$JOB           FORTRAN IV COMPILER (IBFTC), 7090-FO-805, VERSION 5.     5A000000
$DATE          120164                                                   5A000100
$EXECUTE       IBJOB                                                    5A000200
$IBJOB         NOGO                                                     5A000300
$TITLE         FORTRAN IV COMPILER (IBFTC), 7090-FO-805, VERSION 5.     5A000400
$IBMAP 1FTCE   ABSMOD                                                   5A000500
       PCC     ON
       PMC     ON
       DETAIL
       ORG     SYSFAZ                                                   5A000600
       BCI     1,IBFTCE                                                 5A000700
       ORG     SSTRA                                                    5A000800
       TTR     .FCC..                                                   5A000900
       TTL     DEFINITION OF MACROS USED THROUGHOUT THE COMPILER.       5A001000
*                                                                       5A001100
*    I         INITIALIZING + TERMINATING MACROS.                       5A001200
*                                                                       5A001300
       SPACE   3                                                        5A001400
START  MACRO   TBL                                                      5A001500
       TSX     TRSTA,4                                                  5A001600
TR.SS  SET     0                                                        5A001700
       IRP     TBL                                                      5A001800
TR.SS  SET     TR.SS+1                                                  5A001900
       IRP                                                              5A002000
       IRP     TBL                                                      5A002100
TR.SS  SET     TR.SS-1                                                  5A002200
       IFF     TR.SS=0                                                  5A002300
       MZE     TBL'CW                                                   5A002400
       IFT     TR.SS=0                                                  5A002500
       PZE     TBL'CW                                                   5A002600
       IRP                                                              5A002700
       ENDM    START                                                    5A002800
       SPACE   3                                                        5A002900
CLOSE  MACRO   TBL                                                      5A003000
       TSX     TRCLA,4                                                  5A003100
TR.SC  SET     0                                                        5A003200
       IRP     TBL                                                      5A003300
TR.SC  SET     TR.SC+1                                                  5A003400
       IRP                                                              5A003500
       IRP     TBL                                                      5A003600
TR.SC  SET     TR.SC-1                                                  5A003700
       IFF     TR.SC=0                                                  5A003800
       MZE     TBL'CW                                                   5A003900
       IFT     TR.SC=0                                                  5A004000
       PZE     TBL'CW                                                   5A004100
       IRP                                                              5A004200
       ENDM    CLOSE                                                    5A004300
       SPACE   3                                                        5A004400
TEST   MACRO   TBL,EXIT                                                 5A004500
       NZT     TBL                                                      5A004600
       TRA     EXIT                                                     5A004700
       ENDM    TEST                                                     5A004800
       SPACE   3                                                        5A004900
OPEN   MACRO   TBL,EXIT                                                 5A005000
       TEST    TBL,EXIT                                                 5A005100
       LDQ     TBL'ST                                                   5A005200
       STQ     TBL'CW                                                   5A005300
       ENDM    OPEN                                                     5A005400
       EJECT                                                            5A005500
*                                                                       5A005600
*    II        BUILDING   MACROS                                        5A005700
*                                                                       5A005800
       SPACE   3                                                        5A005900
NXTSL  MACRO   TBL                                                      5A006000
       TSX     TWLNA,4                                                  5A006100
       PZE     TBL'CW                                                   5A006200
       ENDM    NXTSL                                                    5A006300
       SPACE   1                                                        5A006400
NXTSLP MACRO   TBL                                                      5A006500
       TSX     TWLPA,4                                                  5A006600
       PZE     TBL'CW                                                   5A006700
       ENDM    NXTSLP                                                   5A006800
       SPACE   3                                                        5A006900
NXTSS  MACRO   TBL,LOC                                                  5A007000
       CAL     LOC                                                      5A007100
       NXTSL   TBL                                                      5A007200
       ENDM    NXTSS                                                    5A007300
       SPACE                                                            5A007400
NXTSSP MACRO   TBL,LOC                                                  5A007500
       CAL     LOC                                                      5A007600
       NXTSLP  TBL                                                      5A007700
       ENDM    NXTSSP                                                   5A007800
       SPACE   3                                                        5A007900
NXTSM  MACRO   TBL,LOC,COUNT                                            5A008000
       TSX     TWMNA,4                                                  5A008100
       PZE     TBL'CW                                                   5A008200
       PZE     COUNT,,LOC                                               5A008300
       ENDM    NXTSM                                                    5A008400
       SPACE                                                            5A008500
NXTSMP MACRO   TBL,LOC,COUNT                                            5A008600
       TSX     TWMPA,4                                                  5A008700
       PZE     TBL'CW                                                   5A008800
       PZE     COUNT,,LOC                                               5A008900
       ENDM    NXTSMP                                                   5A009000
       SPACE   3                                                        5A009100
SMSL   MACRO   TBL                                                      5A009200
       LXD     TBL'CW,4                                                 5A009300
       SLW*    TBL'CW                                                   5A009400
       ENDM    SMSL                                                     5A009500
       SPACE                                                            5A009600
SMSLP  MACRO   TBL                                                      5A009700
       SMSL    TBL                                                      5A009800
       GETPTR  TBL                                                      5A009900
       ENDM    SMSLP                                                    5A010000
       SPACE                                                            5A010100
SMSS   MACRO   TBL,LOC                                                  5A010200
       LXD     TBL'CW,4                                                 5A010300
       LDQ     LOC                                                      5A010400
       STQ*    TBL'CW                                                   5A010500
       ENDM    SMSS                                                     5A010600
SMSSP  MACRO   TBL,LOC                                                  5A010700
       SMSS    TBL,LOC                                                  5A010800
       GETPTR  TBL                                                      5A010900
       ENDM    SMSSP                                                    5A011000
       EJECT                                                            5A011100
*                                                                       5A011200
*    III       FORWARD-READING   MACROS                                 5A011300
*                                                                       5A011400
NXTGL  MACRO   TBL,EXIT                                                 5A011500
       TSX     TVLNA,4                                                  5A011600
       PZE     TBL'CW,,EXIT                                             5A011700
       ENDM    NXTGL                                                    5A011800
       SPACE                                                            5A011900
NXTGLP MACRO   TBL,EXIT                                                 5A012000
       NXTGL   TBL,EXIT                                                 5A012100
       GETPTS  TBL                                                      5A012200
       ENDM    NXTGLP                                                   5A012300
       SPACE                                                            5A012400
NXTGS  MACRO   TBL,LOC,EXIT                                             5A012500
       NXTGL   TBL,EXIT                                                 5A012600
       SLW     LOC                                                      5A012700
       ENDM    NXTGS                                                    5A012800
       SPACE                                                            5A012900
NXTGSP MACRO   TBL,LOC,EXIT                                             5A013000
       NXTGS   TBL,LOC,EXIT                                             5A013100
       GETPTS  TBL                                                      5A013200
       ENDM    NXTGSP                                                   5A013300
       SPACE                                                            5A013400
NXTGM  MACRO   TBL,LOC,COUNT,EXIT                                       5A013500
       TSX     TVMNA,4                                                  5A013600
       PZE     TBL'CW,,EXIT                                             5A013700
       PZE     COUNT,,LOC                                               5A013800
       ENDM    NXTGM                                                    5A013900
       SPACE                                                            5A014000
NXTGMP MACRO   TBL,LOC,COUNT,EXIT                                       5A014100
       TSX     TVMPA,4                                                  5A014200
       PZE     TBL'CW,,EXIT                                             5A014300
       PZE     COUNT,,LOC                                               5A014400
       ENDM    NXTGMP                                                   5A014500
       SPACE                                                            5A014600
NNFGL  MACRO   TBL,EXIT                                                 5A014700
       TSX     TXLNA,4                                                  5A014800
       PZE     TBL'CW,,EXIT                                             5A014900
       ENDM    NNFGL                                                    5A015000
       SPACE                                                            5A015100
NNFGLP MACRO   TBL,EXIT                                                 5A015200
       NNFGL   TBL,EXIT                                                 5A015300
       GETPTS  TBL                                                      5A015400
       ENDM    NNFGLP                                                   5A015500
       SPACE                                                            5A015600
NNFGS  MACRO   TBL,LOC,EXIT                                             5A015700
       NNFGL   TBL,EXIT                                                 5A015800
       SLW     LOC                                                      5A015900
       ENDM    NNFGS                                                    5A016000
       SPACE                                                            5A016100
NNFGSP MACRO   TBL,LOC,EXIT                                             5A016200
       NNFGS   TBL,LOC,EXIT                                             5A016300
       GETPTS  TBL                                                      5A016400
       ENDM    NNFGSP                                                   5A016500
       SPACE                                                            5A016600
NNFGM  MACRO   TBL,LOC,COUNT,EXIT                                       5A016700
       TSX     TXMNA,4                                                  5A016800
       PZE     TBL'CW,,EXIT                                             5A016900
       PZE     COUNT,,LOC                                               5A017000
       ENDM    NNFGM                                                    5A017100
       SPACE                                                            5A017200
NNFGMP MACRO   TBL,LOC,COUNT,EXIT                                       5A017300
       TSX     TXMPA,4                                                  5A017400
       PZE     TBL'CW,,EXIT                                             5A017500
       PZE     COUNT,,LOC                                               5A017600
       ENDM    NNFGMP                                                   5A017700
       EJECT                                                            5A017800
*                                                                       5A017900
*    IV        BACKWARD-READING   MACROS                                5A018000
*                                                                       5A018100
BAKGL  MACRO   TBL,EXIT                                                 5A018200
       TSX     TGLNA,4                                                  5A018300
       PZE     TBL'CW,,EXIT                                             5A018400
       ENDM    BAKGL                                                    5A018500
       SPACE                                                            5A018600
BAKGLP MACRO   TBL,EXIT                                                 5A018700
       BAKGL   TBL,EXIT                                                 5A018800
       GETPTS  TBL                                                      5A018900
       ENDM    BAKGLP                                                   5A019000
       SPACE                                                            5A019100
BAKGS  MACRO   TBL,LOC,EXIT                                             5A019200
       BAKGL   TBL,EXIT                                                 5A019300
       SLW     LOC                                                      5A019400
       ENDM    BAKGS                                                    5A019500
       SPACE                                                            5A019600
BAKGSP MACRO   TBL,LOC,EXIT                                             5A019700
       BAKGS   TBL,LOC,EXIT                                             5A019800
       GETPTR  TBL                                                      5A019900
       ENDM    BAKGSP                                                   5A020000
       SPACE                                                            5A020100
BAKGM  MACRO   TBL,LOC,COUNT,EXIT                                       5A020200
       TSX     TGMNA,4                                                  5A020300
       PZE     TBL'CW,,EXIT                                             5A020400
       PZE     COUNT,,LOC                                               5A020500
       ENDM    BAKGM                                                    5A020600
       SPACE                                                            5A020700
BAKGMP MACRO   TBL,LOC,COUNT,EXIT                                       5A020800
       TSX     TGMPA,4                                                  5A020900
       PZE     TBL'CW,,EXIT                                             5A021000
       PZE     COUNT,,LOC                                               5A021100
       ENDM    BAKGMP                                                   5A021200
       EJECT                                                            5A021300
*                                                                       5A021400
*    V         OTHER READING MACROS                                     5A021500
*                                                                       5A021600
SMGL   MACRO   TBL                                                      5A021700
       LXD     TBL'CW,4                                                 5A021800
       CAL*    TBL'CW                                                   5A021900
       ENDM    SMGL                                                     5A022000
       SPACE                                                            5A022100
SMGLP  MACRO   TBL                                                      5A022200
       GETPTS  TBL                                                      5A022300
       SMGL    TBL                                                      5A022400
       ENDM    SMGLP                                                    5A022500
       SPACE                                                            5A022600
SMGS   MACRO   TBL,LOC                                                  5A022700
       LXD     TBL'CW,4                                                 5A022800
       LDQ*    TBL'CW                                                   5A022900
       STQ     LOC                                                      5A023000
       ENDM    SMGS                                                     5A023100
       SPACE                                                            5A023200
SMGSP  MACRO   TBL,LOC                                                  5A023300
       GETPTS  TBL                                                      5A023400
       SMGS    TBL,LOC                                                  5A023500
       ENDM    SMGSP                                                    5A023600
       EJECT                                                            5A023700
*                                                                       5A023800
*    V         MANIPULATORY   MACROS                                    5A023900
*                                                                       5A024000
JFN    MACRO   TBL,COUNT,EXIT                                           5A024100
       TSX     TJNNA,4                                                  5A024200
       PZE     TBL'CW,,EXIT                                             5A024300
       PZE     COUNT                                                    5A024400
       ENDM    JFN                                                      5A024500
JBN    MACRO   TBL,COUNT,EXIT                                           5A024600
       TSX     THNNA,4                                                  5A024700
       PZE     TBL'CW,,EXIT                                             5A024800
       PZE     COUNT                                                    5A024900
       ENDM    JBN                                                      5A025000
       SPACE                                                            5A025100
JFM    MACRO   N,D,TBL,EXIT                                             5A025200
       IFT     /D/=/B/                                                  5A025300
       TSX     TH'N'NA,4                                                5A025400
       IFF     /D/=/B/                                                  5A025500
       TSX     TJ'N'NA,4                                                5A025600
       PZE     TBL'CW,,EXIT                                             5A025700
       ENDM    JFM                                                      5A025800
       SPACE                                                            5A025900
JF1    MACRO   TBL,EXIT                                                 5A026000
       JFM     1,F,TBL,EXIT                                             5A026100
       ENDM    JF1                                                      5A026200
       SPACE                                                            5A026300
JF2    MACRO   TBL,EXIT                                                 5A026400
       JFM     2,F,TBL,EXIT                                             5A026500
       ENDM    JF2                                                      5A026600
       SPACE                                                            5A026700
JF3    MACRO   TBL,EXIT                                                 5A026800
       JFM     3,F,TBL,EXIT                                             5A026900
       ENDM    JF3                                                      5A027000
       SPACE                                                            5A027100
JB1    MACRO   TBL,EXIT                                                 5A027200
       JFM     1,B,TBL,EXIT                                             5A027300
       ENDM    JB1                                                      5A027400
       SPACE                                                            5A027500
JB2    MACRO   TBL,EXIT                                                 5A027600
       JFM     2,B,TBL,EXIT                                             5A027700
       ENDM    JB2                                                      5A027800
       SPACE                                                            5A027900
JB3    MACRO   TBL,EXIT                                                 5A028000
       JFM     3,B,TBL,EXIT                                             5A028100
       ENDM    JB3                                                      5A028200
       SPACE   3                                                        5A028300
NOTEQ  MACRO   TBL,LOC                                                  5A028400
       LDQ     TBL'CW                                                   5A028500
       STQ     LOC                                                      5A028600
       ENDM    NOTEQ                                                    5A028700
       SPACE                                                            5A028800
RESETQ MACRO   TBL,LOC                                                  5A028900
       LDQ     LOC                                                      5A029000
       STQ     TBL'CW                                                   5A029100
       ENDM    RESETQ                                                   5A029200
       SPACE                                                            5A029300
GETPTR MACRO   TBL                                                      5A029400
       TSX     TRPLA,4                                                  5A029500
       PZE     TBL'CW                                                   5A029600
       ENDM    GETPTR                                                   5A029700
       SPACE                                                            5A029800
GETPTS MACRO   TBL                                                      5A029900
       TSX     TRPSA,4                                                  5A030000
       PZE     TBL'CW                                                   5A030100
       ENDM    GETPTS                                                   5A030200
       SPACE                                                            5A030300
RSTPTR MACRO   TBL,EXIT                                                 5A030400
       TSX     TRSPA,4                                                  5A030500
       PZE     TBL,,EXIT                                                5A030600
       PZE     TBL'CW                                                   5A030700
       ENDM    RSTPTR                                                   5A030800
       SPACE                                                            5A030900
RELPTR MACRO   TBL,EXIT                                                 5A031000
       TSX     TRRPA,4                                                  5A031100
       PZE     TBL,,EXIT                                                5A031200
       ENDM    RELPTR                                                   5A031300
       EJECT                                                            5A031400
*                                                                       5A031500
*    VII       BUFFER   CONTROL   MACROS                                5A031600
*                                                                       5A031700
       SPACE                                                            5A032300
KILAFT MACRO   TBL                                                      5A032400
       TSX     TKAFA,4                                                  5A032500
       PZE     TBL'CW                                                   5A032600
       ENDM    KILAFT                                                   5A032700
KILTAB MACRO   TBL                                                      5A032800
       TSX     TKTBA,4                                                  5A032900
TR.SK  SET     0                                                        5A033000
       IRP     TBL                                                      5A033100
TR.SK  SET     TR.SK+1                                                  5A033200
       IRP                                                              5A033300
       IRP     TBL                                                      5A033400
TR.SK  SET     TR.SK-1                                                  5A033500
       IFF     TR.SK=0                                                  5A033600
       MZE     TBL                                                      5A033700
       IFT     TR.SK=0                                                  5A033800
       PZE     TBL                                                      5A033900
       IRP                                                              5A034000
       ENDM    KILTAB                                                   5A034100
       EJECT                                                            5A034200
*                                                                       5A034300
*    VIII      MACROS FOR SPECIAL TABLES                                5A034400
*                                                                       5A034500
       SPACE                                                            5A034600
ENTNAM MACRO   LOC,DUP                                                  5A034700
       TSX     TNMEA,4                                                  5A034800
       PZE     DUP,,LOC                                                 5A034900
       ENDM    ENTNAM                                                   5A035000
       SPACE                                                            5A035100
ENTEFN MACRO   DUP                                                      5A035200
       TSX     TEFEA,4                                                  5A035300
       PZE     DUP                                                      5A035400
       ENDM    ENTEFN                                                   5A035500
       SPACE                                                            5A035600
ENTTA1 MACRO   LOC,DUP                                                  5A035700
       TSX     TA1EA,4                                                  5A035800
       PZE     DUP,,LOC                                                 5A035900
       ENDM    ENTTA1                                                   5A036000
       SPACE                                                            5A036100
ENTTA2 MACRO   LOC,COUNT,DUP                                            5A036200
       TSX     TA2EA,4                                                  5A036300
       PZE     DUP,,LOC                                                 5A036400
       PZE     COUNT                                                    5A036500
       ENDM    ENTTA2                                                   5A036600
       SPACE                                                            5A036700
ENTSCP MACRO   LOC,COUNT,DUP                                            5A036800
       TSX     TSCEA,4                                                  5A036900
       PZE     DUP,,LOC                                                 5A037000
       PZE     COUNT                                                    5A037100
       ENDM    ENTSCP                                                   5A037200
       SPACE                                                            5A037300
ENTTDM MACRO   LOC,COUNT                                                5A037400
       TSX     TDMEA,4                                                  5A037500
       PZE     COUNT,,LOC                                               5A037600
       ENDM    ENTTDM                                                   5A037700
       SPACE                                                            5A037800
RSPGL  MACRO   TBL,EXIT                                                 5A037900
       TSX     TYLNA,4                                                  5A038000
       PZE     TBL'CW,,EXIT                                             5A038100
       ENDM    RSPGL                                                    5A038200
       SPACE                                                            5A038300
RSPGLP MACRO   TBL,EXIT                                                 5A038400
       RSPGL   TBL,EXIT                                                 5A038500
       GETPTS  TBL                                                      5A038600
       ENDM    RSPGLP                                                   5A038700
       SPACE                                                            5A038800
RSPGS  MACRO   TBL,LOC,EXIT                                             5A038900
       RSPGL   TBL,EXIT                                                 5A039000
       SLW     LOC                                                      5A039100
       ENDM    RSPGS                                                    5A039200
       SPACE                                                            5A039300
RSPGSP MACRO   TBL,LOC,EXIT                                             5A039400
       RSPGS   TBL,LOC,EXIT                                             5A039500
       GETPTS  TBL                                                      5A039600
       ENDM    RSPGSP                                                   5A039700
       EJECT                                                            5A039800
       SPACE   2                                                        5A039900
REFILL MACRO                  LOADS THE NEXT INPUT WORD INTO THE MQ     5A040000
       TSX     BCRF0,4        FROM THE F-REGION AND THE CHARACTER       5A040100
       AXT     6,4            COUNT IN IR4.                             5A040200
       ENDM    REFILL                                                   5A040300
       SPACE   2                                                        5A040400
SETBAS MACRO                                                            5A040500
       TSX     BCSB0,4        SETS THE BASE POINT IN THE F-REGION.      5A040600
       ENDM    SETBAS                                                   5A040700
       SPACE   2                                                        5A040800
RESET  MACRO                                                            5A040900
       TSX     BCRT0,4        RESETS THE SCAN TO THE BASE POINT.        5A041000
       ENDM    RESET                                                    5A041100
       SPACE   2                                                        5A041200
SAVSCN MACRO                                                            5A041300
       SXA     *+2,1                                                    5A041400
       TSX     BCSV0,1        SAVES THE CURRENT SCAN POSITION.          5A041500
       AXT     **,1                                                     5A041600
       ENDM    SAVSCN                                                   5A041700
       SPACE   2                                                        5A041800
RESTOR MACRO                                                            5A041900
       SXA     *+2,1                                                    5A042000
       TSX     BCRS0,1        RESTORES THE SCAN TO CONDITION AT SAVSCN. 5A042100
       AXT     **,1                                                     5A042200
       ENDM    RESTOR                                                   5A042300
       SPACE   2                                                        5A042400
GETBCI MACRO   NUMER,ALPHA,DLMTR                                        5A042500
       TSX     BCI00,4        COLLECTS A SYMBOL, CONSTANT OR DELIMITER. 5A042600
       TRA     NUMER          RETURN FOR A CONSTANT.                    5A042700
       TRA     ALPHA          RETURN FOR A SYMBOL.                      5A042800
       TRA     DLMTR          RETURN FOR A DELIMITER.                   5A042900
       ENDM    GETBCI                                                   5A043000
       SPACE   2                                                        5A043100
       SPACE   2                                                        5A043500
MOREAD MACRO                                                            5A043600
       TSX     BCMD0,4        COLLECTS A SYMBOL STARTING WITH .DLMTR.   5A043700
       ENDM    MOREAD                                                   5A043800
       SPACE   2                                                        5A043900
MOREN  MACRO   .TYPE          COLLECTS A CONSTANT AND CONVERTS          5A044000
       TSX     CBMOR,4        IT ACCORDING TO THE MODE                  5A044100
       PZE     .TYPE          SPECIFIED BY .TYPE                        5A044200
       ENDM    MOREN                                                    5A044300
       SPACE   2                                                        5A044400
TSTNXT MACRO   NUMER,ALPHA,DLMTR                                        5A044500
       TSX     BCTS0,4        TESTS NEXT CHARACTER IN F-REGION AND      5A044600
       TRA     NUMER          RETURNS TO NUMER FOR NUMERIC,             5A044700
       TRA     ALPHA          FOR ALPHABETIC,                           5A044800
       TRA     DLMTR          FOR A DELIMITER.                          5A044900
       ENDM    TSTNXT                                                   5A045000
       SPACE   2                                                        5A045100
GETNNB MACRO   N                                                        5A045200
       TSX     BCGTN,4        COLLECTS N CHARACTERS, IGNORING BLANKS.   5A045300
       PZE     N                                                        5A045400
       ENDM    GETNNB                                                   5A045500
       SPACE   2                                                        5A045600
GETNWB MACRO   N                                                        5A045700
       TSX     BCGTW,4        COLLECTS N CHARACTERS, INCLUDING BLANKS.  5A045800
       PZE     N                                                        5A045900
       ENDM    GETNWB                                                   5A046000
       SPACE   2                                                        5A046100
NAME   MACRO   REPLAC         NAME ROUTINE MACRO.                       5A046200
       TSX     NAME0,4       $CALL COMMON SUBROUTINE.                   5A046300
       ENDM    NAME                                                     5A046400
       SPACE   3                                                        5A046500
       SPACE   2                                                        5A046600
WMAIN  MACRO   A              WRITE MAIN FILE                           5A046700
       TSX     IXMNO,4                                                  5A046800
       PZE     A                                                        5A046900
       ENDM    WMAIN                                                    5A047000
       REM                                                              5A047100
       REM                                                              5A047200
WDOTAG MACRO   A              WRITE DOTAG FILE                          5A047300
       TSX     IXDTO,4                                                  5A047400
       PZE     A                                                        5A047500
       ENDM    WDOTAG                                                   5A047600
       REM                                                              5A047700
       REM                                                              5A047800
RMAIN  MACRO   A              READ MAIN FILE                            5A047900
       TSX     IXMIN,4                                                  5A048000
       TRA     A              END OF COMPILATION EXIT.                  5A048100
       ENDM    RMAIN                                                    5A048200
       REM                                                              5A048300
       REM                                                              5A048400
RDOTAG MACRO   A              READ DOTAG FILE                           5A048500
       TSX     IXDTG,4                                                  5A048600
       TRA     A              END OF COMPILATION EXIT.                  5A048700
       ENDM    RDOTAG                                                   5A048800
       REM                                                              5A048900
       REM                                                              5A049000
       SPACE   2                                                        5A049100
TESTP  MACRO   A,B                                                      5A049200
       LXD     .DLMTR,4                                                 5A049300
       IRP     A                                                        5A049400
       IFTAG   A                                                        5A049500
       IRP                                                              5A049600
       TRA     B                                                        5A049700
       ENDM    TESTP                                                    5A049800
       REM                                                              5A049900
       REM                                                              5A050000
IFTAG  MACRO   K,BRANCH                                                 5A050100
       TXH     *+2,4,K                                                  5A050200
       TXH     BRANCH,4,K'-1                                            5A050300
       ENDM    IFTAG                                                    5A050400
       REM                                                              5A050500
       REM                                                              5A050600
SETON  MACRO   A                                                        5A050700
       IRP     A                                                        5A050800
       STL     A                                                        5A050900
       IRP                                                              5A051000
       ENDM    SETON                                                    5A051100
       REM                                                              5A051200
       REM                                                              5A051300
SETOFF MACRO   A                                                        5A051400
       IRP     A                                                        5A051500
       STZ     A                                                        5A051600
       IRP                                                              5A051700
       ENDM    SETOFF                                                   5A051800
       SPACE   2                                                        5A051900
 IFON  MACRO   A,B                                                      5A052000
       ZET     A                                                        5A052100
       TRA     B                                                        5A052200
       ENDM    IFON                                                     5A052300
       REM                                                              5A052400
       REM                                                              5A052500
 IFOFF MACRO   A,B                                                      5A052600
       NZT     A                                                        5A052700
       TRA     B                                                        5A052800
       ENDM    IFOFF                                                    5A052900
       REM                                                              5A053000
       REM                                                              5A053100
DIAGN  MACRO   A,B,C,D                                                  5A053200
       TSX     DIAG,4                                                   5A053300
       IFF     /D/=/L/                                                  5A053400
       PZE     A,B,C                                                    5A053500
       IFT     /D/=/L/                                                  5A053600
       MZE     A,B,C                                                    5A053700
       ENDM    DIAGN                                                    5A053800
       REM                                                              5A053900
       REM                                                              5A054000
       TTL     IBSYS/IBJOB SIZES, ORIGINS, AND COMMUNICATIONS AREAS.    5A054100
       REM                                                              5A054200
       REM     DEFINITIONS OF IBJOB COMPONENT SIZES                     5A054300
       REM                                                              5A054400
CH7909 EQU     0                                                        5A054500
NOCH9  EQU     1-CH7909                                                 5A054600
IBSIZ  EQU     1450+550*CH7909                                          5A054700
IOCSZ  EQU     1428                                                     5A054800
JCSZ   EQU     41                                                       5A054900
ACTSZ  EQU     352                                                      5A055000
PCTSZ  EQU     2057                                                     5A055100
PCNSZ  EQU     1384                                                     5A055200
EDSIZ  EQU     2148                                                     5A055300
JBCOMS EQU     75                                                       5A055400
IOCOMS EQU     35                                                       5A055500
COMSZ  EQU     JBCOMS+IOCOMS                                            5A055600
       REM                                                              5A055700
       REM     DEFINITIONS OF IBJOB COMPONENT ORIGINS                   5A055800
       REM                                                              5A055900
IOCORG EQU     IBSIZ                                                    5A056000
IOCEND EQU     1450+IOCSZ                                               5A056100
SUBSYS EQU     IOCEND+PCTSZ+ACTSZ+PCNSZ+EDSIZ+COMSZ+JCSZ                5A056200
IOCS   EQU     SUBSYS-IOCOMS                                            5A056300
IBJCOM EQU     IOCS-JBCOMS                                              5A056400
PCNORG EQU     IBJCOM-PCNSZ                                             5A056500
EDORG  EQU     PCNORG-EDSIZ                                             5A056600
ACTORG EQU     EDORG-ACTSZ                                              5A056700
PCTORG EQU     SUBSYS-NOCH9*SUBSYS+NOCH9*IOCEND                         5A056800
JCORG  EQU     ACTORG-JCSZ                                              5A056900
       REM                                                              5A057000
       REM     IBSYS COMMUNICATIONS AREA                                5A057100
SYSCOM EQU     64                                                       5A057200
       ORG     SYSCOM                                                   5A057300
SYSTRA BSS     1                                                        5A057400
SYSDAT BSS     1                                                        5A057500
SYSCUR BSS     1                                                        5A057600
SYSRET BSS     1                                                        5A057700
SYSKEY BSS     1                                                        5A057800
SYSSWS BSS     1                                                        5A057900
SYSPOS BSS     1                                                        5A058000
SYSUNI BSS     1                                                        5A058100
SYSUBC BSS     1                                                        5A058200
SYSUAV BSS     1                                                        5A058300
SYSUCW BSS     1                                                        5A058400
SYSRPT BSS     1                                                        5A058500
SYSCEM BSS     1                                                        5A058600
SYSDMP BSS     1                                                        5A058700
SYSIOX BSS     1                                                        5A058800
SYSIDR BSS     1                                                        5A058900
SYSCOR BSS     1                                                        5A059000
SYSLDR BSS     1                                                        5A059100
SYSACC BSS     1                                                        5A059200
SYSPID BSS     1                                                        5A059300
SYSCYD BSS     2                                                        5A059400
SYSSLD BSS     1                                                        5A059500
SYSTCH BSS     3                                                        5A059600
SYSGET BSS     1                                                        5A059700
SYSJOB BSS     1                                                        5A059800
       REM     IOEX COMMUNICATIONS AREA                                 5A059900
IOXCOM EQU     450                                                      5A060000
       ORG     IOXCOM                                                   5A060100
ACTIV  BSS     1                                                        5A060200
ACTVX  BSS     1                                                        5A060300
NDATA  BSS     1                                                        5A060400
NDSLX  BSS     1                                                        5A060500
PROUT  BSS     2                                                        5A060600
ENBSW  BSS     1                                                        5A060700
PAWSX  BSS     1                                                        5A060800
PAUSE  BSS     1                                                        5A060900
STOPX  BSS     1                                                        5A061000
SYMUN  BSS     1                                                        5A061100
DECVD  BSS     1                                                        5A061200
DECVA  BSS     1                                                        5A061300
CKWAT  BSS     1                                                        5A061400
BCD5R  BSS     1                                                        5A061500
BCD5X  BSS     1                                                        5A061600
CVPRT  BSS     1                                                        5A061700
STOPD  BSS     1                                                        5A061800
CHXAC  BSS     1                                                        5A061900
URRXI  BSS     1                                                        5A062000
RCTXI  BSS     1                                                        5A062100
RCHXI  BSS     1                                                        5A062200
TCOXI  BSS     1                                                        5A062300
TRCXI  BSS     1                                                        5A062400
ETTXI  BSS     1                                                        5A062500
TEFXI  BSS     1                                                        5A062600
TRAPX  BSS     1                                                        5A062700
TRAPS  BSS     1                                                        5A062800
COMMM  BSS     1                                                        5A062900
LTPOS  BSS     1                                                        5A063000
IOXSI  BSS     1                                                        5A063100
CHPSW  BSS     1                                                        5A063200
TRPSW  BSS     1                                                        5A063300
FDAMT  BSS     1                                                        5A063400
SDCXI  BSS     1                                                        5A063500
STCXI  BSS     1                                                        5A063600
COMMD  BSS     1                                                        5A063700
IBCDZ  BSS     1                                                        5A063800
MWR    SYN     PROUT                                                    5A063900
SYSLB1 EQU     1                                                        5A064000
SYSLB2 EQU     2                                                        5A064100
SYSLB3 EQU     3                                                        5A064200
SYSLB4 EQU     4                                                        5A064300
SYSOU1 EQU     8                                                        5A064400
SYSOU2 EQU     9                                                        5A064500
SYSIN1 EQU     10                                                       5A064600
SYSIN2 EQU     11                                                       5A064700
SYSPP1 EQU     12                                                       5A064800
SYSPP2 EQU     13                                                       5A064900
SYSUT1 EQU     16                                                       5A065000
SYSUT2 EQU     17                                                       5A065100
SYSUT3 EQU     18                                                       5A065200
SYSUT4 EQU     19                                                       5A065300
       REM     IBJOB COMMUNICATIONS AREA                                5A065400
       REM     DEFINITIONS OF COMMUNICATION CELLS NEEDED                5A065500
       REM     DURING EXECUTION.                                        5A065600
       REM                                                              5A065700
       ORG     IBJCOM                                                   5A065800
SYSLOC BSS     1                                                        5A065900
SYSFAZ BSS     1                                                        5A066000
IBJCOR BSS     1                                                        5A066100
IBJDAT BSS     1                                                        5A066200
LISDAT BSS     2                                                        5A066300
MTYPE  BSS     1                                                        5A066400
.JLIN  BSS     1                                                        5A066500
MODNO  BSS     1                                                        5A066600
SKAPUT BSS     1                                                        5A066700
SYSDSB BSS     2                                                        5A066800
.FDPOS BSS     1                                                        5A066900
       BSS     2                                                        5A067000
       REM                                                              5A067100
       REM     DEFINITIONS OF COMMUNICATION CELLS NEEDED BY SUBSYSTEMS. 5A067200
       REM                                                              5A067300
SSTRA  BSS     1                                                        5A067400
ACTION BSS     1                                                        5A067500
JOBIN  BSS     1                                                        5A067600
JOBOU  BSS     1                                                        5A067700
JOBPP  BSS     1                                                        5A067800
IOEDIT BSS     1                                                        5A067900
JREEL  BSS     1                                                        5A068000
SUBSP  BSS     1                                                        5A068100
PUNCH  BSS     1                                                        5A068200
SYSSHD BSS     1                                                        5A068300
LILDMP BSS     2                                                        5A068400
PRSW   BSS     1                                                        5A068500
JLNSIZ BSS     1                                                        5A068600
INPOP  BSS     1                                                        5A068700
       ORG     INPOP+8                                               (6)5A068703
DECK   BSS     1                                                     (6)5A068706
       REM                                                              5A068800
       REM     IOCS COMMUNICATIONS AREA                                 5A068900
       ORG     IOCS                                                     5A069000
DEFINE BSS     2                                                        5A069100
JOIN   BSS     2                                                        5A069200
ATTACH BSS     2                                                        5A069300
CLOSE  BSS     2                                                        5A069400
OPEN   BSS     2                                                        5A069500
READ   BSS     2                                                        5A069600
WRITE  BSS     2                                                        5A069700
STASH  BSS     3                                                        5A069800
LFLBLK BSS     1                                                        5A069900
LTSX   BSS     1                                       -                5A070000
XEOB   BSS     1                                       -                5A070100
XEOF   BSS     1                -                                       5A070200
XERR   BSS     1                                                        5A070300
LTRAD  BSS     1                                                        5A070400
TRANS  BSS     1                                                        5A070500
WDCT   BSS     1                                                        5A070600
IRS    BSS     1                                                        5A070700
SENSE  BSS     1                                                        5A070800
FCW    BSS     1                                                        5A070900
LUNBLK BSS     1                                                        5A071000
NDSEL  BSS     1                                                        5A071100
       TTL     IBFTC COMPILER SIZES AND ORIGINS.                        5A071200
*      DEFINITION OF SIZES, LENGTHS, AND ORIGINS.                       5A071300
       SPACE   1                                                        5A071400
*      DEFINITION OF TABLE SIZES AND PARAMETERS.                        5A071500
       SPACE   2                                                        5A071600
ZCDIN  EQU     50             MAXIMUM CONDIG INCREASE, PER COMPILATION. 5A071700
ZCDMX  EQU     250            MAXIMUM TOTAL CONDIG SIZE.                5A071800
TRBSZ  EQU     60             SIZE OF TR BUFFERS.                       5A071900
IXBFZ  EQU     200            SIZE OF I/O BUFFERS.                      5A072000
HTASZ  EQU     37             SIZE OF HASH TABLE A (NAME/EFN).          5A072100
HTBSZ  EQU     17             SIZE OF HASH TABLE B (TSC/TA1).           5A072200
HTCSZ  EQU     17             SIZE OF HASH TABLE C (TA2, IN PHASE A).   5A072300
HTDSZ  EQU     7              SIZE OF HASH TABLE D (TA2, IN PHASE B).   5A072400
       SPACE   4                                                        5A072500
*      LENGTHS OF CODING AND COMMUNICATION BLOCKS.                      5A072600
       SPACE   2                                                        5A072700
Z.TVEC EQU     105            TRANSFER VECTORS                          5A072800
Z.CONS EQU     780            MASKS AND CONSTANTS.                      5A072900
Z.FGEN EQU     1339           ROUTINES COMMON TO THE COMPILER.      (12)5A073000
Z.FAP1 EQU     969            PHASE A PATCH SPACE + COMMON ROUTINES (14)5A073030
Z.FAP3 EQU     295            PHASE A PATCH SPACE + COMMON ROUTINES (14)5A073045
Z.FAP2 EQU     2062           PHASE A PATCH SPACE + COMMON ROUTINES (12)5A073060
Z.FGNP EQU     50             PATCH SPACE FOR COMMON ROUTINES.          5A073100
Z.PHA1 EQU     4600           PHASE A CONTROL AND STATEMENT PROCESSORS. 5A073200
Z.PHA2 EQU     4775           ARITHMETIC TRANSLATOR.                    5A073300
Z.PHA3 EQU     2000           INDEXER.                                  5A073400
Z.PHAP EQU     300            PATCH SPACE FOR PHASE A.               (4)5A073500
Z.PHB1 EQU     6060           STORAGE ALLOCATOR AND RELCON ANALYSIS.    5A073600
Z.PHB2 EQU     5130           ASSEMBLER.                                5A073700
Z.PHBP EQU     100            PHASE B PATCH SPACE.                  (12)5A073800
Z.FDGN EQU     5200           DIAGNOSTIC FILE.                          5A073900
Z.FDGP EQU     100            DIAGNOSTIC PATCH SPACE.                   5A074000
Z.FCOM EQU     30             FORCOM BLOCK.                             5A074100
Z.TRC  EQU     4*TR.NO+2      TR CONTROL.                               5A074200
Z.CMPT EQU     50             COMMON ROUTINE PATCH SPACE             (8)5A074202
       SPACE   4                                                        5A074300
*      ORIGINS OF CODING AND COMMUNICATION BLOCKS.                      5A074400
O.SAR  EQU     -875                                                     5A074500
O.TVEC EQU     SUBSYS         TRANSFER VECTORS.                         5A074600
O.CONS EQU     O.TVEC+Z.TVEC  MASKS AND CONSTANTS.                      5A074700
O.FGEN EQU     O.CONS+Z.CONS  ROUTINES COMMON TO THE COMPILER.          5A074800
O.FAP1 EQU     O.FGEN+Z.FGEN  PHASE A PATCH SPACE + COMMON ROUTINES (12)5A074830
O.FAP3 EQU     O.FAP1+Z.FAP1  PHASE A PATCH SPACE + COMMON ROUTINES (14)5A074845
O.FAP2 EQU     O.FAP3+Z.FAP3  PHASE A PATCH SPACE + COMMON ROUTINES (14)5A074860
O.FGNP EQU     O.FAP2+Z.FAP2  PATCH SPACE FOR COMMON ROUTINES       (12)5A074900
O.PHA1 EQU     O.FGNP+Z.FGNP  PHASE A CONTROL AND STATEMENT PROCESSORS. 5A075000
O.PHA2 EQU     O.PHA1+Z.PHA1  ARITHMETIC TRANSLATOR.                    5A075100
O.PHA3 EQU     O.PHA2+Z.PHA2  INDEXER.                                  5A075200
O.PHAP EQU     O.PHA3+Z.PHA3  PATCH SPACE FOR PHASE A.                  5A075300
O.PHAF EQU     O.PHAP+Z.PHAP  FREE SPACE IN PHASE A.                    5A075400
O.PHB1 EQU     O.PHA1         PHASE B CONTROL, INDEXING PROLOGUE,       5A075500
       REM                    AND RELCON ROUTINES.                      5A075600
O.PHB2 EQU     O.PHB1+Z.PHB1  ASSEMBLER.                                5A075700
O.PHBP EQU     O.PHB2+Z.PHB2  PATCH SPACE FOR PHASE B.                  5A075800
O.PHBF EQU     O.PHBP+Z.PHBP  FREE SPACE IN PHASE B.                    5A075900
O.FDGN EQU     O.PHA1         DIAGNOSTIC FILE.                          5A076000
O.FDGP EQU     O.FDGN+Z.FDGN  DIAGNOSTIC PATCH SPACE.                   5A076100
TBDEF  MACRO   TBL                                                      5A076200
       IRP     TBL                                                      5A076300
TR.NO  SET     TR.NO+1                                                  5A076400
TBL    BSS     1                                                        5A076500
TBL'CW BSS     1                                                        5A076600
TBL'ST BSS     1                                                        5A076700
TBL'FN BSS     1                                                        5A076800
       IRP                                                              5A076900
       ENDM    TBDEF                                                    5A077000
O.FCOM EQU     O.SAR-Z.FCOM   FORCOM BLOCK.                             5A077100
O.TRC  EQU     O.FCOM-Z.TRC   TR CONTROL.                               5A077200
O.CMPT EQU     O.TRC-Z.CMPT   COMMON ROUTINE PATCH SPACE             (8)5A077202
       ORG     O.TRC                                                    5A077300
TRNUL  PZE     **,,**         NULL STRING HEAD-WORD                     5A077400
TRHLS  PZE     **,,**         LIMITS OF PRIMARY TABLE SPACE             5A077500
TR.NO  SET     0              NO. OF TABLES INITIALLY ZERO              5A077600
O.TRN  NULL                                                             5A077700
       TBDEF   (TA1,TB1,TBD,TKN,TN1,TN2,TPD,TSC)                        5A077800
       TBDEF   (TAA,TAF,TAS,TBR,TCH,TDT,TES,TFB,TID,TLT)                5A077900
       TBDEF   (TLV,TMP,TOE,TPR,TQC,TQL,TSL,TST,TTT)                    5A078000
O.TRNZ NULL                                                             5A078100
TR.NN  SET     TR.NO                                                    5A078200
       ORG     O.TRN                                                    5A078300
       TBDEF   (TAP,TBK,TBP,TCD,TCE,TCR,TDD,TDL,TDO,TDU)                5A078400
       TBDEF   (TDX,TEC,TEH,TIN,TLA,TLB,TLC,TLI,TLS,TPL)                5A078500
       TBDEF   (TQR,TSM,TTM)                                            5A078600
TR.NO  SET     TR.NN                                                    5A078700
       ORG     O.TRNZ                                                   5A078800
O.TRI  NULL                                                             5A078900
       TBDEF   (TA2,TAR,TCM,TCN,TDA,TDM,TDP,TEF,TEQ,TER)                5A079000
       TBDEF   (TFL,TFM,TFT,TIF,TNL,TNM,TP1,TP2,TSB,TSY)                5A079100
       TBDEF   (TTA,TTF)                                                5A079200
O.TRIZ NULL                                                             5A079300
TR.NI  SET     TR.NO-TR.NN                                              5A079400
       TTL     TRANSFER VECTORS TO THE COMPILER.                        5A079500
       ORG     O.TVEC                                                   5A079600
       DUP     1,99                                                     5A079700
       STR                                                              5A079800
       ORG     O.TVEC                                                   5A079900
*      TRANSFER VECTORS TO TABLE ROUTINES.                              5A080000
       SPACE   2                                                        5A080100
       TTR     TA1EA                                                    5A080200
       TTR     TA2EA                                                    5A080300
       TTR     TDMEA                                                    5A080400
       TTR     TEFEA                                                    5A080500
       TTR     TGLNA                                                    5A080600
       TTR     TGMNA                                                    5A080700
       TTR     TGMPA                                                    5A080800
       TTR     TH1NA                                                    5A080900
       TTR     TH2NA                                                    5A081000
       TTR     TH3NA                                                    5A081100
       TTR     THNNA                                                    5A081200
       TTR     TJ1NA                                                    5A081300
       TTR     TJ2NA                                                    5A081400
       TTR     TJ3NA                                                    5A081500
       TTR     TJNNA                                                    5A081600
       TTR     TKAFA                                                    5A081700
       BSS     1                                                    (14)5A081800
       TTR     TKTBA                                                    5A081900
       TTR     TNMEA                                                    5A082000
       TTR     TR1IA                                                    5A082100
       TTR     TR2IA                                                    5A082200
       TTR     TR3IA                                                    5A082300
       BSS     1                                                    (12)5A082400
       TTR     TRCLA                                                    5A082500
       TTR     TRPLA                                                    5A082600
       TTR     TRPSA                                                    5A082700
       TTR     TRRPA                                                    5A082800
       TTR     TRSPA                                                    5A082900
       TTR     TRSTA                                                    5A083000
       TTR     TSCEA                                                    5A083100
       TTR     TVLNA                                                    5A083200
       TTR     TVMNA                                                    5A083300
       TTR     TVMPA                                                    5A083400
       TTR     TWLNA                                                    5A083500
       TTR     TWLPA                                                    5A083600
       TTR     TWMNA                                                    5A083700
       TTR     TWMPA                                                    5A083800
       TTR     TXLNA                                                    5A083900
       TTR     TXMNA                                                    5A084000
       TTR     TXMPA                                                    5A084100
       TTR     TYLNA                                                    5A084200
       SPACE   4                                                        5A084300
*      TRANSFER VECTORS TO THE BCI COLLECTOR.                           5A084400
       SPACE   2                                                        5A084500
       TTR     BCGTN                                                    5A084600
       TTR     BCGTW                                                    5A084700
       TTR     BCI00                                                    5A084800
       STR                    (ROUTINE BCMA0 HAS BEEN REMOVED)      (12)5A084900
       TTR     BCMD0                                                    5A085000
       TTR     BCRF0                                                    5A085100
       TTR     BCRS0                                                    5A085200
       TTR     BCRT0                                                    5A085300
       TTR     BCSB0                                                    5A085400
       TTR     BCSV0                                                    5A085500
       TTR     BCTS0                                                    5A085600
       SPACE   4                                                        5A085700
*      TRANSFER VECTORS TO CONVERSION ROUTINES.                         5A085800
       SPACE   2                                                        5A085900
       TTR     CBMOR                                                    5A086000
       TTR     CBRES                                                    5A086100
       TTR     CO00N                                                    5A086200
       TTR     CON1N                                                    5A086300
       TTR     UNBCG                                                    5A086400
       TTR     UNBCO                                                    5A086500
       TTR     UBNBC                                                    5A086600
       SPACE   4                                                        5A086700
*      TRANSFER VECTORS TO THE SUBSCRIPT SCANNER.                       5A086800
       SPACE   2                                                        5A086900
       TTR     SSCAN                                                    5A087000
       TTR     SZPDB                                                    5A087100
       SPACE   4                                                        5A087200
*      TRANSFER VECTORS TO ERASABLE, NAME, CONSTANT, AND                5A087300
*      IFN TABLE ROUTINES.                                              5A087400
       SPACE   2                                                        5A087500
       TTR     ENTTER                                                   5A087600
       TTR     NAME0                                                    5A087700
       TTR     UCSTM                                                    5A087800
       TTR     UIFNO                                                    5A087900
       SPACE   4                                                        5A088000
*      TRANSFER VECTORS TO IN-CORE DIAGNOSTIC ROUTINE.                  5A088100
       SPACE   2                                                        5A088200
       TTR     DIAG                                                     5A088300
       TTR     XCCLS                                                    5A088400
       SPACE   4                                                        5A088500
*      TRANSFER VECTORS TO INTERNAL TEXT ROUTINES.                      5A088600
       SPACE   2                                                        5A088700
       TTR     IXCTL                                                    5A088800
       TTR     IXDTO                                                    5A088900
IXDTG  BSS     1                                                        5A089000
       TTR     IXFCB                                                    5A089100
       TTR     IXINT                                                    5A089200
IXMIN  BSS     1                                                        5A089300
       TTR     IXMNO                                                    5A089400
       TTR     IXPBE                                                    5A089500
IXPBI  BSS     1                                                        5A089600
       TTR     IXERR                                                    5A089700
       SPACE   4                                                        5A089800
*      TRANSFER VECTOR TO PHASE A CONTROL.                              5A089900
       SPACE   2                                                        5A090000
PHASA  BSS     1                                                        5A090100
ULDFT0 BSS     1                                                        5A090200
ULDFTO BSS     1                                                        5A090300
XC35L  BSS     1                                                        5A090400
XCRST  BSS     1                                                        5A090500
       SPACE   1                                                        5A090600
*      POINTERS TO PHASE A CONTROL CELLS.                               5A090700
       SPACE   1                                                        5A090800
UARB1  BSS     1                                                        5A090900
UARC1  BSS     1                                                        5A091000
       SPACE   4                                                        5A091100
*      TRANSFER VECTORS TO EFN AND FORVAL ROUTINES.                     5A091200
       SPACE   2                                                        5A091300
UEFNM  BSS     1                                                        5A091400
UEFNS  BSS     1                                                        5A091500
UFVLS  BSS     1                                                        5A091600
       SPACE   4                                                        5A091700
*      TRANSFER VECTORS TO ARITHMETIC TRANSLATOR AND INDEXER.           5A091800
       SPACE   2                                                        5A091900
ARITH  BSS     1                                                        5A092000
INOHR  BSS     1                                                        5A092100
NESTAG BSS     1                                                        5A092200
       SPACE   4                                                        5A092300
*      TRANSFER VECTORS TO PHASEB CONTROL AND ADJUSTABLE DIMENSION      5A092400
*      PROLOGUE ROUTINE.                                                5A092500
       SPACE   2                                                        5A092600
PGD00  BSS     1                                                        5A092700
PHASB  BSS     1                                                        5A092800
XB06B  BSS     1                                                        5A092900
       SPACE   4                                                        5A093000
*      TRANSFER VECTORS TO THE ASSEMBLER.                               5A093100
       SPACE   2                                                        5A093200
AAMSI  BSS     1                                                        5A093300
AASEM  BSS     1                                                        5A093400
AASMB  BSS     1                                                        5A093500
AIFNS  BSS     1                                                        5A093600
AMERG  BSS     1                                                        5A093700
AVCNC  BSS     1                                                        5A093800
AVECN  BSS     1                                                        5A093900
AWDGN  BSS     1                                                        5A094000
       SPACE   4                                                        5A094100
*      TRANSFER VECTOR TO THE DIAGNOSTIC RECORD.                        5A094200
       SPACE   2                                                        5A094300
DGENT  BSS     1                                                        5A094400
       TTL     COMPILER COMMUNICATIONS AREA, INCLUDING CONSTANTS.       5A094500
       REM     *********************************************************5A094600
       REM                                                              5A094700
       REM     DEFINITION OF FIRST-WORD IIF FLAGS.                      5A094800
       REM                                                              5A094900
.IIFNW LBOOL   400000         IF ON, THIS IS IFN WORD.                  5A095000
.IWONE LBOOL   200000         IF ON, THIS IS NOT THE                    5A095100
       REM                    LAST WORD OF THIS IIF.                    5A095200
.IANAM LBOOL   100000         IF ON, ADDRESS IS NAME POINTER.           5A095300
.IASBK LBOOL   040000         IF ON, ADDRESS IS SUBAK POINTER.          5A095400
.IAEFN LBOOL   020000         IF ON, ADDRESS IS EFN POINTER.            5A095500
.IAIFN LBOOL   010000         IF ON, ADDRESS IS IFN POINTER.            5A095600
.IACON LBOOL   140000         IF ON, ADDRESS IS CONSTANT POINTER.       5A095700
.IAERS LBOOL   120000         IF ON, ADDRESS IS ERASABLE POINTER.       5A095800
.IABIN LBOOL   110000         IF ON, ADDRESS IS BINARY.                 5A095900
.IASTR LBOOL   060000         IF ON, ADDRESS IS ADDEND TO CURRENT       5A096000
       REM                    LOCATION.                                 5A096100
.IASUB LBOOL   050000         IF ON, ADDRESS IS TO BE SUBTRACTED        5A096200
       REM                    FROM CURRENT LOCATION.                    5A096300
.IAVAC LBOOL   030000         IF ON, ADDRESS IS TO BE INITIALIZED.      5A096400
.IALCS LBOOL   150000         IF ON, ADDRESS IS A RELATIVE LOCATION.    5A096500
.ITSYM LBOOL   004000         IF ON, TAG IS SYMBOLIC.                   5A096600
.IINDR LBOOL   002000         IF ON, INDIRECT ADDRESSING IS WANTED.     5A096700
.IASPO LBOOL   001000         IF ON, *+1 IS UNDERSTOOD, AND THE         5A096800
       REM                    ADDRESS FIELD OF THE IIF DEFINES THE      5A096900
       REM                    DECREMENT OF THE INSTRUCTION.             5A097000
       REM                                                              5A097100
       REM     DEFINITION OF SECOND-WORD IIF FLAGS.                     5A097200
.IDNAM LBOOL   100000         IF ON, DECREMENT IS A NAME POINTER.       5A097300
.IDSBK LBOOL   040000         IF ON, DECREMENT IS A SUBAK POINTER.      5A097400
.IDBIN LBOOL   110000         IF ON, DECREMENT IS BINARY.               5A097500
.IDADD LBOOL   060000         IF ON, DECREMENT FIELD IS ADDEND TO       5A097600
       REM                    THE ADDRESS.                              5A097700
.IDSUB LBOOL   050000         IF ON, DECREMENT IS TO BE SUBTRACTED      5A097800
       REM                    FROM ADDRESS.                             5A097900
.IDVAC LBOOL   030000         IF ON, DECREMENT IS TO BE INITIALIZED.    5A098000
       SPACE   3                                                        5A098100
.IMBEG EQU     1              BEGINNING OF IIF OPCODE DEFINITIONS.      5A098200
       REM                                                              5A098300
       REM     DEFINITION OF 7090 MACHINE OPCODES AND PSEUDO-OPERATIONS.5A098400
       REM                    MNEMONIC-                                 5A098500
       ORG     .IMBEG                                                   5A098600
.IADD  BSS     1              ADD                                       5A098700
.IALS  BSS     1              ALS                                       5A098800
.IANA  BSS     1              ANA                                       5A098900
.IAXC  BSS     1              AXC                                       5A099000
.IAXT  BSS     1              AXT                                       5A099100
.IBCI  BSS     1              BCI                                       5A099200
.IBSS  BSS     1              BSS                                       5A099300
.ICAL  BSS     1              CAL                                       5A099400
.ICAS  BSS     1              CAS                                       5A099500
.ICHS  BSS     1              CHS                                       5A099600
.ICLA  BSS     1              CLA                                       5A099700
.ICLS  BSS     1              CLS                                       5A099800
.IDFAD BSS     1              DFAD                                      5A099900
.IDFDP BSS     1              DFDP                                      5A100000
.IDFMP BSS     1              DFMP                                      5A100100
.IDFSB BSS     1              DFSB                                      5A100200
.IDLD  BSS     1              DLD                                       5A100300
.IDST  BSS     1              DST                                       5A100400
.IDUP  BSS     1              DUP                                       5A100500
.IDVP  BSS     1              DVP                                       5A100600
.IEVEN BSS     1              EVEN                                      5A100700
.IFAD  BSS     1              FAD                                       5A100800
.IFDP  BSS     1              FDP                                       5A100900
.IFMP  BSS     1              FMP                                       5A101000
.IFSB  BSS     1              FSB                                       5A101100
.IHTR  BSS     1              HTR                                       5A101200
.ILAC  BSS     1              LAC                                       5A101300
.ILDC  BSS     1              LDC                                       5A101400
.ILDI  BSS     1              LDI                                       5A101500
.ILDQ  BSS     1              LDQ                                       5A101600
.ILLS  BSS     1              LLS                                       5A101700
.ILMTM BSS     1              LMTM                                      5A101800
.ILRS  BSS     1              LRS                                       5A101900
.ILXA  BSS     1              LXA                                       5A102000
.IMPY  BSS     1              MPY                                       5A102100
.INULL BSS     1              NULL                                      5A102200
.INZT  BSS     1              NZT                                       5A102300
.IOCT  BSS     1              OCT                                       5A102400
.IORA  BSS     1              ORA                                       5A102500
.IORG  BSS     1              ORG                                       5A102600
.IPAC  BSS     1              PAC                                       5A102700
.IPAX  BSS     1              PAX                                       5A102800
.IPXA  BSS     1              PXA                                       5A102900
.IPZE  BSS     1              PZE                                       5A103000
.IRQL  BSS     1              RQL                                       5A103100
.ISBM  BSS     1              SBM                                       5A103200
.ISCA  BSS     1              SCA                                       5A103300
.ISLW  BSS     1              SLW                                       5A103400
.ISSM  BSS     1              SSM                                       5A103500
.ISSP  BSS     1              SSP                                       5A103600
.ISTA  BSS     1              STA                                       5A103700
.ISTD  BSS     1              STD                                       5A103800
.ISTI  BSS     1              STI                                       5A103900
.ISTL  BSS     1              STL                                       5A104000
.ISTO  BSS     1              STO                                       5A104100
.ISTQ  BSS     1              STQ                                       5A104200
.ISTZ  BSS     1              STZ                                       5A104300
.ISUB  BSS     1              SUB                                       5A104400
.ISXA  BSS     1              SXA                                       5A104500
.ISXD  BSS     1              SXD                                       5A104600
.ITLQ  BSS     1              TLQ                                       5A104700
.ITMI  BSS     1              TMI                                       5A104800
.ITNZ  BSS     1              TNZ                                       5A104900
.ITPL  BSS     1              TPL                                       5A105000
.ITQP  BSS     1              TQP                                       5A105100
.ITRA  BSS     1              TRA                                       5A105200
.ITSX  BSS     1              TSX                                       5A105300
.ITXH  BSS     1              TXH                                       5A105400
.ITXI  BSS     1              TXI                                       5A105500
.ITXL  BSS     1              TXL                                       5A105600
.ITZE  BSS     1              TZE                                       5A105700
.IUFA  BSS     1              UFA                                       5A105800
.IVLM  BSS     1              VLM                                       5A105900
.IXCA  BSS     1              XCA                                       5A106000
.IXCL  BSS     1              XCL                                       5A106100
.IXEC  BSS     1              XEC                                       5A106200
.IZAC  BSS     1              ZAC                                       5A106300
.IZET  BSS     1              ZET                                       5A106400
.IMZE  BSS     1              MZE                                       5A106500
.ITIX  BSS     1              TIX                                       5A106600
.INOP  BSS     1              NOP                                       5A106700
.ICOM  BSS     1              COM                                       5A106800
       BSS     5              EXPANSION SPACE.                          5A106900
.IBGMC SYN     .IM94B         BEGINNING OF MACRO OPCODE DEFINITIONS.    5A107000
.IM94B NULL                   BEGINNING OF 7094 MACROS.                 5A107100
       REM                                                              5A107200
       REM     DEFINITION OF 7094 MACRO OP CODES.                       5A107300
       REM                    OPERATION SIMULATED-                      5A107400
.IDFAN BSS     1              DFAD  NAME  OR  DFAD  **                  5A107500
.IDFAT BSS     1              DFAD  NAME,T  OR  DFAD  **,T              5A107600
.IDFDN BSS     1              DFDP  NAME  OR  DFDP  **                  5A107700
.IDFDT BSS     1              DFDP  NAME,T  OR  DFDP  **,T              5A107800
.IDFMN BSS     1              DFMP  NAME  OR  DFMP  **                  5A107900
.IDFMT BSS     1              DFMP  NAME,T  OR  DFMP  **,T              5A108000
.IDFSN BSS     1              DFSB  NAME  OR  DFSB  **                  5A108100
.IDFST BSS     1              DFSB  NAME,T  OR  DFSB  **,T              5A108200
.IDLDN BSS     1              DLD   NAME  OR  DLD   **                  5A108300
.IDLDT BSS     1              DLD   NAME,T  OR  DLD   **,T              5A108400
.IDSTN BSS     1              DST   NAME  OR  DST   **                  5A108500
.IDSTT BSS     1              DST   NAME,T  OR  DST   **,T              5A108600
.IFSCA BSS     1              SCA   NAME,T                              5A108700
       BSS     4              EXPANSION SPACE.                          5A108800
.IMFUB NULL                   BEGINNING OF BUILT-IN FUNCTIONS.          5A108900
       REM                                                              5A109000
       REM     DEFINITION OF MACRO OPCODES FOR BUILT-IN FUNCTIONS.      5A109100
       REM                    FUNCTION NAME-                            5A109200
.IMABS BSS     1              ABS                                       5A109300
.IMIAB BSS     1              IABS                                      5A109400
.IMAIN BSS     1              AINT                                      5A109500
.IMINT BSS     1              INT                                       5A109600
.IMAMO BSS     1              AMOD                                      5A109700
.IMMOD BSS     1              MOD                                       5A109800
.IMAX0 BSS     1              AMAX0                                     5A109900
.IMAX1 BSS     1              AMAX1                                     5A110000
.IMMX0 BSS     1              MAX0                                      5A110100
.IMMX1 BSS     1              MAX1                                      5A110200
.IMAN0 BSS     1              AMIN0                                     5A110300
.IMAN1 BSS     1              AMIN1                                     5A110400
.IMMN0 BSS     1              MIN0                                      5A110500
.IMMN1 BSS     1              MIN1                                      5A110600
.IMFLO BSS     1              FLOAT                                     5A110700
.IMFIX BSS     1              IFIX                                      5A110800
.IMSIG BSS     1              SIGN                                      5A110900
.IMISG BSS     1              ISIGN                                     5A111000
.IMDIM BSS     1              DIM                                       5A111100
.IMIDM BSS     1              IDIM                                      5A111200
.IMSGL BSS     1              SNGL                                      5A111300
.IMREA BSS     1              REAL                                      5A111400
.IMIMG BSS     1              AIMAG                                     5A111500
.IMDAB BSS     1              DABS                                      5A111600
.IMDX1 BSS     1              DMAX1                                     5A111700
.IMDN1 BSS     1              DMDN1                                     5A111800
.IMDIN BSS     1              IDINT                                     5A111900
.IMDSG BSS     1              DSIGN                                     5A112000
.IMDBL BSS     1              DBLE                                      5A112100
.IMCPX BSS     1              CMPLX                                     5A112200
.IMCON BSS     1              CONJG                                     5A112300
.IMAND BSS     1              AND                                       5A112400
.IMOR  BSS     1              OR                                        5A112500
.IMCOM BSS     1              COM                                       5A112600
.IMBOL BSS     1              BOOL                                      5A112700
.IMSFL BSS     1              SPECIAL FLOAT                             5A112800
.IMSFX BSS     1              SPECIAL IFIX                              5A112900
.IMSDN BSS     1              SPECIAL IDINT                             5A113000
       BSS     19             EXPANSION SPACE.                          5A113100
.IMGPB NULL                   BEGINNING OF GENERAL-PURPOSE MACROS.      5A113200
       REM                                                              5A113300
       REM     DEFINITION OF GENERAL-PURPOSE MACROS.                    5A113400
       REM                    EXPANDS TO-                               5A113500
.ICALL BSS     1              TSX  NAME,4                               5A113600
       REM                    TXI  *+2+N+M,,N                           5A113700
       REM                    PZE  ID,,LK.DR                            5A113800
.IRTNC BSS     1              AXT  N,4    (IF N IS NOT ZERO)            5A113900
       REM                    SXD  SAVE,4 (IF N IS NOT ZERO)            5A114000
       REM                    TRA  SAVE+1                               5A114100
.IRTNV BSS     1              LXA  NAME,4                               5A114200
       REM                    SXD  SAVE,4                               5A114300
       REM                    TRA  SAVE+1                               5A114400
.IATXS BSS     1              AXT  **,T                                 5A114500
       REM                    TXI  *+1,T,N  OR  TXI  *+1,T,**           5A114600
       REM                    SXA  *-2,T                                5A114700
.ICAAN BSS     1              STQ  E.1                                  5A114800
       REM                    FAD  NAME                                 5A114900
       REM                    STO  E.2                                  5A115000
       REM                    CLA  E.1                                  5A115100
       REM                    FAD  NAME+1                               5A115200
       REM                    XCA                                       5A115300
       REM                    CLA  E.2                                  5A115400
.ICAAT BSS     1              STQ  E.1                                  5A115500
       REM                    FAD  NAME,T                               5A115600
       REM                    STO  E.2                                  5A115700
       REM                    CLA  E.1                                  5A115800
       REM                    FAD  NAME+1,T                             5A115900
       REM                    XCA                                       5A116000
       REM                    CLA  E.2                                  5A116100
.ICAIN BSS     1              NOP  **                                   5A116200
       REM                    SXA  *+9,4                                5A116300
       REM                    LAC  *-2,4                                5A116400
       REM                    STQ  E.1                                  5A116500
       REM                    FAD  0,4                                  5A116600
       REM                    STO  E.2                                  5A116700
       REM                    CLA  E.1                                  5A116800
       REM                    FAD  1,4                                  5A116900
       REM                    XCA                                       5A117000
       REM                    CLA  E.2                                  5A117100
       REM                    AXT  **,4                                 5A117200
.ICAIT BSS     1              NOP  **,T                                 5A117300
       REM                    STQ  E.1                                  5A117400
       REM                    FAD* *-2                                  5A117500
       REM                    STO  E.2                                  5A117600
       REM                    CLA  E.1                                  5A117700
       REM                    TXI  *+1,T,-1                             5A117800
       REM                    FAD* *-6                                  5A117900
       REM                    TXI  *+1,T,1                              5A118000
       REM                    XCA                                       5A118100
       REM                    CLA  E.2                                  5A118200
.ICSAN BSS     1              STQ  E.1                                  5A118300
       REM                    FSB  NAME                                 5A118400
       REM                    STO  E.2                                  5A118500
       REM                    CLA  E.1                                  5A118600
       REM                    FSB  NAME+1                               5A118700
       REM                    XCA                                       5A118800
       REM                    CLA  E.2                                  5A118900
.ICSAT BSS     1              STQ  E.1                                  5A119000
       REM                    FSB  NAME,T                               5A119100
       REM                    STO  E.2                                  5A119200
       REM                    CLA  E.1                                  5A119300
       REM                    FSB  NAME+1,T                             5A119400
       REM                    XCA                                       5A119500
       REM                    CLA  E.2                                  5A119600
.ICSIN BSS     1              NOP  **                                   5A119700
       REM                    SXA  *+9,4                                5A119800
       REM                    LAC  *-2,4                                5A119900
       REM                    STQ  E.1                                  5A120000
       REM                    FSB  0,4                                  5A120100
       REM                    STO  E.2                                  5A120200
       REM                    CLA  E.1                                  5A120300
       REM                    FSB  1,4                                  5A120400
       REM                    XCA                                       5A120500
       REM                    CLA  E.2                                  5A120600
       REM                    AXT  **,4                                 5A120700
.ICSIT BSS     1              NOP  **,T                                 5A120800
       REM                    STQ  E.1                                  5A120900
       REM                    FSB* *-2                                  5A121000
       REM                    STO  E.2                                  5A121100
       REM                    CLA  E.1                                  5A121200
       REM                    TXI  *+1,T,-1                             5A121300
       REM                    FSB* *-6                                  5A121400
       REM                    TXI  *+1,T,1                              5A121500
       REM                    XCA                                       5A121600
       REM                    CLA  E.2                                  5A121700
       REM                                                              5A121800
.IDNAN BSS     1              DFAD  NAME                                5A121900
.IDNAT BSS     1              DFAD  NAME,T                              5A122000
.IDNDN BSS     1              DFDP  NAME                                5A122100
.IDNDT BSS     1              DFDP  NAME,T                              5A122200
.IDNMN BSS     1              DFMP  NAME                                5A122300
.IDNMT BSS     1              DFMP  NAME,T                              5A122400
.IDNSN BSS     1              DFSB  NAME                                5A122500
.IDNST BSS     1              DFSB  NAME,T                              5A122600
.IDNLN BSS     1              DLD   NAME                                5A122700
.IDNLT BSS     1              DLD   NAME,T                              5A122800
.IDNPN BSS     1              DST   NAME                                5A122900
.IDNPT BSS     1              DST   NAME,T                              5A123000
       REM     *********************************************************5A123100
       REM     .........................................................5A123200
       REM                                                              5A123300
       REM                    DEFINITIONS OF TABLE REFERENCE SYMBOLS.   5A123400
       SPACE   1                                                        5A123500
       REM                    NAME TABLE SYMBOLS.                       5A123600
       SPACE   1                                                        5A123700
.VNEPR EQU     0              NEXT ENTRY POINTER WORD.                  5A123800
.VNAME EQU     1              SYMBOL WORD.                              5A123900
.VFLAG EQU     2              SYMBOL DESCRIPTION FLAG WORD.             5A124000
.VALUE EQU     3              DIMENSION POINTER, LOCATION VALUE, ETC.   5A124100
       SPACE   1                                                        5A124200
       REM                    EFN TABLE.                                5A124300
       SPACE   1                                                        5A124400
.VEFNW EQU     1              EFN WORD.                                 5A124500
       REM     .........................................................5A124600
       SPACE   5                                                        5A124700
       REM                    .XWORD FLAG BIT DEFINITIONS               5A124800
       REM                    BETTER KNOWN AS $IBFTC CARD OPTIONS.      5A124900
       SPACE   1                                                        5A125000
CCM90  RBOOL   000040         BIT ON INDICATES 90 MODE.                 5A125100
CCM94  RBOOL   000100         BIT ON INDICATES 94 MODEL 1 MODE.         5A125200
CCM942 RBOOL   000200         BIT ON INDICATES 94 MODEL 2 MODE.         5A125300
CCLIST RBOOL   000400         BIT ON INDICATES 3 COLUMN LIST.           5A125400
CCDECK RBOOL   002000         BIT ON INDICATES BINARY DECK TO BE PUNCHED5A125500
CCFLS  LBOOL   000004         BIT ON INDICATES FULIST (1 COLUMN).       5A125600
CCSDD  LBOOL   000020         BIT ON INDICATES SHORT DEBUG DICTIONARY.  5A125700
CCCDD  LBOOL   000040         BIT ON INDICATES LONG DEBUG DICTIONARY.   5A125800
       SPACE   4                                                        5A125900
       REM                   DEFINITIONS OF EFN TABLE FLAGS.            5A126000
       SPACE   3                                                        5A126100
.EFASN LBOOL   400000         IF ON, EFN REFERENCED BY AN ASSIGN STAT.  5A126200
.EFORT LBOOL   200000         IF ON, EFN APPEARED ON A FORMAT STAT.     5A126300
.EFGOD LBOOL   100000         IF ON, EFN IS THE DESTINATION OF A TRANSFR5A126400
.EFDOE RBOOL   400000         IF ON, EFN IS A DO ENDING.                5A126500
.EFTRF RBOOL   200000         IF ON, EFN HAS BEEN USED AS A FORMAT      5A126600
       REM                    REFERENCE IN A READ OR WRITE STATEMENT.   5A126700
.EFTRA RBOOL   100000         IF ON, THIS EXECUTABLE STATEMENT          5A126800
       REM                    IMMEDIATELY FOLLOWS A TRANSFER STATEMENT. 5A126900
       SPACE   5                                                        5A127000
       REM                   VALUES FOR EFN TABLE FLAGS.                5A127100
       SPACE   3                                                        5A127200
.EVASN EQU     .C4PFX         IF ON, EFN REFERENCED BY AN ASSIGN STAT.  5A127300
.EVORT EQU     .C2PFX         IF ON, EFN APPEARED ON A FORMAT STAT.     5A127400
.EVGOD EQU     .C1PFX         IF ON, EFN IS THE DESTINATION OF A TRANSFR5A127500
.EVDOE EQU     .C4TAG         IF ON, EFN IS A DO ENDING.                5A127600
.EVTRF EQU     .C2TAG         IF ON, EFN HAS BEEN USED AS A FORMAT      5A127700
       REM                    REFERENCE IN A READ OR WRITE STATEMENT.   5A127800
.EVTRA EQU     .C1TAG         IF ON, THIS EXECUTABLE STATEMENT          5A127900
       REM                    IMMEDIATELY FOLLOWS A TRANSFER STATEMENT. 5A128000
       SPACE   5                                                        5A128100
*      DEFINITION OF COMMUNICATION CELLS WITHIN THE FORCOM BLOCK.       5A128200
       SPACE   2                                                        5A128300
       ORG     O.FCOM                                                   5A128400
.XDCKN BSS     1              DECK NAME IN BCI.                         5A128500
.XRANK BSS     1              PHASE (SEQUENCE) OF THIS PROGRAM IN BATCH.5A128600
.XWORD BSS     1              OPTIONS FROM $IBFTC CARD.                 5A128700
.XNXRS BSS     1              NO. OF XRS ON IBFTC CARD, NO. OF XRS USED.5A128800
.XLEVL BSS     1              SOURCE ERROR LEVEL,,MACHINE ERROR LEVEL.  5A128900
.XNSTR BSS     1              NON-ZERO IF THERE ARE NON-STANDARD RETURNS5A129000
.XCSCT BSS     1              COUNT OF CONTROL SECTIONS IN PROGRAM.     5A129100
.XBSCT BSS     1              CONTROL SECTION BIT COUNT +1.             5A129200
UIIFN  BSS     1              CURRENT VALUE OF IFN BEING GENERATED      5A129300
       REM                                                              5A129400
       REM                    INTERPHASE CELLS                          5A129500
       REM                                                              5A129600
RCE.1  BSS     1              CONTAINS POINTER TO ERASABLE TABLE ENTRY  5A129700
DOXRS  BSS     1              NUMBER OF XRS USED - 1.                   5A129800
.XCM90 BSS     1              NON-ZERO FOR 90 MODE.                     5A129900
RCTTF  BSS     1              PTR TO FIRST TTF ENTRY, SET BY DO INDEXER.5A130000
.DPIS. BSS     1              DOUBLE PRECISION ERASABLE REQUIRED FLAG.  5A130100
.MCSW. BSS     1              MACRO CONSTANTS REQUIRED FLAG.            5A130200
CMXCS  BSS     1              ON IF BLANK COMMON HAS BEEN COUNTED       5A130300
       REM                    AS A CONTROL SECTION.                     5A130400
FNCSW  BSS     1              FUNCTION SUBPROGRAM SWITCH FOR ENTRY PROC.5A130500
SUBSW  BSS     1              SUBROUT. SUBPROGRAM SWITCH FOR ENTRY PROC.5A130600
       SPACE   1                                                        5A130700
       REM                                                              5A130800
       REM                    PHASE A-B COMMON CELLS                    5A130900
       REM                                                              5A131000
       REM                    CONSTANT TABLE POINTERS                   5A131100
.ZERO  BSS     1              REAL ZERO.                                5A131200
.ONE   BSS     1              INTEGER ONE.                              5A131300
.TRUE. BSS     1              LOGICAL .TRUE.                            5A131400
.FALSE BSS     1              LOGICAL .FALSE.                           5A131500
DGCON  BSS     1              NO. OF PHASE A DIAGS FOR THIS COMPILATION 5A131600
       EJECT                                                            5A131700
       ORG     O.CONS                                                   5A131800
       REM                    FCC                                       5A131900
       REM                                                              5A132000
       REM                                                              5A132100
       REM                                                              5A132200
       REM                                                              5A132300
       SPACE   2                                                        5A132400
       REM                                                              5A132500
       REM                    FCC COMMON CELLS                          5A132600
       REM                                                              5A132700
XC.RK  BSS     1              RANK OF THIS PROGRAM.                     5A132800
XCPGN  PZE     **             POINTER TO PROGRAM NAME IN CONDIG.        5A132900
XCFTC  PZE     **             IF NON-ZERO, $IBFTC CARD ENCOUNTERED.     5A133000
OCPHAF PZE     O.PHAF         POINTER TO BEGINNING OF CONDIG IN PHASE A.5A133100
OCPHBF PZE     O.PHBF         POINTER TO START OF FREE SPACE IN PHASE B.5A133200
CONDIG PZE     0,0,0          CURRENT PROGRAM IN PROCESS,,TOP OF        5A133300
       REM                    CONDIG                                    5A133400
       PZE     0,0,0          NEXT AVAILABLE LOCATION IN CONDIG.        5A133500
FCPHAS BSS     1              ONE IF PHASE A, TWO IF PHASE B, THREE     5A133600
       REM                    IF DIAGNOSTIC.                            5A133700
DGPER  BSS     1              HIGHEST ERROR LEVEL (FOR IBJOB).          5A133800
.PHING PZE     **             ZERO IF PHASING WANTED, NON-ZERO          5A133900
XB.RK  BSS     1              NUMBER OF ASSEMBLIES CELL.                5A134000
       REM                    OTHERWISE.                                5A134100
OCPHBE PZE     O.PHBF         POINTER TO BEGINNING OF CONDIG IN PHASE B.5A134200
FC3FL  PZE     **,4,**        FILE CONTROL BLOCK                        5A134300
       OCT     025000000000   FOR                                       5A134400
       PZE     **,,**         THIRD                                     5A134500
       PZE     **,,**         FILE.                                     5A134600
       PZE     FC.00,,**                                                5A134700
       PZE     **,,**                                                   5A134800
       PZE     **                                                       5A134900
       PZE     **                                                       5A135000
       BCI     3, IBFTC SPILL                                           5A135100
       PZE                                                              5A135200
FC.00  SYN     .CZERO                                                   5A135300
       SPACE   5                                                        5A135400
       REM                    PHASE A-B                                 5A135500
       REM                                                              5A135600
       REM                                                              5A135700
       REM                                                              5A135800
       REM                                                              5A135900
       SPACE   5                                                        5A136000
       REM                                                              5A136100
       REM                    BCI COLLECTOR CELLS                       5A136200
       REM                                                              5A136300
       REM                    BCI COLLECTOR INFORMATION AND             5A136400
       REM                    OUTPUT AREA.                              5A136500
       SPACE   1                                                        5A136600
.BASEP BSS     1              BASE CHARACTER,,BASE WORD (2'S COMP).     5A136700
.LASTP BSS     1              NICHTS,,LOCATION OF END MARK              5A136800
.CRNTP BSS     1              CURRENT CHARACTER,,CURRENT WORD (2'S COMP)5A136900
.INCHR BSS     1              REMAINING INPUT CHARACTERS.               5A137000
.CONAC BSS     1              CONTENTS OF AC WHEN A SAVE IS EXECUTED.   5A137100
.DLMTR BSS     1              DELIMITER.                                5A137200
.OUTFG BSS     1              SYMBOL CHAR. COUNT,,TYPE                  5A137300
.OUTCH BSS     1              OUTPUT CHARACTERS OR CONSTANT.            5A137400
       BSS     1              CONTINUATION OF OUTCH.                    5A137500
       BSS     1              SAME.                                     5A137600
       SPACE   3                                                        5A137700
FREGB  BSS     11*20          BEGINNING OF 'F' REGION                   5A137800
FREGE  BSS     1              END OF 'F'REGION                          5A137900
       SPACE   3                                                        5A138000
       REM                    BCI COLLECTOR SCAN TABLE                  5A138100
       REM                                                              5A138200
.BCCTB VFD     H6/0,24/0,6/BCNUM       0                                5A138300
       VFD     H6/1,24/0,6/BCNUM       1                                5A138400
       VFD     H6/2,24/0,6/BCNUM       2                                5A138500
       VFD     H6/3,24/0,6/BCNUM       3                                5A138600
       VFD     H6/4,24/0,6/BCNUM       4                                5A138700
       VFD     H6/5,24/0,6/BCNUM       5                                5A138800
       VFD     H6/6,24/0,6/BCNUM       6                                5A138900
       VFD     H6/7,24/0,6/BCNUM       7                                5A139000
       VFD     H6/8,24/0,6/BCNUM       8                                5A139100
       VFD     H6/9,24/0,6/BCNUM       9                                5A139200
       VFD     H18/012,12/0,6/BCILL    ILLEGAL, 12 OCTAL.               5A139300
       VFD     3/0,15/.CEQLS,12/0,6/BCSPN  =                            5A139400
       VFD     3/0,15/.CAPOS,12/0,6/BCPUN  '                            5A139500
       VFD     H18/015,12/0,6/BCILL    ILLEGAL, 15 OCTAL.               5A139600
       VFD     H18/016,12/0,6/BCILL    ILLEGAL, 16 OCTAL.               5A139700
       VFD     H18/017,12/0,6/BCILL    ILLEGAL, 17 OCTAL.               5A139800
       VFD     3/0,15/.CPLUS,12/0,6/BCPUN  +                            5A139900
       VFD     H6/A,24/0,6/BCALP       A                                5A140000
       VFD     H6/B,24/0,6/BCALP       B                                5A140100
       VFD     H6/C,24/0,6/BCALP       C                                5A140200
       VFD     H6/D,24/0,6/BCALP       D                                5A140300
       VFD     H6/E,24/0,6/BCALP       E                                5A140400
       VFD     H6/F,24/0,6/BCALP       F                                5A140500
       VFD     H6/G,24/0,6/BCALP       G                                5A140600
       VFD     H6/H,24/0,6/BCSAP       H                                5A140700
       VFD     H6/I,24/0,6/BCALP       I                                5A140800
       VFD     H18/032,12/0,6/BCILL    ILLEGAL, 32 OCTAL, PLUS ZERO.    5A140900
       VFD     3/0,15/.CPINT,12/0,6/BCPUN  .                            5A141000
       VFD     3/0,15/.CRPRN,12/0,6/BCSPN  )                            5A141100
       VFD     H18/035,12/0,6/BCILL    ILLEGAL, 35 OCTAL.               5A141200
       VFD     H18/036,12/0,6/BCILL    ILLEGAL, 36 OCTAL.               5A141300
       VFD     H18/037,12/0,6/BCILL    ILLEGAL, 37 OCTAL.               5A141400
       VFD     3/0,15/.CMINS,12/0,6/BCPUN  -                            5A141500
       VFD     H6/J,24/0,6/BCALP       J                                5A141600
       VFD     H6/K,24/0,6/BCALP       K                                5A141700
       VFD     H6/L,24/0,6/BCALP       L                                5A141800
       VFD     H6/M,24/0,6/BCALP       M                                5A141900
       VFD     H6/N,24/0,6/BCALP       N                                5A142000
       VFD     H6/O,24/0,6/BCALP       O                                5A142100
       VFD     H6/P,24/0,6/BCALP       P                                5A142200
       VFD     H6/Q,24/0,6/BCALP       Q                                5A142300
       VFD     H6/R,24/0,6/BCALP       R                                5A142400
       VFD     H18/052,12/0,6/BCILL    ILLEGAL, 52 OCTAL, MINUS ZERO.   5A142500
       VFD     3/0,15/.CDOLR,12/0,6/BCPUN  $                            5A142600
       VFD     3/0,15/.CSTAR,12/0,6/BCPUN  *                            5A142700
       VFD     H18/055,12/0,6/BCILL    ILLEGAL, 55 OCTAL.               5A142800
       VFD     H18/056,12/0,6/BCILL    ILLEGAL, 56 OCTAL.               5A142900
       VFD     H18/057,12/0,6/BCILL    ILLEGAL, 57 OCTAL.               5A143000
       VFD     O6/0,24/0,6/BCBLK       BLANK                            5A143100
       VFD     3/0,15/.CSLSH,12/0,6/BCSPN  /                            5A143200
       VFD     H6/S,24/0,6/BCALP       S                                5A143300
       VFD     H6/T,24/0,6/BCALP       T                                5A143400
       VFD     H6/U,24/0,6/BCALP       U                                5A143500
       VFD     H6/V,24/0,6/BCALP       V                                5A143600
       VFD     H6/W,24/0,6/BCALP       W                                5A143700
       VFD     H6/X,24/0,6/BCSAP       X                                5A143800
       VFD     H6/Y,24/0,6/BCALP       Y                                5A143900
       VFD     H6/Z,24/0,6/BCALP       Z                                5A144000
       VFD     H18/072,12/0,6/BCILL    ILLEGAL, 72 OCTAL, RECORD MARK.  5A144100
       VFD     3/0,15/.CCOMA,12/0,6/BCSPN  ,                            5A144200
       VFD     3/0,15/.CLPRN,12/0,6/BCSPN  (                            5A144300
       VFD     H18/075,12/0,6/BCILL    ILLEGAL, 75 OCTAL.               5A144400
       VFD     H18/076,12/0,6/BCILL    ILLEGAL, 76 OCTAL.               5A144500
       VFD     3/0,15/.CENDM,12/0,6/BCEMK  END MARK, 77 OCTAL.          5A144600
       SPACE   2                                                        5A144700
.VARBL VFD     O18/.NVARN+.NEXPT,O18/.NACTV  VAR. USAGE FLAGS           5A144800
       SPACE   5                                                        5A144900
XCFSW  NULL                                                             5A145000
.BCPLX BSS     1              IF NON-ZERO, BCI COLLECTOR LOOKS FOR CMPLX5A145100
.CDATA BSS     1              IF NON-ZERO, DATA LITERAL LIST SCAN       5A145200
CBFSW  BSS     1              IF NON-ZERO, FORMAT SCAN                  5A145300
       REM                    TABLE ROUTINES CELLS                      5A145400
DGMESS PZE     **             IF NON-ZERO, DIAG TABLE HAS OVERFLOWED.   5A145500
       REM                                                              5A145600
TRPTR  BSS     1              TR POINTER TO FIRST WORD OF ENTRY(2'S COM)5A145700
.NAMEP BSS     1              TRUE POINTER TO FLAG WORD OF NAME ENTRY.  5A145800
.NAMEC BSS     1              2'S COMP PTR TO FIRST WORD OF NAME ENTRY. 5A145900
.BNIFN BSS     1              TRUE POINTER TO IFN ENTRY,,VALUE OF IFN   5A146000
.BNEFN BSS     1              CURRENT EFN IF ANY.                       5A146100
       SPACE   2                                                        5A146200
RA.CEL BSS     1              ERASE ROUTINE INPUT CELL.                 5A146300
       REM                                                              5A146400
       REM                    SUBSCRIPT PROCESSOR CELLS                 5A146500
       REM                                                              5A146600
.DCELL BSS     1              COUNT OF D. CELLS ASSIGNED.               5A146700
SS.AT  BSS     1              NON-ZERO IF SUBSCRIPT SCAN CALLED BY ARITH5A146800
.SUBK. BSS     1              SUBAK POINTER FOR SUBSCRIPTED VARIABLE.   5A146900
.FRTG. BSS     1              FORTAG POINTER FOR SUBSCRIPTED VARIABLE.  5A147000
       BSS     2              FORTAG WORKING STORAGE.                   5A147100
SS.SA  BSS     1              IF ON, SUB. SCAN CALLED BY DATA PROCESSOR.5A147200
TR.LS  BSS     1                                                        5A147300
       BSS     2              EXPANSION SPACE.                          5A147400
       SPACE   5                                                        5A147500
       REM                    PHASE A                                   5A147600
       REM                                                              5A147700
       REM                                                              5A147800
O.SWTH SYN     *              ORIGIN FOR SWITCHES.                      5A147900
       REM                                                              5A148000
       REM                                                              5A148100
       SPACE   2                                                        5A148200
       REM                                                              5A148300
       REM                    PHASE A CONTROL CELLS                     5A148400
       REM                                                              5A148500
.XFXEM BSS     1              NON-ZERO IF THERE IS A COMPUTED GO TO.    5A148600
.DOEND BSS     1              NON-ZERO IF END OF DO NEST.               5A148700
XC.CR  BSS     1              FLAG WORD FOR CURRENT STATEMENT           5A148800
XCEIN  BSS     1              IF NON-ZERO, EOF OR $ CARD ENCOUNTERED.   5A148900
XCEND  BSS     1              NON-ZERO IF END CARD HAS BEEN PROCESSED.  5A149000
XC.EA  BSS     1              NON-ZERO IF AN ENTRY POINT ENCOUNTERED.   5A149100
XC.EX  BSS     1              NON-ZERO IF AN EXECUTABLE STATEMENT       5A149200
       REM                    HAS BEEN ENCOUNTERED.                     5A149300
XCFDO  BSS     1              NON-ZERO IF A DO HAS BEEN ENCOUNTERED.    5A149400
DOSKP  BSS     1              NON-ZERO, IGNORE DO PUSH DOWN AND NEST.   5A149500
XC.LG  BSS     1              FALSE EFN POINTER FOR LOGICAL IF.         5A149600
XC.IF  BSS     1              NON-ZERO WHEN AN IF IS IN PROCESS.        5A149700
XC.IL  BSS     1              NON-ZERO WHEN LOGICAL IF IN PROCESS.      5A149800
XC.CL  BSS     1              NON-ZERO INDICATES TO ARITHMETIC TRANSLAT.5A149900
       REM                    THAT IT HAS BEEN CALLED BY THE CALL PROC. 5A150000
       REM                    UPON RETURN TO CALL PROC., THE WORD IS    5A150100
       REM                    SET TO ZERO IF THERE ARE NO NON-STANDARD  5A150200
       REM                    RETURNS OR THE DECREMENT HAS THE COUNT    5A150300
       REM                    OF RETURNS AND THE ADDRESS THE IFN POINTER5A150400
       SPACE   2                                                        5A150500
       REM                                                              5A150600
       REM                    ARITHMETIC TRANSLATOR COMMUNICATIONS CELLS5A150700
       REM                                                              5A150800
AR.ER  BSS     1              NON-ZERO IF ARITHMETIC ERROR.             5A150900
AR.NL  BSS     1              NO LEFT OF EQUALS FLAG FOR ARITH. TRANS.  5A151000
       SPACE   2                                                        5A151100
       REM                                                              5A151200
       REM                    DO NEST COMMUNICATIONS CELLS              5A151300
       REM                                                              5A151400
DOEFN  BSS     1              TEMPORARY EFN CELL FOR DOPUSH DOWN LIST.  5A151500
DOA1   BSS     1              TEMPORARY STORAGE CELL FOR                5A151600
DOA2   BSS     1              DO PARAMETERS.                            5A151700
DOA3   BSS     1              X                                         5A151800
DOA4   BSS     1              X                                         5A151900
DOIMP  BSS     1              IMPLIED DO FLAG FOR DO SCANNER.           5A152000
DOFTG  BSS     1              NOTEQ FROM FORTAG FOR DO NEST.            5A152100
DOFOV  BSS     1              NOTEQ FROM FORVAL FOR DO NEST.            5A152200
.CADIF BSS     1              NON-ZERO IF DO FORVAR CONDITION EXISTS.   5A152300
.DOIND BSS     1              DO INDEX POINTER, OR ZERO IF NO ACTIVE DO.5A152400
.DOLPL BSS     1              COMPL PTR TO 1ST WORD OF LAST DO PDL ENTRY5A152500
.PNST1 BSS     1              NEST1 POINTER FOR CURRENT DO.             5A152600
       SPACE   2                                                        5A152700
       REM                                                              5A152800
       REM                    I/O LIST SCAN CELLS                       5A152900
       REM                                                              5A153000
WRRBN  BSS     1              NON-ZERO, BINARY IO LIST.                 5A153100
WRRIN  BSS     1              NON-ZERO, INPUT IO LIST.                  5A153200
XCENP  BSS     1              ENTRY STAT. SWITCH FOR FLOW TRACE.        5A153300
XC.LS  BSS     1              LAST STATEMENT FLAG WORD.                 5A153400
XC.ET  BSS     1              LAST EXECUTABLE STATEMENT FLAG WORD.      5A153500
WRRLP  BSS     1              SET NON-ZERO IF LEFT PARENTHESIS.         5A153600
IOCSS  BSS     1              IF ON, SUBSCRIPT SCAN CALLED.             5A153700
IOCHI  BSS     1              TPR CHAIN POINTER.                        5A153800
IOSGD  BSS     1              SECOND PASS POSSIBLE SWITCH.              5A153900
IOEQU  BSS     1              EQUAL SIGN SWITCH.                        5A154000
IOCMA  BSS     1              COMMA SWITCH.                             5A154100
IOPRN  BSS     1              PARENTHESIS COUNTER.                      5A154200
IOPTR  BSS     1              SAVE POINTER TO CREATE IIFS.              5A154300
IOVAR  BSS     1                                                        5A154400
IOCST  BSS     1                                                        5A154500
IOPCN  BSS     1              REDUNDANT COMMA SWITCH.                   5A154600
IC.G1  BSS     1              NUMBER OF PERMISSABLE IXRS IN TAG.        5A154700
EQWDF0 BSS     1                                                     (6)5A154701
DORAN  BSS     1              DO NEST RANGE CELL.                    (6)5A154702
NESKP  BSS     1              NESTAG SKIP SWITCH                     (9)5A154704
       SPACE   2                                                        5A154800
XCLSW  NULL                                                             5A154900
XCNSW  EQU     XCLSW-XCFSW                                              5A155000
       SPACE   5                                                        5A155100
       REM                    PHASE B                                   5A155200
       REM                                                              5A155300
       REM                                                              5A155400
       REM                                                              5A155500
       ORG     O.SWTH         SET ORIGIN OF PHASE B SWITCHES SO         5A155600
       REM                    THAT THEY OVERLAY THE PHASE A SWITCHES.   5A155700
       REM                                                              5A155800
       REM                                                              5A155900
       SPACE   2                                                        5A156000
       REM                    STORAGE ALLOCATION CELLS                  5A156100
       SPACE   2                                                        5A156200
XBFSW  NULL                                                             5A156300
DGPBD  BSS     1              IF NON-ZERO A DIAGNOSTIC HAS ALREADY      5A156400
       REM                    OCCURRED IN PHASE B.                      5A156500
SA.CC  BSS     1              CURRENT LOCATION COUNTER.                 5A156600
SA.OC  BSS     1              VALUE OF LOCATION COUNTER AFTER VARIABLES 5A156700
SA.TC  BSS     1              TOTAL LENGTH OF ALL COMMON BLOCKS+1       5A156800
SA.EQ  BSS     1              TOTAL LENGTH OF ALL NON-COMMON EQUIV. VAR.5A156900
SA.MI  BSS     1              ZERO=7090 OR 7094II  NON-ZERO=7094I       5A157000
SA.PI  BSS     1              ZERO IF SA.TC IS EVEN, NON-ZERO IF SA.TC  5A157100
       REM                     IS ODD                                   5A157200
SA.BD  BSS     1              NON-ZERO IF BLOCK DATA SUBPROGRAM.        5A157300
SA.LS  BSS     1              SA LOCATION SYMBOL.                       5A157400
SAMCC  BSS     1              SET ON WHEN COMMON VARIABLES GENERATED    5A157500
SAMDM  BSS     1              SET ON WHEN DIMENS VARIABLES GENERATED    5A157600
SAMDU  BSS     1              SET ON WHEN UNDIMENS VARIABLES GENERATED  5A157700
SAMHD  BSS     1              SET ON WHEN GENERATOR CALLED FIRST TIME   5A157800
SAMIS  BSS     1              SET ON WHEN EFN-IFN CORRESP GENERATED     5A157900
SAMPO  BSS     1              SET ON WHEN ENTRY POINTS ARE GENERATED    5A158000
SAMPS  BSS     1              SET ON WHEN EP/SC LINE IS GENERATED       5A158100
SAMSU  BSS     1              SET ON WHEN SUBR CALLED ARE GENERATED     5A158200
SAMZ4  BSS     1              SET ON WHEN TCM PTR SHOWS LAST VARIABLE   5A158300
       SPACE   5                                                        5A158400
       REM                    COMMON SWITCHES FOR ASSEMBLER.            5A158500
       SPACE   2                                                        5A158600
AMLCS  BSS     1              ASSEMBLY LOCATION COUNTER.                5A158700
ANMAN  BSS     1              NON-ZERO IF MAIN FILE (EXCEPT PROLOGUE)   5A158800
       REM                    HAS BEEN READ FROM MERGE INPUT.           5A158900
ANDON  BSS     1              NON-ZERO IF DOTAG FILE IS ENDED.          5A159000
       REM                    (SET BY ASSEMBLY MERGE)                   5A159100
AMNSW  BSS     1              NON-ZERO IF A NULL IS BEING ASSEMBLED.    5A159200
ANEST  BSS     1              NON-ZERO IF ASSEMBLING WITHIN A DO NEST.  5A159300
AA3LS  BSS     1              NON-ZERO IF 3-COLUMN LIST REQUESTED.      5A159400
APDOS  BSS     1              NON-ZERO IF A TAP ENTRY HAS BEEN MADE     5A159500
       REM                    WHICH CONTAINS A SUBAK POINTER OR         5A159600
       REM                    REQUIRES DECREMENT INITIALIZATION.        5A159700
AWENO  BSS     1              CONTAINS CONTROL SECT. NO. OF EACH ENTRY. 5A159800
LSIFN  BSS     1              CURRENT LOCATION SYMBOL, FOR LISTING.     5A159900
AMMAC  BSS     1              NON-ZERO IF ASSEMBLY INPUT IS A MACRO.    5A160000
AA.DP  BSS     1              NON-ZERO WHILE ASSEMBLING A DUP SEQUENCE. 5A160100
AANLS  BSS     1              NON-ZERO IF LISTING TEMPORARILY SUSPENDED.5A160200
AA.SF  BSS     1              NON-ZERO IF FIELD BEING ASSEMBLED IS      5A160300
       REM                    SHORT FORM COMPLEX.                       5A160400
AW.LF  BSS     1              NON-ZERO IF SENDING A LONG-FORM COMPLEX   5A160500
       REM                    WORD FOR LISTING.                         5A160600
AAT25  BSS     1              NON-ZERO IF USING IN-DO SYMAB IN ASSEMBLER5A160700
AWLC3  BSS     1              TR POINTER TO CURRENT POISTION IN         5A160800
       REM                    COLUMN THREE, CURRENT PAGE LIST TABLE     5A160900
       REM                    (TLA OR TLB) .                            5A161000
AWLC2  BSS     1              TR POINTER TO CURRENT POSITION IN         5A161100
       REM                    COLUMN TWO, CURRENT PAGE LIST TABLE       5A161200
       REM                    (TLA OR TLB).                             5A161300
AWLC1  BSS     1              TR POINTER TO CURRENT POSITION IN         5A161400
       REM                    COLUMN ONE, CURRENT PAGE LIST TABLE       5A161500
       REM                    (TLA OR TLB).                             5A161600
AWLCP  NULL                                                             5A161700
AWPC1  BSS     1              NON-ZERO IF COLUMN ONE IS INCOMPLETE,     5A161800
       REM                    WHEN LISTING LAST THREE COLUMN PAGE.      5A161900
AWPC2  BSS     1              NON-ZERO IF COLUMN TWO IS INCOMPLETE,     5A162000
       REM                    WHEN LISTING LAST THREE COLUMN PAGE.      5A162100
AWPC3  BSS     1              NON-ZERO IF COLUMN THREE IS INCOMPLETE,   5A162200
       REM                    WHEN LISTING LAST THREE COLUMN PAGE.      5A162300
AWLN3  BSS     1              TR POINTER TO BEGINNING OF COLUMN THREE   5A162400
       REM                    IN NEXT-PAGE TABLE.                       5A162500
AWLN2  BSS     1              TR POINTER TO BEGINNING OF COLUMN TWO     5A162600
       REM                   IN NEXT-PAGE TABLE.                        5A162700
AWLN1  BSS     1              TR POINTER TO BEGINNING OF COLUMN ONE     5A162800
       REM                    IN NEXT-PAGE TABLE.                       5A162900
AWLNP  BSS     1              ANY OF THE ABOVE THREE POINTERS,          5A163000
       REM                    TEMPORARILY.                              5A163100
AIFNM  BSS     1              CURRENT MAIN IFN (IF ZERO, NEXT NEEDED).  5A163200
AIFND  BSS     1              CURRENT DOTAG IFN (IF ZERO, NEXT NEEDED). 5A163300
AIFNT  BSS     1              CURRENT TTF IFN (IF ZERO, NEXT NEEDED).   5A163400
AIFNR  BSS     1              CURRENT TRC IFN (IF ZERO, NEXT NEEDED).   5A163500
APEND  BSS     1              NON-ZERO WHEN PROLOGUE GENERATION         5A163600
       REM                    ENCOUNTERS END OF SUBARG.                 5A163700
APDCR  BSS     1              NON-ZERO IF LAST ARGUMENT PROCESSED       5A163800
       REM                    WAS A DECREMENT ENTRY.                    5A163900
APSUB  BSS     1              NON-ZERO IF SAVE IS TO BE GENERATED       5A164000
       REM                    IN-LINE.                                  5A164100
       SPACE   2                                                        5A164200
AMIPT  BSS     1              TRUE POINTER TO FIRST WORD OF IIF         5A164300
.MFSW  BSS     1              IF ON, END OF COMP. FLAG READ IN MAINFILE.5A164400
.DTSW  BSS     1              IF ON, END OF COMP. FLAG READ IN DOTAG.   5A164500
RCSYM  BSS     1              POINTER TO FIRST WORD IN OUT OF DO SYMAB. 5A164600
SA.TR  BSS     1              NAME POINTER FOR FIRST ENTRY POINT.       5A164700
SA.ES  BSS     1              CONTROL-SECTION NO. OF LAST EVEN COMPILED.5A164800
SA.DC  BSS     1              S.A. CONTROL-DICTIONARY SECT NO COUNT.(10)5A164810
XBLSW  NULL                                                             5A164900
XBNSW  SYN     *-XBFSW                                                  5A165000
       SPACE   5                                                        5A165100
       BSS     3              EXPANSION SPACE.                      (10)5A165200
       SPACE   2                                                        5A165300
       REM                                                              5A165400
       REM     *********************************************************5A165500
       EJECT                                                            5A165600
       REM     *********************************************************5A165700
       REM                                                              5A165800
       REM                    DEFINITIONS OF NAME TABLE FLAGS.          5A165900
       REM                                                              5A166000
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A166100
       REM                                                              5A166200
       REM                    CLASS FIELD FLAGS (DEFINITIONS).          5A166300
       REM                                                              5A166400
.NVARN LBOOL   400000         IF ON, SYMBOL IS A VARIABLE NAME.         5A166500
.NROUT LBOOL   200000         IF ON, SYMBOL IS A ROUTINE NAME.          5A166600
.NCMBK LBOOL   100000         IF ON, SYMBOL IS A COMMON BLOCK NAME.     5A166700
.NSPNM LBOOL   040000         IF ON, SYMBOL IS THE NAME OF THIS PROGRAM.5A166800
.NTBNM LBOOL   020000         IF ON, SYMBOL IS A NAME LIST NAME.        5A166900
.NEXPT LBOOL   010000         IF ON, SYMBOL HAS BEEN EXPLICITY TYPED.   5A167000
.NDUMY LBOOL   004000         IF ON, SYMBOL IS ASF DUMMY ARGUMENT.   (5)5A167002
       REM                                                              5A167100
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A167200
       REM                                                              5A167300
       REM                    TYPE FIELD FLAGS (DEFINITIONS)            5A167400
       REM                                                              5A167500
.NOCTL LBOOL   000100         IF ON, SYMBOL OR CONSTANT IS OCTAL.       5A167600
.NALPH LBOOL   000040         IF ON, SYMBOL OR CONSTANT IS ALPHAMERIC.  5A167700
.NLOGL LBOOL   000020         IF ON, SYMBOL OR CONSTANT IS LOGICAL.     5A167800
.NCMLX LBOOL   000010         IF ON, SYMBOL OR CONSTANT IS COMPLEX.     5A167900
.NDBLP LBOOL   000004         IF ON, SYMBOL OR CONSTANT IS DOUBLE PREC. 5A168000
.NREAL LBOOL   000002         IF ON, SYMBOL OR CONSTANT IS REAL.        5A168100
.NINTG LBOOL   000001         IF ON, SYMBOL OR CONSTANT IS INTEGER.     5A168200
       REM                                                              5A168300
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A168400
       REM                                                              5A168500
       REM                    SUB-CLASS FIELD FLAGS (DEFINITIONS)       5A168600
       REM                                                              5A168700
.NENTY RBOOL   400000         IF ON, SYMBOL IS AN ENTRY POINT NAME.     5A168800
.NSARG RBOOL   200000         IF ON, SYMBOL IS AN ARG. TO THIS PROGRAM. 5A168900
       REM                                                              5A169000
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A169100
       REM                                                              5A169200
       REM                    DETAIL FIELD FLAGS FOR A VARIABLE (DEFS). 5A169300
       REM                                                              5A169400
.NARAY RBOOL   040000         IF ON, VARIABLE IS AN ARRAY NAME.         5A169500
.NADJD RBOOL   020000         IF ON, VARIABLE IS AN ADJUSTABLE DIM.     5A169600
.NACTV RBOOL   010000         IF ON, VARIABLE IS NOT JUST A DUMMY ARG.  5A169700
.NARAD RBOOL   004000         IF ON, ARRAY IS ADJUSTABLY DIMENSIONED.   5A169800
.NFRTY RBOOL   001000         IF ON, VARIABLE APPEARS ON THE LEFT OF    5A170000
       REM                           EQUAL, IN AN I/O INPUT LIST, OR    5A170100
       REM                           AS AN ARGUMENT TO A SUBPROGRAM.    5A170200
.NCMVR RBOOL   000400         IF ON, VARIABLE IS IN COMMON.             5A170300
.NEQVL RBOOL   000200         IF ON, VARIABLE IS EQUIVALENCED.          5A170400
.NREQV RBOOL   000100         IF ON, VARIABLE IS REPEATEDLY EQUIVALENCED5A170500
.NBLCM RBOOL   000040         IF ON, VARIABLE IS IN BLANK COMMON.       5A170600
.NCMST RBOOL   000020         IF ON, VARIABLE APPEARED IN COMMON STAT.  5A170700
       REM                                                              5A170800
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A170900
       REM                                                              5A171000
       REM                    DETAIL FIELD FLAGS FOR A ROUTINE (DEFS).  5A171100
       REM                                                              5A171200
.NASFN RBOOL   040000         IF ON, ROUTINE IS AN ASF.                 5A171300
.NSUBN RBOOL   020000         IF ON, ROUTINE IS A SUBROUTINE SUBPROGRAM.5A171400
.NFUNC RBOOL   010000         IF ON, ROUTINE IS A FUNCTION SUBPROGRAM.  5A171500
.NBULT RBOOL   004000         IF ON, ROUTINE IS A BUILT-IN FUNCTION.    5A171600
.NEXTN RBOOL   002000         IF ON, NAME APPEARED IN EXTERNAL STATEMENT5A171700
.NLIBF RBOOL   001000         IF ON, ROUTINE IS A LIBRARY SUBPROGRAM.   5A171800
.NCALL RBOOL   000400         IF ON, SYMBOL IS THE OBJECT OF A CALL.    5A171900
       REM                           AC LINKAGE FOR AN ARGUMENT.        5A172000
       REM                                                              5A172100
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A172200
       REM                                                              5A172300
       REM                    DETAIL FIELD FLAGS FOR A NAME LIST NAME.  5A172400
       REM                                                              5A172500
.NCIVR RBOOL   040000         IF ON, THERE ARE INTEGER VARIABLE(S)      5A172600
       REM                           IN THE LIST.                       5A172700
       REM                                                              5A172800
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A172900
       REM                                                              5A173000
       REM                    DEFINITIONS OF FLAGS IN THE FOURTH WORD   5A173100
       REM                    OF THE NAME TABLE.                        5A173200
       REM                                                              5A173300
.NDMPD LBOOL   100000         IF ON, DIMENSION PRODUCT COMPUTED.        5A173400
.NEQCE LBOOL   200000         IF ON, END OF PHASE A EQUIVALENCE CHAIN.  5A173500
.NSADT LBOOL   400000         IF ON, ADDRESS HAS STORAGE ALLOC. DATA.   5A173600
.NSFCA RBOOL   100000         IF ON, ADDRESS IS SHORT FORM COMPLEX.     5A173700
.NLFCP RBOOL   200000         IF ON, ADDRESS IS A POINTER TO A LONG     5A173800
       REM                           FORM COMPLEX ADDRESS TABLE.        5A173900
       SPACE   2                                                        5A174000
       REM                                                              5A174100
       REM     *********************************************************5A174200
       REM                                                              5A174300
       REM                                                              5A174400
       REM                                                              5A174500
       REM                    GENERAL FLAGS                             5A174600
       REM                                                              5A174700
       REM                                                              5A174800
.LBOL1 LBOOL   100000         ONE IN THE PREFIX                         5A174900
.LBOL2 LBOOL   200000         TWO IN THE PREFIX                         5A175000
.LBOL3 LBOOL   300000         THREE IN THE PREFIX                       5A175100
.LBOL4 LBOOL   400000         FOUR IN THE PREFIX                        5A175200
.LBOL5 LBOOL   500000         FIVE IN THE PREFIX                        5A175300
.LBOL6 LBOOL   600000         SIX IN THE PREFIX                         5A175400
.LBOL7 LBOOL   700000         SEVEN IN THE PREFIX                       5A175500
.RBOL1 RBOOL   100000         ONE IN THE TAG                            5A175600
.RBOL2 RBOOL   200000         TWO IN THE TAG                            5A175700
.RBOL3 RBOOL   300000         THREE IN THE TAG                          5A175800
.RBOL4 RBOOL   400000         FOUR IN THE TAG                           5A175900
.RBOL5 RBOOL   500000         FIVE IN THE TAG                           5A176000
.RBOL6 RBOOL   600000         SIX IN THE TAG                            5A176100
.RBOL7 RBOOL   700000         SEVEN IN THE TAG                          5A176200
       REM                                                              5A176300
       REM     *********************************************************5A176400
       EJECT                                                            5A176500
       REM     *********************************************************5A176600
       REM                                                              5A176700
       REM     IIF OPCODES                                              5A176800
       SPACE   2                                                        5A176900
       REM                    7090 MACHINE OP CODES                     5A177000
       SPACE   1                                                        5A177100
.FADD  PZE     0,,.IADD                ADD                              5A177200
.FALS  VFD     O18/.IABIN+.IALS,18/0   ALS                              5A177300
.FANA  VFD     O18/.IACON+.IANA,18/0   ANA                              5A177400
.FAXC  PZE     0,,.IAXC                AXC                              5A177500
.FAXT  PZE     0,,.IAXT                AXT                              5A177600
.FBCI  PZE     0,,.IBCI                BCI                              5A177700
.FBSS  PZE     0,,.IBSS                BSS                              5A177800
.FCAL  PZE     0,,.ICAL                CAL                              5A177900
.FCAS  PZE     0,,.ICAS                CAS                              5A178000
.FCHS  PZE     0,,.ICHS                CHS                              5A178100
.FCLA  PZE     0,,.ICLA                CLA                              5A178200
.FCLS  PZE     0,,.ICLS                CLS                              5A178300
.FDFAD PZE     0,,.IDFAD               DFAD                             5A178400
.FDFDP PZE     0,,.IDFDP               DFDP                             5A178500
.FDFMP PZE     0,,.IDFMP               DFMP                             5A178600
.FDFSB PZE     0,,.IDFSB               DFSB                             5A178700
.FDLD  PZE     0,,.IDLD                DLD                              5A178800
.FDST  PZE     0,,.IDST                DST                              5A178900
.FDUP  PZE     0,,.IDUP                DUP                              5A179000
.FDVP  PZE     0,,.IDVP                DVP                              5A179100
.FEVEN PZE     0,,.IEVEN               EVEN                             5A179200
.FFAD  PZE     0,,.IFAD                FAD                              5A179300
.FFDP  PZE     0,,.IFDP                FDP                              5A179400
.FFMP  PZE     0,,.IFMP                FMP                              5A179500
.FFSB  PZE     0,,.IFSB                FSB                              5A179600
.FHTR  PZE     0,,.IHTR                HTR                              5A179700
.FLAC  PZE     0,,.ILAC                LAC                              5A179800
.FLDC  PZE     0,,.ILDC                LDC                              5A179900
.FLDI  PZE     0,,.ILDI                LDI                              5A180000
.FLDQ  PZE     0,,.ILDQ                LDQ                              5A180100
.FLLS  VFD     O18/.IABIN+.ILLS,18/0   LLS                              5A180200
.FLMTM PZE     0,,.ILMTM               LMTM                             5A180300
.FLRS  VFD     O18/.IABIN+.ILRS,18/0   LRS                              5A180400
.FLXA  PZE     0,,.ILXA                LXA                              5A180500
.FMPY  PZE     0,,.IMPY                MPY                              5A180600
.FNULL PZE     0,,.INULL               NULL                             5A180700
.FNZT  PZE     0,,.INZT                NZT                              5A180800
.FOCT  PZE     0,,.IOCT                OCT                              5A180900
.FORA  PZE     0,,.IORA                ORA                              5A181000
.FORG  PZE     0,,.IORG                ORG                              5A181100
.FPAC  PZE     0,,.IPAC                PAC                              5A181200
.FPAX  PZE     0,,.IPAX                PAX                              5A181300
.FPXA  PZE     0,,.IPXA                PXA                              5A181400
.FPZE  PZE     0,,.IPZE                PZE                              5A181500
.FRQL  VFD     O18/.IABIN+.IRQL,18/0   RQL                              5A181600
.FSBM  PZE     0,,.ISBM                SBM                              5A181700
.FSCA  PZE     0,,.ISCA                SCA                              5A181800
.FSLW  PZE     0,,.ISLW                SLW                              5A181900
.FSSM  PZE     0,,.ISSM                SSM                              5A182000
.FSSP  PZE     0,,.ISSP                SSP                              5A182100
.FSTA  PZE     0,,.ISTA                STA                              5A182200
.FSTD  PZE     0,,.ISTD                STD                              5A182300
.FSTI  PZE     0,,.ISTI                STI                              5A182400
.FSTL  PZE     0,,.ISTL                STL                              5A182500
.FSTO  PZE     0,,.ISTO                STO                              5A182600
.FSTQ  PZE     0,,.ISTQ                STQ                              5A182700
.FSTZ  PZE     0,,.ISTZ                STZ                              5A182800
.FSUB  PZE     0,,.ISUB                SUB                              5A182900
.FSXA  PZE     0,,.ISXA                SXA                              5A183000
.FSXD  PZE     0,,.ISXD                SXD                              5A183100
.FTLQ  PZE     0,,.ITLQ                TLQ                              5A183200
.FTMI  PZE     0,,.ITMI                TMI                              5A183300
.FTNZ  PZE     0,,.ITNZ                TNZ                              5A183400
.FTPL  PZE     0,,.ITPL                TPL                              5A183500
.FTQP  PZE     0,,.ITQP                TQP                              5A183600
.FTRA  PZE     0,,.ITRA                TRA                              5A183700
.FTSX  PZE     0,,.ITSX                TSX                              5A183800
.FTXH  PZE     0,,.ITXH                TXH                              5A183900
.FTXI  PZE     0,,.ITXI                TXI                              5A184000
.FTXL  PZE     0,,.ITXL                TXL                              5A184100
.FTZE  PZE     0,,.ITZE                TZE                              5A184200
.FUFA  PZE     0,,.IUFA                UFA                              5A184300
.FVLM  PZE     0,,.IVLM                VLM                              5A184400
.FXCA  PZE     0,,.IXCA                XCA                              5A184500
.FXCL  PZE     0,,.IXCL       XCL                                       5A184600
.FXEC  PZE     0,,.IXEC       XEC                                       5A184700
.FZAC  PZE     0,,.IZAC                                                 5A184800
.FZET  PZE     0,,.IZET                ZET                              5A184900
.FMZE  PZE     0,,.IMZE                MZE                              5A185000
.FTIX  PZE     0,,.ITIX                TIX                              5A185100
.FNOP  PZE     0,,.INOP                NOP                              5A185200
.FCOM  PZE     0,,.ICOM                COM                              5A185300
       SPACE   2                                                        5A185400
       REM                    7094 MACRO OPCODES                        5A185500
       SPACE   1                                                        5A185600
.FDFAN PZE     0,,.IDFAN               DFAD                             5A185700
.FDFAT PZE     0,,.IDFAT               DFAD  TAG                        5A185800
.FDFDN PZE     0,,.IDFDN               DFDP                             5A185900
.FDFDT PZE     0,,.IDFDT               DFDP  TAG                        5A186000
.FDFMN PZE     0,,.IDFMN               DFMP                             5A186100
.FDFMT PZE     0,,.IDFMT               DFMP  TAG                        5A186200
.FDFSN PZE     0,,.IDFSN               DFSB                             5A186300
.FDFST PZE     0,,.IDFST               DFSB  TAG                        5A186400
.FDLDN PZE     0,,.IDLDN               DLD                              5A186500
.FDLDT PZE     0,,.IDLDT               DLD   TAG                        5A186600
.FDSTN PZE     0,,.IDSTN               DST                              5A186700
.FDSTT PZE     0,,.IDSTT               DST   TAG                        5A186800
.FFSCA PZE     0,,.IFSCA               SCA                              5A186900
       SPACE   2                                                        5A187000
.FMSFL PZE     0,,.IMSFL      SPECIAL FLOAT                             5A187100
.FMSFX PZE     0,,.IMSFX      SPECIAL FIX                               5A187200
.FMSDN PZE     0,,.IMSDN      SPECIAL IDINT                             5A187300
       SPACE   2                                                        5A187400
       REM                    OP CODES FOR GENERAL PURPOSE MACROS.      5A187500
       SPACE   1                                                        5A187600
.FCALL PZE     0,,.ICALL      CALL                                      5A187700
.FRTNC PZE     0,,.IRTNC      RETURN  CONSTANT                          5A187800
.FRTNV PZE     0,,.IRTNV      RETURN  VARIABLE                          5A187900
.FATXS PZE     0,,.IATXS      AXT, TXI, SXA                             5A188000
       SPACE   2                                                        5A188100
       REM                    COMPLEX ARITH. MACRO OP CODES             5A188200
       SPACE   1                                                        5A188300
.FCAAN PZE     0,,.ICAAN      CXAD  V                                   5A188400
.FCAAT PZE     0,,.ICAAT      CXAD  V,TAG                               5A188500
.FCAIN PZE     0,,.ICAIN      CXAD  **                                  5A188600
.FCAIT PZE     0,,.ICAIT      CXAD  **,TAG                              5A188700
.FCSAN PZE     0,,.ICSAN      CXSB  V                                   5A188800
.FCSAT PZE     0,,.ICSAT      CXSB  V,TAG                               5A188900
.FCSIN PZE     0,,.ICSIN      CXSB  **                                  5A189000
.FCSIT PZE     0,,.ICSIT      CXSB  **,TAG                              5A189100
.FDNAN PZE     0,,.IDNAN      DFAD NAME                                 5A189200
.FDNAT PZE     0,,.IDNAT      DFAD NAME TAG                             5A189300
.FDNDN PZE     0,,.IDNDN      DFDP NAME                                 5A189400
.FDNDT PZE     0,,.IDNDT      DFDP NAME TAG                             5A189500
.FDNMN PZE     0,,.IDNMN      DFMP NAME                                 5A189600
.FDNMT PZE     0,,.IDNMT      DFMP NAME TAG                             5A189700
.FDNSN PZE     0,,.IDNSN      DFSB NAME                                 5A189800
.FDNST PZE     0,,.IDNST      DFSB NAME TAG                             5A189900
.FDNLN PZE     0,,.IDNLN      DLD NAME                                  5A190000
.FDNLT PZE     0,,.IDNLT      DLD NAME TAG                              5A190100
.FDNPN PZE     0,,.IDNPN      DST NAME                                  5A190200
.FDNPT PZE     0,,.IDNPT      DST NAME TAG                              5A190300
       SPACE   2                                                        5A190400
       REM                                                              5A190500
       REM     *********************************************************5A190600
       EJECT                                                            5A190700
       REM     *********************************************************5A190800
       REM                                                              5A190900
       REM                    GENERAL ERASABLE                          5A191000
       REM                                                              5A191100
.ERPX1 PZE     0,,0           PREFIX                                    5A191200
.ERPX2 PZE     0,,0           PREFIX                                    5A191300
       REM                                                              5A191400
.ERDC1 PZE     0,,**          DECREMENT                                 5A191500
.ERDC2 PZE     0,,**          DECREMENT                                 5A191600
       REM                                                              5A191700
.ERTG1 PZE     0,**,0         TAG                                       5A191800
.ERTG2 PZE     0,**,0         TAG                                       5A191900
       REM                                                              5A192000
.ERAD1 PZE     **,,0          ADDRESS                                   5A192100
.ERAD2 PZE     **,,0          ADDRESS                                   5A192200
       REM                                                              5A192300
.ERFW1 ZERO    **             FULL WORD                                 5A192400
.ERFW2 ZERO    **             FULL WORD                                 5A192500
       REM                                                              5A192600
.ETMPL PZE     **,,15         ADDRESS ERASABLE,,LENGTH OF TEMP. ERASABLE5A192700
.ETMPE BSS     15             TEMPORARY ERASABLE BLOCK                  5A192800
.ETMPX NULL                   END OF TEMP. ERASABLE                     5A192900
       SPACE   5                                                        5A193000
       REM                    BULK ERASABLE STORAGE.                    5A193100
       SPACE   2                                                        5A193200
       REM                    BLOCK ONE                                 5A193300
O.CME1 BSS     65             ORIGIN FOR BLOCK 1 OF THE BULK ERASABLE.  5A193400
       REM                    BLOCK 1 IS USED BY THE ARITHMETIC         5A193500
       REM                    TRANSLATOR AND OTHER PROCESSORS.          5A193600
       SPACE   3                                                        5A193700
       REM                    BLOCK TWO                                 5A193800
O.CME2 BSS     50             ORIGIN FOR BLOCK2 OF THE BULK ERASABLE.   5A193900
       REM                    BLOCK 2 IS USED BY THE SUBSCRIPT          5A194000
       REM                    PROCESSOR DURING SCANS OF ARITHMETIC      5A194100
       REM                    STATEMENTS, I/O LISTS AND DATA STATEMENTS.5A194200
       REM                    IT IS AVAILABLE FOR USE BY OTHER ROUTINES 5A194300
       REM                    PROVIDED THAT THEY DO NOT USE THE         5A194400
       REM                    SUBSCRIPT PROCESSOR.                      5A194500
       REM                                                              5A194600
       REM     *********************************************************5A194700
       REM                                                              5A194800
       REM                    TABLE OF BLANKS                           5A194900
       REM                                                              5A195000
       REM                    BLANKS ARE RIGHT JUSTIFIED, LEADING ZEROS.5A195100
.CBLK6 BCI     1,             SIX BLANKS                                5A195200
.CBLK5 BCI     1,0            FIVE BLANKS                               5A195300
.CBLK4 BCI     1,00           FOUR BLANKS                               5A195400
.CBLK3 BCI     1,000          THREE BLANKS                              5A195500
.CBLK2 BCI     1,0000         TWO BLANKS                                5A195600
.CBLK1 BCI     1,00000        ONE BLANK                                 5A195700
.CBLK0 BCI     1,000000       NO BLANKS                                 5A195800
       REM                                                              5A195900
       REM     *********************************************************5A196000
       REM                                                              5A196100
       REM                    BCI COLLECTOR DELIMITER CODES AND TABLES. 5A196200
       REM                                                              5A196300
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A196400
       REM                                                              5A196500
       REM                    DEFINITIONS OF DELIMITER CODES.           5A196600
       REM                                                              5A196700
.CPLUS EQU     1              +  PLUS                                   5A196800
.CMINS EQU     2              -  MINUS                                  5A196900
.CSTAR EQU     3              *  STAR (ASTERISK, MULTIPLY)              5A197000
.CSLSH EQU     4              /  SLASH (DIVIDE, SEPARATOR)              5A197100
.CLPRN EQU     5              (  LEFT PARENTHESIS                       5A197200
.CRPRN EQU     6              )  RIGHT PARENTHESIS                      5A197300
.CEQLS EQU     7              =  EQUALS                                 5A197400
.CCOMA EQU     8              ,  COMMA                                  5A197500
.CPINT EQU     9              .  POINT (PERIOD)                         5A197600
.CAPOS EQU     10             '  APOSTROPHE                             5A197700
.CDOLR EQU     11             $  DOLLAR SIGN                            5A197800
.CENDM EQU     12             END MARK                                  5A197900
       REM                                                              5A198000
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A198100
       REM                                                              5A198200
       REM                    TABLE OF BINARY CODES FOR DELIMITERS.     5A198300
       REM                                                              5A198400
.BENDM PZE     0,,.CENDM      END MARK                                  5A198500
.BDOLR PZE     0,,.CDOLR      $                                         5A198600
.BAPOS PZE     0,,.CAPOS      '                                         5A198700
.BPINT PZE     0,,.CPINT      .                                         5A198800
.BCOMA PZE     0,,.CCOMA      ,                                         5A198900
.BEQLS PZE     0,,.CEQLS      =                                         5A199000
.BRPRN PZE     0,,.CRPRN      )                                         5A199100
.BLPRN PZE     0,,.CLPRN      (                                         5A199200
.BSLSH PZE     0,,.CSLSH      /                                         5A199300
.BSTAR PZE     0,,.CSTAR      *                                         5A199400
.BMINS PZE     0,,.CMINS      -                                         5A199500
.BPLUS PZE     0,,.CPLUS      +                                         5A199600
.BDLMT NULL                   TABLE REFERENCE POINT.                    5A199700
       REM                                                              5A199800
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A199900
       REM                                                              5A200000
       REM                    TABLE OF DECIMAL CODES FOR DELIMITERS.    5A200100
       REM                                                              5A200200
.DENDM BCI     1, 00000       END MARK                                  5A200300
.DDOLR BCI     1,$00000       DOLLAR SIGN                               5A200400
.DAPOS BCI     1,'00000       APOSTROPHE                                5A200500
.DPINT BCI     1,.00000       POINT                                     5A200600
.DCOMA BCI     1,,00000       COMMA                                     5A200700
.DEQLS BCI     1,=00000       EQUALS                                    5A200800
.DRPRN BCI     1,)00000       RIGHT PARENTHESIS                         5A200900
.DLPRN BCI     1,(00000       LEFT PARENTHESIS                          5A201000
.DSLSH BCI     1,/00000       SLASH                                     5A201100
.DSTAR BCI     1,*00000       STAR                                      5A201200
.DMINS BCI     1,-00000       MINUS                                     5A201300
.DPLUS BCI     1,+00000       PLUS                                      5A201400
.DDLMT NULL                   TABLE REFERENCE POINT.                    5A201500
       REM                                                              5A201600
       REM     *********************************************************5A201700
       EJECT                                                            5A201800
       REM     *********************************************************5A201900
       REM                                                              5A202000
       REM                    NUMERICAL CONSTANTS                       5A202100
       REM                                                              5A202200
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A202300
       REM                                                              5A202400
.CONES SEVEN   -1,7,-1        WORD OF ALL ONES                          5A202500
.CZERO PZE     0,,0           WORD OF ALL ZEROS                         5A202600
       REM                                                              5A202700
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A202800
       REM                                                              5A202900
.C1PFX ONE     0,,0           PREFIX OF 1                               5A203000
.C2PFX TWO     0,,0           PREFIX OF 2                               5A203100
.C3PFX THREE   0,,0           PREFIX OF 3                               5A203200
.C4PFX FOUR    0,,0           PREFIX OF 4                               5A203300
.C5PFX FIVE    0,,0           PREFIX OF 5                               5A203400
.C6PFX SIX     0,,0           PREFIX OF 6                               5A203500
.C7PFX SEVEN   0,,0           PREFIX OF 7                               5A203600
       REM                                                              5A203700
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A203800
       REM                                                              5A203900
.C1DEC EQU     .FADD          DECREMENT OF 1     OCTAL 1                5A204000
.C2DEC PZE     0,,2                        2           2                5A204100
.C3DEC PZE     0,,3                        3           3                5A204200
.C4DEC EQU     .FAXC                       4           4                5A204300
.C5DEC EQU     .FAXT          DECREMENT OF 5     OCTAL 5                5A204400
.C6DEC EQU     .FBCI                       6           6                5A204500
.C7DEC EQU     .FBSS                       7           7                5A204600
.C8DEC EQU     .FCAL                       8           10               5A204700
.C9DEC EQU     .FCAS                       9           11               5A204800
.C10DC EQU     .FCHS          DECREMENT OF 10   OCTAL 12                5A204900
.C11DC EQU     .FCLA                       11          13               5A205000
.C12DC EQU     .FCLS                       12          14               5A205100
.C13DC EQU     .FDFAD                      13          15               5A205200
.C14DC EQU     .FDFDP                      14          16               5A205300
.C15DC EQU     .FDFMP         DECREMENT OF 15    OCTAL 17               5A205400
.C16DC EQU     .FDFSB                      16          20               5A205500
.C17DC EQU     .FDLD                       17          21               5A205600
.C18DC EQU     .FDST                       18          22               5A205700
.C19DC EQU     .FDUP                       19          23               5A205800
.C20DC EQU     .FDVP          DECREMENT OF 20    OCTAL 24               5A205900
.C21DC EQU     .FEVEN                      21          25               5A206000
.C22DC EQU     .FFAD                       22          26               5A206100
.C23DC EQU     .FFDP                       23          27               5A206200
.C24DC EQU     .FFMP                       24          30               5A206300
.C25DC EQU     .FFSB          DECREMENT OF 25    OCTAL 31               5A206400
.C26DC EQU     .FHTR                       26          32               5A206500
.C27DC EQU     .FLAC                       27          33               5A206600
.C28DC EQU     .FLDC                       28          34               5A206700
.C29DC EQU     .FLDI                       29          35               5A206800
.C30DC EQU     .FLDQ          DECREMENT OF 30    OCTAL 36               5A206900
.C31DC PZE     0,,31                       31          37               5A207000
.C32DC EQU     .FLMTM                      32         40                5A207100
.C33DC PZE     0,,33                       33          41               5A207200
.C34DC EQU     .FLXA                       34          42               5A207300
.C35DC EQU     .FMPY          DECREMENT OF 35    OCTAL 43               5A207400
.C36DC EQU     .FNULL                      36          44               5A207500
.C37DC EQU     .FNZT                       37          45               5A207600
.C38DC EQU     .FOCT                       38          46               5A207700
.C39DC EQU     .FORA                       39          47               5A207800
.C40DC EQU     .FORG          DECREMENT OF 40    OCTAL 50               5A207900
.C41DC EQU     .FPAC                       41          51               5A208000
.C42DC EQU     .FPAX                       42          52               5A208100
.C43DC EQU     .FPXA                       43          53               5A208200
.C44DC EQU     .FPZE                       44          54               5A208300
.C45DC PZE     0,,45          DECREMENT OF 45    OCTAL 55               5A208400
.C46DC EQU     .FSBM                       46          56               5A208500
.C47DC EQU     .FSCA                       47          57               5A208600
.C48DC EQU     .FSLW                       48          60               5A208700
.C49DC EQU     .FSSM                       49         61                5A208800
.C50DC EQU     .FSSP          DECREMENT OF 50    OCTAL 62               5A208900
.C51DC EQU     .FSTA                       51          63               5A209000
.C52DC EQU     .FSTD                       52          64               5A209100
.C53DC EQU     .FSTI                       53          65               5A209200
.C54DC EQU     .FSTL                       54          66               5A209300
.C55DC EQU     .FSTO          DECREMENT OF 55    OCTAL 67               5A209400
.C56DC EQU     .FSTQ                       56          70               5A209500
.C57DC EQU     .FSTZ                       57          71               5A209600
.C58DC EQU     .FSUB                       58          72               5A209700
.C59DC EQU     .FSXA                       59          73               5A209800
.C60DC EQU     .FSXD          DECREMENT OF 60    OCTAL 74               5A209900
.C61DC EQU     .FTLQ                       61          75               5A210000
.C62DC EQU     .FTMI                       62          76               5A210100
.C63DC EQU     .FTNZ                       63          77               5A210200
.C64DC EQU     .FTPL                       64          100              5A210300
.C100D EQU     .FFSCA         DECREMENT OF 100   OCTAL 144              5A210400
.C1TDC PZE     0,,512         DECREMENT OF 512   OCTAL 1000             5A210500
.C2TDC PZE     0,,1024        DECREMENT OF 1024  OCTAL 2000             5A210600
.C4TDC PZE     0,,2048        DECREMENT OF 2048  OCTAL 4000             5A210700
.C10TD PZE     0,,4096        DECREMENT OF 4096  OCTAL 10000            5A210800
.C20TD PZE     0,,8192        DECREMENT OF 8192  OCTAL 20000            5A210900
.C30TD PZE     0,,12288       DECREMENT OF 12288 OCTAL 30000            5A211000
.C40TD PZE     0,,16384       DECREMENT OF 16384 OCTAL 40000            5A211100
.C50TD PZE     0,,20480       DECREMENT OF 20480 OCTAL 50000            5A211200
.C60TD PZE     0,,24576       DECREMENT OF 24576 OCTAL 60000            5A211300
       REM                                                              5A211400
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A211500
       REM                                                              5A211600
.C11PD VFD     O6/11,30/0     OCTAL 11 IN FIRST SIX BITS OF WORD.       5A211700
.C12PD VFD     O6/12,30/0     OCTAL 12 IN FIRST SIX BITS OD WORD.       5A211800
.C14PD VFD     O6/14,30/0     OCTAL 14 IN FIRST SIX BITS OF WORD.       5A211900
.C25PD VFD     O6/25,30/0     OCTAL 25 IN FIRST SIX BITS OF WORD.       5A212000
.C26PD VFD     O6/26,30/0     OCTAL 26 IN FIRST SIX BITS OF WORD.       5A212100
.C41PD VFD     O6/41,30/0     OCTAL 41 IN FIRST SIX BITS OF WORD.       5A212200
       SPACE   2                                                        5A212300
.P1DP1 ONE     0,,1           PREFIX OF 1 DECREMENT OF 1.               5A212400
.P1DP3 ONE     0,,3           PREFIX OF 1 DECREMENT OF 3.               5A212500
.P3AM1 THREE   -1,,0          PREFIX OF 3 ADDRESS 7S.                   5A212600
       REM                                                              5A212700
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A212800
       REM                                                              5A212900
.C1TAG PZE     0,1,0          TAG OF 1                                  5A213000
.C2TAG PZE     0,2,0                 2                                  5A213100
.C3TAG PZE     0,3,0                 3                                  5A213200
.C4TAG PZE     0,4,0                 4                                  5A213300
.C5TAG PZE     0,5,0                 5                                  5A213400
.C6TAG PZE     0,6,0                 6                                  5A213500
.C7TAG PZE     0,7,0                 7                                  5A213600
       REM                                                              5A213700
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A213800
       REM                                                              5A213900
.C1ADD PZE     1,,0           ADDRESS OF 1     OCTAL 1                  5A214000
.C2ADD PZE     2,,0                      2           2                  5A214100
.C3ADD PZE     3,,0                      3           3                  5A214200
.C4ADD PZE     4,,0                      4           4                  5A214300
.C5ADD PZE     5,,0                      5           5                  5A214400
.C6ADD PZE     6,,0                      6           6                  5A214500
.C7ADD PZE     7,,0                      7           7                  5A214600
.C8ADD PZE     8,,0                      8           10                 5A214700
.C9ADD PZE     9,,0                      9           11                 5A214800
.C10AD PZE     10,,0          ADDRESS OF 10    OCTAL 12                 5A214900
.C12AD PZE     12,,0          ADDRESS OF 12    OCTAL 14                 5A215000
.C15AD PZE     15,,0          ADDRESS OF 15    OCTAL 17                 5A215100
.C16AD PZE     16,,0          ADDRESS OF 16    OCTAL 20                 5A215200
.C17AD PZE     17,,0          ADDRESS OF 17    OCTAL 21                 5A215300
.C18AD PZE     18,,0          ADDRESS OF 18    OCTAL 22                 5A215400
.C32AD PZE     32,,0          ADDRESS OF 32    OCTAL 40                 5A215500
.C33AD PZE     33,,0          ADDRESS OF 33    OCTAL 41                 5A215600
.C38AD PZE     38,,0          ADDRESS OF 38   OCTAL 46                  5A215700
.C64AD PZE     64,,0          ADDRESS OF 64    OCTAL 100                5A215800
.C100A PZE     100,,0         ADDRESS OF 100   OCTAL 144                5A215900
.C128A PZE     128,,0         ADDRESS OF 128   OCTAL 200                5A216000
.C256A PZE     256,,0         ADDRESS OF 256   OCTAL 400                5A216100
.C1TAD PZE     512,,0         ADDRESS OF 512   OCTAL 1000               5A216200
.C2TAD PZE     1024,,0        ADDRESS OF 1024  OCTAL 2000               5A216300
.C4TAD PZE     2048,,0        ADDRESS OF 2048  OCTAL 4000               5A216400
.C10TA PZE     4096,,0        ADDRESS OF 4096  OCTAL 10000              5A216500
.C20TA PZE     8192,,0        ADDRESS OF 8192  OCTAL 20000              5A216600
.C30TA PZE     12288,,0       ADDRESS OF 12288 OCTAL 30000              5A216700
.C40TA PZE     16384,,0       ADDRESS OF 16384 OCTAL 40000              5A216800
.C50TA PZE     20480,,0       ADDRESS OF 20480 OCTAL 50000              5A216900
.C60TA PZE     24576,,0       ADDRESS OF 24576 OCTAL 60000              5A217000
       REM                                                              5A217100
       REM     *********************************************************5A217200
       EJECT                                                            5A217300
       REM     *********************************************************5A217400
       REM                                                              5A217500
       REM                    MASKS                                     5A217600
       REM                                                              5A217700
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A217800
       REM                                                              5A217900
.MPRFX EQU     .C7PFX         PREFIX                                    5A218000
.MDECR PZE     0,,-1          DECREMENT                                 5A218100
.MTAGF EQU     .C7TAG         TAG                                       5A218200
.MADDR PZE     -1,,0          ADDRESS                                   5A218300
.MLEFT SEVEN   0,,-1          LEFT HALF WORD MASK                       5A218400
.MRGHT ZERO    -1,7,0         RIGHT HALF WORD MASK                      5A218500
.M77AD PZE     63,,0          CHARACTER MASK, 77 OCTAL IN ADDRESS.      5A218600
.M77PD VFD     O6/77,30/0     77 OCTAL IN PREFIX AND HIGH ORDER DECR.   5A218700
.M107S PZE     -1,7,4095      OCTAL 007777777777                        5A218800
       REM                                                              5A218900
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A219000
       REM                                                              5A219100
       REM                    IIF MASKS                                 5A219200
       REM                                                              5A219300
.MOPCD PZE     0,,255         OPERATION CODE MASK                       5A219400
       REM                                                              5A219500
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A219600
       REM                                                              5A219700
       REM                    NAME TABLE MASKS                          5A219800
       REM                                                              5A219900
.MCLAS VFD     O7/177,29/0        CLASS FIELD                           5A220000
.MTYPE VFD     11/0,O7/177,18/0    TYPE FIELD                           5A220100
.MDETL VFD     21/0,O12/7777,3/0   DETAIL FIELD                         5A220200
.MCHAR EQU     .C7ADD             CHARACTER COUNT FIELD                 5A220300
       REM                                                              5A220400
       REM     *********************************************************5A220500
       EJECT                                                            5A220600
       REM     *********************************************************5A220700
       REM                                                              5A220800
       REM                    FIRST WORD IIF FLAGS (LOCATIONS OF)       5A220900
       REM                                                              5A221000
.FIFNW EQU     .C4PFX         THIS IS AN IFN WORD.                      5A221100
.FWONE EQU     .C2PFX         ANOTHER WORD OF THIS IIF FOLLOWS.         5A221200
.FANAM EQU     .C1PFX         ADDRESS IS A NAME POINTER.                5A221300
.FASBK EQU     .C40TD         ADDRESS IS A SUBAK POINTER.               5A221400
.FAEFN EQU     .C20TD         ADDRESS IS AN EFN POINTER.                5A221500
.FAIFN EQU     .C10TD         ADDRESS IS AN IFN POINTER.                5A221600
.FACON EQU     .C14PD         ADDRESS IS A CONSTANT POINTER.            5A221700
.FAERS EQU     .C12PD         ADDRESS IS AN ERASABLE POINTER.           5A221800
.FABIN EQU     .C11PD         ADDRESS IS BINARY.                        5A221900
.FASTR EQU     .C60TD         ADDRESS IS AN ADDEND TO CURRENT LOCATION. 5A222000
.FASUB EQU     .C50TD         ADDRESS IS TO BE SUBTRACTED FROM CUR. LOC.5A222100
.FAVAC EQU     .C30TD         ADDRESS IS TO BE INITIALIZED (**).        5A222200
.FTSYM EQU     .C4TDC         TAG IS SYMBOLIC.                          5A222300
.FINDR EQU     .C2TDC         INDIRECT ADDRESSING IS WANTED.            5A222400
.FASPO EQU     .C1TDC         *+1 ADDRESS UNDERSTOOD, ADDRESS DEFINES D.5A222500
       REM                                                              5A222600
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A222700
       REM                                                              5A222800
       REM                    SECOND WORD IIF FLAGS (LOCATIONS OF)      5A222900
       REM                                                              5A223000
.FDNAM EQU     .C1PFX         DECREMENT IS A NAME POINTER.              5A223100
.FDSBK EQU     .C40TD         DECREMENT IS A SUBAK POINTER.             5A223200
.FDBIN EQU     .C11PD         DECREMENT IS BINARY.                      5A223300
.FDADD EQU     .C60TD         DECREMENT IS AN ADDEND TO THE ADDRESS.    5A223400
.FDSUB EQU     .C50TD         DECREMENT IS TO BE SUBTRACTED FROM ADDRESS5A223500
.FDVAC EQU     .C30TD         DECREMENT IS TO BE INITIALIZED (**).      5A223600
       REM                                                              5A223700
       REM     *********************************************************5A223800
       REM                                                              5A223900
       REM                    LOCATIONS CONTAINING NAME TABLE FLAGS.    5A224000
       REM                                                              5A224100
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A224200
       REM                                                              5A224300
       REM                    CLASS FIELD FLAGS (LOCATIONS OF)          5A224400
       REM                                                              5A224500
.VVARN EQU     .C4PFX         SYMBOL IS A VARIABLE NAME.                5A224600
.VROUT EQU     .C2PFX         SYMBOL IS A ROUTINE NAME.                 5A224700
.VCMBK EQU     .C1PFX         SYMBOL IS A COMMON BLOCK NAME.            5A224800
.VSPNM EQU     .C40TD         SYMBOL IS THE NAME OF THIS PROGRAM.       5A224900
.VTBNM EQU     .C20TD         SYMBOL IS A NAME LIST NAME.               5A225000
.VEXPT EQU     .C10TD         SYMBOL HAS BEEN EXPLICITLY TYPED.         5A225100
       REM                                                              5A225200
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A225300
       REM                                                              5A225400
       REM                    TYPE FIELD FLAGS (LOCATIONS OF)           5A225500
       REM                                                              5A225600
.VOCTL EQU     .C64DC         SYMBOL OR CONSTANT IS OCTAL.              5A225700
.VALPH EQU     .C32DC         SYMBOL OR CONSTANT IS ALPHAMERIC.         5A225800
.VLOGL EQU     .C16DC         SYMBOL OR CONSTANT IS LOGICAL.            5A225900
.VCMLX EQU     .C8DEC         SYMBOL OR CONSTANT IS COMPLEX.            5A226000
.VDBLP EQU     .C4DEC         SYMBOL OR CONSTANT IS DOUBLE PRECISION.   5A226100
.VREAL EQU     .C2DEC         SYMBOL OR CONSTANT IS REAL.               5A226200
.VINTG EQU     .C1DEC         SYMBOL OR CONSTANT IS INTEGER.            5A226300
       REM                                                              5A226400
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A226500
       REM                                                              5A226600
       REM                    SUB-CLASS FIELD FLAGS (LOCATIONS OF)      5A226700
       REM                                                              5A226800
.VENTY EQU     .C4TAG         SYMBOL IS AN ENTRY POINT NAME.            5A226900
.VSARG EQU     .C2TAG         SYMBOL IS AN ARGUMENT TO THIS PROGRAM.    5A227000
       REM                                                              5A227100
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A227200
       REM                                                              5A227300
       REM                    DETAIL FLAGS FOR A VARIABLE (LOCATIONS OF)5A227400
       REM                                                              5A227500
.VARAY EQU     .C40TA         VARIABLE IS AN ARRAY NAME.                5A227600
.VADJD EQU     .C20TA         VARIABLE IS AN ADJUSTABLE DIMENSION.      5A227700
.VACTV EQU     .C10TA         VARIABLE IS NOT JUST A DUMMY ARGUMENT.    5A227800
.VARAD EQU     .C4TAD         ARRAY IS ADJUSTABLY DIMENSIONED.          5A227900
.VDUMY EQU     .C2TAD         VARIABLE IS A DUMMY ARGUMENT (ASF).       5A228000
.VFRTY EQU     .C1TAD         VARIABLE APPEARS ON THE LEFT OF           5A228100
       REM                    EQUAL, IN AN I/O INPUT LIST, OR           5A228200
       REM                    AS AN ARGUMENT TO A SUBPROGRAM.           5A228300
.VCMVR EQU     .C256A         VARIABLE IS IN COMMON.                    5A228400
.VEQVL EQU     .C128A         VARIABLE IS EQUIVALENCED.                 5A228500
.VREQV EQU     .C64AD         VARIABLE IS REPEATEDLY EQUIVALENCED.      5A228600
.VBLCM EQU     .C32AD         VARIABLE IS IN BLANK COMMON.              5A228700
.VCMST EQU     .C16AD         VARIABLE APPEARED IN A COMMON STATEMENT.  5A228800
       REM                                                              5A228900
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A229000
       REM                                                              5A229100
       REM                    DETAIL FIELD FLAGS FOR A ROUTINE.         5A229200
       REM                       (LOCATIONS OF)                         5A229300
       REM                                                              5A229400
.VASFN EQU     .C40TA         ROUTINE IS AN ASF.                        5A229500
.VSUBN EQU     .C20TA         ROUTINE IS A SUBROUTINE SUBPROGRAM.       5A229600
.VFUNC EQU     .C10TA         ROUTINE IS A FUNCTION SUBPROGRAM.         5A229700
.VBULT EQU     .C4TAD         ROUTINE IS A BUILT-IN FUNCTION.           5A229800
.VEXTN EQU     .C2TAD         NAME HAS APPEARED IN AN EXTERNAL STATEMENT5A229900
.VLIBF EQU     .C1TAD         ROUTINE IS A LIBRARY SUBPROGRAM.          5A230000
.VCALL EQU     .C256A         SYMBOL IS THE OBJECT OF A CALL.           5A230100
       REM                    FOR AN ARGUMENT,                          5A230200
       REM                                                              5A230300
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A230400
       REM                                                              5A230500
       REM                    DETAIL FLAGS FOR A NAME LIST (LOCATION OF)5A230600
       REM                                                              5A230700
.VCIVR EQU     .C40TA         THERE ARE INTEGER VARIABLE(S) IN THE LIST.5A230800
       REM                                                              5A230900
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A231000
       REM                                                              5A231100
       REM                    NAME TABLE FLAGS FOR THE FOURTH WORD.     5A231200
       REM                        (LOCATIONS OF)                        5A231300
       REM                                                              5A231400
.VDMPD EQU     .C1PFX         IF ON, DIMENSION PRODUCT COMPUTED.        5A231500
.VEQCE EQU     .C2PFX         IF ON, END OF PHASE A EQUIVALENCE CHAIN.  5A231600
.VSADT EQU     .C4PFX         ADDRESS CONTAINS STORAGE ALLOCATOR DATA.  5A231700
.VSFCA EQU     .C1TAG         ADDRESS IS SHORT FORM COMPLEX.            5A231800
.VLFCP EQU     .C2TAG         ADDRESS IS A POINTER TO A LONG FORM       5A231900
       REM                    COMPLEX ADDRESS TABLE.                    5A232000
       REM                                                              5A232100
       REM     *********************************************************5A232200
       EJECT                                                            5A232300
       REM     *********************************************************5A232400
       REM                                                              5A232500
       REM                    DEFINITIONS OF ALHPABETIC CHARACTERS.     5A232600
       REM                                                              5A232700
  A    EQU     17                                                       5A232800
  B    EQU     18                                                       5A232900
  C    EQU     19                                                       5A233000
  D    EQU     20                                                       5A233100
  E    EQU     21                                                       5A233200
  F    EQU     22                                                       5A233300
  G    EQU     23                                                       5A233400
  H    EQU     24                                                       5A233500
  I    EQU     25                                                       5A233600
  J    EQU     33                                                       5A233700
  K    EQU     34                                                       5A233800
  L    EQU     35                                                       5A233900
  M    EQU     36                                                       5A234000
  N    EQU     37                                                       5A234100
  O    EQU     38                                                       5A234200
  P    EQU     39                                                       5A234300
  Q    EQU     40                                                       5A234400
  R    EQU     41                                                       5A234500
  S    EQU     50                                                       5A234600
  T    EQU     51                                                       5A234700
  U    EQU     52                                                       5A234800
  V    EQU     53                                                       5A234900
  W    EQU     54                                                       5A235000
  X    EQU     55                                                       5A235100
  Y    EQU     56                                                       5A235200
  Z    EQU     57                                                       5A235300
       SPACE   1                                                        5A235400
       REM     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  5A235500
       REM                                                              5A235600
       REM                    VALUES OF ALPHABETIC CHARACTERS(LOCATIONS)5A235700
       REM                                                              5A235800
.A     EQU     .C17DC                                                   5A235900
.B     EQU     .C18DC                                                   5A236000
.C     EQU     .C19DC                                                   5A236100
.D     EQU     .C20DC                                                   5A236200
.E     EQU     .C21DC                                                   5A236300
.F     EQU     .C22DC                                                   5A236400
.G     EQU     .C23DC                                                   5A236500
.H     EQU     .C24DC                                                   5A236600
.I     EQU     .C25DC                                                   5A236700
.J     EQU     .C33DC                                                   5A236800
.K     EQU     .C34DC                                                   5A236900
.L     EQU     .C35DC                                                   5A237000
.M     EQU     .C36DC                                                   5A237100
.N     EQU     .C37DC                                                   5A237200
.O     EQU     .C38DC                                                   5A237300
.P     EQU     .C39DC                                                   5A237400
.Q     EQU     .C40DC                                                   5A237500
.R     EQU     .C41DC                                                   5A237600
.S     EQU     .C50DC                                                   5A237700
.T     EQU     .C51DC                                                   5A237800
.U     EQU     .C52DC                                                   5A237900
.V     EQU     .C53DC                                                   5A238000
.W     EQU     .C54DC                                                   5A238100
.X     EQU     .C55DC                                                   5A238200
.Y     EQU     .C56DC                                                   5A238300
.Z     EQU     .C57DC                                                   5A238400
       SPACE   2                                                        5A238500
       REM                                                              5A238600
       REM     *********************************************************5A238700
       TTL     ** ERROR NUMBER DEFINITIONS  **                          5A238800
O.RST  NULL                                                             5A238900
       ORG     0                                                        5A239000
XX01D  BSS     1                                                        5A239100
CC1    BSS     1              ERROR NUMBER.                             5A239200
CC2    BSS     1                                                        5A239300
XC01D  BSS     1                                                        5A239400
UAE3   BSS     1                                                        5A239500
UAE1   BSS     1                                                        5A239600
UAE2   BSS     1                                                        5A239700
UAE4   BSS     1                                                        5A239800
UD1    BSS     1                                                        5A239900
CB1    BSS     1                                                        5A240000
CB2    BSS     1                                                        5A240100
XC02D  BSS     1                                                        5A240200
XC03D  BSS     1                                                        5A240300
XC04D  BSS     1                                                        5A240400
XC05D  BSS     1                                                        5A240500
XC06D  BSS     1                                                        5A240600
XC07D  BSS     1                                                        5A240700
XC08D  BSS     1                                                        5A240800
XC10D  BSS     1                                                        5A240900
XC09D  BSS     1                                                        5A241000
XC11D  BSS     1                                                        5A241100
XC17D  BSS     1                                                        5A241200
CB01D  BSS     1                                                        5A241300
CB05D  BSS     1                                                        5A241400
CB06D  BSS     1                                                        5A241500
CB03D  BSS     1                                                        5A241600
CV01D  BSS     1                                                        5A241700
CV02D  BSS     1                                                        5A241800
UTP1D  BSS     1                                                        5A241900
UTS1D  BSS     1                                                        5A242000
DO01D  BSS     1                                                        5A242100
DO03D  BSS     1                                                        5A242200
UIL1D  BSS     1                                                        5A242300
DO07D  BSS     1                                                        5A242400
DO08D  BSS     1                                                        5A242500
DO05D  BSS     1                                                        5A242600
DB01D  BSS     1                                                        5A242700
DB02D  BSS     1                                                        5A242800
UE01D  BSS     1                                                        5A242900
UC01D  BSS     1                                                        5A243000
XB03D  BSS     1                                                        5A243100
XB02D  BSS     1                                                        5A243200
FW01D  BSS     1                                                        5A243300
FW02D  BSS     1                                                        5A243400
FW03D  BSS     1                                                        5A243500
FW04D  BSS     1                                                        5A243600
FW05D  BSS     1                                                        5A243700
FW06D  BSS     1                                                        5A243800
FW07D  BSS     1                                                        5A243900
AA01D  BSS     1                                                        5A244000
AA02D  BSS     1                                                        5A244100
AA03D  BSS     1                                                        5A244200
AA04D  BSS     1                                                        5A244300
AA05D  BSS     1                                                        5A244400
AA06D  BSS     1                                                        5A244500
AA07D  BSS     1                                                        5A244600
AA08D  BSS     1                                                        5A244700
AA10D  BSS     1                                                        5A244800
AA11D  BSS     1                                                        5A244900
AA13D  BSS     1                                                        5A245000
AA14D  BSS     1                                                        5A245100
SA51D  BSS     1                                                        5A245200
SA52D  BSS     1                                                        5A245300
SA53D  BSS     1                                                        5A245400
SA54D  BSS     1                                                        5A245500
DR01D  BSS     1                                                        5A245600
DR02D  BSS     1                                                        5A245700
DR03D  BSS     1                                                        5A245800
TR01D  BSS     1                                                        5A245900
TR02D  BSS     1                                                        5A246000
SA01D  BSS     1                                                        5A246100
SA02D  BSS     1                                                        5A246200
 EQ06D BSS     1                                                        5A246300
 EQ07D BSS     1                                                        5A246400
 EQ01D BSS     1                                                        5A246500
 EQ10D BSS     1                                                        5A246600
 EQ11D BSS     1                                                        5A246700
 EQ14D BSS     1                                                        5A246800
AA09D  BSS     1                                                        5A246900
 EQ18D BSS     1                                                        5A247000
 EQ09D BSS     1                                                        5A247100
 EQ08D BSS     1                                                        5A247200
 EQ17D BSS     1                                                        5A247300
 GC01D BSS     1                                                        5A247400
 GC02D BSS     1                                                        5A247500
 GC03D BSS     1                                                        5A247600
 GC04D BSS     1                                                        5A247700
 GC05D BSS     1                                                        5A247800
 GC06D BSS     1                                                        5A247900
 GT01D BSS     1                                                        5A248000
GT02D  BSS     1                                                     (7)5A248100
 GT03D BSS     1                                                        5A248200
GT04D  BSS     1                                                     (7)5A248300
 GT05D BSS     1                                                        5A248400
 GT06D BSS     1                                                        5A248500
 GT07D BSS     1                                                        5A248600
 GT08D BSS     1                                                        5A248700
 GT09D BSS     1                                                        5A248800
 GT10D BSS     1                                                        5A248900
 GT11D BSS     1                                                        5A249000
 GT12D BSS     1                                                        5A249100
 GT13D BSS     1                                                        5A249200
 GT14D BSS     1                                                        5A249300
 GT15D BSS     1                                                        5A249400
 GT16D BSS     1                                                        5A249500
 GT17D BSS     1                                                        5A249600
 GT18D BSS     1                                                        5A249700
 GT20D BSS     1                                                        5A249800
 GT23D BSS     1                                                        5A249900
 BR01D BSS     1                                                        5A250000
 BR02D BSS     1                                                        5A250100
EX01D  BSS     1                                                        5A250200
 EX09D BSS     1                                                        5A250300
 EX02D BSS     1                                                        5A250400
 EX03D BSS     1                                                        5A250500
 EX04D BSS     1                                                        5A250600
UC02D  BSS     1                                                        5A250700
 EX11D BSS     1                                                        5A250800
 EX12D BSS     1                                                        5A250900
 SZ01D BSS     1                                                        5A251000
 SZ02D BSS     1                                                        5A251100
 SZ03D BSS     1                                                        5A251200
 SZ04D BSS     1                                                        5A251300
 SZ05D BSS     1                                                        5A251400
 SZ06D BSS     1                                                        5A251500
 SZ07D BSS     1                                                        5A251600
       BSS     1              AVAILABLE                                 5A251700
IN04D  BSS     1                                                    (13)5A251800
 SZ21D BSS     1                                                        5A251900
 SZ23D BSS     1                                                        5A252000
 SZ24D BSS     1                                                        5A252100
UEF1D  BSS     1                                                        5A252200
 AS04D BSS     1                                                        5A252300
 AS03D BSS     1                                                        5A252400
 AS05D BSS     1                                                        5A252500
 AS07D BSS     1                                                        5A252600
       BSS     1              AVAILABLE                                 5A252700
 AS10D BSS     1                                                        5A252800
 AS11D BSS     1                                                        5A252900
 AS09D BSS     1                                                        5A253000
RC01D  BSS     1                                                        5A253100
 NL01D BSS     1                                                        5A253200
DM02E  BSS     1                                                    (16)5A253300
       BSS     1              AVAILABLE                                 5A253400
 NL02D BSS     1                                                        5A253500
 CM04D BSS     1                                                        5A253600
 CM05D BSS     1                                                        5A253700
 NL03D BSS     1                                                        5A253800
 DM02D BSS     1                                                        5A253900
 DM03D BSS     1                                                        5A254000
 NL04D BSS     1                                                        5A254100
 NL05D BSS     1                                                        5A254200
 CM06D BSS     1                                                        5A254300
 DM04D BSS     1                                                        5A254400
 NL06D BSS     1                                                        5A254500
 TY01D BSS     1                                                        5A254600
 DM05D BSS     1                                                        5A254700
 DM07D BSS     1                                                        5A254800
 DM08D BSS     1                                                        5A254900
 CM07D BSS     1                                                        5A255000
 TY02D BSS     1                                                        5A255100
 DM09D BSS     1                                                        5A255200
 DM01D BSS     1                                                        5A255300
 CM13D BSS     1                                                        5A255400
 NL07D BSS     1                                                        5A255500
 CM08D BSS     1                                                        5A255600
DAUPD  BSS     1              END OF DATA TABLE ERROR NUMBER.           5A255700
FTUPD  BSS     1              END OF FORMAT TABLE ERROR NUMBER.         5A255800
BCZEN  BSS     1              ILLEGAL CHARACTER ERROR NUMBER.           5A255900
BCAZE  BSS     1              TOO MANY CHARACTERS ERROR NUMBER.         5A256000
CSDG1  BSS     1              TOO MANY PARENTHESES ERROR NUMBER.        5A256100
DSDEN  BSS     1              ILLEGAL STATEMENT ERROR NUMBER.           5A256200
FTPKD  BSS     1              MISSING EFN ON FORMAT ERROR NUMBER.       5A256300
DC01D  BSS     1                                                        5A256400
DC02D  BSS     1                                                        5A256500
DC05D  BSS     1                                                        5A256600
DC06D  BSS     1                                                        5A256700
DC07D  BSS     1                                                        5A256800
DC08D  BSS     1                                                        5A256900
DC09D  BSS     1                                                        5A257000
DC10D  BSS     1                                                        5A257100
DC11D  BSS     1                                                        5A257200
DC12D  BSS     1                                                        5A257300
DC13D  BSS     1                                                        5A257400
DC14D  BSS     1                                                        5A257500
DC15D  BSS     1                                                        5A257600
DC16D  BSS     1                                                        5A257700
DC17D  BSS     1                                                        5A257800
DC18D  BSS     1                                                        5A257900
DC19D  BSS     1                                                        5A258000
DC20D  BSS     1                                                        5A258100
DC21D  BSS     1                                                        5A258200
DC22D  BSS     1                                                        5A258300
DC23D  BSS     1                                                        5A258400
DC24D  BSS     1                                                        5A258500
DC25D  BSS     1                                                        5A258600
DC26D  BSS     1                                                        5A258700
DC27D  BSS     1                                                        5A258800
DC28D  BSS     1                                                        5A258900
DC29D  BSS     1                                                        5A259000
SS01D  BSS     1                                                        5A259100
SS02D  BSS     1                                                        5A259200
SS04D  BSS     1                                                        5A259300
SS06D  BSS     1                                                        5A259400
SS07D  BSS     1                                                        5A259500
IX01D  BSS     1                                                        5A259600
IX02D  BSS     1                                                        5A259700
IX03D  BSS     1                                                        5A259800
IX05D  BSS     1                                                        5A259900
AL02D  BSS     1                                                        5A260000
AL01D  BSS     1                                                        5A260100
AT02D  BSS     1                                                        5A260200
AT01D  BSS     1                                                        5A260300
AO02D  BSS     1                                                        5A260400
AO01D  BSS     1                                                        5A260500
CL01D  BSS     1                                                        5A260600
CL02D  BSS     1                                                        5A260700
CL03D  BSS     1                                                        5A260800
RT01D  BSS     1                                                        5A260900
       BSS     1              AVAILABLE                                 5A261000
IF01D  BSS     1                                                        5A261100
       BSS     1              AVAILABLE                                 5A261200
IF03D  BSS     1                                                        5A261300
WR01D  BSS     1                                                        5A261400
WR02D  BSS     1                                                        5A261500
WR03D  BSS     1                                                        5A261600
WR04D  BSS     1                                                        5A261700
WR05D  BSS     1                                                        5A261800
SB01D  BSS     1                                                        5A261900
SB02D  BSS     1                                                        5A262000
SB03D  BSS     1                                                        5A262100
SB04D  BSS     1                                                        5A262200
SB05D  BSS     1                                                        5A262300
SB06D  BSS     1                                                        5A262400
SB07D  BSS     1                                                        5A262500
       BSS     1              AVAILABLE                                 5A262600
AR35D  BSS     1                                                        5A262700
AR01D  BSS     1                                                        5A262800
AR02D  BSS     1                                                        5A262900
AR03D  BSS     1                                                        5A263000
AR04D  BSS     1                                                        5A263100
AR05D  BSS     1                                                        5A263200
AR06D  BSS     1                                                        5A263300
AR07D  BSS     1                                                        5A263400
AR08D  BSS     1                                                        5A263500
AR09D  BSS     1                                                        5A263600
AR10D  BSS     1                                                        5A263700
AR11D  BSS     1                                                        5A263800
AR12D  BSS     1                                                        5A263900
AR13D  BSS     1                                                        5A264000
AR14D  BSS     1                                                        5A264100
AR15D  BSS     1                                                        5A264200
AR16D  BSS     1                                                        5A264300
AR17D  BSS     1                                                        5A264400
AR18D  BSS     1                                                        5A264500
AR19D  BSS     1                                                        5A264600
AR20D  BSS     1                                                        5A264700
AR21D  BSS     1                                                        5A264800
AR22D  BSS     1                                                        5A264900
AR23D  BSS     1                                                        5A265000
AR24D  BSS     1                                                        5A265100
AR25D  BSS     1                                                        5A265200
AR26D  BSS     1                                                        5A265300
AR27D  BSS     1                                                        5A265400
AR28D  BSS     1                                                        5A265500
AR29D  BSS     1                                                        5A265600
AR30D  BSS     1                                                        5A265700
AR31D  BSS     1                                                        5A265800
AR32D  BSS     1                                                        5A265900
AR33D  BSS     1                                                        5A266000
AR34D  BSS     1                                                        5A266100
IN01D  BSS     1                                                        5A266200
IN02D  BSS     1                                                        5A266300
IN03D  BSS     1                                                        5A266400
SA60D  BSS     1                                                        5A266500
SA61D  BSS     1                                                        5A266600
SA62D  BSS     1                                                        5A266700
SA63D  BSS     1                                                        5A266800
SA64D  BSS     1                                                        5A266900
SA65D  BSS     1                                                        5A267000
SA66D  BSS     1                                                        5A267100
SA67D  BSS     1                                                        5A267200
SA68D  BSS     1                                                        5A267300
SA69D  BSS     1                                                        5A267400
SA70D  BSS     1                                                        5A267500
SA71D  BSS     1                                                        5A267600
SQ51D  BSS     1                                                        5A267700
DT01D  BSS     1                                                        5A267800
DT02D  BSS     1                                                        5A267900
DT03D  BSS     1                                                        5A268000
DT04D  BSS     1                                                        5A268100
DT05D  BSS     1                                                        5A268200
DT06D  BSS     1                                                        5A268300
DT07D  BSS     1                                                        5A268400
DT08D  BSS     1                                                        5A268500
DT09D  BSS     1                                                        5A268600
DT10D  BSS     1                                                        5A268700
DT11D  BSS     1                                                        5A268800
DT12D  BSS     1                                                        5A268900
DT13D  BSS     1                                                        5A269000
DT14D  BSS     1                                                        5A269100
DT15D  BSS     1                                                        5A269200
DT21D  BSS     1                                                        5A269300
DT22D  BSS     1                                                        5A269400
DT23D  BSS     1                                                        5A269500
DT24D  BSS     1                                                        5A269600
DT25D  BSS     1                                                        5A269700
DT26D  BSS     1                                                        5A269800
DT27D  BSS     1                                                        5A269900
DT29D  BSS     1                                                        5A270000
DT30D  BSS     1                                                        5A270100
DT31D  BSS     1                                                        5A270200
DT32D  BSS     1                                                        5A270300
 SZP1D BSS     1                                                        5A270400
 SZP2D BSS     1                                                        5A270500
 SZP3D BSS     1                                                        5A270600
 SZ13D BSS     1                                                        5A270700
 DM06D BSS     1                                                        5A270800
SA72D  BSS     1                                                        5A270900
 PS02D BSS     1                                                        5A271000
 CT01D BSS     1                                                        5A271100
DT33D  BSS     1                                                        5A271200
       BSS     1              AVAILABLE                                 5A271300
       BSS     1              AVAILABLE                                 5A271400
 EQ16D BSS     1                                                        5A271500
 IO01D BSS     1                                                        5A271600
 IO03D BSS     1                                                        5A271700
 IO04D BSS     1                                                        5A271800
 IO05D BSS     1                                                        5A271900
 IO07D BSS     1                                                        5A272000
 IO10D BSS     1                                                        5A272100
 IO11D BSS     1                                                        5A272200
 IO14D BSS     1                                                        5A272300
 IO15D BSS     1                                                        5A272400
 IO16D BSS     1                                                        5A272500
 IO17D BSS     1                                                        5A272600
ED01D  BSS     1                                                        5A272700
XC12D  BSS     1                                                        5A272800
SS09D  BSS     1                                                        5A272900
       BSS     1              AVAILABLE                                 5A273000
SE01D  BSS     1                                                        5A273100
SE02D  BSS     1                                                        5A273200
SE03D  BSS     1                                                        5A273300
SE04D  BSS     1                                                        5A273400
SE05D  BSS     1                                                        5A273500
SE06D  BSS     1                                                        5A273600
SE07D  BSS     1                                                        5A273700
       BSS     1              AVAILABLE                                 5A273800
SC01D  BSS     1                                                        5A273900
SE08D  BSS     1                                                        5A274000
SE09D  BSS     1                                                        5A274100
SA99D  BSS     1                                                        5A274200
AA15D  BSS     1                                                        5A274300
 CM15D BSS     1                                                        5A274400
SE10D  BSS     1                                                        5A274500
SA81D  BSS     1                                                        5A274600
       ORG     O.RST                                                    5A274700
       TTL                                                              5A274800
       TTL                                                              5A274900
       EJECT                                                            5A275000
       REM     .........................................................5A275100
       REM                                                              5A275200
       SPACE   2                                                        5A275300
       BSS     3              EXPANSION SPACE.                          5A275400
       SPACE   1                                                        5A275500
       REM                                                              5A275600
       REM     .........................................................5A275700
       REM                                                              5A275800
       ORG     O.FGEN                                                   5A275900
       TTL     **  INTERNAL TEXT ROUTINES  -  PHASE A  **               5A276000
       REM                                                              5A276100
       REM           INTERNAL TEXT MACRO SKELETONS                      5A276200
       REM     .........................................................5A276300
       SPACE   5                                                        5A276400
       SPACE   2                                                        5A276500
       REM                                                              5A276600
       REM                                                              5A276700
LOCATE MACRO   A,B            MACRO TO LOCATE EFFECTIVE ADDRESS.        5A276800
       LXD     A,4            FOR A CONTROL WORD STORE IN A BUFFER      5A276900
       SXD     *+2,4                                                    5A277000
       LXA     A,4            BUFFER ADDRESS + BUFFER SIZE              5A277100
       TIX     *+1,4,**       - WORD COUNT                              5A277200
       TXI     *+1,4,-1       ADJUST                                    5A277300
       SXA     B,4            SAVE POINTER                              5A277400
       ENDM    LOCATE                                                   5A277500
       REM                                                              5A277600
       REM                                                              5A277700
MNODT  MACRO   A,B            MAIN FILE OR DOTAG FILE MACRO             5A277800
       ZET     IXOFS          INTERROGATES THE FILE SWITCH              5A277900
       TRA     A              TRANSFER TO LOCATION A IF MAIN FILE.      5A278000
       TRA     B              TRANSFER TO LOCATION B IF DOTAG FILE.     5A278100
       ENDM    MNODT                                                    5A278200
       REM                                                              5A278300
       REM                                                              5A278400
UPSEQN MACRO   A              UPDATES SPECIFIED SEQUENCE NUMBER         5A278500
       LXA     A,1                                                      5A278600
       TXI     *+1,1,1                                                  5A278700
       SXA     A,1                                                      5A278800
       SXA     IXSEQ,1                                                  5A278900
       ENDM    UPSEQN                                                   5A279000
       EJECT                                                            5A279100
       SPACE   5                                                        5A279200
       REM              CONSTANTS AND ERASEABLE FOR IXINT               5A279300
       SPACE   5                                                        5A279400
       REM     .........................................................5A279500
       REM                                                              5A279600
       REM                    FILE CONTROL BLOCKS FOR IOCS              5A279700
       REM                                                              5A279800
       REM                             DOTAG FILE                       5A279900
       REM                                                              5A280000
IXDFB  PZE     **,4,**        UCW1,,UCW2                                5A280100
       OCT     025000000000   BUFFER INFORMATION,,CONTROL BITS.         5A280200
       PZE     **,,**         LOC. OF BUFFER IN USE,,LABEL CHECK        5A280300
       PZE     **,,**         LOC. OF GROUP CONTROL WD.,,BLOCK COUNT    5A280400
       PZE     IX.00,,**      SYNC. CHAIN,,LOC. OF BUFFER POOL          5A280500
       PZE     **,,**         NO. OF CORRECT RTTS,,NO. OF UNCOR. RTTS   5A280600
       PZE     **             FILE SERIAL NUMBER OR HOME ADDRESS.       5A280700
       PZE     **             REEL SEQUENCE NUMBER OR DISK LIMITS       5A280800
       BCI     3,    IBFTC    DOTAG   FILE NAME                         5A280900
       PZE                    REEL SEQUENCE NO (BY LABEL ROUTINE ONLY)  5A281000
IX.00  EQU     .CZERO         ITS NEEDED                                5A281100
       SPACE   4                                                        5A281200
       REM                  MAIN FILE                                   5A281300
       REM                                                              5A281400
IXMFB  PZE     **,4,**                                                  5A281500
       OCT     025000000000                                             5A281600
       PZE     **,,**                                                   5A281700
       PZE     **,,**                                                   5A281800
       PZE     IX.01,,**                                                5A281900
       PZE     **,,**         *********DESCRIPTION ABOVE*********       5A282000
       PZE     **                                                       5A282100
       PZE     **                                                       5A282200
       BCI     3,    IBFTC    MAIN                                      5A282300
       PZE                                                              5A282400
IX.01  EQU     .CZERO                                                   5A282500
       REM     *********************************************************5A282600
IXOOP  PZE     **             OUTPUT OPEN FLAG                          5A282700
IXOIN  PZE     **             INPUT OPEN FLAG                           5A282800
IXMSQ  PZE     **             MAIN FILE SEQUENCE NUMBER.                5A282900
IXDSQ  PZE     **             DOTAG FILE SEQUENCE NUMBER.               5A283000
IXOFS  PZE     **             FILE SWITCH                               5A283100
IXIOL  SEVEN   2,,IXNOB       TWO RESERVE FILES,,FOUR BUFFERS           5A283200
       PZE     IXDFB                                                    5A283300
       PZE     IXMFB                                                    5A283400
       EJECT                                                            5A283500
       REM     DOTAG-MAIN FILES INITIALIZATION ROUTINE - IXINT          5A283600
       REM                                                              5A283700
       REM     THIS ROUTINE IS CALLED BY COMPILER CONTROL AT THE START  5A283800
       REM     OF A JOB                                                 5A283900
       SPACE   3                                                        5A284000
       REM     *********************************************************5A284100
       SPACE   3                                                        5A284200
O.IXO  NULL                                                             5A284300
       ORG     FREGB                                                    5A284400
IXINT  SXA     IXISV,1       *SAVE REGISTERS                            5A284500
       SXA     IXISV+1,2                                                5A284600
       SXA     IXISV+2,4                                                5A284700
       STZ     IXMCT          RESET MAIN FILE WORD COUNTER              5A284800
       STZ     IXDCT          RESET DOTAG FILE WORD COUNTER             5A284900
       ZSD     IXMCW          RESET WORD COUNT OF MAIN FILE CONTROL WORD5A285000
       ZSD     IXDCW          RESET WD. COUNT OF DOTAG FILE CONTROL WORD5A285100
       STL     IXOIC          SET INITIAL CALL SWITCH.                  5A285200
       STZ     IXSEQ          RESET SEQUENCE NUMBER CELL.               5A285300
       STZ     IXMSQ          RESET MAIN FILE SEQUENCE NUMBER.          5A285400
       STZ     IXDSQ          RESET DOTAG FILE SEQUENCE NUMBER.         5A285500
       STZ     IXFCC          RESET SWITCH INDICATING THAT THE FILE     5A285600
       REM                    CONTROL BLOCK (FCB) INITIALIZING ROUTINE  5A285700
       REM                    (IXFCB) HAS BEEN CALLED BY FCC.           5A285800
       SPACE   4                                                        5A285900
       REM                    INITIALIZE THE FILE CONTROL BLOCK         5A286000
       REM                    AND ACQUAINT IOCS WITH THE DOTAG MAIN     5A286100
       REM                    FILES. OPEN DOTAG/MAIN FILES              5A286200
       SPACE   3                                                        5A286300
IXIA0  STZ     IX.DT          RESET FILE CNTRL BLOCK INITIALIZATION     5A286400
       REM                                SWITCH FOR DOTAG              5A286500
       AXC     IXDFB,1        READY FOR DOTAG                           5A286600
       AXT     .DTAGF,2       LOAD TAPE ASSIGNMENT FOR DOTAG.           5A286700
       TRA     *+2            TRANSFER AROUND FCC ENTRY POINT.          5A286800
       SPACE   2                                                        5A286900
       REM       FCB INITIALIZING ROUTINE                               5A287000
       SPACE   2                                                        5A287100
IXFCB  STL     IXFCC         /SET CALL FROM FCC SWITCH.                 5A287200
       SXA     IXI7A,4        SAVE LINKAGE.                             5A287300
       SXA     IXIB1,2        INITIALIZE ADDRESSES                      5A287400
       SXA     IXIB2,2        WHERE TAPE UNITS                          5A287500
       SXA     IXIB3,2        ARE REFERENCED.                           5A287600
       CAL     .C3TAG         INITIALIZE THE DENSITY                    5A287700
       SLW     IXIMK          BIT MASK FOR HIGH DENSITY.                5A287800
IXIA1  LAC     SYSUNI,4       LOAD THE ORIGIN OF THE SYSUNI TABLE       5A287900
       LDC     SYSUNI,2                                                 5A288000
       SXD     IXIA2,2                                                  5A288100
IXIB1  CLA     **,4           GET THE TABLE UNIT ADDRESS                5A288200
       STA     IXFIL,1        SET IT IN THE FILE CONTROL BLOCK          5A288300
       STD     IX.HA          TO DISK HOME ADDRESS                      5A288400
       TMI     *+2           *IS THE DENSITY HIGH OR LOW                5A288500
       STZ     IXIMK          LOW,SET DENSITY BITS SUCH                 5A288600
       STA     *+1            INITIALIZE TO PICK UP UCB CONTROL WORD    5A288700
       CAL     **             GET THE UNIT DENSITY BITS FROM THE UCB    5A288800
       PAI                    PLACE UCB WORD IN INDICATORS              5A288900
       LNT     020100         IS THIS DISK OR TAPE.                     5A289000
       TRA     IXIA3                                                    5A289100
IXIA2  TXI     *+1,4,**                                                 5A289200
IXIB2  CAL     **,4           GET DISK LIMITS.                          5A289300
IXIB3  LDQ     **,4           SWITCH ADDRESS AND                        5A289400
       LGL     18             DECREMENTS OF LIMITS                      5A289500
       STD     IXFIL,1        SET BEGIN. ADDRESS FCB.                   5A289600
       SLW     IXFIL+7,1      SET LIMITS IN FCB.                        5A289700
       CAL     IX.HA          GET HOME ADDRESS.                         5A289800
       SLW     IXFIL+6,1      SET IN FCB.                               5A289900
       CLA     IXFIL+5,1      SET THE DISK FLAG                         5A290000
       SSM                    CODE IN THE                               5A290100
       STO     IXFIL+5,1      FCB BLOCK WORD                            5A290200
       PXD     ,0             SET FOR NO DENSITY ON DISK.               5A290300
       TRA     IXIA6         *CONTINUE BELOW                            5A290400
IXIA3  LNT     020000         IS THIS 729 OR 7340                       5A290500
       TRA     IXIA5          729                                       5A290600
       ALS     12             INTERFACE IS IN BIT 12, UCB WORD 1        5A290700
       STP     IXFIL+2,1      S GETS INTERFACE (0 OR 1)                 5A290800
IXIA4  CAL     IXCB2+1                                                  5A290900
       STP     IXFIL+5,1      DEVICE FLAG  +1 7340                      5A291000
       PXA     0,0            CLEAR AL, INCL DENS. BITS                 5A291100
       TRA     IXIA5+1                                                  5A291200
       REM                    ENTRY FOR TAPE FCB INITIALIZATION         5A291300
IXIA5  CAL     IXIMK          GET THE DENSITY BITS.                     5A291400
       STZ     IXFIL+6,1      INITIALIZE FCB FOR TAPE                   5A291500
       LDQ     IXIRS          OPERATION.                                5A291600
       STQ     IXFIL+7,1                                                5A291700
       REM                    ENTRY FOR DISK OPERATION                  5A291800
IXIA6  ORA     IXIOF          ADD THE READ FLAGS                        5A291900
       SLW     IXFIL+1,1      SET THE FCB CONTROL WORD                  5A292000
IXI7A  AXT     **,4           RESTORE LINKAGE.                          5A292100
       ZET     IXFCC          HAS THE FCB INITIALIZING ROUTINE BEEN     5A292200
       REM                    CALLED BY FCC OR ENTERED IN-LINE.         5A292300
       TRA     1,4           *BY FCC, RETURN TO SAME.                   5A292400
       REM                                                              5A292500
       REM            NOW GO BACK AND INITIALIZE MAIN FCB,IF NEEDED     5A292600
       REM                                                              5A292700
       CLA     IX.DT          TEST FCB INITIALIZATION SW FOR DOTAG      5A292800
       TNZ     IXIA7         *IS MAIN FCB ALREADY INITIALIZED           5A292900
       AXC     IXMFB,1        NO,GET READY FOR MAIN                     5A293000
       STL     IX.DT                                                    5A293100
       AXT     .MAINF,2       LOAD TAPE ASSIGNMENT FOR MAIN FILE.       5A293200
       TRA     IXFCB+2                                                  5A293300
       REM                    YES,ACQUAINT IOCS WITH THE DOTAG AND MAIN 5A293400
       REM                                      FILES                   5A293500
IXIA7  TSX     DEFINE,4       DEFINE THE DOTAG/MAIN POOL                5A293600
       PZE     IXIOB          ORIGIN OF POOL                            5A293700
       PZE     IXNOB,,IXBFZ   NUMBER OF BUFFERS,,BUFFER SIZE            5A293800
IXIA8  TSX     ATTACH,4       ATTACH DOTAG/MAIN FILES TO THE BUFFER POOL5A293900
       PZE     IXIOB          LOCATION OF POOL                          5A294000
       PZE     IXIOL,,2       RESERVE FILE LIST,,NUMBER OF FILES.       5A294100
       REM                                                              5A294200
       REM            NOW OPEN UP THE DOTAG/MAIN FILES                  5A294300
       REM                                                              5A294400
       REM                    OPEN DOTAG FILE                           5A294500
       LDI     IXDFB+1        LOAD FCB CONTROL WORD                     5A294600
       RIL     007000         CLEAR THE MODE BITS                       5A294700
       SIL     005000         SET FOR OUTPUT                            5A294800
       STI     IXDFB+1        SET CW IN FCB                             5A294900
       TSX     OPEN,4         OPEN FILE                                 5A295000
       PZE     IXDFB,,0       FILE NAME,,REWIND.                        5A295100
       REM                    OPEN MAIN FILE                            5A295200
       LDI     IXMFB+1        LOAD FCB CW                               5A295300
       RIL     007000         CLEAR MODE BITS AND SET FOR OUTPUT        5A295400
       SIL     005000                                                   5A295500
       STI     IXMFB+1                                                  5A295600
       TSX     OPEN,4         OPEN FILE                                 5A295700
       PZE     IXMFB,,0       FILE NAME,,REWIND                         5A295800
       STL     IXOOP          SET OUTPUT OPEN SWITCH.                   5A295900
       REM              INITIALIZATION FOR THIS JOB COMPLETE            5A296000
       REM                       RETURN TO FCC                          5A296100
IXISV  AXT     **,1           RESTORE REGISTERS                         5A296200
       AXT     **,2                                                     5A296300
       AXT     **,4                                                     5A296400
       TRA     1,4           *RETURN TO CALLER                          5A296500
       SPACE   2                                                        5A296600
IX.DT  PZE                    FCB INIT. SWITCH FOR DOTAG                5A296700
IXFCC  PZE     0,0,0          CALL FROM FCC FOR INITIALIZATION OF A FCB.5A296800
IX.HA  VFD     O18/401212,18/0 DISK HOME ADDRESS.                       5A296900
IXIMK  PZE     0,3,0          DENSITY BIT MASK                          5A297000
IXFIL  EQU     0              DOTAG/MAIN FILE REFERENCE POINT           5A297100
IXIRS  BCI     1, 0001        REEL SEQUENCE NUMBER                      5A297200
IXIOF  OCT     025000000000   IOCS FLAGS FOR WRITING DOTAG/MAIN FILES.  5A297300
IXNOB  EQU     4              NUMBER OF BUFFERS                         5A297400
.DTAGF EQU     SYSUT1-1       (A3)                                      5A297500
.MAINF EQU     SYSUT3-1       (A4)                                      5A297600
       ORG     O.IXO                                                    5A297700
       EJECT                                                            5A297800
       REM                                                              5A297900
       REM                                                              5A298000
       REM                                                              5A298100
       REM     *********************************************************5A298200
       SPACE   3                                                        5A298300
       REM     *** IXCTL ***                                            5A298400
       REM                                                              5A298500
       REM     ROUTINE THAT CONTROLS THE PLACEMENT AND OUTPUT OF CWDS   5A298600
       REM     OF DOTAG/MAIN FILES.                                     5A298700
       REM     IXCTL ALSO SETS UP THE CONTROL WORDS WITH THE            5A298800
       REM     APPROPRIATE FLAGS SIGNALING-                             5A298900
       REM     1)BEGINNING OF COMPILATION - CALL FROM FCC               5A299000
       REM     2)END OF DO NEST - CALL FROM NESTAG ANALYSIS             5A299100
       REM     3)BEGINNING OF PROLOGUE - CALL FROM RELCON ANALYSIS      5A299200
       REM     4)END OF COMPILATION - CALL FROM FCC                     5A299300
       REM     5)END OF JOB - CALL FROM FCC                             5A299400
       REM     6) BEGINING OF DO NEST - CALL FROM NESTAG.               5A299500
       SPACE   6                                                        5A299600
       REM     *********************************************************5A299700
       SPACE   4                                                        5A299800
IXCTL  SXA     IXCSV,1        SAVE REGISTERS                            5A299900
       SXA     IXCSV+1,2                                                5A300000
       SXA     IXCSV+2,4                                                5A300100
       AXT     6,1            INITIALIZE FOR 6 POSSIBILITIES.           5A300200
       CAL     1,4            PICK UP PARAMETER.                        5A300300
IXCA1  LAS     .C1PFX+6,1     DOES IT MATCH AN ELEMENT IN THE PREFIX TBL5A300400
       TRA     *+2            NO                                        5A300500
       XEC     IXCBR+6,1      YES, TRANSFER OUT AND DO SOMETHING.       5A300600
       TIX     IXCA1,1,1      CONTINUE TO CHECK                         5A300700
       ZAC                    NO MATCH,LOGIC ERROR                      5A300800
IXCA2  TRA     IXCSV          RETURN TO CALLER                          5A300900
       REM                                                              5A301000
       REM       ENTRY POINT FOR BEGINNING OF COMPILATION               5A301100
       REM       APPROPRIATE FLAG IS IN ACC                             5A301200
       REM                                                              5A301300
IXCBC  STP     IXSEQ          SET FLAG IN CELL CONTAINING SEQUENCE NO.  5A301400
       STP     IXSEQ+2        SET FLAG IN WORD COUNT CELL.              5A301500
       REM                    THEREBY COMPLETING CONTROL WORD(1)        5A301600
       CAL     .XDCKN         PICK UP BCI NAME OF PROGRAM.              5A301700
       SLW     IXSEQ+1        SET IN CONTROL WORD(2)                    5A301800
       ZSD     IXSEQ+2        INITIALIZE CONTROL WORD(3) - WORD COUNT.  5A301900
       ZSD     IXMCT          ZERO OUT MAIN FILE WORD COUNT.            5A302000
       ZSD     IXDCT          SAME FOR DOTAG.                           5A302100
       STL     IXCCW          SET SWITCH INDICATING THAT THIS IS A CW.  5A302200
       UPSEQN  IXMSQ          UPDATE MAIN FILE SEQUENCE NUMBER.         5A302300
       WMAIN   IXBC1         $OUTPUT CONTROL WORD SEQUENCE ON MAIN FILE 5A302400
       LOCATE  IXMCW,IXMBP    LOCATE EFFECTIVE ADDRESS TO CONTROL WORD. 5A302500
       STL     IXCCW          SAME FOR DOTAG                            5A302600
       UPSEQN  IXDSQ          UPDATE DOTAG FILE SEQUENCE NUMBER.        5A302700
       WDOTAG  IXBC1          ON DOTAG FILE                             5A302800
       LOCATE  IXDCW,IXDBP    LOCATE EFFECTIVE ADDRESS TO CONTROL WORD. 5A302900
       STZ     IXOIC          RESET INITIAL CALL SWITCH.                5A303000
       CLA     *-1            SET OK FLAG.                              5A303100
IXCSV  AXT     **,1           RETURN TO CALLER                          5A303200
       AXT     **,2                                                     5A303300
       AXT     **,4                                                     5A303400
       STZ     IXCCW          RESET CONTROL WORD SEQUENCE SWITCH        5A303500
       TRA     2,4                                                      5A303600
       REM                                                              5A303700
       REM       ENTRY POINT FOR END OF COMPILATION - FLAG IN ACC       5A303800
       REM                                                              5A303900
IXCEC  STP     IXSEQ          SET FLAG OF CONTROL WORD                  5A304000
       STL     IXCCW          SET CONTROL WORD SEQUENCE SWITCH          5A304100
       UPSEQN  IXDSQ          UPDATE DOTAG FILE SEQUENCE NUMBER.        5A304200
       WDOTAG  IXBC2         $OUTPUT CW ON DOTAG                        5A304300
       LOCATE  IXDCW,IXDBP    LOCATE NEW CW POINTER.                    5A304400
IXCE1  STL     IXCCW          REPEAT FOR MAIN FILE                      5A304500
       UPSEQN  IXMSQ          UPDATE MAIN FILE SEQUENCE NUMBER.         5A304600
       WMAIN   IXBC2         $OUTPUT CW ON MAIN FILE                    5A304700
       CLA     IXMCT          PICK UP NO. OF WORDS INSERTED IN MAIN FILE5A304800
       STD*    IXMBP          UPDATE CONTROL WORD IN MAIN FILE.         5A304900
IXCBL  LOCATE  IXMCW,IXMBP    LOCATE EFFECTIVE ADDRESS TO CONTROL WORD. 5A305000
       TRA     IXCSV-1        RETURN TO CALLER.                         5A305100
       REM                                                              5A305200
       REM       ENTRY POINT FOR BEGINING OF DO NEST - FLAG IN ACC      5A305300
       REM                                                              5A305400
IXCBD  STP     IXSEQ          SET FLAG IN CELL CONTAINING SEQUENCE NO.  5A305500
       STL     IXCCW          SET SWITCH FOR CONTROL WORD SEQUENCE      5A305600
       UPSEQN  IXDSQ          UPDATE DOTAG FILE SEQUENCE NUMBER.        5A305700
       WDOTAG  IXBC2         $OUTPUT CW ON DOTAG FILE                   5A305800
       LOCATE  IXDCW,IXDBP    LOCATE EFFECTIVE ADDRESS TO CONTROL WORD. 5A305900
       TRA     IXCSV-1        RETURN TO CALLER.                         5A306000
       REM                                                              5A306100
       REM       ENTRY POINT FOR END OF COMPILATIONS - PHASE A          5A306200
       REM                                                              5A306300
IXCEJ  TSX     IXEND,4       $TREAT END OF COMPILATIONS CONDITION.      5A306400
       TSX     IXCLS,4       $CLOSE OUT FILES                           5A306500
       TRA     IXCSV-1        RETURN TO CALLER.                         5A306600
       REM                                                              5A306700
       REM       ENTRY POINT FOR END OF DO NEST - FLAG IN ACC           5A306800
       REM                                                              5A306900
IXCED  ORA     IXDCT          PICK UP DOTAG FILE WORD COUNT.            5A307000
       STP*    IXDBP         SET APPROPRIATE FLAG.                      5A307100
       STD*    IXDBP          UPDATE WORD COUNT OF CW ON FILE.          5A307200
       TRA     IXCSV-1        RETURN TO CALLER.                         5A307300
       SPACE   5                                                        5A307400
       REM             GENERAL CONSTANTS AND ERASEABLE FOR IXCTL        5A307500
       SPACE   2                                                        5A307600
       REM     .........................................................5A307700
       SPACE   4                                                        5A307800
       REM                                                              5A307900
       REM                                                              5A308000
       REM     BRANCH TABLE FOR EACH OF THE FUNCTIONS DEFINED BELOW     5A308100
       REM                                                              5A308200
IXCBR  TRA     IXCBD          BEGINING OF DO NEST.                      5A308300
       TRA     IXCEJ          END OF JOB.                               5A308400
       TRA     IXCED          END OF DO NEST.                           5A308500
       TRA     IXCEC          END OF COMPILATION.                       5A308600
       TRA     IXCSV-1                                                  5A308700
       TRA     IXCBC          BEGINING OF COMPILATION.                  5A308800
IXSEQ  PZE     **,,**         SEQUENCE NUMBER,,WORD COUNT  -1           5A308900
       PZE     **             BCI NAME OF PROGRAM         -2 -3 WD. BUFR5A309000
       PZE     **             WORD COUNT                   -3  FOR CWDS.5A309100
IXBC1  MZE     IXSEQ,,3       PARAMETER LIST 1 - BEGINNING LOC.,,WD.CNT.5A309200
IXBC2  MZE     IXSEQ,,1       PARAMETER LIST 2                          5A309300
IXCCW  PZE     **             SWITCH SIGNALLING OUTPUT ROUTINE THAT     5A309400
       REM                    WHAT FOLLOWS IS A CONTROL WORD(S)         5A309500
IXMBP  PZE     **             MAIN FILE CONTROL WORD POINTER.           5A309600
IXDBP  PZE     **             DITTO FOR DOTAG.                          5A309700
       EJECT                                                            5A309800
       SPACE   4                                                        5A309900
       REM     THIS ROUTINE IS THE BASIC OUTPUT ROUTINE FOR THE         5A310000
       REM     DOTAG AND MAIN FILES.                                    5A310100
       REM     COMMUNICATION TO THIS ROUTINE IS PROVIDED BY             5A310200
       REM     THE TWO MACROS-                                          5A310300
       REM            1) WDOTAG    LOC(P)                               5A310400
       REM            2) WMAIN     LOC(P)                               5A310500
       REM     WHERE LOC(P)  IS THE LOCATION OF A PARAMETER LIST        5A310600
       REM     INDICATING WHERE THE INFORMATION TO BE OUTPUT CAN        5A310700
       REM     BE FOUND.                                                5A310800
       REM     *********************************************************5A310900
       SPACE   5                                                        5A311000
       REM       ENTRY POINT FOR MAIN FILE OUTPUT                       5A311100
       REM                                                              5A311200
IXMNO  STL     IXOFS          SET THE FILE SWITCH FOR MAIN              5A311300
       TRA     IXOAA          CONTINUE BELOW                            5A311400
       REM                                                              5A311500
       REM       ENTRY POINT FOR DOTAG FILE OUTPUT                      5A311600
       REM                                                              5A311700
IXDTO  STZ     IXOFS          RESET THE FILE SWITCH FOR DOTAG           5A311800
IXOAA  SXA     IXOSV,1       *SAVE REGISTERS                            5A311900
       SXA     IXOSV+1,2                                                5A312000
       SXA     IXOSV+2,4                                                5A312100
       CLA     1,4            GET ARGUMENT                              5A312200
       PAC     0,4            LOAD LOCATION OF ARGUMENT                 5A312300
IXOAB  CAL     IXDCW          PICK UP DOTAG BUFFER CONTROL WORD.        5A312400
       ZET     IXOFS          IS IT A CALL FOR MAIN OR DOTAG.           5A312500
IXOAC  CAL     IXMCW         *MAIN, PICK UP BUFFER CONTROL WORD.        5A312600
IXOAD  PDX     0,2            *DOTAG,PLACE COUNT OF WORDS LEFT IN IR 2. 5A312700
       STA     IXOA4          INITIALIZE MOVING LOOP                    5A312800
IXOA0  CLA     0,4           *YES, PICK UP A PARAMETER                  5A312900
       TPL     *+2            IS IT THE LAST, NO.                       5A313000
       STL     IXOEP         *YES,SET THE EPL SWITCH.                   5A313100
       PDX     0,1           *NO, LOAD THE SEGMENT WORD COUNT.          5A313200
       PXA     0,1            PLACE IN ACC ADDRESS FOR COMPUTATION.     5A313300
       ADM     0,4            COMPUTE A REFERENCE ADDRESS.              5A313400
       STA     IXOA3          INITIALIZE MOVING LOOP.                   5A313500
       ZET     IXCCW          IS THIS A CONTROL WORD SEQUENCE.          5A313600
       TXL     *+2,2,2       *YES, ARE THERE AT LEAST 3 WORDS LEFT,NO.  5A313700
IXOA1  TXH     IXOA3,2,0     *IS A NEW BUFFER NEEDED, NO.               5A313800
       SXA     IXOA2,4       *YES.                                      5A313900
       TSX     IXLOC,4       $GET ONE.                                  5A314000
IXOA2  AXT     **,4           RESTORE IR4                               5A314100
IXOA3  CAL     **,1           GET A WORD OF ENTRY                       5A314200
IXOA4  SLW     **,2           STORE IT IN DOTAG/MAIN FILES BUFFER.      5A314300
       TXI     *+1,2,-1       UPDATE BUFFER COUNT.                      5A314400
       TIX     IXOA1,1,1     *SEGMENT MOVED., NO.                       5A314500
       NZT     IXOEP         *YES, END OF PARAMETER LIST YET.           5A314600
       TXI     IXOA0,4,-1     NO, GET NEXT SEGMENT.                     5A314700
       CLA     IXCCW         *YES, HAVE WE JUST INSERTED A CW SEQUENCE. 5A314800
       TZE     IXOA5         *NO, COMPUTE A MAIN OR DOTAG FILE WORD CNT.5A314900
       NZT     IXOFS         *YES,ON MAIN OR DOTAG.                     5A315000
       TRA     *+3           *DOTAG.                                    5A315100
       SXA     IXOA5,2       *MAIN, SAVE MAIN FILE BUFFER WORD COUNT.   5A315200
       TRA     IXOA7          CONTINUE BELOW.                           5A315300
       SXA     IXOA6,2       *DOTAG, SAVE DOTAG FILE BUFFER WORD COUNT. 5A315400
       TRA     IXOA9          CONTINUE BELOW.                           5A315500
IXOA5  AXT     **,1           LOAD SAVED BUFFER WORD COUNT (MAIN).      5A315600
       NZT     IXOFS          ARE WE IN FACT WRITING MAIN FILE.         5A315700
IXOA6  AXT     **,1          *NO, LOAD SAVED WORD COUNT (DOTAG).        5A315800
       SXD     *+1,2         *YES, COMPUTE THE NO. OF WORDS             5A315900
       TNX     *+1,1,**       JUST PUT IN BUFFER.                       5A316000
       NZT     IXOFS          IS THIS WORD COUNT (XR 1) FOR THE MAIN    5A316100
       REM                    OR DOTAG FILE.                            5A316200
       TRA     IXOA8         *DOTAG.                                    5A316300
       SXD     IXMCT,1       *MAIN.                                     5A316400
IXOA7  SXD     IXMCW,2        SAVE BUFFER WORD COUNT IN MAIN FILE CW.   5A316500
       TRA     *+3                                                      5A316600
IXOA8  SXD     IXDCT,1       *DOTAG, SAVE CW WORD COUNT.                5A316700
IXOA9  SXD     IXDCW,2        SAVE BUFFER WORD COUNT IN DOTAG FILE CW.  5A316800
       STZ     IXOFS          RESET FILE SWITCH                         5A316900
       STZ     IXOEP          RESET END OF PARAMETER LIST FLAG          5A317000
       CLA     *-1            SET OK FLAG                               5A317100
IXOSV  AXT     **,1           RESTORE LINKAGE                           5A317200
       AXT     **,2                                                     5A317300
       AXT     **,4                                                     5A317400
       TRA     2,4            RETURN TO CALLER.                         5A317500
       SPACE   5                                                        5A317600
       REM     .........................................................5A317700
       REM                                                              5A317800
       REM        CONSTANTS AND ERASABLE FOR IXMNO. IXDTO.              5A317900
       SPACE   4                                                        5A318000
IXOEP  PZE     **             END OF PARAMETER LIST FLAG                5A318100
IXDCT  PZE     **             WORD COUNT FOR CONTROL WRODS ON DOTAG FILE5A318200
IXMCT  PZE     **             WD. COUNTER FOR CONTROL WORDS ON MAIN FILE5A318300
       EJECT                                                            5A318400
       SPACE   4                                                        5A318500
       REM     THIS ROUTINE LOCATES AN IOCS BUFFER.                     5A318600
       REM     IT IS INTERNAL TO THE INTERNAL TEXT OUTPUT               5A318700
       REM     ROUTINES.                                                5A318800
       REM     *********************************************************5A318900
       SPACE   5                                                        5A319000
IXLOC  SXA     IXLSV,1        SAVE LINKAGE                              5A319100
       SXA     IXLSV+1,4                                                5A319200
       CLA     IXOIC          IS THIS THE INITIAL CALL                  5A319300
       TZE     IXLA0         *NO.,TRANSFER TO IXLA0                     5A319400
       MNODT   IXLA2,IXLA4   *YES., MAIN OR DOTAG                       5A319500
IXLA0  LXA     IXOA6,1        LOAD NO. OF WORDS IN DOTAG FILE FROM      5A319600
       REM                    LAST CONTROL WORD TO END OF BUFFER.       5A319700
       SXD     *+1,2          ADJUST TO ACCOUNT FOR EXTRANEOUS          5A319800
       TNX     *+1,1,**       WORDS REMAINING IN BUFFER.                5A319900
       NZT     IXOFS          ARE WE IN FACT LOCATING A DOTAG BUFFER.   5A320000
       TRA     IXLA3         *YES, XR 1 IS LOADED CORRECTLY.            5A320100
       LXA     IXOA5,1       *NO, RELOAD XR 1 WITH PROPER WORD COUNT.   5A320200
       SXD     *+1,2          ADJUST IT.                                5A320300
       TNX     *+1,1,**                                                 5A320400
IXLA1  PXD     0,1           *MAIN, UPDATE LAST CONTROL WORD.           5A320500
       STD*    IXMBP                                                    5A320600
       PXD     ,2                                                       5A320700
       SBM     IXBSZ                                                    5A320800
       STD     IXMCW          SET IN OUTPUT CONTROL WORD.               5A320900
       REM           INITIAL CALL AND MAIN FILE                         5A321000
IXLA2  LXD     IXBSZ,2        LOAD THE BUFFER SIZE                      5A321100
       TSX     WRITE,4        GET NEXT BUFFER                           5A321200
       PZE     IXMFB,,IXE01   FILE NAME,,EOB EXIT.                      5A321300
IXMCW  IOSTN   **,,**         MAIN FILE BUFFER CONTROL WORD - ADDR,,WDCT5A321400
       PXA     ,2             PLACE BUFFER WORD COUNT IN AC             5A321500
       ADM     IXMCW          COMPUTE A REFERENCE ADDRESS.              5A321600
       STA     IXOA4          INITIALIZE MOVING LOOP ADDRESS.           5A321700
       STA     IXMCW          INITIALIZE BUFFER CONTROL WORD.           5A321800
       TRA     IXLA5          TRANSFER AROUND DOTAG CONDITION           5A321900
IXLA3  PXD     ,1            *DOTAG, UPDATE LAST CONTROL WORD.          5A322000
       STD*    IXDBP                                                    5A322100
       PXD     ,2                                                       5A322200
       SBM     IXBSZ                                                    5A322300
       STD     IXDCW                                                    5A322400
       REM            INITIAL CALL AND DOTAG FILE                       5A322500
IXLA4  LXD     IXBSZ,2                                                  5A322600
       TSX     WRITE,4        LOCATE NEXT BUFFER                        5A322700
       PZE     IXDFB,,IXE01   FILE NAME,,EOB EXIT.                      5A322800
IXDCW  IOSTN   **,,**         DOTAG FILE BUFFR CONTROL WORD - ADDR,,WDCT5A322900
       PXA     0,2            COMPUTE A REFERENCE ADDRESS.              5A323000
       ADM     IXDCW                                                    5A323100
       STA     IXOA4          SET IT IN MOVING LOOP ADDRESS             5A323200
       STA     IXDCW          SET IT IN BUFFER CONTROL WORD.            5A323300
IXLA5  ZET     IXCCW          IS THERE A CW SEQUENCE WAITING IN THE     5A323400
       REM                    OUTPUT ROUTINE.                           5A323500
       TRA     IXLSV         *YES, RETURN TO CALLER.                    5A323600
IXLA6  NZT     IXOFS         *NO, MAIN FILE OR DOTAG FILE.              5A323700
       TRA     IXLA7         *DOTAG, CONTINUE BELOW.                    5A323800
       UPSEQN  IXMSQ          UPDATE MAIN FILE SEQUENCE NUMBER.         5A323900
       CLA     IXSEQ         *NO, OUTPUT CONTINUATION CONTROL WORD.     5A324000
       ANA     .MADDR         OBTAIN SEQUENCE NUMBER.                   5A324100
       SLW*    IXOA4          STORE THE WORD IN THE BUFFER.             5A324200
       TXI     *+1,2,-1       UPDATE BUFFER WORD COUNT.                 5A324300
       SXA     IXOA5,2        SAVE BUFFER WORD COUNT FOR FUTURE         5A324400
       SXD     IXMCW,2        COMPUTATION.                              5A324500
       LOCATE  IXMCW,IXMBP    COMPUTE EFFECTIVE ADDRESS TO SAME.        5A324600
       TRA     IXLSV          RETURN TO CALLER.                         5A324700
IXLA7  UPSEQN  IXDSQ        UPDATE DOTAG FILE SEQUENCE NUMBER.          5A324800
       CLA     IXSEQ         *NO, OUTPUT CONTINUATION CONTROL WORD.     5A324900
       ANA     .MADDR         OBTAIN SEQUENCE NUMBER.                   5A325000
       SLW*    IXOA4          STORE THE WORD IN THE BUFFER.             5A325100
       TXI     *+1,2,-1       UPDATE BUFFER WORD COUNT.                 5A325200
       SXA     IXOA6,2        SAVE BUFFER WORD COUNT FOR FUTURE         5A325300
       SXD     IXDCW,2        COMPUTATION.                              5A325400
       LOCATE  IXDCW,IXDBP    COMPUTE EFFECTIVE ADDRESS TO SAME.        5A325500
IXLSV  AXT     **,1           RESTORE LINKAGE.                          5A325600
       AXT     **,4                                                     5A325700
       TRA     1,4            RETURN TO CALLER.                         5A325800
       SPACE   5                                                        5A325900
IXOIC  PZE     **             INITIAL CALL SWITCH.                      5A326000
       EJECT                                                            5A326100
       SPACE   5                                                        5A326200
       REM     THIS ROUTINE  TREATS THE END OF COMPILATION(S)           5A326300
       REM                      CONDITION.                              5A326400
       SPACE   4                                                        5A326500
       REM     *********************************************************5A326600
       SPACE   2                                                        5A326700
IXEND  SXA     IXESV,1        SAVE REGISTERS                            5A326800
       SXA     IXESV+1,2                                                5A326900
       SXA     IXESV+2,4                                                5A327000
       STZ     IX.DT          SET ROUTINE FOR DOTAG                     5A327100
       CAL     IXEDT          INITIALIZATION                            5A327200
       STA     IXEA1          X                                         5A327300
       CAL     IXDCW          X                                         5A327400
IXEA0  STA     IXOA4          INITIALIZE MOVING LOOP                    5A327500
       PDX     ,2             LOAD BUFFER WORD COUNT                    5A327600
       CAL     IXBSZ          GET BUFFER SIZE                           5A327700
IXEA1  SBM     **             COMPUTE THE NUMBER OF USED WORDS.         5A327800
       PDX     ,4             LOAD BUFFER LENGTH                        5A327900
       TXH     IXEB1,4,3      ARE THERE MORE THAN 3 WORDS, YES.         5A328000
       AXT     3,1            NO., INITIALIZE PADDING INDEX             5A328100
       CAL     IXOFL          ADD PADDING TO THE                        5A328200
       SLW*    IXOA4          BUFFER (ALL ONES)                         5A328300
       TXI     *+1,2,-1       UPDATE BUFFER INDEX.                      5A328400
       TIX     *-2,1,1       *PADDING ALL DONE, NO CONTINUE.            5A328500
       TXI     *+1,4,3        YES. UPDATE BUFFER WORD COUNT             5A328600
IXEB1  CLA     IX.DT         * HAS THE MAIN FILE BEEN TAKEN CARE OF YET.5A328700
       TNZ     IXEA2          YES.                                      5A328800
       REM                    NO,INITIALIZE FOR MAIN FILE               5A328900
       SXD     IXEA3,4        INITIALIZE DOTAG I/O COMMAND              5A329000
       CAL     IXEMN                                                    5A329100
       STA     IXEA1                                                    5A329200
       CAL     IXMCW          PICK UP MAIN BUFFER CW                    5A329300
       STL     IX.DT          SET ROUTINE FOR MAIN.                     5A329400
       TRA     IXEA0          GO BACK AND TAKE CARE OF MAIN FILE        5A329500
IXEA2  SXD     IXEA4,4        INITIALIZE MAIN I/O COMMAND               5A329600
       TSX     WRITE,4        BRING IOCS UP TO DATE FOR DOTAG           5A329700
       PZE     IXDFB,,0       TABLE FCB.                                5A329800
IXEA3  IOSTN   **,,**         BUFFER,,WORD COUNT                        5A329900
       TSX     WRITE,4        NOW FOR MAIN FILE                         5A330000
       PZE     IXMFB,,0                                                 5A330100
IXEA4  IOSTN   **,,**                                                   5A330200
IXESV  AXT     **,1           RESTORE REGS.                             5A330300
       AXT     **,2                                                     5A330400
       AXT     **,4                                                     5A330500
       TRA     1,4            RETURN TO CALLER                          5A330600
       SPACE   5                                                        5A330700
       REM        CONSTANTS AND ERASEABLE                               5A330800
       REM     .........................................................5A330900
       SPACE   4                                                        5A331000
IXEDT  PZE     IXDCW          POINTER TO DOTAG BUFFER CONTROL W3RD.     5A331100
IXEMN  PZE     IXMCW          POINTER TO MAIN FILE BUFFER CONTROL WORD. 5A331200
IXOFL  EQU     .CONES         PADDING FOR DOTAG/MAIN FILES.             5A331300
       EJECT                                                            5A331400
       REM     ** IXCLS **  THIS ROUTINE CLOSES THE DOTAG/MAIN FILES    5A331500
       REM                  THE FILES ARE CLOSED AT THE FOLLOWING TIMES-5A331600
       REM                  1) END OF COMPILATIONS - PHASE A            5A331700
       REM                  2) END OF COMPILATIONS- PHASE B             5A331800
       REM                  3) END OF JOB                               5A331900
       SPACE   5                                                        5A332000
IXCLS  SXA     IXCB3,4        SAVE LINKAGE.                             5A332100
       ZET     IXOOP          ARE DOTAG/MAIN FILES OPEN FOR I/O         5A332200
       TRA     IXCB2         *YES,CONTINUE BELOW                        5A332300
       ZET     IXOIN                                                 (1)5A332400
       TRA     IXCB3         *NO,NOTHING TO CLOSE, EXEUNT.              5A332500
IXCB2  TSX     CLOSE,4        CLOSE DOTAG/MAIN FILES                    5A332600
*  PREFIX OF NEXT INSTRUCTION IS USED BY IXIA4 IN IXINT                 5A332700
       PTW     IXDFB,,0       FILE NAME,,REWIND                         5A332800
       TSX     CLOSE,4        CLOSE MAIN                                5A332900
       PTW     IXMFB,,0                                                 5A333000
       STZ     IXOOP          RESET OUTPUT OPEN FLAG.                   5A333100
       STZ     IXOIN          RESET INPUT OPEN FLAG.                    5A333200
IXCB3  AXT     **,4           RESTORE LINKAGE                           5A333300
       TRA     1,4           *RETURN TO CALLER                          5A333400
       SPACE   3                                                        5A333500
IXIOB  BSS     IXNOB*IXBFZ+2*IXNOB+2  IOCS BUFFERS                      5A333600
IXBSZ  SEVEN   -1,7,200       BUFFER SIZE CONSTANT                      5A333700
       EJECT                                                            5A333800
       SPACE   4                                                        5A333900
       REM     ** IXPBE **                                              5A334000
       REM                                                              5A334100
       REM     THIS ROUTINE IS CALLED BY PHASE + CONTROL FOR            5A334200
       REM     PURPOSES OF ADVANCING (SKIPPING) THE MAIN AND            5A334300
       REM     DOTAG FILES OVER A COMPILATION(S) FOR WHICH              5A334400
       REM     THERE CORRESPONDS LEVEL 4 OR 5 ERROR(S) IN               5A334500
       REM     PHASE A OR B , OR WHEN THE END OF COMPILATION FLAG HAS   5A334600
       REM     NOT BEEN READ BY THE ASSEMBLER.  UPON EXIT FROM THIS     5A334700
       REM     ROUTINE BOTH FILES ARE POSITIONED PROPERLY .             5A334800
       SPACE   2                                                        5A334900
       REM     *********************************************************5A335000
       SPACE   2                                                        5A335100
IXPBE  SXA     IXPBS,4        SAVE LINKAGE.                             5A335200
       ZET     .MFSW          IS IT NECESSARY TO ADVANCE THE MAIN FILE. 5A335300
       TRA     IXPBC         *NO.  TEST FOR DOTAG.                      5A335400
       REM                                                              5A335500
       REM        ADVANCE MAIN FILE.                                    5A335600
       REM                                                              5A335700
IXPBA  RMAIN   IXPBC         $READ MAIN FILE UNTIL AN END OF COMPILATION5A335800
       TRA     IXPBA          EXIT IS ENCOUNTERED.                      5A335900
       SPACE   2                                                        5A336000
IXPBC  ZET     .DTSW         *IS IT NECESSARY TO ADVANCE THE DOTAG FILE.5A336100
       TRA     IXPBS         *NO, EXEUNT.                               5A336200
       REM                                                              5A336300
       REM        ADVANCE DOTAG FILE.                                   5A336400
       REM                                                              5A336500
IXPBB  RDOTAG  IXPBS         $READ DOTAG.                               5A336600
       TRA     IXPBB          READ SOME MORE                            5A336700
       REM                                                              5A336800
       REM        BOTH FILES ARE NOW POSITIONED PROPERLY                5A336900
       REM                                                              5A337000
IXPBS  AXT     **,4           RESTORE LINKAGE.                          5A337100
       TRA     1,4           *RETURN TO CALLER.                         5A337200
       REM                                                              5A337300
       REM             DIAGNOSTIC MESSAGES                              5A337400
       REM                                                              5A337500
       REM     .........................................................5A337600
       SPACE   3                                                        5A337700
IXE01  DIAGN   0,IX01L,IX01D  EOB ON OUTPUT OF DOTAG/MAIN FILES.        5A337800
       TRA     IXERR          TO ERROR ROUTINE.                         5A337900
IX01L  EQU     4                                                        5A338000
       SPACE   2                                                        5A338100
       REM     AN ERROR HAS BEEN DETECTED WHILST READING OR WRITING     5A338200
       REM     THE INTERNAL FILES.......................................5A338300
       REM                ABANDON COMPILATION                           5A338400
       SPACE   2                                                        5A338500
IXERR  TSX     XCCLS,4       $CLOSE OUT THE CONDIG TABLE.               5A338600
       AXT     2,1            SET PHASE INDICATOR TO 2  (PHASE B DONE)  5A338700
       SXA     FCPHAS,1                                                 5A338800
       TRA     FC00N         *QUIT COMPILING  ---  RETURN TO FCC.       5A338900
       SPACE   2                                                        5A339000
       TTL     ** FCC ** FORTRAN COMPILER CONTROL **                    5A339100
.FCC.. SAVE    (1,2)I                                                   5A339200
       TSX     SYSIDR,4       CALL ACCOUNTING ROUTINE.                  5A339300
       PON     0,1,0                                                    5A339400
       TSX     IXINT,4        INITIALIZE DOTAG AND MAINFIELE.           5A339500
       AXC     FC3FL,1        SET FILE CONTROL BLOCK FOR THIRD FILE.    5A339600
       AXT     .FCNME,2       X                                         5A339700
       TSX     IXFCB,4        X                                         5A339800
       STZ     XC.RK          RESET NUMBER OF COMPILATION.              5A339900
       STZ     FCPHAS         RESET PHASE INDICATOR.                    5A340000
       STZ     DGPER          RESET GENERAL ERROR LEVEL CELL.           5A340100
       STZ     CONDIG         SET CONDIG.TABLE.                         5A340200
       LXA     OCPHAF,4       X                                         5A340300
       SXA     CONDIG+1,4     X                                         5A340400
       SXA     CONDIG,4       X                                         5A340500
       AXC     FREGB,4        INITIALIZE THE STATEMENT                  5A340600
       PXA     ,4             ASSEMBLY ROUTINE.                         5A340700
       STA*    UARB1                                                    5A340800
       AXC     FREGE+1,4      X                                         5A340900
       PXD     ,4                                                       5A341000
       STD*    UARC1                                                    5A341100
FC00N  LXA     FCPHAS,4       UPDATE PHASE INDICATOR AND                5A341200
       TXI     *+1,4,1        GIVE CONTROL TO CORRECT PHASE.            5A341300
       SXA     FCPHAS,4       X                                         5A341400
       TXL     FC01N,4,1      X PHASE A.                                5A341500
       TXL     FC02N,4,2      X PHASE B.                                5A341600
       NZT     DGPER          X DIAG OR END OF PROCESSING.              5A341700
       TRA     FC05N                                                    5A341800
       CALL    ACTION(FCDGN)  $READ IN DIAG RECORD.                     5A341900
       TSX     DGENT,4        $ PRINT ERROR MESSAGES.                   5A342000
FC05N  TRA     FCPTC0                                                (1)5A342100
       RETURN  .FCC..                                                   5A342200
FC01N  TSX     PHASA,4         PHASE A.                                 5A342300
       TRA     FC00N                                                    5A342400
FC02N  CALL    ACTION(FCPHB) $READ IN PHASE B.                          5A342500
       STZ     XB.RK           RESET NUMBER OF ASSEMBLIES.              5A342600
       TSX     IXPBI,4         INITIALIZE DOTAG AND MAIN FILE.          5A342700
       TSX     PHASB,4        $ PHASE B.                                5A342800
       TRA     FC00N                                                    5A342900
.FCNME SYN     SYSUT4-1                                                 5A343000
FCDGN  BCI     1,DIAGR                                                  5A343100
FCPHB  BCI     1,PHB                                                    5A343200
       TTL     TABLE ROUTINES.                                          5A343300
*                                                                       5A343400
*      CONSTANTS,ETC.                                                   5A343500
*                                                                       5A343600
       SPACE                                                            5A343700
TRBFN  EQU     TRBSZ          BUFFER SIZE                               5A343800
TRBFP  EQU     TRBFN+1        BUFFER SIZE + 1                           5A343900
TRDC1  EQU     .C1DEC         ONE IN DECREMENT                          5A344000
TR3AD  EQU     .C3ADD         THREE IN ADDRESS                          5A344100
       SPACE   2                                                        5A344200
TRBSP  PZE     TRBFP          BUFFER SIZE + 1 IN ADDRESS FIELD.         5A344300
TRBFPD PZE     0,0,TRBFP      BUFFER SIZE + 1 IN DECREMENT FIELD        5A344400
       SPACE   2                                                        5A344500
*      HASH CONTROLS  (THE ORDER OF THESE CARDS IS IMPORTANT)           5A344600
       SPACE                                                            5A344700
TRHIN  PZE     HTASZ          SIZE OF NAME/EFN HASH TABLE               5A344800
TRHDN  PZE     HTBSZ          SIZE OF TA1/TSC HASH TABLE                5A344900
TRHTN  PZE     HTCSZ          SIZE OF TA2 HASH TABLE                    5A345000
       SPACE                                                            5A345100
TRLIL  PZE     **             ORG. OF NAME/EFN HASH TABLE.              5A345200
TRLDL  PZE     **             ORG. OF TA1/TSC HASH TABLE.               5A345300
TRLTL  PZE     **             ORG. OF TA2 HASH TABLE.                   5A345400
       SPACE   2                                                        5A345500
TREXI  PZE     **             INDICATOR, EXTRA SPACE AVAILABLE IF ON    5A345600
TRNHL  PZE     **,,**         LIMITS OF EXTRA SPACE.                    5A345700
       SPACE                                                            5A345800
TRBFL  OCT     777777777777   END-OF-TABLE FLAG                         5A345900
       EJECT                                                            5A346000
*                                                                       5A346100
*      ERROR ROUTINES.                                                  5A346200
*                                                                       5A346300
       SPACE                                                            5A346400
TRER1  TSX     DIAG,4         TABLE SPACE EXHAUSTED                     5A346500
       PZE     0,5,TR01D      SOURCE ERROR, LEVEL 5 . NO RETURN         5A346600
       SPACE                                                            5A346700
TRER2  TSX     DIAG,4         LOGICAL ERROR IN PROCESSING.              5A346800
       MZE     0,5,TR02D      LEVEL 5 . NO RETURN                       5A346900
       HTR     *              RETURN STOPS HERE                         5A347000
       EJECT                                                            5A347100
*      INITIALIZATION ROUTINES                                          5A347200
*                                                                       5A347300
*      TR1IA   INITIALIZE AT START OF PHASE A                           5A347400
       SPACE                                                            5A347500
TR1IA  SXA     TR1IX,4        SAVE REGISTERS                            5A347600
       SPACE                                                            5A347700
       AXC     O.TRN,4        ZERO THRU FOR NON-INTERPHASE TABLES       5A347800
TR1IB  STZ     0,4            X                                         5A347900
       TXI     *+1,4,-4       X                                         5A348000
       TXH     TR1IB,4,-O.TRNZ                                          5A348100
       SPACE                                                            5A348200
       ZAC                    SET THRU FOR INTERPHASE TABLES            5A348300
       SSM                    TO MINUS ZERO                             5A348400
       AXC     O.TRI,4        X                                         5A348500
TR1IC  STO     0,4            X                                         5A348600
       TXI     *+1,4,-4       X                                         5A348700
       TXH     TR1IC,4,-O.TRIZ                                          5A348800
       SPACE                                                            5A348900
       LXD     CONDIG,4       TOP OF CONDIG TABLE                       5A349000
       TXI     *+1,4,1        PLUS ONE                                  5A349100
       SXA     TRLDL,4        AS ORIGIN OF DO-HASH-TABLE                5A349200
       TXI     *+1,4,HTBSZ    PLUS DO-HASH-TABLE SIZE                   5A349300
       SXA     TRLTL,4        AS ORIGIN OF TA2 HASH TABLE               5A349400
       SXA     TR1IG,4        INITIALIZE BELOW                          5A349500
       TXI     *+1,4,HTCSZ    PLUS TA2 HASH-TABLE SIZE                  5A349600
       SXA     TRHLS,4        AS LOWER LIMIT OF TABLE SPACE             5A349700
       SXA     TR1IE,4        INITIALIZE BELOW.                         5A349800
       SPACE                                                            5A349900
       AXT     O.CMPT,4       BOTTOM OF CONTROL BLOCK                (8)5A350000
       TXI     *+1,4,-HTASZ   MINUS IP-HASH SIZE                        5A350100
       SXA     TRLIL,4        AS ORIGIN OF IP HASH TABLE.               5A350200
       TXI     *+1,4,-1       MINUS ONE                                 5A350300
       SXD     TRHLS,4        UPPER LIMIT OF TABLE SPACE                5A350400
       SPACE                                                            5A350500
       STZ     TRNUL          NULL STRING EMPTY                         5A350600
       STZ     TREXI          EXTRA-SPACE INDICATOR OFF                 5A350700
       SPACE                                                            5A350800
       AXT     HTASZ,4        ZERO IP HASH TABLE                        5A350900
       STZ     O.CMPT,4       X                                      (8)5A351000
       TIX     *-1,4,1        X                                         5A351100
       SPACE                                                            5A351200
       AXT     HTCSZ,4        ZERO TA2 HASH TABLE                       5A351300
TR1IE  STZ     **,4           X                                         5A351400
       TIX     *-1,4,1        X                                         5A351500
       SPACE                                                            5A351600
TR1IF  AXT     HTBSZ,4        ZERO DO HASH TABLE                        5A351700
TR1IG  STZ     **,4           X                                         5A351800
       TIX     *-1,4,1        X                                         5A351900
       SPACE                                                            5A352000
TR1IX  AXT     **,4                                                     5A352100
       TRA     1,4                                                      5A352200
       EJECT                                                            5A352300
*      TR2IA   CLEAN UP AFTER DO-PROCESSING                             5A352400
       SPACE                                                            5A352500
TR2IA  SXA     TR1IX,4        SAVE REGISTER                             5A352600
       REM                    KILL ALL DO-REST TABLES                   5A352700
       KILTAB  (TA1,TB1,TBD,TKN,TN1,TN2,TPD,TSC)                        5A352800
       TRA     TR1IF          GO TO CLEAR DO-HASH TABLE.                5A352900
       EJECT                                                            5A353000
*      TR3IA   CLEAN UP AFTER PHASE A                                   5A353100
*                                                                       5A353200
*                                                                       5A353300
TR3IA  SXA     TR3IZ,4        SAVE IR 4                                 5A353400
       CAL     TRHLS          IF LIMITS HAVE NOT CROSSED,               5A353500
       PAX     0,4            NO NEED FOR NULL STRING                   5A353600
       STD     *+1            X                                         5A353700
       TXH     TR3IB,4,**     IS LOWER LIMIT HIGHER THAN UPPER          5A353800
       STZ     TRNUL          NO, KILL NULL STRING                      5A353900
       TRA     TR3IZ          GO TO EXIT                                5A354000
       SPACE                                                            5A354100
*      KILL ALL NON-INTERPHASE TABLES.                                  5A354200
       SPACE                                                            5A354300
TR3IB  STD     TR3IH          INITIALIZE BELOW.                         5A354400
       SXA     TR3IX,1        SAVE IR1, SI                              5A354500
       STI     TR3IS          X                                         5A354600
       SPACE                                                            5A354700
       AXT     O.TRN,1        FIRST NON-INTERPHASE TABLE                5A354800
TR3IC  SXA     TR3ID,1        INITIALIZE.                               5A354900
       TSX     TKTBA,4        KILL.                                     5A355000
TR3ID  PZE     **             X                                         5A355100
       TXI     *+1,1,4        NEXT.                                     5A355200
       TXL     TR3IC,1,O.TRNZ-1  LOOP.                                  5A355300
       EJECT                                                            5A355400
*      ALL NON-INTERPHASE BUFFERS NOW IN NULL STRING                    5A355500
*      SELECT THOSE ABOVE UPPER LIMIT                                   5A355600
*      MAKE NEW NULL STRING OF SELECTED BUFFERS.                        5A355700
       SPACE                                                            5A355800
       CLA     TRNUL          PICK UP THW FOR NULL                      5A355900
       STZ     TRNUL          CLEAR TO START AFRESH.                    5A356000
       TRA     TR3IG          CONTINUE                                  5A356100
       SPACE                                                            5A356200
TR3IE  PAC     0,1            PICK UP NEXT BHW                          5A356300
       CLA     0,1            X                                         5A356400
TR3IG  PAX     0,1            LOC. OF FOLLOWING BUFFER IN IR1           5A356500
       TXL     TR3IX,1,0      IF ZERO, NO MOVE, OUT                     5A356600
TR3IH  TXL     TR3IE,1,**     IF LOWER THAN LIMIT, GO TO NEXT           5A356700
       SXA     TR3IP,1        SELECT THIS BUFFER, TREAT AS TABLE        5A356800
       SXD     TR3IP,1        OF ONE BUFFER. SET UP DUMMY THW           5A356900
       LDI*    TR3IP          C(BHW) OF SELECTED BUFFER IN SI           5A357000
       STZ*    TR3IP          CLEAR BHW.                                5A357100
       TSX     TKTBA,4        KILL DUMMY TABLE, I.E. ATTACH             5A357200
       PZE     TR3IP          BUFFER TO NULL.                           5A357300
       PIA                    C(BHW) BACK TO AC                         5A357400
       TRA     TR3IG          CONTINUE                                  5A357500
       SPACE   2                                                        5A357600
TR3IX  AXT     **,1           EXIT, RELOAD IR1                          5A357700
       LDI     TR3IS          RELOAD SI                                 5A357800
TR3IZ  AXT     **,4           RELOAD IR4                                5A357900
       TRA     1,4            RETURN                                    5A358000
       SPACE   3                                                        5A358100
TR3IS  PZE     **             STORAGE FOR SI                            5A358200
TR3IP  PZE     **,,**         DUMMY THW                                 5A358300
       EJECT                                                            5A358400
*              PATCH SPACE FOR PHASE A                              (12)5A358500
*                                                                   (12)5A358600
       SPACE                                                            5A358700
       BSS     1              USED FOR PATCH IN ASSEMBLY E          (15)5A358800
       SPACE                                                        (12)5A358900
       BSS     12             USED FOR PATCH IN ASSEMBLY C.         (12)5A359600
       BSS     7              USED FOR PATCH IN ASSEMBLY C.         (16)5A359700
       STR                    AVAILABLE PATCH SPACE                 (12)5A360400
       STR                    AVAILABLE PATCH SPACE                 (12)5A360500
       STR                    AVAILABLE PATCH SPACE                 (12)5A360600
       STR                    AVAILABLE PATCH SPACE                 (12)5A360700
       STR                    AVAILABLE PATCH SPACE                 (12)5A360800
       STR                    AVAILABLE PATCH SPACE                 (12)5A360900
       STR                    AVAILABLE PATCH SPACE                 (12)5A361000
       STR                    AVAILABLE PATCH SPACE                 (12)5A361100
       STR                    AVAILABLE PATCH SPACE                 (12)5A361200
       STR                    AVAILABLE PATCH SPACE                 (12)5A361300
       STR                    AVAILABLE PATCH SPACE                 (12)5A361400
       STR                    AVAILABLE PATCH SPACE                 (12)5A361500
       STR                    AVAILABLE PATCH SPACE                 (12)5A361600
       STR                    AVAILABLE PATCH SPACE                 (12)5A361700
       STR                    AVAILABLE PATCH SPACE                 (12)5A361800
       STR                    AVAILABLE PATCH SPACE                 (12)5A361900
       STR                    AVAILABLE PATCH SPACE                 (12)5A362000
       STR                    AVAILABLE PATCH SPACE                 (12)5A362100
       STR                    AVAILABLE PATCH SPACE                 (12)5A362200
       STR                    AVAILABLE PATCH SPACE                 (12)5A362300
       STR                    AVAILABLE PATCH SPACE                 (12)5A362400
       STR                    AVAILABLE PATCH SPACE                 (12)5A362500
       EJECT                                                            5A364000
*      COMMON SPECIAL-EXIT ROUTINE FOR SUBROUTINES.                     5A364100
       SPACE                                                            5A364200
TRDX1  CAL     TRBFPD         BUFFER SIZE +1 IN DECR. AC                5A364300
       TRA     TRDX3          CONTINUE                                  5A364400
TRDX2  CAL     TRDC1          1 IN DECR.                                5A364500
TRDX3  STD*    1,4            STORE DECR. IN TBLCW                      5A364600
TRDX4  CAL     1,4            EXIT LOC. IN DECR. OF 1ST WORD            5A364700
       PDC     0,4            OF CALLING SEQUENCE                       5A364800
       TRA     0,4            GO TO EXIT.                               5A364900
       EJECT                                                            5A365000
*      TRFBA,TRFBB,TRBBA,TRBBB                                          5A365100
*                                                                       5A365200
*      CALLING SEQUENCE-                                                5A365300
*      TSX     XXXXX,4                                                  5A365400
*                             SPECIAL RETURN                            5A365500
*                             NORMAL RETURN                             5A365600
*      INPUT   CONTENTS OF A(TCW) IN A(AC) FOR TRFBB,TRBBB              5A365700
*              IN A(MQ) FOR TRFBA,TRBBA                                 5A365800
*                                                                       5A365900
*      OUTPUT  IN A(AC),REST OF AC=ZERO                                 5A366000
*              NOW VALUE FOR A(TCW)                                     5A366100
*              TRFBA,TRFBB.   NEXT FORWARD BUFFER.                      5A366200
*              TRBBA,TRBBA.   NEXT BACKWARD BUFFER.                     5A366300
*                                                                       5A366400
*      SPECIAL EXIT - IF CURRENT BUFFER IS LAST (TRFBA,TRFBB)           5A366500
*                   - IF CURRENT BUFFER IS FIRST (TRBBA,TRBBB)          5A366600
*                                                                       5A366700
TRFBA  XCL                    C(MQ) TO AC                               5A366800
TRFBB  SXA     TRFBF,4        SAVE CALL INDEX                           5A366900
       PAC     0,4            -(BHW+BS+1) TO IR4                        5A367000
       CAL     -TRBFP,4       C(BHW) TO AC                              5A367100
       PAX     0,4            LOC(NEXT BUFFER) IN IR4                   5A367200
TRFBD  TXL     TRFBH,4,0      IF ZERO, CURRENT IS END OF CHAIN.         5A367300
       TXI     *+1,4,TRBFP    OK,(BHW+BS+1) IN IR4                      5A367400
       PXA     0,4            TO AC                                     5A367500
TRFBF  AXT     **,4           RELOAD REGISTER                           5A367600
       TRA     2,4            NORMAL EXIT.                              5A367700
       SPACE                                                            5A367800
TRFBH  LXA     TRFBF,4        END OF CHAIN. RELOAD REGISTER             5A367900
       TRA     1,4            SPECIAL EXIT.                             5A368000
       SPACE   2                                                        5A368100
TRBBA  XCL                    C(MQ) TO AC                               5A368200
TRBBB  SXA     TRFBF,4        SAVE CALL INDEX                           5A368300
       PAC     0,4            -(BHW+BS+1) TO IR4                        5A368400
       CAL     -TRBFP,4       C(BHW) IN AC                              5A368500
       PDX     0,4            LOC(PREVIOUS BUFFER) IN IR4               5A368600
       TRA     TRFBD         JOIN OTHER ROUTINE.                        5A368700
       EJECT                                                            5A368800
*      TRNPA,TRBPA                                                      5A368900
*                                                                       5A369000
*      CALLING SEQUENCE (E.G) TSX TRNPA,4                               5A369100
*                                                                       5A369200
*      ENTER WITH CONTENTS OF A TBLCW IN LOGICAL AC.                    5A369300
*      EXIT WITH (IN TRPTR) A COMPLEMENTED POINTER                      5A369400
*      TO THE NEXT FORWAD (TRNPA) OR BACKWARD (TRBPA)                   5A369500
*      LOCATION IN THE LABEL TBL, STARTING FROM THE                     5A369600
*      LOCATION INDICATED BY THE TBLCW IN THE AC                        5A369700
*                                                                       5A369800
*      IF THE NEXT LOCATION IS NOT IN THE SAME BUFFER,                  5A369900
*      THE POINTER IN TRPTR IS ERRONEOUS.                               5A370000
*                                                                       5A370100
*      THE AC IS UNCHANGED, AS ARE ALL OTHER REGISTERS.                 5A370200
*                                                                       5A370300
*      THERE ARE NO SPECIAL RETURNS.                                    5A370400
       SPACE   2                                                        5A370500
*      ENTER FOR NEXT FORWARD POINTER                                   5A370600
       SPACE                                                            5A370700
TRNPA  SXA     TRNPX,4        SAVE REGISTER                             5A370800
       PAC     0,4            -(BHW+BS+1) TO IR4                        5A370900
       TXI     TRNPB,4,-1     IR4= -(BHW+BS+2), AND TRANSFER            5A371000
       SPACE                                                            5A371100
*      COMMON ROUTINE.                                                  5A371200
       SPACE                                                            5A371300
TRNPB  STD     TRNPC          BUFFER INDEX STORED. (BS-I+1)             5A371400
TRNPC  TXI     *+1,4,**       COMPLEMENTED POINTER=-(BHW+I+1)           5A371500
       SXA     TRPTR,4        OR -(BHW+I-1)                             5A371600
TRNPX  AXT     **,4           RELOAD REGISTER                           5A371700
       TRA     1,4            RETURN                                    5A371800
       SPACE   2                                                        5A371900
*      ENTER FOR NEXT BACKWARD POINTER                                  5A372000
       SPACE                                                            5A372100
TRBPA  SXA     TRNPX,4        SAVE REGISTER                             5A372200
       PAC     0,4            -(BHW+BS+1) TO IR4                        5A372300
       TXI     TRNPB,4,1      IR4 =-(BHW+BS), AND TRANSFER.             5A372400
       EJECT                                                            5A372500
*                                                                       5A372600
*      TRSTA   -CALLED BY START MACRO                                   5A372700
*              -ATTACH BUFFER TO SPECIFIED TABLE + INITIALIZE           5A372800
*              -NO ACTION IF TABLE ALREADY EXISTS                       5A372900
*                                                                       5A373000
TRSTA  STZ     TRSTI          SET OFF 'LAST-TABLE' INDICATOR            5A373100
TRSTB  SXA     TRSTG,4        SAVE INDEX                                5A373200
       CLA     1,4            LOC(TCW) IN AC                            5A373300
       TMI     TRSTC          IF MINUS, NOT LAST, SKIP                  5A373400
       STL     TRSTI          LAST TABLE, INDICATOR ON                  5A373500
TRSTC  PAC     0,4            -LOC (TCW) TO IR4                         5A373600
       ZET     -1,4           TEST THW FOR ZERO                         5A373700
       TRA     TRSTG          NO, TABLE ALREADY SET UP, EXIT            5A373800
       SXA     TRSTD,4        SAVE IR4                                  5A373900
       TSX     TRABA,4        ATTACH BUFFER,(BHW+BS+1) IN AC ON EXIT    5A374000
       STA     TRSTZ          STORE IN 'SETUP' WORD                     5A374100
       CLA     TRSTZ          PICK UP SETUP WORD                        5A374200
TRSTD  AXT     **,4           -LOC(TCW) TO IR4                          5A374300
       STO     0,4            WORD TO TBLCW                             5A374400
       STO     1,4            AND TO TBLST                              5A374500
       STZ     2,4            CLEAR TBLFN                               5A374600
TRSTG  AXT     **,4           RELOAD CALL INDEX                         5A374700
       NZT     TRSTI          IF INDICATOR OFF                          5A374800
       TXI     TRSTB,4,-1     GO BACK FOR NEXT TABLE, BUMP INDEX        5A374900
       TRA     2,4            OTHERWISE RETURN                          5A375000
       SPACE   2                                                        5A375100
TRSTZ  PZE     **,4,TRBFP                                               5A375200
TRSTI  PZE     **             'LAST-TABLE' INDICATOR.                   5A375300
       EJECT                                                            5A375400
*                                                                       5A375500
*      TRCLA   -CALLED BY CLOSE MACRO                                   5A375600
*              -PLACE 'END-FLAG' IN NEXT AVAILABLE                      5A375700
*              FORWARD LOC. IN SPECIFIED TABLE                          5A375800
*              IF END OF LAST BUFFER, NO FLAG STORED                    5A375900
*              EXIT WITH TBLCW UNCHANGED                                5A376000
*              CONTENTS OF TBLCW TO TBLFN                               5A376100
*                                                                       5A376200
TRCLA  STZ     TRCLI          SET OFF 'LAST-TABLE' INDICATOR            5A376300
TRCLB  SXA     TRCLJ,4        SAVE INDEX.                               5A376400
       CLA     1,4             PICK UP LOC(TCW) IN ADDR.                5A376500
       TMI     TRCLC          IF MINUS, NOT LAST, SKIP                  5A376600
       STL     TRCLI          LAST TABLE, INDICATOR ON                  5A376700
TRCLC  PAC     0,4            -LOC (TCW) IN IR4                         5A376800
       CLA     0,4             C(TCW) TO AC                             5A376900
       STO     2,4            C(TBLCW) TO TBLFN                         5A377000
       PDX     0,4            BUFFER INDEX TO IR4                       5A377100
       TNX     TRCLL,4,1      BUMP, TEST FOR END OF BUFFER.             5A377200
       SPACE                                                            5A377300
TRCLE  STA     TRCLG          INITIALIZE ADDRESS                        5A377400
       CAL     TRBFL          PICK UP 'ENDFLAG'                         5A377500
TRCLG  SLW     **,4           STORE IN TABLE                            5A377600
TRCLJ  AXT     **,4           RELOAD CALL INDEX                         5A377700
       NZT     TRCLI          IF INDICATOR OFF, GO BACK FOR             5A377800
       TXI     TRCLB,4,-1     NEXT TABLE, BUMP INDEX                    5A377900
       TRA     2,4            OTHERWISE, RETURN                         5A378000
       SPACE                                                            5A378100
TRCLL  PAC     0,4            BUFFER END -(BHW+BS+1) IN IR4             5A378200
       CLA     -TRBFP,4       C(BHW) TO AC                              5A378300
       PAC     0,4            NEXT BUFFER LOC IN IR4                    5A378400
       TXL     TRCLJ,4,0      IF ZERO, THIS IS LAST, EXIT               5A378500
       SPACE                                                            5A378600
       CAL     TRBFL          STORE FLAG IN FIRST WORD                  5A378700
       SLW     1,4            OF NEXT BUFFER                            5A378800
       TRA     TRCLJ          GO TO EXIT                                5A378900
       SPACE   2                                                        5A379000
TRCLI  PZE     **             'LAST-TABLE' INDICATOR                    5A379100
       EJECT                                                            5A379200
*                                                                       5A379300
*      TWLNA   CALLED BY NXTSL MACRO                                    5A379400
*              STORE LOGICAL AC INTO NEXT FORWARD LOCATION              5A379500
*              OF SPECIFIED TABLE                                       5A379600
*                                                                       5A379700
TWLNA  SXA     TWLNE,4        SAVE CALL INDEX                           5A379800
       XCL                    INPUT TO MQ                               5A379900
       CLA*    1,4            CONTENTS OF TCW TO AC                     5A380000
       PDX     0,4            BUFFER INDEX TO IR4                       5A380100
       TNX     TWLNG,4,1      BUMP + TEST FOR END OF BUFFER             5A380200
TWLNB  STA     TWLNC          INITIALIZE ADDRESS                        5A380300
TWLNC  STQ     **,4           INPUT TO TABLE                            5A380400
       PXD     0,4            NEW BUFFER INDEX TO DECR. AC              5A380500
TWLNE  AXT     **,4           CALL INDEX                                5A380600
       STD*    1,4            STORE BUFFER INDEX IN TCW                 5A380700
       TRA     2,4            RETURN                                    5A380800
       SPACE   3                                                        5A380900
*      END OF BUFFER.  SWITCH TO NEXT, OR ATTACH NEW BUFFER.            5A381000
       SPACE                                                            5A381100
TWLNG  AXT     TWLNH,4        SET UP RETURN ADDRESS                     5A381200
       TRA     TWLPK          GO TO GET NEW BUFFER                      5A381300
       SPACE                                                            5A381400
       REM                    RETURN WITH NEW BUFFER INFO. IN A(AC)     5A381500
TWLNH  LDQ     TWLPZ          AND IR4. RETRIEVE INPUT WORD              5A381600
       TXI     TWLNB,4,-1     GO TO STORE, REDUCING INDEX TO B.S.       5A381700
       EJECT                                                            5A381800
*                                                                       5A381900
*      TWLPA   CALLED BY NXTSLP MACRO.                                  5A382000
*              STORE CONTENTS OF LOGICAL AC IN NEXT LOCATION            5A382100
*              IN SPECIFIED TABLE.  EXIT WITH COMPLEMENTED              5A382200
*              POINTER IN AC                                            5A382300
TWLPA  SXA     TWLNE,4        SAVE CALL INDEX                           5A382400
       XCL                    INPUT WORD TO MQ                          5A382500
       CLA     1,4            ADDRESS OF CONTROL WORD TO AC             5A382600
       STA     TWLPC          INITIALIZE                                5A382700
       CLA*    1,4            CONTENTS OF CONTROL WORD TO AC            5A382800
       PDX     0,4            BUFFER INDEX TO IR4                       5A382900
       TNX     TWLPJ,4,1      BUMP, TRANSFER IF END OF BUFFER           5A383000
TWLPB  STA     TWLPE          INITIALIZE ADDRESS                        5A383100
TWLPC  SXD     **,4           NO, SAVE BUMPED INDEX                     5A383200
TWLPE  STQ     **,4           INPUT WORD TO TABLE                       5A383300
       SXD     *+2,4          COMPUTE POINTER.                          5A383400
       PAC     0,4            -(ADDRESS OF CONTROL WORD)                5A383500
       TXI     *+1,4,**       + INDEX = -(TABLE ADDRESS OF ENTRY)       5A383600
       PXA     0,4            POINTER TO AC                             5A383700
TWLPG  LXA     TWLNE,4        RELOAD CALL INDEX                         5A383800
       TRA     2,4            RETURN                                    5A383900
       SPACE                                                            5A384000
*                                                                       5A384100
*      SWITCH TO NEXT BUFFER, OR ATTACH NEW ONE.                        5A384200
*                                                                       5A384300
       SPACE                                                            5A384400
TWLPJ  AXT     TWLPL,4        SET UP RETURN ADDRESS                     5A384500
TWLPK  STQ     TWLPZ          SAVE INPUT WORD                           5A384600
       TRA     TWMNR          GO TO GET NEW BUFFER                      5A384700
       SPACE                                                            5A384800
       REM                    RETURN WITH NEW BUFFER INFO IN A(AC)      5A384900
TWLPL  LDQ     TWLPZ          AND IR4. RETRIEVE INPUT WORD              5A385000
       TXI     TWLPB,4,-1     GO TO STORE, REDUCING INDEX TO B.S.       5A385100
       SPACE   3                                                        5A385200
TWLPZ  PZE     **             STORAGE.                                  5A385300
       EJECT                                                            5A385400
TWMPA  SXA     TWMNM,1        SAVE IR1                                  5A385500
       AXT     TWMNE,1        PREPARE TO INITIALIZE TWMND BELOW         5A385600
       TRA     TWMNB          JOIN MAIN ROUTINE                         5A385700
       SPACE                                                            5A385800
TWMNA  SXA     TWMNM,1        SAVE IR1                                  5A385900
       AXT     TWMNG,1        PREPARE TO INITIALIZE TWMND BELOW         5A386000
TWMNB  SXA     TWMND,1        INITIALIZE                                5A386100
       SPACE                                                            5A386200
       SXA     TWMNN,2        SAVE IR2                                  5A386300
       SXA     TWLNE,4        SAVE CALL INDEX                           5A386400
       SPACE                                                            5A386500
       CAL     2,4            -LOC(INPUT)                               5A386600
       PDC     0,2            TO IR2                                    5A386700
       CAL*    2,4            COUNT                                     5A386800
       PAX     0,1            TO IR1                                    5A386900
       CAL*    1,4            C(TCW) TO AC                              5A387000
TWMND  TRA     **             GO TO TWMNE OR TWMNG FOR                  5A387100
       REM                    TWMPA,TWMNA RESPECTIVELY.                 5A387200
       SPACE                                                            5A387300
TWMNE  PDX     0,4            TEST NEXT WORD FOR END OF BUFFER          5A387400
       TNX     TWMNP,4,1      OUT IF SO. COMPLEMENTED POINTER TO        5A387500
TWMNF  TSX     TRNPA,4        NEXT WORD IN TRPTR OTHERWISE.             5A387600
       SPACE                                                            5A387700
TWMNG  PDX     0,4            BUFFER INDEX IN IR4                       5A387800
TWMNH  STA     TWMNL          INITIALIZE ADDRESS BELOW                  5A387900
       SPACE                                                            5A388000
TWMNJ  TNX     TWMNQ,4,1      BUMP, OUT IF END-OF-BUFFER.               5A388100
TWMNK  LDQ     0,2            PICK UP INPUT WORD                        5A388200
TWMNL  STQ     **,4           STORE IN TABLE                            5A388300
       TXI     *+1,2,-1       BUMP INPUT INDEX                          5A388400
       TIX     TWMNJ,1,1      COUNT                                     5A388500
       SPACE                                                            5A388600
       PXD     0,4            FINAL BUFFER INDEX IN DECR(AC)            5A388700
TWMNM  AXT     **,1           RELOAD IR1,IR2                            5A388800
TWMNN  AXT     **,2           X                                         5A388900
       LXA     TWLNE,4        RELOAD CALL INDEX                         5A389000
       STD*    1,4            STORE BUFFER INDEX IN TCW                 5A389100
       CAL     TRPTR          POINTER TO AC(WRONG UNLESS TWMPA)         5A389200
       TRA     3,4            RETURN.                                   5A389300
       EJECT                                                            5A389400
       REM                    ENTER HERE FROM TWMNE                     5A389500
TWMNP  AXT     TWMPP,4        PICK UP RETURN ADDRESS                    5A389600
       TRA     TWMNR          GO TO GET NEW BUFFER.                     5A389700
       SPACE                                                            5A389800
       REM                    RETURN WITH NEW BUFFER INFO-IN A(AC)      5A389900
TWMPP  ORA     TRBFPD         GET BUFFER SIZE +1 IN DECR.               5A390000
       TRA     TWMNF          GO TO COMPUTE POINTER.                    5A390100
       SPACE   2                                                        5A390200
       REM                    ENTER HERE FROM TWMNJ                     5A390300
TWMNQ  AXT     TWMNH,4        PICK UP RETURN ADDRESS.                   5A390400
       SPACE   2                                                        5A390500
*      COMMON ROUTINE STARTS HERE                                       5A390600
TWMNR  SXA     TWMNT,4        INITIALIZE RETURN ADDRESS                 5A390700
       TSX     TRFBB,4        GET A(TCW) FOR NEXT BUFFER                5A390800
       TRA     TWMNU          NO NEXT, GO ATTACH ONE                    5A390900
       SPACE                                                            5A391000
TWMNS  LXA     TWLNE,4        OK, LOAD CALL INDEX                       5A391100
       STA*    1,4            STORE NEW TCW ADDRESS                     5A391200
       AXT     TRBFP,4        BUFFER SIZE + 1 (BS+1) IN IR4             5A391300
TWMNT  TRA     **             GO TO TWMNP,TWMNH,TWLNH, OR TWLPL,        5A391400
       REM                    IF ENTERED FROM TWMNP,TWMNQ,              5A391500
                              TWLNG OR TWLPJ RESPECTIVELY               5A391600
       SPACE                                                            5A391700
       REM                    ATTACH NEW BUFFER                         5A391800
TWMNU  LXA     TWLNE,4        LOAD CALL INDEX                           5A391900
       CAL     1,4            LOC(TCW) IN A(AC)                         5A392000
       TSX     TRABA,4        ATTACH BUFFER. BHW+BS+1 IN A(AC),         5A392100
       TRA     TWMNS          OTHWISE ZERO. CONTINUE                    5A392200
       EJECT                                                            5A392300
*                                                                       5A392400
*      TVLNA   -CALLED BY NXTGL MACRO                                   5A392500
*              GET WORD FROM NEXT FORWARD LOCATION                      5A392600
*              OF SPECIFIED TABLE, IN LOGICAL AC                        5A392700
*              SPECIAL EXIT IF END OF TABLE - TEST FOR FLAG             5A392800
*                                                                       5A392900
TVLNA  SXA     TVLNG,4        SAVE IR4                                  5A393000
       CLA     1,4            ADDRESS OF CONTROL WORD TO AC             5A393100
       STA     TVLNE          INITIALIZE                                5A393200
       CLA*    1,4            CONTENTS OF CONTROL WORD TO AC            5A393300
       PDX     0,4            BUFFER INDEX TO IR4                       5A393400
       TNX     TVLNJ,4,1      BUMP, TRANSFER IF END OF BUFFER           5A393500
TVLNB  STA     TVLNC          INITIALIZE ADDRESS                        5A393600
TVLNC  CAL     **,4           PICK UP WORD FROM TABLE                   5A393700
       LAS     TRBFL          COMPARE AGAINST END OF TABLE FLAG.        5A393800
       TRA     *+2            NO                                        5A393900
       TRA     TVLNN          YES                                       5A394000
TVLNE  SXD     **,4           NO, STORE BUMPED INDEX.                   5A394100
TVLNG  AXT     **,4           RELOAD IR4.                               5A394200
       TRA     2,4            RETURN.(OR SPECIAL TRANSFER TO TVLNL      5A394300
       REM                    WHEN TVLNI IS ON)                         5A394400
       SPACE   3                                                        5A394500
*                                                                       5A394600
*      TRANSFER HERE ON END OF BUFFER                                   5A394700
*                                                                       5A394800
TVLNJ  TSX     TRFBB,4        GET(BHW+BS+1) FOR NEXT BUFFER             5A394900
       TRA     TVLNO          NO NEXT BUFFER                            5A395000
       SETON   TVLNI          NEW BUFFER, INDICATOR ON                  5A395100
       LAC     TVLNE,4        -LOC(TCW) IN IR4                          5A395200
       LDQ     0,4            PICK UP TCW UNCHANGED                     5A395300
       STQ     TVLNZ          PRESERVE                                  5A395400
       STA     0,4            RESET TCW FOR NEW BUFFER                  5A395500
       LXA     TVLNG,4        SAVE CALL INDEX                           5A395600
       SXA     TVLNL,4        X                                         5A395700
       AXT     -TVLNL+2,4     RESET CALL INDEX AXT                      5A395800
       SXA     TVLNG,4        FOR SPECIAL TRANSFER TO TVLNL             5A395900
       AXT     TRBFN,4        BS TO IR4                                 5A396000
       TRA     TVLNB          REJOIN MAIN ROUTINE.                      5A396100
       EJECT                                                            5A396200
*                                                                       5A396300
*      TRANSFER HERE WHEN END OF BUFFER IS FOLLOWED BY                  5A396400
*      NON-FLAG WORD FOUND IN NEXT BUFFER.                              5A396500
*                                                                       5A396600
TVLNL  AXT     **,4           RELOAD CALL INDEX                         5A396700
       SETOFF  TVLNI          CLEAN UP                                  5A396800
       TRA     2,4            RETURN                                    5A396900
*                                                                       5A397000
*      TRANSFER HERE WHEN FLAG WORD FOUND.                              5A397100
*                                                                       5A397200
TVLNN  IFON    TVLNI,TVLNQ    IF END OF BUFFER BEFORE, TO TVLNQ         5A397300
TVLNO  LXA     TVLNG,4        CALL INDEX, SPECIAL EXIT LOC IN DECR.     5A397400
TVLNP  TRA     TRDX4          GO TO EXIT ROUTINE                        5A397500
*                                                                       5A397600
*      TRANSFER HERE WHEN FLAG WORD FOUND                               5A397700
*      FOLLOWING END OF BUFFER                                          5A397800
*                                                                       5A397900
TVLNQ  SETOFF  TVLNI                                                    5A398000
       LDQ     TVLNZ                                                    5A398100
       LXA     TVLNL,4                                                  5A398200
       STQ*    1,4                                                      5A398300
       TRA     TVLNP                                                    5A398400
       SPACE   2                                                        5A398500
TVLNI  PZE     **             IF NON-ZERO, BUFFER END ENCOUNTERED.      5A398600
TVLNZ  PZE     **             STORAGE FOR TCW                           5A398700
       EJECT                                                            5A398800
*                                                                       5A398900
*      TXLNA   CALLED BY      NNFGL MACRO                               5A399000
*              CALLING SEQUENCE TSX TXLNA,4                             5A399100
*                             PZE TBLCW,,ECIT                           5A399200
*              PICK UP NEXT FORWARD WORD IN TBL IN LOGICAL AC           5A399300
*              GO TO EXIT IF END OF LAST BUFFER OF TBL ENCOUNTERED.     5A399400
*              NO TEST FOR END-FLAG                                     5A399500
*                                                                       5A399600
TXLNA  SXA     TXLNG,4        SAVE REGISTER                             5A399700
       CAL*    1,4            C(TCW) TO AC                              5A399800
       PDX     0,4            BUFFER INDEX TO IR4                       5A399900
       TNX     TXLNJ,4,1      BUMP INDEX, OUT IF END OF BUFFER.         5A400000
TXLNC  STA     TXLNE          INITIALIZE ADDRESS                        5A400100
       PXD     0,4            NEW BUFFER INDEX TO DECR.                 5A400200
TXLNE  LDQ     **,4           PICK UP TABLE WORD IN MQ                  5A400300
TXLNG  AXT     **,4           RELOAD CALL REGISTER                      5A400400
       STD*    1,4            STORE NEW BUFFER INDEX                    5A400500
       XCL                    TABLE WORD TO LAC                         5A400600
       TRA     2,4            RETURN                                    5A400700
*                                                                       5A400800
*      TRANSFE R HERE ON END OF BUFFER                                  5A400900
*                                                                       5A401000
TXLNJ  TSX     TRFBB,4        GET(BHW+BS+1) FOR NEXT BUFFER             5A401100
       TRA     TXLNL          NO NEXT BUFFER                            5A401200
       LXA     TXLNG,4        CALL REGISTER                             5A401300
       STA*    1,4            UPDATE A(TCW)                             5A401400
       AXT     TRBFN,4        BS IN IR4                                 5A401500
       TRA     TXLNC          CONTINUE                                  5A401600
*                                                                       5A401700
*      TRANSFE R HERE ON END OF TABLE                                   5A401800
*                                                                       5A401900
TXLNL  LXA     TXLNG,4        CALL REGISTER                             5A402000
       TRA     TRDX4          GO TO EXIT ROUTINE                        5A402100
       EJECT                                                            5A402200
*      TYLNA   CALLED BY RSPGL MACRO.                                   5A402300
*                                                                       5A402400
*      CALLING SEQUENCE-                                                5A402500
*      TSX     TYLNA,4                                                  5A402600
*      PZE     TBLCW,,EXIT                                              5A402700
*                                                                       5A402800
*      OPERATION - PICK UP NEXT FORWARD WORD IN TBL,                    5A402900
*              UNLESS THIS IS END-FLAG, IN WHICH CASE                   5A403000
*              PICK UP FIRST WORD OF FOLLOWING BUFFER OF TBL.           5A403100
*              IF END-FLAG ENCOUNTERED IN LAST BUFFER                   5A403200
*              GO TO EXIT, MARKER INDICATES WORD PRECEDING FLAG.        5A403300
*              IF END OF TABLE ENCOUNTERED, GO TO EXIT.                 5A403400
*              MARKER INDICATES LAST WORD OF TABLE.                     5A403500
*              OTHERWISE, NORMAL EXIT, MARKER INDICATES                 5A403600
*              WORD PICKED UP.                                          5A403700
*                                                                       5A403800
TYLNA  SXA     TYLNH,4        SAVE CALL INDEX                           5A403900
       CAL     1,4            PICK UP TCW LOCATION                      5A404000
       STA     TYLNG          SAVE                                      5A404100
       CAL*    1,4            PICK UP C(TCW)                            5A404200
       PDX     0,4            BUFFER INDEX TO IR4                       5A404300
       TNX     TYLNK,4,1      BUMP INDEX, TO TYLNK IF BUFFER END.       5A404400
TYLNC  STA     TYLNE          INITIALIZE WITH A(TCW)                    5A404500
       XCL                    PRESERVE C(TCW) IN MQ                     5A404600
TYLNE  CAL     **,4           PICK UP WORD                              5A404700
       LAS     TRBFL          IS IT FLAG WORD.                          5A404800
       TRA     *+2            NO                                        5A404900
       TRA     TYLNJ          YES, GO TO NEXT BUFFER.                   5A405000
       SETOFF  TYLNI          NO, INDECATOR OFF (SEE BELOW)             5A405100
TYLNG  SXD     **,4           STORE BUMPED BUFFER INDEX.                5A405200
TYLNH  AXT     **,4           RELOAD CALL INDEX                         5A405300
       TRA     2,4            RETURN.                                   5A405400
       EJECT                                                            5A405500
*      ENTER HERE IF BUFFER-SWITCH REQUIRED                             5A405600
TYLNJ  XCL                    A(TCW) TO MQ                              5A405700
TYLNK  TSX     TRFBB,4        GET A(TCW) FOR NEXT BUFFER.               5A405800
       TRA     TYLNM          NO NEXT BUFFER                            5A405900
       SETON   TYLNI          NEW BUFFER, INDICATOR ON.                 5A406000
       LAC     TYLNG,4        -LOC(TCW) IN IR4                          5A406100
       LDQ     0,4            PICK UP + SAVE OLD C(TCW)                 5A406200
       STA     0,4            CHANGE TCW                                5A406300
       STQ     TYLNS          X                                         5A406400
       AXT     TRBFN,4        BUFFER INDEX FOR NEW BUFFER               5A406500
       TRA     TYLNC          CONTINUE                                  5A406600
       SPACE                                                            5A406700
TYLNM  LXA     TYLNH,4        LAST BUFFER, RELOAD CALL INDEX.           5A406800
       IFOFF   TYLNI,TRDX4    NO INDICATOR, GO TO EXIT ROUTINE          5A406900
       REM                    INDICATOR ON SIGNIFIES END-FLAG           5A407000
       SETOFF  TYLNI          IS FIRST WORD OF LAST BUFFER.             5A407100
       CAL     TYLNS          INDICATOR OFF, EXIT WITH MARKER           5A407200
       STA*    1,4            POINTING TO LAST WORD OF                  5A407300
       TRA     TRDX2          PENULTIMATE BUFFER.                       5A407400
       SPACE   2                                                        5A407500
TYLNI  PZE     **             INDICATOR.                                5A407600
TYLNS  PZE     **             STORAGE                                   5A407700
       EJECT                                                            5A407800
*      TXMPA,TXMNA,TVMPA,TVMNA ROUTINES.                                5A407900
*              CALLED BY MACROS NNFGMP,NNFGM,NXTGMP,NXTGM.              5A408000
*      CALLING SEQUENCE-                                                5A408100
*      TSX     XXXXX,4                                                  5A408200
*      PZE     TBLCW,,EXIT                                              5A408300
*      PZE     COUNT,,LOC                                               5A408400
*                                                                       5A408500
*      OPERATION- MOVE THE NEXT N 'FORWARD' WORDS                       5A408600
*              FROM TBL TO THE N LOCATIONS LOC,...,LOC+N-1              5A408700
*              N IS CONTAINED IN COUNT.                                 5A408800
*              GO TO EXIT IF AN ATTEMPT IS MADE TO                      5A408900
*              MOVE BEYOND THE LAST WORD OF THE LAST BUFFER.            5A409000
*                                                                       5A409100
*              TVMPA+TVMNA. GO TO EXIT IF AN END-FLAG                   5A409200
*              IS ENCOUNTERED AMONG THE N WORDS                         5A409300
*                                                                       5A409400
*              TXMPA+TVMPA. LEAVE COMPLEMENTED POINTER                  5A409500
*              TO FIRST OF N WORDS IN TRPTR                             5A409600
*                                                                       5A409700
TXMPA  SETON   TXMPI          NNFGMP ENTRY. INDICATOR ON FOR POINTER    5A409800
       TRA     TXMNB          CONTINUE                                  5A409900
       SPACE                                                            5A410000
TXMNA  SETOFF  TXMPI          NNFGM ENTRY. INDICATOR OFF FOR POINTER.   5A410100
TXMNB  SETOFF  TVMNI          FLAG-CHECK INDICATOR OFF                  5A410200
       TRA     TXMNC          CONTINUE                                  5A410300
       SPACE                                                            5A410400
TVMPA  SETON   TXMPI          NXTGMP ENTRY. INDICATOR ON FOR POINTER    5A410500
       TRA     TVMNB          CONTINUE                                  5A410600
       SPACE                                                            5A410700
TVMNA  SETOFF  TXMPI          NXTGM ENTRY. INDICATOR OFF FOR POINTER    5A410800
TVMNB  SETON   TVMNI          FLAG-CHECK INDICATOR ON                   5A410900
       EJECT                                                            5A411000
TXMNC  SXA     TXMNK,4        SAVE REGISTERS                            5A411100
       SXA     TXMNL,2        X                                         5A411200
       SXA     TXMNM,1        X                                         5A411300
       SPACE                                                            5A411400
       CAL     2,4            COMPLEMENT OF STORAGE LOCATION            5A411500
       PDC     0,2            IN IR2                                    5A411600
       CAL*    2,4            COUNT                                     5A411700
       PAX     0,1            IN IR1                                    5A411800
       CAL*    1,4            C(TCW) IN LAC                             5A411900
       SPACE                                                            5A412000
       IFOFF   TXMPI,TXMNE    IF NO POINTER REQUIRED, SKIP              5A412100
       PDX     0,4            IF NEXT WORD IS IN NEW BUFFER             5A412200
       TNX     TXMNP,4,1      GO TO FIND NEW BUFFER                     5A412300
TXMND  SETOFF  TXMPI          IF NOT, INDICATOR OF POINTER TO NEXT      5A412400
       TSX     TRNPA,4        WORD TO TRPTR. AC UNCHANGED.              5A412500
       SPACE                                                            5A412600
TXMNE  PDX     0,4            BUFFER INDEX TO IR4                       5A412700
TXMNF  STA     TXMNH          INITIALIZE BUFFER ADDRESS                 5A412800
       XCL                    SAVE AC IN MQ                             5A412900
TXMNG  TNX     TXMNN,4,1      BUMP BUFFER INDEX. OUT IF END.            5A413000
TXMNH  CAL     **,4           PICK UP NEXT WORD IN LAC.                 5A413100
       SPACE                                                            5A413200
       IFOFF   TVMNI,TXMNJ    SKIP UNLESS FLAG-CHECK                    5A413300
       LAS     TRBFL          COMPARE WORD AGAINS END-FLAG              5A413400
       TRA     *+2            NO                                        5A413500
       TRA     TXMNS          EQUAL, OUT                                5A413600
       SETOFF  TVMSI          NO, SPECIAL INDICATOR OFF                 5A413700
       SPACE                                                            5A413800
TXMNJ  SLW     0,2            STORE AS REQUIRED.                        5A413900
       TXI     *+1,2,-1       BUMP STORAGE INDEX                        5A414000
       TIX     TXMNG,1,1      COUNT                                     5A414100
       SPACE                                                            5A414200
       PXD     0,4            FINAL BUFFER INDEX TO DECREMENT.          5A414300
TXMNK  AXT     **,4           RELOAD REGISTERS                          5A414400
TXMNL  AXT     **,2           X                                         5A414500
TXMNM  AXT     **,1           X                                         5A414600
       STD*    1,4            STORE BUFFER INDEX                        5A414700
       TRA     3,4            RETURN                                    5A414800
       EJECT                                                            5A414900
       REM                    ENTER HERE AT END OF BUFFER.              5A415000
TXMNN  XCL                    A(TCW) TO A(AC)                           5A415100
TXMNP  TSX     TRFBB,4        GET NEW A(TCW) IN A(AC).(NEW BUFFER)      5A415200
       TRA     TXMNU          SPECIAL RETURN, END OF TABLE              5A415300
       SPACE                                                            5A415400
       LXA     TXMNK,4        NORMAL RETURN. CALL INDEX IR4             5A415500
       IFOFF   TVMNI,TXMNQ    SKIP IF NO FLAG CHECK                     5A415600
       LDQ*    1,4            SAVE OLD C(TCW) IN CASE                   5A415700
       STQ     TXMS1          END FLAG IS FIRST ENTRY IN NEW BUFFER     5A415800
       SETON   TVMSI          SPECIAL INDICATOR ON                      5A415900
       SPACE                                                            5A416000
TXMNQ  STA*    1,4            STORE NEW A(TDW)                          5A416100
       SPACE                                                            5A416200
       IFON    TXMPI,TXMNR    SKIP IF POINTER STILL NEEDED              5A416300
       AXT     TRBFP,4        BUFFER SIZE+1 TO IR4                      5A416400
       TRA     TXMNF          CONTINUE                                  5A416500
       SPACE                                                            5A416600
TXMNR  ORA     TXMS2          PSEUDO-TCW IN AC                          5A416700
       TRA     TXMND         GO TO GET POINTER.                         5A416800
       SPACE   2                                                        5A416900
       REM                    ENTER HERE IF END-FLAG ENCOUNTERED.       5A417000
TXMNS  IFON    TVMSI,TXMNT    SKIP IF SPECIAL INDICATOR ON.             5A417100
       TXI     TXMNV,4,1      BACK UP BUFFER INDEX                      5A417200
       SPACE                                                            5A417300
TXMNT  SETOFF  TVMSI          SPECIAL ON. SETOFF.                       5A417400
       LXA     TXMNK,4        RESET TCW TO END OF PREVIOUS BUFFER       5A417500
       CAL     TXMS1          X                                         5A417600
       STA*    1,4            X                                         5A417700
       REM                    ENTER HERE IF END OF BUFFER.              5A417800
TXMNU  AXT     1,4            BUFFER INDEX=1, FOR END OF BUFFER         5A417900
TXMNV  PXD     0,4            TO DECREMENT.                             5A418000
       LXA     TXMNK,4        RELOAD REGISTERS                          5A418100
       LXA     TXMNL,2        X                                         5A418200
       LXA     TXMNM,1        X                                         5A418300
       TRA     TRDX3          GO TO EXIT ROUTINE                        5A418400
       SPACE   3                                                        5A418500
TXMS1  PZE     **                                                       5A418600
TXMS2  PZE     **,,TRBFP                                                5A418700
       SPACE                                                            5A418800
TVMNI  PZE     **             IF ON, CHECK END-FLAG                     5A418900
TXMPI  PZE     **             IF ON, GET POINTER                        5A419000
TVMSI  PZE     **             IF ON, TVMNI IS ON, AND NEW BUFFER.       5A419100
       EJECT                                                            5A419200
*                                                                       5A419300
*      TGLNA   (CALLED BY BAKGL MACRO)                                  5A419400
*              BACK UP ONE LOCATION IN SPECIFIED TABLE                  5A419500
*              PICK UP WORD IN LOGICAL AC                               5A419600
*              SPECIAL EXIT IF BEGINNING OF TABLE.                      5A419700
TGLNA  SXA     TGLNG,4        SAVE IR4, PICK UP CONTENTS                5A419800
       CLA*    1,4            OF TCW FOR THIS TABLE                     5A419900
       PDX     0,4            BUFFER INDEX TO IR4                       5A420000
       TXI     *+1,4,1        BUMP INDEX BACKWARDS ONE                  5A420100
TGLNC  TXH     TGLNJ,4,TRBFN  TEST FOR BEGINNING OF BUFFER, YES         5A420200
       SPACE                                                            5A420300
TGLND  STA     TGLNE          NO, INITIALIZE ADDRESS                    5A420400
TGLNE  LDQ     **,4           PICK UP TABLE WORD IN MQ                  5A420500
       PXD     0,4            BUFFER INDEX TO DECR. AC                  5A420600
TGLNG  AXT     **,4           RESTORE CALL REGISTER                     5A420700
       STD*    1,4            STORE NEW BUFFER INDEX                    5A420800
       XCL                    TABLE WORD TO LAC                         5A420900
       TRA     2,4            RETURN                                    5A421000
       SPACE   3                                                        5A421100
TGLNJ  TSX     TRBBB,4        GET(BHW+BS+1) FOR PREVIOUS BUFFER         5A421200
       TRA     TGLNM          NO PREVIOUS BUFFER                        5A421300
       LXA     TGLNG,4        CALL INDEX                                5A421400
       STA*    1,4            NEW BUFFER INFO. TO TCW                   5A421500
       AXT     1,4            BUFFER INDEX = 1                          5A421600
       TRA     TGLND          REJOIN REGULAR ROUTINE                    5A421700
       SPACE   2                                                        5A421800
       REM                    BEGINNING OF FIRST BUFFER.                5A421900
TGLNM  LXA     TGLNG,4        CALL INDEX RELOADED                       5A422000
       TRA     TRDX1          GO TO EXIT ROUTINE                        5A422100
       EJECT                                                            5A422200
*      TGMNA,TGMPA - CALLED BY BAKGM,BAKGMP MACROS                      5A422300
*                                                                       5A422400
*      CALLING SEQUENCE (E.G) TSX TGMNA,4                               5A422500
*                             PZE TBLCW,,EXIT                           5A422600
*                             PZE COUNT,,LOC                            5A422700
*                                                                       5A422800
*      OPERATION - MOVE THE NEXT N 'BACKWARD' WORDS                     5A422900
*              FROM TBL TO LOC, ... , LOC + N+ 1                        5A423000
*              GO TO EXIT IF BEGINNING OF TABLE ENCOUNTERED.            5A423100
*              N IS CONTAINED IN COUNT.                                 5A423200
*              PROVIDE A COMPLEMENTED POINTER (IN TRPTR) TO THE         5A423300
*              TABLE LOCATION OF THE FIRST WORD ENCOUNTERED IF          5A423400
*              ENTRY IS MADE AT TGMPA.                                  5A423500
       SPACE                                                            5A423600
*      ENTER HERE WHEN POINTER REQUIRED.                                5A423700
       SPACE                                                            5A423800
TGMPA  SXA     TGMNM,1        SAVE IR1                                  5A423900
       AXT     TGMNE,1        PICK UP TRANSFER LOC.                     5A424000
       TRA     TGMNB          GO TO INITIALIZE                          5A424100
       SPACE                                                            5A424200
*      ENTER HERE WHEN POINTER NOT REQUIRED.                            5A424300
       SPACE                                                            5A424400
TGMNA  SXA     TGMNM,1        SAVE IR1                                  5A424500
       AXT     TGMNG,1        PICK UP TRANSFER LOCATION.                5A424600
TGMNB  SXA     TGMND,1        INITIALIZE TRANSFER BELOW                 5A424700
       SXA     TGMNN,2        SAVE IR2,IR4                              5A424800
       SXA     TGMNO,4        X                                         5A424900
       CAL     2,4            OUTPUT ADDRESS(COMPLEMENT                 5A425000
       PDC     0,2            IN IR2                                    5A425100
       CAL*    2,4            COUNT                                     5A425200
       PAX     0,1            IN IRU                                    5A425300
       CAL*    1,4            C(TCW) IN AC                              5A425400
TGMND  TRA     **             GO TO TGMNE,TGMNG FOR                     5A425500
       REM                    BAKGMP,BAKGM RESPECTIVELY.                5A425600
       EJECT                                                            5A425700
TGMNE  PDX     0,4            BUFFER INDEX TO IR4                       5A425800
       TXH     TGMNP,4,TRBFN-1  IF NEXT LOC. OUT OF BUFFER, SWITCH.     5A425900
TGMNF  TSX     TRBPA,4        POINTER TO NEXT IN TRPTR.                 5A426000
       SPACE                                                            5A426100
TGMNG  PDX     0,4            BUFFER INDEX TO IR4                       5A426200
TGMNH  STA     TGMNL          INITIALIZE ADDRESS BELOW.                 5A426300
       SPACE                                                            5A426400
TGMNJ  TXI     *+1,4,1        BUMP INDEX BACKWARDS                      5A426500
       TXH     TGMNQ,4,TRBFN  IF OUT OF BUFFER, SIWTCH.                 5A426600
TGMNL  LDQ     **,4           PICK UP FROM TABLE.                       5A426700
       STQ     0,2            STORE AS REQUESTED.                       5A426800
       TXI     *+1,2,-1       BUMP STORAGE INDEX                        5A426900
       TIX     TGMNJ,1,1      COUNT                                     5A427000
       SPACE                                                            5A427100
       PXD     0,4            FINAL BUFFER INDEX TO DECR. AC            5A427200
TGMNM  AXT     **,1           RELOAD REGISTERS                          5A427300
TGMNN  AXT     **,2           X                                         5A427400
TGMNO  AXT     **,4           X                                         5A427500
       STD*    1,4            STORE BUFFER INDEX IN TCW                 5A427600
       TRA     3,4            RETURN.                                   5A427700
       SPACE   3                                                        5A427800
*      ENTER HERE FROM TGMNE.                                           5A427900
       SPACE                                                            5A428000
TGMNP  AXT     TGMNF,4        SET UP RETURN TO TGMNF                    5A428100
       TRA     TGMNR          CONTINUE                                  5A428200
       SPACE                                                            5A428300
*      ENTER HERE FROM TGMNJ.                                           5A428400
       SPACE                                                            5A428500
TGMNQ  AXT     TGMNG,4        SET UP RETURN TGMNG                       5A428600
TGMNR  SXA     TGMNS,4        INITIALIZE TRANSFER.                      5A428700
       REM                    CURRENT A(TCW) IN A(AC)                   5A428800
       TSX     TRBBB,4        GET A(TCW) FOR PRECEDING BUFFER           5A428900
       TRA     TGMNU          NO PRECEDING BUFFER, OUT.                 5A429000
       SPACE                                                            5A429100
       LXA     TGMNO,4        OK, A(TCW) IN A(AC), D(AC)=0.             5A429200
       STA*    1,4            UPDATE TCW                                5A429300
TGMNS  TRA     **             RETURN TO TGMNE,TGMNG FOR                 5A429400
       REM                    ENTRY FROM TGMNE,TGMNJ RESPY.             5A429500
*      BEGINNING OF TABLE EXIT.                                         5A429600
TGMNU  LXA     TGMNO,4        LOAD CALL INDEX                           5A429700
       LXA     TGMNM,1        LOAD OTHER REGISTERS                      5A429800
       LXA     TGMNN,2        X                                         5A429900
       TRA     TRDX1          GO TO EXIT ROUTINE                        5A430000
       EJECT                                                            5A430100
*                                                                       5A430200
*      TJNNA   CALLED BY JFN MACRO                                      5A430300
*              CALLING SEQUENCE TSX TJNNA,4                             5A430400
*                             PZE TBLCW,,EXIT                           5A430500
*                             PZE COUNT                                 5A430600
*              MOVE FORWARD N LOCATIONS IN TBL                          5A430700
*              N CONTAINED IN A(COUNT)                                  5A430800
*              TRANSFER TO EXIT IF END OF LAST BUFFER ENCOUNTERED.      5A430900
*              IN THIS CASE,TBLCW INDICATES THE LAST WORD OF            5A431000
*              THE LAST BUFFER                                          5A431100
*                                                                       5A431200
TJNNA  SXA     TJNNE,4        SAVE REGISTER                             5A431300
       CAL*    2,4            COUNT TO A(AC)                            5A431400
       LDQ*    1,4            C(TBLCW) TO MQ                            5A431500
       PAX     0,4            COUNT TO IR4                              5A431600
       SXD     TJNNC,4        TO DECR. TEST INSTRUCTION                 5A431700
       SPACE                                                            5A431800
       XCL                    C(TBLCW) TO AC                            5A431900
       PDX     0,4            BUFFER INDEX TO IR4                       5A432000
TJNNC  TNX     TJNNG,4,**     BUMP INDEX TO TJNNG IF BUFFER END         5A432100
       PXD     0,4            NEW INDEX TO DECR. AC                     5A432200
TJNNE  AXT     **,4           RELOAD CALL REGISTER                      5A432300
       STD*    1,4            STORE BUFFER INDEX                        5A432400
       TRA     3,4            RETURN.                                   5A432500
*                                                                       5A432600
*      BUFFER END. SWITCH BUFFERS UNLESS LAST                           5A432700
*                                                                       5A432800
TJNNG  SXA     TJNNJ,4        SAVE OLD BUFFER INDEX                     5A432900
       AXT     TJNNC,4        INITIALIZE RETURN LOCATION                5A433000
TJNNH  SXA     TJNNK,4        X                                         5A433100
       TSX     TRFBB,4        GET(BHW+BS+1) FOR NEXT BUFFER             5A433200
       TRA     TJNNL          NO NEXT BUFFER                            5A433300
       LXA     TJNNE,4        CALL REGISTER IN IR4                      5A433400
       STA*    1,4            UPDATE TBLCW CELL                         5A433500
TJNNJ  AXT     **,4           OLD BUFFER INDEX. INCREASE BY BS          5A433600
TJNNK  TXI     **,4,TRBFN     AND RETURN AS INITIALIZED                 5A433700
*                                                                       5A433800
*      END OF LAST BUFFER. SPECIAL EXIT.                                5A433900
*                                                                       5A434000
TJNNL  LXA     TJNNE,4        RELOAD CALL REGISTER.                     5A434100
       TRA     TRDX2          GO TO EXIT ROUTINE                        5A434200
       EJECT                                                            5A434300
*                                                                       5A434400
*      TJ1NA   -CALLED BY JF1 JF1 MACRO.                                5A434500
*              MOVE FORWARD ONE LOCATION                                5A434600
*              IN SPECIFIED TABLE                                       5A434700
*                                                                       5A434800
TJ1NA  SXA     TJNNE,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A434900
       CAL*    1,4            C(TCW) TO AC                              5A435000
       PDX     0,4            BUFFER INDEX TO IR4                       5A435100
TJ1NC  TIX     TJXEX,4,1      BUMP, GO TO EXIT IF BUMPED.               5A435200
       SPACE                                                            5A435300
       SXA     TJNNJ,4        NO BUMP, NEED BUFFER SWITCH. SAVE         5A435400
       AXT     TJ1NC,4        BUFFER INDEX, GET RETURN LOC.             5A435500
       TRA     TJNNH          IN IR4, JOIN GENERAL ROUTINE              5A435600
*                                                                       5A435700
*      COMMON EXIT ROUTINE FOR TJ1NA,TJ2NA,TJ3NA                        5A435800
*                                                                       5A435900
TJXEX  PXD     0,4            BUFFER INDEX TO AC DECR.                  5A436000
       LXA     TJNNE,4        RELOAD CALL INDEX                         5A436100
       STD*    1,4            STORE NEW BUFFER INDEX                    5A436200
       TRA     2,4            RETURN                                    5A436300
       EJECT                                                            5A436400
*                                                                       5A436500
*      TJ2NA   CALLED BY JF2 MACRO                                      5A436600
*              CALLING SEQUENCE TSX TJ2NA,4                             5A436700
*                             PZE TBLCW,,EXIT                           5A436800
*              AS FOR TJNNA, EXCEPT THAT N=2.                           5A436900
*                                                                       5A437000
TJ2NA  SXA     TJNNE,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A437100
       CAL*    1,4            C(TCW) TO AC                              5A437200
       PDX     0,4            BUFFER INDEX TO IR4                       5A437300
TJ2NC  TIX     TJXEX,4,2      BUMP, GO TO EXIT IF BUMPED                5A437400
       SPACE                                                            5A437500
       SXA     TJNNJ,4        NO, NEED BUFFER SWITCH, SAVE INDEX        5A437600
       AXT     TJ2NC,4        GET RETURN LOC. IN IR4                    5A437700
       TRA     TJNNH          JOIN GENERAL ROUTINE                      5A437800
*                                                                       5A437900
*      TJ3NA   CALLED BY JF3 MACRO.                                     5A438000
*              CALLING SEQUENCE TSX TJ3NA,4                             5A438100
*                             PZE TBLCW,,EXIT                           5A438200
*              AS FOR TJNNA, EXCEPT THAT N=3.                           5A438300
*                                                                       5A438400
TJ3NA  SXA     TJNNE,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A438500
       CAL*    1,4            C(TCW) TO AC                              5A438600
       PDX     0,4            BUFFER INDEX TO IRJ                       5A438700
TJ3NC  TIX     TJXEX,4,3      BUMP, GO TO EXIT IF BUMPED                5A438800
       SPACE                                                            5A438900
       SXA     TJNNJ,4        NO, NEED BUFFER SWITCH. SAVE INDEX.       5A439000
       AXT     TJ3NC,4        GET RETURN LOC. IN IR4                    5A439100
       TRA     TJNNH          JOIN GENERAL ROUTINE                      5A439200
       EJECT                                                            5A439300
*                                                                       5A439400
*      THNNA   CALLED BY JBN MACRO.                                     5A439500
*              CALLING SEQUENCE TSX THNNA,4                             5A439600
*                             PZE TBLCW,,EXIT                           5A439700
*                             PZE COUNT                                 5A439800
*              MOVE BACKWARD N LOCATIONS IN TBL                         5A439900
*              N CONTAINED IN A(COUNT).                                 5A440000
*              TRANSFER TO EXIT IF START OF FIRST BUFFER ENCOUNTERED.   5A440100
*              IN THIS CASE, TBLCW INDICATES THE LOCATION               5A440200
*              PRECEDING THE FIRST LOCATION OF THE FIRST BUFFER.        5A440300
*                                                                       5A440400
THNNA  SXA     THNNG,4        SAVE REGISTER.                            5A440500
       CAL*    2,4            COUNT IN A(AC)                            5A440600
       LDQ*    1,4            C(TBLCW) IN MQ.                           5A440700
       PAX     0,4            COUNT IN IR4.                             5A440800
       SXD     THNNC,4        INITIALIZE BUMP INSTRUCTION.              5A440900
       XCL                    C(TBLCW) IN AC.                           5A441000
       PDX     0,4            BUFFER INDEX IN IR4.                      5A441100
THNNC  TXI     *+1,4,**       BUMP BUFFER INDEX AS INSTRUCTED.          5A441200
THNNE  TXH     THNNJ,4,TRBFN  IF OUT OF BUFFER, TRANSFER OUT.           5A441300
       PXD     0,4            OK, NEW INDEX TO DECR. AC.                5A441400
THNNG  AXT     **,4           RELOAD CALL REGISTER.                     5A441500
       STD*    1,4            SAVE BUFFER INDEX.                        5A441600
       TRA     3,4            RETURN.                                   5A441700
*                                                                       5A441800
*      OUT OF BUFFER. SWITCH TO PRECEDING UNLESS FIRST                  5A441900
*                                                                       5A442000
THNNJ  SXA     THNNL,4        SAVE BUMPED INDEX                         5A442100
       AXT     THNNE,4        PICK UP RETURN LOC                        5A442200
THNNK  SXA     THNNM,4        INITIALIZE RETURN INST.                   5A442300
       TSX     TRBBB,4        GET (BHW+BS+1) FOR PRECEDING BUFFER       5A442400
       TRA     THNNN          NO PRECEDING BUFFER                       5A442500
       LXA     THNNG,4        OK, GET CALL INDEX                        5A442600
       STA*    1,4            STORE NEW TCW ADDRESS                     5A442700
THNNL  AXT     **,4           BUMPED INDEX BACK TO IR4                  5A442800
THNNM  TXI     **,4,-TRBFN    BUMP DOWN FOR NEW BUFFER, TRY AGAIN.      5A442900
*                                                                       5A443000
*      START OF FIRST BUFFER. SPECIAL EXIT.                             5A443100
*                                                                       5A443200
THNNN  LXA     THNNG,4        RELOAD CALL REGISTER.                     5A443300
       TRA     TRDX1         GO TO EXIT ROUTINE                         5A443400
       EJECT                                                            5A443500
*                                                                       5A443600
*      TH1NA   CALLED BY JB1 MACRO                                      5A443700
*              CALLING SEQUENCE TSX TH1NA,4                             5A443800
*                             PZE TBLCW,,EXIT                           5A443900
*              AS FOR THNNA,EXCEPT THAT N=1.                            5A444000
*                                                                       5A444100
TH1NA  SXA     THNNG,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A444200
       CAL*    1,4            C(TCW) IN AC                              5A444300
       PDX     0,4            BUFFER INDEX IN IR4                       5A444400
       TXI     *+1,4,1        BUMP BY 1                                 5A444500
TH1NB  TXL     THXEX,4,TRBFN  EXIT UNLESS BEYOND END OF BUFFER          5A444600
       SPACE                                                            5A444700
TH1NC  SXA     THNNL,4        NEED BUFFER SWITCH. SAVE BUFFER INDEX     5A444800
       AXT     THXEX,4        GET RETURN LOC. IN IR4                    5A444900
       TRA     THNNK          JOIN GENERAL ROUTINE                      5A445000
       SPACE                                                            5A445100
*                                                                       5A445200
*      COMMON EXIT ROUTINE FOR TH1NA,TH2NA,TH3NA                        5A445300
*                                                                       5A445400
THXEX  PXD     0,4            NEW BUFFER INDEX IN AC DECR.              5A445500
       LXA     THNNG,4        RELOAD CALL INDEX                         5A445600
       STD*    1,4            STORE BUFFER INDEX                        5A445700
       TRA     2,4            RETURN                                    5A445800
*                                                                       5A445900
*      TH2NA   CALLED BY JB2 MACRO.                                     5A446000
*              CALLING SEQUENCE TSX TH2NA,4                             5A446100
*                             PZE TBLCW,,EXIT                           5A446200
*              AS FOR THNNA, EXCEPT THAT N=2                            5A446300
*                                                                       5A446400
TH2NA  SXA     THNNG,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A446500
       CAL*    1,4            C(TCW) IN AC                              5A446600
       PDX     0,4            BUFFER INDEX IN IR4                       5A446700
       TXI     TH1NB,4,2      BUMP BY 2, JOIN TH1NA ROUTINE             5A446800
*                                                                       5A446900
*      TH3NA   CALLED BY JB3 MACRO                                      5A447000
*              CALLING SEQUENCE TSX TH3NA,4                             5A447100
*                             PZE TBLCW,,EXIT                           5A447200
*              AS FOR THNNA, EXCEPT THAT N=3.                           5A447300
*                                                                       5A447400
TH3NA  SXA     THNNG,4        SAVE CALL INDEX IN GENERAL ROUTINE        5A447500
       CAL*    1,4            C(TCW) IN AC                              5A447600
       PDX     0,4            BUFFER INDEX IN IR4                       5A447700
       TXI     TH1NB,4,3      BUMP BY 3, JOIN TH1NA ROUTINE             5A447800
       EJECT                                                            5A447900
*                                                                       5A448000
*      TRABA                                                            5A448100
*                                                                       5A448200
*      ATTACH BUFFER TO ANY TABLE                                       5A448300
*                                                                       5A448400
*      ENTER WITH ADDRESS OF TABLE CONTROL WORD(TBLCW) IN AC            5A448500
*      EXIT WITH ADDRESS OF NEW BUFFER +BS+1 IN AC                      5A448600
*                                                                       5A448700
TRABA  SXA     TRABX,4        SAVE REGISTERS                            5A448800
       SXA     TRABY,2        X                                         5A448900
       PAC     0,4            -TBLCW TO IR4                             5A449000
       LDQ     -1,4           C(TBL), IE C(THW), TO MQ                  5A449100
       TQP     TRABQ          IF PLUS, THEN NOT INTERPHASE              5A449200
       SPACE   3                                                        5A449300
*                                                                       5A449400
*      INTERPHASE TABLE-ALLOCATE BUFFER FROM HIGH-ORDER AVAILABLE SPACE.5A449500
*                                                                       5A449600
       SPACE                                                            5A449700
TRABB  LXA     TRHLS,2        HIGHEST LOC. OF LOW-ORDER TABLES          5A449800
       SXD     TRABD,2        SAVE FOR TEST                             5A449900
       LXD     TRHLS,2        LOWEST LOC. OF HIGH-ORDER TABLES          5A450000
TRABC  TXI     *+1,2,-TRBFP   PLUS B.S.+1 (INIT.  )                    *5A450100
TRABD  TXH     TRABH,2,**     TEST FOR OVERLAP, NO                      5A450200
       SPACE   2                                                        5A450300
       CLA     TRNUL          YES, EXAMINE NULL CHAIN.                  5A450400
       TZE     TRER1          NO NULL CHAIN, COLLAPSE.                  5A450500
       STO     TRABZ          FIND HIGHEST-ORDER BUFFER                 5A450600
       PDC     0,2                                                      5A450700
TRABF  CLA     0,2                                                      5A450800
       PDC     0,2                                                      5A450900
       CAS     TRABZ          COMPARE                                   5A451000
       STO     TRABZ          GREATER, STORE NEW GREATEST               5A451100
       TRA     TRABF          AND CONTINUE                              5A451200
       TXH     TRABF,2,0      LESS, TEST FOR ZERO (=END OF CHAIN)       5A451300
       SPACE   2                                                        5A451400
       LXD     TRHLS,2        NULL CHAIN CHECKED                        5A451500
       SXD     TRABG,2        SET UP TEST.                              5A451600
       LDC     TRABZ,2        -ADDR. OF HIGHEST-LOC. BUFFER             5A451700
       CLA     0,2            EXTRACT FROM CHAIN.  ZERO BHW.            5A451800
       STZ     0,2            X                                         5A451900
       PDC     0,2            STORE ADDRESS OF FOLLOWING BUFFER         5A452000
       TXH     *+2,2,0        (OR ZERO IF LAST) INTO ADDRESS OF PREVIOUS5A452100
       AXT     -TRNUL,2       BHW, OR INTO A(TRNUL) IF FIRST.           5A452200
       STA     0,2            X                                         5A452300
       PAC     0,2            STORE ADDRESS OF PRECEDING BUFFER         5A452400
       TXH     *+2,2,0        (OR ZERO IF FIRST) INTO DECR. OF          5A452500
       AXT     -TRNUL,2       FOLLOWING BHW,                            5A452600
       STD     0,2            OR INTO D(TRNUL) IF LAST                  5A452700
       LXD     TRABZ,2        PICK UP ADDRESS OF BUFFER + CONTINUE      5A452800
TRABG  TXH     TRABV,2,**     IF NOT LOWEST HIGH-ORDER SO FAR.          5A452900
       SPACE                                                            5A453000
TRABH  SXD     TRHLS,2       NEW HIGH-ORDER LIMIT                       5A453100
       TRA     TRABN         CONTINUE                                   5A453200
       EJECT                                                            5A453300
*                                                                       5A453400
*      ERASABLE TABLES, OR ANY TABLE IN PHASE B.                        5A453500
*                                                                       5A453600
*      ALLOCATE BUFFER FROM LOW-ORDER AVAILABLE SPACE                   5A453700
*                                                                       5A453800
TRABI  LXA     TRHLS,2        HIGHEST LOW-ORDER USED                    5A453900
TRABJ  TXI     *+1,2,TRBFP    BUMP BY BS+1 (INIT.  )                   *5A454000
       SXD     TRABK,2        SAVE FOR TEST                             5A454100
       SXA     TRHLS,2        BACK TO KEY WORD                          5A454200
       LXD     TRHLS,2        LOWEST HIGH-ORDER                         5A454300
TRABK  TXL     TRABM,2,**     TEST FOR OVERLAP, TRANSFER IF YES.        5A454400
       LXA     TRHLS,2        NO, GET NEW HIGHEST, REDUCE BY BS         5A454500
TRABL  TXI     TRABN,2,-TRBFN FOR BHW ADDRESS.  CONTINUE                5A454600
       SPACE   2                                                        5A454700
TRABM  IFOFF   TREXI,TRER1    IF NO EXTRA SPACE, COLLAPSE               5A454800
       CLA     TRNHL          LIMITS OF EXTRA PHASE B SPACE             5A454900
       STO     TRHLS          TO KEYWORD                                5A455000
       SETOFF  TREXI          NO MORE SPACE AFTER THIS.                 5A455100
       TRA     TRABI          TRY AGAIN.                                5A455200
       SPACE   2                                                        5A455300
*                                                                       5A455400
*      BUFFER ALLOCATED FROM AVAILABLE SPACE (HIGH- OR LOW-ORDER)       5A455500
*              CLEAR BHW AND CONTINUE                                   5A455600
*                                                                       5A455700
TRABN  SXA     *+1,2         INITIALIZE WITH BHW ADDRESS.               5A455800
       STZ     **            CLEAR BHW                                  5A455900
       TRA     TRABV         CONTINUE                                   5A456000
       EJECT                                                            5A456100
*                                                                       5A456200
*      NORMAL (NON-INTERPHASE) TABLES.                                  5A456300
*      GET NEXT BUFFER FROM NULL CHAIN.. UPDATE CHAIN.                  5A456400
*                                                                       5A456500
*                                                                       5A456600
TRABQ  LXA     TRNUL,2        ADDR. OF 1ST. BUFFER IN NULL CHAIN TO IR2 5A456700
       TXL     TRABI,2,0      IF ZERO, NO NULL CHAIN                    5A456800
       SPACE                                                            5A456900
       CLA*    TRNUL          PICK UP BHW FOR FIRST BUFFER IN NULL      5A457000
       TNZ     TRABS          IF ZERO, ONLY ONE BUFFER IN NULL          5A457100
       SPACE                                                            5A457200
       STZ     TRNUL          KILL NULL CHAIN                           5A457300
       TRA     TRABV          CONTINUE, WITH ADDR. OF BUFFER IN IR2     5A457400
       SPACE                                                            5A457500
TRABS  STZ*    TRNUL          ZERO BHW FOR BUFFER FOUND, THEN ADDR. OF  5A457600
       STA     TRNUL          2ND BUFFER, NOW 1ST, TO NULL THW          5A457700
       STD*    TRNUL         ZERO DECR. OF BHW OF NEW 1ST BUFFER        5A457800
       SPACE   2                                                        5A457900
*                                                                       5A458000
*      ATTACH BUFFER TO TABLE.                                          5A458100
*                                                                       5A458200
*                                                                       5A458300
TRABV  PXD     0,2            BUFFER ADDRESS IN DECR.                   5A458400
       NZT     -1,4           IF THIS IS FIRST BUFFER FOR TABLE         5A458500
       TRA     TRABW          GO TO TRABW                               5A458600
       SPACE                                                            5A458700
       LDQ     -1,4           THW IN MQ                                 5A458800
       STD     -1,4           LOC (NEW LAST BUFFER) TO DECR. (THW)      5A458900
       PDC     0,4            COMP. BUFFER ADDR. TO IR4                 5A459000
       XCA                    OLD LAST-BUFFER-ADDR. IN DECR.            5A459100
       STD     0,4            TO NEW BUFFER BHW DECR.                   5A459200
       PDC     0,4            NEW BUFFER ADDR. TO                       5A459300
       PXA     0,2            ADDR. OF OL-LAST-BUFFER BHW               5A459400
       STA     0,4            X                                         5A459500
       TRA     TRABWA         EXIT.                                     5A459600
       SPACE                                                            5A459700
TRABW  STD     -1,4           FIRST BUFFER FOR TABLE - STORE LOCATION   5A459800
       PXA     0,2            IN DECR. AND ADDR. OF THW                 5A459900
       STA     -1,4           BUFFER LOCATION IN AC                     5A460000
       SPACE                                                            5A460100
TRABWA ADD     TRBSP          BHW +BS+1 IN AC                           5A460200
TRABX  AXT     **,4           RELOAD REGISTERS                          5A460300
TRABY  AXT     **,2           X                                         5A460400
       TRA     1,4            RETURN                                    5A460500
       SPACE                                                            5A460600
TRABZ  PZE     **             ERASABLE STORAGE                          5A460700
       EJECT                                                            5A460800
*                                                                       5A460900
*      TRSPA   CALLED BY RSTPTR MACRO                                   5A461000
*              RESET TABLE MARKER IN TBLCW TO                           5A461100
*              LOCATION INDICATED BY COMPLEMENTED                       5A461200
*              POINTER IN AC. EXIT IF LOC. NOT IN TABLE                 5A461300
*      CALL SEQUENCE  -  TSX TRSPA,4                                    5A461400
*                        PZE TBL,,EXIT                                  5A461500
*                        PZE TBLCW                                      5A461600
TRSPA  SXA     TRSPJ,4        SAVE REGISTERS                            5A461700
       SXA     TRSPL,2        X                                         5A461800
       LDQ*    1,4            C(THW) TO MQ                              5A461900
       PAX     0,2            POINTER TO IR2.                           5A462000
       XCL                    C(THW) TO AC                              5A462100
       TXI     *+1,2,TRBFP                                              5A462200
       SXA     TRSPC,2                                                  5A462300
       TRA     TRSPE                                                    5A462400
       SPACE                                                            5A462500
TRSPC  AXT     **,2                                                     5A462600
TRSPD  CLA     0,4                                                      5A462700
       SPACE                                                            5A462800
TRSPE  PAC     0,4                                                      5A462900
       TXL     TRSPN,4,0                                                5A463000
       SXD     TRSPG,4                                                  5A463100
TRSPG  TNX     TRSPD,2,**                                               5A463200
       TXH     TRSPC,2,TRBFN                                            5A463300
       SPACE                                                            5A463400
       PXD     0,4                                                      5A463500
       PDC     0,4                                                      5A463600
       TXI     *+1,4,TRBFP                                              5A463700
       PXA     0,4                                                      5A463800
       SPACE                                                            5A463900
TRSPJ  AXT     **,4                                                     5A464000
       STA*    2,4                                                      5A464100
       PXD     0,2                                                      5A464200
       STD*    2,4                                                      5A464300
TRSPL  AXT     **,2                                                     5A464400
       TRA     3,4                                                      5A464500
TRSPN  LXA     TRSPJ,4                                                  5A464600
       TRA     TRDX4          GO TO EXIT ROUTINE                        5A464700
       EJECT                                                            5A464800
*                                                                       5A464900
*      TRPLA   CALLED BY GETPTR MACRO                                   5A465000
*              CALLING SEQUENCE   TSX TRPLA,4                           5A465100
*                                 PZE TBLCW                             5A465200
*              CONVERT CURRENT TABLE MARKER IN TBLCW                    5A465300
*              TO COMPLEMENTED POINTER IN AC                            5A465400
*                                                                       5A465500
TRPLA  SXA     TRPLX,4        SAVE REGISTER                             5A465600
       CAL*    1,4            C(TBLCW) TO AC                            5A465700
       PAC     0,4            COMPLEMENTED POINTER                      5A465800
       STD     *+1            = - ADDRESS (TBLCW)                       5A465900
       TXI     *+1,4,**       + DECREMENT (TBLCW)                       5A466000
       PXA     0,4            RESULT TO AC                              5A466100
TRPLX  AXT     **,4           RELOAD.                                   5A466200
       TRA     2,4            RETURN.                                   5A466300
       EJECT                                                            5A466400
*                                                                       5A466500
*      TRPSA   CALLED BY GETPTS MACRO                                   5A466600
*              CALLING SEQUENCE   TSX TRPSA,4                           5A466700
*                                 PZE TBLCW                             5A466800
*              CONVERT CURRENT TABLE MARKER IN TBLCW                    5A466900
*              TO COMPLEMENTED POINTER IN TRPTR                         5A467000
*              PRESERVE AC                                              5A467100
*                                                                       5A467200
TRPSA  SXA     TRPSX,4        SAVE REGISTER                             5A467300
       XCL                    SAVE AC                                   5A467400
       CAL*    1,4            C(TBLCW) TO AC                            5A467500
       PAC     0,4            COMPLEMENTED POINTER                      5A467600
       STD     *+1            = - ADDR. (TBLCW)                         5A467700
       TXI     *+1,4,**       + DECR. (TBLCW)                           5A467800
       SXA     TRPTR,4        RESULT TO TRPTR                           5A467900
       XCL                    RESTORE AC                                5A468000
TRPSX  AXT     **,4           RELOAD                                    5A468100
       TRA     2,4            RETURN                                    5A468200
       EJECT                                                            5A468300
*                                                                       5A468400
*      TRRPA   CALLED BY      RELPTR MACRO                              5A468500
*              CALLING SEQUENCE TSX TRRPA,4                             5A468600
*                             PZE TBL,,EXIT                             5A468700
*                             PZE TBLCW                                 5A468800
*              RESET THE TABLE MARKER IN TABLCW                         5A468900
*              ACCORDING TO THE 'RELATIVE POINTER' IN A(AC)             5A469000
*              E.G. 'RESET TO THE 753RD WORD IN TBL'                    5A469100
*              GO TO EXIT IF THERE IS NO SUCH POSITION IN TBL.          5A469200
*                                                                       5A469300
TRRPA  SXA     TRRPG,4        SAVE REGISTERS                            5A469400
       SXA     TRRPJ,2        X                                         5A469500
       PAX     0,2            RELATIVE POINTER TO IR2                   5A469600
       CLA*    1,4            C(THW) TO AC                              5A469700
       TNZ     TRRPE          IF NOT ZERO, CONTINUE                     5A469800
       TRA     TRRPL          ZERO, NO TABLE, EXIT.                     5A469900
TRRPC  CAL     0,4            GET NEXT BHW                              5A470000
TRRPE  PAC     0,4            -LOC OF FOLLOWING BUFFER IN IR4           5A470100
       TXL     TRRPL,4,0      IF ZERO, NO MORE, EXIT.                   5A470200
       TIX     TRRPC,2,TRBFN  REDUCE POINTER BY BUFFER SIZE.            5A470300
       SXD     *+1,2         COMPUTE  -(BHW + POSITION)                 5A470400
       TNX     TRRPL,4,**    IN IR4                                     5A470500
       PXA     0,4           TO AC FOR EXIT                             5A470600
TRRPG  AXT     **,4          RELOAD IR4                                 5A470700
TRRPJ  AXT     **,2           RELOAD IR2.                               5A470800
       TRA     2,4           RETURN                                     5A470900
*                                                                       5A471000
*      TRANSFE R HERE IF POSITION NOT IN TABLE.                         5A471100
*                                                                       5A471200
TRRPL  LXA     TRRPJ,2        RELOAD REGISTERS                          5A471300
       LXA     TRRPG,4        X                                         5A471400
       TRA     TRDX4          GO TO EXIT ROUTINE                        5A471500
       EJECT                                                            5A471600
*                                                                       5A471700
*      TNMEA   CALLED BY ENTNAM MACRO                                   5A471800
*              CALLING SEQUENCE   TSX TNMEA,4                           5A471900
*                                 PZE DUP,,LOC                          5A472000
*              THE NAME TABLE(TNM) IS SEARCHED FOR                      5A472100
*              AN ENTRY IDENTICAL TO THE 6-CHARACTER                    5A472200
*              NAME IN LOC. IF NOT FOUND, AN ENTRY IS MADE.             5A472300
*              IF FOUND, EXIT TO DUP.                                   5A472400
*              IN BOTH CASES, A COMPLEMENTED POINTER TO                 5A472500
*              THE FIRST WORD OF THE TNM ENTRY IS PLACED IN             5A472600
*              THE A(AC) ON EXIT                                        5A472700
*                                                                       5A472800
*              A HASH TABLE WITH MOVABLE ORIGIN,                        5A472900
*              OF LENGTH TRHIN IS USED.                                 5A473000
*              A RELATIVE LOCATION IS THIS TABLE                        5A473100
*              IS FOUND BY 'DIVIDING THE NAME'                          5A473200
*              BY TRHIN.                                                5A473300
*              A COMPLEMENTED POINTER IN THE                            5A473400
*              ADDRESS FIELD OF THE LOCATION THUS FOUND                 5A473500
*              INDICATES THE FIRST ENTRY IN A CHAIN                     5A473600
*              OF TNM ENTRIES WITH IDENTICAL 'HASH VALUES'.             5A473700
*                                                                       5A473800
       SPACE                                                            5A473900
TNMEA  SXA     TNMEX,4        SAVE REGISTER                             5A474000
       CAL     1,4            PICK UP FIRST WORD OF C.S.                5A474100
       PDC     0,4            -LOC(NAME) IN IR4                         5A474200
       CAL     0,4            PICK UP NAME                              5A474300
       SLW     TNMES          SAVE NAME                                 5A474400
       SPACE                                                            5A474500
       LRS     35             SET UP FOR DIVISION                       5A474600
       DVP     TRHIN          DIVIDE BY TABLE SIZE                      5A474700
       ADD     TRLIL          REMAINDER+HASH TABLE ORG. IN AC           5A474800
       PAC     0,4            -(HASH TABLE LOC.) IN IR4                 5A474900
       SXA     TNMEG,4        SAVE.                                     5A475000
       SPACE                                                            5A475100
       CAL     0,4            PICK UP HASH TABLE WORD                   5A475200
       PAX     0,4            ADDRESS GIVES NAME TABLE POINTER (COMP)   5A475300
       TXL     TNMEE,4,0      NO CHAIN IF ZERO                          5A475400
       SPACE                                                            5A475500
*      CHAIN EXISTS ON THIS HASH VALUE, CHECK FOR IDENTITY              5A475600
       SPACE                                                            5A475700
TNMEC  SXA     TNMEG,4        SAVE COMPLEMENTED NAME TABLE POINTER.     5A475800
       CAL     1,4            2ND WORD OF ENTRY IS LITERAL NAME         5A475900
       LAS     TNMES          CHECK AGAINST INPUT NAME                  5A476000
       TRA     *+2            DIFFERENT                                 5A476100
       TRA     TNMEN          SAME, GO TO DUP EXIT                      5A476200
       CAL     0,4            DIFFERENT, GET NEXT ENTRY POINTER         5A476300
       PAX     0,4            FROM 1ST WORD OF ENTRY. CONTINUE CHAIN.   5A476400
       TXH     TNMEC,4,0      ZERO INDICATES END OF CHAIN.              5A476500
       TRA     TNMEF          SKIP TEST FOR EXISTENCE                   5A476600
       EJECT                                                            5A476700
       SPACE   3                                                        5A476800
TNMEE  ZET     TNM            CHECK TNM EXISTS                          5A476900
       TRA     TNMEF          YES, OK                                   5A477000
       START   TNM            NO, CREATE TNM                            5A477100
       SPACE                                                            5A477200
TNMEF  ZAC                    ZERO 1ST WORD OF ENTRY + GET POINTER      5A477300
       NXTSLP  TNM            NO DANGER OF CROSSING BUFFER END          5A477400
       REM                    EXCEPT WITH 1ST WORD.                     5A477500
       STA     TNMEL          SAVE COMPLEMENTED POINTER                 5A477600
       SPACE                                                            5A477700
TNMEG  AXT     **,4           -LOCATION OF EITHER HASH TABLE WORD       5A477800
       REM                    OR LAST LINK IN CHAIN                     5A477900
       STA     0,4            STORE POINTER IN ADDRESS OF THIS LOCATION 5A478000
TNMEJ  JF3     TNM,TRER2      JUMP FORWARD 3 LOCS. IN NAME TABLE        5A478100
       REM                    END OF TABLE IS A LOGIC ERROR HERE        5A478200
TNMEL  AXT     **,4           POINTER TO ENTRY JUST MADE                5A478300
       CAL     TNMES          INPUT NAME TO 2ND WORD OF ENTRY           5A478400
       SLW     1,4            X                                         5A478500
       STZ     2,4            ZERO 3RD+4TH WORDS OF ENTRY               5A478600
       STZ     3,4            X                                         5A478700
       SPACE                                                            5A478800
       PXA     0,4           POINTER TO AC                              5A478900
       LXA     TNMEX,4        RELOAD CALL INDEX                         5A479000
       TRA     2,4            RETURN                                    5A479100
       SPACE   3                                                        5A479200
*      EXIT HERE IF DUPLICATE FOUND.                                    5A479300
       SPACE                                                            5A479400
TNMEN  PXA     0,4           POINTER TO AC                              5A479500
TNMEX  AXT     **,4           RELOAD CALL INDEX.                        5A479600
       TRA*    1,4           GO TO DUP EXIT                             5A479700
       SPACE   3                                                        5A479800
TNMES  PZE     **                                                       5A479900
       EJECT                                                            5A480000
*                                                                       5A480100
*      TEFEA   CALLED BY ENTEFN MACRO                                   5A480200
*              CALLING SEQUENCE   TSX TEFEA,4                           5A480300
*                                 PZE DUP                               5A480400
*              EFN IN A(AC) ON ENTRY                                    5A480500
*              SEARCH EFN TABLE(TEF) FOR THIS EFN                       5A480600
*              BY HASH TECHNIQUE. IF FOUND, EXIT                        5A480700
*              TO DUP. OTHERWISE, MAKE ENTRY                            5A480800
*              AND TAKE NORMAL EXIT.                                    5A480900
*              IN EITHER CASE, COMPLEMENTED POINTER                     5A481000
*              TO 1ST WORD OF ENTRY IN A(AC) ON EXIT.                   5A481100
*                                                                       5A481200
TEFEA  SXA     TEFEX,4        SAVE REGISTER                             5A481300
       PAX     0,4            INPUT EFN TO IR4                          5A481400
       SXD     TEFES,4        SAVE IN DECREMENT                         5A481500
       PXD     0,4           CLEAR AC + MQ                              5A481600
       XCA                   OF EVERYTHING BUT EFN, AND                 5A481700
       ZAC                   SET UP FOR DIVISION                        5A481800
       DVP     TRHIN          DIVIDE BY TABLE SIZE                      5A481900
       ADD     TRLIL          REMAINDER+HASH TABLE ORG IN AC.           5A482000
       PAC     0,4            -(HASH TABLE LOC.) IN IR4                 5A482100
       SXA     TEFEQ,4        SAVE THIS H.T. POINTER                    5A482200
       SPACE                                                            5A482300
       CAL     0,4            PICK UP H. T. WORD                        5A482400
       PDX     0,4            DECR. IS EFN TABLE POINTER                5A482500
       TXH     TEFEC,4,0      IF NON-ZERO, GO TO CHECK CHAIN            5A482600
       SXA     TEFEG,0        NO CHAIN. CLEAR CHAIN POINTER             5A482700
       TRA     TEFEE          GO TO MAKE ENTRY.                         5A482800
       SPACE   3                                                        5A482900
*      CHAIN EXISTS FOR THIS HASH VALUE. CHECK IDENTITY.                5A483000
       SPACE                                                            5A483100
TEFEC  SXA     TEFEG,4        SAVE COMP. EFN TABLE POINTER              5A483200
       CAL     1,4            2ND WORD OF ENTRY CONTAINS EFN            5A483300
       ANA     TEFEM          IN DECR. MASK OUT ALL BUT EFN             5A483400
       LAS     TEFES          COMPARE WITH INPUT EFN                    5A483500
       TRA     *+2            DIFFERENT                                 5A483600
       TRA     TEFEN          SAME, GO TO DUP. EXIT.                    5A483700
       CAL     0,4            DIFFERENT,CHAIN POINTER FROM ADDR 1ST WORD5A483800
       PAX     0,4            IF NON-ZERO, CONTINUE CHAIN               5A483900
       TXH     TEFEC,4,0      ZERO INDICATES END OF CHAIN               5A484000
       EJECT                                                            5A484100
       SPACE                                                            5A484200
*      NO ENTRY FOUND. MAKE ENTRY.                                      5A484300
       SPACE                                                            5A484400
TEFEE  ZET     TEF            CHECK TEF EXISTS                          5A484500
       TRA     TEFEF          YES, CONTINUE                             5A484600
       START   TEF            NO, CREATE TEF                            5A484700
       SPACE                                                            5A484800
TEFEF  ZAC                    STORE ZERO IN 1ST WORD OF ENTRY           5A484900
       NXTSLP  TEF            NO DANGER OF CROSSING BUFFER END          5A485000
       REM                    EXCEPT WITH 1ST WORD. GET POINTER         5A485100
       STA     TEFEL          SAVE POINTER (COMP) TO 1ST WORD           5A485200
       SPACE                                                            5A485300
TEFEG  AXT     **,4           CHAIN POINTER. ZERO INDICATES NO CHAIN    5A485400
       TXL     TEFEP,4,0      GO TO CONNECT ENTRY WITH H.T.             5A485500
       STA     0,4            CONNECT WITH LAST LINK OF CHAIN           5A485600
       SPACE                                                            5A485700
TEFEJ  JF1     TEF,TRER2      JUMP TEF MARKER FORWARD FOR 2ND WORD      5A485800
       REM                    END OF TABLE IS HERE A LOGIC ERROR        5A485900
TEFEL  AXT     **,4           POINTER TO NEW ENTRY                      5A486000
       CAL     TEFES          ENTER EFN IN OTHERWISE ZERO ENTRY         5A486100
       SLW     1,4            X                                         5A486200
       SPACE                                                            5A486300
       PXA     0,4           POINTER TO AC                              5A486400
       LXA     TEFEX,4        RELOAD CALL INDEX                         5A486500
       TRA     2,4            RETURN                                    5A486600
       SPACE   3                                                        5A486700
*      EXIT HERE IF DUPLICATE FOUND.                                    5A486800
       SPACE                                                            5A486900
TEFEN  PXA     0,4           POINTER TO AC                              5A487000
TEFEX  AXT     **,4           RELOAD CALL INDEX                         5A487100
       TRA*    1,4            DUP EXIT                                  5A487200
       SPACE   3                                                        5A487300
*      CHAIN NEW ENTRY TO HASH TABLE.                                   5A487400
       SPACE                                                            5A487500
TEFEP  PAX     0,4            POINTER IN ADDRESS                        5A487600
       PXD     0,4            TO DECREMETN                              5A487700
TEFEQ  AXT     **,4           HASH TABLE POINTER IN IR4                 5A487800
       STD     0,4            EFN TABLE POINTER TO DECR. OF H.T.LOCATION5A487900
       TRA     TEFEJ          REJOIN MAIN ROUTINE                       5A488000
       SPACE   2                                                        5A488100
TEFES  PZE     0,0,**         STORAGE FOR EFN                           5A488200
TEFEM  PZE     0,0,-1         MASK FOR EFN TABLE ENTRY.                 5A488300
       EJECT                                                            5A488400
*                                                                       5A488500
*      TA1EA   CALLED BY          ENTTA1 MACRO                          5A488600
*              CALLING SEQUENCE   TSX TA1EA,4                           5A488700
*                                 PZE DUP,,LOC                          5A488800
TA1EA  SXA     TA1EX,4        SAVE REGISTER                             5A488900
       CAL     1,4            CALLING SEQUENCE WORD TO AC               5A489000
       PDC     0,4            -LOC(INPUT) TO IR4                        5A489100
       CAL     0,4            INPUT WORD TO LAC                         5A489200
       SLW     TA1ES+1        SAVE IN SKELETON TA1 ENTRY                5A489300
       LRS     35             SET UP FOR DIVISION                       5A489400
       DVP     TRHDN          DIVIDE BY HASH TABLE SIZE                 5A489500
       ADD     TRLDL          ADD HASH TABLE ORIGIN                     5A489600
       PAC     0,4            -(HASH TABLE LOC.) TO IR4                 5A489700
       SXA     TA1EJ,4        SAVE HASH TABLE POINTER                   5A489800
       SPACE                                                            5A489900
       CAL     0,4            PICK UP HASH TABLE ENTRY                  5A490000
       PDX     0,4            DECR. IS TA1 POINTER                      5A490100
       TXH     TA1EC,4,0      IF NON-ZERO,EXAMINE CHAIN                 5A490200
       SXA     TA1EG,0        ZERO, NO CHAIN. CLEAR CHAIN POINTER       5A490300
       TRA     TA1EE          GO TO MAKE ENTRY                          5A490400
       SPACE                                                            5A490500
*      CHAIN EXISTS FOR THIS HASH VALUE. CHECK FOR DUPLICATE            5A490600
       SPACE                                                            5A490700
TA1EC  SXA     TA1EG,4        SAVE TA1 POINTER                          5A490800
       CAL     1,4            SECOND WORD OF ENTRY                      5A490900
       LAS     TA1ES+1        COMPARE WITH INPUT                        5A491000
       TRA     *+2            DIFFERENT                                 5A491100
       TRA     TA1EN          SAME, GO TO DUP EXIT                      5A491200
       CAL     0,4            DIFFERENT, CHAIN POINTER FROM 1ST WORD    5A491300
       PAX     0,4            TO IR4                                    5A491400
       TXH     TA1EC,4,0      IF NON-ZERO, CONTINUE CHAIN               5A491500
       TRA     TA1EF          ZERO, END OF CHAIN, MAKE ENTRY            5A491600
       EJECT                                                            5A491700
*      NO HASH ENTRY FOUND . CHECK TABLE.                               5A491800
       SPACE                                                            5A491900
TA1EE  ZET     TA1            CHECK EXISTENCE OF TA1 TABLE              5A492000
       TRA     TA1EF          YES, CONTINUE                             5A492100
       START   TA1            NO, CREATE TA1                            5A492200
       SPACE                                                            5A492300
*      NO DUPLICATE TA1 ENTRY . MAKE ENTRY.                             5A492400
       SPACE                                                            5A492500
TA1EF  NXTSMP  TA1,TA1ES,TR3AD  ENTER, GET POINTER IN AC                5A492600
       SPACE                                                            5A492700
TA1EG  AXT     **,4           CHAIN POINTER TO IR4                      5A492800
       TXH     TA1EK,4,0      SKIP IF CHAIN EXISTS ON THIS HASH VALUE   5A492900
       SPACE                                                            5A493000
       PAX     0,4            ENTRY POINTER TO DECR.                    5A493100
       PXD     0,4            FROM ADDRESS OF AC                        5A493200
TA1EJ  AXT     **,4           HASH TABLE POINTER TO IR4                 5A493300
       STD     0,4            TA1 POINTER TO DECR.  H.T. ENTRY          5A493400
       PDX     0,4            POINTER BACK TO ADDR.                     5A493500
       PXA     0,4            X                                         5A493600
       TRA     TA1EL          GO TO EXIT                                5A493700
       SPACE                                                            5A493800
TA1EK  STA     0,4            ENTRY POINTER TO CHAIN                    5A493900
       SPACE                                                            5A494000
TA1EL  LXA     TA1EX,4        RELOAD CALL INDEX. NORMAL EXIT,           5A494100
       TRA     2,4            WITH POINTER IN AC ADDRESS                5A494200
       SPACE                                                            5A494300
*      EXIT HERE IF DUPLICATE FOUND.                                    5A494400
       SPACE                                                            5A494500
TA1EN  PXA     0,4            POINTER TO AC ADDRESS                     5A494600
TA1EX  AXT     **,4           RELOAD CALL REGISTER                      5A494700
       TRA*    1,4            TAKE DUP EXIT.                            5A494800
       SPACE   2                                                        5A494900
TA1ES  PZE     0              SKELETON TA1 ENTRY.                       5A495000
       PZE     **,**,**       2ND WORD SUPPLIED FROM INPUT              5A495100
       PZE     0              1ST + 3RD ALWAYS ZERO.                    5A495200
       SPACE                                                            5A495300
       EJECT                                                            5A495400
*      TA2EA + TSCEA                                                    5A495500
*              CALLED BY ENTTA2 + ENTSCP MACROS                         5A495600
*              CALLING SEQUENCE   TSX TBLEA,4                           5A495700
*                                 PZE DUP,,LOC                          5A495800
*                                 PZE COUNT                             5A495900
*              THE APPROPRIATE TABLE (TA2 OR TSC) IS                    5A496000
*              SEARCHED FOR AN ENTRY IDENTICAL TO                       5A496100
*              THAT IN LOC,...,LOC+N-1.                                 5A496200
*              N IS CONTAINED IN A(COUNT).                              5A496300
*              TA2EA USES HASH TABLE TRHTL OF LENGTH TRHTN              5A496400
*              TSCEA USES HASH TABLE TRHDL OF LENGTH TRHDN              5A496500
*                                                                       5A496600
*              IF AN IDENTICAL ENTRY IS FOUND, EXIT IS MADE TO DUP.     5A496700
*              IF NOT, AN ENTRY IS MADE, NORMAL EXIT.                   5A496800
*              IN EITHER CASE, A COMPLEMENTED POINTER TO THE ENTRY      5A496900
*              IS RETURNED IN A(AC).                                    5A497000
*                                                                       5A497100
TSCEA  CAL     TSCECW         PICK UP LOC(TCW) FOR TSC                  5A497200
       SXA     TA2EY,2        SAVE IR2                                  5A497300
       AXT     0,2            ZERO IN IR2                               5A497400
       TRA     TA2EB          CONTINUE                                  5A497500
       SPACE                                                            5A497600
TA2EA  CAL     TA2ECW         PICK UP LOC(TCW) FOR TA2                  5A497700
       SXA     TA2EY,2        SAVE IR2                                  5A497800
       AXT     -1,2           MINUS ONE IN IR2                          5A497900
TA2EB  STA     TA2EO          INITIALIZE CALLING SEQUENCE BELOW         5A498000
       SXA     TA2EX,4        SAVE OTHER REGISTERS                      5A498100
       SXA     TA2EZ,1            X                                     5A498200
       SPACE                                                            5A498300
       CAL     1,4                GET LOCATION (COMPLEMENTED) OF INPUT  5A498400
       PDC     0,1                IN IR1                                5A498500
       SXA     TA2EH,1            SAVE                                  5A498600
       SPACE                                                            5A498700
       CAL*    2,4                GET WORD COUNT OF INPUT               5A498800
       PAX     0,4                TO IR4                                5A498900
       SXA     TA2EJ,4            SAVE                                  5A499000
       SPACE                                                            5A499100
       CAL     0,1                GET LOGICAL SUM OF INPUT              5A499200
TA2EC  TNX     TA2ED,4,1          X                                     5A499300
       ACL     1,1                X                                     5A499400
       TXI     TA2EC,1,-1    X                                          5A499500
       EJECT                                                            5A499600
TA2ED  LRS     35                 SET UP FOR DIVISION                   5A499700
       SPACE                                                            5A499800
       DVP     TRHDN,2        DIVIDE BY APPROPRIATE TABLE SIZE          5A499900
       ADD     TRLDL,2        ADD APPROPRIATE TABLE ORIGIN              5A500000
       PAC     0,2            -(HASH TABLE LOCATION) IN IR2             5A500100
       SPACE                                                            5A500200
TA2EF5 SXA     TA2EL,2            SAVE HASH TABLE POINTER               5A500300
       CAL     0,2                HASH TABLE ENTRY. POINTER TO          5A500400
       PAX     0,2                CHAIN IN TA2 OR TSX, UNLESS ZERO.     5A500500
       TXL     TA2EN,2,0          ZERO, NO CHAIN, MAKE ENTRY            5A500600
*                                                                       5A500700
*      CHAIN ON THIS HASH VALUE. EXAMINE CHAIN.                         5A500800
*                                                                       5A500900
TA2EG  SXA     TA2EL,2            SAVE POINTER TO THIS ENTRY            5A501000
       CAL     0,2                FIRST WORD OF ENTRY                   5A501100
       STA     TA2EM              SAVE NEXT-ENTRY POINTER               5A501200
       SPACE                                                            5A501300
       ANA     TSCEM              MASK OUT IRRELEVANT FIELDS            5A501400
TA2EH  AXT     **,1               -LOC (INPUT) IN IR1                   5A501500
TA2EJ  AXT     **,4               WORD COUNT IN IR4                     5A501600
       TXI     TA2EK5,2,-1        BUMP ENTRY POINTER TO 2ND WORD        5A501700
       REM                        GO TO COMPARE                         5A501800
       SPACE   2                                                        5A501900
TA2EK  CAL     0,2                NEXT WORD OF ENTRY                    5A502000
       TXI     TA2EK5,2,-1        BUMP ENTRY POINTER                    5A502100
TA2EK5 LAS     0,1                COMPARE AGAINST APPROPRIATE INPUT WORD5A502200
       TRA     TA2EM              DIFFERENT                             5A502300
       TXI     *+2,1,-1           SAME, BRANCH + BUMP INPUT POINTER     5A502400
       TRA     TA2EM              DIFFERENT                             5A502500
       TIX     TA2EK,4,1          LOOP.                                 5A502600
*                                                                       5A502700
*      MATCHING ENTRY FOUND. TAKE DUP EXIT.                             5A502800
*                                                                       5A502900
TA2EL  AXT     **,2               PICK UP ENTRY POINTER                 5A503000
       PXA     0,2                TO A(AC)                              5A503100
TA2EX  AXT     **,4               RELOAD REGISTERS                      5A503200
TA2EY  AXT     **,2               X                                     5A503300
TA2EZ  AXT     **,1               X                                     5A503400
       TRA*    1,4                TAKE DUP EXIT                         5A503500
       EJECT                                                            5A503600
*                                                                       5A503700
*      NON-MATCHING ENTRY. CONTINUE CHAIN                               5A503800
*                                                                       5A503900
TA2EM  AXT     **,2               NEXT-ENTRY POINTER                    5A504000
       TXH     TA2EG,2,0          CONTINUE CHAIN UNLESS END.            5A504100
*                                                                       5A504200
*      NO CHAIN. MAKE ENTRY.                                            5A504300
*                                                                       5A504400
TA2EN  LXA     TA2EJ,1        WORD COUNT IN IR1                         5A504500
       LXA     TA2EH,2        -LOC (INPUT) IN IR2                       5A504600
       TSX     TRENA,4        GO TO MAKE ENTRY IN PROPER TABLE          5A504700
TA2EO  PZE     **             TSCCW OR TA2CW IN ADDRESS FIELD           5A504800
       SPACE                                                            5A504900
       LXA     TA2EL,2        LAST-ENTRY - OR HT-POINTER IN IR2         5A505000
       STA     0,2                CURRENT-ENTRY POINTER STORED          5A505100
       LXA     TA2EX,4            RELOAD REGISTERS                      5A505200
       LXA     TA2EY,2            X                                     5A505300
       LXA     TA2EZ,1            X                                     5A505400
       TRA     3,4                NORMAL EXIT.                          5A505500
       SPACE   2                                                        5A505600
TSCEM  OCT     737777700000   MASK FOR FIRST WORD OF ENTRY.             5A505700
TSCECW PZE     TSCCW,0,0                                                5A505800
TA2ECW PZE     TA2CW,0,0                                                5A505900
       EJECT                                                            5A506000
*                                                                       5A506100
*      TDMEA   CALLED BY ENTDIM MACRO                                   5A506200
*              CALLING SEQUENCE   TSX TDMEA,4                           5A506300
*                                 PZE COUNT,,LOC                        5A506400
*              THE N WORDS IN LOC,...,LOC +N +1 ARE                     5A506500
*              ENTERED IN THE TDM TABLE. N IS CONTAINED                 5A506600
*              IN A(COUNT). ALL N WORDS MUST BE IN THE                  5A506700
*              SAME BUFFER.                                             5A506800
*                                                                       5A506900
TDMEA  SXA     TDMEX,4            SAVE REGISTERS                        5A507000
       SXA     TDMEY,2            X                                     5A507100
       SXA     TDMEZ,1            X                                     5A507200
       SPACE                                                            5A507300
       CAL     1,4                                                      5A507400
       PDC     0,2                                                      5A507500
       CAL*    1,4                                                      5A507600
       PAX     0,1                                                      5A507700
       TSX     TRENA,4                                                  5A507800
       PZE     TDMCW                                                    5A507900
       SPACE                                                            5A508000
TDMEX  AXT     **,4               RELOAD REGISTERS,                     5A508100
TDMEY  AXT     **,2               AND EXIT WITH                         5A508200
TDMEZ  AXT     **,1               TABLE POINTER                         5A508300
       TRA     2,4                IN AC                                 5A508400
       EJECT                                                            5A508500
*      TRENA   USED BY TSCEA,TA2EA,TDMEA                                5A508600
*                                                                       5A508700
*      CALLING SEQUENCE-                                                5A508800
*      TSX     TRENA,4                                                  5A508900
*      PZE     TBLCW                                                    5A509000
*                                                                       5A509100
*              ENTER N WORDS FROM STORAGE INTO TBL.                     5A509200
*              AND CLOSE TBL.                                           5A509300
*              ENSURE THAT ALL WORDS ARE IN SAME BUFFER.                5A509400
*              N MUST BE LESS THAN BUFFER SIZE.                         5A509500
*              IF TBL DOES NOT EXIST, IT IS CREATED.                    5A509600
*                                                                       5A509700
*      INPUT   N IN INDEX REGISTER 1                                    5A509800
*              COMPLEMENT OF STORAGE LOC. OF 1ST WORD IN IR2            5A509900
*                                                                       5A510000
*      OUTPUT  COMPLEMENTED POINTER TO TBL LOC.                         5A510100
*              OF FIRST WORD, IN AC.                                    5A510200
*              IR1,IR2 INDETERMINATE                                    5A510300
*                                                                       5A510400
TRENA  SXA     TRENM,4        SAVE IR4                                  5A510500
       CAL     1,4            LOC(TCW) IN A(AC)                         5A510600
       STA     TRENF          INITIALIZE BELOW                          5A510700
       STA     TRENK          X                                         5A510800
       STA     TRENU          X                                         5A510900
       SPACE                                                            5A511000
       PAC     0,4            -LOC(TCW) IN IR4                          5A511100
       NZT     -1,4           TEST THW FOR EXISTENCE OF TABLE           5A511200
       TRA     TRENP          NO, TRANSFER.                             5A511300
       SPACE                                                            5A511400
TRENC  CAL     0,4            OK, C(TCW) TO AC                          5A511500
       TSX     TRNPA,4        COMPLEMENTED POINTER TO NEXT WORD         5A511600
       REM                    OF TABLE IN TRPTR                         5A511700
       SXA     TRENS,1        STORE COUNT                               5A511800
TRENE  TSX     TJNNA,4        JUMP FORWARD N IN TABLE                   5A511900
TRENF  PZE     **,,TRENT      GO TO TRENT IF TABLE END                  5A512000
       PZE     TRENS          (= BUFFER END)                            5A512100
       SPACE                                                            5A512200
TRENH  LXA     TRPTR,4        IR4 CONTAINS -LOC(FIRST WORD IN TABLE)    5A512300
TRENJ  LDQ     0,2            PICK UP WORD FRO STORAGE                  5A512400
       STQ     0,4            STORE IN TABLE                            5A512500
       TXI     *+1,4,-1       BUMP TABLE POINTER                        5A512600
       TXI     *+1,2,-1       BUMP STORAGE POINTER                      5A512700
       TIX     TRENJ,1,1      COUNT                                     5A512800
       SPACE                                                            5A512900
       TSX     TRCLA,4        CLOSE TABLE                               5A513000
TRENK  PZE     **             X                                         5A513100
       SPACE                                                            5A513200
       CAL     TRPTR          POINTER TO AC                             5A513300
TRENM  AXT     **,4           RELOAD REGISTER                           5A513400
       TRA     2,4            EXIT.                                     5A513500
       EJECT                                                            5A513600
*      ENTER HERE WHEN TABLE DOES NOT EXIST.                            5A513700
TRENP  STA     TRENQ          INITIALIZE CALLING SEQUENCE.              5A513800
       TSX     TRSTA,4        START TABLE                               5A513900
TRENQ  PZE     **             X                                         5A514000
       LAC     TRENQ,4        -LOC(TCW) IN IR4                          5A514100
       TRA     TRENC          REJOIN, -LOC(TCW) IN IR4                  5A514200
       SPACE                                                            5A514300
*      ENTER HERE TO ATTACH NEW BUFFER.                                 5A514400
TRENT  TSX     TWLPA,4        ATTACH BUFFER, GARBAGE FIRST WORD         5A514500
TRENU  PZE     **             POINTER IN AC ON RETURN                   5A514600
       STA     TRPTR          SAVE POINTER                              5A514700
       TNX     TRENH,1,1      NO MORE JUMP IF N=1                       5A514800
       SXA     TRENS,1        STORE N-1 FOR JUMPING                     5A514900
       TXI     TRENE,1,1      GOTO JUMP, C(IR1) =N                      5A515000
       SPACE   2                                                        5A515100
TRENS  PZE     **             STORAGE.                                  5A515200
       SPACE                                                            5A515300
       EJECT                                                            5A515400
*                                                                       5A515500
*      TKTBA   -CALLED BY KILTAB MACRO.                                 5A515600
*              -CALLING SEQUENCE  TSX TKTBA,4                           5A515700
*                                 PZE TBL                               5A515800
*              THE TABLE WHOSE THW IS TBL IS KILLED,                    5A515900
*              TBL IS CLEARED, AND ALL BUFFERS                          5A516000
*              ARE ATTACHED TO THE NULL STRING                          5A516100
*                                                                       5A516200
       SPACE                                                            5A516300
TKTBA  STZ     TKTBI          SET OFF 'LAST-TABLE' INDICATOR            5A516400
TKTBB  SXA     TKTBX,4        SAVE INDEX.                               5A516500
       CLA     1,4            PICK UP CALLING SEQUENCE WORD.            5A516600
       TMI     TKTBC          IF MINUS, NOT LAST, SKIP.                 5A516700
       STL     TKTBI          'LAST-TABLE' INDICATOR ON                 5A516800
TKTBC  CLA*    1,4            C(THW) IN AC.                             5A516900
       TZE     TKTBX          IF ZERO, NO TABLE, EXIT                   5A517000
       STZ*    1,4            KILL THW                                  5A517100
       SPACE                                                            5A517200
       NZT     TRNUL          IF NO NULL STRING,                        5A517300
       TRA     TKTBZ          START ONE NOW.                            5A517400
       SPACE                                                            5A517500
       LDQ     TRNUL          NULL STRING HW TO MQ.                     5A517600
       LDC     TRNUL,4        -LOC(LAST NULL BUFFER) IN IR4.            5A517700
       STD     TRNUL          LAST BUFFER OF TABLE BECOMES LAST OF NULL.5A517800
       STA     0,4            FIRST OF TABLE CONNECTED TO PREVIOUS LAST 5A517900
       XCL                    OF NULL,                                  5A518000
       STD*    0,4            AND VICE VERSA.                           5A518100
       SPACE                                                            5A518200
TKTBX  AXT     **,4           RELOAD REGISTER.                          5A518300
       NZT     TKTBI          IF INDICATOR OFF, GO BACK FOR             5A518400
       TXI     TKTBB,4,-1     NEXT TABLE, BUMP INDEX                    5A518500
       TRA     2,4            OTHERWISE, RETURN                         5A518600
       SPACE   3                                                        5A518700
TKTBZ  SLW     TRNUL          TABLE BECOMES ENTIRE NULL STRING          5A518800
       TRA     TKTBX          GO TO END TEST                            5A518900
       SPACE   2                                                        5A519000
TKTBI  PZE     **             'LAST-TABLE' INDICATOR                    5A519100
       EJECT                                                            5A519200
       SPACE                                                        (14)5A522300
*              PATCH SPACE FOR PHASE A                              (14)5A522400
*                                                                   (14)5A522450
       BSS     19             USED FOR PATCH IN ASSEMBLY C          (14)5A522500
       BSS     11             USED FOR PATCH IN ASSEMBLY E          (15)5A522600
       STR                    AVAILABLE PATCH SPACE                 (14)5A523700
       STR                    AVAILABLE PATCH SPACE                 (14)5A523800
       STR                    AVAILABLE PATCH SPACE                 (14)5A523900
       EJECT                                                            5A524100
*                                                                       5A524200
*      TKAFA   CALLED BY KILAFT MACRO                                   5A524300
*              CALLING SEQUENCE   TSX TKAFA,4                           5A524400
*                                 PZE TBLCW                             5A524500
*              IF THE LOC. INDICATED BY TBLCW IS                        5A524600
*              IN THE LAST BUFFER OF THE TABLE,                         5A524700
*              THERE IS NO EFFECT.                                      5A524800
*              OTHERWISE, ALL BUFFERS FOLLOWING THAT                    5A524900
*              INDICATED ARE DISCONNECTED FROM THE                      5A525000
*              TABLE AND CONNECTED TO THE NULL STRING,                  5A525100
*              AND TBLFN IS CLEARED.                                    5A525200
*                                                                       5A525300
       SPACE                                                            5A525400
TKAFA  SXA     TKAFX,4        SAVE REGISTERS                            5A525500
       SXA     TKAFY,2        X                                         5A525600
       CAL     1,4            LOC(TCW) IN AC                            5A525700
       PAC     0,4            -LOC(TCW) IN IR4                          5A525800
       CLA     -1,4           C(THW) IN AC                              5A525900
       TZE     TKAFX         IF ZERO, NO TABLE, EXIT.                   5A526000
       CAL     0,4            C(TCW) IN LAC                             5A526100
       PAC     0,2            -(BHW+BS+1) IN IR2                        5A526200
       LDQ     -TRBFP,2       C(BHW) IN MQ.                             5A526300
       PXD     0,0            CLEAR ADDR. OF BHW.                       5A526400
       STA     -TRBFP,2       I.E.DISCONNECT FROM HANGING BUFFERS,IF ANY5A526500
       XCL                    -LOC(NEXT BHW,=BHW OF 1ST HANGING BUFFER) 5A526600
       PAC     0,2            IN IR2.                                   5A526700
       TXL     TKAFX,2,0      IF ZERO, NO HANGING BUFFER.               5A526800
       STA     TKAFS          FIRST HANGING BUFFER AS FIRST BUFFER      5A526900
       PXD     0,0            OF SUB-TABLE. CLEAR AC.                   5A527000
       LDQ     0,2            BHW OF FIRST HANGING BUFFER TO MQ         5A527100
       STD     0,2            DISCONNECT HANGING BUFFER FROM TABLE      5A527200
       CAL     -1,4           C(THW). LAST BUFFER OF TABLE BECOMES      5A527300
       STD     TKAFS          LAST OF SUB-TABLE, AND LAST NON-HANGING   5A527400
       XCL                    BUFFER BECOMES NEW LAST BUFFER OF TABLE   5A527500
       STD     -1,4           IN THW.                                   5A527600
       STZ     2,4            CLEAR TBLFN                               5A527700
       TSX     TKTBA,4        CONNECT SUB TABLE TO NULL STRING          5A527800
       PZE     TKAFS          X                                         5A527900
TKAFX  AXT     **,4           RELOAD REGISTERS                          5A528000
TKAFY  AXT     **,2           X                                         5A528100
       TRA     2,4            RETURN                                    5A528200
       SPACE   3                                                        5A528300
TKAFS  PZE     **,,**         SUB-TABLE THW                             5A528400
       REM                                                              5A528500
       TTL *** GENERAL SYSTEM MACRO DEFINITIONS ***                     5A528600
       SPACE   1                                                        5A528700
       TTL *IBFTC V* *BCI COLLECTOR* *SCAN CONTROL ROUTINES*            5A528800
       REM     BCRF0 - BCI COLLECTOR REFILL ROUTINE.                    5A528900
       REM                                                              5A529000
       REM     ROUTINE LOADS THE NEXT WORD FROM THE F-REGION INTO THE   5A529100
       REM     MQ AND UPDATES THE F-REGION POINTER.                     5A529200
       REM                                                              5A529300
       REM     THE CALLING SEQUENCE IS -                                5A529400
       REM                                                              5A529500
       REM                    TSX  BCRF0,4                              5A529600
       REM                    ...  NORMAL RETURN                        5A529700
       REM                                                              5A529800
       REM     OR BY THE MACRO REFILL.                                  5A529900
       SPACE   2                                                        5A530000
BCRF0  SXA     BCRFX,4       .SAVE LINKAGE.                             5A530100
       LXD     .CRNTP,4       LOAD THE CURRENT F-REGION INDEX.          5A530200
       LDQ     0,4            GET NEXT INPUT WORD.                      5A530300
       TXI     *+1,4,-1       UPDATE INDEX TO NEXT WORD.                5A530400
       SXD     .CRNTP,4       SAVE F-REGION INDEX.                      5A530500
BCRFX  AXT     **,4           RESTORE LINKAGE.                          5A530600
       TRA     1,4           *RETURN TO CALLER.                         5A530700
       SPACE   3                                                        5A530800
       REM     BCSB0 - BCI COLLECTOR SET BASE ROUTINE.                  5A530900
       REM                                                              5A531000
       REM     ROUTINE SETS THE ORIGIN (BASE) OF THE SCAN IN THE        5A531100
       REM     F-REGION.                                                5A531200
       REM                                                              5A531300
       REM     THE CALLING SEQUENCE IS -                                5A531400
       REM                                                              5A531500
       REM                    TSX  BCSB0,4                              5A531600
       REM                    ...  NORMAL RETURN                        5A531700
       REM                                                              5A531800
       REM     OR BY THE MACRO SETBAS.                                  5A531900
       SPACE   2                                                        5A532000
BCSB0  LDQ     .CRNTP        .MAKE BASE THE CURRENT                     5A532100
       STQ     .BASEP         SCAN POSITION IN F-REGION.                5A532200
       LDQ     .INCHR         SAVE THE CURRENT INPUT WORD (IF ANY)      5A532300
       STQ     BCSBW          FOR RESETING SCAN TO BASE.                5A532400
       TRA     1,4           *RETURN TO CALLER.                         5A532500
       REM                                                              5A532600
BCSBW  BSS     1              SAVE OF BASE INPUT WORD.                  5A532700
       SPACE   3                                                        5A532800
       REM     BCRT0 - BCI COLLECTOR RESET TO BASE ROUTINE.             5A532900
       REM                                                              5A533000
       REM     ROUTINE RESETS THE SCAN POSITION TO THE BASE CHARACTER   5A533100
       REM     IN THE F-REGION.                                         5A533200
       REM                                                              5A533300
       REM     THE CALLING SEQUENCE IS -                                5A533400
       REM                                                              5A533500
       REM                    TSX  BCRT0,4                              5A533600
       REM                    ...  NORMAL RETURN                        5A533700
       REM                                                              5A533800
       REM     OR BY THE MACRO RESET.                                   5A533900
       SPACE   2                                                        5A534000
BCRT0  LDQ     .BASEP        .MAKE THE BASE WORD INDEX                  5A534100
       STQ     .CRNTP         THE CURRENT WORD INDEX.                   5A534200
       LDQ     BCSBW          SET CURRENT INPUT WORD WITH               5A534300
       STQ     .INCHR         BASE INPUT WORD (IF ANY).                 5A534400
       TRA     1,4           *RETURN TO CALLER.                         5A534500
       SPACE   3                                                        5A534600
       REM     BCSV0 - BCI COLLECTOR SAVE SCAN ROUTINE.                 5A534700
       REM                                                              5A534800
       REM     ROUTINE SAVES THE CURREN SCAN POSITION AND OUTPUT WORDS. 5A534900
       REM                                                              5A535000
       REM     THE CALLING SEQUENCE IS-                                 5A535100
       REM                                                              5A535200
       REM                    TSX  BCSV0,1                              5A535300
       REM                    ...  NORMAL RETURN                        5A535400
       REM                                                              5A535500
       REM     OR BY THE MACRO SAVSCN.  THE BCI COLLECTOR USES THE ENTRY5A535600
       REM     POINT BCSAV, AND THE CONVERSION ROUTINE USE THE ENTRY    5A535700
       REM     POINT CBSAV.                                             5A535800
       SPACE   2                                                        5A535900
       REM                    ENTRY FOR A STATEMENT PROCESSOR.          5A536000
BCSV0  SXA     BCSVX,1       .SAVE LINKAGE.                             5A536100
       AXT     BCSVA,1        SET ADDRESS OF DATA SAVING BLOCK FOR SP.  5A536200
       TRA     BCSV1         *CONTINUE WITH COMMON ROUTINE.             5A536300
       SPACE   1                                                        5A536400
       REM                    ENTRY FOR THE CONVERSION ROUTINE.         5A536500
CBSAV  SXA     BCSVX,1       .SAVE LINKAGE.                             5A536600
       AXT     BCSVC,1        SET ADDRESS OF DATA SAVING BLOCK FOR CNV. 5A536700
       TRA     BCSV1         *CONTINUE WITH COMMON ROUTINE.             5A536800
       SPACE   1                                                        5A536900
       REM                    ENTRY FOR THE BCI COLLECTOR.              5A537000
BCSAV  SXA     BCSVX,1       .SAVE LINKAGE.                             5A537100
       AXT     BCSVB,1        SET ADDRESS OF DATA SAVING BLOCK FOR BCI. 5A537200
       SPACE   1                                                        5A537300
       REM                    COMMON SAVE ROUTINE.                      5A537400
BCSV1  SXA     BCSV2,1       .INITIALIZE ADDRESS OF MOVING LOOP.        5A537500
       SLW     .CONAC         SAVE CONTENTS OF LOGICAL AC.              5A537600
       AXT     10,1           INITIALIZE WORD COUNT.                    5A537700
       CAL     .OUTCH+3,1     MOVE A WORD FROM THE CONTROL BLOCK        5A537800
BCSV2  SLW     **,1           TO THE SAVE BLOCK.                        5A537900
       TIX     *-2,1,1       *ALL MOVED, NO CONTINUE.                   5A538000
       CAL     .CONAC         RESTORE CONTENTS OF AC.                   5A538100
BCSVX  AXT     **,1           YES, RESTORE LINKAGE.                     5A538200
       TRA     1,1           *RETURN-TO CALLER.                         5A538300
       SPACE   1                                                        5A538400
       REM                    DATA BLOCKS FOR SAVES.                    5A538500
       REM                                                              5A538600
       BSS     10             STATEMENT PROCESSOR BLOCK.                5A538700
BCSVA  NULL                   REFERENCE POINT.                          5A538800
       REM                                                              5A538900
       BSS     10             BCI COLLECTOR BLOCK.                      5A539000
BCSVB  NULL                   REFERENCE POINT.                          5A539100
       REM                                                              5A539200
       BSS     10             CONVERSION BLOCK.                         5A539300
BCSVC  NULL                   REFERENCE POINT.                          5A539400
       SPACE   3                                                        5A539500
       REM     BCRS0 - BCI COLLECTOR RESTOR SCAN ROUTINE.               5A539600
       REM                                                              5A539700
       REM     ROUTINE RESTORES THE SCAN TO THE CONDITION OF THE LAST   5A539800
       REM     SAVE.                                                    5A539900
       REM                                                              5A540000
       REM     THE CALLING SEQUENCE IS-                                 5A540100
       REM                                                              5A540200
       REM                    TSX BCRS0,1                               5A540300
       REM                    ...  NORMAL RETURN                        5A540400
       REM                                                              5A540500
       REM     OR BY THE MACRO RESTOR.  THE BCI COLLECTOR USES THE ENTRY5A540600
       REM     POINT BCRST, AND THE CONVERSION ROUTINE USES THE ENTRY   5A540700
       REM     POINT CBRST.                                             5A540800
       SPACE   2                                                        5A540900
       REM                    ENTRY FOR A STATEMENT PROCESSOR.          5A541000
BCRS0  SXA     BCRSX,1       .SAVE LINKAGE.                             5A541100
       AXT     BCSVA,1        SET ADDRESS OF SAVE BLOCK FOR PICKING UP. 5A541200
       TRA     BCRS1         *CONTINUE WITH COMMON ROUTINE.             5A541300
       SPACE   1                                                        5A541400
       REM                    ENTRY FOR THE CONVERSION ROUTINE.         5A541500
CBRST  SXA     BCRSX,1       .SAVE LINKAGE.                             5A541600
       AXT     BCSVC,1        SET ADDRESS OF SAVE BLOCK FOR PICKING UP. 5A541700
       TRA     BCRS1         *CONTINUE WITH COMMON ROUTINE              5A541800
       SPACE   1                                                        5A541900
       REM                    ENTRY FOR THE BCI COLLECTOR.              5A542000
BCRST  SXA     BCRSX,1       .SAVE LINKAGE.                             5A542100
       AXT     BCSVB,1        SET ADDRESS OF SAVE BLOCK FOR PICKING UP. 5A542200
       SPACE   1                                                        5A542300
       REM                    COMMON RESTORE ROUTINE.                   5A542400
BCRS1  SXA     BCRS2,1       .INITIALIZE ADDRESS OF MOVING LOOP.        5A542500
       AXT     10,1           INITIALIZE WORD COUNT.                    5A542600
BCRS2  CAL     **,1           MOVE A WORD FROM THE SZVE BLOCK           5A542700
       SLW     .OUTCH+3,1     TO THE CONTROL BLOCK.                     5A542800
       TIX     BCRS2,1,1     *ALL MOVED, NO CONTINUE.                   5A542900
       CAL     .CONAC         YES, RESTORE LOGICAL AC.                  5A543000
BCRSX  AXT     **,1          *RESTORE LINKAGE.                          5A543100
       TRA     1,1           *RETURN TO CALLER.                         5A543200
       TTL *IBFTC V* *BCI COLLECTOR* *ILLEGAL CHARACTER SECTION*        5A543300
       REM                    GENERAL DIAGNOSTIC MESSAGE FOR BCI.       5A543400
       SPACE   1                                                        5A543500
BCZ00  SXA     BCZXT,4       .SAVE IR4.                                 5A543600
       STQ     .INCHR         SAVE INPUT CHARACTERS.                    5A543700
       STD     BCZWD          SAVE CHARACTER FOR MESSAGE.               5A543800
       DIAGN   BCZLT,2,BCZEN $CALL DIAGNOSTIC.                          5A543900
       LDQ     .INCHR         RESTORE INPUT CHARACTERS                  5A544000
       ZAC                    CLEAR AC.                                 5A544100
BCZXT  AXT     **,4           RESTORE IR4.                              5A544200
       TRA     1,1           *RETURN TO CALLER.                         5A544300
       SPACE   1                                                        5A544400
BCZLT  MZE     BCZWD,,1       MESSAGE INSERT LIST.                      5A544500
BCZWD  BCI     1,             ILLEGAL CHARACTER.                        5A544600
       SPACE   3                                                        5A544700
       TTL *IBFTC V* *BCI COLLECTOR* *COMMON LOAD SEQUENCE*             5A544800
       REM     BCSLD - COMMON ROUTINE TO SAVE LINKAGE AND               5A544900
       REM             INITIALIZE THE BCI COLLECTOR.                    5A545000
       REM                                                              5A545100
       REM     CALLING SEQUENCE IS -                                    5A545200
       REM                                                              5A545300
       REM                    TSX  BCSLD,1                              5A545400
       REM                    ...  NORMAL RETURN                        5A545500
       REM                                                              5A545600
       REM     OR TO BCSLH TO AVOID CLEARING THE OUTPUT AREA.           5A545700
       SPACE   3                                                        5A545800
BCSLD  STZ     .OUTFG        .CLEAR                                     5A545900
       STZ     .OUTCH         OUTPUT                                    5A546000
BCSLQ  STZ     .OUTCH+1       CELLS.                                    5A546100
BCSLH  SXA     BCXAT+1,2     .SAVE LINKAGE.                             5A546200
       SXA     BCXAT+2,4                                                5A546300
       ZAC                    INITIALIZE AC FOR A CAQ AND               5A546400
       PAI                    THE OUTPUT BUILDING AREA (SI).            5A546500
       LXA     .CRNTP,4       LOAD COUNT OF CHARACTERS IN .INCHR.       5A546600
       LDQ     .INCHR         LOAD INPUT CHARACTERS (IF ANY).           5A546700
       TRA     1,1           *RETURN TO CALLER.                         5A546800
       TTL *IBFTC V* *BCI COLLECTOR* *COMMON EXIT*                      5A546900
       REM                    COMMON RETURN FROM BCI COLLECTOR.         5A547000
       SPACE   1                                                        5A547100
       REM                    EXIT TO SAVE INPUT DATA.                  5A547200
BCXET  SXA     .CRNTP,4      .SAVE INTPUT CHARACTER COUNT AND           5A547300
       STQ     .INCHR         ANY REMAINING INPUT CHARACTERS.           5A547400
       REM                   .EXIT TO JUST RESTORE LINKAGE.             5A547500
BCXAT  AXT     **,1           RESTORE LINKAGE.                          5A547600
       AXT     **,2           X                                         5A547700
       AXT     **,4           X                                         5A547800
       REM                    THE FOLLOWING INSTRUCTION IS INITIALIZED  5A547900
       REM                    TO RETURN TO 1,4 OR 2,4 OR 3,4.           5A548000
BCXIT  TRA     **,4          *RETURN TO CALLER.                         5A548100
       TTL *IBFTC V* *BCI COLLECTOR* *GETBCI SECTION*                   5A548200
       REM     BCI00 - BCI COLLECTOR GETBCI ROUTINE                     5A548300
       REM                                                              5A548400
       REM     ROUTINE COLLECTS A SYMBOL, CONSTANT AND/OR PUNCTUATION   5A548500
       REM     FROM THE INPUT STRING.  THE OUTPUT IS PLACED IN THE      5A548600
       REM     STANDARD OUTPUT AREA (.OUTCH, .OUTFG AND .DLMTR).        5A548700
       REM                                                              5A548800
       REM     THE CALLING SEQUENCE IS-                                 5A548900
       REM                                                              5A549000
       REM                    TSX  BCI00,4                              5A549100
       REM                    TRA  ...       NUMERIC RETURN             5A549200
       REM                    TRA  ...       ALPHABETIC RETURN          5A549300
       REM                    TRA  ...       DELIMITER RETURN           5A549400
       REM                                                              5A549500
       REM     OR BY THE MACRO GETBCI.  ILLEGAL CHARACTERS ARE TREATED  5A549600
       REM     AS BLANKS.                                               5A549700
       SPACE   2                                                        5A549800
BCI00  SXA     BCXAT,1       .SAVE LINKAGE.                             5A549900
       SXA     BCXAT+1,2                                                5A550000
       SXA     BCXAT+2,4                                                5A550100
       STZ     .OUTCH         CLEAR                                     5A550200
       STZ     .OUTCH+1       THE OUTPUT                                5A550300
       STZ     .OUTFG         AREA.                                     5A550400
       AXT     6,2            INITILIZE OUTPUT COUNT.                   5A550500
       LXA     .CRNTP,4       LOAD INPUT CHARACTER COUNT.               5A550600
       ZAC                    PREPARE AC FOR SCANNING.                  5A550700
       PAI                    INITIALIZE OUTPUT WORD.                   5A550800
       LDQ     .INCHR         LOAD INPUT CHARACTERS (IF ANY).           5A550900
       ZET     .CDATA         IS THIS A DATA STATEMENT LIST.            5A551000
       TRA     CBDTA         *YES, GO TO CONVERSION ROUTINE.            5A551100
       TXH     BCI20,4,0     *ANY CHARACTERS LEFT, YES.                 5A551200
       REM                    ENTRY TO GET ANOTHER INPUT WORD.          5A551300
BCI10  REFILL                .GET ANOTHER WORD OF INPUT.                5A551400
       REM                    ENTRY TO GET ANOTHER CHARACTER.           5A551500
BCI20  CAQ     .BCCTB,1,1     INTERROGATE A CHARACTER.                  5A551600
       TRA     BCI30,1        BRANCH ON CHARACTER TYPE.                 5A551700
       TRA     BCI50        **ILLEGAL                                   5A551800
       TXI     BCD20,1,-3    *ENDMARK                                   5A551900
       TXI     BCD00,1,-2    *=,/()                                     5A552000
       TXI     BCD10,1,-1    *+-*.$'                                    5A552100
       TXI     BCA00,1,-1    *H OR X                                    5A552200
       TRA     BCA00         *ALPHABETIC                                5A552300
       TRA     BCN00         *NUMERIC                                   5A552400
BCI30  TIX     BCI20,4,1    .*BLANK. ANY CHARACTERS IN INPUT WORD, YES. 5A552500
       TRA     BCI10         *NO, GET ANOTHER WORD.                     5A552600
       SPACE   1                                                        5A552700
BCI50  TSX     BCZ00,1       .ILLEGAL CHARACTER, GIVE MESSAGE.          5A552800
       TRA     BCI30         *TREAT AS BLANK.                           5A552900
       EJECT                                                            5A553000
       REM                    COLLECT A SYMBOL, TYPE IT, AND PLACE      5A553100
       REM                    OUTPUT IN NORMAL CELLS.                   5A553200
       SPACE   2                                                        5A553300
BCA00  SXA     BCXIT,1       .SET EXIT FOR ALPHABETIC RETURN.           5A553400
       REM                    ENTRY FROM MOREA.                         5A553500
BCA04  ARS     12            .SHIFT FIRST CHARACTER TO DECREMENT.       5A553600
       REM                    ENTRY FROM MOREAD.                        5A553700
BCA08  PDX     ,1            .LOAD CHARACTER FOR TYPING.                5A553800
       TXL     *+4,1,H       *IS IT A THROUGH G, YES REAL.              5A553900
       TXH     *+3,1,N       *IS IT O THROUGH Z, YES REAL.              5A554000
       AXT     .NINTG,1       CHARACTER IS I THROUGH N.                 5A554100
       TRA     *+2            TYPE SYMBOL AS INTEGER.                   5A554200
       AXT     .NREAL,1       A-G OR O-Z, TYPE AS REAL.                 5A554300
       SXD     .OUTFG,1       SET IMPLICIT TYPE IN OUTPUT CELL.         5A554400
       ALS     12             MOVE CHARACTER BACK TO HIGH ORDER AC.     5A554500
       NZT     CBFSW          IS THIS A FORMAT STATEMENT.               5A554600
       TRA     BCA30         *NO, CONTINUE BELOW COLLECTING A SYMBOL.   5A554700
       SPACE   2                                                        5A554800
       REM                    FORMAT STATEMENT, COLLECT JUST ONE CHAR.  5A554900
       SLW     .OUTCH         SAVE CHARACTER WITHOU TRAILING BLANKS.    5A555000
       STZ     .DLMTR         CLEAR DELIMITER CELL.                     5A555100
       TXI     BCXET,4,-1    *UPDATE CHARACTER COUNT AND EXIT.          5A555200
       SPACE   3                                                        5A555300
       REM                    LOOP RE-ENTRY FOR SECOND CHARACTER ON.    5A555400
BCA10  TIX     BCA20,2,1    .*IS THE OUTPUT WORD FULL, NO.              5A555500
       REM                    SIX CHARACTERS COLLECTED, STUFF IT AWAY.  5A555600
       AXT     3,1            SCAN THE OUTPUT AREA FOR AN AVAIL. WORD.  5A555700
       NZT     .OUTCH+3,1     IS THIS WORD AVAILABLE.                   5A555800
       TRA     BCA15         *YES, USE IT.                              5A555900
       TIX     *-2,1,1       *NO. ANY WORDS LEFT IN OUTCH, YES.         5A556000
       TRA     *+2            NO. THROW EXCESS CHARACTERS AWAY.         5A556100
BCA15  STI     .OUTCH+3,1     STORE OUTPUT WORD.                        5A556200
       AXT     6,2            SET FOR ANOTHER SIX CHARACTERS OF OUTPUT. 5A556300
       LDI     .CZERO         RESET OUTPUT WORD.                        5A556400
       REM                    NORMAL PLACE TO GO FROM BCA10.            5A556500
BCA20  XEC     BCSFT,2        POSITION CHARACTER FOR PACKING.           5A556600
       REM                    ENTRY FOR FIRST CHARACTER AFTER TYPING.   5A556700
BCA30  OAI                   .PACK CHARACTER INTO OUTPUT WORD.          5A556800
       TIX     BCA50,4,1     *ANY INPUT CHARACTERS LEFT, YES.           5A556900
       REM                    ENTRY FROM MOREA AND LOOP RE-ENTRY        5A557000
       REM                    TO GET ANOTHER INPUT WORD.                5A557100
BCA40  REFILL                .GET ANOTHER WORD OF INPUT.                5A557200
       REM                    ENTRY FROM MOREA AND LOOP RE-ENTRY        5A557300
       REM                    TO SCAN NEXT CHARACTER.                   5A557400
BCA50  ZAC                    CLEAR AC FOR SCAN.                        5A557500
       REM                    RE-ENTRY FOR BLANK.                       5A557600
BCA60  CAQ     .BCCTB,1,1    .INTERROGATE NEXT CHARACTER.               5A557700
       TRA     BCA70,1        BRANCH ON CHARACTER TYPE.                 5A557800
       TRA     BCAI0         *ILLEGAL.                                  5A557900
       TXI     BCAD0,2,-1    *ENDMARK, STOP SCAN, UPDATE OUTPUT COUNT.  5A558000
       TXI     BCAD0,2,-1    *DELIMITER, STOP SCAN, UPDATE OUTPUT COUNT.5A558100
       TXI     BCAD0,2,-1    *DELIMITER, STOP SCAN, UPDATE OUTPUT COUNT.5A558200
       TRA     BCA10          ALPHABETIC, CONTINUE BUILDING SYMBOL.     5A558300
       TRA     BCA10          SAME.                                     5A558400
       TRA     BCA10          NUMERIC, CONTINUE BUILDING SYMBOL.        5A558500
BCA70  TIX     BCA60,4,1     *BLANK. ANY INPUT CHARACTERS LEFT, YES.    5A558600
       TRA     BCA40         *NO, GET MORE.                             5A558700
       SPACE   2                                                        5A558800
       REM                    ILLEGAL CHARACTER.                        5A558900
BCAI0  TSX     BCZ00,1       $USE GENERAL ILLEGAL CHARACTER ROUTINE.    5A559000
       TRA     BCA70         *TREAT AS A BLANK.                         5A559100
       SPACE   3                                                        5A559200
       REM                    DELIMITER ENCOUNTERED COLLECTING SYMBOL.  5A559300
       SPACE   1                                                        5A559400
BCAD0  STD     .DLMTR        .SET DELIMITER IN OUTPUT WORD.             5A559500
       ZET     .OUTCH         ARE THERE MORE THAN SIX CHARACTERS.       5A559600
       TXI     BCAD1,4,-1    *YES, UPDATE INPUT CHARACTER COUNT.        5A559700
       SPACE   1                                                        5A559800
       REM                    SYMBOL HAS SIX CHARACTERS OR LESS.        5A559900
       CAL     .C6ADD,2       SET OUTPUT CHARACTER COUNT                5A560000
       STA     .OUTFG         IN OUTPUT WORD.                           5A560100
       OSI     .CBLK0,2       FILL OUT SYMBOL WITH BLANKS.              5A560200
       STI     .OUTCH         SET SYMBOL IN OUTPUT WORD.                5A560300
       TXI     BCXET,4,-1    *UPDATE INPUT CHARACTER COUNT AND EXIT     5A560400
       SPACE   1                                                        5A560500
       REM                    SYMBOL HAS MORE THAN SIX CHARACTERS.      5A560600
BCAD1  STQ     .INCHR         SAVE INPUT CHARACTERS AND                 5A560700
       SXA     .CRNTP,4       CHARACTER COUNT.                          5A560800
       DIAGN   BCAZL,2,BCAZE $GIVE A MESSAGE.                           5A560900
       STZ     .OUTCH+2       CLEAR GARBAGE FROM OUTCH.                 5A561000
       CAL     .C6ADD         SET AN OUTPUT CHARACTER                   5A561100
       STA     .OUTFG         COUNT OF SIX IN OUTPUT WORD.              5A561200
       TRA     BCXAT         *EXIT.                                     5A561300
       SPACE   1                                                        5A561400
       REM                    DIAGNOSTIC FOR EXCESSIVE CHARACTERS.      5A561500
       SPACE   1                                                        5A561600
BCAZL  MZE     .OUTCH,,1      INSERT FOR MESSAGE.                       5A561700
       EJECT                                                            5A561800
       REM                    DELIMITER ENCOUNTERED AS FIRST CHARACTER. 5A561900
       REM                    CHECK FOR A COMPLEX CONSTANT OR DECIMAL   5A562000
       REM                    POINT CONSTANT.                           5A562100
       SPACE   2                                                        5A562200
       REM                    ENTRY FOR =,/) OR (                       5A562300
       SPACE   1                                                        5A562400
BCD00  NZT     .BCPLX       /.IS A COMPLEX NUMBER POSSIBLE.             5A562500
       TRA     BCD20         *NO, DO NOT LOOK FOR ONE.                  5A562600
       PDX     ,2             YES, LOAD DELIMITER.                      5A562700
       TXL     BCD20,2,.CSLSH CONTINUE BELOW IF                         5A562800
       TXH     BCD20,2,.CLPRN NOT A LEFT PARENTHESIS.                   5A562900
       TXI     BCDT0,4,-1    *LEFT PAREN. UPDATE INPUT COUNT AND TEST.  5A563000
       SPACE   1                                                        5A563100
       REM                    ENTRY FOR +-*$' OR .                      5A563200
       SPACE   1                                                        5A563300
BCD10  PDX     ,2            .LOAD DELIMITER.                           5A563400
       TXL     BCD20,2,.CCOMA CONTINUE BELOW IF                         5A563500
       TXH     BCD20,2,.CPINT NOT A DECIMAL POINT.                      5A563600
       TXI     BCDT0,4,-1    *POINT. UPDATE INPUT COUNT AND TEST.       5A563700
       SPACE   1                                                        5A563800
       REM                    ENTRY FOR END MARK OR CLOSE OUT.          5A563900
       SPACE   1                                                        5A564000
BCD20  STD     .DLMTR        .SAVE THE DELIMITER.                       5A564100
       SXA     BCXIT,1        SET THE DELIMITER EXIT OF 3,4.            5A564200
       TXI     BCXET,4,-1    *UPDATE INPUT COUNT AND RETURN TO CALLER.  5A564300
       SPACE   2                                                        5A564400
       REM                    . OR ( ENCOUNTERED, CHECK FURTHER FOR     5A564500
       REM                    A NUMERICAL CONSTANT.                     5A564600
       SPACE   1                                                        5A564700
BCDT0  SXA     BCXIT,1       .SET EXIT FOR POSSIBLE DELIMITER RETURN.   5A564800
       STD     .DLMTR         SAVE DELIMITER.                           5A564900
       SXA     .CRNTP,4       SAVE CURRENT INPUT                        5A565000
BCDPT0 TRA     BCDPT1                                                (1)5A565100
       TSTNXT  BCDT1,BCXAT,BCDT2   CHECK NEXT CHAR. IF NUMERIC, IT IS   5A565200
       REM                    APPARENTLY A CONSTANT. IF ALPHABETIC, IS  5A565300
       REM                    NOT A CONSTANT. IF DELIMITER, IT MAY BE   5A565400
       REM                    A COMPLEX CONSTANT.                       5A565500
       SPACE   1                                                        5A565600
       REM                    APPARENTLY A CONSTANT, GIVE IT A TRY.     5A565700
       SPACE   1                                                        5A565800
BCDT2  TXH     BCXAT,2,.CLPRN  *EXIT IF PREVIOUS DELIMITER WAS POINT.   5A565900
BCDT1  TSX     BCSAV,1       $SAVE THE SCAN IN CASE ATTEMPT FAILS.      5A566000
       LXA     .CRNTP,4       GO TO CON VERSION ROUTINE, IT WILL        5A566100
       LDQ     .INCHR         RESET THINGS IF IT IS A CONSTANT OR       5A566200
       TXL     CB01N,2,.CLPRN TAKE THE PRESET DELIMITER EXIT.           5A566300
       RQL     6              ELIMINATE CHARACTER FROM INPUT STRING.    5A566400
       TXI     CB01N,4,-1    *UPDATE INPUT COUNT DECIMAL CONSTANT       5A566500
       REM                    SINCE CHARACTER IS IN AC.                 5A566600
       EJECT                                                            5A566700
       REM                    NUMERIC CHARACTER ENCOUNTERED AS FIRST    5A566800
       REM                    CHARACTER. OBVIOUSLY A CONSTANT, CONVERT  5A566900
       REM                    IT TO BINARY.                             5A567000
       SPACE   1                                                        5A567100
BCN00  STZ     .DLMTR        .ELIMINATE ANY GARBAGE IN .DLMTR.          5A567200
       TXI     CB01N,4,-1    *UPDATE INPUT COUNT AND GO TO              5A567300
       REM                    CONVERSION ROUTINE.                       5A567400
       SPACE   2                                                        5A567500
       SPACE   2                                                        5A567600
       REM                    BCI COLLECTOR SHIFT TABLE.                5A567700
       SPACE   1                                                        5A567800
       ANA     .M77PD         1      CHARACTER                          5A567900
       ARS     6               2     POSITION                           5A568000
       ARS     12               3    TABLE                              5A568100
       ARS     18                4   FOR                                5A568200
       ARS     24                 5  ALPHAMERIC                         5A568300
       ARS     30                  6 SYMBOLS.                           5A568400
BCSFT  NULL                                                             5A568500
       TTL *IBFTC V* *BCI COLLECTOR* *MORE ALPHABETIC SECTION*          5A568600
*              PATCH SPACE FOR PHASE A                              (12)5A568700
*              (ROUTINE BCMA0 HAS BEEN REMOVED FROM HERE)           (12)5A568800
       SPACE   2                                                        5A568900
       BSS     7              USED FOR PATCH IN ASSEMBLY E.         (13)5A570100
       BSS     13             USED FOR PATCH IN ASSEMBLY E.         (12)5A570800
       BSS     10             USED FOR PATCH IN ASSEMBLY G.         (13)5A572200
       BSS     4             USED FOR PATCH IN ASSEMBLY G           (16)5A573100
       EJECT                                                        (12)5A574300
       SPACE   3                                                        5A574400
       SPACE   5                                                        5A574500
       REM     BCMD0 - BCI COLLECTOR MORE ALPHABETIC ROUTINE - D        5A574600
       REM                                                              5A574700
       REM     ROUTINE BUILDS A SYMBOL STARTING WITH THE CHARACTER IN   5A574800
       REM     THE .DLMTR CELL. THE OUTPUT IS OF THE SAME FORMAT AS     5A574900
       REM     A CALL TO GETBCI.                                        5A575000
       REM                                                              5A575100
       REM     THE CALLING SEQUENCE IS -                                5A575200
       REM                                                              5A575300
       REM                    TSX  BCMD0,4                              5A575400
       REM                    ...  NORMAL RETURN                        5A575500
       REM                                                              5A575600
       REM     OR BY THE MACRO MAREAD.                                  5A575700
       SPACE   3                                                        5A575800
BCMD0  SXA     BCXAT,1       .SAVE LINKAGE AND INITIALIZE ROUTINE       5A575900
       TSX     BCSLD,1       $WITH COMMON ROUTINE.                      5A576000
       AXT     1,1            SET RETURN                                5A576100
       SXA     BCXIT,1        TO 1,4.                                   5A576200
       AXT     6,2            INITIALIZE OUTPUT CHARACTER COUNT.        5A576300
       CAL     .DLMTR         GET FIRST CHARACTER OF SYMBOL.            5A576400
       TXI     BCA08,4,1     *CONTINUE WITH NORMAL ALPHABETIC           5A576500
       REM                    COLLECTOR OF GETBCI.                      5A576600
       REM                    INPUT CHARACTER COUNT IS BUMPED           5A576700
       REM                    TO FAKE THIS AS AN INPUT CHARACTER.       5A576800
       TTL *IBFTC V* *BCI COLLECTOR* *TEST NEXT CHARACTER SECTION*      5A576900
       REM     BCTS0 - BCI COLLECTOR TEST NEXT CHARACTER ROUTINE.       5A577000
       REM                                                              5A577100
       REM     ROUTINE TESTS THE NEXT CHARACTER WITHOUT ADVANCING THE   5A577200
       REM     SCAN AND RETURNS DEPENDING UPON WHETHER THE CHARACTER    5A577300
       REM     IS NUMERIC, ALPHABETIC OR A DELIMITER.                   5A577400
       REM                                                              5A577500
       REM     THE CALLING SEQUENCE IS -                                5A577600
       REM                                                              5A577700
       REM                    TSX  BCTS0,4                              5A577800
       REM                    TRA  ...       NUMERIC RETURN             5A577900
       REM                    TRA  ...       ALPHABETIC RETURN          5A578000
       REM                    TRA  ...       DELIMITER RETURN           5A578100
       REM                                                              5A578200
       REM     OR BY THE MACRO TSTNXT.                                  5A578300
       SPACE   3                                                        5A578400
BCTS0  SXA     BCTSX,1       .SAVE LINKAGE.                             5A578500
       SXA     BCTSX+1,2                                                5A578600
       SXA     BCTSX+2,4                                                5A578700
       LXA     .CRNTP,4       LOAD INPUT CHARACTER COUNT.               5A578800
       LDQ     .INCHR         LOAD INPUT CHARACTERS (IF ANY).           5A578900
       TXH     BCTS2,4,0     *ANY CHARACTERS LEFT, YES.                 5A579000
BCTS1  REFILL                .NO. GET ANOTHER WORD.                     5A579100
       SXA     .CRNTP,4       SAVE THE UPDATED COUNT AND                5A579200
       STQ     .INCHR         INPUT WORD.                               5A579300
BCTS2  ZAC                    CLEAR AC.                                 5A579400
BCTS3  CAQ     .BCCTB,1,1     INTERROGATE CHARACTER.                    5A579500
       TRA     BCTS4,1        BRANCH ON TYPE.                           5A579600
       TXI     BCTS6,4,-1    *ILLEGAL.                                  5A579700
       TXI     BCTS5,1,-3    *DELIMITER, SET EXIT.                      5A579800
       TXI     BCTS5,1,-2    *SAME.                                     5A579900
       TXI     BCTS5,1,-1    *SAME.                                     5A580000
       TXI     BCTS5,1,-1    *ALPHABETIC, SET EXIT.                     5A580100
       TRA     BCTS5         *SAME.                                     5A580200
       TRA     BCTS5         *NUMERIC, SET EXIT.                        5A580300
BCTS4  TIX     BCTS1+2,4,1     BLANKS                                   5A580400
       TRA     BCTS1         *NO. GET ANOTHER INPUT WORD.               5A580500
       REM                    LEGAL, NON-BLANK CHARACTER.               5A580600
BCTS5  SXA     BCTSX+3,1      SET EXIT TO 1,2 OR 3.                     5A580700
       ANA     .MLEFT         CLEAR TRANSFER CODE.                      5A580800
BCTSX  AXT     **,1           RESTORE LINKAGE.                          5A580900
       AXT     **,2                                                     5A581000
       AXT     **,4                                                     5A581100
       TRA     **,4          *RETURN TO CALLER.                         5A581200
       SPACE   2                                                        5A581300
BCTS6  SXA     .CRNTP,4       ELIMINATE CHARACTER FROM STRING.          5A581400
       STQ     .INCHR         RESET INPUT STRING.                       5A581500
       TSX     BCZ00,1       $ILLEGAL CHARACTER, GO TO DIAGNOSTIC.      5A581600
       TRA     BCTS1-1       *LOOK AT NEXT CHARACTER.                   5A581700
       TTL *IBFTC V* *BCI COLLECTOR* *GET N CHARACTERS SECTION*         5A581800
       REM     BCGTW - BCGTN - BCI COLLECTOR GET N CHARACTERS.          5A581900
       REM                                                              5A582000
       REM     ROUTINE COLLECTS N CHARACTERS, WITH OR WITHOUT BLANKS,   5A582100
       REM     BUT STOPS ON THE END MARK.                               5A582200
       REM                                                              5A582300
       REM     THE CALLING SEQUENCE IS -                                5A582400
       REM                                                              5A582500
       REM                    TSX BCGT.,4                               5A582600
       REM                    PZE N                                     5A582700
       REM                    ... NORMAL RETURN.                        5A582800
       REM                                                              5A582900
       REM     WHERE . IS W IF BLANKS ARE TO BE INCLUDED, OR N IF BLANKS5A583000
       REM     ARE TO BE EXCLUDED. THE CORRESPONDING MACROS ARE GETNWB  5A583100
       REM     OR GETNNB, RESPECITVELY.                                 5A583200
       SPACE   3                                                        5A583300
BCGTW  STL     BC.GF         /ENTRY TO INCLUDE BLANKS, SET FLAG.        5A583400
       TRA     *+2            X                                         5A583500
BCGTN  STZ     BC.GF         /ENTRY TO EXCLUDED BLANKS. SET FLAG.       5A583600
       SXA     BCXAT,1        SAVE IR1.                                 5A583700
       CAL     1,4            GET THE CAHRACTER COUNT.                  5A583800
       PAC     ,1             SET THE 2'S COMPLIMENT TO STOP            5A583900
       SXD     BCGT7,1        COLLECTING.                               5A584000
       TSX     BCSLD,1        SAVE REST OF LINKAGE AND LOAD INPUT DATA. 5A584100
       ZSA     BCGT6          CLEAR OUTPUT CHARACTER COUNT.             5A584200
       AXT     6,2            INITIALIZE OUTPUT PACKING COUNT.          5A584300
       AXT     2,1            SET RETURN TO 2,4.                        5A584400
       SXA     BCXIT,1        X                                         5A584500
       STZ     .DLMTR         CLEAR DELIMITER CELL.                     5A584600
       TXH     BCGT1,4,0     *ANY INPUT CHARACTERS LEFT, YES.           5A584700
BCGT0  REFILL                 NO, GET ANOTHER WORD.                     5A584800
BCGT1  CAQ     .BCCTB,1,1     INTERROGATE A CHARACTER.                  5A584900
       TRA     BCGT2,1        BRANCH ON TYPE.                           5A585000
       TRA     BCGTI         *ILLEGAL.                                  5A585100
       TRA     BCGT9         *END MARK, STOP SCAN.                      5A585200
       TRA     BCGT4         *DELIMITER, REPLACE WITH BCI CODE.         5A585300
       TRA     BCGT4         *SAME.                                     5A585400
       TRA     BCGT5         *ALPHABETIC.                               5A585500
       TRA     BCGT5         *SAME.                                     5A585600
       TRA     BCGT5         *NUMERIC.                                  5A585700
BCGT2  ZET     BC.GF         /BLANK. ARE BLANKS TO BE INCLUDED.         5A585800
       TRA     BCGT3         *YES.                                      5A585900
       TIX     BCGT1,4,1     *NO. ANY CHARACTERS LEFT, YES.             5A586000
       TRA     BCGT0         *NO. GET ANOTHER WORD OF INPUT.            5A586100
       SPACE   1                                                        5A586200
       REM                    ILLEGAL CHARACTER, IGNORE IT.             5A586300
       SPACE   1                                                        5A586400
BCGTI  TSX     BCZ00,1       $USE COMMON DIAGNOSTIC.                    5A586500
       REM                    TREAT AS A BLANK.                         5A586600
       SPACE   1                                                        5A586700
       REM                    BLANKS ARE VALID CHARACTERS.              5A586800
       SPACE   1                                                        5A586900
BCGT3  CAL     .C6PFX        .PICK UP A BLANK IN THE PREFIX.            5A587000
       TRA     BCGT5         *INSERT IT INTO OUTPUT STRING.             5A587100
       SPACE   1                                                        5A587200
       REM                    DELIMITER, CONVERT TO BCI CODE.           5A587300
       SPACE   1                                                        5A587400
BCGT4  PDX     ,1            .LOAD THE INTERNAL DELIMITER CODE.         5A587500
       CAL     .DDLMT,1       GET THE BCI EQUIVALENT.                   5A587600
       SPACE   1                                                        5A587700
       REM                    BUILD THE OUTPUT STRING.                  5A587800
       SPACE   1                                                        5A587900
BCGT5  XEC     BCSFT,2       .POSITION CHARACTER FOR PACKING.           5A588000
       OAI                    PACK IT AWAY.                             5A588100
BCGT6  AXT     **,1           LOAD OUTPUT CHARACTER COUNT.              5A588200
       TXI     *+1,1,-1       DECREMENT IT AND                          5A588300
       SXA     BCGT6,1        SAVE ADJUSTED COUNT.                      5A588400
       REM                    FOLLOWING INSTR. INIT. WITH REQST. COUNT. 5A588500
BCGT7  TXH     *+2,1,**      *HAVE N CHARACTERS BEEN COLLECTED, NO.     5A588600
       TXI     BCGTO,2,-1    *YES ADJUST OUTPUT COUNT AND GET OUT.      5A588700
       TIX     BCGT8,2,1     *ADJUST OUTPUT COUNT AND TR IF LESS THAN 6.5A588800
       ZET     .OUTCH         FULL WORD, IS IT FIRST GROUP.             5A588900
       TXI     BCGTO,2,-1    *NO, ADUST OUTPUT COUNT AND QUIT.          5A589000
       STI     .OUTCH         FIRST GROUP OF SIX, SAVE THEM.            5A589100
       AXT     6,2            RE-INITIALIZE OUTPUT COUNT AND            5A589200
       LDI     .CZERO         OUTPUT WORD                               5A589300
       REM                    CONTINUE COLLECTING CHARACTERS.           5A589400
BCGT8  ZAC                   .CLEAR AC.                                 5A589500
       TIX     BCGT1,4,1     *ANY INPUT CHARACTERS LEFT, YES.           5A589600
       TRA     BCGT0         *NO, GET ANOTHER WORD OF INPUT.            5A589700
       SPACE   1                                                        5A589800
       REM                    END MARK ENCOUNTERED.                     5A589900
       SPACE   1                                                        5A590000
BCGT9  STD     .DLMTR        .SAVE ENDMARK.                             5A590100
       SPACE   1                                                        5A590200
       REM                    N CHARACTERS COLLECTED.                   5A590300
       SPACE   1                                                        5A590400
BCGTO  OSI     .CBLK0,2      .FILL OUT WORD WITH BLANKS.                5A590500
       LAC     BCGT6,1        LOAD COUNT OF CHARACTERS COLLECTED.       5A590600
       TXL     *+3,1,6       *IS GREATER THAN SIX, NO.                  5A590700
       STI     .OUTCH+1       YES, SAVE SECOND GROUP.                   5A590800
       TRA     *+2            CONTINUE BELOW.                           5A590900
       STI     .OUTCH         SAVE FIRST GROUP.                         5A591000
       SXA     .OUTFG,1       SET COUNT OF CHARACTERS COLLECTED.        5A591100
       TXI     BCXET,4,-1    *UPDATE INPUT COUNT AND RETURN TO CALLER.  5A591200
       SPACE   2                                                        5A591300
BC.GF  PZE     **             ZERO - SKIP BLANKS                        5A591400
       REM                    NON-ZERO - INCLUDE BLANKS                 5A591500
       TTL *IBFTC V* *BCI COLLECTOR* *CAQ TABLE*                        5A591600
       REM                    BCI COLLECTOR TABLE TRANSFER CODES.       5A591700
       SPACE   2                                                        5A591800
BCBLK  EQU     0              BLANK                                     5A591900
BCNUM  EQU     1              NUMERIC                                   5A592000
BCALP  EQU     2              ALPHABETIC (EXCEPT H AND X)               5A592100
BCSAP  EQU     3              H AND X                                   5A592200
BCPUN  EQU     4              +-*.$'                                    5A592300
BCSPN  EQU     5              =,/()                                     5A592400
BCEMK  EQU     6              END MARK                                  5A592500
BCILL  EQU     7              ILLEGAL CHARACTER                         5A592600
       SPACE   3                                                        5A592700
       REM                                                              5A592800
       TTL         ** CONVERT ROUTINE **                                5A592900
       TTL         ** CONVERT ROUTINE **                                5A593000
       REM       -CB01N-SCANS THE LITTERAL - CONVERTS IT - SETS         5A593100
       REM       -THE OUTPUT REGION .OUTCH,.OUTCH+1,.OUTFG,.DLMTR.      5A593200
       SPACE   2                                                        5A593300
CB01N  TSX     CBRES,1        RESET THE CONVERT ROUTINE.                5A593400
       LXD     .DLMTR,1                                                 5A593500
       TXL     CB04N,1,0           AC HAS NUMBERICAL CHAR.CONVERT IT.   5A593600
       TXH     *+2,1,.CPINT                                             5A593700
       TXH     CB02N,1,.CPINT-1    DLMT = DCP -AC HAS NUMBERIC          5A593800
       TXH     *+2,1,.CLPRN                                             5A593900
       TXH     CB400,1,.CLPRN-1                                         5A594000
       TSX     DIAG,4          UNEXPECTED ENTRY IN THE CONVERT ROUT.    5A594100
       MZE     0,5,CB06D                                                5A594200
       SPACE   2                                                        5A594300
       REM                                                              5A594400
CB02N  SIB     CBPSW          / SET DECIMAL POINT SWITCH ON.            5A594500
CB05N  BNT     CBPSW                                                    5A594600
       TRA     CB04N                                                    5A594700
       LXA     CBRDG,1        INCREASE NUMBER OF DIGIT AT THE RIGHT     5A594800
       TXI     *+1,1,1        OF DCP BY ONE.                            5A594900
       SXA     CBRDG,1                                                  5A595000
       REM                                                              5A595100
       REM                                                              5A595200
CB04N  TSX     CO00N,2        CONVERT.                                  5A595300
       REM                                                              5A595400
CB10N  TXH     CB01M,4,0      SCAN NEXT CHARACTER.                      5A595500
       REFILL                 X                                         5A595600
CB01M  ZAC                    X                                         5A595700
       CAQ     .BCCTB,1,1     X                                         5A595800
       TRA     CB02M,1        X                                         5A595900
       TXI     CB03M,4,-1     * ILLEGAL.                                5A596000
       TXI     CB45M,4,-1     * ENDM.                                   5A596100
       TXI     CB06M,4,-1     * = , /  (  )                             5A596200
       TXI     CB06M,4,-1     * + - *  .  '                             5A596300
       TXI     CB07M,4,-1     * H X                                     5A596400
       TXI     CB08M,4,-1     * ALPHA.                                  5A596500
       TXI     CB05N,4,-1     * NUMERIC                                 5A596600
CB02M  TXI     CB10N,4,-1     * BLANK                                   5A596700
       REM                                                              5A596800
       REM                                                              5A596900
CB03M  TSX     BCZ00,1         ILLEGAL  CHAR. GIVE A MESSAGE.           5A597000
       TRA     CB10N          *X                                        5A597100
       REM                                                              5A597200
CB06M  NZT     CBFSW          IS INTEGER CONVERSION WANTED.             5A597300
       BFT     .NINTG         X                                         5A597400
       TRA     CB11N          YES                                       5A597500
CB06N  PDX     ,1                                                       5A597600
       TXH     CB09M,1,.CPINT                                           5A597700
       TXL     CB09M,1,.CPINT-1  IT IS A DCP.                           5A597800
       BFT     CBPSW             IS IT THE FIRST.                       5A597900
       TRA     CB45M          NO,                                       5A598000
       SXD     CBDLM,1        YES,SAVE IT.                              5A598100
       TSX     CBSAA,2        AND SAVE SCAN.                            5A598200
       TSTNXT  CB13M,CB16M,CB15M                                        5A598300
CB13M  LXA     .CRNTP,4      NXT CHAR IS NUM.                           5A598400
       TXI     CB02N,4,-1                                               5A598500
CB16M  ARS     12             CHECK FOR  .E OR .D                       5A598600
       LXA     .CRNTP,4       ADVANCE SCAN AND TEST IF IT IS            5A598700
       SIB     CBPPW          AN EXPONENT FIELD.                        5A598800
       TXI     CB50M,4,-1     X                                         5A598900
       REM                                                              5A599000
CB15M  LXA     .CRNTP,4       ADVANCE SCAN                              5A599100
       TXI     *+1,4,-1       AND GO TO FLOATING ROUTINE                5A599200
       SIB     CBPSW          IF NEEDED                                 5A599300
CB09M  BNT     CBCSW          X                                         5A599400
       TRA     CB11N          X                                         5A599500
       PDX     ,1             FOR COMPLEX -CHECK THE LEGALITY OF THIS   5A599600
       TXH     CB15N,1,.CCOMA DLMT.                                     5A599700
       TXH     CB21M,1,.CCOMA-1                                         5A599800
       TXH     CB15N,1,.CRPRN                                           5A599900
       TXL     CB15N,1,.CRPRN-1                                         5A600000
CB22M  BFT     CBPPW+CBPSW    IS THERE A DCP                            5A600100
       BNT     CBCMW          AND A COMMA BEFORE THE )                  5A600200
       TRA     CB15N          NO                                        5A600300
       SIB     CB2CP          YES                                       5A600400
       REM                                                              5A600500
       REM       PICK-UP DLMT AFTER RIGHT PARENT.                       5A600600
       REM                                                              5A600700
CB26M  STQ     .INCHR                                                   5A600800
       SXA     .CRNTP,4                                                 5A600900
CB24M  TSTNXT  CBB0N,CBB03,CBB01                                        5A601000
CBB03  ARS     12             ADVANCE SCAN                              5A601100
CBB01  LXA     .CRNTP,4       AND FLOAT 2ND PART.                       5A601200
       TXI     CB11N,4,-1     X                                         5A601300
CBB0N  LDQ     .INCHR                                                   5A601400
       LXA     .CRNTP,4       NUMERIC CANNOT BE DLMT. SET .DLMTR TO 0   5A601500
       STZ     .DLMTR                                                   5A601600
       TRA     CB11N+1       AND DO NOT ADVANCE SCAN                    5A601700
       REM                                                              5A601800
CB21M  BFT     CBPSW+CBPPW    IS IT THE FIRST COMMA,AND IS THERE A DCP  5A601900
       BFT     CBCMW                                                    5A602000
       TRA     CB15N          NO                                        5A602100
       TRA     CB11N+1        FLOAT.                                    5A602200
       REM                                                              5A602300
CB08M  ARS     12                                                       5A602400
       NZT     CBFSW          IS INTEGER CONVERSION WANTED              5A602500
       BFT     .NINTG         X                                         5A602600
       TRA     CB11N          YES                                       5A602700
       BNT     CBPSW          IS THERE A DCP.                           5A602800
       TRA     CB45M          NO                                        5A602900
       REM                    YES,                                      5A603000
       REM       CHECK FOR EXPONENT FIELD.                              5A603100
       REM                                                              5A603200
       STD     CBDLM          SAVE SCAN                                 5A603300
       TSX     CBSAA,2        IN CASE OF FAILURE.                       5A603400
CB50M  PDX     ,1                                                       5A603500
       TXH     CB14H,1,E                                                5A603600
       TXH     CB52M,1,E-1    IT IS E                                   5A603700
       TXL     CB14H,1,D-1                                              5A603800
CB44M  BFT     CBCSW          IT IS D                                   5A603900
       TRA     CB15N          D IS ILLEGAL IN A COMPLEX LITTERAL        5A604000
       SIB     CBDSW                                                    5A604100
       TRA     CB33U                                                    5A604200
CB52M  SIB     CBESW                                                    5A604300
       REM                                                              5A604400
       REM       COLLECT EXPONENT FIELD                                 5A604500
       REM                                                              5A604600
CB33U  AXT     0,2            XR2 HAS NUMBER OF DIGIT                   5A604700
CB33N  TXH     CB33V,4,0                                                5A604800
       REFILL                                                           5A604900
CB33V  ZAC                                                              5A605000
       CAQ     .BCCTB,1,1                                               5A605100
       TXL     CB32W,1,0                                                5A605200
       TXL     CB31N,1,1                                                5A605300
       TXL     CB30H,1,3                                                5A605400
       TXL     CB30M,1,6                                                5A605500
       TSX     BCZ00,1                                                  5A605600
CB32W  TXI     CB33N,4,-1                                               5A605700
CB31N  SIB     CBFLI                                                    5A605800
       TXI     CB29M,4,-1                                               5A605900
       REM                                                              5A606000
CB30H  ARS     12                                                       5A606100
CB30M  BFT     CBFLI            NUMERIC HAS OCCURED                     5A606200
       TXI     CB33M,4,-1      YES -END OF EXPONENT                     5A606300
       BFT     CBSEX           NO,IS IT THE FIRST SIGN                  5A606400
       TRA     CB14H           NO -RESET SCAN                           5A606500
       PDX     ,1                                                       5A606600
       TXH     CB14H,1,.CMINS    IT IS NOT A SIGN -RESET                5A606700
       TXL     CB32M,1,.CMINS-1  IT IS PLUS                             5A606800
       SIB     CBECN             IT IS MINUS                            5A606900
CB32M  SIB     CBSEX                                                    5A607000
       TXI     CB33N,4,-1                                               5A607100
       REM                                                              5A607200
       REM                                                              5A607300
CB29M  ARS     30                                                       5A607400
       TNZ     *+2           UNCREASE NUMBER OF DIGIT                   5A607500
       ZET     CON3N         OF EXPONENT                                5A607600
       TXI     *+1,2,1       X                                          5A607700
       TXH     CB33N,2,2                                                5A607800
       STO     CON2N          X                                         5A607900
       CLA     CON3N          X                                         5A608000
       ALS     2              X                                         5A608100
       ADD     CON3N          X                                         5A608200
       ALS     1              X                                         5A608300
       ADD     CON2N          X                                         5A608400
       STO     CON3N          X                                         5A608500
       TRA     CB33N                                                    5A608600
       REM                                                              5A608700
CB33M  STD     CBDLM                                                    5A608800
       CLA     CON3N          SET EXPONENT                              5A608900
       BFT     CBECN          WITH SIGN                                 5A609000
       SSM                    IN CORRECT CELL                           5A609100
       STO     COCEX          FOR FLOATING ROUTINE.                     5A609200
       TXH     CB31V,2,2      GIVE A MESSAGE IF THIS EXPO HAS MORE      5A609300
CB31W  CLA     CBDLM          THAN TWO DIGITS.                          5A609400
       TRA     CB09M                                                    5A609500
       REM                                                              5A609600
CB31V  STQ     COMQD                                                    5A609700
       SXA     *+3,4          EXPONENT FIELD                            5A609800
       TSX     DIAG,4         TOO LARGE                                 5A609900
       PZE     0,2,CB01D      X                                         5A610000
       AXT     **,4           X                                         5A610100
       LDQ     COMQD          X                                         5A610200
       TRA     CB31W          X                                         5A610300
       REM                                                              5A610400
       REM      CHECK FOR HOLLERITH FIELD.                              5A610500
CB07M  ARS     12                                                       5A610600
       BNT     .NINTG         DLMTR IF INTEGER                          5A610700
       BFT     CBPSW+CBPPW+CBCSW                                        5A610800
       TRA     CB45M                                                    5A610900
       PDX     ,1                                                       5A611000
       STD     .DLMTR         SET DELIMETER.                         (8)5A611100
       TXH     CB11N+1,1,H    TRANSFER IF NOT H.                     (8)5A611200
       TRA     CBHPT         *TRANSFER TO PATCH.                     (8)5A611300
CB07N  CLA     CON1N          SET OUTPUT ZONE FOR ALPHAMERIC         (8)5A611400
       ORA     .VALPH         CDNSTANT.                                 5A611500
       TRA     CB309                                                    5A611600
       REM                                                              5A611700
       REM      -FINAL CONVERSION.                                      5A611800
       REM                                                              5A611900
CB14H  BFT     CBCSW                                                    5A612000
       TXI     CB15N,4,-1                                               5A612100
       TSX     CBRRT,2                                                  5A612200
       RIB     CBPPW+CBESW+CBDSW                                        5A612300
       CLA     CBDLM                                                    5A612400
CB11N  STD     .DLMTR         SET DLMTR                                 5A612500
       TSX     CV00N,2        FLOAT                                     5A612600
       BFT     CBCSW                                                    5A612700
       TRA     CB11K                                                    5A612800
       STO     .OUTCH         SET OUTCH ZONE                            5A612900
       STQ     .OUTCH+1       X                                         5A613000
       CLA     .VREAL         SET FLAG WORD                             5A613100
       BFT     CBPSW+CBPPW                                              5A613200
       TRA     *+2                                                      5A613300
       CLA     .VINTG         X                                         5A613400
       BNT     CBDSW          X                                         5A613500
       TRA     *+2            X                                         5A613600
       CLA     .VDBLP                                                   5A613700
CB12K  LDQ     COMQD                                                    5A613800
       TRA     CB309                                                    5A613900
       REM                                                              5A614000
CB11K  BNT     CB2CP          SET OUTCH AND OUTFG FOR                   5A614100
       TRA     CB12L          THIS COMPLEX NUMBER                       5A614200
       STO     .OUTCH+1       X                                         5A614300
       CLA     .VCMLX         X                                         5A614400
       TRA     CB12K          X                                         5A614500
CB12L  STO     .OUTCH         X                                         5A614600
       TSX     CBRES,1        RESET CONVERT ROUTINE                     5A614700
       SIB     CBCMW+CBCSW    AND COLLECT 2ND PART.                     5A614800
       LDQ     COMQD          X                                         5A614900
       TRA     CB00N          X                                         5A615000
       REM                                                              5A615100
       SPACE   2                                                        5A615200
       REM                                                              5A615300
CB45M  BNT     CBCSW          IF NOT IN A COMPLEX NUMBER                5A615400
       TRA     CB11N          FLOAT                                     5A615500
CB15N  BNT     CBCMW          IF ERROR OCCURS IN FIRST PART             5A615600
       TRA     CB01A          RESET TO THE (                            5A615700
       SIB     CB2CP                                                    5A615800
       STZ     CON1N          IF NOT SET SCAN TO THE FIRST CHAR.        5A615900
       STZ     CON0N          AFTER THE ) AND GIVE A MESSAGE.           5A616000
       PDX     ,2                                                       5A616100
       STQ     COMQD          X                                         5A616200
       SXA     *+3,4          X                                         5A616300
       TSX     DIAG,4         X                                         5A616400
       PZE     0,4,CB05D      X                                         5A616500
       AXT     **,4           X                                         5A616600
       LDQ     COMQD          X                                         5A616700
CB05A  TXH     CB08A,2,.CRPRN                                           5A616800
       TXH     CB26M,2,.CRPRN-1                                         5A616900
CB02A  TXH     CB04A,4,0                                                5A617000
       REFILL                                                           5A617100
CB04A  ZAC                                                              5A617200
       CAQ     .BCCTB,1,1                                               5A617300
       TXI     *+1,4,-1                                                 5A617400
       PDX     ,2                                                       5A617500
       TXH     CB07A,1,6                                                5A617600
       TXH     CB11N,1,5                                                5A617700
       TXH     CB05A,1,4                                                5A617800
       TRA     CB02A                                                    5A617900
CB07A  TSX     BCZ00,1                                                  5A618000
       TRA     CB02A                                                    5A618100
CB08A  TXL     CB02A,2,.CENDM-1                                         5A618200
       TXH     CB02A,2,.CENDM                                           5A618300
       TRA     CB11N          SET FLAGS AND EXIT.                       5A618400
CB01A  TSX     BCRST,1                                                  5A618500
       LXA     .CRNTP,4                                                 5A618600
       LDQ     .INCHR                                                   5A618700
       CLA     CBDDM                                                    5A618800
       TRA     CB300                                                    5A618900
       REM                                                              5A619000
       REM      -OCTAL CONVERSION                                       5A619100
       REM                                                              5A619200
CBOCT  TRA     CB89T               TEST FOR 8 OR 9                   (5)5A619300
       STO     CODGN                                                    5A619400
       CAL     .OUTCH                                                (4)5A619500
       ALS     3                                                        5A619600
       ORA     CODGN                                                    5A619700
       SLW     .OUTCH                                                (4)5A619800
CB36N  TXH     CB01T,4,0                                                5A619900
       REFILL                 X                                         5A620000
CB01T  ZAC                    X                                         5A620100
       CAQ     .BCCTB,1,1     X                                         5A620200
       TXI     *+1,4,-1                                                 5A620300
       TXL     CB36N,1,0                                                5A620400
       TXL     CBOCT,1,1                                                5A620500
       TXL     CB05T,1,3                                                5A620600
       TXL     CB04T,1,6                                                5A620700
       TSX     BCZ00,1                                                  5A620800
       TRA     CB36N                                                    5A620900
CB05T  ARS     12             SET OUTPUT REGION.                        5A621000
CB04T  STD     .DLMTR         X                                         5A621100
       TRA     CBSGN               CHECK FOR + OR -                  (5)5A621200
       TRA     CB309                                                    5A621300
       REM                                                              5A621400
       REM     -CBMOR - CONVERTS A LITTERAL ACCORDING A GIVEN TYPE.     5A621500
       REM                                                              5A621600
CBMOR  SXA     BCXAT,1                                                  5A621700
       TSX     BCSLD,1        RESTORE GETBCI                            5A621800
       TSX     CBRES,1           -     CONVERT ROUTINE                  5A621900
       LXA     BCXAT+2,2                                                5A622000
       LDI*    1,2                                                      5A622100
       SIB     CBMON          SET FLAG FOR EXIT AT 2,4                  5A622200
       BFT     .NOCTL                                                   5A622300
       TRA     CB36N                                                    5A622400
       TRA     CB00N                                                    5A622500
       REM                                                              5A622600
       EJECT                                                            5A622700
CBDTA  TSX     CBRES,1        RESET CONVERT ROUTINE.                    5A622800
       REM                                                              5A622900
CB00N  TXH     CB100,4,0                                                5A623000
       REFILL                                                           5A623100
CB100  ZAC                                                              5A623200
       CAQ     .BCCTB,1,1                                               5A623300
       TRA     CB101,1                                                  5A623400
       TXI     CB109,4,-1     * ILLEGAL                                 5A623500
       TXI     CB106,4,-1     * ENDM                                    5A623600
       TXI     CB107,4,-1     * = , 1 ( )                               5A623700
       TXI     CB107,4,-1     * + - * . '                               5A623800
       TXI     CB190,4,-1     * H,X                                     5A623900
       TXI     CB104,4,-1     * ALPHAMERIC.                             5A624000
       TXI     CB05N,4,-1     * NUMERIC                                 5A624100
CB101  TXI     CB00N,4,-1     * BLANK                                   5A624200
       REM                                                              5A624300
CB109  TSX     BCZ00,1         ILLEGAL CHARACTER - GIVE A MESSAGE.      5A624400
       TRA     CB00N          *                                         5A624500
CB106  BFT     CBCSW          FNDM - DOES THAT HAPPEN                   5A624600
       TRA     CB15N          AFTER A ( ,YES                            5A624700
       BFT     CBPSW+CBPOM    AFTER .+ OR-                              5A624800
       TSX     CBRRT,2        YES,RESTORE                               5A624900
       BFT     CBPSW+CBPOM                                              5A625000
       CLA     CBDLM          AND SET DLMTR.                            5A625100
CB300  STD     .DLMTR                                                   5A625200
       AXT     3,1            SET PUNCTUATION EXIT.                     5A625300
       TRA     CBXIT+1       *X                                         5A625400
       SPACE   2                                                        5A625500
       REM                                                              5A625600
CB190  BFT     CBCSW+CBPOM+CBPSW                                        5A625700
       TRA     CB106                                                    5A625800
CB302  TXI     *+1,4,1        COLLECT ALPHANUMERIC SYMBOL.              5A625900
       AXT     2,1            X                                         5A626000
       AXT     6,2            X                                         5A626100
       LDI     .CZERO          RESET INDICATOR.                         5A626200
       TRA     BCA00         *                                          5A626300
       REM       -CHECK FOR ,T,F,O---,.TRUE,.FALSE. ,                   5A626400
       SPACE   2                                                        5A626500
CB104  BFT     CBCSW+CBPOM+CBPSW                                        5A626600
       TRA     CB106                                                    5A626700
       SLW     CBSAU          SAVE THIS CHARACTER IN CASE ITIS NOT      5A626800
       ARS     12             O,T,F                                     5A626900
       PDX     ,1                                                       5A627000
       TXH     CB113,1,T                                                5A627100
       TXH     CB111,1,T-1    IT IS T                                   5A627200
       TXH     CB113,1,O                                                5A627300
       TXH     CB170,1,O-1    IT IS O.                                  5A627400
       TXH     CB113,1,F                                                5A627500
       TXH     CB111+1,1,F-1      UT IS F                               5A627600
       TRA     CB113                                                    5A627700
CB112  TSX     CBRRT,2                                                  5A627800
CB113  CAL     CBSAU          COLLECT THIS ALPHA. STRING.               5A627900
       TRA     CB302                                                    5A628000
CB170  SIB     .NOCTL                                                   5A628100
CB111  SIB     CBPLG                                                    5A628200
       TSX     CBSAA,2                                                  5A628300
CB700  TXH     CB600,4,0                                                5A628400
       REFILL                                                           5A628500
CB600  ZAC                                                              5A628600
       CAQ     .BCCTB,1,1                                               5A628700
       TXL     CB601,1,0                                                5A628800
       TXL     CB115,1,1                                                5A628900
       TXL     CB112,1,3                                                5A629000
       TXL     CB117,1,6                                                5A629100
       TSX     BCZ00,1                                                  5A629200
CB601  TXI     CB700,4,-1                                               5A629300
CB115  BNT     .NOCTL                                                   5A629400
       TRA     CB112          GO COLLECTING THIS OCTAL CONSTANT.        5A629500
       TXI     CBOCT,4,-1                                               5A629600
CB117  BFT     .NOCTL                                                   5A629700
       TXI     CBPTM,4,-1    *ADD SIGN IN FIELD WIDTH               (11)5A629800
       TXI     *+1,4,-1       SCAN.                                     5A629900
CB308  STD     .DLMTR         AND SET .OUTPUT AREA.                     5A630000
       BFT     CBPLG                                                    5A630100
       STL     .OUTCH                                                   5A630200
       CLA     .VLOGL                                                   5A630300
CB309  STO     .OUTFG                                                   5A630400
CBXIT  AXT     1,1            SET PROPER  EXIT                          5A630500
       BFT     CBMON                                                    5A630600
       AXT     2,1            FROM MOREN OR GETBCI.                     5A630700
       SXA     BCXIT,1        X                                         5A630800
       TRA     BCXET         *X                                         5A630900
       REM                                                              5A631000
CB107  BFT     CBPOM+CBPSW                                              5A631100
       TRA     *+3                                                      5A631200
       STD     CBDLM                                                    5A631300
       TSX     CBSAA,2                                                  5A631400
       PDX     ,1                                                       5A631500
       TXH     CB106,1,.CPINT                                           5A631600
       TXH     CB310,1,.CPINT-1      IT IS .                            5A631700
       TXH     CB106,1,.CLPRN                                           5A631800
       TXH     CB311,1,.CLPRN-1      IT IS (                            5A631900
       TXH     CB106,1,.CMINS                                           5A632000
       TXL     CB314,1,.CMINS-1     IT IS +                             5A632100
CB312  SIB     CBSPP           SET SIGN TO -                            5A632200
CB314  BFT     CBPSW+CBPOM    IS IT A LEGEL SIGN.                       5A632300
       TRA     CB106          NO                                        5A632400
       SIB     CBPOM                                                    5A632500
       TRA     CB00N                                                    5A632600
       REM                                                              5A632700
CB310  BFT     CBPSW          IS IT THE FIRST DCP.                      5A632800
       TRA     CB106           NO                                       5A632900
       SIB     CBPSW          SET DCP SWITCH ON.                        5A633000
       TRA     CB00N                                                    5A633100
       REM                                                              5A633200
       REM                                                              5A633300
       REM                                                              5A633400
CB311  BFT     CBCSW+CBPSW+CBPOM                                        5A633500
       TRA     CB106           ULLEGAL (                                5A633600
CB400  SIB     CBCSW                                                    5A633700
       SXD     CBDDM,1        SAVE SCAN                                 5A633800
       STQ     .INCHR                                                   5A633900
       SXA     .CRNTP,4                                                 5A634000
       TSX     BCSAV,1                                                  5A634100
       TRA     CB00N          X                                         5A634200
       SPACE   3                                                        5A634300
CBDLM  PZE     **                                                       5A634400
CBDDM  PZE     **                                                       5A634500
CBSAU  PZE     **                                                       5A634600
       REM                                                              5A634700
       REM       CBRES - RESTORES THE CONVERT ROUTINE.                  5A634800
       REM                                                              5A634900
CBRES  STZ     CBRDG                                                    5A635000
       LDI     CBRDG                                                    5A635100
       STZ     CBTDG                                                    5A635200
       STZ     COCEX                                                    5A635300
       STZ     CON1N                                                    5A635400
       STZ     COVEX                                                    5A635500
       STZ     CBDLM                                                    5A635600
       STZ     CON0N                                                    5A635700
       STZ     CON3N                                                    5A635800
       TOV     *+1                                                      5A635900
       TRA     1,1                                                      5A636000
       SPACE   2                                                        5A636100
CBSPP  RBOOL   1              SIGN OF PPLE. PART.                       5A636200
CBPSW  RBOOL   2              DECIMAL POINT INDICATOR.                  5A636300
CBDPW  RBOOL   4              DOUBLE WORD INTEGER INDICATOR             5A636400
CBESW  RBOOL   10            E EXPONENT                                 5A636500
CBDSW  RBOOL   20             D EXPONENT.                               5A636600
CBESN  RBOOL   40            SIGN OF ADJUSTED EXPONENT.                 5A636700
CBCMW  RBOOL   100            THIS LITTERAL CONTAINS A COMMA.           5A636800
CBPPW  RBOOL   200            PERIOD.                                   5A636900
CBOVF  RBOOL   400            OVERFLOW 2** 70.                          5A637000
CBPOM  RBOOL   1000           + OR - SWITCH                             5A637100
CBCSW  RBOOL   2000           COMPLEX NUMBER                            5A637200
CBSEX  RBOOL   4000           EXPONENT SIGN INDICATOR                   5A637300
CBMON  RBOOL   10000          MOREN SWITCH.                             5A637400
CBECN  RBOOL   20000          SIGN OF EXP IS MINUS.                     5A637500
CB2CP  RBOOL   40000        2ND PART OF A COMPLEX NUMBER.               5A637600
CBFLI  RBOOL   100000                                                   5A637700
CBPLG  RBOOL   200000                                                   5A637800
       EJECT                                                            5A637900
       REM                                                              5A638000
       REM       CO00N - CONVERTS BCI TO BINARY INTEGER  -              5A638100
       REM              CALLING SEQUENCE    TSX CO00N,2 OR TSX CO0GN,2  5A638200
CO00N  ARS     30             SHIFT RESULT OF CAQ INSTRUCTION.          5A638300
       TNZ     CO100                                                    5A638400
       NZT     CON1N         INCREASE NUMBER OF SIGNIFICANT DIGIT       5A638500
       TRA     CO0GN         X                                          5A638600
CO100  LXA     CBTDG,1       X                                          5A638700
       TXI     *+1,1,1       X                                          5A638800
       SXA     CBTDG,1       X                                          5A638900
CO0GN  BFT     CBDPW                                                    5A639000
       TRA     CO02N         *YES-                                      5A639100
       BFT     CBOVF          NO- HAS OVERFLOW MODE BEGAN.              5A639200
       TRA     CO04N+1       *YES                                       5A639300
CO09N  STO     CODGN          NO - CONVERT -FIRST SAVE BCI DIGIT DG.    5A639400
       CLA     CON1N          LOAD PREVIOUS RESULT.                     5A639500
       ALS     2              MULTIPLY IT BY FOUR AND           - 4*R   5A639600
       ADD     CON1N          ADD TO THE RESULT PREVIOUS RESULT - 4*R+R 5A639700
       ALS     1              MULTIPLY IT BY 2    -  (4*R+R)*2 = 10*R   5A639800
       ADD     CODGN          ADD IT LAST DIGIT   - 10*R +DG.           5A639900
       TOV     CO01N         *HAS AN OVERFLOW OCCURED.                  5A640000
       STO     CON1N          NO,SAVE PARTIAL CONVERTED CONSTANT.       5A640100
       TRA     1,2           *RETURN.                                   5A640200
       REM                                                              5A640300
       REM       CONVERSION OF BCI  IN A DOUBLE  PRECISION INTEGER      5A640400
       REM                                                              5A640500
CO01N  STQ     COMQD          SAVE  INPUT WORD.                         5A640600
       SIB     CBDPW         /SET ON DOUBLE WORD INTEGER SWITCH.        5A640700
       ZAC                    ZERO AC.                                  5A640800
       LDQ     CON1N          LOAD FIRST CONVERTED PART.                5A640900
       STO     CON1N                                                    5A641000
       STQ     CON0N                                                    5A641100
       TRA     CO03N         *GO CONVERT LAST DIGIT.                    5A641200
CO02N  STO     CODGN          SAVE  DG.                                 5A641300
       STQ     COMQD          SAVE  INPUT WORD.                         5A641400
       CLA     CON1N                                                    5A641500
       LDQ     CON0N                                                    5A641600
CO03N  LLS     2              MULTIPLY IT BY 4   - 4*R                  5A641700
       TOV     CO04N         *OVERFLOW. YES DONOT CONVERT ANY MORE.     5A641800
       STO     COF0N          ADD  R TO 4*R  IN A FIXED DOUBLE PRECISION5A641900
       XCA                    XADDITION                                 5A642000
       ADD     CON0N          X                                         5A642100
       XCA                    X                                         5A642200
       ZAC                    X                                         5A642300
       CLA     COF0N          X                                         5A642400
       TNO     *+2           *X                                         5A642500
       ADD     .C1ADD         X                                         5A642600
       ADD     CON1N          X                                         5A642700
       TOV     CO04N         *X OVERFLOW STOP CONVERTING.               5A642800
       LLS     1               MULTIPLY   R+4*R BY 2                    5A642900
       TOV     CO04N         *X OVERFLOW STOP CONVERTING.               5A643000
       XCA                    ADD TO  10*R   DG                         5A643100
       ADM     CODGN          X                                         5A643200
       XCA                    X                                         5A643300
       TNO     *+2           *X                                         5A643400
       ADD     .C1ADD         X                                         5A643500
       TOV     CO04N         *OVERFLOW STOP CONVERTING.                 5A643600
       STO     CON1N                                                    5A643700
       STQ     CON0N                                                    5A643800
       LDQ     COMQD          RESTORE MQ WITH INPUT WORD.               5A643900
       TRA     1,2           *RETURN.                                   5A644000
CO04N  LDQ     COMQD          REST.INPUT WORD                           5A644100
       CLA     COVEX          INCREASE COUNTER OF OVERFLOW BY ONE       5A644200
       ADD     .C1ADD         X                                         5A644300
       STO     COVEX          X                                         5A644400
       TRA     1,2           *RETURN                                    5A644500
COMQD  PZE     **             SAVE MQ CELL                              5A644600
CON1N  PZE     **             FIRST PART OF INTEGER RESULT.             5A644700
CON0N  PZE     **             2ND  PART  OF INTEGER RESULT.             5A644800
CON2N  PZE     **             3RD  PART  OF INTEGER RESULT.             5A644900
CON3N  PZE     **             4TH  PART  OF INTEGER RESULT.             5A645000
COF0N  PZE     **                                                       5A645100
COVEX  PZE     **             COUNT OF DECIMAL DIGIT WHICH GIVE OVERFLOW5A645200
CODGN  PZE     **             SAVE LAST DIGIT CELL.                     5A645300
COCEX  PZE     **             VALUE OF EXPLICIT EXPONENT.               5A645400
CBRDG  PZE     **             COUNT OF DIGIT AT THE RIGHT OF DECIMAL..  5A645500
CBTDG  PZE     **             COUNT OF DIGIT                            5A645600
CV10P  PZE     **             INITIALIZED BY POWER OF TFN.              5A645700
       EJECT                                                            5A645800
       REM        CV00N  - FLOATS NUMBER IF NEEDED                      5A645900
CV00N  STQ     COMQD          SAVE INPUT WORD.                          5A646000
       REM          CHECK FOR PREDECLARED TYPE LITTERAL                 5A646100
       REM                                                              5A646200
       BNT     .NREAL         IS REAL TYPE ASKED.                       5A646300
       TRA     *+3                                                      5A646400
       RIB     CBDSW          AND RESET DP.SWITCH-                      5A646500
       TRA     CV02N         *GO AND FLOAT THIS NUMBER.                 5A646600
       BNT     .NDBLP         IS DP. TYPE ASKED.                        5A646700
       TRA     *+3                                                      5A646800
       SIB     CBDSW          X                                         5A646900
       TRA     CV02N         * FLOAT.                                   5A647000
       REM                                                              5A647100
       REM                                                              5A647200
       BFT     CBPSW+CBPPW      FLOAT OR NOT.                           5A647300
       TRA     *+2                                                      5A647400
       TRA     CV01N           NO                                       5A647500
       REM           -DECIDE IF IT HAS TO BE FLOAT IN DP OR SINGLE      5A647600
       REM                    PRECISION                                 5A647700
       BFT     CBDSW+CBESW+CBCSW                                        5A647800
       TRA     CV02N                                                    5A647900
       LXA     CBTDG,1        NO E OR D EXPONENT - IF NUMBER OF DIGIT   5A648000
       TXL     CV02N,1,9     *IS GREATER THAN 9                         5A648100
       SIB     CBDSW         /CONVERT IN DOUBLE PRECISION               5A648200
       REM                                                              5A648300
CV02N  SXA     CV00X,4                                                  5A648400
       SXA     CV00X+1,2                                                5A648500
       CLA     COCEX          LOAD VALUE OF E EXPONENT.                 5A648600
       ADD     COVEX          ADD NUMBER OF OVERFLOW COUNT.             5A648700
       SUB     CBRDG          SUB NUMBER OF DIGIT AT THE RIGHT OF EQUAL.5A648800
       TPL     *+2           *                                          5A648900
       SIB     CBESN         /SET FLAG FOR NEGATIVE TRUE EXPONENT.      5A649000
       PAX     ,1             XR1 HAS MAGNITUDE OF TRUE EXPONENT.       5A649100
       NZT     CON1N          IS MANTISSA ZERO.                         5A649200
       TRA     CV37N+2      **YES,UNDERFLOW.                            5A649300
       AXT     128,2          INDEX 2 HAS VALUE OF CHARACTERISTIC FOR   5A649400
       REM                    A ZERO EXPONENT FOR A ONE WORD INTEGER.   5A649500
       BFT     CBDPW                                                    5A649600
       AXT     163,2          SAME THING FOR A DOUBLE WORD INTEGER.     5A649700
       STZ     CON3N                                                    5A649800
       STZ     CON2N          RESET THIRD WORD STORAGE.                 5A649900
       TXL     CV32N,1,0     *IF EXPONENT =0  GO TO FLOATING ROUTINE.   5A650000
       AXC     CON1N,4        XR4 HAS 2'S COMPLT. OF ADDRESS OF FIRST   5A650100
       REM                    WORD STORAGE.                             5A650200
CV27N  SXA     CV31N,1        SAVE VALUE OF TRUE EXPONENT.              5A650300
       TXL     *+2,1,10      *IS XR1 GREATER THAN 10                    5A650400
       AXT     10,1           YES,                                      5A650500
       CLA     CV84N+10,1  AC HAS 10**10 OR 10**XR1 IF XR1 LESS THAN 10.5A650600
       STO     CV10P                                                    5A650700
       BNT     CBESN          IS IT A NEGATIVE  EXPONENT                5A650800
       TXI     CV29N,4,-2    *NO                                        5A650900
       REM                    YES                                       5A651000
       REM       NEGATIVE  EXPONENT.                                    5A651100
       ZAC                    RESET  AC  AND DIVIDE INTEGER      BY     5A651200
       AXT     3,1            CORRECT POWER OF TEN AND SAVE RESULT IN A 5A651300
       AXT     3,4            FOUR WORDS BUFFER.                        5A651400
CV28N  LDQ     CON1N+3,4      LOAD LOWER PART OF DIVIDEND.              5A651500
       DVP     CV10P          DIVIDE  BY  10**10(OR 10**N).             5A651600
       STQ     CON1N+3,1      SAVE QUOTIENT IN FIRST UNOCCUPIED CELL.   5A651700
       NZT     CON1N          IS FIRST CELL STILL ZERO.                 5A651800
       TXI     *+2,2,-35     *YES,DECREASE CHARACTERISTIC BY 35         5A651900
       REM                    AND SAVE REMAINDER IN AC AND KEEP DIVIDING5A652000
       REM                    LOW ORDER PART OF THIS INTEGER.           5A652100
       TNX     CV31N,1,1     *NO,STEP TO NEXT CELL STORAGE.             5A652200
       TIX     CV28N,4,1     *GO AND LOAD NEXT PART OF DIVIDEND.        5A652300
       LDQ     .CZERO         RESET LOWER PART OF DIVIDEND TO ZERO.     5A652400
       TRA     CV28N+1       *DIVIDE LAST PART OF DIVIDEND.             5A652500
       REM                                                              5A652600
       REM        POSITIVE EXPONENT.                                    5A652700
       REM                                                              5A652800
CV29N  AXT     3,1                                                      5A652900
       LDQ     CV10P          LOAD 10**10 (OR 10**N).                   5A653000
       MPY     0,4            MULTIPLY BY INTEGER WORD AND SAVE RESULT  5A653100
       TXH     CV30N,1,2     *IN A FOUR WORDS BUFFER.                   5A653200
       XCA                    MULTIPLICATION IN FIXED DOUBLE PRECISION. 5A653300
       ADD     1,4            X                                         5A653400
       XCL                    X                                         5A653500
       TQP     *+3           *X                                         5A653600
       ADD     .C1ADD         X                                         5A653700
       LRS     0              X                                         5A653800
CV30N  STO     0,4            X                                         5A653900
       STQ     1,4            X                                         5A654000
       TNX     *+2,1,1       *IS MULTIPLICATION OF 4 WORDS FINISHED.    5A654100
       TXI     CV29N+1,4,1    *NO GO ON)                                5A654200
       TZE     *+2           *YES,DOES THE RESULT OCCUPY ONE CELL LESS. 5A654300
       TXI     CV31N,2,35    *NO,INCREMENT CHARACTERISTIC.              5A654400
       TXI     CV31N,4,-1    *YES,DECREASE ADDRESS OF FIRST WORD STORAGE5A654500
CV31N  AXT     **,1           RESTORE VALUE OF TRUE EXPONENT AND        5A654600
       TIX     CV27N,1,10    *DECREASE IT BY 10.                        5A654700
       BFT     CBESN          WAS IT A NEGATIVE EXPONENT.               5A654800
CV32N  AXC     CON1N,4        YES,RELOAD ADDRESS OF FIRST WORD OF INTEG.5A654900
       REM     FLOAT NUMBER -                                           5A655000
       REM                                                              5A655100
       REM                                                              5A655200
       LFTM                   LEAVE TRAP MODE (TO MAKE SURE).           5A655300
       CLA     0,4            ADJUST  CHARACTERISTIC OF RESULT          5A655400
       LRS     8              X                                         5A655500
       ADD     CV71N          X    ADD  35B8                            5A655600
       STO     CV10P          X                                         5A655700
       CLA     CV72N          XAC HAS  27B16                            5A655800
       LLS     8              X                                         5A655900
       FAD     CV10P          X                                         5A656000
       ARS     9              DECREMENT HAS CHARACTERISTIC OF THIS      5A656100
       REM                    BINARY INTEGER.                           5A656200
       PDX     0,1            ADD IT                                    5A656300
       STD     *+1            TO THE CHARACTERISTIC                     5A656400
       TXI     *+1,2,**       DUE TO THE TRUE EXPONENT.                 5A656500
       TXH     CV37N,2,1000 **UNDERFLOW (CHARACT.IS NEGA. SO XR2 HAS    5A656600
       REM                               BEEN COMPLEMENTED).            5A656700
       TXH     CV35N+1,2,255 *OVERFLOW (2**18 -1 =255).                 5A656800
       CLA     1,4            LOAD  2ND WORD.                           5A656900
       LDQ     2,4            MQ HAS 3RD - .                            5A657000
       LLS     35,1           SHIFT THEM LIKE THE FIRST WORD HAS BEEN.  5A657100
       STO     2,4            SAVE RESULT                               5A657200
       CLA     0,4            SAME THING FOR FIRST AND 2ND WORD.        5A657300
       LDQ     1,4            X                                         5A657400
       LLS     35,1           X                                         5A657500
       LDQ     2,4            LOAD MQ WITH RESULT OF SHIFT FOR 2ND AND  5A657600
       REM                    3RD WORD - NOW AC AND MQ HAS CORRECT      5A657700
       REM                    MANTISSA.                                 5A657800
       LRS     8              LEAVE PLACE FOR CHARACTERISTIC.           5A657900
       STO     0,4            SAVE AC                                   5A658000
       PXD     0,2            PLACE CHAR. IN DECREMENT                  5A658100
       ALS     9              PLACE CHAR. AT THE RIGHT PLACE.           5A658200
       TOV     *+1           /TURN OFF OVERFLOW LIGHT.                  5A658300
       BFT     CBDSW          IS DOUBLE PRECISION WANTED.               5A658400
       TXI     CV33N,2,-27   *YES,GO ON BELOW                           5A658500
CV34N  ORA     0,4            NO,PLACE MANTISSA IN AC.                  5A658600
       RQL     28             SHIFT MQ BEFORE FLOATING ROUND.           5A658700
       FRN                    ROUND.                                    5A658800
       LDQ     .CZERO         RESET MQ TO ZERO.                         5A658900
       TRA     CV35N         *                                          5A659000
CV33N  TXH     CV34N,2,256   *                                          5A659100
       ORS     0,4            PLACE CHARACT. IN FIRST PART.             5A659200
       PXA     ,2             PLACE CHARACT OF 2ND PART IN AC           5A659300
       LLS     27             PLACE CHAR.+ MANTISSA OF SECOND PART INAC.5A659400
       RQL     28             SHIFT MQ BEFORE ROUNDING                  5A659500
       FRN                    ROUND.                                    5A659600
       FAD     0,4            PLACE 2 WORDS CONSTANT IN AC AND MQ.      5A659700
CV35N  TNO     CV36N         *                                          5A659800
       REM                    OVERFLOW.                                 5A659900
       TSX     DIAG,4        $                                          5A660000
       PZE     0,2,CV01D                                                5A660100
       CLA     CVMAC          LOAD  37777777777  IN AC                  5A660200
       LDQ     CVMAQ          LOAD 34477777777  IN MQ                   5A660300
       TRA     CV36N         *                                          5A660400
       REM                                                              5A660500
       REM        UNDERFLOW                                             5A660600
CV37N  TSX     DIAG,4        $                                          5A660700
       PZE     0,2,CV02D                                                5A660800
       ZAC                    LOAD 0 IN AC                              5A660900
       LDQ     .CZERO         LOAD 0 IN MQ                              5A661000
CV36N  BFT     CBSPP          IS SIGN OF PRINCIPAL PART MINUS.          5A661100
       SSM                    YES,SET SIGN OF AC MINUS.                 5A661200
       LRS     0              MAKE SIGNS OF AC AND MQ AGREE.            5A661300
CV00X  AXT     **,4                                                     5A661400
       AXT     **,2                                                     5A661500
CV03N  TRA     1,2           *                                          5A661600
       REM          STORE CONVERTED LITTERAL                            5A661700
CV01N  BNT     CBDPW                                                    5A661800
       TRA     *+5                                                      5A661900
       SXA     *+3,4           UNTEGER TOO LARGE.                       5A662000
       TSX     DIAG,4                                                   5A662100
       PZE     0,2,CB03D                                                5A662200
       AXT     **,4                                                     5A662300
       CLA     CON1N                                                    5A662400
       LDQ     .CZERO                                                   5A662500
       BFT     CBSPP                                                    5A662600
       SSM                                                              5A662700
       LRS     0                                                        5A662800
       TRA     1,2                                                      5A662900
       REM     TABLE  OF POWER  OF TEN                                  5A663000
CV84N  DEC     10000000000,1000000000,100000000,10000000,1000000        5A663100
       DEC     100000,10000,1000,100,10                                 5A663200
CV71N  OCT     043000000000    35B8                                     5A663300
CV72N  OCT     000066000000    27B16                                    5A663400
CVMAC  OCT     377777777777    GREATEST NUMBER ADMISSIBLE IN 7090       5A663500
CVMAQ  OCT     344777777777    X                                        5A663600
       SPACE   3                                                        5A663700
CBSAA  SXA     .CRNTP,4                                                 5A663800
       STQ     .INCHR                                                   5A663900
       TSX     CBSAV,1                                                  5A664000
       TRA     1,2                                                      5A664100
       SPACE   3                                                        5A664200
CBRRT  TSX     CBRST,1                                                  5A664300
       LDQ     .INCHR                                                   5A664400
       LXA     .CRNTP,4                                                 5A664500
       TRA     1,2                                                      5A664600
       EJECT                                                            5A664700
UBNBC  CLA     .OUTCH                                                   5A664800
UNBCG  NULL                                                             5A664900
       ANA     .MADDR                                                   5A665000
       LDQ     .CZERO                                                   5A665100
       VDP     UZTB1,,6                                                 5A665200
       VDP     UZTB2,,6     CONVRT THOUSANDS DIGITS.                    5A665300
       VDP     UZTB3,,6     CONVERT HUNDREDS DIGITS.                    5A665400
       VDP     UZTB4,,6     CONVERT TENS DIGITS.                        5A665500
       VDP     UZTB5,,6     CONVERT UNITS DIGITS.                       5A665600
       XCL                                                              5A665700
       SLW     UZAUX                                                    5A665800
       LDQ     .CBLK6       REPLACE LEADING ZERO BY BLANKS.             5A665900
       LGR     6                                                        5A666000
       TNZ     *-1                                                      5A666100
       XCL                                                              5A666200
       LDQ     UZAUX                                                    5A666300
       TRA     1,4                                                      5A666400
UZAUX  PZE     **                                                       5A666500
UZTB1  DEC     640000                                                   5A666600
UZTB2  DEC     4096000                                                  5A666700
UZTB3  DEC     26214400                                                 5A666800
UZTB4  DEC     167772160                                                5A666900
UZTB5  DEC     1073741824                                               5A667000
       EJECT                                                            5A667100
UNBCO  NULL                                                             5A667200
       LGR     15                                                       5A667300
       CLA     .CBLK1                                                   5A667400
       TOV     *+1                                                      5A667500
       ALS     3                                                        5A667600
       LGL     3                                                        5A667700
       TNO     *-2                                                      5A667800
       TRA     1,4                                                      5A667900
       REM                                                              5A668000
       TTL     SUBSCRIPT PROCESSOR                                      5A668100
       SPACE   2                                                        5A668200
       REM     ** SSCAN **                                              5A668300
       REM     THIS ROUTINE IS THE BASIC SCANNING ROUTINE               5A668400
       REM     OF THE SUBSCRIPT PROCESSOR.                              5A668500
       REM     THE SUBSCRIPT PROCESSOR SCANS THE SUBSCRIPT              5A668600
       REM     COMBINATION STARTING WITH THE FIRST CHARACTER            5A668700
       REM     FOLLOWING THE LEFT PARENTHESIS.                          5A668800
       REM     THE NAME POINTER TO THE SUBSCRIPTED VARIABLE             5A668900
       REM     IS AVAILABLE TO THE PROCESSOR IN THE CELL -              5A669000
       REM     .NAMEP                                                   5A669100
       REM     THE CALLING SEQUENCE IS WRITTEN AS FOLLOWS -             5A669200
       REM                   TSX  SSCAN,4                               5A669300
       REM     A POINTER TO THE FORTAG TABLE OR A POINTER TO            5A669400
       REM     THE SUBAK TABLE( CONSTANT SUBSCRIPT) IS RETURNED         5A669500
       REM     TO THE CALLER IN THE CELLS .FRTG. OR .SUBK. RESPECTIVELY 5A669600
       REM     AND IN THE ACC.  A ZERO ACC SIGNIFYS ERROR CONDITION.    5A669700
       SPACE   3                                                        5A669800
       REM     *********************************************************5A669900
       SPACE   5                                                        5A670000
SSCAN  SXA     SSRXR,1        SAVE CALLING LINKAGE.                     5A670100
       SXA     SSRXR+1,2                                                5A670200
       SXA     SSRXR+2,4                                                5A670300
       STI     SSIND          SAVE SENSE INDICATORS.                    5A670400
       LXA     .NAMEP,4       SAVE .NAMEP FOR CALLER.                   5A670500
       SXA     SSAVE,4                                                  5A670600
SSA00  AXT     1,2            INITIALIZE SUBSCRIPT ELEMENT COUNTER - IR25A670700
       SXA     SSEMT,2        SET MULTIPLE CELL, THE PRODUCT OF CONSTANT5A670800
       REM                    DIMENSIONS, WITH A 1 INITIALLY.           5A670900
       SXA     SSTMT,2        ALSO THE TEMPORARY MULTIPLE CELL.         5A671000
       REM              INITIALIZE COUNTERS AND SWITCHES                5A671100
       AXT     6,1                                                      5A671200
       STZ     SSEKA+6,1                                                5A671300
       TIX     *-1,1,1                                                  5A671400
       STZ     SSEPD          RESET PRODUCT OF VARIABLE DIMENSION SWITCH5A671500
       STZ     .FRTG.+1       CLEAR FIRST WORD OF FORTAG WORK AREA.     5A671600
       STZ     .FRTG.+2       NEXT ONE TOO.                             5A671700
       AXT     7,1            ZERO OUT TAU1,2-SCRIPT WORK AREA.         5A671800
       STZ     STWTS+7,1                                                5A671900
       TIX     *-1,1,1                                                  5A672000
       STZ     SSRPN          RESET RT. PAREN ENCOUNTERED SWITCH.       5A672100
       AXC     1,1            INITIALIZE PROLG2 WORK AREA INDEX.        5A672200
       SXA     SSEPC,1                                                  5A672300
       LXA     .NAMEC,1       LOAD COMPLEMENTED POINTER TO FIRST WORD.  5A672400
       SXD     SSENP,1                                                  5A672500
       CAL     .VNAME,1       PICK UP BCI NAME FOR USE AS               5A672600
       SLW     SSBCI          INSERT TO DIAGNOSTIC MESSAGES.            5A672700
       LDI     .VALUE,1       IS THIS SUBSCRIPT COMBINATION THE         5A672800
       BNT     .NDMPD         FIRST USAGE OF THIS VARIABLE.             5A672900
       TSX     SZPDB,4       *$YES, COMPUTE THE DIM PRODUCTS.           5A673000
       CLA     .VALUE,1      *NO, PICK UP WORD WITH DIMENSION POINTER.  5A673100
       PDX     ,4             LOAD COMPLEMENTED POINTER.                5A673200
       TXL     SSERR,4,0      ERROR IF NOT THERE.                       5A673300
       CAL     ,4             PICK UP FIRST WORD OF DIM TABLE.          5A673400
       PDX     ,1             COUNT OF WORDS FOLLOWING TO IR 1.         5A673500
       SXD     SSC00+1,1      SET IT IN TEST INSTRUCTION.               5A673600
       TXI     *+1,1,1        ADJUST TO YIELD TRUE COUNT                5A673700
       SXA     SSAA0,1        SAVE IR1 AROUND ADRESS COMPUTATION.       5A673800
       TXI     *+1,1,SSWDM    COMPUTE A REFERENCE ADDRESS.              5A673900
       SXA     SSAA1,1        SET IT IN THE STORE INSTRUCTION.          5A674000
SSAA0  AXT     **,1           RESTORE IR1 (TRUE COUNT)                  5A674100
SSAA1  SLW     **,1           STORE/NEXT WORD IN DIM TBL WORK AREA.     5A674200
       TXI     *+1,4,-1       ADJUST DIM TABLE INDEX TO POINT TO NEXT WD5A674300
       CAL     ,4             PICK UP NEXT WORD.                        5A674400
       TIX     *-3,1,1        GO BACK TO STORE.                         5A674500
       REM             DIM TABLE NOW IN TEMPORARY WORK AREA.            5A674600
       LDI*    .NAMEP         LOAD NAME TABLE FLAGS.                    5A674700
       LFT     .NCMLX+.NDBLP *IS THIS ARRAY DOUBLE PRECISION OR COMPLEX.5A674800
       STL     SS.DC         *YES, SET DP/CA SWITCH.                    5A674900
       REM                   *NO, INITIALIZE ERASABLE FOR FIRST/NEXT    5A675000
       REM                               SUBSCRIPT ELEMENT              5A675100
       REM                                                              5A675200
       REM             RESET FOLLOWING SWITCHES, COUNTERS ETC.          5A675300
       REM                                                              5A675400
SSINT  AXT     7,4                                                      5A675500
       STZ     SSEVI+1,4                                                5A675600
       TIX     *-1,4,1                                                  5A675700
       STZ     SS.E1          GENERAL ERASABLE.                         5A675800
       REM                                                              5A675900
       REM             BEGIN TO COLLECT THE SUBSCRIPT ELEMENT.          5A676000
       REM                                                              5A676100
SSA10  GETBCI  SSA12,SSA06,SSA08                                     (8)5A676200
       REM             FIRST CHARACTER IS NUMERIC,SEE WHAT PUNCT FOLLOWS5A676300
SSA01  TESTP   ((.CSTAR,SSA02),(.CCOMA,SSB21),(.CRPRN,SSB20)),SSER1     5A676400
       REM             AN ASTERISK FOLLOWS - PROCESS COEFICIENT.        5A676500
SSA02  CAL     .OUTCH         PICK UP EXPLICIT C.                       5A676600
       TZE     SSER9          ERROR IF ZERO.                            5A676700
       TXH     SSA03,2,1      IS IT C1, NO.                             5A676800
       ZET     SS.DC         *YES, IS THIS A DP/CA ARRAY.               5A676900
       ALS     1              YES, DOUBLE COEFICIENT.                   5A677000
SSA03  SLW     SSECI         *NO, STORE COEFICIENT AWAY.                5A677100
       REM             BCI NAME SHOULD FOLLOW.                          5A677200
SSA04  GETBCI  SSER2,SSA05,SSER2                                        5A677300
SSA05  NAME    SSA04          ENTER NAME IN NAME TABLE IF NEW           5A677400
       TRA     SSA07          CONTINUE BELOW                            5A677500
       REM             WE HAVE A NAME,ENTER IT IN THE NAME TABLE.       5A677600
SSA06  NAME    SSA10                                                    5A677700
SSA07  STA     SSEVI          NAME POINTER(COMPLEMENTED) TO VARIABLE    5A677800
       LNT     .NINTG         IS IT AN INTEGER VARIABLE.                5A677900
       TRA     SSER2          *NO, ERROR.                               5A678000
       ERA     .DOIND         IS THIS VARIABLE THE CURRENT DO INDEX.    5A678100
       TZE     *+3           *YES, CONTINUE BELOW.                      5A678200
       OSI     .VARBL        *NO, SET VARIOUS AND SUNDRY FLAGS          5A678300
       STI*    .NAMEP         ON IN THE NAME TABLE FOR THIS VARIABLE.   5A678400
       REM             WHAT PUNCTUATION FOLLOWS.                        5A678500
SSA08  TESTP   ((.CCOMA,SSB04),(.CRPRN,SSB40)),SSA09                    5A678600
SSA09  TESTP   ((.CPLUS,SSB00),(.CMINS,SSB10)),SSER3                    5A678700
       REM             DELIMITER INDICATES PRESENCE OF AN ADDEND.       5A678800
SSB00  STZ     SSIGN         RESET SIGN SWITCH FOR POSITIVE             5A678900
       TRA     *+2                                                      5A679000
SSB10  STL     SSIGN         SET SIGN SWITCH FOR NEGATIVE               5A679100
SSB11  GETBCI  SSB12,SSB01,SSER4     COLLECT ADDEND                  (8)5A679200
SSB01  NAME    SSB11          ALPHA RETURN - ERROR UNLESS A REPLACE     5A679300
       TRA     SSER4          STATEMENT CONDITION.                      5A679400
SSB20  STL     SSRPN          SET RT. PAREN ENCOUNTERED SWITCH.         5A679500
SSB21  STZ     SSIGN          RESET SWITCH FOR POSITIVE ADDEND(CONSTANT)5A679600
SSB02  CLA     .OUTCH         PICK UP ADDEND                            5A679700
       TXH     SSB03,2,1      IS THIS A1, NO.                           5A679800
       ZET     SS.DC         *YES, IS THIS A DP/CA ARRAY.               5A679900
       ALS     1              YES, DOUBLE A1                            5A680000
SSB03  ZET     SSIGN         *NO, POSITIVE OR NEGATIVE.                 5A680100
       SSM                    NEGATIVE, SET SIGN OF AC MINUS AND STORE. 5A680200
       STO     SSEAI          POSITIVE, STORE ADDEND.                   5A680300
       TRA     SSB04         *CONTINUE BELOW.                           5A680400
       REM                                                              5A680500
       REM          SCANNING COMPLETE - DETERMINE IF THERE              5A680600
       REM                   WAS AN ELEMENT AT  ALL.                    5A680700
       REM                                                              5A680800
SSB40  STL     SSRPN          SET RT. PAREN SWITCH.                     5A680900
SSB04  AXT     3,1                                                      5A681000
       CLA     SSECI+3,1      PICK UP C/I/A                             5A681100
       TNZ     SSB05         SOMETHING IS THERE, EXIT.                  5A681200
       TIX     *-2,1,1       GO BACK                                    5A681300
       TRA     SSER6        *NO, DIAGNOSTIC.                            5A681400
SSB05  TXH     SSB07,2,1    *YES, ARE WE PROCESSING THE FIRST ELEMENT,NO5A681500
       CLA     SSEAI          YES, ENTER A1-1 IN CONSTANT ADDEND CELL.  5A681600
       SUB     .C1ADD                                                   5A681700
       ZET     SS.DC          IS THIS ARRAY DP/CA.                      5A681800
       SUB     .C1ADD        *YES, ADJUST ADDEND FURTHER.               5A681900
       STO     SSEKA                                                    5A682000
SSB06  CLA     SSECI         PICK UP COEFICIENT.                        5A682100
       TNZ     SSB60          IS THERE AN EXPLICIT ONE, YES.            5A682200
       CLA     .C1ADD        *NO, SUPPLY ONE OF 1 OR 2.                 5A682300
       ZET     SS.DC          IS IT DP/CA.                              5A682400
       ADD     .C1ADD         2 IF DOUBLE PRECISION OR COMPLEX.         5A682500
SSB60  STA     SSTMT          SAVE THE MULTIPLE OF THIS ELEMENT.        5A682600
       REM        NOTE - THE MULTIPLE IS IMPLICITLY 1                   5A682700
       REM                   THERE IS NO EXPLICIT COEFIEIENT.           5A682800
       CLA     SSEVI         LOOK FOR VARIABLE.                         5A682900
       TZE     SSC00        *IS THERE ONE, NO.                          5A683000
SSB70  ALS     18            *YES, SWITCH NAME PTR. TO DECREMENT.       5A683100
       LXA     SSETC,4       LOAD INDEX POINTER TO TAU1,2-SCRIPT WA.    5A683200
       ORA     SSTMT          PICK UP MULTIPLE OF THIS ELEMENT.         5A683300
       SLW     STWTS,4        STORE MULTIPLE AND FLAGS.                 5A683400
       TXI     *+1,4,-1       UPDATE COUNTER AND POINTER.               5A683500
       SXA     SSETC,4        STORE BACK IN CELL.                       5A683600
       TRA     SSC00          GO TEST IF THERE ARE ANY MORE ELEMENTS.   5A683700
       REM                                                              5A683800
       REM         END OF 1ST ELEMENT PASS AND ENTRY POINT FOR          5A683900
       REM                  SECOND ELEMENT AND ON.                      5A684000
       REM                                                              5A684100
SSB07  PXD     ,2             COMPLEMENT BASIC COUNTER                  5A684200
       PDC     ,1                                                       5A684300
       TXI     *+1,1,1        ADJUST TO REFERENCE I TH WORD OF DIM TBL. 5A684400
       CAL     SSWDM,1        PICK IT UP                                5A684500
       PAI                    PLACE IN INDICATORS FOR TEST.             5A684600
       RIS     SS.M1          ISOLATE PREFIX                            5A684700
       OFT     .CONES        *CONSTANT DIMENSION OR ADJUSTABLE DIM.     5A684800
       TRA     SSC01         *ADJUSTABLE, TAKE DIFFERENT PATH.          5A684900
       PDX     ,4            *CONSTANT, STORE PRODUCT IN MULT CELL.     5A685000
       SXA     SSEMT,4        (PRODUCT OF CONSTANT DIMENSIONS.)         5A685100
       ZET     SSEPD          HAS AN ADJUSTABLE DIMENSION APPEARED      5A685200
       REM                    BEFORE                                    5A685300
       TRA     SSC10         *YES, TAKE ADJDIM PATH.                    5A685400
       STZ     SS.E1         *NO, SET UP FOR A*MULT AND C*MULT.         5A685500
       SXA     SS.E1,4                                                  5A685600
       CLA     SSEAI          PICK UP EXPLICIT ADDEND.                  5A685700
       SUB     .C1ADD         A-1 IN ACC.                               5A685800
       XCA                    TO MQ FOR MULTIPLICATION.                 5A685900
       MPY     SS.E1          (A-1)*MULT IN MQ.                         5A686000
       XCA                    TO AC FOR COMPUTATION.                    5A686100
       ADD     SSEKA          KA + (A-1)*MULT IN ACC.                   5A686200
       STO     SSEKA          TO CONSTANT ADDEND CELL.                  5A686300
SSB08  CLA     SSECI         *IS THERE AN EXPLICIT COEFICIENT.          5A686400
       TNZ     SSB80         *YES, CONTINUE AT SSB80.                   5A686500
       LXA     SSEMT,4       *NO, SET THE TEMPORARY MULTIPLE CELL       5A686600
       SXA     SSTMT,4        WITH THE PRODUCT OF CONSTANT DIMENSIONS.  5A686700
       TRA     SSB09          CONTINUE BELOW.                           5A686800
SSB80  XCA                   *YES, MULTIPLY BY THE PRODUCT OF LEADING   5A686900
       REM                    CONSTANT DIMENSIONS.                      5A687000
       MPY     SS.E1                                                    5A687100
       XCA                                                              5A687200
       STA     SSTMT          SAVE THIS PRODUCT (MULTIPLE) OF THIS      5A687300
       REM                              ELEMENT.                        5A687400
SSB09  CLA     SSEVI         *NO, IS THER A VARIABLE.                   5A687500
       TNZ     SSB70          YES                                       5A687600
       REM             UPDATE BASIC COUNTER AND TEST                    5A687700
SSC00  TXI     *+1,2,1        NO,UPDATE INDEX                           5A687800
       TXH     SSE00,2,**    *ANY MORE ELEMENTS,  NO.                   5A687900
       NZT     SSRPN         *YES, HAS A RT. PAREN BEEN ENCOUNTERED YET.5A688000
       TRA     SSINT         *NO, RE-INITIALIZE.                        5A688100
       TRA     SSER1          YES, ERROR. NUMBER OF SUBSCRIPTS DOES NOT 5A688200
       REM                    AGREE WITH DIMENSIONALITY.                5A688300
       REM                                                              5A688400
       REM          PREFIX CODE OF I TH WORD OF DIM TABLE               5A688500
       REM          INDICATES A PRODUCT OF ADJUSTABLE                   5A688600
       REM          DIMENSIONS OR A RELATIVE POSITION IN                5A688700
       REM          THE D.BLOCK                                         5A688800
       REM                                                              5A688900
SSC01  STP     SSEPD          INITIALIZE PROD CELL (SSEPD) AS DISTINCT  5A689000
       STD     SSEPD          FROM MULT CELL (PRODUCT OF CONSTANT DIMS.)5A689100
       LXA     SSEMT,4        IS THE CONTENTS OF THE MULT CELL 1.       5A689200
SSC10  TXL     SSC09,4,1     *YES, XFER TO TEST C.                      5A689300
       CLA     SSECI         *NO, PICK UP COEFICIENT.                   5A689400
       TNZ     SSC11          IS THERE AN EXPLICIT ONE, YES GENR PROLG1.5A689500
       CLA     .C1ADD         NO, SUPPLY ONE OF 1.                      5A689600
       STA     SSECI                                                    5A689700
SSC11  TRA     SSC09+2        SKIP TEST OF C AND GENERATE PROLG1 ETC.   5A689800
SSC20  CLA     SSEAI          PICK UP EXPLICIT ADDEND                   5A689900
       SUB     .C1ADD         SUBTRACT 1 - A(I)-1 IN ACC                5A690000
       STO     SS.E2          SAVE TEMPORARILY.                         5A690100
       TZE     SSC00          NO ADDEND PRESENT AFTER EXPANSION, SKIP   5A690200
       REM                    GENERATION OF PROLG1,2.                   5A690300
       LXA     SSEMT,4        TEST MULTIPLICITY.                        5A690400
       TXH     SSC21,4,1      IS IT 1,NO - GENERATE PROLG1.             5A690500
       ARS     1             *YES, IS THE EXPANDED ADDEND 1.            5A690600
       TNZ     SSC81          NO, RESTORE ADDEND AND GENERATE PROLG1.   5A690700
       TPL     *+2            YES, IS IT POSITIVE OR NEGATIVE.          5A690800
       ORA     SSSPD         *NEGATIVE, SET SIGN OF ADDEND IN BIT 2,SAVE5A690900
       SLW     SS.E1         *POSITIVE, SAVE SIGN.                      5A691000
       CAL     SSEPD          PROD CELL CONTAINS APPROPRIATE PREFIX.    5A691100
       ANA     SS.M4          FLAG AND DECR. FOR PROLG2 - MASK OUT UN-  5A691200
       TRA     SSC41          WANTED TAG AND ADDRESS, PROCESS PROLG2.   5A691300
SSC21  TSX     SSPG1,4       $PROCESS ADDEND/COEFICIENT THRU PROLG1.    5A691400
       TRA     SSC08          TABLE DUPLICATION CHECK AND ENTRY,EM XFER.5A691500
SSC40  LXA     TRPTR,4        PICK UP TR POINTER TO DUPLICATED ENTRY.   5A691600
       PXD     ,4            PLACE POINTER IN ACC.                      5A691700
       TRA     SSC04         *CONTINUE BELOW.                           5A691800
SSC41  ORA     SSD.G          OR IN A BIT 1 ON.                         5A691900
SSC04  ORA     SS.E1          OR IN SIGN OF PREVIOUS MULTIPLICATION.    5A692000
SSC06  LXA     SSEPC,4        STORE LOGICAL AC IN PROLG2 WORK AREA.     5A692100
       SLW     SPWP2,4                                                  5A692200
       TXI     *+1,4,-1       UPDATE INDEX POINTER                      5A692300
       SXA     SSEPC,4                                                  5A692400
       TRA     SSC00          XFER TO TEST FOR MORE ELEMENTS.           5A692500
SSC81  CLA     SS.E2          RESTORE ADDEND.                           5A692600
       TRA     SSC21          XFER TO GENERATE PROLG1,2.                5A692700
       REM                   *END MARK ENCOUNTERED WHILE READING        5A692800
       REM                    PROLG1 TABLE - ENTRY IS UNIQUE.           5A692900
SSC08  CAL     SPWP1          SET WORD 1 OF ENTRY WITH WORD 1 OF PROLG1 5A693000
       ANA     SS.M2          WORK AREA, WORD 1.  RESET BIT 1 IN THE    5A693100
       SLW     SSELC          PROCESS.                                  5A693200
       STZ     SSELC+1        RESERVE A SECOND WORD.                    5A693300
       NXTSMP  TP1,SSELC,.C2ADD $SEND PROLG1 WA TO PROLG1 TBL. AND OBT- 5A693400
       REM                       AIN POINTER                            5A693500
       PAX     ,1             SAVE POINTER.                             5A693600
       CLOSE   TP1            INSERT END MARK(EM)                       5A693700
       PXD     ,1             TR POINTER IS IN IR 1, PUT IT IN ACC, DECR5A693800
       ORA     SSTP1          OR IN A BIT 1 OF 0.                       5A693900
       TRA     SSC04          XFER TO SET SIGN OF DECR. AND INSERT      5A694000
       REM                    LOGICAL ACC IN PROLG2 WORK AREA.          5A694100
       REM                                                              5A694200
       REM            BUILD PROLG1 TABLE FOR EXPLICIT COEFICIENT        5A694300
       REM            IN SSECI OR FOR IMPLICIT COEFICIENT IN SSEMT.     5A694400
       REM                                                              5A694500
SSC09  CLA     SSECI         *IS THERE A COEFICIENT.                    5A694600
       TZE     SSD20         *NO, SKIP PROLG1 GENERATION, BUT SET       5A694700
       REM                    VARIABLE DIM NAMEP W/TAG OF 5 OR N FROM   5A694800
       REM                    D.CELL W/TAG OF 4 IN TAU1,2-SCRIPT WA.    5A694900
       REM                   *YES, MULTIPLY BY MULT CELL                5A695000
       REM            PROCESS ADDEND/COEF THRU PROLG1 DUP CHECK         5A695100
       REM            AND ENTRY. XFER TO SSD05 IF END MARK IS HIT ON RD.5A695200
       REM                                                              5A695300
       TSX     SSPG1,4                                                  5A695400
       TRA     SSD05         EM EXIT FROM SSPG1 ROUTINE                 5A695500
       REM                   NORMAL EXIT                                5A695600
SSD02  CAL     SSEVI         PUT NAMEP(I) AND N FROM D.CELL INTO        5A695700
       REM     TAU1,2-SCRIPT WORK AREA, IF THERE IS ONE (VARIABLE).     5A695800
       TZE     SSC20                                                    5A695900
       PAX     ,4            SWITCH NAME PTR TO DECREMENT               5A696000
       PXD     ,4                                                       5A696100
       ORA     SS.M3         OR IN A PREFIX OF 4, TAG OF 4.             5A696200
       ORA     SSELC+1       OR IN N FROM PROLG1,WORD2                  5A696300
       LXA     SSETC,4       LOAD INDEX POINTER                         5A696400
       SLW     STWTS,4       PUT LOGICAL ACC IN TAU1,2-SCRIPT WORK AREA.5A696500
       TXI     *+1,4,-1      UPDATE INDEX POINTER.                      5A696600
       SXA     SSETC,4                                                  5A696700
       STZ     SPWP1         RESET PROLG1 WORK AREA, WORD 1.            5A696800
       TRA     SSC20          XFER TO PROCESS ADDEND.                   5A696900
SSD20  CAL     SSEPD          PICK UP VARIABLE DIM OR N FROM D.CELL.    5A697000
       PDX     ,4             SET IT IN THE COMMUNICATIONS REGION.      5A697100
       SXA     SSELC+1,4                                                5A697200
       PBT                    DO WE HAVE A NAME POINTER OR N FROM D.CELL5A697300
       TRA     SSD02         *D.N, TRANSFER TO MAKE TAU ENTRY.          5A697400
       REM                   *NAME POINTER.                             5A697500
       CAL     STVDP          OR IN TAG OF 5 - TO DISTINGUISH BETWEEN A 5A697600
       ORS     SSELC+1        NUMERIC CONSTANT ( TAG OF 0 ), AND A      5A697700
       REM                    RELATIVE POSITION IN THE D. BLOCK (TAG OF 5A697800
       REM                    4 )                                       5A697900
       TRA     SSD02                                                    5A698000
SSD05  CAL     SPWP1          EM HIT WHILE READING - ENTRY IS UNIQUE.   5A698100
       ORA     SSD.G          SET BIT 1 ON IN PROLG1 WORK AREA.         5A698200
       STZ     SSELC+1        RESERVE WORD 2.                           5A698300
       SLW     SSELC                                                    5A698400
       LXA     .DCELL,4       UPDATE D. CELL.                           5A698500
       TXI     *+1,4,1                                                  5A698600
       SXA     .DCELL,4                                                 5A698700
       SXA     SSELC+1,4      SET N IN WORD 2.                          5A698800
       NXTSM   TP1,SSELC,.C2ADD  $SEND PROLG1 WA TO PROLG1 TBL.         5A698900
       CLOSE   TP1            INSERT EM.                                5A699000
       TRA     SSD02          PUT N  AND NAMEP(I) IN TAU1,2-SCRIPT WA.  5A699100
       REM                                                              5A699200
       REM                                                              5A699300
       REM          ESSENTIALLY, THIS IS THE END OF THE FIRST           5A699400
       REM          PASS OF THE PROCESSOR. THE TABLE ENTRIES            5A699500
       REM          ARE BUILT UP IN WORK AREAS. THE REMAINDER           5A699600
       REM          OF THE PROCESSOR CONCERNS ITSELF WITH THE           5A699700
       REM          RE-ORDERING AND OPTIMIZATION OF THESE WORK          5A699800
       REM          AREAS AND THE CONSTRUCTION, DUPLICATE CHECK,        5A699900
       REM          AND INSERTION INTO THEIR RESPECTIVE TR TABLES       5A700000
       REM          OF TAU1, TAU2, SCRIPT, PROLG2, FORTAG, AND          5A700100
       REM          SUBAK ENTRIES.                                      5A700200
       SPACE   4                                                        5A700300
SSE00  TESTP   ((.CRPRN,SSE10)),SSER7  SEE IF THERE IS A CLOSING ).     5A700400
SSE10  CAL     SSEPD          YES, HAS AN ADJUSTABLE DIMENSION          5A700500
       TZE     SSE08          APPEARED PREVIOUSLY, NO.                  5A700600
       LAC     SSEPC,1       *YES, IS THE PROLG2 WORK AREA EMPTY.       5A700700
       TXL     SSE08,1,1      YES, ENTER NAMEP(A) AND KA IN SUBAK TABLE.5A700800
       TXI     *+1,1,-1       NO, UPDATE INDEX TO YIELD TRUE COUNT.     5A700900
       PXD     ,1                                                       5A701000
       ARS     3              SHIFT TO TAG.                             5A701100
       STT     SS.ETP         SAVE TEMPORARILY.                         5A701200
       ORA     SSEKA          OR IN CONSTANT ADDEND                     5A701300
       STP     SS.ETP         SAVE SIGN.                                5A701400
       PAX     ,4             SWITCH ADDRESS/DECR.                      5A701500
       PXD     ,4                                                       5A701600
       ORA     SS.ETP         OR TAG AND SIGN BACK IN.                  5A701700
       ORA     SSP12          BITS 1 AND 2 ARE ALWAYS ON.               5A701800
       SLW     SPWP2          SET LOGICAL ACC IN PROLG2 WORK AREA,WORD 15A701900
       TSX     SSPG2,4       $PROCESS PROLG2 WORK AREA.                 5A702000
       TRA     *+1            DUPLICATE RETURN.                         5A702100
       REM           NORMAL RETURN                                      5A702200
       REM           BUILD SUBAK ENTRY FOR PROLG2                       5A702300
       PXD     ,2            CONVERT D.N TO ERAS. TBL POINTER.          5A702400
       ORA     .C25PD        SET ERASABLE CLASSIFICATION BITS.          5A702500
       SLW     RA.CEL         SEND TO COMMUNICATIONS CELL.              5A702600
       TSX     ENTTER,4      $MAKE ERASABLE TABLE ENTRY FOR THIS D.N.   5A702700
       REM        -  D.CELL ERASABLE TABLE POINTER IS IN ACC. -         5A702800
       ORA     SSSNA          SET INDICATIVE FLAG IN BIT 19.            5A702900
       STA     SS.A2          TO ADDRESS ERASABLE CELL.                 5A703000
SSE70  ORA     SS.A2          OR IN N/KA                                5A703100
       ORA     SSENP          OR IN NAMEP(A).                           5A703200
       SLW     SS.E1          SAVE SUBAK ENTRY FOR DUPLICATE SEARCH.    5A703300
       OPEN    TSB,SSE80     $OPEN SUBAK TABLE.                         5A703400
SSE71  NXTGLP  TSB,SSE81     $PERFORM A LINEAR SEARCH OF THE SUBAK TABLE5A703500
       LAS     SS.E1          COMPARE AGAINST CURRENT ENTRY.            5A703600
       TRA     SSE71         *NO, BACK FOR MORE.                        5A703700
       TRA     SSE82         *YES.                                      5A703800
       TRA     SSE71         *NO, BACK FOR MORE.                        5A703900
SSE82  LXA     TRPTR,1       *ENTRY IS A DUPLICATE, USE OLD             5A704000
       TRA     SSE83          SUBAK POINTER.                            5A704100
SSE81  CAL     SS.E1         *ENTRY IS UNIQUE, RESTORE IT IN LOGICAL ACC5A704200
       NXTSLP  TSB           $INSERT IT.                                5A704300
       PAX     ,1             SAVE POINTER.                             5A704400
       CLOSE   TSB           $INSERT END MARK.                          5A704500
SSE83  SXA     .SUBK.,1       TR POINTER IS IR 1.                       5A704600
       TRA     SSF00                                                    5A704700
SSE80  START   TSB           $THE SUBAK TABLE DOES'NT EXIST, START IT.  5A704800
       CLOSE   TSB           $INSERT END MARK.                          5A704900
       TRA     SSE71          TRANSFER TO INSERT ENTRY.                 5A705000
       REM                                                              5A705100
       REM         EITHER THE PROD CELL IS 0(NO ADJUSTABLE DIMENSIONS)  5A705200
       REM         OR THE PROLG2 WORK AREA IS EMPTY.                    5A705300
       REM             - BUILD SUBAK ENTRY WITH NAMEP(I) AND KA. -      5A705400
       REM                                                              5A705500
SSE08  CAL     SSEKA          PICK UP CONSTANT ADDEND                   5A705600
       STA     SS.A2          INITIALIZE ADDRESS ERASABLE WITH IT.      5A705700
       ARS     18             SHIFT SIGN TO TAG.                        5A705800
       TRA     SSE70          MAKE ENTRY                                5A705900
SSF00  LAC     SSETC,1        LOAD TAU1,2-SCRIPT WORK AREA INDEX.       5A706000
       TXH     SSF01,1,0      WAS THERE A TAU1 OR TAU2 OR SCRIPT.       5A706100
       TRA     SSH03         *NO, SKIP OPTIMIZATION AND RETURN TO CALLER5A706200
       REM                    WITH CONSTANT SC INDICATION               5A706300
*                REORDER  TAU1,2-SCRIPT WORK AREA (STWTS)               5A706400
SSF01  TSX     SSROTS,4                                                 5A706500
       REM                                                              5A706600
       REM       OPTIMIZE TAU1,2-SCRIPT WORK AREA                       5A706700
SSF02  TSX     SSOPTS,4                                                 5A706800
       REM                                                              5A706900
       REM       TAU1,2-SCRIPT COMPLETELEY OPTIMIZED.                   5A707000
       REM                                                              5A707100
       AXC     1,2            INITIALIZE REFERENCE INDEX TO TAU2-SCRIPT 5A707200
       REM                    WORK AREA (ST2SR).                        5A707300
       AXT     0,1            INITIALIZE REFERENCE INDEX TO STWTS.      5A707400
SSF30  CAL     STWTS,1        PICK UP FIRST/NEXT WORD.                  5A707500
       TZE     SSF06          IF ZERO, ALL DONE.                        5A707600
       ARS     18             SHIFT TO ADDRESS.                         5A707700
       LDI     .DOIND         COMPARE TO ADDRESS OF .DOIND CELL.        5A707800
       IIA                                                              5A707900
       RFT     SSDOV          IS IT TAU1 OR TAU2-SCRIPT.                5A708000
       TRA     SSF05         *TAU2-SCRIPT.                              5A708100
       CAL     SS.M6         *TAU1, MASK OUT DECREMENT ( NAME PTR. )    5A708200
       ANS     STWTS,1        OF THIS TAU1.                             5A708300
       LXA     .PNST1,4       REPLACE THE NAME POINTER                  5A708400
       PXD     ,4             WITH THE NEST1 POINTER.                   5A708500
       ORA     STWTS,1                                                  5A708600
       STO     STWT1          STO OPERATION DISREGARDS P BIT.           5A708700
       REM          ENTER ENTRY INTO TAU1 TABLE.                        5A708800
       ENTTA1  STWT1,SSF50                                              5A708900
       REM         NEW ENTRY                                            5A709000
       SXA     SSF04,2        SAVE INDEX.                               5A709100
       PAX     ,2             POINTER TO NEW ENTRY IN ACC TO IR2.       5A709200
       SXD     .FRTG.+2,2     TAU1 POINTER TO FORTAG WORK AREA.         5A709300
       LXA     .DOLPL,4       GET POINTER TO 1ST WORD OF TPD ENTRY.     5A709400
       CAL     1,4            GET SECOND WORD OF TPD ENTRY.             5A709500
       ADM     .C1DEC         BUMP UP COUNT OF NEW TAU1S FOR THIS DO.   5A709600
       STD     1,4            PLACE NEW COUNT IN TPD ENTRY.             5A709700
SSF03  LDQ     2,4            SAVE LAST WORD OF TPD ENTRY.              5A709800
       PXD     0,2            PLACE POINTER TO NEW TAU1 IN ACC.         5A709900
       STD     2,4            SAVE NEW TAU1 POINTER IN TPD ENTRY.       5A710000
       XCA                    RETRIEVE OLD TAU1 POINTER.                5A710100
       PDX     0,4            PLACE OLD TAU1 POINTER IN IXR4.           5A710200
       PXA     ,2             NEW ENTRY POINTER IS NOW PLACED           5A710300
       STA     2,4            IN ADDRESS FIELD OF  LAST   TAU1 IN TABLE.5A710400
       CAL     .C1DEC         INITIALIZE CURRENT TAU1, WORD 3 WITH A    5A710500
       SLW     2,2            DECREMENT OF 1.                           5A710600
SSF04  AXT     **,2           RESTORE 2                                 5A710700
       TXI     SSF30,1,-1     BACK FOR MORE.                            5A710800
       REM             ENTRY IS A DUPLICATE.                            5A710900
SSF50  PAX     ,4             SAVE POINTER TO DUPLICATED ENTRY.         5A711000
       SXD     .FRTG.+2,4     POINTER TO FORTAG WORK AREA.              5A711100
       CAL     2,4            UPDATE COUNT OF SIMILAR TAU1S.            5A711200
       ADD     .C1DEC                                                   5A711300
       SLW     2,4                                                      5A711400
       TXI     SSF30,1,-1     RETURN FOR MORE SEPARATION.               5A711500
       REM          TAU2-SCRIPT.                                        5A711600
SSF05  CAL     STWTS,1        MOVE TAU1,2-SCRIPT WORK AREA ENTRY TO     5A711700
       SLW     ST2SR,2        NEW TAU2-SCRIPT TEMPORARY AREA.           5A711800
       TXI     *+1,1,-1      *NO, CONTINUE                              5A711900
       TXI     SSF30,2,-1                                               5A712000
       REM                                                              5A712100
       REM        DIVISION OF VARIABLES COMPLETE                        5A712200
       REM                                                              5A712300
SSF06  PXA     ,2             WAS THERE ANY TAU2 OR SCRIPT.             5A712400
       PAC     ,2                                                       5A712500
       TXH     SSF07,2,1     *YES, CONTINUE                             5A712600
       TRA     SSH01         *NO                                        5A712700
SSF07  SXA     SS.A1,2        SAVE NUMBER OF WORDS FOR TABLE CALL.      5A712800
       TXI     *+1,2,-1       ADJUST TO YIELD NO. OF WORDS FOLLOWING    5A712900
       PXD     ,2             FIRST WORD FOR TAG.                       5A713000
       ARS     3                                                        5A713100
       ORA     STSB1         *NO, TURN BIT 1 ON IN TAU2-SCRIPT WA.      5A713200
       SLW     ST2SR          SET LOGICAL ACC IN FIRST WORD.            5A713300
       NZT     .DOIND         ARE WE IN A DO NEST.                      5A713400
       TRA     SSF09         *NO                                        5A713500
       REM                   *YES, LOCATE REFERENCE PT. IN THIS DO NEST.5A713600
       REM                    PUT ENTRY IN SCRIPT TABLE.                5A713700
       REM                                                              5A713800
       REM         THIS ROUTINE FINDS THE P.C. (POINT OF COMPUTATION)   5A713900
       REM         FOR A SCRIPT ENTRY AS DETERMINED BY THE DEFINITION   5A714000
       REM           OF THE SCRIPT ITEM VARIABLES BY THE OUTER DO       5A714100
       REM           INDEX VARIABLES.                                   5A714200
SSF70  STZ     SSKA1        /INITIALIZE INDICATOR.                      5A714300
       LXA     .PNST1,4      GET IMMEDIATE DO NEST1 POINTER.            5A714400
SSF71  SXA     SSKA2,2       SAVE THE NUMBER OF UNDEFINED NEST1 ITEMS.  5A714500
SSF72  NZT     SSKA1         HAS A FINAL P.C. BEEN SET YET.             5A714600
SSF73  SXD     ST2SR,4       NO, PLACE LAST NEST1 AS TEMPORARY P.C.     5A714700
SSF74  CLA     1,4           GET THE NEXT OUTER DO NEST1 POINTER.       5A714800
       PAX     0,4           PLACE INTO INDEX REGISTER 4.               5A714900
       TXL     SSF7F,4,0    *TRANSCER OUT IF NO MORE DOS.               5A715000
SSF75  LAC     SS.A1,2        GET THE NUMBER OF SCRIPT ITEMS PLUS 1.    5A715100
SSF76  TXI     *+1,2,1       REDUCE THE COUNT TO THE CORRECT NUMBER.    5A715200
SSF77  TXL     SSF72,2,0    *IF NO MORE, LOOK FOR NEXT OUTER DO.        5A715300
SSF78  LDI     ST2SR,2       GET THE FIRST OR NEXT SCRIPT ITEM.         5A715400
SSF79  BFT     SSKB1         HAS IT BEEN DEFINED ALREADY.               5A715500
       TXI     SSF77,2,1    *YES, GET NEXT SCRIPT ITEM.                 5A715600
SSF7A  PIA                   NO, GET IT INTO THE ACCUMULATOR.           5A715700
       ERA     0,4           COMPARE IT WITH THE DO INDEX               5A715800
       ANA     .MDECR        MASK OUT EXTRANEOUS BITS.                  5A715900
       TNZ     SSF76        *IF NO MATCH, GET NEXT SCRIPT ITEM.         5A716000
       REM                   IT DOES MATCH                              5A716100
SSF7B  SIB     SSKB1         MARK THIS SCRIPT ITEM AS DEFINED           5A716200
       STI     ST2SR,2       REPLACE IT IN SCRIPT ENTRY.                5A716300
       STL     SSKA1         MARK INDICATOR THAT FINAL P.C. HAS BEEN SET5A716400
SSFMC  LXA     SSKA2,2       GET THE NUMBER OF UNDEFINED SCRIPT ITEMS.  5A716500
SSF7D  TIX     SSF71,2,1    REDUCE BY 1. IF NO MORE, TRANSFER TO NEXT DO5A716600
SSF7E  CAL     .C4PFX        GET INDICATOR THAT SCRIPT IS FULLY DEFINED.5A716700
       ORS     ST2SR         USE IT TO MARK THIS SCRIPT AS FULLY DEFINED5A716800
SSF7F  NULL                                                             5A716900
       ENTSCP  ST2SR,SS.A1,SSF08                                        5A717000
SSF08  STA     .FRTG.+2       SCRIPT POINTER TO FORTAG WORK AREA.       5A717100
       TRA     SSH01          TRANSFER AROUND TAU2 CONDITION.           5A717200
SSF09  ENTTA2  ST2SR,SS.A1,SSH00    $MAKE TAU2 ENTRY.                   5A717300
       PAX     ,4             UNIQUE RETURN.                            5A717400
       SXD     .FRTG.+2,4     TAU2 POINTER TO FORTAG WORK AREA.         5A717500
       TRA     SSH01          CONTINUE BELOW.                           5A717600
SSH00  PAX     ,4           *DUPLICATE RETURN, TURN ON BIT 3 IN         5A717700
       CAL     SSSGL          DUPLICATED ENTRY                          5A717800
       ORS     0,4                                                      5A717900
       SXD     .FRTG.+2,4     TAU2 POINTER TO FORTAG WORK AREA.         5A718000
SSH01  LXA     .SUBK.,4       LOAD SUBAK POINTER.                       5A718100
       SXA     .FRTG.+1,4     TO FORTAG.                                5A718200
       ZET     SS.AT          HAS THE SUBSCRIPT PROCESSOR BEEN CALLED   5A718300
       TRA     SSH02          BY THE ARITHMETIC TRANSLATOR, YES.        5A718400
       ZET     SS.SA         *NO, BY THE DATA SCAN.                     5A718500
       TRA     SSH10         *YES, BYPASS IFN ASSIGNMENT.               5A718600
       TSX     UIFNO,4       *NO, ASSIGN AN IFN TO THIS FORTAG.         5A718700
       LXD     .BNIFN,4       LOAD IT.                                  5A718800
       SXD     .FRTG.+1,4     INSERT IT IN THE FORTAG WORK AREA.        5A718900
SSH10  TEST    TFT,SSH30      DOES THE FORTAG TABLE EXIST, NO.          5A719000
SSH20  NXTSMP  TFT,.FRTG.+1,.C2ADD  $SEND ENTRY TO FORTAG TABLE,OBTAIN  5A719100
       TRA     *+2            POINTER.                                  5A719200
       REM                                                              5A719300
       REM          SSCAN CALLED BY ARITHMETIC TRANS. RETURN POINTER    5A719400
       REM          TO FORTAG WORK AREA.                                5A719500
       REM                                                              5A719600
SSH02  CLA     SSFTG                                                    5A719700
       STA     .FRTG.         FORTAG TABLE/WORK AREA POINTER TO ACC     5A719800
       TRA     SSAVE          AND TO CALLER.                            5A719900
SSH30  START   TFT            START FORTAG TABLE.                       5A720000
       TRA     SSH20          INSERT ENTRY.                             5A720100
       REM                                                              5A720200
       REM       THE SUBSCRIPT COMBINATION HAS BEEN FOUND TO BE         5A720300
       REM       COMPOSED OF CONSTANT FACTORS. A SUBAK ENTRY ONLY       5A720400
       REM       HAS BEEN GENERATED. RETURN ITS POINTER TO THE CALLER   5A720500
       REM                                                              5A720600
SSH03  CLA     .SUBK.                                                   5A720700
       SSM                    NEGATIVE ACC INDICATES SUBAK RETURN.      5A720800
SSAVE  AXT     **,4           RESTORE .NAMEP TO WHAT IT WAS UPON ENTRY. 5A720900
       SXA     .NAMEP,4                                                 5A721000
       LXD     SSENP,4        DITTO FOR .NAMEC.                         5A721100
       SXA     .NAMEC,4                                                 5A721200
SSRXR  AXT     **,1           RESTORE REGISTERS.                        5A721300
       AXT     **,2                                                     5A721400
       AXT     **,4                                                     5A721500
       LDI     SSIND          RESTORE INDICATORS.                       5A721600
       STZ     SS.AT          RESET SWITCH USED BY ARITH. TRANS.        5A721700
       STZ     SS.SA          RESET SWITCH USED BY STORAGE ALLOCATOR.   5A721800
       TRA     1,4           *RETURN TO CALLER.                         5A721900
       REM                                                              5A722000
       REM                     SCANNER ERROR ROUTINE                    5A722100
       REM                                                              5A722200
SSERR  TESTP   ((.CRPRN,SSERB),(.CENDM,SSERB)),SSERA                    5A722300
SSERA  GETBCI  SSERR,SSERR,SSERR                                        5A722400
SSERB  ZAC                    SET ERROR FLAG IN ACCUMULATOR.            5A722500
       TRA     SSAVE          RETURN TO CALLER.                         5A722600
       EJECT                                                            5A722700
       SPACE   3                                                        5A722800
       REM                                                              5A722900
       REM     THIS ROUTINE PROCESSES THE ADDEND/COEFICIENT             5A723000
       REM     IN THE ACC. THE PROCESS IS CARRIED THROUGH               5A723100
       REM     THE BUILDING OF THE PROLG1 TBL. THE ENTRY IS             5A723200
       REM     CHECKED FOR UNIQUENESS AND ENTERED IN THE TABLE          5A723300
       REM     IF IT IS.                                                5A723400
       REM                                                              5A723500
       REM     *********************************************************5A723600
       SPACE   4                                                        5A723700
SSPG1  SXA     SSPSV,4        SAVE LINKAGE.                             5A723800
       STZ     SS.E1          RESET TEMPORARY ERASABLE CELL.            5A723900
       LXA     SSEMT,4        SET IT WITH THE PRODUCT OF LEADING        5A724000
       REM                    CONSTANT DIMENSIONS.                      5A724100
       SXA     SS.E1,4                                                  5A724200
       XCA                    ACC TO MQ FOR MULTIPLICATION.             5A724300
       MPY     SS.E1                                                    5A724400
       XCL                    EXCHANGE REGISTERS.                       5A724500
       STZ     SS.E1          RESET TEMPORARY CELL.                     5A724600
       STA     SPWP1          PRODUCT TO PROLG1 WORK AREA               5A724700
       ARS     2              SHIFT SIGN TO BIT 2 .                     5A724800
       STP     SS.E1          SAVE SIGN OF PRODUCT.                     5A724900
       CAL     SSEPD          OR PROD CELL IN.                          5A725000
       ORS     SPWP1                                                    5A725100
       CAL     SPWP1          MASK OUT BITS 1,2                         5A725200
       ANA     SS.M2                                                    5A725300
       SLW     SS.E2          SAVE TEMPORARILY                          5A725400
       OPEN    TP1,SSP03     $OPEN PROLG1 TABLE,TO SSP03 IF NON-EXISTANT5A725500
SSP00  NXTGMP  TP1,SSELC,.C2ADD,SSP04  GET FIRST/NEXT ENTRY OF PROLG1,  5A725600
       REM                            TO SSP04 IF END MARK.             5A725700
       CAL     SSELC          PICK UP WORD 1 OF THIS ENTRY.             5A725800
       ANA     SS.M2          MASK OUT BITS 1,2                         5A725900
       LAS     SS.E2          COMPARE AGAINST CURRENT ENTRY.            5A726000
       TRA     SSP00         *NO                                        5A726100
       TRA     SSP01         *YES                                       5A726200
       TRA     SSP00         *NO                                        5A726300
SSP01  CAL     SSELC          ENTRY IS NOT UNIQUE, IS BIT 1 ON.         5A726400
       ALS     1                                                        5A726500
       PBT                                                              5A726600
       TRA     SSP02         *NO, BIT 1 IS OFF.                         5A726700
       TRA     SSPSV         *YES,BIT 1 IS ON, RETURN TO CALLER.        5A726800
SSP02  ARS     1              ADJUST WORD 1.                            5A726900
       ORA     SSD.G          SET BIT 1 ON.                             5A727000
       SLW     SSELC          SET WORD 1 BACK IN COMMUNICATIONS CELLS.  5A727100
       LXA     .DCELL,4       UPDATE D. CELL.                           5A727200
       TXI     *+1,4,1                                                  5A727300
       SXA     .DCELL,4                                                 5A727400
       SXA     SSELC+1,4      N OF D.CELL TO PROLG1,WORD 2.             5A727500
       JB2     TP1,SSP05     $BACK UP 2 POSITIONS IN TP1.               5A727600
SSP05  NXTSM   TP1,SSELC,.C2ADD   $OUTPUT PROLG1 WORK AREA.             5A727700
SSPSV  AXT     **,4           RESTORE LINKAGE                           5A727800
       TRA     2,4            RETURN.                                   5A727900
SSP03  START   TP1            PROLG1 TBL IS NON-EXISTANT, CURRENT ENTRY 5A728000
       CLOSE   TP1            ENTRY IS UNIQUE , START TABLE,AND INSERT  5A728100
       TRA     SSP00          ENTRY                                     5A728200
SSP04  LXA     SSPSV,4       *END MARK HIT, RETURN AT 1,4               5A728300
       TRA     1,4                                                      5A728400
       EJECT                                                            5A728500
       REM     THIS ROUTINE PROCESSES THE PROLG2 ENTRY BUILT            5A728600
       REM     UP IN THE PROLG2 WORK AREA- SPWP2. THE ENTRY             5A728700
       REM     IS CHECK FOR UNIQUENESS. RETURN IS EFFECTED              5A728800
       REM     AT 1,4 IF THE ENTRY IS DETERMINED TO BE A                5A728900
       REM     DUPLICATE (NON-UNIQUE) AND TO 2,4 IF IT IS               5A729000
       REM     NOT A DUPLICATE ( UNIQUE ). IN THE LATTER CASE,          5A729100
       REM     THE ENTRY IS MADE IN THE PROLG2 TABLE.                   5A729200
       SPACE   2                                                        5A729300
       REM     *********************************************************5A729400
       SPACE   3                                                        5A729500
       REM     *** SSPG2 ***                                            5A729600
       SPACE   5                                                        5A729700
SSPG2  SXA     SSGSV,1        SAVE REGISTERS.                           5A729800
       SXA     SSGSV+1,4                                                5A729900
       OPEN    TP2,SSG09     $OPEN PROLG2 TABLE, TO SSG09 IF NON-EXISTS.5A730000
SSG01  NXTGL   TP2,SSG07     $GET FIRST WORD OF FIRST/NEXT ENTRY OF TP2.5A730100
       STA     SS.A2          SAVE D.N IN CASE ENTRY IS A DUPLICATE.    5A730200
       ANA     SS.M5          MASK OUT ADDRESS PORTION                  5A730300
       LAS     SPWP2          COMPARE TO PROLG2 WORK AREA, WORD 1.      5A730400
       TRA     SSG02          NO COMPARE.                               5A730500
       TRA     SSG03          COMPARE.                                  5A730600
SSG02  ANA     .MTAGF         WORD 1 DOES NOT MATCH                     5A730700
       ALS     3              ISOLATE AND SHIFT TAG (WORD COUNT)        5A730800
       PDX     ,4             TO DECREMENT AND SET IT IN THE TABLE      5A730900
       SXA     SS.A1,4        MACRO PARAMETER.                          5A731000
       JFN     TP2,SS.A1,SSER8 ADVANCE PROLG2 OVER REMAINING WORDS.     5A731100
       TRA     SSG01          GO RETRIEVE NEXT ENTRY FOR COMPARISON.    5A731200
       REM                                                              5A731300
       REM                    FIRST WORD COMPARES, ALL FOLLOWING WORDS  5A731400
       REM                    MUST BE TESTED BEFORE ENTRY CAN BE        5A731500
       REM                    DETERMINED TO BE UNIQUE OR A DUPLICATE.   5A731600
       REM                                                              5A731700
SSG03  AXT     0,4            INITIALIZE COUNTER OF WORDS THAT MATCH.   5A731800
       PXA     ,1             COUNT TO ACC.                             5A731900
       PAX     ,2             COUNT ALSO TO IR 2.                       5A732000
       ADM     SSP2P          COMPUTE A REFERENCE ADDRESS               5A732100
       STA     SSG05          TO PROLG2 WORK AREA, WORD 2.              5A732200
       STA     SSG06                                                    5A732300
SSG04  SXA     SSG50,4        SAVE IR 4.                                5A732400
       NXTGL   TP2,SSER8      PICK UP NEXT WORD OF PROLG2, LOGIC ERROR  5A732500
SSG50  AXT     **,4           IF END OF TABLE HIT, RESTORE IR 4.        5A732600
SSG05  LAS     **,2           DOES IT MATCH.                            5A732700
       TRA     *+2           *NO, BUT MUST RETRIEVE NEXT WORD ANYWAY.   5A732800
       TXI     *+1,4,1       *YES, UPDATE COUNTER OF MATCHED WORDS.     5A732900
       TIX     SSG04,2,1     *NO, ALL DONE YET, NO.                     5A733000
       SXD     *+1,4          YES, DETERMINE IF ALL WORDS COMPARED.     5A733100
       TXH     SSG01,1,**     DO THEY, NO.                              5A733200
SSG06  STZ     **,1          *YES, ZERO OUT WORK AREA, WORD 2 AND ON    5A733300
       TIX     *-1,1,1        AND DISREGARD ENTRY.                      5A733400
       LXA     SS.A2,2        LOAD N FROM DUPLICATED PROLG2 ENTRY.      5A733500
       STL     SSP2D          SET SWITCH INDICATING DUPLICATION         5A733600
       TRA     SSGSV         *RETURN TO CALLER.                         5A733700
       REM                                                              5A733800
       REM                                                              5A733900
       REM                    EM ENCOUNTERED IN PROLG2 TBL, ENTRY IS    5A734000
       REM                    UNIQUE, ENTER IT IN THE PROLG2 TABLE.     5A734100
       REM                                                              5A734200
SSG07  LXA     .DCELL,2       FIRST UPDATE D. CELL.                     5A734300
       TXI     *+1,2,1                                                  5A734400
       SXA     .DCELL,2                                                 5A734500
       SXA     SPWP2,2        N FROM D.CELL TO PROLG2 WORK AREA, WORD 1.5A734600
       TXI     *+1,1,1        ADJUST COUNT OF WORDS FOLLOWING WORD 1.   5A734700
       SXA     SS.A1,1        SET N IN COUNT PARAMETER OF TABLE MACRO.  5A734800
       NXTSM   TP2,SPWP2,SS.A1  $OUTPUT PROLG2 ENTRY.                   5A734900
       CLOSE   TP2            INSERT EM.                                5A735000
       TXI     *+1,1,-1       ADJUST COUNT.                             5A735100
       PXA     ,1             COMPUTE A REFERENCE                       5A735200
       ADM     SSP2P          ADDRESS TO PROLG2 WORK                    5A735300
       STA     *+1            AREA, WORD 2.                             5A735400
       STZ     **,1           CLEAR WORK AREA, WORD 2 AND ON.           5A735500
       TIX     *-1,1,1                                                  5A735600
       STZ     SSP2D          RESET DUPLICATION SWITCH.                 5A735700
SSGSV  AXT     **,1           *RETURN.                                  5A735800
       AXT     **,4                                                     5A735900
       NZT     SSP2D          UNIQUE OR NOT.                            5A736000
       TRA     2,4           *UNIQUE.                                   5A736100
       TRA     1,4           *NOT.                                      5A736200
SSG09  START   TP2            PROLG2 IS NON-EXISTANT, CORRECT THIS      5A736300
       CLOSE   TP2            CONDITION AND INSERT END MARK.            5A736400
       TRA     SSG01        TRANSFER BACK TO PULL OUT FIRST WORD.       5A736500
       EJECT                                                            5A736600
       REM     THIS ROUTINE REORDERS THE TAU1,2-SCRIPT                  5A736700
       REM     WORK AREA.  THE RESULTING WORK AREA WILL                 5A736800
       REM     BE IN ALGEBRAIC DESCENDING ORDER.                        5A736900
       REM                                                              5A737000
       REM                                                              5A737100
       REM     **  SSROTS  **                                           5A737200
       SPACE   4                                                        5A737300
       REM     *********************************************************5A737400
       SPACE   3                                                        5A737500
SSROTS SXA     SSRSV,4        SAVE LINKAGE                              5A737600
SSR00  TIX     *+2,1,1        ADJUST CONTROLLING INDEX.                 5A737700
       TRA     SSRSV          SORT COMPLETE WHEN IR1 HAS DECREMENTED TO15A737800
       PXA     ,1             CONTROLLING INDEX TO MOVING INDEX.        5A737900
       PAX     ,2                                                       5A738000
       AXT     0,4            INITIALIZE REFERENCE INDEX.               5A738100
SSR01  CLA     STWTS,4        MOVING LOOP (1ST/NEXT PASS)               5A738200
       LDQ     STWTS+1,4                                                5A738300
       TLQ     SSR03                                                    5A738400
SSR02  STO     STWTS+1,4      EXCHANGE SEQUENCE.                        5A738500
       STQ     STWTS,4                                                  5A738600
SSR03  TXI     *+1,4,-1       UPDATE SEQUENCE.                          5A738700
       TIX     SSR01,2,1      BACK FOR MORE COMPARISON.                 5A738800
       TRA     SSR00          RE-INITIALIZE FOR ANOTHER PASS.           5A738900
SSRSV  AXT     **,4           RESTORE LINKAGE.                          5A739000
       TRA     1,4           *RETURN.                                   5A739100
       EJECT                                                            5A739200
       REM                                                              5A739300
       SPACE   2                                                        5A739400
       REM     ** SSOPTS **                                             5A739500
       REM                                                              5A739600
       REM     THIS ROUTINE OPTIMIZES THE TAU1,2-SCRIPT WORK            5A739700
       REM     AREA. DUPLICATE SUB-ENTRIES ARE CONDENSED TO             5A739800
       REM     ONE UNIQUE WORD (EQUAL VARIABLES). ADDITIONAL            5A739900
       REM     PROLG2 ENTRIES ARE GENERATED WHEN CALLED FOR.            5A740000
       SPACE   2                                                        5A740100
       REM     *********************************************************5A740200
       SPACE   3                                                        5A740300
SSOPTS SXA     SSOSV,1        SAVE LINKAGE.                             5A740400
       SXA     SSOSV+1,2                                                5A740500
       SXA     SSOSV+2,4                                                5A740600
       REM               INITIALIZATION                                 5A740700
       AXT     0,4            REFERENCE INDEX, TAU1,2-SCRIPT WORK AREA. 5A740800
       STZ     SSRPT          REPEAT SWITCH.                            5A740900
       STZ     SSDIS          D.N OR DI ENCOUNTERED SWITCH.             5A741000
       AXT     0,2            REFERENCE INDEX, SUB-ENTRY WORK AREA.     5A741100
       STZ     SSNCL          INTERMEDIATE COUNTER                      5A741200
       LXA     SSETC,1        NO. OF WORDS IN STWTS - 1.                5A741300
       TXI     *+1,1,1                                                  5A741400
       STZ     SSICL                                                    5A741500
       SXA     SSICL,1        TO I CELL.                                5A741600
       STZ     SPWP2          CLEAR PROLG2 WORK AREA, WORD 1 IN CASE    5A741700
       REM                    WE HAVE TO GENERATE ADDITIONAL PROLG2.    5A741800
       REM                                                              5A741900
       REM            MAIN LOOP                                         5A742000
       REM                                                              5A742100
SSO00  CAL     STWTS,4        COMPARE STWTS(FIRST/NEXT) WITH STWTS(FIRST5A742200
       LDI     STWTS+1,4      /NEXT + 1)                                5A742300
       IIA                                                              5A742400
       OFT     .MDECR         DO THE DECREMENTS COMPARE (NAME POINTERS) 5A742500
       TRA     SSO03         *NO.                                       5A742600
       NZT     SSRPT         *YES, IS THE REPEAT SWITCH ON.             5A742700
       SXA     SSJCL,4        NO, SAVE THIS REFERENCE POINT. (J CELL)   5A742800
       SLW     STTWT,2        YES, MOVE TO TEMPORARY WORK AREA          5A742900
       CAL     STWTS+1,4      NEXT WORD TOO.                            5A743000
       SLW     STTWT+1,2                                                5A743100
       TXI     *+1,2,-1       UPDATE INDEX TO THIS AREA.                5A743200
       ANA     .MTAGF         MASK OUT ALL BUT TAG.                     5A743300
       TZE     SSO01          IS THE TAG 0, INDICATING A NUMERIC CONST. 5A743400
       STL     SSDIS         *NO, SET SWITCH FOR PROLG2 GENERATION.     5A743500
       TRA     SSO02          CONTINUE BELOW.                           5A743600
SSO01  CAL     STTWT,2        SUM THE TWO NUMERIC CONSTANTS TOGETHER.   5A743700
       ANA     .MADDR         MASK OUT ALL BUT ADDRESS.                 5A743800
       ACL     STTWT-1,2      ADD PREVIOUS WORD, FLAGS AND ALL.         5A743900
       SLW     STTWT,2        TO TEMPORARY AREA.                        5A744000
       SLW     STWTS+1,4      TO TAU1,2-SCRIPT WORK AREA.               5A744100
       STZ     STWTS,4        CLEAR SUPERFLUOUS WORD IN TAU WORK AREA.  5A744200
       STZ     STTWT-1,2      ALSO IN TEMPORARY AREA.                   5A744300
SSO02  STL     SSRPT          SET REPEAT SWITCH.                        5A744400
SSO020 PXA     ,4             IS THERE MORE WORDS LEFT.                 5A744500
       SUB     SSICL                                                    5A744600
       TNZ     SSO04-1       *NO                                        5A744700
SSO03  ZET     SSRPT          IS THE REPEAT SWITCH SET.                 5A744800
       TRA     SSO04         *YES                                       5A744900
       PXA     ,4            *NO,ARE WE ALL DONE.                       5A745000
       SUB     SSICL                                                    5A745100
       TZE     SSO16          YES, XFER TO CONDENSATION PASS.           5A745200
       TXI     SSO00,4,-1     NO, RETURN FOR MORE.                      5A745300
SSO04  ZET     SSDIS          DO WE HAVE TO GENERATE A PROLG2 ENTRY     5A745400
       TRA     SSO06         *YES                                       5A745500
SSO05  STZ     SSRPT         *NO, RESET REPEAT SWITCH.                  5A745600
       TRA     SSO020                                                   5A745700
SSO06  AXC     1,1            INITIALIZE PROLG2 WORK AREA REFERENCE IR. 5A745800
       SXA     SSNCL,4        SAVE POINT OF REFERENCE TO STWTS IN NCELL.5A745900
SSO07  CAL     STTWT,2        PICK UP CURRENT WORD IN TEMP. WORK AREA.  5A746000
       PAI                    PLACE IN INDICATORS                       5A746100
       OFT     STCON          IS THE TAG 0.                             5A746200
       TRA     SSO15         *NO, IT MUST BE 4 OR 5.                    5A746300
       ALS     18            *YES, SHIFT NUMERIC CONSTANT TO DECR.      5A746400
       STD     SPWP2          SEND TO 1ST WD. OF PROLG2 ENTRY.          5A746500
       TXI     *+1,1,1        ADJUST PROLG2 INDEX (WORD COUNT)          5A746600
SSO08  CLA     SSNCL          IS J=N YET                                5A746700
       CAS     SSJCL                                                    5A746800
       TRA     *+2           *NO                                        5A746900
       TRA     SSO09         *YES                                       5A747000
       TXI     *+1,2,1       *NO, ADJUST INDECIS TO TEMP WORK AREA      5A747100
       ADD     .C1ADD         AND TAU WORK AREA, IR 2 AND N RESPECTIVELY5A747200
       STA     SSNCL                                                (15)5A747300
       ZET     STTWT,2        IS THE NEXT WORD IN STTWT EMPTY.          5A747400
       TXI     SSO07,1,-1    *NO, RETURN TO GENERATE MORE PROLG2.       5A747500
SSO09  PXD     ,1            *YES, COMPLETE PROLG2 BOOKEEPING.          5A747600
       PDC     ,1                                                       5A747700
       PXD     ,1             PROLG2 WORK AREA INDEX AND WORD COUNT MUST5A747800
       ARS     3              BE INSERTED IN PROLG2, WORD 1, TAG.       5A747900
       STT     SPWP2          FORCE TAG TO THE ONE JUST COMPUTED.       5A748000
       ORA     SSP12          BITS 1,2 ARE ALWAYS ON.                   5A748100
       ORA     SPWP2          PROLG2 WORK AREA, WORD 1.                 5A748200
       ANA     SS.M5          LEAVE EVERYTHING BUT ADDRESS.             5A748300
       SLW     SPWP2          SET LOGICAL ACC IN PROLG2 WORK AREA.      5A748400
       SXA     SSO10,4        SAVE IR4 AROUND CALL.                     5A748500
       SXA     SSO12,4        DITTO.                                    5A748600
       TSX     SSPG2,4       $PROCESS PROLG2 WORK AREA.                 5A748700
       TRA     SSO12         *DUPLICATE RETURN.                         5A748800
SSO10  AXT     **,4          *UNIQUE RETURN, RESTORE IR4.               5A748900
       CLA     SPWP2          PICK UP NEWLY ASSIGNED D.N FROM PROLG2,WD15A749000
SSO11  STA     STWTS,4        REPLACE ADDRESS OF LAST TAU WORD WITH IT. 5A749100
       TRA     SSO13          CONTINUE BELOW.                           5A749200
SSO12  AXT     **,4          *DUPLICATE, RESTORE IR 4.                  5A749300
       PXA     ,2             D.N OF DUPLICATED ENTRY IS IN IR 2.       5A749400
       TRA     SSO11          D.N REPLACES ADDRESS IN TAU WORK AREA.    5A749500
SSO13  STZ     SSDIS          PROLG2 GENERATION COMPLETE, RESET SWITCH. 5A749600
       SPACE   2                                                        5A749700
       REM     THE FOLLOWING SEQUENCE OF INSTRUCTIONS CLEARS (ZEROS)    5A749800
       REM     ALL THE WORDS IN THE TAU1,2-SCRIPT WORK AREA PRECEDING   5A749900
       REM     THE CURRENT POSITION IN THE TABLE POINTED TO BY IR 4 UP  5A750000
       REM     TO AND INCLUDING THE WORD POINTED TO BY J (UPPER BOUND). 5A750100
       SPACE   2                                                        5A750200
       LAC     SSJCL,1        LOAD UPPER BOUND.                         5A750300
       SXD     SSO14,1        SET IT IN COMPUTATIONAL INSTRUCTION.      5A750400
       PXA     ,4             COMPUTE THE NUMBER                        5A750500
       PAC     ,2             OF WORDS THAT                             5A750600
SSO14  TNX     *+1,2,**       MUST BE CLEARED.                          5A750700
       LXA     SSJCL,1        RELOAD UPPER BOUND FOR REFERENCE.         5A750800
       STZ     STWTS,1        CLEAR FIRST/NEXT SUPERFLUOUS WORD.        5A750900
       TXI     *+1,1,-1       UPDATE REFERENCE INDEX.                   5A751000
       TIX     *-2,2,1        ALL DONE YET, NO.                         5A751100
       AXT     8,1           *YES, CLEAR PROLG2 WORK AREA               5A751200
       STZ     SPWP2+8,1                                                5A751300
       TIX     *-1,1,1                                                  5A751400
       TRA     SSO05          XFER TO TEST IF WERE FINISHED AND RESET   5A751500
       REM                    THE REPEAT SWITCH.                        5A751600
SSO15  RNT     STDIP         *WAS A TAG OF 4 OR 5 FOUND IN THE TEMP. WA.5A751700
       RIL     STPDN         *4, ZERO OUT SIGN (BIT P IN SI).           5A751800
       IIL     STPDI         *5, TURN BIT 1 OF SI ON. (PFX OF 6 IF TAG  5A751900
       REM                    IS 5, PFX. OF 2 IF TAG IS 4.).            5A752000
       RIR     STTDN          WHATEVER THE TAG IS, MAKE SURE ITS 4.     5A752100
       PIA                    TO ACC.                                   5A752200
       STT     STWTS,4        FORCE TAG OF CURRENT POSITION IN TAU TO 4.5A752300
       STP     SPWP2,1        PREFIX OF ACC CONTAINS APPROPRIATE CODE.  5A752400
       ALS     18                                                       5A752500
       STD     SPWP2,1        ADDRESS CONTAINS CORRECT DECR OF PROLG2.  5A752600
       TRA     SSO08         *XFER TO TEST IF WERE READY FOR PROLG2     5A752700
       REM                    GENERATION.                               5A752800
       REM                                                              5A752900
       REM             COMPRESS OPTIMIZED TAU1,2-SCRIPT WORK AREA       5A753000
       REM             BY ELIMINATING ZERO WORDS.                       5A753100
       REM                                                              5A753200
SSO16  AXT     0,1            INITIALIZE REFERENCE (REPOSITIONING) INDEX5A753300
       TXI     *+1,4,-1       ADJUST REFERENCE INDEX (ACCESS) TO YIELD  5A753400
       SXA     *+1,4          NUMBER OF WORDS IN STWTS.                 5A753500
       AXC     **,4           COMPLEMENT TO POSITIVE VALUE              5A753600
       SXD     SSO19,4        SET IN INCREMENT INSTRUCTION FOR ZERO PASS5A753700
       PXA     ,4             COMPUTE A REFERENCE ADDRESS.              5A753800
       ADM     SSTSP                                                    5A753900
       STA     SSO20          INITIALIZE ADDRESSES OF LOOP WITH IT.     5A754000
       STA     *+1                                                      5A754100
       CLA     **,4           PICK UP FIRST/NEXT WORD.                  5A754200
       TNZ     SSO18          IS IT EMPTY, NO.                          5A754300
SSO17  TIX     *-2,4,1       *YES, ALL DONE YET, NO.                    5A754400
       TRA     SSO19          YES, CONTINUE BELOW.                      5A754500
SSO18  STO     STWTS,1        THE WORD IS NOT EMPTY, RE-POSITION IT.    5A754600
       TXI     SSO17,1,-1     UPDATE THE RE-POSITIONING REFERENCE INDEX 5A754700
       REM                    AND XFER TO TEST IF WERE DONE.            5A754800
SSO19  TXI     *+1,1,**        ALL NON-EMPTY WORDS HAVE BEEN POSITIONED 5A754900
       SXA     *+1,1          UPWARDS, CLEAR WORDS FOLLOWING.           5A755000
       AXT     **,4                                                     5A755100
SSO20  STZ     **,4           CLEARING LOOP.                            5A755200
       TIX     *-1,4,1                                                  5A755300
       REM                                                              5A755400
       REM            OPTIMIZATION IS NOW COMPLETE                      5A755500
       REM                                                              5A755600
SSOSV  AXT     **,1           RESTORE REGISTERS.                        5A755700
       AXT     **,2                                                     5A755800
       AXT     **,4                                                     5A755900
       TRA     1,4           *RETURN TO CALLER.                         5A756000
       SPACE   4                                                        5A756100
       REM     .........................................................5A756200
       SPACE   2                                                        5A756300
       REM       ERASABLE AND CONSTANTS ETC. FOR SSCAN AND              5A756400
       REM                ASSOCIATED SUBROUTINES.                       5A756500
       SPACE   4                                                        5A756600
SSIND  PZE     0,0,0          INTERMEDIATE STORAGE FOR INDICATORS       5A756700
SSEMT  MZE     **,0,**        MULTIPLE CELL FOR PRODUCT OF CONSTANT     5A756800
       REM                    DIMENSIONS.                               5A756900
SSTMT  MZE     **,0,0         TEMPORARY MULTIPLE CELL, THE CONTENTS OF  5A757000
       REM                    WHICH REFLECTS THE PRODUCT OF ANY LEADING 5A757100
       REM                    CONSTANT DIMENSIONS (SSEMT) AND ANY       5A757200
       REM                    EXPLICIT COEFICIENT ASSOCIATED WITH A     5A757300
       REM                    PARTICULAR SC ELEMENT.                    5A757400
SS..1  SYN     *                                                        5A757500
       ORG     O.CME2                                                   5A757600
SSEKA  PZE     **,0,0         CONSTANT ADDEND CELL.                     5A757700
SS.DC  PZE     0,0,0          DOUBLE PRECISION/COMPLEX ARITHMETIC SWITCH5A757800
SSETC  PZE     **,0,0         TAU1,2-SCRIPT WORK AREA INDEX AND COUNTER.5A757900
SSEPD  PZE     **,0,**       PRODUCT OF VARIABLE DIMENSIONS CELL.       5A758000
SSEPC  PZE     **,0,0         PROLG2 WORK AREA INDEX AND COUNTER.       5A758100
SSENP  PZE     0,0,**        INTERMEDIATE STORAGE FOR NAMEP(A).         5A758200
       SPACE   2                                                        5A758300
SSWDM  BSS     8              DIMENSION TABLE WORK AREA.                5A758400
SS.1.  SYN     *                                                        5A758500
       ORG     SS..1                                                    5A758600
STWTS  BSS     7              TAU1,2-SCRIPT WORK AREA.                  5A758700
       SEVEN   -1,7,-1       DUMMY END OF WORK AREA.                    5A758800
SS..2  SYN     *                                                        5A758900
       ORG     SS.1.                                                    5A759000
SPWP2  BSS     8              PROLG2 WORK AREA.                         5A759100
STTWT  BSS     7              TEMPORARY WORK AREA FOR DUPLICATE         5A759200
       REM                    SUB-ENTRIES IN TAU1,2-SCRIPT - SSOPTS.    5A759300
ST2SR  BSS     8             TAU2-SCRIPT TEMPORARY AREA DURING DIVISION.5A759400
SPWP1  BSS     2             PROLG1 TBL WORK AREA.                      5A759500
SSELC  BSS     2             TR BUFFER COMMUNICATIONS CELLS.            5A759600
SSECI  PZE     **,0,0         COEFICIENT CELL.                          5A759700
SSEAI  PZE     **,0,0         ADDEND CELL.                              5A759800
SSEVI  PZE     **,0,0         VARIABLE CELL.                            5A759900
SSIGN  PZE     0,0,0          SWITCH INDICATING SIGN OF ADDEND AS IT    5A760000
       REM                    EXPLICITLY APPEARS IN THE SOURCE STATEMENT5A760100
SS.2.  SYN     *                                                        5A760200
       ORG     SS..2                                                    5A760300
SS.M1  PZE     -1,7,-1       MASK ISOLATING PREFIX IN INDICATORS        5A760400
SS.M2  MZE     -1,7,-1        MASK TO ERASE BITS 1,2 IN PROLG2 FOR TEST.5A760500
SS.M3  MZE     0,4,0        PREFIX AND TAG OF 4.                        5A760600
SS.M4  EQU     .MLEFT         MASK TO ERASE UNDESIRED T,A OF PROD CELL. 5A760700
SS.M5  SEVEN   0,7,-1         MASK TO ERASE ADDRESS.                    5A760800
SS.M6  SEVEN   -1,7,0         MASK TO ERASE DECREMENT.                  5A760900
SSSPD  EQU     .C1PFX         SIGN OF DECREMENT, PROLG2.                5A761000
SSD.G  EQU     .C2PFX         D. GENERATING ENTRY IN PROLG1/BIT1 ON IN  5A761100
       REM                    PROLG2 TABLE                              5A761200
STVDP  EQU     .C5TAG         FLAG FOR TAG OF TAU1,2-SCRIPT TO INDICATE 5A761300
       REM                    THAT ADDRESS CONTAINS VARIABLE DIM NAME.  5A761400
SSP12  EQU     .C3PFX         BITS 1,2 ON ALWAYS IN PROLG2, WORD 1.     5A761500
SSSNA  EQU     .C2TAG         FLAG IN TAG OF SUBAK INDICATIVE OF N, ADDR5A761600
STCON  EQU     .C7TAG         TESTS TAG OF TAU IN INDICATORS FOR A 0.   5A761700
STSB1  EQU     .C2PFX         BIT 1 ON IN TAU2 AND SCRIPT               5A761800
STDIP  RBOOL   100000         DI  IN ADDRESS OF TAU                     5A761900
STPDN  LBOOL   400000                                                   5A762000
STPDI  LBOOL   200000                                                   5A762100
SS.ETP PZE     0,**,0         ERASABLE FOR TAG AND SIGN OF CONSTANT     5A762200
                              ADDEND THAT GOES IN PROLG2, WORD 1.       5A762300
SSP2P  PZE     SPWP2+1        POINTER TO PROLG2 WORK AREA, WORD 2.      5A762400
SS..3  SYN     *                                                        5A762500
       ORG     SS.2.                                                    5A762600
SSP2D  PZE     0,0,0          SWITCH INDICATIVE OF PROLG2 DUPLICATION.  5A762700
SSRPT  PZE     0,0,0          REPEAT SWITCH IN OPTIMIZATION ROUTINE.    5A762800
SSDIS  PZE     0,0,0          D.N OR NAMEP(DI) IN TAU1,2-SCRIPT- SSOPTS.5A762900
SSNCL  PZE     **,0,0         N-CELL- INTERMEDIATE COUNTER IN SSOPTS    5A763000
SSICL  PZE     **,0,0         I-CELL- NO. OF WRODS IN STWTS-1 - SSOPTS. 5A763100
SS.3.  SYN     *                                                        5A763200
       ORG     SS..3                                                    5A763300
SSJCL  PZE     **,0,0         J-CELL- INTERMEDIATE REFERENCE POINT. OPTS5A763400
STTDN  RBOOL   100000         FORCE TAG OF 4 IN TAU.                    5A763500
SSTSP  PZE     STWTS          POINTER TO TAU1,2-SCRIPT WA.              5A763600
SSTP1  EQU     .CZERO         FLAG FOR PREFIX OF PROLG2 INDICATING      5A763700
       REM                    THAT THE DECREMENT CONTAINS A PROLG1 PTR. 5A763800
SSDOV  RBOOL   077777         MASK FOR TEST OF DO VARIABLE.             5A763900
STWT1  PZE     **             TEMPORARY STORAGE FOR TAU1 ENTRY.         5A764000
SSSGL  OCT     040000000000   BIT 3 ON IN TAU2 FOR DUPLICATED ENTRY.    5A764100
SSFTG  PZE     .FRTG.+1       POINTER TO FORTAG WORK AREA.              5A764200
SSBCI  PZE     0,0,0          BCI NAME OF SUBSCRIPTED VARIABLE.         5A764300
SSKA1  EQU     SSECI                                                    5A764400
SSKA2  EQU     SSEAI                                                    5A764500
SSKB1  RBOOL   200000        THIS BIT IS SET ON WHEN SCRIPT ITEM IS     5A764600
       REM                   DEFINED BY AN OUTER DO.                    5A764700
SS.E1  PZE     **,**,**       FULL WORD OF ERASABLE.                    5A764800
SS.E2  PZE     **,**,**       DITTO.                                    5A764900
SS.A1  PZE     **,0,0         ADDRESS ERASABLE.                         5A765000
SS.A2  PZE     **,0,0         DITTO.                                    5A765100
SSRPN  PZE     **             RIGHT PARENTHESIS ENCOUNTERED SWITCH.     5A765200
       SPACE   3                                                        5A765300
       REM     .........................................................5A765400
       SPACE   4                                                        5A765500
       REM          DIAGNOSTIC SECTION OF THE SUBSCRIPT PROCESSOR.      5A765600
       SPACE   2                                                        5A765700
SSER1  DIAGN   SS01I,SS01L,SS01D ILLEGAL PUNCT FOLLOWS NUMERIC CHARACTER5A765800
       TRA     SSERR          ERROR ROUTINE.                            5A765900
SS01I  MZE     SSBCI,,1       INSERT FOR ALL DIAGNOSTIC MESSAGES.       5A766000
SS01L  EQU     3                                                        5A766100
SSER2  DIAGN   SS01I,SS02L,SS02D NON-VARIABLE FOLLOWS.                  5A766200
       TRA     SSA08          RECOVER.                                  5A766300
SS02L  EQU     2                                                        5A766400
SSER3  EQU     SSER1                                                    5A766500
SSER4  DIAGN   SS01I,SS04L,SS04D                                        5A766600
       TRA     SSERR                                                    5A766700
SS04L  EQU     3                                                        5A766800
SSER6  DIAGN   SS01I,SS06L,SS06D     ELEMENT IS ABSENT.                 5A766900
       TRA     SSERR                                                    5A767000
SS06L  EQU     3                                                        5A767100
SSER7  DIAGN   SS01I,SS07L,SS07D   NO CLOSING RIGHT PAREN.              5A767200
       TRA     SSERR                                                    5A767300
SS07L  EQU     3                                                        5A767400
SSER8  DIAGN   SS02I,SS08L,DR02D,L                                      5A767500
SS02I  MZE     SSEMI,,1       INSERT TO ERROR 8.                        5A767600
SSEMI  BCI     1,TP2          PROLG2 BCI FOR ERROR 8.                   5A767700
SS08L  EQU     5                                                        5A767800
       SPACE   2                                                        5A767900
SSER9  DIAGN   SS01I,SS09L,SS09D                                        5A768000
       TRA     SSA04          RECOVER.                                  5A768100
SS09L  EQU     2                                                        5A768200
       SPACE   2                                                        5A768300
       REM     *********************************************************5A768400
       EJECT                                                            5A768500
       TTL     DIMPRO                                                   5A768600
       REM                                                              5A768700
       REM                                                              5A768800
       REM                                                              5A768900
       REM                    DIMPRO  ROUTINE                           5A769000
       REM                                                              5A769100
       REM                    THIS ROUTINE  COMPUTES THE PRODUCT OF THE 5A769200
       REM                    LEADING DIMENSIONS                        5A769300
       REM                     INPUT= DIMENSION TABLE  (TDM)            5A769400
       REM                     OUTPUT=DECREMENT FIELD OF TDM            5A769500
       REM                            DIMPRO ENTRY IF VARIABLE DIM      5A769600
       REM                    AUXILIARY  CELLS                          5A769700
       REM                    SZPRC =  DEC.  PROD OF CONSTANT DIM       5A769800
       REM                             ADD.  LAST  CONSTANT  DIM        5A769900
       REM                    SZPRV =  DEC.  LAST  VARIABLE DIM         5A770000
       REM                             ADD   PROD OF VARIABLE DIM       5A770100
       REM                                                              5A770200
 SZPDB SXA     SZPFN,4       . SAVE  INDEX  REGISTERS                   5A770300
       SXA     SZPX1,1                                                  5A770400
       SXA     SZPX2,2                                                  5A770500
       REM                                                              5A770600
       STZ     SZPRL                                                    5A770700
       CLA     .C1DEC                                                   5A770800
       STO     SZPRC                                                    5A770900
       STZ     SZPRV          CLEAR VARIABLE  PRODUCT CELL-SZPRV        5A771000
       REM                                                              5A771100
       REM                    INITIALIZATION  FOR THE SCAN OF TDM       5A771200
       REM                                                              5A771300
       LAC     .NAMEP,4                                                 5A771400
       LDI*    .NAMEP         LOAD FLAG WORD INTO INDICATORS.           5A771500
       TXI     *+1,4,-1                                                 5A771600
       CAL     ,4             TAKE TDM POINTER IN NAME  TABLE           5A771700
       ORA     .VDMPD                                                   5A771800
       SLW     ,4                                                       5A771900
       PDC     ,4                                                       5A772000
       TXL     SZPFN,4,0      IS THERE  A    POINTER  -NO               5A772100
       SXA     SZPBG,4        INITIALIZE THE ADDRESS OF THE SCAN        5A772200
       SXA     SZPBB,4        UPDATING OF TDM TABLE                     5A772300
       PDX     ,4             PLACE IT IN XR1                           5A772400
       REM                                                              5A772500
       REM                                                              5A772600
 SZPPR CLA     ,4             TAKE FIRST TDM  WORD-ENTRY                5A772700
       PDC     ,4             TAKE  COUNT OF WORDS FOLLOWING            5A772800
       SXD     SZPLS,4        PLACE IT IN THE END TEST INSTRUCTION      5A772900
       SXD     SZPDR,4                                                  5A773000
       AXT     0,1            INITIALIZE  THE COUNT OF VARIABLES        5A773100
       REM                                                              5A773200
       REM                    TEST IF IT IS A CONSTANT OR  VARIABLE DIM 5A773300
       REM                                                              5A773400
       REM                    INITIALIZE THE CELLS  FOR THE  PRODUCTS   5A773500
       REM                                                              5A773600
       REM                                                              5A773700
 SZPDI PAX     ,2             SAVE THIS DIMENSION                       5A773800
       ANA     .C4TAG         IS IT A VARIABLE DIMENSION                5A773900
       TZE     SZPCT         /NO-  IT IS A CONSTANT DIMENSION           5A774000
       TXH     SZPFR,1,0      IS IT THE FIRST  DIMENSION                5A774100
       BFT     .NCMLX+.NDBLP /YES - IS IT A COMPLEX OR D.P.ARRAY NAME   5A774200
       TRA     SZPDP          YES                                       5A774300
       TRA     SZPFR          NO                                        5A774400
 SZPDP LXD     .C2DEC,4       SET COEFFICIENT =2 IN SZPRV               5A774500
       SXD     SZPRV,4                                                  5A774600
       ORA     .C4PFX          SET  PREFIX =4 - MEANS DEC IS A POSITIVE 5A774700
       STP     SZPRV           INTEGER                                  5A774800
 SZPFR TXI     *+1,1,-1       INCREASE COUNT OF VARIABLES               5A774900
 SZPLS TXL     SZPFN,1,**     IS IT THE LAST WORD ENTRY - YES           5A775000
       LXD     SZPRV,4        IS IT THE 2ND   VARIABLE DIMENSION        5A775100
       TXL     SZPNV,4,0                                                5A775200
       SXA     SZPRV,2        SAVE THIS DIMENSION IN SZPRY-ADD          5A775300
       TRA     SZPOP                                                    5A775400
 SZPNV SXD     SZPRV,2        SAVE THIS DIMENSION IN SZPRV -DEC         5A775500
 SZPCH LXA     SZPRV,4        IS THERE A DIMPRO ENTRY TO DO-            5A775600
       TXL     SZPOQ,4,0      NO -THIS IS THE FIRST VARIABLE DIM.       5A775700
 SZPOP OPEN    TDP,SZPTB                                                5A775800
       REM                    CHECK FOR DUPLICATION IN DIMPRO           5A775900
       REM                                                              5A776000
 SZPMC NXTGL   TDP,SZPEN      TAKE NEXT FIRST WORD OF THE NEXT ENTRY    5A776100
       LAS     SZPRV          CHECK FOR DUPLICATION OF THIS PRODUCT     5A776200
       TRA     SZPMD                                                    5A776300
       TRA     SZPVI          THIS PRODUCT ALREADY EXISTS               5A776400
 SZPMD JF1     TDP,SZP03      MOVE POINTER TO NEXT WORD                 5A776500
       TRA     SZPMC          GO TO THE NEXT ENTRY                      5A776600
 SZPVI NXTGL   TDP,SZP03      TAKE THE RESULT ALREADY COMPUTED          5A776700
       PAX     ,2                                                       5A776800
       TRA     SZPOR                                                    5A776900
 SZPTB START   TDP            NO- ATTACH BUFFER TO DIMPRO TABLE         5A777000
       REM                    ENTRY  IN  DIMPRO TABLE                   5A777100
 SZPEN NXTSS   TDP,SZPRV      PUT SZPRV-CELL IN DIMPRO TABLE            5A777200
       LXA     .DCELL,2       INCREASE  CELL RESULT                     5A777300
       TXI     *+1,2,1                                                  5A777400
       SXA     .DCELL,2                                                 5A777500
       PXA     ,2             PLACE THE RESULT IN DIMPRO TABLE          5A777600
       NXTSL   TDP            PLACE  THE RESULT PRODUCT IN TABLE        5A777700
       CLOSE   TDP                                                      5A777800
       PXA     ,2             RESTAURE THE RESULT                       5A777900
 SZPOR ORA     .C4TAG         PUT TAG=4 FOR THE NEXT ENTRY              5A778000
       SLW     SZPRV          SAVE IT IN SZPRV CELL                     5A778100
       REM                                                              5A778200
       REM                                                              5A778300
       REM                                                              5A778400
       PXD     ,2                                                       5A778500
       ORA     .C2PFX         SET PRODUCT IS IN A SPECIAL CELL          5A778600
       TRA     SZPBB                                                    5A778700
 SZPOQ PXD     ,2                                                       5A778800
       ORA     .C4PFX         THIS IS A VARIABLE NAME                   5A778900
 SZPBB ORA     **,1           NO                                        5A779000
 SZPBG SLW     **,1           SAVE ALL THIS WORD IN TDM TABLE           5A779100
 SZPDR TXL     SZPFN,1,**    IS IT THE LAST WORD ENTRY  -               5A779200
       TRA     SZPDI          GO TO NEXT DIMENSION                      5A779300
       REM                    CONSTANT VARIABLE                         5A779400
 SZPCT TXH     SZPNC,1,0      IS IT THE FIRST DIMENSION - NO            5A779500
       BFT     .NCMLX+.NDBLP  YES- IS IT A D.P. ORCMPLX ARRAY           5A779600
       TRA     SZPFD          YES                                       5A779700
       TRA     SZPNC                                                    5A779800
 SZPFD LXD     .C2DEC,4       INITIALIZE THE PRODUCT =2 - DOUBLE PREC   5A779900
       SXD     SZPRC,4                                                  5A780000
 SZPNC TXI     *+1,1,-1       TAKE NEXT WORD                            5A780100
       SXA     SZPRC,2        SAVE THIS VARIABLE IN SZPRC-ADDRESS       5A780200
       REM                    NO                                        5A780300
       LDQ     SZPRC          PRODUCT OF CONSTANT DIMENSIONS            5A780400
       SLQ     SZPRL                                                    5A780500
       VLM     SZPRL,,18                                                5A780600
       TZE     SZP01          ERROR - PRODUCT =0                        5A780700
       LAS     .MADDR         IS THE PRODUCT GREATER THAN  2**15        5A780800
       TRA     SZP02          YES - ERROR                               5A780900
       TRA     SZP02          YES                                       5A781000
 SZPAD PAX     ,2                                                       5A781100
       SXD     SZPRC,2        UPDATE THE PRODUCT CELL                   5A781200
       PXD     ,2             SET THE RESULT IN AC                      5A781300
       TRA     SZPBB          GO TO TEST IF IT IS THE LAST ENTRY        5A781400
SZPFN  AXT     **,4           RETURN                                    5A781500
SZPX1  AXT     **,1                                                     5A781600
SZPX2  AXT     **,2                                                     5A781700
       TRA     1,4                                                      5A781800
       REM                                                              5A781900
SZPRC                         SAVE  CONSTANT  PRODUCT                   5A782000
SZPRV                         SAVE  VARIABLE  PRODUCT                   5A782100
 SZPRL                                                                  5A782200
       EJECT                                                            5A782300
       REM                      DIAGNOSTICS                             5A782400
       REM                                                              5A782500
       REM                                                              5A782600
       REM                                                              5A782700
       REM                                                              5A782800
       REM                    THE PRODUCT OF CONSTANT DIM IS NULL       5A782900
 SZP01 DIAGN   0,SZP1L,SZP1D                                            5A783000
       TRA     SZPFN                                                    5A783100
       REM                                                              5A783200
       REM                    THE PRODUCT OF CONSTANT DIM IS GT 2**15   5A783300
 SZP02 DIAGN   0,SZP2L,SZP2D                                            5A783400
       CLA     .MADDR                                                   5A783500
       TRA     SZPAD                                                    5A783600
       REM                                                              5A783700
       REM                    END OF  DIMPRO  TABLE - LOGICAL  ERROR    5A783800
 SZP03 DIAGN   0,SZP3L,SZP3D                                            5A783900
       TRA     SZPFN                                                    5A784000
SZP1L  EQU     2                                                        5A784100
SZP2L  EQU     2                                                        5A784200
SZP3L  EQU     5                                                        5A784300
       REM                                                              5A784400
       TTL     ** ERASABLE TABLE ROUTINE **                             5A784500
*                                                                       5A784600
*                 THIS ROUTINE WILL MAKE A NEW TABLE ENTRY OR LOCATE AN 5A784700
*              EXISTING ONE IN THE ERASABLE TABLE.-  UPON RETURN,       5A784800
*              THE ADDRESS OF THE AC CONTAINS A COMPLEMENTED POINTER    5A784900
*              TO THE ENTRY.-  THE INPUT IS EXPECTED IN RA.CEL -        5A785000
*                                                                       5A785100
*              CALLING SEQUENCE                                         5A785200
*                                 TSX   ENTTER,4                        5A785300
*                                 ...   NORMAL RETURN                   5A785400
*                                                                       5A785500
       SPACE   2                                                        5A785600
ENTTER SXA     RAZ12,4       .SAVE LINKAGE                              5A785700
       CAL     RA.CEL        GET INPUT.                                 5A785800
       ANA     .MLEFT         MASK OUT RIGHT HALF.                      5A785900
       SLW     RAZ20          SAVE LEFT HALF.                           5A786000
       TEST    TER,RAZ08                                                5A786100
       RESETQ  TER,TERST      RESET ERASABLE TABLE                      5A786200
RAZ05  NXTGL   TER,RAZ07     *GET AN EXISTING TABLE ENTRY.  IF END OF   5A786300
       ANA     .MLEFT         TABLE MAKE NEW ENTRY. MASK OUT RIGHT HALF.5A786400
       LAS     RAZ20          COMPARE WITH INPUT.                       5A786500
       TRA     RAZ05          DIFFERENT, READ NEXT                      5A786600
       TRA     RAZ10          EQUAL                                     5A786700
       TRA     RAZ05          DIFFERENT, READ NEXT                      5A786800
RAZ08  START   TER                                                      5A786900
RAZ07  NXTSSP  TER,RA.CEL     MAKE NEW ENTRY                            5A787000
       SLW     RAZ20          SAVE ENTRY POINTER.                       5A787100
       CLOSE   TER            SET END OF TABLE FLAG                     5A787200
       CAL     RAZ20          RESTORE ENTRY POINTER.                    5A787300
       TRA     RAZ12          AND RETURN                                5A787400
RAZ10  GETPTR  TER            GET POINTER OF EXISTING ENTRY             5A787500
RAZ12  AXT     **,4           AND RETURN                                5A787600
       TRA     1,4                                                      5A787700
RAZ20  PZE                                                              5A787800
       TTL     ** IFN ASSIGNATOR **                                     5A787900
       SPACE   2                                                        5A788000
       REM  -UIFNO - IFN ASSIGNATOR. RETURN 2'S COMPLEMENT POINTER      5A788100
       REM           TO THIS IFN ENTRY IN AC- AND SETS .BNIFN CELL TO   5A788200
       REM             TRUE POINTER TO IFN TABLE ,,VALUE OF IFN         5A788300
       SPACE   2                                                        5A788400
UIFNO  SXA     UIFNX,4       .SAVE XR4.                                 5A788500
UIF01  CLA     UIIFN          COMPUTE VALUE OF NEW IFN.                 5A788600
       ADD     .C1DEC         X                                         5A788700
       STO     UIIFN          X                                         5A788800
       STD     .BNIFN         SAVE IT IN DECR. OF .BNIFN.               5A788900
       NXTSLP  TIF           $ENTER IT IN IFN TABLE                     5A789000
       PAC     ,4             SAVE POINTER TO THIS ENTRY                5A789100
       SXA     .BNIFN,4       IN .BNIFN.                                5A789200
UIFNX  AXT     **,4           RESTORE XR4.                              5A789300
       TRA     1,4           *RETURN                                    5A789400
       SPACE   2                                                        5A789500
       TTL     ** CONSTANT ROUTINE **                                   5A789600
       REM       UCSTM - CONSTANT ROUTINE - MOVES CONSTANT FROM .OUTCH  5A789700
       REM             - REGION TO THE CONSTANT TABLE - CHECKS FOR      5A789800
       REM             - DUPLICATE CONSTANTS.                           5A789900
       SPACE   3                                                        5A790000
UCSTM  SXA     UCSTX,4        .SAVE LINKAGE.                            5A790100
       SXA     UCSTX+1,2      X                                         5A790200
       SXA     UCSTX+2,1      X                                         5A790300
       STI     UCSSI          SAVE SI.                                  5A790400
       LDI     .OUTFG         LOAD FLAG WORD.                           5A790500
       LNT     .NALPH         IS IT ALPHA.                              5A790600
       TRA     UC00S         *NO CHECK FOR DUPLICATE CONSTANT.          5A790700
       LXA     .OUTFG,2       YES,LOAD CHARACTER COUNT IN XR2.          5A790800
       TXH     *+4,2,0        IS H-COUNT ZERO.                          5A790900
       DIAGN   ,1,UC02D      *YES, DIAGNOSTIC.                          5A791000
       AXT     1,2                                                      5A791100
       ZAC                                                              5A791200
       AXT     0,1            XR1 WILL HAVE WORD COUNT.                 5A791300
       NXTSLP  TCN            ASK A NEW WORD IN TCN.                    5A791400
       STA     UCSAU          SAVE POINTER TO THIS NEW WORD.            5A791500
UCLOP  TNX     *+3,2,6        OBTAIN 6 CHARACTER OR LESS                5A791600
       AXT     6,4            X                                         5A791700
       TRA     *+4                                                      5A791800
       PXA     ,2             X                                         5A791900
       PAX     ,4             X                                         5A792000
       AXT     0,2                                                      5A792100
       SXA     *+2,4          X                                         5A792200
       GETNWB  **             AND MOVE THEM                             5A792300
       NXTSS   TCN,.OUTCH    $IN TCN.                                   5A792400
       TXI     *+1,1,1        INCREASE WORD COUNT.                      5A792500
       TXH     UCLOP,2,0                                                5A792600
UCTXW  TRA     UCCAA         *                                       (4)5A792700
       PXA     ,1             INTO FIRST                                5A792800
       ALS     27             WORD                                      5A792900
       ORA     .VALPH         OF THIS ENTRY.                            5A793000
       SLW     0,4            X                                         5A793100
UCTXX  CLOSE   TCN           $CLOSE TCN.                                5A793200
       CAL     UCSAU          LOAD AC WITH POINTER.                     5A793300
UCSTX  AXT     **,4           RESTORE LINKAGE.                          5A793400
       AXT     **,2           X                                         5A793500
       AXT     **,1           X                                         5A793600
       LDI     UCSSI          RESET SI.                                 5A793700
       TRA     1,4           *RETURN.                                   5A793800
UC00S  NOTEQ   TCN,UCSA1     $SAVE CURRENT POINTER IN TCN.              5A793900
       OPEN    TCN,UC06S     $PREPARE TO SCAN TCN.                      5A794000
UC02T  NXTGLP  TCN,UC06S     $OBTAIN THIS FLAG WORD.                    5A794100
       NOTEQ   TCN,UCSA2     $SAVE POINTER TO CURRENT WORD IN SCANNING. 5A794200
       LXA     TRPTR,2       NO,                                        5A794300
       ERA     .OUTFG         DOES IT MATCH.OUTFG.                      5A794400
       TZE     UC04T          YES                                       5A794500
       CAL     .OUTFG         ISIT  DP AGAINST REAL.                    5A794600
       ORA     0,2                                                      5A794700
       ERA     UCRAD                                                    5A794800
       TNZ     UC01S                                                    5A794900
UC04T  NNFGL   TCN,UC03A      DOES NEXT WORD                            5A795000
       ERA     .OUTCH         MATCH .OUTCH.                             5A795100
       TNZ     UC01S                                                    5A795200
       LFT     .NINTG+.NLOGL+.NOCTL                                     5A795300
       TRA     UC0MA         *IF INTEGER,LOGICAL,OCTAL,IT IS A MATCH.   5A795400
       NNFGL   TCN,UC03A      FOR OTHER                                 5A795500
       SLW     UCSA3          DOES THIS WORD MATCH .OUTCH+1.            5A795600
       ERA     .OUTCH+1                                                 5A795700
       TZE     UC1MA         *YES                                       5A795800
       LFT     .NCMLX                                                   5A795900
       TRA     UC01S                                                    5A796000
       CAL     UCSA3          NO- CHECK IF MANTISSA ARE ZERO            5A796100
       ORA     .OUTCH+1       IN CASE OF DP AGAINST REAL.               5A796200
       ALS     10                                                       5A796300
       TNZ     UC01S                                                    5A796400
UC1MA  CAL     0,2            UPDATE FLAG WORD IN CASE OF               5A796500
       ORA     .OUTFG         DP AGAINST REAL.                          5A796600
       SLW     0,2                                                      5A796700
UC0MA  RESETQ  TCN,UCSA1                                                5A796800
       PXA     ,2             SET POINTER IN AC.                        5A796900
       TRA     UCSTX         *RETURN.                                   5A797000
UC06S  RESETQ  TCN,UCSA1      NO MATCH - ENTER NEW CONSTANT             5A797100
       CAL     .OUTFG         IN CONSTANT TABLE                         5A797200
       NXTSLP  TCN                                                      5A797300
       STA     UCSAU                                                    5A797400
       NXTSS   TCN,.OUTCH                                               5A797500
       BFT     .NINTG+.NLOGL+.NOCTL                                     5A797600
       TRA     UCTXX         * GO EXIT.                                 5A797700
       NXTSS   TCN,.OUTCH+1                                             5A797800
       TRA     UCTXX         * GO EXIT.                                 5A797900
       REM                                                              5A798000
UC01S  LDI     0,2                                                      5A798100
       AXT     2,1            TWO WORDS TO SKIP.                        5A798200
       BFT     .NINTG+.NLOGL+.NOCTL                                     5A798300
       AXT     1,1            ONE WORD TO SKIP.                         5A798400
       BNT     .NALPH                                                   5A798500
       TRA     UCA1A         *IF ALPHA VARIABLE COUNT OF                5A798600
       CAL     0,2            WORDS.                                    5A798700
       ARS     27             X                                         5A798800
       PAX     ,1             X                                         5A798900
UCA1A  RESETQ  TCN,UCSA2      RESET TO CURRENT WORD.                    5A799000
UCA2A  NNFGL   TCN,UC03A      SKIP CORRECT NUMBER OF WORDS.             5A799100
       TIX     UCA2A,1,1      X                                         5A799200
       LDI     .OUTFG         RELOAD SI WITH FLAG WORD.                 5A799300
       TRA     UC02T                                                    5A799400
UC03A  TSX     DIAG,4        $UNEXPECTED END OF CONSTANT TABLE.         5A799500
       PZE     0,5,UC01D      X                                         5A799600
UCSSI  PZE     **             SAVE SI                                   5A799700
UCSAU  PZE     **             SAVE POINTER                              5A799800
UCRAD  PZE     ,,.NREAL+.NDBLP                                          5A799900
UCSA1  PZE     **             SAVE POINTER TO LAST WORD OF TCN.         5A800000
UCSA2  PZE     **             SAVE POINTER TO CURRENT WORD WHEN SCANING.5A800100
UCSA3  PZE     **             SAVE MANTISSA OF .OUTCH+1.                5A800200
       TTL *IBFTC V* *UTILITY ROUTINES* *NAME TABLE ROUTINE*            5A800300
       REM     NAME0 - NAME ROUTINE.                                    5A800400
       SPACE   1                                                        5A800500
       REM     ROUTINE ENTERS (OR LOCATES) THE NAME IN THE .OUTCH CELL  5A800600
       REM     IN THE NAME TABLE.  THE .OUTFG CELL IS UPDATED FROM THE  5A800700
       REM     NAME TABLE IF AN OLD NAME, OR THE FLAGS IN .OUTFG ARE    5A800800
       REM     ENTERED IN TO THE NAME TABLE IF A NEW NAME.              5A800900
       SPACE   1                                                        5A801000
       REM     THE CALLING SEQUENCE IS -                                5A801100
       SPACE   1                                                        5A801200
       REM                    TSX  NAME0,4                              5A801300
       REM                    TRA  REPLAC        REPLACE RETURN         5A801400
       REM                    ...  NORMAL RETURN                        5A801500
       SPACE   1                                                        5A801600
       REM     OR BY THE MACRO NAME.                                    5A801700
       SPACE   1                                                        5A801800
       REM     ROUTINE SETS -                                           5A801900
       REM                   .NAMEP - TRUE POINTER TO FLAG WORD.        5A802000
       REM                   .NAMEC - TWO'S COMPLIMENT POINTER          5A802100
       REM                             TO FIRST WORD OF ENTRY.          5A802200
       REM                    AC     - SAME AS .NAMEC, BUT MINUS IF     5A802300
       REM                             NEW ENTRY.                       5A802400
       SPACE   3                                                        5A802500
NAME0  SXA     NAMEX,4       .SAVE LINKAGE.                             5A802600
       ENTNAM  .OUTCH,NAME1  $LOCATE OR ENTER NAME IN NAME TABLE.       5A802700
       REM                    NEW NAME.                                 5A802800
       SSM                   /SET NEW FLAG IN AC.                       5A802900
       REM                    OLD NAME, FLAG IS PLUS.                   5A803000
NAME1  STA     .NAMEC         SAVE TWO'S COMPLIMENT POINTER.            5A803100
       PAC     ,4             GET TRUE ADDRESS                          5A803200
       TXI     *+1,4,.VFLAG   OF FLAG WORD FOR EASE OF UPDATING         5A803300
       SXA     .NAMEP,4       AND SAVE IT.                              5A803400
       TPL     NAME2         *NEW OR OLD NAME, OLD.                     5A803500
       SPACE   1                                                        5A803600
       REM                    NEW NAME, SET FLAGS IN NAME TABLE.        5A803700
       SPACE   1                                                        5A803800
       LDI     .OUTFG         LOAD THE ASSUMED FLAGS AND                5A803900
       STI*    .NAMEP         SET THEM IN THE ENTRY (ALSO SET SI).      5A804000
       TRA     NAMEX         *RETURN TO CALLER.                         5A804100
       SPACE   1                                                        5A804200
       REM                    OLD NAME, USE FLAGS IN NAME TABLE.        5A804300
       SPACE   1                                                        5A804400
NAME2  LDI*    .NAMEP        .LOAD NAME TABLE FLAGS AND                 5A804500
       STI     .OUTFG         SAVE THEM FOR USAGE.                      5A804600
       SPACE   2                                                        5A804700
       REM                    COMMON EXIT.                              5A804800
       SPACE   1                                                        5A804900
NAMEX  AXT     **,4           RESTORE LINKAGE.                          5A805000
       TRA     1,4           *RETURN TO CALLER.                         5A805100
       TTL     ** IN CORE DIAGNOSTIC **                                 5A805200
       SPACE   3                                                        5A805300
       REM                                                              5A805400
       REM       DIAG - DIAGNOSTIC ROUTINE -SETS THE CONDIG TABLE AND   5A805500
       REM            - THE LEVEL ERROR CELL FOR THE GENERAL CONTROL.   5A805600
       REM            - CALLING SEQUENCE   TSX DIAG,4                   5A805700
       REM                                 PZE A,B,C                    5A805800
       SPACE   3                                                        5A805900
DIAG   SXA     DIAGX,4        .SAVE LINKAGE.                            5A806000
       SXA     DIAGX+1,2      X                                         5A806100
       SXA     DIAGX+2,1      X                                         5A806200
       STZ     DG5LV          RESET LEVEL 5 SWITCH.                     5A806300
       LDC     CONDIG,1       XR1 HAS 2'S COMPLEMENT POINTER TO TOP OF  5A806400
       SXD     DG08M,1        CONDIG TABLE - INITIALIZE TEST OF OVERFLOW5A806500
       SXD     DG09M,1        OF CONDIG TABLE.                          5A806600
       CLA     1,4            LOAD ARGUMENT WORD.                       5A806700
       ANA     .MTAGF         CHECK FOR LEVEL S ERROR.                  5A806800
       ALS     3              X                                         5A806900
       PDX     ,1                                                       5A807000
       LXA     .XLEVL,2                                                 5A807100
       SXD     *+1,1                                                    5A807200
       TXH     *+2,2,**                 GENERAL CONTROL                 5A807300
       SXA     .XLEVL,1                                                 5A807400
       CLA     1,4                                                      5A807500
       TMI     *+6            SET LEVEL ERROR CELL                      5A807600
       LXA     DGPER,2        FOR IBJOB.                                5A807700
       SXD     *+1,1          X                                         5A807800
       TXH     *+7,2,**       X                                         5A807900
       SXA     DGPER,1        X                                         5A808000
       TRA     *+5            X                                         5A808100
       LXD     DGPER,2        X                                         5A808200
       SXD     *+1,1          X                                         5A808300
       TXH     *+2,2,**       X                                         5A808400
       SXD     DGPER,1        X                                         5A808500
       TXH     DGLV5,1,4      X LEVEL 5 STOP COMPILATION.               5A808600
DGPWH  LXA     FCPHAS,1       WHERE OCCURS THIS DIAG.                   5A808700
       TXL     DG21M,1,1                                                5A808800
       ZET     DGPBD          DIAGNOSTIC OCCURS IN PHASE B.             5A808900
       TRA     DG20M         *IT IS NOT THE FIRST DIAG IN PHASE B.      5A809000
       LAC     CONDIG,1                                                 5A809100
       CLA     CONDIG+1                                                 5A809200
       STA     3,1                                                      5A809300
       STL     DGPBD         1 AND SET THE SWITCH ON.                   5A809400
       TRA     DG20M         *                                          5A809500
DG21M  CLA     DGCON          IF DIAG OCCURS IN PHASEA PRINT OUT MESSAGE5A809600
       SXA     DG22M,4        SAVE XR4                                  5A809700
       ADD     .C1ADD                                                   5A809800
       STO     DGCON          DGCON IS THE COUNTER OF DIAG FOR A COMPIL.5A809900
       TSX     UNBCG,4        CONVERT THIS COUNT IN BCD.                5A810000
       SLW     DGCNT                                                    5A810100
       CALL    JOBOU(DG30M)    $PRINT OUT.                              5A810200
DG22M  AXT     **,4           RESET XR4.                                5A810300
DG20M  LAC     CONDIG+1,2     XR2 HAS NEXT AVAILABLE LOCATION IN CONDIG.5A810400
DG09M  TXL     DGOVF,2,**     HAS CONDIG OVERFLOWED.                    5A810500
       CAL     1,4            AC HAS ARGUMENT.                          5A810600
       PAC     ,1             XR1 WAS ADDRESS OF FIRST INSERT.          5A810700
       STP     0,2            PREFIX INDICATE MACHINE OR SOURCE ERROR.  5A810800
       STT     0,2            STORE ERROR LEVEL.                        5A810900
       ARS     18                                                       5A811000
       STA     0,2            STORE ERROR NUMBER.                       5A811100
       TXL     DG12M,1,0     *IS THERE ANY INSERT NO.                   5A811200
DG06M  CLA     0,1            YES,AC HAS FIRST PZE.                     5A811300
       SSP                     SET SIGN PLUS IN CASE OF AN MZE          5A811400
       STA     DGAUX          DGAUX HAS ADDRESS OF FIRST INSERT FOR THIS5A811500
       ARS     18             PZE.                                      5A811600
       ADD     DGAUX                                                    5A811700
       SUB     .C1ADD                                                   5A811800
       PAC     ,4             XR4 HAS ADDRESS OF LAST INSERT.           5A811900
       SXD     DG04M,4        INITIALIZE TEST.                          5A812000
       LAC     DGAUX,4                                                  5A812100
DG05M  TXI     *+1,2,-1       OBTAIN NEXT WORD OF CONDIG.               5A812200
DG08M  TXL     DGOVF,2,**                                               5A812300
       CAL     0,4                                                      5A812400
       SLW     0,2                                                      5A812500
DG04M  TXH     DG15M,4,**     IS IT THE LAST INSERT FOR THIS PZE        5A812600
       CLA     0,1            YES, WAS IT THE LAST SET OF INSERT        5A812700
       TMI     DG12M         *YES                                       5A812800
       TXI     DG06M,1,-1    *NO OBTAIN NEXT SET.                       5A812900
DG15M  TXI     DG05M,4,-1                                               5A813000
       REM                                                              5A813100
DG12M  PXA     ,2             XR2 HAS TRUE POINTER TO LAST              5A813200
       PAC     ,2             LOCATION OCCUPIED IN CONDIG.              5A813300
       PAC     ,1             XR1 HAS SAME THING.                       5A813400
       LAC     CONDIG+1,4     XR4 HAS FIRST LOCATION OCCUPIED BY        5A813500
       SXD     *+1,4                                                    5A813600
       TXI     *+1,2,**       XR2 HAS NUMBER OF INSERT FOR THIS MESSAGE.5A813700
       PXD     ,2                                                       5A813800
       STD*    CONDIG+1       SET IT IN CONDIG.                         5A813900
       TXI     *+1,1,1        SET NEXT AVAILABLE LOCATION IN CONDIG.    5A814000
       SXA     CONDIG+1,1     X                                         5A814100
DGEND  ZET     DG5LV          WAS LEVEL 5.                              5A814200
       TRA     DGLV6         *YES,                                      5A814300
DIAGX  AXT     **,4           NO, RESTORE                               5A814400
       AXT     **,2           XLINKAGE.                                 5A814500
       AXT     **,1           X                                         5A814600
       TRA     2,4                                                      5A814700
DGOVF  ZET     DGMESS         HAS MESSAGE ALREADY BEEN PRINTED.         5A814800
       TRA     DGEND          YES-                                      5A814900
       LXA     CONDIG+1,4     RESET TOP OF                              5A815000
       SXD     CONDIG,4       CONDIG TABLE.                             5A815100
       LAC     CONDIG,4                                                 5A815200
       CAL     .C1TAG                                                   5A815300
       STT     3,4                                                      5A815400
       STL     DGMESS         SET FLAG ON.                              5A815500
       TRA     DGEND         *                                          5A815600
DG30M  PZE     2                                                        5A815700
       TWO     DG31M,,4                                                 5A815800
       MZE     DGCNT,,1                                                 5A815900
DG31M  BCI     4,ERROR MESSAGE NUMBER                                   5A816000
DGLV5  STL     DG5LV         /SET FLAG LOGIC ERROR ON.                  5A816100
       CLA     1,4            IS IT A LOGICAL ERROR                     5A816200
       TPL     DGPWH          NO-                                       5A816300
       SXA     DGORG,4        SAVE ADDRESS OF CALL.                     5A816400
       REM     CONVERT IN BCD.                                          5A816500
       PCA     ,4             ADDRESS OF CALL.                          5A816600
       TSX     UNBCO,4                                                  5A816700
       SLW     DGLV9          X                                         5A816800
       ZET     PRSW           PRINT MESSAGE                             5A816900
       TRA     DGLV4          LOGIC ERROR                               5A817000
       TSX     MWR,4          ON LINE                                   5A817100
       PZE     2                                                        5A817200
       MZE     DGBC2,,9                                                 5A817300
       PZE     DGLV9,,1                                                 5A817400
DGLV4  CALL    JOBOU(DGLV8)   AND  OFF LINE.                            5A817500
DGORG  AXT     **,4                                                     5A817600
       TRA     DGPWH                                                    5A817700
DGLV6  LXA     FCPHAS,1         DOES THID HAPPENED IN PHASE B.          5A817800
       TXL     DGLV7,1,1       X                                        5A817900
       TSX     IXPBE,4         YES,REPOSITINE TAPES AND RETURN TO PHB.  5A818000
       TRA     XB06B           X                                        5A818100
DGLV7  TSX     XCCLS,4                                                  5A818200
       LAC     CONDIG,4       SET I/O WORD TO MINUS ZERO.               5A818300
       CAL     .C4PFX                                                   5A818400
       SLW     2,4                                                      5A818500
DGLV2  TSX     ULDFT0,4       REPOSITION INPUT TAPE TO NEXT COMPILATION.5A818600
       ZET     XCEIN          EOF OR $CARD NON IBFTC                    5A818700
       TRA     DG01S          NO                                        5A818800
       NZT     XCFTC          $IBFTC                                    5A818900
       TRA     DGLV2                                                    5A819000
DG01S  TSX     IXCTL,4        CLOSE FILES.                              5A819100
       MZE                    X                                         5A819200
       NZT     .PHING                                                   5A819300
       ZET     INPOP                                                    5A819400
       TRA     XC35L          NO                                        5A819500
       NZT     XCEIN          YES                                       5A819600
       TRA     XCRST         *                                          5A819700
       TRA     XC35L         *                                          5A819800
DGLV8  PZE     2                                                        5A819900
       TWO     DGBC2,,9                                                 5A820000
       MZE     DGLV9,,1                                                 5A820100
DGBC2  BCI     9,LOGIC ERROR-COMPILATION DELETED-CALLED FROM LOCATION.  5A820200
       REM                    IN PHASE B FOR THIS PROGRAM.              5A820300
DGCNT  PZE     **             COUNT OF ERROR IN PHASE A. IN BCD.        5A820400
DGAUX  PZE     **             TEMPORARY CELL.                           5A820500
DG5LV  PZE     **             NON ZERO IF IT IS A LEVEL 5 DIAG.         5A820600
DGLV9  PZE     **             CONTAINS BCD ADDRESS OF CALLING POINT.    5A820700
       SPACE   3                                                        5A820800
XCCLS  LXA     CONDIG+1,2      CLOSE CONDIG TABLE.                      5A820900
       CAL     .CONES          X                                        5A821000
       SXA     *+1,2           X                                        5A821100
       SLW     **              X                                        5A821200
       TXI     *+1,2,1         X                                        5A821300
       SXA     CONDIG+1,2      X                                        5A821400
       TRA     1,4                                                      5A821500
       LDIR                                                             5A821600
       LORG                                                             5A821700
       ORG     O.FGNP                                                (1)5A821701
FCPTC0 TSX     IXCLS,4                                               (1)5A821702
       TSX     CLOSE,4                                               (1)5A821703
       PTW     FC3FL                                                 (1)5A821704
       CLA     DGPER                                                 (1)5A821705
       TRA     FC05N+1                                               (1)5A821706
BCDPT1 STQ     .INCHR                                                (1)5A821707
       ZET     CBFSW                                                 (1)5A821708
       TRA     BCXAT                                                 (1)5A821709
       TRA     BCDPT0+1                                              (1)5A821710
OUCCAA BOOL    034301                                                (5)5A821712
UCCAA  CAL     .CONES         PLACE A WORD OF ALL SEVENS             (4)5A821716
       NXTSL   TCN            IN TCN.                                (4)5A821718
       LXA     UCSAU,4        SET WORD COUNT                         (4)5A82171A
       TXI     UCTXW+1,1,1    (INCREASED)                            (4)5A82171C
CB89T  ARS     30                                                    (5)5A82171E
       PAX     ,1                                                    (5)5A82171G
       TXL     CBOCT+1,1,7         IS DIGIT 8 OR 9                   (5)5A82171I
       ALS     18                  YES.                              (5)5A82171K
       TSX     BCZ00,1                                               (5)5A82171M
       TRA     CB36N                                                 (5)5A82171O
CBSGN  BNT     CBOMI               DOES - PRECEDE OCTAL DATA.        (5)5A82171Q
       TRA     CBH01                                                 (5)5A82171S
       CAL     .C4PFX              YES.                              (5)5A82171W
       ORS     .OUTCH              SET SIGN MINUS.                   (5)5A82171Y
CBH01  CLA     .VOCTL              NO.                               (5)5A821720
       TRA     CB309                                                 (5)5A821722
CBPTM  PDX     ,1                                                    (5)5A821724
       TXH     CB112,1,.CMINS      ILLEGAL AFTER O.                  (5)5A821726
       TXH     CBMIN,1,.CMINS-1 *DISTINGUISH PLUS FROM MINUS SIGN   (11)5A821728
CBS01  TXH     CBS02,4,0                                             (5)5A82172A
       REFILL                                                        (5)5A82172C
CBS02  ZAC                                                           (5)5A82172E
       CAQ     .BCCTB,1,1          INSPECT NEXT CHARACTER.           (5)5A82172G
       TXL     CBS04,1,0           IT IS BLANK.                      (5)5A82172I
       TXH     CBS03,1,6           ILLEGAL CHARACTER.                (5)5A82172K
       TXH     CB112,1,1                                             (5)5A82172M
       TXI     CBOCT,4,-1                                            (5)5A82172O
CBS03  TSX     BCZ00,1                                               (5)5A82172Q
CBS04  TXI     CBS01,4,-1                                            (5)5A82172S
CBMIN  SIB     CBOMI                                                 (5)5A82172U
       TRA     CBS01                                                 (5)5A82172W
CBOMI  RBOOL   400000                                                (5)5A82172Y
CBHPT  TXL     CB11N+1,1,H-1  TRANSFER IF NOT H.                     (8)5A821732
       CAL     XC.CR          GET CURRENT STATEMENT FLAG WORD.       (8)5A821734
       ANA     .C1TDC         IS CURRENT STATEMENT A DO.             (8)5A821736
       TNZ     CB11N+1        YES. H DOES NOT MEAN ALPHA CONSTANT    (8)5A821738
       TRA     CB07N         *NO. RETURN.                            (8)5A82173A
SSA12  RFT     CBPSW          HAS DECIMAL POINT BEEN ENCOUNTERED.    (8)5A82173C
       TRA     SSER1         *YES.ERROR                              (8)5A82173E
       TRA     SSA01         *NO. CONTINUE WITH NUMERIC PROCESSING.  (8)5A82173G
       ORG     O.CMPT                                                (8)5A82173I
SSB12  RFT     CBPSW          HAS DECIMAL POINT BEEN ENCOUNTERED.    (8)5A82173K
       TRA     SSER1         *YES. ERROR.                            (8)5A82173M
       TRA     SSB02         *NO. CONTINUE                           (8)5A82173O
       UNPNCH                                                           5A821800
       END                                                              5A821900
