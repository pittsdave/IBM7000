$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCSF                          3AF00000
$IBMAP .IOCSF  2800,()OK                                             $5$3AF00010
       TTL     .IOCSF - FORTRAN IOCS                                (12)3AF00020
       LBL     .IOF,BEGIN     .IOCSF                                 (7)3AF00025
*7090/7094 IOCS VERSION - 6 - (FORTRAN VERSION)                         3AF00030
       TITLE                                                            3AF00040
       SPACE   1                                                        3AF00050
*THIS IS IOCS VERSION -6- WHICH HAS BEEN PREPARED                       3AF00060
*  FROM THE DISTRIBUTED VERSION OF THE IOCS SYSTEM                      3AF00070
* HERE, IOCC IS PRESENTED AS A SET OF SUBROUTINES                       3AF00080
*  WHICH MAY BE USED BY ANY SYSTEM FOR BUFFERRED I/O.                   3AF00090
*  USE OF THE BASIC MONITOR AND EXECUTOR IS REQUIRED.                   3AF00100
*  REFER TO BASIC MONITOR AND IOCS MANUALS FOR                          3AF00110
*  DETAILED CONTENT AND RULES OF USEAGE.                                3AF00120
       SPACE   1                                                        3AF00130
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            3AF00140
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                3AF00150
       SPACE   1                                                        3AF00160
*SYSTEM PRINTER                                                         3AF00170
       SPACE   1                                                        3AF00180
*      PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10              3AF00190
EJECT  EQU     1                                                        3AF00200
       SPACE   1                                                        3AF00210
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       3AF00220
DBLSP  EQU     4                                                        3AF00230
       SPACE   1                                                        3AF00240
*SENSE SWITCHES                                                         3AF00250
       SPACE   1                                                        3AF00260
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 3AF00270
       SPACE   1                                                        3AF00280
NOHYP  EQU     0                   NO HYPERTAPE DEFINED IN IOCS         3AF00290
       SPACE   1                                                       $3AF00300
*END OF EQU CARDS TO BE DEFINED BY INSTALLATION.                        3AF00310
       TTL              IBSYS COMMUNICATION REGION                      3AF00320
IOEX   EQU     .ACTV                                                    3AF00330
(ACTIV EQU     IOEX                VALIDATE UNIT AND                    3AF00340
(ACTVX EQU     IOEX+1               ACTIVATE CHANNEL                    3AF00350
(NDATA EQU     IOEX+2              VALIDATE UNIT AND                    3AF00360
(NDSLX EQU     IOEX+3               NON-DATA SELECT                     3AF00370
(PROUT EQU     IOEX+4              MESSAGE WRITER                       3AF00380
(PUNCH EQU     IOEX+5              HOLLERITH PUNCH                      3AF00390
(FRCHX EQU     IOEX+6              FREE CHANNEL                         3AF00400
(PAWSX EQU     IOEX+7              ERROR PAUSE                          3AF00410
(PAUSE EQU     IOEX+8              OPERATOR ACTION PAUSE                3AF00420
(STOPX EQU     IOEX+9              SYSTEM STOP                          3AF00430
(SYMUN EQU     IOEX+10             SYMBOLIC UNIT CONVERSION             3AF00440
(DECVD EQU     IOEX+11             BIN TO DEC CONV. AC DECRE.           3AF00450
(DECVA EQU     IOEX+12             BIN TO DEC CONV. AC ADDR.            3AF00460
(CKWAT EQU     IOEX+13             CHECKPOINT DELAY ROUTINE             3AF00470
(BCD5R EQU     IOEX+14             BIN TO BCD CONV. MQ 3-17             3AF00480
(BCD5X EQU     IOEX+15             BIN TO BCD CONV. MQ S-14             3AF00490
(CVPRT EQU     IOEX+16             APPEND UNIT AND PRINT MESSAGE        3AF00500
(STOPD EQU     IOEX+17             DEAD STOP                            3AF00510
(CHXAC EQU     IOEX+18             CHANNEL ACTIVITY                     3AF00520
(URRXI EQU     IOEX+19             REDUNDANCY COUNTS                    3AF00530
(RCTXI EQU     IOEX+20             REDUNDANCY CONTROL                   3AF00540
(RCHXI EQU     IOEX+21             RCHX                                 3AF00550
(TCOXI EQU     IOEX+22             TCOX                                 3AF00560
(TRCXI EQU     IOEX+23             TRCX                                 3AF00570
(ETTXI EQU     IOEX+24             ETTX                                 3AF00580
(TEFXI EQU     IOEX+25             TEFX                                 3AF00590
(TRAPX EQU     IOEX+26             INDIRECT REF TRAP CELL               3AF00600
(TRAPS EQU     IOEX+27             CURRENT TRAPS (NORMAL)               3AF00610
(COMMM EQU     IOEX+28             SCHX RESULT AT TRAP                  3AF00620
(LTPOS EQU     IOEX+29             TP. POSITION BEFORE TRAP             3AF00630
(IOXSI EQU     IOEX+30             SI AT TRAP                           3AF00640
(CHPSW EQU     IOEX+31             CHECKPOINT SWITCH                    3AF00650
(TRPSW EQU     IOEX+32             TRAP SWITCH                          3AF00660
(FDAMT EQU     IOEX+33                                                 $3AF00670
(CHXSP EQU     IOEX+38                                                  3AF00680
       TTL              INTERMEDIATE DEFINITIONS                        3AF00690
PROUT  EQU     (PROUT                                                   3AF00700
PAWS   EQU     (PAWSX                                                   3AF00710
PAUSE  EQU     (PAUSE                                                   3AF00720
STOP   EQU     (STOPX                                                   3AF00730
ACTV   EQU     (ACTIV                                                   3AF00740
TRAPS  EQU     (TRAPS                                                   3AF00750
CVPRT  EQU     (CVPRT                                                   3AF00760
BCD5   EQU     (BCD5X                                                   3AF00770
COMM   EQU     (COMMM                                                   3AF00780
LTPOS  EQU     (LTPOS                                                   3AF00790
INTRAP EQU     (TRPSW                                                   3AF00800
SYUNCV EQU     (SYMUN                                                   3AF00810
NDATA  EQU     (NDATA                                                   3AF00820
BPRNT  EQU     (PROUT                                                   3AF00830
BSK1   EQU     EJECT                                                    3AF00840
BPAWS  EQU     (PAWSX                                                   3AF00850
TRPSW  EQU     (TRPSW                                                   3AF00860
STOPD  EQU     (STOPX                                                   3AF00870
X09CH  EQU     NOCH+NOHYP                                               3AF00880
NOCHX  EQU     X09CH/X09CH                                              3AF00890
NOPXIT EQU     .NOPXI                                                   3AF00900
COMXIT EQU     .COMXI                                                   3AF00910
LTSX   EQU     .LFBLK+3                                                 3AF00920
XEOB   EQU     .LFBLK+4                                                 3AF00930
XEOF   EQU     .LFBLK+5                                                 3AF00940
XERR   EQU     .LFBLK+6                                                 3AF00950
LTRAD  EQU     .LFBLK+7                                                 3AF00960
TRANS  EQU     .LFBLK+8                                                 3AF00970
WDCT   EQU     .LFBLK+9                                                 3AF00980
FCW    EQU     .AREA1-1                                                 3AF00990
EX34   EQU     .EX34                                                    3AF01000
       USE                                                              3AF01010
       BEGIN   L,*                                                      3AF01020
       USE     L                                                        3AF01030
       ORG     .DEFIN+1                                                 3AF01040
       TXL     .ENTRY,,DEFIN.                                           3AF01050
       BSS     3                                                        3AF01060
       TXL     .ENTRY,,ATTCH.                                           3AF01070
       BSS     1                                                        3AF01080
       TXL     .ENTRY,,CLOSE.                                           3AF01090
       BSS     1                                                        3AF01100
       TXL     .ENTRY,,OPEN.                                            3AF01110
       BSS     1                                                        3AF01120
       TXL     .ENTRY,,READ.                                            3AF01130
       BSS     1                                                        3AF01140
       TXL     .ENTRY,,WRITE.                                           3AF01150
       BSS     7                                                        3AF01160
       TXL     .ENTRY,,BSR.                                             3AF01170
       ORG     .ENTRY                                                   3AF01180
       ZET     L(0)                                                     3AF01190
       ORG     .ENTRY+5                                                 3AF01200
       SXA     GTIOX,4                                                  3AF01210
       ORG     .ENTRY+23                                             (7)3AF01211
       TXH     ENDTRK,1,ATTCH.                                       (7)3AF01212
       ORG     .GOA                                                     3AF01220
       TXL     .GO,1,OPEN.                                              3AF01230
       TRA     *+2                                                      3AF01240
       ORG     .ENTRY+10                                                3AF01250
       STZ     TCHEX                                                    3AF01260
       BES     1                                                        3AF01270
       ENB     L(0)                                                     3AF01280
       ORG     .GO+5                                                    3AF01290
       TSX     SWITCH,1                                                 3AF01300
       NOP                                                              3AF01310
       BES     1                                                        3AF01320
       LXA     GTIOX,4                                                  3AF01330
       BES     1                                                        3AF01340
       TSX     EOTOF,1                                                  3AF01350
       ORG     .NOPXI+1                                                 3AF01360
       TSX     FEEIT,1                                                  3AF01370
       ENB     L(0)                                                     3AF01380
       ORG     .COMXI+4                                                 3AF01390
       TRA     *+1                                                      3AF01400
       BSS     1                                                        3AF01410
       TRA     .EX34-4                                                  3AF01420
       ORG     .COMXI+15                                                3AF01430
       LXA     GTIOX,4                                                  3AF01440
       ZET     TCHEX                                                    3AF01450
       LXA     TCHEX,4                                                  3AF01460
       USE                                                              3AF01470
       TTL              CONSTANT POOL                                   3AF01480
L(0)   PZE                                                              3AF01490
L(1)   PZE     1                                                        3AF01500
L(377) OCT     377                                                      3AF01510
L(400) OCT     400                                                      3AF01520
ADDRS  PZE     -1                                                       3AF01530
1DEC   PZE     0,,1                                                     3AF01540
1B17   EQU     1DEC                                                     3AF01550
L(0)D  PZE     0,,L(0)                                                  3AF01560
DECRE  PZE     0,,-1                                                    3AF01570
1PRE   PON                                                              3AF01580
FOR    FOR                                                              3AF01590
2PRE   TIX     0,0,0                                                    3AF01600
SIX    SIX                                                              3AF01610
6PRE   EQU     SIX                                                      3AF01620
L(6)   PZE     6                                                        3AF01630
L(22)  PZE     22                                                       3AF01640
L(40)  PZE     40                                                      $3AF01650
BVDG   OCT     020100000000                                             3AF01660
DEC15  OCT     000017000000                                             3AF01670
L(4)   PZE     4                                                        3AF01680
L(2)   PZE     2                                                        3AF01690
       BES     *-7+NOCHX/NOCHX*7-*                                      3AF01700
7PRE   SVN                                                              3AF01710
       TTL     INDICATOR ASSIGNMENTS                                    3AF01720
       SPACE   1                                                        3AF01730
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $3AF01740
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $3AF01750
CP2    BOOL    100000              ARE 00,01,10                        $3AF01760
OPEND  BOOL    40000               IF=1 FILE OPEN                       3AF01770
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               3AF01780
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              3AF01790
MODE   BOOL    04000               IF=1 BINARY FILE                     3AF01800
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             3AF01810
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 3AF01820
LABEL  BOOL    00400               IF=1 LABELS                          3AF01830
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                3AF01840
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       3AF01850
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               3AF01860
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              3AF01870
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        3AF01880
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                3AF01890
NOEOT  BOOL    00004               IF=1 NO EOT                          3AF01900
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            3AF01910
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                3AF01920
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           3AF01930
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          3AF01940
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $3AF01950
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  3AF01960
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  3AF01970
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            3AF01980
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    3AF01990
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    3AF02000
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             3AF02010
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  3AF02020
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       3AF02030
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               3AF02040
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        3AF02050
STSH   BOOL    00100               IF =1 STASH ROUTINE                  3AF02060
CPYFN  BOOL    00040               IF =1 COPY MODE                      3AF02070
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         3AF02080
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  3AF02090
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    3AF02100
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    3AF02110
IOSY   BOOL    00004               IF=1, IOSY WRITE                     3AF02120
NORUN  BOOL    00002               IF=1 NO REW UNLD                     3AF02130
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 3AF02140
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          3AF02150
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $3AF02160
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               3AF02170
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        3AF02180
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     3AF02190
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 3AF02200
CDBTS  BOOL    24000               DISCN+EOB                            3AF02210
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     3AF02220
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        3AF02230
OUTPUT BOOL    03000               PTO+TTO                              3AF02240
OPDET  BOOL    40002               OPEND+DETACH                         3AF02250
RESOP  BOOL    60000               RESER+OPEND                          3AF02260
OPNEOT BOOL    40004               OPEND+NOEOT                          3AF02270
RANDG  BOOL    00030               RUSH+GIVUP                           3AF02280
EOBITS BOOL    44400               DONLY+EOB+HOLD                       3AF02290
DIGEN  BOOL    30000               DISCN+GENER                          3AF02300
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     3AF02310
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       3AF02320
NOREOF BOOL    00003               NORED + NOEOF                        3AF02330
RBITS  BOOL    00011               RUSH + RHIST                        $3AF02340
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 3AF02350
NETIH  BOOL    10004               NO EOT+NINHIB                        3AF02360
REWNUN BOOL    00006               NORUN + NOREW                       $3AF02370
*                  CONSTANTS AND MASKS FOR INDICATORS                   3AF02380
       SPACE   1                                                        3AF02390
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              3AF02400
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  3AF02410
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              3AF02420
NOTIN  SVN     -1,7,-1-NINHIB                                           3AF02430
EOTBT  SVN     -1,7,-1-NOEOT                                            3AF02440
NEOTBT PZE     0,,NOEOT                                                 3AF02450
MODBT  PZE     0,0,MODE                                                 3AF02460
       TTL     DEFINE A. BUFFER POOL                                    3AF02470
*      CALLING SEQUENCE                                                 3AF02480
*              TSX  DEFINE,4                                            3AF02490
*              PZE  L(POOL)                                             3AF02500
*              PZE  N,,EFF BUF SIZE                                     3AF02510
*              RETURN                                                   3AF02520
*                                WHERE                                  3AF02530
*                  L(POOL) = LOCATION OF BUFFER POOL                    3AF02540
*                  N= NUMBER OF BUFFERS TO BE FORMED                    3AF02550
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            3AF02560
*      COMMENTS-                                                        3AF02570
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   3AF02580
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   3AF02590
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                3AF02600
       SPACE   1                                                        3AF02610
DEFIN. CLS     -1,4                SAVE                                 3AF02620
       ACL     L(1)                L(POOL+1)                            3AF02630
       STA     DE1                                                      3AF02640
       ACL     L(1)                SET LOCATION                         3AF02650
       STA     DE3                 OF 1ST BUFFER                        3AF02660
       STO*    FCW                 SET BPC= FOR BUF1,,0                 3AF02670
       CAL     0,4                 SET SECOND WORD                      3AF02680
       ANA     DECRE               OF POOL =                            3AF02690
       LGL     4                   S-13= BUF. SIZE                      3AF02700
DE1    SLW     **                  14-35 = 0                            3AF02710
       CLA     0,4                 SET IORT                             3AF02720
       STD     FCW                 =IORT POOL,,SIZE                     3AF02730
       PDX     0,1                 PLACE SIZE+2                         3AF02740
       TXI     *+1,1,2             INTO IR1                             3AF02750
       PAX     0,2                 NUMBER OF BUFFERS                    3AF02760
       ALS     18                  TO IR2                               3AF02770
       STD*    FCW                 AND POOL                             3AF02780
       CLA     DE3                 GO SETUP                             3AF02790
       ACL     L(1)                CHAIN MECHANISM                      3AF02800
       STA     DE4                                                      3AF02810
DE2    CLA     FCW                 CHAIN BUFFER POOL                    3AF02820
DE3    STZ     **                  1ST BUFFER CONTROL WORD              3AF02830
       STA*    *-1                 = 0 00000 0 CHAIN                    3AF02840
DE4    STO     **                  2ND= IORT BPC,,SIZE                  3AF02850
       TNX     DE6,2,1             TEST IF N FORMED                     3AF02860
       PXA     0,1                 CHAIN LAST                           3AF02870
       ACL     DE3                 BUF TO NEXT                          3AF02880
       STA*    DE3                 FINAL BUFFER IS                      3AF02890
       STA     DE3                 CHAINED TO BPC                       3AF02900
       TRA     DE2-2                                                    3AF02910
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              3AF02920
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         3AF02930
       TXI     EX34,4,-1           EXIT AT 3,4                          3AF02940
       TTL     ATTACH ROUTINE                                           3AF02950
*                          CALLING SEQUENCES                            3AF02960
       SPACE   1                                                        3AF02970
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 3AF02980
*              PZE  POOL            TO SPECIFIED POOL                   3AF02990
*              PZE  LIST,,FILECT                                        3AF03000
*                             RESTRICTIONS                              3AF03010
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        3AF03020
*                  IN ONE ATTACH CALLING SEQUENCE                       3AF03030
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       3AF03040
       SPACE   1                                                        3AF03050
*                            ATTACH ROUTINE                             3AF03060
ATTCH. STA     LBC                 SAVE L(POOL)                         3AF03070
       PXA     0,0                 SET OUTPUT CHAIN = 0                 3AF03080
       STA     1,2                 IF POOL HAS BEEN                     3AF03090
       CLA     0,4                 FOR SUBROUTINE                       3AF03100
       TXI     *+1,4,-1            ADVANCE EXIT FOR XTRA WORD           3AF03110
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       3AF03120
       SXA     GTIOX,4             SAVE L(EXIT)                         3AF03130
       TRA     CA3+2               EXAMINE LIST                         3AF03140
CA3    CLA     CA51                ADVANCE IN LIST                      3AF03150
       ACL     L(1)                STARTS AT L(LIST)-1                  3AF03160
       STA     CA51                IN LIST LOCATOR                      3AF03170
       ENB     L(0)                TRAP PROTECT                         3AF03180
CA51   CAL     **                  WHILE ADJUSTING                      3AF03190
       PAC     0,2                 COUNTS                               3AF03200
       STA     FCW                 IN FCW CELL                          3AF03210
       PAI                         FOR CHECK OF SIX OR SUN WORD         3AF03220
       CLA*    CA51                PICK UP LIST ENTRY                   3AF03230
       LNT     600000              SIX OR SUN                           3AF03240
       TRA     CA6                 NO--PZE                              3AF03250
       SXD     CA4,2               STORE FILECT FOR REDUCING BUFCT.     3AF03260
       PDX     0,1                 REDUCE                              $3AF03270
       PDX     0,4                 THE                                 $3AF03280
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             3AF03290
       PXD     0,4                 THAT THE SPECIFIED NUMBER            3AF03300
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        3AF03310
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        3AF03320
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   3AF03330
CA5    PXD     **,1                REDUCE IBACT BY                      3AF03340
       ADD*    LBC                 SUBTRACTING BUFFER COUNT             3AF03350
       STD*    LBC                 USED BY THIS GROUP                   3AF03360
       TRA     CA3                 PROCESS FILE LIST                    3AF03370
*                        FILE HANDLER (ATTACH)                          3AF03380
       SPACE   1                                                        3AF03390
CA6    LDI     1,2                 GET FCB BIT AND MAKE                 3AF03400
       SIL     RESER               FILE A RESERVE FILE                  3AF03410
       CAL     CA5                 PLACE L(SVN WORD)                    3AF03420
       STA     3,2                 IN FCB                               3AF03430
       CLA     LBC                 PLACE L(POOL) IN                     3AF03440
       STA     2,2                 FILE CONTROL WORDS                   3AF03450
       ALS     18                  2ND WORD ADDRESS AND                 3AF03460
       STD     4,2                 5TH WORD DECREMENT                   3AF03470
       ENB     TRAPS               ALLOW TRAPS                          3AF03480
       PIA                         PLACE CONTROL BITS                   3AF03490
       STD     1,2                 IN FILE                              3AF03500
CA25   LXD     CA26,1              ADVANCE                              3AF03510
       TNX     COMXIT+3,1,1        ALONG FILE LIST                      3AF03520
       SXD     CA26,1              AS LONG AS MORE FILES                3AF03530
CA26   TXL     CA3,0,**                                                 3AF03540
       TTL     DE-ACTIVATE AND CLOSE FILE                               3AF03550
CLOSE. ARS     33                                                       3AF03560
       OAI                                                              3AF03570
       LFT     DETACH                                                   3AF03580
       TRA     COMXIT                                                   3AF03590
       TSX     FNLBC,4             FIND POOL                            3AF03600
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3AF03610
       LNT     RESOP               IF CLOSING AN OPEN                   3AF03620
       TRA     *+4                 RESERVE FILE                         3AF03630
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   3AF03640
       ACL     L(1)                ALLOWING ANOTHER FILE                3AF03650
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      3AF03660
       LNT     OPEND               IF FILE NEVER                        3AF03670
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $3AF03680
       LFT     OUTPUT              INPUT OR                             3AF03690
       TRA     SH5                 OUTPUT FILE                          3AF03700
       SPACE   1                                                        3AF03710
*                           CLOSE INPUT FILE                            3AF03720
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3AF03730
SH2    CAL     0,2                 MAKE SURE EOF                        3AF03740
       ANA     FOR                 FLAG IS OFF                         $3AF03750
       STP     0,2                                                     $3AF03760
       BES     *-3+NOCH/NOCH*3-*                                        3AF03770
SH4    CLA     5,2                 CHECK FOR HYPER                      3AF03780
       ANA     SIX                                                     $3AF03790
       TNZ     SH1                 729 OR DISK                          3AF03800
       RNT     REWNUN                                                  $3AF03810
       TRA     SH6                 RETURN                              $3AF03820
       RIR     REWNUN              TAKE OUT HYPER OPTION               $3AF03830
       TRA     SH6                 RETURN                              $3AF03840
SH1    RNT     5                                                        3AF03850
       TRA     *+3                                                      3AF03860
       RNT     2                                                        3AF03870
       TRA     *+5                                                      3AF03880
       RNT     NOEOFM                                                   3AF03890
       TRA     *+3                 NO                                  $3AF03900
       TSX     (NDSLX,4            YES                                 $3AF03910
       PZE     0,2,HFPNP           FILE PROTECT                        $3AF03920
       RNT     REWNUN              TEST FOR UNLOAD                     $3AF03930
       TRA     SH6                 NO                                  $3AF03940
       TSX     (NDSLX,4            YES                                 $3AF03950
       PZE     0,2,HUNLP           UNLOAD                              $3AF03960
       TRA     SH4.1-1             EXIT                                 3AF03970
       BES     SH4+NOHYP/NOHYP**-NOHYP/NOHYP*SH4-*                     $3AF03980
SH6    RFT     NOREW               IF NO REWIND                         3AF03990
       TRA     SH4.1               SPECIFIED SKIP OUT                   3AF04000
       CAL     3DEC                FORM REW CODE (=3)                   3AF04010
       RNT     NORUN               OR REW UNLOAD                        3AF04020
       ACL     1DEC                CODE (=4)                            3AF04030
       STD     *+2                                                      3AF04040
       TSX     NDSEL+1,4           ISSUE REW                            3AF04050
       PZE     0,2,**              OR RUN                               3AF04060
       RFT     REWNUN              IF REWOUND AND                      $3AF04070
       TRA     SH4.1               UNLOADED                             3AF04080
       SIL     DETACH              PRINT MESSAGE                        3AF04090
SH4.1  RIL     OPEND               RESET OPEN BIT                       3AF04100
       TRA     COMXIT              EXIT                                 3AF04110
       SPACE   1                                                        3AF04120
*                          CLOSE OUTPUT FILE                            3AF04130
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            3AF04140
       RNT     000005              CHECK FOR HYPER OPTIONS             $3AF04150
       TRA     *+3                 NOT MON OPTION                      $3AF04160
       RNT     NORUN               IF TRUE MON OPTION                  $3AF04170
       TRA     SH3                 SKIP EOF AND LABEL WRITES            3AF04180
       TSX     NDSEL+1,4           WRITE                                3AF04190
       PZE     0,2,WEFOP           EOF                                  3AF04200
       NOP                         IGNORE EOT                           3AF04210
SH3    LAC     LBC,4               L(POOL) TO IR4                       3AF04220
       SXD     SH33,2              REMOVE FILE FROM                     3AF04230
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              3AF04240
       PAX     0,1                 FILE THAT REFERENCES CLOSING         3AF04250
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           3AF04260
       TXL     SH34,1,0            FOUND.                               3AF04270
       PAC     0,4                 NOT FOUND. ADVANCE                   3AF04280
       TRA     SH32                ALONG CHAIN.                         3AF04290
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           3AF04300
       STA     1,4                 REFERENCED CLOSING FILE              3AF04310
       RNT     000005              IS THIS CLOSE                       $3AF04320
       TRA     *+3                 A TRUE MON OPTION                   $3AF04330
       RNT     NORUN                                                   $3AF04340
       TRA     SH4.1               YES,POST AND RETURN                 $3AF04350
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $3AF04360
       TTL                         OPEN ROUTINE                         3AF04370
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              3AF04380
       SPACE   1                                                        3AF04390
*                           CALLING SEQUENCE                            3AF04400
*              TSX OPEN,4                                               3AF04410
*               P  FILE,,1                                              3AF04420
*      WHERE                                                            3AF04430
*              P= PZE REWIND BEFORE OPEN                                3AF04440
*              P= MZE NO REWIND                                         3AF04450
*              P= MON NO REWIND, NO LABELS                              3AF04460
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  3AF04470
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           3AF04480
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE 3AF04490
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     3AF04500
*      ACTIONS ....                                                     3AF04510
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      3AF04520
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             3AF04530
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                3AF04540
       SPACE   1                                                        3AF04550
OPEN.  LFT     OPEND               IF FILE OPEN                         3AF04560
       TRA     OP1                 GO HOME                              3AF04570
       SIL     NETIH               SET NO INHIBIT BIT                   3AF04580
       CLA*    3,2                 SURE THAT NO MORE                    3AF04590
       PAX     0,1                 THAN THE SPECIFIED                   3AF04600
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  3AF04610
       TXH     SY9.3,1,4096        OPEN AT SAME TIME                    3AF04620
       PXA     0,1                                                      3AF04630
       STA*    3,2                                                      3AF04640
       CLA     OP6                 MAKE SURE THAT                       3AF04650
       STT     0,2                 IMEDIATE MOUNT FLAG IS ON            3AF04660
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $3AF04670
       STA     4,2                 = L(0)                               3AF04680
       TSX     (NDATA,4            TEST LEGALITY                       $3AF04690
2TAG   PZE     0,2,TESTP           OF UNIT                              3AF04700
       TSX     DENSE,4             SET FILE DENSITY                     3AF04710
       LXA     GTIOX,4                                                  3AF04720
       CLA     -1,4                                                     3AF04730
       TMI     OP4                 NO REW                               3AF04740
       TSX     NDSEL+1,4           REWIND BEFORE                        3AF04750
       PZE     0,2,REWOP           OPEN                                 3AF04760
OP4    CLA     5,2                 IS THIS HYPER                        3AF04770
       ANA     SIX                                                      3AF04780
       TNZ     OP7.1               YES                                  3AF04790
       TRA     OP7.3                                                    3AF04800
       BES     *-4+NOHYP/NOHYP*4-*                                      3AF04810
       SPACE   1                                                        3AF04820
*                           OPEN INPUT FILE                             3AF04830
OP6    TSX     FNLBC,4             FIND L(POOL)                         3AF04840
       LFT     OUTPUT                                                   3AF04850
       TRA     OP9                                                      3AF04860
       PXD     0,0                 CLEAR BUFFER COUNT                   3AF04870
       STA     1,2                 IN FCB.                              3AF04880
       TSX     BORBF,1             INITIATE READ                        3AF04890
LBC    NOP                         IF POSSIBLE ... L(POOL)...           3AF04900
OP1    SIL     OPNEOT              SET OPEN AND NO EOT BITS             3AF04910
       TRA     COMXIT              EXIT TO USER                         3AF04920
OP9    LAC     LBC,4               L (POOL) TO IR4                      3AF04930
       CLA     1,4                 PLACE OUTPUT                         3AF04940
       STA     1,2                 FILE IN SYNCING                      3AF04950
       CLA     FCW                 CHAIN USED TO                        3AF04960
       STA     1,4                 RELEASED TO THE                      3AF04970
       TRA     OP1                 BUFFER POOL                          3AF04980
3DEC   PZE     ,,3                                                 IBJOB3AF04990
       SPACE   1                                                        3AF05000
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $3AF05010
OP7.1  RIR     MXDMD               RESET BACKWARD READ                 $3AF05020
       PIA                                                             $3AF05030
       STT     1,2                                                     $3AF05040
       LFT     OUTPUT              IF OUTPUT                           $3AF05050
       TRA     OP6                 ALL DONE                             3AF05060
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $3AF05070
       TXL     OP7.2,4,0           NO                                  $3AF05080
       ORA     *-1                 SET READ                            $3AF05090
       STT     1,2                 BACKWARD                            $3AF05100
       AXC     2,4                                                     $3AF05110
       CLA*    0,2                                                     $3AF05120
       ANA     ADDRS               IF NEXT READ IS NOT A               $3AF05130
       TNZ     OP7.2               FILE MARK THEN PROCEED              $3AF05140
       TSX     (NDSLX,4            ELSE BACKSPACE FILE                 $3AF05150
       PZE     0,2,HBSFP                                               $3AF05160
OP7.2  LXA     GTIOX,4                                                  3AF05170
       CLA     -1,4                TEST FOR THE                        $3AF05180
       ANA     SIX                 SETTING OF FILE PROTECT             $3AF05190
       TZE     *+3                 NO                                  $3AF05200
       TSX     (NDSLX,4                                                $3AF05210
       PZE     0,2,HFPNP           FILE PROTECT                        $3AF05220
       TRA     OP6                                                      3AF05230
OP7.3  LFT     OUTPUT                                                  $3AF05240
       TRA     OP6                                                      3AF05250
       LXD     XEOB,4              IF READ                             $3AF05260
       TXL     OP6,4,0             BACKWARD                             3AF05270
       TSX     NDSEL+1,4           REWIND 729                          $3AF05280
       PZE     0,2,REWOP           OR DISK INPUT                       $3AF05290
       TRA     OP6                                                      3AF05300
       BES     OP7.1+NOHYP/NOHYP**-NOHYP/NOHYP*OP7.1-*                  3AF05310
       TTL                         BUFFERED READ ROUTINE                3AF05320
*              TSX  READ,4              BUFFERED READ                   3AF05330
*              PZE  FILE,,EOB           END OF BLOCK                    3AF05340
*              PZE  EOF,,ERR              END OF FILE AND               3AF05350
*                   *                     ERROR EXITS                   3AF05360
*                   *                                                   3AF05370
*                  IO-LIST                                              3AF05380
*                   *                                                   3AF05390
*              RETURN                                                   3AF05400
       SPACE   1                                                        3AF05410
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3AF05420
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3AF05430
*                              IS GIVEN.                                3AF05440
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   3AF05450
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3AF05460
*                            BUFFER AREA ATTACHED TO THE FILE           3AF05470
       SPACE   1                                                        3AF05480
READ.  SIR     RDSWIT              SET READ SWITCH                     $3AF05490
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    3AF05500
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             3AF05510
       CLA     -1,4                SAVE MODAL EXITS                     3AF05520
       STA     XEOF                END OF FILE                          3AF05530
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     3AF05540
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     3AF05550
       TRA     EOFER               TAKE END OF FILE EXIT                3AF05560
       TSX     FNLBC,4             FIND L(POOL)                         3AF05570
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      3AF05580
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             3AF05590
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       3AF05600
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 3AF05610
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     3AF05620
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     3AF05630
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           3AF05640
       PZE     TRM1                3.TRANSMIT FROM                      3AF05650
       PZE     TRM2                BUFFER TO WORKING STORAGE            3AF05660
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   3AF05670
       TTL                         BUFFERED WRITE ROUTINE               3AF05680
*              TSX WRITE,4              BUFFERED WRITE                  3AF05690
*              PZE  FILE,,EOB            END OF BLOCK EXIT              3AF05700
*                    *                                                  3AF05710
*                    *                                                  3AF05720
*                  IO-LIST                                              3AF05730
*                   *                                                   3AF05740
*              RETURN                                                   3AF05750
       SPACE   1                                                        3AF05760
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3AF05770
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3AF05780
*                              IS GIVEN.                                3AF05790
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  3AF05800
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3AF05810
*                            BUFFER AREA ATTACHED TO THE FILE           3AF05820
       SPACE   1                                                        3AF05830
WRITE. LNT     OPEND               IF FILE NOT OPEN                     3AF05840
       TRA     NOPXIT              DO NOTHING EXIT                      3AF05850
       TSX     FNLBC,4             FIND L(POOL)                         3AF05860
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    3AF05870
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    3AF05880
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   3AF05890
       PZE     TRM2                3.TRANSMIT FROM                      3AF05900
       PZE     TRM1                WORKING STORAGE TO BUFFER            3AF05910
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  3AF05920
       SPACE   2                                                        3AF05930
*                  FIND L(BPC) FROM FILE CONTROL WORD                   3AF05940
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            3AF05950
FNLBC  CLA     4,2                                                      3AF05960
       PDX     0,1                                                      3AF05970
       SXA     LBC,1                                                    3AF05980
       TRA     1,4                                                      3AF05990
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         3AF06000
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          3AF06010
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    3AF06020
       SPACE   1                                                        3AF06030
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            3AF06040
*                          IR4 MUST= -L(POOL)                           3AF06050
       SPACE   1                                                        3AF06060
TOKBB  ENB     L(0)                TRAP PROTECT                         3AF06070
TOKBF  SXA     TK3,4               SAVE IR4                             3AF06080
       CLA*    3,2                 COUNT AND IF IT                      3AF06090
       PDX     0,1                 GOES NEGATIVE THEN                   3AF06100
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  3AF06110
       TXL     TK2,1,4096                                               3AF06120
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               3AF06130
       PDX     0,4                 IMMEDIATE FILES                      3AF06140
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              3AF06150
       SUB     1DEC                                                     3AF06160
       STD*    LBC                                                      3AF06170
TK2    PXD     0,1                 RESTORE RESERVE                      3AF06180
       STD*    3,2                 FILE                                 3AF06190
TK3    AXT     **,4                RESTORE IR4                          3AF06200
       TRA     2,4                 EXIT                                 3AF06210
TK4    LXA     TK3,4               TAKE ERROR EXIT                      3AF06220
       TRA     1,4                                                      3AF06230
       SPACE   1                                                        3AF06240
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            3AF06250
       SPACE   1                                                        3AF06260
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      3AF06270
BCKBF  SXA     BK2,1                                                    3AF06280
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       3AF06290
       PDX     0,1                                                      3AF06300
       ACL     1DEC                                                     3AF06310
       STD*    3,2                                                      3AF06320
       TXL     BK2,1,4096          IF NEGATIVE INCREMENT                3AF06330
BK1    CAL     0,4                 POOL CT ALSO                         3AF06340
       ADD     1DEC                                                     3AF06350
       STD     0,4                                                      3AF06360
BK2    AXT     **,1                                                     3AF06370
       TRA     1,1                 EXIT                                 3AF06380
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    3AF06390
*                    HANDLES EOB,EOF,AND URR EXITS                      3AF06400
       SPACE   1                                                        3AF06410
EOFER  CLA     0,4                 END OF FILE                          3AF06420
       ANA     1PRE                EXIT INPUT FILE                      3AF06430
       RIL     100000              NOT OPEN                             3AF06440
       OAI                         PLACE 1ST COMMAND IN SI              3AF06450
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   3AF06460
       SXA     GTIOX,4             COMMAND                              3AF06470
       TRA     EOF.0               TAKE EOF EXIT                        3AF06480
EOFEX  LFT     MULTI               MULTI-REEL                           3AF06490
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            3AF06500
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   3AF06510
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         3AF06520
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     3AF06530
EOF.1  SXA     TCHEX,4                                                  3AF06540
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             3AF06550
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     3AF06560
       LDQ     LTSX                LOAD EXIT HISTORY                    3AF06570
       RQL     18                                                      $3AF06580
       TRA     COMXIT              EXIT                                 3AF06590
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         3AF06600
ERREX  ARS     18                  CODE IN                             $3AF06610
       STT     LTSX                TAG OF HISTORY                      $3AF06620
       CLA*    2,2                 MAKE HISTORY                        $3AF06630
       STA     LTRAD               REFLECT THIS OP.                    $3AF06640
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                3AF06650
       LDC     XERR,4              ERROR EXITS                          3AF06660
       TRA     EOF.1                                                    3AF06670
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        3AF06680
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          3AF06690
       TRA     EOF.1                                                    3AF06700
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  3AF06710
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        3AF06720
       SXD     LTRAD,4             INTO HISTORY                         3AF06730
       ZET     TCHEX               HAS A TCH OCCURRED                   3AF06740
       TRA     TCHOC               YES-                                 3AF06750
       LFT     100000              NO-IS THIS OP AN IOXT                3AF06760
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            3AF06770
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          3AF06780
FEEIT  TXI     *+1,4,-1            NO-                                 $3AF06790
       CAL     -1,4                SEARCH                               3AF06800
       LGR     34                  FOR                                  3AF06810
       TZE     *+2                 EXIT                                 3AF06820
       TQP     *-4                                                      3AF06830
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  3AF06840
       TRA     *+2                                                      3AF06850
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  3AF06860
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $3AF06870
       TRA     1,1                 RETURN                               3AF06880
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       3AF06890
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  3AF06900
*                        MASTER CONTROL ROUTINE                         3AF06910
*                          FOR READ AND WRITE                           3AF06920
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   3AF06930
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         3AF06940
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            3AF06950
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              3AF06960
*              PRE TRM2 OR TRM1        TRANSMITTING                     3AF06970
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     3AF06980
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            3AF06990
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        3AF07000
*              XEC  N,4                                                 3AF07010
       SPACE   1                                                        3AF07020
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          3AF07030
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         3AF07040
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              3AF07050
       ANA     7PRE                SHOULD BE DISCONNECTED              $3AF07060
       TZE     GTIOX-1             NONE ATTACHED                        3AF07070
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   3AF07080
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3AF07090
*                         GET NEXT IO COMMAND                           3AF07100
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          3AF07110
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              3AF07120
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        3AF07130
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  3AF07140
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             3AF07150
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    3AF07160
       SPACE   1                                                        3AF07170
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           3AF07180
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         3AF07190
       TXI     *+1,1,-1            SETUP L(NEXT)                        3AF07200
       SXA     GTIOX,1             IOXY                                 3AF07210
       CAL     -1,1                THIS IO COMMAND TO AC                3AF07220
       STA     TRANS               SAVE TRANSMIT LOC                    3AF07230
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       3AF07240
       STD     WDCT                SAVE WORD COUNT                      3AF07250
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   3AF07260
       ANA     IOOP                AND NOT DISTURBING FILE              3AF07270
       OAI                         CONDITION OR HISTORY BITS           $3AF07280
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              3AF07290
       LFT     600000              SEPARATE TCH AND IOCD                3AF07300
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  3AF07310
       LFT     100000              IOCD OR TCH COMMAND                  3AF07320
       TRA     TCH                 TCH                                  3AF07330
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  3AF07340
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     3AF07350
       TRA     RW0                 NO                                   3AF07360
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   3AF07370
       CLA*    TRANS                                                    3AF07380
       STA     TRANS                                                    3AF07390
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   3AF07400
RW0    NZT     WDCT                IF WORD COUNT IS                     3AF07410
       LNT     400000              ZERO ON IOCY OR IOSY                 3AF07420
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           3AF07430
       TRA     RW8                                                      3AF07440
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD 3AF07450
       TPL     RW2                 BUFFER IS CONNECTED TO FILE          3AF07460
RW1.4  XEC     2,4                 GET NEXT BUFFER                      3AF07470
       CLA*    2,2                 PICKUP BUFFER CONTROL WORD           3AF07480
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                3AF07490
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        3AF07500
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        3AF07510
       TNZ     RW2.1               IF SOME WORDS ARE                    3AF07520
       PDX     0,1                 AVAILABLE AND COMMAND IS             3AF07530
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    3AF07540
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    3AF07550
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        3AF07560
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     3AF07570
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            3AF07580
*                       COUNT CONTROL EXECUTION                         3AF07590
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  3AF07600
       SIR     GENER               SET GENERATED DISCONNECT             3AF07610
       XEC     1,4                 DISCONNECT                           3AF07620
       RIR     GENER               RESET GENER BIT                      3AF07630
       TRA     RW1.4               AND GO ATTACH NEXT ONE               3AF07640
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              3AF07650
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   3AF07660
       TPL     RW5                 IS BUFFER OVERFLOWED                 3AF07670
       STD     DUMMY               YES- SAVE NUMBER OFF                 3AF07680
       LNT     200000              UNLESS COMMAND IS IOSY               3AF07690
       SIR     GENER               SET BIT FOR GENERATED COMMAND        3AF07700
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                3AF07710
RW4    STD     WDCT                ON THIS BUFFER                       3AF07720
       PXA     0,0                 SET ZERO REMAINING WORDS             3AF07730
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                3AF07740
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   3AF07750
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $3AF07760
       STD*    2,2                 TO ADJUST LOCATOR                    3AF07770
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   3AF07780
       RNT     200000              IF IOXYN **,,CT                      3AF07790
       TRA     RW6                 OR IOXYN* ADDR,,CT                   3AF07800
       CLA     TRANS               THEN PLACE L(WORDS)                  3AF07810
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $3AF07820
       STA     0,1                 RESPECTIVELY                         3AF07830
       SIR     XECNT               INDICATE IOXYN EXECUTED              3AF07840
RW6    LXD     WDCT,1              FORM FIRST                           3AF07850
       PXA     0,1                 TRANSMIT                             3AF07860
       ACL*    2,2                 ADDRESS                              3AF07870
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $3AF07880
       STA*    2,2                 ADJUST LOCATOR                       3AF07890
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           3AF07900
       PXA     0,1                 COMPUTE                              3AF07910
       ACL     TRANS               SECOND TRANSMIT ADDRESS              3AF07920
       STA*    4,4                 AND STORE IT                         3AF07930
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        3AF07940
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            3AF07950
       RFT     200000              IF NON-TRANSMITTING                  3AF07960
       TRA     RW8                 SKIP OVER MOVES                      3AF07970
       LXD     WDCT,1              WDCT TO IR1                          3AF07980
TRM1   CAL     **,1                TRANSMIT                             3AF07990
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                3AF08000
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               3AF08010
*                         TERMINATE IO COMMAND                          3AF08020
RW8    NZT     XEOB                IF USER NOT LOCATING                 3AF08030
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        3AF08040
       RNT     EOB                 IF EOB DID NOT OCCUR                 3AF08050
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   3AF08060
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       3AF08070
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            3AF08080
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       3AF08090
       TRA     RW13                YES                                  3AF08100
RW10   LNT     100000              IS COMMAND                           3AF08110
       TRA     GTIOX               IOXP OR IOXT                         3AF08120
RW12   RFT     HELD                IF A HOLD OCCURRED                   3AF08130
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      3AF08140
       RFT     RDSWIT              IF READING EXECUTE                   3AF08150
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   3AF08160
       RFT     EOBXIT              EXIT AT                              3AF08170
       TRA     EOBEX               -EOB EXIT                            3AF08180
       TRA     COMXIT              -NORMAL EXIT                         3AF08190
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) 3AF08200
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       3AF08210
       TRA     RW10                -NO IT IS COMPLETE                   3AF08220
       RIR     GENER               RESET GENER BIT                      3AF08230
       LFT     200000              IF IOCY                              3AF08240
       TRA     RW14+2              NO- IOSY INTERRUPTED                 3AF08250
       RNT     200000              IF IOCYN                             3AF08260
       TRA     RW14                NO -IOC TRANSMITTING                 3AF08270
       ZET     XEOB                IF IOCYN LOCATING                    3AF08280
       TRA     RW16                TAKE EOB INTERRUPT EXIT              3AF08290
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   3AF08300
       STA     TRANS               ADDRESS                              3AF08310
       CLA     DUMMY               SET NEW                              3AF08320
       STD     WDCT                WORD COUNT                           3AF08330
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            3AF08340
RW16   CAL     2TAG                SET EOB IOCYN                       *3AF08350
       TRA     RW17+1              INTERRUPTED CODE                     3AF08360
RW17   CAL     RW13                SET END OF BUFFERS CODE             *3AF08370
       STT     LTSX                STORE CODE                          *3AF08380
       SIR     EOBXIT              SET AND TAKE                         3AF08390
       TRA     RW12                EOB EXIT                             3AF08400
       EJECT                                                            3AF08410
*                  HANDLER FOR IORY AND IOSY READING                    3AF08420
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              3AF08430
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     3AF08440
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    3AF08450
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       3AF08460
       SIR     DISCN               SET COMMAND DISCONNECT               3AF08470
       TRA     RW4                 EXECUTE READ                         3AF08480
       SPACE   1                                                        3AF08490
*                  HANDLER FOR IORY AND IOSY WRITING                    3AF08500
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 3AF08510
       LNT     400000              IS IT ACTUALLY IOSY                  3AF08520
       IIR     EBDSY               NO-SET EOB DISCONNECT, TURN OFF IOSY 3AF08530
       SUB     WDCT                REDUCE WORD COUNT AVAILABLE          3AF08540
       TPL     RW5                 IF ENOUGH WERE AVAIL,EXECUTE COMMAND 3AF08550
       LNT     400000              NOT ENOUGH                           3AF08560
       TRA     RW3                 IORY- REDUCE CT AND EXECUTE          3AF08570
       LXD     DUMMY,1             IF SECOND ATTEMPT ON IOSY            3AF08580
       TXH     RW3,1,0             IS STILL TOO BIG, THEN REDUCE COUNT  3AF08590
       SIR     GENER               IOSY -SET GENER TO DO ON NEXT BUF    3AF08600
       CLA     WDCT                SETUP GENERATED                      3AF08610
       STD     DUMMY               COMMAND                              3AF08620
       RFT     XECNT               IF AN IOXYN WAS                      3AF08630
       SIR     EOB                 ALREADY EXECUTED SET EOB TESTS       3AF08640
       TRA     RW8                 GO RELEASE THIS BUF AND DO GENER     3AF08650
       SPACE   1                                                        3AF08660
*                         HANDLER TCH COMMAND                           3AF08670
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      3AF08680
       NZT     TCHEX               IF 1ST TCH THEN                      3AF08690
       STA     TCHEX               EXIT = L(TCH)+1                      3AF08700
       RNT     400000              IF NOT INDIRECT                      3AF08710
       TRA     GTIOX+1             TCH EXECUTED                         3AF08720
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             3AF08730
       PAC     0,1                 GO ONE MORE LEVEL AND                3AF08740
       TRA     GTIOX+1             EXIT                                 3AF08750
       SPACE   1                                                        3AF08760
*                     PRIORITY EXIT TESTS FOR READ                      3AF08770
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         3AF08780
       ANA     L(377)                                                   3AF08790
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        3AF08800
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        3AF08810
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  3AF08820
       RIL     PRIBTS              AND EXIT.                            3AF08830
       RFT     REINT               IF LAST BUF SYNCED                   3AF08840
       TRA     *+4                 GIVE FILE A KICK                     3AF08850
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    3AF08860
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         3AF08870
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  3AF08880
       TSX     BORBF,1             IF NO RUSH OCCURRED                  3AF08890
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      3AF08900
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  3AF08910
       TTL     READ SUBROUTINE - SYNCR-                                 3AF08920
*                   GETS A BUFFER FROM THE EXECUTOR                     3AF08930
*                         VIA THE SYNC ROUTINE                          3AF08940
       SPACE   1                                                        3AF08950
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   3AF08960
*              RETURN              INDEXS ARE NOT DISTRUBED             3AF08970
       SPACE   1                                                        3AF08980
SYNCR  SXA     SY8.2,4             SAVE IR4                             3AF08990
       SXA     SY8.1,1             IR1                                  3AF09000
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $3AF09010
L(0)A  ENB     L(0)                DISABLE TRAPS                        3AF09020
       NZT*    4,2                 ANYTHING TO SYNC                     3AF09030
       TRA     SY10                -NO                                  3AF09040
       CLA     5,2                                                     $3AF09050
       ANA     SIX                 HYPER                               $3AF09060
       TZE     *+5                 NO                                  $3AF09070
       LDQ     1,2                 WHAT                                $3AF09080
       RQL     18                  TYPE                                $3AF09090
       TQP     *+2                 READ                                $3AF09100
       SIR     100000              HYPER READ BACKWARD                 $3AF09110
       BES     *-7+NOHYP/NOHYP*7-*                                     $3AF09120
       CLA     4,2                 SYNCED BUFFER TO                     3AF09130
       STA     2,2                 BUFFER IN USE ADDRESS                3AF09140
       CAL     1,2                 REDUCE COUNT OF                      3AF09150
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     3AF09160
       STA     1,2                                                      3AF09170
       CLA*    4,2                 UPDATE SYNC                         $3AF09180
       STA     4,2                 CHAIN CARRYING L(END)                3AF09190
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             3AF09200
       STD*    4,2                 UNLESS NO CHAIN EXISTS               3AF09210
       ENB     TRAPS               ALLOW TRAPS                          3AF09220
       LGR     33                  SET EOF AND/ OR REDUN                3AF09230
       IIA                         BITS=0 IF CONDITION OCCURRED         3AF09240
       LXD     SYNCT,1             ADVANCE COUNT                        3AF09250
       TXI     *+1,1,1             OF BUFFERS                           3AF09260
       SXD     SYNCT,1             USED THIS READ                       3AF09270
       CAL     2,2                                                      3AF09280
       ACL     L(1)                                                     3AF09290
       PAC     0,4                 IR4 = -L(IORT)                       3AF09300
       ACL     L(1)                SET LOCATOR ADDRESS                  3AF09310
       ANA     XCPTP               CLEAR PREFIX                        $3AF09320
       STO*    2,2                                                     $3AF09330
       RNT     100000              READ BACKWARD                       $3AF09340
       TRA     SY4                 NO                                  $3AF09350
       ALS     18                  FIRST DATA WORD                     $3AF09360
       ACL     0,4                 IN BUFFER                           $3AF09370
       ARS     18                  LAST DATA WORD                      $3AF09380
       PAX     0,1                 +1 OF BUFFER                        $3AF09390
       ORA     7PRE                                                    $3AF09400
       BES     *-7+NOHYP/NOHYP*7-*                                     $3AF09410
SY4    SUB     0,4                 LOCATOR - IORT                      $3AF09420
       ALS     18                  =WORD COUNT                         $3AF09430
       STD*    2,2                                                     $3AF09440
       RNT     100000                                                  $3AF09450
       TRA     SY5                                                     $3AF09460
       CAL     0,4                 STARTING DATA                       $3AF09470
       STA*    2,2                                                     $3AF09480
       PXA     0,1                 LAST LOC+1 OF                       $3AF09490
       STA     0,4                 BUFFER IN TO IORT                   $3AF09500
       BES     *-6+NOHYP/NOHYP*6-*                                     $3AF09510
SY5    RNT     NOEOF               DID EOF OCCUR                       $3AF09520
       TRA     SY11                - YES                                3AF09530
       CLA     1,2                 IF LAST BUFFER                       3AF09540
       ANA     L(377)              AHEAD IS                             3AF09550
       PAX     0,1                 SYNCED OUT                           3AF09560
       TXL     SY9,1,0             INITIATE ANOTHER                     3AF09570
SY5.6  RIR     100000                                                   3AF09580
       BES     *-1+NOHYP/NOHYP*1-*                                      3AF09590
       RNT     NORED               IF URR OCCURRED                      3AF09600
       TRA     URREX               TAKE ERROR EXIT                      3AF09610
SY8.2  AXT     **,4                RESTORE IR4                          3AF09620
SY8.1  AXT     **,1                IR1                                  3AF09630
       TTR     1,1                 RETURN                               3AF09640
       SPACE   1                                                        3AF09650
*                          LAST BUFFER SYNCED                           3AF09660
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        3AF09670
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    3AF09680
       TRA     SY5.6               CONTINUE                             3AF09690
       SPACE   1                                                        3AF09700
*                  NO BUFFER AVAILABLE WHEN NEEDED                      3AF09710
       RFT     NOREOF              IF ON TRY                           $3AF09720
       TRA     SY10-5              TO GET A BUFFER                   (8)3AF09730
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   3AF09740
       TRA     RW17                TAKE IT , ELSE GIVE                  3AF09750
       STR                         ILLEGAL FILE USE                     3AF09760
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                3AF09770
       RIR     NOREOF              SET TRIED ONCE                      $3AF09780
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       3AF09790
       TSX     BORBF,1             INITIATE READ                        3AF09800
       TRA     SY9.3-2             COULD NOT                           $3AF09810
       TRA     ACT                                                   (8)3AF09811
SY10   SIL     RBITS                   SET RUSH PRIORITY BITS           3AF09820
       AXC     1,4                                                      3AF09830
       NZT*    0,2                 TO BE SYNCED                         3AF09840
       TRA     SY10-3              -NO                               (8)3AF09850
ACT    TSX     ACTV+1,4            -YES, ACTIVATE PRIORITY           (8)3AF09860
       MZE     0,2                 THAT FILE                            3AF09870
       AXC     1,4                 WAIT UNTIL I/O IS                 (8)3AF09871
       ZET*    0,2                 COMPLETED ON THAT UNIT            (8)3AF09872
       TRA     *-1                                                   (8)3AF09873
       TRA     SY3                 CONTINUE SYNC OUT                    3AF09880
       SPACE   1                                                        3AF09890
*                             EOF ON SYNC                               3AF09900
SY11   TSX     DISCON,1      DISCONNECT BUFFER                     IBJOB3AF09910
       TRA     EOFEX                                                    3AF09920
       TTL                         READ SUBROUTINE-BORBF-               3AF09930
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   3AF09940
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            3AF09950
       SPACE   1                                                        3AF09960
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  3AF09970
*              ERROR RETURN        INDEX REGISTERS ARE                  3AF09980
*              NORMAL RETURN        NOT DISTURBED                       3AF09990
       SPACE   1                                                        3AF10000
BORBF  SXA     BOR8,1              SAVE IR1                             3AF10010
       SXA     BOR2,4              SAVE IR4                             3AF10020
       LAC     LBC,4               IF NO BUFFERS                        3AF10030
       ENB     L(0)                                                    $3AF10040
       CLA*    0,4                 ARE PRESENTLY                        3AF10050
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               3AF10060
       LXA     BOR8,1              RESTORE IR1                          3AF10070
BOR2   AXT     **,4                RESTORE IR4                          3AF10080
       ENB     TRAPS                                                    3AF10090
       TRA     1,1                 AND EXIT                             3AF10100
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $3AF10110
       TXI     BOR2,1,-1           EXIT AT 2,1                          3AF10120
       STA     XERR                SAVE L(NEXT BUFFER)                 $3AF10130
       CLA     1,2                 IF INITIAL                           3AF10140
       PAX     0,4                 BUFFER DONT                          3AF10150
       TXL     *+3,4,0             ADJUST COUNTS                        3AF10160
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 3AF10170
       TRA     BOR2-1              NO BUFFER AVAILABLE                  3AF10180
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              3AF10190
       CLA     XERR                UPDATE POOL                         $3AF10200
       STA*    LBC                 BUFFER CHAIN                         3AF10210
       CAL     1,2                 UP COUNT BUFFERS                     3AF10220
       ADD     L(1)                IN USE BY                            3AF10230
       STA     1,2                 THE FILE                             3AF10240
       ENB     TRAPS               RESTORE TRAPPING                     3AF10250
       TSX     RDSEL,1             ISSUE STACKED SELECT                 3AF10260
BOR8   AXT     **,1                RESTORE IR1                          3AF10270
       TXI     BOR2,1,-1           EXIT AT 2,1                          3AF10280
       TTL                         INPUT BUFFER RELEASE ROUTINES        3AF10290
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  3AF10300
*              TSX  RELES,1        CANNOT BE USED AT TRAP               3AF10310
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     3AF10320
       SPACE   1                                                        3AF10330
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               3AF10340
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               3AF10350
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     3AF10360
       SPACE   1                                                        3AF10370
DISCON SIR     DONLY               SET DISCONNECT ONLY                  3AF10380
RELES  SIR     RDSWIT              SET RELEASE MODE                     3AF10390
       SXA     RE2,1               SAVE IR1                             3AF10400
       SXA     RE2+1,4             AND IR4                              3AF10410
RE1    CLA*    2,2                 IS A BUFFER                          3AF10420
       TPL     RE4                 CONNECTED NORMALLY                   3AF10430
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            3AF10440
       ANA     7PRE                IF BUFFER HELD                       3AF10450
       TZE     RE2                 OR NO BUFFER CONNECTED               3AF10460
       SPACE   1                                                        3AF10470
*                         RELEASE HELD BUFFERS                          3AF10480
       RNT     RDSWIT              RELEASE OR                           3AF10490
       TRA     TR1                 TRUNCATE                             3AF10500
       LAC     LBC,4                                                    3AF10510
       LDQ     2,2                 L(BUF TO MQ)                         3AF10520
       TSX     POOLRD,1            RELEASE BUFFER                       3AF10530
RE1.5  CLA     TCHAN               CHAIN HELD                           3AF10540
       STA     2,2                 BUFFERS                              3AF10550
       RNT     CPYFN               UNLESS COPYING                       3AF10560
       TRA     RE1                 RELEASE ALL HELD BUFFERS             3AF10570
RE2    AXT     **,1                RESTORE IR1                          3AF10580
       AXT     **,4                AND IR4                              3AF10590
       RNT     GENER               IF GENERATED DISCONNECT SAVE         3AF10600
       RIR     DISCN               COMMAND DISCONNECT BIT               3AF10610
       RIR     EOBITS                                                   3AF10620
       RFT     RDSWIT                                                   3AF10630
       RIR     XECNT                                                    3AF10640
       TRA     1,1                 EXIT                                 3AF10650
       SPACE   1                                                        3AF10660
*                        RELEASE BUFFER IN USE                          3AF10670
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            3AF10680
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    3AF10690
       RNT     RDSWIT              RELEASE OR                           3AF10700
       TRA     TR1.1               TRUNCATE                             3AF10710
       RNT     HOLD                IS HOLD BIT ON                       3AF10720
       TRA     RE5                 ENTER HOLD                           3AF10730
       TSX     ENTHLD,4            BUFFER INTO                          3AF10740
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          3AF10750
       TRA     RE6                 HOLD CHAIN                           3AF10760
RE5    LDQ     2,2                 L(BUF) TO MQ                         3AF10770
       LAC     LBC,4                                                    3AF10780
       TSX     POOLRD,1            BUFFER TO POOL                       3AF10790
RE6    CLA     LBC                 SET FILE TO REFER                    3AF10800
       STA     2,2                 TO POOL                              3AF10810
       TRA     RE2                                                      3AF10820
       TTL                         RELEASE INPUT BUFFER TO POOL         3AF10830
*                            IR2 = -L(FILE)                             3AF10840
*                            IR4 = -L(POOL)                             3AF10850
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        3AF10860
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        3AF10870
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               3AF10880
       SPACE   1                                                        3AF10890
TOPOOL LDI     1,2                 FILE BITS TO                         3AF10900
       RIR     77777               SI-RIGHT SIDE TO ZERO                3AF10910
TOCLOS ENB     L(0)                TRAP PROTECT                         3AF10920
       CAL     1,2                 REDUCE                               3AF10930
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     3AF10940
       STA     1,2                 USE COUNT                            3AF10950
*                      RELEASE INPUT BUF TO POOL                        3AF10960
POOLRD ENB     L(0)                TRAP PROTECT                         3AF10970
       CAL     1,2                 REDUCE CT                            3AF10980
       SUB     L(400)              OF BUFS LOGICALLY                    3AF10990
       STA     1,2                 IN USE BY FILE                       3AF11000
       RNT     RDSWIT              IS THE RELEASE MODE ON               3AF11010
       TRA     TCHAN               NO                                   3AF11020
TCHAN  XCA     **                  L(BUF) TO AC                         3AF11030
PRD1   SXA     PRD2,1              SAVE IR1                             3AF11040
       RNT     CPYFN               UNLESS COPYING                       3AF11050
       TSX     BTP2,1              RELEASE BUF TO POOL                  3AF11060
       CLA     1,2                 IF LAST                              3AF11070
       PAX     0,1                 BUFFER                               3AF11080
       TXL     PRD2,1,0            IN USE THEN SKIP                     3AF11090
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 3AF11100
PRD2   AXT     **,1                RESTORE IR1                          3AF11110
       NZT     INTRAP              UNLESS AT TRAP                       3AF11120
       ENB     TRAPS               RESTORE TRAPPING                     3AF11130
       TRA     1,1                 EXIT                                 3AF11140
       TTL                         WRITE SUBROUTINE-TRUNC-              3AF11150
*                      TRUNCATE AN OUTPUT BUFFER                        3AF11160
       SPACE   1                                                        3AF11170
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          3AF11180
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    3AF11190
       SPACE   1                                                        3AF11200
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    3AF11210
       TRA     RELES+1             USE RELES ROUTINE                    3AF11220
       SPACE   1                                                        3AF11230
*                        TRUNCATE HELD BUFFERS                          3AF11240
TR1    CLA*    2,2                 HOLD CODE TO AC                      3AF11250
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         3AF11260
       CLA     TCHAN               UPDATE FILE                          3AF11270
       STA     2,2                 HOLD CHAIN                           3AF11280
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        3AF11290
       SPACE   1                                                        3AF11300
*                        TRUNCATE BUFFER IN USE                         3AF11310
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $3AF11320
       TRA     TR2                 NO, WRITTEN                         $3AF11330
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $3AF11340
       TRA     TR3                                                     $3AF11350
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $3AF11360
       SXA     TR10+2,1                                                $3AF11370
       CAL     2,2                 FIND                                $3AF11380
       ACL     L(1)                L(IORT)                              3AF11390
       STA     TR5                                                      3AF11400
       CLA*    2,2                 PICK UP LOCATOR                     $3AF11410
       TMI     TR5+1               IN HOLD CHAIN                       $3AF11420
TR5    STA     **                                                       3AF11430
       CLA*    TR5                 GET LOCATOR                         $3AF11440
       SUB     TR5                 FORM COUNT AND STORE                $3AF11450
       SUB     L(1)                IN IORT                              3AF11460
       ALS     18                                                       3AF11470
       STD*    TR5                                                      3AF11480
       ANA     DECRE                                                    3AF11490
       TNZ     TR10+1              EXIT THEN                            3AF11500
       LDQ     2,2                 DONT WRITE BUFFER OUT                3AF11510
       LAC     LBC,4               L(POOL) TO IR4                       3AF11520
       CAL     1,4                 RESTORE                              3AF11530
       ARS     4                   SIZE TO                              3AF11540
       STD*    TR5                 IORT                                 3AF11550
       ENB     L(0)                TRAP PROTECT                         3AF11560
       TSX     BTP1,1              BUFFER IN POOL                       3AF11570
       CLA     3,2                 IF AN INTERNAL FILE THEN             3AF11580
       TPL     *+2                 ADJUST BUFFER COUNTS                 3AF11590
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         3AF11600
       ENB     TRAPS               ALLOW TRAPS AND EXIT SO              3AF11610
       LXA     TR10+2,1            NO WRITE                            $3AF11620
TR10   TRA     1,1                 IS EXECUTED                          3AF11630
       AXT     **,4                RESTORE IRS                         $3AF11640
       AXT     **,1                AND RETURN                          $3AF11650
       TRA     1,4                                                     $3AF11660
TR2    TSX     WRSEL,1             WRITE BUFFER                         3AF11670
TR3    CLA     LBC                 SET FILE REFERENCE                   3AF11680
       STA     2,2                 TO POOL                              3AF11690
       TRA     RE2                                                      3AF11700
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       3AF11710
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             3AF11720
*              TSX  GTBUF,1        IR2 =-L(FILE)                        3AF11730
*              RETURN               INDICES NOT DISTURBED               3AF11740
       SPACE   1                                                        3AF11750
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            3AF11760
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    3AF11770
*              RETURN               IR1 DESTROYED                       3AF11780
       SPACE   1                                                        3AF11790
OBTIB  SXA     GET8,4              SAVE IR4                             3AF11800
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $3AF11810
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           3AF11820
       TRA     1,4                 EXIT                                 3AF11830
       SPACE   1                                                        3AF11840
GTBUF  SXA     GET8,4              SAVE IR4                             3AF11850
GET0   SXA     GET8+1,1            SAVE IR1                             3AF11860
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           3AF11870
       CLA     1,4                 NECESSARY IT WILL BE STARTED         3AF11880
       LDQ*    0,4                 WITH FIRST FILE                      3AF11890
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          3AF11900
       SPACE   1                                                        3AF11910
*                         NO BUFFER AVAILABLE                           3AF11920
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   3AF11930
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $3AF11940
       LAC     LBC,4               L(BPCW)                           $5$3AF11950
       LDQ*    0,4                                                   $5$3AF11960
       TQP     GET5                BUF AVAIL-JOIN IT                   $3AF11970
       TRA     SY9.3               NONE-TRY EOB                        $3AF11980
       STA     CPY7                SETUP SYNC SEQUENCE                  3AF11990
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           3AF12000
       CLA     0,1                 PLACE L(UCW)                         3AF12010
CPY7   PAC     **,4                IN IR4                               3AF12020
       CLA     1,4                 IF PRIORITY WORD                     3AF12030
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             3AF12040
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          3AF12050
       TSX     ACTV+1,4            ACTIVATE THIS UNIT GIVING            3AF12060
1TAG   MZE     0,1                 IT HIGH PRIORITY                     3AF12070
       LAC     LBC,4               WAIT UNTIL                           3AF12080
       CLA*    0,4                 A BUFFER PLACED IN                   3AF12090
       TPL     GET5                POOL BY TRAP                         3AF12100
       TRA     CPY7-2                                               (12)3AF12110
       EJECT                                                            3AF12120
*                     UNIT HAS NO REQUESTS WAITING                      3AF12130
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   3AF12140
       ANA     NEOTBT              AND EOT CONDITION                    3AF12150
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             3AF12160
GET3   CLA     1,1                 ADVANCE AROUND                       3AF12170
       TRA     GET1                OUTPUT CHAIN                         3AF12180
       SPACE   1                                                        3AF12190
*                  GOT A BUFFER - READY IT FOR OUTPUT                   3AF12200
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 3AF12210
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     3AF12220
       ENB     L(0)                TRAP PROTECT                         3AF12230
       RNT     HELD                IF A HELD BUFFER                     3AF12240
       TRA     GET6                EXIST,COUNT                          3AF12250
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           3AF12260
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    3AF12270
       LAC     LBC,4               L(POOL) TO IR4                       3AF12280
       CAL     7PRE                SET CODE 7                           3AF12290
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            3AF12300
GET6   CLA*    0,4                 UPDATE AVAILABLE                     3AF12310
       STA     CPY7                BUFFER CHAIN                         3AF12320
       CLA     0,4                 SET L(BUF)                           3AF12330
       STA     2,2                 INTO FILE REFERENCE                  3AF12340
       ACL     L(1)                SAVE                                 3AF12350
       STA     GET7                L(IORT)                              3AF12360
       ACL     L(1)                SET LOCATOR                          3AF12370
       STA*    2,2                 = PZE *+2,,**                        3AF12380
       CAL     CPY7                UPDATE POOL TO REFER                 3AF12390
       STA     0,4                 TO NEXT BUFFER                       3AF12400
       ENB     TRAPS               ALLOW TRAPS                          3AF12410
GET7   CLA     **                  PICKUP IORT                          3AF12420
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     3AF12430
GET8   AXT     **,4                RESTORE IR4                          3AF12440
       AXT     **,1                1                                    3AF12450
       RIR     FREEUP              RESET FREEUP BIT                    $3AF12460
       TRA     1,1                 EXIT                                 3AF12470
       TTL                         HOLD FUNCTION SUBROUTINES            3AF12480
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              3AF12490
       SPACE   1                                                        3AF12500
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  3AF12510
*              RETURN              IR1 DESTROYED                        3AF12520
       SPACE   1                                                        3AF12530
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      3AF12540
       LFT     OUTPUT                                                  $3AF12550
       TRA     FIX                                                     $3AF12560
       TPL     FIX                 IF REGEN INTERNAL FILE              $3AF12570
FIX1   RFT     HELD                IF ALREADY HOLDING                  $3AF12580
       TRA     EN1                 SKIP INITIALIZATION                  3AF12590
       PAX     0,1                 ENTER 1ST BUFFER                     3AF12600
       SIR     HELD                IN CHAIN                             3AF12610
       SXD     HOLDS,1             PRESET * STORE                       3AF12620
       TRA     EN1+1                                                   $3AF12630
FIX    PAC     0,1                 BCW TO IR1                          $3AF12640
       CLA*    2,2                 GET LOCATOR AND                     $3AF12650
       STA     1,1                 SAVE FOR WRITE                      $3AF12660
       CLA     2,2                 IN ITS IORT                         $3AF12670
       TRA     FIX1                PUT IN HOLD CHAIN                   $3AF12680
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                3AF12690
       STA     HOLDS               UPDATE CHAIN                         3AF12700
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $3AF12710
       STP*    HOLDS               IN BUFFER                            3AF12720
       TRA     1,4                                                     $3AF12730
       SPACE   1                                                        3AF12740
*                           SETUP HOLD CHAIN                            3AF12750
*                           IN FILE AT EXIT                             3AF12760
*                          FROM READ OR WRITE                           3AF12770
       SPACE   1                                                        3AF12780
*                           CALLING SEQUENCE                            3AF12790
       SPACE   1                                                        3AF12800
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        3AF12810
*              RETURN                                                   3AF12820
       SPACE   1                                                        3AF12830
HOOK   CLA     2,2                                                      3AF12840
       STA*    HOLDS                                                    3AF12850
       LXD     HOLDS,1                                                  3AF12860
       PXA     0,1                                                      3AF12870
       STA     2,2                                                      3AF12880
       RIR     HELD                                                     3AF12890
       TRA     1,4                                                      3AF12900
       TTL             NON-DATA SELECT CODES FOR IOEX                   3AF12910
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        3AF12920
       SPACE   1                                                        3AF12930
HFPNP  EQU     42                  FILE PROTECT                         3AF12940
HUNLP  EQU     39                  UNLOAD                               3AF12950
HSKFP  EQU     37                  SKIP FILE                            3AF12960
HSKRP  EQU     36                  SKIP RECORD                          3AF12970
HBSFP  EQU     35                  BACKSPACE FILE                       3AF12980
HBSRP  EQU     34                  BACKSPACE RECORD                     3AF12990
HWTMP  EQU     33                  WRITE TAPE MARK                      3AF13000
HERGP  EQU     32                  ERASE LONG GAP                       3AF13010
HRUNP  EQU     31                  REWIND AND UNLOAD                    3AF13020
HRWDP  EQU     30                  REWIND                               3AF13030
WEFOP  EQU     7                   WEF                                  3AF13040
BSFOP  EQU     6                   BSF                                  3AF13050
BSROP  EQU     5                   BSR                                  3AF13060
RUNOP  EQU     4                   RUN                                  3AF13070
REWOP  EQU     3                   REW                                  3AF13080
SDNHP  EQU     2                   SDNH                                 3AF13090
SDNLP  EQU     1                   SDNL                                 3AF13100
TESTP  EQU     0                   TEST OP                              3AF13110
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         3AF13120
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 3AF13130
*      TSX  WRSEL,1                          2,2 (21-35)                3AF13140
*         TSX    WRSLH,1         WRITE HELD BUFFER                      3AF13150
*                                  IR4 IS DESTROYED                     3AF13160
       SPACE   1                                                        3AF13170
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $3AF13180
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      3AF13190
SEL4   PZE     **,,ISSUE           SELECT WORD                          3AF13200
WRSEL  TSX     SETWR,4                 SET UP TO WRITE                  3AF13210
       LDQ     2,2                 L(BUF) TO MQ                         3AF13220
RDSEL  XCA                                                              3AF13230
       STA     SEL4                L(BUF) TO SEL4                       3AF13240
       LDQ     L(0)D               SET BUFFER                           3AF13250
       LGL     18                  1ST WD =                             3AF13260
       SLW*    SEL4                PZE L(0),,*                          3AF13270
SEL0   AXC     1,4                                                      3AF13280
       ENB     L(0)                                                     3AF13290
       CLA*    0,2                 CHECK FILE ALREADY                   3AF13300
       TZE     SEL3                ACTIVE                               3AF13310
       STA     SEL1                YES                                  3AF13320
       CAL     FCW                                                     $3AF13330
       AXT     0,4                                                     $3AF13340
       ERA*    0,2                 IS THIS THE SAME FILE               $3AF13350
       ANA     ADDRS                                                   $3AF13360
       TZE     SEL1                YES                                 $3AF13370
       TSX   (ACTVX,4              NO                                  $3AF13380
       MZE     0,2                                                     $3AF13390
       TRA     SEL0                                                    $3AF13400
SEL1   CLA     **                  ADD NEW                              3AF13410
       PDC     0,4                 BUFFER TO END                        3AF13420
       CLA     SEL4                OF EXISTING                          3AF13430
       STA     0,4                 BUFFER CHAIN                         3AF13440
       ALS     18                  SET L(NEW BUF) INTO                  3AF13450
       STD*    SEL1                DECREMENT 1ST ENTRY                  3AF13460
       ENB     TRAPS               ALLOW TRAPS                          3AF13470
       TRA     1,1                 EXIT                                 3AF13480
       SPACE   1                                                        3AF13490
*                         ENTER INITIAL SELECT                          3AF13500
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    3AF13510
       TRA     SEL6                GO HANDLE IT SPECIAL                 3AF13520
       AXT     0,4                 CHECK FOR                            3AF13530
       CLA*    0,2                 ENTERING INITIAL SELECT ON           3AF13540
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         3AF13550
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         3AF13560
       LGL     18                  HAS ENCOUNTERED EOT                  3AF13570
       STA     CPY7                IF SO THEN HANDLE                    3AF13580
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        3AF13590
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   3AF13600
       TSX     EOTOF,1                                                  3AF13610
       TSX     CPY6,4                                                   3AF13620
SEL2.4 AXT     **,1                RESTORE IR1                          3AF13630
SEL2.5 STI     TEMIND                                                  $3AF13640
       AXT     0,4                 GET FILE BLOCK ADDRESS              $3AF13650
       CAL     FCW                 AND STORE IN UCW ONE                $3AF13660
       STA*    0,2                                                     $3AF13670
       LDI*    0,2                 UCW 1                               $3AF13680
       LFT     20000               1301                                $3AF13690
       TRA     SEL2.6              MAYBE                               $3AF13700
       BES     *-3+NOCHX/NOCHX*3-*                                      3AF13710
SEL2.7 CAL     SEL4                NO                                  $3AF13720
       AXC     1,4                                                     $3AF13730
       LDI     TEMIND                                                  $3AF13740
       LFT     OUTPUT              OUTPUT                              $3AF13750
       ORA     FOR                 YES-SET BIT                         $3AF13760
       SLW*    0,2                 STORE ISSUE IN UCW 2                $3AF13770
       TSX     ACTV+1,4            ACTIVATE                             3AF13780
       PZE     0,2                 THIS FILE                            3AF13790
       TRA     1,1                                                      3AF13800
SEL2.6 LNT     100                 1301                                $3AF13810
       TRA     SEL8           NO                                       $3AF13820
       SXA     SEL2.8+1,1          YES                                 $3AF13830
       CLA     0,2                 PUT -L(UCB) IN IR4                  $3AF13840
       PAC     0,4                                                     $3AF13850
       LDQ     6,2                 CHECK IF EOF ON DISK                $3AF13860
       TQP     SEL2.8              NO                                  $3AF13870
       ARS     18                  PUT CORRECT SEEK                    $3AF13880
       STA     6,2                 IN WORD SEVEN                       $3AF13890
       STP     6,2                 AND TURN OFF EOF BIT                $3AF13900
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $3AF13910
       AXT     **,1                                                    $3AF13920
       TRA     SEL2.7         RETURN                                   $3AF13930
ENDTRK LDI     1,2                 RESET BUFFER USAGE                (7)3AF13991
       RIR     77777                                                 (7)3AF13992
       ZAC                         RESET END OF TRACKS SIGNAL        (7)3AF13993
       STT     6,2                                                   (7)3AF13994
       TRA     BOFEX                                                 (7)3AF13995
       BES     SEL2.6+NOCH/NOCH**-NOCH/NOCH*SEL2.6-*                   $3AF14000
SEL8   PXD     0,0                                                     $3AF14010
       LDI     1,2                                                     $3AF14020
       RFT     400000              IS THIS READ BACKWARD               $3AF14030
       CLA     SIX                 YES, SET BACKWARD READ MODE         $3AF14040
       ACL     SEL4                YES                                 $3AF14050
       AXC     3,4                 STORE ZERO                          $3AF14060
       STZ*    0,2                 IN UCW 4                            $3AF14070
       TRA     SEL2.7+1                                                $3AF14080
       BES     *-8+NOHYP/NOHYP*8-*                                     $3AF14090
TEMIND PZE                                                              3AF14100
       TTL 0                                                            3AF14110
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         3AF14120
SEL5   SXA     SEL5.6,1                                                 3AF14130
       ENB     L(0)                DISABLE TRAPS                        3AF14140
       TSX     BCKBB,1                                                  3AF14150
SEL5.6 AXT     **,1                RESTORE IR1                          3AF14160
       TRA     WRSEL               RETURN TO WRITE                      3AF14170
       SPACE   1                                                        3AF14180
*                        EOF OR EOT ENCOUNTERED                         3AF14190
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            3AF14200
       TRA     SEL7-1                                                   3AF14210
       LDQ     SEL4                RELEASE BUFFER                       3AF14220
       LAC     LBC,4               -L(POOL) TO IR4                      3AF14230
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  3AF14240
       SPACE   1                                                        3AF14250
*                             EOT OCCURRED                              3AF14260
       SXA     *+2,1               SAVE IR1                             3AF14270
SEL7   TSX     EOTOF,1             HANDLE EOT                           3AF14280
       AXT     **,1                RESTORE IR1                          3AF14290
       TRA     SEL0                AND CONTINUE                         3AF14300
       TTL                         DENSITY SETTING ROUTINE              3AF14310
*                             TSX DENSE,4                               3AF14320
       SPACE   1                                                        3AF14330
DENSE  CLA     1,2                 PLACE FILE                           3AF14340
       ANA     1TAG                DENSITY BIT                          3AF14350
       ALS     3                   IN DECREMENT                         3AF14360
       ACL     1DEC                ADD 1 TO FORM                        3AF14370
       STD     *+3                 LOW DEN. = 1                         3AF14380
       SXA     *+3,4               HI DEN. = 2                          3AF14390
       TSX     NDSEL+1,4           SET DENSITY                         $3AF14400
       PZE     0,2,**                                                   3AF14410
       AXT     **,4                RESTORE IR4                          3AF14420
       TRA     1,4                 EXIT                                 3AF14430
       TTL     7909 CHANNEL SELECT ROUTINES                             3AF14440
       LBT                         DISK                                $3AF14450
       TRA     HSELM               NO                                  $3AF14460
       BES     *-2+NOCHX/NOCHX*2-*                                      3AF14470
MSEL   LFT     7100                TEST UNUSUAL END                    $3AF14480
       TRA     DERR                                                     3AF14490
       LDI     0,2                                                     $3AF14500
       CLA*    1,4            GET FLAG WORD USED                       $3AF14510
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $3AF14520
       ADD     L(1)           FOR THIS OPERATION                       $3AF14530
       STA     *+3                                                     $3AF14540
       LFT     200000              EOF FROM LAST READ                  $3AF14550
       TRA     SEOFI               YES                                 $3AF14560
       LDI     **             PUT FLAG WORD IN INDICATORS              $3AF14570
       LNT     400000              IS RECORD COMPLETE                  $3AF14580
       TRA     FINREC         NO-FINISH RECORD                         $3AF14590
       LFT     200000         EOF OCCUR                                $3AF14600
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $3AF14610
       LDI     FOR            SET INDICATORS AS 7607                   $3AF14620
SELM2  CLA     1,2                 IF MIXED MODE                        3AF14630
       TMI     1KA                 SKIP OUT                             3AF14640
       CAL     1,4                                                      3AF14650
       SUB     L(1)                                                    $3AF14660
       SXA     *+3,4          SAVE IR4                                 $3AF14670
       PAC     0,4            IR4=-L(COMM-1)                           $3AF14680
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $3AF14690
SELM5  AXT     **,4                RESTORE IR4                         $3AF14700
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $3AF14710
       CLA     1,4                 PUT ADDRESS OF                      $3AF14720
       PAC     0,1                 COMD CHAIN IN IR 1                  $3AF14730
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $3AF14740
       STZ     1,1                 ZERO OUT COUNT SAVED                $3AF14750
       CAL     8,1                                                     $3AF14760
       ACL     L(1)                                                    $3AF14770
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $3AF14780
       CAL     FCW                 RESTORE IORT                        $3AF14790
       STP     -1,1                IN BUFFER                           $3AF14800
       LDQ     1,4                                                     $3AF14810
       NZT*    1,4                 IF ZERO-ZERO OUT                    $3AF14820
       TRA     *+4                 AND KILL SEEK                       $3AF14830
       LFT     200000              IF EOF                              $3AF14840
       TRA     *+3                 KILL SEEK OR                        $3AF14850
       TRA     *+4                 ELSE PROCEED                        $3AF14860
       STZ     1,4                                                     $3AF14870
       CAL     2,4                                                     $3AF14880
       STO     2,4                                                     $3AF14890
       TQP     SELM4               IF MQ + READ IS DONE                $3AF14900
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $3AF14910
       TRA     SELM3               GO POST WRITE COMPLETION            $3AF14920
SELM4  CAL     *+1                                                     $3AF14930
       XCA     **                  MQ = ADDRESS OF BUF CW              $3AF14940
       SXA     C8,1                                                    $3AF14950
       CAL     -1,1                PICK UP COUNT FROM FLAG             $3AF14960
 ER    AXT     **,1                                                    $3AF14970
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $3AF14980
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $3AF14990
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $3AF15000
       LFT     200000              IF EOF GO                           $3AF15010
       TSX     EOF,4               TAKE CARE OF IT                     $3AF15020
       CLA     4,2                 PICK UP AND                         $3AF15030
       PDC     0,4                 RESTORE THE                         $3AF15040
       CAL     1,4                 BUFFER SIZE                         $3AF15050
       ARS     4                   IN THE IORT                         $3AF15060
       STD     -1,1                NOW GO POST                         $3AF15070
       XEC     SELM5               READ COMPLETION                     $3AF15080
       TRA     POSTR+2             SOME JOB                            $3AF15090
EOF    ENB     L(0)                                                    $3AF15100
       LDQ     0,2                 EXCHANGE START AND                  $3AF15110
       CAL     6,2                 FINISH OF FILE                      $3AF15120
       LGL     18                  PUT A MINUS                         $3AF15130
       STD     0,2                 IN WORD SEVEN                       $3AF15140
       STA     6,2                 TO INDICATE SPECIAL                 $3AF15150
       CLS     6,2                 HANDLING NEEDED                     $3AF15160
       STO     6,2                 FOR NEXT DATA OPER.                 $3AF15170
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $3AF15180
       TRA     1,4                 GO HOME                             $3AF15190
DEOF1  NZT     1,4            IF LAST BUFFER                           $3AF15200
       TRA     PSTR6          DO NOTHING                               $3AF15210
       CAL*    1,4                 DISK OPERATIONS                     $3AF15220
       STZ*    1,4                 ARE DONE FOR NOW                    $3AF15230
       STA     1,4                 RESTORE REQUEST CHAIN               $3AF15240
       TRA     PSTR2               AS TAPE (UCB2)                      $3AF15250
FINREC LFT     200000              IOCS EOF                            $3AF15260
       TRA     DEOF                YES                                 $3AF15270
       CLA     1,4                                                     $3AF15280
       PAC     0,1            -L(COMMANDS)IN IR1                       $3AF15290
       CLA     L(STL               IF READ HAS FILLED                  $3AF15300
       ERA     1,1                 BUFFER AREA,GO BACK                 $3AF15310
       TNZ     *+3                 AS FINISHED RECORD                  $3AF15320
       LXA     S3+1,1                                                  $3AF15330
       TRA     SEOF+1                                                  $3AF15340
       CLA     1,1            PICK UP AND COUNT                        $3AF15350
       SXA     *+2,2                                                   $3AF15360
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $3AF15370
D7     AXT     **,2                RESTORE IR2                         $3AF15380
       CLA     1,4            READ OR WRITE                            $3AF15390
       TPL     D4                  READ                                $3AF15400
       CAL     6,2                 UPDATE NEXT TRACK                   $3AF15410
       ACL     L(2)                TO BE USED BY FILE                  $3AF15420
       ALS     18                  STORE IN FLAG WORD                  $3AF15430
       STD*    8,1                                                     $3AF15440
 D4    CAL     9,1                 PUT THE NEXT READ                    3AF15450
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (3)3AF15460
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (3)3AF15461
       LXA     D7,2         RESTORE                                  (3)3AF15462
       STA     9,1            COMMAND                                  $3AF15470
       SXA     *+2,1                                                   $3AF15480
       TSX     CKSEE,1        IS SEEK NECESSARY                        $3AF15490
       AXT     **,1           RESTORE IR1                              $3AF15500
       CLA     6,2            CREATE BCD CHARACTERS                    $3AF15510
       SXA     *+2,4          FOR THE NEXT PREPARE                     $3AF15520
       TSX     (DECVA,4       TO VERIFY COMMAND                        $3AF15530
       AXT     **,4                                                    $3AF15540
       CLA     6,2            GET REC LAB                              $3AF15550
       ADD     TRKC                UP TRACK COUNT                      $3AF15560
       SLW     6,2                 FOR RECORD                          $3AF15570
       ARS     6                   AND PUT IN                          $3AF15580
       STO     *+2            P.V. WORD                                $3AF15590
       TSX     (FDAMT,2                                                $3AF15600
       PZE                                                             $3AF15610
       PZE     12,1                                                     3AF15620
       TRA     S3             RETURN TO IOEX                           $3AF15630
DERR   LNT     100                     INTERFACE CHECK                  3AF15640
       TRA     *+4                 NO                                  $3AF15650
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3AF15660
       SXA     CHATT-1,4           RETURN 2,4                          $3AF15670
       TRA     DCHG                                                    $3AF15680
       CLA     1,4                 GET COMMAND LIST ADDRESS            $3AF15690
       PAC     0,1                 FOR STZ OPERATION                   $3AF15700
       STO     .DERR                   SET UNUSUAL END FLAG             3AF15710
       STZ     1,4                 ZERO OUT REQUEST                    $3AF15720
       CLA     4,2                 GET BUFFER POOL                     $3AF15730
       PDC     0,4                 AND PLACE IT IN IR4                 $3AF15740
       CLA     0,1                 GET BUFFER IN USE                   $3AF15750
       STZ     ,1                  ZERO OUT COMMAND LIST               $3AF15760
       STZ     1,1                 CONTROL WORDS                       $3AF15770
DERG   PAC     0,1                 RESTORE                             $3AF15780
       STA     *-1                 IORT                                $3AF15790
       CLA     FCW                 AND                                 $3AF15800
       STP     1,1                 BUFFER                              $3AF15810
       CLA     1,4                 COUNT                               $3AF15820
       ARS     4                                                       $3AF15830
       STD     1,1                                                     $3AF15840
       CLA     DERG                                                    $3AF15850
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $3AF15860
       TRA     S3                  GO BACK                             $3AF15870
TRKC   OCT     010000000000                                            $3AF15880
TRKRC  OCT     007777777777                                            $3AF15890
SEOH   CLA     SIX                 SET EOF BIT ON                      $3AF15900
       STP     0,2                 FOR STRANGE EOF                     $3AF15910
       TRA     SEOF+1              FINISH READ                         $3AF15920
SEOFI  RIL     200000              TURN OFF                            $3AF15930
       STI     0,2                 STRANGE EOF                         $3AF15940
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *3AF15950
       TRA     SELM2                                                   *3AF15960
       TTL     SELECT PLUS FOR 7909 CHANNEL                             3AF15970
DRWRS  CLA     1,4                                                      3AF15980
       PAX     0,1                 IF THIS IS A LIST WORD               3AF15990
       TXL     *+2,1,LCOMAD-1      FOR NOPOOL OPTION                 (8)3AF15991
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        3AF16000
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             3AF16010
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     3AF16020
       TZE     *+3                                                      3AF16030
       TIX     *-2,1,COMADL-LCOMAD                                      3AF16040
       TRA     DER1                                                     3AF16050
       PXA     0,1                                                      3AF16060
       SUB     DRWRX                                                    3AF16070
       PAC     0,1                                                     $3AF16080
       STA     D6-3                SAVE LIST ADDRESS                    3AF16090
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          3AF16100
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  3AF16110
       CLA*    1,4                 GET BUFFERS AHEAD                   $3AF16120
       STD     0,1                                                      3AF16130
       CLA     D6-3                PICKUP LIST ADDRESS AND              3AF16140
       STA     1,4                 PUT IT IN UCW 2                      3AF16150
       CLA     1,4                                                     $3AF16160
DRWRW  LXA     S3+1,1              RESTORE IR 1                         3AF16170
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         3AF16180
       TPL     *+2                 READ                                $3AF16190
       ACL     L(3)                WRITE                               $3AF16200
       STA*    (RCHXI              SET START CHAN INST                 $3AF16210
       ZET*    (URRXI              FIRST TIME THRU                     $3AF16220
       TRA     C3                  NO                                  $3AF16230
       LXA     CHATT-1,1           WAS CHANNEL                         $3AF16240
       SXA     CHATT-1,0           LIST SET UP                         $3AF16250
       TXH     C3,1,0              YES                                 $3AF16260
       STA     C7                                                      $3AF16270
       CLA     1,4                 ADDRESS OF COMMD                    $3AF16280
       PAC     0,1                 LIST TO IR1                         $3AF16290
       ZET     1,1                 PARTIAL RECORD                      $3AF16300
       TRA     C3                  YES START CHANNEL                   $3AF16310
DRWRS1 CLA     L(6)                BCD MODE                            $3AF16320
       LNT     MODE                                                    $3AF16330
       CLA     L(22)               BINARY MODE                         $3AF16340
C7     STA     **                  ADDRESS OF SMS                      $3AF16350
       CLA     0,1            ADDRESS OF BUFFER                        $3AF16360
       ACL     L(1)                                                    $3AF16370
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $3AF16380
       ACL     L(1)                                                    $3AF16390
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $3AF16400
       CLA*    8,1            PICK UP COUNT                            $3AF16410
       ARS     18                  MOVE COUNT OVER                     $3AF16420
       ANA     ADDRS               MASK ALL BUT ADDRESS                $3AF16430
       SXA     *+2,2                                                   $3AF16440
       TSX     SIZE,2         CHECK RECORD SIZE                        $3AF16450
C9     AXT     **,2                                                    $3AF16460
       CAL     6,2                 CREATE BCD CHARACTER                $3AF16470
       ANA     TRKRC               CHANGE THE TRACK                    $3AF16480
       ADD     TRKC                COUNT TO ONE FOR RECORD             $3AF16490
       SLW     6,2                 PUT BACK TO FCB                     $3AF16500
       SXA     *+2,4          FOR PV COMMAND                           $3AF16510
       TSX     (DECVA,4                                                $3AF16520
C2     AXT     **,4                                                    $3AF16530
       CAL     6,2                 GET SEEK ADDRESS                    $3AF16540
       ADD     L(1)                                                    $3AF16550
       ALS     18                  MOVE SEEK ADDRESS OVER              $3AF16560
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $3AF16570
       CAL     6,2                 LABEL FOR                           $3AF16580
       ARS     6                   RECORD ADDRESS                      $3AF16590
       STO     *+2                                                     $3AF16600
       TSX     (FDAMT,2       PLACE P.V. COMMAND                       $3AF16610
       PZE                    BITS IN PROPER PLACE                     $3AF16620
       PZE     12,1                                                     3AF16630
       XEC     C9                  RESTORE IR2                         $3AF16640
       CLA     *-3                 SET INTERFACE BIT                   $3AF16650
       ANA     L(1)                ON FOR SMS INST.                    $3AF16660
       ORS*    C7                                                      $3AF16670
C3     XEC     S3+1                RESTORE IR1                         $3AF16680
       CAL     0,2                 IS THERE A STRANGE                  $3AF16690
       ALS     1                   EOF ON THIS FILE -                  $3AF16700
       PBT                                                             $3AF16710
       TRA     S3-1                NO                                  $3AF16720
       XEC     C2                  YES - RESTORE XR4                   $3AF16730
       CLA*    1,4                 YES                                 $3AF16740
       ACL     L(1)                GET FLAG WORD                       $3AF16750
       STA     DRWRS2              ADDRESS AND SAVE                    $3AF16760
       CAL     6,2                 GET SEEK ADDRESS                    $3AF16770
       SUB     L(1)                MINUS 1 AND STORE                   $3AF16780
       STA     3,4                 IN UCB 4 AND FCB 7                  $3AF16790
       STA     6,2                                                     $3AF16800
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $3AF16810
       AXT     SYSTWT,2            START CHANNEL                       $3AF16820
       PXA     0,2                 FOR A                               $3AF16830
       STA*    (RCHXI              TRAP                                $3AF16840
       TRA     S3-1                GO                                  $3AF16850
L(3)   PZE     3                                                        3AF16860
LCOMAD PZE                         CHAIN TO BUFFERS                    $3AF16870
       PZE                         COUNT FOR MULTI TRACK RECORD        $3AF16880
       SMS     **                  SET MODE FOR READ                   $3AF16890
       CTLR    *+9            PREPARE DISK FOR READ.                    3AF16900
       TCH     *+4                 GO DO DATA MOVEMENT                 $3AF16910
       SMS     **                  SET MODE FOR WRITE                  $3AF16920
       LCC     0                   COUNTER FOR WRITE CHECK             $3AF16930
       CTLW    *+5            PREPARE DISK FOR WRITE                    3AF16940
       CPYP    **,,1               FLAG WORD MOVEMENT                  $3AF16950
       CPYP    **,,**              DATA MOVEMENT                       $3AF16960
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $3AF16970
       TCH     SYSTWT              INTERUPT CPU                        $3AF16980
       DVTA    ,,                                                      $3AF16990
COMADL PZE                                                             $3AF17000
       PZE                                                             $3AF17010
       SMS     **                                                      $3AF17020
       CTLR    *+9                                                      3AF17030
       TCH     *+4                                                     $3AF17040
       SMS     **                                                      $3AF17050
       LCC     0                                                       $3AF17060
       CTLW    *+5                                                      3AF17070
       CPYP    **,,1                                                   $3AF17080
       CPYP    **,,**                                                  $3AF17090
       CPYD    0,,0                                                    $3AF17100
       TCH     SYSTWT                                                  $3AF17110
       DVTA    ,,                                                      $3AF17120
       PZE                                                             $3AF17130
       PZE                                                             $3AF17140
       SMS     **                                                      $3AF17150
       CTLR    *+9                                                      3AF17160
       TCH     *+4                                                     $3AF17170
       SMS     **                                                      $3AF17180
       LCC     0                                                       $3AF17190
       CTLW    *+5                                                      3AF17200
       CPYP    **,,1                                                   $3AF17210
       CPYP    **,,**                                                  $3AF17220
       CPYD    0,,0                                                    $3AF17230
       TCH     SYSTWT                                                  $3AF17240
       DVTA    ,,                                                      $3AF17250
       PZE                                                             $3AF17260
       PZE                                                             $3AF17270
       SMS     **                                                      $3AF17280
       CTLR    *+9                                                      3AF17290
       TCH     *+4                                                     $3AF17300
       SMS     **                                                      $3AF17310
       LCC     0                                                       $3AF17320
       CTLW    *+5                                                      3AF17330
       CPYP    **,,1                                                   $3AF17340
       CPYP    **,,**                                                  $3AF17350
       CPYD    0,,0                                                    $3AF17360
       TCH     SYSTWT                                                  $3AF17370
       DVTA    ,,                                                      $3AF17380
       PZE                                                             $3AF17390
       PZE                                                             $3AF17400
       SMS     **                                                      $3AF17410
       CTLR    *+9                                                      3AF17420
       TCH     *+4                                                     $3AF17430
       SMS     **                                                      $3AF17440
       LCC     0                                                       $3AF17450
       CTLW    *+5                                                      3AF17460
       CPYP    **,,1                                                   $3AF17470
       CPYP    **,,**                                                  $3AF17480
       CPYD    0,,0                                                    $3AF17490
       TCH     SYSTWT                                                  $3AF17500
       DVTA    ,,                                                      $3AF17510
       PZE                                                             $3AF17520
       PZE                                                             $3AF17530
       SMS     **                                                      $3AF17540
       CTLR    *+9                                                      3AF17550
       TCH     *+4                                                     $3AF17560
       SMS     **                                                      $3AF17570
       LCC     0                                                       $3AF17580
       CTLW    *+5                                                      3AF17590
       CPYP    **,,1                                                   $3AF17600
       CPYP    **,,**                                                  $3AF17610
       CPYD    0,,0                                                    $3AF17620
       TCH     SYSTWT                                                  $3AF17630
       DVTA    ,,                                                      $3AF17640
       PZE                                                             $3AF17650
       PZE                                                             $3AF17660
       SMS     **                                                      $3AF17670
       CTLR    *+9                                                      3AF17680
       TCH     *+4                                                     $3AF17690
       SMS     **                                                      $3AF17700
       LCC     0                                                       $3AF17710
       CTLW    *+5                                                      3AF17720
       CPYP    **,,1                                                   $3AF17730
       CPYP    **,,**                                                  $3AF17740
       CPYD    0,,0                                                    $3AF17750
       TCH     SYSTWT                                                  $3AF17760
       DVTA    ,,                                                      $3AF17770
       PZE                                                             $3AF17780
       PZE                                                             $3AF17790
       SMS     **                                                      $3AF17800
       CTLR    *+9                                                      3AF17810
       TCH     *+4                                                     $3AF17820
       SMS     **                                                      $3AF17830
       LCC     0                                                       $3AF17840
       CTLW    *+5                                                      3AF17850
       CPYP    **,,1                                                   $3AF17860
       CPYP    **,,**                                                  $3AF17870
       CPYD    0,,0                                                    $3AF17880
       TCH     SYSTWT                                                  $3AF17890
       DVTA    ,,                                                      $3AF17900
       PZE                                                             $3AF17910
       PZE                                                             $3AF17920
       SMS     **                                                      $3AF17930
       CTLR    *+9                                                      3AF17940
       TCH     *+4                                                     $3AF17950
       SMS     **                                                      $3AF17960
       LCC     0                                                       $3AF17970
       CTLW    *+5                                                      3AF17980
       CPYP    **,,1                                                   $3AF17990
       CPYP    **,,**                                                  $3AF18000
       CPYD    0,,0                                                    $3AF18010
       TCH     SYSTWT                                                  $3AF18020
       DVTA    ,,                                                      $3AF18030
       PZE                                                             $3AF18040
       PZE                                                             $3AF18050
       SMS     **                                                      $3AF18060
       CTLR    *+9                                                      3AF18070
       TCH     *+4                                                     $3AF18080
       SMS     **                                                      $3AF18090
       LCC     0                                                       $3AF18100
       CTLW    *+5                                                      3AF18110
       CPYP    **,,1                                                   $3AF18120
       CPYP    **,,**                                                  $3AF18130
       CPYD    0,,0                                                    $3AF18140
       TCH     SYSTWT                                                  $3AF18150
       DVTA    ,,                                                      $3AF18160
ENDLIS BES     LCOMAD+NOCH*14-*                                         3AF18170
       TTL 0                                                           $3AF18180
*                                                                      $3AF18190
*              TSX CKSEE,1                                             $3AF18200
*              RETURN                                                  $3AF18210
*                                                                      $3AF18220
*                                                                      $3AF18230
CKSEE  CAL     6,2            UPDATE SEEK                              $3AF18240
       ACL     L(4)                                                    $3AF18250
       ERA     7,2            ADDRESS                                  $3AF18260
       ANA     ADDRS                                                   $3AF18270
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $3AF18280
       TXH     D9,1,-TEMIND                                            $3AF18290
       CAL     6,2                                                     $3AF18300
       ADD     L(1)                                                    $3AF18310
       STA     6,2            NEXT ADDRESS FOR SEEK                    $3AF18320
       CAL     3,4                                                     $3AF18330
       ADD     L(1)                                                    $3AF18340
       STA     3,4                 UPDATE SEEK ADDRESS                 $3AF18350
       ERA     6,2                 SAME ARM POSITION                   $3AF18360
       ANA     ADDRS               AS DESIRED                          $3AF18370
       TZE     D8                  YES                                 $3AF18380
D9     CAL     6,2                 NO, PUT DESIRED                     $3AF18390
       STA     3,4                 POSITION IN REQUEST                 $3AF18400
       TRA     D6                  AND ASK FOR SEEK                    $3AF18410
D8     CLA     3,4                 GET POSITION AND                    $3AF18420
       ANA     ADDRS          CHECK IF ANOTHER                         $3AF18430
       XCA                    SEEK NEC. NOW                            $3AF18440
       PXA     **,0                                                     3AF18450
       DVP     L(40)                                                   $3AF18460
       TNZ     1,1            RETURN IF NO SEEK                        $3AF18470
D6     CLS     2,4            SET 3RD UCW TO                           $3AF18480
       STO     2,4            DEMAND A SEEK                            $3AF18490
       TRA     1,1                                                     $3AF18500
*                                                                      $3AF18510
*              COUNT IN ACC                                            $3AF18520
*              TSX SIZE,2                                              $3AF18530
*              RETURN                                                  $3AF18540
*                                                                      $3AF18550
 SIZE  SXA     C11,2        SAVE IR2                                 (3)3AF18560
       XCA                  SAVE COUNT                               (3)3AF18570
       CAL     0,4          UCW1                                     (3)3AF18580
       ARS     6            MOVE AND                        7=1302   (3)3AF18590
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (3)3AF18600
       PDX     0,2          DEVICE TO IR2                   1=1301   (3)3AF18610
 SVCOD XCA     **           RESTORE COUNT IN AC. INST ADDR SAVES CODE(3)3AF18620
       TIX     *+1,2,5      IF 1302,MAKE CODE A 2                    (3)3AF18630
       SXA     *-2,2        SAVE THE CODE                            (3)3AF18640
       SUB     L(STL,2      SUB FULL TRACK FROM WORD COUNT           (3)3AF18650
       TMI     D1           LESS THAN OR                             (3)3AF18660
       TZE     D1           EQUAL TO FULL TRACK TRA TO D1            (3)3AF18670
       STA     1,1          SAVE EXTRA WORD COUNT                    (3)3AF18680
       CLA     L(STL,2      GET FULL TRACK                           (3)3AF18690
 C1    SLW*    8,1          PUT IN FLAG WORD                         (3)3AF18700
       ALS     18           PUT COUNT IN                             (3)3AF18710
       STD     9,1          COPY COMMAND                             (3)3AF18720
 C11   AXT     **,2         PREPARE TO RETURN                        (3)3AF18730
       TRA     1,2          RETURN                                   (3)3AF18740
 D1    ADD     L(STL,2      GET COUNT BACK                           (3)3AF18750
       STL     1,1          MAKE FALSE COUNT                         (3)3AF18760
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (3)3AF18770
       TXI     C1,0,7       FINISH UP                                (3)3AF18780
 ENTRK CLA     TRKRC        SET END OF TRACK                         (3)3AF18790
       STT     6,2          INDICATION IN FCW7                       (3)3AF18800
       TRA     CKSEE+5      AND RETURN                               (3)3AF18810
       PZE     524          7320 DRUM TRACKSIZE                      (3)3AF18820
       PZE     969          1302 DISK TRACKSIZE                      (3)3AF18821
       PZE     465          1301 DISK TRACKSIZE                      (3)3AF18822
 L(STL PZE     D2           LOCATION OF STL FOR LATER COMPARE        (3)3AF18823
       BES     MSEL+NOCH/NOCH**-NOCH/NOCH*MSEL-*                       $3AF18830
HBEG   SMS     **                  SET INTERFACE                       $3AF18840
       LIPT    *+1                 LEAVE INTERUPT STATUS               $3AF18850
       CTLR    *+7                 SELECT FOR READ                     $3AF18860
       TCH     *+3                 DO IO                               $3AF18870
       SMS     **                  SET INTERFACE                       $3AF18880
       CTLW    *+4                 SELECT FOR WRITE                    $3AF18890
       CPYP    **,,**              DO IO                               $3AF18900
       CPYD    0,,0                                                    $3AF18910
       TCH     SYSTWT              INTERUPT                            $3AF18920
       OCT     120600120112        HSEL AND EOS                        $3AF18930
HLIS   SMS     **                                                      $3AF18940
       LIPT    *+1                                                     $3AF18950
       CTLR    *+7                                                     $3AF18960
       TCH     *+3                                                     $3AF18970
       SMS     **                                                      $3AF18980
       CTLW    *+4                                                     $3AF18990
       CPYP    **,,**                                                  $3AF19000
       CPYD    0,,0                                                    $3AF19010
       TCH     SYSTWT                                                  $3AF19020
       OCT     120600120112                                            $3AF19030
       SMS     **                                                      $3AF19040
       LIPT    *+1                                                     $3AF19050
       CTLR    *+7                                                     $3AF19060
       TCH     *+3                                                     $3AF19070
       SMS     **                                                      $3AF19080
       CTLW    *+4                                                     $3AF19090
       CPYP    **,,**                                                  $3AF19100
       CPYD    0,,0                                                    $3AF19110
       TCH     SYSTWT                                                  $3AF19120
       OCT     120600120112                                            $3AF19130
       SMS     **                                                      $3AF19140
       LIPT    *+1                                                     $3AF19150
       CTLR    *+7                                                     $3AF19160
       TCH     *+3                                                     $3AF19170
       SMS     **                                                      $3AF19180
       CTLW    *+4                                                     $3AF19190
       CPYP    **,,**                                                  $3AF19200
       CPYD    0,,0                                                    $3AF19210
       TCH     SYSTWT                                                  $3AF19220
       OCT     120600120112                                            $3AF19230
HEND   BES     HBEG+NOHYP*10-*                                         $3AF19240
       PZE     HEND                                                    $3AF19250
       TTL     SELECT ROUTINES FOR HYPER                                3AF19260
HYPL   CLA     3,4                 IF REINSTRUCT                       $3AF19270
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $3AF19280
       AXT     HEND-HBEG,1         FIND CH. LIST POINTER               $3AF19290
       SXA     HSXA,1              SAVE CH. LIST POINTER               $3AF19300
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $3AF19310
       ANA     DECRE               THIS CHANNEL TO USE                 $3AF19320
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $3AF19330
       ARS     18                                                      $3AF19340
       SUB     S3+1                                                    $3AF19350
       ANA     ADDRS                                                   $3AF19360
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $3AF19370
       TIX     HYPL+3,1,HLIS-HBEG                                      $3AF19380
       TRA     DER1                                                    $3AF19390
       LXA     S3+1,1              GET CHANNEL NO                      $3AF19400
       PXD     0,1                                                     $3AF19410
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $3AF19420
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $3AF19430
       PXA     0,1                 COMPUTE THE                         $3AF19440
       SUB     HEND                CHANNEL LIST                        $3AF19450
       STA     HSXA                START ADDRESS                       $3AF19460
       CLA     1,4                                                     $3AF19470
       ACL     L(1)                                                    $3AF19480
       STA     S0                  SAVE ADDRESS OF IORT                $3AF19490
       ACL     L(1)                PUT LOCATION OF                     $3AF19500
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $3AF19510
       STA     6,1                 ADDRESS FOR START CH.               $3AF19520
       XCA                         SAVE READ OR WRITE                  $3AF19530
S0     CLA     **                  GET NO. OF WORDS                     3AF19540
       STD     6,1                 STORE IN COPY                        3AF19550
       RNT     400000              READ BACKWARD                        3AF19560
       TRA     *+4                 NO                                   3AF19570
       ARS     18                  PUT LAST LOCATION                    3AF19580
       ACL     S0                  OF BUFFER IN                         3AF19590
       STA     6,1                 COPY COMMAND                         3AF19600
       CLA     3,4                 IS THIS A REINSTRUCT                 3AF19610
       TZE     HNSL                NO                                   3AF19620
       CLA     HYCLN               TURN OFF THE                         3AF19630
       ORS     2,1                 CONTROL OPERATION                    3AF19640
       ORS     5,1                                                      3AF19650
       LXA     S3+1,1                                                   3AF19660
       NZT*    (URRXI              IF NO ERROR                          3AF19670
       TRA     S3-1                START CHANNEL                        3AF19680
HNSL   CAL     HSXA                SMS ADDRESS                         $3AF19690
       STA     3,4                 SAVE CH LIST IN UCW4                $3AF19700
       TQP     *+2                 READ                                 3AF19710
       ADD     L(4)                WRITE                               $3AF19720
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $3AF19730
       STA*    (RCHXI              START CHANNEL ADDRESS               $3AF19740
       ZET*    (URRXI              BACK ON ERROR CONDITION             $3AF19750
       TRA     S3-1                YES, START CHANNEL                  $3AF19760
       CLA     CHATT-1             IF RETURN FROM                      $3AF19770
       ANA     ADDRS               SEL-WITH INTERFACE                  $3AF19780
       SXA     CHATT-1,0           NOT READY, THEN                     $3AF19790
       TNZ     S3-1                JUST TRY AGAIN                      $3AF19800
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $3AF19810
       CLA     0,4                 SAVE UNIT                           $3AF19820
       ANA     DEC15               NO. IN SEL ORDER                    $3AF19830
       ORA     HYSEL                                                   $3AF19840
       RFT     400000              IS THIS READ BACKWARD               $3AF19850
       ORA     L(64D)              YES, FIX SEL ORDER                  $3AF19860
       STD     9,1                                                     $3AF19870
       CLA     HYCTL               SET CONTROL                         $3AF19880
       ANS     2,1                 OPERATION ON                        $3AF19890
       ANS     5,1                                                     $3AF19900
       CLA     HSMSN               SET UP SMS COMMAND                  $3AF19910
       LNT     004000              IF OFF BCD MODE                     $3AF19920
       ORA     L(22)                                                   $3AF19930
       RFT     400000                                                  $3AF19940
       ORA     HSMSR               BACKWARD READ                       $3AF19950
       LDI     0,4                 PUT THE                             $3AF19960
       LFT     40                  INTERFACE                           $3AF19970
       ORA     L(1)                IN SMS                              $3AF19980
       STA     0,1                                                     $3AF19990
       STA     4,1                                                     $3AF20000
       LXA     S3+1,1                                                  $3AF20010
       TRA     S3-1                                                    $3AF20020
       TTL     SELECT MINUS FOR HYPER                                   3AF20030
HSELM  CLA     1,4                 UCW 2 TO AC                         $3AF20040
       ACL     L(1)                IORT ADDRESS OF BUF                 $3AF20050
       STA     HIORT                                                   $3AF20060
       ACL     L(1)                                                    $3AF20070
       LFT     7100                ERROR                               $3AF20080
       TRA     HEROR               YES                                 $3AF20090
       ALS     18                  DEC= 1ST WORD WRITTEN               $3AF20100
       STD     COMM                SAVE AS 76O7 CH.                    $3AF20110
HIORT  CLA     **                  LAST WORD WRITTEN                   $3AF20120
       STA     COMM                SAVE AS 7607 CH.                    $3AF20130
HRETN  CAL     S3                  FIX EXIT                            $3AF20140
       SUB     L(1)                FOR CONTINUED                       $3AF20150
       STA     S3                  PRIORITY ON UNIT                    $3AF20160
       CLA     1,2                 IF MIXED MODE                        3AF20170
       TPL     SELM1               SKIP OUT AFTER                       3AF20180
       STZ     3,4                 REINSTRUCT IS                        3AF20190
       TRA     MXMOD+3             MADE IMPOSSIBLE                      3AF20200
HSMRD  LDI     FOR                 GOOD READ                           $3AF20210
       LDQ     COMM                MAKE COMM LOOK                      $3AF20220
       LGL     18                  LIKE 7607 CHANNEL                   $3AF20230
       SLW     COMM                                                    $3AF20240
       ANA     ADDRS                                                   $3AF20250
       LDQ     1,4                                                     $3AF20260
       RQL     1                   TYPE READ                           $3AF20270
       TQP     HREAD               READ FORWARD                        $3AF20280
       LNT     200000              END OF FILE TEST                    $3AF20290
       TNZ     *+2                 IF LONG LENGTH RECORD               $3AF20300
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $3AF20310
       ACL     L(1)                ELSE IT POINTS AT LAST              $3AF20320
       STA     COMM                WORD READ                           $3AF20330
HREAD  TNZ     HRETN                                                   $3AF20340
       CAL     COMM                MAKE IT POINT AT                    $3AF20350
       ADD*    HIORT               LAST REC IN BUFF+1                  $3AF20360
       ARS     18                  IF LONG RECORD READ                 $3AF20370
       TRA     HREAD-1                                                 $3AF20380
HEROR  RFT     377777              NCI INTERRUPT                       $3AF20390
       TRA     *+2                 NO                                  $3AF20400
       TRA     HSMRD               YES                                 $3AF20410
       LNT     100                 INTERFACE CHECK                     $3AF20420
       TRA     *+4                 NO                                  $3AF20430
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3AF20440
       SXA     CHATT-1,4           RETURN 2,4                          $3AF20450
       TRA     DCHG                                                    $3AF20460
       RFT     020014                                                  $3AF20470
       TRA     HYSEL+1             EOT, EOF, BOT                       $3AF20480
       LDI     1,4                                                     $3AF20490
       LFT     400000                                                  $3AF20500
       TRA     *+3                 WRITE ERROR                         $3AF20510
       LDI     1PRE                READ ERROR                          $3AF20520
       TRA     HSMRD+1             GO POST                             $3AF20530
       CAL     S3                                                      $3AF20540
       SUB     L(2)                CHANGE EXIT                         $3AF20550
       STO     S3                  TO 3,4                              $3AF20560
       CLA*    (URRXI              UPDATE ERROR                        $3AF20570
       ACL     5,2                                                     $3AF20580
       SLW     5,2                 HISTORY AND TRY                     $3AF20590
       TRA     S3                  TO WRITE AGAIN                      $3AF20600
HSMSR  OCT     000000000040        CONSTANTS                           $3AF20610
HSMSN  OCT     000000000106        FOR                                 $3AF20620
HYCTL  OCT     757777777777        HYPER                               $3AF20630
HYCLN  OCT     020000000000        SELECT                              $3AF20640
HYSEL  OCT     120600120112                                            $3AF20650
       LDI     SIX                                                     $3AF20660
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE              3AF20670
       TPL     HSMRD+1             READ EOF                            $3AF20680
       TRA     HIORT-2             WRITE EOT                           $3AF20690
       BES     HBEG+NOHYP/NOHYP**-NOHYP/NOHYP*HBEG-*                   $3AF20700
DER1   STL     .DERR                                                    3AF20710
       STZ     1,4                 ZERO OUT UCW2                       $3AF20720
       TRA     DCHG                RETURN 2,4                          $3AF20730
       BES     *-3+NOCHX/NOCHX*3-*                                      3AF20740
       TTL     NON-DATA OPERATION CHECK FOR DISK                        3AF20750
*                                                                       3AF20760
D7909  AXT     **,4                                                    *3AF20770
       TRA     (NDSLX                                                $5$3AF20771
SVDID  PZE     **                                                      *3AF20780
       SXA     D7909,4                                                 *3AF20790
       CLA     1,4                                                   $5$3AF20791
       PDX     0,4                                                   $5$3AF20792
       CLA     5,2                                                     *3AF20800
       TMI     7KA                 1301                                *3AF20810
       ANA     SIX                                                     *3AF20820
       TZE     D7909                                                 $5$3AF20830
 HNDS  TXL     HND2,4,2                                              $5$3AF20860
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *3AF20870
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *3AF20880
       TNX     *+4,4,31            FOLLOWING ORDERS                    *3AF20890
       TXI     *+1,4,33            RWD,RUN                             *3AF20900
       TNX     *+2,4,35            BSR,BSF                             *3AF20910
       TXI     *+1,4,32            WTM                                 *3AF20920
HND1   SXD     *+2,4                                                   *3AF20930
       TSX     (NDSLX,4                                                *3AF20940
       PZE     0,2,**                                                  *3AF20950
HND2   LXA     D7909,4                                                 *3AF20960
       TRA     2,4                                                     *3AF20970
       BES     HNDS+NOHYP/NOHYP**-NOHYP/NOHYP*HNDS-*                    3AF20980
  7KA  TXL     DNDSEL+1,4,2                                          $5$3AF20981
       STI     SVDID                                                 $5$3AF20990
       STZ     TEMP                                                     3AF21000
       LDQ     6,2                 CHECK FOR EOF                      *$3AF21010
       TQP     7KAA          NO                                      $5$3AF21020
       STL     TEMP                                                     3AF21030
       SXA     *+2,4                                                 $5$3AF21031
       TSX     EOF,4               YES                                 $3AF21040
       AXT     **,4                                                  $5$3AF21050
 7KAA  ENB     TRAPS                                                 $5$3AF21060
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $3AF21100
       TXH     DWEF,4,5            BSF-6 WEF-7                         $3AF21110
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $3AF21120
       ZET     TEMP                                                     3AF21130
       TRA     7KB                                                      3AF21140
       CAL     7,2                 GET BOT AND                          3AF21150
       ARS     18                  TEST IF POSITION                    $3AF21160
       SBM     6,2                 NOW, IS SAME                        $3AF21170
       ANA     ADDRS               IF SO                               $3AF21180
       TZE     DNDSEL              NO BACKSPACE - NOP                  $3AF21190
7KB    PXA     0,0                 NO. OF TRACKS IN RECORD              3AF21200
       LLS     5                   DEDUCT TRACKS                       $3AF21210
       SUB     6,2                 AND PUT IT BACK                     $3AF21220
       STA     6,2                 FOR NEXT SEEK                       $3AF21230
DNDSEL LDI     SVDID         PLACE BACK AND                        IBJOB3AF21240
       LXA     D7909,4             RETURN                              $3AF21250
       TRA     2,4                                                     $3AF21260
DIND   SYN     DNDSEL                                              IBJOB3AF21270
NDSEL  EQU     SVDID                                                   $3AF21280
DWEF   SXA     DWEF1,4                                                 $3AF21290
       SXA     DWEF1+1,1                                               $3AF21300
       TXL     DBSF,4,6            BSF                                 $3AF21310
DBSF1  AXC     1,4                                                     $3AF21320
       CLA*    0,2                 GET 2ND WORD OF UCB                 $3AF21330
       TNZ     *-1                 WAIT FOR LAST WRITE                 $3AF21340
       ENB     L(0)                                                    $3AF21350
       CLA     6,2                                                     $3AF21360
       ANA     DECRE                                                   $3AF21370
       ARS     6                                                       $3AF21380
       STO     DSMSB                                                   $3AF21390
       SXA     DWEF6,2                                                 $3AF21400
       CLA     1,2                 TEST MODE                           $3AF21410
       ANA     MODBT                                                    3AF21420
       TZE     *+3                 BCD MODE                             3AF21430
       CLA     L(6)                BINARY MODE                          3AF21440
       TRA     *+2                                                      3AF21450
       CLA     L(22)                                                    3AF21460
       ORS     DSMSB                                                    3AF21470
       CLA     0,2                 GET UCB ADDRESS                     $3AF21480
       STA     DAXC                                                    $3AF21490
       CLA     6,2                                                     $3AF21500
       TSX     (DECVA,4                                                $3AF21510
DAXC   AXC     **,4                'L(UCB)                             $3AF21520
       CLS     2,4                 REQUEST SEEK                        $3AF21530
       STO     2,4                 WITH MINUS SIGN                     $3AF21540
       CLA     6,2                 AND CORRECT                         $3AF21550
       STA     3,4                                                     $3AF21560
       TSX     (FDAMT,2            IOEX ROUTINE TO SET ORDER           $3AF21570
DSMSB  BCI     1,00I006                                                $3AF21580
       PZE     DVTA                                                    $3AF21590
DWEF6  AXT     **,2                L(FCB)                              $3AF21600
       STL     DWAIT               MAKE WAIT CELL NONZERO              $3AF21610
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $3AF21620
       PXD     0,1                                                     $3AF21630
       STD     1,4                 SECOND WORD OF UCB                  $3AF21640
       TSX     (ACTVX,4            ACTIVATE CHAIN OF CHANNEL COMMANDS  $3AF21650
       MZE     0,2                                                     $3AF21660
       ZET     DWAIT               WAIT FOR SELECT MINUS                3AF21670
       TRA     *-1                 TO FINISH                           $3AF21680
       XEC     DWEF1                                                   $3AF21690
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $3AF21700
       CAL     6,2                 SET UP SEEK                         $3AF21710
       ACL     L(1)                AND FILE START                      $3AF21720
       STA     6,2                 ADDRESS FOR                         $3AF21730
       TSX     EOF,4               BACKSPACE FILE                      $3AF21740
       ENB     TRAPS                                                   $3AF21750
DWEF1  AXT     **,4                AT LAST                             $3AF21760
       AXT     **,1                                                    $3AF21770
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $3AF21780
       CAL     7,2                 GET BOT ADDRESS                     $3AF21790
       STD     0,2                 AND PUT IN BOTH                     $3AF21800
       ARS     18                  WORD ONE AND SEVEN                  $3AF21810
       STA     6,2                                                     $3AF21820
       TXL     DNDSEL,4,3                                              $3AF21830
       PXA     0,0                                                     $3AF21840
       STA     0,2                 ZERO OUT UCB                        $3AF21850
       XEC     DIND                RESTORE INDICATORS                  $3AF21860
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $3AF21870
       TRA     DNDSEL+1            RETURN                              $3AF21880
DWAIT  PZE                                                             $3AF21890
DVTA   DVTA    ,,                                                      $3AF21900
DBSF   LDI     6,2                 1ST TIME AROUND                     $3AF21910
       CLA     7,2                                                     $3AF21920
       STD     *+3                 IF AT                               $3AF21930
       CLA     0,2                 BOT DO NOT                          $3AF21940
       PDC     0,1                 DO THE                              $3AF21950
       TXI     *+1,1,**            BACKSPACE                           $3AF21960
       TXL     DNDSEL,1,0    FILE                                  IBJOB3AF21970
       LFT     600000                                                  $3AF21980
       TRA     DBSF4               NOT 1ST TIME                        $3AF21990
       CLA     0,2                 EXCHANGE SEEK POINTER               $3AF22000
DBSF6  ARS     18                  TO BE BEGINNING                     $3AF22010
       STA     6,2                 OF THE FILE                         $3AF22020
       CAL     SIX                 PUT NOT FIRST                       $3AF22030
       STP     6,2                 TIME THRU FLAG ON                   $3AF22040
       TRA     DNDSEL        EXIT                                  IBJOB3AF22050
DBSF4  LFT     200000                                                  $3AF22060
       TRA     DBSF5               NOT FIRST TIME THRU                 $3AF22070
       PIA     **                  PUT SEEK ADDRESS                    $3AF22080
       ALS     18                  AND BEGINNING OF                    $3AF22090
       STD     0,2                 FILE EQUAL                          $3AF22100
       TRA     DBSF6+2             EXIT                                $3AF22110
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $3AF22120
       SXA     DSELP+2,4           FOR BACKSPACE                       $3AF22130
       PIA                                                             $3AF22140
       SUB     L(1)                MAKE SEEK ADDRESS                   $3AF22150
       STA     6,2                 EOF ADDRESS                         $3AF22160
       TRA     DBSF1               GET FLAG FOR EOF                    $3AF22170
DBSF3  AXT     DCTL,4              RESTORE START                       $3AF22180
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $3AF22190
       CAL     DFLAG               GET NEW B.O.F.                      $3AF22200
       STD     0,2                 AND PUT IT IN THE                   $3AF22210
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $3AF22220
*                                                                      $3AF22230
DISUE  ACL     L(1)                GET ADDRESS OF                      $3AF22240
       STA     DSELM1              UCB + 1                             $3AF22250
       LXA     DWEF6,2             -L (FILE) IN IR2                    $3AF22260
       TPL     DSELP                                                   $3AF22270
       STZ     DWAIT                                                   $3AF22280
DSELM1 STZ     **                                                      $3AF22290
       TRA     1,4                 RETURN                              $3AF22300
DSELP  CAL     0,2                 PUT FILE                            $3AF22310
       STD     DFLAG               START POINT IN FLAG                 $3AF22320
       AXT     DCTL,2              COMM. LIST                          $3AF22330
       PXA     0,2                                                     $3AF22340
       STA*    (RCHXI                                                  $3AF22350
       XEC*    (RCHXI              SEL+ START CHANNEL                  $3AF22360
       TRA     1,4                 EOF LOCATION                        $3AF22370
*              7909 CHANNEL PROGRAM                                    $3AF22380
*                                                                      $3AF22390
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              3AF22400
       CTLW    DVTA                                                    $3AF22410
       CPYD    DFLAG,,1                                                $3AF22420
       TCH     SYSTWT                                                  $3AF22430
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $3AF22440
       CTLR    DVTA                FOR BACK SPACE                      $3AF22450
       TCH     DCTL+2              FILE ROUTINE                        $3AF22460
DFLAG  PTW                         EOF FLAG WORD                       $3AF22470
       BES     7KA+NOCH/NOCH**-NOCH/NOCH*7KA-*                          3AF22480
       TTL                         UNBUFFER INPUT FILE                  3AF22490
*    TSX  UNBFI,4           DESTROYS IR1                                3AF22500
       SPACE   1                                                        3AF22510
UNBFI  SXA     UB7,4               SAVE IR4                             3AF22520
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       3AF22530
UB1    ENB     L(0)                TRAP PROTECT                         3AF22540
       AXC     1,4                 IF NO BUFS IN REQ                    3AF22550
       CLA*    0,2                 CHAIN THEN GO RELEASE                3AF22560
       TZE     UB4                 SYNC CHAIN                           3AF22570
UB1.1  LDQ     5,2                   CHECK FOR DISK                     3AF22590
       TQP     *+2                                                     $3AF22610
       TRA     UB3                 DISK, GO TO UB3                     $3AF22620
       BES     UB1.1+NOCH/NOCH**-NOCH/NOCH*UB1.1-*                   $5$3AF22630
       STA     UB2                 SAVE L(1ST REQ)                      3AF22640
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       3AF22650
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         3AF22660
       TRA     UB3                 HOOKING REMAINDER OF REQ             3AF22670
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       3AF22680
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         3AF22690
       XCA                         ITS COMPLETION                       3AF22700
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    3AF22710
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           3AF22720
       LDQ     4,2                 ADD 2ND ON REQS                      3AF22730
       STA     4,2                 TO SYNC CHAIN                        3AF22740
       PDC     0,1                                                      3AF22750
       XCA                                                              3AF22760
       STA     0,1                                                      3AF22770
       CLA*    0,1                                                      3AF22780
       STD*    4,2                                                      3AF22790
UB3    TSX     ACTV+1,4            WHICH AT TRAP WILL                   3AF22800
       MZE     0,2                 BE ENTERED INTO                      3AF22810
       AXC     1,4                 SYNC CHAIN                           3AF22820
       ZET*    0,2                 WAIT                                 3AF22830
       TRA     *-1                                                      3AF22840
       SPACE   1                                                        3AF22850
*                      ALL BUFFERS IN SYNC CHAIN                        3AF22860
UB4    SXD     SYNCT,0             PRESET SYNC CT                       3AF22870
       STZ     TEMP                SET EOF DELETE SWITCH =0             3AF22880
UB4.1  CLA*    4,2                 PLACE BUFFERS                        3AF22890
       TZE     UB6                 FROM SYNC CHAIN                      3AF22900
       TPL     *+4                 TO POOL ,+ BUFFERS                   3AF22910
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          3AF22920
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 3AF22930
       SXD     SYNCT,1             NECESSARY TO REPOSITION              3AF22940
       LDQ     4,2                 TO POOL                              3AF22950
       STA     4,2                                                      3AF22960
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           3AF22970
       TZE     UB4.2               WITH THIS BUFFER                     3AF22980
       XCA                         YES- SO PICKUP                       3AF22990
       PAC     0,1                 THE TAPE POSITION                    3AF23000
       XCA                         AND SAVE FOR AFTER BSR               3AF23010
       CLA     2,1                 ACROSS EOF MARK                      3AF23020
       STO     TEMP                                                     3AF23030
UB4.2  LAC     LBC,4                                                    3AF23040
       TSX     TOCLOS,1                                                 3AF23050
       TRA     UB4.1                                                    3AF23060
       SPACE   1                                                        3AF23070
*                         FORM NEW SYNC CHAIN                           3AF23080
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  3AF23090
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $3AF23100
       TRA     UB3                 AND CONTINUE                         3AF23110
       SPACE   1                                                        3AF23120
*                            EXIT SEQUENCE                              3AF23130
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              3AF23140
       TXL     UB7,1,0             SETUP AND BACKSPACE                  3AF23150
       LDQ     5,2                                                     $3AF23160
       RQL     1                   HYPER                               $3AF23170
       TQP     *+7                 NO                                  $3AF23180
       LDQ     1,2                                                     $3AF23190
       RQL     18                  READ BACKWARD                       $3AF23200
       TQP     *+4                 NO                                  $3AF23210
       TSX     (NDSLX,4                                                $3AF23220
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $3AF23230
       TRA     UB6.3-1                                                 $3AF23240
       BES     *-9+NOHYP/NOHYP*9-*                                     $3AF23250
       TSX     NDSEL+1,4                                                3AF23260
       PZE     0,2,BSROP                                                3AF23270
       NZT     TEMP                IF BSR ACROSS EOF MARK               3AF23280
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $3AF23290
       CLA     5,2                                                   $5$3AF23291
       TMI     *+5                                                   $5$3AF23292
       CLA     TEMP                AND CONTINUE                         3AF23300
       AXC     2,4                                                      3AF23310
       STO*    0,2                                                      3AF23320
       STZ     TEMP                                                     3AF23330
       SIL     NINHIB              UN-INHIBIT FILE                      3AF23340
       TRA     UB6.3                                                    3AF23350
UB7    AXT     **,4                RESTORE IR4                          3AF23360
       TRA     1,4                 EXIT                                 3AF23370
       TTL     UNBUFFER OUTPUT FILE                                     3AF23380
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   3AF23390
*    TSX  UNBFO,4     DESTROYS IR1                                      3AF23400
       SPACE   1                                                        3AF23410
UNBFO  SXA     UNBO,4              SAVE IR4                             3AF23420
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         3AF23430
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 3AF23440
       NZT*    0,2                 TO DO GIVE IT                        3AF23450
       TRA     UNBO                PRIORITY AND WAIT.....               3AF23460
       TSX     ACTV+1,4            FOR ALL REQUESTS TO GET DONE         3AF23470
       MZE     0,2                                                      3AF23480
       TRA     UNBF1                                                    3AF23490
UNBO   AXT     **,4                                                     3AF23500
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        3AF23510
       TRA     1,4                 ELSE EXIT                            3AF23520
       TSX     EOTOF,1                                                  3AF23530
       TRA     UNBO-3                                                   3AF23540
       TTL                         IOCS SELECT ROUTINES                 3AF23550
*             (INITIATE A SELECT AND POST ITS COMPLETION)               3AF23560
       SPACE   1                                                        3AF23570
CHATY  PZE                         UNIT AND CHANNEL TYPE               $3AF23580
ISSUE  SXA     S3,4                SAVE IR4                             3AF23590
       SXA     S3+1,1              SAVE IR1                             3AF23600
       PAC     0,4                 -L(UCW) TO IR4                       3AF23610
       XCA                         SAVE + OR - ENTRY                    3AF23620
CHATT  CLA     0,4                 SET UP AND                          $3AF23630
       ANA     BVDG                TEST FOR UNIT                       $3AF23640
       PDX     0,2                 AND CHANNEL TYPE                    $3AF23650
       TXL     *+3,2,8191          7909 OR 7607                        $3AF23660
       TXL     *+3,2,8192          HYPER                               $3AF23670
       TXI     *+2,2,1             DISK                                $3AF23680
       AXT     0,2                 IF 7607'''ZERO IR2                  $3AF23690
       SXA     CHATY,2             SAVE INDICATION                     $3AF23700
       BES     *-8+NOCHX/NOCHX*8-*                                      3AF23710
       CLA     0,4                 0=7607, 20101=DISK, 20000=HYPER     $3AF23720
       PAC     0,2                 L(FILE) TO IR2                      $3AF23730
       TQP     SELP                SEPARATE SEL+ ENTRY                 $3AF23740
       CLA     CHATY               CHANNEL TYPE                        $3AF23750
       TNZ     MSEL-2              79O9 CHANNEL                        $3AF23760
       BES     *-2+NOCHX/NOCHX*2-*                                      3AF23770
*                  SELECT (-) ENTRY = POST COMPLETION                   3AF23780
       LFT     400000              IF SHORT RECORD                      3AF23790
       TRA     MXMDT               INDICATION IS ON                     3AF23800
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 3AF23810
       SUB     L(1)                THEN SETUP TO EXIT                   3AF23820
       STA     S3                  AT 2,4                               3AF23830
       CLA     1,4                 IF READING                           3AF23840
       TPL     S3                  DISCARD NOISE RECORD                 3AF23850
MXMDT  CLA     1,2                 IF MIXED MODE                        3AF23860
       TMI     MXMOD               PERFORM EXTRA CALCULATIONS           3AF23870
SELM1  TSX     URC1,1              UPDATE REQUEST CHAIN                 3AF23880
       NZT     CHATY                                                   $3AF23890
       TRA     HSEL1               729 OR CARD UNIT                    $3AF23900
       CLA     1,4                                                     $3AF23910
       TZE     *+4                 NO REQUEST CHAIN                    $3AF23920
       PXD     0,0                 PREFIX FOR REINSTRUCT               $3AF23930
       LNT     200000              OR IF EOF                           $3AF23940
       TRA     HSEL1                                                   $3AF23950
       STA     0,4                 ZERO FCB FROM UCW1                  $3AF23960
       CAL     S3                  RESTORE                             $3AF23970
       ADD     L(1)                ADDRESS                             $3AF23980
       STA     S3                  FOR RETURN                          $3AF23990
       BES     *-11+NOHYP/NOHYP*11-*                                   $3AF24000
HSEL1  LDC     COMM,1              RESTORE TO                          $3AF24010
       TQP     POSTR               IF MQ + READ IS DONE                 3AF24020
       SPACE   1                                                        3AF24030
*                        POST WRITE COMPLETION                          3AF24040
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $3AF24050
       PDC     0,4                                                      3AF24060
       CAL     1,4                 RESTORE BUFFER                       3AF24070
       ARS     4                   SIZE TO IORT                         3AF24080
       STD     -1,1                TO IORT                              3AF24090
       TSX     BTP1,1              PLACE BUF IN POOL                    3AF24100
       LNT     200000              DID EOT OCCUR                        3AF24110
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         3AF24120
*                        EOT HANDLE TRAP WRITE                          3AF24130
       AXC     1,4                                                      3AF24140
       CLA*    0,2                                                      3AF24150
       TZE     *+2                                                      3AF24160
       STA     4,2                                                      3AF24170
       CAL     EOTBT                                                    3AF24180
*                         INHIBIT BITS TO FILE                          3AF24190
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $3AF24200
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $3AF24210
       LXA     FCW,1                                                   $3AF24220
INEX2  TXI     *+1,1,**                                                 3AF24230
       TXH     INEX4,1,0                                                3AF24240
       ANS     (IOXSI                                                   3AF24250
INEX4  ANS     1,2                                                      3AF24260
       TRA     S3                                                       3AF24270
       SPACE   1                                                        3AF24280
*                         POST READ COMPLETION                          3AF24290
POSTR  CAL     COMM                                                     3AF24300
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $3AF24310
       PIA                                                              3AF24320
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $3AF24330
       CLA*    4,2                 DOES SYNC CHAIN EXIST                3AF24340
       TZE     PSTR8               NO                                   3AF24350
       PDC     0,1                 SAVE L(END)                          3AF24360
       XCA                         L(BUF) TO AC                         3AF24370
       STA     0,1                 UPDATE                               3AF24380
       LDQ     L(0)D               SYNC CHAIN                           3AF24390
       LGL     18                                                       3AF24400
       STA*    0,1                                                     $3AF24410
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $3AF24420
       LNT     200000         IF NO EOF                                $3AF24430
       TRA     S3                  THEN EXIT                            3AF24440
       SPACE   1                                                        3AF24450
*                        EOF HANDLER TRAP INPUT                         3AF24460
       SXA     PSTR5,4             SAVE L(UCW)                          3AF24470
       LXA     CHATY,1                                                 $3AF24480
       TXH     DEOF1,1,8192                                            $3AF24490
       BES     *-2+NOCH/NOCH*2-*                                        3AF24500
       LDQ     LTPOS               SAVE TAPE POSITION                   3AF24510
       STQ*    COMM                JUST PRIOR TO EOF MARK               3AF24520
PSTR4  NZT     1,4                 IF LAST BUFFER                       3AF24530
       TRA     PSTR6               DO NOTHING                           3AF24540
PSTR2  TSX     URC1,1              DELETE AHEAD                        $3AF24550
       CLA     4,2                 L(POOL) TO IR4                       3AF24560
       PDC     0,4                                                      3AF24570
       TSX     TOPOOL,1            BUFFERS                              3AF24580
PSTR5  AXT     **,4                RESTORE L(UCW)                       3AF24590
       TRA     PSTR4               DELETE ALL                           3AF24600
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              3AF24610
       CAL     NOTIN               WD UCW AND                           3AF24620
       TRA     INEX                GO INHIBIT FILE                      3AF24630
       SPACE   1                                                        3AF24640
*                           START SYNC CHAIN                            3AF24650
PSTR8  XCA                         PUT BUF READ IN AC                  $3AF24660
       STA     4,2                                                      3AF24670
       LDQ     L(0)D                                                    3AF24680
       LGL     18                                                       3AF24690
       STA*    4,2                 L(1) IN BUF CW                      $3AF24700
       TRA     PSTR3                                                    3AF24710
       TTL     SELECT (+) ENTRY                                         3AF24720
*                      SIGN OF UCW WD2 0-RD 1-WR                        3AF24730
*                        INSERTS *+1 INTO IORT                          3AF24740
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   3AF24750
*                   AND INCREMENTS IT IN FILE WORDS                     3AF24760
       SPACE   1                                                        3AF24770
SELP   LDI     1,2                 FILE BITS TO SI                      3AF24780
       CLA     CHATY                                                   $3AF24790
       LBT                         UNIT TYPE TEST                      $3AF24800
       TNZ     HYPL                HYPER                               $3AF24810
       TNZ     DRWRS               DISK                                $3AF24820
       BES     *-4+NOCHX/NOCHX*4-*                                      3AF24830
       LFT     MXDMD               IF MIXED MODE                        3AF24840
       TRA     MXMP                SKIP OUT                             3AF24850
S4     CLA     1,4                 GET ADDRESS OF                       3AF24860
       ACL     L(1)                THE IORT TO BE USED                  3AF24870
       STA*    (RCHXI                                                   3AF24880
       STA     S1+1                                                     3AF24890
S1     ACL     L(1)                                                     3AF24900
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      3AF24910
       CLA     1,2                 FORM SELECT                          3AF24920
       ANA     MODBT               INSERTING TAPE MODE BIT              3AF24930
       TNZ     *+2                                                      3AF24931
       STZ     SYSJOB+2                                                 3AF24932
       ARS     7                                                        3AF24940
       ORA     0,4                                                      3AF24950
RWRS   ARS     18                                                       3AF24960
       STA     SELCT               UNIT ADDRESS TO SELECT               3AF24970
       CLA     S2                                                       3AF24980
       LDQ     1,4                                                      3AF24990
       TQP     *+2                 RDS IN SELECT                        3AF25000
       ALS     15                  WRS IN SELECT                        3AF25010
       STD     SELCT                                                    3AF25020
       ZET*    SYSJOB+1                                                 3AF25021
SELCT  RDS     **                  SEL                                  3AF25030
       XEC*    (RCHXI              RCHX                                 3AF25040
S3     AXT     **,4                                                     3AF25050
       AXT     **,1                                                     3AF25060
       TRA     1,4                 RETURN TO IOEX                       3AF25070
S2     OCT     076200766000        RDS...WRS                            3AF25080
       TTL                         BTP (BUFFER TO POOL) ROUTINE         3AF25090
*              TSX BTP,1                                                3AF25100
       SPACE   1                                                        3AF25110
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           3AF25120
*              MQ                  TSX BTP1,1                           3AF25130
       SPACE   1                                                        3AF25140
BTP1   XCA                         L(BUF. IN USE IN AC                 $3AF25150
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $3AF25160
       STA     0,4                 PUT BUF IN USE BACK                 $3AF25170
       XCA                         BUF FROM CHAIN IN AC                $3AF25180
       STZ*    0,4                 ZERO IN BUF CW                      $3AF25190
       STA*    0,4                 ADDRESS OF CHAIN                    $3AF25200
       TRA     1,1                                                      3AF25210
       SPACE   1                                                        3AF25220
*                      URC (UPDATE REQUEST CHAIN)                       3AF25230
*                       IR4 = -L(UCW) TSX URC1,1                        3AF25240
       SPACE   1                                                        3AF25250
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $3AF25260
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $3AF25270
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $3AF25280
       NZT*    1,4                 LOC OF ZERO                         $3AF25290
       TRA     *+3                                                      3AF25300
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $3AF25310
       TRA     1,1                                                      3AF25320
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $3AF25330
       TRA     1,1                                                      3AF25340
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      3AF25350
*                    IN SEARCHING OUTPUT FILE CHAIN                     3AF25360
       SPACE   1                                                        3AF25370
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              3AF25380
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               3AF25390
       SPACE   1                                                        3AF25400
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      3AF25410
       TSX     EOTOF,1             HANDLE EOT                           3AF25420
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           3AF25430
       TRA     GET0+1              AND IR2 THEN EXIT                    3AF25440
       SPACE   1                                                        3AF25450
*                       EOT HANDLER OUTPUT FILE                         3AF25460
       SPACE   1                                                        3AF25470
*      TSX     EOTOF,1             IR2 = -L(FILE)                       3AF25480
*      RETURN                      INDICES NOT DISTURBED                3AF25490
       SPACE   1                                                        3AF25500
EOTOF  SXA     ETOF5,4             SAVE IR4                             3AF25510
       SXA     ETOF6,1             IR1                                  3AF25520
       TSX     NDSEL+1,4           WEF ON OLD                           3AF25530
       PZE     0,2,WEFOP           FILE                                 3AF25540
       NOP                         IGNORE EOT                           3AF25550
       TSX     SWITCH,1            SWITCH REELS                         3AF25560
       SIL     NOEOT               SET NO EOT CONDITION                 3AF25570
       NZT*    4,2                 IF NO SELECTS TO DO                  3AF25580
       TRA     ETOF5               SKIP OUT                             3AF25590
       CLA     4,2                 SET EOT CHAIN OF SELECTS             3AF25600
       STA     ETOF7               INTO UCW OF                          3AF25610
       CAL     ETOF7               NEW REEL                             3AF25620
       AXC     1,4                                                      3AF25630
       ZET*    0,2                                                      3AF25640
       TRA     *-1                                                      3AF25650
       ORS*    0,2                                                      3AF25660
       CLA     L(0)A               SET EOT CHAIN                        3AF25670
       STA     4,2                 = 0                                  3AF25680
       TSX     ACTV+1,4            ACTIVATE                             3AF25690
       PZE     0,2                 NEW REEL                             3AF25700
ETOF5  AXT     **,4                RESTORE IR4                          3AF25710
ETOF6  AXT     **,1                IR1                                  3AF25720
       TRA     1,1                 EXIT                                 3AF25730
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          3AF25740
       TTL                         REEL SWITCHING ROUTINE               3AF25750
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  3AF25760
*      RETURN                      INDICES NOT DISTURBED                3AF25770
       SPACE   1                                                        3AF25780
*                               ACTIONS                                 3AF25790
*            1. REWINDS UNLOADS OLD REEL                                3AF25800
*            2. SWITCHES TO ALTERNATE UNIT                              3AF25810
*            3. PRINTS MESSAGE TO OPERATOR                              3AF25820
*            4. ADVANCES REEL SEQ. NUMBER                               3AF25830
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  3AF25840
       SPACE   1                                                        3AF25850
SWITCH SXA     SW3,4               SAVE IR4                             3AF25860
       LDQ     5,2                                                     $3AF25870
       RQL     1                   HYPER                               $3AF25880
       TQP     *+9                 NO                                  $3AF25890
       STI     TEMP                                                    $3AF25900
       LDI     1,2                                                     $3AF25910
       LFT     OUTPUT                                                  $3AF25920
       RNT     100000              FILE PROTECT                        $3AF25930
       TRA     *+3                 NO                                  $3AF25940
       TSX     (NDSLX,4                                                $3AF25950
       PZE     0,2,HFPNP                                               $3AF25960
       RFT     200000              UNLOAD                               3AF25970
       TRA     *+4                 NO                                  $3AF25980
       TSX     (NDSLX,4                                                $3AF25990
       PZE     0,2,HUNLP                                               $3AF26000
       TRA     *+3                                                     $3AF26010
       BES     *-15+NOHYP/NOHYP*15-*                                   $3AF26020
       TSX     NDSEL+1,4           REWIND UNLOAD                        3AF26030
       PZE     0,2,RUNOP           OLD REEL                             3AF26040
       TSX     PAUSE,4             PAUSE FOR OPERATOR                   3AF26050
       SIL     NINHIB              UN-INHIBIT FILE                      3AF26060
       LDQ     5,2                                                     $3AF26070
       RQL     1                                                       $3AF26080
       TQP     *+6                                                     $3AF26090
       RNT     100000                                                  $3AF26100
       TRA     *+3                                                     $3AF26110
       TSX     (NDSLX,4                                                $3AF26120
       PZE     0,2,HFPNP                                               $3AF26130
       LDI     TEMP                                                    $3AF26140
       BES     *-8+NOHYP/NOHYP*8-*                                     $3AF26150
SW3    AXT     **,4                RESTORE IR4                          3AF26160
       TRA     1,1                 EXIT                                 3AF26170
*                   ROUTINE TO REVERSE FILE CONTROLS                    3AF26180
*                   SI AND IR2 FROM FILE A TO FILE B                    3AF26190
CPY6   XCA     **                  SAVE AC                              3AF26200
       ENB     L(0)                TRAP PROTECT                         3AF26210
       PIA                         RESTORE CONTROL                      3AF26220
       STD     1,2                 BITS TO FILE                         3AF26230
       LXA     CPY7,1              SWITCH                               3AF26240
       LXA     FCW,2               TO OTHER                             3AF26250
       SXA     FCW,1               FILE                                 3AF26260
       SXA     CPY7,2                                                   3AF26270
       LAC     FCW,2               PLACE 2ND                            3AF26280
       CLA     1,2                 FILES CONTROL                        3AF26290
       ANA     DECRE               BITS IN SI                           3AF26300
       RIL     077777                                                   3AF26310
       OAI                                                              3AF26320
       TXH     *+2,4,-SEL2.4                                           $3AF26330
       ENB     TRAPS               ALLOW TRAPS                          3AF26340
       XCA                         RESTORE AC                           3AF26350
       TRA     1,4                 EXIT                                 3AF26360
       TTL     CONSTANT POOL                                            3AF26370
XCPTP  OCT     077777777777                                            $3AF26380
L(64D) PZE     0,,64                                                    3AF26390
       SPACE   1                                                        3AF26400
*                          TEMPORARY STORAGE                            3AF26410
HOLDS  PZE     *                   CHAIN CELL                           3AF26420
TCHEX  PZE     **                  TCH SWITCH                           3AF26430
TEMP   PZE     **                  ERASEABLE STORAGE                    3AF26440
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             3AF26450
*                               ACTIONS                                 3AF26460
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          3AF26470
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      3AF26480
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                3AF26490
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              3AF26500
*                MODE WILL BE USED AND THE RECORD WILL BE READ          3AF26510
*                WITHOUT REDUNDANCY CHECKING                            3AF26520
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 3AF26530
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             3AF26540
*                            XX XX XX X5 XX XX    BIN   BIN             3AF26550
*                            XX XX XX X1 XX XX    BCD   BIN             3AF26560
*                            XX XX XX X1 XX XX    BIN   BCD             3AF26570
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   3AF26580
*                            XX XX 00 00 00 00    BCD   BCD             3AF26590
*                            00 01 00 05 00 04    BIN   BIN             3AF26600
*                            XX XX 11 11 07 07    BCD   BIN             3AF26610
*                            00 00 00 01 00 00    BIN   BCD             3AF26620
*             5. WRITE MIXED MODE WORKS ............                    3AF26630
MXMOD  CLA     0,4                 MIXED MODE                           3AF26640
       ANA     L(64D)              CARD EQUIPMENT                       3AF26650
       TNZ     CDMXM               CHECKS FOR EOF CARD                  3AF26660
       STI     MX2                 SAVE SI                              3AF26670
       LNT     100000              IF NO REDUNDANCY ANALYZE             3AF26680
       TRA     LKAD                LOOK AHEAD BITS                      3AF26690
       LDI     1,4                 IF CODE 3 THEN                       3AF26700
       LNT     300000              10 TRIES ON FIRST MODE DONE          3AF26710
       TRA     MX1                                                      3AF26720
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         3AF26730
MX0    STZ*    (URRXI              ERROR PRINT                          3AF26740
       STI     1,4                                                      3AF26750
       LDI     1,2                 REVERSE                              3AF26760
       IIL     MODE                MODE OF                              3AF26770
       STI     1,2                 SELECT                               3AF26780
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     3AF26790
       LXA     S3+1,1              RESTORE IR 1                         3AF26800
       LXA     S3,4                RETURN TO                            3AF26810
       TRA     3,4                 EXECUTOR TO RE-TRY                   3AF26820
*                   SECOND AND THIRD MODE TRIES SEL-                    3AF26830
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      3AF26840
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $3AF26850
       IIL     300000              IF SECOND GO TRY AGAIN               3AF26860
       TRA     MX0                 AT FIRST MODE                        3AF26870
MX2    PZE     **                  SI STORAGE                           3AF26880
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   3AF26890
MXMP   LDI     1,4                 IF FIRST TIME                        3AF26900
       LFT     300000              SELECT SET ALTERNATOR                3AF26910
       TRA     MX3                 CODE =3                              3AF26920
       IIL     300000                                                   3AF26930
       STI     1,4                 RESTORE UCW 2ND WORD                 3AF26940
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           3AF26950
       STZ*    (RCTXI              THIRD TRY DISABLE REDUNDANCY         3AF26960
       LDI     1,2                 RESTORE SI                           3AF26970
       TRA     S4                  EXIT                                 3AF26980
       EJECT                                                            3AF26990
*                      INTERROGATE LOOKAHEAD BITS                       3AF27000
1KA    LFT     200000              EOF                                 $3AF27010
       TRA     SELM2+2             NO CHANGE IN MODE                   $3AF27020
       STI     MX2                 SAVE INDICATORS                     $3AF27030
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $3AF27040
       CLA     1,4                                                     $3AF27050
       PAC     0,1                                                     $3AF27060
       CLA     9,1                 LAST COMMAND                        $3AF27070
       ARS     18                                                      $3AF27080
       ADD     9,1                 LAST WORD READ + 1                  $3AF27090
       PAC     0,1                                                     $3AF27100
       TRA     LWRD+1                                                  $3AF27110
       BES     1KA+NOCH/NOCH**-NOCH/NOCH*1KA-*                         $3AF27120
       LDI     MX2                                                     $3AF27130
LKAD   LFT     200000              EOF                                 $3AF27140
       TRA     MX5                 NO CHANGE IN MODE                   $3AF27150
       LDI     1,2                                                     $3AF27160
LWRD   LAC     COMM,1              INTERROGATE                         $3AF27170
       CLA     -1,1                LAST WORD IN BUFFER                  3AF27180
       ANA     MXBB2                                                   $3AF27190
       LNT     MODE                TEST MODE                           $3AF27200
       TZE     MX5                 BCD TO BCD                          $3AF27210
       ANA     DISCON              BIN CHECK BIN'BIN                   $3AF27220
       TNZ     MX5                 BIN TO BIN                          $3AF27230
       IIL     MODE                CHANGE MODE BIT                     $3AF27240
       STI     1,2                 STORE IN FILE BITS                   3AF27250
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     3AF27260
MX5    LDI     MX2                 RESTORE SI FOR SELM                  3AF27270
       LXA     S3+1,1                                                  $3AF27280
       CLA     CHATY                                                   $3AF27290
       LBT                                                             $3AF27300
       TRA     *+2                                                     $3AF27310
       TRA     SELM2+2             DISK SEL-                           $3AF27320
       TNZ     SELM1               HYPER SEL-                          $3AF27330
       CAL     XCPT3               CLEAR READ                          $3AF27340
       ANS     1,4                 MODE SWITCH                         $3AF27350
       TRA     SELM1               POST COMPLETION                      3AF27360
MXBB2  OCT     000000050000                                            $3AF27370
XCPT3  OCT     477777777777                                             3AF27380
       SPACE   1                                                        3AF27390
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      3AF27400
*                     BEING REFERENCED BY THE IOBS                      3AF27410
INVM   SXA     INVM1,1             SAVE IR1                             3AF27420
       CLA     0,4                 IF FILE IS                           3AF27430
       ALS     18                  CURRENTLY BEING                      3AF27440
       STD     *+2                 REFERENCED BY IOBS                   3AF27450
       LAC     FCW,1               THEN MODIFY MODE                     3AF27460
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              3AF27470
       TXH     *+4,1,0             AS STORED BY                         3AF27480
       LDI     (IOXSI              IOEX.......                          3AF27490
       IIL     MODE                                                     3AF27500
       STI     (IOXSI                                                   3AF27510
INVM1  AXT     **,1                RESTORE IR1                          3AF27520
       TRA     1,1                 EXIT                                 3AF27530
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    3AF27540
CDMXM  SXA     CDMX4,4             SAVE IR4                             3AF27550
       CAL     1,4                 FIND L(9L)-2                         3AF27560
       PAC     0,4                 IF BOTH                              3AF27570
       CLA     4,4                 8L AND 7L                            3AF27580
       TPL     CDMX4               ARE                                  3AF27590
       CLA     6,4                 (-) TREAT IT AS                      3AF27600
       TPL     CDMX4               END OF FILE                          3AF27610
       LXD     COMM,4              SET L(IORT)+1                        3AF27620
       SXA     COMM,4              AS LAST WD STORED+1                  3AF27630
       SIL     200000              SET EOF BIT                          3AF27640
CDMX4  AXT     **,4                RESTORE IR4                          3AF27650
       TRA     SELM1               RETURN                               3AF27660
       TTL     BACKSPACE RECORD ROUTINE (BSR)                           3AF27670
*      PZE     FILE,,BOFEX      BOFEX= EXIT AFTER BSR OVER EOF          3AF27680
*                                                                       3AF27690
*      ACTION                                                           3AF27700
*      TSX     BSR,4                                                    3AF27710
*              1. UNBUFFERS FILE                                        3AF27720
*              2. IF TAPE AT FILE X RECORD 0 - BOF EXIT OCCURS          3AF27730
*                                                                       3AF27740
BSR.   LNT     OPEND                   IF FILE NOT OPEN                 3AF27750
       TRA     COMXIT                  TAKE NORMAL EXIT                 3AF27760
       TSX     FNLBC,4                 FIND L(POOL)                     3AF27770
       SIR     INSAT                                                    3AF27780
       LFT     OUTPUT                                                   3AF27790
       TRA     BSC2                    UNBUFFER OUTPUT                  3AF27800
       TSX     UNBFI,4                 UNBUFFER INPUT                   3AF27810
BSC1   LDQ     5,2                     IS THIS HYPER                    3AF27820
       RQL     1                                                        3AF27830
       RIR     200000                                                   3AF27840
       TQP     *+2                     NOT HYPER                        3AF27850
       SIR     200000                  HYPER TAPE                       3AF27860
       RNT     600000                  READ BACKWARD                    3AF27870
       TRA     *+5                     NO                               3AF27880
       TSX     (NDSLX,4                                                 3AF27890
       PZE     0,2,HSKRP               SKIP REC. FORWARD                3AF27900
       CLA     1DEC                                                     3AF27910
       TRA     BSR2                                                     3AF27920
       BES     *-11+NOHYP/NOHYP*11-*                                    3AF27930
       TSX     NDSEL+1,4                                                3AF27940
       PZE     0,2,BSROP               BACKSPACE REC.                   3AF27950
       CLS     1DEC                                                     3AF27960
BSR2   ADM     3,2                     ADJUST BLOCK                     3AF27970
       STD     3,2                     SEQUENCE NUMBER                  3AF27980
       LDQ     5,2                 IS THIS DISK                         3AF27990
       TQP     *+4                 NO                                   3AF28000
       ZET     TEMP                YES, DID EOF GET PASSED              3AF28010
       TRA     BOFEX               YES                                  3AF28020
       TRA     COMXIT              NO                                   3AF28030
       BES     *-5+NOCH/NOCH*5-*                                        3AF28040
       AXC     2,4                     IF BACKED OVER                   3AF28050
       CLA*    0,2                     A FILE MARK                      3AF28060
       ANA     ADDRS               STORE ZERO IN                        3AF28070
       ERA     ADDRS               BLOCK COUNT                          3AF28080
       TNZ     COMXIT              AND GIVE THE                         3AF28090
       STD     3,2                     BEGINNING OF FILE EXIT           3AF28100
       TRA     BOFEX                                                    3AF28110
BSC2   TSX     UNBFO,4                                                  3AF28120
       TRA     BSC1                                                     3AF28130
       END                   END OF FORTRAN IOCS                        3AF28140
