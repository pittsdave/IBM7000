$*     7090/7094 BCD CONVERT ROUTINES                                   3F300000
$IBMAP FCNV    1500,()OK                                             (8)3F300001
       TTL     FCNV - BCD CONVERT ROUTINES                          (14)3F300002
CHLIMT EQU     133                 LINE LIMIT IN CHARACTERS          (8)3F300011
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90 ,         $5$3F300012
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94 .        $5$3F300013
*                   (OR TO ANY VALUE NOT EQUAL TO 90.)               $5$3F300014
M9094  SET     90                                                    $5$3F300015
       PCC     ON                                                    $5$3F300016
       IFF     M9094=90                                              $5$3F300017
       GOTO    BEG94                                                 $5$3F300018
       PCC     OFF                                                   $5$3F300019
*              BCD CONVERT ROUTINES                                     3F300030
.WIDTH ENTRY   WIDTH                                                    3F300040
.ENDFS ENTRY   ENDFSW                                                   3F300050
.ONPT  ENTRY   ONPT                                                     3F300060
.OOUT  ENTRY   OOUT                                                     3F300070
.FIXSW ENTRY   FIXSW                                                    3F300080
.DBC   ENTRY   DBC                                                      3F300090
.KOUNT ENTRY   COUNT                                                    3F300100
.INTG  ENTRY   INTG                                                     3F300110
.TEST  ENTRY   TEST                                                     3F300120
.ANPT  ENTRY   ANPT                                                     3F300130
.AOUT  ENTRY   AOUT                                                     3F300140
.FXD   ENTRY   FXD                                                      3F300150
.FXFL1 ENTRY   FXFL1                                                    3F300160
.FXFL2 ENTRY   FXFL2                                                    3F300170
.FXFL3 ENTRY   FXFL3                                                    3F300180
.FLT   ENTRY   FLT                                                      3F300190
.DBC20 ENTRY   DBC20                                                    3F300200
.DDBC  ENTRY   DDBC                                                     3F300210
.DDSW  ENTRY   DDSW                                                     3F300220
.DDFIX ENTRY   DDFIX                                                    3F300230
.DFLT  ENTRY   DFLT                                                     3F300240
.LNTP  ENTRY   LNTP                                                     3F300250
.LOUT  ENTRY   LOUT                                                     3F300260
.DDRS2 ENTRY   DDRST2                                                   3F300270
.CNVSW ENTRY   CNVSW                                                    3F300280
.WORD  ENTRY   WORD                                                     3F300290
.DONE  ENTRY   DONE                                                     3F300300
.OUTBF ENTRY   OUTBUF                                                   3F300310
.DEXPN ENTRY   DEXPON                                                   3F300320
.DIG   ENTRY   DIG                                                      3F300330
.FEXP  ENTRY   EXP                                                      3F300340
.PEX   ENTRY   PEX                                                      3F300350
.MQD   ENTRY   MQD                                                      3F300360
.DDFLG ENTRY   DDFLAG                                                   3F300370
.DDDFL ENTRY   DDDFLG                                                   3F300380
.DDRS1 ENTRY   DDRST1                                                   3F300390
.LIST  ENTRY   LIST                                                     3F300400
       ENTRY   .FBDBF                                                   3F300410
.DBC10 ENTRY   DBC10                                                    3F300420
.D2    ENTRY   D2                                                       3F300430
.D1    ENTRY   D1                                                       3F300440
.FDX1  ENTRY   DX1                                                      3F300450
.FDX2  ENTRY   DX2                                                      3F300460
       ENTRY   .FERR2                                                $5$3F300463
.FPACK ENTRY   PACK                                                     3F300470
.TOPAC ENTRY   TOPACK                                                   3F300480
.CHAR  ENTRY   CHAR                                                     3F300490
BUFADD EQU     .FBDBF                                                   3F300500
       ENTRY   .FCNV.                                                   3F300510
       ENTRY   .FCON.                                                   3F300520
.FCON. STD     DDRST2                SET NOP AND TRA                    3F300530
       STD     CNVSW                 WHERE NECESSARY                    3F300540
       SXA     LNKG,4                                                $5$3F300541
       CLA     DX1                                                      3F300550
       STD     ENDFSW                                                   3F300560
       STZ     PEX                                                      3F300570
       SXA     TEST,2                INITIALIZE ADDRESSES IN            3F300580
       SXA     ENDFSW,1              FCNV TO PREVENT FCNV               3F300590
       CLA     3,4                   DEPENDENCY ON FIOH.                3F300600
       STA     DDRST1                                                   3F300610
       ARS     18                                                       3F300620
       STA     DDRST1+1                                                 3F300630
       CLA     4,4                                                      3F300640
       STA     CNVSW                                                    3F300650
       ARS     18                    STORE BUFFER ADDRESS IN CALL       3F300660
       STA     .FBDBF                CALL WAS FRCD                      3F300670
       TRA     1,4                   RETURN TO FIOH FORMAT SCAN         3F300680
       REM REENTRY FROM MAIN PROGRAM LIST.                              3F300690
.FCNV. NOP     LNKG,4                                                (6)3F300700
       SXA     LXIT1,1                                               (6)3F300701
       SXA     LXIT2,2               SAVE INDEX                         3F300710
       SXA     LEXIT,4               REGISTERS.                         3F300720
       DST     DATUM                 SAVE DATUM.                        3F300740
ENDFSW NOP     **                  * RESCAN FORMAT IF NECESSARY         3F300750
       REM  REENTRY FROM FIELD.                                         3F300760
       DLD     DATUM                 PICKUP DATUM, AND TRA TO (DBC,ANPT,3F300770
CNVSW  TRA     **                  * ONPT,AOUT,OOUT,FLT,FXD,INTG)       3F300780
       LXA     WIDTH,4               IR(4) = DESIRED FIELD WIDTH.       3F300790
       STZ     DG                    INITIALIZE.                        3F300800
       LDQ     MQD                   ..                                 3F300810
DX1    AXT     **,1                  CHARACTER COUNT.                   3F300820
DX2    AXT     **,2                  WORD COUNT.                        3F300830
       TRA*    CNVSW               * EXIT THRU CNVSW.                   3F300840
       REM  DBC / DECIMAL TO BINARY CONVERSION ROUTINE.                 3F300850
DBC    STZ     N                     INITIALIZE.                     (8)3F300870
       STZ     N+1                                                  (13)3F300872
       RIR     DBSPP+DBSEP                                          (13)3F300875
       STZ     V                     ..                                 3F300880
       CLA     FIXSW                                                 (8)3F300884
       STD     DBC9                                                  (8)3F300886
       CLS     DIG                   ..                                 3F300890
       STO     D                     ..                                 3F300900
       CLA     EXP                   ..                                 3F300910
       STO     E                     ..                                 3F300920
       TNO     DBC1                  TURN OFF                           3F300930
       TRA     DBC1                  OVERFLOW LIGHT.                    3F300940
DBCBL  SIR     DBSPP                 MAKE BLANK FIELD MINUS         (13)3F300944
       TRA     DBC15                                                 (8)3F300946
DBC2   TNX     DBCBL,4,1             BUMP WIDTH.                     (8)3F300950
DBC1   TIX     *+4,1,1               BUMP CHARACTER COUNT, IF EXHAUSTED 3F300960
       TXI     *+1,2,-1              GET NEXT WORD.                     3F300970
       AXT     6,1                   ..                                 3F300980
       LDQ*    BUFADD                ..                                 3F300990
       PXD     ,0                    TAKE A                             3F301000
       LGL     6                     CHARACTER.                         3F301010
       CAS     BLANK                 IF IT IS BLANK                     3F301020
       TRA     STOP1                 IGNORE IT.                         3F301030
       TRA     DBC2                  TAKE                               3F301040
       CAS     MINUS                 APPROPRIATE                        3F301050
       TRA     STOP1               * ACTION                             3F301060
       TRA     *+6                   ON                                 3F301070
       CAS     PLUS                  ERRORS, I.E. STOP.                 3F301080
       TRA     DBC9                  FOR LEGAL                          3F301090
       TRA     *+6                   + AND -                            3F301100
       CAS     NEGAT                 SIGNS                              3F301110
       TRA     STOP1               * SET                                3F301120
       CLA     MZE                   THE                                3F301130
       CAS     TEN                   SIGN                               3F301140
       TRA     STOP1               * OF                                 3F301150
DBCS1  PXD     ,0                    THE                                3F301160
       STO     DG                    RESULT.                            3F301170
DBC13  STO     N                     ..                                 3F301180
DBC14  TNX     DBC15,4,1             BUMP WIDTH.                        3F301190
DBC11  TIX     DBC98,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F301200
       TXI     DBC99,2,-1            GET ANOTHER WORD.                  3F301210
DBC3   TNX     DBC6,4,1              ENTRY ON E OR E BLANK, BUMP WIDTH. 3F301220
       TIX     DBC93,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED,3F301230
       TXI     DBC94,2,-1            GET ANOTHER WORD.                  3F301240
DBC94  AXT     6,1                   ..                                 3F301250
       LDQ*    BUFADD                ..                                 3F301260
DBC93  PXD     ,0                    TAKE A                             3F301270
       LGL     6                     CHARACTER.                         3F301280
       CAS     BLANK                 IF IT IS                           3F301290
       TRA     STOP2               * BLANK                              3F301300
       TRA     DBC3                  IGNORE IT.                         3F301310
       SXD     ER,4                  ILLEGAL                            3F301320
DBC4   CAS     MINUS                 CHARACTERS                         3F301330
       TRA     ER                  * CAUSE AN EXIT.                     3F301340
       TRA     DBC92                 A LEGAL                            3F301350
DBC5   CAS     PLUS                  + OR -                             3F301360
       TRA     ER                  * SIGN                               3F301370
       TRA     DBC6                  IS                                 3F301380
       CAS     NEGAT                 USED                               3F301390
       TRA     ER                  * TO                                 3F301400
DBC92  CLA     MZE                   SET                                3F301410
       CAS     TEN                   THE                                3F301420
       TRA     STOP2               * SIGN                               3F301430
DBC6   PXD     ,0                    OF                                 3F301440
DBC95  STO     E                     E, THEN                            3F301450
       TNX     DBC15,4,1             BUMP WIDTH, EXIT WHEN EXHAUSTED.   3F301460
       TIX     DBC96,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F301470
       TXI     DBC97,2,-1            GET ANOTHER WORD  AND CONVERT E.   3F301480
DBC97  AXT     6,1                   GET A NEW WORD FOR                 3F301490
       LDQ*    BUFADD                E FIELD.                           3F301500
DBC96  PXD     ,0                    TAKE A                             3F301510
       LGL     6                     CHARACTER.                         3F301520
       CAS     BLANK                 TREAT BLANK                        3F301530
       TRA     STOP3               * ZERO.                              3F301540
       TRA     *+3                   EXIT FOR                           3F301550
       CAS     TEN                   ILLEGAL CHARACTERS.                3F301560
ER3    TRA     STOP3               * CONVERT                            3F301570
       PXD     ,0                    E FIELD                            3F301580
       STO     DG                    AND                                3F301590
       CLA     E                     STORE                              3F301600
       ALS     2                     IN                                 3F301610
       ADD     E                     E                                  3F301620
       ALS     1                     AND                                3F301630
       ACL     DG                    GO                                 3F301640
       TRA     DBC95                 BUMP WIDTH.                        3F301650
DBC8   CAS     BLANK                 EXAMINE NON-NUMERIC                3F301660
       TRA     STOP4               * CHARACTER.                         3F301670
       TRA     DBC12                 TREAT BLANK AS ZERO.               3F301680
DBC9   NOP     STOP4                 TRA IF I CONVERSION             (8)3F301685
       SXD     U,4                   IF A                            (8)3F301690
       STD     ER                    DECIMAL                            3F301700
       CAS     POINT                 POINT, RECORD                      3F301710
       TRA     DBC4                  FIELD                              3F301720
       TXI     DBC30,4,-1            WIDTH.                             3F301730
DBC10  CAS     EXPON                 ON AN E (OR D FOR DOUBLE PRECISION)3F301740
       TRA     STOP4               * GO CONVERT                         3F301750
       TRA     DBC3                  E FIELD.                           3F301760
       TRA     DBC5                  ANYTHING ELSE CONTINUE ABOVE.      3F301770
DBC30  PXA     ,4                    DECIMAL POINT FIELD POSITION       3F301780
       STO     U                     IS SET                             3F301790
       STO     D                     HERE.                              3F301800
       TXI     DBC14,4,1             EXIT TO CONTINUE.                  3F301810
DBC99  AXT     6,1                   GET A                              3F301820
       LDQ*    BUFADD                NEW WORD.                          3F301830
DBC98  PXD     ,0                    TAKE A                             3F301840
       LGL     6                     CHARACTER.                         3F301850
       CAS     TEN                   TREAT BLANK                        3F301860
       TRA     DBC8                  AS ZERO, EXAMINE                   3F301870
DBC12  PXD     ,0                    OTHER NON-NUMERICS AT DBC8.        3F301880
       STA     DG                    CONVERT                            3F301890
       CLA     N                     BCD                                3F301900
       ALS     2                     TO                                 3F301910
       ADD     N                     BINARY                             3F301920
       ALS     1                     AND                                3F301930
       ADD     DG                    IF                                 3F301940
       TNO     DBC13                 NO OVERFLOW CONTINUE.              3F301950
DBC20  TRA     *+1                   DOUBLE PRECISION OVERFLOW SWITCH.  3F301960
       CLA     V                     IF OVERFLOW, IGNORE                3F301970
       ADD     L(1)                  CONVERTED RESULT, BUT              3F301980
       STO     V                     ADD ONE TO V.                      3F301990
       TIX     DBC11,4,1             BUMP WIDTH.                        3F302000
DBC15  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F302010
       SXA     DX1,1                 CHARACTERS AND                     3F302020
       SXA     DX2,2                 COUNTS.                            3F302030
       CLA     N                     PICK UP CONVERTED N.               3F302050
       TZE     DBEXIT                EXIT ON N = 0.                     3F302060
       TPL     *+3                                                   $5$3F302070
       SIR     DBSPP                                                 $5$3F302075
       SSP                                                           $5$3F302080
       NZT     DDFLAG                                               (13)3F302085
DDSW   TRA     DDFIX                                                (13)3F302095
       CLA     ND+1                                                 (13)3F302100
       STO     N+1                                                  (13)3F302105
       CLA     ND                                                   (13)3F302110
DDFIX  STO     N                                                    (13)3F302115
FIXSW  NOP     DBEXIT                                                $5$3F302120
       CLA     D             -DIG FROM FORMAT SPEC                   $5$3F302125
       TMI     *+4           WAS DEC POINT SPECIFIED - NO            $5$3F302130
       CLA     U             YES                                     $5$3F302135
       ARS     18                                                    $5$3F302140
       SUB     D                                                     $5$3F302145
       ADD     E                                                     $5$3F302150
       ADD     V             OVERFLOW COUNT                          $5$3F302155
       TPL     *+2                                                   $5$3F302160
       SIR     DBSEP         SAVE SIGN OF EXPONENT                   $5$3F302165
       PAX     0,1           XR1=TRUE EXPONENT                       $5$3F302170
       AXT     128,2                                                 $5$3F302175
       ZET     DDFLAG                                                $5$3F302180
       AXT     163,2                                                 $5$3F302185
       STZ     N+2                                                   $5$3F302190
       AXT     0,4                                                   $5$3F302200
       TXL     DB832,1,0                                             $5$3F302205
       AXC     N,4                                                   $5$3F302210
DB827  SXA     DB831,1                                               $5$3F302215
       TXL     *+2,1,10                                              $5$3F302220
       AXT     10,1                                                  $5$3F302225
       CLA     IC10+10,1                                             $5$3F302230
       STO     DB8PW                                                 $5$3F302235
       RNT     DBSEP                                                 $5$3F302240
       TXI     DB829,4,-2    EXPONENT IS POSITIVE                    $5$3F302245
*                            NEGATIVE EXPONENT                       $5$3F302250
       PXD     0,0                                                   $5$3F302255
       AXT     3,1                                                   $5$3F302260
       AXT     3,4                                                   $5$3F302265
DB828  LDQ     N+3,4                                                 $5$3F302270
       DVP     DB8PW                                                 $5$3F302275
       STQ     N+3,1                                                 $5$3F302280
       NZT     N                                                     $5$3F302285
       TXI     *+2,2,-35     REDUCE CHARACTERISTIC                   $5$3F302290
       TNX     DB831,1,1     STEP TO NEXT RESULT STORAGE             $5$3F302295
       TIX     DB828,4,1                                             $5$3F302300
       LDQ     =0                                                    $5$3F302305
       TRA     DB828+1                                               $5$3F302310
DDBC   STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F302370
       SXA     DDSV4,4                                                  3F302380
       AXT     DDBC7,4               SET DOUBLE PRECISION EXIT AFTER    3F302390
       SXA     DBC99-1,4             DECIMAL POINT IS SCANNED.          3F302400
DDSV4  AXT     **,4                                                     3F302410
       STZ     DATUM+1                                                  3F302420
       STL     DDFLAG                SET FLAG INDICATING DOUBLE         3F302430
       PXD     0,0                   PRECISION RESULT OCCUPIES TWO      3F302440
       LDQ     N                     CELLS AND SET PARTIALLY            3F302450
       LRS     0                     CONVERTED RESULT IN                3F302460
       DST     ND                    LOW ORDER PART.                    3F302470
       TRA     DDBC4                                                    3F302480
DDBC1  TIX     DDBC2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F302490
       TXI     DDBC3,2,-1            GET ANOTHER WORD.                  3F302500
DDBC3  AXT     6,1                   RESET CHARACTER COUNT.             3F302510
       LDQ*    BUFADD                GET A NEW WORD.                    3F302520
DDBC2  PXD     0,0                   EXAMINE                            3F302530
       LGL     6                     NEXT CHARACTER.                    3F302540
       CAS     TEN                   TREAT BLANK AS ZERO.               3F302550
       TRA     DDBC5                 NON-NUMERIC.                       3F302560
DDBC6  PXD     0,0                                                      3F302570
       STA     DG                    SAVE NUMERIC CHARACTER.            3F302580
       STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F302590
       DLD     ND                                                       3F302600
DDBC4  LLS     2                     CONVERT BCD TO BINARY.             3F302610
       TOV     DDOV                  THIS INVOLVES DOUBLE PRECISION     3F302620
       STO     F                     FIXED POINT ADDITION.              3F302630
       XCA                                                              3F302640
       ADD     ND+1                                                     3F302650
       XCA                                                              3F302660
       PXD     0,0                                                      3F302670
       CLA     F                                                        3F302680
       TNO     *+2                                                      3F302690
       ADD     L(1)                                                     3F302700
       ADD     ND                                                       3F302710
       TOV     DDOV                                                     3F302720
       LLS     1                                                        3F302730
       TOV     DDOV                                                     3F302740
       XCA                                                              3F302750
       ADM     DG                                                       3F302760
       XCA                                                              3F302770
       TNO     *+2                                                      3F302780
       ADD     L(1)                                                     3F302790
       TOV     DDOV                                                     3F302800
       DST     ND                                                       3F302810
       LDQ     DMQD                                                     3F302820
DDBC7  TNX     DBC15,4,1             BUMP WIDTH.                        3F302830
       TRA     DDBC1                                                    3F302840
DDBC5  CAS     BLANK                 EXAMINE NON-NUMERIC CHARACTER.     3F302850
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F302860
       TRA     DDBC6                 TREAT BLANK AS ZERO.               3F302870
       TRA     DBC9                                                     3F302880
DDOV   LDQ     DMQD                  IF OVERFLOW,IGNORE CONVERTED       3F302890
       CLA     V                     RESULT BUT ADD ONE TO V.           3F302900
       ADD     L(1)                                                     3F302910
       STO     V                                                        3F302920
       TIX     DDOV1,4,1             BUMP WIDTH.                        3F302930
       TRA     DBC15                 EXIT WHEN WIDTH EXHAUSTED.         3F302940
DDOV1  TIX     DDOV2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F302950
       TXI     *+1,2,-1              GET ANOTHER WORD.                  3F302960
       AXT     6,1                   RESET CHARACTER COUNT.             3F302970
       LDQ*    BUFADD                GET A NEW WORD.                    3F302980
DDOV2  PXD     0,0                   EXAMINE                            3F302990
       LGL     6                     NEXT CHARACTER.                    3F303000
       CAS     TEN                                                      3F303010
       TRA     DDOV3                                                    3F303020
       TRA     DDOV+1                                                   3F303030
       TRA     DDOV+1                                                   3F303040
DDOV3  CAS     BLANK                                                    3F303050
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F303060
       TRA     DDOV+1                TREAT BLANK AS ZERO.               3F303070
       TRA     DBC9                                                     3F303080
*                  POSITIVE EXPONENT                                 $5$3F303090
DB829  AXT     3,1                                                   $5$3F303100
       LDQ     DB8PW                                                 $5$3F303110
       MPY     0,4                                                   $5$3F303120
       TXH     DB830,1,2                                             $5$3F303130
       XCA                                                           $5$3F303140
       ADD     1,4                                                   $5$3F303150
       XCL                                                           $5$3F303160
       TQP     *+3                                                   $5$3F303170
       ADD     L(1)                                                  $5$3F303180
       LRS     0                                                     $5$3F303190
DB830  STO     0,4                                                   $5$3F303200
       STQ     1,4                                                   $5$3F303210
       TNX     *+2,1,1                                               $5$3F303220
       TXI     DB829+1,4,1                                           $5$3F303230
       TZE     *+2                                                   $5$3F303240
       TXI     DB831,2,35    INCREMENT CHARACTERISTIC                $5$3F303250
       TXI     *+1,4,-1                                             (13)3F303255
       TXH     DB831,4,-ND                                          (13)3F303260
       AXC     N,4                                                  (13)3F303265
DB831  AXT     **,1                                                  $5$3F303270
       TIX     DB827,1,10                                            $5$3F303280
       RFT     DBSEP                                                 $5$3F303290
DB832  AXC     N,4                                                   $5$3F303300
*                  FLOAT NUMBER                                      $5$3F303310
       LFTM                                                          $5$3F303320
       CLA     0,4                                                   $5$3F303330
       LRS     8                                                     $5$3F303340
       ADD     DB871         35B8                                    $5$3F303350
       STO     DB8PW                                                 $5$3F303360
       CLA     DB872         27B16                                   $5$3F303370
       LLS     8                                                     $5$3F303380
       FAD     DB8PW                                                 $5$3F303390
       ARS     9                                                     $5$3F303400
       PDX     0,1                                                   $5$3F303410
       STD     *+1                                                   $5$3F303420
       TXI     *+1,2,**                                              $5$3F303430
       TXH     FERR3,2,1000                                          $5$3F303440
       TXH     FERR2,2,255                                           $5$3F303450
       CLA     1,4                                                   $5$3F303460
       LDQ     2,4                                                   $5$3F303470
       LLS     35,1                                                  $5$3F303480
       STO     2,4                                                   $5$3F303490
       CLA     0,4                                                   $5$3F303500
       LDQ     1,4                                                   $5$3F303510
       LLS     35,1                                                  $5$3F303520
       LDQ     2,4                                                   $5$3F303530
       LRS     8                                                     $5$3F303540
       STO     0,4                                                   $5$3F303550
       PXD     0,2                                                   $5$3F303560
       ALS     9                                                     $5$3F303570
       TOV     *+1                                                   $5$3F303580
       ZET     DDDFLG                                                $5$3F303590
       TXI     DB833,2,-27   DOUBLE PRECISION                        $5$3F303600
DB834  ORA     0,4           SINGLE PRECISION                        $5$3F303610
       RQL     28                                                    $5$3F303620
       FRN                                                           $5$3F303625
       TRA     DBEXIT-1                                             (13)3F303630
DB833  TXH     DB834,2,256                                           $5$3F303635
       ORS     0,4                                                   $5$3F303640
       PXA     0,2                                                   $5$3F303645
       LLS     27                                                    $5$3F303650
       RQL     28                                                    $5$3F303655
       FRN                                                           $5$3F303660
       FAD     0,4                                                   $5$3F303665
       EFTM                                                          (6)3F303673
DBEXIT RFT     DBSPP                                                 $5$3F303675
       SSM                                                           $5$3F303680
       LRS     0                                                     $5$3F303685
       LAS     CHTEST                                                $5$3F303686
       TRA     *+3                                                   $5$3F303687
       TRA     *+2                                                   $5$3F303688
       LDQ     =0                                                    $5$3F303689
       DST     DATUM                                                 $5$3F303690
       STZ     N+1                                                   (6)3F303701
       TRA     COUNT-2                                               $5$3F303710
       EVEN                                                          $5$3F303712
CHTEST DEC     1.EE-30                                               $5$3F303713
IC10   DEC     10000000000,1000000000,100000000,10000000,1000000     $5$3F303720
       DEC     100000,10000,1000,100,10,1                            $5$3F303721
DDRSET AXT     DBC14,4               RESET EXIT CHANGED FOR TWO-CELL    3F303730
       SXA     DBC99-1,4             DOUBLE PRECISION CONVERSION.       3F303740
       STZ     DDFLAG                RESET FLAG.                        3F303750
       LXA     COUNT,4               IF FIELD                           3F303760
       TNX     DDRST1,4,1            COUNT IS                           3F303770
       TRA     COUNT                 EXHAUSTED,                         3F303780
DDRST1 AXT     **,4                  RESET ALL DOUBLE PRECISION EXITS   3F303790
       SXA     **,4                                                     3F303800
DDRST2 NOP     D3                                                       3F303810
       AXT     EXPON,4                                                  3F303820
       SXA     DBC10,4                                                  3F303830
D1     AXT     **,4                                                     3F303840
       SXA     DBC20,4                                                  3F303850
D2     AXT     **,4                                                     3F303860
       SXA     DDSW,4                                                   3F303870
D3     STZ     DDDFLG                                                   3F303880
       TRA     1,2                                                      3F303890
       REM  ILLEGAL INPUT DATA.                                         3F303900
STOP1  CLA     BUFADD                STORE LOCATION OF INPUT            3F303910
       ALS     18                    BUFFER FOR FXEM.                   3F303920
       STD     CODE1                                                    3F303930
       SXA     SP1SV,4                                                  3F303940
1STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F303950
SP1SV  AXT     **,4                                                     3F303960
       TOV     *+1                                                   (6)3F303961
       TRA     DBCS1                                                    3F303970
ER     TXH     STOP4,4,**                                               3F303980
STOP2  CLA     BUFADD                STORE LOCATION OF INPUT            3F303990
       ALS     18                    BUFFER FOR FXEM.                   3F304000
       STD     CODE1                                                    3F304010
       SXA     SP2SV,4                                                  3F304020
2STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304030
SP2SV  AXT     **,4                                                     3F304040
       TRA     DBC6                                                     3F304050
STOP3  CLA     BUFADD                STORE LOCATION OF INPUT            3F304060
       ALS     18                    BUFFER FOR FXEM.                   3F304070
       STD     CODE1                                                    3F304080
       SXA     SP3SV,4                                                  3F304090
3STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304100
SP3SV  AXT     **,4                                                     3F304110
       TRA     ER3+1                                                    3F304120
STOP4  CLA     BUFADD                STORE LOCATION OF INPUT            3F304130
       ALS     18                    BUFFER FOR FXEM.                   3F304140
       STD     CODE1                                                    3F304150
       SXA     SP4SV,4                                                  3F304160
4STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304170
SP4SV  AXT     **,4                                                  (6)3F304175
       TOV     *+1                                                   (6)3F304176
       TRA     DBC12                                                 $5$3F304181
FERR2  TSX     .FERR2,1                                              $5$3F304182
       OCT     377777777777                                          $5$3F304183
       OCT     344777777777                                          $5$3F304184
FERR3  TSX     .FERR2,1                                              $5$3F304185
       DEC     0                                                     $5$3F304186
       DEC     0                                                     $5$3F304187
.FERR2 CALL    .FXEM.(CODE3)      OVERFLOW OR UNDERFLOW              $5$3F304188
       CLA     1,1                                                   $5$3F304189
       EFTM                                                          (6)3F30418A
       LDQ     2,1                                                   $5$3F304190
       TRA     DBEXIT+3                                              $5$3F304191
CODE3  PZE     71                                                    $5$3F304192
ER71MS PZE     E71MES,,11                                            $5$3F304193
ER71OP PZE     E71OMS,,6                                             $5$3F304194
E71MES BCI     8,0INPUT DATA NOT WITHIN PERMISSIBLE RANGE OF FLOA    $5$3F304195
       BCI     3,TING POINT NUMBERS                                  $5$3F304196
E71OMS BCI     6,0READING OF INPUT DATA CONTINUES                    $5$3F304197
       REM  ENTRY FOR INPUT OF ALPHAMERIC DATA.                         3F304200
ANPT   TIX     ANPT1,1,1             SCAN THE CURRENT INPUT FIELD.      3F304210
       TXI     *+1,2,-1              IF WIDTH                           3F304220
       LDQ*    BUFADD                IS GREATER THAN OR EQUAL TO SIX,   3F304230
       AXT     6,1                   OBTAIN                             3F304240
ANPT1  LGL     6                     THE SIX                            3F304250
       TIX     ANPT,4,1              RIGHTMOST                          3F304260
       SXA     DX2,2                 CHARACTERS.                        3F304270
       STQ     MQD                   ..                                 3F304280
       LXA     WIDTH,4               LEFT ADJUST, IF LESS THAN SIX      3F304290
       LDQ     BLANKS                AND                                3F304300
       TXH     ONPT4,4,5           * FILL OUT                           3F304310
       LGL     6                     WORD                               3F304320
       TXI     *-2,4,1               WITH BLANKS.                       3F304330
       REM  ENTRY FOR INPUT OF OCTAL DATA.                              3F304340
ONPT   STZ     N                     CONVERT                            3F304350
       STZ     BLCNT                                                 (8)3F304355
ONPT1  TIX     *+6,1,1               FROM                               3F304360
       LXA     DX2,2                 OCTAL                              3F304370
       TXI     *+1,2,-1              TO                                 3F304380
       LDQ*    BUFADD                BINARY.                            3F304390
       SXA     DX2,2                 IF FIELD                           3F304400
       AXT     6,1                   WIDTH IS                           3F304410
       PXD     ,0                    GREATER THAN 12                    3F304420
       LGL     6                     ONLY THE 12                        3F304430
       PAX     ,2                    RIGHTMOST                          3F304440
       TXL     ONPT3,2,7             DIGITS ARE                         3F304450
       SUB     BLANK                 SIGNIFICANT.                       3F304460
       TZE     CNTBL                 IF LESS                         (8)3F304470
       ZET     BLCNT                                                 (8)3F304478
       TRA     STOP5                 (ILLEGAL CHARACTER)             (8)3F304479
       CLA     MZE                   THAN 12,                           3F304480
       TXL     STOP5,2,11            RIGHT-ADJUST                       3F304490
       TXL     ONPT2,2,12            AND FILLOUT                        3F304500
       TXH     STOP5,2,32            WITH                               3F304510
       TXH     ONPT2,2,32-1          ZEROS.                             3F304520
       TXH     STOP5,2,16            TREAT BLANKS                       3F304530
       TXH     ONPT3,2,16-1          AS ZEROS.                          3F304540
STOP5  CLA     BUFADD                STORE LOCATION OF INPUT            3F304550
       ALS     18                    BUFFER FOR FXEM.                   3F304560
       STD     CODE2                                                    3F304570
       SXA     SP5SV,4                                                  3F304580
5STOP  CALL    .FXEM.(CODE2)         EXIT FOR EXECUTION ERROR.          3F304590
SP5SV  AXT     **,4                                                     3F304600
       TRA     ONPT3                 ILLEGAL INPUT DATA.                3F304610
CNTBL  ZET     BLCNT                                                 (8)3F304620
       TRA     ONPT3                 INPUT DATA NOT BLANK FIELD.     (8)3F304625
       TRA     ONPT3A                                                (8)3F304630
ONPT2  STO     DG                    SET SIGN MINUS.                 (8)3F304640
ONPT3  STA     DG                    ..                                 3F304650
       CAL     N                     ..                                 3F304660
       ALS     3                     ..                                 3F304670
       ADM     DG                    ..                                 3F304680
       SLW     N                     ..                                 3F304690
       STL     BLCNT                 (INPUT DATA NOT ALL BLANKS)     (8)3F304695
ONPT3A TIX     ONPT1,4,1                                             (8)3F304700
       NZT     BLCNT                 IS INPUT DATA FIELD BLANK...    (8)3F304708
       ORA     MZE                   YES.  TREAT IT AS MINUS ZERO.   (8)3F304709
       ORA     DG                    ..                                 3F304710
       STQ     MQD                   ..                                 3F304720
       REM  ENTRY FROM ANPT.                                            3F304730
ONPT4  SLW     DATUM                 ..                                 3F304740
       SXA     DX1,1                 ..                                 3F304750
       TRA     COUNT               * EXIT TO TEST FIELD COUNT.          3F304760
       REM  ENTRY FOR INPUT OF LOGICAL DATA                             3F304770
LNTP   STZ     DATUM                 SET LOGICAL VARIABLE TO FALSE.     3F304780
LNTP0  TIX     LNTP1,1,1             IS CHARACTER COUNT EXHAUSTED.      3F304790
       TXI     *+1,2,-1              YES. INCREMENT WORD COUNT.         3F304800
       AXT     6,1                                                      3F304810
       LDQ*    BUFADD                GET NEXT INPUT WORD.               3F304820
LNTP1  PXD     ,0                                                       3F304830
       LGL     6                     TAKE A CHARACTER.                  3F304840
       CAS     TRUE                                                     3F304850
       TRA     STOPL                                                    3F304860
       TRA     LNPT3                 CHARACTER = T.                     3F304870
       CAS     BLANK                                                    3F304880
       TRA     STOPL                                                    3F304890
       TRA     LNPT2                 CHARACTER = BLANK.                 3F304900
       CAS     FALSE                                                    3F304910
       TRA     STOPL                                                    3F304920
       TRA     LNPT4                 CHARACTER = F.                     3F304930
STOPL  CLA     BUFADD                ERROR. ILLEGAL INPUT CHARACTER.    3F304940
       ALS     18                                                       3F304950
       STD     CODE9                                                    3F304960
       SXA     SPLSV,4                                                  3F304970
       CALL    .FXEM.(CODE9)         OPTIONAL RETURN IS TREAT AS BLANK. 3F304980
SPLSV  AXT     **,4                                                     3F304990
LNPT2  TIX     LNTP0,4,1                                                3F305000
       TRA     LNPT6                 IF FIELD IS BLANK, ASSUME FALSE.   3F305010
LNPT3  STL     DATUM                 SET LOGICAL VARIABLE TO TRUE.      3F305020
LNPT4  TNX     LNPT6,4,1             SKIP TO END OF INPUT FIELD.        3F305030
       TIX     LNPT5,1,1                                                3F305040
       TXI     *+1,2,-1                                                 3F305050
       AXT     6,1                                                      3F305060
       LDQ*    BUFADD                                                   3F305070
LNPT5  LGL     6                                                        3F305080
       TRA     LNPT4                                                    3F305090
LNPT6  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F305100
       SXA     DX1,1                 CHARACTER AND                      3F305110
       SXA     DX2,2                 WORD COUNTS.                       3F305120
       TRA     COUNT                 GO TEST FIELD COUNT.               3F305130
       REM  ENTRY FOR OUTPUT OF ALPHAMERIC DATA.                        3F305140
AOUT   LXA     WIDTH,4               STARTING ON THE LEFT,              3F305150
       XCA                           MOVE THE SPECIFIED NUMBER          3F305160
       TXL     *+2,4,6               OF ALPHANUMERICS                   3F305170
       AXT     6,4                   FROM THE CURRENT WORD              3F305180
       PXD     ,0                    INTO THE                           3F305190
       LGL     6                     CHARACTER BUFFER.                  3F305200
       SLW     CHAR,4                THEN GO                            3F305210
       TIX     *-3,4,1               FILL OUT THE FIELD                 3F305220
       TXI     TOPACK,4,5          * WITH LEADING BLANKS.               3F305230
       REM  ENTRY FOR OUTPUT OF OCTAL DATA.                             3F305240
OOUT   XCA                           STARTING ON THE RIGHT,             3F305250
       AXT     12,4                  CONVERT THE                        3F305260
       PXD     ,0                    CURRENT                            3F305270
       LGL     3                     WORD                               3F305280
       SLW     CHAR,4                FROM                               3F305290
       TIX     *-3,4,1               BINARY                             3F305300
       LXA     WIDTH,4               TO                                 3F305310
       TXH     OUTEX,4,11            OCTAL                              3F305320
       LDQ     DATUM                 AND                                3F305330
       PXD     ,0                    MOVE                               3F305340
       LLS     2                     INTO                               3F305350
       TNZ     OUTEX                 CHARACTER                          3F305360
       CAL     BLANK                 BUFFER.                            3F305370
       AXT     10,4                  CONVERT                            3F305380
       ZET     CHAR-1,4              LEADING                            3F305390
       TXI     *+3,4,1               ZEROS                              3F305400
       SLW     CHAR-1,4              TO BLANKS.                         3F305410
       TIX     *-3,4,1               SIGN                               3F305420
       TQP     *+3                   THE NUMBER,                        3F305430
       CAL     MINUS                 IF                                 3F305440
       SLW     CHAR-1,4              NEGATIVE                           3F305450
OUTEX  AXT     12,4                  AND WITHIN FIELD SIZE              3F305460
       TRA     TOPACK              * GO FILL OUT FIELD WITH BLANKS.     3F305470
       REM  ENTRY FOR OUTPUT OF LOGICAL DATA                            3F305480
LOUT   LDQ     TFTEST                PICKUP T AND F CHARACTERS.         3F305490
       PXD     ,0                                                       3F305500
       NZT     DATUM                 TEST LOGICAL VARIABLE.             3F305510
       RQL     6                     LOGICAL VARIABLE IS FALSE.         3F305520
       LGL     6                     LOGICAL VRAIABLE IS TRUE.          3F305530
       AXT     1,4                                                      3F305540
       STO     CHAR,4                SAVE CHARACTER AND GO TO FILL      3F305550
       TRA     TOPACK                OUT FIELD WITH LEADING BLANKS.     3F305560
       REM  BDC/BINARY TO DECIMAL CONVERSION.                           3F305570
       REM  ENTRY FOR DOUBLE-PRECISION FLOATING POINT OUTPUT.           3F305580
DFLT   TZE     BDC1                  EXIT ON ZERO                    (6)3F305590
       XCL                           PBIT ASSUMED OFF                (6)3F305600
       PXD     ,0                    OBTAIN CHARACTERISTIC              3F305640
       LLS     8                     MODULO 128.                        3F305650
       SUB     =128                  OBTAIN APPROXIMATION OF POWER      3F305660
       XCA                           OF TEN CORRESPONDING TO THIS       3F305670
       VLM     LOG2,,12              POWER OF TWO BY MULTIPLYING        3F305680
       PAX     ,2                    BY LOG 2. INTEGRAL PORTION OF      3F305690
       ALS     1                     RESULT IS IN ACCUMULATOR.          3F305700
       TPL     DFLT2                                                    3F305710
       PAC     ,4                    PREPARE TO COMPARE DATA WITH       3F305720
       CLA     DATUM                 POWERS OF TEN FROM -1 TO -38.      3F305730
       LAS     D1E0+2,4              COMPARE HIGH ORDER PORTION.        3F305740
       TRA     DFLT3                 TRUE SCALE.                        3F305750
       TRA     CMPLSN                GO TO COMPARE LOW ORDER PORTION.   3F305760
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F305770
DFLT2  PAX     ,4                    PREPARE TO COMPARE DATA WITH       3F305780
       CLA     DATUM                 POWERS OF TEN FROM 0 TO +38.       3F305790
       LAS     D1E0,4                COMPARE HIGH ORDER PORTION.        3F305800
       TXI     *+2,2,1               ADJUST EXPONENT UP BY ONE.         3F305810
       TRA     CMPLSP                GO TO COMPARE LOW ORDER PORTION.   3F305820
DFLT3  PXA     0,2                   TRUE EXPONENT.                     3F305830
       LLS     0                     GET SIGN OF EXPONENT.              3F305840
       SUB     PEX                   ADJUST EXPONENT BY SCALE FACTOR.   3F305850
DFLT3A STO     EXP                                                   (6)3F305860
       LDQ     DEXPON                PREPARE TO PLACE A D IN EXPONENT   3F305870
       STQ     CHAR-4                FIELD FOR OUTPUT.                  3F305880
       LDI     BLANK                                                    3F305890
       TPL     *+3                                                   (6)3F305900
       TZE     *+2                                                   (6)3F305905
       RIR     20                                                       3F305910
       STI     CHAR-3                SET SIGN OF EXPONENT FOR OUTPUT.   3F305920
       LDQ     L(1)                  FORM BCD REPRESENTATION OF         3F305930
       LRS     3                     EXPONENT AND STORE FOR OUTPUT.     3F305940
       VDP     TEN,,3                                                   3F305950
       STQ     CHAR-2                                                   3F305960
       SLW     CHAR-1                                                   3F305970
       CLA     EXP                                                      3F305980
       ALS     1                     DOUBLE EXPONENT FOR             (6)3F305990
       PAX     ,4                    PURPOSES OF INDEXING            (6)3F306000
       TMI     DFLT5                 IS MULTIPLICATION REQUIRED      (6)3F306010
       DLD     DATUM                 NO,PREPARE TO DIVIDE            (6)3F306020
       TXL     DFLT7,4,0             IS SCALING NEEDED               (6)3F306030
       TNX     DFLT4,4,2*38   YES                                    (6)3F306035
       DFDP    DE38           DIVIDE BY 10**38 SINCE EXP .GT. 76     (6)3F306040
DFLT4  DFDP    D1E0,4         OTHERWISE ONLY ONE DIVISION NECESSARY  (6)3F306050
       TRA     DFLT7                                                 (6)3F306060
DFLT5  DLD     DATUM                 FOR NEGATIVE EXP,SCALING        (6)3F306070
       TNX     DFLT6,4,2*38                                          (6)3F306075
       DFMP    DE38           MULTIPLY BY 10**38 SINCE EXP .LT. 76   (6)3F306080
DFLT6  DFMP    D1E0,4         OTHERWISE ONE MULTIPLICATION NEEDED    (6)3F306090
       USE     REMOTE                GET CODING OUT OF THE WAY       (6)3F306180
CMPLSN CLA     DATUM+1               COMPARE LOW ORDER PORTION FOR CASE 3F306190
       LAS     D1E0+3,4              OF EQUAL HIGH ORDER COMPARE.       3F306200
       TRA     DFLT3                 TRUE SCALE.                        3F306210
       TRA     DFLT3                 TRUE SCALE.                        3F306220
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306230
CMPLSP CLA     DATUM+1               COMPARE LOW ORDER PORTION FOR CASE 3F306240
       LAS     D1E0+1,4              OF EQUAL HIGH ORDER COMPARE.       3F306250
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306260
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306270
       TRA     DFLT3                 TRUE SCALE.                        3F306280
       USE                           CONTINUE IN-LINE CODE           (6)3F306290
DFLT7  XCL                           STORE ABSOLUTE VALUE OF SCALED     3F306300
       XCA                           NUMBER.                            3F306310
       DST     N                                                        3F306320
       CAS     D1E0-15               COMPARE SCALED NUMBER              3F306330
       NOP                           WITH 200000000000.                 3F306340
       TRA     DFLT12                TRANSFER IF EQUAL OR GREATER.      3F306350
       STZ     ND+1                  NO INTEGER PORTION.                3F306360
       UFA     =128B8                EXPRESS FRACTIONAL PORTION         3F306370
       STO     FD                    OF SCALED DATA WITH                3F306380
       XCA                           CHARACTERISTIC OF 200.             3F306390
       UFA     N+1                   SHIFT SO THAT BINARY POINT         3F306400
       LDQ     FD                    IS BETWEEN SIGN AND BIT 1          3F306410
DFLT11 ALS     8                     OF MOST SIGNIFICANT PORTION.       3F306420
       XCA                                                              3F306430
       LLS     8                                                        3F306440
       DST     FD                    STORE FRACTIONAL PORTION           3F306450
       TOV     *+1                   AND TURN OFF OVERFLOW INDICATOR.   3F306460
ROUND  CLA     DIG                   PICK-UP DECIMAL DIGIT INDICATOR.   3F306490
       ALS     1                     SET INDEXING TO OBTAIN             3F306500
       PAC     0,4                   APPROPRIATE ROUNDING FACTOR.       3F306510
       CLA     FD+1                  ROUND LOW ORDER PORTION OF         3F306520
       ADD     DRND+1,4              BINARY FRACTION                 (6)3F306530
       STO     FD+1                  AND STORE.                         3F306540
       CLA     FD                    ROUND HIGH ORDER PORTION           3F306550
       TNO     *+2                   OF BINARY FRACTION                 3F306560
       ADD     L(1)                  ADJUSTING FOR OVERFLOW             3F306570
       ADD     DRND,4                IF ANY                          (6)3F306580
       STO     FD                    AND STORE.                         3F306590
       CLA     ND+1                  GET INTEGER PART IN AC.         (6)3F306600
       TNO     DFLT8                 IF NO OVERFLOW, GO TO CONVERT.  (6)3F306610
       ADD     L(1)                  ADJUST INTEGER PART             (6)3F306620
       STO     ND+1                  AND STORE.                         3F306630
DFLT8  LXA     PEX,4                 GET P SCALE FACTOR              (6)3F306640
       CAS     IC10+10,4                                             (6)3F306650
       TRA     DFLT8A                                                (6)3F306655
       TRA     DFLT8A                                                (6)3F306660
       USE     REMOTE                                                (6)3F306665
DFLT8A CLA     EXP                                                   (6)3F306670
       ADD     L(1)                                                  (6)3F306675
       TRA     DFLT3A                                                (6)3F306680
       USE                                                           (6)3F306685
       LXA     DIG,4                 PREPARE TO CONVERT BIN FRACTION (6)3F306686
       TXL     FXFL3,4,0             EXIT IF DIG = 0                 (6)3F306687
       DLD     FD                    TO DECIMAL FRACTION.               3F306690
DFLT9  LRS     2                     4 BITS,ONE                         3F306700
       XCA                           CHARACTER AT                       3F306710
       ADD     FD+1                  A TIME.                            3F306720
       XCA                                                              3F306730
       TNO     *+2                                                      3F306740
       ADD     L(1)                                                     3F306750
       ADD     FD                                                       3F306760
       DST     MULT                                                     3F306770
       ARS     32                                                       3F306780
       SLW     CHAR-4,4              STORE DECIMAL CHARACTER.           3F306790
       DLD     MULT                                                     3F306800
       ANA     DGMASK                REMOVE BITS JUST CONVERTED.        3F306810
       LLS     3                                                        3F306820
       DST     FD                                                       3F306830
       TOV     *+1                                                      3F306840
       TIX     DFLT9,4,1             REPEAT UNTIL DONE.                 3F306850
       CLA     ND+1                  GET INTEGER AND                    3F306860
       TRA     BDC2                  GO TO CONVERT.                     3F306870
DFLT12 UFA     =155B8                OBTAIN INTEGER PART             (6)3F306880
       ANA     CHMASK                DISCARD CHARACTERISTIC.            3F306920
       STO     ND+1                  STORE INTEGER PORTION.             3F306930
       XCA                           OBTAIN FRACTIONAL PORTION          3F306940
       UFA     N+1                   OF SCALED DATA.                    3F306950
       XCA                                                              3F306960
       TRA     DFLT11                                                   3F306970
       REM  BDC / BINARY TO DECIMAL CONVERSION.                         3F307110
       REM  ENTRY FOR SINGLE-PRECISION FLOATING POINT OUTPUT.           3F307120
FLT    TZE     BDC1                  EXIT ON ZERO.                      3F307130
       XCL                           P, Q BITS ASSUMED OFF              3F307140
       PXD     ,0                    ..                                 3F307150
       LLS     8                     ..                                 3F307160
       SUB     =128                  MODULO 128                         3F307170
       XCA                           FORM APPROX. OF DEC. SCALE         3F307180
       VLM     LOG2,,12              BY * LOG2 AT Q OF 23               3F307190
       PAX     ,2                    0-38 POSSIBLE IN IR2               3F307200
       TPL     FLT1                  NO. IS E OR GT MOD. 128            3F307210
       PAC     ,4                    ADJUST SCALE UP TO -38             3F307220
       CLA     DATUM                 LOGICAL CP. DATA WITH BASE         3F307230
       LAS     L(1E0)+1,4            1E-1, AND APPROX. DEC. SCALE       3F307240
       TRA     FLT2                  TRUE SCALE                         3F307250
       TRA     FLT2                  TRUE SCALE                         3F307260
       TXI     FLT2,2,1              ADJUST EXP. UP                     3F307270
FLT1   CLA     DATUM                 ADJUST SCALE UP TO +38             3F307280
       LAS     L(1E0),2              ..                                 3F307290
       TXI     *+2,2,1               ADJUST EXP. UP                     3F307300
       TXI     *+1,2,1               ..                                 3F307310
FLT2   PXA     ,2                    TRUE EXP.                          3F307320
       LLS     0                     GIVE TRUE SIGN                     3F307330
       SUB     PEX                   ADJUST EXP. BY SCALE FACTOR        3F307340
FLT3   STO     EXP                   ..                              (6)3F307350
       LDQ     EXPON                 ..                                 3F307360
       STQ     CHAR-4                ..                                 3F307370
       LDI     BLANK                 ..                                 3F307380
       TPL     *+3                                                   (6)3F307390
       TZE     *+2                                                   (6)3F307395
       RIR     20                    ..                                 3F307400
       STI     CHAR-3                                                   3F307410
       LDQ     L(1)                  FORM BCD EXPONENT                  3F307420
       LRS     3                     ..                                 3F307430
       VDP     TEN,,3                MAX. CHAR. = 63                    3F307440
       STQ     CHAR-2                ..                                 3F307450
       SLW     CHAR-1                ..                                 3F307460
       CLA     DATUM                 ..                                 3F307470
       STL     ETYPE                 SET SWITCH                      (6)3F307475
FXD1   LXA     EXP,4                 IF EXP. IS ZERO                    3F307480
       LDQ     EXP                                                   (6)3F307485
       TXL     FXD3,4,0              FIX, SCALING NOT NEEDED.           3F307490
       TQP     FXD12          IS SCALE FACTOR POSITIVE               (6)3F307500
FXD11  XCA                    NO,                                    (6)3F307510
       TNX     FXD13,4,38     TWO MULTIPLICATIONS NEEDED             (6)3F307515
       FMP     L1E0M          SINCE EXP .GT. 38                      (6)3F307520
       XCA                                                           (6)3F307525
FXD13  FMP     L(1E0),4       OTHERWISE ONLY ONE MULTIPLICATION      (6)3F307530
       TRA     FXD2                                                  (6)3F307540
FXD12  TNX     FXD14,4,38     YES, SCALING DONE BY                   (6)3F307545
       FDP     L1E0M          TWO DIVISIONS SINCE EXP .GT. 38        (6)3F307550
       XCA                                                           (6)3F307555
FXD14  FDP     L(1E0),4       OTHERWISE ONLY ONE DIVISION            (6)3F307560
       XCA                           NEEDED                          (6)3F307570
 FXD2  LAS     L(1E0)                IS SCALED NUMBER .GT. 1.0       (6)3F307575
       TRA     FXD3                  YES                             (6)3F307580
       TRA     FXD3                                                  (6)3F307585
       STQ     N+1                   NO, SAVE  LOW ORDER OF FRACTION (6)3F307590
       STZ     ND                    SET INTEGER PART TO ZERO        (6)3F307595
       UFA     =128B8                SHIFT SO BINARY POINT           (6)3F307600
       STO     N                     IS IN PLACE                     (6)3F307605
       XCA                                                           (6)3F307610
       UFA     N+1                   ADD LOW ORDER BITS BACK IN,     (6)3F307615
       LRS     27                    THEN GET RID OF                 (6)3F307620
       CLA     N                     CHARACTERISTICS TO              (6)3F307630
       LLS     8                     FORM FRACTION IN                (6)3F307635
       TRA     FXD4                  FIXED POINT                     (6)3F307640
FXD3   UFA     =155B8                FIX NO. (SPILL MAY OCCUR ON F CONV.3F307650
       LLS     8                     NO SCALING                         3F307660
       ALS     2                     NEEDED, DISCARD                    3F307670
       ARS     10                    CHARACTERISTIC.                    3F307680
FXD31  STO     ND                    ..                                 3F307690
       XCA                           GET                                3F307700
FXD4   LXA     DIG,4                 FRACTION,                       (6)3F307710
       ACL     RND,4                 ADD APPROPRIATE ROUNDING FACTOR,   3F307720
       LRS     35                    ..                                 3F307730
       ADD     ND                    ..                                 3F307740
       STO     ND                    ..                                 3F307750
       NZT     ETYPE                 IS THIS E CONVERSION            (6)3F307752
       TRA     FXD6                  NO, DO NOT TEST FOR RE-SCALING  (6)3F307754
       STZ     ETYPE                                                 (6)3F307756
       LXA     PEX,1                 OBTAIN SCALE FACTOR             (6)3F307758
       LAS     IC10+10,1             ENSURE ROUNDING HAS NOT         (6)3F307760
       TRA     FXD5                  CAUSED US TO GO OUT OF          (6)3F307761
       TRA     FXD5                  SCALE ON E CONVERSION           (6)3F307762
       USE     REMOTE                                                (6)3F307764
FXD5   CLA     EXP                                                   (6)3F307765
       ADD     L(1)                                                  (6)3F307766
       TRA     FLT3                                                  (6)3F307767
       USE                                                           (6)3F307768
FXD6   TXL     FXFL3,4,0             EXIT IF DIG = 0.                (6)3F307769
       STQ     FD                    CONVERT FRACTION.                  3F307770
       ALS     4                     4 BITS, 1                          3F307780
       LLS     33                    CHARACTER                          3F307790
       ADD     FD                    AT                                 3F307800
       LRS     32                    A TIME.                            3F307810
FXFL1  SLW     **,4                  STORE                              3F307820
       TIX     *-6,4,1               AND REPEAT UNTIL DONE.             3F307830
       CLA     ND                    GET INTEGER AND                    3F307840
       TRA     BDC2                  TO TO CONVERT.                     3F307850
       REM  ENTRY FOR FIXED POINT OUTPUT.                               3F307860
FXD    TNZ     FXD1                  DO F CONVERSION.                   3F307870
BDC1   LXA     DIG,4                 IF ZERO, FILL                      3F307880
       LDQ     BLANK                 IN                                 3F307890
FXFL2  TXI     *+1,4,**              BLANKS                             3F307900
       STQ     CHAR,4                ..                                 3F307910
       TIX     *-1,4,1               ..                                 3F307920
BDC2   LXA     DIG,4                 ..                                 3F307930
FXFL3  TXI     *+1,4,**              ..                                 3F307940
       LDQ     POINT                 AND A                              3F307950
       STQ     CHAR,4                POINT.                             3F307960
       TRA     *+2                   ..                                 3F307970
       REM  ENTRY FOR INTEGER OUTPUT.                                   3F307980
INTG   AXT     0,4                   ..                                 3F307990
       XCA                           INTEGER PART FROM I, E, F.         3F308000
       PXD     ,0                    ..                                 3F308010
       DVP     TEN                   ..                                 3F308020
       SLW     CHAR-1,4              STRING CHARACTERS FROM LOW TO HIGH.3F308030
       XCA                           ..                                 3F308040
       TZE     *+2                   NO MORE.                           3F308050
       TXI     *-6,4,1               ..                                 3F308060
       LDQ     DATUM                 SET SIGN OF THIS FIELD.            3F308070
       LDI     BLANK                 ..                                 3F308080
       TQP     *+2                   ..                                 3F308090
       RIR     20                    ..                                 3F308100
       STI     CHAR-2,4              ..                                 3F308110
INTGSW TXI     TOPACK,4,2          * ADJ. FLD. SIZ FOR SIGN AND 1 CHAR. 3F308120
       REM  ENTRY FROM BDC, AOUT, OOUT, BOUT.                           3F308130
TOPACK CAL     WORD                  FILL OUTPUT                        3F308140
       TNO     *+1                   BUFFER                             3F308150
       LXA     PACK,1                WITH                               3F308160
       SXD     *+2,4                 LEADING                            3F308170
WIDTH  AXT     **,4                  BLANKS                             3F308180
       TIX     TOPC,4,**             A WORD                             3F308190
TOPA   ALS     6                     AT A TIME, IF POSSIBLE             3F308200
       ADM     CHAR,4                AFTER THE                          3F308210
       TNO     TOPB                  PENDING                            3F308220
PACK   SLW     **                    WORD                               3F308230
TEST   TXH     **,1,OUTBUF+LIMIT-2                                  (14)3F308240
       TXI     *+1,1,1               IS READY                           3F308250
       SXA     PACK,1                THEN,                              3F308260
       CAL     L(1)                  COMPLETE                           3F308270
TOPB   TIX     TOPA,4,1              THE                                3F308280
TOPSW1 TRA     TOPSW2              * FIELD                              3F308290
TOPC   LDQ     BLANKS                BY                                 3F308300
TOPD   LGL     6                     PACKING                            3F308310
       TNO     TOPF                  FROM                               3F308320
       LDQ     BLANKS                THE                                3F308330
       XEC     PACK                  CHARACTER                          3F308340
       TXI     *+2,4,-1              BUFFER                             3F308350
TOPE   STQ*    PACK                  INTO                               3F308360
       XEC     TEST                * (HAS LINE FORMATTING OVERFLOWED)   3F308370
       TXI     *+1,1,1               THE                                3F308380
       SXA     PACK,1                BUFFER                             3F308390
       TIX     TOPE,4,6              THE                                3F308400
       TXI     *+1,4,1               REMAINING                          3F308410
       TXL     *+2,4,6               TRUE                               3F308420
       TXI     TOPE,4,-7             FIELD                              3F308430
       CAL     L(1)                  CHARACTERS                         3F308440
TOPF   TIX     TOPD,4,1              AND                                3F308450
       LXD     WIDTH+1,4             SAVE                               3F308460
       TIX     TOPA,4,0              PARTIAL                            3F308470
TOPSW2 SLW     WORD                * WORD.                              3F308480
       REM  ENTRY FROM DBC, ANPT, ONPT, TOPACK.                         3F308490
       ZET     DDDFLG         WAS THIS DOUBLE PRECISION CONVERT      $5$3F308500
       TSX     DDRSET,2              YES. RESET DOUBLE PRECISION EXITS. 3F308510
COUNT  AXT     **,4                  TEST FIELD COUNT,                  3F308520
       TNX     DONE,4,1              IF NOT DONE,                       3F308530
       SXA     *-2,4                 RESET COUNT, AND                   3F308540
       REM  ENTRY FROM CCRPAR, FIELD.                                   3F308550
LIST   DLD     DATUM                 PICKUP INPUT DATUM.                3F308560
LXIT1  AXT     **,1                  RESTORE                            3F308570
LXIT2  AXT     **,2                  INDEX                              3F308580
LEXIT  AXT     **,4                  REGISTERS.                         3F308590
       TRA     1,4                   EXIT TO PROGRAMS I/O LIST.         3F308600
       REM  REENTRY FROM COUNT.                                         3F308610
DONE   AXT     **,4                  RESTORE RETURN INDEX.              3F308620
       TRA     1,4                 * EXIT TO CALLER.                    3F308630
       REM     TABLE OF POWERS OF TEN IN DOUBLE PRECISION ACCURACY      3F308640
       EVEN                                                          $5$3F308642
DE38   DEC     1.EE+38,1.EE+37,1.EE+36,1.EE+35,1.EE+34,1.EE+33,1.EE+32  3F308650
       DEC     1.EE+31,1.EE+30,1.EE+29,1.EE+28,1.EE+27,1.EE+26,1.EE+25  3F308660
       DEC     1.EE+24,1.EE+23,1.EE+22,1.EE+21,1.EE+20,1.EE+19,1.EE+18  3F308670
       DEC     1.EE+17,1.EE+16,1.EE+15,1.EE+14,1.EE+13,1.EE+12,1.EE+11  3F308680
       DEC     1.EE+10,1.EE+9,1.EE+8,1.EE+7,1.EE+6,1.EE+5,1.EE+4,1.EE+3 3F308690
       DEC     1.EE+2,1.EE+1                                            3F308700
D1E0   DEC     1.EE+0,1.EE-1,1.EE-2,1.EE-3,1.EE-4,1.EE-5,1.EE-6,1.EE-7  3F308710
       DEC     1.EE-8,1.EE-9,1.EE-10,1.EE-11,1.EE-12,1.EE-13,1.EE-14    3F308720
       DEC     1.EE-15,1.EE-16,1.EE-17,1.EE-18,1.EE-19,1.EE-20,1.EE-21  3F308730
       DEC     1.EE-22,1.EE-23,1.EE-24,1.EE-25,1.EE-26,1.EE-27,1.EE-28  3F308740
       DEC     1.EE-29,1.EE-30,1.EE-31,1.EE-32,1.EE-33,1.EE-34,1.EE-35  3F308750
       DEC     1.EE-36,1.EE-37,1.EE-38                                  3F308760
       REM     TABLE OF ROUNDING CONSTANTS FOR D CONVERSION             3F308790
DRND   DEC     .5BEE0,.5BEE-1,.5BEE-2,.5BEE-3,.5BEE-4,.5BEE-5        (6)3F308800
       DEC     .5BEE-6                                               (6)3F308801
       DEC     .5BEE-7,.5BEE-8,.5BEE-9,.5BEE-10,.5BEE-11,.5BEE-12       3F308810
       DEC     .5BEE-13,.5BEE-14,.5BEE-15,.5BEE-16,.5BEE-17             3F308820
       REM     TABLE OF POWERS OF TEN ROUNDED UP TO 9 DIGIT ACCURACY    3F308830
L1E0M  OCT     377454732313          1E38                            (6)3F308840
       OCT     373741367021          1E37                               3F308850
       OCT     370601137164          1E36                               3F308860
       OCT     365464114135          1E35                               3F308870
       OCT     361755023373          1E34                               3F308880
       OCT     356612334311          1E33                               3F308890
       OCT     353473426555          1E32                               3F308900
       OCT     347770675742          1E31                               3F308910
       OCT     344623713116          1E30                               3F308920
       OCT     341503074077          1E29                               3F308930
       OCT     336402374714          1E28                               3F308940
       OCT     332635456171          1E27                               3F308950
       OCT     327512676456          1E26                               3F308960
       OCT     324410545213          1E25                               3F308970
       OCT     320647410336          1E24                               3F308980
       OCT     315522640262          1E23                               3F308990
       OCT     312417031702          1E22                               3F309000
       OCT     306661534466          1E21                               3F309010
       OCT     303532743536          1E20                               3F309020
       OCT     300425434430          1E19                               3F309030
       OCT     274674055532          1E18                               3F309040
       OCT     271543212741          1E17                               3F309050
       OCT     266434157116          1E16                               3F309060
       OCT     262706576512          1E15                               3F309070
       OCT     257553630410          1E14                               3F309080
       OCT     254443023471          1E13                               3F309090
       OCT     250721522451          1E12                               3F309100
       OCT     245564416672          1E11                               3F309110
       OCT     242452013710          1E10                               3F309120
       OCT     236734654500          1E9                                3F309130
       OCT     233575360400          1E8                                3F309140
       OCT     230461132000          1E7                                3F309150
       OCT     224750220000          1E6                                3F309160
       OCT     221606500000          1E5                                3F309170
       OCT     216470400000          1E4                                3F309180
       OCT     212764000000          1E3                                3F309190
       OCT     207620000000          1E2                                3F309200
       OCT     204500000000          1E1                                3F309210
L(1E0) OCT     201400000000          1E0                                3F309220
       OCT     175631463146          1E-1                               3F309230
       OCT     172507534122          1E-2                               3F309240
       OCT     167406111565          1E-3                               3F309250
       OCT     163643334273          1E-4                               3F309260
       OCT     160517426542          1E-5                               3F309270
       OCT     155414336750          1E-6                               3F309280
       OCT     151655376247          1E-7                               3F309290
       OCT     146527461671          1E-8                               3F309300
       OCT     143422701372          1E-9                               3F309310
       OCT     137667633766          1E-10                              3F309320
       OCT     134537657770          1E-11                              3F309330
       OCT     131431363140          1E-12                              3F309340
       OCT     125702270232          1E-13                              3F309350
       OCT     122550223342          1E-14                              3F309360
       OCT     117440165750          1E-15                              3F309370
       OCT     113715126246          1E-16                              3F309380
       OCT     110560736522          1E-17                              3F309390
       OCT     105447113564          1E-18                              3F309400
       OCT     101730171124          1E-19                              3F309410
       OCT     076571624103          1E-20                              3F309420
       OCT     073456166403          1E-21                              3F309430
       OCT     067743444004          1E-22                              3F309440
       OCT     064602666320          1E-23                              3F309450
       OCT     061465370246          1E-24                              3F309460
       OCT     055757132075          1E-25                              3F309470
       OCT     052614110061          1E-26                              3F309480
       OCT     047474723216          1E-27                              3F309490
       OCT     043773036660          1E-28                              3F309500
       OCT     040625513700          1E-29                              3F309510
       OCT     035504411400          1E-30                              3F309520
       OCT     032403472631          1E-31                              3F309530
       OCT     026637304365          1E-32                              3F309540
       OCT     023514235136          1E-33                              3F309550
       OCT     020411660745          1E-34                              3F309560
       OCT     014651264556          1E-35                              3F309570
       OCT     011524220445          1E-36                              3F309580
       OCT     006420163521          1E-37                              3F309590
NEWTAB OCT     002663437347          1E-38                              3F309600
       REM     TABLE OF ROUNDED ROUNDING CONSTANTS FOR E AND F CNV.     3F309610
       DEC     .5BE-9                                                   3F309620
       OCT     254                   .5BE-8                             3F309630
       OCT     3266                  .5BE-7                             3F309640
       OCT     41434                 .5BE-6                             3F309650
       OCT     517427                .5BE-5                             3F309660
       OCT     6433343               .5BE-4                             3F309670
       DEC     .5BE-3                                                   3F309680
       OCT     1217270244            .5BE-2                             3F309690
       DEC     .5BE-1                                                   3F309700
RND    DEC     .5B                                                      3F309710
CODE1  PZE     32                                                       3F309720
ER32MS PZE     E32MES,,7                                                3F309730
ER32OP PZE     E32OMS,,5                                                3F309740
E32MES BCI     7,0ILLEGAL CHAR IN DATA BELOW OR BAD FORMAT              3F309750
E32OMS BCI     5,0TREAT ILLEGAL CHAR AS ZERO                            3F309760
CODE2  PZE     33                                                       3F309770
ER33MS PZE     E32MES,,7                                                3F309780
ER33OP PZE     E32OMS,,5                                                3F309790
CODE9  PZE     57                                                       3F309800
ER57MS PZE     E57MES,,8                                                3F309810
ER57OP PZE     E57OMS,,5                                                3F309820
E57MES BCI     8,0ILLEGAL CHAR FOR L CONVERSION IN DATA BELOW           3F309830
E57OMS BCI     5,0TREAT ILLEGAL CHAR AS BLANK                           3F309840
LIMIT5 EQU     CHLIMT                                               (14)3F309850
OUTBUF BSS     LIMIT                                                 (8)3F309860
CHAR   BES     CHLIMT                                                (8)3F309870
MINUS  BCI     1,00000-                                                 3F309880
POINT  BCI     1,00000.                                                 3F309890
EXPON  BCI     1,00000E                                                 3F309900
PLUS   BCI     1,00000+                                                 3F309910
NEGAT  BCI     1,00000'                                                 3F309920
TRUE   BCI     1,00000T                                                 3F309930
FALSE  BCI     1,00000F                                                 3F309940
TFTEST BCI     1,TF                                                     3F309950
ETYPE  PZE     **              ADDRESS IS SWITCH FOR E-CONVERSION.   (6)3F309951
MZE    MZE                                                              3F309960
TEN    PZE     10                                                       3F309970
LOG2   OCT     2321                                                     3F309980
.FBDBF PZE     **,2                  LOCATION OF INPUT BUFFER,2         3F309990
DMQD   PZE                                                              3F310000
V      PZE                                                              3F310010
U      PZE                                                              3F310020
CHMASK OCT     000777777777                                             3F310030
F      PZE                                                              3F310040
E      PZE                                                              3F310050
D      PZE                                                              3F310060
DGMASK OCT     037777777777                                             3F310070
DG     PZE                                                              3F310080
       EVEN                                                             3F310090
DATUM  BSS     2                                                        3F310100
N      PZE     0                                                     $5$3F310110
N1     PZE     0                                                     $5$3F310111
N2     PZE     0                                                     $5$3F310112
N3     PZE     0                                                     $5$3F310113
ND     BSS     2                                                        3F310120
FD     BSS     2                                                        3F310130
LIMIT  EQU     LIMIT5/6+1          LINE LIMIT IN WORDS              (14)3F310140
MULT   BSS     2                                                        3F310150
BLCNT  PZE                           NON-ZERO IF DATA NOT ALL BLANKS.(8)3F310155
BLANK  BCI     1,00000                                                  3F310160
L(1)   PZE     1                                                        3F310170
BLANKS BCI     1,                                                       3F310180
DDDFLG PZE     **                    NON-ZERO IF D IN FORMAT SCAN.      3F310190
DDFLAG PZE     **                    NON-ZERO IF CONVERTED RESULT       3F310200
WORD   PZE                                                              3F310210
MQD    PZE                                                              3F310220
PEX    PZE                                                              3F310230
EXP    PZE                                                              3F310240
DIG    PZE                                                              3F310250
DEXPON BCI     1,00000D                                                 3F310260
DB8PW  BSS     1                                                     $5$3F310263
DB871  OCT     043000000000                                          $5$3F310264
DB872  OCT     000066000000                                          $5$3F310265
DBSPP  BOOL    1              SIGN OF PRINCIPAL PART                 $5$3F310266
DBSEP  BOOL    40             SIGN OF EXPONENTIAL PART               $5$3F310267
LNKG   LDIR                                                          (6)3F310275
BEG94  NULL                                                          $5$3F310280
*                                                                    $5$3F310290
*                                                                    $5$3F310300
       PCC     ON                                                    $5$3F350000
       IFT     M9094=90                                              $5$3F350010
       GOTO    END94                                                 $5$3F350020
       PCC     OFF                                                   $5$3F350030
       TTL     BCD CONVERT ROUTINES                                  $5$3F350040
*              BCD CONVERT ROUTINES                                     3F350050
.WIDTH ENTRY   WIDTH                                                    3F350060
.ENDFS ENTRY   ENDFSW                                                   3F350070
.ONPT  ENTRY   ONPT                                                     3F350080
.OOUT  ENTRY   OC                                                    $5$3F350090
.FIXSW ENTRY   FIXSW                                                    3F350100
.DBC   ENTRY   DBC                                                      3F350110
.KOUNT ENTRY   COUNT                                                    3F350120
.INTG  ENTRY   IC                                                    $5$3F350130
.ANPT  ENTRY   ANPT                                                     3F350140
.AOUT  ENTRY   AC                                                    $5$3F350150
.FXD   ENTRY   FC                                                    $5$3F350160
.FLT   ENTRY   EC                                                    $5$3F350170
.DBC20 ENTRY   DBC20                                                    3F350180
.DDBC  ENTRY   DDBC                                                     3F350190
.DDSW  ENTRY   DDSW                                                     3F350200
.DDFIX ENTRY   DDFIX                                                    3F350210
.DFLT  ENTRY   DC                                                    $5$3F350220
.LNTP  ENTRY   LNTP                                                     3F350230
.LOUT  ENTRY   LC                                                    $5$3F350240
.DDRS2 ENTRY   DDRST2                                                   3F350250
.CNVSW ENTRY   CNVSW                                                    3F350260
.DONE  ENTRY   DONE                                                     3F350270
.OUTBF ENTRY   OUTBUF                                                   3F350280
.DEXPN ENTRY   EC15                                                  $5$3F350290
.DIG   ENTRY   DIG                                                      3F350300
.FEXP  ENTRY   EXP                                                      3F350310
.PEX   ENTRY   PEX                                                      3F350320
.MQD   ENTRY   MQD                                                      3F350330
.DDFLG ENTRY   DDFLAG                                                   3F350340
.DDDFL ENTRY   DDDFLG                                                   3F350350
.DDRS1 ENTRY   DDRST1                                                   3F350360
.LIST  ENTRY   LIST                                                     3F350370
       ENTRY   .FBDBF                                                   3F350380
.XCF   ENTRY   XCF                                                   $5$3F350390
.DBC10 ENTRY   DBC10                                                    3F350400
.D2    ENTRY   D2                                                       3F350410
.D1    ENTRY   D1                                                       3F350420
.FDX1  ENTRY   DX1                                                      3F350430
.FDX2  ENTRY   DX2                                                      3F350440
.TEST  ENTRY   TEST                                                  $5$3F350450
       ENTRY   .FERR2                                                $5$3F350460
.GAIN  ENTRY   GAIN                                                  $5$3F350470
.GAIN1 ENTRY   GAIN1                                                 $5$3F350480
.BUF   ENTRY   BUF                                                   $5$3F350490
.QSTO  ENTRY   QSTO                                                  $5$3F350500
.HOUT  ENTRY   HC                                                    $5$3F350510
BUFADD EQU     .FBDBF                                                   3F350520
       ENTRY   .FCNV.                                                   3F350530
       ENTRY   .FCON.                                                   3F350540
.FCON. STD     DDRST2                SET NOP AND TRA                    3F350550
       STD     CNVSW                 WHERE NECESSARY                    3F350560
       SXA     LNKG,4                                                $5$3F350570
       CLA     DX1                                                      3F350580
       STD     ENDFSW                                                   3F350590
       STZ     PEX                                                      3F350600
       SXA     TEST,2                                                $5$3F350610
       SXA     ENDFSW,1              FCNV TO PREVENT FCNV               3F350620
       CLA     3,4                   DEPENDENCY ON FIOH.                3F350630
       STA     DDRST1                                                   3F350640
       ARS     18                                                       3F350650
       STA     DDRST1+1                                                 3F350660
       CLA     4,4                                                      3F350670
       STA     CNVSW                                                    3F350680
       ARS     18                    STORE BUFFER ADDRESS IN CALL       3F350690
       STA     .FBDBF                CALL WAS FRCD                      3F350700
       CLA     5,4                                                   $5$3F350710
       STA     HCEXIT                                                $5$3F350720
       TRA     1,4                   RETURN TO FIOH FORMAT SCAN         3F350730
       REM REENTRY FROM MAIN PROGRAM LIST.                              3F350740
.FCNV. NOP     LNKG,4                INPUT/OUTPUT CONVERSION         (6)3F350750
       SXA     LXIT1,1                                               (6)3F350751
       SXA     LXIT2,2               SAVE INDEX                         3F350760
       SXA     LEXIT,4               REGISTERS.                         3F350770
       LMTM                                                          (6)3F350771
       SXA     LXIT3,3                                               (6)3F350772
       SXA     LXIT5,5                                               (6)3F350773
       SXA     LXIT6,6                                               (6)3F350774
       SXA     LXIT7,7                                               (6)3F350775
       DST     DATUM                 SAVE DATUM.                        3F350780
ENDFSW NOP     **                  * RESCAN FORMAT IF NECESSARY         3F350800
       REM  REENTRY FROM FIELD.                                         3F350810
       DLD     DATUM                 PICKUP DATUM, AND TRA TO (DBC,ANPT,3F350820
CNVSW  TRA     **                  * ONPT,AOUT,OOUT,FLT,FXD,INTG)       3F350830
       LXA     WIDTH,4               IR(4) = DESIRED FIELD WIDTH.       3F350840
       STZ     DG                    INITIALIZE.                        3F350850
       LDQ     MQD                   ..                                 3F350860
DX1    AXT     **,1                  CHARACTER COUNT.                   3F350870
DX2    AXT     **,2                  WORD COUNT.                        3F350880
       TRA*    CNVSW               * EXIT THRU CNVSW.                   3F350890
       REM  DBC / DECIMAL TO BINARY CONVERSION ROUTINE.                 3F350900
DBC    STZ     N                     INITIALIZE.                     (8)3F350920
       STZ     N+1                                                  (13)3F350922
       RIR     DBSPP+DBSEP                                          (14)3F350925
       STZ     V                     ..                                 3F350930
       CLA     FIXSW                                                 (8)3F350934
       STD     DBC9                                                  (8)3F350936
       CLS     DIG                   ..                                 3F350940
       STO     D                     ..                                 3F350950
       CLA     EXP                   ..                                 3F350960
       STO     E                     ..                                 3F350970
       TNO     DBC1                  TURN OFF                           3F350980
       TRA     DBC1                  OVERFLOW LIGHT.                    3F350990
DBCBL  SIR     DBSPP                 MAKE BLANK FIELD MINUS         (13)3F350994
       TRA     DBC15                                                 (8)3F350996
DBC2   TNX     DBCBL,4,1             BUMP WIDTH.                     (8)3F351000
DBC1   TIX     *+4,1,1               BUMP CHARACTER COUNT, IF EXHAUSTED 3F351010
       TXI     *+1,2,-1              GET NEXT WORD.                     3F351020
       AXT     6,1                   ..                                 3F351030
       LDQ*    BUFADD                ..                                 3F351040
       PXD     ,0                    TAKE A                             3F351050
       LGL     6                     CHARACTER.                         3F351060
       CAS     BLANK                 IF IT IS BLANK                     3F351070
       TRA     STOP1                 IGNORE IT.                         3F351080
       TRA     DBC2                  TAKE                               3F351090
       CAS     MINUS                 APPROPRIATE                        3F351100
       TRA     STOP1               * ACTION                             3F351110
       TRA     *+6                   ON                                 3F351120
       CAS     PLUS                  ERRORS, I.E. STOP.                 3F351130
       TRA     DBC9                  FOR LEGAL                          3F351140
       TRA     *+6                   + AND -                            3F351150
       CAS     NEGAT                 SIGNS                              3F351160
       TRA     STOP1               * SET                                3F351170
       CLA     MZE                   THE                                3F351180
       CAS     TEN                   SIGN                               3F351190
       TRA     STOP1               * OF                                 3F351200
DBCS1  PXD     ,0                    THE                                3F351210
       STO     DG                    RESULT.                            3F351220
DBC13  STO     N                     ..                                 3F351230
DBC14  TNX     DBC15,4,1             BUMP WIDTH.                        3F351240
DBC11  TIX     DBC98,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F351250
       TXI     DBC99,2,-1            GET ANOTHER WORD.                  3F351260
DBC3   TNX     DBC6,4,1              ENTRY ON E OR E BLANK, BUMP WIDTH. 3F351270
       TIX     DBC93,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED,3F351280
       TXI     DBC94,2,-1            GET ANOTHER WORD.                  3F351290
DBC94  AXT     6,1                   ..                                 3F351300
       LDQ*    BUFADD                ..                                 3F351310
DBC93  PXD     ,0                    TAKE A                             3F351320
       LGL     6                     CHARACTER.                         3F351330
       CAS     BLANK                 IF IT IS                           3F351340
       TRA     STOP2               * BLANK                              3F351350
       TRA     DBC3                  IGNORE IT.                         3F351360
       SXD     ER,4                  ILLEGAL                            3F351370
DBC4   CAS     MINUS                 CHARACTERS                         3F351380
       TRA     ER                  * CAUSE AN EXIT.                     3F351390
       TRA     DBC92                 A LEGAL                            3F351400
DBC5   CAS     PLUS                  + OR -                             3F351410
       TRA     ER                  * SIGN                               3F351420
       TRA     DBC6                  IS                                 3F351430
       CAS     NEGAT                 USED                               3F351440
       TRA     ER                  * TO                                 3F351450
DBC92  CLA     MZE                   SET                                3F351460
       CAS     TEN                   THE                                3F351470
       TRA     STOP2               * SIGN                               3F351480
DBC6   PXD     ,0                    OF                                 3F351490
DBC95  STO     E                     E, THEN                            3F351500
       TNX     DBC15,4,1             BUMP WIDTH, EXIT WHEN EXHAUSTED.   3F351510
       TIX     DBC96,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F351520
       TXI     DBC97,2,-1            GET ANOTHER WORD  AND CONVERT E.   3F351530
DBC97  AXT     6,1                   GET A NEW WORD FOR                 3F351540
       LDQ*    BUFADD                E FIELD.                           3F351550
DBC96  PXD     ,0                    TAKE A                             3F351560
       LGL     6                     CHARACTER.                         3F351570
       CAS     BLANK                 TREAT BLANK                        3F351580
       TRA     STOP3               * ZERO.                              3F351590
       TRA     *+3                   EXIT FOR                           3F351600
       CAS     TEN                   ILLEGAL CHARACTERS.                3F351610
ER3    TRA     STOP3               * CONVERT                            3F351620
       PXD     ,0                    E FIELD                            3F351630
       STO     DG                    AND                                3F351640
       CLA     E                     STORE                              3F351650
       ALS     2                     IN                                 3F351660
       ADD     E                     E                                  3F351670
       ALS     1                     AND                                3F351680
       ACL     DG                    GO                                 3F351690
       TRA     DBC95                 BUMP WIDTH.                        3F351700
DBC8   CAS     BLANK                 EXAMINE NON-NUMERIC                3F351710
       TRA     STOP4               * CHARACTER.                         3F351720
       TRA     DBC12                 TREAT BLANK AS ZERO.               3F351730
DBC9   NOP     STOP4                 TRA IF I CONVERSION             (8)3F351735
       SXD     U,4                   IF A                            (8)3F351740
       STD     ER                    DECIMAL                            3F351750
       CAS     POINT                 POINT, RECORD                      3F351760
       TRA     DBC4                  FIELD                              3F351770
       TXI     DBC30,4,-1            WIDTH.                             3F351780
DBC10  CAS     EXPON                 ON AN E (OR D FOR DOUBLE PRECISION)3F351790
       TRA     STOP4               * GO CONVERT                         3F351800
       TRA     DBC3                  E FIELD.                           3F351810
       TRA     DBC5                  ANYTHING ELSE CONTINUE ABOVE.      3F351820
DBC30  PXA     ,4                    DECIMAL POINT FIELD POSITION       3F351830
       STO     U                     IS SET                             3F351840
       STO     D                     HERE.                              3F351850
       TXI     DBC14,4,1             EXIT TO CONTINUE.                  3F351860
DBC99  AXT     6,1                   GET A                              3F351870
       LDQ*    BUFADD                NEW WORD.                          3F351880
DBC98  PXD     ,0                    TAKE A                             3F351890
       LGL     6                     CHARACTER.                         3F351900
       CAS     TEN                   TREAT BLANK                        3F351910
       TRA     DBC8                  AS ZERO, EXAMINE                   3F351920
DBC12  PXD     ,0                    OTHER NON-NUMERICS AT DBC8.        3F351930
       STA     DG                    CONVERT                            3F351940
       CLA     N                     BCD                                3F351950
       ALS     2                     TO                                 3F351960
       ADD     N                     BINARY                             3F351970
       ALS     1                     AND                                3F351980
       ADD     DG                    IF                                 3F351990
       TNO     DBC13                 NO OVERFLOW CONTINUE.              3F352000
DBC20  TRA     *+1                   DOUBLE PRECISION OVERFLOW SWITCH.  3F352010
       CLA     V                     IF OVERFLOW, IGNORE                3F352020
       ADD     L(1)                  CONVERTED RESULT, BUT              3F352030
       STO     V                     ADD ONE TO V.                      3F352040
       TIX     DBC11,4,1             BUMP WIDTH.                        3F352050
DBC15  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F352060
       SXA     DX1,1                 CHARACTERS AND                     3F352070
       SXA     DX2,2                 COUNTS.                            3F352080
       CLA     N                     PICK UP CONVERTED N.               3F352100
       TZE     DBEXIT                EXIT ON N = 0.                     3F352110
       TPL     *+3                                                   $5$3F352120
       SIR     DBSPP                                                 $5$3F352130
       SSP                                                           $5$3F352140
       NZT     DDFLAG                                               (13)3F352150
DDSW   TRA     DDFIX                                                (13)3F352160
       CLA     ND+1                                                 (13)3F352170
       STO     N+1                                                  (13)3F352180
       CLA     ND                                                   (13)3F352190
DDFIX  STO     N                                                    (13)3F352200
FIXSW  NOP     DBEXIT                                                $5$3F352220
       CLA     D             -DIG FROM FORMAT SPEC                   $5$3F352230
       TMI     *+4           WAS DEC POINT SPECIFIED - NO            $5$3F352240
       CLA     U             YES                                     $5$3F352250
       ARS     18                                                    $5$3F352260
       SUB     D                                                     $5$3F352270
       ADD     E                                                     $5$3F352280
       ADD     V             OVERFLOW COUNT                          $5$3F352290
       TPL     *+2                                                   $5$3F352300
       SIR     DBSEP         SAVE SIGN OF EXPONENT                   $5$3F352310
       PAX     0,1           XR1=TRUE EXPONENT                       $5$3F352320
       AXT     128,2                                                 $5$3F352330
       ZET     DDFLAG                                                $5$3F352340
       AXT     163,2                                                 $5$3F352350
       STZ     N+2                                                   $5$3F352360
       AXT     0,4                                                   $5$3F352370
       TXL     DB832,1,0                                             $5$3F352380
       AXC     N,4                                                   $5$3F352390
DB827  SXA     DB831,1                                               $5$3F352400
       TXL     *+2,1,10                                              $5$3F352410
       AXT     10,1                                                  $5$3F352420
       CLA     IC10+10,1                                             $5$3F352430
       STO     DB8PW                                                 $5$3F352440
       RNT     DBSEP                                                 $5$3F352450
       TXI     DB829,4,-2    EXPONENT IS POSITIVE                    $5$3F352460
*                            NEGATIVE EXPONENT                       $5$3F352470
       PXD     0,0                                                   $5$3F352480
       AXT     3,1                                                   $5$3F352490
       AXT     3,4                                                   $5$3F352500
DB828  LDQ     N+3,4                                                 $5$3F352510
       DVP     DB8PW                                                 $5$3F352520
       STQ     N+3,1                                                 $5$3F352530
       NZT     N                                                     $5$3F352540
       TXI     *+2,2,-35     REDUCE CHARACTERISTIC                   $5$3F352550
       TNX     DB831,1,1     STEP TO NEXT RESULT STORAGE             $5$3F352560
       TIX     DB828,4,1                                             $5$3F352570
       LDQ     =0                                                    $5$3F352580
       TRA     DB828+1                                               $5$3F352590
DDBC   STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F352680
       SXA     DDSV4,4                                                  3F352690
       AXT     DDBC7,4               SET DOUBLE PRECISION EXIT AFTER    3F352700
       SXA     DBC99-1,4             DECIMAL POINT IS SCANNED.          3F352710
DDSV4  AXT     **,4                                                     3F352720
       STZ     DATUM+1                                                  3F352730
       STL     DDFLAG                SET FLAG INDICATING DOUBLE         3F352740
       PXD     0,0                   PRECISION RESULT OCCUPIES TWO      3F352750
       LDQ     N                     CELLS AND SET PARTIALLY            3F352760
       LRS     0                     CONVERTED RESULT IN                3F352790
       DST     ND                    LOW ORDER PART.                    3F352800
       TRA     DDBC4                                                    3F352810
DDBC1  TIX     DDBC2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F352820
       TXI     DDBC3,2,-1            GET ANOTHER WORD.                  3F352830
DDBC3  AXT     6,1                   RESET CHARACTER COUNT.             3F352840
       LDQ*    BUFADD                GET A NEW WORD.                    3F352850
DDBC2  PXD     0,0                   EXAMINE                            3F352860
       LGL     6                     NEXT CHARACTER.                    3F352870
       CAS     TEN                   TREAT BLANK AS ZERO.               3F352880
       TRA     DDBC5                 NON-NUMERIC.                       3F352890
DDBC6  PXD     0,0                                                      3F352900
       STA     DG                    SAVE NUMERIC CHARACTER.            3F352910
       STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F352920
       DLD     ND                                                       3F352930
DDBC4  LLS     2                     CONVERT BCD TO BINARY.             3F352940
       TOV     DDOV                  THIS INVOLVES DOUBLE PRECISION     3F352950
       STO     F                     FIXED POINT ADDITION.              3F352960
       XCA                                                              3F352970
       ADD     ND+1                                                     3F352980
       XCA                                                              3F352990
       PXD     0,0                                                      3F353000
       CLA     F                                                        3F353010
       TNO     *+2                                                      3F353020
       ADD     L(1)                                                     3F353030
       ADD     ND                                                       3F353040
       TOV     DDOV                                                     3F353050
       LLS     1                                                        3F353060
       TOV     DDOV                                                     3F353070
       XCA                                                              3F353080
       ADM     DG                                                       3F353090
       XCA                                                              3F353100
       TNO     *+2                                                      3F353110
       ADD     L(1)                                                     3F353120
       TOV     DDOV                                                     3F353130
       DST     ND                                                       3F353140
       LDQ     DMQD                                                     3F353150
DDBC7  TNX     DBC15,4,1             BUMP WIDTH.                        3F353160
       TRA     DDBC1                                                    3F353170
DDBC5  CAS     BLANK                 EXAMINE NON-NUMERIC CHARACTER.     3F353180
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F353190
       TRA     DDBC6                 TREAT BLANK AS ZERO.               3F353200
       TRA     DBC9                                                     3F353210
DDOV   LDQ     DMQD                  IF OVERFLOW,IGNORE CONVERTED       3F353220
       CLA     V                     RESULT BUT ADD ONE TO V.           3F353230
       ADD     L(1)                                                     3F353240
       STO     V                                                        3F353250
       TIX     DDOV1,4,1             BUMP WIDTH.                        3F353260
       TRA     DBC15                 EXIT WHEN WIDTH EXHAUSTED.         3F353270
DDOV1  TIX     DDOV2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F353280
       TXI     *+1,2,-1              GET ANOTHER WORD.                  3F353290
       AXT     6,1                   RESET CHARACTER COUNT.             3F353300
       LDQ*    BUFADD                GET A NEW WORD.                    3F353310
DDOV2  PXD     0,0                   EXAMINE                            3F353320
       LGL     6                     NEXT CHARACTER.                    3F353330
       CAS     TEN                                                      3F353340
       TRA     DDOV3                                                    3F353350
       TRA     DDOV+1                                                   3F353360
       TRA     DDOV+1                                                   3F353370
DDOV3  CAS     BLANK                                                    3F353380
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F353390
       TRA     DDOV+1                TREAT BLANK AS ZERO.               3F353400
       TRA     DBC9                                                     3F353410
*                  POSITIVE EXPONENT                                 $5$3F353420
DB829  AXT     3,1                                                   $5$3F353430
       LDQ     DB8PW                                                 $5$3F353440
       MPY     0,4                                                   $5$3F353450
       TXH     DB830,1,2                                             $5$3F353460
       XCA                                                           $5$3F353470
       ADD     1,4                                                   $5$3F353480
       XCL                                                           $5$3F353490
       TQP     *+3                                                   $5$3F353500
       ADD     L(1)                                                  $5$3F353510
       LRS     0                                                     $5$3F353520
DB830  STO     0,4                                                   $5$3F353530
       STQ     1,4                                                   $5$3F353540
       TNX     *+2,1,1                                               $5$3F353550
       TXI     DB829+1,4,1                                           $5$3F353560
       TZE     *+2                                                   $5$3F353570
       TXI     DB831,2,35    INCREMENT CHARACTERISTIC                $5$3F353580
       TXI     *+1,4,-1                                             (13)3F353585
       TXH     DB831,4,-ND                                          (13)3F353590
       AXC     N,4                                                  (13)3F353595
DB831  AXT     **,1                                                  $5$3F353600
       TIX     DB827,1,10                                            $5$3F353610
       RFT     DBSEP                                                 $5$3F353620
DB832  AXC     N,4                                                   $5$3F353630
*                  FLOAT NUMBER                                      $5$3F353640
       LFTM                                                          $5$3F353650
       CLA     0,4                                                   $5$3F353660
       LRS     8                                                     $5$3F353670
       ADD     DB871         35B8                                    $5$3F353680
       STO     DB8PW                                                 $5$3F353690
       CLA     DB872         27B16                                   $5$3F353700
       LLS     8                                                     $5$3F353710
       FAD     DB8PW                                                 $5$3F353720
       ARS     9                                                     $5$3F353730
       PDX     0,1                                                   $5$3F353740
       STD     *+1                                                   $5$3F353750
       TXI     *+1,2,**                                              $5$3F353760
       TXH     FERR3,2,1000                                          $5$3F353770
       TXH     FERR2,2,255                                           $5$3F353780
       CLA     1,4                                                   $5$3F353790
       LDQ     2,4                                                   $5$3F353800
       LLS     35,1                                                  $5$3F353810
       STO     2,4                                                   $5$3F353820
       CLA     0,4                                                   $5$3F353830
       LDQ     1,4                                                   $5$3F353840
       LLS     35,1                                                  $5$3F353850
       LDQ     2,4                                                   $5$3F353860
       LRS     8                                                     $5$3F353870
       STO     0,4                                                   $5$3F353880
       PXD     0,2                                                   $5$3F353890
       ALS     9                                                     $5$3F353900
       TOV     *+1                                                   $5$3F353910
       ZET     DDDFLG                                                $5$3F353920
       TXI     DB833,2,-27   DOUBLE PRECISION                        $5$3F353930
DB834  ORA     0,4           SINGLE PRECISION                        $5$3F353940
       RQL     28                                                    $5$3F353950
       FRN                                                           $5$3F353960
       TRA     DBEXIT-1                                             (13)3F353970
DB833  TXH     DB834,2,256                                           $5$3F353980
       ORS     0,4                                                   $5$3F353990
       PXA     0,2                                                   $5$3F354000
       LLS     27                                                    $5$3F354010
       RQL     28                                                    $5$3F354020
       FRN                                                           $5$3F354030
       FAD     0,4                                                   $5$3F354040
       EFTM                                                          (6)3F354055
DBEXIT RFT     DBSPP                                                 $5$3F354060
       SSM                                                           $5$3F354070
       LRS     0                                                     $5$3F354080
       LAS     CHTEST                                                $5$3F354090
       TRA     *+3                                                   $5$3F354100
       TRA     *+2                                                   $5$3F354110
       LDQ     =0                                                    $5$3F354120
       DST     DATUM                                                 $5$3F354130
       STZ     N+1                                                   $5$3F354160
       TRA     COUNT-2                                               $5$3F354170
       EVEN                                                          $5$3F354180
CHTEST DEC     1.EE-30                                               $5$3F354190
       DEC     100000,10000,1000,100,10,1                            $5$3F354200
DDRSET AXT     DBC14,4               RESET EXIT CHANGED FOR TWO-CELL    3F354210
       SXA     DBC99-1,4             DOUBLE PRECISION CONVERSION.       3F354220
       STZ     DDFLAG                RESET FLAG.                        3F354230
       LXA     COUNT,4               IF FIELD                           3F354240
       TNX     DDRST1,4,1            COUNT IS                           3F354250
       TRA     COUNT                 EXHAUSTED,                         3F354260
DDRST1 AXT     **,4                  RESET ALL DOUBLE PRECISION EXITS   3F354270
       SXA     **,4                                                     3F354280
DDRST2 NOP     D3                                                       3F354290
       AXT     EXPON,4                                                  3F354300
       SXA     DBC10,4                                                  3F354310
D1     AXT     **,4                                                     3F354320
       SXA     DBC20,4                                                  3F354330
D2     AXT     **,4                                                     3F354340
       SXA     DDSW,4                                                   3F354350
D3     STZ     DDDFLG                                                   3F354360
       TRA     1,2                                                      3F354370
       REM  ILLEGAL INPUT DATA.                                         3F354380
STOP1  CLA     BUFADD                STORE LOCATION OF INPUT            3F354390
       ALS     18                    BUFFER FOR FXEM.                   3F354400
       STD     CODE1                                                    3F354410
       SXA     SP1SV,4                                                  3F354420
1STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354430
SP1SV  AXT     **,4                                                     3F354440
       TOV     *+1                                                   (6)3F354441
       TRA     DBCS1                                                    3F354450
ER     TXH     STOP4,4,**                                               3F354460
STOP2  CLA     BUFADD                STORE LOCATION OF INPUT            3F354470
       ALS     18                    BUFFER FOR FXEM.                   3F354480
       STD     CODE1                                                    3F354490
       SXA     SP2SV,4                                                  3F354500
2STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354510
SP2SV  AXT     **,4                                                     3F354520
       TRA     DBC6                                                     3F354530
STOP3  CLA     BUFADD                STORE LOCATION OF INPUT            3F354540
       ALS     18                    BUFFER FOR FXEM.                   3F354550
       STD     CODE1                                                    3F354560
       SXA     SP3SV,4                                                  3F354570
3STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354580
SP3SV  AXT     **,4                                                     3F354590
       TRA     ER3+1                                                    3F354600
STOP4  CLA     BUFADD                STORE LOCATION OF INPUT            3F354610
       ALS     18                    BUFFER FOR FXEM.                   3F354620
       STD     CODE1                                                    3F354630
       SXA     SP4SV,4                                                  3F354640
4STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354650
SP4SV  AXT     **,4                                                     3F354660
       TOV     *+1                                                   (6)3F354661
       TRA     DBC12                                                 $5$3F354670
FERR2  TSX     .FERR2,1                                              $5$3F354680
       OCT     377777777777                                          $5$3F354690
       OCT     344777777777                                          $5$3F354700
FERR3  TSX     .FERR2,1                                              $5$3F354710
       DEC     0                                                     $5$3F354720
       DEC     0                                                     $5$3F354730
.FERR2 CALL    .FXEM.(CODE3)      OVERFLOW OR UNDERFLOW              $5$3F354740
       CLA     1,1                                                   $5$3F354750
       EFTM                                                          (6)3F354755
       LDQ     2,1                                                   $5$3F354760
       TRA     DBEXIT+3                                              $5$3F354770
CODE3  PZE     71                                                    $5$3F354780
ER71MS PZE     E71MES,,11                                            $5$3F354790
ER71OP PZE     E71OMS,,6                                             $5$3F354800
E71MES BCI     8,0INPUT DATA NOT WITHIN PERMISSIBLE RANGE OF FLOA    $5$3F354810
       BCI     3,TING POINT NUMBERS                                  $5$3F354820
E71OMS BCI     6,0READING OF INPUT DATA CONTINUES                    $5$3F354830
       REM  ENTRY FOR INPUT OF ALPHAMERIC DATA.                         3F354840
ANPT   TIX     ANPT1,1,1             SCAN THE CURRENT INPUT FIELD.      3F354850
       TXI     *+1,2,-1              IF WIDTH                           3F354860
       LDQ*    BUFADD                IS GREATER THAN OR EQUAL TO SIX,   3F354870
       AXT     6,1                   OBTAIN                             3F354880
ANPT1  LGL     6                     THE SIX                            3F354890
       TIX     ANPT,4,1              RIGHTMOST                          3F354900
       SXA     DX2,2                 CHARACTERS.                        3F354910
       STQ     MQD                   ..                                 3F354920
       LXA     WIDTH,4               LEFT ADJUST, IF LESS THAN SIX      3F354930
       LDQ     BLANKS                AND                                3F354940
       TXH     ONPT4,4,5           * FILL OUT                           3F354950
       LGL     6                     WORD                               3F354960
       TXI     *-2,4,1               WITH BLANKS.                       3F354970
       REM  ENTRY FOR INPUT OF OCTAL DATA.                              3F354980
ONPT   STZ     N                     CONVERT                            3F354990
       STZ     BLCNT                                                 (8)3F354995
ONPT1  TIX     *+6,1,1               FROM                               3F355000
       LXA     DX2,2                 OCTAL                              3F355010
       TXI     *+1,2,-1              TO                                 3F355020
       LDQ*    BUFADD                BINARY.                            3F355030
       SXA     DX2,2                 IF FIELD                           3F355040
       AXT     6,1                   WIDTH IS                           3F355050
       PXD     ,0                    GREATER THAN 12                    3F355060
       LGL     6                     ONLY THE 12                        3F355070
       PAX     ,2                    RIGHTMOST                          3F355080
       TXL     ONPT3,2,7             DIGITS ARE                         3F355090
       SUB     BLANK                 SIGNIFICANT.                       3F355100
       TZE     CNTBL                 IF LESS                         (8)3F355110
       ZET     BLCNT                                                 (8)3F355118
       TRA     STOP5                 (ILLEGAL CHARACTER)             (8)3F355119
       CLA     MZE                   THAN 12,                           3F355120
       TXL     STOP5,2,11            RIGHT-ADJUST                       3F355130
       TXL     ONPT2,2,12            AND FILLOUT                        3F355140
       TXH     STOP5,2,32            WITH                               3F355150
       TXH     ONPT2,2,32-1          ZEROS.                             3F355160
       TXH     STOP5,2,16            TREAT BLANKS                       3F355170
       TXH     ONPT3,2,16-1          AS ZEROS.                          3F355180
STOP5  CLA     BUFADD                STORE LOCATION OF INPUT            3F355190
       ALS     18                    BUFFER FOR FXEM.                   3F355200
       STD     CODE2                                                    3F355210
       SXA     SP5SV,4                                                  3F355220
5STOP  CALL    .FXEM.(CODE2)         EXIT FOR EXECUTION ERROR.          3F355230
SP5SV  AXT     **,4                                                     3F355240
       TRA     ONPT3                 ILLEGAL INPUT DATA.                3F355250
CNTBL  ZET     BLCNT                                                 (8)3F355260
       TRA     ONPT3                 INPUT DATA NOT BLANK FIELD.     (8)3F355265
       TRA     ONPT3A                                                (8)3F355270
ONPT2  STO     DG                    SET SIGN MINUS.                 (8)3F355280
ONPT3  STA     DG                    ..                                 3F355290
       CAL     N                     ..                                 3F355300
       ALS     3                     ..                                 3F355310
       ADM     DG                    ..                                 3F355320
       SLW     N                     ..                                 3F355330
       STL     BLCNT                 (INPUT DATA NOT ALL BLANKS)     (8)3F355335
ONPT3A TIX     ONPT1,4,1                                             (8)3F355340
       NZT     BLCNT                 IS INPUT DATA FIELD BLANK...    (8)3F355348
       ORA     MZE                   YES.  TREAT IT AS MINUS ZERO.   (8)3F355349
       ORA     DG                    ..                                 3F355350
       STQ     MQD                   ..                                 3F355360
       REM  ENTRY FROM ANPT.                                            3F355370
ONPT4  SLW     DATUM                 ..                                 3F355380
       SXA     DX1,1                 ..                                 3F355390
       TRA     COUNT               * EXIT TO TEST FIELD COUNT.          3F355400
       REM  ENTRY FOR INPUT OF LOGICAL DATA                             3F355410
LNTP   STZ     DATUM                 SET LOGICAL VARIABLE TO FALSE.     3F355420
LNTP0  TIX     LNTP1,1,1             IS CHARACTER COUNT EXHAUSTED.      3F355430
       TXI     *+1,2,-1              YES. INCREMENT WORD COUNT.         3F355440
       AXT     6,1                                                      3F355450
       LDQ*    BUFADD                GET NEXT INPUT WORD.               3F355460
LNTP1  PXD     ,0                                                       3F355470
       LGL     6                     TAKE A CHARACTER.                  3F355480
       CAS     TRUE                                                     3F355490
       TRA     STOPL                                                    3F355500
       TRA     LNPT3                 CHARACTER = T.                     3F355510
       CAS     BLANK                                                    3F355520
       TRA     STOPL                                                    3F355530
       TRA     LNPT2                 CHARACTER = BLANK.                 3F355540
       CAS     FALSE                                                    3F355550
       TRA     STOPL                                                    3F355560
       TRA     LNPT4                 CHARACTER = F.                     3F355570
STOPL  CLA     BUFADD                ERROR. ILLEGAL INPUT CHARACTER.    3F355580
       ALS     18                                                       3F355590
       STD     CODE9                                                    3F355600
       SXA     SPLSV,4                                                  3F355610
       CALL    .FXEM.(CODE9)         OPTIONAL RETURN IS TREAT AS BLANK. 3F355620
SPLSV  AXT     **,4                                                     3F355630
LNPT2  TIX     LNTP0,4,1                                                3F355640
       TRA     LNPT6                 IF FIELD IS BLANK, ASSUME FALSE.   3F355650
LNPT3  STL     DATUM                 SET LOGICAL VARIABLE TO TRUE.      3F355660
LNPT4  TNX     LNPT6,4,1             SKIP TO END OF INPUT FIELD.        3F355670
       TIX     LNPT5,1,1                                                3F355680
       TXI     *+1,2,-1                                                 3F355690
       AXT     6,1                                                      3F355700
       LDQ*    BUFADD                                                   3F355710
LNPT5  LGL     6                                                        3F355720
       TRA     LNPT4                                                    3F355730
LNPT6  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F355740
       SXA     DX1,1                 CHARACTER AND                      3F355750
       SXA     DX2,2                 WORD COUNTS.                       3F355760
       TRA     COUNT         GO TEST FIELD COUNT                     $5$3F355770
*         **** ENTRY FOR A OUTPUT****                                $5$3F355780
AC     XEC     GAIN           RESET XR1 FOR OUTBUF CHARACTER COUNT   $5$3F355790
       XEC     GAIN1          RESET XR2 FOR OUTBUF LOCATION COUNT    $5$3F355800
       LDQ     QSTO           BCD CHARACTERS                         $5$3F355810
       LXA     WIDTH,4        FIELD WIDTH                            $5$3F355820
AC1    TNX     AC2,4,6        IF FIELD WIDTH NOT GREATER THAN SIX    $5$3F355830
       TSX     XC,3           INSERT BLANKS                          $5$3F355840
       AXT     6,4                                                   $5$3F355850
AC2    XCA                                                           $5$3F355860
AC3    LGL     6              SOURCE CHARACTER ENTERS AC             $5$3F355870
       TIX     *+2,1,1                                               $5$3F355880
       TSX     EC20,5         TO OUTBUF UPDATING ROUTINE             $5$3F355890
       TIX     AC3,4,1                                               $5$3F355900
       XCL                                                           $5$3F355910
       TRA     EC1            EXIT TO FORMAT SCAN                    $5$3F355920
*         ****ENTRY FOR D OUTPUT****                                 $5$3F355930
DC     CLA     PEX           SCALE FACTOR SUBSEQUENTLY CALLED 'P'    $5$3F355940
       TNZ     DC3           IF P NOT ZERO                           $5$3F355950
       TSX     ECDC,5        GO TO IMPLEMENT TESTS AND CONVERSION    $5$3F355960
       CLA     DP50+1        EQUIVALENT OF D-8 DIGITS                $5$3F355970
       TSX     DC1,7         DEVELOP BCD REPRESENTATION AND STORE    $5$3F355980
       TRA     EC1           EXIT TO FORMAT SCAN                     $5$3F355990
*           **SUBROUTINE TO DEVELOP BCD REPRESENTATION AND           $5$3F356000
*             TO STORE INTO OUTPUT BUFFER.                           $5$3F356010
*             EQUIVALENT OF LEADING D-8 DIGITS IN AC                 $5$3F356020
*             EQUIVALENT OF 8 LOW-ORDER DIGITS IN DP50               $5$3F356030
DC1    TSX     EC30,3        INSERT SIGN                             $5$3F356040
       TSX     EC32,3        INSERT 0.                               $5$3F356050
       LXA     DIG,4         D=NUMBER OF DIGITS AFTER DECIMAL POINT  $5$3F356060
       TXL     DC2A,4,0      IF DIG=0                                $5$3F356070
       XCL                                                           $5$3F356080
       TNX     DC2,4,8       IF D LESS THAN OR EQUAL TO 8            $5$3F356090
       TSX     JP,3          DEVELOP D-8 DECIMAL DIGITS              $5$3F356100
       AXT     8,4                                                   $5$3F356110
DC2    CLA     DP50                                                  $5$3F356120
       TSX     JP,3          DEVELOP REMAINING DIGITS                $5$3F356130
       XCL                                                           $5$3F356140
DC2A   ALS     6                                                     $5$3F356150
       ORA     EC15          INSERT D                                $5$3F356160
       TRA     EC5           INSERT EXPONENT                         $5$3F356170
*         POSITIVE SCALE FACTOR IN DOUBLE PRECISION OUTPUT           $5$3F356180
DC3    TSX     ECDCP,7       CONVERT TO BINARY INTEGERS              $5$3F356190
       DEC     32                                                    $5$3F356200
       TRA     DC+2          IF P NEGATIVE                           $5$3F356210
       CLA     DIGP          D=ACTUAL NUMBER OF DIGITS DEVELOPED FOR $5$3F356220
       SUB     =8            FRACTION, D-8                           $5$3F356230
       TMI     DC9           D LESS THAN 8                           $5$3F356240
       TZE     DC8           D=8                                     $5$3F356250
       STA     DC5           NUMBER OF LEADING DIGITS FOR FRACTION   $5$3F356260
       PAX     ,4            FOR DIVISION                            $5$3F356270
       PXD     ,0                                                    $5$3F356280
       LDQ     DP50+1        EQUIVALENT OF P+D-8 DIGITS              $5$3F356290
       LLS     0                                                     $5$3F356300
       DVP     IC10+10,4     BY 10**D-8,INTEGER PART IN MQ           $5$3F356310
       STO     DP50+1        SAVE FRACTION PART                      $5$3F356320
       XCA                                                           $5$3F356330
       TSX     DC11,7        DEVELOP INTEGER PART                    $5$3F356340
       CLA     DP50+1        FRACTION PART                           $5$3F356350
*         DEVELOP BCD REPRESENTATION OF FRACTION                     $5$3F356360
DC5    AXT     **,4          NUMBER OF LEADING DIGITS FOR FRACTION   $5$3F356370
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356380
       AXT     8,4                                                   $5$3F356390
       CLA     DP50          EQUIVALENT OF 8 MORE DIGITS OF FRACTION $5$3F356400
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356410
       XEC     EC8           NUMBER OF ADDITIONAL ZEROS FOR FRACTION $5$3F356420
       TXL     *+2,4,0       IF NO ZEROS REQUIRED                    $5$3F356430
       TSX     DC16,7        INSERT ZEROS                            $5$3F356440
DC5A   TSX     DC2+2,7       INSERT D AND EXPONENT                   $5$3F356450
       TRA     EC1           EXIT                                    $5$3F356460
*         IF D=8                                                     $5$3F356470
DC8    CLA     DP50+1        EQUIVALENT OF INTEGER PART              $5$3F356480
       TSX     DC11,7        DEVELOP INTEGER PART                    $5$3F356490
       LXA     DIGP,4                                                $5$3F356500
       TXL     DC5A,4,0                                              $5$3F356510
       TRA     DC5+3         DEVELOP FRACTION,INSERT D AND EXPONENT  $5$3F356520
*         IF D LESS THAN 8                                           $5$3F356530
DC9    TSX     ECDCP1,7      SEPARATE INTEGER AND FRACTION PARTS     $5$3F356540
       STO     DP50          EQUIVALENT OF DIGITS AFTER DECIMAL POINT$5$3F356550
       ZET     DP50+1        TEST IF HIGH ORDER PART=0               $5$3F356560
       TRA     DC10          HIGH-ORDER PART NOT ZERO                $5$3F356570
       XCA                                                           $5$3F356580
       TRA     DC8+1         INSERT SIGN AND DEVELOP BCD REPR.       $5$3F356590
*        IF LESS THAN 8 AND HIGH-ORDER PART NOT ZERO                 $5$3F356600
DC10   STQ     N+1           SAVE SECOND PART OF INTEGER             $5$3F356610
       CLA     =8                                                    $5$3F356620
       SUB     DIGP          8-D=NUMBER OF DIGITS OF LOW-ORDER PART B$5$3F356630
       STO     N             NGING TO INTEGER                        $5$3F356640
       CLA     PEX           P                                       $5$3F356650
       SUB     N             NUMBER OF LEADING DIGITS OF INTEGER     $5$3F356660
       PAX     ,4                                                    $5$3F356670
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F356680
       CLA     DP50+1        EQUIVALENT OF FIRST PART OF INTEGER     $5$3F356690
       TSX     EC30,3        INSERT SIGN                             $5$3F356700
       XCL                                                           $5$3F356710
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356720
       LXA     N,4                                                   $5$3F356730
       CLA     N+1           SECOND PART OF INTEGER                  $5$3F356740
       TSX     DC13,7        COMPLETE INTEGER PART                   $5$3F356750
       LXA     DIGP,4                                                $5$3F356760
       TRA     DC5+3         DEVELOP FRACTION                        $5$3F356770
*         INSERT SIGN,DEVELOP INTEGER PART,AND INSERT .              $5$3F356780
DC11   LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F356790
DC12   LXA     PEX,4         P                                       $5$3F356800
       TSX     EC30,3        INSERT SIGN                             $5$3F356810
       XCL                                                           $5$3F356820
DC13   TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356830
       XCL                                                           $5$3F356840
       ALS     6                                                     $5$3F356850
       ORA     EC11          INSERT .                                $5$3F356860
       XCL                                                           $5$3F356870
       TIX     *+2,1,1                                               $5$3F356880
       TSX     JP4,3          UPDATE OUTBUF                          (6)3F356890
       TRA     1,7                                                   $5$3F356900
*         INSERT ZEROS IN FRACTION                                   $5$3F356910
DC16   PXD     ,0                                                    $5$3F356920
       TSX     JP2,3         INSERT BCD ZEROS                        $5$3F356930
       AXT     0,4                                                   $5$3F356940
       PXA     EC8,4         RESET ADDRESS OF EC8 WITH 0             $5$3F356950
DC17   TRA     1,7                                                   $5$3F356960
*         ****ENTRY FOR E OUTPUT****                                 $5$3F356970
EC     STZ     DATUM+1                                               $5$3F356980
       CLA     PEX                                                   $5$3F356990
       TNZ     EC6           IF P NOT ZERO                           $5$3F357000
       TSX     ECDC,5        GO TO IMPLEMENT TESTS AND CONVERSION    $5$3F357010
       CLA     DP50          EQUIVALENT OF D DECIMAL DIGITS          $5$3F357020
       TSX     EC3,7         DEVELOP BCD REPRESENTATION AND STORE    $5$3F357030
       TRA     EC1           EXIT                                    $5$3F357040
*           **E OUTPUT. SUBROUTINE TO DEVELOP BCD REPRESENTATION AND $5$3F357050
*             STORE INTO OUTPUT BUFFER.EQUIVALENT OF D DIGITS IN AC. $5$3F357060
EC3    TSX     EC30,3        INSERT SIGN                             $5$3F357070
       TSX     EC32,3        INSERT 0.                               $5$3F357080
       LXA     DIG,4         D=NUMBER OF DIGITS AFTER DECIMAL POINT  $5$3F357090
       TXL     EC4+1,4,0     IF DIG=0                                $5$3F357100
       TXH     EC50,4,8      IF D=9                                  $5$3F357110
       XCL                                                           $5$3F357120
       TSX     JP,3          DEVELOP D DIGITS                        $5$3F357130
EC4    XCL                                                           $5$3F357140
       ALS     6                                                     $5$3F357150
       ORA     EC12          E                                       $5$3F357160
EC5    TIX     *+2,1,1                                               $5$3F357170
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F357180
*                            DEAL WITH U                             $5$3F357190
       XCL                                                           $5$3F357200
       PXA     ,6            U+38                                    $5$3F357210
       SUB     EC13          38                                      $5$3F357220
       SUB     PEX           P                                       $5$3F357230
*             U+38 IN XR6                                            $5$3F357240
       TSX     EC30E,3       DEAL WITH SIGN OF EXPONENT             (12)3F357250
*         DEVELOP U                                                  $5$3F357260
       XCL                                                           $5$3F357270
       AXT     2,4           SET J=2                                 $5$3F357280
       TSX     JP,3                                                  $5$3F357290
       TRA     1,7                                                   $5$3F357300
*         POSITIVE SCALE FACTOR IN SINGLE PRECISION OUTPUT           $5$3F357310
EC6    TSX     ECDCP,7       CONVERT TO BINARY INTEGERS              $5$3F357320
       DEC     16                                                    $5$3F357330
       TRA     EC+3          IF P NEGATIVE                           $5$3F357340
       TSX     ECDCP1,7      SEPARATE INTEGER AND FRACTION PARTS     $5$3F357350
       DST     DP50                                                  $5$3F357360
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F357370
       CLA     DP50+1        INTEGER PART                            $5$3F357380
       TSX     DC12,7        DEVELOP BCD REPRESENTATION OF INTG. PART$5$3F357390
       LXA     DIGP,4        NUMBER OF DIGITS DEVELOPED FOR FRACTION $5$3F357400
       CLA     DP50          FRACTION                                $5$3F357420
       TXL     *+2,4,0                                               $5$3F357430
       TSX     JP2,3         DEVELOP BCD REPRESENTATION OF FRACTION  $5$3F357440
EC8    AXT     **,4          NUMBER OF ZEROS TO BE INSERTED IN FRAC. $5$3F357450
       TXL     *+2,4,0       IF NO ZEROS REQUIRED                    $5$3F357460
       TSX     DC16,7        INSERT ZEROS                            $5$3F357470
EC8A   TSX     EC4,7         INSERT E AND EXPONENT                   $5$3F357480
EC9    TRA     EC1           EXIT                                    $5$3F357490
EC50   AXT     1,4                                                   $5$3F357500
       XCL                                                           $5$3F357510
       CLA     DP50+1                                                $5$3F357520
       TSX     JP,3                                                  $5$3F357530
       AXT     8,4                                                   $5$3F357540
       CLA     DP50                                                  $5$3F357550
       TRA     EC4-1                                                 $5$3F357560
*         EDITING CONSTANTS                                          $5$3F357570
EC10   BCI     1,00000-                                              $5$3F357580
EC11   BCI     1,00000.                                              $5$3F357590
EC12   BCI     1,00000E                                              $5$3F357600
EC13   DEC     38                                                    $5$3F357610
EC14   EQU     JP11          SIX BLANKS                              $5$3F357620
EC15   BCI     1,00000D                                              $5$3F357630
*         ****ENTRY FOR FIXED POINT OUTPUT****                       $5$3F357640
FC     STZ     DATUM+1                                               $5$3F357650
       XEC     GAIN                                                  $5$3F357660
       XEC     GAIN1                                                 $5$3F357670
       LDQ     DATUM                                                (12)3F357680
       CLA     L(1)                                                 (12)3F357681
       TQP     *+2                                                  (12)3F357682
       ADD     L(1)                                                 (12)3F357683
       STO     FC2J                                                 (12)3F357684
       ADD     DIG                                                  (12)3F357690
       CAS     WIDTH                                                 $5$3F357700
       TRA     FC8           IF FIELD WIDTH TOO SMALL                $5$3F357710
       TRA     FC8           IF FIELD WIDTH TOO SMALL                $5$3F357720
       CLA     DIG                                                  (12)3F357730
       ADD     PEX           D+P                                     $5$3F357740
       ALS     1             2(D+P)                                  $5$3F357750
       TMI     FC20                                                  $5$3F357760
       STA     FC3           FOR FC ROUTINE                          $5$3F357770
FC9    LXA     WIDTH,4       W=FIELD WIDTH                           $5$3F357780
       TXH     FC2,4,22      IF BLANKS MUST BE FILLED IN             $5$3F357790
       SXA     FC4A,0                                                (6)3F357791
       PXA     0,4           WIDTH LESS THAN OR EQUAL 22             $5$3F357800
FC1    SUB     DIG           W-D                                     $5$3F357810
       SUB     FC2J          W-D-2 IF NEG. W-D-1 IF POS.            (12)3F357820
       STA     FC6           FOR IC ROUTINE                          $5$3F357830
       ADD     DIG           W-2                                     $5$3F357840
       ALS     1             2(W-2)                                  $5$3F357850
       STA     FC4           FOR FC ROUTINE                          $5$3F357860
       DLD     DATUM                                                 $5$3F357870
       ZET     FC21                                                  $5$3F357880
       TRA     FC22                                                  $5$3F357890
       TSX     FC3,7                                                 $5$3F357900
       TRA     EC1                                                   $5$3F357910
FC2    TXI     *+1,4,-22                                             $5$3F357920
       SXA     FC4A,4                                                $5$3F357930
       CLA     =22                                                   $5$3F357940
       TRA     FC1                                                   $5$3F357950
FC2J   PZE                                                          (12)3F357955
*         F CONVERSION COUTINE                                       $5$3F357960
FC3    AXT     **,6          2(D+P)                                  $5$3F357970
       DFMP    DP40+76,6     FORM X*10**(D+P)                        $5$3F357980
*         ROUND OFF                                                  $5$3F357990
FC3A   TPL     *+3                                                   $5$3F358000
       DFSB    DP42          .5                                      $5$3F358010
       TRA     *+2                                                   $5$3F358020
       DFAD    DP42          .5                                      $5$3F358030
*         OVERFLOW TEST                                              $5$3F358040
FC4    AXT     **,5                                                  $5$3F358050
       LAS     DP40+76,5     COMPARE TO 10**2(W-2)                   $5$3F358060
       TRA     FC8           IF OVERFLOW                             $5$3F358070
       TSX     DP5,3         FOR EQUAL CONDITION COMPARE L.O. PART   $5$3F358080
*         FIXING OF MANTISSA                                         $5$3F358090
       LLS     10                                                    $5$3F358100
       LRS     2             SUPPRESS HIGH-ORDER CHARACTERISTIC      $5$3F358110
       PAX     ,3            LOW 8 BITS OF LOW-ORDER CHARACTERISTIC  $5$3F358120
       ARS     8                                                     $5$3F358130
       LRS     163,3         RIGHT-JUSTIFY X*10**D IN AC AND MQ      $5$3F358140
       LXA     DIG,6                                                 $5$3F358150
       DVP     IC10+10,6     DIVIDE BY 10**D                         $5$3F358160
       DST     DP50                                                  $5$3F358170
FC4A   AXT     **,4                                                  $5$3F358180
       TXL     FC5,4,0                                               $5$3F358190
       LDQ     QSTO                                                  $5$3F358200
       TSX     XC,3                                                  $5$3F358210
       STQ     QSTO                                                  $5$3F358220
FC5    SXA     FC7,7          PRESERVE XR7                           $5$3F358240
       LDQ     QSTO                                                  $5$3F358250
       XEC     FC6                                                   $5$3F358260
       TNX     *+4,4,11                                              $5$3F358270
       TSX     XC,3                                                  $5$3F358280
       CLA     =11                                                   $5$3F358290
       STA     FC6                                                   $5$3F358300
       CLA     DP50+1        HIGH ORDER PART                         $5$3F358310
       TSX     IC2,7         DEVELOP AS INTEGER                      $5$3F358320
FC6    AXT     **,4          W-2-D                                   $5$3F358330
       XCL                                                           $5$3F358340
       ALS     6                                                     $5$3F358350
       ORA     EC11          INSERT .                                $5$3F358360
       TIX     *+2,1,1                                               $5$3F358370
       TSX     EC20,5        UPDATE WORD                             $5$3F358380
       XCL                                                           $5$3F358390
       CLA     DP50                                                  $5$3F358400
       LXA     DIG,4         DIG FROM FORMAT SCAN                    $5$3F358410
       TXL     *+2,4,0                                               $5$3F358420
       TSX     JP,3          DEVELOP LOW-ORDER PART                  $5$3F358430
FC7    AXT     **,7          RESTORE XR 7                            $5$3F358440
       TRA     1,7           EXIT                                    $5$3F358450
*         ERROR CONDITION                                            $5$3F358460
FC8    LDQ     QSTO          INSERT ASTERISKS                        $5$3F358470
       TRA     EC2                                                   $5$3F358480
FC20   STA     FC22                                                  $5$3F358490
       STO     FC21                                                  $5$3F358500
       TRA     FC9                                                   $5$3F358510
FC22   AXT     **,6                                                  $5$3F358520
       DFDP    DP40+76,6                                             $5$3F358530
       STZ     FC21                                                  $5$3F358540
       TSX     FC3A,7                                                (7)3F358550
       TRA     EC1                                                   (7)3F358555
FC21   PZE     0                                                     $5$3F358560
*         *** ENTRY FOR H OUTPUT ****                                $5$3F358570
HC     SXA     HC5+1,2       SAVE FORMATLOC COUNT                    $5$3F358580
       LXA     GAIN,5        RESTORE OUTBUF CHAR COUNT               $5$3F358590
       XEC     GAIN1         OUTBUF LOCATION COUNT TO XR 2           $5$3F358600
       CAL     QSTO          RESTORE BCD CHARACTERS FOR OUTPUT       $5$3F358610
       TSX     HC1,7                                                 $5$3F358620
       SLW     QSTO          SAVE BCD CHARACTERS FOR OUTPUT          $5$3F358630
       SXA     GAIN,5        SAVE BCD CHARACTER COUNT                $5$3F358640
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F358650
       XEC     HC5+1         RESTORE FORMATLOC ADDRESS               $5$3F358660
HCEXIT TRA     **                                                    $5$3F358670
HC1    TNX     HC3,4,6                                               $5$3F358680
*         IF J GREATER THAN SIX                                      $5$3F358690
       AXT     6,6           SET COUNT OF LOOP                       $5$3F358700
HC2    TIX     *+2,1,6       COUNT DOWN OF CHARACTERS IN MQ          $5$3F358710
       TSX     HC5,3                                                 $5$3F358720
       LGL     6             SOURCE CHARACTER ENTERS AC              $5$3F358730
       TIX     *+2,5,1                                               $5$3F358740
       TSX     HC4,3         TO WORD UPDATING ROUTINE                $5$3F358750
       TIX     HC2,6,1       COUNT DOWN ON SIX                       $5$3F358760
       TRA     HC1                                                   $5$3F358770
*         IF J NO GREATER THAN SIX                                   $5$3F358780
HC3    TIX     *+2,1,6                                               $5$3F358790
       TSX     HC5,3                                                 $5$3F358800
       LGL     6                                                     $5$3F358810
       TIX     *+2,5,1                                               $5$3F358820
       TSX     HC4,3                                                 $5$3F358830
       TIX     HC3,4,1                                               $5$3F358840
       TRA     1,7                                                   $5$3F358850
HC4    SLW*    BUF           TO PRINT BUFFER                         $5$3F358860
       CAL     JP11          SIX BLANKS                              $5$3F358870
       AXT     6,5           RESET OUTBUF CHARACTER COUNT            $5$3F358880
       TIX     *+2,2,1       ADVANCE PRINT BUFFER ADDRESS            $5$3F358890
       TRA     TEST                                                  $5$3F358900
       TRA     1,3                                                   $5$3F358910
HC5    SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F358920
       AXT     **,2          RESTORE FORMATLOC ADDRESS               $5$3F358930
       TXI     *+1,2,-1      ADVANCE FORMATLOC ADDRESS               $5$3F358940
       AXT     36,1          RESET FORMAT WORD CHARACTER COUNT       $5$3F358950
       LDQ     0,2                                                   $5$3F358960
       SXA     HC5+1,2       SAVE FORMATLOC ADDRESS                  $5$3F358970
       XEC     GAIN1         RESTORE OUTBUF LOCATION COUNT           $5$3F358980
       TRA     1,3                                                   $5$3F358990
*         ****ENTRY FOR I OUTPUT****                                 $5$3F359000
IC     XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F359010
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F359020
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F359030
       CLA     DATUM         BINARY INTEGER                          $5$3F359040
       LXA     WIDTH,4       W=FIELD WIDTH FROM FORMAT STATEMENT     $5$3F359050
       TNX     IC1,4,12      IF NO BLANKS NEEDED                     $5$3F359070
       TSX     XC,3          FILL IN BLANKS                          $5$3F359080
       AXT     12,4          ADJUSTED FIELD WIDTH SUBSEQUENTLY CALLED$5$3F359090
IC1    TPL     *+2                                                  (12)3F359100
       TNX     EC2,4,1       IF FIELD WIDTH IN FORMAT TOO SMALL     (12)3F359101
       SXA     *+2,4                                                 $5$3F359110
       TSX     IC2,7         CREATE BCD INTEGER                      $5$3F359120
       AXT     **,4                                                  $5$3F359130
       TRA     EC1           EXIT                                    $5$3F359140
*           **CREATE BCD REPRESENTATION OF BINARY INTEGER**          $5$3F359150
*             W-1 LESS THAN OR EQUAL TO 11                           $5$3F359160
IC2    XEC     1,7                                                   $5$3F359170
       TXH     IC4-1,4,11                                           (12)3F359175
       TXH     IC6,4,10      IF W-1=11                               $5$3F359180
*         TEST FOR CORRECT FIELD WIDTH                               $5$3F359190
       LAS     IC10+10,4                                             $5$3F359200
       TRA     EC2           FIELD WIDTH IN FORMAT TOO SMALL         $5$3F359210
       TRA     EC2           FIELD WIDTH IN FORMAT TOO SMALL         $5$3F359220
IC3    LAS     IC10+11,4                                             $5$3F359230
       TRA     IC5           IF SIGNIFICANT DIGIT ENCOUNTERED        $5$3F359240
       TRA     IC5           IF SIGNIFICANT DIGIT ENCOUNTERED        $5$3F359250
       TNX     IC5,4,1                                               $5$3F359260
IC4    RQL     6             ACT OF SUPPRESSION                      $5$3F359270
       TIX     IC3,1,1                                               $5$3F359280
*         OUTBUF UPDATING ROUTINE                                    $5$3F359290
       STQ*    BUF                                                   $5$3F359300
       LDQ     JP11          SIX BLANKS                              $5$3F359310
       AXT     6,1                                                   $5$3F359320
       TIX     IC3,2,1       ADVANCE OUTBUF ADDRESS                  $5$3F359330
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F359340
*         DEVELOP NON-BLANK CHARACTERS                               $5$3F359350
IC5    TSX     EC30,3                                                $5$3F359360
       XCL                                                           $5$3F359370
       TSX     JP,3          DEVELOP BCD REPRESENTATION              $5$3F359380
       TRA     2,7                                                   $5$3F359390
*         IF W-1=11                                                  $5$3F359400
IC6    LAS     IC10          COMPARE TO 10**10                       $5$3F359410
       TRA     IC5           NUMBER HAS 11 DECIMAL DIGITS            $5$3F359420
       TRA     IC5                                                   $5$3F359430
       TXI     IC4,4,-1                                              $5$3F359440
*CONSTANTS                                                           $5$3F359810
IC10   DEC     10000000000,1000000000,100000000,10000000,1000000     $5$3F359820
       DEC     100000,10000,1000,100,10,1                            $5$3F359830
*         ****ENTRY FOR L OUTPUT****                                 $5$3F359840
LC     XEC     GAIN          RESET XR1 WITH  OUTBUF CHARACTER COUNT  $5$3F359850
       XEC     GAIN1         RESET XR2 OUTBUF LOCATION COUNT         $5$3F359860
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F359870
       LXA     WIDTH,4       W=FIELD WIDTH FROM FORMAT SPECIFICATION $5$3F359880
       TNX     LC1,4,1       IF W=1                                  $5$3F359890
       TSX     XC,3          FILL IN W-1 BLANKS                      $5$3F359900
LC1    XCL                                                           $5$3F359910
       LDQ     TFTEST        PICK-UP T AND F CHARACTERS              $5$3F359920
       NZT     DATUM         TEST LOGICAL VARIABLE                   $5$3F359930
       RQL     6             LOGICAL VARIABLE IS FALSE               $5$3F359940
       LGL    6              LOGICAL VARIABLE IS TRUE                $5$3F359950
       TIX     *+2,1,1                                               $5$3F359960
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F359970
       XCL                                                           $5$3F359980
       TRA     EC1           EXIT                                    $5$3F359990
*         ****ENTRY FOR OUTPUT****                                   $5$3F360000
OC     XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F360010
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F360020
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F360030
       LXA     WIDTH,4       FIELD WIDTH FROM FORMAT STATEMENT=W     $5$3F360040
       TNX     OC3,4,12      IF W LESS THAN OR EQUAL TO 12           $5$3F360050
       TSX     XC,3          FILL IN BLANKS                          $5$3F360060
       AXT     12,4                                                  $5$3F360070
OC1    XCA                                                           (6)3F360080
OC2    ALS     3                                                     $5$3F360090
       LGL     3                                                     $5$3F360100
       TIX     *+2,1,1                                               $5$3F360110
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F360120
       TIX     OC2,4,1                                               $5$3F360130
       XCL                                                           $5$3F360140
       TRA     EC1           EXIT                                    $5$3F360150
OC3    CLA     =12                                                   $5$3F360160
       SUB     WIDTH         12-W                                    $5$3F360170
       PAX     ,4                                                    $5$3F360180
       CAL     DATUM                                                 $5$3F360190
       XCL                                                           $5$3F360200
       TNX     *+3,4,0                                               (6)3F360205
       RQL     3                                                     $5$3F360210
       TIX     *-1,4,1                                               $5$3F360220
       LXA     WIDTH,4                                               $5$3F360230
       TRA     OC2                                                   $5$3F360240
*         ****ENTRY FOR X OUTPUT.  NUMBER OF BLANKS REQUIRED IN XR4**$5$3F360250
XCF    XEC     GAIN          RESTORE OUTBUF CHARACTER COUNT          $5$3F360260
       XEC     GAIN1         RESTORE OUTBUF LOCATION COUNT           $5$3F360270
       LDQ     QSTO          BCD CHARACTERS                          $5$3F360280
       TSX     XC,3          FILL IN BLANKS                          $5$3F360290
       TRA     EC1           EXIT                                    $5$3F360300
*         **** X CONVERSION  ****                                    $5$3F360310
*         NUMBER OF BLANKS TO BE INSERTED IN XR 4                    $5$3F360320
XC     XEC     XC10+6,1                                              $5$3F360330
*         IF J GREATER THAN I                                        $5$3F360340
       XEC     XC11+6,1      DEVELOP I LOW ORDER BLANKS IN MQ        $5$3F360350
       STQ*    BUF                                                   $5$3F360360
       LDQ     JP11          6 BLANKS                                $5$3F360370
       TIX     XC1,2,1       ADVANCE BUFFER ADDRESS                  $5$3F360380
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360390
XC1    TNX     XC2,4,6                                               $5$3F360400
       STQ*    BUF                                                   $5$3F360410
       TIX     XC1,2,1                                               $5$3F360420
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360430
*         LAST WORD                                                  $5$3F360440
XC2    XEC     XC12+6,4      IF J LESS THAN 6,RESET I, ELSE BRANCH   $5$3F360450
       TRA     1,3                                                   $5$3F360460
XC3    STQ*    BUF                                                   $5$3F360470
       AXT     6,1                                                   $5$3F360480
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F360490
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360500
       TRA     1,3                                                   $5$3F360510
*         IF J LESS THAN OR EQUAL TO I                               $5$3F360520
XC4    XEC     XC13+6,4                                              $5$3F360530
       XEC     XC11+6,4      DEVELOP J LOW-ORDER BLANKS IN MQ        $5$3F360540
       STQ*    BUF                                                   $5$3F360550
       LDQ     JP11          6 BLANKS                                $5$3F360560
       TRA     XC3+1                                                 $5$3F360570
XC5    XEC     XC11+6,4      DEVELOP J LOW-ORDER BLANKS IN MQ        $5$3F360580
       TRA     1,3                                                   $5$3F360590
*         TABLES                                                     $5$3F360600
XC10   TNX     XC4,4,6       I=6                                     $5$3F360610
       TNX     XC4,4,5       I=5                                     $5$3F360620
       TNX     XC4,4,4       I=4                                     $5$3F360630
       TNX     XC4,4,3       I=3                                     $5$3F360640
       TNX     XC4,4,2       I=2                                     $5$3F360650
       TNX     XC4,4,1       I=1                                     $5$3F360660
XC11   TRA     XC1+1         I=6                                     $5$3F360670
       RQL     30            I=5                                     $5$3F360680
       RQL     24            I=4                                     $5$3F360690
       RQL     18            I=3                                     $5$3F360700
       RQL     12            I=2                                     $5$3F360710
       RQL     6             I=1                                     $5$3F360720
XC12   TRA     XC3           J=6                                     $5$3F360730
       AXT     1,1           J=5                                     $5$3F360740
       AXT     2,1           J=4                                     $5$3F360750
       AXT     3,1           J=3                                     $5$3F360760
       AXT     4,1           J=2                                     $5$3F360770
       AXT     5,1           J=1                                     $5$3F360780
XC13   TRA     XC3           J=6                                     $5$3F360790
       TIX     XC5,1,5       J=5                                     $5$3F360800
       TIX     XC5,1,4       J=4                                     $5$3F360810
       TIX     XC5,1,3       J=3                                     $5$3F360820
       TIX     XC5,1,2       J=2                                     $5$3F360830
       TIX     XC5,1,1       J=1                                     $5$3F360840
*         *****          COMMON SERVICE SUBROUTINES          *****   $5$3F360850
*            **INSERTION OF ASTERISKS**                              $5$3F360860
AST    LXA     WIDTH,4       FIELD WIDTH                             $5$3F360870
AST1   CAL     AST10         ASTERISK                                $5$3F360880
       VDP     AST11,,6      ENTERS MQ FROM RIGHT                    $5$3F360890
       RQL     1                                                     $5$3F360900
       LGR     1                                                     $5$3F360910
       TNX     AST3,1,1      TO OUTBUF UPDATING ROUTINE              $5$3F360920
AST2   TIX     AST1,4,1                                              $5$3F360930
       TRA     1,3           EXIT                                    $5$3F360940
*         OUTBUF UPDATING ROUTINE FOR AST SUBROUTINE                 $5$3F360950
AST3   STQ*    BUF           PLACE BCD CHARACTERS INTO OUTPUT BUFFER $5$3F360960
       AXT     6,1           RESET XR1 WITH 6                        $5$3F360970
       LDQ     JP11          SIX BLANKS                              $5$3F360980
       TIX     AST2,2,1      ADVANCE BUFFER ADDRESSS                 $5$3F360990
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F361000
*         CONSTANTS                                                  $5$3F361010
AST10  BCI     1,00000*      RIGHT-JUSTIFIED ASTERISK                $5$3F361020
AST11  OCT     100           DIVISOR                                 $5$3F361030
*                            EXIT FOR ALL OUTPUT ROUTINES            $5$3F361040
EC1    SXA     GAIN,1        SAVE OUTBUF CHARACTER COUNT             $5$3F361050
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F361060
       STQ     QSTO          SAVE BCD CHARACTERS                     $5$3F361070
       TRA     COUNT         EXIT TO FORMAT SCAN                     $5$3F361080
*                            IF FIELD WIDTH TOO SMALL                $5$3F361090
EC2    TSX     AST,3         GO TO FILL IN ASTERISKS                 $5$3F361100
       TRA     EC1           EXIT                                    $5$3F361110
*         SUBROUTINE FOR UPDATING OUTPUT BUFFER CALLED BY XR 5       $5$3F361120
EC20   SLW*    BUF                                                   $5$3F361130
       CAL     EC14          SIX BLANKS                              $5$3F361140
       AXT     6,1           RESET I=6                               $5$3F361150
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F361160
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F361170
       TRA     1,5                                                   $5$3F361180
*         SUBROUTINE FOR INSERTING SIGN CALLED BY XR3                $5$3F361190
EC30   TMI     EC30E+1                                              (12)3F361197
       XCL                                                          (12)3F361198
       TRA     1,3                                                  (12)3F361199
EC30E  TPL     EC31                                                 (12)3F361200
       XCL                                                           $5$3F361210
       ALS     6                                                     $5$3F361220
       ORA     EC10          MINUS SIGN                              $5$3F361230
       TRA     EC31+2                                                   3F361240
EC31   RQL     6             CREATE LOW ORDER BLANK                  $5$3F361250
       XCL                                                           $5$3F361260
       TIX     *+2,1,1                                               $5$3F361270
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F361280
       TRA     1,3                                                   $5$3F361290
*        SUBROUTINE FOR INSERTING 0. CALLED BY XR3                   $5$3F361300
EC32   ALS     6             CREATE 0                                $5$3F361310
       TIX     *+2,1,1                                               $5$3F361320
       TSX     EC20,5                                                $5$3F361330
       ALS     6                                                     $5$3F361340
       ORA     EC11          .                                       $5$3F361350
       TIX     *+2,1,1                                               $5$3F361360
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F361370
       TRA     1,3                                                   $5$3F361380
*         TEST FOR FIELD WIDTH,INSERT BLANKS WHERE NEEDED,AND CONVERT$5$3F361390
*         FROM FLOATING POINT NUMBER TO BINARY INTEGERS.             $5$3F361400
ECDC   ADD     DIG           P+D. D=NUMBER OF DIGITS REQUESTED IN    $5$3F361410
       ALS     1             FORMAT 2(P+D)                           $5$3F361420
       TPL     *+2                                                   $5$3F361430
       PXD     ,0            IN NEG SCALE FACTOR,IF ABS VALUE OF P   $5$3F361440
       STA     DP2           GTR FOR DP ROUTINE               THAN D $5$3F361450
       DLD     DATUM         FLOATING POINT NUMBER                   $5$3F361460
       STZ     FC2J                                                 (12)3F361461
       TPL     *+2                                                  (12)3F361462
       STL     FC2J                                                 (12)3F361463
       TSX     DP,4          TO CONVERSION ROUTINE                   $5$3F361470
       PAX     ,0            SINGLE PRECISION EXIT                   $5$3F361480
       DST     DP50          DOUBLE PRECISION EXIT                   $5$3F361490
       CLA     DIG           D                                       $5$3F361500
       ADD     =7            D+7                                     $5$3F361510
       NZT     FC2J                                                 (12)3F361511
       SUB     L(1)                                                 (12)3F361512
ECDC1  XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F361520
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F361530
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F361540
       CAS     WIDTH         COMPARE TO FIELD WIDTH                  $5$3F361550
       TRA     EC2           FIELD WIDTH TOO SMALL.INSERT ASTERISKS  $5$3F361560
       TRA     1,5           NO BLANKS NEEDED                        $5$3F361570
       SUB     WIDTH         NUMBER OF BLANKS NEEDED                 $5$3F361580
       PAX     ,4                                                    $5$3F361590
       TSX     XC,3          INSERT BLANKS                           $5$3F361600
       TRA     1,5                                                   $5$3F361610
*         SUBROUTINE FOR POSITIVE P FACTOR                           $5$3F361620
*         TESTS FOR FIELD WIDTH,NUMBER OF DIGITS TO BE DEVELOPED,AND $5$3F361630
*         CONVERTS FROM FLOATING POINT NUMBERS TO BINARY INTEGERS    $5$3F361640
ECDCP  TMI     2,7           P NEGATIVE                              $5$3F361650
       ADD     DIG           P+D                                     $5$3F361660
       STO     N                                                     $5$3F361670
       ADD     =5            P+D+5                                  (12)3F361671
       LDQ     DATUM                                                (12)3F361672
       TQP     *+2                                                  (12)3F361673
       ADD     L(1)          P+D+6                                  (12)3F361680
       TSX     ECDC1,5       INSERT BLANKS IF NEEDED                 $5$3F361690
       SXA     GAIN,1        SAVE OUTBUF CHARACTER COUNT             $5$3F361700
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F361710
       STQ     QSTO          SAVE BCD CHARACTERS                     $5$3F361720
       CLA     N             P+D                                     $5$3F361730
       ALS     1             2(P+D)                                  $5$3F361740
       STO     N                                                     $5$3F361750
       CAS     1,7           COMPARE TO 16 IF SINGLE PREC OR 32 IF DP$5$3F361760
       CLA     1,7           IF 2(P+D)GREATER THAN 16(SP) OR 32(DP)  $5$3F361770
       PAX     ,0            NOOP IF 2(P+D)=16 OR 32                 $5$3F361780
       STA     DP2           FOR DP ROUTINE                          $5$3F361790
       DLD     DATUM         FLOATING-POINT NUMBER                   $5$3F361800
       TSX     DP,4          CONVERT TO BINARY INTEGERS              $5$3F361810
       LDQ     L(0)          SINGLE PRECISION EXIT                   $5$3F361820
       DST     DP50          DOUBLE PRECISION EXIT                   $5$3F361830
       XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F361840
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F361850
       CLA     N             2(P+D)                                  $5$3F361860
       SUB     1,7           2(P+D-8) OR 2(P+D-16)                   $5$3F361870
       TMI     ECDCP3                                                (6)3F361880
       ARS     1             P+D-8 OR P+D-16                         $5$3F361890
       STA     EC8           NUMBER OF ZEROS NEEDED FOR FRACTION PART$5$3F361900
       SUB     DIG           P-8 OR P-16                             $5$3F361910
       STA     DIGP          ACTUAL NUMBER OF DIGITS DEVELOPED FOR   $5$3F361920
       TRA     3,7           FRACTION                                $5$3F361930
ECDCP3 CLA     DIG                                                   (6)3F361940
       SXA     EC8,0                                                 (6)3F361941
       TRA     ECDCP3-2                                              (6)3F361950
*         SUBROUTINE FOR POSITIVE SCALE FACTOR.SEPARATES FRACTION AND$5$3F361960
*         INTEGER PARTS                                              $5$3F361970
ECDCP1 LXA     DIGP,4        D                                       $5$3F361980
       PXD     ,0                                                    $5$3F361990
       LDQ     DP50          BINARY INTEGER                          $5$3F362000
       LLS     0                                                     $5$3F362010
       DVP     IC10+10,4     BY 10**D                                $5$3F362020
ECDCP2 TRA     1,7                                                   $5$3F362030
DIGP   PZE     0             ACTUAL NUMBER OF DIGITS DEVEL. FOR FRCTN$5$3F362040
*         SUBROUTINE TO DEVELOP J-PLACE INTEGER                      $5$3F362050
*         CALLED BY TSX JP,3 WITH J LESS THAN OR = 11 IN XR4         $5$3F362060
JP     TXL     JP2,4,9                                               $5$3F362070
*          IF J=10 OR 11                                             $5$3F362080
       RQL     6                                                     $5$3F362090
       LLS     0                                                     $5$3F362100
       LRS     6                                                     $5$3F362110
       VDP     JP10+11,4,6                                           $5$3F362120
       TNX     JP4,1,1             IF WORD BOUNDARY MUST BE CROSSED  $5$3F362130
       TXI     JP,4,-1                                               $5$3F362140
*         CONVERSION LOOP                                            $5$3F362150
JP1    ARS     6                                                     $5$3F362160
JP2    VDP     JP10+11,4,6         DECIMAL DIGIT ENTERS MQ FROM RIGHT$5$3F362170
       TNX     JP3,1,1             IF WORD BOUNDARY MUST BE CROSSED  $5$3F362180
       TIX     JP1,4,1             COUNT ON J                        $5$3F362190
*         AFTER CONVERSION                                           $5$3F362200
       RQL     1                                                     $5$3F362210
       LGR     1                   REPLACE HIGH ORDER BIT IN MQ      $5$3F362220
       TRA     1,3                 GO TO EXIT                        $5$3F362230
*         WORD UPDATING ROUTINE                                      $5$3F362240
JP3    RQL     1                                                     $5$3F362250
       LGR     1                   REPLACE HIGH ORDER BIT IN MQ      $5$3F362260
       ARS     5                   REJUSTIFY AC                      $5$3F362270
JP4    STQ*    BUF           STORE                                   $5$3F362280
       LDQ     JP11                SIX BLANKS                        $5$3F362290
       AXT     6,1                 RESET I=6                         $5$3F362300
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F362310
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F362320
       TIX     JP,4,1        COUNT ON J                              $5$3F362330
       TRA     1,3                 GO TO EXIT                        $5$3F362340
*      POWERS OF TEN                                                 $5$3F362350
JP10   DEC     10000000000                                           $5$3F362360
       DEC     1000000000                                            $5$3F362370
       DEC     6400000000                                            $5$3F362380
       DEC     640000000                                             $5$3F362390
       DEC     64000000                                              $5$3F362400
       DEC     6400000                                               $5$3F362410
       DEC     640000                                                $5$3F362420
       DEC     64000                                                 $5$3F362430
       DEC     6400                                                  $5$3F362440
       DEC     640                                                   $5$3F362450
       DEC     64                                                    $5$3F362460
*         BCD CONSTANT                                               $5$3F362470
JP11   BCI     1,                  SIX BLANKS                        $5$3F362480
*            **DOUBLE PRECISION CONVERSION ROUTINE**                 $5$3F362490
*             *(2**C).F=(10**U).V,D=NUMBER OF DECIMAL DIGITS IN V    $5$3F362500
*             *P=SCALE FACTOR.FLOATING POINT NUMBER IN AC AND MQ.    $5$3F362510
*         OBTAIN U+38                                                $5$3F362520
DP     LGR     63            RIGHT-JUSTIFY CHARACTERISTIC IN MQ      $5$3F362530
       VLM     DP20,,12      BY LOG 2                                $5$3F362540
       PAX     ,6            U+38                                    $5$3F362550
*         OBTAIN V                                                   $5$3F362560
       ALS     1             2(U+38)                                 $5$3F362570
       TXL     DP1,6,37                                              $5$3F362580
*         IF U NOT NEGATIVE                                          $5$3F362590
       PAX     ,1            2(U+38)                                 $5$3F362600
       DLD     DP51          RESTORE FLOATING POINT NUMBER           $5$3F362610
       DFDP    DP40+152,1    BY 10**U                                $5$3F362620
       TRA     DP2                                                   $5$3F362630
*         IF U NEGATIVE                                              $5$3F362640
DP1    PAC     ,1            2(U+38)                                 $5$3F362650
       DLD     DP51          RESTORE FLOATING POINT NUMBER           $5$3F362660
       DFMP    DP40,1        BY 10**U                                $5$3F362670
*         SCALE TEST                                                 $5$3F362680
DP2    AXT     **,1          2(D+P)                                  $5$3F362690
       LAS     DP21                                                  $5$3F362700
*         IF OUT OF SCALE                                            $5$3F362710
       DFMP    DP40+78,1     BY 10**(D+P-1)                          $5$3F362720
       TXI     *+2,6,1                                               $5$3F362730
*         IF IN SCALE                                                $5$3F362740
       DFMP    DP40+76,1     BY 10**(D+P)                            $5$3F362750
*         ROUND OFF                                                  $5$3F362760
       TPL     *+3                                                   $5$3F362770
       DFSB    DP42          .5                                      $5$3F362780
       TRA     *+2                                                   $5$3F362790
       DFAD    DP42          .5                                      $5$3F362800
*         OVERFLOW TEST                                              $5$3F362810
       LAS     DP40+76,1     COMPARE TO 10**(D+P)                    $5$3F362820
       TRA     DP6           IF OVERFLOW OCCURRED                    $5$3F362830
       TSX     DP5,3         IF LOW ORDER PART MUST ALSO BE TESTED   $5$3F362840
*         FIXING OF MANTISSA                                         $5$3F362850
DP3    LLS     10                                                    $5$3F362860
       LRS     2             SUPPRESS HIGH ORDER CHARACTERISTIC      $5$3F362870
       PAX     ,3            LOW 8 BITS OF LOW ORDER CHARACTERISTIC  $5$3F362880
       LXA     DIG,1                 D FROM W.D OR DEC. PT. FROM DATA(8)3F362890
       TIX     DP4,1,8               GO TO DP4 IF DOUBLE PRECISION   (8)3F362895
       XEC     DP2           2(P+D) TO XR1                          (12)3F362896
       TIX     DP4,1,16      GO TO DP4 IF 2(P+D) IS G. T. 16        (12)3F362897
*         FOR SINGLE PRECISION                                       $5$3F362900
       ARS     136,3         RIGHT-JUSTIFY V*10**D IN AC             $5$3F362910
       TRA     1,4           EXIT                                    $5$3F362920
*         FOR DOUBLE PRECISION                                       $5$3F362930
DP4    ARS     8                                                     $5$3F362940
       LRS     163,3         RIGHT-JUSTIFY V*10**C IN AC AND MQ      $5$3F362950
       DVP     DP24          BY 10**8                                $5$3F362960
       TRA     2,4           EXIT                                    $5$3F362970
*         IF LOW ORDER PART MUST ALSO BE TESTED                      $5$3F362980
DP5    XCA                   LOW ORDER PART TO AC                    $5$3F362990
       TXI     *+1,1,-1      NEXT INSTRUCTION REFR. LOP OF 10**CD+P  $5$3F363000
       XEC     -2,3          COMPARE TO LOW ORDER PART OF 10**D+P    $5$3F363010
       TXI     *+2,3,2       ADJUST XR3 FOR HIGH-ORDER EXIT          $5$3F363020
       TXI     *+1,3,2       ADJUST XR3 FOR HIGH-ORDER EXIT          $5$3F363030
       XCA                   RESTORE AC                              $5$3F363040
       TXI     *+1,1,1       RESTORE XR1                             $5$3F363050
       TRA     1,3                                                   $5$3F363060
*         DEAL WITH ROUND-OFF OVERFLOW                               $5$3F363070
DP6    DFDP    DP40+74       BY 10                                   $5$3F363080
       TXI     DP3,6,1       INCREASE U BY 1                         $5$3F363090
*         CONSTANTS                                                  $5$3F363100
DP20   OCT     2321                                                  $5$3F363110
DP21   OCT     201000000000  QUASI-ONE                               $5$3F363120
DP24   DEC     100000000                                             $5$3F363130
       EVEN                                                          $5$3F363140
*         POWERS OF TEN IN DOUBLE PRECISION                          $5$3F363150
DP40   DEC     1.EE38,1.EE37,1.EE36,1.EE35,1.EE34,1.EE33,1.EE32      $5$3F363160
       DEC     1.EE31                                                $5$3F363170
       DEC     1.EE30,1.EE29,1.EE28,1.EE27,1.EE26,1.EE25,1.EE24      $5$3F363180
       DEC     1.EE23                                                $5$3F363190
       DEC     1.EE22,1.EE21,1.EE20,1.EE19,1.EE18,1.EE17,1.EE16      $5$3F363200
       DEC     1.EE15                                                $5$3F363210
       DEC     1.EE14,1.EE13,1.EE12,1.EE11,1.EE10,1.EE9,1.EE8,1.EE7  $5$3F363220
       DEC     1.EE6,1.EE5,1.EE4,1.EE3,1.EE2,1.EE1,1.EE0             $5$3F363230
       DEC     1.EE-1                                                $5$3F363240
DP42   OCT     232000000001,0    ROUND-OFF CONSTANT=.5               $5$3F363250
DP50   BSS     2                 FOR TEMPORARY STORAGE               $5$3F363260
DP51   EQU     DATUM                                                 $5$3F363270
TEST   TRA     **                                                    $5$3F363280
       REM  ENTRY FROM DBC, ANPT, ONPT, TOPACK.                         3F363290
       ZET     DDDFLG         WAS THIS DOUBLE PRECISION CONVERT      $5$3F363300
       TSX     DDRSET,2              YES. RESET DOUBLE PRECISION EXITS. 3F363310
COUNT  AXT     **,4                  TEST FIELD COUNT,                  3F363320
       TNX     DONE,4,1              IF NOT DONE,                       3F363330
       SXA     *-2,4                 RESET COUNT, AND                   3F363340
       REM  ENTRY FROM CCRPAR, FIELD.                                   3F363350
LIST   DLD     DATUM                 PICKUP INPUT DATUM.                3F363360
LXIT3  AXT     **,3                                                  (6)3F363361
LXIT5  AXT     **,5                                                  (6)3F363362
LXIT6  AXT     **,6                                                  (6)3F363363
LXIT7  AXT     **,7                                                  (6)3F363364
LXIT1  AXT     **,1                  RESTORE                            3F363370
LXIT2  AXT     **,2                  INDEX                              3F363380
LEXIT  AXT     **,4                  REGISTERS.                         3F363390
       TRA     1,4                   EXIT TO PROGRAMS I/O LIST.         3F363400
       REM  REENTRY FROM COUNT.                                         3F363410
DONE   AXT     **,4                  RESTORE RETURN INDEX.              3F363420
       TRA     1,4                 * EXIT TO CALLER.                    3F363430
CODE1  PZE     32                                                       3F363440
ER32MS PZE     E32MES,,7                                                3F363450
ER32OP PZE     E32OMS,,5                                                3F363460
E32MES BCI     7,0ILLEGAL CHAR IN DATA BELOW OR BAD FORMAT              3F363470
E32OMS BCI     5,0TREAT ILLEGAL CHAR AS ZERO                            3F363480
CODE2  PZE     33                                                       3F363490
ER33MS PZE     E32MES,,7                                                3F363500
ER33OP PZE     E32OMS,,5                                                3F363510
CODE9  PZE     57                                                       3F363520
ER57MS PZE     E57MES,,8                                                3F363530
ER57OP PZE     E57OMS,,5                                                3F363540
E57MES BCI     8,0ILLEGAL CHAR FOR L CONVERSION IN DATA BELOW           3F363550
E57OMS BCI     5,0TREAT ILLEGAL CHAR AS BLANK                           3F363560
LIMIT  EQU     LIMIT5/6+1            LINE LIMIT IN WORDS             (8)3F363570
       EVEN                                                          $5$3F363580
OUTBUF BSS     LIMIT                                                 (8)3F363590
BUF    PZE     OUTBUF+LIMIT,2                                        $5$3F363600
QSTO   BCI     1,             6 BLANKS                               $5$3F363610
WIDTH  PZE                                                           $5$3F363620
GAIN   AXT     6,1                                                   $5$3F363630
GAIN1  AXT     LIMIT,2                                               $5$3F363640
MINUS  EQU     EC10                                                  $5$3F363650
POINT  EQU     EC11                                                  $5$3F363660
EXPON  EQU     EC12                                                  $5$3F363670
PLUS   BCI     1,00000+                                                 3F363680
NEGAT  BCI     1,00000'                                                 3F363690
TRUE   BCI     1,00000T                                                 3F363700
FALSE  BCI     1,00000F                                                 3F363710
TFTEST BCI     1,TF                                                     3F363720
L(0)   PZE     0                                                     $5$3F363730
MZE    MZE                                                              3F363740
TEN    EQU     IC10+9                                                $5$3F363750
.FBDBF PZE     **,2                  LOCATION OF INPUT BUFFER,2         3F363760
DMQD   PZE                                                              3F363770
V      PZE                                                              3F363780
U      PZE                                                              3F363790
CHMASK OCT     000777777777                                             3F363800
F      PZE                                                              3F363810
E      PZE                                                              3F363820
D      PZE                                                              3F363830
DG     PZE                                                              3F363850
       EVEN                                                             3F363860
DATUM  BSS     2                                                        3F363870
N      PZE     0                                                     $5$3F363880
N1     PZE     0                                                     $5$3F363890
N2     PZE     0                                                     $5$3F363900
N3     PZE     0                                                     $5$3F363910
ND     BSS     2                                                        3F363920
BLCNT  PZE                           NON-ZERO IF DATA NOT ALL BLANKS.(8)3F363925
LIMIT5 EQU     CHLIMT                                               (14)3F363930
BLANK  BCI     1,00000                                                  3F363950
L(1)   PZE     1                                                        3F363960
BLANKS EQU     JP11                                                  $5$3F363970
DDDFLG PZE     **                    NON-ZERO IF D IN FORMAT SCAN.      3F363980
DDFLAG PZE     **                    NON-ZERO IF CONVERTED RESULT       3F363990
MQD    PZE                                                              3F364000
PEX    PZE                                                              3F364010
EXP    PZE                                                              3F364020
DIG    PZE                                                              3F364030
DEXPON EQU     EC15                                                  $5$3F364040
DB8PW  BSS     1                                                     $5$3F364050
DB871  OCT     043000000000                                          $5$3F364060
DB872  OCT     000066000000                                          $5$3F364070
DBSPP  BOOL    1              SIGN OF PRINCIPAL PART                 $5$3F364080
DBSEP  BOOL    40             SIGN OF EXPONENTIAL PART               $5$3F364090
LNKG   LDIR                                                             3F364120
END94  NULL                                                          $5$3F364130
       END                                                           $5$3F364140
