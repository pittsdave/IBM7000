$JOB           ASSEMBLE IOCSB
$EXECUTE       IBJOB
$IBJOB         NOGO
$*7090/7094 IOCS VERSION 6 (SYSTEM COMPONENT FORM) RECORD IOCSB         1IO00000
$TITLE         7090/7094 IBJOB MONITOR (IBJOB), 7090-SV-801, VERSION $5$1IO00010
$IBMAP IOCSB   3000,ABSMOD,MONSYM,()OK                               $5$1IO00020
       PCC     ON                                                       1IO00030
       LBL     IOCSB                                                 $5$1IO00040
       TITLE                                                            1IO00070
       PCC     OFF                                                      1IO00080
       SPACE   1                                                        1IO00090
*THIS IS IOCS VERSION -6- WHICH HAS BEEN PREPARED                       1IO00100
*  FROM THE DISTRIBUTED VERSION OF THE IOCS SYSTEM                      1IO00110
* HERE, IOCC IS PRESENTED AS A SET OF SUBROUTINES                       1IO00120
*  WHICH MAY BE USED BY ANY SYSTEM FOR BUFFERRED I/O.                   1IO00130
*  USE OF THE BASIC MONITOR AND EXECUTOR IS REQUIRED.                   1IO00140
*  REFER TO BASIC MONITOR AND IOCS MANUALS FOR                          1IO00150
*  DETAILED CONTENT AND RULES OF USEAGE.                                1IO00160
       SPACE   1                                                        1IO00170
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            1IO00180
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                1IO00190
       SPACE   1                                                        1IO00200
*SYSTEM PRINTER                                                         1IO00210
       SPACE   1                                                        1IO00220
*      PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10              1IO00230
EJECT  EQU     1                                                        1IO00240
       SPACE   1                                                        1IO00250
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       1IO00260
DBLSP  EQU     4                                                        1IO00270
       SPACE   1                                                        1IO00280
*SENSE SWITCHES                                                         1IO00290
       SPACE   1                                                        1IO00300
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 1IO00310
       SPACE   1                                                        1IO00320
NOHYP  SET     0                   NO HYPERTAPE DEFINED IN IOCS      $5$1IO00330
       SPACE   1                                                       $1IO00340
*      END OF PARAMETERS TO BE SET BY INSTALLATION                   $5$1IO00350
       SPACE   2                                                     $5$1IO00360
XO9CH  SET     NOCH+NOHYP                                            $5$1IO00370
NOCHX  SET     XO9CH+XO9CH                                           $5$1IO00380
IBSIZ  EQU     1450+XO9CH/XO9CH*550                                  $5$1IO00381
       SPACE   2                                                     $5$1IO00390
*      SPECIAL SYSTEM MONITOR SYMBOL DEFINITIONS                     $5$1IO00400
CHEXI  EQU     SYSJOB+1                                              $5$1IO00410
MODSW  EQU     SYSJOB+2                                              $5$1IO00420
BPAWS  EQU     .PAWS                                                 $5$1IO00430
TRPSW  EQU     .TRPSW                                                $5$1IO00440
STOPD  EQU     .STOP                                                 $5$1IO00450
       SPACE   2                                                     $5$1IO00460
*      IBJOB   COMMUNICATION   SYMBOLS                               $5$1IO00470
IOCS   EQU     8935                                                  $5$1IO00480
IBJCOM EQU     8860                                                  $5$1IO00490
SYSLOC EQU     IBJCOM                                                $5$1IO00500
SYSFAZ EQU     SYSLOC+1                                              $5$1IO00510
       SPACE   2                                                     $5$1IO00520
EMTM   OPD     460066100016                                          $5$1IO00530
LMTM   OPD     460066000016                                          $5$1IO00540
       TTL     IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION    1IO01100
       REM     RECORD NAME FOR MAINTENANCE                           $5$1IO01110
       ORG     SYSFAZ                                                   1IO01120
       BCI     1,IOCSB                                                  1IO01130
       ORG     IOCS                IOCS COMM. REGION ORG. FOR JOB       1IO01140
*IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION.                 1IO01150
* PRIMARY IOCS COMMUNICATIONS                                           1IO01160
DEFINE STL     ROUTE               DEFINE A BUFFER POOL                 1IO01170
       TXL     ENTRY,,DEFIN.                                            1IO01180
JOIN   STL     ROUTE               JOIN TWO BUFFER POOLS                1IO01190
       TXL     ENTRY,,JOINX                                             1IO01200
ATTACH STL     ROUTE               ATTACH FILES TO A                    1IO01210
       TXL     ENTRY,,ATTCH.        BUFFER POOL                         1IO01220
CLOSE  STL     ROUTE               CLOSE FILE(S),OPTIONALLY             1IO01230
       TXL     ENTRY,,CLOSE.        DETACHING FROM A POOL               1IO01240
OPEN   STL     ROUTE               OPEN A FILE                          1IO01250
       TXL     ENTRY,,OPEN.                                             1IO01260
READ   STL     ROUTE               BUFFERED READ                        1IO01270
       TXL     ENTRY,,READ.                                             1IO01280
WRITE  STL     ROUTE               BUFFERED WRITE                       1IO01290
       TXL     ENTRY,,WRITE.                                            1IO01300
STASH  STL     ROUTE               BUFFER TRANSFER                      1IO01310
       TXL     ENTRY,,STASH.                                            1IO01320
       TTL              SECONDARY IOCS COMMUNICATION CELLS              1IO01330
MWR    TTR     .MWR                                                  $5$1IO01340
LFLBLK MZE     **,,**              L(FILE BLOCK),,SIZE                  1IO01350
LTSX   PZE     0,,**               L(TSX)                               1IO01360
XEOB   PZE     0,,**               L( EOB EXIT)                         1IO01370
XEOF   PZE     **,,0               L( EOF EXIT)                         1IO01380
XERR   PZE     0,,**               L( ERROR EXIT)                       1IO01390
LTRAD  PZE     **,,0               LAST TRANSMIT ADDRESS                1IO01400
TRANS  PZE     **,,0               TRANSMIT ADDRESS                     1IO01410
WDCT   PZE     0,,**               WORD COUNT                           1IO01420
IRS    PZE     **,,**              INDEX REGISTER STORAGE               1IO01430
SENSE  PZE     0,,0                SENSE INDICATOR STORAGE              1IO01440
FCW    IORT    **,,**              IO WORD FOR BUFS AND IN IOCS SWITCH  1IO01450
LUNBLK PZE     **,,**              LOC AND LENGTH RESERVE UNIT BLOCK    1IO01460
NDSL   TTR     NDSEL+1                                                  1IO01470
       TTL     CONSTANT POOL                                            1IO01480
       ORG     IBSIZ                                                 $5$1IO01490
L(0)   PZE                                                              1IO01500
L(1)   PZE     1                                                        1IO01510
L(377) OCT     377                                                      1IO01520
L(400) OCT     400                                                      1IO01530
ADDRS  PZE     -1                                                       1IO01540
1DEC   PZE     0,,1                                                     1IO01550
1B17   EQU     1DEC                                                     1IO01560
L(0)D  PZE     0,,L(0)                                                  1IO01570
DECRE  PZE     0,,-1                                                    1IO01580
1PRE   PON                                                              1IO01590
FOR    FOR                                                              1IO01600
2PRE   TIX     0,0,0                                                    1IO01610
SIX    SIX                                                              1IO01620
6PRE   EQU     SIX                                                      1IO01630
       IFT     NOCHX=0                                               $5$1IO01631
       GOTO    7PRE                                                  $5$1IO01632
L(6)   PZE     6                                                        1IO01640
L(22)  PZE     22                                                       1IO01650
L(40)  PZE     40                                                      $1IO01660
BVDG   OCT     020100000000                                             1IO01670
DEC15  OCT     000017000000                                             1IO01680
L(4)   PZE     4                                                        1IO01690
L(2)   PZE     2                                                        1IO01700
7PRE   SVN                                                              1IO01720
B1FIN  BSS     0                                                        1IO01730
       TTL     IOBS SECTION OF IOCS                                     1IO01740
       SPACE   1                                                        1IO01750
*                      I O B S SECTION OF I O C S                       1IO01760
*                      B U F F E R I N G  R O U T I N E S               1IO01770
*                        INDICATOR ASSIGNMENTS                          1IO01780
       SPACE   1                                                        1IO01790
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $1IO01800
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $1IO01810
CP2    BOOL    100000              ARE 00,01,10                        $1IO01820
OPEND  BOOL    40000               IF=1 FILE OPEN                       1IO01830
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               1IO01840
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              1IO01850
MODE   BOOL    04000               IF=1 BINARY FILE                     1IO01860
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             1IO01870
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 1IO01880
LABEL  BOOL    00400               IF=1 LABELS                          1IO01890
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                1IO01900
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       1IO01910
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               1IO01920
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              1IO01930
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        1IO01940
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                1IO01950
NOEOT  BOOL    00004               IF=1 NO EOT                          1IO01960
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            1IO01970
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                1IO01980
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           1IO01990
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          1IO02000
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $1IO02010
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  1IO02020
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  1IO02030
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            1IO02040
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    1IO02050
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    1IO02060
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             1IO02070
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  1IO02080
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       1IO02090
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               1IO02100
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        1IO02110
STSH   BOOL    00100               IF =1 STASH ROUTINE                  1IO02120
CPYFN  BOOL    00040               IF =1 COPY MODE                      1IO02130
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         1IO02140
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  1IO02150
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    1IO02160
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    1IO02170
IOSY   BOOL    00004               IF=1, IOSY WRITE                     1IO02180
NORUN  BOOL    00002               IF=1 NO REW UNLD                     1IO02190
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 1IO02200
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          1IO02210
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $1IO02220
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               1IO02230
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        1IO02240
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     1IO02250
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 1IO02260
CDBTS  BOOL    24000               DISCN+EOB                            1IO02270
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     1IO02280
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        1IO02290
OUTPUT BOOL    03000               PTO+TTO                              1IO02300
OPDET  BOOL    40002               OPEND+DETACH                         1IO02310
RESOP  BOOL    60000               RESER+OPEND                          1IO02320
OPNEOT BOOL    40004               OPEND+NOEOT                          1IO02330
RANDG  BOOL    00030               RUSH+GIVUP                           1IO02340
EOBITS BOOL    44400               DONLY+EOB+HOLD                       1IO02350
DIGEN  BOOL    30000               DISCN+GENER                          1IO02360
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     1IO02370
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       1IO02380
NOREOF BOOL    00003               NORED + NOEOF                        1IO02390
RBITS  BOOL    00011               RUSH + RHIST                        $1IO02400
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 1IO02410
NETIH  BOOL    10004               NO EOT+NINHIB                        1IO02420
REWNUN BOOL    00006               NORUN + NOREW                       $1IO02430
*                  CONSTANTS AND MASKS FOR INDICATORS                   1IO02440
       SPACE   1                                                        1IO02450
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              1IO02460
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  1IO02470
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              1IO02480
NOTIN  SVN     -1,7,-1-NINHIB                                           1IO02490
EOTBT  SVN     -1,7,-1-NOEOT                                            1IO02500
NEOTBT PZE     0,,NOEOT                                                 1IO02510
MODBT  PZE     0,0,MODE                                                 1IO02520
       TTL     COMMON ENTRY TO ALL JOBS ROUTINES                        1IO02530
*      SAVES   1. SENSE INDICATORS AND ALL INDEX REGISTERS              1IO02540
*              2.L(ENTRY) TO ROUTINE (I.E. L(TSX))                      1IO02550
*              3.L(TSX+2)                                               1IO02560
*              4.PLACES IN CELL -FCW- AND IN IR2 COMPLEMENTED           1IO02570
*                 A.L(POOL) FOR DEFINE,JOIN AND ATTACH                  1IO02580
*                 B.L(FILE) FOR ALL OTHER IOCS ROUTINES                 1IO02590
*              5.PLACES IN CELL-XEOB-                                   1IO02600
*                 A.EOB EXIT FOR READ AND WRITE                         1IO02610
*                 B.L(POOL2) FOR JOIN                                   1IO02620
*                 C.L(FILE2) FOR COPY AND STASH                         1IO02630
*              6.PLACES FILE CONTROL BITS IN SI                         1IO02640
       SPACE   1                                                        1IO02650
ENTRY  STI     SENSE                                                    1IO02660
       SXA     LTSX,4              SAVE L(ENTRY)                       $1IO02670
       TXI     *+1,4,-2                                                 1IO02680
       SXA     GTIOX,4             SAVE L(TSX)+2                        1IO02690
       SXA     IRS,2               SAVE IR2                             1IO02700
       SXD     IRS,1               SAVE IR1                             1IO02710
ROUTE  LXD     **,1                FIND L(ROUTINE)                     $1IO02720
       SXA     GO,1                WHICH WAS CALLED                    $1IO02730
       STZ     TCHEX               CLEAR TCH SWITCH                    $1IO02740
       CAL     -1,4                SAVE IN-LFCW-AND IR2(COMPLEMENTED)  $1IO02750
       ENB     L(0)                THE FOLLOWING DISABLING TRAPS        1IO02760
       STA     FCW                 L(BPC) FOR DEFINE,JOIN AND ATTACH    1IO02770
       PAC     0,2                 L(FCW) FOR READ,WRITE,COPY,REW,      1IO02780
       STD     XEOB                WEF,OPEN AND CLOSE                   1IO02790
       IFT     NOCH=0                                                $5$1IO02791
       GOTO    GO1                                                   $5$1IO02792
       ZET     DERR                TEST FOR ANY DISK ERROR             $1IO02800
       TSX     STOPA,4             HAS BEEN A DISK ERROR               $1IO02810
       LDI     6,2                 TEST FOR END OF TRACK + EOB EXIT    $1IO02820
       RNT     700000                                                  $1IO02830
       TRA     *+2            NO                                       $1IO02840
       TXH     ENDTRK,1,ATTCH.                                          1IO02850
GO1    LDI     1,2                 FILE INDICATORS TO SI             $5$1IO02870
       RIR     77777                                                   $1IO02880
       ENB     .TRAPS              ALLOW TRAPS (FILE BITS IN SI)     $5$1IO02890
       TXL     GO,1,OPEN.          IF REFERENCE TO A FILE               1IO02900
       LFT     NOEOT               AND EOT OR NON-LABELED EOF           1IO02910
GO     TTR     **                  GO TO ROUTINE CALLED                 1IO02920
       LFT     OUTPUT              IS FILE INPUT                        1IO02930
       TRA     ENT2                OR OUTPUT                            1IO02940
       TSX     SWITCH,1            IF EOF NON LABELED FILE AGAIN        1IO02950
ENT1   SIL     NOEOT               REFERENCED,SWITCH REELS AND          1IO02960
       TRA*    GO                  GO.......                            1IO02970
ENT2   TSX     EOTOF,1             HANDLE EOT                           1IO02980
       TRA     ENT1                TURN OFF EOT AND CONTINUE            1IO02990
       IFT     NOCHX=0                                               $5$1IO02991
       GOTO    NOPXIT                                                $5$1IO02992
STOPA  CLA     DERR                SAVE + ZERO OUT                     $1IO03000
       STZ     DERR                THE DISK ERROR                      $1IO03010
       STR                         SWITCH                            $5$1IO03020
       TTL     COMMON. EXIT ROUTINE - COMXIT-                           1IO03040
*                              TRA COMXIT                               1IO03050
*                          NO RETURN POSSIBLE                           1IO03060
*                        THIS ROUTINE RESTORES                          1IO03070
*              1.IR2,IR1,SI                                             1IO03080
*              2. FILE CONTROL BITS TO FILE WORDS                       1IO03090
*         AND PLACES HISTORY IN THE AC                                  1IO03100
       SPACE   1                                                        1IO03110
NOPXIT SXD     LTRAD,4             SAVE LAST WD WORKED ON               1IO03120
       TSX     FEEIT,1                                                 $1IO03130
COMXIT ENB     L(0)                DISABLE TRAPS                        1IO03140
       PIA                         RESTORE CONTROL                      1IO03150
       STD     1,2                 BITS TO FILE                         1IO03160
       SXA     FCW,0               SET IOBS SWITCH =0                   1IO03170
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO03180
EX23   CLA     LTRAD               HISTORY TO AC                        1IO03190
EX24   LXA     GTIOX,4             IF TCH OCCURRED                      1IO03200
       ZET     TCHEX               EXIT AT L(1ST TCH) +1                1IO03210
       LXA     TCHEX,4             ELSE AT NORMAL EXIT                  1IO03220
EX34   LXA     IRS,2               RESTORE IR2                          1IO03230
       LXD     IRS,1                                                    1IO03240
       LDI     SENSE               RESTORE SI                           1IO03250
       TTR     0,4                 RETURN TO USER                       1IO03260
       TTL     DEFINE A. BUFFER POOL                                    1IO03270
*      CALLING SEQUENCE                                                 1IO03280
*              TSX  DEFINE,4                                            1IO03290
*              PZE  L(POOL)                                             1IO03300
*              PZE  N,,EFF BUF SIZE                                     1IO03310
*              RETURN                                                   1IO03320
*                                WHERE                                  1IO03330
*                  L(POOL) = LOCATION OF BUFFER POOL                    1IO03340
*                  N= NUMBER OF BUFFERS TO BE FORMED                    1IO03350
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            1IO03360
*      COMMENTS-                                                        1IO03370
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   1IO03380
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   1IO03390
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                1IO03400
       SPACE   1                                                        1IO03410
DEFIN. CLS     -1,4                SAVE                                 1IO03420
       ACL     L(1)                L(POOL+1)                            1IO03430
       STA     DE1                                                      1IO03440
       ACL     L(1)                SET LOCATION                         1IO03450
       STA     DE3                 OF 1ST BUFFER                        1IO03460
       STO*    FCW                 SET BPC= FOR BUF1,,0                 1IO03470
       CAL     0,4                 SET SECOND WORD                      1IO03480
       ANA     DECRE               OF POOL =                            1IO03490
       LGL     4                   S-13= BUF. SIZE                      1IO03500
DE1    SLW     **                  14-35 = 0                            1IO03510
       CLA     0,4                 SET IORT                             1IO03520
       STD     FCW                 =IORT POOL,,SIZE                     1IO03530
       PDX     0,1                 PLACE SIZE+2                         1IO03540
       TXI     *+1,1,2             INTO IR1                             1IO03550
       PAX     0,2                 NUMBER OF BUFFERS                    1IO03560
       ALS     18                  TO IR2                               1IO03570
       STD*    FCW                 AND POOL                             1IO03580
       CLA     DE3                 GO SETUP                             1IO03590
       ACL     L(1)                CHAIN MECHANISM                      1IO03600
       STA     DE4                                                      1IO03610
DE2    CLA     FCW                 CHAIN BUFFER POOL                    1IO03620
DE3    STZ     **                  1ST BUFFER CONTROL WORD              1IO03630
       STA*    *-1                 = 0 00000 0 CHAIN                    1IO03640
DE4    STO     **                  2ND= IORT BPC,,SIZE                  1IO03650
       TNX     DE6,2,1             TEST IF N FORMED                     1IO03660
       PXA     0,1                 CHAIN LAST                           1IO03670
       ACL     DE3                 BUF TO NEXT                          1IO03680
       STA*    DE3                 FINAL BUFFER IS                      1IO03690
       STA     DE3                 CHAINED TO BPC                       1IO03700
       TRA     DE2-2                                                    1IO03710
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              1IO03720
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         1IO03730
       TXI     EX34,4,-1           EXIT AT 3,4                          1IO03740
*                           JOIN ENTRY POINT                            1IO03750
*         PLACED HERE FOR L(ENTRY) CHECK IN EOT CHECK SUPPRESS          1IO03760
JOINX  TRA     JOIN.               GO TO JOIN                           1IO03770
       TTL     ATTACH ROUTINE                                           1IO03780
*                          CALLING SEQUENCES                            1IO03790
       SPACE   1                                                        1IO03800
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 1IO03810
*              PZE  POOL            TO SPECIFIED POOL                   1IO03820
*              PZE  LIST,,FILECT                                        1IO03830
*                             RESTRICTIONS                              1IO03840
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        1IO03850
*                  IN ONE ATTACH CALLING SEQUENCE                       1IO03860
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       1IO03870
       SPACE   1                                                        1IO03880
*                            ATTACH ROUTINE                             1IO03890
ATTCH. STA     LBC                 SAVE L(POOL)                         1IO03900
       PXA     0,0                 SET OUTPUT CHAIN = 0                 1IO03910
       STA     1,2                 IF POOL HAS BEEN                     1IO03920
       CLA     0,4                 FOR SUBROUTINE                       1IO03930
       TXI     *+1,4,-1            ADVANCE EXIT FOR XTRA WORD           1IO03940
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       1IO03950
       SXA     GTIOX,4             SAVE L(EXIT)                         1IO03960
       TRA     CA3+2               EXAMINE LIST                         1IO03970
CA3    CLA     CA51                ADVANCE IN LIST                      1IO03980
       ACL     L(1)                STARTS AT L(LIST)-1                  1IO03990
       STA     CA51                IN LIST LOCATOR                      1IO04000
       ENB     L(0)                TRAP PROTECT                         1IO04010
CA51   CAL     **                  WHILE ADJUSTING                      1IO04020
       PAC     0,2                 COUNTS                               1IO04030
       STA     FCW                 IN FCW CELL                          1IO04040
       PAI                         FOR CHECK OF SIX OR SUN WORD         1IO04050
       CLA*    CA51                PICK UP LIST ENTRY                   1IO04060
       LNT     600000              SIX OR SUN                           1IO04070
       TRA     CA6                 NO--PZE                              1IO04080
       SXD     CA4,2               STORE FILECT FOR REDUCING BUFCT.     1IO04090
       PDX     0,1                 REDUCE                              $1IO04100
       PDX     0,4                 THE                                 $1IO04110
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             1IO04120
       PXD     0,4                 THAT THE SPECIFIED NUMBER            1IO04130
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        1IO04140
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        1IO04150
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   1IO04160
CA5    PXD     **,1                REDUCE IBACT BY                      1IO04170
       ADD*    LBC                 SUBTRACTING BUFFER COUNT             1IO04180
       STD*    LBC                 USED BY THIS GROUP                   1IO04190
       TRA     CA3                 PROCESS FILE LIST                    1IO04200
*                        FILE HANDLER (ATTACH)                          1IO04210
       SPACE   1                                                        1IO04220
CA6    LDI     1,2                 GET FCB BIT AND MAKE                 1IO04230
       SIL     RESER               FILE A RESERVE FILE                  1IO04240
       CAL     CA5                 PLACE L(SVN WORD)                    1IO04250
       STA     3,2                 IN FCB                               1IO04260
       CLA     LBC                 PLACE L(POOL) IN                     1IO04270
       STA     2,2                 FILE CONTROL WORDS                   1IO04280
       ALS     18                  2ND WORD ADDRESS AND                 1IO04290
       STD     4,2                 5TH WORD DECREMENT                   1IO04300
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO04310
       PIA                         PLACE CONTROL BITS                   1IO04320
       STD     1,2                 IN FILE                              1IO04330
CA25   LXD     CA26,1              ADVANCE                              1IO04340
       TNX     COMXIT+3,1,1        ALONG FILE LIST                      1IO04350
       SXD     CA26,1              AS LONG AS MORE FILES                1IO04360
CA26   TXL     CA3,0,**                                                 1IO04370
       TTL     DE-ACTIVATE AND CLOSE FILE                               1IO04380
CLOSE. ARS     33                                                       1IO04390
       OAI                                                              1IO04400
       LFT     DETACH                                                   1IO04410
       TRA     COMXIT                                                   1IO04420
       TSX     FNLBC,4             FIND POOL                            1IO04430
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     1IO04440
       LNT     RESOP               IF CLOSING AN OPEN                   1IO04450
       TRA     *+4                 RESERVE FILE                         1IO04460
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   1IO04470
       ACL     L(1)                ALLOWING ANOTHER FILE                1IO04480
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      1IO04490
       CLA     3,2                 HANDEL INTERNAL                      1IO04500
       TMI     INTCL               FILE SEPARATELY                      1IO04510
       LNT     OPEND               IF FILE NEVER                        1IO04520
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $1IO04530
       LFT     OUTPUT              INPUT OR                             1IO04540
       TRA     SH5                 OUTPUT FILE                          1IO04550
       SPACE   1                                                        1IO04560
*                           CLOSE INPUT FILE                            1IO04570
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  1IO04580
SH2    NULL                                                          $5$1IO04581
       IFT     NOCH=0                                                $5$1IO04582
       GOTO    SH4                                                   $5$1IO04583
       CAL     0,2                 MAKE SURE EOF                     $5$1IO04590
       ANA     FOR                 FLAG IS OFF                         $1IO04600
       STP     0,2                                                     $1IO04610
SH4    NULL                                                          $5$1IO04621
       IFT     NOHYP=0                                               $5$1IO04622
       GOTO    SH6                                                   $5$1IO04623
       CLA     5,2                 CHECK FOR HYPER                   $5$1IO04630
       ANA     SIX                                                     $1IO04640
       TNZ     SH1                 729 OR DISK                          1IO04650
       RNT     REWNUN                                                  $1IO04660
       TRA     SH6                 RETURN                              $1IO04670
       RIR     REWNUN              TAKE OUT HYPER OPTION               $1IO04680
       TRA     SH6                 RETURN                              $1IO04690
SH1    RNT     5                                                        1IO04700
       TRA     *+3                                                      1IO04710
       RNT     2                                                        1IO04720
       TRA     *+5                                                      1IO04730
       RNT     NOEOFM                                                   1IO04740
       TRA     *+3                 NO                                  $1IO04750
       TSX     .NDSEL+1,4          YES                               $5$1IO04760
       PZE     0,2,HFPNP           FILE PROTECT                        $1IO04770
       RNT     REWNUN              TEST FOR UNLOAD                     $1IO04780
       TRA     SH6                 NO                                  $1IO04790
       TSX     .NDSEL+1,4          YES                               $5$1IO04800
       PZE     0,2,HUNLP           UNLOAD                              $1IO04810
       TRA     SH4.1-1             EXIT                                 1IO04820
SH6    RFT     NOREW               IF NO REWIND                         1IO04840
       TRA     SH4.1               SPECIFIED SKIP OUT                   1IO04850
       CAL     3DEC                FORM REW CODE (=3)                   1IO04860
       RNT     NORUN               OR REW UNLOAD                        1IO04870
       ACL     1DEC                CODE (=4)                            1IO04880
       STD     *+2                                                      1IO04890
       TSX     NDSEL+1,4           ISSUE REW                            1IO04900
       PZE     0,2,**              OR RUN                               1IO04910
       RFT     REWNUN              IF REWOUND AND                      $1IO04920
       TRA     SH4.1               UNLOADED                             1IO04930
       SIL     DETACH              PRINT MESSAGE                        1IO04940
SH4.1  RIL     OPEND               RESET OPEN BIT                       1IO04950
       TRA     COMXIT              EXIT                                 1IO04960
       SPACE   1                                                        1IO04970
*                          CLOSE OUTPUT FILE                            1IO04980
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            1IO04990
       RNT     000005              CHECK FOR HYPER OPTIONS             $1IO05000
       TRA     *+3                 NOT MON OPTION                      $1IO05010
       RNT     NORUN               IF TRUE MON OPTION                  $1IO05020
       TRA     SH3                 SKIP EOF AND LABEL WRITES            1IO05030
       TSX     NDSEL+1,4           WRITE                                1IO05040
       PZE     0,2,WEFOP           EOF                                  1IO05050
       NOP                         IGNORE EOT                           1IO05060
SH3    LAC     LBC,4               L(POOL) TO IR4                       1IO05070
       SXD     SH33,2              REMOVE FILE FROM                     1IO05080
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              1IO05090
       PAX     0,1                 FILE THAT REFERENCES CLOSING         1IO05100
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           1IO05110
       TXL     SH34,1,0            FOUND.                               1IO05120
       PAC     0,4                 NOT FOUND. ADVANCE                   1IO05130
       TRA     SH32                ALONG CHAIN.                         1IO05140
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           1IO05150
       STA     1,4                 REFERENCED CLOSING FILE              1IO05160
       RNT     000005              IS THIS CLOSE                       $1IO05170
       TRA     *+3                 A TRUE MON OPTION                   $1IO05180
       RNT     NORUN                                                   $1IO05190
       TRA     SH4.1               YES,POST AND RETURN                 $1IO05200
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $1IO05210
       TTL                         OPEN ROUTINE                         1IO05220
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              1IO05230
       SPACE   1                                                        1IO05240
*                           CALLING SEQUENCE                            1IO05250
*              TSX OPEN,4                                               1IO05260
*               P  FILE,,1                                              1IO05270
*      WHERE                                                            1IO05280
*              P= PZE REWIND BEFORE OPEN                                1IO05290
*              P= MZE NO REWIND                                         1IO05300
*              P= MON NO REWIND, NO LABELS                              1IO05310
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  1IO05320
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           1IO05330
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE 1IO05340
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     1IO05350
*      ACTIONS ....                                                     1IO05360
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      1IO05370
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             1IO05380
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                1IO05390
       SPACE   1                                                        1IO05400
OPEN.  LFT     OPEND               IF FILE OPEN                         1IO05410
       TRA     OP1                 GO HOME                              1IO05420
       SIL     NETIH               SET NO INHIBIT BIT                   1IO05430
       CLA*    3,2                 SURE THAT NO MORE                    1IO05440
       PAX     0,1                 THAN THE SPECIFIED                   1IO05450
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  1IO05460
       TXH     SY9.3,1,4096        OPEN AT SAME TIME                    1IO05470
       PXA     0,1                                                      1IO05480
       STA*    3,2                                                      1IO05490
       CLA     3,2                 OPEN INTRENAL FILE                   1IO05500
       TMI     INTOP               HANDLED SEPARATELY                   1IO05510
       CLA     OP6                 MAKE SURE THAT                       1IO05520
       STT     0,2                 IMEDIATE MOUNT FLAG IS ON            1IO05530
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $1IO05540
       STA     4,2                 = L(0)                               1IO05550
       TSX     .NDSEL,4            TEST LEGALITY                     $5$1IO05560
2TAG   PZE     0,2,TESTP           OF UNIT                              1IO05570
       TSX     DENSE,4             SET FILE DENSITY                     1IO05580
       LXA     GTIOX,4                                                  1IO05590
       CLA     -1,4                                                     1IO05600
       TMI     OP4                 NO REW                               1IO05610
       TSX     NDSEL+1,4           REWIND BEFORE                        1IO05620
       PZE     0,2,REWOP           OPEN                                 1IO05630
OP4    NULL                                                          $5$1IO05631
       IFT     NOHYP=0                                               $5$1IO05632
       GOTO    OP6                                                   $5$1IO05633
       CLA     5,2                                                   $5$1IO05640
       ANA     SIX                                                      1IO05650
       TNZ     OP7.1               YES                                  1IO05660
       TRA     OP7.3                                                    1IO05670
       SPACE   1                                                        1IO05690
*                           OPEN INPUT FILE                             1IO05700
OP6    TSX     FNLBC,4             FIND L(POOL)                         1IO05710
       LFT     OUTPUT                                                   1IO05720
       TRA     OP9                                                      1IO05730
       PXD     0,0                 CLEAR BUFFER COUNT                   1IO05740
       STA     1,2                 IN FCB.                              1IO05750
       TSX     BORBF,1             INITIATE READ                        1IO05760
LBC    NOP                         IF POSSIBLE ... L(POOL)...           1IO05770
OP1    SIL     OPNEOT              SET OPEN AND NO EOT BITS             1IO05780
       TRA     COMXIT              EXIT TO USER                         1IO05790
OP9    LAC     LBC,4               L (POOL) TO IR4                      1IO05800
       CLA     1,4                 PLACE OUTPUT                         1IO05810
       STA     1,2                 FILE IN SYNCING                      1IO05820
       CLA     FCW                 CHAIN USED TO                        1IO05830
       STA     1,4                 RELEASED TO THE                      1IO05840
       TRA     OP1                 BUFFER POOL                          1IO05850
3DEC   PZE     ,,3                                                 IBJOB1IO05860
       SPACE   1                                                        1IO05870
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $1IO05880
       IFT     NOHYP=0                                               $5$1IO05881
       GOTO    READ.                                                 $5$1IO05882
OP7.1  RIR     MXDMD               RESET BACKWARD READ                 $1IO05890
       PIA                                                             $1IO05900
       STT     1,2                                                     $1IO05910
       LFT     OUTPUT              IF OUTPUT                           $1IO05920
       TRA     OP6                 ALL DONE                             1IO05930
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $1IO05940
       TXL     OP7.2,4,0           NO                                  $1IO05950
       ORA     *-1                 SET READ                            $1IO05960
       STT     1,2                 BACKWARD                            $1IO05970
       AXC     2,4                                                     $1IO05980
       CLA*    0,2                                                     $1IO05990
       ANA     ADDRS               IF NEXT READ IS NOT A               $1IO06000
       TNZ     OP7.2               FILE MARK THEN PROCEED              $1IO06010
       TSX     .NDSEL+1,4          ELSE BACKSPACE FILE               $5$1IO06020
       PZE     0,2,HBSFP                                               $1IO06030
OP7.2  LXA     GTIOX,4                                                  1IO06040
       CLA     -1,4                TEST FOR THE                        $1IO06050
       ANA     SIX                 SETTING OF FILE PROTECT             $1IO06060
       TZE     *+3                 NO                                  $1IO06070
       TSX     .NDSEL+1,4                                            $5$1IO06080
       PZE     0,2,HFPNP           FILE PROTECT                        $1IO06090
       TRA     OP6                                                      1IO06100
OP7.3  LFT     OUTPUT                                                  $1IO06110
       TRA     OP6                                                      1IO06120
       LXD     XEOB,4              IF READ                             $1IO06130
       TXL     OP6,4,0             BACKWARD                             1IO06140
       TSX     NDSEL+1,4           REWIND 729                          $1IO06150
       PZE     0,2,REWOP           OR DISK INPUT                       $1IO06160
       TRA     OP6                                                      1IO06170
       TTL                         BUFFERED READ ROUTINE                1IO06190
*              TSX  READ,4              BUFFERED READ                   1IO06200
*              PZE  FILE,,EOB           END OF BLOCK                    1IO06210
*              PZE  EOF,,ERR              END OF FILE AND               1IO06220
*                   *                     ERROR EXITS                   1IO06230
*                   *                                                   1IO06240
*                  IO-LIST                                              1IO06250
*                   *                                                   1IO06260
*              RETURN                                                   1IO06270
       SPACE   1                                                        1IO06280
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                1IO06290
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               1IO06300
*                              IS GIVEN.                                1IO06310
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   1IO06320
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      1IO06330
*                            BUFFER AREA ATTACHED TO THE FILE           1IO06340
       SPACE   1                                                        1IO06350
READ.  SIR     RDSWIT              SET READ SWITCH                     $1IO06360
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    1IO06370
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             1IO06380
       CLA     -1,4                SAVE MODAL EXITS                     1IO06390
       STA     XEOF                END OF FILE                          1IO06400
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     1IO06410
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     1IO06420
       TRA     EOFER               TAKE END OF FILE EXIT                1IO06430
       TSX     FNLBC,4             FIND L(POOL)                         1IO06440
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      1IO06450
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             1IO06460
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       1IO06470
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 1IO06480
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     1IO06490
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     1IO06500
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           1IO06510
       PZE     TRM1                3.TRANSMIT FROM                      1IO06520
       PZE     TRM2                BUFFER TO WORKING STORAGE            1IO06530
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   1IO06540
       TTL                         BUFFERED WRITE ROUTINE               1IO06550
*              TSX WRITE,4              BUFFERED WRITE                  1IO06560
*              PZE  FILE,,EOB            END OF BLOCK EXIT              1IO06570
*                    *                                                  1IO06580
*                    *                                                  1IO06590
*                  IO-LIST                                              1IO06600
*                   *                                                   1IO06610
*              RETURN                                                   1IO06620
       SPACE   1                                                        1IO06630
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                1IO06640
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               1IO06650
*                              IS GIVEN.                                1IO06660
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  1IO06670
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      1IO06680
*                            BUFFER AREA ATTACHED TO THE FILE           1IO06690
       SPACE   1                                                        1IO06700
WRITE. LNT     OPEND               IF FILE NOT OPEN                     1IO06710
       TRA     NOPXIT              DO NOTHING EXIT                      1IO06720
       TSX     FNLBC,4             FIND L(POOL)                         1IO06730
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    1IO06740
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    1IO06750
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   1IO06760
       PZE     TRM2                3.TRANSMIT FROM                      1IO06770
       PZE     TRM1                WORKING STORAGE TO BUFFER            1IO06780
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  1IO06790
       SPACE   2                                                        1IO06800
*                  FIND L(BPC) FROM FILE CONTROL WORD                   1IO06810
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            1IO06820
FNLBC  CLA     4,2                                                      1IO06830
       PDX     0,1                                                      1IO06840
       SXA     LBC,1                                                    1IO06850
       TRA     1,4                                                      1IO06860
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         1IO06870
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          1IO06880
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    1IO06890
       SPACE   1                                                        1IO06900
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            1IO06910
*                          IR4 MUST= -L(POOL)                           1IO06920
       SPACE   1                                                        1IO06930
TOKBB  ENB     L(0)                TRAP PROTECT                         1IO06940
TOKBF  SXA     TK3,4               SAVE IR4                             1IO06950
       CLA*    3,2                 COUNT AND IF IT                      1IO06960
       PDX     0,1                 GOES NEGATIVE THEN                   1IO06970
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  1IO06980
       TXL     TK2,1,4096                                               1IO06990
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               1IO07000
       PDX     0,4                 IMMEDIATE FILES                      1IO07010
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              1IO07020
       SUB     1DEC                                                     1IO07030
       STD*    LBC                                                      1IO07040
TK2    PXD     0,1                 RESTORE RESERVE                      1IO07050
       STD*    3,2                 FILE                                 1IO07060
TK3    AXT     **,4                RESTORE IR4                          1IO07070
       TRA     2,4                 EXIT                                 1IO07080
TK4    LXA     TK3,4               TAKE ERROR EXIT                      1IO07090
       TRA     1,4                                                      1IO07100
       SPACE   1                                                        1IO07110
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            1IO07120
       SPACE   1                                                        1IO07130
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      1IO07140
BCKBF  SXA     BK2,1                                                    1IO07150
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       1IO07160
       PDX     0,1                                                      1IO07170
       ACL     1DEC                                                     1IO07180
       STD*    3,2                                                      1IO07190
       TXL     BK2,1,4096          IF NEGATIVE INCREMENT                1IO07200
BK1    CAL     0,4                 POOL CT ALSO                         1IO07210
       ADD     1DEC                                                     1IO07220
       STD     0,4                                                      1IO07230
BK2    AXT     **,1                                                     1IO07240
       TRA     1,1                 EXIT                                 1IO07250
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    1IO07260
*                    HANDLES EOB,EOF,AND URR EXITS                      1IO07270
       SPACE   1                                                        1IO07280
EOFER  CLA     0,4                 END OF FILE                          1IO07290
       ANA     1PRE                EXIT INPUT FILE                      1IO07300
       RIL     100000              NOT OPEN                             1IO07310
       OAI                         PLACE 1ST COMMAND IN SI              1IO07320
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   1IO07330
       SXA     GTIOX,4             COMMAND                              1IO07340
       TRA     EOF.0               TAKE EOF EXIT                        1IO07350
EOFEX  LFT     MULTI               MULTI-REEL                           1IO07360
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            1IO07370
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   1IO07380
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         1IO07390
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     1IO07400
EOF.1  SXA     TCHEX,4                                                  1IO07410
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             1IO07420
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     1IO07430
       LDQ     LTSX                LOAD EXIT HISTORY                    1IO07440
       RQL     18                                                      $1IO07450
       TRA     COMXIT              EXIT                                 1IO07460
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         1IO07470
ERREX  ARS     18                  CODE IN                             $1IO07480
       STT     LTSX                TAG OF HISTORY                      $1IO07490
       CLA*    2,2                 MAKE HISTORY                        $1IO07500
       STA     LTRAD               REFLECT THIS OP.                    $1IO07510
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                1IO07520
       LDC     XERR,4              ERROR EXITS                          1IO07530
       TRA     EOF.1                                                    1IO07540
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        1IO07550
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          1IO07560
       TRA     EOF.1                                                    1IO07570
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  1IO07580
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        1IO07590
       SXD     LTRAD,4             INTO HISTORY                         1IO07600
       ZET     TCHEX               HAS A TCH OCCURRED                   1IO07610
       TRA     TCHOC               YES-                                 1IO07620
       LFT     100000              NO-IS THIS OP AN IOXT                1IO07630
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            1IO07640
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          1IO07650
FEEIT  TXI     *+1,4,-1            NO-                                 $1IO07660
       CAL     -1,4                SEARCH                               1IO07670
       LGR     34                  FOR                                  1IO07680
       TZE     *+2                 EXIT                                 1IO07690
       TQP     *-4                                                      1IO07700
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  1IO07710
       TRA     *+2                                                      1IO07720
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  1IO07730
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $1IO07740
       TRA     1,1                 RETURN                               1IO07750
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       1IO07760
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  1IO07770
*                        MASTER CONTROL ROUTINE                         1IO07780
*                          FOR READ AND WRITE                           1IO07790
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   1IO07800
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         1IO07810
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            1IO07820
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              1IO07830
*              PRE TRM2 OR TRM1        TRANSMITTING                     1IO07840
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     1IO07850
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            1IO07860
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        1IO07870
*              XEC  N,4                                                 1IO07880
       SPACE   1                                                        1IO07890
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          1IO07900
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         1IO07910
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              1IO07920
       ANA     7PRE                SHOULD BE DISCONNECTED              $1IO07930
       TZE     GTIOX-1             NONE ATTACHED                        1IO07940
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   1IO07950
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     1IO07960
*                         GET NEXT IO COMMAND                           1IO07970
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          1IO07980
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              1IO07990
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        1IO08000
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  1IO08010
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             1IO08020
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    1IO08030
       SPACE   1                                                        1IO08040
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           1IO08050
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         1IO08060
       TXI     *+1,1,-1            SETUP L(NEXT)                        1IO08070
       SXA     GTIOX,1             IOXY                                 1IO08080
       CAL     -1,1                THIS IO COMMAND TO AC                1IO08090
       STA     TRANS               SAVE TRANSMIT LOC                    1IO08100
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       1IO08110
       STD     WDCT                SAVE WORD COUNT                      1IO08120
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   1IO08130
       ANA     IOOP                AND NOT DISTURBING FILE              1IO08140
       OAI                         CONDITION OR HISTORY BITS           $1IO08150
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              1IO08160
       LFT     600000              SEPARATE TCH AND IOCD                1IO08170
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  1IO08180
       LFT     100000              IOCD OR TCH COMMAND                  1IO08190
       TRA     TCH                 TCH                                  1IO08200
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  1IO08210
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     1IO08220
       TRA     RW0                 NO                                   1IO08230
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   1IO08240
       CLA*    TRANS                                                    1IO08250
       STA     TRANS                                                    1IO08260
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   1IO08270
RW0    NZT     WDCT                IF WORD COUNT IS                     1IO08280
       LFT     200000              ZERO ON IOCY                         1IO08290
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           1IO08300
       TRA     RW8                                                      1IO08310
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD 1IO08320
       TMI     RW1.4               NO BUFFER CONNECTED TO FILE          1IO08330
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                1IO08340
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        1IO08350
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        1IO08360
       TNZ     RW2.1               IF SOME WORDS ARE                    1IO08370
       PDX     0,1                 AVAILABLE AND COMMAND IS             1IO08380
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    1IO08390
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    1IO08400
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        1IO08410
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     1IO08420
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            1IO08430
*                       COUNT CONTROL EXECUTION                         1IO08440
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  1IO08450
       SIR     GENER               SET GENERATED DISCONNECT             1IO08460
       XEC     1,4                 DISCONNECT                           1IO08470
       RIR     GENER               RESET GENER BIT                      1IO08480
       TRA     RW1.4               AND GO ATTACH NEXT ONE               1IO08490
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              1IO08500
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   1IO08510
       TPL     RW5                 IS BUFFER OVERFLOWED                 1IO08520
       STD     DUMMY               YES- SAVE NUMBER OFF                 1IO08530
       LNT     200000              UNLESS COMMAND IS IOSY               1IO08540
       SIR     GENER               SET BIT FOR GENERATED COMMAND        1IO08550
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                1IO08560
RW4    STD     WDCT                ON THIS BUFFER                       1IO08570
       PXA     0,0                 SET ZERO REMAINING WORDS             1IO08580
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                1IO08590
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   1IO08600
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $1IO08610
       STD*    2,2                 TO ADJUST LOCATOR                    1IO08620
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   1IO08630
       RNT     200000              IF IOXYN **,,CT                      1IO08640
       TRA     RW6                 OR IOXYN* ADDR,,CT                   1IO08650
       CLA     TRANS               THEN PLACE L(WORDS)                  1IO08660
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $1IO08670
       STA     0,1                 RESPECTIVELY                         1IO08680
       SIR     XECNT               INDICATE IOXYN EXECUTED              1IO08690
RW6    LXD     WDCT,1              FORM FIRST                           1IO08700
       PXA     0,1                 TRANSMIT                             1IO08710
       ACL*    2,2                 ADDRESS                              1IO08720
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $1IO08730
       STA*    2,2                 ADJUST LOCATOR                       1IO08740
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           1IO08750
       PXA     0,1                 COMPUTE                              1IO08760
       ACL     TRANS               SECOND TRANSMIT ADDRESS              1IO08770
       STA*    4,4                 AND STORE IT                         1IO08780
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        1IO08790
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            1IO08800
       RFT     200000              IF NON-TRANSMITTING                  1IO08810
       TRA     RW8                 SKIP OVER MOVES                      1IO08820
       LXD     WDCT,1              WDCT TO IR1                          1IO08830
TRM1   CAL     **,1                TRANSMIT                             1IO08840
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                1IO08850
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               1IO08860
*                         TERMINATE IO COMMAND                          1IO08870
RW8    NZT     XEOB                IF USER NOT LOCATING                 1IO08880
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        1IO08890
       RNT     EOB                 IF EOB DID NOT OCCUR                 1IO08900
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   1IO08910
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       1IO08920
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            1IO08930
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       1IO08940
       TRA     RW13                YES                                  1IO08950
RW10   LNT     100000              IS COMMAND                           1IO08960
       TRA     GTIOX               IOXP OR IOXT                         1IO08970
RW12   RFT     HELD                IF A HOLD OCCURRED                   1IO08980
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      1IO08990
       RFT     RDSWIT              IF READING EXECUTE                   1IO09000
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   1IO09010
       RFT     EOBXIT              EXIT AT                              1IO09020
       TRA     EOBEX               -EOB EXIT                            1IO09030
       TRA     COMXIT              -NORMAL EXIT                         1IO09040
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) 1IO09050
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       1IO09060
       TRA     RW10                -NO IT IS COMPLETE                   1IO09070
       RIR     GENER               RESET GENER BIT                      1IO09080
       RNT     200000              IF IOCYN                             1IO09090
       TRA     RW14                NO -IOC TRANSMITTING                 1IO09100
       ZET     XEOB                IF IOCYN LOCATING                    1IO09110
       TRA     RW16                TAKE EOB INTERRUPT EXIT              1IO09120
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   1IO09130
       STA     TRANS               ADDRESS                              1IO09140
       CLA     DUMMY               SET NEW                              1IO09150
       STD     WDCT                WORD COUNT                           1IO09160
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            1IO09170
RW16   CAL     2TAG                SET EOB IOCYN                       *1IO09180
       TRA     RW17+1              INTERRUPTED CODE                     1IO09190
RW17   CAL     RW13                SET END OF BUFFERS CODE             *1IO09200
       STT     LTSX                STORE CODE                          *1IO09210
       SIR     EOBXIT              SET AND TAKE                         1IO09220
       TRA     RW12                EOB EXIT                             1IO09230
       EJECT                                                            1IO09240
*                  HANDLER FOR IORY AND IOSY READING                    1IO09250
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              1IO09260
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     1IO09270
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    1IO09280
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       1IO09290
       SIR     DISCN               SET COMMAND DISCONNECT               1IO09300
       TRA     RW4                 EXECUTE READ                         1IO09310
       SPACE   1                                                        1IO09320
*                  HANDLER FOR IORY AND IOSY WRITING                    1IO09330
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 1IO09340
       LFT     400000              ACTUALLY IOSY                        1IO09350
       TRA     RSWS                YES                                  1IO09360
       IIR     EBDSY               NO, SET EOB DISCONNECT-NOT IOSY      1IO09370
       SUB     WDCT                REDUCE WORD COUNT                    1IO09380
       TPL     RW5                 ENOUGH AVAIL, EXECUTE COMMAND        1IO09390
       TRA     RW3                 IORY--EXECUTE                        1IO09400
RSWS   LXD     DUMMY,1             IF NOT 1ST TIME THRU                 1IO09410
       TXH     RW7,1,0             EXECUTE COMMAND                      1IO09420
       LXD     WDCT,1              OTHERWISE, PICK UP COUNT             1IO09430
       PXA     0,1                 AND BUFFER AND TRUNCATE              1IO09440
       ACL*    2,2                 WITH THAT COUNT                      1IO09450
       STA*    2,2                                                      1IO09460
       XEC     1,4                                                      1IO09470
RW1.4  SXD     DUMMY,1                                                  1IO09480
       XEC     2,4                 GET NEW BUFFER                       1IO09490
       TRA     RW1                                                      1IO09500
RW7    STD     WDCT                                                     1IO09510
       TRA     RW5+2                                                    1IO09520
       SPACE   1                                                        1IO09530
*                         HANDLER TCH COMMAND                           1IO09540
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      1IO09550
       NZT     TCHEX               IF 1ST TCH THEN                      1IO09560
       STA     TCHEX               EXIT = L(TCH)+1                      1IO09570
       RNT     400000              IF NOT INDIRECT                      1IO09580
       TRA     GTIOX+1             TCH EXECUTED                         1IO09590
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             1IO09600
       PAC     0,1                 GO ONE MORE LEVEL AND                1IO09610
       TRA     GTIOX+1             EXIT                                 1IO09620
       SPACE   1                                                        1IO09630
*                     PRIORITY EXIT TESTS FOR READ                      1IO09640
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         1IO09650
       ANA     L(377)                                                   1IO09660
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        1IO09670
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        1IO09680
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  1IO09690
       RIL     PRIBTS              AND EXIT.                            1IO09700
       RFT     REINT               IF LAST BUF SYNCED                   1IO09710
       TRA     *+4                 GIVE FILE A KICK                     1IO09720
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    1IO09730
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         1IO09740
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  1IO09750
       TSX     BORBF,1             IF NO RUSH OCCURRED                  1IO09760
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      1IO09770
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  1IO09780
       TTL     READ SUBROUTINE - SYNCR-                                 1IO09790
*                   GETS A BUFFER FROM THE EXECUTOR                     1IO09800
*                         VIA THE SYNC ROUTINE                          1IO09810
       SPACE   1                                                        1IO09820
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   1IO09830
*              RETURN              INDEXS ARE NOT DISTRUBED             1IO09840
       SPACE   1                                                        1IO09850
SYNCR  SXA     SY8.2,4             SAVE IR4                             1IO09860
       SXA     SY8.1,1             IR1                                  1IO09870
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $1IO09880
L(0)A  ENB     L(0)                DISABLE TRAPS                        1IO09890
       NZT*    4,2                 ANYTHING TO SYNC                     1IO09900
       TRA     SY10                -NO                                  1IO09910
       IFT     NOHYP=0                                               $5$1IO09911
       GOTO    SY3A                                                  $5$1IO09912
       CAL     5,2                                                     $1IO09920
       ANA     SIX                 HYPER                               $1IO09930
       TZE     *+5                 NO                                  $1IO09940
       LDQ     1,2                 WHAT                                $1IO09950
       RQL     18                  TYPE                                $1IO09960
       TQP     *+2                 READ                                $1IO09970
       SIR     100000              HYPER READ BACKWARD                 $1IO09980
SY3A   CLA     4,2                 SYNCED BUFFER TO                  $5$1IO10000
       STA     2,2                 BUFFER IN USE ADDRESS                1IO10010
       CAL     1,2                 REDUCE COUNT OF                      1IO10020
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     1IO10030
       STA     1,2                                                      1IO10040
       CLA*    4,2                 UPDATE SYNC                         $1IO10050
       STA     4,2                 CHAIN CARRYING L(END)                1IO10060
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             1IO10070
       STD*    4,2                 UNLESS NO CHAIN EXISTS               1IO10080
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO10090
       LGR     33                  SET EOF AND/ OR REDUN                1IO10100
       IIA                         BITS=0 IF CONDITION OCCURRED         1IO10110
       LXD     SYNCT,1             ADVANCE COUNT                        1IO10120
       TXI     *+1,1,1             OF BUFFERS                           1IO10130
       SXD     SYNCT,1             USED THIS READ                       1IO10140
       CAL     2,2                                                      1IO10150
       ACL     L(1)                                                     1IO10160
       PAC     0,4                 IR4 = -L(IORT)                       1IO10170
       ACL     L(1)                SET LOCATOR ADDRESS                  1IO10180
       ANA     XCPTP               CLEAR PREFIX                        $1IO10190
       STO*    2,2                                                     $1IO10200
       IFT     NOHYP=0                                               $5$1IO10201
       GOTO    SY4                                                   $5$1IO10202
       RNT     100000              READ BACKWARD                       $1IO10210
       TRA     SY4                 NO                                  $1IO10220
       ALS     18                  FIRST DATA WORD                     $1IO10230
       ACL     0,4                 IN BUFFER                           $1IO10240
       ARS     18                  LAST DATA WORD                      $1IO10250
       PAX     0,1                 +1 OF BUFFER                        $1IO10260
       ORA     7PRE                                                    $1IO10270
SY4    SUB     0,4                 LOCATOR - IORT                      $1IO10290
       ALS     18                  =WORD COUNT                         $1IO10300
       STD*    2,2                                                     $1IO10310
       IFT     NOHYP=0                                               $5$1IO10311
       GOTO    SY5                                                   $5$1IO10312
       RNT     100000                                                  $1IO10320
       TRA     SY5                                                     $1IO10330
       CAL     0,4                 STARTING DATA                       $1IO10340
       STA*    2,2                                                     $1IO10350
       PXA     0,1                 LAST LOC+1 OF                       $1IO10360
       STA     0,4                 BUFFER IN TO IORT                   $1IO10370
SY5    RNT     NOEOF               DID EOF OCCUR                       $1IO10390
       TRA     SY11                - YES                                1IO10400
       CLA     1,2                 IF LAST BUFFER                       1IO10410
       ANA     L(377)              AHEAD IS                             1IO10420
       PAX     0,1                 SYNCED OUT                           1IO10430
       CAL     3,2                 AND NOT                              1IO10440
       PBT                         AN INTERNAL FILE                     1IO10450
       TXL     SY9,1,0             INITIATE ANOTHER                     1IO10460
SY5.6  ADD     1DEC                UP DATE BLOCK SEQ.                   1IO10470
       IFT     NOHYP=0                                               $5$1IO10471
       GOTO    SY8                                                   $5$1IO10472
       RIR     100000                                                  $1IO10480
SY8    RNT     NORED               IF URR OCCURRED                   $5$1IO10500
       TRA     URREX               TAKE ERROR EXIT                      1IO10510
       STD     3,2                                                      1IO10520
SY8.2  AXT     **,4                RESTORE IR4                          1IO10530
SY8.1  AXT     **,1                IR1                                  1IO10540
       TTR     1,1                 RETURN                               1IO10550
       SPACE   1                                                        1IO10560
*                          LAST BUFFER SYNCED                           1IO10570
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        1IO10580
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    1IO10590
       CAL     3,2                 BLK SEQ NUMBER-1 TO AC               1IO10600
       TRA     SY5.6               CONTINUE                             1IO10610
       SPACE   1                                                        1IO10620
*                  NO BUFFER AVAILABLE WHEN NEEDED                      1IO10630
       RFT     NOREOF              IF ON TRY                           $1IO10640
       TRA     SY10-5        TO GET A BUFFER                         (7)1IO10650
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   1IO10660
       TRA     RW17                TAKE IT , ELSE GIVE                  1IO10670
       STR                         ILLEGAL FILE USE                     1IO10680
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                1IO10690
       RIR     NOREOF              SET TRIED ONCE                      $1IO10700
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       1IO10710
       TSX     BORBF,1             INITIATE READ                        1IO10720
       TRA     SY9.3-2             COULD NOT                           $1IO10730
       TRA     SY11-3                                                (7)1IO10740
SY10   TRA     SY10.1                                                (7)1IO10750
       SIL     RBITS               SET RUSH PRIORITY BITS              $1IO10760
       AXC     1,4                                                      1IO10770
       NZT*    0,2                 TO BE SYNCED                         1IO10780
       TRA     SY10-3        -NO                                     (7)1IO10790
       TSX     .ACTV+1,4           YES,ACTIVATE PRIORITY             $5$1IO10800
       MZE     0,2                 THAT FILE                            1IO10810
       TRA     SY10.2        GO TO WAIT                              (7)1IO10820
       SPACE   1                                                        1IO10830
*                             EOF ON SYNC                               1IO10840
SY11   TSX     DISCON,1      DISCONNECT BUFFER                     IBJOB1IO10850
       TRA     EOFEX                                                    1IO10860
       TTL                         READ SUBROUTINE-BORBF-               1IO10870
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   1IO10880
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            1IO10890
       SPACE   1                                                        1IO10900
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  1IO10910
*              ERROR RETURN        INDEX REGISTERS ARE                  1IO10920
*              NORMAL RETURN        NOT DISTURBED                       1IO10930
       SPACE   1                                                        1IO10940
BORBF  SXA     BOR8,1              SAVE IR1                             1IO10950
       SXA     BOR2,4              SAVE IR4                             1IO10960
       LAC     LBC,4               IF NO BUFFERS                        1IO10970
       ENB     L(0)                                                    $1IO10980
       CLA*    0,4                 ARE PRESENTLY                        1IO10990
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               1IO11000
       LXA     BOR8,1              RESTORE IR1                          1IO11010
BOR2   AXT     **,4                RESTORE IR4                          1IO11020
       ENB     .TRAPS                                                $5$1IO11030
       TRA     1,1                 AND EXIT                             1IO11040
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $1IO11050
       TXI     BOR2,1,-1           EXIT AT 2,1                          1IO11060
       STA     XERR                SAVE L(NEXT BUFFER)                 $1IO11070
       CLA     1,2                 IF INITIAL                           1IO11080
       PAX     0,4                 BUFFER DONT                          1IO11090
       TXL     *+3,4,0             ADJUST COUNTS                        1IO11100
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 1IO11110
       TRA     BOR2-1              NO BUFFER AVAILABLE                  1IO11120
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              1IO11130
       CLA     XERR                UPDATE POOL                         $1IO11140
       STA*    LBC                 BUFFER CHAIN                         1IO11150
       CAL     1,2                 UP COUNT BUFFERS                     1IO11160
       ADD     L(1)                IN USE BY                            1IO11170
       STA     1,2                 THE FILE                             1IO11180
       ENB     .TRAPS              RESTORE TRAPPING                  $5$1IO11190
       TSX     RDSEL,1             ISSUE STACKED SELECT                 1IO11200
BOR8   AXT     **,1                RESTORE IR1                          1IO11210
       TXI     BOR2,1,-1           EXIT AT 2,1                          1IO11220
       TTL                         INPUT BUFFER RELEASE ROUTINES        1IO11230
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  1IO11240
*              TSX  RELES,1        CANNOT BE USED AT TRAP               1IO11250
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     1IO11260
       SPACE   1                                                        1IO11270
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               1IO11280
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               1IO11290
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     1IO11300
       SPACE   1                                                        1IO11310
DISCON SIR     DONLY               SET DISCONNECT ONLY                  1IO11320
RELES  SIR     RDSWIT              SET RELEASE MODE                     1IO11330
       SXA     RE2,1               SAVE IR1                             1IO11340
       SXA     RE2+1,4             AND IR4                              1IO11350
RE1    CLA*    2,2                 IS A BUFFER                          1IO11360
       TPL     RE4                 CONNECTED NORMALLY                   1IO11370
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            1IO11380
       ANA     7PRE                IF BUFFER HELD                       1IO11390
       TZE     RE2                 OR NO BUFFER CONNECTED               1IO11400
       SPACE   1                                                        1IO11410
*                         RELEASE HELD BUFFERS                          1IO11420
       RNT     RDSWIT              RELEASE OR                           1IO11430
       TRA     TR1                 TRUNCATE                             1IO11440
       LAC     LBC,4                                                    1IO11450
       LDQ     2,2                 L(BUF TO MQ)                         1IO11460
       TSX     POOLRD,1            RELEASE BUFFER                       1IO11470
RE1.5  CLA     TCHAN               CHAIN HELD                           1IO11480
       STA     2,2                 BUFFERS                              1IO11490
       RNT     CPYFN               UNLESS COPYING                       1IO11500
       TRA     RE1                 RELEASE ALL HELD BUFFERS             1IO11510
RE2    AXT     **,1                RESTORE IR1                          1IO11520
       AXT     **,4                AND IR4                              1IO11530
       RNT     GENER               IF GENERATED DISCONNECT SAVE         1IO11540
       RIR     DISCN               COMMAND DISCONNECT BIT               1IO11550
       RIR     EOBITS                                                   1IO11560
       RFT     RDSWIT                                                   1IO11570
       RIR     XECNT                                                    1IO11580
       TRA     1,1                 EXIT                                 1IO11590
       SPACE   1                                                        1IO11600
*                        RELEASE BUFFER IN USE                          1IO11610
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            1IO11620
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    1IO11630
       RNT     RDSWIT              RELEASE OR                           1IO11640
       TRA     TR1.1               TRUNCATE                             1IO11650
       RNT     HOLD                IS HOLD BIT ON                       1IO11660
       TRA     RE5                 ENTER HOLD                           1IO11670
       TSX     ENTHLD,4            BUFFER INTO                          1IO11680
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          1IO11690
       TRA     RE6                 HOLD CHAIN                           1IO11700
RE5    LDQ     2,2                 L(BUF) TO MQ                         1IO11710
       LAC     LBC,4                                                    1IO11720
       TSX     POOLRD,1            BUFFER TO POOL                       1IO11730
RE6    CLA     LBC                 SET FILE TO REFER                    1IO11740
       STA     2,2                 TO POOL                              1IO11750
       TRA     RE2                                                      1IO11760
*                  RELEASE BUFFER FROM INTERNAL FILE                    1IO11770
RE7    TSX     ENTIN,1             ENTER BUFFER INTO CHAIN              1IO11780
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO11790
       RNT     INSAT               EXIT EITHER TO                       1IO11800
       TRA     RE1.5               RELEASING HELD                       1IO11810
       TRA     RE6                 RELEASING THOSE IN USE               1IO11820
       TTL                         RELEASE INPUT BUFFER TO POOL         1IO11830
*                            IR2 = -L(FILE)                             1IO11840
*                            IR4 = -L(POOL)                             1IO11850
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        1IO11860
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        1IO11870
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               1IO11880
       SPACE   1                                                        1IO11890
TOPOOL LDI     1,2                 FILE BITS TO                         1IO11900
       RIR     77777               SI-RIGHT SIDE TO ZERO                1IO11910
TOCLOS ENB     L(0)                TRAP PROTECT                         1IO11920
       CAL     1,2                 REDUCE                               1IO11930
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     1IO11940
       STA     1,2                 USE COUNT                            1IO11950
*                      RELEASE INPUT BUF TO POOL                        1IO11960
POOLRD ENB     L(0)                TRAP PROTECT                         1IO11970
       CAL     1,2                 REDUCE CT                            1IO11980
       SUB     L(400)              OF BUFS LOGICALLY                    1IO11990
       STA     1,2                 IN USE BY FILE                       1IO12000
       RNT     RDSWIT              IS THE RELEASE MODE ON               1IO12010
       TRA     TCHAN               NO                                   1IO12020
TCHAN  XCA     **                  L(BUF) TO AC                         1IO12030
       RNT     STSH                IF STASH AND XEOB IS NOT ZERO        1IO12040
       TRA     *+4                 (SIGNIFYING RELEASE ALREADY          1IO12050
       ZET     XEOB                ACCOUNTED FOR BY TSX BCKBF,1 )       1IO12060
       TRA     PRD2+1              SKIP TO EXIT, ALL STASHES ARE        1IO12070
       TRA     PRD1                DESTRUCTIVE RELEASES FROM INPUT      1IO12080
       LDQ     3,2                 IF AN INTERNAL FILE                  1IO12090
       TQP     *+2                 GO OUT AND CHECK DESTRUCTIVE         1IO12100
       TMI     RE7                 READ MODE OR NOT                     1IO12110
PRD1   SXA     PRD2,1              SAVE IR1                             1IO12120
       RNT     CPYFN               UNLESS COPYING                       1IO12130
       TSX     BTP2,1              RELEASE BUF TO POOL                  1IO12140
       CLA     1,2                 IF LAST                              1IO12150
       PAX     0,1                 BUFFER                               1IO12160
       TXL     PRD2,1,0            IN USE THEN SKIP                     1IO12170
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 1IO12180
PRD2   AXT     **,1                RESTORE IR1                          1IO12190
       NZT     .TRPSW              UNLESS AT TRAP                    $5$1IO12200
       ENB     .TRAPS              RESTORE TRAPPING                  $5$1IO12210
       TRA     1,1                 EXIT                                 1IO12220
       TTL                         WRITE SUBROUTINE-TRUNC-              1IO12230
*                      TRUNCATE AN OUTPUT BUFFER                        1IO12240
       SPACE   1                                                        1IO12250
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          1IO12260
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    1IO12270
       SPACE   1                                                        1IO12280
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    1IO12290
       TRA     RELES+1             USE RELES ROUTINE                    1IO12300
       SPACE   1                                                        1IO12310
*                        TRUNCATE HELD BUFFERS                          1IO12320
TR1    CLA*    2,2                 HOLD CODE TO AC                      1IO12330
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         1IO12340
       CLA     TCHAN               UPDATE FILE                          1IO12350
       STA     2,2                 HOLD CHAIN                           1IO12360
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        1IO12370
       SPACE   1                                                        1IO12380
*                        TRUNCATE BUFFER IN USE                         1IO12390
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $1IO12400
       TRA     TR2                 NO, WRITTEN                         $1IO12410
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $1IO12420
       TRA     TR3                                                     $1IO12430
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $1IO12440
       SXA     TR10+2,1                                                $1IO12450
       CAL     2,2                 FIND                                $1IO12460
       ACL     L(1)                L(IORT)                              1IO12470
       STA     TR5                                                      1IO12480
       CLA*    2,2                 PICK UP LOCATOR                     $1IO12490
       TMI     TR5+1               IN HOLD CHAIN                       $1IO12500
TR5    STA     **                                                       1IO12510
       CLA*    TR5                 GET LOCATOR                         $1IO12520
       SUB     TR5                 FORM COUNT AND STORE                $1IO12530
       SUB     L(1)                IN IORT                              1IO12540
       ALS     18                                                       1IO12550
       STD*    TR5                                                      1IO12560
       ANA     DECRE                                                    1IO12570
       TNZ     PAD                 GO PAD, IF NECESSARY.             (8)1IO12580
       LDQ     2,2                 DONT WRITE BUFFER OUT                1IO12590
       LAC     LBC,4               L(POOL) TO IR4                       1IO12600
       CAL     1,4                 RESTORE                              1IO12610
       ARS     4                   SIZE TO                              1IO12620
       STD*    TR5                 IORT                                 1IO12630
       ENB     L(0)                TRAP PROTECT                         1IO12640
       TSX     BTP1,1              BUFFER IN POOL                       1IO12650
       CLA     3,2                 IF AN INTERNAL FILE THEN             1IO12660
       TPL     *+2                 ADJUST BUFFER COUNTS                 1IO12670
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         1IO12680
       ENB     .TRAPS              ALLOW TRAPS AND EXIT SO           $5$1IO12690
       LXA     TR10+2,1            NO WRITE                            $1IO12700
TR10   TRA     1,1                 IS EXECUTED                          1IO12710
       AXT     **,4                RESTORE IRS                         $1IO12720
       AXT     **,1                AND RETURN                          $1IO12730
       TRA     1,4                                                     $1IO12740
TR2    TSX     WRSEL,1             WRITE BUFFER                         1IO12750
TR3    CLA     LBC                 SET FILE REFERENCE                   1IO12760
       STA     2,2                 TO POOL                              1IO12770
       TRA     RE2                                                      1IO12780
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       1IO12790
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             1IO12800
*              TSX  GTBUF,1        IR2 =-L(FILE)                        1IO12810
*              RETURN               INDICES NOT DISTURBED               1IO12820
       SPACE   1                                                        1IO12830
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            1IO12840
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    1IO12850
*              RETURN               IR1 DESTROYED                       1IO12860
       SPACE   1                                                        1IO12870
OBTIB  SXA     GET8,4              SAVE IR4                             1IO12880
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $1IO12890
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           1IO12900
       TRA     1,4                 EXIT                                 1IO12910
       SPACE   1                                                        1IO12920
GTBUF  SXA     GET8,4              SAVE IR4                             1IO12930
       CLA     3,2                 IF AN INTERNAL FILE                  1IO12940
       TPL     GET0                CHECK TO MAKE SURE AFTER             1IO12950
       SXA     GET8+1,1            SAVING INDEX 1 ,                     1IO12960
       TSX     TOKBB,4             THAT FILE IS ALLOWED                 1IO12970
       TRA     SY9.3               TO TAKE A BUFFER , IF SO             1IO12980
       TRA     *+2                 SKIP SAVING OF IR1                   1IO12990
GET0   SXA     GET8+1,1            SAVE IR1                             1IO13000
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           1IO13010
       CLA     1,4                 NECESSARY IT WILL BE STARTED         1IO13020
       LDQ*    0,4                 WITH FIRST FILE                      1IO13030
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          1IO13040
       SPACE   1                                                        1IO13050
*                         NO BUFFER AVAILABLE                           1IO13060
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   1IO13070
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $1IO13080
       LAC     LBC,4               L(BPCW)                           $5$1IO13090
       LDQ*    0,4                                                   $5$1IO13100
       TQP     GET5                BUF AVAIL-JOIN IT                   $1IO13110
       TRA     SY9.3               NONE-TRY EOB                        $1IO13120
       STA     CPY7                SETUP SYNC SEQUENCE                  1IO13130
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           1IO13140
       CLA     0,1                 PLACE L(UCW)                         1IO13150
CPY7   PAC     **,4                IN IR4                               1IO13160
       CLA     1,4                 IF PRIORITY WORD                     1IO13170
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             1IO13180
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          1IO13190
       TSX     .ACTV+1,4           ACTIVATE THIS UNIT GIVING         $5$1IO13200
1TAG   MZE     0,1                 IT HIGH PRIORITY                     1IO13210
       LAC     LBC,4               WAIT UNTIL                           1IO13220
       CLA*    0,4                 A BUFFER PLACED IN                   1IO13230
       TPL     GET5                POOL BY TRAP                         1IO13240
       TRA     *-2                 ROUTINE                              1IO13250
       EJECT                                                            1IO13260
*                     UNIT HAS NO REQUESTS WAITING                      1IO13270
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   1IO13280
       ANA     NEOTBT              AND EOT CONDITION                    1IO13290
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             1IO13300
GET3   CLA     1,1                 ADVANCE AROUND                       1IO13310
       TRA     GET1                OUTPUT CHAIN                         1IO13320
       SPACE   1                                                        1IO13330
*                  GOT A BUFFER - READY IT FOR OUTPUT                   1IO13340
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 1IO13350
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     1IO13360
       ENB     L(0)                TRAP PROTECT                         1IO13370
       RNT     HELD                IF A HELD BUFFER                     1IO13380
       TRA     GET6                EXIST,COUNT                          1IO13390
       CLA     3,2                 SHOULD BE ADJUSTED                   1IO13400
       TMI     *+4                 ( EXCEPT INTERNAL FILES)             1IO13410
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           1IO13420
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    1IO13430
       LAC     LBC,4               L(POOL) TO IR4                       1IO13440
       CAL     7PRE                SET CODE 7                           1IO13450
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            1IO13460
GET6   CLA*    0,4                 UPDATE AVAILABLE                     1IO13470
       STA     CPY7                BUFFER CHAIN                         1IO13480
       CLA     0,4                 SET L(BUF)                           1IO13490
       STA     2,2                 INTO FILE REFERENCE                  1IO13500
       ACL     L(1)                SAVE                                 1IO13510
       STA     GET7                L(IORT)                              1IO13520
       ACL     L(1)                SET LOCATOR                          1IO13530
       STA*    2,2                 = PZE *+2,,**                        1IO13540
       CAL     CPY7                UPDATE POOL TO REFER                 1IO13550
       STA     0,4                 TO NEXT BUFFER                       1IO13560
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO13570
GET7   CLA     **                  PICKUP IORT                          1IO13580
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     1IO13590
GET8   AXT     **,4                RESTORE IR4                          1IO13600
       AXT     **,1                1                                    1IO13610
       RIR     FREEUP              RESET FREEUP BIT                    $1IO13620
       TRA     1,1                 EXIT                                 1IO13630
       TTL                         HOLD FUNCTION SUBROUTINES            1IO13640
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              1IO13650
       SPACE   1                                                        1IO13660
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  1IO13670
*              RETURN              IR1 DESTROYED                        1IO13680
       SPACE   1                                                        1IO13690
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      1IO13700
       LFT     OUTPUT                                                  $1IO13710
       TRA     FIX                                                     $1IO13720
       TPL     FIX                 IF REGEN INTERNAL FILE              $1IO13730
FIX1   RFT     HELD                IF ALREADY HOLDING                  $1IO13740
       TRA     EN1                 SKIP INITIALIZATION                  1IO13750
       PAX     0,1                 ENTER 1ST BUFFER                     1IO13760
       SIR     HELD                IN CHAIN                             1IO13770
       SXD     HOLDS,1             PRESET * STORE                       1IO13780
       TRA     EN1+1                                                   $1IO13790
FIX    PAC     0,1                 BCW TO IR1                          $1IO13800
       CLA*    2,2                 GET LOCATOR AND                     $1IO13810
       STA     1,1                 SAVE FOR WRITE                      $1IO13820
       CLA     2,2                 IN ITS IORT                         $1IO13830
       TRA     FIX1                PUT IN HOLD CHAIN                   $1IO13840
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                1IO13850
       STA     HOLDS               UPDATE CHAIN                         1IO13860
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $1IO13870
       STP*    HOLDS               IN BUFFER                            1IO13880
       TRA     1,4                                                     $1IO13890
       SPACE   1                                                        1IO13900
*                           SETUP HOLD CHAIN                            1IO13910
*                           IN FILE AT EXIT                             1IO13920
*                          FROM READ OR WRITE                           1IO13930
       SPACE   1                                                        1IO13940
*                           CALLING SEQUENCE                            1IO13950
       SPACE   1                                                        1IO13960
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        1IO13970
*              RETURN                                                   1IO13980
       SPACE   1                                                        1IO13990
HOOK   CLA     2,2                                                      1IO14000
       STA*    HOLDS                                                    1IO14010
       LXD     HOLDS,1                                                  1IO14020
       PXA     0,1                                                      1IO14030
       STA     2,2                                                      1IO14040
       RIR     HELD                                                     1IO14050
       TRA     1,4                                                      1IO14060
       TTL             NON-DATA SELECT CODES FOR IOEX                   1IO14070
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        1IO14080
       SPACE   1                                                        1IO14090
HFPNP  EQU     42                  FILE PROTECT                         1IO14100
HUNLP  EQU     39                  UNLOAD                               1IO14110
HSKFP  EQU     37                  SKIP FILE                            1IO14120
HSKRP  EQU     36                  SKIP RECORD                          1IO14130
HBSFP  EQU     35                  BACKSPACE FILE                       1IO14140
HBSRP  EQU     34                  BACKSPACE RECORD                     1IO14150
HWTMP  EQU     33                  WRITE TAPE MARK                      1IO14160
HERGP  EQU     32                  ERASE LONG GAP                       1IO14170
HRUNP  EQU     31                  REWIND AND UNLOAD                    1IO14180
HRWDP  EQU     30                  REWIND                               1IO14190
WEFOP  EQU     7                   WEF                                  1IO14200
BSFOP  EQU     6                   BSF                                  1IO14210
BSROP  EQU     5                   BSR                                  1IO14220
RUNOP  EQU     4                   RUN                                  1IO14230
REWOP  EQU     3                   REW                                  1IO14240
SDNHP  EQU     2                   SDNH                                 1IO14250
SDNLP  EQU     1                   SDNL                                 1IO14260
TESTP  EQU     0                   TEST OP                              1IO14270
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         1IO14280
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 1IO14290
*      TSX  WRSEL,1                          2,2 (21-35)                1IO14300
*         TSX    WRSLH,1         WRITE HELD BUFFER                      1IO14310
*                                  IR4 IS DESTROYED                     1IO14320
       SPACE   1                                                        1IO14330
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $1IO14340
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      1IO14350
SEL4   PZE     **,,ISSUE           SELECT WORD                          1IO14360
WRSEL  CLA     3,2                 HANDLE INTERNAL FILE                 1IO14370
       TMI     SEL5.8              SEPARATELY                           1IO14380
       TSX     SETWR,4             SET UP TO WRITE                     $1IO14390
       LDQ     2,2                 L(BUF) TO MQ                         1IO14400
RDSEL  XCA                                                              1IO14410
       STA     SEL4                L(BUF) TO SEL4                       1IO14420
       LDQ     L(0)D               SET BUFFER                           1IO14430
       LGL     18                  1ST WD =                             1IO14440
       SLW*    SEL4                PZE L(0),,*                          1IO14450
SEL0   AXC     1,4                                                      1IO14460
       ENB     L(0)                                                     1IO14470
       CLA*    0,2                 CHECK FILE ALREADY                   1IO14480
       TZE     SEL3                ACTIVE                               1IO14490
       STA     SEL1                YES                                  1IO14500
       CAL     FCW                                                     $1IO14510
       AXT     0,4                                                     $1IO14520
       ERA*    0,2                 IS THIS THE SAME FILE               $1IO14530
       ANA     ADDRS                                                   $1IO14540
       TZE     SEL1                YES                                 $1IO14550
       TSX     .ACTV+1,4           NO                                $5$1IO14560
       MZE     0,2                                                     $1IO14570
       TRA     SEL0                                                    $1IO14580
SEL1   CLA     **                  ADD NEW                              1IO14590
       PDC     0,4                 BUFFER TO END                        1IO14600
       CLA     SEL4                OF EXISTING                          1IO14610
       STA     0,4                 BUFFER CHAIN                         1IO14620
       ALS     18                  SET L(NEW BUF) INTO                  1IO14630
       STD*    SEL1                DECREMENT 1ST ENTRY                  1IO14640
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO14650
       TRA     1,1                 EXIT                                 1IO14660
       SPACE   1                                                        1IO14670
*                         ENTER INITIAL SELECT                          1IO14680
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    1IO14690
       TRA     SEL6                GO HANDLE IT SPECIAL                 1IO14700
       AXT     0,4                 CHECK FOR                            1IO14710
       CLA*    0,2                 ENTERING INITIAL SELECT ON           1IO14720
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         1IO14730
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         1IO14740
       LGL     18                  HAS ENCOUNTERED EOT                  1IO14750
       STA     CPY7                IF SO THEN HANDLE                    1IO14760
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        1IO14770
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   1IO14780
       TSX     EOTOF,1                                                  1IO14790
       TSX     CPY6,4                                                   1IO14800
SEL2.4 AXT     **,1                RESTORE IR1                          1IO14810
SEL2.5 STI     TEMIND                                                  $1IO14820
       AXT     0,4                 GET FILE BLOCK ADDRESS              $1IO14830
       CAL     FCW                 AND STORE IN UCW ONE                $1IO14840
       STA*    0,2                                                     $1IO14850
       IFT     NOCHX=0                                               $5$1IO14851
       GOTO    SEL2.7                                                $5$1IO14852
       LDI*    0,2                 UCW 1                               $1IO14860
       LFT     20000               1301                                $1IO14870
       TRA     SEL2.6              MAYBE                               $1IO14880
SEL2.7 CAL     SEL4                NO                                  $1IO14900
       AXC     1,4                                                     $1IO14910
       LDI     TEMIND                                                  $1IO14920
       LFT     OUTPUT              OUTPUT                              $1IO14930
       ORA     FOR                 YES-SET BIT                         $1IO14940
       SLW*    0,2                 STORE ISSUE IN UCW 2                $1IO14950
       TSX     .ACTV+1,4           ACTIVATE                          $5$1IO14960
       PZE     0,2                 THIS FILE                            1IO14970
       TRA     1,1                                                      1IO14980
       IFT     NOCH=0                                                $5$1IO14981
       GOTO    SEL8                                                  $5$1IO14982
SEL2.6 LNT     100                 1301                                $1IO14990
       TRA     SEL8           NO                                       $1IO15000
       SXA     SEL2.8+1,1          YES                                 $1IO15010
       CLA     0,2                 PUT -L(UCB) IN IR4                  $1IO15020
       PAC     0,4                                                     $1IO15030
       LDQ     6,2                 CHECK IF EOF ON DISK                $1IO15040
       TQP     SEL2.8              NO                                  $1IO15050
       ARS     18                  PUT CORRECT SEEK                    $1IO15060
       STA     6,2                 IN WORD SEVEN                       $1IO15070
       STP     6,2                 AND TURN OFF EOF BIT                $1IO15080
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $1IO15090
       AXT     **,1                                                    $1IO15100
       TRA     SEL2.7         RETURN                                   $1IO15110
ENDTRK LDI     1,2                                                      1IO15120
       LDI     1,2            RESTORE IND                              $1IO15130
       RIR     77777                                                   $1IO15140
       PXA     0,0                                                     $1IO15150
       STT     6,2                                                     $1IO15160
       TRA     BOFEX                                                   $1IO15170
SEL8   NULL                                                          $5$1IO15181
       IFT     NOHYP=0                                               $5$1IO15182
       GOTO    TEMIND                                                $5$1IO15183
       PXD     0,0                                                   $5$1IO15190
       LDI     1,2                                                     $1IO15200
       RFT     400000              IS THIS READ BACKWARD               $1IO15210
       CLA     SIX                 YES, SET BACKWARD READ MODE         $1IO15220
       ACL     SEL4                YES                                 $1IO15230
       AXC     3,4                 STORE ZERO                          $1IO15240
       STZ*    0,2                 IN UCW 4                            $1IO15250
       TRA     SEL2.7+1                                                $1IO15260
TEMIND PZE                                                              1IO15280
       TTL 0                                                            1IO15290
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         1IO15300
SEL5   CLA     3,2                 IF AN INTERNAL FILE                  1IO15310
       TMI     SEL5.8              HANDLE IT SEPARATELY                 1IO15320
       SXA     SEL5.6,1            SAVE IR1                             1IO15330
       ENB     L(0)                DISABLE TRAPS                        1IO15340
       TSX     BCKBB,1                                                  1IO15350
SEL5.6 AXT     **,1                RESTORE IR1                          1IO15360
       TRA     WRSEL+2             RETURN TO WRITE                      1IO15370
*                      WRITE INTERNAL FILE BUFFER                       1IO15380
SEL5.8 TSX     SETWR,4             SET UP TO WRITE                     $1IO15390
       SXA     SEL5.6,1            SAVE IR1                            $1IO15400
       CLA     2,2                 L(BUF)                               1IO15410
       PAC     0,1                 TO IR1                               1IO15420
       LAC     LBC,4               RESTORE SIZE TO                      1IO15430
       CAL     1,4                                                      1IO15440
       ARS     4                                                        1IO15450
       STD     1,1                                                      1IO15460
       CLA     2,2                 SET THIS BUFFER                      1IO15470
SEL5.9 TSX     ENTIN,1             INTO RE-GENERATIVE CHAIN             1IO15480
       CAL     3,2                 ADVANCE BLOCK SEQ                    1IO15490
       ACL     1DEC                                                     1IO15500
       STD     3,2                                                      1IO15510
       LXA     SEL5.6,1            RESTORE IR1                          1IO15520
       TRA     1,1                 EXIT                                 1IO15530
       SPACE   1                                                        1IO15540
*                        EOF OR EOT ENCOUNTERED                         1IO15550
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            1IO15560
       TRA     SEL7-1                                                   1IO15570
       LDQ     SEL4                RELEASE BUFFER                       1IO15580
       LAC     LBC,4               -L(POOL) TO IR4                      1IO15590
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  1IO15600
       SPACE   1                                                        1IO15610
*                             EOT OCCURRED                              1IO15620
       SXA     *+2,1               SAVE IR1                             1IO15630
SEL7   TSX     EOTOF,1             HANDLE EOT                           1IO15640
       AXT     **,1                RESTORE IR1                          1IO15650
       TRA     SEL0                AND CONTINUE                         1IO15660
       TTL                         DENSITY SETTING ROUTINE              1IO15670
*                             TSX DENSE,4                               1IO15680
       SPACE   1                                                        1IO15690
DENSE  CLA     1,2                 PLACE FILE                           1IO15700
       ANA     1TAG                DENSITY BIT                          1IO15710
       ALS     3                   IN DECREMENT                         1IO15720
       ACL     1DEC                ADD 1 TO FORM                        1IO15730
       STD     *+3                 LOW DEN. = 1                         1IO15740
       SXA     *+3,4               HI DEN. = 2                          1IO15750
       TSX     NDSEL+1,4           SET DENSITY                         $1IO15760
       PZE     0,2,**                                                   1IO15770
       AXT     **,4                RESTORE IR4                          1IO15780
       TRA     1,4                 EXIT                                 1IO15790
       TTL                         UNBUFFER INPUT FILE                  1IO15800
*    TSX  UNBFI,4           DESTROYS IR1                                1IO15810
       SPACE   1                                                        1IO15820
UNBFI  SXA     UB7,4               SAVE IR4                             1IO15830
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       1IO15840
UB1    ENB     L(0)                TRAP PROTECT                         1IO15850
       AXC     1,4                 IF NO BUFS IN REQ                    1IO15860
       CLA*    0,2                 CHAIN THEN GO RELEASE                1IO15870
       TZE     UB4                 SYNC CHAIN                           1IO15880
       IFT     NOCH=0                                                $5$1IO15891
       GOTO    UB1.2                                                 $5$1IO15892
UB1.1  LDQ     5,2           CHECK FOR DISK                             1IO15900
       TQP     *+2                                                     $1IO15920
       TRA     UB3                 DISK, GO TO UB3                     $1IO15930
UB1.2  STA     UB2                 SAVE L(1ST REQ)                   $5$1IO15950
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       1IO15960
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         1IO15970
       TRA     UB3                 HOOKING REMAINDER OF REQ             1IO15980
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       1IO15990
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         1IO16000
       XCA                         ITS COMPLETION                       1IO16010
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    1IO16020
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           1IO16030
       LDQ     4,2                 ADD 2ND ON REQS                      1IO16040
       STA     4,2                 TO SYNC CHAIN                        1IO16050
       PDC     0,1                                                      1IO16060
       XCA                                                              1IO16070
       STA     0,1                                                      1IO16080
       CLA*    0,1                                                      1IO16090
       STD*    4,2                                                      1IO16100
UB3    TSX     .ACTV+1,4           WHICH AT TRAP WILL                $5$1IO16110
       MZE     0,2                 BE ENTERED INTO                      1IO16120
       AXC     1,4                 SYNC CHAIN                           1IO16130
       ZET*    0,2                 WAIT                                 1IO16140
       TRA     *-1                                                      1IO16150
       SPACE   1                                                        1IO16160
*                      ALL BUFFERS IN SYNC CHAIN                        1IO16170
UB4    SXD     SYNCT,0             PRESET SYNC CT                       1IO16180
       STZ     TEMP                SET EOF DELETE SWITCH =0             1IO16190
UB4.1  CLA*    4,2                 PLACE BUFFERS                        1IO16200
       TZE     UB6                 FROM SYNC CHAIN                      1IO16210
       TPL     *+4                 TO POOL ,+ BUFFERS                   1IO16220
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          1IO16230
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 1IO16240
       SXD     SYNCT,1             NECESSARY TO REPOSITION              1IO16250
       LDQ     4,2                 TO POOL                              1IO16260
       STA     4,2                                                      1IO16270
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           1IO16280
       TZE     UB4.2               WITH THIS BUFFER                     1IO16290
       XCA                         YES- SO PICKUP                       1IO16300
       PAC     0,1                 THE TAPE POSITION                    1IO16310
       XCA                         AND SAVE FOR AFTER BSR               1IO16320
       CLA     2,1                 ACROSS EOF MARK                      1IO16330
       STO     TEMP                                                     1IO16340
UB4.2  LAC     LBC,4                                                    1IO16350
       TSX     TOCLOS,1                                                 1IO16360
       TRA     UB4.1                                                    1IO16370
       SPACE   1                                                        1IO16380
*                         FORM NEW SYNC CHAIN                           1IO16390
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  1IO16400
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $1IO16410
       TRA     UB3                 AND CONTINUE                         1IO16420
       SPACE   1                                                        1IO16430
*                            EXIT SEQUENCE                              1IO16440
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              1IO16450
       TXL     UB7,1,0             SETUP AND BACKSPACE                  1IO16460
       IFT     NOHYP=0                                               $5$1IO16461
       GOTO    UB6.2                                                 $5$1IO16462
       LDQ     5,2                                                     $1IO16470
       RQL     1                   HYPER                               $1IO16480
       TQP     *+7                 NO                                  $1IO16490
       LDQ     1,2                                                     $1IO16500
       RQL     18                  READ BACKWARD                       $1IO16510
       TQP     *+4                 NO                                  $1IO16520
       TSX     .NDSEL+1,4                                            $5$1IO16530
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $1IO16540
       TRA     UB6.3-1                                                 $1IO16550
 UB6.2 TSX     NDSEL+1,4                                             $5$1IO16570
       PZE     0,2,BSROP                                                1IO16580
       NZT     TEMP                IF BSR ACROSS EOF MARK               1IO16590
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $1IO16600
       CLA     TEMP                AND CONTINUE                         1IO16610
       AXC     2,4                                                      1IO16620
       STO*    0,2                                                      1IO16630
       STZ     TEMP                                                     1IO16640
       SIL     NINHIB              UN-INHIBIT FILE                      1IO16650
       TRA     UB6.3                                                    1IO16660
UB7    AXT     **,4                RESTORE IR4                          1IO16670
       TRA     1,4                 EXIT                                 1IO16680
       TTL     UNBUFFER OUTPUT FILE                                     1IO16690
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   1IO16700
*    TSX  UNBFO,4     DESTROYS IR1                                      1IO16710
       SPACE   1                                                        1IO16720
UNBFO  SXA     UNBO,4              SAVE IR4                             1IO16730
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         1IO16740
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 1IO16750
       NZT*    0,2                 TO DO GIVE IT                        1IO16760
       TRA     UNBO                PRIORITY AND WAIT.....               1IO16770
       TSX     .ACTV+1,4           FOR ALL REQUESTS TO GET DONE      $5$1IO16780
       MZE     0,2                                                      1IO16790
       TRA     UNBF1                                                    1IO16800
UNBO   AXT     **,4                                                     1IO16810
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        1IO16820
       TRA     1,4                 ELSE EXIT                            1IO16830
       TSX     EOTOF,1                                                  1IO16840
       TRA     UNBO-3                                                   1IO16850
       TTL                         IOCS SELECT ROUTINES                 1IO16860
*             (INITIATE A SELECT AND POST ITS COMPLETION)               1IO16870
       SPACE   1                                                        1IO16880
CHATY  PZE                         UNIT AND CHANNEL TYPE               $1IO16890
ISSUE  SXA     S3,4                SAVE IR4                             1IO16900
       SXA     S3+1,1              SAVE IR1                             1IO16910
       PAC     0,4                 -L(UCW) TO IR4                       1IO16920
       XCA                         SAVE + OR - ENTRY                    1IO16930
CHATT  CLA     0,4                 SET UP AND                          $1IO16940
       IFT     NOCH=0                                                $5$1IO16941
       GOTO    CHAT1                                                 $5$1IO16942
       ANA     BVDG                TEST FOR UNIT                       $1IO16950
       PDX     0,2                 AND CHANNEL TYPE                    $1IO16960
       TXL     *+3,2,8191          7909 OR 7607                        $1IO16970
       TXL     *+3,2,8192          HYPER                               $1IO16980
       TXI     *+2,2,1             DISK                                $1IO16990
       AXT     0,2                 IF 7607'''ZERO IR2                  $1IO17000
       SXA     CHATY,2             SAVE INDICATION                     $1IO17010
CHAT1  CLA     0,4                 0=7607,20101=DISC,20000=HYPER     $5$1IO17030
       PAC     0,2                 L(FILE) TO IR2                      $1IO17040
       TQP     SELP                SEPARATE SEL+ ENTRY                 $1IO17050
       IFT     NOCHX=0                                               $5$1IO17051
       GOTO    CHAT2                                                 $5$1IO17052
       CLA     CHATY               CHANNEL TYPE                        $1IO17060
       TNZ     MSELT               7909 CHANNEL                      $5$1IO17070
*                  SELECT (-) ENTRY = POST COMPLETION                   1IO17090
CHAT2  LFT     400000              IF SHORT RECORD                   $5$1IO17100
       TRA     MXMDT               INDICATION IS ON                     1IO17110
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 1IO17120
       SUB     L(1)                THEN SETUP TO EXIT                   1IO17130
       STA     S3                  AT 2,4                               1IO17140
       CLA     1,4                 IF READING                           1IO17150
       TPL     S3                  DISCARD NOISE RECORD                 1IO17160
MXMDT  CLA     1,2                 IF MIXED MODE                        1IO17170
       TMI     MXMOD               SKIP OUT                             1IO17180
SELM1  TSX     URC1,1              UPDATE REQUEST CHAIN                 1IO17190
       IFT     NOHYP=0                                               $5$1IO17191
       GOTO    HSEL1                                                 $5$1IO17192
       NZT     CHATY                                                   $1IO17200
       TRA     HSEL1               729 OR CARD UNIT                    $1IO17210
       CLA     1,4                                                     $1IO17220
       TZE     *+4                 NO REQUEST CHAIN                    $1IO17230
       PXD     0,0                 PREFIX FOR REINSTRUCT               $1IO17240
       LNT     200000              OR IF EOF                           $1IO17250
       TRA     HSEL1                                                   $1IO17260
       STA     0,4                 ZERO FCB FROM UCW1                  $1IO17270
       CAL     S3                  RESTORE                             $1IO17280
       ADD     L(1)                ADDRESS                             $1IO17290
       STA     S3                  FOR RETURN                          $1IO17300
 HSEL1 LDC     .COMM,1             RESTORE TO                        $5$1IO17320
       TQP     POSTR               IF MQ + READ IS DONE                 1IO17330
       SPACE   1                                                        1IO17340
*                        POST WRITE COMPLETION                          1IO17350
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $1IO17360
       PDC     0,4                                                      1IO17370
       CAL     1,4                 RESTORE BUFFER                       1IO17380
       ARS     4                   SIZE TO IORT                         1IO17390
       STD     -1,1                TO IORT                              1IO17400
       TSX     BTP1,1              PLACE BUF IN POOL                    1IO17410
       LNT     200000              DID EOT OCCUR                        1IO17420
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         1IO17430
*                        EOT HANDLE TRAP WRITE                          1IO17440
       AXC     1,4                                                      1IO17450
       CLA*    0,2                                                      1IO17460
       TZE     *+2                                                      1IO17470
       STA     4,2                                                      1IO17480
       LDQ     EOTBT                                                    1IO17490
*                         INHIBIT BITS TO FILE                          1IO17500
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $1IO17510
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $1IO17520
       XCL                         MASK TO AC                           1IO17530
       LXA     FCW,1                                                   $1IO17540
INEX2  TXI     *+1,1,**                                                 1IO17550
       TXH     INEX4,1,0                                                1IO17560
       ANS     .IOXSI                                                $5$1IO17570
INEX4  ANS     1,2                                                      1IO17580
       TRA     S3                                                       1IO17590
       SPACE   1                                                        1IO17600
*                         POST READ COMPLETION                          1IO17610
POSTR  CAL     .COMM                                                 $5$1IO17620
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $1IO17630
       PIA                                                              1IO17640
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $1IO17650
       CLA*    4,2                 DOES SYNC CHAIN EXIST                1IO17660
       TZE     PSTR8               NO                                   1IO17670
       PDC     0,1                 SAVE L(END)                          1IO17680
       XCA                         L(BUF) TO AC                         1IO17690
       STA     0,1                 UPDATE                               1IO17700
       LDQ     L(0)D               SYNC CHAIN                           1IO17710
       LGL     18                                                       1IO17720
       STA*    0,1                                                     $1IO17730
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $1IO17740
       LNT     200000         IF NO EOF                                $1IO17750
       TRA     S3                  THEN EXIT                            1IO17760
       SPACE   1                                                        1IO17770
*                        EOF HANDLER TRAP INPUT                         1IO17780
       SXA     PSTR5,4             SAVE L(UCW)                          1IO17790
       IFT     NOCH=0                                                $5$1IO17791
       GOTO    PSTR                                                  $5$1IO17792
       LXA     CHATY,1                                                 $1IO17800
       TXH     DEOF1,1,8192                                            $1IO17810
PSTR   LDQ     .LTPOS              SAVE TAPE POSITIOM                $5$1IO17830
       STQ*    .COMM               JUST PRIOR TO EOF MARK            $5$1IO17840
PSTR4  NZT     1,4                 IF LAST BUFFER                       1IO17850
       TRA     PSTR6               DO NOTHING                           1IO17860
PSTR2  TSX     URC1,1              DELETE AHEAD                        $1IO17870
       CLA     4,2                 L(POOL) TO IR4                       1IO17880
       PDC     0,4                                                      1IO17890
       TSX     TOPOOL,1            BUFFERS                              1IO17900
PSTR5  AXT     **,4                RESTORE L(UCW)                       1IO17910
       TRA     PSTR4               DELETE ALL                           1IO17920
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              1IO17930
       LDQ     NOTIN               WD UCW AND                           1IO17940
       TRA     INEX                GO INHIBIT FILE                      1IO17950
       SPACE   1                                                        1IO17960
*                           START SYNC CHAIN                            1IO17970
PSTR8  XCA                         PUT BUF READ IN AC                  $1IO17980
       STA     4,2                                                      1IO17990
       LDQ     L(0)D                                                    1IO18000
       LGL     18                                                       1IO18010
       STA*    4,2                 L(1) IN BUF CW                      $1IO18020
       TRA     PSTR3                                                    1IO18030
       TTL     SELECT (+) ENTRY                                         1IO18040
*                      SIGN OF UCW WD2 0-RD 1-WR                        1IO18050
*                        INSERTS *+1 INTO IORT                          1IO18060
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   1IO18070
*                   AND INCREMENTS IT IN FILE WORDS                     1IO18080
       SPACE   1                                                        1IO18090
SELP   LDI     1,2                 FILE BITS TO SI                      1IO18100
       IFT     NOCHX=0                                               $5$1IO18101
       GOTO    S3.5                                                  $5$1IO18102
       CLA     CHATY                                                   $1IO18110
       IFT     NOHYP=0                                               $5$1IO18111
       GOTO    S3.2                                                  $5$1IO18112
       LBT                         UNIT TYPE TEST                      $1IO18120
       TNZ     HYPL                HYPER                               $1IO18130
S3.2   TNZ     DRWRS               DISK                              $5$1IO18140
S3.5   LFT     MXDMD               IF MIXED MODE                     $5$1IO18160
       TRA     MXMP                SKIP OUT                             1IO18170
S4     CLA     1,4                 GET ADDRESS OF                       1IO18180
       ACL     L(1)                THE IORT TO BE USED                  1IO18190
       STA*    .RCHX                                                 $5$1IO18200
       STA     S1+1                                                     1IO18210
S1     ACL     L(1)                                                     1IO18220
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      1IO18230
       CLA     1,2                 FORM SELECT                          1IO18240
       ANA     MODBT               INSERTING TAPE MODE BIT              1IO18250
       ARS     7                                                        1IO18260
       TNZ     *+2                                                      1IO18261
       STZ     MODSW                                                    1IO18262
       ORA     0,4                                                      1IO18270
RWRS   ARS     18                                                       1IO18280
       STA     SELCT               UNIT ADDRESS TO SELECT               1IO18290
       CLA     S2                                                       1IO18300
       LDQ     1,4                                                      1IO18310
       TQP     *+2                 RDS IN SELECT                        1IO18320
       ALS     15                  WRS IN SELECT                        1IO18330
       STD     SELCT                                                    1IO18340
       ZET*    CHEXI                                                    1IO18341
SELCT  RDS     **                  SEL                                  1IO18350
       XEC*    .RCHX               RCHX                              $5$1IO18360
S3     AXT     **,4                                                     1IO18370
       AXT     **,1                                                     1IO18380
       TRA     1,4                 RETURN TO IOEX                       1IO18390
S2     OCT     076200766000        RDS...WRS                            1IO18400
       TTL     7909 CHANNEL SELECT ROUTINES                             1IO18410
MSELT  NULL                                                          $5$1IO18411
       IFT     NOHYP=0                                               $5$1IO18412
       GOTO    MSEL                                                  $5$1IO18413
       LBT                         DISK                                $1IO18420
       TRA     HSELM               NO                                  $1IO18430
MSEL   NULL                                                          $5$1IO18441
       IFT     NOCH=0                                                $5$1IO18442
       GOTO    HBEG                                                  $5$1IO18443
       LFT     7100                                                  $5$1IO18450
       TRA     DERR+1                                                  $1IO18460
       LDI     0,2                                                     $1IO18470
       CLA*    1,4            GET FLAG WORD USED                       $1IO18480
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $1IO18490
       ADD     L(1)           FOR THIS OPERATION                       $1IO18500
       STA     *+3                                                     $1IO18510
       LFT     200000              EOF FROM LAST READ                  $1IO18520
       TRA     SEOFI               YES                                 $1IO18530
       LDI     **             PUT FLAG WORD IN INDICATORS              $1IO18540
       LNT     400000              IS RECORD COMPLETE                  $1IO18550
       TRA     FINREC         NO-FINISH RECORD                         $1IO18560
       LFT     200000         EOF OCCUR                                $1IO18570
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $1IO18580
       LDI     FOR            SET INDICATORS AS 7607                   $1IO18590
SELM2  CLA     1,2                 IF MIXED MODE                        1IO18600
       TMI     1KA                 SKIP OUT                             1IO18610
       CAL     1,4                                                      1IO18620
       SUB     L(1)                                                    $1IO18630
       SXA     *+3,4          SAVE IR4                                 $1IO18640
       PAC     0,4            IR4=-L(COMM-1)                           $1IO18650
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $1IO18660
SELM5  AXT     **,4                RESTORE IR4                         $1IO18670
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $1IO18680
       CLA     1,4                 PUT ADDRESS OF                      $1IO18690
       PAC     0,1                 COMD CHAIN IN IR 1                  $1IO18700
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $1IO18710
       STZ     1,1                 ZERO OUT COUNT SAVED                $1IO18720
       CAL     8,1                                                     $1IO18730
       ACL     L(1)                                                    $1IO18740
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $1IO18750
       CAL     FCW                 RESTORE IORT                        $1IO18760
       STP     -1,1                IN BUFFER                           $1IO18770
       LDQ     1,4                                                     $1IO18780
       NZT*    1,4                 IF ZERO-ZERO OUT                    $1IO18790
       TRA     *+4                 AND KILL SEEK                       $1IO18800
       LFT     200000              IF EOF                              $1IO18810
       TRA     *+3                 KILL SEEK OR                        $1IO18820
       TRA     *+4                 ELSE PROCEED                        $1IO18830
       STZ     1,4                                                     $1IO18840
       CAL     2,4                                                     $1IO18850
       STO     2,4                                                     $1IO18860
       TQP     SELM4               IF MQ + READ IS DONE                $1IO18870
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $1IO18880
       TRA     SELM3               GO POST WRITE COMPLETION            $1IO18890
SELM4  CAL     *+1                                                     $1IO18900
       XCA     **                  MQ = ADDRESS OF BUF CW              $1IO18910
       SXA     C8,1                                                    $1IO18920
       CAL     -1,1                PICK UP COUNT FROM FLAG             $1IO18930
 ER    AXT     **,1                                                    $1IO18940
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $1IO18950
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $1IO18960
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $1IO18970
       LFT     200000              IF EOF GO                           $1IO18980
       TSX     EOF,4               TAKE CARE OF IT                     $1IO18990
       CLA     4,2                 PICK UP AND                         $1IO19000
       PDC     0,4                 RESTORE THE                         $1IO19010
       CAL     1,4                 BUFFER SIZE                         $1IO19020
       ARS     4                   IN THE IORT                         $1IO19030
       STD     -1,1                NOW GO POST                         $1IO19040
       XEC     SELM5               READ COMPLETION                     $1IO19050
       TRA     POSTR+2             SOME JOB                            $1IO19060
EOF    ENB     L(0)                                                    $1IO19070
       LDQ     0,2                 EXCHANGE START AND                  $1IO19080
       CAL     6,2                 FINISH OF FILE                      $1IO19090
       LGL     18                  PUT A MINUS                         $1IO19100
       STD     0,2                 IN WORD SEVEN                       $1IO19110
       STA     6,2                 TO INDICATE SPECIAL                 $1IO19120
       CLS     6,2                 HANDLING NEEDED                     $1IO19130
       STO     6,2                 FOR NEXT DATA OPER.                 $1IO19140
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $1IO19150
       TRA     1,4                 GO HOME                             $1IO19160
DEOF1  NZT     1,4            IF LAST BUFFER                           $1IO19170
       TRA     PSTR6          DO NOTHING                               $1IO19180
       CAL*    1,4                 DISK OPERATIONS                     $1IO19190
       STZ*    1,4                 ARE DONE FOR NOW                    $1IO19200
       STA     1,4                 RESTORE REQUEST CHAIN               $1IO19210
       TRA     PSTR2               AS TAPE (UCB2)                      $1IO19220
FINREC LFT     200000              IOCS EOF                            $1IO19230
       TRA     DEOF                YES                                 $1IO19240
       CLA     1,4                                                     $1IO19250
       PAC     0,1            -L(COMMANDS)IN IR1                       $1IO19260
       CLA     L(STL               IF READ HAS FILLED                  $1IO19270
       ERA     1,1                 BUFFER AREA,GO BACK                 $1IO19280
       TNZ     *+3                 AS FINISHED RECORD                  $1IO19290
       LXA     S3+1,1                                                  $1IO19300
       TRA     SEOF+1                                                  $1IO19310
       CLA     1,1            PICK UP AND COUNT                        $1IO19320
       SXA     *+2,2                                                   $1IO19330
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $1IO19340
D7     AXT     **,2                RESTORE IR2                         $1IO19350
       CLA     1,4            READ OR WRITE                            $1IO19360
       TPL     D4                  READ                                $1IO19370
       CAL     6,2                 UPDATE NEXT TRACK                   $1IO19380
       ACL     L(2)                TO BE USED BY FILE                  $1IO19390
       ALS     18                  STORE IN FLAG WORD                  $1IO19400
       STD*    8,1                                                     $1IO19410
 D4    CAL     9,1                 PUT THE NEXT READ                    1IO19420
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (3)1IO19430
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (3)1IO19431
       LXA     D7,2         RESTORE IR2                              (3)1IO19432
       STA     9,1            COMMAND                                  $1IO19440
       SXA     *+2,1                                                   $1IO19450
       TSX     CKSEE,1        IS SEEK NECESSARY                        $1IO19460
       AXT     **,1           RESTORE IR1                              $1IO19470
       CLA     6,2            CREATE BCD CHARACTERS                    $1IO19480
       SXA     *+2,4          FOR THE NEXT PREPARE                     $1IO19490
       TSX     .DECVA,4            TO VERIFY COMMAND                 $5$1IO19500
       AXT     **,4                                                    $1IO19510
       CLA     6,2            GET REC LAB                              $1IO19520
       ADD     TRKC                UP TRACK COUNT                      $1IO19530
       SLW     6,2                 FOR RECORD                          $1IO19540
       ARS     6                   AND PUT IN                          $1IO19550
       STO     *+2            P.V. WORD                                $1IO19560
       TSX     .FDAMT,2                                              $5$1IO19570
       PZE                                                             $1IO19580
       PZE     12,1                                                     1IO19590
       TRA     S3             RETURN TO IOEX                           $1IO19600
DERR   PZE     0                   FLAG FOR ERROR IN HA2, FORMAT, ETC. $1IO19610
       LNT     100                 INTERFACE CHECK                     $1IO19620
       TRA     *+4                 NO                                  $1IO19630
       AXC     *+1,4               SET SWITCH FOR SEL+                 $1IO19640
       SXA     CHATT-1,4           RETURN 2,4                          $1IO19650
       TRA     DCHG                                                    $1IO19660
       CLA     1,4                 GET COMMAND LIST ADDRESS            $1IO19670
       PAC     0,1                 FOR STZ OPERATION                   $1IO19680
       STO     DERR                SET UNUSUAL END FLAG                $1IO19690
       STZ     1,4                 ZERO OUT REQUEST                    $1IO19700
       CLA     4,2                 GET BUFFER POOL                     $1IO19710
       PDC     0,4                 AND PLACE IT IN IR4                 $1IO19720
       CLA     0,1                 GET BUFFER IN USE                   $1IO19730
       STZ     ,1                  ZERO OUT COMMAND LIST               $1IO19740
       STZ     1,1                 CONTROL WORDS                       $1IO19750
DERG   PAC     0,1                 RESTORE                             $1IO19760
       STA     *-1                 IORT                                $1IO19770
       CLA     FCW                 AND                                 $1IO19780
       STP     1,1                 BUFFER                              $1IO19790
       CLA     1,4                 COUNT                               $1IO19800
       ARS     4                                                       $1IO19810
       STD     1,1                                                     $1IO19820
       CLA     DERG                                                    $1IO19830
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $1IO19840
       TRA     S3                  GO BACK                             $1IO19850
TRKC   OCT     010000000000                                            $1IO19860
TRKRC  OCT     007777777777                                            $1IO19870
SEOH   CLA     SIX                 SET EOF BIT ON                      $1IO19880
       STP     0,2                 FOR STRANGE EOF                     $1IO19890
       TRA     SEOF+1              FINISH READ                         $1IO19900
SEOFI  RIL     200000              TURN OFF                            $1IO19910
       STI     0,2                 STRANGE EOF                         $1IO19920
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *1IO19930
       TRA     SELM2                                                   *1IO19940
       TTL     SELECT PLUS FOR 7909 CHANNEL                             1IO19950
DRWRS  CLA     1,4                                                      1IO19960
       PAX     0,1                 IF THIS IS A LIST WORD               1IO19970
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        1IO19980
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             1IO19990
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     1IO20000
       TZE     *+3                                                      1IO20010
       TIX     *-2,1,14            CHANGE DECR IF LENGTH IS ALTERED  $5$1IO20020
       TRA     DER1                                                     1IO20030
       PXA     0,1                                                      1IO20040
       SUB     DRWRX                                                    1IO20050
       PAC     0,1                                                     $1IO20060
       STA     D6-3                SAVE LIST ADDRESS                    1IO20070
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          1IO20080
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  1IO20090
       CLA*    1,4                 GET BUFFERS AHEAD                   $1IO20100
       STD     0,1                                                      1IO20110
       CLA     D6-3                PICKUP LIST ADDRESS AND              1IO20120
       STA     1,4                 PUT IT IN UCW 2                      1IO20130
       CLA     1,4                                                     $1IO20140
DRWRW  LXA     S3+1,1              RESTORE IR 1                         1IO20150
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         1IO20160
       TPL     *+2                 READ                                $1IO20170
       ACL     L(3)                WRITE                               $1IO20180
       STA*    .RCHX               SET START CHAN INST               $5$1IO20190
       ZET*    .URRX               FIRST TIME THRU                   $5$1IO20200
       TRA     C3                  NO                                  $1IO20210
       LXA     CHATT-1,1           WAS CHANNEL                         $1IO20220
       SXA     CHATT-1,0           LIST SET UP                         $1IO20230
       TXH     C3,1,0              YES                                 $1IO20240
       STA     C7                                                      $1IO20250
       CLA     1,4                 ADDRESS OF COMMD                    $1IO20260
       PAC     0,1                 LIST TO IR1                         $1IO20270
       ZET     1,1                 PARTIAL RECORD                      $1IO20280
       TRA     C3                  YES START CHANNEL                   $1IO20290
DRWRS1 CLA     L(6)                BCD MODE                            $1IO20300
       LNT     MODE                                                    $1IO20310
       CLA     L(22)               BINARY MODE                         $1IO20320
C7     STA     **                  ADDRESS OF SMS                      $1IO20330
       CLA     0,1            ADDRESS OF BUFFER                        $1IO20340
       ACL     L(1)                                                    $1IO20350
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $1IO20360
       ACL     L(1)                                                    $1IO20370
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $1IO20380
       CLA*    8,1            PICK UP COUNT                            $1IO20390
       ARS     18                  MOVE COUNT OVER                     $1IO20400
       ANA     ADDRS               MASK ALL BUT ADDRESS                $1IO20410
       SXA     *+2,2                                                   $1IO20420
       TSX     SIZE,2         CHECK RECORD SIZE                        $1IO20430
C9     AXT     **,2                                                    $1IO20440
       CAL     6,2                 CREATE BCD CHARACTER                $1IO20450
       ANA     TRKRC               CHANGE THE TRACK                    $1IO20460
       ADD     TRKC                COUNT TO ONE FOR RECORD             $1IO20470
       SLW     6,2                 PUT BACK TO FCB                     $1IO20480
       SXA     *+2,4          FOR PV COMMAND                           $1IO20490
       TSX     .DECVA,4                                              $5$1IO20500
C2     AXT     **,4                                                    $1IO20510
       CAL     6,2                 GET SEEK ADDRESS                    $1IO20520
       ADD     L(1)                                                    $1IO20530
       ALS     18                  MOVE SEEK ADDRESS OVER              $1IO20540
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $1IO20550
       CAL     6,2                 LABEL FOR                           $1IO20560
       ARS     6                   RECORD ADDRESS                      $1IO20570
       STO     *+2                                                     $1IO20580
       TSX     .FDAMT,2            PLACE P.V. COMMAND                $5$1IO20590
       PZE                    BITS IN PROPER PLACE                     $1IO20600
       PZE     12,1                                                     1IO20610
       XEC     C9                  RESTORE IR2                         $1IO20620
       CLA     *-3                 SET INTERFACE BIT                   $1IO20630
       ANA     L(1)                ON FOR SMS INST.                    $1IO20640
       ORS*    C7                                                      $1IO20650
C3     XEC     S3+1                RESTORE IR1                         $1IO20660
       CAL     0,2                 IS THERE A STRANGE                  $1IO20670
       ALS     1                   EOF ON THIS FILE -                  $1IO20680
       PBT                                                             $1IO20690
       TRA     S3-1                NO                                  $1IO20700
       XEC     C2                  YES - RESTORE XR4                   $1IO20710
       CLA*    1,4                 YES                                 $1IO20720
       ACL     L(1)                GET FLAG WORD                       $1IO20730
       STA     DRWRS2              ADDRESS AND SAVE                    $1IO20740
       CAL     6,2                 GET SEEK ADDRESS                    $1IO20750
       SUB     L(1)                MINUS 1 AND STORE                   $1IO20760
       STA     3,4                 IN UCB 4 AND FCB 7                  $1IO20770
       STA     6,2                                                     $1IO20780
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $1IO20790
       AXT     SYSTWT,2            START CHANNEL                       $1IO20800
       PXA     0,2                 FOR A                               $1IO20810
       STA*    .RCHX               TRAP                              $5$1IO20820
       TRA     S3-1                GO                                  $1IO20830
L(3)   PZE     3                                                        1IO20840
LCOMAD NULL                                                          $5$1IO20841
       DUP     13,NOCH                                               $5$1IO20844
       PZE                         CHAIN TO BUFFERS                  $5$1IO20850
       PZE                         COUNT FOR MULTI TRACK RECORD        $1IO20860
       SMS     **                  SET MODE FOR READ                   $1IO20870
       CTLR    *+9            PREPARE DISK FOR READ.                    1IO20880
       TCH     *+4                 GO DO DATA MOVEMENT                 $1IO20890
       SMS     **                  SET MODE FOR WRITE                  $1IO20900
       LCC     0                   COUNTER FOR WRITE CHECK             $1IO20910
       CTLW    *+5            PREPARE DISK FOR WRITE                    1IO20920
       CPYP    **,,1               FLAG WORD MOVEMENT                  $1IO20930
       CPYP    **,,**              DATA MOVEMENT                       $1IO20940
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $1IO20950
       TCH     SYSTWT              INTERUPT CPU                        $1IO20960
       DVTA    ,,                                                      $1IO20970
ENDLIS NULL                                                          $5$1IO22150
       TTL 0                                                           $1IO22160
*                                                                      $1IO22170
*              TSX CKSEE,1                                             $1IO22180
*              RETURN                                                  $1IO22190
*                                                                      $1IO22200
*                                                                      $1IO22210
CKSEE  CAL     6,2            UPDATE SEEK                              $1IO22220
       ACL     L(4)                                                    $1IO22230
       ERA     7,2            ADDRESS                                  $1IO22240
       ANA     ADDRS                                                   $1IO22250
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $1IO22260
       TXH     D9,1,-TEMIND                                            $1IO22270
       CAL     6,2                                                     $1IO22280
       ADD     L(1)                                                    $1IO22290
       STA     6,2            NEXT ADDRESS FOR SEEK                    $1IO22300
       CAL     3,4                                                     $1IO22310
       ADD     L(1)                                                    $1IO22320
       STA     3,4                 UPDATE SEEK ADDRESS                 $1IO22330
       ERA     6,2                 SAME ARM POSITION                   $1IO22340
       ANA     ADDRS               AS DESIRED                          $1IO22350
       TZE     D8                  YES                                 $1IO22360
D9     CAL     6,2                 NO, PUT DESIRED                     $1IO22370
       STA     3,4                 POSITION IN REQUEST                 $1IO22380
       TRA     D6                  AND ASK FOR SEEK                    $1IO22390
D8     CLA     3,4                 GET POSITION AND                    $1IO22400
       ANA     ADDRS          CHECK IF ANOTHER                         $1IO22410
       XCA                    SEEK NEC. NOW                            $1IO22420
       PXA     **,0                                                     1IO22430
       DVP     L(40)                                                   $1IO22440
       TNZ     1,1            RETURN IF NO SEEK                        $1IO22450
D6     CLS     2,4            SET 3RD UCW TO                           $1IO22460
       STO     2,4            DEMAND A SEEK                            $1IO22470
       TRA     1,1                                                     $1IO22480
*                                                                      $1IO22490
*              COUNT IN ACC                                            $1IO22500
*              TSX SIZE,2                                              $1IO22510
*              RETURN                                                  $1IO22520
*                                                                      $1IO22530
 SIZE  SXA     C11,2        SAVE IR2                                 (3)1IO22540
       XCA                  SAVE COUNT                               (3)1IO22550
       CAL     0,4          UCW1                                     (3)1IO22560
       ARS     6            MOVE AND                        7=1302   (3)1IO22570
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (3)1IO22580
       PDX     0,2          DEVICE TO IR2                   1=1301   (3)1IO22590
 SVCOD XCA     **           RESTORE COUNT IN AC. INST ADDR SAVES CODE(3)1IO22600
       TIX     *+1,2,5      IF 1302,MAKE CODE A 2                    (3)1IO22610
       SXA     *-2,2        SAVE THE CODE                            (3)1IO22620
       SUB     L(STL,2      SUB FULL TRACK FROM WORD COUNT           (3)1IO22630
       TMI     D1           LESS THAN OR                             (3)1IO22640
       TZE     D1           EQUAL TO FULL TRACK TRA TO D1            (3)1IO22650
       STA     1,1          SAVE EXTRA WORD COUNT                    (3)1IO22660
       CLA     L(STL,2      GET FULL TRACK                           (3)1IO22670
 C1    SLW*    8,1          PUT IN FLAG WORD                         (3)1IO22680
       ALS     18           PUT COUNT IN                             (3)1IO22690
       STD     9,1          COPY COMMAND                             (3)1IO22700
 C11   AXT     **,2         PREPARE TO RETURN                        (3)1IO22710
       TRA     1,2          RETURN                                   (3)1IO22720
 D1    ADD     L(STL,2      GET COUNT BACK                           (3)1IO22730
       STL     1,1          MAKE FALSE COUNT                         (3)1IO22740
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (3)1IO22750
       TXI     C1,0,7       FINISH UP                                (3)1IO22760
 ENTRK CLA     TRKRC        SET END OF TRACK                         (3)1IO22770
       STT     6,2          INDICATION IN FCW7                       (3)1IO22780
       TRA     CKSEE+5      AND RETURN                               (3)1IO22790
       PZE     524          7320 DRUM TRACKSIZE                      (3)1IO22800
       PZE     969          1302 DISK TRACKSIZE                      (3)1IO22801
       PZE     465          1301 DISK TRACKSIZE                      (3)1IO22802
 L(STL PZE     D2           LOCATION OF STL FOR LATER COMPARE        (3)1IO22803
HBEG   NULL                                                          $5$1IO22811
       IFT     NOHYP=0                                               $5$1IO22812
       GOTO    DER2                                                  $5$1IO22813
       DUP     10,NOHYP                                              $5$1IO22814
       SMS     **                  SET INTERFACE                     $5$1IO22820
       LIPT    *+1                 LEAVE INTERUPT STATUS               $1IO22830
       CTLR    *+7                 SELECT FOR READ                     $1IO22840
       TCH     *+3                 DO IO                               $1IO22850
       SMS     **                  SET INTERFACE                       $1IO22860
       CTLW    *+4                 SELECT FOR WRITE                    $1IO22870
       CPYP    **,,**              DO IO                               $1IO22880
       CPYD    0,,0                                                    $1IO22890
       TCH     SYSTWT              INTERUPT                            $1IO22900
       OCT     120600120112        HSEL AND EOS                        $1IO22910
HEND   NULL                                                          $5$1IO23220
       PZE     HEND                                                    $1IO23230
       TTL     SELECT ROUTINES FOR HYPER                                1IO23240
HYPL   CLA     3,4                 IF REINSTRUCT                       $1IO23250
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $1IO23260
       AXT     HEND-HBEG+3,1       FIND CH LIST POINTER              $5$1IO23270
       SXA     HSXA,1              SAVE CH. LIST POINTER               $1IO23280
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $1IO23290
       ANA     DECRE               THIS CHANNEL TO USE                 $1IO23300
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $1IO23310
       ARS     18                                                      $1IO23320
       SUB     S3+1                                                    $1IO23330
       ANA     ADDRS                                                   $1IO23340
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $1IO23350
       TIX     HYPL+3,1,HEND-HBEG+3/NOHYP                            $5$1IO23360
       TRA     DER1                                                    $1IO23370
       LXA     S3+1,1              GET CHANNEL NO                      $1IO23380
       PXD     0,1                                                     $1IO23390
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $1IO23400
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $1IO23410
       PXA     0,1                 COMPUTE THE                         $1IO23420
       SUB     HEND                CHANNEL LIST                        $1IO23430
       STA     HSXA                START ADDRESS                       $1IO23440
       CLA     1,4                                                     $1IO23450
       ACL     L(1)                                                    $1IO23460
       STA     S0                  SAVE ADDRESS OF IORT                $1IO23470
       ACL     L(1)                PUT LOCATION OF                     $1IO23480
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $1IO23490
       STA     6,1                 ADDRESS FOR START CH.               $1IO23500
       XCA                         SAVE READ OR WRITE                  $1IO23510
S0     CLA     **                  GET NO. OF WORDS                     1IO23520
       STD     6,1                 STORE IN COPY                        1IO23530
       RNT     400000              READ BACKWARD                        1IO23540
       TRA     *+4                 NO                                   1IO23550
       ARS     18                  PUT LAST LOCATION                    1IO23560
       ACL     S0                  OF BUFFER IN                         1IO23570
       STA     6,1                 COPY COMMAND                         1IO23580
       CLA     3,4                 IS THIS A REINSTRUCT                 1IO23590
       TZE     HNSL                NO                                   1IO23600
       CLA     HYCLN               TURN OFF THE                         1IO23610
       ORS     2,1                 CONTROL OPERATION                    1IO23620
       ORS     5,1                                                      1IO23630
       LXA     S3+1,1                                                   1IO23640
       NZT*    .URRX               IF NO ERROR                       $5$1IO23650
       TRA     S3-1                START CHANNEL                        1IO23660
HNSL   CAL     HSXA                SMS ADDRESS                         $1IO23670
       STA     3,4                 SAVE CH LIST IN UCW4                $1IO23680
       TQP     *+2                 READ                                 1IO23690
       ADD     L(4)                WRITE                               $1IO23700
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $1IO23710
       STA*    .RCHX               START CHANNEL ADDRESS             $5$1IO23720
       ZET*    .URRX               BACK ON ERROR CONDITION           $5$1IO23730
       TRA     S3-1                YES, START CHANNEL                  $1IO23740
       CLA     CHATT-1             IF RETURN FROM                      $1IO23750
       ANA     ADDRS               SEL-WITH INTERFACE                  $1IO23760
       SXA     CHATT-1,0           NOT READY, THEN                     $1IO23770
       TNZ     S3-1                JUST TRY AGAIN                      $1IO23780
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $1IO23790
       CLA     0,4                 SAVE UNIT                           $1IO23800
       ANA     DEC15               NO. IN SEL ORDER                    $1IO23810
       ORA     HYSEL                                                   $1IO23820
       RFT     400000              IS THIS READ BACKWARD               $1IO23830
       ORA     L(64D)              YES, FIX SEL ORDER                  $1IO23840
       STD     9,1                                                     $1IO23850
       CLA     HYCTL               SET CONTROL                         $1IO23860
       ANS     2,1                 OPERATION ON                        $1IO23870
       ANS     5,1                                                     $1IO23880
       CLA     HSMSN               SET UP SMS COMMAND                  $1IO23890
       LNT     004000              IF OFF BCD MODE                     $1IO23900
       ORA     L(22)                                                   $1IO23910
       RFT     400000                                                  $1IO23920
       ORA     HSMSR               BACKWARD READ                       $1IO23930
       LDI     0,4                 PUT THE                             $1IO23940
       LFT     40                  INTERFACE                           $1IO23950
       ORA     L(1)                IN SMS                              $1IO23960
       STA     0,1                                                     $1IO23970
       STA     4,1                                                     $1IO23980
       LXA     S3+1,1                                                  $1IO23990
       TRA     S3-1                                                    $1IO24000
       TTL     SELECT MINUS FOR HYPER                                   1IO24010
HSELM  CLA     1,4                 UCW 2 TO AC                         $1IO24020
       ACL     L(1)                IORT ADDRESS OF BUF                 $1IO24030
       STA     HIORT                                                   $1IO24040
       ACL     L(1)                                                    $1IO24050
       LFT     7100                ERROR                               $1IO24060
       TRA     HEROR               YES                                 $1IO24070
       ALS     18                  DEC= 1ST WORD WRITTEN               $1IO24080
       STD     .COMM               SAVE AS 7607 CH.                  $5$1IO24090
HIORT  CLA     **                  LAST WORD WRITTEN                   $1IO24100
       STD     .COMM               SAVE AS 7607 CH.                  $5$1IO24110
HRETN  CAL     S3                  FIX EXIT                            $1IO24120
       SUB     L(1)                FOR CONTINUED                       $1IO24130
       STA     S3                  PRIORITY ON UNIT                    $1IO24140
       CLA     1,2                 IF MIXED MODE                        1IO24150
       TPL     SELM1               SKIP OUT AFTER                       1IO24160
       STZ     3,4                 REINSTRUCT IS                        1IO24170
       TRA     MXMOD+3             MAKE IMPOSSIBLE                      1IO24180
HSMRD  LDI     FOR                 GOOD READ                           $1IO24190
       LDQ     .COMM               MAKE COMM LOOK                    $5$1IO24200
       LGL     18                  LIKE 7607 CHANNEL                   $1IO24210
       SLW     .COMM                                                 $5$1IO24220
       ANA     ADDRS                                                   $1IO24230
       LDQ     1,4                                                     $1IO24240
       RQL     1                   TYPE READ                           $1IO24250
       TQP     HREAD               READ FORWARD                        $1IO24260
       LNT     200000              END OF FILE TEST                    $1IO24270
       TNZ     *+2                 IF LONG LENGTH RECORD               $1IO24280
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $1IO24290
       ACL     L(1)                ELSE IT POINTS AT LAST              $1IO24300
       STA     .COMM               WORD READ                         $5$1IO24310
HREAD  TNZ     HRETN                                                   $1IO24320
       CAL     .COMM               MAKE IT POINT AT                  $5$1IO24330
       ADD*    HIORT               LAST REC IN BUFF+1                  $1IO24340
       ARS     18                  IF LONG RECORD READ                 $1IO24350
       TRA     HREAD-1                                                 $1IO24360
HEROR  RFT     377777              NCI INTERRUPT                        1IO24370
       TRA     *+2                 NO                                  $1IO24380
       TRA     HSMRD               YES                                 $1IO24390
       LNT     100                 INTERFACE CHECK                     $1IO24400
       TRA     *+4                 NO                                  $1IO24410
       AXC     *+1,4               SET SWITCH FOR SEL+                 $1IO24420
       SXA     CHATT-1,4           RETURN 2,4                          $1IO24430
       TRA     DCHG                                                    $1IO24440
       RFT     020014                                                  $1IO24450
       TRA     HYSEL+1             EOT, EOF, BOT                       $1IO24460
       LDI     1,4                                                     $1IO24470
       LFT     400000                                                  $1IO24480
       TRA     *+3                 WRITE ERROR                         $1IO24490
       LDI     1PRE                READ ERROR                          $1IO24500
       TRA     HSMRD+1             GO POST                             $1IO24510
       CAL     S3                                                      $1IO24520
       SUB     L(2)                CHANGE EXIT                         $1IO24530
       STO     S3                  TO 3,4                              $1IO24540
       CLA*    .URRX               UPDATE ERROR                      $5$1IO24550
       ACL     5,2                                                     $1IO24560
       SLW     5,2                 HISTORY AND TRY                     $1IO24570
       TRA     S3                  TO WRITE AGAIN                      $1IO24580
HSMSR  OCT     000000000040        CONSTANTS                           $1IO24590
HSMSN  OCT     000000000106        FOR                                 $1IO24600
HYCTL  OCT     757777777777        HYPER                               $1IO24610
HYCLN  OCT     020000000000        SELECT                              $1IO24620
HYSEL  OCT     120600120112                                            $1IO24630
       LDI     SIX                                                     $1IO24640
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE              1IO24650
       TPL     HSMRD+1             READ EOF                            $1IO24660
       TRA     HIORT-2             WRITE EOT                           $1IO24670
DER2   NULL                                                          $5$1IO24681
       IFT     NOCHX=0                                               $5$1IO24681
       GOTO    BTP1                                                  $5$1IO24682
DER1   STL     DERR                                                    $1IO24690
       STZ     1,4                 ZERO OUT UCW2                       $1IO24700
       TRA     DCHG                RETURN 2,4                          $1IO24710
       TTL                         BTP (BUFFER TO POOL) ROUTINE         1IO24730
*              TSX BTP,1                                                1IO24740
       SPACE   1                                                        1IO24750
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           1IO24760
*              MQ                  TSX BTP1,1                           1IO24770
       SPACE   1                                                        1IO24780
BTP1   XCA                         L(BUF. IN USE IN AC                 $1IO24790
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $1IO24800
       STA     0,4                 PUT BUF IN USE BACK                 $1IO24810
       XCA                         BUF FROM CHAIN IN AC                $1IO24820
       STZ*    0,4                 ZERO IN BUF CW                      $1IO24830
       STA*    0,4                 ADDRESS OF CHAIN                    $1IO24840
       TRA     1,1                                                      1IO24850
       SPACE   1                                                        1IO24860
*                      URC (UPDATE REQUEST CHAIN)                       1IO24870
*                       IR4 = -L(UCW) TSX URC1,1                        1IO24880
       SPACE   1                                                        1IO24890
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $1IO24900
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $1IO24910
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $1IO24920
       NZT*    1,4                 LOC OF ZERO                         $1IO24930
       TRA     *+3                                                      1IO24940
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $1IO24950
       TRA     1,1                                                      1IO24960
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $1IO24970
       TRA     1,1                                                      1IO24980
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      1IO24990
*                    IN SEARCHING OUTPUT FILE CHAIN                     1IO25000
       SPACE   1                                                        1IO25010
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              1IO25020
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               1IO25030
       SPACE   1                                                        1IO25040
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      1IO25050
       TSX     EOTOF,1             HANDLE EOT                           1IO25060
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           1IO25070
       TRA     GET0+1              AND IR2 THEN EXIT                    1IO25080
       SPACE   1                                                        1IO25090
*                       EOT HANDLER OUTPUT FILE                         1IO25100
       SPACE   1                                                        1IO25110
*      TSX     EOTOF,1             IR2 = -L(FILE)                       1IO25120
*      RETURN                      INDICES NOT DISTURBED                1IO25130
       SPACE   1                                                        1IO25140
EOTOF  SXA     ETOF5,4             SAVE IR4                             1IO25150
       SXA     ETOF6,1             IR1                                  1IO25160
       TSX     NDSEL+1,4           WEF ON OLD                           1IO25170
       PZE     0,2,WEFOP           FILE                                 1IO25180
       NOP                         IGNORE EOT                           1IO25190
       TSX     SWITCH,1            SWITCH REELS                         1IO25200
       SIL     NOEOT               SET NO EOT CONDITION                 1IO25210
       NZT*    4,2                 IF NO SELECTS TO DO                  1IO25220
       TRA     ETOF5               SKIP OUT                             1IO25230
       CLA     4,2                 SET EOT CHAIN OF SELECTS             1IO25240
       STA     ETOF7               INTO UCW OF                          1IO25250
       CAL     ETOF7               NEW REEL                             1IO25260
       AXC     1,4                                                      1IO25270
       ZET*    0,2                                                      1IO25280
       TRA     *-1                                                      1IO25290
       ORS*    0,2                                                      1IO25300
       CLA     L(0)A               SET EOT CHAIN                        1IO25310
       STA     4,2                 = 0                                  1IO25320
       TSX     .ACTV+1,4           ACTIVATE                          $5$1IO25330
       PZE     0,2                 NEW REEL                             1IO25340
ETOF5  AXT     **,4                RESTORE IR4                          1IO25350
ETOF6  AXT     **,1                IR1                                  1IO25360
       TRA     1,1                 EXIT                                 1IO25370
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          1IO25380
       TTL                         REEL SWITCHING ROUTINE               1IO25390
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  1IO25400
*      RETURN                      INDICES NOT DISTURBED                1IO25410
       SPACE   1                                                        1IO25420
*                               ACTIONS                                 1IO25430
*            1. REWINDS UNLOADS OLD REEL                                1IO25440
*            2. SWITCHES TO ALTERNATE UNIT                              1IO25450
*            3. PRINTS MESSAGE TO OPERATOR                              1IO25460
*            4. ADVANCES REEL SEQ. NUMBER                               1IO25470
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  1IO25480
       SPACE   1                                                        1IO25490
SWITCH SXA     SW3,4               SAVE IR4                             1IO25500
       IFT     NOHYP=0                                               $5$1IO25501
       GOTO    SW1                                                   $5$1IO25502
       LDQ     5,2                                                     $1IO25510
       RQL     1                   HYPER                               $1IO25520
       TQP     *+9                 NO                                  $1IO25530
       STI     TEMP                                                    $1IO25540
       LDI     1,2                                                     $1IO25550
       LFT     OUTPUT                                                  $1IO25560
       RNT     100000              FILE PROTECT                        $1IO25570
       TRA     *+3                 NO                                  $1IO25580
       TSX     .NDSEL+1,4                                            $5$1IO25590
       PZE     0,2,HFPNP                                               $1IO25600
       RFT     200000              UNLOAD                               1IO25610
       TRA     *+4                 NO                                  $1IO25620
       TSX     .NDSEL+1,4                                            $5$1IO25630
       PZE     0,2,HUNLP                                               $1IO25640
       TRA     *+3                                                     $1IO25650
 SW1   TSX     NDSEL+1,4          REWIND UNLOAD                      $5$1IO25670
       PZE     0,2,RUNOP           OLD REEL                             1IO25680
       TRA     EOTPCH                                                (5)1IO25690
       SIL     NINHIB              UN-INHIBIT FILE                      1IO25700
       IFT     NOHYP=0                                               $5$1IO25701
       GOTO    SW3                                                   $5$1IO25702
       LDQ     5,2                                                     $1IO25710
       RQL     1                                                       $1IO25720
       TQP     *+6                                                     $1IO25730
       RNT     100000                                                  $1IO25740
       TRA     *+3                                                     $1IO25750
       TSX     .NDSEL+1,4                                            $5$1IO25760
       PZE     0,2,HFPNP                                               $1IO25770
       LDI     TEMP                                                    $1IO25780
SW3    AXT     **,4                RESTORE IR4                          1IO25800
       TRA     1,1                 EXIT                                 1IO25810
*                   ROUTINE TO REVERSE FILE CONTROLS                    1IO25820
*                   SI AND IR2 FROM FILE A TO FILE B                    1IO25830
CPY6   XCA     **                  SAVE AC                              1IO25840
       ENB     L(0)                TRAP PROTECT                         1IO25850
       PIA                         RESTORE CONTROL                      1IO25860
       STD     1,2                 BITS TO FILE                         1IO25870
       LXA     CPY7,1              SWITCH                               1IO25880
       LXA     FCW,2               TO OTHER                             1IO25890
       SXA     FCW,1               FILE                                 1IO25900
       SXA     CPY7,2                                                   1IO25910
       LAC     FCW,2               PLACE 2ND                            1IO25920
       CLA     1,2                 FILES CONTROL                        1IO25930
       ANA     DECRE               BITS IN SI                           1IO25940
       RIL     077777                                                   1IO25950
       OAI                                                              1IO25960
       TXH     *+2,4,-SEL2.4                                           $1IO25970
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO25980
       XCA                         RESTORE AC                           1IO25990
       TRA     1,4                 EXIT                                 1IO26000
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             1IO26010
*                               ACTIONS                                 1IO26020
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          1IO26030
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      1IO26040
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                1IO26050
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              1IO26060
*                MODE WILL BE USED AND THE RECORD WILL BE READ          1IO26070
*                WITHOUT REDUNDANCY CHECKING                            1IO26080
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 1IO26090
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             1IO26100
*                            XX XX XX X5 XX XX    BIN   BIN             1IO26110
*                            XX XX XX X1 XX XX    BCD   BIN             1IO26120
*                            XX XX XX X1 XX XX    BIN   BCD             1IO26130
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   1IO26140
*                            XX XX 00 00 00 00    BCD   BCD             1IO26150
*                            00 01 00 05 00 04    BIN   BIN             1IO26160
*                            XX XX 11 11 07 07    BCD   BIN             1IO26170
*                            00 00 00 01 00 00    BIN   BCD             1IO26180
*             5. WRITE MIXED MODE WORKS ............                    1IO26190
MXMOD  CLA     0,4                 MIXED MODE                           1IO26200
       ANA     L(64D)              CARD EQUIPMENT                       1IO26210
       TNZ     CDMXM               CHECKS FOR EOF CARD                  1IO26220
       STI     MX2                 SAVE SI                              1IO26230
       LNT     100000              IF NO REDUNDANCY ANALYZE             1IO26240
       TRA     LKAD                LOOK AHEAD BITS                      1IO26250
       LDI     1,4                 IF CODE 3 THEN                       1IO26260
       LNT     300000              10 TRIES ON FIRST MODE DONE          1IO26270
       TRA     MX1                                                      1IO26280
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         1IO26290
MX0    STZ*    .URRX               ERROR PRINT                       $5$1IO26300
       STI     1,4                                                      1IO26310
       LDI     1,2                 REVERSE                              1IO26320
       IIL     MODE                MODE OF                              1IO26330
       STI     1,2                 SELECT                               1IO26340
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     1IO26350
       LXA     S3+1,1              RESTORE IR 1                         1IO26360
       LXA     S3,4                RETURN TO                            1IO26370
       TRA     3,4                 EXECUTOR TO RE-TRY                   1IO26380
*                   SECOND AND THIRD MODE TRIES SEL-                    1IO26390
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      1IO26400
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $1IO26410
       IIL     300000              IF SECOND GO TRY AGAIN               1IO26420
       TRA     MX0                 AT FIRST MODE                        1IO26430
MX2    PZE     **                  SI STORAGE                           1IO26440
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   1IO26450
MXMP   LDI     1,4                 IF FIRST TIME                        1IO26460
       LFT     300000              SELECT SET ALTERNATOR                1IO26470
       TRA     MX3                 CODE =3                              1IO26480
       IIL     300000                                                   1IO26490
       STI     1,4                 RESTORE UCW 2ND WORD                 1IO26500
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           1IO26510
       STZ*    .RCTX               THIRD TRY DISABLE REDUNDANCY      $5$1IO26520
       LDI     1,2                 RESTORE SI                           1IO26530
       TRA     S4                  EXIT                                 1IO26540
       EJECT                                                            1IO26550
*                      INTERROGATE LOOKAHEAD BITS                       1IO26560
1KA    NULL                                                          $5$1IO26561
       IFT     NOCH=0                                                $5$1IO26562
       GOTO    1KA.1                                                 $5$1IO26563
       LFT     200000              EOF                               $5$1IO26570
       TRA     SELM2+2             NO CHANGE IN MODE                   $1IO26580
       STI     MX2                 SAVE INDICATORS                     $1IO26590
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $1IO26600
       CLA     1,4                                                     $1IO26610
       PAC     0,1                                                     $1IO26620
       CLA     9,1                 LAST COMMAND                        $1IO26630
       ARS     18                                                      $1IO26640
       ADD     9,1                 LAST WORD READ + 1                  $1IO26650
       PAC     0,1                                                     $1IO26660
       TRA     LWRD+1                                                  $1IO26670
1KA.1  LDI     MX2                                                   $5$1IO26690
LKAD   LFT     200000              EOF                                 $1IO26700
       TRA     MX5                 NO CHANGE IN MODE                   $1IO26710
       LDI     1,2                                                     $1IO26720
LWRD   LAC     .COMM,1             INTERROGATE                       $5$1IO26730
       CLA     -1,1                LAST WORD IN BUFFER                  1IO26740
       ANA     MXBB2                                                   $1IO26750
       LNT     MODE                TEST MODE                           $1IO26760
       TZE     MX5                 BCD TO BCD                          $1IO26770
       ANA     DISCON              BIN CHECK BIN'BIN                   $1IO26780
       TNZ     MX5                 BIN TO BIN                          $1IO26790
       IIL     MODE                CHANGE MODE BIT                     $1IO26800
       STI     1,2                 STORE IN FILE BITS                   1IO26810
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     1IO26820
MX5    LDI     MX2                 RESTORE SI FOR SELM                  1IO26830
       LXA     S3+1,1                                                  $1IO26840
       CLA     CHATY                                                   $1IO26850
       IFT     NOCH=0                                                $5$1IO26851
       GOTO    MX6                                                   $5$1IO26852
       LBT                                                             $1IO26860
       TRA     *+2                                                     $1IO26870
       TRA     SELM2+2             DISK SEL-                           $1IO26880
MX6    TNZ     SELM1               HYPER SEL                         $5$1IO26890
       CAL     XCPT3               CLEAR READ                          $1IO26900
       ANS     1,4                 MODE SWITCH                         $1IO26910
       TRA     SELM1               POST COMPLETION                      1IO26920
MXBB2  OCT     000000050000                                            $1IO26930
XCPT3  OCT     477777777777                                             1IO26940
       SPACE   1                                                        1IO26950
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      1IO26960
*                     BEING REFERENCED BY THE IOBS                      1IO26970
INVM   SXA     INVM1,1             SAVE IR1                             1IO26980
       CLA     0,4                 IF FILE IS                           1IO26990
       ALS     18                  CURRENTLY BEING                      1IO27000
       STD     *+2                 REFERENCED BY IOBS                   1IO27010
       LAC     FCW,1               THEN MODIFY MODE                     1IO27020
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              1IO27030
       TXH     *+4,1,0             AS STORED BY                         1IO27040
       LDI     .IOXSI              IOEX.............                 $5$1IO27050
       IIL     MODE                                                     1IO27060
       STI     .IOXSI                                                $5$1IO27070
INVM1  AXT     **,1                RESTORE IR1                          1IO27080
       TRA     1,1                 EXIT                                 1IO27090
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    1IO27100
CDMXM  SXA     CDMX4,4             SAVE IR4                             1IO27110
       CAL     1,4                 FIND L(9L)-2                         1IO27120
       PAC     0,4                 IF BOTH                              1IO27130
       CLA     4,4                 8L AND 7L                            1IO27140
       TPL     CDMX4               ARE                                  1IO27150
       CLA     6,4                 (-) TREAT IT AS                      1IO27160
       TPL     CDMX4               END OF FILE                          1IO27170
       LXD     .COMM,4             SET L(IORT)+1                     $5$1IO27180
       SXA     .COMM,4             AS LAST WD STORED +1              $5$1IO27190
       SIL     200000              SET EOF BIT                          1IO27200
CDMX4  AXT     **,4                RESTORE IR4                          1IO27210
       TRA     SELM1               RETURN                               1IO27220
       TTL     NON-DATA OPERATION CHECK FOR 7909 CHANNEL                1IO27230
D7909  AXT     **,4                                                     1IO27240
SVDID  PZE     **                                                       1IO27250
 NDSEL EQU     SVDID                                                 $5$1IO27255
       SXA     D7909,4                                                  1IO27260
       CLA     5,2                                                      1IO27270
       TMI     7KA                 1301                                *1IO27280
       ANA     SIX                                                     *1IO27290
       TZE     .NDSEL+1            729                               $5$1IO27300
       IFT     NOHYP=0                                               $5$1IO27301
       GOTO    7KA                                                   $5$1IO27302
HNDS   CLA     1,4                                                     *1IO27310
       PDX     0,4                 EXIT IF INVALID NON-DATA            *1IO27320
       TXL     HND2,4,2                                                *1IO27330
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *1IO27340
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *1IO27350
       TNX     *+4,4,31            FOLLOWING ORDERS                    *1IO27360
       TXI     *+1,4,33            RWD,RUN                             *1IO27370
       TNX     *+2,4,35            BSR,BSF                             *1IO27380
       TXI     *+1,4,32            WTM                                 *1IO27390
HND1   SXD     *+2,4                                                   *1IO27400
       TSX     .NDSEL+1,4                                            $5$1IO27410
       PZE     0,2,**                                                  *1IO27420
HND2   LXA     D7909,4                                                 *1IO27430
       TRA     2,4                                                     *1IO27440
7KA    NULL                                                          $5$1IO27451
       IFT     NOCH=0                                                $5$1IO27452
       GOTO    XCPTP                                                 $5$1IO27453
       STI     SVDID                                                 $5$1IO27460
       LDQ     6,2                 CHECK FOR EOF                      *$1IO27470
       TQP     *+3                 NO                                  $1IO27480
       TSX     EOF,4               YES                                 $1IO27490
       LXA     D7909,4                                                *$1IO27500
       ENB     .TRAPS                                                $5$1IO27510
       CLA     1,4                 YES                                 $1IO27520
       PDX     0,4                 CODE FOR NDATA IN IR4               $1IO27530
       TXL     DNDSEL,4,2          EXIT IF DENSITY NDS                 $1IO27540
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $1IO27550
       TXH     DWEF,4,5            BSF-6 WEF-7                         $1IO27560
       STZ     TEMP                                                    $1IO27570
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $1IO27580
       CAL     0,2                 GET BOF AND                         $1IO27590
       ARS     18                  TEST IF POSITION                    $1IO27600
       SBM     6,2                 NOW, IS SAME                        $1IO27610
       ANA     ADDRS               IF SO                               $1IO27620
       TZE     DNDSEL              NO BACKSPACE - NOP                  $1IO27630
       PXA     0,0                 GET COUNT OF TRACKS IN RECORD       $1IO27640
       LLS     5                   DEDUCT TRACKS                       $1IO27650
       SUB     6,2                 AND PUT IT BACK                     $1IO27660
       STA     6,2                 FOR NEXT SEEK                       $1IO27670
DNDSEL LDI     SVDID         PLACE BACK AND                        IBJOB1IO27680
       LXA     D7909,4             RETURN                              $1IO27690
       TRA     2,4                                                     $1IO27700
DIND   SYN     DNDSEL                                              IBJOB1IO27710
DWEF   SXA     DWEF1,4                                                 $1IO27730
       SXA     DWEF1+1,1                                               $1IO27740
       TXL     DBSF,4,6            BSF                                 $1IO27750
DBSF1  AXC     1,4                                                     $1IO27760
       CLA*    0,2                 GET 2ND WORD OF UCB                 $1IO27770
       TNZ     *-1                 WAIT FOR LAST WRITE                 $1IO27780
       ENB     L(0)                                                    $1IO27790
       CLA     6,2                                                     $1IO27800
       ANA     DECRE                                                   $1IO27810
       ARS     6                                                       $1IO27820
       STO     DSMSB                                                   $1IO27830
       SXA     DWEF6,2                                                 $1IO27840
       CLA     1,2                 TEST MODE                           $1IO27850
       ANA     MODBT                                                    1IO27860
       TZE     *+3                 BCD MODE                             1IO27870
       CLA     L(6)                BINARY MODE                          1IO27880
       TRA     *+2                                                      1IO27890
       CLA     L(22)                                                    1IO27900
       ORS     DSMSB                                                    1IO27910
       CLA     0,2                 GET UCB ADDRESS                     $1IO27920
       STA     DAXC                                                    $1IO27930
       CLA     6,2                                                     $1IO27940
       TSX     .DECVA,4                                              $5$1IO27950
DAXC   AXC     **,4                'L(UCB)                             $1IO27960
       CLS     2,4                 REQUEST SEEK                        $1IO27970
       STO     2,4                 WITH MINUS SIGN                     $1IO27980
       CLA     6,2                 AND CORRECT                         $1IO27990
       STA     3,4                                                     $1IO28000
       TSX     .FDAMT,2            IOEX ROUTINE TO SET ORDER         $5$1IO28010
DSMSB  BCI     1,00I006                                                $1IO28020
       PZE     DVTA                                                    $1IO28030
DWEF6  AXT     **,2                L(FCB)                              $1IO28040
       STL     DWAIT               MAKE WAIT CELL NONZERO              $1IO28050
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $1IO28060
       PXD     0,1                                                     $1IO28070
       STD     1,4                 SECOND WORD OF UCB                  $1IO28080
       TSX     .ACTV+1,4           ACTIVATE CHAIN OF CHANNEL COMMAND $5$1IO28090
       MZE     0,2                                                     $1IO28100
       ZET     DWAIT               WAIT FOR SELECT MINUS                1IO28110
       TRA     *-1                 TO FINISH                           $1IO28120
       XEC     DWEF1                                                   $1IO28130
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $1IO28140
       CAL     6,2                 SET UP SEEK                         $1IO28150
       ACL     L(1)                AND FILE START                      $1IO28160
       STA     6,2                 ADDRESS FOR                         $1IO28170
       TSX     EOF,4               BACKSPACE FILE                      $1IO28180
       ENB     .TRAPS                                                $5$1IO28190
DWEF1  AXT     **,4                AT LAST                             $1IO28200
       AXT     **,1                                                    $1IO28210
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $1IO28220
       CAL     7,2                 GET BOT ADDRESS                     $1IO28230
       STD     0,2                 AND PUT IN BOTH                     $1IO28240
       ARS     18                  WORD ONE AND SEVEN                  $1IO28250
       STA     6,2                                                     $1IO28260
       TXL     DNDSEL,4,3                                              $1IO28270
       PXA     0,0                                                     $1IO28280
       STA     0,2                 ZERO OUT UCB                        $1IO28290
       XEC     DIND                RESTORE INDICATORS                  $1IO28300
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $1IO28310
       TRA     DNDSEL+1            RETURN                              $1IO28320
DWAIT  PZE                                                             $1IO28330
DVTA   DVTA    ,,                                                      $1IO28340
DBSF   LDI     6,2                 1ST TIME AROUND                     $1IO28350
       CLA     7,2                                                     $1IO28360
       STD     *+3                 IF AT                               $1IO28370
       CLA     0,2                 BOT DO NOT                          $1IO28380
       PDC     0,1                 DO THE                              $1IO28390
       TXI     *+1,1,**            BACKSPACE                           $1IO28400
       TXL     DNDSEL,1,0    FILE                                  IBJOB1IO28410
       LFT     600000                                                  $1IO28420
       TRA     DBSF4               NOT 1ST TIME                        $1IO28430
       CLA     0,2                 EXCHANGE SEEK POINTER               $1IO28440
DBSF6  ARS     18                  TO BE BEGINNING                     $1IO28450
       STA     6,2                 OF THE FILE                         $1IO28460
       CAL     SIX                 PUT NOT FIRST                       $1IO28470
       STP     6,2                 TIME THRU FLAG ON                   $1IO28480
       TRA     DNDSEL        EXIT                                  IBJOB1IO28490
DBSF4  LFT     200000                                                  $1IO28500
       TRA     DBSF5               NOT FIRST TIME THRU                 $1IO28510
       PIA     **                  PUT SEEK ADDRESS                    $1IO28520
       ALS     18                  AND BEGINNING OF                    $1IO28530
       STD     0,2                 FILE EQUAL                          $1IO28540
       TRA     DBSF6+2             EXIT                                $1IO28550
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $1IO28560
       SXA     DSELP+2,4           FOR BACKSPACE                       $1IO28570
       PIA                                                             $1IO28580
       SUB     L(1)                MAKE SEEK ADDRESS                   $1IO28590
       STA     6,2                 EOF ADDRESS                         $1IO28600
       TRA     DBSF1               GET FLAG FOR EOF                    $1IO28610
DBSF3  AXT     DCTL,4              RESTORE START                       $1IO28620
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $1IO28630
       CAL     DFLAG               GET NEW B.O.F.                      $1IO28640
       STD     0,2                 AND PUT IT IN THE                   $1IO28650
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $1IO28660
*                                                                      $1IO28670
DISUE  ACL     L(1)                GET ADDRESS OF                      $1IO28680
       STA     DSELM1              UCB + 1                             $1IO28690
       LXA     DWEF6,2             -L (FILE) IN IR2                    $1IO28700
       TPL     DSELP                                                   $1IO28710
       STZ     DWAIT                                                   $1IO28720
DSELM1 STZ     **                                                      $1IO28730
       TRA     1,4                 RETURN                              $1IO28740
DSELP  CAL     0,2                 PUT FILE                            $1IO28750
       STD     DFLAG               START POINT IN FLAG                 $1IO28760
       AXT     DCTL,2              COMM. LIST                          $1IO28770
       PXA     0,2                                                     $1IO28780
       STA*    .RCHX                                                 $5$1IO28790
       XEC*    .RCHX               SEL+  START CHANNEL               $5$1IO28800
       TRA     1,4                 EOF LOCATION                        $1IO28810
*              7909 CHANNEL PROGRAM                                    $1IO28820
*                                                                      $1IO28830
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              1IO28840
       CTLW    DVTA                                                    $1IO28850
       CPYD    DFLAG,,1                                                $1IO28860
       TCH     SYSTWT                                                  $1IO28870
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $1IO28880
       CTLR    DVTA                FOR BACK SPACE                      $1IO28890
       TCH     DCTL+2              FILE ROUTINE                        $1IO28900
DFLAG  PTW                         EOF FLAG WORD                       $1IO28910
       TTL     CONSTANT POOL                                            1IO28930
XCPTP  OCT     077777777777                                            $1IO28940
L(64D) PZE     0,,64                                                    1IO28950
       SPACE   1                                                        1IO28960
*                          TEMPORARY STORAGE                            1IO28970
HOLDS  PZE     *                   CHAIN CELL                           1IO28980
TCHEX  PZE     **                  TCH SWITCH                           1IO28990
TEMP   PZE     **                  ERASEABLE STORAGE                    1IO29000
       TTL                         JOIN TWO BUFFER POOLS                1IO29010
*      TSX     JOIN,4                                                   1IO29020
*      PZE     POOL1,,POOL2                                             1IO29030
       SPACE   1                                                        1IO29040
*            1.POOL2 IS APPENDED TO POOL1                               1IO29050
*            2.POOL2 MUST HAVE AT LAST REFERENCE BEEN DEFINED           1IO29060
*            3.POOL1 MAY HAVE FILES ATTACHED                            1IO29070
*            4.POOL1 OR POOL2 MUST NOT HAVE                             1IO29080
*              PREVIOUSLY JOINED ELSEWHERE                              1IO29090
*            5.AFTER TSX JOIN,4 POOL2 NO LONGER EXISTS                  1IO29100
       SPACE   1                                                        1IO29110
JOIN.  LDC     XEOB,1              CHECK IF EITHER                      1IO29120
       ENB     L(0)                TRAP PROTECT                         1IO29130
       LDQ     0,2                 JOIN THE BUFFER POOLS                1IO29140
       CLA     0,1                 BY-                                  1IO29150
       STA     0,2                 CHAIN (1) TO END CHAIN(2)            1IO29160
       XCA                         CHAIN(2) TO CHAIN(1)                 1IO29170
       STA*    1,1                                                      1IO29180
       ACL     0,1                 SUM BUFFER COUNTS                    1IO29190
       STD     0,2                 AND SET IN POOL1                     1IO29200
       ENB     .TRAPS              ALLOW TRAPS                       $5$1IO29210
       TRA     EX24                EXIT                                 1IO29220
       TTL                         COPY AND STASH ROUTINES              1IO29230
*      TSX     COPY,4              TSX  STASH,4                         1IO29240
*      PZE     FILE1,,FILE2        PZE  FILE1,,FILE2                    1IO29250
*                                  PZE  NTS                             1IO29260
*                             COMMENTS...                               1IO29270
*             1. NO ACTION IF NO INPUT BUFFER                           1IO29280
*             2. PRESENT OUTPUT BUFFER,IF ANY, TRUNCATED                1IO29290
STASH. TXI     *+1,4,-1            SETUP L( NORMAL EXIT)                1IO29300
       SXA     GTIOX,4                                                  1IO29310
       CLA     -1,4                SAVE                                 1IO29320
       STA     XEOF                NTS EXIT                             1IO29330
COPY.  LNT     OPEND               IF INPUT FILE                        1IO29340
       TRA     COMXIT              NOT OPEN THEN EXIT                   1IO29350
       TSX     FNLBC,4             FIND L(POOL)                         1IO29360
       LXD     XEOB,1              SET FILE2 INTO                       1IO29370
       SXA     CPY7,1              SWITCHING ROUTINE                    1IO29380
       TSX     CPY6,4              SWITCH TO OTHER FILES CONTROLS       1IO29390
       LNT     OPEND               IF OUTPUT FILE                       1IO29400
       TRA     COMXIT              NOT OPEN ,THEN EXIT                  1IO29410
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     1IO29420
       TSX     TRUNC,1             TRUNCATE ANY OUTPUT BUFFER           1IO29430
CPY1   TSX     CPY6,4              REVERSE FILE BITS TO FILE1           1IO29440
       STZ     XEOB                SET STASH SWITCH=0                   1IO29450
STSH2  TSX     TRUNC,1             TRUNCATE ANY OUTPUT PREPARED         1IO29460
       CLA*    0,2                 IF NO OUTPUT IN REGEN CHAIN          1IO29470
       TZE     EOF.0+1             YET TAKE NTS EXIT                    1IO29480
       LDQ     0,2                 REMOVE 1ST                           1IO29490
       STA     0,2                 BUFFER FROM                          1IO29500
       ZET*    0,2                 FILE1'S REGEN                        1IO29510
       STD*    0,2                 CHAIN AND PLACE                      1IO29520
       STQ     TEMP                INTO REGULAR OUTPUT FILE             1IO29530
       LAC     TEMP,4              FOR ACTUAL OUTPUT                    1IO29540
       CLA     1,4                 SETUP BUFFER SO LOCATOR              1IO29550
       STZ     0,4                 SHOWS BUFFER CONTENT                 1IO29560
       STA     0,4                                                      1IO29570
       ENB     L(0)                TRAP PROTECT                         1IO29580
       TSX     BCKBB,1             RELEASE ONE FROM OUTPUT-1            1IO29590
       CAL     3,2                 REDUCE                               1IO29600
       ACL     DECRE               SEQUENCE                             1IO29610
       STD     3,2                 COUNT BY ONE                         1IO29620
       TSX     CPY6+1,4            SWITCH TO FILE 2 BITS                1IO29630
       STA     2,2                 OUTPUT                               1IO29640
       SIR     CPYFN                                                    1IO29650
       TSX     TRUNC,1             BUFFER                               1IO29660
       TRA     COMXIT              EXIT                                 1IO29670
       TTL                   INTERNAL FILE OPEN                         1IO29680
INTOP  CAL     -1,4                PLACE OPTION                         1IO29690
       ARS     33                  BITS IN SI                           1IO29700
       OAI                                                              1IO29710
       RNT     INTRD               READ OR                              1IO29720
       TRA     IOP3                WRITE                                1IO29730
       RIL     OUTPUT              SET INPUT TYPE                       1IO29740
       CLA     3,2                 SET                                  1IO29750
       ARS     18                  SEQ CT+1                             1IO29760
       ACL     L(1)                AS THE                               1IO29770
       STA     1,2                 NUMBER OF BUFFERS                    1IO29780
       STD     3,2                 AVAILABLE                            1IO29790
       CLA     0,2                 SET RE-GENERATIVE                    1IO29800
       STA     4,2                 BUFFER CHAIN SYNC                    1IO29810
       CLA     L(0)A               SET RE-GEN                           1IO29820
       STA     0,2                 = L(0)                               1IO29830
       PIA                         SET READ                             1IO29840
       ARS     2                   MODE (DESTRUCTIVE                    1IO29850
       ALS     35                  OR NOT)                              1IO29860
       STP     2,2                                                      1IO29870
       TRA     OP1                 EXIT                                 1IO29880
IOP3   RNT     RETAIN                                                   1IO29890
       TSX     DESTRY,4                                                 1IO29900
       SIL     PTO                                                      1IO29910
       CAL     L(0)A                                                   $1IO29920
       ENB     .TRAPS                                                $5$1IO29930
       STA     4,2                                                     $1IO29940
       TRA     OP1                                                      1IO29950
       SPACE   1                                                        1IO29960
*              DESTROY CONTENT OF FILE (RELEASE TO POOL)                1IO29970
DESTRY PXA     0,0                 SET                                  1IO29980
       STA     1,2                 BUF IN USE CT                        1IO29990
       STD     3,2                 AND SEQ CT =0                        1IO30000
       SXA     DEST2,4             SAVE IR4                             1IO30010
       TSX     FNLBC,4             FIND L(POOL)                         1IO30020
       LAC     LBC,4               L(POOL) 0O IR4                       1IO30030
DEST1  CLA*    0,2                 RELEASE                              1IO30040
       TZE     DEST2               ALL                                  1IO30050
       LDQ     0,2                 BUFFERS                              1IO30060
       ENB     L(0)                                                     1IO30070
       STA     0,2                 IN USE                               1IO30080
       TSX     BTP1,1                                                   1IO30090
       TSX     BCKBF,1                                                  1IO30100
       TRA     DEST1                                                    1IO30110
DEST2  AXT     **,4                RESTORE IR4                          1IO30120
       TRA     1,4                 EXIT                                 1IO30130
       TTL                         INTERNAL FILE CLOSE                  1IO30140
INTCL  LFT     OUTPUT              DISCONNECT                           1IO30150
       TRA     *+3                 ANY BUFFERS                          1IO30160
       TSX     DISCON,1            IN USE                               1IO30170
       TRA     *+2                                                      1IO30180
       TSX     TRUNC,1                                                  1IO30190
       CAL     1,2                 SUM BUFFERS IN                       1IO30200
       ALS     18                  USE CT. AND                          1IO30210
       ACL     3,2                 SEQ. CT. FOR                         1IO30220
       LFT     OPEND               FILE OPEN                           $1IO30230
       LFT     OUTPUT              TRUE NUMBER OF BUFFERS               1IO30240
       TRA     *+2                 ADJUST COUNT                         1IO30250
       SUB     1DEC                BY ONE AS AN EXTRA                   1IO30260
       STD     3,2                 WAS ADDED WHEN INPUT                 1IO30270
       STA     1,2                 WAS OPENED                           1IO30280
       CLA*    0,2                 FORM IN                              1IO30290
       TZE     ICL2                0,2 THE                              1IO30300
       PDC     0,1                 COMPLETE                             1IO30310
       CLA     4,2                 CHAIN OF                             1IO30320
       STA     0,1                 BUFFERS                              1IO30330
       CLA*    4,2                 THAT ARE                             1IO30340
       TZE     *+2                 CURRENTLY                            1IO30350
       STD*    0,2                 IN USE                               1IO30360
ICL1   CLA     L(0)A               BY THE FILE                          1IO30370
       STA     4,2                                                      1IO30380
       RNT     RETAIN              IF BUFFERS ARE NOT TO BE             1IO30390
       TSX     DESTRY,4            RETAINED RELEASE THEM TO POOL        1IO30400
       TRA     SH4.1               EXIT                                 1IO30410
ICL2   CLA     4,2                 IF RE-GEN =L(0)                      1IO30420
       STA     0,2                 SET SYNC CHAIN                       1IO30430
       TRA     ICL1                IN THERE                             1IO30440
       TTL                         ENTER BUFFER INTO INTERNAL FILE      1IO30450
ENTIN  SXA     EIN,1               SAVE IR1                             1IO30460
       XCA                         SAVE L(BUF) IN MQ                    1IO30470
       CLA*    0,2                 INSERT BUFFER                        1IO30480
       TNZ     *+3                 INTO RE-GENERATIVE CHAIN             1IO30490
       LAC     FCW,1               SETTING UP IR1 AS L(FILE)            1IO30500
       TRA     *+2                 IF NO CHAIN EXISTS                   1IO30510
       PDC     0,1                 L(END) CHAIN TO IR1                  1IO30520
       XCA                         L(BUF) TO AC                         1IO30530
       STA     0,1                                                      1IO30540
       LDQ     L(0)D                                                    1IO30550
       LGL     18                                                       1IO30560
       STO*    0,1                                                      1IO30570
       STD*    0,2                                                      1IO30580
EIN    AXT     **,1                                                     1IO30590
       TRA     1,1                                                      1IO30600
MESS   BCI     1,EOT                                                 (5)1IO30601
EOTPCH AXT     0,4           ZERO XR4.                               (5)1IO30602
       LDQ*    0,2           LOCATION OF FCB INTO MQ.                (5)1IO30603
       TSX     .CVPRT,4      CONVERT AND APPEND UNIT                 (5)1IO30604
       PZE     MESS,,1+512*4     DESIGNATION TO EOT MESSAGE.         (5)1IO30605
       TSX     .PAUSE,4      PAUSE FOR OPERATOR ACTION.              (5)1IO30606
       TRA     SW1+3                                                 (5)1IO30607
SY10.1 CLA     3,2           EOB ON INTERNAL                         (7)1IO30610
       TMI     EOFEX         FILE IS = END OF FILE                   (7)1IO30611
       TRA     SY10+1                                                (7)1IO30612
SY10.2 AXC     1,4                                                   (7)1IO30613
       ZET*    0,2           WAIT UNTIL I/O ON                       (7)1IO30614
       TRA     *-1           THAT UNIT IS COMPLETED                  (7)1IO30615
       TRA     SY3           CONTINUE SYNC OUT                       (7)1IO30616
PAD    PDX     0,4           NO. OF WORDS TO BE WRITTEN IN XR        (8)1IO30617
       TXH     TR10+1,4,2    IF GREATER THAN 2, EXIT.                (8)1IO30618
       CLA*    2,2           IF NOT, STORE 'PADPAD'                  (8)1IO30619
       PAC     0,1            IN NEXT 2 WORDS                        (8)1IO30620
       CLA     PADPAD          OF BUFFER.                            (8)1IO30621
       STO     0,1                                                   (8)1IO30622
       STO     1,1                                                   (8)1IO30623
       AXT     3,4           SET WORD COUNT TO 3.                    (8)1IO30624
       PXD     0,4                                                   (8)1IO30625
       STD*    TR5                                                   (8)1IO30626
       TRA     TR10+1        EXIT.                                   (8)1IO30627
PADPAD BCI     1,PADPAD                                              (8)1IO30628
       PMC                                                              1IO30630
       BES     SY10.2-*+49   PATCH SPACE                             (8)1IO30680
FULIO  NULL                  END OF BASIC IOBS                       (8)1IO30690
       END                                                           $5$1IO99990
