$DATE          120164                                                $5$3A000000
$*     7090/7094 IBJOB LIBRARY (IBLIB), 7090-LM-803,                    3A000001
$*     VERSION 5, MODIFICATION LEVEL 0.                              $5$3A000002
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 4   (4)3A000005
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 5   (5)3A000006
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 6   (6)3A000007
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 7   (7)3A000008
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 8   (8)3A000009
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 9   (9)3A00000A
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 10 (10)3A00000B
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 11 (11)3A00000C
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 12 (12)3A00000D
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 13 (13)3A00000E
$*     IBJOB LIBRARY (IBLIB), 7090-LM-803, VERSION 5, MOD. LEVEL 14 (14)3A00000F
$EXECUTE       IBJOB                                                    3A000010
$IBJOB IBLIB   NOGO                                                     3A000020
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IBSYS                          3AA00000
$IBMAP .IBSYS                                                           3AA00010
*  IBSYS  MEMORY MAP SUBROUTINE                                         3AA00020
       ENTRY   SYSTRA                                                   3AA00030
       ENTRY   SYSDAT                                                   3AA00040
       ENTRY   SYSCUR                                                   3AA00050
       ENTRY   SYSRET                                                   3AA00060
       ENTRY   SYSKEY                                                   3AA00070
       ENTRY   SYSSWS                                                   3AA00080
       ENTRY   SYSPOS                                                   3AA00090
       ENTRY   SYSUNI                                                   3AA00100
       ENTRY   SYSUBC                                                   3AA00110
       ENTRY   SYSUAV                                                   3AA00120
       ENTRY   SYSUCW                                                   3AA00130
       ENTRY   SYSRPT                                                   3AA00140
       ENTRY   SYSCEM                                                   3AA00150
       ENTRY   SYSDMP                                                   3AA00160
       ENTRY   SYSIOX                                                   3AA00170
       ENTRY   SYSIDR                                                   3AA00180
       ENTRY   SYSCOR                                                   3AA00190
       ENTRY   SYSLDR                                                   3AA00200
       ENTRY   SYSPID                                                   3AA00210
       ENTRY   SYSCYD                                                   3AA00215
       ENTRY   SYSACC                                                   3AA00220
       ENTRY   SYSTWT                                                   3AA00230
       ENTRY   SYSLB1                                                   3AA00240
       ENTRY   SYSLB2                                                   3AA00250
       ENTRY   SYSLB3                                                   3AA00260
       ENTRY   SYSLB4                                                   3AA00270
       ENTRY   SYSCRD                                                   3AA00280
       ENTRY   SYSPRT                                                   3AA00290
       ENTRY   SYSPCH                                                   3AA00300
       ENTRY   SYSOU1                                                   3AA00310
       ENTRY   SYSOU2                                                   3AA00320
       ENTRY   SYSIN1                                                   3AA00330
       ENTRY   SYSIN2                                                   3AA00340
       ENTRY   SYSPP1                                                   3AA00350
       ENTRY   SYSPP2                                                   3AA00360
       ENTRY   SYSCK1                                                   3AA00370
       ENTRY   SYSCK2                                                   3AA00380
       ENTRY   SYSUT1                                                   3AA00390
       ENTRY   SYSUT2                                                   3AA00400
       ENTRY   SYSUT3                                                   3AA00410
       ENTRY   SYSUT4                                                   3AA00420
       ENTRY   SYSUT5                                                $5$3AA00421
       ENTRY   SYSUT6                                                $5$3AA00422
       ENTRY   SYSUT7                                                $5$3AA00423
       ENTRY   SYSUT8                                                $5$3AA00424
       ENTRY   SYSUT9                                                $5$3AA00425
       ENTRY   SYSSLD                                                   3AA00430
       ENTRY   SYSGET                                                   3AA00440
       ENTRY   SYSJOB                                                   3AA00450
       ENTRY   SYSTCH                                                   3AA00451
       EJECT                                                            3AA00460
*  IBSYS SYSUNI ASSIGNMENTS                                             3AA00470
SYSLB1 BSS     1                                                        3AA00480
SYSLB2 BSS     1                                                        3AA00490
SYSLB3 BSS     1                                                        3AA00500
SYSLB4 BSS     1                                                        3AA00510
SYSCRD BSS     1                                                        3AA00520
SYSPRT BSS     1                                                        3AA00530
SYSPCH BSS     1                                                        3AA00540
SYSOU1 BSS     1                                                        3AA00550
SYSOU2 BSS     1                                                        3AA00560
SYSIN1 BSS     1                                                        3AA00570
SYSIN2 BSS     1                                                        3AA00580
SYSPP1 BSS     1                                                        3AA00590
SYSPP2 BSS     1                                                        3AA00600
SYSCK1 BSS     1                                                        3AA00610
SYSCK2 BSS     1                                                        3AA00620
SYSUT1 BSS     1                                                        3AA00630
SYSUT2 BSS     1                                                        3AA00640
SYSUT3 BSS     1                                                        3AA00650
SYSUT4 BSS     1                                                        3AA00660
SYSUT5 BSS     1                                                     $5$3AA00661
SYSUT6 BSS     1                                                     $5$3AA00662
SYSUT7 BSS     1                                                     $5$3AA00663
SYSUT8 BSS     1                                                     $5$3AA00664
SYSUT9 BSS     1                                                     $5$3AA00665
       SPACE   2                                                        3AA00670
*  IBSYS COMMUNICATION REGION                                           3AA00680
       BSS     40                                                    $5$3AA00690
SYSTRA BSS     1                                                        3AA00700
SYSDAT BSS     1                                                        3AA00710
SYSCUR BSS     1                                                        3AA00720
SYSRET BSS     1                                                        3AA00730
SYSKEY BSS     1                                                        3AA00740
SYSSWS BSS     1                                                        3AA00750
SYSPOS BSS     1                                                        3AA00760
SYSUNI BSS     1                                                        3AA00770
SYSUBC BSS     1                                                        3AA00780
SYSUAV BSS     1                                                        3AA00790
SYSUCW BSS     1                                                        3AA00800
SYSRPT BSS     1                                                        3AA00810
SYSCEM BSS     1                                                        3AA00820
SYSDMP BSS     1                                                        3AA00830
SYSIOX BSS     1                                                        3AA00840
SYSIDR BSS     1                                                        3AA00850
SYSCOR BSS     1                                                        3AA00860
SYSLDR BSS     1                                                        3AA00870
SYSACC BSS     1                                                        3AA00880
SYSPID BSS     1                                                        3AA00890
SYSCYD BSS     2                                                        3AA00900
SYSSLD BSS     1                                                        3AA00910
SYSTCH BSS     2                                                        3AA00920
SYSTWT BSS     1                                                        3AA00930
SYSGET BSS     1                                                        3AA00940
SYSJOB BSS     1                                                        3AA00950
       END                                                              3AA00960
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOEX                           3AB00000
$IBMAP .IOEX                                                            3AB00010
       LBL     .IOX,BEGIN     .IOEX                                  (7)3AB00013
* IOEX  MEMORY MAP SUBROUTINE                                           3AB00020
       ENTRY   .ACTV                                                    3AB00030
       ENTRY   .NDSEL                                                   3AB00040
       ENTRY   .MWR                                                     3AB00050
       ENTRY   .PUNCH                                                   3AB00060
       ENTRY   .ENBSW                                                   3AB00070
       ENTRY   .PAWS                                                    3AB00080
       ENTRY   .PAUSE                                                   3AB00090
       ENTRY   .STOP                                                    3AB00100
       ENTRY   .SYMUN                                                   3AB00110
       ENTRY   .DECVD                                                   3AB00120
       ENTRY   .DECVA                                                   3AB00130
       ENTRY   .CKWAT                                                   3AB00140
       ENTRY   .BCD5R                                                   3AB00150
       ENTRY   .BCD5X                                                   3AB00160
       ENTRY   .CVPRT                                                   3AB00170
       ENTRY   .STOPD                                                   3AB00180
       ENTRY   .CHXAC                                                   3AB00190
       ENTRY   .URRX                                                    3AB00200
       ENTRY   .RCTX                                                    3AB00210
       ENTRY   .RCHX                                                    3AB00220
       ENTRY   .TCOX                                                    3AB00230
       ENTRY   .TRCX                                                    3AB00240
       ENTRY   .ETTX                                                    3AB00250
       ENTRY   .TEFX                                                    3AB00260
       ENTRY   .TRAPX                                                   3AB00270
       ENTRY   .TRAPS                                                   3AB00280
       ENTRY   .COMM                                                    3AB00290
       ENTRY   .LTPOS                                                   3AB00300
       ENTRY   .IOXSI                                                   3AB00310
       ENTRY   .CHPSW                                                   3AB00320
       ENTRY   .TRPSW                                                   3AB00330
       ENTRY   .FDAMT                                                   3AB00340
       ENTRY   .SDCXI                                                   3AB00341
       ENTRY   .STCXI                                                   3AB00342
       ENTRY   .COMMD                                                   3AB00343
       ENTRY   .IBCDZ                                                   3AB00344
       ENTRY   .CHXSP                                                   3AB00350
       EJECT                                                            3AB00360
.ACTV  BSS     2                                                        3AB00370
.NDSEL BSS     2                                                        3AB00380
.MWR   BSS     1                                                        3AB00390
.PUNCH BSS     1                                                        3AB00400
.ENBSW BSS     1                                                        3AB00410
.PAWS  BSS     1                                                        3AB00420
.PAUSE BSS     1                                                        3AB00430
.STOP  BSS     1                                                        3AB00440
.SYMUN BSS     1                                                        3AB00450
.DECVD BSS     1                                                        3AB00460
.DECVA BSS     1                                                        3AB00470
.CKWAT BSS     1                                                        3AB00480
.BCD5R BSS     1                                                        3AB00490
.BCD5X BSS     1                                                        3AB00500
.CVPRT BSS     1                                                        3AB00510
.STOPD BSS     1                                                        3AB00520
.CHXAC BSS     1                                                        3AB00530
.URRX  BSS     1                                                        3AB00540
.RCTX  BSS     1                                                        3AB00550
.RCHX  BSS     1                                                        3AB00560
.TCOX  BSS     1                                                        3AB00570
.TRCX  BSS     1                                                        3AB00580
.ETTX  BSS     1                                                        3AB00590
.TEFX  BSS     1                                                        3AB00600
.TRAPX BSS     1                                                        3AB00610
.TRAPS BSS     1                                                        3AB00620
.COMM  BSS     1                                                        3AB00630
.LTPOS BSS     1                                                        3AB00640
.IOXSI BSS     1                                                        3AB00650
.CHPSW BSS     1                                                        3AB00660
.TRPSW BSS     1                                                        3AB00670
.FDAMT BSS     1                                                        3AB00680
.SDCXI BSS     1                                                        3AB00690
.STCXI BSS     1                                                        3AB00691
.COMMD BSS     1                                                        3AB00692
.IBCDZ BSS     1                                                        3AB00693
.CHXSP BSS     1                                                        3AB00700
       END                                                              3AB00710
$*     7090/7094 IBLIB SYSTEM LIBRARY - .JBCON                          3AC00000
$IBMAP .JBCON  19                                                       3AC00010
       TTL     .JBCON - OBJECT TIME IBJOB COMMUNICATIONS AREA        $5$3AC00015
SYSLOC ENTRY   SYSLOC                                                   3AC00020
SYSFAZ ENTRY   SYSFAZ                                                   3AC00030
.JCOR  ENTRY   .JCOR                                                    3AC00040
.JDATE ENTRY   .JDATE                                                   3AC00050
.JLDAT ENTRY   .JLDAT                                                   3AC00060
.JTYPE ENTRY   .JTYPE                                                   3AC00070
.JLIN  ENTRY   .JLIN                                                    3AC00080
.JVER  ENTRY   .JVER                                                    3AC00090
SYSDSB ENTRY   SYSDSB                                                   3AC00100
.IOEXD ENTRY   .IOEXD                                                   3AC00101
.FDPOS ENTRY   .FDPOS                                                   3AC00102
.JDTRK ENTRY   .JDTRK                                                   3AC00103
SYSZRO ENTRY   SYSZRO                                                $5$3AC00104
SYSLOC BSS     1                                                        3AC00110
SYSFAZ BSS     1                                                        3AC00120
.JCOR  BSS     1                                                        3AC00130
.JDATE BSS     1                                                        3AC00140
.JLDAT BSS     2                                                        3AC00150
.JTYPE BSS     1                                                        3AC00160
.JLIN  BSS     1                                                        3AC00170
.JVER  BSS     1                                                        3AC00180
SYSDSB ENB     SYSZRO                                                $5$3AC00190
.IOEXD BSS     25                                                       3AC00191
.FDPOS BSS     1                                                        3AC00192
.JDTRK BSS     1                                                        3AC00193
SYSZRO PZE     0,,0                                                  $5$3AC00194
       END                                                              3AC00200
$*     7090/7094 IBLIB SYSTEM LIBRARY - .LXCON                          3AD00000
$IBMAP .LXCON  350                                                   $5$3AD00010
       TTL     .LXCON - POST EXECUTION SUBROUTINE                   (13)3AD00015
* POST EXECUTION SUBROUTINE FOR ALL IBJOB EXECUTIONS                    3AD00020
*                                                                       3AD00040
*  IS ENTERED FROM OBJ. PROG ,PREEX , OR MONITOR                        3AD00050
*   IN ONE OF THREE WAYS                                                3AD00060
*                                                                       3AD00070
*      1. STR EXECUTED BY SOME-BODY                                     3AD00080
*      2. SYSTEM STOP CONDITION BLOCKED                                 3AD00090
*      3. NORMAL ENTRY AT TERMINATION OF EXECUTION                      3AD00100
*                                                                       3AD00110
*  FOR STR OR SYSTEM STOP                                               3AD00120
*    1. STR LOC (WHEN APPLICABLE) IS PRINTED BOTH ON AND OFF LINE.      3AD00130
*       IRS ARE PRINTED OFF LINE ONLY.                                  3AD00140
*    2. IF STR SYSDMP WILL BE USED TO TAKE A DUMP (FULL CORE) ON        3AD00150
*        THE WAY BACK TO THE IBJOB MONITOR                              3AD00160
*                                                                       3AD00170
*                                                                       3AD00180
*  IN ANY ENTRY , IF THE OBJECT PROG HAS FILES (.LFBLK CELL IN IOCS)    3AD00190
*   THEY WILL BE CLOSED WITH                                            3AD00200
*                                                                       3AD00210
*    1.REW  IF SCRATCH                                                  3AD00220
*    2.NOREW IF MONCON  (I.E. OU,IN,PP)                                 3AD00230
*    3.RUN  AND  'PRINT','PUNCH'OR'HOLD' ON ALL OTHERS                  3AD00240
*  FOR FILES USING NON- SYSTEM UNITS , THOSE UNITS WILL BE              3AD00250
*    RE-ESTABLISHED IN THE APPROPRIATE CHANNEL AVAILABILITY CHAINS      3AD00260
*     EXCEPT AS FOLLOWS  ------                                         3AD00270
*      IF EXECUTION TERMINATED IN A NORMAL WAY ( .LXRTN ENTRY TO THIS   3AD00280
*         ROUTINE),  NON-SYSTEM UCW'S OF THE RESERVE TYPE WILL NOT      3AD00290
*         BE PLACED IN THE AVAILIBILITY CHAINS AND THE RESERVE UNIT BIT 3AD00300
*         WILL BE TURNED 'ON' AND THE RESERVE UNIT CHARACTERS WILL      3AD00310
*         BE STORED IN THE FIRST WORD OF THE UCB IN THE RIGHT SIDE OF   3AD00320
*         THE ADDRESS                                                   3AD00330
*                                                                       3AD00340
       ENTRY   .LXCAL              FORTRAN ALTERNATE I/O LINK        $5$3AD00345
.LXRTN ENTRY   EXRE2               NORMAL ENTRY POINT               (10)3AD00350
.LXSTR ENTRY   EXSTR               STR ENTRY POINT                      3AD00360
.LXSTP ENTRY   EXSTP               SYSTEM STOP ENTRY POINT              3AD00370
.LXERR ENTRY   EXERR               EXECUTION ERROR ENTRY POINT      (10)3AD00380
IBEXIT ENTRY   EXRE2                                                (10)3AD00385
       ENTRY   .LXARG                                                   3AD00390
       ENTRY   .LXOUT                                                   3AD00400
       ENTRY   .CLSE                                                    3AD00410
       ENTRY   .LFBL                                                    3AD00420
       ENTRY   .LUNB                                                    3AD00430
       ENTRY   .L0                                                      3AD00440
       ENTRY   .DBCLS              FOR DEBUG ROUTINE TO INSERT CLOSE    3AD00450
       ENTRY   .DFOUT              EXECUTED BY FDMP BEFORE DUMP      $5$3AD00451
       EJECT                                                            3AD00460
 EXSTR ZET     STR                 ONLY ALLOW ONE STR                $5$3AD00470
       STL     STR2                STR WHILE PROCESSING STR          $5$3AD00472
       STL     STR                 SET STR                           $5$3AD00474
 EXSTP STI     SI                                                       3AD00480
       SXD     X1,1                SAVE IRS                             3AD00490
       SXD     X2,2                                                     3AD00500
       SXD     X4,4                                                     3AD00510
       SXD     X3,3                                                     3AD00520
       SXD     X5,5                                                     3AD00530
       SXD     X6,6                                                     3AD00540
       SXD     X7,7                                                     3AD00550
       STQ     MQ                  MQ                                   3AD00560
       LGR     2                   AC                                   3AD00570
       STO     AC1                  P AND Q                             3AD00580
       STQ     AC2                                                      3AD00590
       AXT     14,1                CONVERT INDEX REGISTERS              3AD00600
       AXT     7,2                                                      3AD00610
 EX1   LDQ     X7+1,2                                                   3AD00620
       TSX     .BCD5R,4                                                 3AD00630
       SLW     XMS9+1,1                                                 3AD00640
       TXI     *+1,1,-2                                                 3AD00650
       TIX     EX1,2,1                                                  3AD00660
       NZT     STR                 STR OR SYSTEM STOP                   3AD00670
       TRA     EX7                   STOP                               3AD00680
       LXA     0,4                 CONVERT                              3AD00690
       TXI     *+1,4,-1             STR                                 3AD00700
       PXD     0,4                  LOCATION                            3AD00710
       XCA                                                              3AD00720
       TSX     .BCD5R,4                                                 3AD00730
       TRA     EX8                                                      3AD00740
 EX7   CAL     XMS9                                                     3AD00750
       SLW     XMS1+1                                                   3AD00760
       CAL     XMS9+1                                                   3AD00770
 EX8   SLW     XMS1+2                                                   3AD00780
       TSX     .MWR,4              PRINT ON LINE                        3AD00790
       PZE     1                                                        3AD00800
       PZE     XMS1,,3                                                  3AD00810
* OFF-LINE PRINT                                                        3AD00820
       NZT     .JTYPE                                                   3AD00830
       TRA     .LXOUT                7090 - 3 IRS                       3AD00840
       AXT     17,4                  7094 - 7 IRS                       3AD00850
       SXD     .LXARG,4                                                 3AD00860
.LXOUT CALL    .LXSL1(SLCMD1)                                       (10)3AD00870
       ZET     STR2                                                  $5$3AD00872
       TRA     EXXT2+2                                               $5$3AD00874
       STL     SWCH                INDICATE NON NORMAL ENTRY.           3AD00880
EXERR  LDI     SYSJOB              SET SYSTEM NOGO BIT ON           (10)3AD00890
       SIL     1                                                     $5$3AD00891
       STI     SYSJOB                                               (10)3AD00892
       EJECT                                                            3AD00900
* NORMAL RETURN ENTRY POINT                                             3AD00910
* OVERLAY POINT FOR FORTRAN ALTERNATE I/O                            $5$3AD00950
*      TSX     ..FREQ,2            CHECK LAST I/O                    $5$3AD00951
.LXCAL NULL       WHENEVER ALTERNATE I/O GAINS CONTROL               $5$3AD00952
 EXRE2 NOP                         SWITCH FOR ALTERNATE I/O SYSTEM   $5$3AD00953
* SKIP CLOSING FILES IF NO IOCS                                      $5$3AD00954
       LDI     .CLSE                                                 $5$3AD00955
       LNT     500000              IF STR, NO IOCS                   $5$3AD00956
       TRA     *+2                                                   $5$3AD00957
       TRA     EXXIT                                                 $5$3AD00958
       CAL     .LFBL                                                 $5$3AD00959
       PDX     0,1                                                      3AD00960
       TXL     EXXIT,1,0           NO FILES - EXIT                      3AD00970
* CLOSE ALL FILES                                                       3AD00980
       PAC     0,2                                                      3AD00990
 EXNX  STA     FLIST                                                    3AD01000
       LDI     0,2                 CLOSE THIS FILE IF                $5$3AD01001
       ZET     0,2                 IT HAS A UNIT ASSIGNMENT          $5$3AD01002
       RNT     400000              AND A REEL HAS BEEN MOUNTED       $5$3AD01003
       TRA     NEXT                                                  $5$3AD01004
       LDI     2,2                                                      3AD01010
       LFT     200000              TEST FOR MONITOR CONTROL             3AD01020
       TRA     MNCLS               YES- CLOSE IT                        3AD01030
       LDI     4,2                                                      3AD01040
       LFT     300000                                                   3AD01050
       TRA     LXDMNT                                                   3AD01060
* SCRATCH TYPE FILE                                                     3AD01070
       LDI     1,2                 IS FILE                           $5$3AD01071
       LNT     040000              OPEN                              $5$3AD01072
       TRA     NEXT                NO                                $5$3AD01073
       LNT     003000              IS FILE                           $5$3AD01074
       TRA     *+2                 CHECKPOINT                        $5$3AD01075
       TRA     MNCLS               YES                               $5$3AD01076
       LDI     3,2                 IS FILE                           $5$3AD01077
       LFT     400000              INTERNAL                          $5$3AD01078
       TRA     NEXT                YES                               $5$3AD01079
       STA     *+2                                                      3AD01080
       TSX     .CLSE,4                                                  3AD01090
       PTW     **                                                       3AD01100
* TO NEXT FILE                                                          3AD01110
 NEXT  CAL     FLIST                                                    3AD01120
       ACL     L12                                                      3AD01130
       TXI     *+1,2,-12           COUNT THRU ALL                       3AD01140
       TIX     EXNX,1,12            FILE BLOCKS                         3AD01150
*                                                                       3AD01160
       CAL     .LFBL                                                    3AD01170
       PAC     0,2                 PICKUP FILE BLOCK ORG                3AD01180
       PDX     0,1                 PICKUP FILE BLOCK LENGTH             3AD01190
MUNP   SXA     MNXT,1                                                   3AD01200
       STL     MTMP1               SET PRIMARY UNIT SWITCH              3AD01210
       AXT     0,4                                                      3AD01220
       CLA     3,2                                                      3AD01230
       TMI     MNXT                IGNORE INTERNAL FILE                 3AD01240
       NZT     0,2                                                      3AD01250
       TRA     MNXT                IGNORE FILE WITH NO UNIT             3AD01260
       CLA     5,2                                                   $5$3AD01261
       TMI     MNXT                                                  $5$3AD01262
       LDI*    0,2                                                      3AD01270
       LNT     020100                                                   3AD01280
       TRA     *+2                                                      3AD01290
       TRA     MNXT                IGNORE DISK                          3AD01300
       LFT     000100                                                   3AD01310
       TRA     MNXT                IGNORE CARD  UNIT                    3AD01320
*                                                                       3AD01330
MUNS   CAL     0,2                                                      3AD01340
       NZT     MTMP1               IS THIS UNIT1                        3AD01350
       ARS     18                                                       3AD01360
       STA     MTMP                STORE L(UCB)                         3AD01370
*   SCAN SYSUNI TABLE FOR L(UCB)                                        3AD01380
       LAC     SYSUNI,4                                                 3AD01390
       LXD     SYSUNI,1                                                 3AD01400
MUNI   CAL     0,4                                                      3AD01410
       ANA     SMAD                                                     3AD01420
       ERA     MTMP                                                     3AD01430
       TZE     MNXT1               IGNORE SYSUNI                        3AD01440
       TXI     *+1,4,-1                                                 3AD01450
       TIX     MUNI,1,1                                                 3AD01460
*     IF NORMAL ENTRY TO .LXCON, SCAN RUTBL FOR L(UCB)                  3AD01470
       ZET     SWCH                                                     3AD01480
       TRA     MUV                                                      3AD01490
       CAL*    .LUNB                                                    3AD01500
       PDX     0,1                                                      3AD01510
       TXL     MUV,1,0             SKIP IF NO RUTBL                     3AD01520
       PAC     0,4                                                      3AD01530
MRE1   CAL     0,4                                                      3AD01540
       ARS     18                                                       3AD01550
       ERA     MTMP                                                     3AD01560
       TZE     MRES                RESERVE UNIT                         3AD01570
       TXI     *+1,4,-1                                                 3AD01580
       TIX     MRE1,1,1                                                 3AD01590
*    RETURN UNIT TO SYSUAV                                              3AD01600
MUV    CAL*    MTMP                PICKUP UCW                           3AD01610
       ANA     MDMK                                                     3AD01620
       ARS     9                                                        3AD01630
       PDC     0,4                                                      3AD01640
       TXI     *+1,4,1             CHANNEL INDEX TO IR4                 3AD01650
       SXD     *+2,4                                                    3AD01660
       LAC     SYSUAV,4                                                 3AD01670
       TXI     *+1,4,**            L(SYSUAV) TO IR4                     3AD01680
MUV1   CAL     0,4                 PICKUP SYSUAV ENTRY                  3AD01690
       ANA     SMAD                                                     3AD01700
       TZE     MUV2                                                     3AD01710
       PAC     0,4                                                      3AD01720
       ERA     MTMP                                                     3AD01730
       TZE     MNXT1                                                    3AD01740
       TRA     MUV1                                                     3AD01750
MUV2   CAL     MTMP                                                     3AD01760
       STA     0,4                                                      3AD01770
       LDI*    MTMP                                                     3AD01780
       SIL     400000                                                   3AD01790
       RIL     200000                                                   3AD01800
       RIR     077777                                                   3AD01810
       STI*    MTMP                                                     3AD01820
 MNXT1 NZT     MTMP1               IS THIS UNIT1                        3AD01830
       TRA     MNXT                                                     3AD01840
       CAL     0,2                                                      3AD01850
       ARS     18                                                       3AD01860
       ANA     SMAD                                                     3AD01870
       ERA     MTMP                                                     3AD01880
       TZE     MNXT                UNIT2 = UNIT1, GET NEXT FILE         3AD01890
       STZ     MTMP1               OTHERWISE,                           3AD01900
       TRA     MUNS                GO PROCESS UNIT2                     3AD01910
*                                                                       3AD01920
MNXT   AXT     **,1                                                     3AD01930
       TXI     *+1,2,-12                                                3AD01940
       TIX     MUNP,1,12                                                3AD01950
*  BACK TO MONITOR                                                      3AD02060
 EXXIT TSX     SYSIDR,4            SIGN OFF EXECUTION                   3AD02070
       PTW     0,4,0                                                    3AD02080
.DBCLS TRA     *+2                 OVERLAID BY 'CLOSE' OF DEBUG FILE    3AD02090
       TRA     EXXT2                                                    3AD02100
       NZT     .JLIN                                                    3AD02110
       TRA     EXXT2                                                    3AD02120
       LDQ     .JLIN                                                    3AD02130
       AXT     36,4                                                     3AD02140
       STZ     MTMP1                                                    3AD02150
 CVR1  PXD     0,0                 CONVERT JLINE TO DECIMAL             3AD02160
       DVP     BTEN                                                     3AD02170
       TZE     CVR5                                                     3AD02180
       ALS     36,4                                                     3AD02190
       ORS     MTMP1                                                    3AD02200
 CVR2  TXI     *+1,4,-6                                                 3AD02210
       TXH     CVR1,4,0                                                 3AD02220
 CVR3  CAL     BLNKS                                                    3AD02230
       ALS     36,4                                                     3AD02240
       ORA     MTMP1                                                    3AD02250
       SLW     LNMS+1                                                   3AD02260
       CALL    .LXSEL(SLCMD2)                                           3AD02270
       TSX     .MWR,4                                                   3AD02280
       PZE     1                                                        3AD02290
       PZE     LNMS+1,,4                                                3AD02300
EXXT2  CLA     TTR                 REINITIALIZE STR                  $5$3AD02310
       STO     2                   RETURN TO SYSDMP.                 $5$3AD02312
       NZT     STR                 IF NO STR, RETURN TO SYSRET       $5$3AD02320
       TRA     SYSRET                                                   3AD02330
       LDI     SYSJOB                                                $5$3AD02331
       LFT     000002       IS DEBUG POST-PROCESSING NEEDED          $5$3AD02332
       STZ     STR           YES SET STR = 0                         $5$3AD02333
       LXD     X4,4                                                     3AD02380
       LXD     X2,2                                                     3AD02390
       LXD     X1,1                                                     3AD02400
       LDI     SI                   DUMP                                3AD02410
       CLA     AC1                                                      3AD02420
       LDQ     AC2                                                      3AD02430
       LGL     2                                                        3AD02440
       LDQ     MQ                                                       3AD02450
       ZET     STR          IS DEBUG POST-PROCESSING NEEDED          $5$3AD02451
TTR    TTR     SYSDMP              DUMP WITH IBSYS DUMP              $5$3AD02460
       TSX     SYSDMP,4      YES, SNAP DUMP WITH IBSYS               $5$3AD02461
       PZE     0                    ASSEMBLY OPTION FULL CORE DUMP   $5$3AD02462
       TRA     SYSRET                                                $5$3AD02463
 CVR5  STQ     MTMP                                                     3AD02470
       ZET     MTMP                                                     3AD02480
       TRA     CVR2                                                     3AD02490
       TRA     CVR3                                                     3AD02500
*    RESERVE UCB FOR NEXT JOB                                           3AD02510
MRES   CAL     0,4                                                      3AD02520
       STA*    MTMP                                                     3AD02530
       LDI*    MTMP                                                     3AD02540
       SIL     040000                                                   3AD02550
       STI*    MTMP                                                     3AD02560
       TRA     MNXT1                                                    3AD02570
*  SPECIAL CLOSE W/OPERATOR TAPE DISPOSAL MESSAGE                       3AD02580
LXDMNT TSX     .CLSE,4             CLOSE                                3AD02590
 FLIST PZE     **                   W/REW-UNLOAD                        3AD02600
       CAL     PRINT                                                    3AD02610
       LNT     200000              PRINT                                3AD02620
       TRA     DISMT                PUNCH OR HOLD                       3AD02630
       CAL     PUNCH                                                    3AD02640
       LFT     100000                                                   3AD02650
       CAL     HOLD                                                     3AD02660
* PRINT                                                                 3AD02670
 DISMT SLW     TYPE                                                     3AD02680
       TSX     .MWR,4              PRINT                                3AD02690
       PZE     2                    'PRINT FILENAME' -OR                3AD02700
       MZE     TYPE,,1              'PUNCH FILENAME' -OR                3AD02710
       PZE     9,2,3                'HOLD  FILENAME'                    3AD02720
       TRA     NEXT                                                     3AD02730
       SPACE   1                                                        3AD02740
*      SYSTEM FILE WITH MONITOR-CONTROLLED CLOSE                        3AD02750
*      OR CHECKPOINT FILE                                            $5$3AD02751
 MNCLS STA     *+2                                                      3AD02760
       TSX     .CLSE,4             CLOSE WITH NO REW,                   3AD02770
       MON     **                   NO EOF                              3AD02780
       TRA     NEXT                                                     3AD02790
*                                  ** ERROR MESSAGES AND SELECT WORDS   3AD02800
 XMS1  BCI     3,      STR AT *****                                     3AD02810
       BCI     2,  XR1= *****                                           3AD02820
       BCI     2,  XR2= *****                                           3AD02830
       BCI     2,  XR4= *****                                           3AD02840
       BCI     2,  XR3= *****                                           3AD02850
       BCI     2,  XR5= *****                                           3AD02860
       BCI     2,  XR6= *****                                           3AD02870
       BCI     2,  XR7= *****                                           3AD02880
 XMS9  BCI     2,SYSTEM STOP                                            3AD02890
 TYPE  BCI     1,ARG                                                    3AD02900
 PRINT BCI     1,PRINT                                                  3AD02910
 PUNCH BCI     1,PUNCH                                                  3AD02920
 HOLD  BCI     1,HOLD                                                   3AD02930
 LNMS  BCI     5,1            LINES OUTPUT.                             3AD02940
SLCMD1 PTW     SYSOU1,,.LXARG                                           3AD02950
SLCMD2 PTW     SYSOU1,,IOLIN                                            3AD02960
.LXARG IORP    XMS1,,9                                                  3AD02970
       TCH     .LTCH                                                    3AD02980
 IOLIN IORT    LNMS,,5                                                  3AD02990
       TCH     .LTCH                                                    3AD03000
*                                  ** STORAGES                          3AD03010
 X1    PZE     0,,**                                                    3AD03020
 X2    PZE     0,,**                                                    3AD03030
 X4    PZE     0,,**                                                    3AD03040
 X3    PZE     0,,**                                                    3AD03050
 X5    PZE     0,,**                                                    3AD03060
 X6    PZE     0,,**                                                    3AD03070
 X7    PZE     0,,**                                                    3AD03080
 SI    PZE     **                                                       3AD03090
 MQ    PZE     **                                                       3AD03100
 AC1   PZE     **                                                       3AD03110
 AC2   PZE     **                                                       3AD03120
*                                  ** CONSTANTS AND MASKS               3AD03130
 BLNKS BCI     1,                                                       3AD03140
 SMAD  PZE     -1                                                       3AD03150
 L12   PZE     12                                                       3AD03160
 BTEN  PZE     10                                                       3AD03170
.L0    PZE     0                                                        3AD03180
*                                  ** SWITCHES AND TEMPS                3AD03190
STR    PZE     0                   SET NEQ 0 IF STR EXECUTED            3AD03200
SWCH   PZE     **                  0 IF NORMAL ENTRY                    3AD03210
MTMP   PZE                         TEMP                                 3AD03220
MTMP1  PZE                                                              3AD03230
MDMK   OCT     017777077777        MASK                                 3AD03240
       EJECT                                                            3AD03250
.CLSE  STR                                                           $5$3AD03260
.LFBL  BSS     1                                                        3AD03270
.LUNB  BSS     1                                                        3AD03280
.DFOUT NOP                         OVERLAYED BY FOUT (TSX  DMPUNB,2) $5$3AD03281
STR2   PZE     **                  NONZERO, STR WHILE PROCESSING STR $5$3AD03282
*  LOAD  COMMUNICATION CELL ENTRIES TO THIS  PROGRAM                    3AD03290
       USE     A                                                        3AD03300
       ORG     .STOPD              LOAD                                 3AD03310
       TTR     EXSTP                DEAD STOP ENTRY MECHANISM           3AD03320
       ORG     2                   LOAD                                 3AD03330
       TTR     EXSTR                'STR' MECHANISM IN CELL 2        $5$3AD03340
       USE                                                              3AD03350
       END                                                              3AD03360
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IODEF                          3AE00000
$IBMAP .IODEF  300,()OK                                                 3AE00010
       TTL     .IODEF/PRIMARY IOCS COMMUNICATIONS                   (12)3AE00020
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            3AE00030
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                3AE00040
       SPACE   1                                                        3AE00050
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 3AE00060
       SPACE   1                                                        3AE00070
NOHYP  EQU     0                                                        3AE00080
       SPACE   1                                                       $3AE00090
*END OF EQU CARDS TO BE DEFINED BY INSTALLATION.                        3AE00100
       TTL              IBSYS COMMUNICATION REGION                      3AE00110
IOEX   EQU     .ACTV                                                    3AE00120
STOP   EQU     IOEX+9              SYSTEM STOP                          3AE00130
(PROUT EQU     IOEX+4              MESSAGE WRITER                       3AE00140
TRAPS  EQU     IOEX+27             CURRENT TRAPS (NORMAL)               3AE00150
       SPACE   1                                                        3AE00160
OUTPUT BOOL    03000               NOT INPUT                            3AE00170
LABEL  BOOL    00400               IF=1 LABELS                          3AE00180
NOEOT  BOOL    00004               IF=1 NO END OF TAPE                  3AE00190
       ENTRY   .DEFIN                                                   3AE00200
       ENTRY   .ATTAC                                                   3AE00210
       ENTRY   .CLOSE                                                   3AE00220
       ENTRY   .OPEN                                                    3AE00230
       ENTRY   .READ                                                    3AE00240
       ENTRY   .WRITE                                                   3AE00250
       ENTRY   .BSR                                                     3AE00260
       ENTRY   .READR                                                   3AE00270
       ENTRY   .RELES                                                   3AE00280
       ENTRY   .LAREA                                                   3AE00290
       ENTRY   .AREA1                                                   3AE00300
       ENTRY   .LFBLK                                                   3AE00310
       ENTRY   .LUNBL                                                   3AE00320
       ENTRY   .ENTRY                                                   3AE00330
.RLHLD ENTRY   RLHLD                                                (12)3AE00335
.GO    ENTRY   GO                                                       3AE00340
.COMXI ENTRY   COMXIT                                                   3AE00350
.NOPXI ENTRY   NOPXIT                                                   3AE00360
       ENTRY   .EX34                                                    3AE00370
       ENTRY   .GOA                                                     3AE00380
       ENTRY   .DERR                                                    3AE00390
.LTSX  ENTRY   LTSX                                                  $5$3AE00395
       TTL     IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION    3AE00400
* PRIMARY IOCS COMMUNICATIONS                                           3AE00410
.DEFIN STL     ROUTE               DEFINE                               3AE00420
       BSS     1                                                        3AE00430
.JOIN  STL     ROUTE               JOIN                                 3AE00440
       BSS     1                                                        3AE00450
.ATTAC STL     ROUTE               ATTACH                               3AE00460
       BSS     1                                                        3AE00470
.CLOSE STL     ROUTE               CLOSE                                3AE00480
       BSS     1                                                        3AE00490
.OPEN  STL     ROUTE               OPEN                                 3AE00500
       BSS     1                                                        3AE00510
.READ  STL     ROUTE               READ                                 3AE00520
       BSS     1                                                        3AE00530
.WRITE STL     ROUTE               WRITE                                3AE00540
       BSS     1                                                        3AE00550
.COPY  STL     ROUTE               COPY                                 3AE00560
       BSS     1                                                        3AE00570
.REW   STL     ROUTE               REW                                  3AE00580
       BSS     1                                                        3AE00590
.WEF   STL     ROUTE               WEF                                  3AE00600
       BSS     1                                                        3AE00610
.BSR   STL     ROUTE               BSR                                  3AE00620
       BSS     1                                                        3AE00630
.BSF   STL     ROUTE               BSF                                  3AE00640
       BSS     1                                                        3AE00650
.CKPT  STL     ROUTE               CKPT                                 3AE00660
       BSS     1                                                        3AE00670
.STASH STL     ROUTE               STASH                                3AE00680
       BSS     1                                                        3AE00690
.READR STL     ROUTE               READR                                3AE00700
       BSS     1                                                        3AE00710
.RELES STL     ROUTE               RELESE                               3AE00720
       BSS     1                                                        3AE00730
       BES     3                                                        3AE00740
       TTL              SECONDARY IOCS COMMUNICATION CELLS              3AE00750
       PZE                   'DATE' IS EQUATED TO 'IBJDAT'.             3AE00760
JOBID  BCI     3,                  JOB NAME                             3AE00770
.LAREA BSS     14                  LABEL AREA                           3AE00780
.LFBLK BSS     1                   L(FILE BLOCK),,SIZE                  3AE00790
CPFILE PZE     **                  CURRENT CHECKPOINT FILE              3AE00800
CPSEQ  BCI     1, 00001            SEQ NUMBER + 1 OF LAST CHECKPOINT    3AE00810
LTSX   PZE     0,,**               L(TSX)                               3AE00820
XEOB   PZE     0,,**               L( EOB EXIT)                         3AE00830
XEOF   PZE     **,,0               L( EOF EXIT)                         3AE00840
XERR   PZE     0,,**               L( ERROR EXIT)                       3AE00850
LTRAD  PZE     **,,0               LAST TRANSMIT ADDRESS                3AE00860
TRANS  PZE     **,,0               TRANSMIT ADDRESS                     3AE00870
WDCT   PZE     0,,**               WORD COUNT                           3AE00880
IRS    PZE     **,,**              INDEX REGISTER STORAGE               3AE00890
RLHLD  PZE     **                                                   (12)3AE00895
SENSE  PZE     0,,0                SENSE INDICATOR STORAGE              3AE00900
FCW    IORT    **,,**              IO WORD FOR BUFS AND IN IOCS SWITCH  3AE00910
.AREA1 BSS     6                                                        3AE00920
.LUNBL BSS     1                   LOC AND LENGTH RESERVE UNIT BLOCK    3AE00940
CKPT1  BSS     1                   TTR CHCPT                            3AE00950
SWITCD BSS     1                   TTR MONSW                            3AE00960
MONEOF BSS     1                   TTR TEOR                             3AE00970
       TTL     COMMON ENTRY TO ALL JOBS ROUTINES                        3AE00980
*      SAVES   1. SENSE INDICATORS AND ALL INDEX REGISTERS              3AE00990
*              2.L(ENTRY) TO ROUTINE (I.E. L(TSX))                      3AE01000
*              3.L(TSX+2)                                               3AE01010
*              4.PLACES IN CELL -FCW- AND IN IR2 COMPLEMENTED           3AE01020
*                 A.L(POOL) FOR DEFINE,JOIN AND ATTACH                  3AE01030
*                 B.L(FILE) FOR ALL OTHER IOCS ROUTINES                 3AE01040
*              5.PLACES IN CELL-XEOB-                                   3AE01050
*                 A.EOB EXIT FOR READ AND WRITE                         3AE01060
*                 B.L(POOL2) FOR JOIN                                   3AE01070
*                 C.L(FILE2) FOR COPY AND STASH                         3AE01080
*              6.PLACES FILE CONTROL BITS IN SI                         3AE01090
       SPACE   1                                                        3AE01100
.ENTRY BSS     1                   ZET L(0)                             3AE01110
       TSX     STOP,4                                                  $3AE01120
       STI     SENSE                                                   $3AE01130
       SXA     LTSX,4              SAVE L(ENTRY)                       $3AE01140
       TXI     *+1,4,-2                                                 3AE01150
       BSS     1                   SAVE L(TSX)+2                        3AE01160
       SXA     IRS,2               SAVE IR2                             3AE01170
       SXD     IRS,1               SAVE IR1                             3AE01180
ROUTE  LXD     **,1                FIND L(ROUTINE)                     $3AE01190
       SXA     GO,1                WHICH WAS CALLED                    $3AE01200
       BSS     1                   CLEAR TCH SWITCH                     3AE01210
       CAL     -1,4                SAVE IN-LFCW-AND IR2(COMPLEMENTED)  $3AE01220
       BSS     1                   DISABLE TRAPS                        3AE01230
       STA     FCW                 L(BPC) FOR DEFINE,JOIN AND ATTACH    3AE01240
       PAC     0,2                 L(FCW) FOR READ,WRITE,COPY,REW,      3AE01250
       STD     XEOB                WEF, OPEN AND CLOSE                  3AE01260
       LDQ     5,2                 DISK...                           (7)3AE01261
       TQP     LDI                 NO  -  BYPASS END OF TRACKS TEST  (7)3AE01262
       ZET     .DERR                   DISK ERROR                       3AE01270
       TSX     STOPA,4                 YES                              3AE01280
       LDI     6,2                 TEST FOR END OF TRACK + EOB EXIT    $3AE01290
       RNT     700000                                                  $3AE01300
       TRA     *+2            NO                                       $3AE01310
       BSS     1                                                        3AE01320
LDI    LDI     1,2                 FILE INDICATORS TO SI             (7)3AE01330
       RIR     77777                                                   $3AE01340
       LDQ     7,2                                                  (12)3AE01345
       STQ     RLHLD                                                (12)3AE01347
       ENB     TRAPS               ALLOW TRAPS (FILE BITS IN SI)        3AE01350
.GOA   BSS     1                   IF REFERENCE TO A FILE               3AE01360
       BSS     1                   IS THIS A RELEASE ENTRY              3AE01370
       TXL     GO,1,0              YES, GO THERE                       $3AE01380
       LFT     NOEOT               AND EOT OR NON-LABELED EOF           3AE01390
GO     TTR     **                  GO TO ROUTINE CALLED                 3AE01400
       LFT     OUTPUT              IS FILE INPUT                        3AE01410
       TRA     ENT2                OR OUTPUT                            3AE01420
       LFT     LABEL               IF LABELLED INPUT                    3AE01430
       TRA*    GO                  GO TO ROUTINE WHICH WILL GIVE EOF    3AE01440
       BSS     1                   IF EOF NON LABELED FILE              3AE01450
       BSS     1                   TSX CPINT,4                          3AE01460
ENT1   SIL     NOEOT               REFERENCED,SWITCH REELS AND          3AE01470
       BSS     1                   RESTORE IR4 AND                      3AE01480
       TRA*    GO                  GO.......                            3AE01490
ENT2   BSS     1                   HANDLE EOT                           3AE01500
       TRA     ENT1                TURN OFF EOT AND CONTINUE            3AE01510
.DERR  PZE                                                              3AE01520
STOPA  CLA     .DERR                                                    3AE01530
       STZ     .DERR                                                    3AE01540
       TRA     STOP                                                     3AE01550
       BES     STOPA+NOCH/NOCH**-NOCH/NOCH*STOPA-*                      3AE01560
       TTL     COMMON. EXIT ROUTINE - COMXIT-                           3AE01570
*                              TRA COMXIT                               3AE01580
*                          NO RETURN POSSIBLE                           3AE01590
*                        THIS ROUTINE RESTORES                          3AE01600
*              1.IR2,IR1,SI                                             3AE01610
*              2. FILE CONTROL BITS TO FILE WORDS                       3AE01620
*         AND PLACES HISTORY IN THE AC                                  3AE01630
       SPACE   1                                                        3AE01640
NOPXIT SXD     LTRAD,4             SAVE LAST WRD WORKED ON              3AE01650
       BSS     1                                                        3AE01660
COMXIT BSS     1                   DISABLE TRAPS                        3AE01670
       PIA                         RESTORE CONTROL                      3AE01680
       STD     1,2                 BITS TO FILE                         3AE01690
       SXA     FCW,0               SET IOBS SWITCH =0                   3AE01700
       BSS     1                                                        3AE01710
       ENB     TRAPS               ALLOW TRAPS                          3AE01720
EX14   BSS     1                                                        3AE01730
       TRA     EX19                SWITCH FOR CKPTS                     3AE01740
       ZET     CPSW                DOWN WAIT TILL PLACED UP             3AE01750
       TRA     EX23                THEN DOWN...                         3AE01760
       STL     CPSW                SENSE LITE ON SIGNIFIES THAT         3AE01770
       BSS     1                   THE CORRESDONDING SENSE              3AE01780
       TRA     EX23                SWITCH HAS NOT BEEN SENSED           3AE01790
EX19   STZ     CPSW                IN THE UP POSITION.                  3AE01800
EX23   CLA     LTRAD               HISTORY TO AC                        3AE01810
       BSS     1                   IF TCH OCCURED                       3AE01820
       BSS     1                   EXIT AT L (1ST TCH) +1               3AE01830
       BSS     1                   ELSE AT NORMAL EXIT                  3AE01840
.EX34  LXA     IRS,2               RESTORE IR2                          3AE01850
       LXD     IRS,1                                                    3AE01860
       LDI     SENSE               RESTORE SI                           3AE01870
       TTR     0,4                 RETURN TO USER                       3AE01880
CPSW   PZE     **,,0               ZERO IF CKPT SENSE SWITCH UP         3AE01890
.GO    EQU     GO                                                       3AE01900
.COMXI EQU     COMXIT                                                   3AE01910
.NOPXI EQU     NOPXIT                                                   3AE01920
       ORG     .CLSE                                                    3AE01930
       TTR     .CLOSE                                                   3AE01940
       ORG     .LUNB                                                    3AE01970
       PZE     .LUNBL                                                   3AE01980
       END                         END OF COMMUNICATION AREA            3AE01990
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCSF                          3AF00000
$IBMAP .IOCSF  2800,()OK                                             $5$3AF00010
       TTL     .IOCSF - FORTRAN IOCS                                (12)3AF00020
       LBL     .IOF,BEGIN     .IOCSF                                 (7)3AF00025
*7090/7094 IOCS VERSION - 6 - (FORTRAN VERSION)                         3AF00030
       TITLE                                                            3AF00040
       SPACE   1                                                        3AF00050
*THIS IS IOCS VERSION -6- WHICH HAS BEEN PREPARED                       3AF00060
*  FROM THE DISTRIBUTED VERSION OF THE IOCS SYSTEM                      3AF00070
* HERE, IOCC IS PRESENTED AS A SET OF SUBROUTINES                       3AF00080
*  WHICH MAY BE USED BY ANY SYSTEM FOR BUFFERRED I/O.                   3AF00090
*  USE OF THE BASIC MONITOR AND EXECUTOR IS REQUIRED.                   3AF00100
*  REFER TO BASIC MONITOR AND IOCS MANUALS FOR                          3AF00110
*  DETAILED CONTENT AND RULES OF USEAGE.                                3AF00120
       SPACE   1                                                        3AF00130
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            3AF00140
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                3AF00150
       SPACE   1                                                        3AF00160
*SYSTEM PRINTER                                                         3AF00170
       SPACE   1                                                        3AF00180
*      PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10              3AF00190
EJECT  EQU     1                                                        3AF00200
       SPACE   1                                                        3AF00210
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       3AF00220
DBLSP  EQU     4                                                        3AF00230
       SPACE   1                                                        3AF00240
*SENSE SWITCHES                                                         3AF00250
       SPACE   1                                                        3AF00260
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 3AF00270
       SPACE   1                                                        3AF00280
NOHYP  EQU     0                   NO HYPERTAPE DEFINED IN IOCS         3AF00290
       SPACE   1                                                       $3AF00300
*END OF EQU CARDS TO BE DEFINED BY INSTALLATION.                        3AF00310
       TTL              IBSYS COMMUNICATION REGION                      3AF00320
IOEX   EQU     .ACTV                                                    3AF00330
(ACTIV EQU     IOEX                VALIDATE UNIT AND                    3AF00340
(ACTVX EQU     IOEX+1               ACTIVATE CHANNEL                    3AF00350
(NDATA EQU     IOEX+2              VALIDATE UNIT AND                    3AF00360
(NDSLX EQU     IOEX+3               NON-DATA SELECT                     3AF00370
(PROUT EQU     IOEX+4              MESSAGE WRITER                       3AF00380
(PUNCH EQU     IOEX+5              HOLLERITH PUNCH                      3AF00390
(FRCHX EQU     IOEX+6              FREE CHANNEL                         3AF00400
(PAWSX EQU     IOEX+7              ERROR PAUSE                          3AF00410
(PAUSE EQU     IOEX+8              OPERATOR ACTION PAUSE                3AF00420
(STOPX EQU     IOEX+9              SYSTEM STOP                          3AF00430
(SYMUN EQU     IOEX+10             SYMBOLIC UNIT CONVERSION             3AF00440
(DECVD EQU     IOEX+11             BIN TO DEC CONV. AC DECRE.           3AF00450
(DECVA EQU     IOEX+12             BIN TO DEC CONV. AC ADDR.            3AF00460
(CKWAT EQU     IOEX+13             CHECKPOINT DELAY ROUTINE             3AF00470
(BCD5R EQU     IOEX+14             BIN TO BCD CONV. MQ 3-17             3AF00480
(BCD5X EQU     IOEX+15             BIN TO BCD CONV. MQ S-14             3AF00490
(CVPRT EQU     IOEX+16             APPEND UNIT AND PRINT MESSAGE        3AF00500
(STOPD EQU     IOEX+17             DEAD STOP                            3AF00510
(CHXAC EQU     IOEX+18             CHANNEL ACTIVITY                     3AF00520
(URRXI EQU     IOEX+19             REDUNDANCY COUNTS                    3AF00530
(RCTXI EQU     IOEX+20             REDUNDANCY CONTROL                   3AF00540
(RCHXI EQU     IOEX+21             RCHX                                 3AF00550
(TCOXI EQU     IOEX+22             TCOX                                 3AF00560
(TRCXI EQU     IOEX+23             TRCX                                 3AF00570
(ETTXI EQU     IOEX+24             ETTX                                 3AF00580
(TEFXI EQU     IOEX+25             TEFX                                 3AF00590
(TRAPX EQU     IOEX+26             INDIRECT REF TRAP CELL               3AF00600
(TRAPS EQU     IOEX+27             CURRENT TRAPS (NORMAL)               3AF00610
(COMMM EQU     IOEX+28             SCHX RESULT AT TRAP                  3AF00620
(LTPOS EQU     IOEX+29             TP. POSITION BEFORE TRAP             3AF00630
(IOXSI EQU     IOEX+30             SI AT TRAP                           3AF00640
(CHPSW EQU     IOEX+31             CHECKPOINT SWITCH                    3AF00650
(TRPSW EQU     IOEX+32             TRAP SWITCH                          3AF00660
(FDAMT EQU     IOEX+33                                                 $3AF00670
(CHXSP EQU     IOEX+38                                                  3AF00680
       TTL              INTERMEDIATE DEFINITIONS                        3AF00690
PROUT  EQU     (PROUT                                                   3AF00700
PAWS   EQU     (PAWSX                                                   3AF00710
PAUSE  EQU     (PAUSE                                                   3AF00720
STOP   EQU     (STOPX                                                   3AF00730
ACTV   EQU     (ACTIV                                                   3AF00740
TRAPS  EQU     (TRAPS                                                   3AF00750
CVPRT  EQU     (CVPRT                                                   3AF00760
BCD5   EQU     (BCD5X                                                   3AF00770
COMM   EQU     (COMMM                                                   3AF00780
LTPOS  EQU     (LTPOS                                                   3AF00790
INTRAP EQU     (TRPSW                                                   3AF00800
SYUNCV EQU     (SYMUN                                                   3AF00810
NDATA  EQU     (NDATA                                                   3AF00820
BPRNT  EQU     (PROUT                                                   3AF00830
BSK1   EQU     EJECT                                                    3AF00840
BPAWS  EQU     (PAWSX                                                   3AF00850
TRPSW  EQU     (TRPSW                                                   3AF00860
STOPD  EQU     (STOPX                                                   3AF00870
X09CH  EQU     NOCH+NOHYP                                               3AF00880
NOCHX  EQU     X09CH/X09CH                                              3AF00890
NOPXIT EQU     .NOPXI                                                   3AF00900
COMXIT EQU     .COMXI                                                   3AF00910
LTSX   EQU     .LFBLK+3                                                 3AF00920
XEOB   EQU     .LFBLK+4                                                 3AF00930
XEOF   EQU     .LFBLK+5                                                 3AF00940
XERR   EQU     .LFBLK+6                                                 3AF00950
LTRAD  EQU     .LFBLK+7                                                 3AF00960
TRANS  EQU     .LFBLK+8                                                 3AF00970
WDCT   EQU     .LFBLK+9                                                 3AF00980
FCW    EQU     .AREA1-1                                                 3AF00990
EX34   EQU     .EX34                                                    3AF01000
       USE                                                              3AF01010
       BEGIN   L,*                                                      3AF01020
       USE     L                                                        3AF01030
       ORG     .DEFIN+1                                                 3AF01040
       TXL     .ENTRY,,DEFIN.                                           3AF01050
       BSS     3                                                        3AF01060
       TXL     .ENTRY,,ATTCH.                                           3AF01070
       BSS     1                                                        3AF01080
       TXL     .ENTRY,,CLOSE.                                           3AF01090
       BSS     1                                                        3AF01100
       TXL     .ENTRY,,OPEN.                                            3AF01110
       BSS     1                                                        3AF01120
       TXL     .ENTRY,,READ.                                            3AF01130
       BSS     1                                                        3AF01140
       TXL     .ENTRY,,WRITE.                                           3AF01150
       BSS     7                                                        3AF01160
       TXL     .ENTRY,,BSR.                                             3AF01170
       ORG     .ENTRY                                                   3AF01180
       ZET     L(0)                                                     3AF01190
       ORG     .ENTRY+5                                                 3AF01200
       SXA     GTIOX,4                                                  3AF01210
       ORG     .ENTRY+23                                             (7)3AF01211
       TXH     ENDTRK,1,ATTCH.                                       (7)3AF01212
       ORG     .GOA                                                     3AF01220
       TXL     .GO,1,OPEN.                                              3AF01230
       TRA     *+2                                                      3AF01240
       ORG     .ENTRY+10                                                3AF01250
       STZ     TCHEX                                                    3AF01260
       BES     1                                                        3AF01270
       ENB     L(0)                                                     3AF01280
       ORG     .GO+5                                                    3AF01290
       TSX     SWITCH,1                                                 3AF01300
       NOP                                                              3AF01310
       BES     1                                                        3AF01320
       LXA     GTIOX,4                                                  3AF01330
       BES     1                                                        3AF01340
       TSX     EOTOF,1                                                  3AF01350
       ORG     .NOPXI+1                                                 3AF01360
       TSX     FEEIT,1                                                  3AF01370
       ENB     L(0)                                                     3AF01380
       ORG     .COMXI+4                                                 3AF01390
       TRA     *+1                                                      3AF01400
       BSS     1                                                        3AF01410
       TRA     .EX34-4                                                  3AF01420
       ORG     .COMXI+15                                                3AF01430
       LXA     GTIOX,4                                                  3AF01440
       ZET     TCHEX                                                    3AF01450
       LXA     TCHEX,4                                                  3AF01460
       USE                                                              3AF01470
       TTL              CONSTANT POOL                                   3AF01480
L(0)   PZE                                                              3AF01490
L(1)   PZE     1                                                        3AF01500
L(377) OCT     377                                                      3AF01510
L(400) OCT     400                                                      3AF01520
ADDRS  PZE     -1                                                       3AF01530
1DEC   PZE     0,,1                                                     3AF01540
1B17   EQU     1DEC                                                     3AF01550
L(0)D  PZE     0,,L(0)                                                  3AF01560
DECRE  PZE     0,,-1                                                    3AF01570
1PRE   PON                                                              3AF01580
FOR    FOR                                                              3AF01590
2PRE   TIX     0,0,0                                                    3AF01600
SIX    SIX                                                              3AF01610
6PRE   EQU     SIX                                                      3AF01620
L(6)   PZE     6                                                        3AF01630
L(22)  PZE     22                                                       3AF01640
L(40)  PZE     40                                                      $3AF01650
BVDG   OCT     020100000000                                             3AF01660
DEC15  OCT     000017000000                                             3AF01670
L(4)   PZE     4                                                        3AF01680
L(2)   PZE     2                                                        3AF01690
       BES     *-7+NOCHX/NOCHX*7-*                                      3AF01700
7PRE   SVN                                                              3AF01710
       TTL     INDICATOR ASSIGNMENTS                                    3AF01720
       SPACE   1                                                        3AF01730
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $3AF01740
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $3AF01750
CP2    BOOL    100000              ARE 00,01,10                        $3AF01760
OPEND  BOOL    40000               IF=1 FILE OPEN                       3AF01770
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               3AF01780
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              3AF01790
MODE   BOOL    04000               IF=1 BINARY FILE                     3AF01800
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             3AF01810
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 3AF01820
LABEL  BOOL    00400               IF=1 LABELS                          3AF01830
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                3AF01840
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       3AF01850
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               3AF01860
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              3AF01870
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        3AF01880
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                3AF01890
NOEOT  BOOL    00004               IF=1 NO EOT                          3AF01900
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            3AF01910
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                3AF01920
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           3AF01930
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          3AF01940
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $3AF01950
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  3AF01960
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  3AF01970
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            3AF01980
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    3AF01990
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    3AF02000
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             3AF02010
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  3AF02020
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       3AF02030
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               3AF02040
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        3AF02050
STSH   BOOL    00100               IF =1 STASH ROUTINE                  3AF02060
CPYFN  BOOL    00040               IF =1 COPY MODE                      3AF02070
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         3AF02080
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  3AF02090
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    3AF02100
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    3AF02110
IOSY   BOOL    00004               IF=1, IOSY WRITE                     3AF02120
NORUN  BOOL    00002               IF=1 NO REW UNLD                     3AF02130
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 3AF02140
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          3AF02150
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $3AF02160
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               3AF02170
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        3AF02180
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     3AF02190
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 3AF02200
CDBTS  BOOL    24000               DISCN+EOB                            3AF02210
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     3AF02220
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        3AF02230
OUTPUT BOOL    03000               PTO+TTO                              3AF02240
OPDET  BOOL    40002               OPEND+DETACH                         3AF02250
RESOP  BOOL    60000               RESER+OPEND                          3AF02260
OPNEOT BOOL    40004               OPEND+NOEOT                          3AF02270
RANDG  BOOL    00030               RUSH+GIVUP                           3AF02280
EOBITS BOOL    44400               DONLY+EOB+HOLD                       3AF02290
DIGEN  BOOL    30000               DISCN+GENER                          3AF02300
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     3AF02310
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       3AF02320
NOREOF BOOL    00003               NORED + NOEOF                        3AF02330
RBITS  BOOL    00011               RUSH + RHIST                        $3AF02340
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 3AF02350
NETIH  BOOL    10004               NO EOT+NINHIB                        3AF02360
REWNUN BOOL    00006               NORUN + NOREW                       $3AF02370
*                  CONSTANTS AND MASKS FOR INDICATORS                   3AF02380
       SPACE   1                                                        3AF02390
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              3AF02400
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  3AF02410
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              3AF02420
NOTIN  SVN     -1,7,-1-NINHIB                                           3AF02430
EOTBT  SVN     -1,7,-1-NOEOT                                            3AF02440
NEOTBT PZE     0,,NOEOT                                                 3AF02450
MODBT  PZE     0,0,MODE                                                 3AF02460
       TTL     DEFINE A. BUFFER POOL                                    3AF02470
*      CALLING SEQUENCE                                                 3AF02480
*              TSX  DEFINE,4                                            3AF02490
*              PZE  L(POOL)                                             3AF02500
*              PZE  N,,EFF BUF SIZE                                     3AF02510
*              RETURN                                                   3AF02520
*                                WHERE                                  3AF02530
*                  L(POOL) = LOCATION OF BUFFER POOL                    3AF02540
*                  N= NUMBER OF BUFFERS TO BE FORMED                    3AF02550
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            3AF02560
*      COMMENTS-                                                        3AF02570
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   3AF02580
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   3AF02590
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                3AF02600
       SPACE   1                                                        3AF02610
DEFIN. CLS     -1,4                SAVE                                 3AF02620
       ACL     L(1)                L(POOL+1)                            3AF02630
       STA     DE1                                                      3AF02640
       ACL     L(1)                SET LOCATION                         3AF02650
       STA     DE3                 OF 1ST BUFFER                        3AF02660
       STO*    FCW                 SET BPC= FOR BUF1,,0                 3AF02670
       CAL     0,4                 SET SECOND WORD                      3AF02680
       ANA     DECRE               OF POOL =                            3AF02690
       LGL     4                   S-13= BUF. SIZE                      3AF02700
DE1    SLW     **                  14-35 = 0                            3AF02710
       CLA     0,4                 SET IORT                             3AF02720
       STD     FCW                 =IORT POOL,,SIZE                     3AF02730
       PDX     0,1                 PLACE SIZE+2                         3AF02740
       TXI     *+1,1,2             INTO IR1                             3AF02750
       PAX     0,2                 NUMBER OF BUFFERS                    3AF02760
       ALS     18                  TO IR2                               3AF02770
       STD*    FCW                 AND POOL                             3AF02780
       CLA     DE3                 GO SETUP                             3AF02790
       ACL     L(1)                CHAIN MECHANISM                      3AF02800
       STA     DE4                                                      3AF02810
DE2    CLA     FCW                 CHAIN BUFFER POOL                    3AF02820
DE3    STZ     **                  1ST BUFFER CONTROL WORD              3AF02830
       STA*    *-1                 = 0 00000 0 CHAIN                    3AF02840
DE4    STO     **                  2ND= IORT BPC,,SIZE                  3AF02850
       TNX     DE6,2,1             TEST IF N FORMED                     3AF02860
       PXA     0,1                 CHAIN LAST                           3AF02870
       ACL     DE3                 BUF TO NEXT                          3AF02880
       STA*    DE3                 FINAL BUFFER IS                      3AF02890
       STA     DE3                 CHAINED TO BPC                       3AF02900
       TRA     DE2-2                                                    3AF02910
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              3AF02920
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         3AF02930
       TXI     EX34,4,-1           EXIT AT 3,4                          3AF02940
       TTL     ATTACH ROUTINE                                           3AF02950
*                          CALLING SEQUENCES                            3AF02960
       SPACE   1                                                        3AF02970
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 3AF02980
*              PZE  POOL            TO SPECIFIED POOL                   3AF02990
*              PZE  LIST,,FILECT                                        3AF03000
*                             RESTRICTIONS                              3AF03010
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        3AF03020
*                  IN ONE ATTACH CALLING SEQUENCE                       3AF03030
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       3AF03040
       SPACE   1                                                        3AF03050
*                            ATTACH ROUTINE                             3AF03060
ATTCH. STA     LBC                 SAVE L(POOL)                         3AF03070
       PXA     0,0                 SET OUTPUT CHAIN = 0                 3AF03080
       STA     1,2                 IF POOL HAS BEEN                     3AF03090
       CLA     0,4                 FOR SUBROUTINE                       3AF03100
       TXI     *+1,4,-1            ADVANCE EXIT FOR XTRA WORD           3AF03110
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       3AF03120
       SXA     GTIOX,4             SAVE L(EXIT)                         3AF03130
       TRA     CA3+2               EXAMINE LIST                         3AF03140
CA3    CLA     CA51                ADVANCE IN LIST                      3AF03150
       ACL     L(1)                STARTS AT L(LIST)-1                  3AF03160
       STA     CA51                IN LIST LOCATOR                      3AF03170
       ENB     L(0)                TRAP PROTECT                         3AF03180
CA51   CAL     **                  WHILE ADJUSTING                      3AF03190
       PAC     0,2                 COUNTS                               3AF03200
       STA     FCW                 IN FCW CELL                          3AF03210
       PAI                         FOR CHECK OF SIX OR SUN WORD         3AF03220
       CLA*    CA51                PICK UP LIST ENTRY                   3AF03230
       LNT     600000              SIX OR SUN                           3AF03240
       TRA     CA6                 NO--PZE                              3AF03250
       SXD     CA4,2               STORE FILECT FOR REDUCING BUFCT.     3AF03260
       PDX     0,1                 REDUCE                              $3AF03270
       PDX     0,4                 THE                                 $3AF03280
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             3AF03290
       PXD     0,4                 THAT THE SPECIFIED NUMBER            3AF03300
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        3AF03310
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        3AF03320
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   3AF03330
CA5    PXD     **,1                REDUCE IBACT BY                      3AF03340
       ADD*    LBC                 SUBTRACTING BUFFER COUNT             3AF03350
       STD*    LBC                 USED BY THIS GROUP                   3AF03360
       TRA     CA3                 PROCESS FILE LIST                    3AF03370
*                        FILE HANDLER (ATTACH)                          3AF03380
       SPACE   1                                                        3AF03390
CA6    LDI     1,2                 GET FCB BIT AND MAKE                 3AF03400
       SIL     RESER               FILE A RESERVE FILE                  3AF03410
       CAL     CA5                 PLACE L(SVN WORD)                    3AF03420
       STA     3,2                 IN FCB                               3AF03430
       CLA     LBC                 PLACE L(POOL) IN                     3AF03440
       STA     2,2                 FILE CONTROL WORDS                   3AF03450
       ALS     18                  2ND WORD ADDRESS AND                 3AF03460
       STD     4,2                 5TH WORD DECREMENT                   3AF03470
       ENB     TRAPS               ALLOW TRAPS                          3AF03480
       PIA                         PLACE CONTROL BITS                   3AF03490
       STD     1,2                 IN FILE                              3AF03500
CA25   LXD     CA26,1              ADVANCE                              3AF03510
       TNX     COMXIT+3,1,1        ALONG FILE LIST                      3AF03520
       SXD     CA26,1              AS LONG AS MORE FILES                3AF03530
CA26   TXL     CA3,0,**                                                 3AF03540
       TTL     DE-ACTIVATE AND CLOSE FILE                               3AF03550
CLOSE. ARS     33                                                       3AF03560
       OAI                                                              3AF03570
       LFT     DETACH                                                   3AF03580
       TRA     COMXIT                                                   3AF03590
       TSX     FNLBC,4             FIND POOL                            3AF03600
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3AF03610
       LNT     RESOP               IF CLOSING AN OPEN                   3AF03620
       TRA     *+4                 RESERVE FILE                         3AF03630
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   3AF03640
       ACL     L(1)                ALLOWING ANOTHER FILE                3AF03650
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      3AF03660
       LNT     OPEND               IF FILE NEVER                        3AF03670
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $3AF03680
       LFT     OUTPUT              INPUT OR                             3AF03690
       TRA     SH5                 OUTPUT FILE                          3AF03700
       SPACE   1                                                        3AF03710
*                           CLOSE INPUT FILE                            3AF03720
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3AF03730
SH2    CAL     0,2                 MAKE SURE EOF                        3AF03740
       ANA     FOR                 FLAG IS OFF                         $3AF03750
       STP     0,2                                                     $3AF03760
       BES     *-3+NOCH/NOCH*3-*                                        3AF03770
SH4    CLA     5,2                 CHECK FOR HYPER                      3AF03780
       ANA     SIX                                                     $3AF03790
       TNZ     SH1                 729 OR DISK                          3AF03800
       RNT     REWNUN                                                  $3AF03810
       TRA     SH6                 RETURN                              $3AF03820
       RIR     REWNUN              TAKE OUT HYPER OPTION               $3AF03830
       TRA     SH6                 RETURN                              $3AF03840
SH1    RNT     5                                                        3AF03850
       TRA     *+3                                                      3AF03860
       RNT     2                                                        3AF03870
       TRA     *+5                                                      3AF03880
       RNT     NOEOFM                                                   3AF03890
       TRA     *+3                 NO                                  $3AF03900
       TSX     (NDSLX,4            YES                                 $3AF03910
       PZE     0,2,HFPNP           FILE PROTECT                        $3AF03920
       RNT     REWNUN              TEST FOR UNLOAD                     $3AF03930
       TRA     SH6                 NO                                  $3AF03940
       TSX     (NDSLX,4            YES                                 $3AF03950
       PZE     0,2,HUNLP           UNLOAD                              $3AF03960
       TRA     SH4.1-1             EXIT                                 3AF03970
       BES     SH4+NOHYP/NOHYP**-NOHYP/NOHYP*SH4-*                     $3AF03980
SH6    RFT     NOREW               IF NO REWIND                         3AF03990
       TRA     SH4.1               SPECIFIED SKIP OUT                   3AF04000
       CAL     3DEC                FORM REW CODE (=3)                   3AF04010
       RNT     NORUN               OR REW UNLOAD                        3AF04020
       ACL     1DEC                CODE (=4)                            3AF04030
       STD     *+2                                                      3AF04040
       TSX     NDSEL+1,4           ISSUE REW                            3AF04050
       PZE     0,2,**              OR RUN                               3AF04060
       RFT     REWNUN              IF REWOUND AND                      $3AF04070
       TRA     SH4.1               UNLOADED                             3AF04080
       SIL     DETACH              PRINT MESSAGE                        3AF04090
SH4.1  RIL     OPEND               RESET OPEN BIT                       3AF04100
       TRA     COMXIT              EXIT                                 3AF04110
       SPACE   1                                                        3AF04120
*                          CLOSE OUTPUT FILE                            3AF04130
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            3AF04140
       RNT     000005              CHECK FOR HYPER OPTIONS             $3AF04150
       TRA     *+3                 NOT MON OPTION                      $3AF04160
       RNT     NORUN               IF TRUE MON OPTION                  $3AF04170
       TRA     SH3                 SKIP EOF AND LABEL WRITES            3AF04180
       TSX     NDSEL+1,4           WRITE                                3AF04190
       PZE     0,2,WEFOP           EOF                                  3AF04200
       NOP                         IGNORE EOT                           3AF04210
SH3    LAC     LBC,4               L(POOL) TO IR4                       3AF04220
       SXD     SH33,2              REMOVE FILE FROM                     3AF04230
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              3AF04240
       PAX     0,1                 FILE THAT REFERENCES CLOSING         3AF04250
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           3AF04260
       TXL     SH34,1,0            FOUND.                               3AF04270
       PAC     0,4                 NOT FOUND. ADVANCE                   3AF04280
       TRA     SH32                ALONG CHAIN.                         3AF04290
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           3AF04300
       STA     1,4                 REFERENCED CLOSING FILE              3AF04310
       RNT     000005              IS THIS CLOSE                       $3AF04320
       TRA     *+3                 A TRUE MON OPTION                   $3AF04330
       RNT     NORUN                                                   $3AF04340
       TRA     SH4.1               YES,POST AND RETURN                 $3AF04350
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $3AF04360
       TTL                         OPEN ROUTINE                         3AF04370
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              3AF04380
       SPACE   1                                                        3AF04390
*                           CALLING SEQUENCE                            3AF04400
*              TSX OPEN,4                                               3AF04410
*               P  FILE,,1                                              3AF04420
*      WHERE                                                            3AF04430
*              P= PZE REWIND BEFORE OPEN                                3AF04440
*              P= MZE NO REWIND                                         3AF04450
*              P= MON NO REWIND, NO LABELS                              3AF04460
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  3AF04470
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           3AF04480
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE 3AF04490
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     3AF04500
*      ACTIONS ....                                                     3AF04510
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      3AF04520
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             3AF04530
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                3AF04540
       SPACE   1                                                        3AF04550
OPEN.  LFT     OPEND               IF FILE OPEN                         3AF04560
       TRA     OP1                 GO HOME                              3AF04570
       SIL     NETIH               SET NO INHIBIT BIT                   3AF04580
       CLA*    3,2                 SURE THAT NO MORE                    3AF04590
       PAX     0,1                 THAN THE SPECIFIED                   3AF04600
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  3AF04610
       TXH     SY9.3,1,4096        OPEN AT SAME TIME                    3AF04620
       PXA     0,1                                                      3AF04630
       STA*    3,2                                                      3AF04640
       CLA     OP6                 MAKE SURE THAT                       3AF04650
       STT     0,2                 IMEDIATE MOUNT FLAG IS ON            3AF04660
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $3AF04670
       STA     4,2                 = L(0)                               3AF04680
       TSX     (NDATA,4            TEST LEGALITY                       $3AF04690
2TAG   PZE     0,2,TESTP           OF UNIT                              3AF04700
       TSX     DENSE,4             SET FILE DENSITY                     3AF04710
       LXA     GTIOX,4                                                  3AF04720
       CLA     -1,4                                                     3AF04730
       TMI     OP4                 NO REW                               3AF04740
       TSX     NDSEL+1,4           REWIND BEFORE                        3AF04750
       PZE     0,2,REWOP           OPEN                                 3AF04760
OP4    CLA     5,2                 IS THIS HYPER                        3AF04770
       ANA     SIX                                                      3AF04780
       TNZ     OP7.1               YES                                  3AF04790
       TRA     OP7.3                                                    3AF04800
       BES     *-4+NOHYP/NOHYP*4-*                                      3AF04810
       SPACE   1                                                        3AF04820
*                           OPEN INPUT FILE                             3AF04830
OP6    TSX     FNLBC,4             FIND L(POOL)                         3AF04840
       LFT     OUTPUT                                                   3AF04850
       TRA     OP9                                                      3AF04860
       PXD     0,0                 CLEAR BUFFER COUNT                   3AF04870
       STA     1,2                 IN FCB.                              3AF04880
       TSX     BORBF,1             INITIATE READ                        3AF04890
LBC    NOP                         IF POSSIBLE ... L(POOL)...           3AF04900
OP1    SIL     OPNEOT              SET OPEN AND NO EOT BITS             3AF04910
       TRA     COMXIT              EXIT TO USER                         3AF04920
OP9    LAC     LBC,4               L (POOL) TO IR4                      3AF04930
       CLA     1,4                 PLACE OUTPUT                         3AF04940
       STA     1,2                 FILE IN SYNCING                      3AF04950
       CLA     FCW                 CHAIN USED TO                        3AF04960
       STA     1,4                 RELEASED TO THE                      3AF04970
       TRA     OP1                 BUFFER POOL                          3AF04980
3DEC   PZE     ,,3                                                 IBJOB3AF04990
       SPACE   1                                                        3AF05000
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $3AF05010
OP7.1  RIR     MXDMD               RESET BACKWARD READ                 $3AF05020
       PIA                                                             $3AF05030
       STT     1,2                                                     $3AF05040
       LFT     OUTPUT              IF OUTPUT                           $3AF05050
       TRA     OP6                 ALL DONE                             3AF05060
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $3AF05070
       TXL     OP7.2,4,0           NO                                  $3AF05080
       ORA     *-1                 SET READ                            $3AF05090
       STT     1,2                 BACKWARD                            $3AF05100
       AXC     2,4                                                     $3AF05110
       CLA*    0,2                                                     $3AF05120
       ANA     ADDRS               IF NEXT READ IS NOT A               $3AF05130
       TNZ     OP7.2               FILE MARK THEN PROCEED              $3AF05140
       TSX     (NDSLX,4            ELSE BACKSPACE FILE                 $3AF05150
       PZE     0,2,HBSFP                                               $3AF05160
OP7.2  LXA     GTIOX,4                                                  3AF05170
       CLA     -1,4                TEST FOR THE                        $3AF05180
       ANA     SIX                 SETTING OF FILE PROTECT             $3AF05190
       TZE     *+3                 NO                                  $3AF05200
       TSX     (NDSLX,4                                                $3AF05210
       PZE     0,2,HFPNP           FILE PROTECT                        $3AF05220
       TRA     OP6                                                      3AF05230
OP7.3  LFT     OUTPUT                                                  $3AF05240
       TRA     OP6                                                      3AF05250
       LXD     XEOB,4              IF READ                             $3AF05260
       TXL     OP6,4,0             BACKWARD                             3AF05270
       TSX     NDSEL+1,4           REWIND 729                          $3AF05280
       PZE     0,2,REWOP           OR DISK INPUT                       $3AF05290
       TRA     OP6                                                      3AF05300
       BES     OP7.1+NOHYP/NOHYP**-NOHYP/NOHYP*OP7.1-*                  3AF05310
       TTL                         BUFFERED READ ROUTINE                3AF05320
*              TSX  READ,4              BUFFERED READ                   3AF05330
*              PZE  FILE,,EOB           END OF BLOCK                    3AF05340
*              PZE  EOF,,ERR              END OF FILE AND               3AF05350
*                   *                     ERROR EXITS                   3AF05360
*                   *                                                   3AF05370
*                  IO-LIST                                              3AF05380
*                   *                                                   3AF05390
*              RETURN                                                   3AF05400
       SPACE   1                                                        3AF05410
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3AF05420
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3AF05430
*                              IS GIVEN.                                3AF05440
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   3AF05450
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3AF05460
*                            BUFFER AREA ATTACHED TO THE FILE           3AF05470
       SPACE   1                                                        3AF05480
READ.  SIR     RDSWIT              SET READ SWITCH                     $3AF05490
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    3AF05500
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             3AF05510
       CLA     -1,4                SAVE MODAL EXITS                     3AF05520
       STA     XEOF                END OF FILE                          3AF05530
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     3AF05540
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     3AF05550
       TRA     EOFER               TAKE END OF FILE EXIT                3AF05560
       TSX     FNLBC,4             FIND L(POOL)                         3AF05570
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      3AF05580
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             3AF05590
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       3AF05600
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 3AF05610
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     3AF05620
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     3AF05630
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           3AF05640
       PZE     TRM1                3.TRANSMIT FROM                      3AF05650
       PZE     TRM2                BUFFER TO WORKING STORAGE            3AF05660
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   3AF05670
       TTL                         BUFFERED WRITE ROUTINE               3AF05680
*              TSX WRITE,4              BUFFERED WRITE                  3AF05690
*              PZE  FILE,,EOB            END OF BLOCK EXIT              3AF05700
*                    *                                                  3AF05710
*                    *                                                  3AF05720
*                  IO-LIST                                              3AF05730
*                   *                                                   3AF05740
*              RETURN                                                   3AF05750
       SPACE   1                                                        3AF05760
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3AF05770
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3AF05780
*                              IS GIVEN.                                3AF05790
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  3AF05800
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3AF05810
*                            BUFFER AREA ATTACHED TO THE FILE           3AF05820
       SPACE   1                                                        3AF05830
WRITE. LNT     OPEND               IF FILE NOT OPEN                     3AF05840
       TRA     NOPXIT              DO NOTHING EXIT                      3AF05850
       TSX     FNLBC,4             FIND L(POOL)                         3AF05860
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    3AF05870
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    3AF05880
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   3AF05890
       PZE     TRM2                3.TRANSMIT FROM                      3AF05900
       PZE     TRM1                WORKING STORAGE TO BUFFER            3AF05910
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  3AF05920
       SPACE   2                                                        3AF05930
*                  FIND L(BPC) FROM FILE CONTROL WORD                   3AF05940
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            3AF05950
FNLBC  CLA     4,2                                                      3AF05960
       PDX     0,1                                                      3AF05970
       SXA     LBC,1                                                    3AF05980
       TRA     1,4                                                      3AF05990
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         3AF06000
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          3AF06010
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    3AF06020
       SPACE   1                                                        3AF06030
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            3AF06040
*                          IR4 MUST= -L(POOL)                           3AF06050
       SPACE   1                                                        3AF06060
TOKBB  ENB     L(0)                TRAP PROTECT                         3AF06070
TOKBF  SXA     TK3,4               SAVE IR4                             3AF06080
       CLA*    3,2                 COUNT AND IF IT                      3AF06090
       PDX     0,1                 GOES NEGATIVE THEN                   3AF06100
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  3AF06110
       TXL     TK2,1,4096                                               3AF06120
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               3AF06130
       PDX     0,4                 IMMEDIATE FILES                      3AF06140
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              3AF06150
       SUB     1DEC                                                     3AF06160
       STD*    LBC                                                      3AF06170
TK2    PXD     0,1                 RESTORE RESERVE                      3AF06180
       STD*    3,2                 FILE                                 3AF06190
TK3    AXT     **,4                RESTORE IR4                          3AF06200
       TRA     2,4                 EXIT                                 3AF06210
TK4    LXA     TK3,4               TAKE ERROR EXIT                      3AF06220
       TRA     1,4                                                      3AF06230
       SPACE   1                                                        3AF06240
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            3AF06250
       SPACE   1                                                        3AF06260
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      3AF06270
BCKBF  SXA     BK2,1                                                    3AF06280
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       3AF06290
       PDX     0,1                                                      3AF06300
       ACL     1DEC                                                     3AF06310
       STD*    3,2                                                      3AF06320
       TXL     BK2,1,4096          IF NEGATIVE INCREMENT                3AF06330
BK1    CAL     0,4                 POOL CT ALSO                         3AF06340
       ADD     1DEC                                                     3AF06350
       STD     0,4                                                      3AF06360
BK2    AXT     **,1                                                     3AF06370
       TRA     1,1                 EXIT                                 3AF06380
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    3AF06390
*                    HANDLES EOB,EOF,AND URR EXITS                      3AF06400
       SPACE   1                                                        3AF06410
EOFER  CLA     0,4                 END OF FILE                          3AF06420
       ANA     1PRE                EXIT INPUT FILE                      3AF06430
       RIL     100000              NOT OPEN                             3AF06440
       OAI                         PLACE 1ST COMMAND IN SI              3AF06450
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   3AF06460
       SXA     GTIOX,4             COMMAND                              3AF06470
       TRA     EOF.0               TAKE EOF EXIT                        3AF06480
EOFEX  LFT     MULTI               MULTI-REEL                           3AF06490
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            3AF06500
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   3AF06510
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         3AF06520
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     3AF06530
EOF.1  SXA     TCHEX,4                                                  3AF06540
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             3AF06550
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     3AF06560
       LDQ     LTSX                LOAD EXIT HISTORY                    3AF06570
       RQL     18                                                      $3AF06580
       TRA     COMXIT              EXIT                                 3AF06590
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         3AF06600
ERREX  ARS     18                  CODE IN                             $3AF06610
       STT     LTSX                TAG OF HISTORY                      $3AF06620
       CLA*    2,2                 MAKE HISTORY                        $3AF06630
       STA     LTRAD               REFLECT THIS OP.                    $3AF06640
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                3AF06650
       LDC     XERR,4              ERROR EXITS                          3AF06660
       TRA     EOF.1                                                    3AF06670
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        3AF06680
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          3AF06690
       TRA     EOF.1                                                    3AF06700
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  3AF06710
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        3AF06720
       SXD     LTRAD,4             INTO HISTORY                         3AF06730
       ZET     TCHEX               HAS A TCH OCCURRED                   3AF06740
       TRA     TCHOC               YES-                                 3AF06750
       LFT     100000              NO-IS THIS OP AN IOXT                3AF06760
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            3AF06770
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          3AF06780
FEEIT  TXI     *+1,4,-1            NO-                                 $3AF06790
       CAL     -1,4                SEARCH                               3AF06800
       LGR     34                  FOR                                  3AF06810
       TZE     *+2                 EXIT                                 3AF06820
       TQP     *-4                                                      3AF06830
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  3AF06840
       TRA     *+2                                                      3AF06850
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  3AF06860
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $3AF06870
       TRA     1,1                 RETURN                               3AF06880
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       3AF06890
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  3AF06900
*                        MASTER CONTROL ROUTINE                         3AF06910
*                          FOR READ AND WRITE                           3AF06920
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   3AF06930
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         3AF06940
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            3AF06950
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              3AF06960
*              PRE TRM2 OR TRM1        TRANSMITTING                     3AF06970
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     3AF06980
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            3AF06990
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        3AF07000
*              XEC  N,4                                                 3AF07010
       SPACE   1                                                        3AF07020
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          3AF07030
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         3AF07040
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              3AF07050
       ANA     7PRE                SHOULD BE DISCONNECTED              $3AF07060
       TZE     GTIOX-1             NONE ATTACHED                        3AF07070
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   3AF07080
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3AF07090
*                         GET NEXT IO COMMAND                           3AF07100
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          3AF07110
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              3AF07120
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        3AF07130
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  3AF07140
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             3AF07150
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    3AF07160
       SPACE   1                                                        3AF07170
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           3AF07180
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         3AF07190
       TXI     *+1,1,-1            SETUP L(NEXT)                        3AF07200
       SXA     GTIOX,1             IOXY                                 3AF07210
       CAL     -1,1                THIS IO COMMAND TO AC                3AF07220
       STA     TRANS               SAVE TRANSMIT LOC                    3AF07230
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       3AF07240
       STD     WDCT                SAVE WORD COUNT                      3AF07250
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   3AF07260
       ANA     IOOP                AND NOT DISTURBING FILE              3AF07270
       OAI                         CONDITION OR HISTORY BITS           $3AF07280
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              3AF07290
       LFT     600000              SEPARATE TCH AND IOCD                3AF07300
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  3AF07310
       LFT     100000              IOCD OR TCH COMMAND                  3AF07320
       TRA     TCH                 TCH                                  3AF07330
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  3AF07340
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     3AF07350
       TRA     RW0                 NO                                   3AF07360
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   3AF07370
       CLA*    TRANS                                                    3AF07380
       STA     TRANS                                                    3AF07390
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   3AF07400
RW0    NZT     WDCT                IF WORD COUNT IS                     3AF07410
       LNT     400000              ZERO ON IOCY OR IOSY                 3AF07420
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           3AF07430
       TRA     RW8                                                      3AF07440
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD 3AF07450
       TPL     RW2                 BUFFER IS CONNECTED TO FILE          3AF07460
RW1.4  XEC     2,4                 GET NEXT BUFFER                      3AF07470
       CLA*    2,2                 PICKUP BUFFER CONTROL WORD           3AF07480
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                3AF07490
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        3AF07500
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        3AF07510
       TNZ     RW2.1               IF SOME WORDS ARE                    3AF07520
       PDX     0,1                 AVAILABLE AND COMMAND IS             3AF07530
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    3AF07540
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    3AF07550
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        3AF07560
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     3AF07570
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            3AF07580
*                       COUNT CONTROL EXECUTION                         3AF07590
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  3AF07600
       SIR     GENER               SET GENERATED DISCONNECT             3AF07610
       XEC     1,4                 DISCONNECT                           3AF07620
       RIR     GENER               RESET GENER BIT                      3AF07630
       TRA     RW1.4               AND GO ATTACH NEXT ONE               3AF07640
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              3AF07650
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   3AF07660
       TPL     RW5                 IS BUFFER OVERFLOWED                 3AF07670
       STD     DUMMY               YES- SAVE NUMBER OFF                 3AF07680
       LNT     200000              UNLESS COMMAND IS IOSY               3AF07690
       SIR     GENER               SET BIT FOR GENERATED COMMAND        3AF07700
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                3AF07710
RW4    STD     WDCT                ON THIS BUFFER                       3AF07720
       PXA     0,0                 SET ZERO REMAINING WORDS             3AF07730
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                3AF07740
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   3AF07750
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $3AF07760
       STD*    2,2                 TO ADJUST LOCATOR                    3AF07770
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   3AF07780
       RNT     200000              IF IOXYN **,,CT                      3AF07790
       TRA     RW6                 OR IOXYN* ADDR,,CT                   3AF07800
       CLA     TRANS               THEN PLACE L(WORDS)                  3AF07810
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $3AF07820
       STA     0,1                 RESPECTIVELY                         3AF07830
       SIR     XECNT               INDICATE IOXYN EXECUTED              3AF07840
RW6    LXD     WDCT,1              FORM FIRST                           3AF07850
       PXA     0,1                 TRANSMIT                             3AF07860
       ACL*    2,2                 ADDRESS                              3AF07870
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $3AF07880
       STA*    2,2                 ADJUST LOCATOR                       3AF07890
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           3AF07900
       PXA     0,1                 COMPUTE                              3AF07910
       ACL     TRANS               SECOND TRANSMIT ADDRESS              3AF07920
       STA*    4,4                 AND STORE IT                         3AF07930
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        3AF07940
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            3AF07950
       RFT     200000              IF NON-TRANSMITTING                  3AF07960
       TRA     RW8                 SKIP OVER MOVES                      3AF07970
       LXD     WDCT,1              WDCT TO IR1                          3AF07980
TRM1   CAL     **,1                TRANSMIT                             3AF07990
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                3AF08000
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               3AF08010
*                         TERMINATE IO COMMAND                          3AF08020
RW8    NZT     XEOB                IF USER NOT LOCATING                 3AF08030
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        3AF08040
       RNT     EOB                 IF EOB DID NOT OCCUR                 3AF08050
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   3AF08060
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       3AF08070
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            3AF08080
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       3AF08090
       TRA     RW13                YES                                  3AF08100
RW10   LNT     100000              IS COMMAND                           3AF08110
       TRA     GTIOX               IOXP OR IOXT                         3AF08120
RW12   RFT     HELD                IF A HOLD OCCURRED                   3AF08130
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      3AF08140
       RFT     RDSWIT              IF READING EXECUTE                   3AF08150
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   3AF08160
       RFT     EOBXIT              EXIT AT                              3AF08170
       TRA     EOBEX               -EOB EXIT                            3AF08180
       TRA     COMXIT              -NORMAL EXIT                         3AF08190
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) 3AF08200
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       3AF08210
       TRA     RW10                -NO IT IS COMPLETE                   3AF08220
       RIR     GENER               RESET GENER BIT                      3AF08230
       LFT     200000              IF IOCY                              3AF08240
       TRA     RW14+2              NO- IOSY INTERRUPTED                 3AF08250
       RNT     200000              IF IOCYN                             3AF08260
       TRA     RW14                NO -IOC TRANSMITTING                 3AF08270
       ZET     XEOB                IF IOCYN LOCATING                    3AF08280
       TRA     RW16                TAKE EOB INTERRUPT EXIT              3AF08290
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   3AF08300
       STA     TRANS               ADDRESS                              3AF08310
       CLA     DUMMY               SET NEW                              3AF08320
       STD     WDCT                WORD COUNT                           3AF08330
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            3AF08340
RW16   CAL     2TAG                SET EOB IOCYN                       *3AF08350
       TRA     RW17+1              INTERRUPTED CODE                     3AF08360
RW17   CAL     RW13                SET END OF BUFFERS CODE             *3AF08370
       STT     LTSX                STORE CODE                          *3AF08380
       SIR     EOBXIT              SET AND TAKE                         3AF08390
       TRA     RW12                EOB EXIT                             3AF08400
       EJECT                                                            3AF08410
*                  HANDLER FOR IORY AND IOSY READING                    3AF08420
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              3AF08430
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     3AF08440
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    3AF08450
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       3AF08460
       SIR     DISCN               SET COMMAND DISCONNECT               3AF08470
       TRA     RW4                 EXECUTE READ                         3AF08480
       SPACE   1                                                        3AF08490
*                  HANDLER FOR IORY AND IOSY WRITING                    3AF08500
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 3AF08510
       LNT     400000              IS IT ACTUALLY IOSY                  3AF08520
       IIR     EBDSY               NO-SET EOB DISCONNECT, TURN OFF IOSY 3AF08530
       SUB     WDCT                REDUCE WORD COUNT AVAILABLE          3AF08540
       TPL     RW5                 IF ENOUGH WERE AVAIL,EXECUTE COMMAND 3AF08550
       LNT     400000              NOT ENOUGH                           3AF08560
       TRA     RW3                 IORY- REDUCE CT AND EXECUTE          3AF08570
       LXD     DUMMY,1             IF SECOND ATTEMPT ON IOSY            3AF08580
       TXH     RW3,1,0             IS STILL TOO BIG, THEN REDUCE COUNT  3AF08590
       SIR     GENER               IOSY -SET GENER TO DO ON NEXT BUF    3AF08600
       CLA     WDCT                SETUP GENERATED                      3AF08610
       STD     DUMMY               COMMAND                              3AF08620
       RFT     XECNT               IF AN IOXYN WAS                      3AF08630
       SIR     EOB                 ALREADY EXECUTED SET EOB TESTS       3AF08640
       TRA     RW8                 GO RELEASE THIS BUF AND DO GENER     3AF08650
       SPACE   1                                                        3AF08660
*                         HANDLER TCH COMMAND                           3AF08670
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      3AF08680
       NZT     TCHEX               IF 1ST TCH THEN                      3AF08690
       STA     TCHEX               EXIT = L(TCH)+1                      3AF08700
       RNT     400000              IF NOT INDIRECT                      3AF08710
       TRA     GTIOX+1             TCH EXECUTED                         3AF08720
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             3AF08730
       PAC     0,1                 GO ONE MORE LEVEL AND                3AF08740
       TRA     GTIOX+1             EXIT                                 3AF08750
       SPACE   1                                                        3AF08760
*                     PRIORITY EXIT TESTS FOR READ                      3AF08770
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         3AF08780
       ANA     L(377)                                                   3AF08790
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        3AF08800
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        3AF08810
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  3AF08820
       RIL     PRIBTS              AND EXIT.                            3AF08830
       RFT     REINT               IF LAST BUF SYNCED                   3AF08840
       TRA     *+4                 GIVE FILE A KICK                     3AF08850
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    3AF08860
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         3AF08870
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  3AF08880
       TSX     BORBF,1             IF NO RUSH OCCURRED                  3AF08890
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      3AF08900
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  3AF08910
       TTL     READ SUBROUTINE - SYNCR-                                 3AF08920
*                   GETS A BUFFER FROM THE EXECUTOR                     3AF08930
*                         VIA THE SYNC ROUTINE                          3AF08940
       SPACE   1                                                        3AF08950
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   3AF08960
*              RETURN              INDEXS ARE NOT DISTRUBED             3AF08970
       SPACE   1                                                        3AF08980
SYNCR  SXA     SY8.2,4             SAVE IR4                             3AF08990
       SXA     SY8.1,1             IR1                                  3AF09000
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $3AF09010
L(0)A  ENB     L(0)                DISABLE TRAPS                        3AF09020
       NZT*    4,2                 ANYTHING TO SYNC                     3AF09030
       TRA     SY10                -NO                                  3AF09040
       CLA     5,2                                                     $3AF09050
       ANA     SIX                 HYPER                               $3AF09060
       TZE     *+5                 NO                                  $3AF09070
       LDQ     1,2                 WHAT                                $3AF09080
       RQL     18                  TYPE                                $3AF09090
       TQP     *+2                 READ                                $3AF09100
       SIR     100000              HYPER READ BACKWARD                 $3AF09110
       BES     *-7+NOHYP/NOHYP*7-*                                     $3AF09120
       CLA     4,2                 SYNCED BUFFER TO                     3AF09130
       STA     2,2                 BUFFER IN USE ADDRESS                3AF09140
       CAL     1,2                 REDUCE COUNT OF                      3AF09150
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     3AF09160
       STA     1,2                                                      3AF09170
       CLA*    4,2                 UPDATE SYNC                         $3AF09180
       STA     4,2                 CHAIN CARRYING L(END)                3AF09190
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             3AF09200
       STD*    4,2                 UNLESS NO CHAIN EXISTS               3AF09210
       ENB     TRAPS               ALLOW TRAPS                          3AF09220
       LGR     33                  SET EOF AND/ OR REDUN                3AF09230
       IIA                         BITS=0 IF CONDITION OCCURRED         3AF09240
       LXD     SYNCT,1             ADVANCE COUNT                        3AF09250
       TXI     *+1,1,1             OF BUFFERS                           3AF09260
       SXD     SYNCT,1             USED THIS READ                       3AF09270
       CAL     2,2                                                      3AF09280
       ACL     L(1)                                                     3AF09290
       PAC     0,4                 IR4 = -L(IORT)                       3AF09300
       ACL     L(1)                SET LOCATOR ADDRESS                  3AF09310
       ANA     XCPTP               CLEAR PREFIX                        $3AF09320
       STO*    2,2                                                     $3AF09330
       RNT     100000              READ BACKWARD                       $3AF09340
       TRA     SY4                 NO                                  $3AF09350
       ALS     18                  FIRST DATA WORD                     $3AF09360
       ACL     0,4                 IN BUFFER                           $3AF09370
       ARS     18                  LAST DATA WORD                      $3AF09380
       PAX     0,1                 +1 OF BUFFER                        $3AF09390
       ORA     7PRE                                                    $3AF09400
       BES     *-7+NOHYP/NOHYP*7-*                                     $3AF09410
SY4    SUB     0,4                 LOCATOR - IORT                      $3AF09420
       ALS     18                  =WORD COUNT                         $3AF09430
       STD*    2,2                                                     $3AF09440
       RNT     100000                                                  $3AF09450
       TRA     SY5                                                     $3AF09460
       CAL     0,4                 STARTING DATA                       $3AF09470
       STA*    2,2                                                     $3AF09480
       PXA     0,1                 LAST LOC+1 OF                       $3AF09490
       STA     0,4                 BUFFER IN TO IORT                   $3AF09500
       BES     *-6+NOHYP/NOHYP*6-*                                     $3AF09510
SY5    RNT     NOEOF               DID EOF OCCUR                       $3AF09520
       TRA     SY11                - YES                                3AF09530
       CLA     1,2                 IF LAST BUFFER                       3AF09540
       ANA     L(377)              AHEAD IS                             3AF09550
       PAX     0,1                 SYNCED OUT                           3AF09560
       TXL     SY9,1,0             INITIATE ANOTHER                     3AF09570
SY5.6  RIR     100000                                                   3AF09580
       BES     *-1+NOHYP/NOHYP*1-*                                      3AF09590
       RNT     NORED               IF URR OCCURRED                      3AF09600
       TRA     URREX               TAKE ERROR EXIT                      3AF09610
SY8.2  AXT     **,4                RESTORE IR4                          3AF09620
SY8.1  AXT     **,1                IR1                                  3AF09630
       TTR     1,1                 RETURN                               3AF09640
       SPACE   1                                                        3AF09650
*                          LAST BUFFER SYNCED                           3AF09660
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        3AF09670
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    3AF09680
       TRA     SY5.6               CONTINUE                             3AF09690
       SPACE   1                                                        3AF09700
*                  NO BUFFER AVAILABLE WHEN NEEDED                      3AF09710
       RFT     NOREOF              IF ON TRY                           $3AF09720
       TRA     SY10-5              TO GET A BUFFER                   (8)3AF09730
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   3AF09740
       TRA     RW17                TAKE IT , ELSE GIVE                  3AF09750
       STR                         ILLEGAL FILE USE                     3AF09760
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                3AF09770
       RIR     NOREOF              SET TRIED ONCE                      $3AF09780
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       3AF09790
       TSX     BORBF,1             INITIATE READ                        3AF09800
       TRA     SY9.3-2             COULD NOT                           $3AF09810
       TRA     ACT                                                   (8)3AF09811
SY10   SIL     RBITS                   SET RUSH PRIORITY BITS           3AF09820
       AXC     1,4                                                      3AF09830
       NZT*    0,2                 TO BE SYNCED                         3AF09840
       TRA     SY10-3              -NO                               (8)3AF09850
ACT    TSX     ACTV+1,4            -YES, ACTIVATE PRIORITY           (8)3AF09860
       MZE     0,2                 THAT FILE                            3AF09870
       AXC     1,4                 WAIT UNTIL I/O IS                 (8)3AF09871
       ZET*    0,2                 COMPLETED ON THAT UNIT            (8)3AF09872
       TRA     *-1                                                   (8)3AF09873
       TRA     SY3                 CONTINUE SYNC OUT                    3AF09880
       SPACE   1                                                        3AF09890
*                             EOF ON SYNC                               3AF09900
SY11   TSX     DISCON,1      DISCONNECT BUFFER                     IBJOB3AF09910
       TRA     EOFEX                                                    3AF09920
       TTL                         READ SUBROUTINE-BORBF-               3AF09930
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   3AF09940
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            3AF09950
       SPACE   1                                                        3AF09960
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  3AF09970
*              ERROR RETURN        INDEX REGISTERS ARE                  3AF09980
*              NORMAL RETURN        NOT DISTURBED                       3AF09990
       SPACE   1                                                        3AF10000
BORBF  SXA     BOR8,1              SAVE IR1                             3AF10010
       SXA     BOR2,4              SAVE IR4                             3AF10020
       LAC     LBC,4               IF NO BUFFERS                        3AF10030
       ENB     L(0)                                                    $3AF10040
       CLA*    0,4                 ARE PRESENTLY                        3AF10050
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               3AF10060
       LXA     BOR8,1              RESTORE IR1                          3AF10070
BOR2   AXT     **,4                RESTORE IR4                          3AF10080
       ENB     TRAPS                                                    3AF10090
       TRA     1,1                 AND EXIT                             3AF10100
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $3AF10110
       TXI     BOR2,1,-1           EXIT AT 2,1                          3AF10120
       STA     XERR                SAVE L(NEXT BUFFER)                 $3AF10130
       CLA     1,2                 IF INITIAL                           3AF10140
       PAX     0,4                 BUFFER DONT                          3AF10150
       TXL     *+3,4,0             ADJUST COUNTS                        3AF10160
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 3AF10170
       TRA     BOR2-1              NO BUFFER AVAILABLE                  3AF10180
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              3AF10190
       CLA     XERR                UPDATE POOL                         $3AF10200
       STA*    LBC                 BUFFER CHAIN                         3AF10210
       CAL     1,2                 UP COUNT BUFFERS                     3AF10220
       ADD     L(1)                IN USE BY                            3AF10230
       STA     1,2                 THE FILE                             3AF10240
       ENB     TRAPS               RESTORE TRAPPING                     3AF10250
       TSX     RDSEL,1             ISSUE STACKED SELECT                 3AF10260
BOR8   AXT     **,1                RESTORE IR1                          3AF10270
       TXI     BOR2,1,-1           EXIT AT 2,1                          3AF10280
       TTL                         INPUT BUFFER RELEASE ROUTINES        3AF10290
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  3AF10300
*              TSX  RELES,1        CANNOT BE USED AT TRAP               3AF10310
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     3AF10320
       SPACE   1                                                        3AF10330
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               3AF10340
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               3AF10350
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     3AF10360
       SPACE   1                                                        3AF10370
DISCON SIR     DONLY               SET DISCONNECT ONLY                  3AF10380
RELES  SIR     RDSWIT              SET RELEASE MODE                     3AF10390
       SXA     RE2,1               SAVE IR1                             3AF10400
       SXA     RE2+1,4             AND IR4                              3AF10410
RE1    CLA*    2,2                 IS A BUFFER                          3AF10420
       TPL     RE4                 CONNECTED NORMALLY                   3AF10430
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            3AF10440
       ANA     7PRE                IF BUFFER HELD                       3AF10450
       TZE     RE2                 OR NO BUFFER CONNECTED               3AF10460
       SPACE   1                                                        3AF10470
*                         RELEASE HELD BUFFERS                          3AF10480
       RNT     RDSWIT              RELEASE OR                           3AF10490
       TRA     TR1                 TRUNCATE                             3AF10500
       LAC     LBC,4                                                    3AF10510
       LDQ     2,2                 L(BUF TO MQ)                         3AF10520
       TSX     POOLRD,1            RELEASE BUFFER                       3AF10530
RE1.5  CLA     TCHAN               CHAIN HELD                           3AF10540
       STA     2,2                 BUFFERS                              3AF10550
       RNT     CPYFN               UNLESS COPYING                       3AF10560
       TRA     RE1                 RELEASE ALL HELD BUFFERS             3AF10570
RE2    AXT     **,1                RESTORE IR1                          3AF10580
       AXT     **,4                AND IR4                              3AF10590
       RNT     GENER               IF GENERATED DISCONNECT SAVE         3AF10600
       RIR     DISCN               COMMAND DISCONNECT BIT               3AF10610
       RIR     EOBITS                                                   3AF10620
       RFT     RDSWIT                                                   3AF10630
       RIR     XECNT                                                    3AF10640
       TRA     1,1                 EXIT                                 3AF10650
       SPACE   1                                                        3AF10660
*                        RELEASE BUFFER IN USE                          3AF10670
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            3AF10680
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    3AF10690
       RNT     RDSWIT              RELEASE OR                           3AF10700
       TRA     TR1.1               TRUNCATE                             3AF10710
       RNT     HOLD                IS HOLD BIT ON                       3AF10720
       TRA     RE5                 ENTER HOLD                           3AF10730
       TSX     ENTHLD,4            BUFFER INTO                          3AF10740
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          3AF10750
       TRA     RE6                 HOLD CHAIN                           3AF10760
RE5    LDQ     2,2                 L(BUF) TO MQ                         3AF10770
       LAC     LBC,4                                                    3AF10780
       TSX     POOLRD,1            BUFFER TO POOL                       3AF10790
RE6    CLA     LBC                 SET FILE TO REFER                    3AF10800
       STA     2,2                 TO POOL                              3AF10810
       TRA     RE2                                                      3AF10820
       TTL                         RELEASE INPUT BUFFER TO POOL         3AF10830
*                            IR2 = -L(FILE)                             3AF10840
*                            IR4 = -L(POOL)                             3AF10850
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        3AF10860
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        3AF10870
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               3AF10880
       SPACE   1                                                        3AF10890
TOPOOL LDI     1,2                 FILE BITS TO                         3AF10900
       RIR     77777               SI-RIGHT SIDE TO ZERO                3AF10910
TOCLOS ENB     L(0)                TRAP PROTECT                         3AF10920
       CAL     1,2                 REDUCE                               3AF10930
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     3AF10940
       STA     1,2                 USE COUNT                            3AF10950
*                      RELEASE INPUT BUF TO POOL                        3AF10960
POOLRD ENB     L(0)                TRAP PROTECT                         3AF10970
       CAL     1,2                 REDUCE CT                            3AF10980
       SUB     L(400)              OF BUFS LOGICALLY                    3AF10990
       STA     1,2                 IN USE BY FILE                       3AF11000
       RNT     RDSWIT              IS THE RELEASE MODE ON               3AF11010
       TRA     TCHAN               NO                                   3AF11020
TCHAN  XCA     **                  L(BUF) TO AC                         3AF11030
PRD1   SXA     PRD2,1              SAVE IR1                             3AF11040
       RNT     CPYFN               UNLESS COPYING                       3AF11050
       TSX     BTP2,1              RELEASE BUF TO POOL                  3AF11060
       CLA     1,2                 IF LAST                              3AF11070
       PAX     0,1                 BUFFER                               3AF11080
       TXL     PRD2,1,0            IN USE THEN SKIP                     3AF11090
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 3AF11100
PRD2   AXT     **,1                RESTORE IR1                          3AF11110
       NZT     INTRAP              UNLESS AT TRAP                       3AF11120
       ENB     TRAPS               RESTORE TRAPPING                     3AF11130
       TRA     1,1                 EXIT                                 3AF11140
       TTL                         WRITE SUBROUTINE-TRUNC-              3AF11150
*                      TRUNCATE AN OUTPUT BUFFER                        3AF11160
       SPACE   1                                                        3AF11170
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          3AF11180
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    3AF11190
       SPACE   1                                                        3AF11200
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    3AF11210
       TRA     RELES+1             USE RELES ROUTINE                    3AF11220
       SPACE   1                                                        3AF11230
*                        TRUNCATE HELD BUFFERS                          3AF11240
TR1    CLA*    2,2                 HOLD CODE TO AC                      3AF11250
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         3AF11260
       CLA     TCHAN               UPDATE FILE                          3AF11270
       STA     2,2                 HOLD CHAIN                           3AF11280
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        3AF11290
       SPACE   1                                                        3AF11300
*                        TRUNCATE BUFFER IN USE                         3AF11310
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $3AF11320
       TRA     TR2                 NO, WRITTEN                         $3AF11330
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $3AF11340
       TRA     TR3                                                     $3AF11350
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $3AF11360
       SXA     TR10+2,1                                                $3AF11370
       CAL     2,2                 FIND                                $3AF11380
       ACL     L(1)                L(IORT)                              3AF11390
       STA     TR5                                                      3AF11400
       CLA*    2,2                 PICK UP LOCATOR                     $3AF11410
       TMI     TR5+1               IN HOLD CHAIN                       $3AF11420
TR5    STA     **                                                       3AF11430
       CLA*    TR5                 GET LOCATOR                         $3AF11440
       SUB     TR5                 FORM COUNT AND STORE                $3AF11450
       SUB     L(1)                IN IORT                              3AF11460
       ALS     18                                                       3AF11470
       STD*    TR5                                                      3AF11480
       ANA     DECRE                                                    3AF11490
       TNZ     TR10+1              EXIT THEN                            3AF11500
       LDQ     2,2                 DONT WRITE BUFFER OUT                3AF11510
       LAC     LBC,4               L(POOL) TO IR4                       3AF11520
       CAL     1,4                 RESTORE                              3AF11530
       ARS     4                   SIZE TO                              3AF11540
       STD*    TR5                 IORT                                 3AF11550
       ENB     L(0)                TRAP PROTECT                         3AF11560
       TSX     BTP1,1              BUFFER IN POOL                       3AF11570
       CLA     3,2                 IF AN INTERNAL FILE THEN             3AF11580
       TPL     *+2                 ADJUST BUFFER COUNTS                 3AF11590
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         3AF11600
       ENB     TRAPS               ALLOW TRAPS AND EXIT SO              3AF11610
       LXA     TR10+2,1            NO WRITE                            $3AF11620
TR10   TRA     1,1                 IS EXECUTED                          3AF11630
       AXT     **,4                RESTORE IRS                         $3AF11640
       AXT     **,1                AND RETURN                          $3AF11650
       TRA     1,4                                                     $3AF11660
TR2    TSX     WRSEL,1             WRITE BUFFER                         3AF11670
TR3    CLA     LBC                 SET FILE REFERENCE                   3AF11680
       STA     2,2                 TO POOL                              3AF11690
       TRA     RE2                                                      3AF11700
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       3AF11710
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             3AF11720
*              TSX  GTBUF,1        IR2 =-L(FILE)                        3AF11730
*              RETURN               INDICES NOT DISTURBED               3AF11740
       SPACE   1                                                        3AF11750
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            3AF11760
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    3AF11770
*              RETURN               IR1 DESTROYED                       3AF11780
       SPACE   1                                                        3AF11790
OBTIB  SXA     GET8,4              SAVE IR4                             3AF11800
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $3AF11810
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           3AF11820
       TRA     1,4                 EXIT                                 3AF11830
       SPACE   1                                                        3AF11840
GTBUF  SXA     GET8,4              SAVE IR4                             3AF11850
GET0   SXA     GET8+1,1            SAVE IR1                             3AF11860
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           3AF11870
       CLA     1,4                 NECESSARY IT WILL BE STARTED         3AF11880
       LDQ*    0,4                 WITH FIRST FILE                      3AF11890
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          3AF11900
       SPACE   1                                                        3AF11910
*                         NO BUFFER AVAILABLE                           3AF11920
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   3AF11930
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $3AF11940
       LAC     LBC,4               L(BPCW)                           $5$3AF11950
       LDQ*    0,4                                                   $5$3AF11960
       TQP     GET5                BUF AVAIL-JOIN IT                   $3AF11970
       TRA     SY9.3               NONE-TRY EOB                        $3AF11980
       STA     CPY7                SETUP SYNC SEQUENCE                  3AF11990
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           3AF12000
       CLA     0,1                 PLACE L(UCW)                         3AF12010
CPY7   PAC     **,4                IN IR4                               3AF12020
       CLA     1,4                 IF PRIORITY WORD                     3AF12030
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             3AF12040
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          3AF12050
       TSX     ACTV+1,4            ACTIVATE THIS UNIT GIVING            3AF12060
1TAG   MZE     0,1                 IT HIGH PRIORITY                     3AF12070
       LAC     LBC,4               WAIT UNTIL                           3AF12080
       CLA*    0,4                 A BUFFER PLACED IN                   3AF12090
       TPL     GET5                POOL BY TRAP                         3AF12100
       TRA     CPY7-2                                               (12)3AF12110
       EJECT                                                            3AF12120
*                     UNIT HAS NO REQUESTS WAITING                      3AF12130
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   3AF12140
       ANA     NEOTBT              AND EOT CONDITION                    3AF12150
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             3AF12160
GET3   CLA     1,1                 ADVANCE AROUND                       3AF12170
       TRA     GET1                OUTPUT CHAIN                         3AF12180
       SPACE   1                                                        3AF12190
*                  GOT A BUFFER - READY IT FOR OUTPUT                   3AF12200
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 3AF12210
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     3AF12220
       ENB     L(0)                TRAP PROTECT                         3AF12230
       RNT     HELD                IF A HELD BUFFER                     3AF12240
       TRA     GET6                EXIST,COUNT                          3AF12250
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           3AF12260
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    3AF12270
       LAC     LBC,4               L(POOL) TO IR4                       3AF12280
       CAL     7PRE                SET CODE 7                           3AF12290
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            3AF12300
GET6   CLA*    0,4                 UPDATE AVAILABLE                     3AF12310
       STA     CPY7                BUFFER CHAIN                         3AF12320
       CLA     0,4                 SET L(BUF)                           3AF12330
       STA     2,2                 INTO FILE REFERENCE                  3AF12340
       ACL     L(1)                SAVE                                 3AF12350
       STA     GET7                L(IORT)                              3AF12360
       ACL     L(1)                SET LOCATOR                          3AF12370
       STA*    2,2                 = PZE *+2,,**                        3AF12380
       CAL     CPY7                UPDATE POOL TO REFER                 3AF12390
       STA     0,4                 TO NEXT BUFFER                       3AF12400
       ENB     TRAPS               ALLOW TRAPS                          3AF12410
GET7   CLA     **                  PICKUP IORT                          3AF12420
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     3AF12430
GET8   AXT     **,4                RESTORE IR4                          3AF12440
       AXT     **,1                1                                    3AF12450
       RIR     FREEUP              RESET FREEUP BIT                    $3AF12460
       TRA     1,1                 EXIT                                 3AF12470
       TTL                         HOLD FUNCTION SUBROUTINES            3AF12480
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              3AF12490
       SPACE   1                                                        3AF12500
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  3AF12510
*              RETURN              IR1 DESTROYED                        3AF12520
       SPACE   1                                                        3AF12530
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      3AF12540
       LFT     OUTPUT                                                  $3AF12550
       TRA     FIX                                                     $3AF12560
       TPL     FIX                 IF REGEN INTERNAL FILE              $3AF12570
FIX1   RFT     HELD                IF ALREADY HOLDING                  $3AF12580
       TRA     EN1                 SKIP INITIALIZATION                  3AF12590
       PAX     0,1                 ENTER 1ST BUFFER                     3AF12600
       SIR     HELD                IN CHAIN                             3AF12610
       SXD     HOLDS,1             PRESET * STORE                       3AF12620
       TRA     EN1+1                                                   $3AF12630
FIX    PAC     0,1                 BCW TO IR1                          $3AF12640
       CLA*    2,2                 GET LOCATOR AND                     $3AF12650
       STA     1,1                 SAVE FOR WRITE                      $3AF12660
       CLA     2,2                 IN ITS IORT                         $3AF12670
       TRA     FIX1                PUT IN HOLD CHAIN                   $3AF12680
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                3AF12690
       STA     HOLDS               UPDATE CHAIN                         3AF12700
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $3AF12710
       STP*    HOLDS               IN BUFFER                            3AF12720
       TRA     1,4                                                     $3AF12730
       SPACE   1                                                        3AF12740
*                           SETUP HOLD CHAIN                            3AF12750
*                           IN FILE AT EXIT                             3AF12760
*                          FROM READ OR WRITE                           3AF12770
       SPACE   1                                                        3AF12780
*                           CALLING SEQUENCE                            3AF12790
       SPACE   1                                                        3AF12800
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        3AF12810
*              RETURN                                                   3AF12820
       SPACE   1                                                        3AF12830
HOOK   CLA     2,2                                                      3AF12840
       STA*    HOLDS                                                    3AF12850
       LXD     HOLDS,1                                                  3AF12860
       PXA     0,1                                                      3AF12870
       STA     2,2                                                      3AF12880
       RIR     HELD                                                     3AF12890
       TRA     1,4                                                      3AF12900
       TTL             NON-DATA SELECT CODES FOR IOEX                   3AF12910
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        3AF12920
       SPACE   1                                                        3AF12930
HFPNP  EQU     42                  FILE PROTECT                         3AF12940
HUNLP  EQU     39                  UNLOAD                               3AF12950
HSKFP  EQU     37                  SKIP FILE                            3AF12960
HSKRP  EQU     36                  SKIP RECORD                          3AF12970
HBSFP  EQU     35                  BACKSPACE FILE                       3AF12980
HBSRP  EQU     34                  BACKSPACE RECORD                     3AF12990
HWTMP  EQU     33                  WRITE TAPE MARK                      3AF13000
HERGP  EQU     32                  ERASE LONG GAP                       3AF13010
HRUNP  EQU     31                  REWIND AND UNLOAD                    3AF13020
HRWDP  EQU     30                  REWIND                               3AF13030
WEFOP  EQU     7                   WEF                                  3AF13040
BSFOP  EQU     6                   BSF                                  3AF13050
BSROP  EQU     5                   BSR                                  3AF13060
RUNOP  EQU     4                   RUN                                  3AF13070
REWOP  EQU     3                   REW                                  3AF13080
SDNHP  EQU     2                   SDNH                                 3AF13090
SDNLP  EQU     1                   SDNL                                 3AF13100
TESTP  EQU     0                   TEST OP                              3AF13110
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         3AF13120
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 3AF13130
*      TSX  WRSEL,1                          2,2 (21-35)                3AF13140
*         TSX    WRSLH,1         WRITE HELD BUFFER                      3AF13150
*                                  IR4 IS DESTROYED                     3AF13160
       SPACE   1                                                        3AF13170
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $3AF13180
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      3AF13190
SEL4   PZE     **,,ISSUE           SELECT WORD                          3AF13200
WRSEL  TSX     SETWR,4                 SET UP TO WRITE                  3AF13210
       LDQ     2,2                 L(BUF) TO MQ                         3AF13220
RDSEL  XCA                                                              3AF13230
       STA     SEL4                L(BUF) TO SEL4                       3AF13240
       LDQ     L(0)D               SET BUFFER                           3AF13250
       LGL     18                  1ST WD =                             3AF13260
       SLW*    SEL4                PZE L(0),,*                          3AF13270
SEL0   AXC     1,4                                                      3AF13280
       ENB     L(0)                                                     3AF13290
       CLA*    0,2                 CHECK FILE ALREADY                   3AF13300
       TZE     SEL3                ACTIVE                               3AF13310
       STA     SEL1                YES                                  3AF13320
       CAL     FCW                                                     $3AF13330
       AXT     0,4                                                     $3AF13340
       ERA*    0,2                 IS THIS THE SAME FILE               $3AF13350
       ANA     ADDRS                                                   $3AF13360
       TZE     SEL1                YES                                 $3AF13370
       TSX   (ACTVX,4              NO                                  $3AF13380
       MZE     0,2                                                     $3AF13390
       TRA     SEL0                                                    $3AF13400
SEL1   CLA     **                  ADD NEW                              3AF13410
       PDC     0,4                 BUFFER TO END                        3AF13420
       CLA     SEL4                OF EXISTING                          3AF13430
       STA     0,4                 BUFFER CHAIN                         3AF13440
       ALS     18                  SET L(NEW BUF) INTO                  3AF13450
       STD*    SEL1                DECREMENT 1ST ENTRY                  3AF13460
       ENB     TRAPS               ALLOW TRAPS                          3AF13470
       TRA     1,1                 EXIT                                 3AF13480
       SPACE   1                                                        3AF13490
*                         ENTER INITIAL SELECT                          3AF13500
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    3AF13510
       TRA     SEL6                GO HANDLE IT SPECIAL                 3AF13520
       AXT     0,4                 CHECK FOR                            3AF13530
       CLA*    0,2                 ENTERING INITIAL SELECT ON           3AF13540
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         3AF13550
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         3AF13560
       LGL     18                  HAS ENCOUNTERED EOT                  3AF13570
       STA     CPY7                IF SO THEN HANDLE                    3AF13580
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        3AF13590
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   3AF13600
       TSX     EOTOF,1                                                  3AF13610
       TSX     CPY6,4                                                   3AF13620
SEL2.4 AXT     **,1                RESTORE IR1                          3AF13630
SEL2.5 STI     TEMIND                                                  $3AF13640
       AXT     0,4                 GET FILE BLOCK ADDRESS              $3AF13650
       CAL     FCW                 AND STORE IN UCW ONE                $3AF13660
       STA*    0,2                                                     $3AF13670
       LDI*    0,2                 UCW 1                               $3AF13680
       LFT     20000               1301                                $3AF13690
       TRA     SEL2.6              MAYBE                               $3AF13700
       BES     *-3+NOCHX/NOCHX*3-*                                      3AF13710
SEL2.7 CAL     SEL4                NO                                  $3AF13720
       AXC     1,4                                                     $3AF13730
       LDI     TEMIND                                                  $3AF13740
       LFT     OUTPUT              OUTPUT                              $3AF13750
       ORA     FOR                 YES-SET BIT                         $3AF13760
       SLW*    0,2                 STORE ISSUE IN UCW 2                $3AF13770
       TSX     ACTV+1,4            ACTIVATE                             3AF13780
       PZE     0,2                 THIS FILE                            3AF13790
       TRA     1,1                                                      3AF13800
SEL2.6 LNT     100                 1301                                $3AF13810
       TRA     SEL8           NO                                       $3AF13820
       SXA     SEL2.8+1,1          YES                                 $3AF13830
       CLA     0,2                 PUT -L(UCB) IN IR4                  $3AF13840
       PAC     0,4                                                     $3AF13850
       LDQ     6,2                 CHECK IF EOF ON DISK                $3AF13860
       TQP     SEL2.8              NO                                  $3AF13870
       ARS     18                  PUT CORRECT SEEK                    $3AF13880
       STA     6,2                 IN WORD SEVEN                       $3AF13890
       STP     6,2                 AND TURN OFF EOF BIT                $3AF13900
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $3AF13910
       AXT     **,1                                                    $3AF13920
       TRA     SEL2.7         RETURN                                   $3AF13930
ENDTRK LDI     1,2                 RESET BUFFER USAGE                (7)3AF13991
       RIR     77777                                                 (7)3AF13992
       ZAC                         RESET END OF TRACKS SIGNAL        (7)3AF13993
       STT     6,2                                                   (7)3AF13994
       TRA     BOFEX                                                 (7)3AF13995
       BES     SEL2.6+NOCH/NOCH**-NOCH/NOCH*SEL2.6-*                   $3AF14000
SEL8   PXD     0,0                                                     $3AF14010
       LDI     1,2                                                     $3AF14020
       RFT     400000              IS THIS READ BACKWARD               $3AF14030
       CLA     SIX                 YES, SET BACKWARD READ MODE         $3AF14040
       ACL     SEL4                YES                                 $3AF14050
       AXC     3,4                 STORE ZERO                          $3AF14060
       STZ*    0,2                 IN UCW 4                            $3AF14070
       TRA     SEL2.7+1                                                $3AF14080
       BES     *-8+NOHYP/NOHYP*8-*                                     $3AF14090
TEMIND PZE                                                              3AF14100
       TTL 0                                                            3AF14110
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         3AF14120
SEL5   SXA     SEL5.6,1                                                 3AF14130
       ENB     L(0)                DISABLE TRAPS                        3AF14140
       TSX     BCKBB,1                                                  3AF14150
SEL5.6 AXT     **,1                RESTORE IR1                          3AF14160
       TRA     WRSEL               RETURN TO WRITE                      3AF14170
       SPACE   1                                                        3AF14180
*                        EOF OR EOT ENCOUNTERED                         3AF14190
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            3AF14200
       TRA     SEL7-1                                                   3AF14210
       LDQ     SEL4                RELEASE BUFFER                       3AF14220
       LAC     LBC,4               -L(POOL) TO IR4                      3AF14230
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  3AF14240
       SPACE   1                                                        3AF14250
*                             EOT OCCURRED                              3AF14260
       SXA     *+2,1               SAVE IR1                             3AF14270
SEL7   TSX     EOTOF,1             HANDLE EOT                           3AF14280
       AXT     **,1                RESTORE IR1                          3AF14290
       TRA     SEL0                AND CONTINUE                         3AF14300
       TTL                         DENSITY SETTING ROUTINE              3AF14310
*                             TSX DENSE,4                               3AF14320
       SPACE   1                                                        3AF14330
DENSE  CLA     1,2                 PLACE FILE                           3AF14340
       ANA     1TAG                DENSITY BIT                          3AF14350
       ALS     3                   IN DECREMENT                         3AF14360
       ACL     1DEC                ADD 1 TO FORM                        3AF14370
       STD     *+3                 LOW DEN. = 1                         3AF14380
       SXA     *+3,4               HI DEN. = 2                          3AF14390
       TSX     NDSEL+1,4           SET DENSITY                         $3AF14400
       PZE     0,2,**                                                   3AF14410
       AXT     **,4                RESTORE IR4                          3AF14420
       TRA     1,4                 EXIT                                 3AF14430
       TTL     7909 CHANNEL SELECT ROUTINES                             3AF14440
       LBT                         DISK                                $3AF14450
       TRA     HSELM               NO                                  $3AF14460
       BES     *-2+NOCHX/NOCHX*2-*                                      3AF14470
MSEL   LFT     7100                TEST UNUSUAL END                    $3AF14480
       TRA     DERR                                                     3AF14490
       LDI     0,2                                                     $3AF14500
       CLA*    1,4            GET FLAG WORD USED                       $3AF14510
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $3AF14520
       ADD     L(1)           FOR THIS OPERATION                       $3AF14530
       STA     *+3                                                     $3AF14540
       LFT     200000              EOF FROM LAST READ                  $3AF14550
       TRA     SEOFI               YES                                 $3AF14560
       LDI     **             PUT FLAG WORD IN INDICATORS              $3AF14570
       LNT     400000              IS RECORD COMPLETE                  $3AF14580
       TRA     FINREC         NO-FINISH RECORD                         $3AF14590
       LFT     200000         EOF OCCUR                                $3AF14600
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $3AF14610
       LDI     FOR            SET INDICATORS AS 7607                   $3AF14620
SELM2  CLA     1,2                 IF MIXED MODE                        3AF14630
       TMI     1KA                 SKIP OUT                             3AF14640
       CAL     1,4                                                      3AF14650
       SUB     L(1)                                                    $3AF14660
       SXA     *+3,4          SAVE IR4                                 $3AF14670
       PAC     0,4            IR4=-L(COMM-1)                           $3AF14680
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $3AF14690
SELM5  AXT     **,4                RESTORE IR4                         $3AF14700
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $3AF14710
       CLA     1,4                 PUT ADDRESS OF                      $3AF14720
       PAC     0,1                 COMD CHAIN IN IR 1                  $3AF14730
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $3AF14740
       STZ     1,1                 ZERO OUT COUNT SAVED                $3AF14750
       CAL     8,1                                                     $3AF14760
       ACL     L(1)                                                    $3AF14770
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $3AF14780
       CAL     FCW                 RESTORE IORT                        $3AF14790
       STP     -1,1                IN BUFFER                           $3AF14800
       LDQ     1,4                                                     $3AF14810
       NZT*    1,4                 IF ZERO-ZERO OUT                    $3AF14820
       TRA     *+4                 AND KILL SEEK                       $3AF14830
       LFT     200000              IF EOF                              $3AF14840
       TRA     *+3                 KILL SEEK OR                        $3AF14850
       TRA     *+4                 ELSE PROCEED                        $3AF14860
       STZ     1,4                                                     $3AF14870
       CAL     2,4                                                     $3AF14880
       STO     2,4                                                     $3AF14890
       TQP     SELM4               IF MQ + READ IS DONE                $3AF14900
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $3AF14910
       TRA     SELM3               GO POST WRITE COMPLETION            $3AF14920
SELM4  CAL     *+1                                                     $3AF14930
       XCA     **                  MQ = ADDRESS OF BUF CW              $3AF14940
       SXA     C8,1                                                    $3AF14950
       CAL     -1,1                PICK UP COUNT FROM FLAG             $3AF14960
 ER    AXT     **,1                                                    $3AF14970
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $3AF14980
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $3AF14990
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $3AF15000
       LFT     200000              IF EOF GO                           $3AF15010
       TSX     EOF,4               TAKE CARE OF IT                     $3AF15020
       CLA     4,2                 PICK UP AND                         $3AF15030
       PDC     0,4                 RESTORE THE                         $3AF15040
       CAL     1,4                 BUFFER SIZE                         $3AF15050
       ARS     4                   IN THE IORT                         $3AF15060
       STD     -1,1                NOW GO POST                         $3AF15070
       XEC     SELM5               READ COMPLETION                     $3AF15080
       TRA     POSTR+2             SOME JOB                            $3AF15090
EOF    ENB     L(0)                                                    $3AF15100
       LDQ     0,2                 EXCHANGE START AND                  $3AF15110
       CAL     6,2                 FINISH OF FILE                      $3AF15120
       LGL     18                  PUT A MINUS                         $3AF15130
       STD     0,2                 IN WORD SEVEN                       $3AF15140
       STA     6,2                 TO INDICATE SPECIAL                 $3AF15150
       CLS     6,2                 HANDLING NEEDED                     $3AF15160
       STO     6,2                 FOR NEXT DATA OPER.                 $3AF15170
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $3AF15180
       TRA     1,4                 GO HOME                             $3AF15190
DEOF1  NZT     1,4            IF LAST BUFFER                           $3AF15200
       TRA     PSTR6          DO NOTHING                               $3AF15210
       CAL*    1,4                 DISK OPERATIONS                     $3AF15220
       STZ*    1,4                 ARE DONE FOR NOW                    $3AF15230
       STA     1,4                 RESTORE REQUEST CHAIN               $3AF15240
       TRA     PSTR2               AS TAPE (UCB2)                      $3AF15250
FINREC LFT     200000              IOCS EOF                            $3AF15260
       TRA     DEOF                YES                                 $3AF15270
       CLA     1,4                                                     $3AF15280
       PAC     0,1            -L(COMMANDS)IN IR1                       $3AF15290
       CLA     L(STL               IF READ HAS FILLED                  $3AF15300
       ERA     1,1                 BUFFER AREA,GO BACK                 $3AF15310
       TNZ     *+3                 AS FINISHED RECORD                  $3AF15320
       LXA     S3+1,1                                                  $3AF15330
       TRA     SEOF+1                                                  $3AF15340
       CLA     1,1            PICK UP AND COUNT                        $3AF15350
       SXA     *+2,2                                                   $3AF15360
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $3AF15370
D7     AXT     **,2                RESTORE IR2                         $3AF15380
       CLA     1,4            READ OR WRITE                            $3AF15390
       TPL     D4                  READ                                $3AF15400
       CAL     6,2                 UPDATE NEXT TRACK                   $3AF15410
       ACL     L(2)                TO BE USED BY FILE                  $3AF15420
       ALS     18                  STORE IN FLAG WORD                  $3AF15430
       STD*    8,1                                                     $3AF15440
 D4    CAL     9,1                 PUT THE NEXT READ                    3AF15450
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (3)3AF15460
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (3)3AF15461
       LXA     D7,2         RESTORE                                  (3)3AF15462
       STA     9,1            COMMAND                                  $3AF15470
       SXA     *+2,1                                                   $3AF15480
       TSX     CKSEE,1        IS SEEK NECESSARY                        $3AF15490
       AXT     **,1           RESTORE IR1                              $3AF15500
       CLA     6,2            CREATE BCD CHARACTERS                    $3AF15510
       SXA     *+2,4          FOR THE NEXT PREPARE                     $3AF15520
       TSX     (DECVA,4       TO VERIFY COMMAND                        $3AF15530
       AXT     **,4                                                    $3AF15540
       CLA     6,2            GET REC LAB                              $3AF15550
       ADD     TRKC                UP TRACK COUNT                      $3AF15560
       SLW     6,2                 FOR RECORD                          $3AF15570
       ARS     6                   AND PUT IN                          $3AF15580
       STO     *+2            P.V. WORD                                $3AF15590
       TSX     (FDAMT,2                                                $3AF15600
       PZE                                                             $3AF15610
       PZE     12,1                                                     3AF15620
       TRA     S3             RETURN TO IOEX                           $3AF15630
DERR   LNT     100                     INTERFACE CHECK                  3AF15640
       TRA     *+4                 NO                                  $3AF15650
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3AF15660
       SXA     CHATT-1,4           RETURN 2,4                          $3AF15670
       TRA     DCHG                                                    $3AF15680
       CLA     1,4                 GET COMMAND LIST ADDRESS            $3AF15690
       PAC     0,1                 FOR STZ OPERATION                   $3AF15700
       STO     .DERR                   SET UNUSUAL END FLAG             3AF15710
       STZ     1,4                 ZERO OUT REQUEST                    $3AF15720
       CLA     4,2                 GET BUFFER POOL                     $3AF15730
       PDC     0,4                 AND PLACE IT IN IR4                 $3AF15740
       CLA     0,1                 GET BUFFER IN USE                   $3AF15750
       STZ     ,1                  ZERO OUT COMMAND LIST               $3AF15760
       STZ     1,1                 CONTROL WORDS                       $3AF15770
DERG   PAC     0,1                 RESTORE                             $3AF15780
       STA     *-1                 IORT                                $3AF15790
       CLA     FCW                 AND                                 $3AF15800
       STP     1,1                 BUFFER                              $3AF15810
       CLA     1,4                 COUNT                               $3AF15820
       ARS     4                                                       $3AF15830
       STD     1,1                                                     $3AF15840
       CLA     DERG                                                    $3AF15850
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $3AF15860
       TRA     S3                  GO BACK                             $3AF15870
TRKC   OCT     010000000000                                            $3AF15880
TRKRC  OCT     007777777777                                            $3AF15890
SEOH   CLA     SIX                 SET EOF BIT ON                      $3AF15900
       STP     0,2                 FOR STRANGE EOF                     $3AF15910
       TRA     SEOF+1              FINISH READ                         $3AF15920
SEOFI  RIL     200000              TURN OFF                            $3AF15930
       STI     0,2                 STRANGE EOF                         $3AF15940
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *3AF15950
       TRA     SELM2                                                   *3AF15960
       TTL     SELECT PLUS FOR 7909 CHANNEL                             3AF15970
DRWRS  CLA     1,4                                                      3AF15980
       PAX     0,1                 IF THIS IS A LIST WORD               3AF15990
       TXL     *+2,1,LCOMAD-1      FOR NOPOOL OPTION                 (8)3AF15991
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        3AF16000
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             3AF16010
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     3AF16020
       TZE     *+3                                                      3AF16030
       TIX     *-2,1,COMADL-LCOMAD                                      3AF16040
       TRA     DER1                                                     3AF16050
       PXA     0,1                                                      3AF16060
       SUB     DRWRX                                                    3AF16070
       PAC     0,1                                                     $3AF16080
       STA     D6-3                SAVE LIST ADDRESS                    3AF16090
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          3AF16100
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  3AF16110
       CLA*    1,4                 GET BUFFERS AHEAD                   $3AF16120
       STD     0,1                                                      3AF16130
       CLA     D6-3                PICKUP LIST ADDRESS AND              3AF16140
       STA     1,4                 PUT IT IN UCW 2                      3AF16150
       CLA     1,4                                                     $3AF16160
DRWRW  LXA     S3+1,1              RESTORE IR 1                         3AF16170
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         3AF16180
       TPL     *+2                 READ                                $3AF16190
       ACL     L(3)                WRITE                               $3AF16200
       STA*    (RCHXI              SET START CHAN INST                 $3AF16210
       ZET*    (URRXI              FIRST TIME THRU                     $3AF16220
       TRA     C3                  NO                                  $3AF16230
       LXA     CHATT-1,1           WAS CHANNEL                         $3AF16240
       SXA     CHATT-1,0           LIST SET UP                         $3AF16250
       TXH     C3,1,0              YES                                 $3AF16260
       STA     C7                                                      $3AF16270
       CLA     1,4                 ADDRESS OF COMMD                    $3AF16280
       PAC     0,1                 LIST TO IR1                         $3AF16290
       ZET     1,1                 PARTIAL RECORD                      $3AF16300
       TRA     C3                  YES START CHANNEL                   $3AF16310
DRWRS1 CLA     L(6)                BCD MODE                            $3AF16320
       LNT     MODE                                                    $3AF16330
       CLA     L(22)               BINARY MODE                         $3AF16340
C7     STA     **                  ADDRESS OF SMS                      $3AF16350
       CLA     0,1            ADDRESS OF BUFFER                        $3AF16360
       ACL     L(1)                                                    $3AF16370
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $3AF16380
       ACL     L(1)                                                    $3AF16390
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $3AF16400
       CLA*    8,1            PICK UP COUNT                            $3AF16410
       ARS     18                  MOVE COUNT OVER                     $3AF16420
       ANA     ADDRS               MASK ALL BUT ADDRESS                $3AF16430
       SXA     *+2,2                                                   $3AF16440
       TSX     SIZE,2         CHECK RECORD SIZE                        $3AF16450
C9     AXT     **,2                                                    $3AF16460
       CAL     6,2                 CREATE BCD CHARACTER                $3AF16470
       ANA     TRKRC               CHANGE THE TRACK                    $3AF16480
       ADD     TRKC                COUNT TO ONE FOR RECORD             $3AF16490
       SLW     6,2                 PUT BACK TO FCB                     $3AF16500
       SXA     *+2,4          FOR PV COMMAND                           $3AF16510
       TSX     (DECVA,4                                                $3AF16520
C2     AXT     **,4                                                    $3AF16530
       CAL     6,2                 GET SEEK ADDRESS                    $3AF16540
       ADD     L(1)                                                    $3AF16550
       ALS     18                  MOVE SEEK ADDRESS OVER              $3AF16560
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $3AF16570
       CAL     6,2                 LABEL FOR                           $3AF16580
       ARS     6                   RECORD ADDRESS                      $3AF16590
       STO     *+2                                                     $3AF16600
       TSX     (FDAMT,2       PLACE P.V. COMMAND                       $3AF16610
       PZE                    BITS IN PROPER PLACE                     $3AF16620
       PZE     12,1                                                     3AF16630
       XEC     C9                  RESTORE IR2                         $3AF16640
       CLA     *-3                 SET INTERFACE BIT                   $3AF16650
       ANA     L(1)                ON FOR SMS INST.                    $3AF16660
       ORS*    C7                                                      $3AF16670
C3     XEC     S3+1                RESTORE IR1                         $3AF16680
       CAL     0,2                 IS THERE A STRANGE                  $3AF16690
       ALS     1                   EOF ON THIS FILE -                  $3AF16700
       PBT                                                             $3AF16710
       TRA     S3-1                NO                                  $3AF16720
       XEC     C2                  YES - RESTORE XR4                   $3AF16730
       CLA*    1,4                 YES                                 $3AF16740
       ACL     L(1)                GET FLAG WORD                       $3AF16750
       STA     DRWRS2              ADDRESS AND SAVE                    $3AF16760
       CAL     6,2                 GET SEEK ADDRESS                    $3AF16770
       SUB     L(1)                MINUS 1 AND STORE                   $3AF16780
       STA     3,4                 IN UCB 4 AND FCB 7                  $3AF16790
       STA     6,2                                                     $3AF16800
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $3AF16810
       AXT     SYSTWT,2            START CHANNEL                       $3AF16820
       PXA     0,2                 FOR A                               $3AF16830
       STA*    (RCHXI              TRAP                                $3AF16840
       TRA     S3-1                GO                                  $3AF16850
L(3)   PZE     3                                                        3AF16860
LCOMAD PZE                         CHAIN TO BUFFERS                    $3AF16870
       PZE                         COUNT FOR MULTI TRACK RECORD        $3AF16880
       SMS     **                  SET MODE FOR READ                   $3AF16890
       CTLR    *+9            PREPARE DISK FOR READ.                    3AF16900
       TCH     *+4                 GO DO DATA MOVEMENT                 $3AF16910
       SMS     **                  SET MODE FOR WRITE                  $3AF16920
       LCC     0                   COUNTER FOR WRITE CHECK             $3AF16930
       CTLW    *+5            PREPARE DISK FOR WRITE                    3AF16940
       CPYP    **,,1               FLAG WORD MOVEMENT                  $3AF16950
       CPYP    **,,**              DATA MOVEMENT                       $3AF16960
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $3AF16970
       TCH     SYSTWT              INTERUPT CPU                        $3AF16980
       DVTA    ,,                                                      $3AF16990
COMADL PZE                                                             $3AF17000
       PZE                                                             $3AF17010
       SMS     **                                                      $3AF17020
       CTLR    *+9                                                      3AF17030
       TCH     *+4                                                     $3AF17040
       SMS     **                                                      $3AF17050
       LCC     0                                                       $3AF17060
       CTLW    *+5                                                      3AF17070
       CPYP    **,,1                                                   $3AF17080
       CPYP    **,,**                                                  $3AF17090
       CPYD    0,,0                                                    $3AF17100
       TCH     SYSTWT                                                  $3AF17110
       DVTA    ,,                                                      $3AF17120
       PZE                                                             $3AF17130
       PZE                                                             $3AF17140
       SMS     **                                                      $3AF17150
       CTLR    *+9                                                      3AF17160
       TCH     *+4                                                     $3AF17170
       SMS     **                                                      $3AF17180
       LCC     0                                                       $3AF17190
       CTLW    *+5                                                      3AF17200
       CPYP    **,,1                                                   $3AF17210
       CPYP    **,,**                                                  $3AF17220
       CPYD    0,,0                                                    $3AF17230
       TCH     SYSTWT                                                  $3AF17240
       DVTA    ,,                                                      $3AF17250
       PZE                                                             $3AF17260
       PZE                                                             $3AF17270
       SMS     **                                                      $3AF17280
       CTLR    *+9                                                      3AF17290
       TCH     *+4                                                     $3AF17300
       SMS     **                                                      $3AF17310
       LCC     0                                                       $3AF17320
       CTLW    *+5                                                      3AF17330
       CPYP    **,,1                                                   $3AF17340
       CPYP    **,,**                                                  $3AF17350
       CPYD    0,,0                                                    $3AF17360
       TCH     SYSTWT                                                  $3AF17370
       DVTA    ,,                                                      $3AF17380
       PZE                                                             $3AF17390
       PZE                                                             $3AF17400
       SMS     **                                                      $3AF17410
       CTLR    *+9                                                      3AF17420
       TCH     *+4                                                     $3AF17430
       SMS     **                                                      $3AF17440
       LCC     0                                                       $3AF17450
       CTLW    *+5                                                      3AF17460
       CPYP    **,,1                                                   $3AF17470
       CPYP    **,,**                                                  $3AF17480
       CPYD    0,,0                                                    $3AF17490
       TCH     SYSTWT                                                  $3AF17500
       DVTA    ,,                                                      $3AF17510
       PZE                                                             $3AF17520
       PZE                                                             $3AF17530
       SMS     **                                                      $3AF17540
       CTLR    *+9                                                      3AF17550
       TCH     *+4                                                     $3AF17560
       SMS     **                                                      $3AF17570
       LCC     0                                                       $3AF17580
       CTLW    *+5                                                      3AF17590
       CPYP    **,,1                                                   $3AF17600
       CPYP    **,,**                                                  $3AF17610
       CPYD    0,,0                                                    $3AF17620
       TCH     SYSTWT                                                  $3AF17630
       DVTA    ,,                                                      $3AF17640
       PZE                                                             $3AF17650
       PZE                                                             $3AF17660
       SMS     **                                                      $3AF17670
       CTLR    *+9                                                      3AF17680
       TCH     *+4                                                     $3AF17690
       SMS     **                                                      $3AF17700
       LCC     0                                                       $3AF17710
       CTLW    *+5                                                      3AF17720
       CPYP    **,,1                                                   $3AF17730
       CPYP    **,,**                                                  $3AF17740
       CPYD    0,,0                                                    $3AF17750
       TCH     SYSTWT                                                  $3AF17760
       DVTA    ,,                                                      $3AF17770
       PZE                                                             $3AF17780
       PZE                                                             $3AF17790
       SMS     **                                                      $3AF17800
       CTLR    *+9                                                      3AF17810
       TCH     *+4                                                     $3AF17820
       SMS     **                                                      $3AF17830
       LCC     0                                                       $3AF17840
       CTLW    *+5                                                      3AF17850
       CPYP    **,,1                                                   $3AF17860
       CPYP    **,,**                                                  $3AF17870
       CPYD    0,,0                                                    $3AF17880
       TCH     SYSTWT                                                  $3AF17890
       DVTA    ,,                                                      $3AF17900
       PZE                                                             $3AF17910
       PZE                                                             $3AF17920
       SMS     **                                                      $3AF17930
       CTLR    *+9                                                      3AF17940
       TCH     *+4                                                     $3AF17950
       SMS     **                                                      $3AF17960
       LCC     0                                                       $3AF17970
       CTLW    *+5                                                      3AF17980
       CPYP    **,,1                                                   $3AF17990
       CPYP    **,,**                                                  $3AF18000
       CPYD    0,,0                                                    $3AF18010
       TCH     SYSTWT                                                  $3AF18020
       DVTA    ,,                                                      $3AF18030
       PZE                                                             $3AF18040
       PZE                                                             $3AF18050
       SMS     **                                                      $3AF18060
       CTLR    *+9                                                      3AF18070
       TCH     *+4                                                     $3AF18080
       SMS     **                                                      $3AF18090
       LCC     0                                                       $3AF18100
       CTLW    *+5                                                      3AF18110
       CPYP    **,,1                                                   $3AF18120
       CPYP    **,,**                                                  $3AF18130
       CPYD    0,,0                                                    $3AF18140
       TCH     SYSTWT                                                  $3AF18150
       DVTA    ,,                                                      $3AF18160
ENDLIS BES     LCOMAD+NOCH*14-*                                         3AF18170
       TTL 0                                                           $3AF18180
*                                                                      $3AF18190
*              TSX CKSEE,1                                             $3AF18200
*              RETURN                                                  $3AF18210
*                                                                      $3AF18220
*                                                                      $3AF18230
CKSEE  CAL     6,2            UPDATE SEEK                              $3AF18240
       ACL     L(4)                                                    $3AF18250
       ERA     7,2            ADDRESS                                  $3AF18260
       ANA     ADDRS                                                   $3AF18270
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $3AF18280
       TXH     D9,1,-TEMIND                                            $3AF18290
       CAL     6,2                                                     $3AF18300
       ADD     L(1)                                                    $3AF18310
       STA     6,2            NEXT ADDRESS FOR SEEK                    $3AF18320
       CAL     3,4                                                     $3AF18330
       ADD     L(1)                                                    $3AF18340
       STA     3,4                 UPDATE SEEK ADDRESS                 $3AF18350
       ERA     6,2                 SAME ARM POSITION                   $3AF18360
       ANA     ADDRS               AS DESIRED                          $3AF18370
       TZE     D8                  YES                                 $3AF18380
D9     CAL     6,2                 NO, PUT DESIRED                     $3AF18390
       STA     3,4                 POSITION IN REQUEST                 $3AF18400
       TRA     D6                  AND ASK FOR SEEK                    $3AF18410
D8     CLA     3,4                 GET POSITION AND                    $3AF18420
       ANA     ADDRS          CHECK IF ANOTHER                         $3AF18430
       XCA                    SEEK NEC. NOW                            $3AF18440
       PXA     **,0                                                     3AF18450
       DVP     L(40)                                                   $3AF18460
       TNZ     1,1            RETURN IF NO SEEK                        $3AF18470
D6     CLS     2,4            SET 3RD UCW TO                           $3AF18480
       STO     2,4            DEMAND A SEEK                            $3AF18490
       TRA     1,1                                                     $3AF18500
*                                                                      $3AF18510
*              COUNT IN ACC                                            $3AF18520
*              TSX SIZE,2                                              $3AF18530
*              RETURN                                                  $3AF18540
*                                                                      $3AF18550
 SIZE  SXA     C11,2        SAVE IR2                                 (3)3AF18560
       XCA                  SAVE COUNT                               (3)3AF18570
       CAL     0,4          UCW1                                     (3)3AF18580
       ARS     6            MOVE AND                        7=1302   (3)3AF18590
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (3)3AF18600
       PDX     0,2          DEVICE TO IR2                   1=1301   (3)3AF18610
 SVCOD XCA     **           RESTORE COUNT IN AC. INST ADDR SAVES CODE(3)3AF18620
       TIX     *+1,2,5      IF 1302,MAKE CODE A 2                    (3)3AF18630
       SXA     *-2,2        SAVE THE CODE                            (3)3AF18640
       SUB     L(STL,2      SUB FULL TRACK FROM WORD COUNT           (3)3AF18650
       TMI     D1           LESS THAN OR                             (3)3AF18660
       TZE     D1           EQUAL TO FULL TRACK TRA TO D1            (3)3AF18670
       STA     1,1          SAVE EXTRA WORD COUNT                    (3)3AF18680
       CLA     L(STL,2      GET FULL TRACK                           (3)3AF18690
 C1    SLW*    8,1          PUT IN FLAG WORD                         (3)3AF18700
       ALS     18           PUT COUNT IN                             (3)3AF18710
       STD     9,1          COPY COMMAND                             (3)3AF18720
 C11   AXT     **,2         PREPARE TO RETURN                        (3)3AF18730
       TRA     1,2          RETURN                                   (3)3AF18740
 D1    ADD     L(STL,2      GET COUNT BACK                           (3)3AF18750
       STL     1,1          MAKE FALSE COUNT                         (3)3AF18760
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (3)3AF18770
       TXI     C1,0,7       FINISH UP                                (3)3AF18780
 ENTRK CLA     TRKRC        SET END OF TRACK                         (3)3AF18790
       STT     6,2          INDICATION IN FCW7                       (3)3AF18800
       TRA     CKSEE+5      AND RETURN                               (3)3AF18810
       PZE     524          7320 DRUM TRACKSIZE                      (3)3AF18820
       PZE     969          1302 DISK TRACKSIZE                      (3)3AF18821
       PZE     465          1301 DISK TRACKSIZE                      (3)3AF18822
 L(STL PZE     D2           LOCATION OF STL FOR LATER COMPARE        (3)3AF18823
       BES     MSEL+NOCH/NOCH**-NOCH/NOCH*MSEL-*                       $3AF18830
HBEG   SMS     **                  SET INTERFACE                       $3AF18840
       LIPT    *+1                 LEAVE INTERUPT STATUS               $3AF18850
       CTLR    *+7                 SELECT FOR READ                     $3AF18860
       TCH     *+3                 DO IO                               $3AF18870
       SMS     **                  SET INTERFACE                       $3AF18880
       CTLW    *+4                 SELECT FOR WRITE                    $3AF18890
       CPYP    **,,**              DO IO                               $3AF18900
       CPYD    0,,0                                                    $3AF18910
       TCH     SYSTWT              INTERUPT                            $3AF18920
       OCT     120600120112        HSEL AND EOS                        $3AF18930
HLIS   SMS     **                                                      $3AF18940
       LIPT    *+1                                                     $3AF18950
       CTLR    *+7                                                     $3AF18960
       TCH     *+3                                                     $3AF18970
       SMS     **                                                      $3AF18980
       CTLW    *+4                                                     $3AF18990
       CPYP    **,,**                                                  $3AF19000
       CPYD    0,,0                                                    $3AF19010
       TCH     SYSTWT                                                  $3AF19020
       OCT     120600120112                                            $3AF19030
       SMS     **                                                      $3AF19040
       LIPT    *+1                                                     $3AF19050
       CTLR    *+7                                                     $3AF19060
       TCH     *+3                                                     $3AF19070
       SMS     **                                                      $3AF19080
       CTLW    *+4                                                     $3AF19090
       CPYP    **,,**                                                  $3AF19100
       CPYD    0,,0                                                    $3AF19110
       TCH     SYSTWT                                                  $3AF19120
       OCT     120600120112                                            $3AF19130
       SMS     **                                                      $3AF19140
       LIPT    *+1                                                     $3AF19150
       CTLR    *+7                                                     $3AF19160
       TCH     *+3                                                     $3AF19170
       SMS     **                                                      $3AF19180
       CTLW    *+4                                                     $3AF19190
       CPYP    **,,**                                                  $3AF19200
       CPYD    0,,0                                                    $3AF19210
       TCH     SYSTWT                                                  $3AF19220
       OCT     120600120112                                            $3AF19230
HEND   BES     HBEG+NOHYP*10-*                                         $3AF19240
       PZE     HEND                                                    $3AF19250
       TTL     SELECT ROUTINES FOR HYPER                                3AF19260
HYPL   CLA     3,4                 IF REINSTRUCT                       $3AF19270
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $3AF19280
       AXT     HEND-HBEG,1         FIND CH. LIST POINTER               $3AF19290
       SXA     HSXA,1              SAVE CH. LIST POINTER               $3AF19300
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $3AF19310
       ANA     DECRE               THIS CHANNEL TO USE                 $3AF19320
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $3AF19330
       ARS     18                                                      $3AF19340
       SUB     S3+1                                                    $3AF19350
       ANA     ADDRS                                                   $3AF19360
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $3AF19370
       TIX     HYPL+3,1,HLIS-HBEG                                      $3AF19380
       TRA     DER1                                                    $3AF19390
       LXA     S3+1,1              GET CHANNEL NO                      $3AF19400
       PXD     0,1                                                     $3AF19410
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $3AF19420
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $3AF19430
       PXA     0,1                 COMPUTE THE                         $3AF19440
       SUB     HEND                CHANNEL LIST                        $3AF19450
       STA     HSXA                START ADDRESS                       $3AF19460
       CLA     1,4                                                     $3AF19470
       ACL     L(1)                                                    $3AF19480
       STA     S0                  SAVE ADDRESS OF IORT                $3AF19490
       ACL     L(1)                PUT LOCATION OF                     $3AF19500
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $3AF19510
       STA     6,1                 ADDRESS FOR START CH.               $3AF19520
       XCA                         SAVE READ OR WRITE                  $3AF19530
S0     CLA     **                  GET NO. OF WORDS                     3AF19540
       STD     6,1                 STORE IN COPY                        3AF19550
       RNT     400000              READ BACKWARD                        3AF19560
       TRA     *+4                 NO                                   3AF19570
       ARS     18                  PUT LAST LOCATION                    3AF19580
       ACL     S0                  OF BUFFER IN                         3AF19590
       STA     6,1                 COPY COMMAND                         3AF19600
       CLA     3,4                 IS THIS A REINSTRUCT                 3AF19610
       TZE     HNSL                NO                                   3AF19620
       CLA     HYCLN               TURN OFF THE                         3AF19630
       ORS     2,1                 CONTROL OPERATION                    3AF19640
       ORS     5,1                                                      3AF19650
       LXA     S3+1,1                                                   3AF19660
       NZT*    (URRXI              IF NO ERROR                          3AF19670
       TRA     S3-1                START CHANNEL                        3AF19680
HNSL   CAL     HSXA                SMS ADDRESS                         $3AF19690
       STA     3,4                 SAVE CH LIST IN UCW4                $3AF19700
       TQP     *+2                 READ                                 3AF19710
       ADD     L(4)                WRITE                               $3AF19720
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $3AF19730
       STA*    (RCHXI              START CHANNEL ADDRESS               $3AF19740
       ZET*    (URRXI              BACK ON ERROR CONDITION             $3AF19750
       TRA     S3-1                YES, START CHANNEL                  $3AF19760
       CLA     CHATT-1             IF RETURN FROM                      $3AF19770
       ANA     ADDRS               SEL-WITH INTERFACE                  $3AF19780
       SXA     CHATT-1,0           NOT READY, THEN                     $3AF19790
       TNZ     S3-1                JUST TRY AGAIN                      $3AF19800
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $3AF19810
       CLA     0,4                 SAVE UNIT                           $3AF19820
       ANA     DEC15               NO. IN SEL ORDER                    $3AF19830
       ORA     HYSEL                                                   $3AF19840
       RFT     400000              IS THIS READ BACKWARD               $3AF19850
       ORA     L(64D)              YES, FIX SEL ORDER                  $3AF19860
       STD     9,1                                                     $3AF19870
       CLA     HYCTL               SET CONTROL                         $3AF19880
       ANS     2,1                 OPERATION ON                        $3AF19890
       ANS     5,1                                                     $3AF19900
       CLA     HSMSN               SET UP SMS COMMAND                  $3AF19910
       LNT     004000              IF OFF BCD MODE                     $3AF19920
       ORA     L(22)                                                   $3AF19930
       RFT     400000                                                  $3AF19940
       ORA     HSMSR               BACKWARD READ                       $3AF19950
       LDI     0,4                 PUT THE                             $3AF19960
       LFT     40                  INTERFACE                           $3AF19970
       ORA     L(1)                IN SMS                              $3AF19980
       STA     0,1                                                     $3AF19990
       STA     4,1                                                     $3AF20000
       LXA     S3+1,1                                                  $3AF20010
       TRA     S3-1                                                    $3AF20020
       TTL     SELECT MINUS FOR HYPER                                   3AF20030
HSELM  CLA     1,4                 UCW 2 TO AC                         $3AF20040
       ACL     L(1)                IORT ADDRESS OF BUF                 $3AF20050
       STA     HIORT                                                   $3AF20060
       ACL     L(1)                                                    $3AF20070
       LFT     7100                ERROR                               $3AF20080
       TRA     HEROR               YES                                 $3AF20090
       ALS     18                  DEC= 1ST WORD WRITTEN               $3AF20100
       STD     COMM                SAVE AS 76O7 CH.                    $3AF20110
HIORT  CLA     **                  LAST WORD WRITTEN                   $3AF20120
       STA     COMM                SAVE AS 7607 CH.                    $3AF20130
HRETN  CAL     S3                  FIX EXIT                            $3AF20140
       SUB     L(1)                FOR CONTINUED                       $3AF20150
       STA     S3                  PRIORITY ON UNIT                    $3AF20160
       CLA     1,2                 IF MIXED MODE                        3AF20170
       TPL     SELM1               SKIP OUT AFTER                       3AF20180
       STZ     3,4                 REINSTRUCT IS                        3AF20190
       TRA     MXMOD+3             MADE IMPOSSIBLE                      3AF20200
HSMRD  LDI     FOR                 GOOD READ                           $3AF20210
       LDQ     COMM                MAKE COMM LOOK                      $3AF20220
       LGL     18                  LIKE 7607 CHANNEL                   $3AF20230
       SLW     COMM                                                    $3AF20240
       ANA     ADDRS                                                   $3AF20250
       LDQ     1,4                                                     $3AF20260
       RQL     1                   TYPE READ                           $3AF20270
       TQP     HREAD               READ FORWARD                        $3AF20280
       LNT     200000              END OF FILE TEST                    $3AF20290
       TNZ     *+2                 IF LONG LENGTH RECORD               $3AF20300
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $3AF20310
       ACL     L(1)                ELSE IT POINTS AT LAST              $3AF20320
       STA     COMM                WORD READ                           $3AF20330
HREAD  TNZ     HRETN                                                   $3AF20340
       CAL     COMM                MAKE IT POINT AT                    $3AF20350
       ADD*    HIORT               LAST REC IN BUFF+1                  $3AF20360
       ARS     18                  IF LONG RECORD READ                 $3AF20370
       TRA     HREAD-1                                                 $3AF20380
HEROR  RFT     377777              NCI INTERRUPT                       $3AF20390
       TRA     *+2                 NO                                  $3AF20400
       TRA     HSMRD               YES                                 $3AF20410
       LNT     100                 INTERFACE CHECK                     $3AF20420
       TRA     *+4                 NO                                  $3AF20430
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3AF20440
       SXA     CHATT-1,4           RETURN 2,4                          $3AF20450
       TRA     DCHG                                                    $3AF20460
       RFT     020014                                                  $3AF20470
       TRA     HYSEL+1             EOT, EOF, BOT                       $3AF20480
       LDI     1,4                                                     $3AF20490
       LFT     400000                                                  $3AF20500
       TRA     *+3                 WRITE ERROR                         $3AF20510
       LDI     1PRE                READ ERROR                          $3AF20520
       TRA     HSMRD+1             GO POST                             $3AF20530
       CAL     S3                                                      $3AF20540
       SUB     L(2)                CHANGE EXIT                         $3AF20550
       STO     S3                  TO 3,4                              $3AF20560
       CLA*    (URRXI              UPDATE ERROR                        $3AF20570
       ACL     5,2                                                     $3AF20580
       SLW     5,2                 HISTORY AND TRY                     $3AF20590
       TRA     S3                  TO WRITE AGAIN                      $3AF20600
HSMSR  OCT     000000000040        CONSTANTS                           $3AF20610
HSMSN  OCT     000000000106        FOR                                 $3AF20620
HYCTL  OCT     757777777777        HYPER                               $3AF20630
HYCLN  OCT     020000000000        SELECT                              $3AF20640
HYSEL  OCT     120600120112                                            $3AF20650
       LDI     SIX                                                     $3AF20660
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE              3AF20670
       TPL     HSMRD+1             READ EOF                            $3AF20680
       TRA     HIORT-2             WRITE EOT                           $3AF20690
       BES     HBEG+NOHYP/NOHYP**-NOHYP/NOHYP*HBEG-*                   $3AF20700
DER1   STL     .DERR                                                    3AF20710
       STZ     1,4                 ZERO OUT UCW2                       $3AF20720
       TRA     DCHG                RETURN 2,4                          $3AF20730
       BES     *-3+NOCHX/NOCHX*3-*                                      3AF20740
       TTL     NON-DATA OPERATION CHECK FOR DISK                        3AF20750
*                                                                       3AF20760
D7909  AXT     **,4                                                    *3AF20770
       TRA     (NDSLX                                                $5$3AF20771
SVDID  PZE     **                                                      *3AF20780
       SXA     D7909,4                                                 *3AF20790
       CLA     1,4                                                   $5$3AF20791
       PDX     0,4                                                   $5$3AF20792
       CLA     5,2                                                     *3AF20800
       TMI     7KA                 1301                                *3AF20810
       ANA     SIX                                                     *3AF20820
       TZE     D7909                                                 $5$3AF20830
 HNDS  TXL     HND2,4,2                                              $5$3AF20860
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *3AF20870
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *3AF20880
       TNX     *+4,4,31            FOLLOWING ORDERS                    *3AF20890
       TXI     *+1,4,33            RWD,RUN                             *3AF20900
       TNX     *+2,4,35            BSR,BSF                             *3AF20910
       TXI     *+1,4,32            WTM                                 *3AF20920
HND1   SXD     *+2,4                                                   *3AF20930
       TSX     (NDSLX,4                                                *3AF20940
       PZE     0,2,**                                                  *3AF20950
HND2   LXA     D7909,4                                                 *3AF20960
       TRA     2,4                                                     *3AF20970
       BES     HNDS+NOHYP/NOHYP**-NOHYP/NOHYP*HNDS-*                    3AF20980
  7KA  TXL     DNDSEL+1,4,2                                          $5$3AF20981
       STI     SVDID                                                 $5$3AF20990
       STZ     TEMP                                                     3AF21000
       LDQ     6,2                 CHECK FOR EOF                      *$3AF21010
       TQP     7KAA          NO                                      $5$3AF21020
       STL     TEMP                                                     3AF21030
       SXA     *+2,4                                                 $5$3AF21031
       TSX     EOF,4               YES                                 $3AF21040
       AXT     **,4                                                  $5$3AF21050
 7KAA  ENB     TRAPS                                                 $5$3AF21060
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $3AF21100
       TXH     DWEF,4,5            BSF-6 WEF-7                         $3AF21110
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $3AF21120
       ZET     TEMP                                                     3AF21130
       TRA     7KB                                                      3AF21140
       CAL     7,2                 GET BOT AND                          3AF21150
       ARS     18                  TEST IF POSITION                    $3AF21160
       SBM     6,2                 NOW, IS SAME                        $3AF21170
       ANA     ADDRS               IF SO                               $3AF21180
       TZE     DNDSEL              NO BACKSPACE - NOP                  $3AF21190
7KB    PXA     0,0                 NO. OF TRACKS IN RECORD              3AF21200
       LLS     5                   DEDUCT TRACKS                       $3AF21210
       SUB     6,2                 AND PUT IT BACK                     $3AF21220
       STA     6,2                 FOR NEXT SEEK                       $3AF21230
DNDSEL LDI     SVDID         PLACE BACK AND                        IBJOB3AF21240
       LXA     D7909,4             RETURN                              $3AF21250
       TRA     2,4                                                     $3AF21260
DIND   SYN     DNDSEL                                              IBJOB3AF21270
NDSEL  EQU     SVDID                                                   $3AF21280
DWEF   SXA     DWEF1,4                                                 $3AF21290
       SXA     DWEF1+1,1                                               $3AF21300
       TXL     DBSF,4,6            BSF                                 $3AF21310
DBSF1  AXC     1,4                                                     $3AF21320
       CLA*    0,2                 GET 2ND WORD OF UCB                 $3AF21330
       TNZ     *-1                 WAIT FOR LAST WRITE                 $3AF21340
       ENB     L(0)                                                    $3AF21350
       CLA     6,2                                                     $3AF21360
       ANA     DECRE                                                   $3AF21370
       ARS     6                                                       $3AF21380
       STO     DSMSB                                                   $3AF21390
       SXA     DWEF6,2                                                 $3AF21400
       CLA     1,2                 TEST MODE                           $3AF21410
       ANA     MODBT                                                    3AF21420
       TZE     *+3                 BCD MODE                             3AF21430
       CLA     L(6)                BINARY MODE                          3AF21440
       TRA     *+2                                                      3AF21450
       CLA     L(22)                                                    3AF21460
       ORS     DSMSB                                                    3AF21470
       CLA     0,2                 GET UCB ADDRESS                     $3AF21480
       STA     DAXC                                                    $3AF21490
       CLA     6,2                                                     $3AF21500
       TSX     (DECVA,4                                                $3AF21510
DAXC   AXC     **,4                'L(UCB)                             $3AF21520
       CLS     2,4                 REQUEST SEEK                        $3AF21530
       STO     2,4                 WITH MINUS SIGN                     $3AF21540
       CLA     6,2                 AND CORRECT                         $3AF21550
       STA     3,4                                                     $3AF21560
       TSX     (FDAMT,2            IOEX ROUTINE TO SET ORDER           $3AF21570
DSMSB  BCI     1,00I006                                                $3AF21580
       PZE     DVTA                                                    $3AF21590
DWEF6  AXT     **,2                L(FCB)                              $3AF21600
       STL     DWAIT               MAKE WAIT CELL NONZERO              $3AF21610
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $3AF21620
       PXD     0,1                                                     $3AF21630
       STD     1,4                 SECOND WORD OF UCB                  $3AF21640
       TSX     (ACTVX,4            ACTIVATE CHAIN OF CHANNEL COMMANDS  $3AF21650
       MZE     0,2                                                     $3AF21660
       ZET     DWAIT               WAIT FOR SELECT MINUS                3AF21670
       TRA     *-1                 TO FINISH                           $3AF21680
       XEC     DWEF1                                                   $3AF21690
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $3AF21700
       CAL     6,2                 SET UP SEEK                         $3AF21710
       ACL     L(1)                AND FILE START                      $3AF21720
       STA     6,2                 ADDRESS FOR                         $3AF21730
       TSX     EOF,4               BACKSPACE FILE                      $3AF21740
       ENB     TRAPS                                                   $3AF21750
DWEF1  AXT     **,4                AT LAST                             $3AF21760
       AXT     **,1                                                    $3AF21770
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $3AF21780
       CAL     7,2                 GET BOT ADDRESS                     $3AF21790
       STD     0,2                 AND PUT IN BOTH                     $3AF21800
       ARS     18                  WORD ONE AND SEVEN                  $3AF21810
       STA     6,2                                                     $3AF21820
       TXL     DNDSEL,4,3                                              $3AF21830
       PXA     0,0                                                     $3AF21840
       STA     0,2                 ZERO OUT UCB                        $3AF21850
       XEC     DIND                RESTORE INDICATORS                  $3AF21860
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $3AF21870
       TRA     DNDSEL+1            RETURN                              $3AF21880
DWAIT  PZE                                                             $3AF21890
DVTA   DVTA    ,,                                                      $3AF21900
DBSF   LDI     6,2                 1ST TIME AROUND                     $3AF21910
       CLA     7,2                                                     $3AF21920
       STD     *+3                 IF AT                               $3AF21930
       CLA     0,2                 BOT DO NOT                          $3AF21940
       PDC     0,1                 DO THE                              $3AF21950
       TXI     *+1,1,**            BACKSPACE                           $3AF21960
       TXL     DNDSEL,1,0    FILE                                  IBJOB3AF21970
       LFT     600000                                                  $3AF21980
       TRA     DBSF4               NOT 1ST TIME                        $3AF21990
       CLA     0,2                 EXCHANGE SEEK POINTER               $3AF22000
DBSF6  ARS     18                  TO BE BEGINNING                     $3AF22010
       STA     6,2                 OF THE FILE                         $3AF22020
       CAL     SIX                 PUT NOT FIRST                       $3AF22030
       STP     6,2                 TIME THRU FLAG ON                   $3AF22040
       TRA     DNDSEL        EXIT                                  IBJOB3AF22050
DBSF4  LFT     200000                                                  $3AF22060
       TRA     DBSF5               NOT FIRST TIME THRU                 $3AF22070
       PIA     **                  PUT SEEK ADDRESS                    $3AF22080
       ALS     18                  AND BEGINNING OF                    $3AF22090
       STD     0,2                 FILE EQUAL                          $3AF22100
       TRA     DBSF6+2             EXIT                                $3AF22110
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $3AF22120
       SXA     DSELP+2,4           FOR BACKSPACE                       $3AF22130
       PIA                                                             $3AF22140
       SUB     L(1)                MAKE SEEK ADDRESS                   $3AF22150
       STA     6,2                 EOF ADDRESS                         $3AF22160
       TRA     DBSF1               GET FLAG FOR EOF                    $3AF22170
DBSF3  AXT     DCTL,4              RESTORE START                       $3AF22180
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $3AF22190
       CAL     DFLAG               GET NEW B.O.F.                      $3AF22200
       STD     0,2                 AND PUT IT IN THE                   $3AF22210
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $3AF22220
*                                                                      $3AF22230
DISUE  ACL     L(1)                GET ADDRESS OF                      $3AF22240
       STA     DSELM1              UCB + 1                             $3AF22250
       LXA     DWEF6,2             -L (FILE) IN IR2                    $3AF22260
       TPL     DSELP                                                   $3AF22270
       STZ     DWAIT                                                   $3AF22280
DSELM1 STZ     **                                                      $3AF22290
       TRA     1,4                 RETURN                              $3AF22300
DSELP  CAL     0,2                 PUT FILE                            $3AF22310
       STD     DFLAG               START POINT IN FLAG                 $3AF22320
       AXT     DCTL,2              COMM. LIST                          $3AF22330
       PXA     0,2                                                     $3AF22340
       STA*    (RCHXI                                                  $3AF22350
       XEC*    (RCHXI              SEL+ START CHANNEL                  $3AF22360
       TRA     1,4                 EOF LOCATION                        $3AF22370
*              7909 CHANNEL PROGRAM                                    $3AF22380
*                                                                      $3AF22390
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              3AF22400
       CTLW    DVTA                                                    $3AF22410
       CPYD    DFLAG,,1                                                $3AF22420
       TCH     SYSTWT                                                  $3AF22430
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $3AF22440
       CTLR    DVTA                FOR BACK SPACE                      $3AF22450
       TCH     DCTL+2              FILE ROUTINE                        $3AF22460
DFLAG  PTW                         EOF FLAG WORD                       $3AF22470
       BES     7KA+NOCH/NOCH**-NOCH/NOCH*7KA-*                          3AF22480
       TTL                         UNBUFFER INPUT FILE                  3AF22490
*    TSX  UNBFI,4           DESTROYS IR1                                3AF22500
       SPACE   1                                                        3AF22510
UNBFI  SXA     UB7,4               SAVE IR4                             3AF22520
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       3AF22530
UB1    ENB     L(0)                TRAP PROTECT                         3AF22540
       AXC     1,4                 IF NO BUFS IN REQ                    3AF22550
       CLA*    0,2                 CHAIN THEN GO RELEASE                3AF22560
       TZE     UB4                 SYNC CHAIN                           3AF22570
UB1.1  LDQ     5,2                   CHECK FOR DISK                     3AF22590
       TQP     *+2                                                     $3AF22610
       TRA     UB3                 DISK, GO TO UB3                     $3AF22620
       BES     UB1.1+NOCH/NOCH**-NOCH/NOCH*UB1.1-*                   $5$3AF22630
       STA     UB2                 SAVE L(1ST REQ)                      3AF22640
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       3AF22650
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         3AF22660
       TRA     UB3                 HOOKING REMAINDER OF REQ             3AF22670
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       3AF22680
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         3AF22690
       XCA                         ITS COMPLETION                       3AF22700
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    3AF22710
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           3AF22720
       LDQ     4,2                 ADD 2ND ON REQS                      3AF22730
       STA     4,2                 TO SYNC CHAIN                        3AF22740
       PDC     0,1                                                      3AF22750
       XCA                                                              3AF22760
       STA     0,1                                                      3AF22770
       CLA*    0,1                                                      3AF22780
       STD*    4,2                                                      3AF22790
UB3    TSX     ACTV+1,4            WHICH AT TRAP WILL                   3AF22800
       MZE     0,2                 BE ENTERED INTO                      3AF22810
       AXC     1,4                 SYNC CHAIN                           3AF22820
       ZET*    0,2                 WAIT                                 3AF22830
       TRA     *-1                                                      3AF22840
       SPACE   1                                                        3AF22850
*                      ALL BUFFERS IN SYNC CHAIN                        3AF22860
UB4    SXD     SYNCT,0             PRESET SYNC CT                       3AF22870
       STZ     TEMP                SET EOF DELETE SWITCH =0             3AF22880
UB4.1  CLA*    4,2                 PLACE BUFFERS                        3AF22890
       TZE     UB6                 FROM SYNC CHAIN                      3AF22900
       TPL     *+4                 TO POOL ,+ BUFFERS                   3AF22910
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          3AF22920
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 3AF22930
       SXD     SYNCT,1             NECESSARY TO REPOSITION              3AF22940
       LDQ     4,2                 TO POOL                              3AF22950
       STA     4,2                                                      3AF22960
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           3AF22970
       TZE     UB4.2               WITH THIS BUFFER                     3AF22980
       XCA                         YES- SO PICKUP                       3AF22990
       PAC     0,1                 THE TAPE POSITION                    3AF23000
       XCA                         AND SAVE FOR AFTER BSR               3AF23010
       CLA     2,1                 ACROSS EOF MARK                      3AF23020
       STO     TEMP                                                     3AF23030
UB4.2  LAC     LBC,4                                                    3AF23040
       TSX     TOCLOS,1                                                 3AF23050
       TRA     UB4.1                                                    3AF23060
       SPACE   1                                                        3AF23070
*                         FORM NEW SYNC CHAIN                           3AF23080
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  3AF23090
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $3AF23100
       TRA     UB3                 AND CONTINUE                         3AF23110
       SPACE   1                                                        3AF23120
*                            EXIT SEQUENCE                              3AF23130
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              3AF23140
       TXL     UB7,1,0             SETUP AND BACKSPACE                  3AF23150
       LDQ     5,2                                                     $3AF23160
       RQL     1                   HYPER                               $3AF23170
       TQP     *+7                 NO                                  $3AF23180
       LDQ     1,2                                                     $3AF23190
       RQL     18                  READ BACKWARD                       $3AF23200
       TQP     *+4                 NO                                  $3AF23210
       TSX     (NDSLX,4                                                $3AF23220
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $3AF23230
       TRA     UB6.3-1                                                 $3AF23240
       BES     *-9+NOHYP/NOHYP*9-*                                     $3AF23250
       TSX     NDSEL+1,4                                                3AF23260
       PZE     0,2,BSROP                                                3AF23270
       NZT     TEMP                IF BSR ACROSS EOF MARK               3AF23280
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $3AF23290
       CLA     5,2                                                   $5$3AF23291
       TMI     *+5                                                   $5$3AF23292
       CLA     TEMP                AND CONTINUE                         3AF23300
       AXC     2,4                                                      3AF23310
       STO*    0,2                                                      3AF23320
       STZ     TEMP                                                     3AF23330
       SIL     NINHIB              UN-INHIBIT FILE                      3AF23340
       TRA     UB6.3                                                    3AF23350
UB7    AXT     **,4                RESTORE IR4                          3AF23360
       TRA     1,4                 EXIT                                 3AF23370
       TTL     UNBUFFER OUTPUT FILE                                     3AF23380
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   3AF23390
*    TSX  UNBFO,4     DESTROYS IR1                                      3AF23400
       SPACE   1                                                        3AF23410
UNBFO  SXA     UNBO,4              SAVE IR4                             3AF23420
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         3AF23430
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 3AF23440
       NZT*    0,2                 TO DO GIVE IT                        3AF23450
       TRA     UNBO                PRIORITY AND WAIT.....               3AF23460
       TSX     ACTV+1,4            FOR ALL REQUESTS TO GET DONE         3AF23470
       MZE     0,2                                                      3AF23480
       TRA     UNBF1                                                    3AF23490
UNBO   AXT     **,4                                                     3AF23500
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        3AF23510
       TRA     1,4                 ELSE EXIT                            3AF23520
       TSX     EOTOF,1                                                  3AF23530
       TRA     UNBO-3                                                   3AF23540
       TTL                         IOCS SELECT ROUTINES                 3AF23550
*             (INITIATE A SELECT AND POST ITS COMPLETION)               3AF23560
       SPACE   1                                                        3AF23570
CHATY  PZE                         UNIT AND CHANNEL TYPE               $3AF23580
ISSUE  SXA     S3,4                SAVE IR4                             3AF23590
       SXA     S3+1,1              SAVE IR1                             3AF23600
       PAC     0,4                 -L(UCW) TO IR4                       3AF23610
       XCA                         SAVE + OR - ENTRY                    3AF23620
CHATT  CLA     0,4                 SET UP AND                          $3AF23630
       ANA     BVDG                TEST FOR UNIT                       $3AF23640
       PDX     0,2                 AND CHANNEL TYPE                    $3AF23650
       TXL     *+3,2,8191          7909 OR 7607                        $3AF23660
       TXL     *+3,2,8192          HYPER                               $3AF23670
       TXI     *+2,2,1             DISK                                $3AF23680
       AXT     0,2                 IF 7607'''ZERO IR2                  $3AF23690
       SXA     CHATY,2             SAVE INDICATION                     $3AF23700
       BES     *-8+NOCHX/NOCHX*8-*                                      3AF23710
       CLA     0,4                 0=7607, 20101=DISK, 20000=HYPER     $3AF23720
       PAC     0,2                 L(FILE) TO IR2                      $3AF23730
       TQP     SELP                SEPARATE SEL+ ENTRY                 $3AF23740
       CLA     CHATY               CHANNEL TYPE                        $3AF23750
       TNZ     MSEL-2              79O9 CHANNEL                        $3AF23760
       BES     *-2+NOCHX/NOCHX*2-*                                      3AF23770
*                  SELECT (-) ENTRY = POST COMPLETION                   3AF23780
       LFT     400000              IF SHORT RECORD                      3AF23790
       TRA     MXMDT               INDICATION IS ON                     3AF23800
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 3AF23810
       SUB     L(1)                THEN SETUP TO EXIT                   3AF23820
       STA     S3                  AT 2,4                               3AF23830
       CLA     1,4                 IF READING                           3AF23840
       TPL     S3                  DISCARD NOISE RECORD                 3AF23850
MXMDT  CLA     1,2                 IF MIXED MODE                        3AF23860
       TMI     MXMOD               PERFORM EXTRA CALCULATIONS           3AF23870
SELM1  TSX     URC1,1              UPDATE REQUEST CHAIN                 3AF23880
       NZT     CHATY                                                   $3AF23890
       TRA     HSEL1               729 OR CARD UNIT                    $3AF23900
       CLA     1,4                                                     $3AF23910
       TZE     *+4                 NO REQUEST CHAIN                    $3AF23920
       PXD     0,0                 PREFIX FOR REINSTRUCT               $3AF23930
       LNT     200000              OR IF EOF                           $3AF23940
       TRA     HSEL1                                                   $3AF23950
       STA     0,4                 ZERO FCB FROM UCW1                  $3AF23960
       CAL     S3                  RESTORE                             $3AF23970
       ADD     L(1)                ADDRESS                             $3AF23980
       STA     S3                  FOR RETURN                          $3AF23990
       BES     *-11+NOHYP/NOHYP*11-*                                   $3AF24000
HSEL1  LDC     COMM,1              RESTORE TO                          $3AF24010
       TQP     POSTR               IF MQ + READ IS DONE                 3AF24020
       SPACE   1                                                        3AF24030
*                        POST WRITE COMPLETION                          3AF24040
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $3AF24050
       PDC     0,4                                                      3AF24060
       CAL     1,4                 RESTORE BUFFER                       3AF24070
       ARS     4                   SIZE TO IORT                         3AF24080
       STD     -1,1                TO IORT                              3AF24090
       TSX     BTP1,1              PLACE BUF IN POOL                    3AF24100
       LNT     200000              DID EOT OCCUR                        3AF24110
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         3AF24120
*                        EOT HANDLE TRAP WRITE                          3AF24130
       AXC     1,4                                                      3AF24140
       CLA*    0,2                                                      3AF24150
       TZE     *+2                                                      3AF24160
       STA     4,2                                                      3AF24170
       CAL     EOTBT                                                    3AF24180
*                         INHIBIT BITS TO FILE                          3AF24190
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $3AF24200
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $3AF24210
       LXA     FCW,1                                                   $3AF24220
INEX2  TXI     *+1,1,**                                                 3AF24230
       TXH     INEX4,1,0                                                3AF24240
       ANS     (IOXSI                                                   3AF24250
INEX4  ANS     1,2                                                      3AF24260
       TRA     S3                                                       3AF24270
       SPACE   1                                                        3AF24280
*                         POST READ COMPLETION                          3AF24290
POSTR  CAL     COMM                                                     3AF24300
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $3AF24310
       PIA                                                              3AF24320
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $3AF24330
       CLA*    4,2                 DOES SYNC CHAIN EXIST                3AF24340
       TZE     PSTR8               NO                                   3AF24350
       PDC     0,1                 SAVE L(END)                          3AF24360
       XCA                         L(BUF) TO AC                         3AF24370
       STA     0,1                 UPDATE                               3AF24380
       LDQ     L(0)D               SYNC CHAIN                           3AF24390
       LGL     18                                                       3AF24400
       STA*    0,1                                                     $3AF24410
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $3AF24420
       LNT     200000         IF NO EOF                                $3AF24430
       TRA     S3                  THEN EXIT                            3AF24440
       SPACE   1                                                        3AF24450
*                        EOF HANDLER TRAP INPUT                         3AF24460
       SXA     PSTR5,4             SAVE L(UCW)                          3AF24470
       LXA     CHATY,1                                                 $3AF24480
       TXH     DEOF1,1,8192                                            $3AF24490
       BES     *-2+NOCH/NOCH*2-*                                        3AF24500
       LDQ     LTPOS               SAVE TAPE POSITION                   3AF24510
       STQ*    COMM                JUST PRIOR TO EOF MARK               3AF24520
PSTR4  NZT     1,4                 IF LAST BUFFER                       3AF24530
       TRA     PSTR6               DO NOTHING                           3AF24540
PSTR2  TSX     URC1,1              DELETE AHEAD                        $3AF24550
       CLA     4,2                 L(POOL) TO IR4                       3AF24560
       PDC     0,4                                                      3AF24570
       TSX     TOPOOL,1            BUFFERS                              3AF24580
PSTR5  AXT     **,4                RESTORE L(UCW)                       3AF24590
       TRA     PSTR4               DELETE ALL                           3AF24600
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              3AF24610
       CAL     NOTIN               WD UCW AND                           3AF24620
       TRA     INEX                GO INHIBIT FILE                      3AF24630
       SPACE   1                                                        3AF24640
*                           START SYNC CHAIN                            3AF24650
PSTR8  XCA                         PUT BUF READ IN AC                  $3AF24660
       STA     4,2                                                      3AF24670
       LDQ     L(0)D                                                    3AF24680
       LGL     18                                                       3AF24690
       STA*    4,2                 L(1) IN BUF CW                      $3AF24700
       TRA     PSTR3                                                    3AF24710
       TTL     SELECT (+) ENTRY                                         3AF24720
*                      SIGN OF UCW WD2 0-RD 1-WR                        3AF24730
*                        INSERTS *+1 INTO IORT                          3AF24740
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   3AF24750
*                   AND INCREMENTS IT IN FILE WORDS                     3AF24760
       SPACE   1                                                        3AF24770
SELP   LDI     1,2                 FILE BITS TO SI                      3AF24780
       CLA     CHATY                                                   $3AF24790
       LBT                         UNIT TYPE TEST                      $3AF24800
       TNZ     HYPL                HYPER                               $3AF24810
       TNZ     DRWRS               DISK                                $3AF24820
       BES     *-4+NOCHX/NOCHX*4-*                                      3AF24830
       LFT     MXDMD               IF MIXED MODE                        3AF24840
       TRA     MXMP                SKIP OUT                             3AF24850
S4     CLA     1,4                 GET ADDRESS OF                       3AF24860
       ACL     L(1)                THE IORT TO BE USED                  3AF24870
       STA*    (RCHXI                                                   3AF24880
       STA     S1+1                                                     3AF24890
S1     ACL     L(1)                                                     3AF24900
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      3AF24910
       CLA     1,2                 FORM SELECT                          3AF24920
       ANA     MODBT               INSERTING TAPE MODE BIT              3AF24930
       TNZ     *+2                                                      3AF24931
       STZ     SYSJOB+2                                                 3AF24932
       ARS     7                                                        3AF24940
       ORA     0,4                                                      3AF24950
RWRS   ARS     18                                                       3AF24960
       STA     SELCT               UNIT ADDRESS TO SELECT               3AF24970
       CLA     S2                                                       3AF24980
       LDQ     1,4                                                      3AF24990
       TQP     *+2                 RDS IN SELECT                        3AF25000
       ALS     15                  WRS IN SELECT                        3AF25010
       STD     SELCT                                                    3AF25020
       ZET*    SYSJOB+1                                                 3AF25021
SELCT  RDS     **                  SEL                                  3AF25030
       XEC*    (RCHXI              RCHX                                 3AF25040
S3     AXT     **,4                                                     3AF25050
       AXT     **,1                                                     3AF25060
       TRA     1,4                 RETURN TO IOEX                       3AF25070
S2     OCT     076200766000        RDS...WRS                            3AF25080
       TTL                         BTP (BUFFER TO POOL) ROUTINE         3AF25090
*              TSX BTP,1                                                3AF25100
       SPACE   1                                                        3AF25110
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           3AF25120
*              MQ                  TSX BTP1,1                           3AF25130
       SPACE   1                                                        3AF25140
BTP1   XCA                         L(BUF. IN USE IN AC                 $3AF25150
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $3AF25160
       STA     0,4                 PUT BUF IN USE BACK                 $3AF25170
       XCA                         BUF FROM CHAIN IN AC                $3AF25180
       STZ*    0,4                 ZERO IN BUF CW                      $3AF25190
       STA*    0,4                 ADDRESS OF CHAIN                    $3AF25200
       TRA     1,1                                                      3AF25210
       SPACE   1                                                        3AF25220
*                      URC (UPDATE REQUEST CHAIN)                       3AF25230
*                       IR4 = -L(UCW) TSX URC1,1                        3AF25240
       SPACE   1                                                        3AF25250
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $3AF25260
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $3AF25270
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $3AF25280
       NZT*    1,4                 LOC OF ZERO                         $3AF25290
       TRA     *+3                                                      3AF25300
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $3AF25310
       TRA     1,1                                                      3AF25320
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $3AF25330
       TRA     1,1                                                      3AF25340
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      3AF25350
*                    IN SEARCHING OUTPUT FILE CHAIN                     3AF25360
       SPACE   1                                                        3AF25370
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              3AF25380
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               3AF25390
       SPACE   1                                                        3AF25400
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      3AF25410
       TSX     EOTOF,1             HANDLE EOT                           3AF25420
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           3AF25430
       TRA     GET0+1              AND IR2 THEN EXIT                    3AF25440
       SPACE   1                                                        3AF25450
*                       EOT HANDLER OUTPUT FILE                         3AF25460
       SPACE   1                                                        3AF25470
*      TSX     EOTOF,1             IR2 = -L(FILE)                       3AF25480
*      RETURN                      INDICES NOT DISTURBED                3AF25490
       SPACE   1                                                        3AF25500
EOTOF  SXA     ETOF5,4             SAVE IR4                             3AF25510
       SXA     ETOF6,1             IR1                                  3AF25520
       TSX     NDSEL+1,4           WEF ON OLD                           3AF25530
       PZE     0,2,WEFOP           FILE                                 3AF25540
       NOP                         IGNORE EOT                           3AF25550
       TSX     SWITCH,1            SWITCH REELS                         3AF25560
       SIL     NOEOT               SET NO EOT CONDITION                 3AF25570
       NZT*    4,2                 IF NO SELECTS TO DO                  3AF25580
       TRA     ETOF5               SKIP OUT                             3AF25590
       CLA     4,2                 SET EOT CHAIN OF SELECTS             3AF25600
       STA     ETOF7               INTO UCW OF                          3AF25610
       CAL     ETOF7               NEW REEL                             3AF25620
       AXC     1,4                                                      3AF25630
       ZET*    0,2                                                      3AF25640
       TRA     *-1                                                      3AF25650
       ORS*    0,2                                                      3AF25660
       CLA     L(0)A               SET EOT CHAIN                        3AF25670
       STA     4,2                 = 0                                  3AF25680
       TSX     ACTV+1,4            ACTIVATE                             3AF25690
       PZE     0,2                 NEW REEL                             3AF25700
ETOF5  AXT     **,4                RESTORE IR4                          3AF25710
ETOF6  AXT     **,1                IR1                                  3AF25720
       TRA     1,1                 EXIT                                 3AF25730
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          3AF25740
       TTL                         REEL SWITCHING ROUTINE               3AF25750
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  3AF25760
*      RETURN                      INDICES NOT DISTURBED                3AF25770
       SPACE   1                                                        3AF25780
*                               ACTIONS                                 3AF25790
*            1. REWINDS UNLOADS OLD REEL                                3AF25800
*            2. SWITCHES TO ALTERNATE UNIT                              3AF25810
*            3. PRINTS MESSAGE TO OPERATOR                              3AF25820
*            4. ADVANCES REEL SEQ. NUMBER                               3AF25830
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  3AF25840
       SPACE   1                                                        3AF25850
SWITCH SXA     SW3,4               SAVE IR4                             3AF25860
       LDQ     5,2                                                     $3AF25870
       RQL     1                   HYPER                               $3AF25880
       TQP     *+9                 NO                                  $3AF25890
       STI     TEMP                                                    $3AF25900
       LDI     1,2                                                     $3AF25910
       LFT     OUTPUT                                                  $3AF25920
       RNT     100000              FILE PROTECT                        $3AF25930
       TRA     *+3                 NO                                  $3AF25940
       TSX     (NDSLX,4                                                $3AF25950
       PZE     0,2,HFPNP                                               $3AF25960
       RFT     200000              UNLOAD                               3AF25970
       TRA     *+4                 NO                                  $3AF25980
       TSX     (NDSLX,4                                                $3AF25990
       PZE     0,2,HUNLP                                               $3AF26000
       TRA     *+3                                                     $3AF26010
       BES     *-15+NOHYP/NOHYP*15-*                                   $3AF26020
       TSX     NDSEL+1,4           REWIND UNLOAD                        3AF26030
       PZE     0,2,RUNOP           OLD REEL                             3AF26040
       TSX     PAUSE,4             PAUSE FOR OPERATOR                   3AF26050
       SIL     NINHIB              UN-INHIBIT FILE                      3AF26060
       LDQ     5,2                                                     $3AF26070
       RQL     1                                                       $3AF26080
       TQP     *+6                                                     $3AF26090
       RNT     100000                                                  $3AF26100
       TRA     *+3                                                     $3AF26110
       TSX     (NDSLX,4                                                $3AF26120
       PZE     0,2,HFPNP                                               $3AF26130
       LDI     TEMP                                                    $3AF26140
       BES     *-8+NOHYP/NOHYP*8-*                                     $3AF26150
SW3    AXT     **,4                RESTORE IR4                          3AF26160
       TRA     1,1                 EXIT                                 3AF26170
*                   ROUTINE TO REVERSE FILE CONTROLS                    3AF26180
*                   SI AND IR2 FROM FILE A TO FILE B                    3AF26190
CPY6   XCA     **                  SAVE AC                              3AF26200
       ENB     L(0)                TRAP PROTECT                         3AF26210
       PIA                         RESTORE CONTROL                      3AF26220
       STD     1,2                 BITS TO FILE                         3AF26230
       LXA     CPY7,1              SWITCH                               3AF26240
       LXA     FCW,2               TO OTHER                             3AF26250
       SXA     FCW,1               FILE                                 3AF26260
       SXA     CPY7,2                                                   3AF26270
       LAC     FCW,2               PLACE 2ND                            3AF26280
       CLA     1,2                 FILES CONTROL                        3AF26290
       ANA     DECRE               BITS IN SI                           3AF26300
       RIL     077777                                                   3AF26310
       OAI                                                              3AF26320
       TXH     *+2,4,-SEL2.4                                           $3AF26330
       ENB     TRAPS               ALLOW TRAPS                          3AF26340
       XCA                         RESTORE AC                           3AF26350
       TRA     1,4                 EXIT                                 3AF26360
       TTL     CONSTANT POOL                                            3AF26370
XCPTP  OCT     077777777777                                            $3AF26380
L(64D) PZE     0,,64                                                    3AF26390
       SPACE   1                                                        3AF26400
*                          TEMPORARY STORAGE                            3AF26410
HOLDS  PZE     *                   CHAIN CELL                           3AF26420
TCHEX  PZE     **                  TCH SWITCH                           3AF26430
TEMP   PZE     **                  ERASEABLE STORAGE                    3AF26440
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             3AF26450
*                               ACTIONS                                 3AF26460
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          3AF26470
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      3AF26480
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                3AF26490
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              3AF26500
*                MODE WILL BE USED AND THE RECORD WILL BE READ          3AF26510
*                WITHOUT REDUNDANCY CHECKING                            3AF26520
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 3AF26530
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             3AF26540
*                            XX XX XX X5 XX XX    BIN   BIN             3AF26550
*                            XX XX XX X1 XX XX    BCD   BIN             3AF26560
*                            XX XX XX X1 XX XX    BIN   BCD             3AF26570
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   3AF26580
*                            XX XX 00 00 00 00    BCD   BCD             3AF26590
*                            00 01 00 05 00 04    BIN   BIN             3AF26600
*                            XX XX 11 11 07 07    BCD   BIN             3AF26610
*                            00 00 00 01 00 00    BIN   BCD             3AF26620
*             5. WRITE MIXED MODE WORKS ............                    3AF26630
MXMOD  CLA     0,4                 MIXED MODE                           3AF26640
       ANA     L(64D)              CARD EQUIPMENT                       3AF26650
       TNZ     CDMXM               CHECKS FOR EOF CARD                  3AF26660
       STI     MX2                 SAVE SI                              3AF26670
       LNT     100000              IF NO REDUNDANCY ANALYZE             3AF26680
       TRA     LKAD                LOOK AHEAD BITS                      3AF26690
       LDI     1,4                 IF CODE 3 THEN                       3AF26700
       LNT     300000              10 TRIES ON FIRST MODE DONE          3AF26710
       TRA     MX1                                                      3AF26720
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         3AF26730
MX0    STZ*    (URRXI              ERROR PRINT                          3AF26740
       STI     1,4                                                      3AF26750
       LDI     1,2                 REVERSE                              3AF26760
       IIL     MODE                MODE OF                              3AF26770
       STI     1,2                 SELECT                               3AF26780
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     3AF26790
       LXA     S3+1,1              RESTORE IR 1                         3AF26800
       LXA     S3,4                RETURN TO                            3AF26810
       TRA     3,4                 EXECUTOR TO RE-TRY                   3AF26820
*                   SECOND AND THIRD MODE TRIES SEL-                    3AF26830
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      3AF26840
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $3AF26850
       IIL     300000              IF SECOND GO TRY AGAIN               3AF26860
       TRA     MX0                 AT FIRST MODE                        3AF26870
MX2    PZE     **                  SI STORAGE                           3AF26880
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   3AF26890
MXMP   LDI     1,4                 IF FIRST TIME                        3AF26900
       LFT     300000              SELECT SET ALTERNATOR                3AF26910
       TRA     MX3                 CODE =3                              3AF26920
       IIL     300000                                                   3AF26930
       STI     1,4                 RESTORE UCW 2ND WORD                 3AF26940
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           3AF26950
       STZ*    (RCTXI              THIRD TRY DISABLE REDUNDANCY         3AF26960
       LDI     1,2                 RESTORE SI                           3AF26970
       TRA     S4                  EXIT                                 3AF26980
       EJECT                                                            3AF26990
*                      INTERROGATE LOOKAHEAD BITS                       3AF27000
1KA    LFT     200000              EOF                                 $3AF27010
       TRA     SELM2+2             NO CHANGE IN MODE                   $3AF27020
       STI     MX2                 SAVE INDICATORS                     $3AF27030
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $3AF27040
       CLA     1,4                                                     $3AF27050
       PAC     0,1                                                     $3AF27060
       CLA     9,1                 LAST COMMAND                        $3AF27070
       ARS     18                                                      $3AF27080
       ADD     9,1                 LAST WORD READ + 1                  $3AF27090
       PAC     0,1                                                     $3AF27100
       TRA     LWRD+1                                                  $3AF27110
       BES     1KA+NOCH/NOCH**-NOCH/NOCH*1KA-*                         $3AF27120
       LDI     MX2                                                     $3AF27130
LKAD   LFT     200000              EOF                                 $3AF27140
       TRA     MX5                 NO CHANGE IN MODE                   $3AF27150
       LDI     1,2                                                     $3AF27160
LWRD   LAC     COMM,1              INTERROGATE                         $3AF27170
       CLA     -1,1                LAST WORD IN BUFFER                  3AF27180
       ANA     MXBB2                                                   $3AF27190
       LNT     MODE                TEST MODE                           $3AF27200
       TZE     MX5                 BCD TO BCD                          $3AF27210
       ANA     DISCON              BIN CHECK BIN'BIN                   $3AF27220
       TNZ     MX5                 BIN TO BIN                          $3AF27230
       IIL     MODE                CHANGE MODE BIT                     $3AF27240
       STI     1,2                 STORE IN FILE BITS                   3AF27250
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     3AF27260
MX5    LDI     MX2                 RESTORE SI FOR SELM                  3AF27270
       LXA     S3+1,1                                                  $3AF27280
       CLA     CHATY                                                   $3AF27290
       LBT                                                             $3AF27300
       TRA     *+2                                                     $3AF27310
       TRA     SELM2+2             DISK SEL-                           $3AF27320
       TNZ     SELM1               HYPER SEL-                          $3AF27330
       CAL     XCPT3               CLEAR READ                          $3AF27340
       ANS     1,4                 MODE SWITCH                         $3AF27350
       TRA     SELM1               POST COMPLETION                      3AF27360
MXBB2  OCT     000000050000                                            $3AF27370
XCPT3  OCT     477777777777                                             3AF27380
       SPACE   1                                                        3AF27390
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      3AF27400
*                     BEING REFERENCED BY THE IOBS                      3AF27410
INVM   SXA     INVM1,1             SAVE IR1                             3AF27420
       CLA     0,4                 IF FILE IS                           3AF27430
       ALS     18                  CURRENTLY BEING                      3AF27440
       STD     *+2                 REFERENCED BY IOBS                   3AF27450
       LAC     FCW,1               THEN MODIFY MODE                     3AF27460
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              3AF27470
       TXH     *+4,1,0             AS STORED BY                         3AF27480
       LDI     (IOXSI              IOEX.......                          3AF27490
       IIL     MODE                                                     3AF27500
       STI     (IOXSI                                                   3AF27510
INVM1  AXT     **,1                RESTORE IR1                          3AF27520
       TRA     1,1                 EXIT                                 3AF27530
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    3AF27540
CDMXM  SXA     CDMX4,4             SAVE IR4                             3AF27550
       CAL     1,4                 FIND L(9L)-2                         3AF27560
       PAC     0,4                 IF BOTH                              3AF27570
       CLA     4,4                 8L AND 7L                            3AF27580
       TPL     CDMX4               ARE                                  3AF27590
       CLA     6,4                 (-) TREAT IT AS                      3AF27600
       TPL     CDMX4               END OF FILE                          3AF27610
       LXD     COMM,4              SET L(IORT)+1                        3AF27620
       SXA     COMM,4              AS LAST WD STORED+1                  3AF27630
       SIL     200000              SET EOF BIT                          3AF27640
CDMX4  AXT     **,4                RESTORE IR4                          3AF27650
       TRA     SELM1               RETURN                               3AF27660
       TTL     BACKSPACE RECORD ROUTINE (BSR)                           3AF27670
*      PZE     FILE,,BOFEX      BOFEX= EXIT AFTER BSR OVER EOF          3AF27680
*                                                                       3AF27690
*      ACTION                                                           3AF27700
*      TSX     BSR,4                                                    3AF27710
*              1. UNBUFFERS FILE                                        3AF27720
*              2. IF TAPE AT FILE X RECORD 0 - BOF EXIT OCCURS          3AF27730
*                                                                       3AF27740
BSR.   LNT     OPEND                   IF FILE NOT OPEN                 3AF27750
       TRA     COMXIT                  TAKE NORMAL EXIT                 3AF27760
       TSX     FNLBC,4                 FIND L(POOL)                     3AF27770
       SIR     INSAT                                                    3AF27780
       LFT     OUTPUT                                                   3AF27790
       TRA     BSC2                    UNBUFFER OUTPUT                  3AF27800
       TSX     UNBFI,4                 UNBUFFER INPUT                   3AF27810
BSC1   LDQ     5,2                     IS THIS HYPER                    3AF27820
       RQL     1                                                        3AF27830
       RIR     200000                                                   3AF27840
       TQP     *+2                     NOT HYPER                        3AF27850
       SIR     200000                  HYPER TAPE                       3AF27860
       RNT     600000                  READ BACKWARD                    3AF27870
       TRA     *+5                     NO                               3AF27880
       TSX     (NDSLX,4                                                 3AF27890
       PZE     0,2,HSKRP               SKIP REC. FORWARD                3AF27900
       CLA     1DEC                                                     3AF27910
       TRA     BSR2                                                     3AF27920
       BES     *-11+NOHYP/NOHYP*11-*                                    3AF27930
       TSX     NDSEL+1,4                                                3AF27940
       PZE     0,2,BSROP               BACKSPACE REC.                   3AF27950
       CLS     1DEC                                                     3AF27960
BSR2   ADM     3,2                     ADJUST BLOCK                     3AF27970
       STD     3,2                     SEQUENCE NUMBER                  3AF27980
       LDQ     5,2                 IS THIS DISK                         3AF27990
       TQP     *+4                 NO                                   3AF28000
       ZET     TEMP                YES, DID EOF GET PASSED              3AF28010
       TRA     BOFEX               YES                                  3AF28020
       TRA     COMXIT              NO                                   3AF28030
       BES     *-5+NOCH/NOCH*5-*                                        3AF28040
       AXC     2,4                     IF BACKED OVER                   3AF28050
       CLA*    0,2                     A FILE MARK                      3AF28060
       ANA     ADDRS               STORE ZERO IN                        3AF28070
       ERA     ADDRS               BLOCK COUNT                          3AF28080
       TNZ     COMXIT              AND GIVE THE                         3AF28090
       STD     3,2                     BEGINNING OF FILE EXIT           3AF28100
       TRA     BOFEX                                                    3AF28110
BSC2   TSX     UNBFO,4                                                  3AF28120
       TRA     BSC1                                                     3AF28130
       END                   END OF FORTRAN IOCS                        3AF28140
$*     7090/7094 IBLIB SYSTEM LIBRARY - .LOVRY                          3AK00000
$IBMAP .LOVRY                                                           3AK00010
       TTL     .LOVRY/LOAD OVERLAY LINKS                            (12)3AK00020
* LOAD OVERLAY LINKS SUBROUTINE - REQUIRED FOR ALL OVERLAY EXECUTIONS.  3AK00030
*                                                                       3AK00040
* PURPOSE-                                                              3AK00050
*    THIS SUBROUTINE WILL LOAD THE REQUIRED LINKS AND RESET ALL THE     3AK00060
*      CALL TRANSFER VECTOR WORDS INVOLVED TO PROPERLY REFLECT THE      3AK00070
*      LOAD STATUS OF THE LINKS.                                        3AK00080
*                                                                       3AK00090
* ENTRY-                                                                3AK00100
*    CALL TRANSFER (.LVEC) WHEN CALLED LINK IS NOT IN CORE.             3AK00110
*                                                                       3AK00120
* TABLES USED-                                                          3AK00130
*    1) LINK DIRECTOR TABLE (.LDT) - ONE WORD ENTRY PER LINK            3AK00140
*    2) LINK RECORD CHAIN (.LRECT) - TWO WORD ENTRY PER LINK BLOCK      3AK00150
*    3) CALL TRANSFER VECTOR TABLE (.LVEC) - TWO WORD ENTRY PER CALL    3AK00160
*                                                                       3AK00170
* THE CONTENTS OF ACCUMULATOR, Q AND P BITS, SENSE INDICATORS, MQ, AND  3AK00180
* ALL INDEX REGISTERS ARE SAVED AND RESTORED UPON EXIT.                 3AK00190
*                                                                       3AK00200
DBLSP  EQU     4                   DOUBLE SPACE                      (4)3AK00205
RUNOP  EQU     4                   REWIND UNLOAD OP                  (4)3AK00206
HYPER  SET     0                   =0 FOR NO HYPERTAPE                  3AK00210
*                                  =1 FOR HYPERTAPE                     3AK00220
DISK   SET     0                   =0 FOR NO DISK                       3AK00230
*                                  =1 FOR DISK                          3AK00240
A7909  SET     0                   SET BY PROGRAM                       3AK00250
       IFT     HYPER=1,OR                                               3AK00260
       IFT     DISK=1                                                   3AK00270
A7909  SET     1                                                        3AK00280
*                                                                       3AK00290
       ENTRY   .LOVRY                                                   3AK00300
       ENTRY   .LDT                ** REMOVE IF NOT SUBR ASSEMBLY **    3AK00310
       ENTRY   .LRECT              ** REMOVE IF NOT SUBR ASSEMBLY **    3AK00320
       ENTRY   .LVEC               ** REMOVE IF NOT SUBR ASSEMBLY **    3AK00330
       EJECT                                                            3AK00340
.LOVRY STQ     MQSTO               SAVE IRS, MQ, ACC, Q, P, SI          3AK00350
       LGR     2                                                        3AK00360
       STQ     QPSTO                                                    3AK00370
       STO     ACCSTO                                                   3AK00380
       STI     INDSTO                                                   3AK00390
       SXA     LK99E,4                                                  3AK00410
       SXA     LK99C,4                                                  3AK00420
       SXA     LK99A,2                                                  3AK00430
       SXA     LK99B,1                                                  3AK00440
       NZT     FSTENT              IS THIS FIRST ENTRY                  3AK00450
       TRA     LK43                  YES - SET UP UNITAB                3AK00460
 LK00  CAL     0,4                                                      3AK00470
       PAX     0,1                                                      3AK00480
       SXD     VECLOC,1            .LVEC LOCATION FROM CALL             3AK00490
       SXA     LK99D,1             SET EXIT LOCATION                    3AK00500
       PAC     0,2                 COMP .LVEC LOCATION FROM CALL        3AK00510
       CLS     0,2                 SET .LVEC ENTRY TO TXL               3AK00520
       TPL     ERROR               ALREADY TXL - ERROR                  3AK00530
       STO     0,2                                                      3AK00540
       PDC     0,1                 COMP LINK NUMBER FROM CALL           3AK00550
       CLA     .LDT,1              .LDT ENTRY FOR PRIMARY LINK          3AK00560
       TMI     LK04                LINK NOT IN CORE - SET FOR LOAD      3AK00570
       PDC     0,2                                                      3AK00580
       TXL     LK03,2,0            FIRST REFERENCE TO IN-CORE LINK      3AK00590
 LK01  CLA     1,2                 CHECK REFERENCE CHAIN                3AK00600
       PDX     0,1                                                      3AK00610
       TXL     LK02,1,0            LAST ENTRY IN CHAIN                  3AK00620
       PDC     0,2                                                      3AK00630
       TRA     LK01                RETURN FOR NEXT ENTRY IN CHAIN       3AK00640
 LK02  CAL     VECLOC                                                   3AK00650
       STD     1,2                 ENTER THIS .LVEC ENTRY IN CHAIN      3AK00660
       TRA     LK99                EXIT                                 3AK00670
 LK03  CAL     VECLOC                                                   3AK00680
       STD     .LDT,1              ENTER THIS .LVEC ENTRY IN .LDT ENTRY 3AK00690
       TRA     LK99                EXIT                                 3AK00700
 LK04  ORA     VECLOC                                                   3AK00710
       PAI                                                              3AK00720
 LK05  RFT     200000              IS UNIT TO BE REWOUND AFTER LOAD     3AK00730
       STL     REWALD                                                   3AK00740
       RIL     400000              SET IN-CORE BIT                      3AK00750
       SIL     200000              SET NEW LINK BIT                     3AK00760
       STI     .LDT,1                                                   3AK00770
       CAL     .LDT,1                                                   3AK00780
       ACL     .LDT,1                                                   3AK00790
       ANA     RECMSK                                                   3AK00800
       TZE     LK08                NO LINK TO LOAD                      3AK00810
       ACL     RECLOC                                                   3AK00820
       STA     LK07                                                     3AK00830
       PAC     0,2                 COMP LOC .LRECT ENTRY                3AK00840
 LK06  CLA     0,2                 FIRST WORD .LRECT ENTRY              3AK00850
       SSM                         SET .LRECT ENTRY FOR LOAD            3AK00860
       STO     0,2                                                      3AK00870
       PAC     0,2                 LOC NEXT .LRECT ENTRY IN CHAIN       3AK00880
       TXH     LK06,2,0            RETURN FOR NEXT ENTRY IN CHAIN       3AK00890
       NZT     REWALD              IS UNIT TO BE REWOUND AFTER LOAD     3AK00900
       TRA     LK08                  NO                                 3AK00910
 LK07  AXC     **,2                                                     3AK00920
       CAL     1,2                                                      3AK00930
       TSX     LK40,2              GET UNITAB ENTRY                     3AK00940
       SSM                                                              3AK00950
       STO     UNITAB,4            SET UNIT FOR REWIND                  3AK00960
       STZ     REWALD              CLEAR FLAG                           3AK00970
 LK08  PIA                                                              3AK00980
       ARS     8                                                        3AK00990
       ANA     PARMSK              FIND PARENT LINK                     3AK01000
       PAC     0,1                                                      3AK01010
       TXH     LK25,1,0            PARENT LINK NOT ZERO                 3AK01020
       LAC     LDTLEN,1            SEARCH .LDT FOR OVERWRITES           3AK01030
       SXD     LK12,1                                                   3AK01040
       AXC     1,1                                                      3AK01050
 LK09  LDI     .LDT,1                                                   3AK01060
       LFT     400000                                                   3AK01070
       TRA     LK11                LINK NOT IN CORE                     3AK01080
       LNT     200000                                                   3AK01090
       TRA     LK23                OVERWRITE THIS LINK                  3AK01100
       RIL     200000                                                   3AK01110
 LK10  STI     .LDT,1                                                   3AK01120
 LK11  TXI     LK12,1,-1                                                3AK01130
 LK12  TXH     LK09,1,**           RETURN FOR NEXT LINK                 3AK01140
       LAC     RECLEN,1            CHECK .LRECT FOR LOADS               3AK01150
       SXD     LK15,1                                                   3AK01160
       AXC     0,1                                                      3AK01170
 LK13  NZT     .LRECT+1,1          IS THIS LAST .LRECT ENTRY            3AK01180
       TRA     LK16                  YES                                3AK01190
       CLS     .LRECT,1            FIRST WORD .LRECT ENTRY              3AK01200
       TPL     LK26                LOAD THIS RECORD                     3AK01210
 LK14  TXI     LK15,1,-2                                                3AK01220
 LK15  TXH     LK13,1,**           RETURN FOR NEXT .LRECT ENTRY         3AK01230
 LK16  AXT     7,1                 CHECK FOR REWINDS                    3AK01240
 LK17  CLA     UNITAB,1                                                 3AK01250
       TPL     LK21                DO NOT REWIND                        3AK01260
       PAI                                                              3AK01270
       SLW     UNITAB,1            RESET FLAG                           3AK01280
       LFT     200000                                                   3AK01290
       TRA     LK21                UNIT IS DISK - SKIP                  3AK01300
       BES     DISK*2-2                                                 3AK01310
       LFT     100000                                                   3AK01320
       TRA     LK22                UNIT IS HYPERTAPE                    3AK01330
       LXA     REWCDE,2            729 REW CODE                         3AK01340
 LK19  SXD     LK20,2                                                   3AK01350
       BES     HYPER*4-4                                                3AK01360
       TSX     .NDSEL,4                                                 3AK01370
 LK20  PZE     UNITAB,1,REWND                                           3AK01380
 LK21  TIX     LK17,1,1            RETURN FOR NEXT UNITAB ENTRY         3AK01390
 LK99  CLA     ACCSTO                                                   3AK01400
       LDQ     QPSTO                                                    3AK01410
       LGL     2                                                        3AK01420
       LDQ     MQSTO                                                    3AK01430
 LK99A AXT     **,2                                                     3AK01440
 LK99B AXT     **,1                                                     3AK01450
 LK99C AXT     **,4                                                     3AK01460
       LDI     INDSTO                                                   3AK01470
 LK99D TRA     **                  ** EXIT **                           3AK01480
 LK22  LXD     REWCDE,2            HYPER REW CODE                       3AK01490
       TRA     LK19                                                     3AK01500
REWCDE PZE     REWND,,HREWND                                            3AK01510
       BES     HYPER*3-3                                                3AK01520
 LK23  SIL     400000                                                   3AK01530
       PIA                                                              3AK01540
       RIL     277777                                                   3AK01550
 LK24  PDC     0,2                 COMP LOC FIRST .LVEC ENTRY           3AK01560
       TXL     LK10,2,0            END OF CHAIN OR NO REFERENCE         3AK01570
       CAL     1,2                                                      3AK01580
       PDX     0,4                                                      3AK01590
       ANA     DECMSK              CLEAR CHAIN WORD                     3AK01600
       SLW     1,2                                                      3AK01610
       CLA     0,2                 SET .LVEC ENTRY TO TXH               3AK01620
       TPL     ERROR               ALREADY TXH - ERROR                  3AK01630
       SLW     0,2                                                      3AK01640
       PXD     0,4                                                      3AK01650
       TRA     LK24                RETURN FOR NEXT ENTRY                3AK01660
 LK25  LDI     .LDT,1              .LDT ENTRY FOR PARENT LINK           3AK01670
       LFT     400000                                                   3AK01680
       TRA     LK05                LOAD THIS LINK                       3AK01690
       SIL     200000              SET AS NEW LINK                      3AK01700
       STI     .LDT,1                                                   3AK01710
       TRA     LK08                GET NEXT LINK                        3AK01720
 LK26  STO     .LRECT,1            RESET LOAD FLAG                      3AK01730
       SXA     LK42,1                                                   3AK01740
       CAL     .LRECT+1,1          SECOND WORD .LRECT ENTRY             3AK01750
       STD     NUMREC              NUMBER OF RECORDS TO BE READ         3AK01760
       STA     FSTREC              FIRST RECORD TO BE READ              3AK01770
       TSX     LK40,2              GET UNITAB ENTRY                     3AK01780
       PDX     0,4                                                      3AK01790
       SXA     UNIT,4                                                   3AK01800
       STA     LK28                L(UCB)                               3AK01810
 LK28  AXC     **,2                -L(UCB) TO IR2                       3AK01820
       PAI                                                              3AK01830
       LFT     200000              IS THIS DISK                         3AK01840
       TRA     LK39                  YES                                3AK01850
       BES     DISK*2-2                                                 3AK01860
       LNT     100000              IS THIS HYPER                        3AK01870
       TRA     LK29                  NO                                 3AK01880
       AXT     3808,1              SET 7909 FLAG                        3AK01890
       TRA     LK30                                                     3AK01900
       BES     HYPER*4-4                                                3AK01910
 LK29  AXT     3975,1              SET 7607 FLAG                        3AK01920
 LK30  CAL     2,2                                                      3AK01930
       ANA     RHWMSK                                                   3AK01940
       LAS     FSTREC              IS TAPE POSITIONED CORRECTLY         3AK01950
       TRA     LK31                  NO - BACKSPACE                     3AK01960
       TRA     LK35                  YES - READ                         3AK01970
       TXL     LK47,1,3808         TEST FOR HYPER.                      3AK01973
       BES     HYPER-1                                                  3AK01975
       CAL     UNIT                                                     3AK01980
       STA     SLCMD1              SET L(UCB) IN CALL                   3AK01990
       CALL    .LXSL1(SLCMD1)                                       (12)3AK02000
       TRA     LK30                TRY AGAIN                            3AK02010
 LK31  TXL     LK34,1,3808         TEST FOR HYPERTAPE                   3AK02020
       LXA     BKSPCD,4            729 BACKSPACE CODE                   3AK02030
 LK32  SXD     LK33,4                                                   3AK02040
       BES     HYPER*3-3                                                3AK02050
       TSX     .NDSEL,4            BACKSPACE ONE RECORD                 3AK02060
 LK33  PZE     LK28,,BKSPR                                              3AK02070
       TRA     LK30                TRY AGAIN                            3AK02080
 LK34  LXD     BKSPCD,4            HYPER BACKSPACE CODE                 3AK02090
       TRA     LK32                                                     3AK02100
BKSPCD PZE     BKSPR,,HBKSPR                                            3AK02110
       BES     HYPER*3-3                                                3AK02120
 LK35  CAL     UNIT                                                     3AK02130
       STA     SLCMD2              SET L(UCB) IN CALL                   3AK02140
LK36   SXA     LK36.1,1            SAVE UNIT CODE                    (4)3AK02141
       LDC     SYSUBC,1            WAIT UNTIL ALL CHANNEL            (4)3AK02142
       TXI     *+1,1,1             ACTIVITY IS COMPLETED             (4)3AK02143
       ZET*    .CHXAC                                                (4)3AK02144
       TRA     *-1                                                   (4)3AK02145
.IORT  TXH     *-3,1,0                                               (4)3AK02146
LK36.1 AXT     **,1                RESTORE CODE                      (4)3AK02147
       ZET*    SYSJOB+1            IF NOT DCS, AND                   (4)3AK02148
       TXH     .SCTR,1,3808        IF 729 TAPE, DO SCATTERLOAD CHECK (4)3AK02149
       CALL    .LXSL1(SLCMD2)                                       (12)3AK02150
       LDI     .LXIND              CHECK FOR ERRORS                     3AK02160
       TXL     LK38,1,3808         TEST FOR 7909                        3AK02170
       BES     A7909-1                                                  3AK02180
       LFT     300000              REDUNDANCY OR EOF                    3AK02190
       TRA     ERROR                                                    3AK02200
 LK37  LXD     NUMREC,4            UPDATE NUMBER TO BE READ             3AK02210
       TXI     *+1,4,-1                                                 3AK02220
       TXL     LK41,4,0            ALL DONE                             3AK02230
       SXD     NUMREC,4                                                 3AK02240
       TXH     LK36,1,705          TEST FOR TAPE                        3AK02250
       CAL     FSTREC                                                   3AK02260
       ACL     LD1                                                      3AK02270
       STD     FSTREC                                                   3AK02280
       STO     .LXDIS                                                   3AK02290
       TRA     LK36                READ NEXT                            3AK02300
       BES     DISK*5-5                                                 3AK02310
 LK38  LFT     001000              IS THIS UNUSUAL END                  3AK02320
       TRA     ERROR                 YES                                3AK02330
       TXH     LK37,1,705          TEST FOR HYPERTAPE                   3AK02340
       BES     HYPER-1                                                  3AK02350
       LDI     .LXFLG                                                   3AK02360
       LFT     200000              IS THIS EOF                          3AK02370
       TRA     ERROR                 YES                                3AK02380
       TRA     LK37                                                     3AK02390
       BES     A7909*6-6                                                3AK02400
 LK39  LAC     SYSUNI,2                                                 3AK02410
 LK39A TXI     *+1,2,**                                              $5$3AK02420
       XEC     UNIT                                                     3AK02430
       AXT     705,1               SET 1301 FLAG                        3AK02440
       ACL     FSTREC                                                   3AK02450
       PAX     0,2                                                      3AK02460
       SXD     FSTREC,2            FIRST RECORD TO BE READ              3AK02470
       PXD     0,2                                                      3AK02480
       SSM                                                              3AK02490
       STO     .LXDIS                                                   3AK02500
       LAC     LK28,2                                                   3AK02510
       TRA     LK35                                                     3AK02520
       BES     DISK*12-12                                               3AK02530
 LK40  ANA     TAGMSK                                                   3AK02540
       ALS     3                                                        3AK02550
       PDX     0,4                 INDEX INTO UNITS TABLE               3AK02560
       TXL     ERROR,4,0           NO UNIT - ERROR                      3AK02570
       CLA     UNITAB,4            UNITAB ENTRY                         3AK02580
       TRA     1,2                 RETURN                               3AK02590
 LK41  STZ     FSTREC              CLEAR FLAGS                          3AK02600
 LK42  AXT     **,1                                                     3AK02610
       TRA     LK14                RETURN FOR NEXT .LRECT ENTRY         3AK02620
 LK43  AXT     7,1                 SET L(UCB) AND UNIT TYPE             3AK02630
 LK44  CAL     UNITAB,1              IN UNITS TABLE                     3AK02640
       PDX     0,2                                                      3AK02650
       SXA     *+2,2                                                    3AK02660
       LAC     SYSUNI,2                                                 3AK02670
       CLA     **,2                                                     3AK02680
       STA     UNITAB,1                                                 3AK02690
       TZE     LK46                NO UNIT ASSIGNED                     3AK02700
       STA     *+1                                                      3AK02710
       AXC     **,2                                                     3AK02720
       LDI     0,2                                                      3AK02730
       BES     A7909*2-2                                                3AK02740
       LNT     020100                                                   3AK02750
       TRA     *+3                                                      3AK02760
       CAL     PTW                 UNIT IS DISK                         3AK02770
       TRA     LK45                                                     3AK02780
       BES     DISK*4-4                                                 3AK02790
       LNT     020000                                                   3AK02800
       TRA     LK46                UNIT IS 729                          3AK02810
       CAL     PON                 UNIT IS HYPERTAPE                    3AK02820
       BES     HYPER*4-4                                                3AK02830
 LK45  STP     UNITAB,1            SET UNIT TYPE                        3AK02840
       BES     A7909-1                                                  3AK02850
 LK46  TIX     LK44,1,1            RETURN                               3AK02860
       STL     FSTENT              SET FIRST ENTRY FLAG                 3AK02870
       LDC     SYSUNI,1            SET NUMBER OF SYSUNI FOR          $5$3AK02872
       SXD     LK39A,1              DISK SECOND TABLE                $5$3AK02874
       BES     DISK*2-2                                              $5$3AK02876
       TRA     LK00                CONTINUE                             3AK02880
 LK47  TSX     .NDSEL,4            SKIP HYPER RECORD.                   3AK02882
       PZE     LK28,,HTSKR                                              3AK02884
       TRA     LK30                                                     3AK02886
       BES     HYPER*3-3                                                3AK02888
ERROR  CALL    .LXSL1(SLCMD3)                                       (12)3AK02890
       STR     ,,.LXSTR                                                 3AK02900
SLCMD1 PON     **,,IOSKP                                                3AK02910
SLCMD2 PON     **,,IORDT                                                3AK02920
SLCMD3 PTW     SYSOU1,,IOERR                                            3AK02930
IOERR  IORT    ERMSG,,15                                                3AK02940
SYTCH. TCH     .LTCH                                                 (4)3AK02950
ERMSG  BCI     9, UNABLE TO INTERPRET OVERLAY COMMUNICATION REGION WHIL 3AK02960
       BCI     6,E LOADING LINK. CANNOT PROCEED.                        3AK02970
IORDT  TCH     SYSSLD                                                   3AK02980
IOSKP  IORTN   0,,0                                                     3AK02990
       TCH     .LTCH                                                    3AK03000
       PZE     ,,SYSCK2            INDEX TABLE FOR SYSUNI               3AK03010
       PZE     ,,SYSCK1                                                 3AK03020
       PZE     ,,SYSLB4                                                 3AK03030
       PZE     ,,SYSLB3                                                 3AK03040
       PZE     ,,SYSLB2                                                 3AK03050
       PZE     ,,SYSUT3                                                 3AK03060
       PZE     ,,SYSUT2                                                 3AK03070
UNITAB BSS     0                                                        3AK03080
NUMREC EQU     VECLOC                                                   3AK03090
FSTREC EQU     REWALD                                                   3AK03100
 UNIT  CLA     **,2                                                     3AK03110
FSTENT PZE                         FIRST ENTRY FLAG                     3AK03120
INDSTO PZE                                                              3AK03130
VECLOC PZE                                                              3AK03140
MQSTO  PZE                                                              3AK03150
ACCSTO PZE                                                              3AK03160
QPSTO  PZE                                                              3AK03170
REWALD PZE                                                              3AK03180
RHWMSK OCT     777777                                                   3AK03190
TAGMSK OCT     700000                                                   3AK03200
PARMSK EQU     RECMSK                                                   3AK03210
DECMSK OCT     700000777777                                             3AK03220
RECMSK OCT     377                                                      3AK03230
RECLEN PZE     .LVEC-.LRECT                                             3AK03240
LDTLEN PZE     .LRECT-.LDT                                              3AK03250
RECLOC PZE     .LRECT-2                                                 3AK03260
LD1    PZE     ,,1                                                      3AK03270
PTW    PTW                                                              3AK03280
       BES     DISK*2-2                                                 3AK03290
PON    PON                                                              3AK03300
       BES     HYPER-1                                                  3AK03310
REWND  EQU     3                                                        3AK03320
BKSPR  EQU     5                                                        3AK03330
HREWND EQU     30                                                       3AK03340
HBKSPR EQU     34                                                       3AK03350
HTSKR  EQU     36                                                       3AK03351
.LDT   BSS     0                   ** REMOVE IF NOT SUBR ASSEMBLY **    3AK03360
.LRECT BSS     0                   ** REMOVE IF NOT SUBR ASSEMBLY **    3AK03370
.LVEC  BSS     0                   ** REMOVE IF NOT SUBR ASSEMBLY **    3AK03380
.SCTR  LDI     0,2                                                   (4)3AK03390
       SIL     000020              SET UP BINARY UNIT ADDRESS        (4)3AK03400
       RIL     760000                                                (4)3AK03700
       PIA                                                           (4)3AK03800
       PDX     ,4                                                    (4)3AK03900
       SXA     .Y40.2,4            INITIALIZE READ SELECT            (4)3AK04000
       SXA     .Y40.9,4            AND BACK SPACE INSTRUCTIONS       (4)3AK04100
       ARS     9                   PICK UP CHANNEL NUMBER            (4)3AK04200
       PDC     ,1                                                    (4)3AK04300
       TXI     *+1,1,1                                               (4)3AK04400
       LDQ*    .TEFX               INITIALIZE TRANSFER ON END OF     (4)3AK04500
       SLQ     .Y40.1              FILE INSTRUCTIONS                 (4)3AK04600
       SLQ     .Y40.7                                                (4)3AK04700
       LDQ*    .RCHX               INITIALIZE RESET AND LOAD         (4)3AK04800
       SLQ     .Y40.3              CHANNEL INSTRUCTIONS              (4)3AK04900
       SLQ     .Y40.8                                                (4)3AK05000
       LDQ*    .TRCX               INITIALIZE REDUNDANCY CHECK       (4)3AK05100
       SLQ     .Y40.4              INSTRUCTIONS                      (4)3AK05200
       SLQ     .Y40.6                                                (4)3AK05300
       LDQ*    .TCOX               INITIALIZE CHANNEL ACTIVITY       (4)3AK05400
       SLQ     .Y40.5              TEST INSTRUCTION                  (4)3AK05500
       CLA     .IORT               RESET FINAL IOCT TO IORT          (4)3AK05600
       STP     .LTCH               FOR LRC CHECKING                  (4)3AK05700
       LXA     LK36.1,1            RESTORE UNIT CODE                 (4)3AK05800
       ENB     =0                  TRAP PROTECT SCATTERLOAD          (4)3AK05900
.Y40.1 ***     *+1        (TEFA *+1 )    TURN OFF EOF INDICATOR      (4)3AK06000
.Y45.1 AXT     10,4                      SET FOR 10 RETRIES          (4)3AK06100
.Y45.2 CLA     SYSSLD                    SET UP DUMMY COMMAND        (4)3AK06200
       STO     SYSTCH                                                (4)3AK06300
.Y40.2 RDS     **                        SELECT UNIT AND START TO    (4)3AK06400
.Y40.3 ***     SYSSLD     ( RCHA SYSSLD ) SCATTERLOAD NEXT REC.      (4)3AK06500
.Y45.3 CLA     SYSTCH                    PICKUP IO COMMAND           (4)3AK06600
       TPL     *+3                       CHECK FOR FINAL TCH         (4)3AK06700
       ANA     .Y45.5              MASK OUT CRITICAL BITS            (4)3AK06900
       TRA     *+2                 GO CHECK FOR SKEW READ (IOCP )    (4)3AK07000
       ERA     SYTCH.              CHECK FOR FINAL TCH COMMAND       (4)3AK07200
       TNZ     .Y40.8              NO GOOD, SKEW READ HAS OCCURRED   (4)3AK07300
.Y40.4 ***     .Y40.8     ( TRCA  .Y40.8 ) KILL CHAN. IF REDUN.      (4)3AK07400
.Y40.5 ***     .Y45.3     ( TCOA  .Y45.3 ) CONTINUE IF ACTIVE        (4)3AK07500
.Y40.6 ***     .Y40.9     ( TRCA  .Y40.9 ) CHECK LRC CHARACTER       (4)3AK07600
.Y40.7 ***     .Y40.9     ( TEFA  .Y40.9 ) BAD EOF ERROR             (4)3AK07700
       CAL     .IOCT               RESTORE  .LTCH                    (4)3AK07800
       STP     .LTCH                                                 (4)3AK07900
       CAL     2,2                 UPDATE RECORD COUNT               (4)3AK07910
       ACL     =1                                                    (4)3AK07920
       STA     2,2                                                   (4)3AK07930
       TRA     LK37                GO CHECK FOR NEXT RECORD          (4)3AK08000
.Y40.8 ***     .LTCH     ( RCHA  .LTCH )  RESET CHAN. ACTIVITY       (4)3AK08100
.Y40.9 BSR     **                         BACKSPACE FOR RETRY        (4)3AK08200
       TIX     .Y45.2,4,1          RETRY IF NOT THE TENTH TIME       (4)3AK08300
       TSX     .NDSEL,4            YES, UNLOAD OFFENDING TAPE        (4)3AK08400
       PZE     LK28,,RUNOP                                           (4)3AK08500
       LDQ     0,2                 PICK UP ACTUAL ADDRESS            (4)3AK08700
       TSX     .SYMUN,4            AND CONVERT TO BCD                (4)3AK08800
       SLW     SCTR1+7                                               (4)3AK08900
       TSX     .MWR,4              PRINT MESSAGE ON LINE             (4)3AK09000
       PZE     1                                                     (4)3AK09100
       PZE     SCTR1,,12+512*DBLSP                                   (4)3AK09200
       TSX     .PAUSE,4            OPERATOR ACTION PAUSE             (4)3AK09300
       CAL     .IOCT               RESTORE FINAL .LTCH               (4)3AK09400
       STP     .LTCH                                                 (4)3AK09500
       TRA     .LXERR              RETURN TO IBSYS                   (4)3AK09600
.IOCT  IOCT    0,,0                                                  (4)3AK09700
SCTR1  BCI     8,SCATTERLOAD FAILURE LOADING LINK. REPLACE  XX       (4)3AK09800
       BCI     4,, USE $RESTART OPTION.                              (4)3AK09900
.Y45.5 OCT     377000700000        SKEW MASK                         (4)3AK10000
LK99E  NULL                                                          (4)3AK10050
       END                                                           (4)3AK10100
$*     7090/7094 IBLIB SYSTEM LIBRARY - .LXSL                           3AL00000
$IBMAP .LXSL                                                            3AL00010
       TTL     .LXSL/OBJECT TIME READ-WRITE SELECT ROUTINE          (14)3AL00020
* OBJECT TIME READ/WRITE SELECT ROUTINE                                 3AL00030
*                                                                       3AL00040
* PURPOSE-                                                              3AL00050
*    THIS ROUTINE WILL READ OR WRITE A SPECIFIED UNIT                   3AL00060
*      (729,7340,1301)IN BCD OR BINARY USING IOEX                       3AL00070
*                                                                       3AL00080
* ENTRY-                                                                3AL00090
*    CALL    .LXSEL(L)                                                  3AL00100
*                                                                       3AL00110
* INPUT-                                                                3AL00120
*    1) L= LOC OF CONTROL WORD OF THE FORMAT-                           3AL00130
*              PFX     U,,S                                             3AL00140
*       WHERE  PFX=PZE  READ BCD                                        3AL00150
*                 =PON  READ BINARY                                     3AL00160
*                 =PTW  WRITE BCD                                       3AL00170
*                 =PTH  WRITE BINARY                                    3AL00180
*              U  =SYSUNI INDEX                                         3AL00190
*              S  =LOC OF I/O COMMAND SEQUENCE                          3AL00200
*    2) LAST COMMAND OF I/O SEQUENCE AS  TCH .LTCH                      3AL00210
*                                                                       3AL00220
* OUTPUT-                                                               3AL00230
*    1) CONTENTS OF INDICATORS UPON ENTRY TO SEL- IN CELL .LXIND        3AL00240
*    2) FLAGWORD READ FROM DISK IN CELL .LXFLG                          3AL00250
*                                                                       3AL00260
HYPER  SET     0                   =0 FOR NO HYPERTAPE                  3AL00270
*                                  =1 FOR HYPERTAPE                     3AL00280
DISK   SET     0                   =0 FOR NO DISK                       3AL00290
*                                  =1 FOR DISK                          3AL00300
A7909  SET     0                   SET BY PROGRAM                       3AL00310
*                                                                       3AL00320
       IFT     HYPER=1,OR                                               3AL00330
       IFT     DISK=1                                                   3AL00340
A7909  SET     1                                                        3AL00350
*                                                                       3AL00360
       ENTRY   .LXIND                                                   3AL00380
       ENTRY   .LTCH                                                    3AL00390
       ENTRY   .LXFLG                                                   3AL00400
       ENTRY   .LXDIS                                                   3AL00410
       ENTRY   .LXTST                                                $5$3AL00412
       ENTRY   .LXOVL                                                $5$3AL00413
       ENTRY   .LXSL1                                               (10)3AL00414
       ENTRY   .LXSEL                                                (2)3AL00415
       ENTRY   .LXMOD              IF NE 0, SWITCH MODES ON RED. RD.(10)3AL00416
       EJECT                                                            3AL00420
       USE                                                              3AL00430
.LXSEL SXA     SYSLOC,4                                              (2)3AL00431
.LXSL1 SXA     LNKG,4                                               (10)3AL00433
       SXA     SV2,2                                                 (2)3AL00435
       STI     SVIND                                                 (2)3AL00440
*           ALTERNATE I/O FORTRAN SYSTEM OVERLAYS THE FOLLOWING      $5$3AL00441
*              CELL DURING OUTPUT TRANSMISSION -- TSX ..FREQ,2       $5$3AL00442
.LXTST NOP                                                           $5$3AL00443
       STZ     WRFLG               PRESET I/O                        $5$3AL00444
       STZ     BIFLG                CONTROL                          $5$3AL00445
       STZ     NIFLG                 LOGIC                           $5$3AL00446
       BES     A7909-1               FLAGS                           $5$3AL00447
       STZ     PFLG                  *                               $5$3AL00448
       BES     DISK-1                *                               $5$3AL00449
       LDI*    3,4                 CONTROL PARAMETER                    3AL00450
       PIA                                                              3AL00460
       PAC     0,2                                                   $5$3AL00461
       TXI     *+1,2,SYSOU1                                          $5$3AL00463
       TXH     *+2,2,0             CLEAR BUFFERS IF SYSOU1           $5$3AL00465
       XEC     .DFOUT                                                $5$3AL00467
       PIA                                                           $5$3AL00469
       PDX     0,4                 LOC OF I/O SEQUENCE                  3AL00470
       STA     SL01                SYSUNI INDEX                         3AL00480
       LAC     SYSUNI,2                                                 3AL00490
 SL01  CAL     **,2                                                     3AL00500
       STA     SL03                L(UCW)                               3AL00510
       STD     SMSCMD              STORE HA2                        (14)3AL00515
       LXA     SL01,2              CHECK FOR PERIPHERAL                 3AL00520
       TXH     SL02,2,12                                                3AL00530
       TXL     SL02,2,3                                                 3AL00540
       STL     PFLG                                                     3AL00550
       BES     DISK*5-5                                             (14)3AL00560
 SL02  LFT     200000              CHECK MODES                          3AL00570
       STL     WRFLG               WRITE                                3AL00580
       LFT     100000                                                   3AL00590
       STL     BIFLG               BINARY                               3AL00600
 SL03  AXC     **,2                -L(UCW) TO IR2                       3AL00610
       ZET     1,2                 DELAY UNTIL DORMANT                  3AL00620
       TRA     *-1                                                      3AL00630
       LDI     0,2                 UNIT CONTROL WORD                    3AL00640
       LFT     020000              DATA CHANNEL TYPE                    3AL00650
       TRA     SL20                  7909                               3AL00660
       SXA     TNSB,4                7607                               3AL00670
       CLA     TNSA                                                     3AL00680
       ZET     WRFLG                                                    3AL00683
       SSM                                                              3AL00687
*              ** CALL TO ACTION                                        3AL00690
SL04   STO     1,2            SET SELECT WORD                           3AL00700
       TSX     .ACTV,4                                                  3AL00710
       MZE     SL03                                                     3AL00720
*           ALTERNATE I/O FORTRAN SYSTEM OVERLAYS THE FOLLOWING      $5$3AL00721
*              CELL DURING OUTPUT TRANSMISSION -- TRA .LXOVL+3       $5$3AL00722
.LXOVL NOP                                                           $5$3AL00723
       ZET     1,2                 DELAY TILL DONE  MUST FOLLOW NOP  $5$3AL00730
       TRA     *-1                  *               MUST FOLLOW ZET  $5$3AL00740
*              THE PRIOR SEQUENCE OF INSTRUCTIONS (NOP,ZET,TRA) MUST $5$3AL00741
*               BE IN ORDER - REQUIRED BY FORTRAN ALT. I/O SYSTEM    $5$3AL00742
       LDI     SVIND                                                 (2)3AL00810
SV2    AXT     **,2                                                  (2)3AL00811
       LXA     LNKG,4                                                (2)3AL00813
       TRA     1,4                                                   (2)3AL00815
*              ** MULTIPURPOSE SELECT ROUTINE                           3AL00820
 SL10  PAC     0,2                 -L(UCB) TO IR2                       3AL00830
       TMI     SL13                CHECK SEL (+) OR (-)                 3AL00840
       CAL     1,2                   (+)                                3AL00850
       STA*    .RCHX               FORM RCHX                            3AL00860
       ZET     NIFLG               IS THIS 7909                         3AL00870
       TRA     SL12                  YES                                3AL00880
       BES     A7909*2-2                                                3AL00890
       CAL     0,2                 FORM UNIT ADDRESS                    3AL00900
       ARS     18                                                       3AL00910
       NZT     BIFLG               CHECK MODE.                          3AL00911
       STZ     SYSJOB+2            BCD. RESET MODSW.                    3AL00912
       ZET     BIFLG               CHECK MODE                           3AL00920
       ORA     BINBIT                BINARY                             3AL00930
       NZT     .LXMOD              IF .LXMOD ZERO, ONE MODE READ    (10)3AL00931
       TRA     SL10.1                                               (10)3AL00932
       LDI*    .URRX               CONTAINS RETRY COUNT (INIT. 0)   (10)3AL00933
       RFT     000001              INVERT MODE OF READ              (10)3AL00934
       ERA     BINBIT              AT EVERY ODD-NUMBERED ATTEMPT,   (10)3AL00935
       STA     .LXMOD              AND SAVE TAPE ADDRESS USED       (10)3AL00936
SL10.1 ZET     WRFLG               CHECK OPERATION                  (10)3AL00940
       TRA     SL11                  WRITE                              3AL00950
       STA     *+2                   READ                               3AL00960
       ZET*    SYSJOB+1              SKIP SELECT IF DCS.                3AL00961
       RDS     **                  READ SELECT                          3AL00970
       TRA     SL12                                                     3AL00980
SL11   STA     *+2                   WRITE SELECT                       3AL00990
       ZET*    SYSJOB+1              SKIP SELCT IF DCS.                 3AL00991
       WRS     **                  WRITE SELECT                         3AL01000
 SL12  XEC*    .RCHX                                                    3AL01010
       TRA     1,4                 BACK TO IOEX                         3AL01020
.LXMOD PZE     **                                                   (10)3AL01025
*              IF .LXMOD IS NON-ZERO ON ENTRY TO .LXSL, THE         (10)3AL01026
*              SELECT(+) ROUTINE WILL SWITCH MODES EVERY OTHER TIME (10)3AL01027
*              ON A READ ERROR.  AFTER THE SELECT, THE ADDRESS      (10)3AL01028
*              OF .LXMOD WILL CONTAIN THE LAST TAPE ADDRESS USED.   (10)3AL01029
*              .LXMOD MUST BE RESET TO ZERO BY THE USER IF MODE     (10)3AL0102A
*              SWITCHING IS NO LONGER WANTED.                       (10)3AL0102B
 SL13  STZ     1,2                   (-)                                3AL01030
       STI     .LXIND              SAVE INDICATORS                      3AL01040
       TRA     1,4                 BACK TO IOEX                         3AL01050
*              ** TRANSFER POINTS                                       3AL01060
 SL20  TRA     SL90                                                     3AL01070
 SL30  TRA     SL90                                                     3AL01080
 SL40  TRA     SL90                                                     3AL01090
       EJECT                                                            3AL01100
*              ** 7909 PROCESSING PACKAGE **                            3AL01110
       USE     A                                                        3AL01120
       ORG     SL20                                                     3AL01130
       IFT     A7909=1                                                  3AL01140
       TRA     SL21                                                     3AL01150
       USE                                                              3AL01160
SL21   STL     NIFLG               7909                                 3AL01170
       CAL     SMSCMD                                                   3AL01180
       ARS     6                   POSITION AC                      (14)3AL01185
       LFT     000040              CHECK INTERFACE                      3AL01190
       ORA     LOCONE                INTERFACE 2                        3AL01200
       NZT     BIFLG               CHECK MODE                           3AL01210
       ORA     BINBIT                BCD                                3AL01220
       LFT     000100              COMPONENT TYPE                       3AL01230
       TRA     SL40                  DISK                               3AL01240
       TRA     SL30                  HYPERTAPE                          3AL01250
       BES     A7909*10-10                                          (14)3AL01260
       EJECT                                                            3AL01270
*              ** HYPERTAPE PROCESSING PACKAGE                          3AL01280
       USE     A                                                        3AL01290
       ORG     SL30                                                     3AL01300
       IFT     HYPER=1                                                  3AL01310
       TRA     SL31                                                     3AL01320
       USE                                                              3AL01330
 SL31  SXA     HTSD,4              I/O COMMAND LIST                     3AL01340
       SLW     HTSMS               SET SMS COMMAND                      3AL01350
       RIS     HYPRES              PUT UNIT NUMBER INTO                 3AL01360
       CAL     HYPSEL               HYPER SELECT WORD                   3AL01370
       ANA     HYPRES                                                   3AL01380
       OAI                                                              3AL01390
       STI     HYPSEL                                                   3AL01400
       AXT     0,4                                                      3AL01410
       NZT     WRFLG               CHECK OPERATION                      3AL01420
       TXI     *+1,4,-1              READ                               3AL01430
       CLA     HTSA,4                                                   3AL01440
       TRA     SL04                GO TO ACTION CALL                    3AL01450
       BES     HYPER*12-12                                              3AL01460
       EJECT                                                            3AL01470
*              ** DISK PROCESSING PACKAGE                               3AL01480
       USE     A                                                        3AL01490
       ORG     SL40                                                     3AL01500
       IFT     DISK=1                                                   3AL01510
       TRA     SL41                                                     3AL01520
       USE                                                              3AL01530
 SL41  ZET     PFLG                IS THIS PERIPHERAL                   3AL01540
       TRA     SL92                  YES - ERROR                        3AL01550
       SLW     DISSMS                                                   3AL01560
       SXA     DISD,4              I/O COMMAND LIST                     3AL01570
       CAL     .LXDIS                                                   3AL01580
       PAI                                                              3AL01590
       PDX     0,4                                                      3AL01600
       LFT     400000              IS SEEK REQUESTED                    3AL01610
       TRA     SL42                  YES                                3AL01620
       PXA     0,4                                                      3AL01630
       LRS     35                                                       3AL01640
       DVP     LOC4TY              IS SEEK REQUIRED                     3AL01650
       TNZ     SL43                  NO                                 3AL01660
 SL42  PXA     0,4                 PERFORM SEEK                         3AL01670
       STA     3,2                                                      3AL01680
       CLS     2,2                                                      3AL01690
       STO     2,2                                                      3AL01700
       BES     DISK*17-17                                               3AL01710
       TSX     .ACTV,4                                                  3AL01720
       PZE     SL03                                                     3AL01730
 SL43  CAL     .LXDIS              FORM DISK ORDER                      3AL01740
       TSX     .DECVD,4            CONVERT DECR TO BCD                  3AL01750
       LAC     SL03,4              -L(UCW) TO IR4                       3AL01760
       TSX     .FDAMT,2                                                 3AL01770
DISSMS PZE     **                    HA2                                3AL01780
       PZE     DISORD                L(ORDER TO BE COMPOSED)            3AL01790
       LAC     SL03,2                                                   3AL01800
       AXT     0,4                                                      3AL01810
       NZT     WRFLG               CHECK OPERATION                      3AL01820
       TXI     *+1,4,-1              READ                               3AL01830
       CLA     DISA,4                                                   3AL01840
       STZ     .LXDIS                                                   3AL01850
       TRA     SL04                GO TO ACTION CALL                    3AL01860
       BES     DISK*15-15                                               3AL01870
       EJECT                                                            3AL01880
*              ** ERROR ROUTINES                                        3AL01890
 SL90  TSX     .MWR,4                                                   3AL01900
       PZE     1                                                        3AL01910
       PZE     SL91,,8                                                  3AL01920
       TRA     .LXSTP                                                   3AL01930
 SL91  BCI     8, .LXSEL FOR UNIT REQUESTED IS NOT IN LIBRARY.          3AL01940
       BES     -12*HYPER*DISK                                           3AL01950
 SL92  TSX     .MWR,4                                                   3AL01960
       PZE     1                                                        3AL01970
       PZE     SL93,,9                                                  3AL01980
       TRA     .LXSTP                                                   3AL01990
       BES     DISK*4-4                                                 3AL02000
 SL93  BCI     9, SYSOU, SYSIN, OR SYSPP CANNOT BE ASSIGNED TO DISK     3AL02010
       BES     DISK*9-9                                                 3AL02020
*              ** CONSTANTS MASKS AND STORAGES                          3AL02030
*              BIFLG, .LXIND, AND WRFLG MUST BE CONSECUTIVE          $5$3AL02031
BIFLG  PZE                         EQ 0 BCD   NEQ 0 BINARY              3AL02040
.LXIND PZE                         INDICATOR STORAGE                    3AL02050
WRFLG  PZE                         EQ 0 READ  NEQ 0 WRITE               3AL02060
*              BIFLG, .LXIND, AND WRFLG MUST BE CONSECUTIVE AND      $5$3AL02061
*                IN THIS ORDER - REQUIRED BY FORTRAN ALT. I/O SYSTEM $5$3AL02062
BINBIT OCT     000000000020        BINARY 729 - BCD HYPER MODE          3AL02070
NIFLG  PZE                         EQ 0 7607  NEQ 0 7909                3AL02080
LOCONE OCT     000000000001        ONE                                  3AL02090
SMSCMD OCT     600                 SMS SETTING 00 HA2               (14)3AL02100
       BES     A7909*3-3                                                3AL02110
HTSMS  PZE                         HYPER SMS COMMAND                    3AL02120
HYPRES OCT     777760777777        UNIT RESET MASK                      3AL02130
HYPSEL OCT     120600120112        HYPER SELECT COMMAND                 3AL02140
       BES     HYPER*3-3                                                3AL02150
.LXDIS PZE                                                              3AL02160
.LXFLG PZE                         DISK FLAG WORD                       3AL02170
LOC4TY OCT     000000000050        FORTY                                3AL02180
DISORD DVTA    ,,,                 DISK ORDER                           3AL02190
PFLG   PZE                                                              3AL02200
       BES     DISK*4-4                                                 3AL02210
*              ** SELECT COMMANDS                                       3AL02220
.LTCH  CPYD    0,,0                TRAP SEQUENCE                        3AL02230
       TCH     SYSTWT                                                   3AL02240
       BES     A7909-1                                                  3AL02250
HTSA   FOR     HTSB,,SL10          HYPER                                3AL02260
       PZE     HTSC,,SL10                                               3AL02270
HTSB   SMS*    HTSMS                                                    3AL02280
       CTLW    HYPSEL                                                   3AL02290
       BES     HYPER*4-4                                                3AL02300
       TCH     HTSD                                                     3AL02310
HTSC   SMS*    HTSMS                                                    3AL02320
       BES     HYPER*2-2                                                3AL02330
       CTLR    HYPSEL                                                   3AL02340
HTSD   TCH     **                                                       3AL02350
       BES     HYPER*2-2                                                3AL02360
DISA   FOR     DISB,,SL10     DISK                                      3AL02370
       PZE     DISC,,SL10                                               3AL02380
       BES     DISK*2-2                                                 3AL02390
DISB   SMS*    DISSMS                                                   3AL02400
       CTLW    DISORD                                                   3AL02410
       TCH     DISD                                                     3AL02420
       BES     DISK*3-3                                                 3AL02430
DISC   SMS*    DISSMS                                                   3AL02440
       CTLR    DISORD                                                   3AL02450
       BES     DISK*2-2                                                 3AL02460
       CPYP    .LXFLG,,1                                                3AL02470
DISD   TCH     **                                                       3AL02480
       BES     DISK*2-2                                                 3AL02490
TNSA   PZE     TNSB,,SL10          729                                  3AL02500
TNSB   TCH     **                                                       3AL02510
SVIND  PZE     **                                                    (2)3AL02511
LNKG   LDIR                                                          (2)3AL02513
       END                                                              3AL02520
$*     7090/7094 IBLIB FORTRAN SYSTEM LIBRARY - FFPT                    3AM00000
$IBMAP .FPTRP  150,()OK                                                 3AM00010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3AM00011
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3AM00012
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3AM00013
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3AM00014
M9094  SET     90                                                       3AM00015
       PCC     ON                                                       3AM00016
       IFF     M9094=90                                                 3AM00017
       GOTO    BEG94                                                    3AM00018
       PCC     OFF                                                      3AM00019
       TTL     .FPTRP - FLOATING POINT TRAP ROUTINE                     3AM00020
       ENTRY   .FFPT.                                                   3AM00030
       ENTRY   OVFLOW                                                   3AM00040
       ENTRY   .FPARG                                                   3AM00050
       ENTRY   .FPOUT                                                   3AM00060
.FFPT. TXI     *+6,0,0                                                  3AM00070
       AXT     **,1                                                     3AM00080
       AXT     **,4                                                     3AM00090
       LDI     *+2                                                      3AM00100
       TRA     **                                                       3AM00110
       PZE                                                              3AM00120
       STI     *-1                                                      3AM00130
       SXA     *-5,4                                                    3AM00140
       SXA     *-7,1                                                    3AM00150
       LXA     0,4                                                      3AM00160
       SXA     *-6,4                                                    3AM00170
       STO     SAC                                                      3AM00180
       STQ     SMQ                                                      3AM00190
       CLA     0                                                        3AM00200
       ORS     OVFLOW         SAVE INDICATORS                        $5$3AM00210
       PAI                                                              3AM00220
       PAX     ,1             COMPUTE ADDRESS OF TRAP.                  3AM00230
       TXI     *+1,1,-1                                                 3AM00240
       PXA     ,1             CONVERT BINARY TO OCTAL                   3AM00250
       LGR     15                                                       3AM00260
       CLA     BLNK                                                     3AM00270
       TOV     *+1                                                      3AM00280
       ALS     3                                                        3AM00290
       LGL     3                                                        3AM00300
       TNO     *-2                                                      3AM00310
       LFT     40             ODD ADDRESS.                              3AM00320
       TRA     ODD            YES.                                      3AM00330
       LFT     4              OVERFLOW.                                 3AM00340
       TRA     OVR            YES                                       3AM00350
       LFT     2              AC UNDERFLOW AND AC AND MQ UNDERFLOW      3AM00360
       TRA     ACUN                                                     3AM00370
       SLW     UM+2                                                     3AM00380
       CLA     UMC                                                      3AM00390
       TSX     OUT,1                                                    3AM00400
 MQUF  CAL     L(10)                                                    3AM00410
       ANS     SMQ                                                      3AM00420
       LDQ     SMQ                                                      3AM00430
       CLA     SAC                                                      3AM00440
       TRA     .FFPT.+1                                                 3AM00450
ACUN   SLW     UAM+2                                                    3AM00460
       LFT     1                                                        3AM00470
       TRA     ACMQU          YES                                       3AM00480
ACU    CLA     UAC                                                      3AM00490
       TSX     OUT,1                                                    3AM00500
       TRA     ACZ                                                      3AM00510
ACMQU  CLA     UAMC                                                     3AM00520
       TSX     OUT,1                                                    3AM00530
 MQZ   CAL     L(10)                                                    3AM00540
       ANS     SMQ                                                      3AM00550
ACZ    LDQ     SMQ                                                      3AM00560
       CLA     SAC                                                      3AM00570
       CLM                                                              3AM00580
       TRA     .FFPT.+1                                                 3AM00590
OVR    LFT     2              AC OVERFLOW AND AC AND MQ OVERFLOW.       3AM00600
       TRA     ACOV                                                     3AM00610
MQO    SLW     OM+2                                                     3AM00620
       CLA     OMC                                                      3AM00630
       TSX     OUT,1                                                    3AM00640
 MQOV  CAL     L(1)                                                     3AM00650
       ORS     SMQ                                                      3AM00660
       LDQ     SMQ                                                      3AM00670
       CLA     SAC                                                      3AM00680
       TRA     .FFPT.+1                                                 3AM00690
ACOV   SLW     OAM+2                                                    3AM00700
       LFT     1                                                        3AM00710
       TRA     ACMQO          YES                                       3AM00720
ACO    CLA     OAC                                                      3AM00730
       TSX     OUT,1                                                    3AM00740
       TRA     ACON                                                     3AM00750
ACMQO  CLA     OAMC                                                     3AM00760
       TSX     OUT,1                                                    3AM00770
 MQON  CAL     L(1)                                                     3AM00780
       ORS     SMQ                                                      3AM00790
ACON   LDQ     SMQ                                                      3AM00800
       CLA     SAC                                                      3AM00810
       ORA     L(1)                                                     3AM00820
       TRA     .FFPT.+1                                                 3AM00830
ODD    SLW     OD+2                                                     3AM00840
       CLA     ODC                                                      3AM00850
       TSX     OUT,1                                                    3AM00860
ODD1   LDQ     SMQ            RESTORE MQ                                3AM00870
       CLA     SAC            RESTORE AC                                3AM00880
       TRA     .FFPT.+1                                                 3AM00890
OUT    STO     .FPARG         SET UP ARGUMENT FOR OUTPUT ROUTINE.       3AM00900
       LXA     COUNT,4        TEST WHETHER MAXIMUM MESSAGE COUNT        3AM00910
       TNX     RTN,4,1        HAS BEEN EXCEEDED.                        3AM00920
       SXA     COUNT,4        SAVE DECREMENTED COUNT.                   3AM00930
.FPOUT CALL    .LXSL1(ARG)         WRITE MESSAGE.  CALL OVERLAID    (10)3AM00940
       REM                    IF FOUT IS LOADED FOR PROGRAM.            3AM00950
RTN    TRA     1,1                                                      3AM00960
ARG    PTW     SYSOU1,,.FPARG                                           3AM00970
.FPARG IOCP    **,,**                                                   3AM00980
       TCH     .LTCH                                                    3AM00990
.COUNT CONTRL  COUNT,UAM      MAXIMUM NUMBER OF TIMES .FPTRP            3AM01000
COUNT  DEC     6              WILL WRITE MESSAGES PER EXECUTION.        3AM01010
UAM    BCI     6,0UNDRFLOW AT       IN AC AND MQ.                       3AM01020
UM     BCI     4,0UNDRFLOW AT       IN MQ                               3AM01030
OAM    BCI     6,0OVERFLOW AT       IN AC AND MQ.                       3AM01040
OM     BCI     4,0OVERFLOW AT       IN MQ                               3AM01050
OD     BCI     4,0ADDRESS AT        ODD.                                3AM01060
UAC    IOCP    UAM,,4                                                   3AM01070
UAMC   IOCP    UAM,,6                                                   3AM01080
UMC    IOCP    UM,,4                                                    3AM01090
OAC    IOCP    OAM,,4                                                   3AM01100
OAMC   IOCP    OAM,,6                                                   3AM01110
OMC    IOCP    OM,,4                                                    3AM01120
ODC    IOCP    OD,,4                                                    3AM01130
 BLNK  OCT     000000000060                                             3AM01140
 L(1)  PTH     -1,7,-1                                                  3AM01150
 L(10) FOR                                                              3AM01160
 L(11) SVN     -1,7,-1                                                  3AM01170
OVFLOW PZE     0                                                        3AM01180
 SMQ   PZE     **                                                       3AM01190
 SAC   PZE     **                                                       3AM01200
LNKG   LDIR                                                             3AM01210
       ORG     8                                                        3AM01220
       TTR     .FFPT.                                                   3AM01230
BEG94  NULL                                                             3AM50000
       PCC     ON                                                       3AM50010
       IFT     M9094=90                                                 3AM50020
       GOTO    END94                                                    3AM50030
       PCC     OFF                                                      3AM50040
       REM     7094 MODE FLOATING POINT TRAP SUBROUTINE.  RETURNS DIRECT3AM50050
       REM     LY TO USER IF MQ UNDERFLOW RESULTED FROM DOUBLE PRECISION3AM50060
       ENTRY   .FFPT.                                                   3AM50070
       ENTRY   OVFLOW                                                   3AM50080
       ENTRY   .FPARG                                                   3AM50090
       ENTRY   .FPOUT                                                   3AM50100
.FFPT. TXI     *+6,0,0                                                  3AM50110
       AXT     **,1                                                     3AM50120
       AXT     **,4                                                     3AM50130
       LDI     *+2                                                      3AM50140
  FXIT TRA     **             EXIT BACK TO MAIN PROGRAM                 3AM50150
       PZE                                                              3AM50160
       STI     *-1                                                      3AM50170
       SXA     *-5,4                                                    3AM50180
       SXA     *-7,1                                                    3AM50190
       STO     SAC                                                      3AM50200
       STQ     SMQ                                                      3AM50210
       CLA     0                                                        3AM50220
       STA     FXIT           SAVE RETURN ADDRESS                       3AM50230
       ORS     OVFLOW         SAVE INDICATORS                           3AM50240
       PAI                                                              3AM50250
       PAC     ,1             COMPUTE ADDRESS OF TRAP                   3AM50260
       TXI     *+1,1,1        SAVE THE COMPLEMENT FOR UNDERFLOW USAGE.  3AM50270
       PCA     ,1             NOW CONVERT THE ADDRESS TO BCD FOR MESSAGE3AM50280
       LGR     15                                                       3AM50290
       CLA     BLNK                                                     3AM50300
       TOV     *+1                                                      3AM50310
       ALS     3                                                        3AM50320
       LGL     3                                                        3AM50330
       TNO     *-2                                                      3AM50340
       LFT     40             ODD ADDRESS.                              3AM50350
       TRA     ODD            YES.                                      3AM50360
       LFT     4              OVERFLOW.                                 3AM50370
       TRA     OVR            YES                                       3AM50380
       LFT     2              AC UNDERFLOW AND AC AND MQ UNDERFLOW      3AM50390
       TRA     ACUN                                                     3AM50400
       SLW     UM+2           UNDERFLOW IN THE MQ, DISTINGUISH CASES.   3AM50410
       CAL     0,1            OBTAIN THE INST. CAUSING THE TRAP     (10)3AM50420
       ARS     24             WE WISH TO LEAVE THE MQ (AND AC) ALONE IF 3AM50430
       ERA     =O4240         THE UNDERFLOW IS INSIGNIFICANT (IE , THE  3AM50440
       LBT                    RESULT OF A DOUBLE PRECISION OPERATION.)  3AM50450
       TNZ     SPMQUF         ALL SUCH OPERATIONS EXCEPT ONE ARE ODD.   3AM50460
       ERA     =O4001           (EXCEPTION IS DFDH, WHICH IS -240)      3AM50470
       TNZ     DPMQUF         ALL SINGLE PRECISION OPS EXCEPT ONE ARE   3AM50480
       REM                    EVEN.   (EXCEPTION IS FDP WHICH IS  241)  3AM50490
SPMQUF CLA     UMC            SINGLE PRECISION CASE, PRINT MESSAGE ON   3AM50500
       TSX     OUT,1          STANDARD OUTPUT,                          3AM50510
       CAL     L(10)          SET MQ=SIGNED ZERO                        3AM50520
       ANS     SMQ                                                      3AM50530
DPMQUF LDQ     SMQ            NO MESSAGE GIVEN FOR DBLE PRECISION CASE. 3AM50540
       CLA     SAC                                                      3AM50550
       TRA     .FFPT.+1                                                 3AM50560
ACUN   SLW     UAM+2                                                    3AM50570
       LFT     1                                                        3AM50580
       TRA     ACMQU          YES                                       3AM50590
ACU    CLA     UAC                                                      3AM50600
       TSX     OUT,1                                                    3AM50610
       TRA     ACZ                                                      3AM50620
ACMQU  CLA     UAMC                                                     3AM50630
       TSX     OUT,1                                                    3AM50640
 MQZ   CAL     L(10)                                                    3AM50650
       ANS     SMQ                                                      3AM50660
ACZ    LDQ     SMQ                                                      3AM50670
       CLA     SAC                                                      3AM50680
       CLM                                                              3AM50690
       TRA     .FFPT.+1                                                 3AM50700
OVR    LFT     2              AC OVERFLOW AND AC AND MQ OVERFLOW.       3AM50710
       TRA     ACOV                                                     3AM50720
MQO    SLW     OM+2                                                     3AM50730
       CLA     OMC                                                      3AM50740
       TSX     OUT,1                                                    3AM50750
 MQOV  CAL     L(1)                                                     3AM50760
       ORS     SMQ                                                      3AM50770
       LDQ     SMQ                                                      3AM50780
       CLA     SAC                                                      3AM50790
       TRA     .FFPT.+1                                                 3AM50800
ACOV   SLW     OAM+2                                                    3AM50810
       LFT     1                                                        3AM50820
       TRA     ACMQO          YES                                       3AM50830
ACO    CLA     OAC                                                      3AM50840
       TSX     OUT,1                                                    3AM50850
       TRA     ACON                                                     3AM50860
ACMQO  CLA     OAMC                                                     3AM50870
       TSX     OUT,1                                                    3AM50880
 MQON  CAL     L(1)                                                     3AM50890
       ORS     SMQ                                                      3AM50900
ACON   LDQ     SMQ                                                      3AM50910
       CLA     SAC                                                      3AM50920
       ORA     L(1)                                                     3AM50930
       TRA     .FFPT.+1                                                 3AM50940
ODD    SLW     OD+2                                                     3AM50950
       CLA     ODC                                                      3AM50960
       TSX     OUT,1                                                    3AM50970
ODD1   LDQ     SMQ            RESTORE MQ                                3AM50980
       CLA     SAC            RESTORE AC                                3AM50990
       TRA     .FFPT.+1                                                 3AM51000
OUT    STO     .FPARG         SET UP ARGUMENT FOR OUTPUT ROUTINE.       3AM51010
       LXA     COUNT,4        TEST WHETHER MAXIMUM MESSAGE COUNT        3AM51020
       TNX     RTN,4,1        HAS BEEN EXCEEDED.                        3AM51030
       SXA     COUNT,4        SAVE DECREMENTED COUNT.                   3AM51040
.FPOUT CALL    .LXSL1(ARG)         WRITE MESSAGE.  CALL OVERLAID    (10)3AM51050
RTN    TRA     1,1            IF FOUT IS LOADED FOR PROGRAM.            3AM51060
ARG    PTW     SYSOU1,,.FPARG                                           3AM51070
.FPARG IOCP    **,,**                                                   3AM51080
       TCH     .LTCH                                                    3AM51090
.COUNT CONTRL  COUNT,UAM      MAXIMUM NUMBER OF TIMES .FPTRP            3AM51100
COUNT  DEC     6              WILL WRITE MESSAGES PER EXECUTION.        3AM51110
UAM    BCI     6,0UNDRFLOW AT       IN AC AND MQ.                    (8)3AM51120
UM     BCI     4,0UNDRFLOW AT       IN MQ.                           (8)3AM51130
OAM    BCI     6,0OVERFLOW AT       IN AC AND MQ.                       3AM51140
OM     BCI     4,0OVERFLOW AT       IN MQ                               3AM51150
OD     BCI     4,0ADDRESS AT        ODD.                                3AM51160
UAC    IOCP    UAM,,4                                                   3AM51170
UAMC   IOCP    UAM,,6                                                   3AM51180
UMC    IOCP    UM,,4                                                    3AM51190
OAC    IOCP    OAM,,4                                                   3AM51200
OAMC   IOCP    OAM,,6                                                   3AM51210
OMC    IOCP    OM,,4                                                    3AM51220
ODC    IOCP    OD,,4                                                    3AM51230
 BLNK  OCT     000000000060                                             3AM51240
 L(1)  PTH     -1,7,-1                                                  3AM51250
 L(10) FOR                                                              3AM51260
 L(11) SVN     -1,7,-1                                                  3AM51270
OVFLOW PZE     0                                                        3AM51280
 SMQ   PZE     **                                                       3AM51290
 SAC   PZE     **                                                       3AM51300
LNKG   LDIR                                                             3AM51310
       LORG                                                             3AM51320
       ORG     8                                                        3AM51330
       TTR     .FFPT.                                                   3AM51340
END94  NULL                                                             3AM51350
       END                                                              3AM51360
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IBDBI                          3B000000
$IBMAP .IBDBI  2005                                                     3B000010
       TTL     .IBDBI - OBJECT TIME ROUTINES FOR DEBUGGING              3B000015
 .PCC  OPSYN   PCC                                                      3B000020
*   MACRO TO SET PCC AND PRESERVE STATUS OF MODE IN PCC.CT              3B000030
 PCC   MACRO   X                                                        3B000040
       .PCC    X                                                        3B000050
       IFT     /X/=/ON/                                                 3B000060
PCC.CT SET     1                                                        3B000070
       IFT     /X/=/OFF/                                                3B000080
PCC.CT SET     2                                                        3B000090
       IFT     /X/=/ON/,OR                                              3B000100
       IFT     /X/=/OFF/                                                3B000110
       GOTO                                                             3B000120
       IFT     PCC.CT=2                                                 3B000130
PCC.CT SET     0                                                        3B000140
PCC.CT SET     PCC.CT+1                                                 3B000150
       ENDM    PCC                                                      3B000160
       SPACE   3                                                        3B000170
*   MACRO TO TURN ON PCC WITHOUT AFFECTING STATUS OF PCC.CT             3B000180
PCCON  MACRO                                                            3B000190
       .PCC    ON                                                       3B000200
       ENDM    PCCON                                                    3B000210
       SPACE   3                                                        3B000220
*   MACRO TO RESTORE STATUS OF PCC ACCORDING TO PCC.CT                  3B000230
PCCBAK MACRO                                                            3B000240
       IFT     PCC.CT=0                                                 3B000250
       .PCC    OFF                                                      3B000260
       IFT     PCC.CT=1                                                 3B000270
       .PCC    ON                                                       3B000280
       IFT     PCC.CT=2                                                 3B000290
       .PCC    OFF                                                      3B000300
       ENDM    PCCBAK                                                   3B000310
       PCC     OFF                                                      3B000320
       LBL     .IBD,BEGIN     .IBDBI                                 (7)3B000330
       TTL     ASSEMBLY PARAMETERS FOR THE DEBUGGING PACKAGE.           3B000340
*   IF THE INSTALLATION HAS DISK OR DRUM CAPABILITY, SET DISK=1         3B000350
*                                            IF NOT, SET DISK=0         3B000360
DISK   SET     0                                                        3B000370
       TTL     .DSTRS    (THE OBJECT-TIME STR SUPERVISOR FOR DEBUGGING) 3B000380
*                                                                       3B000390
*              THIS ROUTINE IS ENTERED WHENEVER AN STR OCCURS DURING    3B000400
*            A DEBUGGING EXECUTION.  IT SAVES THE CONTENTS OF THE AC,   3B000410
*            MQ, XR1, XR2, XR4, SI, AND THE STATUS OF THE THE AC O'FLO  3B000420
*            INDICATOR, AND THE TRAP TRANSFER MODE.                     3B000430
*                                                                       3B000440
*              IF .DSTRN (OR .DSTRO) DETERMINE THAT THIS IS NOT A       3B000450
*            DEBUGGING REQUEST STR, THIS ROUTINE RESTORES REGISTERS     3B000460
*            AND TRANSFERS TO THE STR ENTRANCE IN .LXCON                3B000470
*            IF THIS IS A DEBUGGING STR, ALL REQUESTS AT THIS           3B000480
*            LOCATION ARE INTERPRETED AND THEN THE REGISTERS ARE        3B000490
*            RESTORED AND THE INSTRUCTION REPLACED IS EITHER            3B000500
*            EXECUTED OR SIMULATED.   (RETURN IS TO THE OBJECT PROGRAM) 3B000510
       SPACE   5                                                        3B000520
*      THIS IS THE ENTRY POINT OF THIS ROUTINE.                         3B000530
*              SAVE ALL REGISTERS TO BE USED BY .DSTRS ROUTINE          3B000540
 DSTRS STO     AC                  SAVE MQ, ALL OF ACC                  3B000550
       SLW     LAC                                                      3B000560
       ARS     2                                                        3B000570
       STP     QPX2X1                                                   3B000580
       STQ     MQ                                                       3B000590
       STI     SI                  SAVE SI                              3B000600
       LDI     =0                  CLEAR INDICATORS                     3B000610
       ENB     =0                                                       3B000620
       CAL     0                                                        3B000630
       STZ     0                                                        3B000640
       TMI     *                                                        3B000650
       ZET     0                                                        3B000660
       SIB     TTM                 MARK AS TRANSFER TRAPPING MODE       3B000670
       LTM                                                              3B000680
       SLW     0                                                        3B000690
       NZT     .TRPSW                                                   3B000700
       ENB     .TRAPS                                                   3B000710
       TNO     *+2                 TEST ACC OVRFL                       3B000720
       SIB     OFLO                MARK AS AC O'FLOW                    3B000730
       STI     X4ETC               SAVE STATUS OF HARDWARE INDICATORS   3B000740
       SXA     QPX2X1,1            SAVE X1                              3B000750
       SXD     QPX2X1,2            SAVE X2                              3B000760
       SXD     X4ETC,4             AND X4                               3B000770
       LXA     0,4                                                      3B000780
       SXA     DSTS,4              1+L(STR)                             3B000790
       SXA     DSXIT,4                                                  3B000800
       TXI     *+1,4,1             2+L(STR)                             3B000810
       SXA     DSXIT1,4                                                 3B000820
       TXI     *+1,4,1             3+L(STR)                             3B000830
       SXA     DSXIT2,4                                                 3B000840
       TXI     *+1,4,-3                                                 3B000850
       NZT     NESTED              NESTED REQUESTS--                 (2)3B000851
       TRA     DTRS-2              NO                                (2)3B000852
       STZ     NESTED              YES                               (2)3B000853
       SXD     LSTR,4                                                (2)3B000854
       TRA     DTRS                                                  (2)3B000855
NESTED PZE     **                                                    (2)3B000856
       STL     NESTED                                                (2)3B000857
       SXA     LSTR,4              AND  L(STR)                          3B000860
       SPACE   3                                                        3B000870
*    SEARCH TBSTR FOR A DEBUG REQUEST AT THIS POINT                     3B000880
 DTRS  SXA     DSTR7,4             L(INSTRUCTION EXECUTED)              3B000890
       PXD     ,4                                                       3B000900
       SPACE   5                                                        3B000910
* THE FOLLOWING CELL IS A TRANSFER VECTOR LOADED BY ONE OF TWO ROUTINES.3B000920
*     IT WILL TRANSFER TO THE TBSTR SEARCH ROUTINE FOR EITHER           3B000930
*         OVERLAY OR NON-OVERLAY, APPROPRIATE TO THE JOB.               3B000940
       ENTRY   .DSTRS                                                   3B000950
.DSTRS BSS     1                   TSX TO APPROPRIATE STR TABLE SEARCH  3B000960
*    ACCUMULATOR RETURNS NEGATIVE IF MORE REQUESTS AT THIS LOCATION.    3B000970
*    ACCUMULATOR RETURNS ZERO IF NO MATCH COULD BE FOUND.               3B000980
       STO     DSTR8               SAVE AS SWITCH FOR USE AFTER RESTORE 3B000990
       SPACE   3                                                        3B001000
*      CONTENTS OF AC(21-35)=LOCATION OF ENTRY IN .TBSTR                3B001010
       TZE     IBDXT               NO MATCH FOUND                    (2)3B001011
       ZET     NESTED              NESTED REQUEST--                  (2)3B001012
       TRA     IBDIN               NO, INTERPRET CORR. REQUEST       (2)3B001013
       CALL    .LXSL1(NEST)        YES. OUTPUT TERMINATION MESSAGE. (10)3B001014
       CLA     NESTED-15                                             (2)3B001015
       STT     RDLRC                                                 (2)3B001016
       TSX     MOTWR+2,4           OUTPUT NESTED REQUEST             (2)3B001017
       PZE     STRLST              POINT RECORD                      (2)3B001018
       TRA     .LXERR              TERMINATE EXECUTION               (2)3B001019
  NEST PTW     SYSOU1,,*+1                                           (2)3B001020
       IORP    *+2,,9                                                (2)3B001021
       TCH     .LTCH                                                 (2)3B001022
       BCI     4, ***EXECUTION TERMINATED                            (2)3B001023
       BCI     5, DUE TO NESTED DEBUG REQUESTS.                      (2)3B001024
 IBDXT CLA     DSTR8                                                    3B001030
       TPL     *+3                 NO MORE REQUESTS AT THIS LOCATION    3B001040
*    WHEN THIS POINT IS REACHED, AT LEAST ONE MORE DEBUG REQUEST HAS    3B001050
*    BEEN REQUESTED FOR THIS LOCATION.                                  3B001060
       LXA     DSTR7,4             PREPARE TO GO BACK FOR MORE REQUESTS 3B001070
       TRA     DTRS+1                AT THIS ABSOLUTE LOCATION.         3B001080
       SPACE   3                                                        3B001090
 DSTR7 LDQ     **                  PICKUP THE INSTRUCTION               3B001100
       TZE     DSTR9                AND PROCESS IT.                     3B001110
       SPACE   3                                                        3B001120
*              ASSEMBLE REPLACED INSTRUCTION IN PREPARATION FOR EXECUT  3B001130
       RQL     3                   PUSH STR TO CORNER.                  3B001140
       CAL*    IBDPRE              GET 1ST WD OF 1ST TBSTR ENTRY     (4)3B001150
       ARS     15                  RIGHT-JSTFY 3 REPLACED OP BITS       3B001160
       LGR     3                   FORM INSTR TO BE STUDIED-            3B001170
 DSTR9 STQ     DSTO                STORE IT.                            3B001180
       SPACE   3                                                        3B001190
*      RESTORE STATUS OF ALL REGISTERS USED BY THIS ROUTINE AND         3B001200
*              RESET OVERFLOW INDICATOR AND TRANS TRAP MODE.            3B001210
       CAL     *                   TURN ON OVERFLOW  INDICATOR FOR NOW  3B001220
       ALS     3                    SO STATUS CAN BE REESTABLISHED      3B001230
       LDQ     QPX2X1              RESTORE AC AND MQ                    3B001240
       LLS     2                                                        3B001250
       LDQ     AC                                                       3B001260
       LLS     35                                                       3B001270
       LDQ     MQ                                                       3B001280
       LXD     X4ETC,4             RESTORE X4                           3B001290
       LXD     QPX2X1,2            RESTORE X2                           3B001300
       LXA     QPX2X1,1            AND X1                               3B001310
       LDI     X4ETC               HARDWARE STATUS WORD                 3B001320
       BNT     OFLO                WAS OVERFLOW  ON AT ENTRY            3B001330
       TOV     *+1                  -NO, TURN IT OFF NOW                3B001340
       BFT     TTM                 WAS EXECUTION IN TRAPPING MODE-      3B001350
       ETM                          -YES, ENTER TRAPPING MODE.          3B001360
       SPACE   2                                                        3B001370
       LDI     DSTO                REPLACED INSTRUCTION                 3B001380
       SPACE   3                                                        3B001390
*      TESTS ARE FOR INSTRUCTIONS INVOLVING THE USE OF THE LOCATION     3B001400
*              COUNTER SO THEY CAN BE SIMULATED, INSTEAD OF BEING       3B001410
*              EXECUTED AT A REMOTE LOCATION.                           3B001420
 DSTA  IIB     /XEC*/IGNORE                                             3B001430
       BNT     /IGNORE             IS THIS XEC                          3B001440
       TTR     DSTC                 -NO                                 3B001450
       RIB     /LDI*/IGNORE         -YES, FORM LDI                      3B001460
       STI     *+1                                                      3B001470
 DSTR6 ***     **                  WILL BE LDI OR LDI* TO SIMULATE XEC  3B001480
       TTR     DSTA                                                     3B001490
 DSTC  IIB     /STR*/IGNRE-/XEC*/IGNORE                                 3B001500
       BNT     /IGNRE              IS THIS STR                          3B001510
       TTR     *+2                  -NO                                 3B001520
       TTR     DSTRC                -YES, SEE IF THIS NEEDS TO BE RERUN 3B001530
       NZT     DSTR8               WAS THIS A DEBUG REQUEST             3B001540
       TTR     LXSTR                -NO, MUST BE AN OPERATOR STR        3B001550
       IIB     /STR*/IGNRE-/STL*/IGNORE                                 3B001560
       BNT     /IGNORE             IS THIS STL                          3B001570
       TTR     DSTD                 -NO                                 3B001580
       RIB     /STI*/IGNORE         -YES, FORM STI                      3B001590
       STI     DSTE                                                     3B001600
       IIB     /STI*/IGNORE-/LDI*/IGNORE    (NOW MAKE LDI)              3B001610
       STI     *+1                                                      3B001620
       LDI     **                                                       3B001630
       RIB     ADDRS               CLEAR ADDRESS                        3B001640
       OSI     DSTS                GET CORRECT ADDRESS                  3B001650
 DSTE  STI     **                  SIMULATE STL                         3B001660
       LDI     SI                  RESTORE SI                           3B001670
       STZ     NESTED                                                (2)3B001675
       TTR*    DSXIT               EXIT TO INTERRUPTED PROGRAM          3B001680
       SPACE   3                                                        3B001690
 DSTD  IIB     /STL*/IGNORE-/TSX*/IGNORE                                3B001700
       BNT     /IGNORE             IS THIS TSX                          3B001710
       TTR     DSTB                 -NO                                 3B001720
       STI     DSTO                SAVE INSTRUCTION FOR RECOVERY        3B001730
       RIS     =O777777077777      ALL BUT TAG                          3B001740
       OSI     DSXIT3              FORM LAC                             3B001750
       STI     *+1                                                      3B001760
       LAC     LSTR,**             AND EXECUTE IT                       3B001770
       LDI     DSTO                                                     3B001780
       RIB     TAG                 CLEAR TAG AND                        3B001790
       STI     DSTO                                                     3B001800
DSTB   LDI     SI                  RESTORE SI                           3B001810
       STZ     NESTED                                                (2)3B001815
DSTO   ***                         EXECUTE INSTRUCTION                  3B001820
DSXIT  TTR     **                  RETURN TO INTERRUPTED                3B001830
DSXIT1 TTR     **                  PROGRAM THROUGH ONE                  3B001840
DSXIT2 TTR     **                  OF THESE THREE EXITS, IF NOT A TRANS.3B001850
       SPACE   3                                                        3B001860
 DSTRC NZT     DSTR6               WAS XEC LOOP PERFORMED               3B001870
       TTR     LXSTR                -NO, SIMULATE NORMAL STR            3B001880
*                                                                       3B001890
*        IF THIS POINT IS REACHED, IT MEANS THAT THE STR WHICH WE       3B001900
*              ARE PROCESSING WAS WAS BROUGHT INTO EFFECT BY AN XEC     3B001910
*              AND THE EFFECTIVE ADDRESS OF THE STR MUST BE COMPUTED    3B001920
*              TO SEE IF A DEBUGGING REQUEST WAS LOCATED THERE.         3B001930
*                                                                       3B001940
       LTM                         RESTORE MUST BE DONE AGAIN,          3B001950
 DSEF  CAL     DSTR6                 SO USE AC TO COMPUTE EFFECTIVE     3B001960
       STT     *+1                    ADDRESS OF STR LOCATION.          3B001970
       PXA     ,**                                                      3B001980
       STT     DSTR6               CLEAR TAG                            3B001990
       SBM     DSTR6                                                    3B002000
       STA     DSTR6                                                    3B002010
       LDI     DSTR6                                                    3B002020
       BNT     INDRCT              INDIRECT ADDRESS                     3B002030
       TRA     DSEG                 -NO, PUT EFFECTIVE ADDRESS IN X4    3B002040
       LDI*    DSTR6                -YES, PICKUP INSTRUCTION            3B002050
       RIB     INDRCT              PREVENT RECYCLING                    3B002060
       SIB     LDI                 ASSURE THAT SOME BITS ARE ON IN OP   3B002070
       STI     DSTR6                                                    3B002080
       TRA     DSEF                                                     3B002090
 DSEG  LXA     DSTR6,4                                                  3B002100
       STZ     DSTR6               CLEAR INDICATION OF XEC CYCLE        3B002110
       TRA     DTRS                                                     3B002120
       EJECT                                                            3B002130
*      WORKING STORAGE AND DATA AREA OF .DSTRS                          3B002140
DSXIT3 LAC     LSTR,**                                                  3B002150
DSTS   PZE     **                  L(STR)+1  (FOR STL SIMULATOR)        3B002160
.IBPRE CONTRL  IBDPRE,DSTR8                                          (4)3B002168
IBDPRE BSS     1                   LOC OF CORRECT OP CODE TBSTR ENTRY(4)3B002169
DSTR8  BSS     1                   LOCATION IN .TBSTR, OR ZERO IF NONE  3B002170
       SPACE   3                                                        3B002180
*    BITS USED TO STORE HARDWARE STATUS AT ENTRY IN X4ETC               3B002190
 OFLO  RBOOL   100000              AC OVERFLOW INDICATOR                3B002200
 DC    RBOOL   040000              DIVIDE CHECK INDICATOR               3B002210
 IO    RBOOL   020000              I/O CHECK INDICATOR                  3B002220
 TTM   RBOOL   010000              TRANSFER TRAP MODE STATUS            3B002230
       SPACE   3                                                        3B002240
*    BIT CONFIGURATIONS OF OP CODES                                     3B002250
 LDI   LBOOL   044100                                                   3B002260
 STI   LBOOL   060400                                                   3B002270
 STL   LBOOL   462500                                                   3B002280
 STR   LBOOL   500000                                                   3B002290
 TSX   LBOOL   007400                                                   3B002300
 XEC   LBOOL   052200                                                   3B002310
       SPACE   3                                                        3B002320
*    FIELD DEFINITONS OF PARTS OF 7090/7094 WORD                        3B002330
IGNORE LBOOL   000077              BITS NOT USED BY 12 BIT OP CODES     3B002340
 IGNRE LBOOL   077777              BITS NOT USED BY 3 BIT OP CODES      3B002350
INDRCT LBOOL   000060              BITS SIGNALING INDIRECT ADDRESSING   3B002360
 TAG   RBOOL   700000                                                   3B002370
 ADDRS RBOOL   077777                                                   3B002380
       SPACE   5                                                        3B002390
*      PLANT TRANSFER IN STR COMMUNICATION CELL                         3B002400
       USE     ABS                                                      3B002410
       ORG     2                                                        3B002420
       TTR     DSTRS                                                    3B002430
       USE                                                              3B002440
       TTL     IBDIN               (REPLACEABLE CONTROL SECTIONS)       3B002450
*                                                                       3B002460
*    THE FOLLOWING ARE REPLACEABLE CONTROL SECTIONS WHOSE CODE APPLIES  3B002470
*      TO ONLY A SPECIFIC OPERATION OR SET OF RELATED OPERATIONS.       3B002480
*      IF THIS FUNCTION IS NOT REQUIRED BY A GIVEN DEBUG RUN, THE       3B002490
*      DEBUGGING COMPILER (IBDBL) WILL OUTPUT AN ENTRY POINT WITH THE   3B002500
*      SAME NAME.   SINCE THE DEBUG COMPILER DECK (.DBGTX) PRECEDES     3B002510
*      THIS SUBROUTINE, THE  CODING IN THIS ROUTINE WILL NOT BE         3B002520
*      LOADED FOR CORRESPONDING FUNCTION.                               3B002530
*                                                                       3B002540
.IBD01 CONTRL  01B,01E                                                  3B002550
.IBD02 CONTRL  02B,02E                                                  3B002560
.IBD03 CONTRL  03B,03E                                                  3B002570
.IBD04 CONTRL  04B,04E                                                  3B002580
.IBD06 CONTRL  06B,06E                                                  3B002590
.IBD10 CONTRL  10B,10E                                                  3B002600
.IBD12 CONTRL  12B,12E                                                  3B002610
.IBD14 CONTRL  14B,14E                                                  3B002620
.IBD18 CONTRL  18B,18E                                                  3B002630
.IBD20 CONTRL  20B,20E                                                  3B002640
.IBD22 CONTRL  22B,22E                                                  3B002650
.IBD23 CONTRL  23B,23E                                                  3B002660
.IBD27 CONTRL  27B,27E                                                  3B002670
.IBD28 CONTRL  28B,28E                                                  3B002680
.IBD32 CONTRL  32B,32E                                                  3B002690
.IBD33 CONTRL  33B,33E                                                  3B002700
.IBD35 CONTRL  35B,35E                                                  3B002710
.IBD39 CONTRL  39B,39E                                                  3B002720
.IBD41 CONTRL  41B,41E                                                  3B002730
.IBD44 CONTRL  44B,44E                                                  3B002740
.IBD45 CONTRL  45B,45E                                                  3B002750
.IBD48 CONTRL  48B,48E                                                  3B002760
.IBD49 CONTRL  49B,49E                                                  3B002770
.IBD51 CONTRL  51B,51E                                                  3B002780
.IBD64 CONTRL  64B,64E                                                  3B002790
.IBD65 CONTRL  65B,65E                                                  3B002800
.IBD66 CONTRL  66B,66E                                                  3B002810
.IBD67 CONTRL  67B,67E                                                  3B002820
.IBD68 CONTRL  68B,68E                                                  3B002830
.IBD69 CONTRL  69B,69E                                                  3B002840
.IBDSB CONTRL  SBB,SBE                                                  3B002850
.IBDAA CONTRL  AAB,AAE                                                  3B002860
.IBDAB CONTRL  ABB,ABE                                                  3B002870
.IBDAC CONTRL  ACB,ACE                                                  3B002880
.IBDAD CONTRL  ADB,ADE                                                  3B002890
.IBDAE CONTRL  AEB,AEE                                                  3B002900
.IBDAF CONTRL  AFB,AFE                                                  3B002910
.IBDAG CONTRL  AGB,AGE                                                  3B002920
.IBDAH CONTRL  AHB,AHE                                                  3B002930
       TTL     IBDIN  -  DEBUG REQUEST INTERPRETER                      3B002940
 IBDIN STA     *+1                                                      3B002950
       CLA     **                                                       3B002960
       STA     INCSX                                                    3B002970
IBDIN2 LXD     .IBDB1,2                                                 3B002980
       TIX     IBDIN1,2,1          IS STR COUNTER LIMIT REACHED         3B002990
       TXL     IBDXT,2,0            -YES, IS THIS THE FIRST TIME        3B003000
       CLA     .IBDB1               -YES                                3B003010
       TMI     IBDIN1-1                                                 3B003020
       CALL    .LXSL1(NOMORE)      OUTPUT TERMINATION MESSAGE.      (10)3B003030
       TXI     *+1,2,-1                                                 3B003040
IBDIN1 SXD    .IBDB1,2                                                  3B003050
       AXT     -.IBDB5+1,4                                              3B003060
       SXA     PSHDN,4                                                  3B003070
       STZ     DUMP                DUMP STR LOC FLAG                    3B003080
       AXT     .IBDB6,4                                                 3B003090
       SXA     GETRS1,4                                                 3B003100
*                                                                       3B003110
*   INTERPRETER                                                         3B003120
*              - PROCESSES CONSECUTIVE HALFWORD ENTRIES IN .IBDBT       3B003130
*                TO EVALUATE REQUESTS.                                  3B003140
 INCSX AXT     **,4                SET XR4 = NEXT ITEM TO BE INTERPRETED3B003150
       PXA     ,4                                                       3B003160
       TXI     *+1,4,1             BUMP TO NEXT ITEM                    3B003170
       SXA     INCSX,4              AND SAVE                            3B003180
       LGR     1                   DIVIDE BY 2, SAVE REMAINDER IN MQ    3B003190
       PAC     ,4                  RELATIVE POINTER INTO .IBDBT         3B003200
       CAL     .IBDBT,4                                                 3B003210
       TQP     *+2                                                      3B003220
       ALS     18                                                       3B003230
       PDX     ,1                  XR1 CONTAINS VALUE.                  3B003240
       ARS     15                                                       3B003250
       ANA     =O000007000000      CLEAR ALL BUT 3 BITS                 3B003260
       PDC     ,2                  XR2 = -PREFIX =-INTERPRETER CODE.    3B003270
       LAC     GTSB,4                                                   3B003280
       TXL     *+3,4,0                                                  3B003290
       STZ     GTSB                                                     3B003300
       TRA     1,4                                                      3B003310
       TRA     *+1,2               PREFIX                               3B003320
       TRA     OPTOR               0 - OPERATION                        3B003330
       TRA     RDOP                1 - READ VIA RDICT.                  3B003340
       TRA     RCON                2 - READ VIA CONSTANT POOL - .IBDB2  3B003350
       TRA     RABS                3 - ABSOLUTE ADDRESS                 3B003360
       TRA     RMR                4 - READ MACHINE REGISTER             3B003370
       STR                                                              3B003380
       TRA     VALUE               6 - VALUE IS TRUE VALUE.             3B003390
       STR                                                              3B003400
       TTL     IBDIN               OPERATIONS                           3B003410
*    DETERMINE CATEGOY AND                                              3B003420
*        PREPARE TO PERFORM OPERATION                                   3B003430
*                                                                       3B003440
 OPTOR STZ     UNDEF                                                    3B003450
       STZ     AHIGH                                                    3B003460
       STZ     BHIGH                                                    3B003470
       TXL     AOPS,1,17           ARITHMETIC AND RELATIONAL OPERATIONS 3B003480
       TXL     OPTOR1,1,18         SPECIAL ADDER FOR ADDRESSES          3B003490
       TXL     INCSX,1,19          UNDEFINED                            3B003500
       TXL     ADDR,1,21           ADDRESS AND DECREMENT OPERATIONS     3B003510
       TXL     COMPL,1,22          COMPLEMENT OPERATION                 3B003520
       TXL     OPTR13,1,23         OPERATION IS 'NOT'                   3B003530
       TXL     INCSX,1,26          UNDEFINED                            3B003540
       TXL     OPTR12,1,27         OPERATION IS XTRACT                  3B003550
       TXL     COPY,1,28           COPY                                 3B003560
       TXL     DMPALL,1,31         DUMP 0-77777 IN DICTIONARY MODE      3B003570
       TXL     JUMPS,1,38          SKIP AND JUMP OPERATIONS             3B003580
       TXL     OPTOR4,1,39                                              3B003590
       TXL     OPT40,1,40                                               3B003600
       TXL     DSTOR,1,41         DESTRUCTIVE STORE                     3B003610
       TXL     .LXERR,1,43         TERMINATE EXECUTION                  3B003620
       TXL     PAUSE,1,44          PAUSE OPERATION                      3B003630
       TXL     OPCALL,1,45         CALL                                 3B003640
       TXL     INCSX,1,46          NO OPERATION                         3B003650
       TXL     IBDXT,1,47          EXIT FROM IBDIN                      3B003660
       TXL     ONOP,1,48           'ON'                                 3B003670
       TXL     OPTOR3,1,50         LOOPING AND DUMMY VARIABLE OPERATIONS3B003680
       TXL     OP51,1,51           GET SUBSCRIPTED VARIABLE             3B003690
       TXL     OP52,1,52           GET LAST LOCATION OF ARRAY           3B003700
       TXL     DUMPS,1,4*8*8-1     (OCTAL 377) DUMP OPERATIONS          3B003710
       STR                         NO SUCH OPERATIONS                   3B003720
       TTL     IBDIN             OPERATIONS (ARITHMETIC AND RELATIONAL) 3B003730
*        OPERATIONS  00 TO 17 , ARITHMETIC AND RELATIONAL OPERATIONS    3B003740
*              ARITHMETIC OPERATIONS ARE - - -                          3B003750
*      1   IS  +                                                        3B003760
*      2   IS  -                                                        3B003770
*      3   IS  *                                                        3B003780
*      4   IS  /                                                        3B003790
*      5   IS  UNDEFINED                                                3B003800
*                                                                       3B003810
*              RELATIONAL OPERATIONS ARE                                3B003820
*      6    IS LGT                                                      3B003830
*      7    IS LGE                                                      3B003840
*      8    IS LLE                                                      3B003850
*      9    IS LLT                                                      3B003860
*      10   IS LNE                                                      3B003870
*      11   IS LEQ                                                      3B003880
*      12   IS NE                                                       3B003890
*      13   IS EQ                                                       3B003900
*      14   IS GT                                                       3B003910
*      15   IS GE                                                       3B003920
*      16   IS LE                                                       3B003930
*      17   IS LT                                                       3B003940
       SPACE   3                                                        3B003950
*        GET OPERANDS                                                   3B003960
 AOPS  SXA     AOPS6,1             OPERATION TYPE                       3B003970
       TSX     OPAND,1             GET OPERAND 'A'                      3B003980
       STO     AHIGH                                                    3B003990
       STQ     ALOW                                                     3B004000
       SXA     MODE,4                                                   3B004010
       TSX     OPAND,1             GET OPERAND 'B'                      3B004020
       STO     BHIGH                                                    3B004030
       STQ     BLOW                                                     3B004040
 AOPS6 AXC     **,1                RESTORE OPERATION TYPE               3B004050
       TXH     *+2,1,-6           ARITHMETIC OPERATION                  3B004060
       TXH     DOOP3,1,-12        LOGICAL RELATIONAL (IGNORES MODE)     3B004070
       SPACE   3                                                        3B004080
*        PUT OPERANDS INTO A COMPATABLE MODE                            3B004090
 ABB   NULL                                                             3B004100
       LXA     MODE,2              MODE OF A                            3B004110
       TXH     AOPS1,4,6           TRA IF B IS FLTNG, DBLE, OR CMPLX.   3B004120
       TXH     AOPS4,2,6           TRA IF A IS FLOATING, ETC.           3B004130
 AOPSA STZ     MODE                SET MODE AS OCTAL.                   3B004140
       TRA     DOOP                GO DO OPERATION.                     3B004150
 AOPS1 TXL     *+2,4,7                                                  3B004160
       TXL     DOOP,4,8                                                 3B004170
       TXL     AOPS3,2,6           TRA IF A IS NOT FLOATING, ETC.       3B004180
       TXL     *+3,2,7                                                  3B004190
       TXH     *+2,2,8                                                  3B004200
       SXA     MODE,4                                                   3B004210
       PXA     0,4                 AC = BMODE.                          3B004220
       CAS     MODE                THE GREATER MODE OVERIDES.           3B004230
       TRA     AOPS2               BMODE MTH AMODE,                     3B004240
       TRA     DOOP                BOTH HAVE SAME MODE.                 3B004250
       TRA     AOPS5               AMODE OVERIDES.                      3B004260
 AOPS2 STO     MODE                BMODE OVERIDES.                      3B004270
       TRA     AOPS5                                                    3B004280
 AOPS3 SXA     MODE,4              BMODE OVERIDES                       3B004290
       CLA     AHIGH                                                    3B004300
       TSX     AOPFL,4             FLOAT A                              3B004310
       STQ     ALOW                                                     3B004320
       STO     AHIGH                                                    3B004330
       TRA     AOPS5                                                    3B004340
 AOPS4 TXL     *+2,2,7                                                  3B004350
       TXL     AOPSA,2,8                                                3B004360
       CLA     BHIGH                                                    3B004370
       TSX     AOPFL,4             FLOAT B                              3B004380
       STQ     BLOW                                                     3B004390
       STO     BHIGH                                                    3B004400
 AOPS5 CLA     MMODE1                                                   3B004410
       CAS     MODE                IS MODE COMPLEX                      3B004420
       TRA     DOOP                 -NO                                 3B004430
       TRA     DOOP                 -NO                                 3B004440
       TXL     *+3,2,14            MODE OF 'A'                          3B004450
       STZ     BLOW                                                     3B004460
       TRA     DOOP                                                     3B004470
       STZ     ALOW                                                     3B004480
       TRA     DOOP                                                     3B004490
 ABE   NULL                                                             3B004500
       SPACE   3                                                        3B004510
*        CONVERT TO FLOATING POINT                                      3B004520
 AOPFL LDQ     =0                                                       3B004530
       LRS     8                                                        3B004540
       ORA     =163B8                                                   3B004550
       STO     TEMP                                                     3B004560
       CLA     =155B16                                                  3B004570
       LLS     8                                                        3B004580
       FAD     TEMP                                                     3B004590
       TRA     1,4                                                      3B004600
       EJECT                                                            3B004610
*                                                                       3B004620
*        ARITHMETIC OPERATIONS                                          3B004630
*                                                                       3B004640
 01B   NULL                                                             3B004650
 XADD  CLA     AHIGH               B+A                                  3B004660
       ADD     BHIGH                                                    3B004670
       TRA     RDOP10                                                   3B004680
 FADD  CLA     AHIGH                                                    3B004690
       FAD     BHIGH                                                    3B004700
       TRA     RDOP10                                                   3B004710
 CADD  CLA     AHIGH                                                    3B004720
       FAD     BHIGH                                                    3B004730
       STO     0,2                                                      3B004740
       CLA     ALOW                                                     3B004750
 CADD1 FAD     BLOW                                                     3B004760
       STO     1,2                                                      3B004770
       TRA     INCSX                                                    3B004780
 DADD  CLA     AHIGH                                                    3B004790
       FAD     BHIGH                                                    3B004800
       STO     0,2                                                      3B004810
       XCA                                                              3B004820
       FAD     ALOW                                                     3B004830
 01E   NULL                                                             3B004840
 AAB   NULL                                                             3B004850
       FAD     BLOW                                                     3B004860
 DADD1 FAD     0,2                                                      3B004870
       STQ     1,2                                                      3B004880
       TRA     RDOP10                                                   3B004890
 DOOP1 TSX     GETRS,4             GET RESULT.STORAGE.POINTER.          3B004900
       CLA     MODE                                                     3B004910
       TZE*    XOP-1,1                                                  3B004920
       CAS     MMODE1                                                   3B004930
       TRA*    COP-1,1                                                  3B004940
       TRA*    DOP-1,1                                                  3B004950
       CAS     MMODE2                                                   3B004960
       TRA*    XOP-1,1             OPERATION ASSUMED FOR MODE=8         3B004970
       TRA*    FOP-1,1                                                  3B004980
       TRA*    XOP-1,1                                                  3B004990
 XOP   TRA     XADD                                                     3B005000
       TRA     XSUB                                                     3B005010
       TRA     XMUL                                                     3B005020
       TRA     XDIV                                                     3B005030
 FOP   TRA     FADD                                                     3B005040
       TRA     FSUB                                                     3B005050
       TRA     FMUL                                                     3B005060
       TRA     FDIV                                                     3B005070
 DOP   TRA     DADD                                                     3B005080
       TRA     DSUB                                                     3B005090
       TRA     DMUL                                                     3B005100
       TRA     DDIV                                                     3B005110
 COP   TRA     CADD                                                     3B005120
       TRA     CSUB                                                     3B005130
       TRA     CMUL                                                     3B005140
       TRA     CDIV                                                     3B005150
 AAE   NULL                                                             3B005160
*                                                                       3B005170
 02B   NULL                                                             3B005180
 XSUB  CLS     AHIGH               B-A                                  3B005190
       TRA     XADD+1                                                   3B005200
 FSUB  CLS     AHIGH                                                    3B005210
       TRA     FADD+1                                                   3B005220
 DSUB  CLS     ALOW                                                     3B005230
       STO     ALOW                                                     3B005240
       CLS     AHIGH                                                    3B005250
       TRA     DADD+1                                                   3B005260
 CSUB  CLS     AHIGH                                                    3B005270
       FAD     BHIGH                                                    3B005280
       STO     0,2                                                      3B005290
       CLS     ALOW                                                     3B005300
       TRA     CADD1                                                    3B005310
 02E   NULL                                                             3B005320
 04B   NULL                                                             3B005330
 XDIV  LDQ     BHIGH               B/A                                  3B005340
       ZAC                                                              3B005350
       DVP     AHIGH                                                    3B005360
       TRA     XMUL1                                                    3B005370
*                                                                       3B005380
 FDIV  CLA     BHIGH                                                    3B005390
       FDP     AHIGH                                                    3B005400
       TRA     XMUL1                                                    3B005410
 DDIV  CLA     BHIGH               B/A = (BH/AH) + (BL+R-AL*(BH/AH))/AH 3B005420
       FDP     AHIGH                                                    3B005430
       STO     1,2                 R                                    3B005440
       STQ     0,2                 BH/AH                                3B005450
       FMP     ALOW                                                     3B005460
       CHS                         -AL*(BH/AH)                          3B005470
       FAD     1,2                 +R                                   3B005480
       FAD     BLOW                +BL                                  3B005490
       FDP     AHIGH               /AH                                  3B005500
       XCA                                                              3B005510
       TRA     DADD1                                                    3B005520
*                                                                       3B005530
*                                                                       3B005540
 CDIV  LDQ     AHIGH                                                    3B005550
       FMP     AHIGH                                                    3B005560
       STO     CDIV1                                                    3B005570
       LDQ     ALOW                                                     3B005580
       FMP     ALOW                                                     3B005590
       FAD     CDIV1                                                    3B005600
       STO     CDIV1               STORE ABS VAL OF DENOMINATOR.        3B005610
       LDQ     BHIGH                                                    3B005620
       FMP     ALOW                                                     3B005630
       STO     1,2                                                      3B005640
       LDQ     BLOW                                                     3B005650
       FMP     AHIGH                                                    3B005660
       FSB     1,2                                                      3B005670
       FDP     CDIV1                                                    3B005680
       STQ     1,2                                                      3B005690
       LDQ     BHIGH               MUL B BY COMPLEX CONJ. OF A.         3B005700
       FMP     AHIGH                                                    3B005710
       STO     0,2                                                      3B005720
       LDQ     BLOW                                                     3B005730
       FMP     ALOW                                                     3B005740
       FAD     0,2                                                      3B005750
       FDP     CDIV1                                                    3B005760
       TRA     XMUL1                                                    3B005770
 CDIV1 PZE                                                              3B005780
 04E   NULL                                                             3B005790
 03B   NULL                                                             3B005800
 CMUL  LDQ     ALOW                                                     3B005810
       FMP     BLOW                                                     3B005820
       STO     0,2                                                      3B005830
       LDQ     AHIGH                                                    3B005840
       FMP     BHIGH                                                    3B005850
       FSB     0,2                                                      3B005860
       STO     0,2                                                      3B005870
       LDQ     ALOW                                                     3B005880
       FMP     BHIGH                                                    3B005890
       STO     1,2                                                      3B005900
       LDQ     AHIGH                                                    3B005910
       FMP     BLOW                                                     3B005920
       FAD     1,2                                                      3B005930
       STO     1,2                                                      3B005940
       TRA     INCSX                                                    3B005950
 DMUL  LDQ     BLOW                                                     3B005960
       FMP     AHIGH                                                    3B005970
       STO     1,2                                                      3B005980
       LDQ     BHIGH                                                    3B005990
       FMP     AHIGH                                                    3B006000
       STO     0,2                                                      3B006010
       STQ     BLOW                                                     3B006020
       LDQ     BHIGH                                                    3B006030
       FMP     ALOW                                                     3B006040
       FAD     1,2                                                      3B006050
       TRA     DADD1-1                                                  3B006060
 FMUL  LDQ     BHIGH                                                    3B006070
       FMP     AHIGH                                                    3B006080
       TRA     RDOP10                                                   3B006090
 XMUL  LDQ     BHIGH               B*A                                  3B006100
       MPY     AHIGH                                                    3B006110
 03E   NULL                                                             3B006120
 XMUL1 STQ     0,2                                                      3B006130
       TRA     INCSX                                                    3B006140
       EJECT                                                            3B006150
*    LOGICAL RELATIONAL PROCESSING                                      3B006160
 ACB   NULL                                                             3B006170
 DOOP3 ZET     UNDEF                                                    3B006180
       TRA     IBDXT                                                    3B006190
       CAL     AHIGH                                                    3B006200
       TXL     *+2,1,-10          LEQ AND LNE                           3B006210
       TXI     DOOP4,1,7          LGT, LGE, LLE, LLT                    3B006220
 ACE   NULL                                                             3B006230
 10B   NULL                                                             3B006240
       ERA     BHIGH                                                    3B006250
       TNZ*    DONE-10,1          A NE B                                3B006260
       TZE*    DONE-9,1           A EQ B                                3B006270
 10E   NULL                                                             3B006280
       SPACE   3                                                        3B006290
 06B   NULL                                                             3B006300
 DOOP4 LAS     BHIGH                                                    3B006310
       TXI     TRUE-1,1,2                                               3B006320
       TXI     TRUE-1,1,1                                               3B006330
       TRA     TRUE-1                                                   3B006340
 06E   NULL                                                             3B006350
       EJECT                                                            3B006360
*                                                                       3B006370
*        PERFORM THE PROPER OPERATION.  (MODES HAVE BEEN MATCHED)       3B006380
 DOOP  TXH     DOOP1,1,-6                                               3B006390
*        RELATIONAL OPERATIONS                                          3B006400
 ADB   NULL                                                             3B006410
       ZET     UNDEF                                                    3B006420
       TRA     IBDXT                                                    3B006430
       LXA     MODE,4                                                   3B006440
       TNX     *+1,4,6                                                  3B006450
       TNX     *+1,4,6                                                  3B006460
       CLA     AHIGH                                                    3B006470
       TXH     DOOP2,1,-14         EQ AND NE TESTS                      3B006480
       TRA     *+4,4                                                    3B006490
       TXI     CCOM,1,15           COMPLEX COMPARISON                   3B006500
       TXI     DCOM,1,15           DOUBLE PRECISION COMPARISON          3B006510
       TXI     XCOM,1,15           FLOATING COMPARISON                  3B006520
       TXI     XCOM,1,15           ONE WORD COMPARISONS                 3B006530
       SPACE   3                                                        3B006540
       FSB     BHIGH                                                    3B006550
       FSB     BHIGH                                                    3B006560
       FSB     BHIGH                                                    3B006570
 SBTR  SUB     BHIGH                                                    3B006580
 ADE   NULL                                                             3B006590
 12B   NULL                                                             3B006600
       SPACE   3                                                        3B006610
*                                                                       3B006620
*        EQ AND NE RELATIONAL PROCESSING                                3B006630
*                                                                       3B006640
 DOOP2 XEC     SBTR,4                                                   3B006650
       TNZ*    DONE-12,1           A NE B                               3B006660
       TXH     *+2,4,1                                                  3B006670
       TRA*    DONE-11,1           A EQ B                               3B006680
       CLA     ALOW                                                     3B006690
       FSB     BLOW                                                     3B006700
       TNZ*    DONE-12,1           NE                                   3B006710
       TRA*    DONE-11,1           EQ                                   3B006720
 12E   NULL                                                             3B006730
       EJECT                                                            3B006740
 14B   NULL                                                             3B006750
*                                                                       3B006760
*                                                                       3B006770
*   ROP    XR1    XR1+15                                                3B006780
*                                                                       3B006790
*   GT     -14     1                                                    3B006800
*   GE     -15     0                                                    3B006810
*   LE     -16    -1                                                    3B006820
*   LT     -17    -2                                                    3B006830
*                                                                       3B006840
       SPACE   2                                                        3B006850
*        SINGLE WORD COMPARISON                                         3B006860
 XCOM  XEC     SBTR,4                                                   3B006870
       TZE     ZRO                                                      3B006880
       TMI     NEG                                                      3B006890
       TXI     TRUE-1,1,2          B LT A                               3B006900
 ZRO   TXI     TRUE-1,1,1          B EQ A                               3B006910
*                                                                       3B006920
*        DOUBLE PRECISION COMPARISON                                    3B006930
 DCOM  XEC     SBTR,4                                                   3B006940
       TNZ     XCOM+2                                                   3B006950
       CLA     ALOW                                                     3B006960
       FSB     BLOW                                                     3B006970
       TRA     XCOM+1                                                   3B006980
       SPACE   2                                                        3B006990
*        COMPLEX NUMBER COMPARISON (AMPLITUDE)                          3B007000
 CCOM  AXC     AHIGH,2             SET UP TO COMPARE THE ABSOLUTE       3B007010
       TSX     CCOM1,4             VALUES OF A AND B.                   3B007020
       AXC     BHIGH,2                                                  3B007030
       TSX     CCOM1,4                                                  3B007040
       CLA     AHIGH                                                    3B007050
       TXI     XCOM,4,*-2+3        SET XR4=3                            3B007060
*                                                                       3B007070
 CCOM1 LDQ     0,2                 GET ABSOLUTE VALUE OF COMPLEX        3B007080
       FMP     0,2                 NUMBER IN 0,2 AND 1,2.               3B007090
       STO     0,2                                                      3B007100
       LDQ     1,2                                                      3B007110
       FMP     1,2                                                      3B007120
       FAD     0,2                                                      3B007130
       STO     0,2                                                      3B007140
       TRA     1,4                                                      3B007150
 14E   NULL                                                             3B007160
       TTL     IBDIN             OPERATIONS  (SPECIAL WORD OPERATIONS)  3B007170
 18B   NULL                                                             3B007180
*        SPECIAL ADDER FOR ADDRESSES  - IS OPERATION 18                 3B007190
*                                                                       3B007200
OPTOR1 TSX     FXOPND,1                                                 3B007210
       SXD     OPTR11,4           SAVE INTEGER ADDEND                   3B007220
       TSX     PSHUP,4             GET WORD WHOSE ADDRESS PORTION IS TO 3B007230
       STO     AHIGH               BE INCREASED.                        3B007240
       PAX     0,4                                                      3B007250
OPTR11 TXI     *+1,4,**                                                 3B007260
       SXA     AHIGH,4                                                  3B007270
       TSX     RDOP8,4                                                  3B007280
       CLA     AHIGH                                                    3B007290
       TRA     RDOP10                                                   3B007300
 18E   NULL                                                             3B007310
       EJECT                                                            3B007320
*    OPERATIONS 20, 21, AND 22                                          3B007330
*                                                                       3B007340
 20B   NULL                                                             3B007350
*                                                                       3B007360
*      20  IS  ADDR                                                     3B007370
*      21  IS  DECRE                                                    3B007380
*                                                                       3B007390
 ADDR  SXA     ADDR1,1                                                  3B007400
       TSX     OPAND,1                                                  3B007410
 ADDR1 AXT     **,1                                                     3B007420
       XEC     ADDRA+21,1                                               3B007430
       TXI     OPTR4,1,39-21                                            3B007440
       SPACE   2                                                        3B007450
 ADDRA ARS     18                  OPERATE ON DECREMENT                 3B007460
       TXI     OPTR4,1,39-20       OPERATE ON ADDRESS                   3B007470
 20E   NULL                                                             3B007480
       SPACE   5                                                        3B007490
 22B   NULL                                                             3B007500
*      22  IS  COMPLEMENT                                               3B007510
*                                                                       3B007520
 COMPL TSX     PSHUP,4                                                  3B007530
       PAC     ,4                                                       3B007540
       PXA     ,4                                                       3B007550
       TRA     OPTR4+1                                                  3B007560
 22E   NULL                                                             3B007570
       EJECT                                                            3B007580
*        OPERATION IS 'NOT'                                             3B007590
*                                                                       3B007600
 23B   NULL                                                             3B007610
OPTR13 TSX     OPAND,1             23-027 IS 'NOT' = 1'S COMPLEMENT     3B007620
       STO     AHIGH                                                    3B007630
       TSX     GETRS,4                                                  3B007640
       CAL     AHIGH                                                    3B007650
       TZE     *+2                                                      3B007660
       AXT     0,4                                                      3B007670
       PXA     ,4                                                       3B007680
       SLW     0,2                                                      3B007690
       TRA     INCSX                                                    3B007700
 23E   NULL                                                             3B007710
       EJECT                                                            3B007720
*                                                                       3B007730
*    OPERATION IS EXTRACT.                                              3B007740
*      (CLEAR ALL BUT BITS A1 TO A2 AND SAVE RIGHT JUSTIFIED)           3B007750
*                                                                       3B007760
*                                                                       3B007770
 27B   NULL                                                             3B007780
OPTR12 TSX     FXOPND,1            GET AN OPERAND IN FIXED POINT        3B007790
       SXA     OPT122,4                                                 3B007800
       TSX     FXOPND,1                                                 3B007810
       SXA     OPT121,4                                                 3B007820
       TSX     OPAND,1                                                  3B007830
       STO     BHIGH                                                    3B007840
       STQ     BLOW                                                     3B007850
       ZSA     MODE                                                     3B007860
       TSX     GETRS,4                                                  3B007870
*        CLEAR ALL BUT BITS A1 TO A2 INCLUSIVE                          3B007880
OPT121 AXC     **,4                                                     3B007890
OPT122 AXT     **,1                                                     3B007900
       CAL     BHIGH                                                    3B007910
       LDQ     BLOW                                                     3B007920
       LGL     1,4                 SHIFT LEFT 1+A1                      3B007930
       SXD     *+1,1                                                    3B007940
       TXI     *+1,4,**            XR4 = A2-A1                          3B007950
       LGR     72,4                SHIFT RIGHT 72-(A2-A1)               3B007960
       SLW     1,2                 INVERSE ORDER.                       3B007970
       TRA     XMUL1                                                    3B007980
       SPACE   6                                                        3B007990
 DSTIM STA     DSTIM1              (NUMBER OF RIGHT BIT)                3B008000
       TSX     PSHUP,4                                                  3B008010
       PAC     ,2                  XR2= -(LEFT BIT)                     3B008020
       SXD     DSTIM2,2                                                 3B008030
       TSX     OPAND,1             GET CONTENTS OF CELL BEING ALTERED   3B008040
       TSX     PSHDN,4             RESTORE PUSHDOWN STATUS              3B008050
DSTIM1 AXC     **,2                RIGHT BIT NUMBER                     3B008060
       LAC     DSTIM1,1            RIGHT BIT NUMBER                     3B008070
DSTIM2 TXI     *+1,1,**            X1= (RIGHT BIT NO.)-(LEFT BIT NO.)   3B008080
       STO     ALOW                PUT CONTENTS OF CELL BEING        (2)3B008081
       CAL     ALOW                 ALTERED IN LOGICAL AC            (2)3B008082
       LGR     35,2                                                     3B008090
       SLW     ALOW                                                     3B008100
       CAL     DSTIM3              ALL BITS ON                          3B008110
       ARS     35,1                35-(BIT DIFFERENCE)                  3B008120
       ANS     AHIGH               MASK OFF UNWANTED BITS               3B008130
       COM                                                              3B008140
       ANA     ALOW                CLEAR REPLACED BIT AREA              3B008150
       ORA     AHIGH               INSERT NEW BITS                      3B008160
       LGL     35,2                READJUST WORD TO PROPER B VALUE      3B008170
       SLW     AHIGH               WORD THAT WILL BE STORED             3B008180
       TRA     DSTI                RETURN TO STORE WORD                 3B008190
DSTIM3 OCT     777777777777                                             3B008200
 27E   NULL                                                             3B008210
       EJECT                                                            3B008220
*    OPERATION IS COPY    - 28                                          3B008230
 28B   NULL                                                             3B008240
 COPY  LXA     PSHDN,2                                                  3B008250
       CLA     0,2                                                      3B008260
       TSX     PSHDN,4                                                  3B008270
       TRA     RDOP10                                                   3B008280
 28E   NULL                                                             3B008290
       TTL     IBDIN             OPERATIONS  (SKIPS AND JUMPS)          3B008300
*    SKIPPING AND JUMPING OPERATIONS                                    3B008310
*      32  IS  JUMP EXIT                                                3B008320
*      33  IS  JUMP                                                     3B008330
*      34  IS  JUMP RETURN                                              3B008340
*      35  IS  SKIP IF TRUE                                             3B008350
*      36  IS  SKIP 3 IF TRUE                                           3B008360
*      37  IS  SKIP IF FALSE                                            3B008370
*      38  IS  SKIP 3 IF FALSE                                          3B008380
 JUMPS TXL     JMPXIT,1,32         OPERATION IS JUMP EXIT               3B008390
       SXA     OPT2A,1             SAVE TYPE                            3B008400
       TSX     OPAND,1             GET ARGUMENT                         3B008410
 OPT2A AXT     **,1                OPERATION TYPE                       3B008420
 33B   NULL                                                             3B008430
       TXH     *+3,1,33            OPERATION IS NOT JUMP                3B008440
*    OPERATION IS SIMPLE JUMP                                           3B008450
       STA     INCSX               ESTABLISH JUMP ADDRESS               3B008460
       TRA     INCSX                                                    3B008470
       SPACE   2                                                        3B008480
 33E   NULL                                                             3B008490
       TNX     JMPRET,1,34         GO DO JUMP RETURN                    3B008500
 35B   NULL                                                             3B008510
*    OPERATION IS SKIP TYPE                                             3B008520
       LXA     INCSX,4                                                  3B008530
       XEC     SKIPOP+4,1                                               3B008540
       XEC     SKIPNO+4,1                                               3B008550
       SPACE   2                                                        3B008560
SKIPOP TNZ     INCSX+1             SKIP 3 IF FALSE                      3B008570
       TNZ     INCSX+1             SKIP   IF FALSE                      3B008580
       TZE     INCSX+1             SKIP 3 IF TRUE                       3B008590
       TZE     INCSX+1             SKIP   IF TRUE                       3B008600
SKIPNO TXI     INCSX+1,4,3         SKIP 3 IF FALSE                      3B008610
       TXI     INCSX+1,4,2         SKIP   IF FALSE                      3B008620
       TXI     INCSX+1,4,3         SKIP 3 IF TRUE                       3B008630
       TXI     INCSX+1,4,2         SKIP   IF TRUE                       3B008640
       SPACE   3                                                        3B008650
 NEG   TXH     FALSE,1,1                                                3B008660
 TRUE  CLA     =1                                                       3B008670
       TSX     PSHDN,4                                                  3B008680
       TRA     RDOP10                                                   3B008690
 FALSE ZAC                                                              3B008700
       TRA     TRUE+1                                                   3B008710
       SPACE   3                                                        3B008720
 DONE  TRA     TRUE                                                     3B008730
       TRA     FALSE                                                    3B008740
       TRA     TRUE                                                     3B008750
 35E   NULL                                                             3B008760
       EJECT                                                            3B008770
 32B   NULL                                                             3B008780
*    JUMP EXIT                                                          3B008790
JMPXIT CLA     RJMPM                                                    3B008800
       STA     INCSX                                                    3B008810
       PDX     ,2                                                       3B008820
       CLA     0,2                                                      3B008830
       STO     RJMPM                                                    3B008840
       SXA     PSHDN,2                                                  3B008850
       TSX     PSHUP,4                                                  3B008860
       TRA     INCSX                                                    3B008870
*    RETURN JUMP                                                        3B008880
JMPRET ZET     UNDEF                                                    3B008890
       TRA     INCSX                                                    3B008900
       PAX     ,1                                                       3B008910
       CLA     RJMPM                                                    3B008920
       TSX     PSHDN,4                                                  3B008930
       STO     0,2                                                      3B008940
       CLA     INCSX                                                    3B008950
       STA     RJMPM                                                    3B008960
       PXD     ,2                                                       3B008970
       STD     RJMPM                                                    3B008980
       SXA     INCSX,1                                                  3B008990
       TRA     INCSX                                                    3B009000
       SPACE   4                                                        3B009010
 32E   NULL                                                             3B009020
       SPACE   3                                                        3B009030
RJMPM  PZE     **,,**                                                   3B009040
       TTL     IBDIN             OPERATIONS                             3B009050
*    OPERATIONS 39 AND 40                                               3B009060
*      39  IS  ADDRESS TO VALUE                                         3B009070
*      40  IS  VALUE TO ADDRESS                                         3B009080
 39B   NULL                                                             3B009090
OPTOR4 TSX     PSHUP,4                                                  3B009100
 OPTR4 ANA     =O000000077777      CLEAR ALL BUT ADDRESS                3B009110
       TSX     RDOP8,4                                                  3B009120
       TRA     RDOP10                                                   3B009130
 OPT40 TSX     FXOPND,1                                                 3B009140
       PXA     ,4                                                       3B009150
       ORA     OPT45               MAKE ADDRESS OF DICTIONARY MODE LOC. 3B009160
       TRA     OPTR4+1                                                  3B009170
 OPT45 PON     0,0,8               ADDRESS POINTER, DICTIONARY MODE     3B009180
 39E   NULL                                                             3B009190
       EJECT                                                            3B009200
*    OPERATION IS DESTRUCTIVE STORE   -  41                             3B009210
 41B   NULL                                                             3B009220
 DSTOR TSX     OPAND,1                                                  3B009230
       SXD     DSTO1,4             SAVE MODE OF OPERAND                 3B009240
       TXI     *+1,4,-1              BUMP DOWN ONE                      3B009250
       SXD     DSTO2,4              AND SAVE                            3B009260
       STO     AHIGH                                                    3B009270
 DSTI  TSX     PSHUP,4             GET STORAGE LOCATION                 3B009280
       TMI     DSTORM              MACHINE REGISTER                     3B009290
       SUB     =1B2                IS IT PARTIAL WORD STORE             3B009300
       TMI     DSTIM                -YES, GO EVALUATE STORAGE WORD      3B009310
       ZET     UNDEF                                                    3B009320
       TRA     INCSX                                                    3B009330
       PDX     ,1                  MODE OF STORAGE CELL                 3B009340
       PAC     ,2                                                       3B009350
       CLA     AHIGH                                                    3B009360
 DSTO1 TXH     DSTO3,1,**          OPERAND MODE .LT. CELL MODE          3B009370
 DSTO2 TXL     DSTO4,1,**          OPERAND MODE .GT. CELL MODE          3B009380
 DSTO5 TXL     RDOP10,1,13         ONLY SINGLE WORD STORE               3B009390
       STQ     1,2                                                      3B009400
       TRA     RDOP10                                                   3B009410
 DSTO3 TXL     DSTO5,1,6           BOTH ARE INTEGER TYPE                3B009420
       TXL     DSTO6,1,7           NOT DICTIONARY MODE                  3B009430
       TXL     DSTO5,1,8                                                3B009440
 DSTO6 TSX     AOPFL,4             FLOAT OPERAND                        3B009450
       TXL     DSTO5,1,13                                               3B009460
 DSTO7 LDQ     =0                                                       3B009470
       TRA     DSTO5                                                    3B009480
 DSTO4 LXD     DSTO1,4             MODE OF OPERAND                      3B009490
       TXL     DSTO5,4,6           BOTH ARE INTEGER TYPE                3B009500
       TXL     DSFIX,4,7                                                3B009510
       TXL     DSTO5,4,8                                                3B009520
       TXH     DSTO7,1,6                                                3B009530
 DSFIX TSX     FIX,4                                                    3B009540
       TRA     DSTO5                                                    3B009550
 41E   NULL                                                             3B009560
 AHB   NULL                                                             3B009570
DSTORM PAX     ,2                  STORE INTO MACHINE REGISTER          3B009580
       ZET     UNDEF                                                 (8)3B009583
       TRA     INCSX                                                 (8)3B009586
       TNX     DSTORX,2,7          (GO STORE INDEX REGISTER)            3B009590
       CLA     AHIGH                                                    3B009600
       STO*    OPANTB+4,2          STORE INTO APPROPRIATE REGISTER      3B009610
       TRA     INCSX                                                    3B009620
DSTORX ALS     15                                                       3B009630
       STT     DSTX                                                     3B009640
       CLA     AHIGH                                                    3B009650
       LXD     DSTO1,1                                                  3B009660
       TXH     *+3,1,8                                                  3B009670
       TXH     *+3,1,7                                                  3B009675
       TXL     *+2,1,6                                                  3B009680
       TSX     FIX,4                                                    3B009690
       ADD     DSTY                                                     3B009700
       PAC     ,1                                                       3B009710
       XEC     DSTOTB,2            STORE INTO APPROPRIATE XR            3B009720
 DSTX  PAC     ,**                 (IN CASE XR3, 5, 6, OR 7)            3B009730
       TRA     INCSX                                                    3B009740
 DSTY  OCT     -377777700000                                            3B009750
       SXD     X7X6,1                                                   3B009760
       SXA     X7X6,1                                                   3B009770
       SXD     X5X3,1                                                   3B009780
       SXD     X4ETC,1                                                  3B009790
       SXA     X5X3,1                                                   3B009800
       SXD     QPX2X1,1                                                 3B009810
       SXA     QPX2X1,1                                                 3B009820
DSTOTB NULL                                                             3B009821
       EJECT                                                            3B009830
*    GET MACHINE REGISTER CONTENTS                                      3B009840
 GMR   SXA     GMRX,4                                                   3B009850
       AXT     8,4                 SET REGISTER MODE = DICTIONARY       3B009860
       SXA     OPAN4+2,4                                                3B009870
       PAX     ,4                  REGISTER NUMBER                      3B009880
       TNX     GMRA,4,7            MACHINE REGISTER IS AN INDEX         3B009890
       CLA*    OPANTB+4,4          GET REGISTER CONTENTS                3B009900
 GMRX  AXT     **,4                                                     3B009910
       TRA     1,4                                                      3B009920
       SPACE   3                                                        3B009930
 GMRA  PXD     ,4                                                       3B009940
       ARS     3                                                        3B009950
       STT     GMRB                STORE INDEX NUMBER                   3B009960
       LXA     QPX2X1,1                                                 3B009970
       LXD     QPX2X1,2                                                 3B009980
       LXD     X4ETC,4                                                  3B009990
       ZSA     OPAN4+2             SET REGISTER MODE OCTAL              3B010000
 GMRB  PXA     ,**                                                      3B010010
       TRA     GMRX                                                     3B010020
OPANTB PZE     SI                                                       3B010030
       PZE     MQ                                                       3B010040
       PZE     LAC                                                      3B010050
       PZE     AC                                                       3B010060
*    OPERAND IS A MACHINE REGISTER                                      3B010070
 OPAN4 CLA     OPANA               REGISTER NUMBER                      3B010080
       TSX     GMR,4               GET THE REGISTER                     3B010090
       AXT     **,4                SET MODE                             3B010100
       TRA     OPANX                                                    3B010110
       SPACE   4                                                        3B010120
*    DUMP MACHINE REGISTER                                              3B010130
 DMPMR STA     MRNO                                                     3B010140
       TSX     GMR,4                                                    3B010150
       STO     MR                                                       3B010160
       TSX     MOTWR,4                                                  3B010170
       PZE     *+2                                                      3B010180
       TRA     INCSX                                                    3B010190
       IOCD    *+1,,4                                                   3B010200
       PZE     4,,2                                                     3B010210
 MRNO  PZE     **                                                       3B010220
       BCI     1,00000                                                  3B010230
 MR    BSS     1                                                        3B010240
 AHE   NULL                                                             3B010250
       EJECT                                                            3B010260
*    OPERATION IS PAUSE  -OPERATION 44                                  3B010270
 44B   NULL                                                             3B010280
 PAUSE TSX     .MWR,4                                                   3B010290
       PZE     1                                                        3B010300
       PZE     PAUMES,,4                                                3B010310
       HTR     INCSX                                                    3B010320
PAUMES BCI     4,DEBUG REQUEST PAUSE.                                   3B010330
 44E   NULL                                                             3B010340
       EJECT                                                            3B010350
*    OPERATION IS CALL    - 45                                          3B010360
 45B   NULL                                                             3B010370
OPCALL TSX     OPAND,1                                                  3B010380
       PAX     ,1                 NUMBER OF CALL PARAMETERS             3B010390
       SXD     OPCAL1+1,1                                               3B010400
       SXA     OPCAL2,1                                                 3B010410
       TXI     *+1,1,OPCAL1+3                                           3B010420
       SXA     OPCAL1+1,1         RETURN ADDRESS                        3B010430
       TXL     OPCAL3,1,OPCAL1+3                                        3B010440
OPCAL4 STL     CALL                                                     3B010450
       TSX     PSHUP,4                                                  3B010455
       TMI     OPCA10             EITHER UNDEFINED OR MACHINE REG       3B010460
       PAI                                                              3B010470
       LFT     700000                                                   3B010480
       TRA     OPCAL2                                                   3B010490
OPCAL6 PAI                        HOLD OPERAND                          3B010500
       LDQ     UNDEF                                                    3B010510
       STZ     UNDEF                                                    3B010520
       TSX     GETRS,4            GET A PLACE TO PUT IT                 3B010530
       STQ     UNDEF                                                    3B010540
       STI     0,2                PUT IT IN.                            3B010550
       TSX     PSHUP,4            GET POINTER TO THE CELL               3B010560
OPCAL2 AXC     **,1                                                     3B010570
       STZ     OPCAL1+2,1                                               3B010580
       STA*    *-1                                                      3B010590
       LXA     OPCAL2,1                                                 3B010600
       TNX     OPCAL3,1,1                                               3B010610
       SXA     OPCAL2,1                                                 3B010620
       TRA     OPCAL4                                                   3B010630
OPCAL3 STZ     CALL                                                     3B010640
       TSX     PSHUP,4                                                  3B010645
       STA     OPCAL1                                                   3B010650
       CAL     OPCARP                                                   3B010660
       SLW*    OPCAL1+1                                                 3B010670
       ZET     UNDEF                                                    3B010680
       TRA     INCSX-2                                                  3B010690
       TSX     PANSAV,4                                                 3B010700
       TRA     OPCAL1                                                   3B010710
OPCARP TRA     *+1                                                      3B010720
       TSX     PANRES,4                                                 3B010730
       LXA     X5X3,3                                                   3B010740
       LXD     X5X3,5                                                   3B010750
       LXA     X7X6,6                                                   3B010760
       LXD     X7X6,7                                                   3B010770
       TRA     INCSX-2                                                  3B010780
OPCA10 TSX     GMR,4               GET MACHINE REGISTER                 3B010790
       TPL     OPCAL6                                                   3B010800
OPCAL8 ORA     =-0                                                      3B010810
       TRA     OPCAL6                                                   3B010820
 45E   NULL                                                             3B010840
CALL   PZE     **                                                       3B010845
       EJECT                                                            3B010850
 48B   NULL                                                             3B010860
*    OPERATION IS 'ON'    - 48                                          3B010870
 ONOP  TSX     PSHUP,4             GET POINTER TO COUNTER               3B010880
       STA     ONOPCT                                                   3B010890
       SUB     =1B2                                                     3B010900
       TMI     ONOPIM                                                   3B010910
       CLA*    ONOPCT              GET COUNTER                          3B010920
       ADD     =1                  INCREMENT                            3B010930
       STO*    ONOPCT              AND RESTORE                          3B010940
       STO     ONOPCT                                                   3B010950
 ONOP1 TSX     FXOPND,1            GET THE 'EVERY' ENTRY                3B010960
       SXA     ONOPBM,4             AND HOLD IT.                        3B010970
       TSX     FXOPND,1            GET 'UNTIL' ENTRY                    3B010980
       PXA     ,4                                                       3B010990
       SUB     ONOPCT              SUBTRACT CURRENT COUNTER VALUE       3B011000
       TZE     *+2                 (WE ARE AT UPPER LIMIT, CONTINUE.)   3B011010
       TMI     ONOPPU              UPPER LIMIT PASSED, GIVE UP          3B011020
       TSX     FXOPND,1            GET INITIAL 'ON' ENTRY               3B011030
       ZET     UNDEF                                                    3B011040
       TRA     FALSE                                                    3B011050
       SUB     ONOPCT              SUBTRACT CURRENT COUNTER VALUE       3B011060
       TZE     TRUE                (WE ARE AT INITIAL POINT)            3B011070
       TPL     FALSE               WE HAVEN'T GOTTEN TO INTITIAL POINT  3B011080
       XCA                                                              3B011090
       ZAC                                                              3B011100
       DVP     ONOPBM              'EVERY'                              3B011110
       TNZ     FALSE               HAS A REMAINDER, SO NOT APPROPRIATE  3B011120
       TRA     TRUE                                                     3B011130
ONOPPU TSX     PSHUP,4             REMOVE TOP OPERAND FROM P.D.         3B011140
       TRA     FALSE                                                    3B011150
       SPACE   2                                                        3B011160
*   COUNTER IS IN THE TEXT                                              3B011170
ONOPIM CLA     INCSX                                                    3B011180
       LGR     1                                                        3B011190
       PAC     ,4                                                       3B011200
       TXI     *+1,4,1                                                  3B011210
       CLA     ONOPCT                                                   3B011220
       ADD     =1                                                       3B011230
       STO     ONOPCT                                                   3B011240
       TQP     *+3                                                      3B011250
       STA     .IBDBT,4                                                 3B011260
       TRA     ONOP1                                                    3B011270
       ALS     18                                                       3B011280
       STD     .IBDBT,4                                                 3B011290
       TRA     ONOP1                                                    3B011300
ONOPCT PZE     **                  CURRENT COUNTER VALUE                3B011310
ONOPBM PZE     **                  VALUE OF 'EVERY' ENTRY               3B011320
 48E   NULL                                                             3B011330
       TTL     IBDIN         OPERATIONS  (LOOPING AND DUMMY VARIABLE)   3B011340
 49B   NULL                                                             3B011350
OPTOR3 TXL     LOPINT,1,49         INITIALIZE LOOP                      3B011360
       LXA     RDOP2,4                                                  3B011370
       CLA     RDOPT+10,4                                               3B011380
       PDX     ,2                                                       3B011390
       TXL     LOP3,2,0                                                 3B011400
       STD     LOP1                                                     3B011410
       PAX     ,2                                                       3B011420
       SXD     LOP2,2                                                   3B011430
       CLA     RDOPT+9,4                                                3B011440
       PAX     ,2                                                       3B011450
LOP1   TXI     *+1,2,**                                                 3B011460
LOP2   TXH     LOP3,2,**                                                3B011470
       PXA     ,2                                                       3B011480
       STA     RDOPT+9,4                                                3B011490
       CLA     RDOPT+11,4                                               3B011500
       STA     INCSX                                                    3B011510
       TRA     INCSX                                                    3B011520
LOP3   TXI     *+1,4,-3                                                 3B011530
       SXA     RDOP2,4                                                  3B011540
       TRA     INCSX                                                    3B011550
LOPINT STL     GTSB                                                     3B011560
       TRA     INCSX                                                    3B011570
       LXA     RDOP2,4                                                  3B011580
       TXI     *+1,4,3                                                  3B011590
       SXA     RDOP2,4                                                  3B011600
       PXD     ,1                                                       3B011610
       STO     RDOPT+9,4                                                3B011620
       CLA     INCSX                                                    3B011630
       STA     RDOPT+11,4                                               3B011640
       TSX     FXOPND,1                                                 3B011650
       PXD     0,4                                                      3B011660
       LXA     RDOP2,4                                                  3B011670
       STO     RDOPT+10,4                                               3B011680
       TSX     FXOPND,1                                                 3B011690
       PXA     ,4                                                       3B011700
       LXA     RDOP2,4                                                  3B011710
       STA     RDOPT+10,4                                               3B011720
       TSX     FXOPND,1                                                 3B011730
       PXA     ,4                                                       3B011740
       LXA     RDOP2,4                                                  3B011750
       STA     RDOPT+9,4                                                3B011760
       NZT     UNDEF                                                    3B011770
       TRA     INCSX                                                    3B011780
       ZAC                                                              3B011790
       STA     RDOPT+10,4                                               3B011800
 RDOP3 CLA     RDOPT+9,2                                                3B011810
       ANA     =O077777000000                                           3B011820
       CAS     RDOP7                                                    3B011830
       TRA     *+2                                                      3B011840
       TRA     RDOP6               DUMMY VARIABLE MATCH FOUND.          3B011850
       TIX     RDOP3,2,3                                                3B011860
       TRA     RDOP4                                                    3B011870
 RDOP6 CLA     RDOPT+9,2           DUMMY VARIABLE ENTRY HAS FORM        3B011880
       ANA     =O000000077777      VALUE,,PHONY RDICT POINTER.          3B011890
       TSX     PSHDN,4                                                  3B011900
       TRA     RDOP10                                                   3B011910
RDOPT  BSS     9                                                        3B011920
 49E   NULL                                                             3B011930
       TTL     IBDIN               OPERATIONS  (SUBSCRIPTED VARIABLE)   3B011940
 51B   NULL                                                             3B011950
*      OPERATION IS SUBSCRIPT                                           3B011960
 OP51  TSX     GETSUB,4                                                 3B011970
       STZ     OP51T1                                                   3B011980
       TSX     PSHUP,4                                                  3B011990
 OP51A STA     OP51T2              NUMBER OF SUBSCRRPTS                 3B012000
       TSX     FXOPND,1                                                 3B012010
       PXA     ,4                                                       3B012020
       SUB     =1                                                       3B012030
       ADD     OP51T1                                                   3B012040
       AXC     GTSBB-1,4                                                3B012050
       XCA                                                              3B012060
       MPY*    OP51T2                                                   3B012070
       STQ     OP51T1                                                   3B012080
       CLA     OP51T2                                                   3B012090
       SUB     =O400001                                                 3B012100
       TNZ     OP51A                                                    3B012110
       LXA     OP51T1,4                                                 3B012120
       PXA     ,4                                                       3B012130
       ADD     GTSBB+4                                                  3B012140
       ADD     GTSBB+6                                                  3B012150
       TSX     RDOP8,4                                                  3B012160
       TRA     RDOP10                                                   3B012170
OP51T1 BSS     1                                                        3B012180
OP51T2 PZE     **,4                                                     3B012190
 51E   NULL                                                             3B012200
       TTL     IBDIN             OPERATIONS  (DUMPS)                    3B012210
*    OUTPUT FINAL DUMP RECORD                                           3B012220
 DMP90 NZT     WDCNT               HAVE ANY DUMPS BEEN TAKEN            3B012230
       TRA     2,1                  -NO, IGNORE FILE CLOSE              3B012240
 AFB   NULL                                                             3B012250
       TSX     MOTWR+2,4                                                3B012260
       PZE     DMP9L                                                    3B012270
       TRA     1,1                                                      3B012280
 DMP9L IOCP    *+2,,1                                                   3B012290
       IORT    .JLIN,,1                                                 3B012300
       PZE     2,,7                                                     3B012310
       EJECT                                                            3B012320
 DUMPS NZT     NODUMP              HAS LINE-MAX CUT OFF DUMPS           3B012330
       ZET     DUMP                HAS STR LOCATION BEEN OUTPUT         3B012340
       TRA     DMP10                -YES, PROCEED WITH DUMP             3B012350
       STL     DUMP                                                     3B012360
       TSX     MOTWR,4                                                  3B012370
       PZE     STRLST                                                   3B012380
       CLA     .IBDB1                                                   3B012390
       TMI     DMP10                                                    3B012400
       AXT     **,4                DUMP NUMBER (INITIALLY = 0)          3B012410
       TXI     *+1,4,1             INCREMENT                            3B012420
       SXA     *-2,4               AND SAVE                             3B012430
       PXA     ,4                                                       3B012440
       TSX     .DECVA,4            CONVERT TO BCD                       3B012450
       STQ     DMPNO                                                    3B012460
       CALL    .LXSL1(DMPNUM)      PRINT DUMP NUMBER OFF-LINE.      (10)3B012470
 DMP10 TXL     DMP20,1,64          SINGLE WORD DUMP                     3B012480
       TXL     DMP30,1,65          'B' TO 'A' IN MODE 'C'               3B012490
       TXL     DMP40,1,66          DUMP A  (ENTRY OR ARRAY)             3B012500
       TXL     DMP50,1,67          PANEL                                3B012510
       TXL     DMP60,1,68          BCI STRING  (COMMENT)                3B012520
       TXL     DMP70,1,69          DUMP PROGRAM                         3B012530
       EJECT                                                            3B012540
*    DUMP PACKAGE OUTPUT ROUTINE                                        3B012550
*    ENTERED ONCE PER LOGICAL RECORD                                    3B012560
 MOTWR ZET     NODUMP                                                   3B012570
       TRA     2,4                                                      3B012580
       SXA     MOTXT,4                                                  3B012590
       SXA     MOTXT+1,2                                                3B012600
       SXA     MOTXT+2,1                                                3B012610
       TRA     BLOCK+1                                                  3B012620
 MOT05 CLA     1,4                GET POINTER TO I/O LIST               3B012630
       PAC     ,4                                                       3B012640
 MOT10 CLA     0,4                 GET COMMAND                          3B012650
       STP     MOTCOM              SAVE TYPE                            3B012660
       TPL     *+2                 TRA IF LAST COMMAND IN LIST          3B012670
       SXA     MOT50,4              SAVE POINTER TO COMMAND             3B012680
       PDX     ,2                  NUMBER OF WORDS BEING WRITTEN        3B012690
       PXA     ,2                                                       3B012700
       ADD     WDCNT                                                    3B012710
       STO     WDCNT                                                    3B012720
       LDQ     WRDMAX                                                   3B012730
       TLQ     *+2                                                      3B012740
       TRA     *+4                                                      3B012750
       STL     NODUMP                                                   3B012760
       CLA     INCSX                                                    3B012770
       STT     DMP9L+2                                                  3B012780
       CLA     0,4                                                      3B012790
       PDX     ,2                                                       3B012800
       TXL     MOT50,2,0           TRA IF NONE                          3B012810
       AXC     MOT30,1             SET UP MOT70 EXIT                    3B012820
       ARS     18                                                       3B012830
       ACL     0,4                 COMPUTE LAST ADDRESS +1              3B012840
       STA     *+2                                                      3B012850
 MOT20 LAC     BLOCK,4             CURRENT NUMBER OF WORDS IN BLOCK     3B012860
       CLA     **,2                GET DATA WORD                        3B012870
       STO     BLOCK,4              AND PUT INTO BLOCK                  3B012880
       PXA     1,4                                                      3B012890
       SBM     *-1                 RECOMPLEMENT AND BUMP BY 1           3B012900
       STA     BLOCK               KEEP WORD COUNT UP TO DATE           3B012910
       TXL     MOT70,4,-BLKSIZ+1   BLOCK IS FULL, WRITE IT              3B012920
 MOT30 TIX     MOT20,2,1           GO BACK FOR MORE WORDS               3B012930
 MOT50 AXT     **,4                (NON-ZERO IF MORE COMMANDS IN LIST)  3B012940
       TXL     MOT60,4,0           NO MORE COMMANDS                     3B012950
       ZSA     MOT50               RESET FOR NEXT COMMAND               3B012960
       TXI     MOT10,4,-1           AND RETURN TO PROCESS IT.           3B012970
 MOT60 ZET     MOTCOM                                                   3B012980
       TRA     MOT65,4             NOT IOCD, FORCE OUT RECORD           3B012990
 MOTXT AXT     **,4                RESTORE IR'S                         3B013000
       AXT     **,2                 AND EXIT                            3B013010
       AXT     **,1                                                     3B013020
       TRA     2,4                                                      3B013030
 MOT65 AXC     MOTXT,1             SET MOT70 EXIT TO THIS               3B013040
 MOT70 LXA     BLOCK,4             GET LENGTH OF BLOCK                  3B013050
       TXH     *+2,4,2             IF LESS THAN 3 WORDS                 3B013060
       AXT     3,4                  MAKE IT THREE                       3B013070
       PCCON                                                            3B013080
       IFF     DISK=1                                                   3B013090
       GOTO    IFT,BLANK                                                3B013100
       SPACE   3                                                        3B013110
*   THE FOLLOWING CODE WILL BE OVERLAID BY THE CODE REQUIRED TO         3B013120
*   WRITE ON TAPE IF THE DEBUG FILE IS NOT ON DISK (OR DRUM).           3B013130
*          (SEE CODE BEGINNING AT MOT84)                                3B013140
 MOT7A NULL                                                             3B013150
       SXA     BLOCK-1,4                                                3B013160
       TXI     *+1,4,1                                                  3B013170
       SXD     MOTL1+1,4                                                3B013180
       LXA     .JDTRK,4                                                 3B013190
 MOTCL TXH     MOT71,4,**          TRA IF NO MORE TRACKS AVAILABLE      3B013200
       PXD     ,4                                                       3B013210
       SSM                                                              3B013220
       STO     .LXDIS                                                   3B013230
       TXI     *+1,4,1                                                  3B013240
       SXA     .JDTRK,4                                                 3B013250
       SXD     BLOCK-1,4                                                3B013260
       CALL    .LXSL1(MOTL1)                                        (10)3B013270
       LXA     .JDTRK,4                                                 3B013280
       PXD     ,4                                                       3B013290
       SSM                                                              3B013300
       STO     .LXDIS                                                   3B013310
       CALL    .LXSL1(MOTL2)                                        (10)3B013320
       TRA     MOT7B                                                    3B013330
 MOTL1 PTH     SYSCK2,,*+1                                              3B013340
       CPYP    BLOCK-1,,**                                              3B013350
       TCH     .LTCH                                                    3B013360
 MOTL2 PTW     SYSCK2,,*+1                                              3B013370
       CPYP    *+2,,2                                                   3B013380
       TCH     .LTCH                                                    3B013390
       SIX     1,,**                                                    3B013400
       OCT     170000000000                                             3B013410
 IFT   REM                                                              3B013420
       IFT     DISK=1                                                   3B013430
       GOTO    PCCBAK,BLANK                                             3B013440
       SXD     MOTL+1,4                                                 3B013450
       CALL    .LXSL1(MOTL)        WRITE BLOCK ONTO DEBUG FILE      (10)3B013460
PCCBAK PCCBAK                                                           3B013470
 MOT7B ZET     DUMP1               IS THIS FIRST RECORD OUTPUT          3B013480
       TRA     MOT71                                                    3B013490
       STL     DUMP1                                                    3B013500
       TSX     .MWR,4             TELL OPERATOR THAT THERE IS INFO      3B013510
       PZE     1                    ON SYSCK2                           3B013520
       PZE     DBONCK,,7                                                3B013530
       CAL     =HIBJOB                                                  3B013540
       SLW     SYSGET                                                   3B013550
       CAL     =1B16                                                    3B013560
       ORS     SYSJOB                                                   3B013570
 MOT71 AXT     1,4                                                      3B013580
       SXA     BLOCK,4                                                  3B013590
       TRA     0,1                 RETURN TO PROPER PROCESSING          3B013600
       SPACE   2                                                        3B013610
*   MOTWR WORKING STORAGE                                               3B013620
MOTCOM PZE     0                   FLAG TO FORCE OUT BUFFER             3B013630
       PCCON                                                            3B013640
       IFT     DISK=1                                                   3B013650
       GOTO    PCCBAK,BLANK                                             3B013660
 MOTL  PTH     SYSCK2,,*+1         WRITE BINARY ON SYSCK2               3B013670
       CPYP    BLOCK,,**                                                3B013680
       TCH     .LTCH                                                    3B013690
PCCBAK PCCBAK                                                           3B013700
*    OUTPUT BUFFER                                                      3B013710
BUFFR  EQU     241                 SIZE OF DMPTRN BUFFER                3B013720
BLKSIZ EQU     256                 PHYSICAL RECORD SIZE                 3B013730
       IFT     DISK=1                                                   3B013740
       MZE     **,,**                                                   3B013750
 BLOCK PZE     **,,3000            PHYSICAL RECORD CONTROL WORD         3B013760
       CLA     .IBDB1                                                   3B013770
       TMI     MOT82               NOMES OPTION IN EFFECT               3B013780
       AXT     BLOCK,4                                                  3B013790
       PXD     ,4                                                       3B013800
       XCA                                                              3B013810
       TSX     .BCD5R,4                                                 3B013820
       SLW     BLKMES                                                   3B013830
       CALL    .LXSL1(MOT80)                                        (10)3B013840
 MOT82 AXT     1,4                                                      3B013850
       SXA     BLOCK,4                                                  3B013860
       LAC     SYSUNI,4                                                 3B013870
       LDQ*    SYSCK2,4                                                 3B013880
       TSX     .SYMUN,4                                                 3B013890
       SLW     DBONCK+5                                                 3B013900
       PCCON                                                            3B013910
       IFF     DISK=1                                                   3B013920
       GOTO    PCCBAK,BLANK                                             3B013930
       LXA     .JDTRK,4            IS DEBUG FILE ON DISK                3B013940
       TNX     MOT84,4,1            -NO, GO ESTABLISH CODING FOR TAPE   3B013950
       SXD     MOTL2+3,4            -YES, SAVE LOC OF PREVIOUS EOF.     3B013960
       LDC     SYSUNI,4                                                 3B013970
       SXD     *+2,4                                                    3B013980
       LAC     SYSUNI,4                                                 3B013990
       TXI     *+1,4,**            COMPUTE UPPER TRACK LIMIT TEST       3B014000
       CLA     SYSCK2,4                                                 3B014010
       ACL     =O077777000000      DECREASE DECREMENT BY 1              3B014020
       STD     MOTCL                                                    3B014030
       TRA     MOT83                                                    3B014040
 MOT84 AXT     MOT86-MOT85,4                                            3B014050
       CLA     MOT86,4                                                  3B014060
       STO     MOT86-OFSET,4                                            3B014070
       TIX     *-2,4,1                                                  3B014080
       LXA     MOT85+2,4           (TXI IN CALL)                        3B014090
       TXI     *+1,4,-OFSET                                             3B014100
       SXA     MOT85+2-OFSET,4                                          3B014110
PCCBAK PCCBAK                                                           3B014120
 MOT83 LXA     .IBDB1,4                                                 3B014130
       PXA     ,4                                                       3B014140
       ALS     3                                                        3B014150
       STO     WRDMAX                                                   3B014160
       LXA     MOTXT,4                                                  3B014170
       CLA     *+2                                                      3B014180
       STO     MOT05-1                                                  3B014190
       TRA     MOT05                                                    3B014200
 MOT80 PTW     SYSOU1,,*+1                                              3B014210
       IORP    *+2,,5                                                   3B014220
       TCH     .LTCH                                                    3B014230
 MOT81 BCI     3,       (BUFFER AT                                      3B014240
BLKMES BCI     2, *****)                                                3B014250
       PCCON                                                            3B014260
       IFF     DISK=1                                                   3B014270
       GOTO    PCCBAK,BLANK                                             3B014280
 MOT85 NULL                                                             3B014290
       SXD     MOTL+1,4                                                 3B014300
       CALL    .LXSL1(MOTL)                                         (10)3B014310
       TRA     MOT7B                                                    3B014320
 OFSET EQU     MOT85-MOT7A                                              3B014330
 MOTL  EQU     *-OFSET                                                  3B014340
       PTH     SYSCK2,,MOTL+1                                           3B014350
       CPYP    BLOCK,,**                                                3B014360
       TCH     .LTCH                                                    3B014370
 MOT86 NULL                                                             3B014380
PCCBAK PCCBAK                                                           3B014390
 LREQ  MAX     *-BLOCK,BLKSIZ                                           3B014400
       BSS     BLOCK+LREQ-*                                             3B014410
NODUMP PZE     0                   IF NON-ZERO NO MORE DUMPS WILL OCCUR 3B014420
WRDMAX BSS     1                   MAXIMUM WORDS TO BE OUTPUT BY MOTWR  3B014430
       SPACE   2                                                        3B014440
*    THE FOLLOWING CELLS ARE USED TO DISPLAY THE DUMP NUMBER ON SYSOU1  3B014450
DMPNUM PTW     SYSOU1,,*+1                                              3B014460
       IORP    *+2,,3                                                   3B014470
       TCH     .LTCH                                                    3B014480
       BCI     2, DUMP NUMBER                                           3B014490
 DMPNO BCI     1, *****            WILL CONTAIN DUMP NUMBER IN BCI      3B014500
       SPACE   2                                                        3B014510
DBONCK BCI     7,DEBUG INFORMATION ON SYSCK2. (******)                  3B014520
 AFE   NULL                                                             3B014530
       EJECT                                                            3B014540
*    DUMP A SINGLE ENTRY                                                3B014550
 64B   NULL                                                             3B014560
 DMP20 TSX     PSHUP,4                                                  3B014570
       ZET     UNDEF                                                    3B014580
       TRA     INCSX                                                    3B014590
       TMI     DMPMR               DUMP MACHINE REGISTER                3B014600
       STA     DMP37+1                                                  3B014610
       PDX     ,1                                                       3B014620
       TXL     *+2,1,13            TRA IF NOT DBL OR CMPLX              3B014630
       ADD     =1                                                       3B014640
       ALS     18                                                       3B014650
       STD     DMP37+1                                                  3B014660
       TRA     DMP45                                                    3B014670
 64E   NULL                                                             3B014680
       EJECT                                                            3B014690
 66B   NULL                                                             3B014700
*    TABLE OF MODES                                                     3B014710
       BCI     1,00000J           COMPLEX NUMBER                        3B014720
       BCI     1,00000D           DOUBLE PRECISION                      3B014730
       BCI     1,00000            UNDEFINED                             3B014740
       BCI     1,00000            UNDEFINED                             3B014750
       BCI     1,00000            UNDEFINED                             3B014760
       BCI     1,00000            UNDEFINED                             3B014770
       BCI     1,00000            UNDEFINED                             3B014780
       BCI     1,00000            UNDEFINED                             3B014790
       BCI     1,00000F           FLOATING POINT                        3B014800
       BCI     1,00000H           ALPHANUMERIC                          3B014810
       BCI     1,00000X           DECIMAL INTEGER                       3B014820
       BCI     1,00000L           LOGICAL (BOOLEAN)                     3B014830
       BCI     1,00000            UNDEFINED                             3B014840
       BCI     1,00000C           SYMBOLIC COMMAND                      3B014850
       BCI     1,00000S           SYMBOLIC INSTRUCTION                  3B014860
MODTAB BCI     1,00000O           OCTAL                                 3B014870
       SPACE   5                                                        3B014880
*    DUMP 'A' (ELEMENT OR ARRAY)                                        3B014890
 DMP40 TSX     GETSUB,4                                                 3B014900
       ALS     18                                                       3B014910
       STD     DMP37+1             LAST LOCATION OF ARRAY               3B014920
       CLA     GTSBB+4                                                  3B014930
       STA     DMP37+1             FIRST LOCATION OF ARRAY              3B014940
 DMP45 CLA     MODTAB,1                                                 3B014950
       TRA     DMP30A                                                   3B014960
 66E   NULL                                                             3B014970
       SPACE   8                                                        3B014980
DMPALL NULL                                                             3B014990
       EJECT                                                            3B015000
*    DUMP CORE FROM 'B' TO 'A' IN MODE 'C'                              3B015010
 65B   NULL                                                             3B015020
       CLA     *                                                        3B015030
       STO     MOTWR+1             FORCE MOTWR TO WORK AFTER LINE MAX.  3B015040
       CLA     DMP30A-1                                                 3B015050
       STT     RDLRC                                                    3B015060
       TSX     MOTWR,4                                                  3B015070
       PZE     STRLST                                                   3B015080
       LDI     =H00000                                                  3B015090
       TSX     PSHDN,4                                                  3B015100
       STI     0,2                                                      3B015110
       TSX     PSHDN,4                                                  3B015120
       STZ     0,2                                                      3B015130
       TSX     PSHDN,4                                                  3B015140
       LDI     =O77777                                                  3B015150
       STI     0,2                                                      3B015160
 DMP30 TSX     PSHUP,4                                                  3B015170
       PDX     ,4                                                    (4)3B015171
       TXL     *+2,4,13                                              (4)3B015172
       ADD     =1                                                    (4)3B015173
       ALS     18                                                       3B015180
       STD     DMP37+1                                                  3B015190
       TSX     PSHUP,4                                                  3B015200
       STA     DMP37+1                                                  3B015210
       LDQ     DMP37+1                                               (7)3B015211
       RQL     18                                                    (7)3B015212
       CAL     DMP37+1                                               (7)3B015213
       TLQ     *+2                                                   (7)3B015214
       STQ     DMP37+1                                               (7)3B015215
       TSX     OPAND,1             GET MODE                             3B015220
DMP30A ZET     UNDEF                                                    3B015230
       TRA     INCSX                                                    3B015240
       ANA     =O77                KEEP ONE CHARACTER                   3B015250
       SLW     DMP37+2                                                  3B015260
       TSX     MOTWR,4             OUTPUT CORE MACRO RECORD             3B015270
       PZE     DMP36                                                    3B015280
 DMP32 LAC     DMP37+1,1           START LOCATION                       3B015290
       LXD     DMP37+1,4           END LOCATION                         3B015300
       SXA     GET+2,4                                                  3B015310
       SXD     *+1,1                                                    3B015320
       TXI     *+1,4,**            MAKE X4 = (NUMBER OF CELLS EXAMINED) 3B015330
       AXT     0,1                                                      3B015340
 GET   CLA*    *+2                                                      3B015350
       TNX     EOBLOC,4,1                                               3B015360
GET1   CAS     **,4                                                     3B015370
       TRA     *+2                                                      3B015380
       TXI     *-3,1,1             BUMP COUNT OF MATCHES                3B015390
       TXL     GET-1,1,MATMAX-2                                         3B015400
 EOB1  SXD     ALCON+2,1      NUMBER OF MATCHES FOUND                   3B015410
       SXD     MATNO,1                                                  3B015420
 MATNO TXI     *+1,4,**                                                 3B015430
       STO     ALCON+3             WORD THAT IS THE CONSECUTIVE CELLS   3B015440
       PXA     ,4                                                       3B015450
       SBM     GET+2               COMPUTE EFFECTIVE ADDRESS            3B015460
       STA     ALCON+2             FIRST WORD OF BLOCK                  3B015470
       ADD     =1                   (MINUS 1)                           3B015480
       STA     AHIGH               ENDING LOCATION OF BLOCK BEING DUMPED3B015490
 EOB2  LXA     DMP37+1,4                                                3B015500
       SXA     BHIGH,4                                                  3B015510
*   OUTPUT ONE OR MORE DETAIL RECORDS                                   3B015520
 DMP31 LXA     AHIGH,1                                                  3B015530
       LXA     BHIGH,2                                                  3B015540
       LAC     BHIGH,4                                                  3B015550
       SXD     *+1,4                                                    3B015560
       TXI     *+1,1,**            MAKE X1=(NUMBER OF CELLS)-1          3B015570
       TXI     *+1,1,3             MAKE X1=RECORD LENGTH                3B015590
       TXL     DMP33,1,BUFFR        IT WILL ALL FIT INTO BUFFER         3B015600
       AXT     BUFFR-2,1           NUMBER OF CELLS TO BE OUTPUT         3B015610
       PXA     ,1                                                       3B015620
       ADM     BHIGH               ESTABLISH NEXT START POINT           3B015630
       STA     BHIGH                                                    3B015640
       STL     DMPCYC              MARK FOR REITERATION                 3B015650
       TXI     DMP33+1,1,2         MAKE X1=RECORD LENGTH                3B015660
 DMP33 STZ     DMPCYC                                                   3B015670
       SXA     DMP39+1,2           START LOCATION                       3B015680
       SXA     DMP38+1,2                                                3B015690
       SXA     DMP39,1             RECORD LENGTH                        3B015700
       TXI     *+1,1,-2                                                 3B015710
       SXD     DMP38+1,1           NUMBER OF CELLS OUTPUT               3B015720
       TSX     MOTWR,4             PUT OUT DETAIL RECORD                3B015730
       PZE     DMP38                                                    3B015740
       ZET     DMPCYC              DO WE NEED TO DUMP MORE              3B015750
       TRA     DMP31                -YES                                3B015760
ALLMAT LXD     ALCON+2,2           IS AN 'ALL CONTAIN' MESSAGE          3B015770
       TXL     DMP34,2,0            IN ORDER                            3B015780
       TSX     MOTWR,4              -YES, GIVE IT                       3B015790
       PZE     ALCON                                                    3B015800
       SXD     *+2,2                                                    3B015810
       LXA     AHIGH,4             END OF PRECEEDING DUMP               3B015820
       TXI     *+1,4,**             + LENGTH OF 'ALL CONTAIN' AREA      3B015830
       TXI     *+1,4,1                                                  3B015840
       SXA     DMP37+1,4           BEGINNING OF NEXT SEARCH AREA        3B015850
       ZSD     ALCON+2             RESET 'ALL CONTAIN' COUNT            3B015860
       NZT     ENDMAT              WAS END OF DESIRED BLOCK REACHED     3B015870
       TRA     DMP32                -NO                                 3B015880
 DMP34 STZ     ENDMAT                                                   3B015890
       TRA     INCSX                                                    3B015900
ENDMAT PZE     **                                                       3B015910
EOBLOC TXI     *+1,4,-1                                                 3B015920
       TXL     GET1,4,-2                                                3B015930
       STL     ENDMAT                                                   3B015940
       TXH     EOB1,1,MATMAX-2                                          3B015950
       LXD     DMP37+1,4                                                3B015960
       SXA     AHIGH,4                                                  3B015970
       TRA     EOB2                                                     3B015980
 ALCON IOCD    *+1,,3                                                   3B015990
       PZE     3,1,5                                                    3B016000
       PZE     **,,**                                                   3B016010
       BSS     1                                                        3B016020
STRTPT PZE     **                                                       3B016030
MATMAX EQU     8                   NUMBER OF CONSECUTIVE CELLS REQUIRED 3B016040
       SPACE   2                                                        3B016050
DMP36  IOCD    DMP37,,3            CORE MACRO COMMAND                   3B016060
*    THE FOLLOWING THREE CELLS ARE THE IMAGE FOR CORE MACRO INFORMATION 3B016070
DMP37  PZE     3,,2                                                     3B016080
       PZE     **,,**                                                   3B016090
       BCI     1,00000X                                                 3B016100
       SPACE   2                                                        3B016110
DMPCYC BSS     1                   REITERATION FLAG, DUMP DETAIL        3B016120
       SPACE   2                                                        3B016130
DMP38  IOCP    DMP39,,2            COMMANDS FOR                         3B016140
       IOCD    **,,**                CORE DETAIL RECORD                 3B016150
*    THE FOLLOWING TWO WORDS ARE THE IMAGE FOR A CORE DETAIL RECORD     3B016160
DMP39  PZE     **,,4                                                    3B016170
       PZE     **                                                       3B016180
       SPACE   5                                                        3B016190
 OP52  TSX     GETSUB,4                                                 3B016200
       TSX     RDOP8,4                                                  3B016210
       TRA     RDOP10                                                   3B016220
 65E   NULL                                                             3B016230
       SPACE   5                                                        3B016240
       TTR     .LXSTR                                                   3B016250
FKSTOP OCT     000037000053        TRY FULL DUMP AND TERMINATE          3B016260
 LXSTR LTM                                                              3B016270
       LDI     FKSTOP                                                   3B016280
       STI     .IBDBT                                                   3B016290
       EJECT                                                            3B016300
*    DISPLAY PANEL INFORMATION                                          3B016310
 67B   NULL                                                             3B016320
       ZSA     INCSX                                                    3B016330
       CLA     *                                                        3B016340
       STO     MOTWR+1             FORCE MOTWR TO WORK AFTER LINE MAX   3B016350
       CLA     DMP50+1                                                  3B016360
       STT     RDLRC                                                    3B016370
       TSX     MOTWR,4                                                  3B016380
       PZE     STRLST                                                   3B016390
 DMP50 SXA     X5X3,3                                                   3B016400
       AXT     9,1                                                      3B016410
       AXT     7,3                                                      3B016420
       SXA     PANRC,1                                                  3B016430
       LXA     X5X3,3                                                   3B016440
       ENK                                                              3B016450
       STQ     ENK                                                      3B016460
       TSX     PANSAV,4                                                 3B016470
       AXT     6,1                                                      3B016480
 DMP53 PSE     119,1                                                    3B016490
       TRA     *+2                                                      3B016500
       OAI                                                              3B016510
       ARS     1                                                        3B016520
       TIX     DMP53,1,1                                                3B016530
       STI     X4ETC                                                    3B016540
       LXA     PANRC,4                                                  3B016550
       SXD     PANLST,4                                                 3B016560
       TSX     MOTWR,4                                                  3B016570
       PZE     PANLST                                                   3B016580
       TSX     PANRES,4                                                 3B016590
       TRA     INCSX                                                    3B016600
 67E   NULL                                                             3B016610
       LDI     SI                                                       3B016620
       AXT     1,4                                                      3B016630
       SXA     INCSX,4                                                  3B016640
       LXD     X4ETC,4                                                  3B016650
       TTR     DMPALL                                                   3B016660
       EJECT                                                            3B016670
*   DUMP ENTIRE PROGRAM                                                 3B016680
 69B   NULL                                                             3B016690
 DMP70 AXT     DMP75,4                                                  3B016700
       SXA     DMP34+1,4                                                3B016710
       AXT     IBDB8E-.IBDB8,4                                          3B016720
 DMP73 SXA     DMP75,4                                                  3B016730
       CAL     IBDB8E,4                                                 3B016740
       TZE     DMP76                                                    3B016750
       STD     DMP37+1                                                  3B016760
       STA     DMP37+1                                                  3B016770
       CAL     =H00000                                                  3B016780
       TRA     DMP30A                                                   3B016790
 DMP75 AXT     **,4                                                     3B016800
 DMP76 TIX     DMP73,4,1                                                3B016810
       AXT     INCSX,4                                                  3B016820
       SXA     DMP34+1,4                                                3B016830
       TRA     INCSX                                                    3B016840
 69E   NULL                                                             3B016850
.IBDB8 PZE     **,,**              (FILLED WITH DUMP LIMITS BY IBLDR)   3B016860
       PZE     **,,**               (NON-MAIN LINK LIMITS)              3B016870
       PZE     **,,**               (BLANK COMMON LIMITS)               3B016880
IBDB8E NULL                                                             3B016890
       EJECT                                                            3B016900
*    DUMP BCI STRING  (COMMENT RECORD)                                  3B016910
 68B   NULL                                                             3B016920
 DMP60 TSX     PSHUP,4                                                  3B016930
       STA     COMENT+2                                                 3B016940
       TSX     MOTWR,4                                                  3B016950
       PZE     COMENT                                                   3B016960
       TRA     INCSX                                                    3B016970
COMENT IOCD    *+1,,3                                                   3B016980
       PZE     3,,5                                                     3B016990
       PZE     **                                                       3B017000
       PZE                                                              3B017010
 68E   NULL                                                             3B017020
       TTL     IBDIN             OPERATIONS  (SUBSCRIPTS)               3B017030
*                                                                       3B017040
*                                                                       3B017050
*                                                                       3B017060
*                                                                       3B017070
*        GET SUBSCRIPTS                                                 3B017080
*                                                                       3B017090
*                                                                       3B017100
*                                                                       3B017110
 SBB   NULL                                                             3B017120
*                                                                       3B017130
GETSUB SXA     GTSUBX,4                                                 3B017140
       STL     GTSB                                                     3B017150
       TRA     INCSX                                                    3B017160
       SXD     RDOP7,1                                                  3B017170
       TSX     GTRDT,4                                                  3B017180
       TNZ     *+3                                                      3B017190
       STL     UNDEF                                                    3B017200
       TRA     GTSUBX                                                   3B017210
       STA     GTSBB+4                                                  3B017220
       ARS     15                                                       3B017230
       LGR     3                                                        3B017240
       STA     GTSBB+1             D1                                   3B017250
       ARS     15                                                       3B017260
       LGR     1                                                        3B017270
       CAL     .RDICT,1                                                 3B017280
       STA     GTSBB+3             D3                                   3B017290
       PDX     ,1                                                       3B017300
       SXA     GTSBB+2,1           D2                                   3B017310
       ZAC                                                              3B017320
       LGL     4                                                        3B017330
       PAX     ,1                                                       3B017340
       SXD     GTSBB+6,1                                                3B017350
       CLA     =1                                                       3B017360
       TXL     *+2,1,13            TRA IF NOT DOUBLE OR COMPLEX.        3B017370
       ALS     1                                                        3B017380
       STA     GTSBB                                                    3B017390
       LDQ     GTSBB                                                    3B017400
       AXT     3,4                                                      3B017410
       ZET     GTSBB+4,4                                                3B017420
       MPY     GTSBB+4,4                                                3B017430
       TIX     *-2,4,1                                                  3B017440
       XCA                                                              3B017450
       ADD     GTSBB+4                                                  3B017460
       SUB     =1                                                       3B017470
       STA     GTSBB+5                                                  3B017480
GTSUBX AXT     **,4                                                     3B017490
       TRA     1,4                                                      3B017500
*                                                                       3B017510
 GTSBB PZE     **                  WORDS/ENTRY                          3B017520
*    INFORMATION ABOUT DIMENSIONED VARIABLES                            3B017530
       PZE     **                 FIRST DIMENSION                       3B017540
       PZE     **                 SECOND DIMENSION                      3B017550
       PZE     **                 THIRD DIMENSION                       3B017560
       PZE     **                 FIRST LOCATION OF ENTRY               3B017570
       PZE     **                  SIZE OF ARRAY                        3B017580
       PON     0,,**               MODE                                 3B017590
 SBE   NULL                                                             3B017600
       TTL     IBDIN               EXTENDED PANEL SAVE + RESTORE        3B017610
 AEB   NULL                                                             3B017620
PANSAV SXA     PANOUT,4                                                 3B017630
       SXA     X5X3,3                                                   3B017640
       SXD     X5X3,5                                                   3B017650
       SXA     X7X6,6                                                   3B017660
       SXD     X7X6,7                                                   3B017670
       LDI     X4ETC                                                    3B017680
       CAL     SL1                                                      3B017690
       AXT     4,4                                                      3B017700
 PS1   SLT     5,4                                                      3B017710
       TRA     *+2                                                      3B017720
       OAI                                                              3B017730
       ARS     1                                                        3B017740
       TIX     PS1,4,1                                                  3B017750
       DCT                                                              3B017760
       SIB     DC                                                       3B017770
       IOT                                                              3B017780
       SIB     IO                                                       3B017790
PANOUT AXT     **,4                                                     3B017800
       TRA     1,4                                                      3B017810
PANRES SXA     PANOUT,4                                                 3B017820
       DCT                                                              3B017830
       NOP                                                              3B017840
       IOT                                                              3B017850
       NOP                                                              3B017860
       LDI     X4ETC                                                    3B017870
       BFT     DC                                                       3B017880
       DVP     =0                                                       3B017890
       BFT     IO                                                       3B017900
       OCT     070000000000        (CPY INSTRUCTION)                    3B017910
       AXT     4,4                                                      3B017920
       CAL     SL1                                                      3B017930
       SLF                                                              3B017940
 PR1   TIF     *+2                                                      3B017950
       SLN     5,4                                                      3B017960
       ARS     1                                                        3B017970
       TIX     PR1,4,1                                                  3B017980
       TRA     PANOUT                                                   3B017990
 SL1   OCT     4000                                                     3B018000
 AEE   NULL                                                             3B018010
       TTL     IBDIN               READ   (USING .RDICT)                3B018020
*   READ OPERAND, USING .RDICT                                          3B018030
 RDOP  SXD     RDOP7,1             PUT RDICT POINTER IN DECREMENT.      3B018040
       LDC     RDOP7,1                                                  3B018050
 RDOP2 AXT     **,2                XR2 = NO. OF DUMMY VARIABLES.        3B018060
       TXH     RDOP3,2,0           TRA IF DUMMY VARIABLES.              3B018070
 RDOP4 TSX     PSHDN,4             GET A PUSHDOWN SLOT (XR2 WILL POINT) 3B018080
       CLA     =O100000000000      AND PUT ENTRY IN.                    3B018090
       STO     0,2                                                      3B018100
       TSX     GTRDT,4                                                  3B018110
       TZE     RDOP9               UNDEFINED ENTRY                      3B018120
       STA     0,2                                                      3B018130
       LGR     18                                                       3B018140
       ARS     15                  EXTRACT MODE.                        3B018150
       LGR     1                                                        3B018160
       ZAC                                                              3B018170
       LGL     22                                                       3B018180
       STD     0,2                 STORE MODE.                          3B018190
       TRA     INCSX                                                    3B018200
 RDOP7 PZE                                                              3B018210
       TTL     IBDIN              READ  (VIA CONSTANT POOL)             3B018220
*    READ VIA CONSTANT POOL                                             3B018230
 RCON  PXA     ,1                                                       3B018240
       LRS     11                 PUSH MODE TO RIGHT OF AC              3B018250
       ALS     7                  SEPARATE IT FROM INCREMENT            3B018260
       LLS     11                                                       3B018270
       TSX     PSHDN,4                                                  3B018280
       ADD     RCON1              COMPLETE PUSHDOWN ENTRY               3B018290
       TRA     RDOP10                                                   3B018300
 RCON1 PON     .IBDB2-1                                                 3B018310
       TTL     IBDIN              READ  (IMMEDIATE OPERAND)             3B018320
*                                                                       3B018330
*    OPERAND IS IN IMMEDIATE FORM, PUT (X1) INTO PUSHDOWN TABLE         3B018340
 RABS  PXA     ,1                                                       3B018350
       ORA     =1B2                                                     3B018360
       TRA     VALUE+1                                                  3B018370
       SPACE   2                                                        3B018380
 VALUE PXA     ,1                                                       3B018390
       TSX     PSHDN,4                                                  3B018400
       TRA     RDOP10                                                   3B018410
       SPACE   5                                                        3B018420
 RMR   PXA     ,1                                                       3B018430
       SSM                                                              3B018440
       TRA     VALUE+1                                                  3B018450
*                                                                       3B018460
 RDOP8 NZT     UNDEF                                                    3B018470
       TRA     PSHDN                                                    3B018480
       TSX     PSHDN,4                                                  3B018490
 RDOP9 CLA     =O700000000000      PUT UNDEFINED CODE INTO              3B018500
RDOP10 STO     0,2                  PUSHDOWN TABLE                      3B018510
       TRA     INCSX                                                    3B018520
       TTL     IBDIN UTILITY FUNCTIONS                                  3B018530
 AGB   NULL                                                             3B018540
FXOPND SXA     OPTRI2,1                                                 3B018550
       TSX     OPAND,1                                                  3B018560
       TXL     OPTRI1,4,6          MODE IS NOT FLOATING                 3B018570
*                                                                       3B018580
*        FIX OPERAND TO ADDRESS                                         3B018590
*                                                                       3B018600
       TSX     FIX,4                                                    3B018610
OPTRI1 PAX     ,4                                                       3B018620
       TPL     OPTRI2                                                   3B018630
       PAC     0,4                 IF RESULT IS NEGATIVE                3B018640
OPTRI2 AXT     **,1                                                     3B018650
       TRA     1,1                                                      3B018660
 AGE   NULL                                                             3B018670
       EJECT                                                            3B018680
*   FLOAT TO FIX                                                        3B018690
 FIX   UFA     =182B8                                                   3B018700
       RQL     8                                                        3B018710
       LRS     8                                                        3B018720
       XCA                                                              3B018730
       TRA     1,4                                                      3B018740
       EJECT                                                            3B018750
*                                                                       3B018760
*      PICK OFF THE OPERAND ON THE TOP OF THE PD STACK.                 3B018770
*                                                                       3B018780
 OPAND TSX     PSHUP,4                                                  3B018790
       SXA     OPANX,1                                                  3B018800
       STA     OPANA                                                    3B018810
       PDX     0,4                 XR4 = DECR.                          3B018820
       ARS     15                                                       3B018830
       PDC     0,1                 XR1 = -PREFIX                        3B018840
       LDQ     =0                                                       3B018850
       TMI     OPAN4               MACHINE REGISTER                     3B018880
       TRA     *+1,1                                                 (8)3B018890
       TRA     OPANV               0 - VALUE ENTRY                      3B018900
       TRA     OPAN1               1 - MEMORY POINTER.                  3B018910
       TRA     OPAN1               2 - TEMPORARY STORAGE POINTER        3B018920
 OPANV CLA     OPANA                                                    3B018930
 OPANX AXT     **,1                                                     3B018940
       TRA     1,1                                                      3B018950
 OPAN1 LAC     OPANA,2                                                  3B018960
       TXL     *+2,4,13            OCTAL 16 AND 17 ARE DBLE AND COMPLEX.3B018970
       LDQ     1,2                                                      3B018980
       CLA     0,2                                                      3B018990
       TRA     OPANX                                                    3B019000
       EJECT                                                            3B019010
*                                                                       3B019020
*                                                                       3B019030
*        GET RESULT STORAGE LOCATION                                    3B019040
*                                                                       3B019050
 GETRS SXA     GETRS2,4                                                 3B019060
       TSX     RDOP8,4                                                  3B019070
       LXA     MODE,4                                                   3B019080
       SXD     GETRS3,4                                                 3B019090
GETRS1 AXT     .IBDB6,4                                                 3B019100
       SXA     GETRS3,4                                                 3B019110
       CAL     GETRS3                                                   3B019120
       TXI     *+1,4,2                                                  3B019130
       TXH     RSERR,4,.IBDB2-2                                         3B019140
       SXA     GETRS1,4                                                 3B019150
       STO     0,2                 STORE  PTW P.S.P,,MODE.              3B019160
       PAC     0,2                                                      3B019170
GETRS2 AXT     **,4                                                     3B019180
       TRA     1,4                                                      3B019190
GETRS3 PTW     **,,**                                                   3B019200
 RSERR STR                                                              3B019210
*                                                                       3B019220
       EJECT                                                            3B019230
*    GET .RDICT ENTRY                                                   3B019240
 GTRDT LDC     RDOP7,1                                                  3B019250
 GTRD1 CAL     .RDICT-1,1                                               3B019260
       TRA     1,4                                                      3B019270
       EJECT                                                            3B019280
*    READOUT TOP OPERAND IN PUSHDOWN TABLE                              3B019290
 PSHUP LXA     PSHDN,2                                                  3B019300
       CLA     0,2                                                      3B019310
       TXI     *+1,2,1                                                  3B019320
       SXA     PSHDN,2                                                  3B019330
       ZET     CALL                                                     3B019333
       TRA     *+4                                                      3B019337
       CAS     =2B2                                                     3B019340
       STA     GETRS1              FREE TEMPORARY STORAGE CELL          3B019350
       NOP                                                              3B019360
       CAS     =-3B2                                                    3B019370
       TRA     1,4                                                      3B019380
       SSP                                                           $5$3B019390
       STL     UNDEF                                                    3B019400
       TRA     1,4                                                      3B019410
       SPACE   2                                                        3B019420
*                                                                       3B019430
*                                                                       3B019440
*    LOCATE NEXT CELL IN PUSHDOWN TABLE                                 3B019450
 PSHDN AXT     -.IBDB5+1,2                                              3B019460
       TXI     *+1,2,-1                                                 3B019470
       TXL     PSHDN1,2,-.IBDB6                                         3B019480
       SXA     PSHDN,2                                                  3B019490
       TRA     1,4                                                      3B019500
PSHDN1 STR                         PUSHDOWN TABLE SIZE EXCEEDED         3B019510
       TTL     IBDIN AND DUMPS WORKING STORAGE                          3B019520
*    THE FOLLOWING TWO CELLS CONTAIN OPERAND 'A'                        3B019530
 AHIGH PZE                                                              3B019540
 ALOW  PZE                                                              3B019550
       SPACE   2                                                        3B019560
*    THE FOLLOWING TWO CELLS CONTAIN OPERAND 'B'                        3B019570
 BHIGH PZE                                                              3B019580
 BLOW  PZE                                                              3B019590
       SPACE   2                                                        3B019600
 MODE  PZE     **                  MODE OF THE OPERANDS                 3B019610
MMODE1 PZE     14                  DOUBLE PRECISION MODE.               3B019620
MMODE2 PZE     7                   FLOATING POINT MODE.                 3B019630
       SPACE   2                                                        3B019640
 OPANA PZE                         POINTS TO STORAGE LOCATION OF OPRND  3B019650
 UNDEF PZE                         NON-ZERO IF AN OPERAND WAS UNDEFINED 3B019660
       SPACE   3                                                        3B019670
 GTSB  PZE     **                 FLAG TO RETURN TO SUBSCRIPT PROCESSOR 3B019680
       SPACE   2                                                        3B019690
*    THE FOLLOWING CELLS ARE USED TO OUTPUT A RECORD ABOUT THE LOCATION 3B019700
*    THE DUMPING STR OCCURRED.                                          3B019710
STRLST IOCP    RDLRC,,2            STR LOC OUTPUT COMMAND               3B019720
*    THE FOLLOWING TWO CELLS ARE FILLED WITH APPROPRIATE INFORMATION    3B019730
*      FOR EITHER OVERLAY OR NON-OVERLAY EXECUTIONS.                    3B019740
       ENTRY   .LSTR                                                    3B019750
 .LSTR BSS     1                   IOCD  .LDT+1,,.LRECT-1-.LDT          3B019760
 RDLRC BSS     1                   PZE   .LRECT-.LDT+1,,6               3B019770
 LSTR  PZE     **                  LOCATION OF STR                      3B019780
 DUMP  BSS     1                   DUMP REQUEST LOCATION FLAG           3B019790
       SPACE   2                                                        3B019800
PANLST IOCD    PANRC,,**           COMMAND FOR PANEL RECORD             3B019810
*    THE FOLLOWING 9 CELLS ARE  A PANEL RECORD IMAGE                    3B019820
PANRC  PZE     **,,1                                                    3B019830
 AC    BSS     1                                                        3B019840
 MQ    BSS     1                                                        3B019850
 SI    BSS     1                                                        3B019860
QPX2X1 ***     **,,**                                                   3B019870
 X4ETC BSS     1                                                        3B019880
 ENK   BSS     1                                                        3B019890
 X5X3  PZE     **,,**                                                   3B019900
 X7X6  PZE     **,,**                                                   3B019910
 LAC   BSS     1                  LOGICAL ACCUMULATOR                   3B019920
 DUMP1 PZE     0                   FLAG INDICATING FIRST DUMP TAKEN     3B019930
       SPACE   2                                                        3B019940
 TEMP  BSS     1                   SCRATCH CELL                         3B019950
       SPACE   2                                                        3B019960
 WDCNT PZE     **                                                       3B019970
       SPACE   3                                                        3B019980
NOMORE PTW     SYSOU1,,*+1                                              3B019990
       IORP    *+2,,3                                                   3B020000
       TCH     .LTCH                                                    3B020010
       BCI     3, TRAP MAX REACHED.                                     3B020020
       SPACE   2                                                        3B020030
*    PLANT DEBUG FILE CLOSE IN .LXCON                                   3B020040
       USE     ABS                                                      3B020050
       ORG     .DBCLS                                                   3B020060
       TSX     DMP90,1                                                  3B020070
       USE     PREVIOUS                                                 3B020080
       SPACE   4                                                        3B020090
*    THE FOLLOWING SECTIONS ARE PUT INTO THIS DECK TO KEEP THE          3B020100
*      SUBROUTINE LIBRARY FREE OF 1NDEFINED VIRTUALS.                   3B020110
*    THE ACTUAL CONTROL SECTIONS WILL BE IN THE IBDBL COMPILER GENERATED3B020120
*      DECK, '.DBGTX'.                                                  3B020130
       USE     .IBDBT                                                   3B020140
.IBDBT CONTRL  .IBDBT                                                   3B020150
       USE     .IBDB1                                                   3B020160
.IBDB1 CONTRL  .IBDB1                                                   3B020170
       USE     .IBDB2                                                   3B020180
.IBDB2 CONTRL  .IBDB2                                                   3B020190
       USE     .IBDB5                                                   3B020200
.IBDB5 CONTRL  .IBDB5                                                   3B020210
       USE     .IBDB6                                                   3B020220
.IBDB6 CONTRL  .IBDB6                                                   3B020230
       USE                                                              3B020240
OPCAL1 NULL                                                             3B020250
.IBDB7 ENTRY   OPCAL1                                                   3B020260
.IBDB8 CONTRL  .IBDB8,IBDB8E                                            3B020270
       END     DSTRS                                                    3B020280
$*     7090/7094 IBLIB SYSTEM LIBRARY - .DSTRN                          3C000000
$IBMAP .DSTRN                                                           3C000010
       TTL  .DSTRN - DEBUG STR SRCH ROUT. FOR NON-OVRLY EXECUTIONS   (7)3C000020
       LBL     .DSN,BEGIN     .DSTRN                                 (7)3C000030
*    THIS ROUTINE IS ENTERED WITH AN ABSOLUTE LOCATION IN THE DECREMENT 3C000040
*     OF THE ACCUMULATOR. THE REST OF THE ACCUMULATOR IS CLEARED.       3C000050
*     .TBSTR IS SEARCHED FOR A DEBUBGING REQUEST LOCATED AT THIS POINT. 3C000060
*     IF ONE IS FOUND, A LOOKAHEAD IS DONE TO DETERMINE IF MORE THAN ONE3C000070
*     REQUEST HAS BEEN MADE FOR THIS LOCATION.   IF ANOTHER MATCH IS    3C000080
*     FOUND, THE ROUTINE HOLDS ITS LOCATION IN THE TABLE, AND EXITS     3C000090
*     WITH THE ACCUMULATOR NEGATIVE.  THE LOCATION OF THE FIRST      (4)3C000100
*     MATCHING ENTRY, WHICH CONTAINS THE TRUE OP CODE PREFIX OF THE  (4)3C000101
*     REQUEST POINT, IS SAVED IN .IBPRE OF .IBDBI.                   (4)3C000102
*                                                                       3C000110
*    CALLING SEQUENCE -                                                 3C000120
*              TSX    .DSTRS,4                                          3C000130
*             (RETURN)        NOTE -  XR1 IS NOT RESTORED            (4)3C000140
*                                                                    (4)3C000150
*    THE ENTRIES ARE SEARCHED FROM FIRST TO LAST.                    (4)3C000160
       SPACE   3                                                        3C000170
DSTRN  XCL                         PUT ARGUMENT IN MQ                   3C000180
       LXA     DSSAV,1                                                  3C000190
       TXH     DST10,1,0           TRANSFER IF NOW PROCESSING LOOKAHEAD 3C000200
       AXC     .TBSTR,1            POINT TO FIRST ENTRY IN TABLE     (4)3C000210
       SPACE   2                                                        3C000220
 DST01 CAL     0,1                 PICKUP FIRST WORD OF ENTRY           3C000230
       ANA     =O077777000000      MASK OFF ALL BUT DECREMENT           3C000240
       TLQ     DST20               MARK OVERSHOT, TERMINATE SEARCHING(7)3C000250
       XCL                         CHANGE SHOES                         3C000260
       TLQ     DST10               NO MATCH, CONTINUE SCANNING       (7)3C000270
*                                                                       3C000280
*         THIS POINT IS REACHED IF AND ONLY IF A MATCH IS FOUND         3C000290
*                                                                       3C000300
       NZT     DSSAV               ARE WE IN LOOKAHEAD MODE             3C000310
       TRA     DST09                -NO,GO MARK AS SUCH AND LOOKAHEAD   3C000320
       SPACE   3                                                        3C000330
       SXA     DSSAV,1              -YES, SAVE LOOKAHEAD ADDRESS        3C000340
       PXA     -ENLEN,1            PUT LOC IN ACC                    (4)3C000350
       SBM     *-1                 COMPLEMENT AND BUMP ONE ENTRY        3C000360
       ANA     =O000000077777      CLEAR ALL BUT ADDRESS                3C000370
       SSM                         MARK FOR REENTRY                     3C000380
       TRA     1,4                                                      3C000390
       SPACE   2                                                        3C000400
 DST09 SXA     DSSAV,1             HOLD MATCH ADDRESS                   3C000410
       LAC     DSSAV,1                                               (7)3C000413
       SXA     .IBPRE,1            ENTRY W/CORRECT OP CODE PREFIX    (4)3C000415
       LXA     DSSAV,1                                               (7)3C000417
       SPACE   3                                                        3C000420
*   SEARCH FOREWARD FOR MATCH                                        (4)3C000430
DST10  TXL     DST20,1,ENLEN-.RDICT   END OF TABLE REACHED           (7)3C000440
       XCL                                                           (7)3C000445
       TXI     DST01,1,-ENLEN      BUMP TO NEXT ENTRY AND RETURN     (4)3C000450
       SPACE   2                                                        3C000460
 DST20 LAC     DSSAV,1             PICKUP MATCH LOCATION, IF ANY.       3C000470
       ZSA     DSSAV               RESET FOR NEXT ENTRY                 3C000480
       PXA     ,1                  PUT MATCH LOCATION IN AC             3C000490
       TRA     1,4                                                      3C000500
       SPACE   3                                                        3C000510
 DSSAV PZE     **                  HOLDS MATCH LOCATION                 3C000520
       SPACE   2                                                        3C000530
 ENLEN EQU     2                   LENGTH OF .TBSTR ENTRY               3C000540
       SPACE   3                                                        3C000550
 IOCD  IOCD    0,,0                DUMMY I/O INSTRUCTION FOR IBDIN      3C000560
       LORG                                                             3C000570
       SPACE   3                                                        3C000580
*      THE FOLLOWING TWO ENTRY POINTS ARE DUMMIES TO KEEP THE SUBROUTINE3C000590
*      LIBRARY FREE OF UNDEFINED VIRTUALS.  THE REAL SECTIONS WILL      3C000600
*      BE FOUND IN THE OUTPUT DECK FROM THE DEBUGGING COMPILER, IBDBL.  3C000610
       USE     .TBSTR                                                   3C000620
.TBSTR CONTRL  .TBSTR                                                   3C000630
       USE     .RDICT                                                   3C000640
.RDICT CONTRL  .RDICT                                                   3C000650
       USE                                                              3C000660
       SPACE   3                                                        3C000670
*    PLANT TRANSFER IN .DSTRS                                           3C000680
       ORG     .DSTRS                                                   3C000690
       TSX     DSTRN,4                                                  3C000700
       SPACE   3                                                        3C000710
*    PLANT I/O COMMANDS IN IBDIN DUMP OF STR LOC RECORD                 3C000720
       ORG     .LSTR                                                    3C000730
       IOCD    0,,0                I/O COMMAND FOR DUMP STR LOC RECORD  3C000740
       PZE     2,,6                                                     3C000750
       SPACE   2                                                        3C000760
       END     DSTRN                                                    3C000770
$*     7090/7094 IBLIB SYSTEM LIBRARY - .DSTRO                          3D000000
$IBMAP .DSTRO                                                           3D000010
       TTL  .DSTRO - DEBUG STR SRCH ROUT. FOR OVERLAY EXECUTIONS     (7)3D000020
       LBL     .DSO,BEGIN     .DSTRO                                 (7)3D000030
*    THIS ROUTINE IS ENTERED WITH AN ABSOLUTE LOCATION IN THE DECREMENT 3D000040
*     OF THE ACCUMULATOR. THE REST OF THE ACCUMULATOR IS CLEARED.       3D000050
*     .TBSTR IS SEARCHED FOR A DEBUBGING REQUEST LOCATED AT THIS POINT. 3D000060
*       (ONLY LINKS PRESENT IN CORE ARE SEARCHED)                       3D000070
*     IF ONE IS FOUND, A LOOKAHEAD IS DONE TO DETERMINE IF MORE THAN ONE3D000080
*     REQUEST HAS BEEN MADE FOR THIS LOCATION IN THIS LINK.  IF ANOTHER 3D000090
*     FOUND, THE ROUTINE HOLDS ITS LOCATION IN THE TABLE, AND EXITS     3D000100
*     WITH THE ACCUMULATOR NEGATIVE.  THE LOCATION OF THE FIRST      (4)3D000110
*     MATCHING ENTRY, WHICH CONTAINS THE TRUE OP CODE PREFIX OF THE  (4)3D000111
*     REQUEST POINT, IS SAVED IN .IBPRE OF .IBDBI.                   (4)3D000112
*                                                                       3D000120
*    CALLING SEQUENCE -                                                 3D000130
*              TSX    .DSTRS,4                                          3D000140
*             (RETURN)        NOTE -  X1 AND X2 NOT RESTORED            3D000150
*                                                                       3D000160
*    THE ENTRIES ARE SEARCHED FROM FIRST TO LAST WITHIN A LINK GROUP (4)3D000170
*     THE LINK WHERE THE PREVIOUS MATCH WAS FOUND IS SEARCHED FIRST,    3D000180
*     AND IF NO MATCH IS NOW FOUND, THE TABLE IS SEARCHED STARTING WITH 3D000190
*     THE FIRST LINK GROUP.                                             3D000200
       SPACE   3                                                        3D000210
 DSTRO XCL                         HOLD ARGUMENT IN MQ THRUOUT ROUTINE  3D000220
 DSTTA AXT     **,2                POINTER TO CHAIN WORD OF LINK GROUP  3D000230
       REM                          OF PREVIOUS MATCH TO X2             3D000240
       TXH     DSTSL,2,0           IF POINTER EXISTS, SCAN LINK GROUP   3D000250
 DSTRT ZSA     DSTTA               RESET MATCH IN LINK GROUP POINTER    3D000260
       AXC     .TBSTR+1,2          POINT TO CHN WRD OF 1ST LINK GROUP   3D000270
 DSTSL CLA     0,2                 PICKUP LINK NUMBER                   3D000280
       PAC     ,1                   LINK NUMBER TO X1                   3D000290
       CLA     .LDT,1              LDT ENTRY CORRES TO THIS LINK        3D000300
       TPL     DSTIC               THIS LINK IS IN CORE                 3D000310
       SPACE   2                                                        3D000320
*    NO MATCH OCCURRED FOR THIS LINK GROUP IN .TBSTR                    3D000330
 DSTIR LXA     DSTTA,1             WERE WE PROCESSING THIS LINK GROUP   3D000340
       REM                          BECAUSE LAST MATCH WAS HERE.        3D000350
       TXH     DSTRT,1,0            -YES, GO BACK AND START W/ 1ST L GRP3D000360
       CLA     0,2                  -NO, PICKUP CHAIN ADDRESS           3D000370
       PDC     ,2                                                       3D000380
       TXH     DSTSL,2,1           IF NOT LAST LINK GROUP, TRY NEXT     3D000390
 DSTNF LAC     DSSAV,1             PICKUP MATCH LOCATION, IF ANY        3D000400
       PXA     ,1                  SETUP AC FOR EXIT                    3D000410
       TZE     1,4                 IF NO MATCH FOUND, TRA               3D000420
       ZSA     DSSAV               RESET, SINCE ANOTHER MATCH IS NOT    3D000430
       REM                         IN THE OFFING.                       3D000440
 DSTF2 AXT     **,1                SAVE LINK GROUP POINTER           (4)3D000450
       SXA     DSTTA,1              FOR THIS MATCH                      3D000460
       TRA     1,4                 AND EXIT                             3D000470
       SPACE   3                                                        3D000480
*    THIS PART OF THE ROUTINE SCANS ENTRIES WITHIN A LINK GROUP.        3D000490
 DSTIC CLA     0,2                 PICKUP CHAIN WORD                    3D000500
       LXA     DSSAV,1             IF RE-ENTERING THIS ROUTINE TO GET   3D000510
       TXH     DST10,1,0            SUBSEQUENT MATCHES, CONTINUE LOOKAHD3D000520
       SPACE   2                                                        3D000530
*    INITIALIZE LIMITS FOR THIS LINK GROUP                              3D000540
       SXA     DSTF2,2             SAVE LINK GROUP POINTER           (4)3D000550
       PDC     ,1                  LOC OF NEXT LINK GROUP               3D000560
       TXH     *+2,1,1             TRA IF NOT LAST LINK GROUP           3D000570
       AXC     .RDICT+1,1          UPPER BOUND FOR LAST LINK GROUP      3D000580
       TXI     *+1,1,ENLEN+1       ADJUST TO POINT TO LAST ENTRY THIS   3D000590
       SXD     DST10,1              LINK GROUP                       (4)3D000600
       SXA     *+1,2                                                 (4)3D000601
       AXT     **,1                                                  (4)3D000602
       TXI     *+1,1,1                                               (4)3D000603
       SPACE   2                                                        3D000610
 DST01 CAL     0,1                 PICKUP FIRST WORD OF ENTRY           3D000620
       ANA     =O077777000000      CLEAR ALL BUT DECREMENT              3D000630
       TLQ     DST20               PASSED POSSIBLE MATCH POINT       (7)3D000640
       XCL                                                              3D000650
       TLQ     DST10-1             DOES NOT MATCH, CONTINUE SEARCH   (7)3D000660
       SPACE   2                                                        3D000670
*    THIS POINT IS REACHED ONLY IF A MATCH IS FOUND.                    3D000680
       NZT     DSSAV               ARE WE IN LOOKAHEAD MODE             3D000690
       TRA     DST09                -NO, ENTER IT                       3D000700
       SXA     DSSAV,1              -YES, SAVE LOC FOR RE-ENTRY         3D000710
       PXA     -ENLEN,1            PUT LOC IN AC (COMPLEMENTED)      (4)3D000720
       SBM     *-1                 RECOMPLEMENT AND BUMP ONE ENTRY      3D000730
       ANA     =O000000077777      CLEAR ALL BUT ADDRESS                3D000740
       SSM                         MARK FOR RE-ENTRY                    3D000750
       TRA     DSTF2                                                    3D000760
 DST09 SXA     DSSAV,1             SAVE LOCATION MATCH OCCURRED         3D000770
       LAC     DSSAV,1                                               (7)3D000773
       SXA     .IBPRE,1            ENTRY W/CORRECT OP CODE PREFIX    (4)3D000775
       LXA     DSSAV,1                                               (7)3D000776
       XCL                                                           (7)3D000777
 DST10 TXL     DST20,1,**          TRA NO MORE ENTRIES THIS LINK GRP (4)3D000780
       TXI     DST01,1,-ENLEN      RETURN TO TEST NEXT ENTRY         (4)3D000790
*    MATCH NOT FOUND                                                    3D000800
 DST20 LAC     DSSAV,1                                                  3D000820
       TXH     DSTNF+1,1,0         TRA W/ LOC OF MATCH IF IN LOOKAHEAD  3D000830
*    NO MATCH FOUND IN THIS LINK GROUP                                  3D000840
       TRA     DSTIR                POSSIBLE SCAN IN NEXT LINK GROUP    3D000850
       SPACE   3                                                        3D000860
*    WORKING STORAGE, CONSTANTS ETC.                                    3D000870
 DSSAV PZE     **                  POINTS TO LOC WHERE MATCH OCCURRED   3D000880
 ENLEN EQU     2                   LENGTH OF ENTRY IN .TBSTR            3D000890
       SPACE   2                                                        3D000900
       LORG                                                             3D000910
       SPACE   3                                                        3D000920
*      THE FOLLOWING TWO ENTRY POINTS ARE DUMMIES TO KEEP THE SUBROUTINE3D000930
*      LIBRARY FREE OF UNDEFINED VIRTUALS.  THE REAL SECTIONS WILL      3D000940
*      BE FOUND IN THE OUTPUT DECK FROM THE DEBUGGING COMPILER, IBDBL.  3D000950
       USE     .TBSTR                                                   3D000960
.TBSTR CONTRL  .TBSTR                                                   3D000970
       USE     .RDICT                                                   3D000980
.RDICT CONTRL  .RDICT                                                   3D000990
       USE                                                              3D001000
       SPACE   3                                                        3D001010
*    PLANT ENTRY TRANSFER IN .DSTRS ROUTINE                             3D001020
       ORG     .DSTRS                                                   3D001030
       TSX     DSTRO,4                                                  3D001040
       SPACE   3                                                        3D001050
*    PLANT I/O COMMANDS IN IBDIN DUMP OF STR LOC RECORD                 3D001060
       ORG     .LSTR                                                    3D001070
       IOCD    .LDT+1,,.LRECT-.LDT-1 I/O COMMAND FOR DUMP STR LOC RECORD3D001080
       PZE     .LRECT-.LDT+1,,6    FIRST WORD OUTPUT IN STR LOC RECORD  3D001090
       SPACE   2                                                        3D001100
       END     DSTRO                                                    3D001110
$IBMAP .ERAS.  9                                                        3F0ER000
       ENTRY   E.1                                                      3F0ER010
       ENTRY   E.2                                                      3F0ER020
       ENTRY   E.3                                                      3F0ER030
       ENTRY   E.4                                                      3F0ER040
E.1    PZE                                                              3F0ER050
E.2    PZE                                                              3F0ER060
E.3    PZE                                                              3F0ER070
E.4    PZE                                                              3F0ER080
       END                                                              3F0ER090
$IBMAP .XCC.   ()OK                                                  $5$3F0FC010
       ENTRY   CC.1                                                  $5$3F0FC020
       ENTRY   CC.2                                                  $5$3F0FC030
       ENTRY   CC.3                                                  $5$3F0FC040
       ENTRY   CC.4                                                  $5$3F0FC050
CC.1   DEC     155B8                                                 $5$3F0FC060
CC.2   DEC     163B8                                                 $5$3F0FC070
CC.3   DEC     155B16                                                $5$3F0FC080
CC.4   DEC     182B8                                                 $5$3F0FC090
       END                                                           $5$3F0FC100
$*     7090/7094 IBLIB FORTRAN SYSTEM LIBRARY - EXIT                    3F100000
$IBMAP XIT     8                                                        3F100010
       TTL     EXIT/TRANSFER CONTROL TO IBJOB MONITOR                   3F100020
       ENTRY   EXIT                                                     3F100030
       ENTRY   .EXIT.                                                   3F100040
.EXIT. NULL                                                             3F100050
EXIT   TRA     .LXRTN                                                   3F100060
       END                                                              3F100070
$*     7090/7094 IBLIB FORTRAN SYSTEM LIBRARY - FXEM                    3F200000
$IBMAP FXEM    225,()OK                                              $5$3F200010
       TTL     FXEM - FORTRAN EXECUTION ERROR MONITOR                (6)3F200020
       REM                                                              3F200030
       REM     CALLING SEQUENCE IS CALL .FXEM.(CODE)                    3F200040
       REM     WHERE CODE CONTAINS IN THE ADDRESS THE                   3F200050
       REM     NUMBER DESIGNATING THE PARTICULAR ERROR FOR              3F200060
       REM     WHICH FXEM IS CALLED AND IS FOLLOWED BY THE              3F200070
       REM     ERROR MESSAGE LIST FOR THIS ERROR.                       3F200080
       REM                                                              3F200090
       ENTRY   .FXEM.                                                   3F200100
       ENTRY   .FXOUT                                                   3F200110
       ENTRY   .FXARG                                                   3F200120
.FXEM. STQ     SMQ            SAVE MQ AND ACCUMULATOR.                  3F200130
       SLW     ACC1                                                     3F200140
       ARS     2                                                        3F200150
       STO     ACC2                                                     3F200160
XEM    SAVEN   (1,2)I                                                   3F200170
       SXA     LNKG,4                                                   3F200180
       LXA     MAX,1                                                    3F200190
       SXD     TSCST,1                                                  3F200200
       AXT     100,1                                                    3F200210
ERRTR  CLA     TRMESS         ERROR TRACE                               3F200220
       TSX     OUT,2                                                    3F200230
       CLA     IOCTS                                                    3F200240
       TSX     OUT,2                                                    3F200250
       CLA     IOCTT                                                    3F200260
       TSX     OUT,2                                                    3F200270
       LXA     LNKG,4                                                   3F200280
       TRA     *+2                                                      3F200290
BEGIN  LXA     **,4                                                     3F200300
       PCA     0,4            ADDRESS OF CALL.                          3F200310
       STA     B10                                                      3F200320
       ADD     =2             ADDRESS OF  PZE  LINE NO.,,LK.DR          3F200330
       STA     B11                                                      3F200340
       CLA*    B11                                                      3F200350
       ANA     ADMSK                                                    3F200360
       TSX     CCNVT,4        CONVERT LINE NUMBER TO BCD.               3F200370
       SLW     LINENO                                                   3F200380
B10    AXT     **,4           CONVERT ADDRESS                           3F200390
       PXA     0,4            OF CALL                                   3F200400
       TSX     CVBCD,4        TO BCD.                                   3F200410
       SLW     RELOC                                                    3F200420
B11    CLA     **                                                       3F200430
       TMI     NEXT           FLOW TRACE EXIT.                          3F200440
       ARS     18                                                       3F200450
       STA     BEGIN          LOCATION OF LINKAGE DIRECTOR.             3F200460
       STA     *+1            HAS LK. DIR. BEEN INITIALIZED          (4)3F200461
       NZT     **             FOR THIS SUBROUTINE                    (4)3F200462
       AXT     0,1            NO, INHIBIT FURTHER TRACE              (4)3F200463
       ADD     =1             LOCATION OF DECKNAME.                     3F200470
       STA     *+1                                                      3F200480
       CLA     **             DECKNAME                                  3F200490
       STO     DECNM                                                    3F200500
       CLA     IOCTET                                                   3F200510
       TSX     OUT,2                                                    3F200520
       TIX     BEGIN,1,1                                                3F200530
       TRA     NEXT                                                     3F200540
TRERR  BCI     7,0ERROR TRACE. CALLS IN REVERSE ORDER.                  3F200550
TRMESS IOCP    TRERR,,7                                                 3F200560
DECMES BCI     1,0                                                      3F200570
DECNM  BCI     1,XXXXXX                                                 3F200580
       BCI     2,                                                       3F200590
LINENO BCI     1,XXXXX                                                  3F200600
       BCI     2,                                                       3F200610
RELOC  BCI     1,XXXXX                                                  3F200620
IOCTET IOCP    DECMES,,8                                                3F200630
HDLN   BCI     9,0   CALLING             IFN OR            ABSOLUTE     3F200640
IOCTS  IOCP    HDLN,,9                                                  3F200650
HDLN1  BCI     9,    ROUTINE             LINE NO.          LOCATION     3F200660
IOCTT  IOCP    HDLN1,,9                                                 3F200670
NEXT   LXA     LNKG,4                                                   3F200680
       CLA*    3,4            ERROR CODE                                3F200690
       PAX     0,1            IN INDEX REGISTER 1.                      3F200700
       AXT     OPTWD1,2       DECIDE LOCATION OF OPTIONAL               3F200710
       TXH     BB1,1,70                                              $5$3F200715
       TXH     BB2,1,35       EXIT SWITCH.                              3F200720
BB3    STA     SHFT                                                     3F200730
       SXA     OPTDEC,2                                              (6)3F200735
TSCST  TXH     CUSOPT,1,**    TEST FOR USERS CODE.                   (6)3F200740
       TXH     WRMES,1,70     NO EXTRA OUTPUT FOR ERROR CODE 71      (6)3F200743
       TXH     ERR32,1,59     EXTRA LINE FOR ERRORS 60 TO 70         (6)3F200746
       TXH     WRMES,1,58     NO EXTRA OUTPUT FOR ERROR CODE 59.     (6)3F200749
       TXH     ERR32,1,56     EXTRA LINE FOR ERROR CODES 57, 58      (6)3F200752
       TXH     WRMES,1,55     TEST FOR ERROR CODE 55.                   3F200760
       TXH     IO55,1,54      FXEM CONTAINS MESSAGE FOR ERROR CODE 55.  3F200770
       TXH     WRMES,1,52     TEST FOR ERROR CODE 52, IT             (6)3F200774
       TXH     ERR32,1,51     REQUIRES AN EXTRA LINE OF OUTPUT       (6)3F200778
       TXH     WRMES,1,37     TEST FOR ERROR CODE 37.                   3F200780
       TXH     ERR37,1,36     SPECIAL PROCESSING REQUIRED FOR ERROR 37. 3F200790
       TXH     WRMES,1,33     TEST FOR ERROR CODES 32 AND 33.           3F200800
       TXH     ERR32,1,31     THESE CODES REQUIRE EXTRA OUTPUT LINE.    3F200810
WRMES  CLA     3,4                                                      3F200820
       PAC     0,4                                                      3F200830
       CLA     2,4            OPTIONAL EXIT MESSAGE.                    3F200840
       SSM                    FIX FOR .LXSEL ARGUMENT.                  3F200850
       STO     OPTMES                                                   3F200860
       CLA     1,4            ERROR MESSAGE.                            3F200870
       SSM                    FIX FOR .LXSEL ARGUMENT.                  3F200880
M1     TSX     OUT,2          WRITE ERROR MESSAGE.                      3F200890
M2     CLA     OPTMES         PREPARE TO WRITE OPTIONAL ERROR           3F200900
       TSX     AAA,2          MESSAGE IF SWITCH ON.                     3F200910
       LDQ     SMQ            IF OPTIONAL EXIT SWITCH ON,               3F200920
       CLA     ACC2           RESTORE MQ AND AC                         3F200930
       ALS     2              AND RESUME                                3F200940
       ORA     ACC1           EXECUTION.                                3F200950
       RETURN  XEM                                                      3F200960
ERR32  ARS     18             STORE ADDRESS OF BUFFER CONTAINING        3F200970
       PAX     0,2            ILLEGAL DATA.                             3F200980
       TXI     *+1,2,14                                                 3F200990
       SXA     MDATA,2                                                  3F201000
       AXT     14,2                                                     3F201010
MDATA  CLA     **,2                                                     3F201020
       STO     DATA+14,2                                                3F201030
       TIX     *-2,2,1                                                  3F201040
       CLA     M2             SAVE INSTRUCTION USED IN                  3F201050
       STO     SVINS          NORMAL FLOW.                              3F201060
       CLA     *+3            SET TRANSFER INSTRUCTION.                 3F201070
       STO     M2                                                       3F201080
       TRA     WRMES          WRITE ERROR MESSAGE.                      3F201090
       TRA     *+1                                                      3F201100
       CLA     ER32MS         WRITE LINE OF ILLEGAL DATA.               3F201110
       TSX     OUT,2                                                    3F201120
       CLA     SVINS          RESTORE NORMAL INSTRUCTION.               3F201130
       STO     M2                                                       3F201140
       TRA     M2                                                       3F201150
ER32MS IOCP    ODATA,,15                                                3F201160
SVINS  PZE     **                                                       3F201170
ERR37  PDC     0,1            CHECK TO SEE IF THIS OUTPUT               3F201180
       LDI     2,1            TAPE IS SYSOU.                            3F201190
       LNT     200000         IS THIS MONITOR CONTROLLED FILE.          3F201200
       TRA     WRMES          NO. NOT SYSOU.                            3F201210
       CLA     3,4            YES. CANNOT WRITE MESSAGE                 3F201220
       PAC     0,4            ON SYSOU, SO                              3F201230
       CLA     1,4            PRINT ON-LINE FOR                         3F201240
       STO     BB             THIS CASE AND THEN                        3F201250
       TSX     .MWR,4         TERMINATE EXECUTION.                      3F201260
       PZE     2                                                        3F201270
       PZE     0,,512*4                                                 3F201280
BB     PZE     **                                                       3F201290
       TRA     .LXERR                                                $5$3F201300
*                                                                       3F201310
BB1    SUB     =70                                                   $5$3F201311
       TXI     BB3,2,2            DESIRED SWITCH IN THIRD WORD       $5$3F201312
BB2    SUB     =35                                                      3F201320
       TXI     BB3,2,1        DESIRED SWITCH IN SECOND WORD.            3F201330
CUSOPT PXA     0,1            RESTORE USERS CODE                     (6)3F201335
       TSX     CCNVT,4        CONVERT CODE TO BCD                    (6)3F201340
       SLW     USERS+2                                                  3F201350
       CLA     PZEA                                                     3F201360
       TSX     OUT,2                                                    3F201370
TERMES CLA     PZEB                                                     3F201380
       TSX     OUT,2                                                    3F201390
       TRA     .LXERR                                                   3F201400
USERS  BCI     7,0ERROR CODE        NOT A STANDARD CODE              (6)3F201410
PZEA   IOCP    USERS,,7                                                 3F201420
E1     BCI     4,0EXECUTION TERMINATED.                                 3F201430
PZEB   IOCP    E1,,4                                                    3F201440
*                                                                       3F201450
CVBCD  XCA                    CONVERT TO BCD                            3F201460
       RQL     21                                                       3F201470
       CLA     BLANKS                                                   3F201480
       SXA     *+5,1                                                    3F201490
       AXT     5,1            5 OCTAL CHARS                             3F201500
 B1    ALS     3                                                        3F201510
       LGL     3                                                        3F201520
       TIX     B1,1,1                                                   3F201530
       AXT     **,1                                                     3F201540
       TRA     1,4                                                      3F201550
*                                                                       3F201560
CCNVT  SXA     SV1,1          BINARY TO DECIMAL CONVERSION.             3F201570
       XCA                                                              3F201580
       AXT     0,1                                                      3F201590
       STZ     TEMP                                                     3F201600
CNVT   PXA     0,0                                                      3F201610
       DVP     L(10)                                                    3F201620
       ALS     0,1                                                      3F201630
       ORS     TEMP                                                     3F201640
       CLA     =1                                                       3F201650
       TLQ     *+2                                                      3F201660
       TXI     CNVT,1,-6                                                3F201670
       CAL     BLANKS                                                   3F201680
       ALS     6,1                                                      3F201690
       ORA     TEMP                                                     3F201700
SV1    AXT     **,1                                                     3F201710
       TRA     1,4                                                      3F201720
*                                                                       3F201730
AAA    STO     .FXARG                                                   3F201740
OPTDEC CLA     **             TERMINATION DECISION                      3F201750
 SHFT  ALS     **                                                       3F201760
       PBT                                                              3F201770
       TRA     TERMES         DIGIT = 0                                 3F201780
       TRA     .FXOUT                                                   3F201790
OUT    STO     .FXARG                                                   3F201800
.FXOUT CALL    .LXSEL(ARG)                                              3F201810
       TRA     1,2                                                      3F201820
*                                                                       3F201830
ARG    PTW     SYSOU1,,.FXARG                                           3F201840
.FXARG IOCP    **,,**                                                   3F201850
       TCH     .LTCH                                                    3F201860
*                                                                       3F201870
IO55   LXA     LNKG,4                                                   3F201880
       TXI     *+1,4,-2                                                 3F201890
       CLA     0,4                                                      3F201900
       ANA     ADMSK                                                    3F201910
       TSX     CCNVT,4                                                  3F201920
       SLW     IOE55+7                                                  3F201930
       CLA     PZE55                                                    3F201940
       TSX     OUT,2                                                    3F201950
       TRA     TERMES                                                   3F201960
IOE55  BCI     8,0ILLEGAL VALUE FOR COMPUTED GO TO AT IFN               3F201970
PZE55  IOCP    IOE55,,8                                                 3F201980
*                                                                       3F201990
ODATA  BCI     1,0                                                      3F202000
DATA   BSS     14                                                       3F202010
OPTMES PZE     **                                                       3F202020
ADMSK  OCT     000000077777                                             3F202030
BLANKS BCI     1,                                                       3F202040
TEMP   PZE     **                                                       3F202050
SMQ    PZE     **                                                       3F202060
ACC1   PZE     **                                                       3F202070
ACC2   PZE     **                                                       3F202080
L(10)  DEC     10                                                       3F202090
MAX    DEC     77            HIGHEST SYSTEM ASSIGNED CODE               3F202100
.OPTW. CONTRL  OPTWD1,LNKG                                              3F202110
OPTWD1 OCT     377777777740   SWITCHES 1 THRU 30 SET ON.                3F202120
OPTWD2 DEC     0                  SWITCHES 36-70                     $5$3F202130
OPTWD3 OCT     376000000000  SWITCHES 71-77 SET ON                      3F202135
LNKG   LDIR                                                             3F202140
       END                                                              3F202150
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FOUT              3F2F0000
$IBMAP FOUT    200                                                   $5$3F2F0010
       TTL     FOUT - FORTRAN BLOCKED OUTPUT SUBROUTINE FOR SYSOU    (8)3F2F0020
       REM                                                              3F2F0030
       REM     CALLING SEQUENCE IS CALL .FOUT.(ARG)                     3F2F0040
       REM     ARG IS OF THE FORM   PZE  LOCATION,,COUNT                3F2F0050
       REM     WHERE LOCATION IS THE FIRST WORD OF A BCD                3F2F0060
       REM     IMAGE OF LENGTH COUNT.                                   3F2F0070
       REM                                                              3F2F0080
       ENTRY   .FOUT.                                                   3F2F0090
NLRPB  SET     0                   IF NON ZERO ONLY 5 RECORDS A BLOCK(8)3F2F0091
       USE                                                              3F2F0100
.FOUT. TXI     BEGIN,,0                                                 3F2F0110
SV2    AXT     **,2                                                     3F2F0120
SV1    AXT     **,1                                                     3F2F0130
SV4    AXT     **,4                                                     3F2F0140
       LDI     *+2                                                      3F2F0150
       TRA     1,4                                                      3F2F0160
       PZE     **                                                       3F2F0170
BEGIN  STI     *-1                                                      3F2F0180
       SXA     SV4,4                                                    3F2F0190
       SXA     SV1,1                                                    3F2F0200
       SXA     SV2,2                                                    3F2F0210
       CLA*    3,4                                                      3F2F0220
       STO     ARG                   SAVE INCOMING ARGUMENT.            3F2F0230
       STA     LOC                   SET TO PICK UP BCD DATA FOR OUTPUT.3F2F0240
       ZET     FIRST                 IS THIS FIRST TIME THROUGH.        3F2F0250
       TRA     LOADBF                NO.                                3F2F0260
       STL     FIRST                 YES. INITIALIZE FOR WRITING SYSOU. 3F2F0270
       CLA*    OTUN                  PLACE LOCATION OF FCB FOR SYSOU1$5$3F2F0280
       STA     OPN                   IN IOCS CALLING SEQUENCES       $5$3F2F0290
       STA     DFILE                                                 $5$3F2F0299
       STA     FILE                                                  $5$3F2F0300
       STA     RITE                                                  $5$3F2F0310
       STA     WRITE                                                 $5$3F2F0312
       PAC     0,4                   GET BLOCK SIZE                  $5$3F2F0313
       LDI     1,4                   FROM SECOND BUFFER              $5$3F2F0314
       CLA     4,4                   POOL CONTROL WORD               $5$3F2F0315
       PDC     0,4                                                   $5$3F2F0316
       CLA     1,4                                                   $5$3F2F0317
       ARS     4                                                     $5$3F2F0318
       STD     BLKSZ                 STORE BLOCK SIZE                $5$3F2F0319
       STD     CHKCT-1               INITIALIZE NEW BUFFER TEST      $5$3F2F0320
       STZ     PFLAG                                                 $5$3F2F0321
       LNT     004000                IS THE MODE OF OUTPUT BCD OR BIN$5$3F2F0322
       STL     PFLAG                 BCD--SET FOR 720 STYLE OUTPUT   $5$3F2F0323
       LXA     .BUFSZ,4              GET MAXIMUM LOGICAL RECORD SIZE.   3F2F0330
       NZT     PFLAG                 INCREMENT SIZE FOR              $5$3F2F0350
       TXI     *+1,4,1               LOGICAL RECORD CONTROL WORD IF 14013F2F0360
       SXD     LOCBUF,4              SEQUENCES WITH THIS COUNT.         3F2F0380
       SXD     BUFPT,4                                                  3F2F0390
       TXI     *+1,4,-1                                                 3F2F0400
       SXD     SVV5,4                                                   3F2F0410
       LFT     040000                IS SYSOU OPEN.                     3F2F0530
       TRA     OPND                  YES.                               3F2F0540
       TSX     .OPEN,4               NO. OPEN SYSOU.                    3F2F0550
OPN    MON     **                                                       3F2F0560
OPND   TSX     .WRITE,4              LOCATE BUFFER.                     3F2F0570
FILE   PZE     **,,.WEOB.            IOCS PLACES IN BUFADD ADDRESS      3F2F0580
LOCBUF IOSTN*  BUFADD,,**            OF BUFFER LOCATED.                 3F2F0590
       NZT     PFLAG                 MAKE BUFFER CONTROL WORD IF     $5$3F2F0610
       TSX     NEWBUF,2              1401 STYLE OUTPUT.                 3F2F0620
OPND1  STZ     COUNT                 RESET COUNT OF WORDS IN BUFFER.    3F2F0630
       STZ     RECCT                 RESET COUNT OF RECORDS IN BUFFER.  3F2F0640
LOADBF LXD     ARG,4                 GET WORD COUNT.                    3F2F0650
       PXA     0,4                                                      3F2F0660
       NZT     PFLAG                                                 $5$3F2F0680
       TXI     *+1,4,1               INCREMENT FOR RECORD FLAG WORD IF  3F2F0690
       SXD     INCCT,4               1401 STYLE OUTPUT.                 3F2F0700
       ZET     KOUNT                                                    3F2F0710
       TRA     FIX                                                      3F2F0720
INC    SXD     RITCT,4                                                  3F2F0730
       LXA     COUNT,4                                                  3F2F0740
INCCT  TXI     *+1,4,**                                                 3F2F0750
       SXA     COUNT,4               INCREMENT COUNT OF WORDS PLACED    3F2F0760
       ZET     PFLAG                                                    3F2F0780
       TRA     STORE                                                    3F2F0790
       XCA                           FOR 1401 STYLE OUTPUT,             3F2F0800
       PXD     0,0                   COMPUTE NUMBER OF                  3F2F0810
       MPY     SIX                   CHARACTERS IN LOGICAL              3F2F0820
       XCA                           RECORD, CONVERT TO BCD             3F2F0830
       TSX     BCVR,2                AND PLACE IN RECORD                3F2F0840
       LXA     BCDINT,4              FLAG WORD.                         3F2F0850
       PXD     0,4                                                      3F2F0860
       ORA     RECWD                                                    3F2F0870
STORE  LXD     ARG,4                 PREPARE TO STORE RECORD            3F2F0880
       AXT     0,1                   IN BUFFER.                         3F2F0890
       AXT     0,2                                                      3F2F0900
       ZET     PFLAG                 IF 1401 STYLE,                     3F2F0910
       TRA     LOC                   STORE RECORD FLAG                  3F2F0920
       SLW*    BUFADD                WORD.                              3F2F0930
       TXI     *+1,2,-1                                                 3F2F0940
LOC    CLA     **,1                                                     3F2F0950
       STO*    BUFADD                STORE OUTPUT RECORD IN             3F2F0960
       TXI     *+1,2,-1              BUFFER.                            3F2F0970
       TXI     *+1,1,-1                                                 3F2F0980
       TIX     LOC,4,1                                                  3F2F0990
       ZET     PFLAG                                                    3F2F1000
       TRA     SETMK                                                    3F2F1010
       LXA     RECCT,4                                                  3F2F1020
       TXI     *+1,4,1               UPDATE RECORD COUNT FOR BUFFER     3F2F1030
       SXA     RECCT,4               FLAG WORD, CONVERT TO BCD          3F2F1040
       PXA     0,4                   AND PLACE IN FLAG WORD.            3F2F1050
       TSX     BCVR,2                                                   3F2F1060
       LXA     BCDINT,4                                                 3F2F1070
       PXA     0,4                                                      3F2F1080
       ORA     BLKWD                                                    3F2F1090
       XEC     BUFBEG                STORE UPDATED BUFFER FLAG WORD.    3F2F1100
WRIT   TSX     .WRITE,4              RELEASE RECORD TO IOCS AND         3F2F1110
RITE   PZE     **,,.WEOB.            LOCATE NEXT AVAILABLE SPACE IN     3F2F1120
RITCT  IOCPN   **,,**                CURRENT BUFFER OR LOCATE NEW    $5$3F2F1130
BUFPT  IOSTN*  BUFADD,,**            BUFFER.                            3F2F1140
       STD     CHKCT                 SAVE NUMBER OF REMAINING WORDS  $5$3F2F1145
       CLA     .JLIN                 UPDATE LINES OUTPUT COUNT.         3F2F1150
       ADD     ONE                                                      3F2F1160
       STO     .JLIN                                                    3F2F1170
       LDC     BUFPT,4               REINITIALIZE COUNTS IF A NEW    $5$3F2F1200
       TXI     *+1,4,**              BUFFER HAS BEEN LOCATED,        $5$3F2F1210
CHKCT  TXH     SV2,4,**              OTHERWISE RETURN TO CALLER.     $5$3F2F1220
       NZT     PFLAG                 INITIALIZE IF NEW BUFFER WAS    $5$3F2F1240
       TSX     NEWBUF,2              LOCATED.                           3F2F1250
FIXCT  STZ     COUNT                                                    3F2F1260
       STZ     RECCT                                                    3F2F1270
       LXD     LOCBUF,4              RESTORE ACTUAL WORD COUNT       $5$3F2F1290
       SXD     BUFPT,4                                                  3F2F1300
       TRA     SV2                   RETURN TO CALLER.               $5$3F2F1320
FIX    STZ     KOUNT                                                    3F2F1330
       TXI     INC,4,1                                                  3F2F1340
SETMK  XCA                                                              3F2F1350
       NZT     RECCT                 SET RECORD MARK IN PREVIOUS        3F2F1360
       TRA     SVV2                  RECORD IF THERE IS A PREVIOUS      3F2F1370
SVV    AXT     **,1                  RECORD IN BUFFER.                  3F2F1380
       CAL     MASK1                                                    3F2F1390
SVV7   ANS     **,1                                                     3F2F1400
       CAL     RECMK                                                    3F2F1410
SVV1   ORS     **,1                                                     3F2F1420
SVV2   XCA                                                              3F2F1430
       ANA     MASK                  TEST CURRENT LINE TO SEE WHERE     3F2F1440
       SSP                           RECORD MARK CAN BE PLACED.         3F2F1450
       SUB     BLANK                                                    3F2F1460
       TZE     SVV3                  LAST CHARACTER IS BLANK.           3F2F1470
       LXD     ARG,4                 LAST CHARACTER NOT BLANK. CHECK TO 3F2F1480
SVV5   TXH     FIFTH,4,**            FORCE BUFFER FULL               $5$3F2F1490
       CLA     BLANKS                ADDITIONAL WORD. IF SO, ADD        3F2F1500
       STO*    BUFADD                WORD OF BLANKS AND STORE IN        3F2F1510
       TXI     *+1,4,1               BUFFER.                            3F2F1520
       SXD     RITCT,4               INCREMENT WORD COUNT IN IOCS       3F2F1530
       LXA     COUNT,4               CALLING SEQUENCE, IN               3F2F1540
       TXI     *+1,4,1               CUMULATIVE WORD COUNT,             3F2F1550
       SXA     COUNT,4               AND IN TEST FOR NEW BUFFER.        3F2F1560
       TRA     SVV4                                                     3F2F1580
SVV3   TXI     *+1,2,1                                                  3F2F1590
SVV4   SXA     SVV,2                 SET UP FOR STORING RECORD MARK     3F2F1600
       LXA     BUFADD,4              NEXT TIME THROUGH.                 3F2F1610
       SXA     SVV1,4                                                   3F2F1620
       SXA     SVV7,4                                                   3F2F1630
       LXA     RECCT,4               UPDATE RECORD COUNT.               3F2F1640
       TXI     *+1,4,1                                                  3F2F1650
       NZT*    SYSJOB+1              IF IN DC MODE                   $5$3F2F1651
       TRA     FIFTH                 UNBLOCK BCD OUTPUT              $5$3F2F1652
       IFF     NLRPB=0                                               (8)3F2F1653
       TXH     FIFTH,4,4                                                3F2F1660
       SXA     RECCT,4                                                  3F2F1670
       TRA     WRIT                                                     3F2F1680
FIFTH  LXD     BLKSZ,4               FORCE BUFFER FULL.              $5$3F2F1710
       SXD     BUFPT,4                                                  3F2F1720
       TRA     WRIT                                                     3F2F1740
BCVR   AXT     36,4                  CONVERSION OF BINARY INTEGER       3F2F1750
       STZ     BCDINT                TO BCD INTEGER.                    3F2F1760
BCVR1  XCA                                                              3F2F1770
       PXD     0,0                                                      3F2F1780
       DVP     TEN                                                      3F2F1790
       ALS     36,4                                                     3F2F1800
       ORS     BCDINT                                                   3F2F1810
       XCA                                                              3F2F1820
       TZE     BCVR2                                                    3F2F1830
       TXI     BCVR1,4,-6                                               3F2F1840
BCVR2  TRA     1,2                                                      3F2F1850
NEWBUF LXA     BUFADD,4              INITIALIZE FOR NEW BUFFER.         3F2F1860
       SXA     BUFBEG,4                                                 3F2F1870
       TXI     *+1,4,1                                                  3F2F1880
       SXA     BUFADD,4                                                 3F2F1890
       STL     KOUNT                                                    3F2F1900
       AXT     1,4                                                      3F2F1910
       SXA     COUNT,4                                                  3F2F1920
       TRA     2,2                                                      3F2F1930
.WEOB. PDC     0,4                   FIND LOCATION OF COMMAND WHICH  $5$3F2F1933
       TXI     *+1,4,-1              WAS NOT EXECUTED                $5$3F2F1934
       SXA     WRITE+1,4             INITIALIZE IOCS CALLING SEQUENCE$5$3F2F1935
       XCA                           FIND LOCATION OF NORMAL         $5$3F2F1936
       PAX     0,2                   RETURN FROM IOCS                $5$3F2F1937
       TSX     .WRITE,4              TRY TO WRITE AGAIN, IF END-OF-  $5$3F2F193B
 WRITE PZE     **,,WERR              BUFFER CONDITION STILL PERSISTS,$5$3F2F193C
       TCH     **                    PRINT ERROR MESSAGE, OTHERWISE  $5$3F2F193D
       TRA     0,2                   RETURN TO NORMAL PROCESSING.    $5$3F2F193E
DMPUNB NZT     FIRST                 IF THERE IS AN OUTPUT BUFFER    $5$3F2F193F
       TRA     1,2                   FOR UN06,                       $5$3F2F193G
       STZ     FIRST                 RESET INITIALIZATION SWITCH     $5$3F2F193H
       TSX     .WRITE,4              UNBUFFER UN06 WITH WRITE OF     $5$3F2F193I
DFILE  PZE     **,,.WEOB.            ZERO WORD COUNT.                $5$3F2F193J
       IOCD    *,,0                  RETURN TO FDMP TO READ IN       $5$3F2F193K
       TRA     1,2                   DMPREC AND CONTINUE.            $5$3F2F193L
ARG    PZE     **                    INCOMING ARGUMENT.                 3F2F1940
FIRST  PZE     **                    FIRST TIME THROUGH FLAG.           3F2F1950
PFLAG  PZE     **                    ZERO IF BLOCKED WITH CONTROL WORDS,3F2F1960
       REM                           NON-ZERO IF BLOCKED WITH RECORD    3F2F1970
       REM                           MARKS.                             3F2F1980
OTUN   PZE     .UN06.                                                   3F2F2000
BLKSZ  PZE     **                    DECREMENT CONTAINS BLOCK SIZE.     3F2F2010
COUNT  PZE     **                    COUNT OF WORDS PLACED IN BUFFER.   3F2F2020
KOUNT  PZE                                                              3F2F2030
RECCT  PZE     **                    COUNT OF RECORDS PLACED IN BUFFER. 3F2F2040
BUFADD PZE     **,2                                                     3F2F2050
ONE    DEC     1                                                        3F2F2060
SIX    DEC     6                                                        3F2F2070
TEN    DEC     10                                                       3F2F2080
RECWD  OCT     500000200460          RECORD FLAG WORD.                  3F2F2090
BUFBEG SLW     **                    STORE BLOCK FLAG WORD.             3F2F2100
BLKWD  OCT     760000000000          BLOCK FLAG WORD.                   3F2F2110
BCDINT PZE     **                                                       3F2F2120
BLANK  BCI     1,00000                                                  3F2F2130
BLANKS BCI     1,                                                       3F2F2140
RECMK  OCT     000000000072                                             3F2F2150
MASK   OCT     000000000077                                             3F2F2160
MASK1  OCT     777777777700                                             3F2F2170
  WERR TSX     .MWR,4                ISSUE END-OF-BUFFERS ERROR      $5$3F2F2180
       PZE     1                     MUST BE WRITTEN ON-LINE.           3F2F2190
       PZE     MSG,,10                                                  3F2F2200
       TRA     .LXERR                                                   3F2F2210
MSG    BCI     9,0END-OF-BUFFER EXIT WRITING SYSOU1. EXECUTION TERMINAT 3F2F2220
       BCI     1,ED.                                                    3F2F2230
LNKG   LDIR                                                             3F2F2240
       USE     A                                                        3F2F2250
       ORG     .LXOUT                                                   3F2F2260
       CALL    .FOUT.(.LXARG)                                           3F2F2270
       ORG     .FPOUT                                                   3F2F2280
       CALL    .FOUT.(.FPARG)                                           3F2F2290
       ORG     .FXOUT                                                   3F2F2300
       CALL    .FOUT.(.FXARG)                                           3F2F2310
       ORG     .DFOUT                OVERLAY (NOP) IN .LXCON         $5$3F2F2311
       TSX     DMPUNB,2              TO UNBUFFER SYSOU1 BEFORE DUMPS $5$3F2F2312
       USE                                                              3F2F2320
       END                                                              3F2F2330
$*     7090/7094 BCD CONVERT ROUTINES                                   3F300000
$IBMAP FCNV    1500,()OK                                             (8)3F300001
       TTL     FCNV - BCD CONVERT ROUTINES                          (14)3F300002
CHLIMT EQU     133                 LINE LIMIT IN CHARACTERS          (8)3F300011
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90 ,         $5$3F300012
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94 .        $5$3F300013
*                   (OR TO ANY VALUE NOT EQUAL TO 90.)               $5$3F300014
M9094  SET     90                                                    $5$3F300015
       PCC     ON                                                    $5$3F300016
       IFF     M9094=90                                              $5$3F300017
       GOTO    BEG94                                                 $5$3F300018
       PCC     OFF                                                   $5$3F300019
*              BCD CONVERT ROUTINES                                     3F300030
.WIDTH ENTRY   WIDTH                                                    3F300040
.ENDFS ENTRY   ENDFSW                                                   3F300050
.ONPT  ENTRY   ONPT                                                     3F300060
.OOUT  ENTRY   OOUT                                                     3F300070
.FIXSW ENTRY   FIXSW                                                    3F300080
.DBC   ENTRY   DBC                                                      3F300090
.KOUNT ENTRY   COUNT                                                    3F300100
.INTG  ENTRY   INTG                                                     3F300110
.TEST  ENTRY   TEST                                                     3F300120
.ANPT  ENTRY   ANPT                                                     3F300130
.AOUT  ENTRY   AOUT                                                     3F300140
.FXD   ENTRY   FXD                                                      3F300150
.FXFL1 ENTRY   FXFL1                                                    3F300160
.FXFL2 ENTRY   FXFL2                                                    3F300170
.FXFL3 ENTRY   FXFL3                                                    3F300180
.FLT   ENTRY   FLT                                                      3F300190
.DBC20 ENTRY   DBC20                                                    3F300200
.DDBC  ENTRY   DDBC                                                     3F300210
.DDSW  ENTRY   DDSW                                                     3F300220
.DDFIX ENTRY   DDFIX                                                    3F300230
.DFLT  ENTRY   DFLT                                                     3F300240
.LNTP  ENTRY   LNTP                                                     3F300250
.LOUT  ENTRY   LOUT                                                     3F300260
.DDRS2 ENTRY   DDRST2                                                   3F300270
.CNVSW ENTRY   CNVSW                                                    3F300280
.WORD  ENTRY   WORD                                                     3F300290
.DONE  ENTRY   DONE                                                     3F300300
.OUTBF ENTRY   OUTBUF                                                   3F300310
.DEXPN ENTRY   DEXPON                                                   3F300320
.DIG   ENTRY   DIG                                                      3F300330
.FEXP  ENTRY   EXP                                                      3F300340
.PEX   ENTRY   PEX                                                      3F300350
.MQD   ENTRY   MQD                                                      3F300360
.DDFLG ENTRY   DDFLAG                                                   3F300370
.DDDFL ENTRY   DDDFLG                                                   3F300380
.DDRS1 ENTRY   DDRST1                                                   3F300390
.LIST  ENTRY   LIST                                                     3F300400
       ENTRY   .FBDBF                                                   3F300410
.DBC10 ENTRY   DBC10                                                    3F300420
.D2    ENTRY   D2                                                       3F300430
.D1    ENTRY   D1                                                       3F300440
.FDX1  ENTRY   DX1                                                      3F300450
.FDX2  ENTRY   DX2                                                      3F300460
       ENTRY   .FERR2                                                $5$3F300463
.FPACK ENTRY   PACK                                                     3F300470
.TOPAC ENTRY   TOPACK                                                   3F300480
.CHAR  ENTRY   CHAR                                                     3F300490
BUFADD EQU     .FBDBF                                                   3F300500
       ENTRY   .FCNV.                                                   3F300510
       ENTRY   .FCON.                                                   3F300520
.FCON. STD     DDRST2                SET NOP AND TRA                    3F300530
       STD     CNVSW                 WHERE NECESSARY                    3F300540
       SXA     LNKG,4                                                $5$3F300541
       CLA     DX1                                                      3F300550
       STD     ENDFSW                                                   3F300560
       STZ     PEX                                                      3F300570
       SXA     TEST,2                INITIALIZE ADDRESSES IN            3F300580
       SXA     ENDFSW,1              FCNV TO PREVENT FCNV               3F300590
       CLA     3,4                   DEPENDENCY ON FIOH.                3F300600
       STA     DDRST1                                                   3F300610
       ARS     18                                                       3F300620
       STA     DDRST1+1                                                 3F300630
       CLA     4,4                                                      3F300640
       STA     CNVSW                                                    3F300650
       ARS     18                    STORE BUFFER ADDRESS IN CALL       3F300660
       STA     .FBDBF                CALL WAS FRCD                      3F300670
       TRA     1,4                   RETURN TO FIOH FORMAT SCAN         3F300680
       REM REENTRY FROM MAIN PROGRAM LIST.                              3F300690
.FCNV. NOP     LNKG,4                                                (6)3F300700
       SXA     LXIT1,1                                               (6)3F300701
       SXA     LXIT2,2               SAVE INDEX                         3F300710
       SXA     LEXIT,4               REGISTERS.                         3F300720
       DST     DATUM                 SAVE DATUM.                        3F300740
ENDFSW NOP     **                  * RESCAN FORMAT IF NECESSARY         3F300750
       REM  REENTRY FROM FIELD.                                         3F300760
       DLD     DATUM                 PICKUP DATUM, AND TRA TO (DBC,ANPT,3F300770
CNVSW  TRA     **                  * ONPT,AOUT,OOUT,FLT,FXD,INTG)       3F300780
       LXA     WIDTH,4               IR(4) = DESIRED FIELD WIDTH.       3F300790
       STZ     DG                    INITIALIZE.                        3F300800
       LDQ     MQD                   ..                                 3F300810
DX1    AXT     **,1                  CHARACTER COUNT.                   3F300820
DX2    AXT     **,2                  WORD COUNT.                        3F300830
       TRA*    CNVSW               * EXIT THRU CNVSW.                   3F300840
       REM  DBC / DECIMAL TO BINARY CONVERSION ROUTINE.                 3F300850
DBC    STZ     N                     INITIALIZE.                     (8)3F300870
       STZ     N+1                                                  (13)3F300872
       RIR     DBSPP+DBSEP                                          (13)3F300875
       STZ     V                     ..                                 3F300880
       CLA     FIXSW                                                 (8)3F300884
       STD     DBC9                                                  (8)3F300886
       CLS     DIG                   ..                                 3F300890
       STO     D                     ..                                 3F300900
       CLA     EXP                   ..                                 3F300910
       STO     E                     ..                                 3F300920
       TNO     DBC1                  TURN OFF                           3F300930
       TRA     DBC1                  OVERFLOW LIGHT.                    3F300940
DBCBL  SIR     DBSPP                 MAKE BLANK FIELD MINUS         (13)3F300944
       TRA     DBC15                                                 (8)3F300946
DBC2   TNX     DBCBL,4,1             BUMP WIDTH.                     (8)3F300950
DBC1   TIX     *+4,1,1               BUMP CHARACTER COUNT, IF EXHAUSTED 3F300960
       TXI     *+1,2,-1              GET NEXT WORD.                     3F300970
       AXT     6,1                   ..                                 3F300980
       LDQ*    BUFADD                ..                                 3F300990
       PXD     ,0                    TAKE A                             3F301000
       LGL     6                     CHARACTER.                         3F301010
       CAS     BLANK                 IF IT IS BLANK                     3F301020
       TRA     STOP1                 IGNORE IT.                         3F301030
       TRA     DBC2                  TAKE                               3F301040
       CAS     MINUS                 APPROPRIATE                        3F301050
       TRA     STOP1               * ACTION                             3F301060
       TRA     *+6                   ON                                 3F301070
       CAS     PLUS                  ERRORS, I.E. STOP.                 3F301080
       TRA     DBC9                  FOR LEGAL                          3F301090
       TRA     *+6                   + AND -                            3F301100
       CAS     NEGAT                 SIGNS                              3F301110
       TRA     STOP1               * SET                                3F301120
       CLA     MZE                   THE                                3F301130
       CAS     TEN                   SIGN                               3F301140
       TRA     STOP1               * OF                                 3F301150
DBCS1  PXD     ,0                    THE                                3F301160
       STO     DG                    RESULT.                            3F301170
DBC13  STO     N                     ..                                 3F301180
DBC14  TNX     DBC15,4,1             BUMP WIDTH.                        3F301190
DBC11  TIX     DBC98,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F301200
       TXI     DBC99,2,-1            GET ANOTHER WORD.                  3F301210
DBC3   TNX     DBC6,4,1              ENTRY ON E OR E BLANK, BUMP WIDTH. 3F301220
       TIX     DBC93,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED,3F301230
       TXI     DBC94,2,-1            GET ANOTHER WORD.                  3F301240
DBC94  AXT     6,1                   ..                                 3F301250
       LDQ*    BUFADD                ..                                 3F301260
DBC93  PXD     ,0                    TAKE A                             3F301270
       LGL     6                     CHARACTER.                         3F301280
       CAS     BLANK                 IF IT IS                           3F301290
       TRA     STOP2               * BLANK                              3F301300
       TRA     DBC3                  IGNORE IT.                         3F301310
       SXD     ER,4                  ILLEGAL                            3F301320
DBC4   CAS     MINUS                 CHARACTERS                         3F301330
       TRA     ER                  * CAUSE AN EXIT.                     3F301340
       TRA     DBC92                 A LEGAL                            3F301350
DBC5   CAS     PLUS                  + OR -                             3F301360
       TRA     ER                  * SIGN                               3F301370
       TRA     DBC6                  IS                                 3F301380
       CAS     NEGAT                 USED                               3F301390
       TRA     ER                  * TO                                 3F301400
DBC92  CLA     MZE                   SET                                3F301410
       CAS     TEN                   THE                                3F301420
       TRA     STOP2               * SIGN                               3F301430
DBC6   PXD     ,0                    OF                                 3F301440
DBC95  STO     E                     E, THEN                            3F301450
       TNX     DBC15,4,1             BUMP WIDTH, EXIT WHEN EXHAUSTED.   3F301460
       TIX     DBC96,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F301470
       TXI     DBC97,2,-1            GET ANOTHER WORD  AND CONVERT E.   3F301480
DBC97  AXT     6,1                   GET A NEW WORD FOR                 3F301490
       LDQ*    BUFADD                E FIELD.                           3F301500
DBC96  PXD     ,0                    TAKE A                             3F301510
       LGL     6                     CHARACTER.                         3F301520
       CAS     BLANK                 TREAT BLANK                        3F301530
       TRA     STOP3               * ZERO.                              3F301540
       TRA     *+3                   EXIT FOR                           3F301550
       CAS     TEN                   ILLEGAL CHARACTERS.                3F301560
ER3    TRA     STOP3               * CONVERT                            3F301570
       PXD     ,0                    E FIELD                            3F301580
       STO     DG                    AND                                3F301590
       CLA     E                     STORE                              3F301600
       ALS     2                     IN                                 3F301610
       ADD     E                     E                                  3F301620
       ALS     1                     AND                                3F301630
       ACL     DG                    GO                                 3F301640
       TRA     DBC95                 BUMP WIDTH.                        3F301650
DBC8   CAS     BLANK                 EXAMINE NON-NUMERIC                3F301660
       TRA     STOP4               * CHARACTER.                         3F301670
       TRA     DBC12                 TREAT BLANK AS ZERO.               3F301680
DBC9   NOP     STOP4                 TRA IF I CONVERSION             (8)3F301685
       SXD     U,4                   IF A                            (8)3F301690
       STD     ER                    DECIMAL                            3F301700
       CAS     POINT                 POINT, RECORD                      3F301710
       TRA     DBC4                  FIELD                              3F301720
       TXI     DBC30,4,-1            WIDTH.                             3F301730
DBC10  CAS     EXPON                 ON AN E (OR D FOR DOUBLE PRECISION)3F301740
       TRA     STOP4               * GO CONVERT                         3F301750
       TRA     DBC3                  E FIELD.                           3F301760
       TRA     DBC5                  ANYTHING ELSE CONTINUE ABOVE.      3F301770
DBC30  PXA     ,4                    DECIMAL POINT FIELD POSITION       3F301780
       STO     U                     IS SET                             3F301790
       STO     D                     HERE.                              3F301800
       TXI     DBC14,4,1             EXIT TO CONTINUE.                  3F301810
DBC99  AXT     6,1                   GET A                              3F301820
       LDQ*    BUFADD                NEW WORD.                          3F301830
DBC98  PXD     ,0                    TAKE A                             3F301840
       LGL     6                     CHARACTER.                         3F301850
       CAS     TEN                   TREAT BLANK                        3F301860
       TRA     DBC8                  AS ZERO, EXAMINE                   3F301870
DBC12  PXD     ,0                    OTHER NON-NUMERICS AT DBC8.        3F301880
       STA     DG                    CONVERT                            3F301890
       CLA     N                     BCD                                3F301900
       ALS     2                     TO                                 3F301910
       ADD     N                     BINARY                             3F301920
       ALS     1                     AND                                3F301930
       ADD     DG                    IF                                 3F301940
       TNO     DBC13                 NO OVERFLOW CONTINUE.              3F301950
DBC20  TRA     *+1                   DOUBLE PRECISION OVERFLOW SWITCH.  3F301960
       CLA     V                     IF OVERFLOW, IGNORE                3F301970
       ADD     L(1)                  CONVERTED RESULT, BUT              3F301980
       STO     V                     ADD ONE TO V.                      3F301990
       TIX     DBC11,4,1             BUMP WIDTH.                        3F302000
DBC15  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F302010
       SXA     DX1,1                 CHARACTERS AND                     3F302020
       SXA     DX2,2                 COUNTS.                            3F302030
       CLA     N                     PICK UP CONVERTED N.               3F302050
       TZE     DBEXIT                EXIT ON N = 0.                     3F302060
       TPL     *+3                                                   $5$3F302070
       SIR     DBSPP                                                 $5$3F302075
       SSP                                                           $5$3F302080
       NZT     DDFLAG                                               (13)3F302085
DDSW   TRA     DDFIX                                                (13)3F302095
       CLA     ND+1                                                 (13)3F302100
       STO     N+1                                                  (13)3F302105
       CLA     ND                                                   (13)3F302110
DDFIX  STO     N                                                    (13)3F302115
FIXSW  NOP     DBEXIT                                                $5$3F302120
       CLA     D             -DIG FROM FORMAT SPEC                   $5$3F302125
       TMI     *+4           WAS DEC POINT SPECIFIED - NO            $5$3F302130
       CLA     U             YES                                     $5$3F302135
       ARS     18                                                    $5$3F302140
       SUB     D                                                     $5$3F302145
       ADD     E                                                     $5$3F302150
       ADD     V             OVERFLOW COUNT                          $5$3F302155
       TPL     *+2                                                   $5$3F302160
       SIR     DBSEP         SAVE SIGN OF EXPONENT                   $5$3F302165
       PAX     0,1           XR1=TRUE EXPONENT                       $5$3F302170
       AXT     128,2                                                 $5$3F302175
       ZET     DDFLAG                                                $5$3F302180
       AXT     163,2                                                 $5$3F302185
       STZ     N+2                                                   $5$3F302190
       AXT     0,4                                                   $5$3F302200
       TXL     DB832,1,0                                             $5$3F302205
       AXC     N,4                                                   $5$3F302210
DB827  SXA     DB831,1                                               $5$3F302215
       TXL     *+2,1,10                                              $5$3F302220
       AXT     10,1                                                  $5$3F302225
       CLA     IC10+10,1                                             $5$3F302230
       STO     DB8PW                                                 $5$3F302235
       RNT     DBSEP                                                 $5$3F302240
       TXI     DB829,4,-2    EXPONENT IS POSITIVE                    $5$3F302245
*                            NEGATIVE EXPONENT                       $5$3F302250
       PXD     0,0                                                   $5$3F302255
       AXT     3,1                                                   $5$3F302260
       AXT     3,4                                                   $5$3F302265
DB828  LDQ     N+3,4                                                 $5$3F302270
       DVP     DB8PW                                                 $5$3F302275
       STQ     N+3,1                                                 $5$3F302280
       NZT     N                                                     $5$3F302285
       TXI     *+2,2,-35     REDUCE CHARACTERISTIC                   $5$3F302290
       TNX     DB831,1,1     STEP TO NEXT RESULT STORAGE             $5$3F302295
       TIX     DB828,4,1                                             $5$3F302300
       LDQ     =0                                                    $5$3F302305
       TRA     DB828+1                                               $5$3F302310
DDBC   STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F302370
       SXA     DDSV4,4                                                  3F302380
       AXT     DDBC7,4               SET DOUBLE PRECISION EXIT AFTER    3F302390
       SXA     DBC99-1,4             DECIMAL POINT IS SCANNED.          3F302400
DDSV4  AXT     **,4                                                     3F302410
       STZ     DATUM+1                                                  3F302420
       STL     DDFLAG                SET FLAG INDICATING DOUBLE         3F302430
       PXD     0,0                   PRECISION RESULT OCCUPIES TWO      3F302440
       LDQ     N                     CELLS AND SET PARTIALLY            3F302450
       LRS     0                     CONVERTED RESULT IN                3F302460
       DST     ND                    LOW ORDER PART.                    3F302470
       TRA     DDBC4                                                    3F302480
DDBC1  TIX     DDBC2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F302490
       TXI     DDBC3,2,-1            GET ANOTHER WORD.                  3F302500
DDBC3  AXT     6,1                   RESET CHARACTER COUNT.             3F302510
       LDQ*    BUFADD                GET A NEW WORD.                    3F302520
DDBC2  PXD     0,0                   EXAMINE                            3F302530
       LGL     6                     NEXT CHARACTER.                    3F302540
       CAS     TEN                   TREAT BLANK AS ZERO.               3F302550
       TRA     DDBC5                 NON-NUMERIC.                       3F302560
DDBC6  PXD     0,0                                                      3F302570
       STA     DG                    SAVE NUMERIC CHARACTER.            3F302580
       STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F302590
       DLD     ND                                                       3F302600
DDBC4  LLS     2                     CONVERT BCD TO BINARY.             3F302610
       TOV     DDOV                  THIS INVOLVES DOUBLE PRECISION     3F302620
       STO     F                     FIXED POINT ADDITION.              3F302630
       XCA                                                              3F302640
       ADD     ND+1                                                     3F302650
       XCA                                                              3F302660
       PXD     0,0                                                      3F302670
       CLA     F                                                        3F302680
       TNO     *+2                                                      3F302690
       ADD     L(1)                                                     3F302700
       ADD     ND                                                       3F302710
       TOV     DDOV                                                     3F302720
       LLS     1                                                        3F302730
       TOV     DDOV                                                     3F302740
       XCA                                                              3F302750
       ADM     DG                                                       3F302760
       XCA                                                              3F302770
       TNO     *+2                                                      3F302780
       ADD     L(1)                                                     3F302790
       TOV     DDOV                                                     3F302800
       DST     ND                                                       3F302810
       LDQ     DMQD                                                     3F302820
DDBC7  TNX     DBC15,4,1             BUMP WIDTH.                        3F302830
       TRA     DDBC1                                                    3F302840
DDBC5  CAS     BLANK                 EXAMINE NON-NUMERIC CHARACTER.     3F302850
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F302860
       TRA     DDBC6                 TREAT BLANK AS ZERO.               3F302870
       TRA     DBC9                                                     3F302880
DDOV   LDQ     DMQD                  IF OVERFLOW,IGNORE CONVERTED       3F302890
       CLA     V                     RESULT BUT ADD ONE TO V.           3F302900
       ADD     L(1)                                                     3F302910
       STO     V                                                        3F302920
       TIX     DDOV1,4,1             BUMP WIDTH.                        3F302930
       TRA     DBC15                 EXIT WHEN WIDTH EXHAUSTED.         3F302940
DDOV1  TIX     DDOV2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F302950
       TXI     *+1,2,-1              GET ANOTHER WORD.                  3F302960
       AXT     6,1                   RESET CHARACTER COUNT.             3F302970
       LDQ*    BUFADD                GET A NEW WORD.                    3F302980
DDOV2  PXD     0,0                   EXAMINE                            3F302990
       LGL     6                     NEXT CHARACTER.                    3F303000
       CAS     TEN                                                      3F303010
       TRA     DDOV3                                                    3F303020
       TRA     DDOV+1                                                   3F303030
       TRA     DDOV+1                                                   3F303040
DDOV3  CAS     BLANK                                                    3F303050
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F303060
       TRA     DDOV+1                TREAT BLANK AS ZERO.               3F303070
       TRA     DBC9                                                     3F303080
*                  POSITIVE EXPONENT                                 $5$3F303090
DB829  AXT     3,1                                                   $5$3F303100
       LDQ     DB8PW                                                 $5$3F303110
       MPY     0,4                                                   $5$3F303120
       TXH     DB830,1,2                                             $5$3F303130
       XCA                                                           $5$3F303140
       ADD     1,4                                                   $5$3F303150
       XCL                                                           $5$3F303160
       TQP     *+3                                                   $5$3F303170
       ADD     L(1)                                                  $5$3F303180
       LRS     0                                                     $5$3F303190
DB830  STO     0,4                                                   $5$3F303200
       STQ     1,4                                                   $5$3F303210
       TNX     *+2,1,1                                               $5$3F303220
       TXI     DB829+1,4,1                                           $5$3F303230
       TZE     *+2                                                   $5$3F303240
       TXI     DB831,2,35    INCREMENT CHARACTERISTIC                $5$3F303250
       TXI     *+1,4,-1                                             (13)3F303255
       TXH     DB831,4,-ND                                          (13)3F303260
       AXC     N,4                                                  (13)3F303265
DB831  AXT     **,1                                                  $5$3F303270
       TIX     DB827,1,10                                            $5$3F303280
       RFT     DBSEP                                                 $5$3F303290
DB832  AXC     N,4                                                   $5$3F303300
*                  FLOAT NUMBER                                      $5$3F303310
       LFTM                                                          $5$3F303320
       CLA     0,4                                                   $5$3F303330
       LRS     8                                                     $5$3F303340
       ADD     DB871         35B8                                    $5$3F303350
       STO     DB8PW                                                 $5$3F303360
       CLA     DB872         27B16                                   $5$3F303370
       LLS     8                                                     $5$3F303380
       FAD     DB8PW                                                 $5$3F303390
       ARS     9                                                     $5$3F303400
       PDX     0,1                                                   $5$3F303410
       STD     *+1                                                   $5$3F303420
       TXI     *+1,2,**                                              $5$3F303430
       TXH     FERR3,2,1000                                          $5$3F303440
       TXH     FERR2,2,255                                           $5$3F303450
       CLA     1,4                                                   $5$3F303460
       LDQ     2,4                                                   $5$3F303470
       LLS     35,1                                                  $5$3F303480
       STO     2,4                                                   $5$3F303490
       CLA     0,4                                                   $5$3F303500
       LDQ     1,4                                                   $5$3F303510
       LLS     35,1                                                  $5$3F303520
       LDQ     2,4                                                   $5$3F303530
       LRS     8                                                     $5$3F303540
       STO     0,4                                                   $5$3F303550
       PXD     0,2                                                   $5$3F303560
       ALS     9                                                     $5$3F303570
       TOV     *+1                                                   $5$3F303580
       ZET     DDDFLG                                                $5$3F303590
       TXI     DB833,2,-27   DOUBLE PRECISION                        $5$3F303600
DB834  ORA     0,4           SINGLE PRECISION                        $5$3F303610
       RQL     28                                                    $5$3F303620
       FRN                                                           $5$3F303625
       TRA     DBEXIT-1                                             (13)3F303630
DB833  TXH     DB834,2,256                                           $5$3F303635
       ORS     0,4                                                   $5$3F303640
       PXA     0,2                                                   $5$3F303645
       LLS     27                                                    $5$3F303650
       RQL     28                                                    $5$3F303655
       FRN                                                           $5$3F303660
       FAD     0,4                                                   $5$3F303665
       EFTM                                                          (6)3F303673
DBEXIT RFT     DBSPP                                                 $5$3F303675
       SSM                                                           $5$3F303680
       LRS     0                                                     $5$3F303685
       LAS     CHTEST                                                $5$3F303686
       TRA     *+3                                                   $5$3F303687
       TRA     *+2                                                   $5$3F303688
       LDQ     =0                                                    $5$3F303689
       DST     DATUM                                                 $5$3F303690
       STZ     N+1                                                   (6)3F303701
       TRA     COUNT-2                                               $5$3F303710
       EVEN                                                          $5$3F303712
CHTEST DEC     1.EE-30                                               $5$3F303713
IC10   DEC     10000000000,1000000000,100000000,10000000,1000000     $5$3F303720
       DEC     100000,10000,1000,100,10,1                            $5$3F303721
DDRSET AXT     DBC14,4               RESET EXIT CHANGED FOR TWO-CELL    3F303730
       SXA     DBC99-1,4             DOUBLE PRECISION CONVERSION.       3F303740
       STZ     DDFLAG                RESET FLAG.                        3F303750
       LXA     COUNT,4               IF FIELD                           3F303760
       TNX     DDRST1,4,1            COUNT IS                           3F303770
       TRA     COUNT                 EXHAUSTED,                         3F303780
DDRST1 AXT     **,4                  RESET ALL DOUBLE PRECISION EXITS   3F303790
       SXA     **,4                                                     3F303800
DDRST2 NOP     D3                                                       3F303810
       AXT     EXPON,4                                                  3F303820
       SXA     DBC10,4                                                  3F303830
D1     AXT     **,4                                                     3F303840
       SXA     DBC20,4                                                  3F303850
D2     AXT     **,4                                                     3F303860
       SXA     DDSW,4                                                   3F303870
D3     STZ     DDDFLG                                                   3F303880
       TRA     1,2                                                      3F303890
       REM  ILLEGAL INPUT DATA.                                         3F303900
STOP1  CLA     BUFADD                STORE LOCATION OF INPUT            3F303910
       ALS     18                    BUFFER FOR FXEM.                   3F303920
       STD     CODE1                                                    3F303930
       SXA     SP1SV,4                                                  3F303940
1STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F303950
SP1SV  AXT     **,4                                                     3F303960
       TOV     *+1                                                   (6)3F303961
       TRA     DBCS1                                                    3F303970
ER     TXH     STOP4,4,**                                               3F303980
STOP2  CLA     BUFADD                STORE LOCATION OF INPUT            3F303990
       ALS     18                    BUFFER FOR FXEM.                   3F304000
       STD     CODE1                                                    3F304010
       SXA     SP2SV,4                                                  3F304020
2STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304030
SP2SV  AXT     **,4                                                     3F304040
       TRA     DBC6                                                     3F304050
STOP3  CLA     BUFADD                STORE LOCATION OF INPUT            3F304060
       ALS     18                    BUFFER FOR FXEM.                   3F304070
       STD     CODE1                                                    3F304080
       SXA     SP3SV,4                                                  3F304090
3STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304100
SP3SV  AXT     **,4                                                     3F304110
       TRA     ER3+1                                                    3F304120
STOP4  CLA     BUFADD                STORE LOCATION OF INPUT            3F304130
       ALS     18                    BUFFER FOR FXEM.                   3F304140
       STD     CODE1                                                    3F304150
       SXA     SP4SV,4                                                  3F304160
4STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F304170
SP4SV  AXT     **,4                                                  (6)3F304175
       TOV     *+1                                                   (6)3F304176
       TRA     DBC12                                                 $5$3F304181
FERR2  TSX     .FERR2,1                                              $5$3F304182
       OCT     377777777777                                          $5$3F304183
       OCT     344777777777                                          $5$3F304184
FERR3  TSX     .FERR2,1                                              $5$3F304185
       DEC     0                                                     $5$3F304186
       DEC     0                                                     $5$3F304187
.FERR2 CALL    .FXEM.(CODE3)      OVERFLOW OR UNDERFLOW              $5$3F304188
       CLA     1,1                                                   $5$3F304189
       EFTM                                                          (6)3F30418A
       LDQ     2,1                                                   $5$3F304190
       TRA     DBEXIT+3                                              $5$3F304191
CODE3  PZE     71                                                    $5$3F304192
ER71MS PZE     E71MES,,11                                            $5$3F304193
ER71OP PZE     E71OMS,,6                                             $5$3F304194
E71MES BCI     8,0INPUT DATA NOT WITHIN PERMISSIBLE RANGE OF FLOA    $5$3F304195
       BCI     3,TING POINT NUMBERS                                  $5$3F304196
E71OMS BCI     6,0READING OF INPUT DATA CONTINUES                    $5$3F304197
       REM  ENTRY FOR INPUT OF ALPHAMERIC DATA.                         3F304200
ANPT   TIX     ANPT1,1,1             SCAN THE CURRENT INPUT FIELD.      3F304210
       TXI     *+1,2,-1              IF WIDTH                           3F304220
       LDQ*    BUFADD                IS GREATER THAN OR EQUAL TO SIX,   3F304230
       AXT     6,1                   OBTAIN                             3F304240
ANPT1  LGL     6                     THE SIX                            3F304250
       TIX     ANPT,4,1              RIGHTMOST                          3F304260
       SXA     DX2,2                 CHARACTERS.                        3F304270
       STQ     MQD                   ..                                 3F304280
       LXA     WIDTH,4               LEFT ADJUST, IF LESS THAN SIX      3F304290
       LDQ     BLANKS                AND                                3F304300
       TXH     ONPT4,4,5           * FILL OUT                           3F304310
       LGL     6                     WORD                               3F304320
       TXI     *-2,4,1               WITH BLANKS.                       3F304330
       REM  ENTRY FOR INPUT OF OCTAL DATA.                              3F304340
ONPT   STZ     N                     CONVERT                            3F304350
       STZ     BLCNT                                                 (8)3F304355
ONPT1  TIX     *+6,1,1               FROM                               3F304360
       LXA     DX2,2                 OCTAL                              3F304370
       TXI     *+1,2,-1              TO                                 3F304380
       LDQ*    BUFADD                BINARY.                            3F304390
       SXA     DX2,2                 IF FIELD                           3F304400
       AXT     6,1                   WIDTH IS                           3F304410
       PXD     ,0                    GREATER THAN 12                    3F304420
       LGL     6                     ONLY THE 12                        3F304430
       PAX     ,2                    RIGHTMOST                          3F304440
       TXL     ONPT3,2,7             DIGITS ARE                         3F304450
       SUB     BLANK                 SIGNIFICANT.                       3F304460
       TZE     CNTBL                 IF LESS                         (8)3F304470
       ZET     BLCNT                                                 (8)3F304478
       TRA     STOP5                 (ILLEGAL CHARACTER)             (8)3F304479
       CLA     MZE                   THAN 12,                           3F304480
       TXL     STOP5,2,11            RIGHT-ADJUST                       3F304490
       TXL     ONPT2,2,12            AND FILLOUT                        3F304500
       TXH     STOP5,2,32            WITH                               3F304510
       TXH     ONPT2,2,32-1          ZEROS.                             3F304520
       TXH     STOP5,2,16            TREAT BLANKS                       3F304530
       TXH     ONPT3,2,16-1          AS ZEROS.                          3F304540
STOP5  CLA     BUFADD                STORE LOCATION OF INPUT            3F304550
       ALS     18                    BUFFER FOR FXEM.                   3F304560
       STD     CODE2                                                    3F304570
       SXA     SP5SV,4                                                  3F304580
5STOP  CALL    .FXEM.(CODE2)         EXIT FOR EXECUTION ERROR.          3F304590
SP5SV  AXT     **,4                                                     3F304600
       TRA     ONPT3                 ILLEGAL INPUT DATA.                3F304610
CNTBL  ZET     BLCNT                                                 (8)3F304620
       TRA     ONPT3                 INPUT DATA NOT BLANK FIELD.     (8)3F304625
       TRA     ONPT3A                                                (8)3F304630
ONPT2  STO     DG                    SET SIGN MINUS.                 (8)3F304640
ONPT3  STA     DG                    ..                                 3F304650
       CAL     N                     ..                                 3F304660
       ALS     3                     ..                                 3F304670
       ADM     DG                    ..                                 3F304680
       SLW     N                     ..                                 3F304690
       STL     BLCNT                 (INPUT DATA NOT ALL BLANKS)     (8)3F304695
ONPT3A TIX     ONPT1,4,1                                             (8)3F304700
       NZT     BLCNT                 IS INPUT DATA FIELD BLANK...    (8)3F304708
       ORA     MZE                   YES.  TREAT IT AS MINUS ZERO.   (8)3F304709
       ORA     DG                    ..                                 3F304710
       STQ     MQD                   ..                                 3F304720
       REM  ENTRY FROM ANPT.                                            3F304730
ONPT4  SLW     DATUM                 ..                                 3F304740
       SXA     DX1,1                 ..                                 3F304750
       TRA     COUNT               * EXIT TO TEST FIELD COUNT.          3F304760
       REM  ENTRY FOR INPUT OF LOGICAL DATA                             3F304770
LNTP   STZ     DATUM                 SET LOGICAL VARIABLE TO FALSE.     3F304780
LNTP0  TIX     LNTP1,1,1             IS CHARACTER COUNT EXHAUSTED.      3F304790
       TXI     *+1,2,-1              YES. INCREMENT WORD COUNT.         3F304800
       AXT     6,1                                                      3F304810
       LDQ*    BUFADD                GET NEXT INPUT WORD.               3F304820
LNTP1  PXD     ,0                                                       3F304830
       LGL     6                     TAKE A CHARACTER.                  3F304840
       CAS     TRUE                                                     3F304850
       TRA     STOPL                                                    3F304860
       TRA     LNPT3                 CHARACTER = T.                     3F304870
       CAS     BLANK                                                    3F304880
       TRA     STOPL                                                    3F304890
       TRA     LNPT2                 CHARACTER = BLANK.                 3F304900
       CAS     FALSE                                                    3F304910
       TRA     STOPL                                                    3F304920
       TRA     LNPT4                 CHARACTER = F.                     3F304930
STOPL  CLA     BUFADD                ERROR. ILLEGAL INPUT CHARACTER.    3F304940
       ALS     18                                                       3F304950
       STD     CODE9                                                    3F304960
       SXA     SPLSV,4                                                  3F304970
       CALL    .FXEM.(CODE9)         OPTIONAL RETURN IS TREAT AS BLANK. 3F304980
SPLSV  AXT     **,4                                                     3F304990
LNPT2  TIX     LNTP0,4,1                                                3F305000
       TRA     LNPT6                 IF FIELD IS BLANK, ASSUME FALSE.   3F305010
LNPT3  STL     DATUM                 SET LOGICAL VARIABLE TO TRUE.      3F305020
LNPT4  TNX     LNPT6,4,1             SKIP TO END OF INPUT FIELD.        3F305030
       TIX     LNPT5,1,1                                                3F305040
       TXI     *+1,2,-1                                                 3F305050
       AXT     6,1                                                      3F305060
       LDQ*    BUFADD                                                   3F305070
LNPT5  LGL     6                                                        3F305080
       TRA     LNPT4                                                    3F305090
LNPT6  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F305100
       SXA     DX1,1                 CHARACTER AND                      3F305110
       SXA     DX2,2                 WORD COUNTS.                       3F305120
       TRA     COUNT                 GO TEST FIELD COUNT.               3F305130
       REM  ENTRY FOR OUTPUT OF ALPHAMERIC DATA.                        3F305140
AOUT   LXA     WIDTH,4               STARTING ON THE LEFT,              3F305150
       XCA                           MOVE THE SPECIFIED NUMBER          3F305160
       TXL     *+2,4,6               OF ALPHANUMERICS                   3F305170
       AXT     6,4                   FROM THE CURRENT WORD              3F305180
       PXD     ,0                    INTO THE                           3F305190
       LGL     6                     CHARACTER BUFFER.                  3F305200
       SLW     CHAR,4                THEN GO                            3F305210
       TIX     *-3,4,1               FILL OUT THE FIELD                 3F305220
       TXI     TOPACK,4,5          * WITH LEADING BLANKS.               3F305230
       REM  ENTRY FOR OUTPUT OF OCTAL DATA.                             3F305240
OOUT   XCA                           STARTING ON THE RIGHT,             3F305250
       AXT     12,4                  CONVERT THE                        3F305260
       PXD     ,0                    CURRENT                            3F305270
       LGL     3                     WORD                               3F305280
       SLW     CHAR,4                FROM                               3F305290
       TIX     *-3,4,1               BINARY                             3F305300
       LXA     WIDTH,4               TO                                 3F305310
       TXH     OUTEX,4,11            OCTAL                              3F305320
       LDQ     DATUM                 AND                                3F305330
       PXD     ,0                    MOVE                               3F305340
       LLS     2                     INTO                               3F305350
       TNZ     OUTEX                 CHARACTER                          3F305360
       CAL     BLANK                 BUFFER.                            3F305370
       AXT     10,4                  CONVERT                            3F305380
       ZET     CHAR-1,4              LEADING                            3F305390
       TXI     *+3,4,1               ZEROS                              3F305400
       SLW     CHAR-1,4              TO BLANKS.                         3F305410
       TIX     *-3,4,1               SIGN                               3F305420
       TQP     *+3                   THE NUMBER,                        3F305430
       CAL     MINUS                 IF                                 3F305440
       SLW     CHAR-1,4              NEGATIVE                           3F305450
OUTEX  AXT     12,4                  AND WITHIN FIELD SIZE              3F305460
       TRA     TOPACK              * GO FILL OUT FIELD WITH BLANKS.     3F305470
       REM  ENTRY FOR OUTPUT OF LOGICAL DATA                            3F305480
LOUT   LDQ     TFTEST                PICKUP T AND F CHARACTERS.         3F305490
       PXD     ,0                                                       3F305500
       NZT     DATUM                 TEST LOGICAL VARIABLE.             3F305510
       RQL     6                     LOGICAL VARIABLE IS FALSE.         3F305520
       LGL     6                     LOGICAL VRAIABLE IS TRUE.          3F305530
       AXT     1,4                                                      3F305540
       STO     CHAR,4                SAVE CHARACTER AND GO TO FILL      3F305550
       TRA     TOPACK                OUT FIELD WITH LEADING BLANKS.     3F305560
       REM  BDC/BINARY TO DECIMAL CONVERSION.                           3F305570
       REM  ENTRY FOR DOUBLE-PRECISION FLOATING POINT OUTPUT.           3F305580
DFLT   TZE     BDC1                  EXIT ON ZERO                    (6)3F305590
       XCL                           PBIT ASSUMED OFF                (6)3F305600
       PXD     ,0                    OBTAIN CHARACTERISTIC              3F305640
       LLS     8                     MODULO 128.                        3F305650
       SUB     =128                  OBTAIN APPROXIMATION OF POWER      3F305660
       XCA                           OF TEN CORRESPONDING TO THIS       3F305670
       VLM     LOG2,,12              POWER OF TWO BY MULTIPLYING        3F305680
       PAX     ,2                    BY LOG 2. INTEGRAL PORTION OF      3F305690
       ALS     1                     RESULT IS IN ACCUMULATOR.          3F305700
       TPL     DFLT2                                                    3F305710
       PAC     ,4                    PREPARE TO COMPARE DATA WITH       3F305720
       CLA     DATUM                 POWERS OF TEN FROM -1 TO -38.      3F305730
       LAS     D1E0+2,4              COMPARE HIGH ORDER PORTION.        3F305740
       TRA     DFLT3                 TRUE SCALE.                        3F305750
       TRA     CMPLSN                GO TO COMPARE LOW ORDER PORTION.   3F305760
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F305770
DFLT2  PAX     ,4                    PREPARE TO COMPARE DATA WITH       3F305780
       CLA     DATUM                 POWERS OF TEN FROM 0 TO +38.       3F305790
       LAS     D1E0,4                COMPARE HIGH ORDER PORTION.        3F305800
       TXI     *+2,2,1               ADJUST EXPONENT UP BY ONE.         3F305810
       TRA     CMPLSP                GO TO COMPARE LOW ORDER PORTION.   3F305820
DFLT3  PXA     0,2                   TRUE EXPONENT.                     3F305830
       LLS     0                     GET SIGN OF EXPONENT.              3F305840
       SUB     PEX                   ADJUST EXPONENT BY SCALE FACTOR.   3F305850
DFLT3A STO     EXP                                                   (6)3F305860
       LDQ     DEXPON                PREPARE TO PLACE A D IN EXPONENT   3F305870
       STQ     CHAR-4                FIELD FOR OUTPUT.                  3F305880
       LDI     BLANK                                                    3F305890
       TPL     *+3                                                   (6)3F305900
       TZE     *+2                                                   (6)3F305905
       RIR     20                                                       3F305910
       STI     CHAR-3                SET SIGN OF EXPONENT FOR OUTPUT.   3F305920
       LDQ     L(1)                  FORM BCD REPRESENTATION OF         3F305930
       LRS     3                     EXPONENT AND STORE FOR OUTPUT.     3F305940
       VDP     TEN,,3                                                   3F305950
       STQ     CHAR-2                                                   3F305960
       SLW     CHAR-1                                                   3F305970
       CLA     EXP                                                      3F305980
       ALS     1                     DOUBLE EXPONENT FOR             (6)3F305990
       PAX     ,4                    PURPOSES OF INDEXING            (6)3F306000
       TMI     DFLT5                 IS MULTIPLICATION REQUIRED      (6)3F306010
       DLD     DATUM                 NO,PREPARE TO DIVIDE            (6)3F306020
       TXL     DFLT7,4,0             IS SCALING NEEDED               (6)3F306030
       TNX     DFLT4,4,2*38   YES                                    (6)3F306035
       DFDP    DE38           DIVIDE BY 10**38 SINCE EXP .GT. 76     (6)3F306040
DFLT4  DFDP    D1E0,4         OTHERWISE ONLY ONE DIVISION NECESSARY  (6)3F306050
       TRA     DFLT7                                                 (6)3F306060
DFLT5  DLD     DATUM                 FOR NEGATIVE EXP,SCALING        (6)3F306070
       TNX     DFLT6,4,2*38                                          (6)3F306075
       DFMP    DE38           MULTIPLY BY 10**38 SINCE EXP .LT. 76   (6)3F306080
DFLT6  DFMP    D1E0,4         OTHERWISE ONE MULTIPLICATION NEEDED    (6)3F306090
       USE     REMOTE                GET CODING OUT OF THE WAY       (6)3F306180
CMPLSN CLA     DATUM+1               COMPARE LOW ORDER PORTION FOR CASE 3F306190
       LAS     D1E0+3,4              OF EQUAL HIGH ORDER COMPARE.       3F306200
       TRA     DFLT3                 TRUE SCALE.                        3F306210
       TRA     DFLT3                 TRUE SCALE.                        3F306220
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306230
CMPLSP CLA     DATUM+1               COMPARE LOW ORDER PORTION FOR CASE 3F306240
       LAS     D1E0+1,4              OF EQUAL HIGH ORDER COMPARE.       3F306250
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306260
       TXI     DFLT3,2,1             ADJUST EXPONENT UP BY ONE.         3F306270
       TRA     DFLT3                 TRUE SCALE.                        3F306280
       USE                           CONTINUE IN-LINE CODE           (6)3F306290
DFLT7  XCL                           STORE ABSOLUTE VALUE OF SCALED     3F306300
       XCA                           NUMBER.                            3F306310
       DST     N                                                        3F306320
       CAS     D1E0-15               COMPARE SCALED NUMBER              3F306330
       NOP                           WITH 200000000000.                 3F306340
       TRA     DFLT12                TRANSFER IF EQUAL OR GREATER.      3F306350
       STZ     ND+1                  NO INTEGER PORTION.                3F306360
       UFA     =128B8                EXPRESS FRACTIONAL PORTION         3F306370
       STO     FD                    OF SCALED DATA WITH                3F306380
       XCA                           CHARACTERISTIC OF 200.             3F306390
       UFA     N+1                   SHIFT SO THAT BINARY POINT         3F306400
       LDQ     FD                    IS BETWEEN SIGN AND BIT 1          3F306410
DFLT11 ALS     8                     OF MOST SIGNIFICANT PORTION.       3F306420
       XCA                                                              3F306430
       LLS     8                                                        3F306440
       DST     FD                    STORE FRACTIONAL PORTION           3F306450
       TOV     *+1                   AND TURN OFF OVERFLOW INDICATOR.   3F306460
ROUND  CLA     DIG                   PICK-UP DECIMAL DIGIT INDICATOR.   3F306490
       ALS     1                     SET INDEXING TO OBTAIN             3F306500
       PAC     0,4                   APPROPRIATE ROUNDING FACTOR.       3F306510
       CLA     FD+1                  ROUND LOW ORDER PORTION OF         3F306520
       ADD     DRND+1,4              BINARY FRACTION                 (6)3F306530
       STO     FD+1                  AND STORE.                         3F306540
       CLA     FD                    ROUND HIGH ORDER PORTION           3F306550
       TNO     *+2                   OF BINARY FRACTION                 3F306560
       ADD     L(1)                  ADJUSTING FOR OVERFLOW             3F306570
       ADD     DRND,4                IF ANY                          (6)3F306580
       STO     FD                    AND STORE.                         3F306590
       CLA     ND+1                  GET INTEGER PART IN AC.         (6)3F306600
       TNO     DFLT8                 IF NO OVERFLOW, GO TO CONVERT.  (6)3F306610
       ADD     L(1)                  ADJUST INTEGER PART             (6)3F306620
       STO     ND+1                  AND STORE.                         3F306630
DFLT8  LXA     PEX,4                 GET P SCALE FACTOR              (6)3F306640
       CAS     IC10+10,4                                             (6)3F306650
       TRA     DFLT8A                                                (6)3F306655
       TRA     DFLT8A                                                (6)3F306660
       USE     REMOTE                                                (6)3F306665
DFLT8A CLA     EXP                                                   (6)3F306670
       ADD     L(1)                                                  (6)3F306675
       TRA     DFLT3A                                                (6)3F306680
       USE                                                           (6)3F306685
       LXA     DIG,4                 PREPARE TO CONVERT BIN FRACTION (6)3F306686
       TXL     FXFL3,4,0             EXIT IF DIG = 0                 (6)3F306687
       DLD     FD                    TO DECIMAL FRACTION.               3F306690
DFLT9  LRS     2                     4 BITS,ONE                         3F306700
       XCA                           CHARACTER AT                       3F306710
       ADD     FD+1                  A TIME.                            3F306720
       XCA                                                              3F306730
       TNO     *+2                                                      3F306740
       ADD     L(1)                                                     3F306750
       ADD     FD                                                       3F306760
       DST     MULT                                                     3F306770
       ARS     32                                                       3F306780
       SLW     CHAR-4,4              STORE DECIMAL CHARACTER.           3F306790
       DLD     MULT                                                     3F306800
       ANA     DGMASK                REMOVE BITS JUST CONVERTED.        3F306810
       LLS     3                                                        3F306820
       DST     FD                                                       3F306830
       TOV     *+1                                                      3F306840
       TIX     DFLT9,4,1             REPEAT UNTIL DONE.                 3F306850
       CLA     ND+1                  GET INTEGER AND                    3F306860
       TRA     BDC2                  GO TO CONVERT.                     3F306870
DFLT12 UFA     =155B8                OBTAIN INTEGER PART             (6)3F306880
       ANA     CHMASK                DISCARD CHARACTERISTIC.            3F306920
       STO     ND+1                  STORE INTEGER PORTION.             3F306930
       XCA                           OBTAIN FRACTIONAL PORTION          3F306940
       UFA     N+1                   OF SCALED DATA.                    3F306950
       XCA                                                              3F306960
       TRA     DFLT11                                                   3F306970
       REM  BDC / BINARY TO DECIMAL CONVERSION.                         3F307110
       REM  ENTRY FOR SINGLE-PRECISION FLOATING POINT OUTPUT.           3F307120
FLT    TZE     BDC1                  EXIT ON ZERO.                      3F307130
       XCL                           P, Q BITS ASSUMED OFF              3F307140
       PXD     ,0                    ..                                 3F307150
       LLS     8                     ..                                 3F307160
       SUB     =128                  MODULO 128                         3F307170
       XCA                           FORM APPROX. OF DEC. SCALE         3F307180
       VLM     LOG2,,12              BY * LOG2 AT Q OF 23               3F307190
       PAX     ,2                    0-38 POSSIBLE IN IR2               3F307200
       TPL     FLT1                  NO. IS E OR GT MOD. 128            3F307210
       PAC     ,4                    ADJUST SCALE UP TO -38             3F307220
       CLA     DATUM                 LOGICAL CP. DATA WITH BASE         3F307230
       LAS     L(1E0)+1,4            1E-1, AND APPROX. DEC. SCALE       3F307240
       TRA     FLT2                  TRUE SCALE                         3F307250
       TRA     FLT2                  TRUE SCALE                         3F307260
       TXI     FLT2,2,1              ADJUST EXP. UP                     3F307270
FLT1   CLA     DATUM                 ADJUST SCALE UP TO +38             3F307280
       LAS     L(1E0),2              ..                                 3F307290
       TXI     *+2,2,1               ADJUST EXP. UP                     3F307300
       TXI     *+1,2,1               ..                                 3F307310
FLT2   PXA     ,2                    TRUE EXP.                          3F307320
       LLS     0                     GIVE TRUE SIGN                     3F307330
       SUB     PEX                   ADJUST EXP. BY SCALE FACTOR        3F307340
FLT3   STO     EXP                   ..                              (6)3F307350
       LDQ     EXPON                 ..                                 3F307360
       STQ     CHAR-4                ..                                 3F307370
       LDI     BLANK                 ..                                 3F307380
       TPL     *+3                                                   (6)3F307390
       TZE     *+2                                                   (6)3F307395
       RIR     20                    ..                                 3F307400
       STI     CHAR-3                                                   3F307410
       LDQ     L(1)                  FORM BCD EXPONENT                  3F307420
       LRS     3                     ..                                 3F307430
       VDP     TEN,,3                MAX. CHAR. = 63                    3F307440
       STQ     CHAR-2                ..                                 3F307450
       SLW     CHAR-1                ..                                 3F307460
       CLA     DATUM                 ..                                 3F307470
       STL     ETYPE                 SET SWITCH                      (6)3F307475
FXD1   LXA     EXP,4                 IF EXP. IS ZERO                    3F307480
       LDQ     EXP                                                   (6)3F307485
       TXL     FXD3,4,0              FIX, SCALING NOT NEEDED.           3F307490
       TQP     FXD12          IS SCALE FACTOR POSITIVE               (6)3F307500
FXD11  XCA                    NO,                                    (6)3F307510
       TNX     FXD13,4,38     TWO MULTIPLICATIONS NEEDED             (6)3F307515
       FMP     L1E0M          SINCE EXP .GT. 38                      (6)3F307520
       XCA                                                           (6)3F307525
FXD13  FMP     L(1E0),4       OTHERWISE ONLY ONE MULTIPLICATION      (6)3F307530
       TRA     FXD2                                                  (6)3F307540
FXD12  TNX     FXD14,4,38     YES, SCALING DONE BY                   (6)3F307545
       FDP     L1E0M          TWO DIVISIONS SINCE EXP .GT. 38        (6)3F307550
       XCA                                                           (6)3F307555
FXD14  FDP     L(1E0),4       OTHERWISE ONLY ONE DIVISION            (6)3F307560
       XCA                           NEEDED                          (6)3F307570
 FXD2  LAS     L(1E0)                IS SCALED NUMBER .GT. 1.0       (6)3F307575
       TRA     FXD3                  YES                             (6)3F307580
       TRA     FXD3                                                  (6)3F307585
       STQ     N+1                   NO, SAVE  LOW ORDER OF FRACTION (6)3F307590
       STZ     ND                    SET INTEGER PART TO ZERO        (6)3F307595
       UFA     =128B8                SHIFT SO BINARY POINT           (6)3F307600
       STO     N                     IS IN PLACE                     (6)3F307605
       XCA                                                           (6)3F307610
       UFA     N+1                   ADD LOW ORDER BITS BACK IN,     (6)3F307615
       LRS     27                    THEN GET RID OF                 (6)3F307620
       CLA     N                     CHARACTERISTICS TO              (6)3F307630
       LLS     8                     FORM FRACTION IN                (6)3F307635
       TRA     FXD4                  FIXED POINT                     (6)3F307640
FXD3   UFA     =155B8                FIX NO. (SPILL MAY OCCUR ON F CONV.3F307650
       LLS     8                     NO SCALING                         3F307660
       ALS     2                     NEEDED, DISCARD                    3F307670
       ARS     10                    CHARACTERISTIC.                    3F307680
FXD31  STO     ND                    ..                                 3F307690
       XCA                           GET                                3F307700
FXD4   LXA     DIG,4                 FRACTION,                       (6)3F307710
       ACL     RND,4                 ADD APPROPRIATE ROUNDING FACTOR,   3F307720
       LRS     35                    ..                                 3F307730
       ADD     ND                    ..                                 3F307740
       STO     ND                    ..                                 3F307750
       NZT     ETYPE                 IS THIS E CONVERSION            (6)3F307752
       TRA     FXD6                  NO, DO NOT TEST FOR RE-SCALING  (6)3F307754
       STZ     ETYPE                                                 (6)3F307756
       LXA     PEX,1                 OBTAIN SCALE FACTOR             (6)3F307758
       LAS     IC10+10,1             ENSURE ROUNDING HAS NOT         (6)3F307760
       TRA     FXD5                  CAUSED US TO GO OUT OF          (6)3F307761
       TRA     FXD5                  SCALE ON E CONVERSION           (6)3F307762
       USE     REMOTE                                                (6)3F307764
FXD5   CLA     EXP                                                   (6)3F307765
       ADD     L(1)                                                  (6)3F307766
       TRA     FLT3                                                  (6)3F307767
       USE                                                           (6)3F307768
FXD6   TXL     FXFL3,4,0             EXIT IF DIG = 0.                (6)3F307769
       STQ     FD                    CONVERT FRACTION.                  3F307770
       ALS     4                     4 BITS, 1                          3F307780
       LLS     33                    CHARACTER                          3F307790
       ADD     FD                    AT                                 3F307800
       LRS     32                    A TIME.                            3F307810
FXFL1  SLW     **,4                  STORE                              3F307820
       TIX     *-6,4,1               AND REPEAT UNTIL DONE.             3F307830
       CLA     ND                    GET INTEGER AND                    3F307840
       TRA     BDC2                  TO TO CONVERT.                     3F307850
       REM  ENTRY FOR FIXED POINT OUTPUT.                               3F307860
FXD    TNZ     FXD1                  DO F CONVERSION.                   3F307870
BDC1   LXA     DIG,4                 IF ZERO, FILL                      3F307880
       LDQ     BLANK                 IN                                 3F307890
FXFL2  TXI     *+1,4,**              BLANKS                             3F307900
       STQ     CHAR,4                ..                                 3F307910
       TIX     *-1,4,1               ..                                 3F307920
BDC2   LXA     DIG,4                 ..                                 3F307930
FXFL3  TXI     *+1,4,**              ..                                 3F307940
       LDQ     POINT                 AND A                              3F307950
       STQ     CHAR,4                POINT.                             3F307960
       TRA     *+2                   ..                                 3F307970
       REM  ENTRY FOR INTEGER OUTPUT.                                   3F307980
INTG   AXT     0,4                   ..                                 3F307990
       XCA                           INTEGER PART FROM I, E, F.         3F308000
       PXD     ,0                    ..                                 3F308010
       DVP     TEN                   ..                                 3F308020
       SLW     CHAR-1,4              STRING CHARACTERS FROM LOW TO HIGH.3F308030
       XCA                           ..                                 3F308040
       TZE     *+2                   NO MORE.                           3F308050
       TXI     *-6,4,1               ..                                 3F308060
       LDQ     DATUM                 SET SIGN OF THIS FIELD.            3F308070
       LDI     BLANK                 ..                                 3F308080
       TQP     *+2                   ..                                 3F308090
       RIR     20                    ..                                 3F308100
       STI     CHAR-2,4              ..                                 3F308110
INTGSW TXI     TOPACK,4,2          * ADJ. FLD. SIZ FOR SIGN AND 1 CHAR. 3F308120
       REM  ENTRY FROM BDC, AOUT, OOUT, BOUT.                           3F308130
TOPACK CAL     WORD                  FILL OUTPUT                        3F308140
       TNO     *+1                   BUFFER                             3F308150
       LXA     PACK,1                WITH                               3F308160
       SXD     *+2,4                 LEADING                            3F308170
WIDTH  AXT     **,4                  BLANKS                             3F308180
       TIX     TOPC,4,**             A WORD                             3F308190
TOPA   ALS     6                     AT A TIME, IF POSSIBLE             3F308200
       ADM     CHAR,4                AFTER THE                          3F308210
       TNO     TOPB                  PENDING                            3F308220
PACK   SLW     **                    WORD                               3F308230
TEST   TXH     **,1,OUTBUF+LIMIT-2                                  (14)3F308240
       TXI     *+1,1,1               IS READY                           3F308250
       SXA     PACK,1                THEN,                              3F308260
       CAL     L(1)                  COMPLETE                           3F308270
TOPB   TIX     TOPA,4,1              THE                                3F308280
TOPSW1 TRA     TOPSW2              * FIELD                              3F308290
TOPC   LDQ     BLANKS                BY                                 3F308300
TOPD   LGL     6                     PACKING                            3F308310
       TNO     TOPF                  FROM                               3F308320
       LDQ     BLANKS                THE                                3F308330
       XEC     PACK                  CHARACTER                          3F308340
       TXI     *+2,4,-1              BUFFER                             3F308350
TOPE   STQ*    PACK                  INTO                               3F308360
       XEC     TEST                * (HAS LINE FORMATTING OVERFLOWED)   3F308370
       TXI     *+1,1,1               THE                                3F308380
       SXA     PACK,1                BUFFER                             3F308390
       TIX     TOPE,4,6              THE                                3F308400
       TXI     *+1,4,1               REMAINING                          3F308410
       TXL     *+2,4,6               TRUE                               3F308420
       TXI     TOPE,4,-7             FIELD                              3F308430
       CAL     L(1)                  CHARACTERS                         3F308440
TOPF   TIX     TOPD,4,1              AND                                3F308450
       LXD     WIDTH+1,4             SAVE                               3F308460
       TIX     TOPA,4,0              PARTIAL                            3F308470
TOPSW2 SLW     WORD                * WORD.                              3F308480
       REM  ENTRY FROM DBC, ANPT, ONPT, TOPACK.                         3F308490
       ZET     DDDFLG         WAS THIS DOUBLE PRECISION CONVERT      $5$3F308500
       TSX     DDRSET,2              YES. RESET DOUBLE PRECISION EXITS. 3F308510
COUNT  AXT     **,4                  TEST FIELD COUNT,                  3F308520
       TNX     DONE,4,1              IF NOT DONE,                       3F308530
       SXA     *-2,4                 RESET COUNT, AND                   3F308540
       REM  ENTRY FROM CCRPAR, FIELD.                                   3F308550
LIST   DLD     DATUM                 PICKUP INPUT DATUM.                3F308560
LXIT1  AXT     **,1                  RESTORE                            3F308570
LXIT2  AXT     **,2                  INDEX                              3F308580
LEXIT  AXT     **,4                  REGISTERS.                         3F308590
       TRA     1,4                   EXIT TO PROGRAMS I/O LIST.         3F308600
       REM  REENTRY FROM COUNT.                                         3F308610
DONE   AXT     **,4                  RESTORE RETURN INDEX.              3F308620
       TRA     1,4                 * EXIT TO CALLER.                    3F308630
       REM     TABLE OF POWERS OF TEN IN DOUBLE PRECISION ACCURACY      3F308640
       EVEN                                                          $5$3F308642
DE38   DEC     1.EE+38,1.EE+37,1.EE+36,1.EE+35,1.EE+34,1.EE+33,1.EE+32  3F308650
       DEC     1.EE+31,1.EE+30,1.EE+29,1.EE+28,1.EE+27,1.EE+26,1.EE+25  3F308660
       DEC     1.EE+24,1.EE+23,1.EE+22,1.EE+21,1.EE+20,1.EE+19,1.EE+18  3F308670
       DEC     1.EE+17,1.EE+16,1.EE+15,1.EE+14,1.EE+13,1.EE+12,1.EE+11  3F308680
       DEC     1.EE+10,1.EE+9,1.EE+8,1.EE+7,1.EE+6,1.EE+5,1.EE+4,1.EE+3 3F308690
       DEC     1.EE+2,1.EE+1                                            3F308700
D1E0   DEC     1.EE+0,1.EE-1,1.EE-2,1.EE-3,1.EE-4,1.EE-5,1.EE-6,1.EE-7  3F308710
       DEC     1.EE-8,1.EE-9,1.EE-10,1.EE-11,1.EE-12,1.EE-13,1.EE-14    3F308720
       DEC     1.EE-15,1.EE-16,1.EE-17,1.EE-18,1.EE-19,1.EE-20,1.EE-21  3F308730
       DEC     1.EE-22,1.EE-23,1.EE-24,1.EE-25,1.EE-26,1.EE-27,1.EE-28  3F308740
       DEC     1.EE-29,1.EE-30,1.EE-31,1.EE-32,1.EE-33,1.EE-34,1.EE-35  3F308750
       DEC     1.EE-36,1.EE-37,1.EE-38                                  3F308760
       REM     TABLE OF ROUNDING CONSTANTS FOR D CONVERSION             3F308790
DRND   DEC     .5BEE0,.5BEE-1,.5BEE-2,.5BEE-3,.5BEE-4,.5BEE-5        (6)3F308800
       DEC     .5BEE-6                                               (6)3F308801
       DEC     .5BEE-7,.5BEE-8,.5BEE-9,.5BEE-10,.5BEE-11,.5BEE-12       3F308810
       DEC     .5BEE-13,.5BEE-14,.5BEE-15,.5BEE-16,.5BEE-17             3F308820
       REM     TABLE OF POWERS OF TEN ROUNDED UP TO 9 DIGIT ACCURACY    3F308830
L1E0M  OCT     377454732313          1E38                            (6)3F308840
       OCT     373741367021          1E37                               3F308850
       OCT     370601137164          1E36                               3F308860
       OCT     365464114135          1E35                               3F308870
       OCT     361755023373          1E34                               3F308880
       OCT     356612334311          1E33                               3F308890
       OCT     353473426555          1E32                               3F308900
       OCT     347770675742          1E31                               3F308910
       OCT     344623713116          1E30                               3F308920
       OCT     341503074077          1E29                               3F308930
       OCT     336402374714          1E28                               3F308940
       OCT     332635456171          1E27                               3F308950
       OCT     327512676456          1E26                               3F308960
       OCT     324410545213          1E25                               3F308970
       OCT     320647410336          1E24                               3F308980
       OCT     315522640262          1E23                               3F308990
       OCT     312417031702          1E22                               3F309000
       OCT     306661534466          1E21                               3F309010
       OCT     303532743536          1E20                               3F309020
       OCT     300425434430          1E19                               3F309030
       OCT     274674055532          1E18                               3F309040
       OCT     271543212741          1E17                               3F309050
       OCT     266434157116          1E16                               3F309060
       OCT     262706576512          1E15                               3F309070
       OCT     257553630410          1E14                               3F309080
       OCT     254443023471          1E13                               3F309090
       OCT     250721522451          1E12                               3F309100
       OCT     245564416672          1E11                               3F309110
       OCT     242452013710          1E10                               3F309120
       OCT     236734654500          1E9                                3F309130
       OCT     233575360400          1E8                                3F309140
       OCT     230461132000          1E7                                3F309150
       OCT     224750220000          1E6                                3F309160
       OCT     221606500000          1E5                                3F309170
       OCT     216470400000          1E4                                3F309180
       OCT     212764000000          1E3                                3F309190
       OCT     207620000000          1E2                                3F309200
       OCT     204500000000          1E1                                3F309210
L(1E0) OCT     201400000000          1E0                                3F309220
       OCT     175631463146          1E-1                               3F309230
       OCT     172507534122          1E-2                               3F309240
       OCT     167406111565          1E-3                               3F309250
       OCT     163643334273          1E-4                               3F309260
       OCT     160517426542          1E-5                               3F309270
       OCT     155414336750          1E-6                               3F309280
       OCT     151655376247          1E-7                               3F309290
       OCT     146527461671          1E-8                               3F309300
       OCT     143422701372          1E-9                               3F309310
       OCT     137667633766          1E-10                              3F309320
       OCT     134537657770          1E-11                              3F309330
       OCT     131431363140          1E-12                              3F309340
       OCT     125702270232          1E-13                              3F309350
       OCT     122550223342          1E-14                              3F309360
       OCT     117440165750          1E-15                              3F309370
       OCT     113715126246          1E-16                              3F309380
       OCT     110560736522          1E-17                              3F309390
       OCT     105447113564          1E-18                              3F309400
       OCT     101730171124          1E-19                              3F309410
       OCT     076571624103          1E-20                              3F309420
       OCT     073456166403          1E-21                              3F309430
       OCT     067743444004          1E-22                              3F309440
       OCT     064602666320          1E-23                              3F309450
       OCT     061465370246          1E-24                              3F309460
       OCT     055757132075          1E-25                              3F309470
       OCT     052614110061          1E-26                              3F309480
       OCT     047474723216          1E-27                              3F309490
       OCT     043773036660          1E-28                              3F309500
       OCT     040625513700          1E-29                              3F309510
       OCT     035504411400          1E-30                              3F309520
       OCT     032403472631          1E-31                              3F309530
       OCT     026637304365          1E-32                              3F309540
       OCT     023514235136          1E-33                              3F309550
       OCT     020411660745          1E-34                              3F309560
       OCT     014651264556          1E-35                              3F309570
       OCT     011524220445          1E-36                              3F309580
       OCT     006420163521          1E-37                              3F309590
NEWTAB OCT     002663437347          1E-38                              3F309600
       REM     TABLE OF ROUNDED ROUNDING CONSTANTS FOR E AND F CNV.     3F309610
       DEC     .5BE-9                                                   3F309620
       OCT     254                   .5BE-8                             3F309630
       OCT     3266                  .5BE-7                             3F309640
       OCT     41434                 .5BE-6                             3F309650
       OCT     517427                .5BE-5                             3F309660
       OCT     6433343               .5BE-4                             3F309670
       DEC     .5BE-3                                                   3F309680
       OCT     1217270244            .5BE-2                             3F309690
       DEC     .5BE-1                                                   3F309700
RND    DEC     .5B                                                      3F309710
CODE1  PZE     32                                                       3F309720
ER32MS PZE     E32MES,,7                                                3F309730
ER32OP PZE     E32OMS,,5                                                3F309740
E32MES BCI     7,0ILLEGAL CHAR IN DATA BELOW OR BAD FORMAT              3F309750
E32OMS BCI     5,0TREAT ILLEGAL CHAR AS ZERO                            3F309760
CODE2  PZE     33                                                       3F309770
ER33MS PZE     E32MES,,7                                                3F309780
ER33OP PZE     E32OMS,,5                                                3F309790
CODE9  PZE     57                                                       3F309800
ER57MS PZE     E57MES,,8                                                3F309810
ER57OP PZE     E57OMS,,5                                                3F309820
E57MES BCI     8,0ILLEGAL CHAR FOR L CONVERSION IN DATA BELOW           3F309830
E57OMS BCI     5,0TREAT ILLEGAL CHAR AS BLANK                           3F309840
LIMIT5 EQU     CHLIMT                                               (14)3F309850
OUTBUF BSS     LIMIT                                                 (8)3F309860
CHAR   BES     CHLIMT                                                (8)3F309870
MINUS  BCI     1,00000-                                                 3F309880
POINT  BCI     1,00000.                                                 3F309890
EXPON  BCI     1,00000E                                                 3F309900
PLUS   BCI     1,00000+                                                 3F309910
NEGAT  BCI     1,00000'                                                 3F309920
TRUE   BCI     1,00000T                                                 3F309930
FALSE  BCI     1,00000F                                                 3F309940
TFTEST BCI     1,TF                                                     3F309950
ETYPE  PZE     **              ADDRESS IS SWITCH FOR E-CONVERSION.   (6)3F309951
MZE    MZE                                                              3F309960
TEN    PZE     10                                                       3F309970
LOG2   OCT     2321                                                     3F309980
.FBDBF PZE     **,2                  LOCATION OF INPUT BUFFER,2         3F309990
DMQD   PZE                                                              3F310000
V      PZE                                                              3F310010
U      PZE                                                              3F310020
CHMASK OCT     000777777777                                             3F310030
F      PZE                                                              3F310040
E      PZE                                                              3F310050
D      PZE                                                              3F310060
DGMASK OCT     037777777777                                             3F310070
DG     PZE                                                              3F310080
       EVEN                                                             3F310090
DATUM  BSS     2                                                        3F310100
N      PZE     0                                                     $5$3F310110
N1     PZE     0                                                     $5$3F310111
N2     PZE     0                                                     $5$3F310112
N3     PZE     0                                                     $5$3F310113
ND     BSS     2                                                        3F310120
FD     BSS     2                                                        3F310130
LIMIT  EQU     LIMIT5/6+1          LINE LIMIT IN WORDS              (14)3F310140
MULT   BSS     2                                                        3F310150
BLCNT  PZE                           NON-ZERO IF DATA NOT ALL BLANKS.(8)3F310155
BLANK  BCI     1,00000                                                  3F310160
L(1)   PZE     1                                                        3F310170
BLANKS BCI     1,                                                       3F310180
DDDFLG PZE     **                    NON-ZERO IF D IN FORMAT SCAN.      3F310190
DDFLAG PZE     **                    NON-ZERO IF CONVERTED RESULT       3F310200
WORD   PZE                                                              3F310210
MQD    PZE                                                              3F310220
PEX    PZE                                                              3F310230
EXP    PZE                                                              3F310240
DIG    PZE                                                              3F310250
DEXPON BCI     1,00000D                                                 3F310260
DB8PW  BSS     1                                                     $5$3F310263
DB871  OCT     043000000000                                          $5$3F310264
DB872  OCT     000066000000                                          $5$3F310265
DBSPP  BOOL    1              SIGN OF PRINCIPAL PART                 $5$3F310266
DBSEP  BOOL    40             SIGN OF EXPONENTIAL PART               $5$3F310267
LNKG   LDIR                                                          (6)3F310275
BEG94  NULL                                                          $5$3F310280
*                                                                    $5$3F310290
*                                                                    $5$3F310300
       PCC     ON                                                    $5$3F350000
       IFT     M9094=90                                              $5$3F350010
       GOTO    END94                                                 $5$3F350020
       PCC     OFF                                                   $5$3F350030
       TTL     BCD CONVERT ROUTINES                                  $5$3F350040
*              BCD CONVERT ROUTINES                                     3F350050
.WIDTH ENTRY   WIDTH                                                    3F350060
.ENDFS ENTRY   ENDFSW                                                   3F350070
.ONPT  ENTRY   ONPT                                                     3F350080
.OOUT  ENTRY   OC                                                    $5$3F350090
.FIXSW ENTRY   FIXSW                                                    3F350100
.DBC   ENTRY   DBC                                                      3F350110
.KOUNT ENTRY   COUNT                                                    3F350120
.INTG  ENTRY   IC                                                    $5$3F350130
.ANPT  ENTRY   ANPT                                                     3F350140
.AOUT  ENTRY   AC                                                    $5$3F350150
.FXD   ENTRY   FC                                                    $5$3F350160
.FLT   ENTRY   EC                                                    $5$3F350170
.DBC20 ENTRY   DBC20                                                    3F350180
.DDBC  ENTRY   DDBC                                                     3F350190
.DDSW  ENTRY   DDSW                                                     3F350200
.DDFIX ENTRY   DDFIX                                                    3F350210
.DFLT  ENTRY   DC                                                    $5$3F350220
.LNTP  ENTRY   LNTP                                                     3F350230
.LOUT  ENTRY   LC                                                    $5$3F350240
.DDRS2 ENTRY   DDRST2                                                   3F350250
.CNVSW ENTRY   CNVSW                                                    3F350260
.DONE  ENTRY   DONE                                                     3F350270
.OUTBF ENTRY   OUTBUF                                                   3F350280
.DEXPN ENTRY   EC15                                                  $5$3F350290
.DIG   ENTRY   DIG                                                      3F350300
.FEXP  ENTRY   EXP                                                      3F350310
.PEX   ENTRY   PEX                                                      3F350320
.MQD   ENTRY   MQD                                                      3F350330
.DDFLG ENTRY   DDFLAG                                                   3F350340
.DDDFL ENTRY   DDDFLG                                                   3F350350
.DDRS1 ENTRY   DDRST1                                                   3F350360
.LIST  ENTRY   LIST                                                     3F350370
       ENTRY   .FBDBF                                                   3F350380
.XCF   ENTRY   XCF                                                   $5$3F350390
.DBC10 ENTRY   DBC10                                                    3F350400
.D2    ENTRY   D2                                                       3F350410
.D1    ENTRY   D1                                                       3F350420
.FDX1  ENTRY   DX1                                                      3F350430
.FDX2  ENTRY   DX2                                                      3F350440
.TEST  ENTRY   TEST                                                  $5$3F350450
       ENTRY   .FERR2                                                $5$3F350460
.GAIN  ENTRY   GAIN                                                  $5$3F350470
.GAIN1 ENTRY   GAIN1                                                 $5$3F350480
.BUF   ENTRY   BUF                                                   $5$3F350490
.QSTO  ENTRY   QSTO                                                  $5$3F350500
.HOUT  ENTRY   HC                                                    $5$3F350510
BUFADD EQU     .FBDBF                                                   3F350520
       ENTRY   .FCNV.                                                   3F350530
       ENTRY   .FCON.                                                   3F350540
.FCON. STD     DDRST2                SET NOP AND TRA                    3F350550
       STD     CNVSW                 WHERE NECESSARY                    3F350560
       SXA     LNKG,4                                                $5$3F350570
       CLA     DX1                                                      3F350580
       STD     ENDFSW                                                   3F350590
       STZ     PEX                                                      3F350600
       SXA     TEST,2                                                $5$3F350610
       SXA     ENDFSW,1              FCNV TO PREVENT FCNV               3F350620
       CLA     3,4                   DEPENDENCY ON FIOH.                3F350630
       STA     DDRST1                                                   3F350640
       ARS     18                                                       3F350650
       STA     DDRST1+1                                                 3F350660
       CLA     4,4                                                      3F350670
       STA     CNVSW                                                    3F350680
       ARS     18                    STORE BUFFER ADDRESS IN CALL       3F350690
       STA     .FBDBF                CALL WAS FRCD                      3F350700
       CLA     5,4                                                   $5$3F350710
       STA     HCEXIT                                                $5$3F350720
       TRA     1,4                   RETURN TO FIOH FORMAT SCAN         3F350730
       REM REENTRY FROM MAIN PROGRAM LIST.                              3F350740
.FCNV. NOP     LNKG,4                INPUT/OUTPUT CONVERSION         (6)3F350750
       SXA     LXIT1,1                                               (6)3F350751
       SXA     LXIT2,2               SAVE INDEX                         3F350760
       SXA     LEXIT,4               REGISTERS.                         3F350770
       LMTM                                                          (6)3F350771
       SXA     LXIT3,3                                               (6)3F350772
       SXA     LXIT5,5                                               (6)3F350773
       SXA     LXIT6,6                                               (6)3F350774
       SXA     LXIT7,7                                               (6)3F350775
       DST     DATUM                 SAVE DATUM.                        3F350780
ENDFSW NOP     **                  * RESCAN FORMAT IF NECESSARY         3F350800
       REM  REENTRY FROM FIELD.                                         3F350810
       DLD     DATUM                 PICKUP DATUM, AND TRA TO (DBC,ANPT,3F350820
CNVSW  TRA     **                  * ONPT,AOUT,OOUT,FLT,FXD,INTG)       3F350830
       LXA     WIDTH,4               IR(4) = DESIRED FIELD WIDTH.       3F350840
       STZ     DG                    INITIALIZE.                        3F350850
       LDQ     MQD                   ..                                 3F350860
DX1    AXT     **,1                  CHARACTER COUNT.                   3F350870
DX2    AXT     **,2                  WORD COUNT.                        3F350880
       TRA*    CNVSW               * EXIT THRU CNVSW.                   3F350890
       REM  DBC / DECIMAL TO BINARY CONVERSION ROUTINE.                 3F350900
DBC    STZ     N                     INITIALIZE.                     (8)3F350920
       STZ     N+1                                                  (13)3F350922
       RIR     DBSPP+DBSEP                                          (14)3F350925
       STZ     V                     ..                                 3F350930
       CLA     FIXSW                                                 (8)3F350934
       STD     DBC9                                                  (8)3F350936
       CLS     DIG                   ..                                 3F350940
       STO     D                     ..                                 3F350950
       CLA     EXP                   ..                                 3F350960
       STO     E                     ..                                 3F350970
       TNO     DBC1                  TURN OFF                           3F350980
       TRA     DBC1                  OVERFLOW LIGHT.                    3F350990
DBCBL  SIR     DBSPP                 MAKE BLANK FIELD MINUS         (13)3F350994
       TRA     DBC15                                                 (8)3F350996
DBC2   TNX     DBCBL,4,1             BUMP WIDTH.                     (8)3F351000
DBC1   TIX     *+4,1,1               BUMP CHARACTER COUNT, IF EXHAUSTED 3F351010
       TXI     *+1,2,-1              GET NEXT WORD.                     3F351020
       AXT     6,1                   ..                                 3F351030
       LDQ*    BUFADD                ..                                 3F351040
       PXD     ,0                    TAKE A                             3F351050
       LGL     6                     CHARACTER.                         3F351060
       CAS     BLANK                 IF IT IS BLANK                     3F351070
       TRA     STOP1                 IGNORE IT.                         3F351080
       TRA     DBC2                  TAKE                               3F351090
       CAS     MINUS                 APPROPRIATE                        3F351100
       TRA     STOP1               * ACTION                             3F351110
       TRA     *+6                   ON                                 3F351120
       CAS     PLUS                  ERRORS, I.E. STOP.                 3F351130
       TRA     DBC9                  FOR LEGAL                          3F351140
       TRA     *+6                   + AND -                            3F351150
       CAS     NEGAT                 SIGNS                              3F351160
       TRA     STOP1               * SET                                3F351170
       CLA     MZE                   THE                                3F351180
       CAS     TEN                   SIGN                               3F351190
       TRA     STOP1               * OF                                 3F351200
DBCS1  PXD     ,0                    THE                                3F351210
       STO     DG                    RESULT.                            3F351220
DBC13  STO     N                     ..                                 3F351230
DBC14  TNX     DBC15,4,1             BUMP WIDTH.                        3F351240
DBC11  TIX     DBC98,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F351250
       TXI     DBC99,2,-1            GET ANOTHER WORD.                  3F351260
DBC3   TNX     DBC6,4,1              ENTRY ON E OR E BLANK, BUMP WIDTH. 3F351270
       TIX     DBC93,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED,3F351280
       TXI     DBC94,2,-1            GET ANOTHER WORD.                  3F351290
DBC94  AXT     6,1                   ..                                 3F351300
       LDQ*    BUFADD                ..                                 3F351310
DBC93  PXD     ,0                    TAKE A                             3F351320
       LGL     6                     CHARACTER.                         3F351330
       CAS     BLANK                 IF IT IS                           3F351340
       TRA     STOP2               * BLANK                              3F351350
       TRA     DBC3                  IGNORE IT.                         3F351360
       SXD     ER,4                  ILLEGAL                            3F351370
DBC4   CAS     MINUS                 CHARACTERS                         3F351380
       TRA     ER                  * CAUSE AN EXIT.                     3F351390
       TRA     DBC92                 A LEGAL                            3F351400
DBC5   CAS     PLUS                  + OR -                             3F351410
       TRA     ER                  * SIGN                               3F351420
       TRA     DBC6                  IS                                 3F351430
       CAS     NEGAT                 USED                               3F351440
       TRA     ER                  * TO                                 3F351450
DBC92  CLA     MZE                   SET                                3F351460
       CAS     TEN                   THE                                3F351470
       TRA     STOP2               * SIGN                               3F351480
DBC6   PXD     ,0                    OF                                 3F351490
DBC95  STO     E                     E, THEN                            3F351500
       TNX     DBC15,4,1             BUMP WIDTH, EXIT WHEN EXHAUSTED.   3F351510
       TIX     DBC96,1,1             BUMP CHARACTER COUNT, IF EXHAUSTED 3F351520
       TXI     DBC97,2,-1            GET ANOTHER WORD  AND CONVERT E.   3F351530
DBC97  AXT     6,1                   GET A NEW WORD FOR                 3F351540
       LDQ*    BUFADD                E FIELD.                           3F351550
DBC96  PXD     ,0                    TAKE A                             3F351560
       LGL     6                     CHARACTER.                         3F351570
       CAS     BLANK                 TREAT BLANK                        3F351580
       TRA     STOP3               * ZERO.                              3F351590
       TRA     *+3                   EXIT FOR                           3F351600
       CAS     TEN                   ILLEGAL CHARACTERS.                3F351610
ER3    TRA     STOP3               * CONVERT                            3F351620
       PXD     ,0                    E FIELD                            3F351630
       STO     DG                    AND                                3F351640
       CLA     E                     STORE                              3F351650
       ALS     2                     IN                                 3F351660
       ADD     E                     E                                  3F351670
       ALS     1                     AND                                3F351680
       ACL     DG                    GO                                 3F351690
       TRA     DBC95                 BUMP WIDTH.                        3F351700
DBC8   CAS     BLANK                 EXAMINE NON-NUMERIC                3F351710
       TRA     STOP4               * CHARACTER.                         3F351720
       TRA     DBC12                 TREAT BLANK AS ZERO.               3F351730
DBC9   NOP     STOP4                 TRA IF I CONVERSION             (8)3F351735
       SXD     U,4                   IF A                            (8)3F351740
       STD     ER                    DECIMAL                            3F351750
       CAS     POINT                 POINT, RECORD                      3F351760
       TRA     DBC4                  FIELD                              3F351770
       TXI     DBC30,4,-1            WIDTH.                             3F351780
DBC10  CAS     EXPON                 ON AN E (OR D FOR DOUBLE PRECISION)3F351790
       TRA     STOP4               * GO CONVERT                         3F351800
       TRA     DBC3                  E FIELD.                           3F351810
       TRA     DBC5                  ANYTHING ELSE CONTINUE ABOVE.      3F351820
DBC30  PXA     ,4                    DECIMAL POINT FIELD POSITION       3F351830
       STO     U                     IS SET                             3F351840
       STO     D                     HERE.                              3F351850
       TXI     DBC14,4,1             EXIT TO CONTINUE.                  3F351860
DBC99  AXT     6,1                   GET A                              3F351870
       LDQ*    BUFADD                NEW WORD.                          3F351880
DBC98  PXD     ,0                    TAKE A                             3F351890
       LGL     6                     CHARACTER.                         3F351900
       CAS     TEN                   TREAT BLANK                        3F351910
       TRA     DBC8                  AS ZERO, EXAMINE                   3F351920
DBC12  PXD     ,0                    OTHER NON-NUMERICS AT DBC8.        3F351930
       STA     DG                    CONVERT                            3F351940
       CLA     N                     BCD                                3F351950
       ALS     2                     TO                                 3F351960
       ADD     N                     BINARY                             3F351970
       ALS     1                     AND                                3F351980
       ADD     DG                    IF                                 3F351990
       TNO     DBC13                 NO OVERFLOW CONTINUE.              3F352000
DBC20  TRA     *+1                   DOUBLE PRECISION OVERFLOW SWITCH.  3F352010
       CLA     V                     IF OVERFLOW, IGNORE                3F352020
       ADD     L(1)                  CONVERTED RESULT, BUT              3F352030
       STO     V                     ADD ONE TO V.                      3F352040
       TIX     DBC11,4,1             BUMP WIDTH.                        3F352050
DBC15  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F352060
       SXA     DX1,1                 CHARACTERS AND                     3F352070
       SXA     DX2,2                 COUNTS.                            3F352080
       CLA     N                     PICK UP CONVERTED N.               3F352100
       TZE     DBEXIT                EXIT ON N = 0.                     3F352110
       TPL     *+3                                                   $5$3F352120
       SIR     DBSPP                                                 $5$3F352130
       SSP                                                           $5$3F352140
       NZT     DDFLAG                                               (13)3F352150
DDSW   TRA     DDFIX                                                (13)3F352160
       CLA     ND+1                                                 (13)3F352170
       STO     N+1                                                  (13)3F352180
       CLA     ND                                                   (13)3F352190
DDFIX  STO     N                                                    (13)3F352200
FIXSW  NOP     DBEXIT                                                $5$3F352220
       CLA     D             -DIG FROM FORMAT SPEC                   $5$3F352230
       TMI     *+4           WAS DEC POINT SPECIFIED - NO            $5$3F352240
       CLA     U             YES                                     $5$3F352250
       ARS     18                                                    $5$3F352260
       SUB     D                                                     $5$3F352270
       ADD     E                                                     $5$3F352280
       ADD     V             OVERFLOW COUNT                          $5$3F352290
       TPL     *+2                                                   $5$3F352300
       SIR     DBSEP         SAVE SIGN OF EXPONENT                   $5$3F352310
       PAX     0,1           XR1=TRUE EXPONENT                       $5$3F352320
       AXT     128,2                                                 $5$3F352330
       ZET     DDFLAG                                                $5$3F352340
       AXT     163,2                                                 $5$3F352350
       STZ     N+2                                                   $5$3F352360
       AXT     0,4                                                   $5$3F352370
       TXL     DB832,1,0                                             $5$3F352380
       AXC     N,4                                                   $5$3F352390
DB827  SXA     DB831,1                                               $5$3F352400
       TXL     *+2,1,10                                              $5$3F352410
       AXT     10,1                                                  $5$3F352420
       CLA     IC10+10,1                                             $5$3F352430
       STO     DB8PW                                                 $5$3F352440
       RNT     DBSEP                                                 $5$3F352450
       TXI     DB829,4,-2    EXPONENT IS POSITIVE                    $5$3F352460
*                            NEGATIVE EXPONENT                       $5$3F352470
       PXD     0,0                                                   $5$3F352480
       AXT     3,1                                                   $5$3F352490
       AXT     3,4                                                   $5$3F352500
DB828  LDQ     N+3,4                                                 $5$3F352510
       DVP     DB8PW                                                 $5$3F352520
       STQ     N+3,1                                                 $5$3F352530
       NZT     N                                                     $5$3F352540
       TXI     *+2,2,-35     REDUCE CHARACTERISTIC                   $5$3F352550
       TNX     DB831,1,1     STEP TO NEXT RESULT STORAGE             $5$3F352560
       TIX     DB828,4,1                                             $5$3F352570
       LDQ     =0                                                    $5$3F352580
       TRA     DB828+1                                               $5$3F352590
DDBC   STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F352680
       SXA     DDSV4,4                                                  3F352690
       AXT     DDBC7,4               SET DOUBLE PRECISION EXIT AFTER    3F352700
       SXA     DBC99-1,4             DECIMAL POINT IS SCANNED.          3F352710
DDSV4  AXT     **,4                                                     3F352720
       STZ     DATUM+1                                                  3F352730
       STL     DDFLAG                SET FLAG INDICATING DOUBLE         3F352740
       PXD     0,0                   PRECISION RESULT OCCUPIES TWO      3F352750
       LDQ     N                     CELLS AND SET PARTIALLY            3F352760
       LRS     0                     CONVERTED RESULT IN                3F352790
       DST     ND                    LOW ORDER PART.                    3F352800
       TRA     DDBC4                                                    3F352810
DDBC1  TIX     DDBC2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F352820
       TXI     DDBC3,2,-1            GET ANOTHER WORD.                  3F352830
DDBC3  AXT     6,1                   RESET CHARACTER COUNT.             3F352840
       LDQ*    BUFADD                GET A NEW WORD.                    3F352850
DDBC2  PXD     0,0                   EXAMINE                            3F352860
       LGL     6                     NEXT CHARACTER.                    3F352870
       CAS     TEN                   TREAT BLANK AS ZERO.               3F352880
       TRA     DDBC5                 NON-NUMERIC.                       3F352890
DDBC6  PXD     0,0                                                      3F352900
       STA     DG                    SAVE NUMERIC CHARACTER.            3F352910
       STQ     DMQD                  SAVE REMAINING INPUT WORD.         3F352920
       DLD     ND                                                       3F352930
DDBC4  LLS     2                     CONVERT BCD TO BINARY.             3F352940
       TOV     DDOV                  THIS INVOLVES DOUBLE PRECISION     3F352950
       STO     F                     FIXED POINT ADDITION.              3F352960
       XCA                                                              3F352970
       ADD     ND+1                                                     3F352980
       XCA                                                              3F352990
       PXD     0,0                                                      3F353000
       CLA     F                                                        3F353010
       TNO     *+2                                                      3F353020
       ADD     L(1)                                                     3F353030
       ADD     ND                                                       3F353040
       TOV     DDOV                                                     3F353050
       LLS     1                                                        3F353060
       TOV     DDOV                                                     3F353070
       XCA                                                              3F353080
       ADM     DG                                                       3F353090
       XCA                                                              3F353100
       TNO     *+2                                                      3F353110
       ADD     L(1)                                                     3F353120
       TOV     DDOV                                                     3F353130
       DST     ND                                                       3F353140
       LDQ     DMQD                                                     3F353150
DDBC7  TNX     DBC15,4,1             BUMP WIDTH.                        3F353160
       TRA     DDBC1                                                    3F353170
DDBC5  CAS     BLANK                 EXAMINE NON-NUMERIC CHARACTER.     3F353180
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F353190
       TRA     DDBC6                 TREAT BLANK AS ZERO.               3F353200
       TRA     DBC9                                                     3F353210
DDOV   LDQ     DMQD                  IF OVERFLOW,IGNORE CONVERTED       3F353220
       CLA     V                     RESULT BUT ADD ONE TO V.           3F353230
       ADD     L(1)                                                     3F353240
       STO     V                                                        3F353250
       TIX     DDOV1,4,1             BUMP WIDTH.                        3F353260
       TRA     DBC15                 EXIT WHEN WIDTH EXHAUSTED.         3F353270
DDOV1  TIX     DDOV2,1,1             BUMP CHARACTER COUNT. IF EXHAUSTED,3F353280
       TXI     *+1,2,-1              GET ANOTHER WORD.                  3F353290
       AXT     6,1                   RESET CHARACTER COUNT.             3F353300
       LDQ*    BUFADD                GET A NEW WORD.                    3F353310
DDOV2  PXD     0,0                   EXAMINE                            3F353320
       LGL     6                     NEXT CHARACTER.                    3F353330
       CAS     TEN                                                      3F353340
       TRA     DDOV3                                                    3F353350
       TRA     DDOV+1                                                   3F353360
       TRA     DDOV+1                                                   3F353370
DDOV3  CAS     BLANK                                                    3F353380
       TRA     STOP4                 ILLEGAL CHARACTER.                 3F353390
       TRA     DDOV+1                TREAT BLANK AS ZERO.               3F353400
       TRA     DBC9                                                     3F353410
*                  POSITIVE EXPONENT                                 $5$3F353420
DB829  AXT     3,1                                                   $5$3F353430
       LDQ     DB8PW                                                 $5$3F353440
       MPY     0,4                                                   $5$3F353450
       TXH     DB830,1,2                                             $5$3F353460
       XCA                                                           $5$3F353470
       ADD     1,4                                                   $5$3F353480
       XCL                                                           $5$3F353490
       TQP     *+3                                                   $5$3F353500
       ADD     L(1)                                                  $5$3F353510
       LRS     0                                                     $5$3F353520
DB830  STO     0,4                                                   $5$3F353530
       STQ     1,4                                                   $5$3F353540
       TNX     *+2,1,1                                               $5$3F353550
       TXI     DB829+1,4,1                                           $5$3F353560
       TZE     *+2                                                   $5$3F353570
       TXI     DB831,2,35    INCREMENT CHARACTERISTIC                $5$3F353580
       TXI     *+1,4,-1                                             (13)3F353585
       TXH     DB831,4,-ND                                          (13)3F353590
       AXC     N,4                                                  (13)3F353595
DB831  AXT     **,1                                                  $5$3F353600
       TIX     DB827,1,10                                            $5$3F353610
       RFT     DBSEP                                                 $5$3F353620
DB832  AXC     N,4                                                   $5$3F353630
*                  FLOAT NUMBER                                      $5$3F353640
       LFTM                                                          $5$3F353650
       CLA     0,4                                                   $5$3F353660
       LRS     8                                                     $5$3F353670
       ADD     DB871         35B8                                    $5$3F353680
       STO     DB8PW                                                 $5$3F353690
       CLA     DB872         27B16                                   $5$3F353700
       LLS     8                                                     $5$3F353710
       FAD     DB8PW                                                 $5$3F353720
       ARS     9                                                     $5$3F353730
       PDX     0,1                                                   $5$3F353740
       STD     *+1                                                   $5$3F353750
       TXI     *+1,2,**                                              $5$3F353760
       TXH     FERR3,2,1000                                          $5$3F353770
       TXH     FERR2,2,255                                           $5$3F353780
       CLA     1,4                                                   $5$3F353790
       LDQ     2,4                                                   $5$3F353800
       LLS     35,1                                                  $5$3F353810
       STO     2,4                                                   $5$3F353820
       CLA     0,4                                                   $5$3F353830
       LDQ     1,4                                                   $5$3F353840
       LLS     35,1                                                  $5$3F353850
       LDQ     2,4                                                   $5$3F353860
       LRS     8                                                     $5$3F353870
       STO     0,4                                                   $5$3F353880
       PXD     0,2                                                   $5$3F353890
       ALS     9                                                     $5$3F353900
       TOV     *+1                                                   $5$3F353910
       ZET     DDDFLG                                                $5$3F353920
       TXI     DB833,2,-27   DOUBLE PRECISION                        $5$3F353930
DB834  ORA     0,4           SINGLE PRECISION                        $5$3F353940
       RQL     28                                                    $5$3F353950
       FRN                                                           $5$3F353960
       TRA     DBEXIT-1                                             (13)3F353970
DB833  TXH     DB834,2,256                                           $5$3F353980
       ORS     0,4                                                   $5$3F353990
       PXA     0,2                                                   $5$3F354000
       LLS     27                                                    $5$3F354010
       RQL     28                                                    $5$3F354020
       FRN                                                           $5$3F354030
       FAD     0,4                                                   $5$3F354040
       EFTM                                                          (6)3F354055
DBEXIT RFT     DBSPP                                                 $5$3F354060
       SSM                                                           $5$3F354070
       LRS     0                                                     $5$3F354080
       LAS     CHTEST                                                $5$3F354090
       TRA     *+3                                                   $5$3F354100
       TRA     *+2                                                   $5$3F354110
       LDQ     =0                                                    $5$3F354120
       DST     DATUM                                                 $5$3F354130
       STZ     N+1                                                   $5$3F354160
       TRA     COUNT-2                                               $5$3F354170
       EVEN                                                          $5$3F354180
CHTEST DEC     1.EE-30                                               $5$3F354190
       DEC     100000,10000,1000,100,10,1                            $5$3F354200
DDRSET AXT     DBC14,4               RESET EXIT CHANGED FOR TWO-CELL    3F354210
       SXA     DBC99-1,4             DOUBLE PRECISION CONVERSION.       3F354220
       STZ     DDFLAG                RESET FLAG.                        3F354230
       LXA     COUNT,4               IF FIELD                           3F354240
       TNX     DDRST1,4,1            COUNT IS                           3F354250
       TRA     COUNT                 EXHAUSTED,                         3F354260
DDRST1 AXT     **,4                  RESET ALL DOUBLE PRECISION EXITS   3F354270
       SXA     **,4                                                     3F354280
DDRST2 NOP     D3                                                       3F354290
       AXT     EXPON,4                                                  3F354300
       SXA     DBC10,4                                                  3F354310
D1     AXT     **,4                                                     3F354320
       SXA     DBC20,4                                                  3F354330
D2     AXT     **,4                                                     3F354340
       SXA     DDSW,4                                                   3F354350
D3     STZ     DDDFLG                                                   3F354360
       TRA     1,2                                                      3F354370
       REM  ILLEGAL INPUT DATA.                                         3F354380
STOP1  CLA     BUFADD                STORE LOCATION OF INPUT            3F354390
       ALS     18                    BUFFER FOR FXEM.                   3F354400
       STD     CODE1                                                    3F354410
       SXA     SP1SV,4                                                  3F354420
1STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354430
SP1SV  AXT     **,4                                                     3F354440
       TOV     *+1                                                   (6)3F354441
       TRA     DBCS1                                                    3F354450
ER     TXH     STOP4,4,**                                               3F354460
STOP2  CLA     BUFADD                STORE LOCATION OF INPUT            3F354470
       ALS     18                    BUFFER FOR FXEM.                   3F354480
       STD     CODE1                                                    3F354490
       SXA     SP2SV,4                                                  3F354500
2STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354510
SP2SV  AXT     **,4                                                     3F354520
       TRA     DBC6                                                     3F354530
STOP3  CLA     BUFADD                STORE LOCATION OF INPUT            3F354540
       ALS     18                    BUFFER FOR FXEM.                   3F354550
       STD     CODE1                                                    3F354560
       SXA     SP3SV,4                                                  3F354570
3STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354580
SP3SV  AXT     **,4                                                     3F354590
       TRA     ER3+1                                                    3F354600
STOP4  CLA     BUFADD                STORE LOCATION OF INPUT            3F354610
       ALS     18                    BUFFER FOR FXEM.                   3F354620
       STD     CODE1                                                    3F354630
       SXA     SP4SV,4                                                  3F354640
4STOP  CALL    .FXEM.(CODE1)         EXIT FOR EXECUTION ERROR.          3F354650
SP4SV  AXT     **,4                                                     3F354660
       TOV     *+1                                                   (6)3F354661
       TRA     DBC12                                                 $5$3F354670
FERR2  TSX     .FERR2,1                                              $5$3F354680
       OCT     377777777777                                          $5$3F354690
       OCT     344777777777                                          $5$3F354700
FERR3  TSX     .FERR2,1                                              $5$3F354710
       DEC     0                                                     $5$3F354720
       DEC     0                                                     $5$3F354730
.FERR2 CALL    .FXEM.(CODE3)      OVERFLOW OR UNDERFLOW              $5$3F354740
       CLA     1,1                                                   $5$3F354750
       EFTM                                                          (6)3F354755
       LDQ     2,1                                                   $5$3F354760
       TRA     DBEXIT+3                                              $5$3F354770
CODE3  PZE     71                                                    $5$3F354780
ER71MS PZE     E71MES,,11                                            $5$3F354790
ER71OP PZE     E71OMS,,6                                             $5$3F354800
E71MES BCI     8,0INPUT DATA NOT WITHIN PERMISSIBLE RANGE OF FLOA    $5$3F354810
       BCI     3,TING POINT NUMBERS                                  $5$3F354820
E71OMS BCI     6,0READING OF INPUT DATA CONTINUES                    $5$3F354830
       REM  ENTRY FOR INPUT OF ALPHAMERIC DATA.                         3F354840
ANPT   TIX     ANPT1,1,1             SCAN THE CURRENT INPUT FIELD.      3F354850
       TXI     *+1,2,-1              IF WIDTH                           3F354860
       LDQ*    BUFADD                IS GREATER THAN OR EQUAL TO SIX,   3F354870
       AXT     6,1                   OBTAIN                             3F354880
ANPT1  LGL     6                     THE SIX                            3F354890
       TIX     ANPT,4,1              RIGHTMOST                          3F354900
       SXA     DX2,2                 CHARACTERS.                        3F354910
       STQ     MQD                   ..                                 3F354920
       LXA     WIDTH,4               LEFT ADJUST, IF LESS THAN SIX      3F354930
       LDQ     BLANKS                AND                                3F354940
       TXH     ONPT4,4,5           * FILL OUT                           3F354950
       LGL     6                     WORD                               3F354960
       TXI     *-2,4,1               WITH BLANKS.                       3F354970
       REM  ENTRY FOR INPUT OF OCTAL DATA.                              3F354980
ONPT   STZ     N                     CONVERT                            3F354990
       STZ     BLCNT                                                 (8)3F354995
ONPT1  TIX     *+6,1,1               FROM                               3F355000
       LXA     DX2,2                 OCTAL                              3F355010
       TXI     *+1,2,-1              TO                                 3F355020
       LDQ*    BUFADD                BINARY.                            3F355030
       SXA     DX2,2                 IF FIELD                           3F355040
       AXT     6,1                   WIDTH IS                           3F355050
       PXD     ,0                    GREATER THAN 12                    3F355060
       LGL     6                     ONLY THE 12                        3F355070
       PAX     ,2                    RIGHTMOST                          3F355080
       TXL     ONPT3,2,7             DIGITS ARE                         3F355090
       SUB     BLANK                 SIGNIFICANT.                       3F355100
       TZE     CNTBL                 IF LESS                         (8)3F355110
       ZET     BLCNT                                                 (8)3F355118
       TRA     STOP5                 (ILLEGAL CHARACTER)             (8)3F355119
       CLA     MZE                   THAN 12,                           3F355120
       TXL     STOP5,2,11            RIGHT-ADJUST                       3F355130
       TXL     ONPT2,2,12            AND FILLOUT                        3F355140
       TXH     STOP5,2,32            WITH                               3F355150
       TXH     ONPT2,2,32-1          ZEROS.                             3F355160
       TXH     STOP5,2,16            TREAT BLANKS                       3F355170
       TXH     ONPT3,2,16-1          AS ZEROS.                          3F355180
STOP5  CLA     BUFADD                STORE LOCATION OF INPUT            3F355190
       ALS     18                    BUFFER FOR FXEM.                   3F355200
       STD     CODE2                                                    3F355210
       SXA     SP5SV,4                                                  3F355220
5STOP  CALL    .FXEM.(CODE2)         EXIT FOR EXECUTION ERROR.          3F355230
SP5SV  AXT     **,4                                                     3F355240
       TRA     ONPT3                 ILLEGAL INPUT DATA.                3F355250
CNTBL  ZET     BLCNT                                                 (8)3F355260
       TRA     ONPT3                 INPUT DATA NOT BLANK FIELD.     (8)3F355265
       TRA     ONPT3A                                                (8)3F355270
ONPT2  STO     DG                    SET SIGN MINUS.                 (8)3F355280
ONPT3  STA     DG                    ..                                 3F355290
       CAL     N                     ..                                 3F355300
       ALS     3                     ..                                 3F355310
       ADM     DG                    ..                                 3F355320
       SLW     N                     ..                                 3F355330
       STL     BLCNT                 (INPUT DATA NOT ALL BLANKS)     (8)3F355335
ONPT3A TIX     ONPT1,4,1                                             (8)3F355340
       NZT     BLCNT                 IS INPUT DATA FIELD BLANK...    (8)3F355348
       ORA     MZE                   YES.  TREAT IT AS MINUS ZERO.   (8)3F355349
       ORA     DG                    ..                                 3F355350
       STQ     MQD                   ..                                 3F355360
       REM  ENTRY FROM ANPT.                                            3F355370
ONPT4  SLW     DATUM                 ..                                 3F355380
       SXA     DX1,1                 ..                                 3F355390
       TRA     COUNT               * EXIT TO TEST FIELD COUNT.          3F355400
       REM  ENTRY FOR INPUT OF LOGICAL DATA                             3F355410
LNTP   STZ     DATUM                 SET LOGICAL VARIABLE TO FALSE.     3F355420
LNTP0  TIX     LNTP1,1,1             IS CHARACTER COUNT EXHAUSTED.      3F355430
       TXI     *+1,2,-1              YES. INCREMENT WORD COUNT.         3F355440
       AXT     6,1                                                      3F355450
       LDQ*    BUFADD                GET NEXT INPUT WORD.               3F355460
LNTP1  PXD     ,0                                                       3F355470
       LGL     6                     TAKE A CHARACTER.                  3F355480
       CAS     TRUE                                                     3F355490
       TRA     STOPL                                                    3F355500
       TRA     LNPT3                 CHARACTER = T.                     3F355510
       CAS     BLANK                                                    3F355520
       TRA     STOPL                                                    3F355530
       TRA     LNPT2                 CHARACTER = BLANK.                 3F355540
       CAS     FALSE                                                    3F355550
       TRA     STOPL                                                    3F355560
       TRA     LNPT4                 CHARACTER = F.                     3F355570
STOPL  CLA     BUFADD                ERROR. ILLEGAL INPUT CHARACTER.    3F355580
       ALS     18                                                       3F355590
       STD     CODE9                                                    3F355600
       SXA     SPLSV,4                                                  3F355610
       CALL    .FXEM.(CODE9)         OPTIONAL RETURN IS TREAT AS BLANK. 3F355620
SPLSV  AXT     **,4                                                     3F355630
LNPT2  TIX     LNTP0,4,1                                                3F355640
       TRA     LNPT6                 IF FIELD IS BLANK, ASSUME FALSE.   3F355650
LNPT3  STL     DATUM                 SET LOGICAL VARIABLE TO TRUE.      3F355660
LNPT4  TNX     LNPT6,4,1             SKIP TO END OF INPUT FIELD.        3F355670
       TIX     LNPT5,1,1                                                3F355680
       TXI     *+1,2,-1                                                 3F355690
       AXT     6,1                                                      3F355700
       LDQ*    BUFADD                                                   3F355710
LNPT5  LGL     6                                                        3F355720
       TRA     LNPT4                                                    3F355730
LNPT6  STQ     MQD                   SAVE REMAINING INPUT WORD,         3F355740
       SXA     DX1,1                 CHARACTER AND                      3F355750
       SXA     DX2,2                 WORD COUNTS.                       3F355760
       TRA     COUNT         GO TEST FIELD COUNT                     $5$3F355770
*         **** ENTRY FOR A OUTPUT****                                $5$3F355780
AC     XEC     GAIN           RESET XR1 FOR OUTBUF CHARACTER COUNT   $5$3F355790
       XEC     GAIN1          RESET XR2 FOR OUTBUF LOCATION COUNT    $5$3F355800
       LDQ     QSTO           BCD CHARACTERS                         $5$3F355810
       LXA     WIDTH,4        FIELD WIDTH                            $5$3F355820
AC1    TNX     AC2,4,6        IF FIELD WIDTH NOT GREATER THAN SIX    $5$3F355830
       TSX     XC,3           INSERT BLANKS                          $5$3F355840
       AXT     6,4                                                   $5$3F355850
AC2    XCA                                                           $5$3F355860
AC3    LGL     6              SOURCE CHARACTER ENTERS AC             $5$3F355870
       TIX     *+2,1,1                                               $5$3F355880
       TSX     EC20,5         TO OUTBUF UPDATING ROUTINE             $5$3F355890
       TIX     AC3,4,1                                               $5$3F355900
       XCL                                                           $5$3F355910
       TRA     EC1            EXIT TO FORMAT SCAN                    $5$3F355920
*         ****ENTRY FOR D OUTPUT****                                 $5$3F355930
DC     CLA     PEX           SCALE FACTOR SUBSEQUENTLY CALLED 'P'    $5$3F355940
       TNZ     DC3           IF P NOT ZERO                           $5$3F355950
       TSX     ECDC,5        GO TO IMPLEMENT TESTS AND CONVERSION    $5$3F355960
       CLA     DP50+1        EQUIVALENT OF D-8 DIGITS                $5$3F355970
       TSX     DC1,7         DEVELOP BCD REPRESENTATION AND STORE    $5$3F355980
       TRA     EC1           EXIT TO FORMAT SCAN                     $5$3F355990
*           **SUBROUTINE TO DEVELOP BCD REPRESENTATION AND           $5$3F356000
*             TO STORE INTO OUTPUT BUFFER.                           $5$3F356010
*             EQUIVALENT OF LEADING D-8 DIGITS IN AC                 $5$3F356020
*             EQUIVALENT OF 8 LOW-ORDER DIGITS IN DP50               $5$3F356030
DC1    TSX     EC30,3        INSERT SIGN                             $5$3F356040
       TSX     EC32,3        INSERT 0.                               $5$3F356050
       LXA     DIG,4         D=NUMBER OF DIGITS AFTER DECIMAL POINT  $5$3F356060
       TXL     DC2A,4,0      IF DIG=0                                $5$3F356070
       XCL                                                           $5$3F356080
       TNX     DC2,4,8       IF D LESS THAN OR EQUAL TO 8            $5$3F356090
       TSX     JP,3          DEVELOP D-8 DECIMAL DIGITS              $5$3F356100
       AXT     8,4                                                   $5$3F356110
DC2    CLA     DP50                                                  $5$3F356120
       TSX     JP,3          DEVELOP REMAINING DIGITS                $5$3F356130
       XCL                                                           $5$3F356140
DC2A   ALS     6                                                     $5$3F356150
       ORA     EC15          INSERT D                                $5$3F356160
       TRA     EC5           INSERT EXPONENT                         $5$3F356170
*         POSITIVE SCALE FACTOR IN DOUBLE PRECISION OUTPUT           $5$3F356180
DC3    TSX     ECDCP,7       CONVERT TO BINARY INTEGERS              $5$3F356190
       DEC     32                                                    $5$3F356200
       TRA     DC+2          IF P NEGATIVE                           $5$3F356210
       CLA     DIGP          D=ACTUAL NUMBER OF DIGITS DEVELOPED FOR $5$3F356220
       SUB     =8            FRACTION, D-8                           $5$3F356230
       TMI     DC9           D LESS THAN 8                           $5$3F356240
       TZE     DC8           D=8                                     $5$3F356250
       STA     DC5           NUMBER OF LEADING DIGITS FOR FRACTION   $5$3F356260
       PAX     ,4            FOR DIVISION                            $5$3F356270
       PXD     ,0                                                    $5$3F356280
       LDQ     DP50+1        EQUIVALENT OF P+D-8 DIGITS              $5$3F356290
       LLS     0                                                     $5$3F356300
       DVP     IC10+10,4     BY 10**D-8,INTEGER PART IN MQ           $5$3F356310
       STO     DP50+1        SAVE FRACTION PART                      $5$3F356320
       XCA                                                           $5$3F356330
       TSX     DC11,7        DEVELOP INTEGER PART                    $5$3F356340
       CLA     DP50+1        FRACTION PART                           $5$3F356350
*         DEVELOP BCD REPRESENTATION OF FRACTION                     $5$3F356360
DC5    AXT     **,4          NUMBER OF LEADING DIGITS FOR FRACTION   $5$3F356370
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356380
       AXT     8,4                                                   $5$3F356390
       CLA     DP50          EQUIVALENT OF 8 MORE DIGITS OF FRACTION $5$3F356400
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356410
       XEC     EC8           NUMBER OF ADDITIONAL ZEROS FOR FRACTION $5$3F356420
       TXL     *+2,4,0       IF NO ZEROS REQUIRED                    $5$3F356430
       TSX     DC16,7        INSERT ZEROS                            $5$3F356440
DC5A   TSX     DC2+2,7       INSERT D AND EXPONENT                   $5$3F356450
       TRA     EC1           EXIT                                    $5$3F356460
*         IF D=8                                                     $5$3F356470
DC8    CLA     DP50+1        EQUIVALENT OF INTEGER PART              $5$3F356480
       TSX     DC11,7        DEVELOP INTEGER PART                    $5$3F356490
       LXA     DIGP,4                                                $5$3F356500
       TXL     DC5A,4,0                                              $5$3F356510
       TRA     DC5+3         DEVELOP FRACTION,INSERT D AND EXPONENT  $5$3F356520
*         IF D LESS THAN 8                                           $5$3F356530
DC9    TSX     ECDCP1,7      SEPARATE INTEGER AND FRACTION PARTS     $5$3F356540
       STO     DP50          EQUIVALENT OF DIGITS AFTER DECIMAL POINT$5$3F356550
       ZET     DP50+1        TEST IF HIGH ORDER PART=0               $5$3F356560
       TRA     DC10          HIGH-ORDER PART NOT ZERO                $5$3F356570
       XCA                                                           $5$3F356580
       TRA     DC8+1         INSERT SIGN AND DEVELOP BCD REPR.       $5$3F356590
*        IF LESS THAN 8 AND HIGH-ORDER PART NOT ZERO                 $5$3F356600
DC10   STQ     N+1           SAVE SECOND PART OF INTEGER             $5$3F356610
       CLA     =8                                                    $5$3F356620
       SUB     DIGP          8-D=NUMBER OF DIGITS OF LOW-ORDER PART B$5$3F356630
       STO     N             NGING TO INTEGER                        $5$3F356640
       CLA     PEX           P                                       $5$3F356650
       SUB     N             NUMBER OF LEADING DIGITS OF INTEGER     $5$3F356660
       PAX     ,4                                                    $5$3F356670
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F356680
       CLA     DP50+1        EQUIVALENT OF FIRST PART OF INTEGER     $5$3F356690
       TSX     EC30,3        INSERT SIGN                             $5$3F356700
       XCL                                                           $5$3F356710
       TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356720
       LXA     N,4                                                   $5$3F356730
       CLA     N+1           SECOND PART OF INTEGER                  $5$3F356740
       TSX     DC13,7        COMPLETE INTEGER PART                   $5$3F356750
       LXA     DIGP,4                                                $5$3F356760
       TRA     DC5+3         DEVELOP FRACTION                        $5$3F356770
*         INSERT SIGN,DEVELOP INTEGER PART,AND INSERT .              $5$3F356780
DC11   LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F356790
DC12   LXA     PEX,4         P                                       $5$3F356800
       TSX     EC30,3        INSERT SIGN                             $5$3F356810
       XCL                                                           $5$3F356820
DC13   TSX     JP2,3         DEVELOP BCD REPRESENTATION              $5$3F356830
       XCL                                                           $5$3F356840
       ALS     6                                                     $5$3F356850
       ORA     EC11          INSERT .                                $5$3F356860
       XCL                                                           $5$3F356870
       TIX     *+2,1,1                                               $5$3F356880
       TSX     JP4,3          UPDATE OUTBUF                          (6)3F356890
       TRA     1,7                                                   $5$3F356900
*         INSERT ZEROS IN FRACTION                                   $5$3F356910
DC16   PXD     ,0                                                    $5$3F356920
       TSX     JP2,3         INSERT BCD ZEROS                        $5$3F356930
       AXT     0,4                                                   $5$3F356940
       PXA     EC8,4         RESET ADDRESS OF EC8 WITH 0             $5$3F356950
DC17   TRA     1,7                                                   $5$3F356960
*         ****ENTRY FOR E OUTPUT****                                 $5$3F356970
EC     STZ     DATUM+1                                               $5$3F356980
       CLA     PEX                                                   $5$3F356990
       TNZ     EC6           IF P NOT ZERO                           $5$3F357000
       TSX     ECDC,5        GO TO IMPLEMENT TESTS AND CONVERSION    $5$3F357010
       CLA     DP50          EQUIVALENT OF D DECIMAL DIGITS          $5$3F357020
       TSX     EC3,7         DEVELOP BCD REPRESENTATION AND STORE    $5$3F357030
       TRA     EC1           EXIT                                    $5$3F357040
*           **E OUTPUT. SUBROUTINE TO DEVELOP BCD REPRESENTATION AND $5$3F357050
*             STORE INTO OUTPUT BUFFER.EQUIVALENT OF D DIGITS IN AC. $5$3F357060
EC3    TSX     EC30,3        INSERT SIGN                             $5$3F357070
       TSX     EC32,3        INSERT 0.                               $5$3F357080
       LXA     DIG,4         D=NUMBER OF DIGITS AFTER DECIMAL POINT  $5$3F357090
       TXL     EC4+1,4,0     IF DIG=0                                $5$3F357100
       TXH     EC50,4,8      IF D=9                                  $5$3F357110
       XCL                                                           $5$3F357120
       TSX     JP,3          DEVELOP D DIGITS                        $5$3F357130
EC4    XCL                                                           $5$3F357140
       ALS     6                                                     $5$3F357150
       ORA     EC12          E                                       $5$3F357160
EC5    TIX     *+2,1,1                                               $5$3F357170
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F357180
*                            DEAL WITH U                             $5$3F357190
       XCL                                                           $5$3F357200
       PXA     ,6            U+38                                    $5$3F357210
       SUB     EC13          38                                      $5$3F357220
       SUB     PEX           P                                       $5$3F357230
*             U+38 IN XR6                                            $5$3F357240
       TSX     EC30E,3       DEAL WITH SIGN OF EXPONENT             (12)3F357250
*         DEVELOP U                                                  $5$3F357260
       XCL                                                           $5$3F357270
       AXT     2,4           SET J=2                                 $5$3F357280
       TSX     JP,3                                                  $5$3F357290
       TRA     1,7                                                   $5$3F357300
*         POSITIVE SCALE FACTOR IN SINGLE PRECISION OUTPUT           $5$3F357310
EC6    TSX     ECDCP,7       CONVERT TO BINARY INTEGERS              $5$3F357320
       DEC     16                                                    $5$3F357330
       TRA     EC+3          IF P NEGATIVE                           $5$3F357340
       TSX     ECDCP1,7      SEPARATE INTEGER AND FRACTION PARTS     $5$3F357350
       DST     DP50                                                  $5$3F357360
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F357370
       CLA     DP50+1        INTEGER PART                            $5$3F357380
       TSX     DC12,7        DEVELOP BCD REPRESENTATION OF INTG. PART$5$3F357390
       LXA     DIGP,4        NUMBER OF DIGITS DEVELOPED FOR FRACTION $5$3F357400
       CLA     DP50          FRACTION                                $5$3F357420
       TXL     *+2,4,0                                               $5$3F357430
       TSX     JP2,3         DEVELOP BCD REPRESENTATION OF FRACTION  $5$3F357440
EC8    AXT     **,4          NUMBER OF ZEROS TO BE INSERTED IN FRAC. $5$3F357450
       TXL     *+2,4,0       IF NO ZEROS REQUIRED                    $5$3F357460
       TSX     DC16,7        INSERT ZEROS                            $5$3F357470
EC8A   TSX     EC4,7         INSERT E AND EXPONENT                   $5$3F357480
EC9    TRA     EC1           EXIT                                    $5$3F357490
EC50   AXT     1,4                                                   $5$3F357500
       XCL                                                           $5$3F357510
       CLA     DP50+1                                                $5$3F357520
       TSX     JP,3                                                  $5$3F357530
       AXT     8,4                                                   $5$3F357540
       CLA     DP50                                                  $5$3F357550
       TRA     EC4-1                                                 $5$3F357560
*         EDITING CONSTANTS                                          $5$3F357570
EC10   BCI     1,00000-                                              $5$3F357580
EC11   BCI     1,00000.                                              $5$3F357590
EC12   BCI     1,00000E                                              $5$3F357600
EC13   DEC     38                                                    $5$3F357610
EC14   EQU     JP11          SIX BLANKS                              $5$3F357620
EC15   BCI     1,00000D                                              $5$3F357630
*         ****ENTRY FOR FIXED POINT OUTPUT****                       $5$3F357640
FC     STZ     DATUM+1                                               $5$3F357650
       XEC     GAIN                                                  $5$3F357660
       XEC     GAIN1                                                 $5$3F357670
       LDQ     DATUM                                                (12)3F357680
       CLA     L(1)                                                 (12)3F357681
       TQP     *+2                                                  (12)3F357682
       ADD     L(1)                                                 (12)3F357683
       STO     FC2J                                                 (12)3F357684
       ADD     DIG                                                  (12)3F357690
       CAS     WIDTH                                                 $5$3F357700
       TRA     FC8           IF FIELD WIDTH TOO SMALL                $5$3F357710
       TRA     FC8           IF FIELD WIDTH TOO SMALL                $5$3F357720
       CLA     DIG                                                  (12)3F357730
       ADD     PEX           D+P                                     $5$3F357740
       ALS     1             2(D+P)                                  $5$3F357750
       TMI     FC20                                                  $5$3F357760
       STA     FC3           FOR FC ROUTINE                          $5$3F357770
FC9    LXA     WIDTH,4       W=FIELD WIDTH                           $5$3F357780
       TXH     FC2,4,22      IF BLANKS MUST BE FILLED IN             $5$3F357790
       SXA     FC4A,0                                                (6)3F357791
       PXA     0,4           WIDTH LESS THAN OR EQUAL 22             $5$3F357800
FC1    SUB     DIG           W-D                                     $5$3F357810
       SUB     FC2J          W-D-2 IF NEG. W-D-1 IF POS.            (12)3F357820
       STA     FC6           FOR IC ROUTINE                          $5$3F357830
       ADD     DIG           W-2                                     $5$3F357840
       ALS     1             2(W-2)                                  $5$3F357850
       STA     FC4           FOR FC ROUTINE                          $5$3F357860
       DLD     DATUM                                                 $5$3F357870
       ZET     FC21                                                  $5$3F357880
       TRA     FC22                                                  $5$3F357890
       TSX     FC3,7                                                 $5$3F357900
       TRA     EC1                                                   $5$3F357910
FC2    TXI     *+1,4,-22                                             $5$3F357920
       SXA     FC4A,4                                                $5$3F357930
       CLA     =22                                                   $5$3F357940
       TRA     FC1                                                   $5$3F357950
FC2J   PZE                                                          (12)3F357955
*         F CONVERSION COUTINE                                       $5$3F357960
FC3    AXT     **,6          2(D+P)                                  $5$3F357970
       DFMP    DP40+76,6     FORM X*10**(D+P)                        $5$3F357980
*         ROUND OFF                                                  $5$3F357990
FC3A   TPL     *+3                                                   $5$3F358000
       DFSB    DP42          .5                                      $5$3F358010
       TRA     *+2                                                   $5$3F358020
       DFAD    DP42          .5                                      $5$3F358030
*         OVERFLOW TEST                                              $5$3F358040
FC4    AXT     **,5                                                  $5$3F358050
       LAS     DP40+76,5     COMPARE TO 10**2(W-2)                   $5$3F358060
       TRA     FC8           IF OVERFLOW                             $5$3F358070
       TSX     DP5,3         FOR EQUAL CONDITION COMPARE L.O. PART   $5$3F358080
*         FIXING OF MANTISSA                                         $5$3F358090
       LLS     10                                                    $5$3F358100
       LRS     2             SUPPRESS HIGH-ORDER CHARACTERISTIC      $5$3F358110
       PAX     ,3            LOW 8 BITS OF LOW-ORDER CHARACTERISTIC  $5$3F358120
       ARS     8                                                     $5$3F358130
       LRS     163,3         RIGHT-JUSTIFY X*10**D IN AC AND MQ      $5$3F358140
       LXA     DIG,6                                                 $5$3F358150
       DVP     IC10+10,6     DIVIDE BY 10**D                         $5$3F358160
       DST     DP50                                                  $5$3F358170
FC4A   AXT     **,4                                                  $5$3F358180
       TXL     FC5,4,0                                               $5$3F358190
       LDQ     QSTO                                                  $5$3F358200
       TSX     XC,3                                                  $5$3F358210
       STQ     QSTO                                                  $5$3F358220
FC5    SXA     FC7,7          PRESERVE XR7                           $5$3F358240
       LDQ     QSTO                                                  $5$3F358250
       XEC     FC6                                                   $5$3F358260
       TNX     *+4,4,11                                              $5$3F358270
       TSX     XC,3                                                  $5$3F358280
       CLA     =11                                                   $5$3F358290
       STA     FC6                                                   $5$3F358300
       CLA     DP50+1        HIGH ORDER PART                         $5$3F358310
       TSX     IC2,7         DEVELOP AS INTEGER                      $5$3F358320
FC6    AXT     **,4          W-2-D                                   $5$3F358330
       XCL                                                           $5$3F358340
       ALS     6                                                     $5$3F358350
       ORA     EC11          INSERT .                                $5$3F358360
       TIX     *+2,1,1                                               $5$3F358370
       TSX     EC20,5        UPDATE WORD                             $5$3F358380
       XCL                                                           $5$3F358390
       CLA     DP50                                                  $5$3F358400
       LXA     DIG,4         DIG FROM FORMAT SCAN                    $5$3F358410
       TXL     *+2,4,0                                               $5$3F358420
       TSX     JP,3          DEVELOP LOW-ORDER PART                  $5$3F358430
FC7    AXT     **,7          RESTORE XR 7                            $5$3F358440
       TRA     1,7           EXIT                                    $5$3F358450
*         ERROR CONDITION                                            $5$3F358460
FC8    LDQ     QSTO          INSERT ASTERISKS                        $5$3F358470
       TRA     EC2                                                   $5$3F358480
FC20   STA     FC22                                                  $5$3F358490
       STO     FC21                                                  $5$3F358500
       TRA     FC9                                                   $5$3F358510
FC22   AXT     **,6                                                  $5$3F358520
       DFDP    DP40+76,6                                             $5$3F358530
       STZ     FC21                                                  $5$3F358540
       TSX     FC3A,7                                                (7)3F358550
       TRA     EC1                                                   (7)3F358555
FC21   PZE     0                                                     $5$3F358560
*         *** ENTRY FOR H OUTPUT ****                                $5$3F358570
HC     SXA     HC5+1,2       SAVE FORMATLOC COUNT                    $5$3F358580
       LXA     GAIN,5        RESTORE OUTBUF CHAR COUNT               $5$3F358590
       XEC     GAIN1         OUTBUF LOCATION COUNT TO XR 2           $5$3F358600
       CAL     QSTO          RESTORE BCD CHARACTERS FOR OUTPUT       $5$3F358610
       TSX     HC1,7                                                 $5$3F358620
       SLW     QSTO          SAVE BCD CHARACTERS FOR OUTPUT          $5$3F358630
       SXA     GAIN,5        SAVE BCD CHARACTER COUNT                $5$3F358640
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F358650
       XEC     HC5+1         RESTORE FORMATLOC ADDRESS               $5$3F358660
HCEXIT TRA     **                                                    $5$3F358670
HC1    TNX     HC3,4,6                                               $5$3F358680
*         IF J GREATER THAN SIX                                      $5$3F358690
       AXT     6,6           SET COUNT OF LOOP                       $5$3F358700
HC2    TIX     *+2,1,6       COUNT DOWN OF CHARACTERS IN MQ          $5$3F358710
       TSX     HC5,3                                                 $5$3F358720
       LGL     6             SOURCE CHARACTER ENTERS AC              $5$3F358730
       TIX     *+2,5,1                                               $5$3F358740
       TSX     HC4,3         TO WORD UPDATING ROUTINE                $5$3F358750
       TIX     HC2,6,1       COUNT DOWN ON SIX                       $5$3F358760
       TRA     HC1                                                   $5$3F358770
*         IF J NO GREATER THAN SIX                                   $5$3F358780
HC3    TIX     *+2,1,6                                               $5$3F358790
       TSX     HC5,3                                                 $5$3F358800
       LGL     6                                                     $5$3F358810
       TIX     *+2,5,1                                               $5$3F358820
       TSX     HC4,3                                                 $5$3F358830
       TIX     HC3,4,1                                               $5$3F358840
       TRA     1,7                                                   $5$3F358850
HC4    SLW*    BUF           TO PRINT BUFFER                         $5$3F358860
       CAL     JP11          SIX BLANKS                              $5$3F358870
       AXT     6,5           RESET OUTBUF CHARACTER COUNT            $5$3F358880
       TIX     *+2,2,1       ADVANCE PRINT BUFFER ADDRESS            $5$3F358890
       TRA     TEST                                                  $5$3F358900
       TRA     1,3                                                   $5$3F358910
HC5    SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F358920
       AXT     **,2          RESTORE FORMATLOC ADDRESS               $5$3F358930
       TXI     *+1,2,-1      ADVANCE FORMATLOC ADDRESS               $5$3F358940
       AXT     36,1          RESET FORMAT WORD CHARACTER COUNT       $5$3F358950
       LDQ     0,2                                                   $5$3F358960
       SXA     HC5+1,2       SAVE FORMATLOC ADDRESS                  $5$3F358970
       XEC     GAIN1         RESTORE OUTBUF LOCATION COUNT           $5$3F358980
       TRA     1,3                                                   $5$3F358990
*         ****ENTRY FOR I OUTPUT****                                 $5$3F359000
IC     XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F359010
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F359020
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F359030
       CLA     DATUM         BINARY INTEGER                          $5$3F359040
       LXA     WIDTH,4       W=FIELD WIDTH FROM FORMAT STATEMENT     $5$3F359050
       TNX     IC1,4,12      IF NO BLANKS NEEDED                     $5$3F359070
       TSX     XC,3          FILL IN BLANKS                          $5$3F359080
       AXT     12,4          ADJUSTED FIELD WIDTH SUBSEQUENTLY CALLED$5$3F359090
IC1    TPL     *+2                                                  (12)3F359100
       TNX     EC2,4,1       IF FIELD WIDTH IN FORMAT TOO SMALL     (12)3F359101
       SXA     *+2,4                                                 $5$3F359110
       TSX     IC2,7         CREATE BCD INTEGER                      $5$3F359120
       AXT     **,4                                                  $5$3F359130
       TRA     EC1           EXIT                                    $5$3F359140
*           **CREATE BCD REPRESENTATION OF BINARY INTEGER**          $5$3F359150
*             W-1 LESS THAN OR EQUAL TO 11                           $5$3F359160
IC2    XEC     1,7                                                   $5$3F359170
       TXH     IC4-1,4,11                                           (12)3F359175
       TXH     IC6,4,10      IF W-1=11                               $5$3F359180
*         TEST FOR CORRECT FIELD WIDTH                               $5$3F359190
       LAS     IC10+10,4                                             $5$3F359200
       TRA     EC2           FIELD WIDTH IN FORMAT TOO SMALL         $5$3F359210
       TRA     EC2           FIELD WIDTH IN FORMAT TOO SMALL         $5$3F359220
IC3    LAS     IC10+11,4                                             $5$3F359230
       TRA     IC5           IF SIGNIFICANT DIGIT ENCOUNTERED        $5$3F359240
       TRA     IC5           IF SIGNIFICANT DIGIT ENCOUNTERED        $5$3F359250
       TNX     IC5,4,1                                               $5$3F359260
IC4    RQL     6             ACT OF SUPPRESSION                      $5$3F359270
       TIX     IC3,1,1                                               $5$3F359280
*         OUTBUF UPDATING ROUTINE                                    $5$3F359290
       STQ*    BUF                                                   $5$3F359300
       LDQ     JP11          SIX BLANKS                              $5$3F359310
       AXT     6,1                                                   $5$3F359320
       TIX     IC3,2,1       ADVANCE OUTBUF ADDRESS                  $5$3F359330
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F359340
*         DEVELOP NON-BLANK CHARACTERS                               $5$3F359350
IC5    TSX     EC30,3                                                $5$3F359360
       XCL                                                           $5$3F359370
       TSX     JP,3          DEVELOP BCD REPRESENTATION              $5$3F359380
       TRA     2,7                                                   $5$3F359390
*         IF W-1=11                                                  $5$3F359400
IC6    LAS     IC10          COMPARE TO 10**10                       $5$3F359410
       TRA     IC5           NUMBER HAS 11 DECIMAL DIGITS            $5$3F359420
       TRA     IC5                                                   $5$3F359430
       TXI     IC4,4,-1                                              $5$3F359440
*CONSTANTS                                                           $5$3F359810
IC10   DEC     10000000000,1000000000,100000000,10000000,1000000     $5$3F359820
       DEC     100000,10000,1000,100,10,1                            $5$3F359830
*         ****ENTRY FOR L OUTPUT****                                 $5$3F359840
LC     XEC     GAIN          RESET XR1 WITH  OUTBUF CHARACTER COUNT  $5$3F359850
       XEC     GAIN1         RESET XR2 OUTBUF LOCATION COUNT         $5$3F359860
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F359870
       LXA     WIDTH,4       W=FIELD WIDTH FROM FORMAT SPECIFICATION $5$3F359880
       TNX     LC1,4,1       IF W=1                                  $5$3F359890
       TSX     XC,3          FILL IN W-1 BLANKS                      $5$3F359900
LC1    XCL                                                           $5$3F359910
       LDQ     TFTEST        PICK-UP T AND F CHARACTERS              $5$3F359920
       NZT     DATUM         TEST LOGICAL VARIABLE                   $5$3F359930
       RQL     6             LOGICAL VARIABLE IS FALSE               $5$3F359940
       LGL    6              LOGICAL VARIABLE IS TRUE                $5$3F359950
       TIX     *+2,1,1                                               $5$3F359960
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F359970
       XCL                                                           $5$3F359980
       TRA     EC1           EXIT                                    $5$3F359990
*         ****ENTRY FOR OUTPUT****                                   $5$3F360000
OC     XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F360010
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F360020
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F360030
       LXA     WIDTH,4       FIELD WIDTH FROM FORMAT STATEMENT=W     $5$3F360040
       TNX     OC3,4,12      IF W LESS THAN OR EQUAL TO 12           $5$3F360050
       TSX     XC,3          FILL IN BLANKS                          $5$3F360060
       AXT     12,4                                                  $5$3F360070
OC1    XCA                                                           (6)3F360080
OC2    ALS     3                                                     $5$3F360090
       LGL     3                                                     $5$3F360100
       TIX     *+2,1,1                                               $5$3F360110
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F360120
       TIX     OC2,4,1                                               $5$3F360130
       XCL                                                           $5$3F360140
       TRA     EC1           EXIT                                    $5$3F360150
OC3    CLA     =12                                                   $5$3F360160
       SUB     WIDTH         12-W                                    $5$3F360170
       PAX     ,4                                                    $5$3F360180
       CAL     DATUM                                                 $5$3F360190
       XCL                                                           $5$3F360200
       TNX     *+3,4,0                                               (6)3F360205
       RQL     3                                                     $5$3F360210
       TIX     *-1,4,1                                               $5$3F360220
       LXA     WIDTH,4                                               $5$3F360230
       TRA     OC2                                                   $5$3F360240
*         ****ENTRY FOR X OUTPUT.  NUMBER OF BLANKS REQUIRED IN XR4**$5$3F360250
XCF    XEC     GAIN          RESTORE OUTBUF CHARACTER COUNT          $5$3F360260
       XEC     GAIN1         RESTORE OUTBUF LOCATION COUNT           $5$3F360270
       LDQ     QSTO          BCD CHARACTERS                          $5$3F360280
       TSX     XC,3          FILL IN BLANKS                          $5$3F360290
       TRA     EC1           EXIT                                    $5$3F360300
*         **** X CONVERSION  ****                                    $5$3F360310
*         NUMBER OF BLANKS TO BE INSERTED IN XR 4                    $5$3F360320
XC     XEC     XC10+6,1                                              $5$3F360330
*         IF J GREATER THAN I                                        $5$3F360340
       XEC     XC11+6,1      DEVELOP I LOW ORDER BLANKS IN MQ        $5$3F360350
       STQ*    BUF                                                   $5$3F360360
       LDQ     JP11          6 BLANKS                                $5$3F360370
       TIX     XC1,2,1       ADVANCE BUFFER ADDRESS                  $5$3F360380
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360390
XC1    TNX     XC2,4,6                                               $5$3F360400
       STQ*    BUF                                                   $5$3F360410
       TIX     XC1,2,1                                               $5$3F360420
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360430
*         LAST WORD                                                  $5$3F360440
XC2    XEC     XC12+6,4      IF J LESS THAN 6,RESET I, ELSE BRANCH   $5$3F360450
       TRA     1,3                                                   $5$3F360460
XC3    STQ*    BUF                                                   $5$3F360470
       AXT     6,1                                                   $5$3F360480
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F360490
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F360500
       TRA     1,3                                                   $5$3F360510
*         IF J LESS THAN OR EQUAL TO I                               $5$3F360520
XC4    XEC     XC13+6,4                                              $5$3F360530
       XEC     XC11+6,4      DEVELOP J LOW-ORDER BLANKS IN MQ        $5$3F360540
       STQ*    BUF                                                   $5$3F360550
       LDQ     JP11          6 BLANKS                                $5$3F360560
       TRA     XC3+1                                                 $5$3F360570
XC5    XEC     XC11+6,4      DEVELOP J LOW-ORDER BLANKS IN MQ        $5$3F360580
       TRA     1,3                                                   $5$3F360590
*         TABLES                                                     $5$3F360600
XC10   TNX     XC4,4,6       I=6                                     $5$3F360610
       TNX     XC4,4,5       I=5                                     $5$3F360620
       TNX     XC4,4,4       I=4                                     $5$3F360630
       TNX     XC4,4,3       I=3                                     $5$3F360640
       TNX     XC4,4,2       I=2                                     $5$3F360650
       TNX     XC4,4,1       I=1                                     $5$3F360660
XC11   TRA     XC1+1         I=6                                     $5$3F360670
       RQL     30            I=5                                     $5$3F360680
       RQL     24            I=4                                     $5$3F360690
       RQL     18            I=3                                     $5$3F360700
       RQL     12            I=2                                     $5$3F360710
       RQL     6             I=1                                     $5$3F360720
XC12   TRA     XC3           J=6                                     $5$3F360730
       AXT     1,1           J=5                                     $5$3F360740
       AXT     2,1           J=4                                     $5$3F360750
       AXT     3,1           J=3                                     $5$3F360760
       AXT     4,1           J=2                                     $5$3F360770
       AXT     5,1           J=1                                     $5$3F360780
XC13   TRA     XC3           J=6                                     $5$3F360790
       TIX     XC5,1,5       J=5                                     $5$3F360800
       TIX     XC5,1,4       J=4                                     $5$3F360810
       TIX     XC5,1,3       J=3                                     $5$3F360820
       TIX     XC5,1,2       J=2                                     $5$3F360830
       TIX     XC5,1,1       J=1                                     $5$3F360840
*         *****          COMMON SERVICE SUBROUTINES          *****   $5$3F360850
*            **INSERTION OF ASTERISKS**                              $5$3F360860
AST    LXA     WIDTH,4       FIELD WIDTH                             $5$3F360870
AST1   CAL     AST10         ASTERISK                                $5$3F360880
       VDP     AST11,,6      ENTERS MQ FROM RIGHT                    $5$3F360890
       RQL     1                                                     $5$3F360900
       LGR     1                                                     $5$3F360910
       TNX     AST3,1,1      TO OUTBUF UPDATING ROUTINE              $5$3F360920
AST2   TIX     AST1,4,1                                              $5$3F360930
       TRA     1,3           EXIT                                    $5$3F360940
*         OUTBUF UPDATING ROUTINE FOR AST SUBROUTINE                 $5$3F360950
AST3   STQ*    BUF           PLACE BCD CHARACTERS INTO OUTPUT BUFFER $5$3F360960
       AXT     6,1           RESET XR1 WITH 6                        $5$3F360970
       LDQ     JP11          SIX BLANKS                              $5$3F360980
       TIX     AST2,2,1      ADVANCE BUFFER ADDRESSS                 $5$3F360990
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F361000
*         CONSTANTS                                                  $5$3F361010
AST10  BCI     1,00000*      RIGHT-JUSTIFIED ASTERISK                $5$3F361020
AST11  OCT     100           DIVISOR                                 $5$3F361030
*                            EXIT FOR ALL OUTPUT ROUTINES            $5$3F361040
EC1    SXA     GAIN,1        SAVE OUTBUF CHARACTER COUNT             $5$3F361050
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F361060
       STQ     QSTO          SAVE BCD CHARACTERS                     $5$3F361070
       TRA     COUNT         EXIT TO FORMAT SCAN                     $5$3F361080
*                            IF FIELD WIDTH TOO SMALL                $5$3F361090
EC2    TSX     AST,3         GO TO FILL IN ASTERISKS                 $5$3F361100
       TRA     EC1           EXIT                                    $5$3F361110
*         SUBROUTINE FOR UPDATING OUTPUT BUFFER CALLED BY XR 5       $5$3F361120
EC20   SLW*    BUF                                                   $5$3F361130
       CAL     EC14          SIX BLANKS                              $5$3F361140
       AXT     6,1           RESET I=6                               $5$3F361150
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F361160
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F361170
       TRA     1,5                                                   $5$3F361180
*         SUBROUTINE FOR INSERTING SIGN CALLED BY XR3                $5$3F361190
EC30   TMI     EC30E+1                                              (12)3F361197
       XCL                                                          (12)3F361198
       TRA     1,3                                                  (12)3F361199
EC30E  TPL     EC31                                                 (12)3F361200
       XCL                                                           $5$3F361210
       ALS     6                                                     $5$3F361220
       ORA     EC10          MINUS SIGN                              $5$3F361230
       TRA     EC31+2                                                   3F361240
EC31   RQL     6             CREATE LOW ORDER BLANK                  $5$3F361250
       XCL                                                           $5$3F361260
       TIX     *+2,1,1                                               $5$3F361270
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F361280
       TRA     1,3                                                   $5$3F361290
*        SUBROUTINE FOR INSERTING 0. CALLED BY XR3                   $5$3F361300
EC32   ALS     6             CREATE 0                                $5$3F361310
       TIX     *+2,1,1                                               $5$3F361320
       TSX     EC20,5                                                $5$3F361330
       ALS     6                                                     $5$3F361340
       ORA     EC11          .                                       $5$3F361350
       TIX     *+2,1,1                                               $5$3F361360
       TSX     EC20,5        TO OUTBUF UPDATING ROUTINE              $5$3F361370
       TRA     1,3                                                   $5$3F361380
*         TEST FOR FIELD WIDTH,INSERT BLANKS WHERE NEEDED,AND CONVERT$5$3F361390
*         FROM FLOATING POINT NUMBER TO BINARY INTEGERS.             $5$3F361400
ECDC   ADD     DIG           P+D. D=NUMBER OF DIGITS REQUESTED IN    $5$3F361410
       ALS     1             FORMAT 2(P+D)                           $5$3F361420
       TPL     *+2                                                   $5$3F361430
       PXD     ,0            IN NEG SCALE FACTOR,IF ABS VALUE OF P   $5$3F361440
       STA     DP2           GTR FOR DP ROUTINE               THAN D $5$3F361450
       DLD     DATUM         FLOATING POINT NUMBER                   $5$3F361460
       STZ     FC2J                                                 (12)3F361461
       TPL     *+2                                                  (12)3F361462
       STL     FC2J                                                 (12)3F361463
       TSX     DP,4          TO CONVERSION ROUTINE                   $5$3F361470
       PAX     ,0            SINGLE PRECISION EXIT                   $5$3F361480
       DST     DP50          DOUBLE PRECISION EXIT                   $5$3F361490
       CLA     DIG           D                                       $5$3F361500
       ADD     =7            D+7                                     $5$3F361510
       NZT     FC2J                                                 (12)3F361511
       SUB     L(1)                                                 (12)3F361512
ECDC1  XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F361520
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F361530
       LDQ     QSTO          RESTORE BCD CHARACTERS                  $5$3F361540
       CAS     WIDTH         COMPARE TO FIELD WIDTH                  $5$3F361550
       TRA     EC2           FIELD WIDTH TOO SMALL.INSERT ASTERISKS  $5$3F361560
       TRA     1,5           NO BLANKS NEEDED                        $5$3F361570
       SUB     WIDTH         NUMBER OF BLANKS NEEDED                 $5$3F361580
       PAX     ,4                                                    $5$3F361590
       TSX     XC,3          INSERT BLANKS                           $5$3F361600
       TRA     1,5                                                   $5$3F361610
*         SUBROUTINE FOR POSITIVE P FACTOR                           $5$3F361620
*         TESTS FOR FIELD WIDTH,NUMBER OF DIGITS TO BE DEVELOPED,AND $5$3F361630
*         CONVERTS FROM FLOATING POINT NUMBERS TO BINARY INTEGERS    $5$3F361640
ECDCP  TMI     2,7           P NEGATIVE                              $5$3F361650
       ADD     DIG           P+D                                     $5$3F361660
       STO     N                                                     $5$3F361670
       ADD     =5            P+D+5                                  (12)3F361671
       LDQ     DATUM                                                (12)3F361672
       TQP     *+2                                                  (12)3F361673
       ADD     L(1)          P+D+6                                  (12)3F361680
       TSX     ECDC1,5       INSERT BLANKS IF NEEDED                 $5$3F361690
       SXA     GAIN,1        SAVE OUTBUF CHARACTER COUNT             $5$3F361700
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F361710
       STQ     QSTO          SAVE BCD CHARACTERS                     $5$3F361720
       CLA     N             P+D                                     $5$3F361730
       ALS     1             2(P+D)                                  $5$3F361740
       STO     N                                                     $5$3F361750
       CAS     1,7           COMPARE TO 16 IF SINGLE PREC OR 32 IF DP$5$3F361760
       CLA     1,7           IF 2(P+D)GREATER THAN 16(SP) OR 32(DP)  $5$3F361770
       PAX     ,0            NOOP IF 2(P+D)=16 OR 32                 $5$3F361780
       STA     DP2           FOR DP ROUTINE                          $5$3F361790
       DLD     DATUM         FLOATING-POINT NUMBER                   $5$3F361800
       TSX     DP,4          CONVERT TO BINARY INTEGERS              $5$3F361810
       LDQ     L(0)          SINGLE PRECISION EXIT                   $5$3F361820
       DST     DP50          DOUBLE PRECISION EXIT                   $5$3F361830
       XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F361840
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F361850
       CLA     N             2(P+D)                                  $5$3F361860
       SUB     1,7           2(P+D-8) OR 2(P+D-16)                   $5$3F361870
       TMI     ECDCP3                                                (6)3F361880
       ARS     1             P+D-8 OR P+D-16                         $5$3F361890
       STA     EC8           NUMBER OF ZEROS NEEDED FOR FRACTION PART$5$3F361900
       SUB     DIG           P-8 OR P-16                             $5$3F361910
       STA     DIGP          ACTUAL NUMBER OF DIGITS DEVELOPED FOR   $5$3F361920
       TRA     3,7           FRACTION                                $5$3F361930
ECDCP3 CLA     DIG                                                   (6)3F361940
       SXA     EC8,0                                                 (6)3F361941
       TRA     ECDCP3-2                                              (6)3F361950
*         SUBROUTINE FOR POSITIVE SCALE FACTOR.SEPARATES FRACTION AND$5$3F361960
*         INTEGER PARTS                                              $5$3F361970
ECDCP1 LXA     DIGP,4        D                                       $5$3F361980
       PXD     ,0                                                    $5$3F361990
       LDQ     DP50          BINARY INTEGER                          $5$3F362000
       LLS     0                                                     $5$3F362010
       DVP     IC10+10,4     BY 10**D                                $5$3F362020
ECDCP2 TRA     1,7                                                   $5$3F362030
DIGP   PZE     0             ACTUAL NUMBER OF DIGITS DEVEL. FOR FRCTN$5$3F362040
*         SUBROUTINE TO DEVELOP J-PLACE INTEGER                      $5$3F362050
*         CALLED BY TSX JP,3 WITH J LESS THAN OR = 11 IN XR4         $5$3F362060
JP     TXL     JP2,4,9                                               $5$3F362070
*          IF J=10 OR 11                                             $5$3F362080
       RQL     6                                                     $5$3F362090
       LLS     0                                                     $5$3F362100
       LRS     6                                                     $5$3F362110
       VDP     JP10+11,4,6                                           $5$3F362120
       TNX     JP4,1,1             IF WORD BOUNDARY MUST BE CROSSED  $5$3F362130
       TXI     JP,4,-1                                               $5$3F362140
*         CONVERSION LOOP                                            $5$3F362150
JP1    ARS     6                                                     $5$3F362160
JP2    VDP     JP10+11,4,6         DECIMAL DIGIT ENTERS MQ FROM RIGHT$5$3F362170
       TNX     JP3,1,1             IF WORD BOUNDARY MUST BE CROSSED  $5$3F362180
       TIX     JP1,4,1             COUNT ON J                        $5$3F362190
*         AFTER CONVERSION                                           $5$3F362200
       RQL     1                                                     $5$3F362210
       LGR     1                   REPLACE HIGH ORDER BIT IN MQ      $5$3F362220
       TRA     1,3                 GO TO EXIT                        $5$3F362230
*         WORD UPDATING ROUTINE                                      $5$3F362240
JP3    RQL     1                                                     $5$3F362250
       LGR     1                   REPLACE HIGH ORDER BIT IN MQ      $5$3F362260
       ARS     5                   REJUSTIFY AC                      $5$3F362270
JP4    STQ*    BUF           STORE                                   $5$3F362280
       LDQ     JP11                SIX BLANKS                        $5$3F362290
       AXT     6,1                 RESET I=6                         $5$3F362300
       TIX     *+2,2,1       ADVANCE BUFFER ADDRESS                  $5$3F362310
       TRA     TEST          IF OUTBUF+LIMIT HAS BEEN REACHED        $5$3F362320
       TIX     JP,4,1        COUNT ON J                              $5$3F362330
       TRA     1,3                 GO TO EXIT                        $5$3F362340
*      POWERS OF TEN                                                 $5$3F362350
JP10   DEC     10000000000                                           $5$3F362360
       DEC     1000000000                                            $5$3F362370
       DEC     6400000000                                            $5$3F362380
       DEC     640000000                                             $5$3F362390
       DEC     64000000                                              $5$3F362400
       DEC     6400000                                               $5$3F362410
       DEC     640000                                                $5$3F362420
       DEC     64000                                                 $5$3F362430
       DEC     6400                                                  $5$3F362440
       DEC     640                                                   $5$3F362450
       DEC     64                                                    $5$3F362460
*         BCD CONSTANT                                               $5$3F362470
JP11   BCI     1,                  SIX BLANKS                        $5$3F362480
*            **DOUBLE PRECISION CONVERSION ROUTINE**                 $5$3F362490
*             *(2**C).F=(10**U).V,D=NUMBER OF DECIMAL DIGITS IN V    $5$3F362500
*             *P=SCALE FACTOR.FLOATING POINT NUMBER IN AC AND MQ.    $5$3F362510
*         OBTAIN U+38                                                $5$3F362520
DP     LGR     63            RIGHT-JUSTIFY CHARACTERISTIC IN MQ      $5$3F362530
       VLM     DP20,,12      BY LOG 2                                $5$3F362540
       PAX     ,6            U+38                                    $5$3F362550
*         OBTAIN V                                                   $5$3F362560
       ALS     1             2(U+38)                                 $5$3F362570
       TXL     DP1,6,37                                              $5$3F362580
*         IF U NOT NEGATIVE                                          $5$3F362590
       PAX     ,1            2(U+38)                                 $5$3F362600
       DLD     DP51          RESTORE FLOATING POINT NUMBER           $5$3F362610
       DFDP    DP40+152,1    BY 10**U                                $5$3F362620
       TRA     DP2                                                   $5$3F362630
*         IF U NEGATIVE                                              $5$3F362640
DP1    PAC     ,1            2(U+38)                                 $5$3F362650
       DLD     DP51          RESTORE FLOATING POINT NUMBER           $5$3F362660
       DFMP    DP40,1        BY 10**U                                $5$3F362670
*         SCALE TEST                                                 $5$3F362680
DP2    AXT     **,1          2(D+P)                                  $5$3F362690
       LAS     DP21                                                  $5$3F362700
*         IF OUT OF SCALE                                            $5$3F362710
       DFMP    DP40+78,1     BY 10**(D+P-1)                          $5$3F362720
       TXI     *+2,6,1                                               $5$3F362730
*         IF IN SCALE                                                $5$3F362740
       DFMP    DP40+76,1     BY 10**(D+P)                            $5$3F362750
*         ROUND OFF                                                  $5$3F362760
       TPL     *+3                                                   $5$3F362770
       DFSB    DP42          .5                                      $5$3F362780
       TRA     *+2                                                   $5$3F362790
       DFAD    DP42          .5                                      $5$3F362800
*         OVERFLOW TEST                                              $5$3F362810
       LAS     DP40+76,1     COMPARE TO 10**(D+P)                    $5$3F362820
       TRA     DP6           IF OVERFLOW OCCURRED                    $5$3F362830
       TSX     DP5,3         IF LOW ORDER PART MUST ALSO BE TESTED   $5$3F362840
*         FIXING OF MANTISSA                                         $5$3F362850
DP3    LLS     10                                                    $5$3F362860
       LRS     2             SUPPRESS HIGH ORDER CHARACTERISTIC      $5$3F362870
       PAX     ,3            LOW 8 BITS OF LOW ORDER CHARACTERISTIC  $5$3F362880
       LXA     DIG,1                 D FROM W.D OR DEC. PT. FROM DATA(8)3F362890
       TIX     DP4,1,8               GO TO DP4 IF DOUBLE PRECISION   (8)3F362895
       XEC     DP2           2(P+D) TO XR1                          (12)3F362896
       TIX     DP4,1,16      GO TO DP4 IF 2(P+D) IS G. T. 16        (12)3F362897
*         FOR SINGLE PRECISION                                       $5$3F362900
       ARS     136,3         RIGHT-JUSTIFY V*10**D IN AC             $5$3F362910
       TRA     1,4           EXIT                                    $5$3F362920
*         FOR DOUBLE PRECISION                                       $5$3F362930
DP4    ARS     8                                                     $5$3F362940
       LRS     163,3         RIGHT-JUSTIFY V*10**C IN AC AND MQ      $5$3F362950
       DVP     DP24          BY 10**8                                $5$3F362960
       TRA     2,4           EXIT                                    $5$3F362970
*         IF LOW ORDER PART MUST ALSO BE TESTED                      $5$3F362980
DP5    XCA                   LOW ORDER PART TO AC                    $5$3F362990
       TXI     *+1,1,-1      NEXT INSTRUCTION REFR. LOP OF 10**CD+P  $5$3F363000
       XEC     -2,3          COMPARE TO LOW ORDER PART OF 10**D+P    $5$3F363010
       TXI     *+2,3,2       ADJUST XR3 FOR HIGH-ORDER EXIT          $5$3F363020
       TXI     *+1,3,2       ADJUST XR3 FOR HIGH-ORDER EXIT          $5$3F363030
       XCA                   RESTORE AC                              $5$3F363040
       TXI     *+1,1,1       RESTORE XR1                             $5$3F363050
       TRA     1,3                                                   $5$3F363060
*         DEAL WITH ROUND-OFF OVERFLOW                               $5$3F363070
DP6    DFDP    DP40+74       BY 10                                   $5$3F363080
       TXI     DP3,6,1       INCREASE U BY 1                         $5$3F363090
*         CONSTANTS                                                  $5$3F363100
DP20   OCT     2321                                                  $5$3F363110
DP21   OCT     201000000000  QUASI-ONE                               $5$3F363120
DP24   DEC     100000000                                             $5$3F363130
       EVEN                                                          $5$3F363140
*         POWERS OF TEN IN DOUBLE PRECISION                          $5$3F363150
DP40   DEC     1.EE38,1.EE37,1.EE36,1.EE35,1.EE34,1.EE33,1.EE32      $5$3F363160
       DEC     1.EE31                                                $5$3F363170
       DEC     1.EE30,1.EE29,1.EE28,1.EE27,1.EE26,1.EE25,1.EE24      $5$3F363180
       DEC     1.EE23                                                $5$3F363190
       DEC     1.EE22,1.EE21,1.EE20,1.EE19,1.EE18,1.EE17,1.EE16      $5$3F363200
       DEC     1.EE15                                                $5$3F363210
       DEC     1.EE14,1.EE13,1.EE12,1.EE11,1.EE10,1.EE9,1.EE8,1.EE7  $5$3F363220
       DEC     1.EE6,1.EE5,1.EE4,1.EE3,1.EE2,1.EE1,1.EE0             $5$3F363230
       DEC     1.EE-1                                                $5$3F363240
DP42   OCT     232000000001,0    ROUND-OFF CONSTANT=.5               $5$3F363250
DP50   BSS     2                 FOR TEMPORARY STORAGE               $5$3F363260
DP51   EQU     DATUM                                                 $5$3F363270
TEST   TRA     **                                                    $5$3F363280
       REM  ENTRY FROM DBC, ANPT, ONPT, TOPACK.                         3F363290
       ZET     DDDFLG         WAS THIS DOUBLE PRECISION CONVERT      $5$3F363300
       TSX     DDRSET,2              YES. RESET DOUBLE PRECISION EXITS. 3F363310
COUNT  AXT     **,4                  TEST FIELD COUNT,                  3F363320
       TNX     DONE,4,1              IF NOT DONE,                       3F363330
       SXA     *-2,4                 RESET COUNT, AND                   3F363340
       REM  ENTRY FROM CCRPAR, FIELD.                                   3F363350
LIST   DLD     DATUM                 PICKUP INPUT DATUM.                3F363360
LXIT3  AXT     **,3                                                  (6)3F363361
LXIT5  AXT     **,5                                                  (6)3F363362
LXIT6  AXT     **,6                                                  (6)3F363363
LXIT7  AXT     **,7                                                  (6)3F363364
LXIT1  AXT     **,1                  RESTORE                            3F363370
LXIT2  AXT     **,2                  INDEX                              3F363380
LEXIT  AXT     **,4                  REGISTERS.                         3F363390
       TRA     1,4                   EXIT TO PROGRAMS I/O LIST.         3F363400
       REM  REENTRY FROM COUNT.                                         3F363410
DONE   AXT     **,4                  RESTORE RETURN INDEX.              3F363420
       TRA     1,4                 * EXIT TO CALLER.                    3F363430
CODE1  PZE     32                                                       3F363440
ER32MS PZE     E32MES,,7                                                3F363450
ER32OP PZE     E32OMS,,5                                                3F363460
E32MES BCI     7,0ILLEGAL CHAR IN DATA BELOW OR BAD FORMAT              3F363470
E32OMS BCI     5,0TREAT ILLEGAL CHAR AS ZERO                            3F363480
CODE2  PZE     33                                                       3F363490
ER33MS PZE     E32MES,,7                                                3F363500
ER33OP PZE     E32OMS,,5                                                3F363510
CODE9  PZE     57                                                       3F363520
ER57MS PZE     E57MES,,8                                                3F363530
ER57OP PZE     E57OMS,,5                                                3F363540
E57MES BCI     8,0ILLEGAL CHAR FOR L CONVERSION IN DATA BELOW           3F363550
E57OMS BCI     5,0TREAT ILLEGAL CHAR AS BLANK                           3F363560
LIMIT  EQU     LIMIT5/6+1            LINE LIMIT IN WORDS             (8)3F363570
       EVEN                                                          $5$3F363580
OUTBUF BSS     LIMIT                                                 (8)3F363590
BUF    PZE     OUTBUF+LIMIT,2                                        $5$3F363600
QSTO   BCI     1,             6 BLANKS                               $5$3F363610
WIDTH  PZE                                                           $5$3F363620
GAIN   AXT     6,1                                                   $5$3F363630
GAIN1  AXT     LIMIT,2                                               $5$3F363640
MINUS  EQU     EC10                                                  $5$3F363650
POINT  EQU     EC11                                                  $5$3F363660
EXPON  EQU     EC12                                                  $5$3F363670
PLUS   BCI     1,00000+                                                 3F363680
NEGAT  BCI     1,00000'                                                 3F363690
TRUE   BCI     1,00000T                                                 3F363700
FALSE  BCI     1,00000F                                                 3F363710
TFTEST BCI     1,TF                                                     3F363720
L(0)   PZE     0                                                     $5$3F363730
MZE    MZE                                                              3F363740
TEN    EQU     IC10+9                                                $5$3F363750
.FBDBF PZE     **,2                  LOCATION OF INPUT BUFFER,2         3F363760
DMQD   PZE                                                              3F363770
V      PZE                                                              3F363780
U      PZE                                                              3F363790
CHMASK OCT     000777777777                                             3F363800
F      PZE                                                              3F363810
E      PZE                                                              3F363820
D      PZE                                                              3F363830
DG     PZE                                                              3F363850
       EVEN                                                             3F363860
DATUM  BSS     2                                                        3F363870
N      PZE     0                                                     $5$3F363880
N1     PZE     0                                                     $5$3F363890
N2     PZE     0                                                     $5$3F363900
N3     PZE     0                                                     $5$3F363910
ND     BSS     2                                                        3F363920
BLCNT  PZE                           NON-ZERO IF DATA NOT ALL BLANKS.(8)3F363925
LIMIT5 EQU     CHLIMT                                               (14)3F363930
BLANK  BCI     1,00000                                                  3F363950
L(1)   PZE     1                                                        3F363960
BLANKS EQU     JP11                                                  $5$3F363970
DDDFLG PZE     **                    NON-ZERO IF D IN FORMAT SCAN.      3F363980
DDFLAG PZE     **                    NON-ZERO IF CONVERTED RESULT       3F363990
MQD    PZE                                                              3F364000
PEX    PZE                                                              3F364010
EXP    PZE                                                              3F364020
DIG    PZE                                                              3F364030
DEXPON EQU     EC15                                                  $5$3F364040
DB8PW  BSS     1                                                     $5$3F364050
DB871  OCT     043000000000                                          $5$3F364060
DB872  OCT     000066000000                                          $5$3F364070
DBSPP  BOOL    1              SIGN OF PRINCIPAL PART                 $5$3F364080
DBSEP  BOOL    40             SIGN OF EXPONENTIAL PART               $5$3F364090
LNKG   LDIR                                                             3F364120
END94  NULL                                                          $5$3F364130
       END                                                           $5$3F364140
$*     7090/7094 BINARY BUFFER BUILDER AND LIST PROCESSOR               3F4A0000
$IBMAP FIOB                                                             3F4A0010
       TTL     FIOB/BINARY BUFFER PROCESSOR                             3F4A0020
*              BINARY BUFFER PROCESSOR                                  3F4A0030
*              CALLING SEQUENCE IS                                      3F4A0040
*              CALL .FIOB.(ARG)                                         3F4A0050
*                                    NOP = INPUT                        3F4A0060
*              ARG - DECREMENT -     TRA = OUTPUT                       3F4A0070
*              ADDRESS               = LOCATION OF TRANSMISSION         3F4A0080
*                                    ROUTINE                            3F4A0090
*              FIOB INITIALIZES THE LIST PROCESSING                     3F4A0100
*              AND END OF LIST ROUTINES. IT THEN                        3F4A0110
*              ACQUIRES DATA AND SUPERVISES IT'S ACTIVITY               3F4A0120
*              FOR BOTH INPUT AND OUTPUT FUNCTIONS.                     3F4A0130
.FRITE ENTRY   RITE                                                     3F4A0140
.FCNT  ENTRY   CT                                                       3F4A0150
       ENTRY   .FBIBF                                                   3F4A0160
       ENTRY   .FRLR.                                                   3F4A0161
       ENTRY   .FWLR.                                                   3F4A0162
       ENTRY   .FIOB.                                                   3F4A0170
       ENTRY   .FBLT.                                                   3F4A0171
       ENTRY   .FBDT.                                                   3F4A0172
.FIOB. SXA     LNKG,4                                                   3F4A0180
       STD     CHKSZ1                PUT BLOCK                          3F4A0190
       ARS     18                    SIZE IN FIOB                       3F4A0200
       STA     STCT                                                     3F4A0210
       CLA     3,4                   GET TRA,NOP AND I/O RETURN LOCATION3F4A0220
       STA     INOUT+1               WHERE TO GO FOR I/O                3F4A0230
       STD     TST1                  INITIALIZE FOR INPUT               3F4A0240
       STD     TST2                  OR OUTPUT - NOP = INPUT            3F4A0250
       STD     TST3                  TRA = OUTPUT                       3F4A0260
       STD     TST4                                                     3F4A0270
       STD     TST5                                                     3F4A0275
       CLA     4,4                   GET LOC OF CALL FROM OBJ. PROG.    3F4A0280
       STA     LISTB                                                    3F4A0290
       SXA     LISTB+1,1             SAVE INITIAL VALUES OF XR1,XR2     3F4A0291
       SXA     LISTB+2,2             FROM MAIN PROGRAM                  3F4A0293
       LDQ     STOIND                INITIALIZE LIST PROCESSING         3F4A0300
TST1   NOP     *+2                   ROUTINE FOR INPUT                  3F4A0310
       LDQ     CLAIND                OR OUTPUT.                         3F4A0320
       SLQ     IOSW                                                     3F4A0330
       SLQ     FBDT2                                                    3F4A0340
       LDQ     STQIND                                                $5$3F4A0350
TST2   NOP     *+2                                                      3F4A0360
       LDQ     LDQIND                                                   3F4A0370
       SLQ     FBDT4                                                    3F4A0380
       AXT     WRR,4                                                    3F4A0381
TST5   NOP     *+2                                                      3F4A0382
       AXT     RDD,4                                                    3F4A0383
       SXA     RDWR,4                                                   3F4A0384
       AXT     WREC,4                                                   3F4A0390
TST3   NOP     *+2                                                      3F4A0400
       AXT     RDD,4                                                    3F4A0410
       SXA     INOUSW,4                                                 3F4A0420
       SXA     FBDT5,4                                                  3F4A0430
       SXA     FBDT7,4                                                  3F4A0440
TST4   NOP     LISTB-1                                                  3F4A0450
       STZ     ELRFG                                                    3F4A0460
       STZ     ENDLST                                                   3F4A0470
RDWR   TSX     **,2                                                     3F4A0480
LISTB  AXT     **,4                  RETURN TO OBJECT PROGRAM           3F4A0490
       AXT     **,1                                                     3F4A0491
       AXT     **,2                                                     3F4A0493
       TRA     1,4                   TO PROCESS LIST                    3F4A0500
INOUT  SXA     *+2,2                 ALL BINARY TRANSMISSION            3F4A0510
       TSX     **,2                  DONE THRU HERE. TSX POINTS         3F4A0520
       AXT     **,2                  TO IO CONTAINED IN THE             3F4A0530
       TRA     1,2                   INTERFACE ROUTINE.                 3F4A0540
*              BINARY READ ROUTINE. IT READS A RECORD                   3F4A0550
*              AND EXAMINES LABEL FOR RECORD SIZE.                      3F4A0560
RDD    SXA     SVRDD,2                                                  3F4A0570
ELRSW  TRA     *+1                   EXIT IF LIST LONGER THAN RECORD    3F4A0580
       TSX     INOUT,2               READ A RECORD.                     3F4A0590
       AXT     0,2                                                      3F4A0600
       LDI*    .FBIBF                EXAMINE LABEL                      3F4A0610
       RFT     77777                 LABEL IS NON-ZERO, SET END OF      3F4A0620
       TRA     ELR                   LOGICAL RECORD SWITCH.             3F4A0630
CHKSZ  PIA                           ADDRESS ZERO. EXAMINE DECREMENT.   3F4A0640
       AXT     127,4                 IF DECREMENT ZERO, SET PHYSICAL    3F4A0650
       LFT     77777                 RECORD SIZE TO OLD SIZE (127).     3F4A0660
       PDX     0,4                   IF NON ZERO, PICK UP COUNT.        3F4A0670
CHKSZ1 TXL     STCNT,4,**            IF TOO LARGE                       3F4A0680
ERR    CALL    .FXEM.(CODE)          EXIT FOR EXECTION ERROR            3F4A0690
STCT   AXT     **,4                  OPTIONAL RETURN .SET COUNT TO      3F4A0700
STCNT  TXI     *+1,4,1               MAXIMUM SIZE                       3F4A0710
       TXH     *+2,4,2       DID CONTROL WORD COUNT = 1.             (9)3F4A0711
       TXI     *+1,4,1       YES, RECORD IS POSSIBLY FORTRAN II BIN  (9)3F4A0713
       SXA     COUNT,4               SET COUNT.                         3F4A0720
CT     TXI     *+1,4,**              COMPARE COUNT WITH RECORD          3F4A0730
       TXH     ERR1,4,0              SIZE RETURNED FROM IOCS CALL.      3F4A0740
       AXT     -1,4                  SET INDEXING TO OBTAIN             3F4A0750
       SXA     BUFCT,4               BUFFER WORD.                       3F4A0760
SVRDD  AXT     **,2                                                     3F4A0770
       TRA     1,2                                                      3F4A0780
*              ROUTINE TO SET END OF RECORD SWITCH                      3F4A0790
ELR    LXA     ELRSW,1               SAVE CURRENT ADDRESS IN END OF     3F4A0800
       SXA     RSTOR1,1              LOGICAL RECORD SWITCH.             3F4A0810
       AXT     ERR2,1                SET END OF LOGICAL RECORD          3F4A0820
       SXA     ELRSW,1               SWITCH.                            3F4A0830
       STL     ELRFG                 SET END OF LOGICAL RECORD FLAG.    3F4A0840
       LFT     77777                                                    3F4A0850
       TRA     CHKSZ                                                    3F4A0860
       LDC     CT,4                                                  (9)3F4A0870
       TRA     CT-1                                                     3F4A0880
ERR2   CALL    .FXEM.(CODE2)         LIST LONGER THAN LOGICAL RECORD.   3F4A0890
       STL     ENDLST                SET OPTIONAL RETURN FLAG.          3F4A0900
       LXA     IOSW-1,1              OPTIONAL RETURN FROM FXEM.         3F4A0910
       SXA     RSTOR2,1              SET TO ZERO OUT                    3F4A0920
       AXT     IOSW,1                REMAINING LIST ITEMS.              3F4A0930
       SXA     IOSW-1,1                                                 3F4A0940
       LXA     FBDT2-1,1                                                3F4A0950
       SXA     RSTOR3,1                                                 3F4A0960
       AXT     FBDT2,1                                                  3F4A0970
       SXA     FBDT2-1,1                                                3F4A0980
       LXA     FBDT3,1                                                  3F4A0990
       SXA     RSTOR4,1                                                 3F4A1000
       AXT     FBDT4,1                                                  3F4A1010
       SXA     FBDT3,1                                                  3F4A1020
       CLA     ZAC                                                      3F4A1030
       STO     IOSW                                                     3F4A1040
       STO     FBDT2                                                    3F4A1050
       CLA     ZMQ                                                      3F4A1060
       STO     FBDT4                                                    3F4A1070
       TRA     SVRDD                                                    3F4A1080
WREC   SXA     SVWREC,2                                                 3F4A1090
       STO     DATUM                 SAVE CURRENT DATUM.                3F4A1100
       STQ     DATUM+1                                                  3F4A1110
PRC    AXT     1,4                   INCREASE PHYSICAL                  3F4A1120
       TXI     *+1,4,1               RECORD COUNT BY                    3F4A1130
       SXA     PRC,4                 ONE.                               3F4A1140
       TSX     WRR,2                 GO TO WRITE ONE RECORD.            3F4A1150
       CLA     DATUM                 RESTORE CURRENT DATUM.             3F4A1160
       LDQ     DATUM+1                                                  3F4A1170
SVWREC AXT     **,2                                                     3F4A1180
       TRA     1,2                                                      3F4A1190
WRR    SXA     SVWRR,2                                                  3F4A1200
       TSX     INOUT,2               TRANSMIT A LINE                    3F4A1210
       AXT     0,2                                                      3F4A1220
       XEC     STCT                  AXT   **,4 PLACE RECORD LENGTH     3F4A1230
       PXD     0,4                   IN INTERNAL LABEL.                 3F4A1240
       STO*    .FBIBF                                                   3F4A1250
       TXI     *+1,4,1               SET COUNT.                         3F4A1260
       SXA     COUNT,4                                                  3F4A1270
       SXD     RITE,4                SET WORD COUNT FOR I/O COMMAND     3F4A1280
       AXT     -1,4                  CALLING SEQUENCE. SET INDEXING     3F4A1290
       SXA     BUFCT,4               FOR OUTPUT BUFFER.                 3F4A1300
SVWRR  AXT     **,2                                                     3F4A1310
       TRA     1,2                                                      3F4A1320
       REM  LIST PROCESSING FOR SINGLE-PRECISION BINARY DATA            3F4A1330
.FBLT. SXA     LXIT1,1                                                  3F4A1340
       SXA     LXIT2,2                                                  3F4A1350
       SXA     LEXIT,4                                                  3F4A1360
BUFCT  AXT     **,2                                                     3F4A1370
COUNT  AXT     **,4                                                     3F4A1380
       TNX     INOUSW,4,1            TRANSFER IF BUFFER EXHAUSTED.      3F4A1390
IOSW   CLA*    .FBIBF                CHANGED TO STO* FOR OUTPUT.        3F4A1400
       TXI     *+1,2,-1                                                 3F4A1410
       SXA     BUFCT,2                                                  3F4A1420
       SXA     COUNT,4                                                  3F4A1430
LXIT1  AXT     **,1                                                     3F4A1440
LXIT2  AXT     **,2                                                     3F4A1450
LEXIT  AXT     **,4                                                     3F4A1460
       TRA     1,4                                                      3F4A1470
INOUSW TSX     **,2                  SET TO RDD FOR INPUT, WREC FOR     3F4A1480
       TRA     BUFCT                 OUTPUT.                            3F4A1490
       REM  LIST PROCESSING FOR DOUBLE-PRECISION BINARY DATA            3F4A1500
.FBDT. SXA     LXIT1,1                                                  3F4A1510
       SXA     LXIT2,2                                                  3F4A1520
       SXA     LEXIT,4                                                  3F4A1530
FBDT1  LXA     BUFCT,2                                                  3F4A1540
       LXA     COUNT,4                                                  3F4A1550
       TNX     FBDT5,4,1             TRANSFER IF BUFFER EXHAUSTED.      3F4A1560
FBDT2  CLA*    .FBIBF                CHANGED TO STO* FOR OUTPUT         3F4A1570
       TXI     *+1,2,-1                                                 3F4A1580
FBDT3  TNX     FBDT6,4,1             TRANSFER IF BUFFER EXHAUSTED.      3F4A1590
FBDT4  LDQ*    .FBIBF                CHANGED TO STQ* FOR OUTPUT.        3F4A1600
       TXI     *+1,2,-1                                                 3F4A1610
       TRA     LXIT1-2                                                  3F4A1620
FBDT5  TSX     **,2                                                     3F4A1630
       TRA     FBDT1                                                    3F4A1640
FBDT6  STO     DATUM+3                                                  3F4A1650
FBDT7  TSX     **,2                  SET TO RDD FOR INPUT, WREC         3F4A1660
       LXA     BUFCT,2               FOR OUTPUT.                        3F4A1670
       LXA     COUNT,4                                                  3F4A1680
       CLA     DATUM+3                                                  3F4A1690
       TRA     FBDT3                                                    3F4A1700
       REM  ENTRY FROM MAIN PROGRAM FOR END-OF-LIST INPUT.              3F4A1710
.FRLR. SAVE    (2)I                                                     3F4A1720
       NZT     ENDLST                WAS OPTIONAL ERR2 EXIT TAKEN.      3F4A1730
       TRA     ELRTST                NO.                                3F4A1740
       STZ     ENDLST                YES. RESET FLAG.                   3F4A1750
RSTOR2 AXT     **,2                  RESTORE EXITS                      3F4A1760
       SXA     IOSW-1,2              WHICH HAVE BEEN                    3F4A1770
RSTOR3 AXT     **,2                  RESET IN PROCESS                   3F4A1780
       SXA     FBDT2-1,2             OF SETTING LIST ITEMS              3F4A1790
RSTOR4 AXT     **,2                  TO ZERO FOR THE CASE               3F4A1800
       SXA     FBDT3,2               OF LIST LONGER THAN                3F4A1810
       AXT     .FBIBF,2              LOGICAL RECORD                     3F4A1820
       SXA     IOSW,2                                                   3F4A1830
       SXA     FBDT2,2                                                  3F4A1840
       SXA     FBDT4,2                                                  3F4A1850
ELRTST ZET     ELRFG                 HAS END OF LOGICAL RECORD BEEN READ3F4A1860
       TRA     RLR1                  YES.                               3F4A1870
RDLGR  TSX     INOUT,2               NO.KEEP READING                    3F4A1880
       AXT     0,2                   PHYSICAL RECORDS                   3F4A1890
       LDI*    .FBIBF                UNTIL LAST RECORD                  3F4A1900
       RFT     77777                 HAS BEEN READ.                     3F4A1910
       TRA     REXIT                                                    3F4A1920
       TRA     RDLGR                                                    3F4A1930
RLR1   STZ     ELRFG                 RESET END OF LOGICAL RECORD FLAG.  3F4A1940
RSTOR1 AXT     **,2                  RESET END OF LOGICAL               3F4A1950
       SXA     ELRSW,2               RECORD SWITCH.                     3F4A1960
REXIT  RETURN  .FRLR.                                                   3F4A1970
       REM  ENTRY FROM MAIN PROGRAM FOR END-OF-LIST OUTPUT.             3F4A1980
.FWLR. SAVE    (2)                                                      3F4A1990
       LAC     BUFCT,4               COMPUTE WORD COUNT FOR LAST RECORD.3F4A2000
       TXL     FIXCT,4,2             ADJUST WORD COUNT FOR SHORT RECORD.3F4A2010
FWLR1  SXD     RITE,4                SET APPROPRIATE                    3F4A2020
       TXI     *+1,4,-1              WORD COUNT IN IOCS                 3F4A2030
       PXD     0,4                   CALLING SEQUENCE AND PREPARE       3F4A2040
       STO     DATUM                 TO SET IN INTERNAL LABEL.          3F4A2050
       LXA     PRC,4                 GET PHYSICAL RECORD COUNT AND      3F4A2060
       SXA     DATUM,4               PREPARE TO SET IN                  3F4A2070
       AXT     0,2                   INTERNAL LABEL.                    3F4A2080
       CLA     DATUM                                                    3F4A2090
       STO*    .FBIBF                                                   3F4A2100
       TSX     INOUT,2               WRITE LAST RECORD.                 3F4A2110
       AXT     1,2                   RESET PHYSICAL RECORD              3F4A2120
       SXA     PRC,2                 COUNT TO ONE.                      3F4A2130
       AXT     0,2                   RESET WORD COUNT IN                3F4A2140
       SXD     RITE,2                IOCS CALLING SEQUENCE TO ZERO.     3F4A2150
       RETURN  .FWLR.                                                   3F4A2160
FIXCT  AXT     3,4                   MAKE WORD COUNT                    3F4A2170
       TRA     FWLR1                 AT LEAST THREE.                    3F4A2180
CLAIND CLA*    **                                                       3F4A2190
LDQIND LDQ*    **                                                       3F4A2200
STOIND STO*    **                                                       3F4A2210
STQIND STQ*    **                                                       3F4A2220
FILEBK PZE     **                    LOCATION OF FILE CONTROL BLOCK.    3F4A2230
.FBIBF PZE     **,2                  LOCATION OF BINARY BUFFER,2        3F4A2240
ERR1   CALL    .FXEM.(CODE1)         INTERNAL LABEL WORD COUNT DOES NOT 3F4A2250
       TRA     CT+2                  AGREE WITH IOCS WORD COUNT.        3F4A2260
       REM                           OPTIONAL RETURN FROM FXEM IS       3F4A2270
       REM                           PROCESS RECORD READ.               3F4A2280
CODE   PZE     38                                                       3F4A2300
ER38MS PZE     E38MES,,7                                                3F4A2310
ER38OP PZE     E38OMS,,6                                                3F4A2320
E38MES BCI     7,0PHYSICAL RECORD SIZE EXCEEDS BUFFER SIZE              3F4A2330
E38OMS BCI     6,0PROCESS PORTION OF RECORD IN BUFFER                   3F4A2340
CODE1  PZE     39                                                       3F4A2350
ER39MS PZE     E39MES,,10                                               3F4A2360
ER39OP PZE     E39OMS,,4                                                3F4A2370
E39MES BCI ,0INTERNAL LABEL WORD COUNT DOES NOT MATCH IOCS WORD COUNT   3F4A2380
E39OMS BCI     4,0PROCESS RECORD READ                                   3F4A2390
CODE2  PZE     40                                                       3F4A2400
ER40MS PZE     E40MES,,6                                                3F4A2410
ER40OP PZE     E40OMS,,6                                                3F4A2420
E40MES BCI     6,0LIST EXCEEDS LOGICAL RECORD LENGTH                    3F4A2430
E40OMS BCI     6,0STORE ZEROS IN REMAINING LIST ITEMS                   3F4A2440
ELRFG  PZE     **                    NON-ZERO IF LOGICAL RECORD READ.   3F4A2450
ENDLST PZE     **                    NON-ZERO IF END LIST OPTION TAKEN. 3F4A2460
ZAC    ZAC                                                              3F4A2470
ZMQ    LDQ     SYSZRO                                                (9)3F4A2480
RITE   PZE                                                              3F4A2500
DATUM  BSS     3                                                        3F4A2510
LNKG   LDIR                                                             3F4A2520
       END                                                              3F4A2540
$*     7090/7094 INPUT/OUTPUT SUPERVISOR                                3F4B0000
$IBMAP FIOS                                                             3F4B0010
       TTL     FIOS-I/O SUPERVISOR                                   (7)3F4B0020
*      I/O SUPERVISOR                                                   3F4B0030
*              THE PURPOSE OF FIOS IS TO INITIALIZE                     3F4B0040
*              ALL IOCS CALLING SEQUENCES FOR BCD                       3F4B0050
*              AND BINARY READING AND WRITING. IT ALSO                  3F4B0060
*              PROCESS THE ARGUMENTS OBTAINED FROM                      3F4B0070
*              THE OBJECT PROGRAM I/O CALLING SEQUENCE                  3F4B0080
*              FIOS PRESUPPOSES THE SETTING OF READ-                    3F4B0090
*              WRITE, BINARY-BCD SWITCHES                               3F4B0100
*              .REED=0, WRITE = NOT ZERO, READ                          3F4B0110
*              .BIN=0, BCD = NOT ZERO, BINARY                           3F4B0120
*                                                                       3F4B0130
.FCKSZ ENTRY   .CHKSZ                                                   3F4B0140
       ENTRY   .REED                                                    3F4B0150
       ENTRY   .BIN                                                     3F4B0160
.FCT   ENTRY   .CT                                                      3F4B0170
       ENTRY   .FIOS.                                                $5$3F4B0180
       ENTRY   .FRTD.                                                $5$3F4B0190
       ENTRY   .FRTB.                                                $5$3F4B0200
       ENTRY   REOF                                                  $5$3F4B0210
       ENTRY   .FOPN                                                 $5$3F4B0220
       ENTRY   .FILL.                                                $5$3F4B0230
       ENTRY   .FILR.                                                $5$3F4B0240
       ENTRY   .FCLS                                                 $5$3F4B0250
       ENTRY   .TOUT.                                                $5$3F4B0260
       ENTRY   .FSEL.                                                $5$3F4B0270
.FIOS. SXA     RETURN,4                                                 3F4B0280
       SXA     LNKG,4                LINKAGE DIRECTOR                   3F4B0290
       CLA     3,4                   GET ARGS FOR READ AND BIN SWITCHES 3F4B0300
       STA     .REED                                                    3F4B0310
       STD     .BIN                                                     3F4B0320
       CLA     4,4                   GET I/O COMMAND                    3F4B0330
       STO     .FILL.                STORE IN IOCS CALL                 3F4B0340
       STO     .FILR.                                                   3F4B0350
       STI     SAVIND                SAVE INDICATORS                    3F4B0360
       LXA     SYSLOC,4              GET LICATION OF CALL FROM          3F4B0370
       CLA*    3,4                   OBJ. PORG. TO LOCATE FCB           3F4B0380
       STA     FILEBK                SAVE LOC. OF FCB                   3F4B0390
       STA     .FCLS+2               SET FILE DESIGNATION               3F4B0400
       STA     .FOPN+2               IN IOCS CALLING SEQUENCES.         3F4B0410
       STA     .FSEL.+2                                                 3F4B0420
       STA     .FRTD.+2                                                 3F4B0430
       NZT     .BIN                                                     3F4B0440
       TRA     INITRW                IF BCD, TEST FOR SYSOU1            3F4B0450
       STA     .FRTB.+2              IF BINARY,SET UP BINARY            3F4B0460
       ADD     =4                    CALLING SEQUENCES.GET ADDRESS      3F4B0470
       STA     *+1                   OF FIFTH WORD IN FILE CONTROL      3F4B0480
       LDC     **,4                  BLOCK.LOCATION OF BUFFER POOL      3F4B0490
       CLA     1,4                   SECOND BUFFER POOL CONTROL WORD.   3F4B0500
       ARS     22                    PLACE BLOCK SIZE IN ADDRESS.       3F4B0510
       PAX     ,4                                                       3F4B0520
       SXD     .FILL.,4              INITIALIZE FOR BLOCK SIZE          3F4B0530
       TXI     *+1,4,-1              AND SAVE FOR PURPOSE OF            3F4B0540
       SXD     .CHKSZ,4              TESTING SIZE OF BINARY             3F4B0550
INITRW LAC     SYSUNI,4                                                 3F4B0560
       CLA     SYSOU1,4              CHECK TO SEE IF                    3F4B0570
       PAX     0,4                   THIS WRITE                         3F4B0580
       SXD     CHECK3,4              REQUEST IS FOR SYSOU1              3F4B0590
       CLA*    FILEBK                                                   3F4B0600
       PAC     0,4                                                      3F4B0610
CHECK3 TXI     *+1,4,**                                                 3F4B0620
       TXH     CONT,4,0                                                 3F4B0630
       ZET     .REED                 TEST OPERATION REQUESTED           3F4B0640
       TRA     FERR1                 ERROR-CANNOT READ SYSOU1.          3F4B0650
       ZET     .BIN                                                  $5$3F4B0660
       TRA     CONT                   READ BINARY                    $5$3F4B0670
       LXA     .TOUT.,4       IS FOUT IN CORE                        $5$3F4B0680
       TXL     CONT,4,0       NO, GO USE .WRITE.                     $5$3F4B0690
       AXT     .TOUT.,4          SET UP TO USE .FOUT.                $5$3F4B0700
       SXA     .FRTD.+1,4        TO WRITE ON SYSOU1                  $5$3F4B0710
RETURN AXT     **,4                                                     3F4B0720
       LDI     SAVIND                RESTORE INDICATORS                 3F4B0730
       TRA     1,4                   RETURN TO INTERFACE ROUTINE        3F4B0740
CONT   AXT     .WRITE,4          OVERLAY TSX TO FOUT                 $5$3F4B0750
       SXA     .FRTD.+1,4        WRITE OTHER TAPES WITHOUT FOUT      $5$3F4B0760
       LXA     FILEBK,4              OBTAIN FCB WORD 2.                 3F4B0770
       TXI     *+1,4,1               AND SAVE                           3F4B0780
       SXA     GFCB2,4                                                  3F4B0790
       TXI     *+1,4,1               OBTAIN FCB WORD 3                  3F4B0800
       SXA     GFCB3,4               AND SAVE                           3F4B0810
GFCB3  LDI     **                    LOAD IND. WITH FCB WORD 3          3F4B0820
       STZ     MCB                   MCB OFF = OTHER UNIT               3F4B0830
       LFT     100000                                                $5$3F4B0840
       STL     MCB                   MCB ON = SYSIN1                    3F4B0850
GFCB2  LDI     **                    GET FCB WORD 2                     3F4B0860
       STL     PRACT                 PRACT ON = INPUT                   3F4B0870
       LFT     003000                                                   3F4B0880
       STZ     PRACT                 PRACT OFF = NOT INPUT              3F4B0890
       STZ     FSTAT                 FSTAT OFF = CLOSED FILE            3F4B0900
       LFT     040000                                                   3F4B0910
       STL     FSTAT                 FSTAT ON = OPEN FILE               3F4B0920
       NZT     .REED                                                    3F4B0930
       TRA     WRTST                 WRITING - GO INITIALIZE IT         3F4B0940
       ZET     PRACT                 READING - TEST FOR INPUT           3F4B0950
       TRA     THRO                  INPUT-                             3F4B0960
       ZET     FSTAT                 NOT INPUT-                         3F4B0970
       TSX     .FCLS,4        FILE OPEN, SO CLOSE IT                 $5$3F4B0980
       LDI*    GFCB2                                                 (7)3F4B0981
       RIL     003000                SET FCB FOR INPUT                  3F4B0990
       STI*    GFCB2                                                    3F4B1000
       TRA     *+2                                                      3F4B1010
THRO   NZT     FSTAT                                                    3F4B1020
       TSX     .FOPN,4               OPEN FILE                          3F4B1030
       AXT     REOF,4            PLACE EOF RETURN FOR OTHER UNITS    $5$3F4B1040
       ZET     MCB                                                      3F4B1050
       AXT     SYSEOF,4          PLACE EOF RETURN FOR SYSIN1         $5$3F4B1060
       SXA     .FSEL.+3,4                                               3F4B1070
       TRA     RETURN                                                   3F4B1080
WRTST  ZET     MCB                    IS IT SYSIN1                   $5$3F4B1090
       TRA     FERR                   SORRY CAN'T WRITE              $5$3F4B1100
CONT1  ZET     PRACT                                                    3F4B1110
       TRA     TST3                  INPUT                              3F4B1120
       NZT     FSTAT                 NOT INPUT-IS FILE OPEN             3F4B1130
OPN1   TSX     .FOPN,4               NO-OPEN FILE                       3F4B1140
       TRA     RETURN                YES                                3F4B1150
TST3   ZET     FSTAT                 INPUT-IS FILE OPEN                 3F4B1160
       TSX     .FCLS,4               YES-CLOSE FILE                     3F4B1170
       LDI*    GFCB2                                                 $5$3F4B1180
       SIL     001000                SET FCB BITS                       3F4B1190
       RIL     002000                FOR OUTPUT                         3F4B1200
       STI*    GFCB2                                                    3F4B1210
       TRA     OPN1                                                  $5$3F4B1220
.FSEL. SXA     RETIRN,4                                              $5$3F4B1230
       TSX     .READ,4                                                  3F4B1240
       PZE     **,,REOB                                                 3F4B1250
       PZE     **,,RERR                                                 3F4B1260
.FILR. IORTN*  **,,**                                                   3F4B1270
       NZT     .BIN                  CHECK MODE                         3F4B1280
       TRA     RETIRN         BCD-RETURN                             $5$3F4B1290
       LDC     *-3,4                 BINARY-SAVE                        3F4B1300
       SXD     .FCT,4                WORD COUNT                         3F4B1310
RETIRN AXT     **,4                                                  $5$3F4B1320
       TRA     1,4                                                      3F4B1330
*      BCD AND BINARY IOCS WRITE CALLING SEQUENCE                       3F4B1340
.FRTB. XEC     .FSEL.                                                   3F4B1350
       TSX     .WRITE,4              WRITE A RECORD-IF BINARY           3F4B1360
       PZE     **,,0                                                    3F4B1370
       IOCDN   **,,0                                                    3F4B1380
       TRA     *+2                                                      3F4B1390
.FRTD. XEC     .FSEL.                IF BINARY-LOCATE A BUFFER          3F4B1400
       TSX     .WRITE,4              IF BCD-WRITE A LINE                3F4B1410
       PZE     **,,WEOB                                                 3F4B1420
.FILL. IOCD    **,,**                                                   3F4B1430
       TRA     RETIRN         OR BCD                                 $5$3F4B1440
*      CLOSE A FILE                                                     3F4B1450
.FCLS  XEC     .FSEL.                                                   3F4B1460
       TSX     .CLOSE,4                                                 3F4B1470
       MON     **                                                       3F4B1480
       TRA     RETIRN                                                $5$3F4B1490
*      OPEN A FILE                                                      3F4B1500
.FOPN  XEC     .FSEL.                                                   3F4B1510
       TSX     .OPEN,4                                                  3F4B1520
       MON     **                                                       3F4B1530
       TRA     RETIRN                                                $5$3F4B1540
REOF   AXT     34,4                ASSUME FILE IS BCD                $5$3F4B1550
       ZET     .BIN                IS FILE ACTUALLY BINARY           $5$3F4B1560
       AXT     41,4                YES,CHANGE XR4 ACCORDINGLY        $5$3F4B1570
       SXA     CODE3,4                                               $5$3F4B1580
       TSX     FILENM,4                                              $5$3F4B1590
       STO     E41MES+5                                                 3F4B1600
       STQ     E41MES+6                                                 3F4B1610
REOFXT CALL    .FXEM.(CODE3)         EOF READING. EXECUTION ERROR.      3F4B1620
       TRA     .FSEL.+1              OPTIONAL EXIT. READ NEXT FILE   $5$3F4B1630
RERR   AXT     35,4              ASSUME FILE IS BCD                  $5$3F4B1640
       ZET     .BIN              IS FILE ACTUALLY BINARY             $5$3F4B1650
       AXT     42,4              YES, CHANGE XR4 ACCORDINGLY         $5$3F4B1660
       SXA     CODE4,4                                               $5$3F4B1670
       TSX     FILENM,4                                              $5$3F4B1680
       STO     E42MES+5                                                 3F4B1690
       STQ     E42MES+6                                                 3F4B1700
RERRXT CALL    .FXEM.(CODE4)         REDUNDANCY READING.                3F4B1710
       TRA     .FSEL.+1                                              $5$3F4B1720
REOB   TSX     FILENM,4                                                 3F4B1730
       STO     E43MES+5                                                 3F4B1740
       STQ     E43MES+6                                                 3F4B1750
REOBXT CALL    .FXEM.(CODE5)         EOB EXIT READING.                  3F4B1760
       TRA     .LXERR                NO OPTIONAL EXIT.                  3F4B1770
WEOB   TSX     FILENM,4                                                 3F4B1780
       STO     E44MES+5                                                 3F4B1790
       STQ     E44MES+6                                                 3F4B1800
WEOBXT CALL    .FXEM.(CODE6)         EOB EXIT WRITING.                  3F4B1810
       TRA     .LXERR                NO OPTIONAL EXIT.                  3F4B1820
FILENM SXA     FILEN,4                                                  3F4B1830
       LAC     .FCLS+2,4                                                3F4B1840
       CAL     10,4                                                     3F4B1850
       ARS     12                                                       3F4B1860
       LDQ     BLANKS                                                   3F4B1870
       LGR     24                                                       3F4B1880
       CLA     9,4                                                      3F4B1890
FILEN  AXT     **,4                                                     3F4B1900
       TRA     1,4                                                      3F4B1910
CODE3  PZE     **                                                    $5$3F4B1920
ER41MS PZE     E41MES,,7                                                3F4B1930
ER41OP PZE     E41OMS,,3                                                3F4B1940
E41MES BCI     7,0END OF FILE READING                                   3F4B1950
E41OMS BCI     3,0READ NEXT FILE                                        3F4B1960
CODE4  PZE     **                                                    $5$3F4B1970
ER42MS PZE     E42MES,,7                                                3F4B1980
ER42OP PZE     E42OMS,,6                                                3F4B1990
E42MES BCI     7,0PERMANENT READ REDUNDANCY                             3F4B2000
E42OMS BCI     6,0RECORD USED AS READ THE 100TH TIME                    3F4B2010
CODE5  PZE     43                                                       3F4B2020
ER43MS PZE     E43MES,,7                                                3F4B2030
ER43OP PZE     NOOPXT,,7                                                3F4B2040
E43MES BCI     7,0END-OF-BUFFER EXIT READING                            3F4B2050
CODE6  PZE     44                                                       3F4B2060
ER44MS PZE     E44MES,,7                                                3F4B2070
ER44OP PZE     NOOPXT,,7                                                3F4B2080
E44MES BCI     7,0END-OF-BUFFER EXIT WRITING                            3F4B2090
BLANKS BCI     1,                                                       3F4B2100
.TOUT. BSS     4                                                     $5$3F4B2110
       TRA     RETIRN                                                $5$3F4B2120
SAVIND PZE                           SAVE INDICATORS                    3F4B2130
.REED  PZE                           .REED ON = READ, .REED OFF = WRITE 3F4B2140
.BIN   PZE                           .BIN ON = BINARY, .BIN OFF = BCD   3F4B2150
.CT    PZE                           CONTAINS INPUT RECORD SIZE         3F4B2160
FILEBK PZE     **                    LOCATION OF FILE CONTROL BLOCK     3F4B2170
.CHKSZ PZE                           BLOCK SIZE FOUND IN BUFFER POOL    3F4B2180
MCB    PZE                           ON = SYSIN1, OFF = OTHER UNIT      3F4B2190
FSTAT  PZE                           ON = OPEN FILE, OFF = CLOSE D FILE 3F4B2200
PRACT  PZE                           ON = INPUT, OFF = NOT INPUT        3F4B2210
FERR   CALL    .FXEM.(CODE7)         WRITE REQUEST ON SYSIN1. EXECUTION 3F4B2220
       TRA     .LXERR                NO OPTIONAL EXIT.                  3F4B2230
FERR1  CALL    .FXEM.(CODE8)         READ REQUEST ON SYSOU1. EXECUTION  3F4B2240
       TRA     .LXERR                ERROR. NO OPTIONAL EXIT.           3F4B2250
SYSEOF CALL    EXIT                                                     3F4B2260
CODE7  PZE     54                                                       3F4B2270
ER54MS PZE     E54MES,,8                                                3F4B2280
ER54OP PZE     NOOPXT,,7                                                3F4B2290
E54MES BCI     8,0WRITE REQUEST ON UNIT DEFINED AS SYSIN1 ILLEGAL       3F4B2300
CODE8  PZE     56                                                       3F4B2310
ER56MS PZE     E56MES,,8                                                3F4B2320
ER56OP PZE     NOOPXT,,7                                                3F4B2330
E56MES BCI     8,0READ REQUEST ON UNIT DEFINED AS SYSOU1 ILLEGAL        3F4B2340
NOOPXT BCI     7,0NO OPTIONAL EXIT-EXECUTION TERMINATED.             $5$3F4B2350
LNKG   LDIR                                                             3F4B2360
       BCI     1,FIOS                                                   3F4B2370
       END                                                           $5$3F4B2380
$*     7090/7094 BCD FORMAT SCANNER AND BUFFER BUILDING ROUTINE         3F4C0000
$IBMAP FIOH    300,()OK                                              (8)3F4C0001
       TTL     FIOH - FORMAT SCANNER                                (14)3F4C0002
CHLIMT EQU     133                 LINE LIMIT IN CHARACTERS          (8)3F4C0011
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90 ,         $5$3F4C0012
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94 .        $5$3F4C0013
*                   (OR TO ANY VALUE NOT EQUAL TO 90.)               $5$3F4C0014
M9094  SET     90                                                    $5$3F4C0015
       PCC     ON                                                    $5$3F4C0016
       IFF     M9094=90                                              $5$3F4C0017
       GOTO    BEG94                                                 $5$3F4C0018
       PCC     OFF                                                   $5$3F4C0019
       REM  FORMAT SCAN.                                                3F4C0030
*              FORMAT SCANNER                                           3F4C0040
*              CALLING SEQUENCE IS                                      3F4C0050
*              CALL .FIOH.(ARG)                                         3F4C0060
*              ARG= DECREMENT IS NOP FOR INPUT,TRA FOR OUTPUT           3F4C0070
*                   ADDRES IS LOCATION OF IO CALLING SEQUENCE           3F4C0080
*                                                                       3F4C0090
*                                                                       3F4C0100
       ENTRY   .FFIL.                                                   3F4C0110
       ENTRY   .FRTN.                                                   3F4C0120
       ENTRY   .FIOH.                                                   3F4C0130
TRA    EQU     FSET1+1                                                  3F4C0140
ANPT   EQU     .ANPT                                                    3F4C0150
AOUT   EQU     .AOUT                                                    3F4C0160
CHAR   EQU     .CHAR                                                    3F4C0170
CNVSW  EQU     .CNVSW                                                   3F4C0180
COUNT  EQU     .KOUNT                                                   3F4C0190
D1     EQU     .D1                                                      3F4C0200
D2     EQU     .D2                                                      3F4C0210
DBC10  EQU     .DBC10                                                   3F4C0220
DBC20  EQU     .DBC20                                                   3F4C0230
DBC    EQU     .DBC                                                     3F4C0240
DDBC   EQU     .DDBC                                                    3F4C0250
DDDFLG EQU     .DDDFL                                                   3F4C0260
DDFIX  EQU     .DDFIX                                                   3F4C0270
DDFLAG EQU     .DDFLG                                                   3F4C0280
DDRST1 EQU     .DDRS1                                                   3F4C0290
DDSW   EQU     .DDSW                                                    3F4C0300
DEXPON EQU     .DEXPN                                                   3F4C0310
DFLT   EQU     .DFLT                                                    3F4C0320
DIG    EQU     .DIG                                                     3F4C0330
DONE   EQU     .DONE                                                    3F4C0340
ENDFSW EQU     .ENDFS                                                   3F4C0350
FIXSW  EQU     .FIXSW                                                   3F4C0360
FLT    EQU     .FLT                                                     3F4C0370
FXD    EQU     .FXD                                                     3F4C0380
FXFL1  EQU     .FXFL1                                                   3F4C0390
FXFL2  EQU     .FXFL2                                                   3F4C0400
FXFL3  EQU     .FXFL3                                                   3F4C0410
INTG   EQU     .INTG                                                    3F4C0420
LNTP   EQU     .LNTP                                                    3F4C0430
LOUT   EQU     .LOUT                                                    3F4C0440
MQD    EQU     .MQD                                                     3F4C0450
ONPT   EQU     .ONPT                                                    3F4C0460
OOUT   EQU     .OOUT                                                    3F4C0470
OUTBUF EQU     .OUTBF                                                   3F4C0480
PEX    EQU     .PEX                                                     3F4C0490
TEST   EQU     .TEST                                                    3F4C0500
TOPACK EQU     .TOPAC                                                   3F4C0510
WIDTH  EQU     .WIDTH                                                   3F4C0520
.FIOH. SXA     LNKG,4                                                   3F4C0530
       SXA     SYSLOC,4                                                 3F4C0540
       SXA     SV1,1                 SAVE XR1 AND XR2 FROM              3F4C0550
       SXA     SV2,2                 ORIGINAL CALL FROM MAIN PROGRAM    3F4C0560
       CLA     4,4                   GET RETURN FROM MAIN CALL AND      3F4C0570
       STA     LIST                  SAVE.STORE ADDRESS OF BUFFER       3F4C0580
       STD     ARG2                  IF FRCD CALL                       3F4C0590
       CLA     3,4                   GET TRA,NOP AND I/O RETURN         3F4C0600
       STT     ONLIN                 SET ONLINE OPERATION SWITCH        3F4C0610
       STA     INOUT                 SAVE RETURN TO TRANSMIT LINE       3F4C0620
       STA     FSTLN                                                    3F4C0630
       STD     CCOCTL                SET INPUT/OUTPUT SWITCHES          3F4C0640
       STD     CCINTG                NOP FOR INPUT                      3F4C0650
       STD     CCHOLL+1              TRA FOR OUTPUT                     3F4C0660
       STD     INOUTS+1                                                 3F4C0670
       STD     INOUT+1                                                  3F4C0680
       STD     CCFFXD+2                                                 3F4C0690
       STD     CCEFLT                                                   3F4C0700
       STD     CCDFLT+3                                                 3F4C0710
       STD     SKIP                                                     3F4C0720
       STD     CCALPH                                                   3F4C0730
       STD     CCLOGC                                                   3F4C0740
       STD     TST1                                                     3F4C0750
       AXT     OVER,2                                                   3F4C0760
       AXT     RESCAN,1                                                 3F4C0770
       CALL    .FCON.(ARG1,ARG2)                                        3F4C0780
       ORG     *-2                                                      3F4C0790
ARG1   PZE     DCPT,,CCDCPT                                             3F4C0800
ARG2   PZE     STOP,,**                                                 3F4C0810
       TSX     RESET,2               RESET BUFFER FOR OUTPUT            3F4C0820
       CLA     FSET1+1                                                  3F4C0830
       STD     EXITSW                SET EXIT SWITCH                    3F4C0840
       STZ     DIVRT                 RESET SWITCH,RETURN THRU FCNV      3F4C0850
       STZ     INT                                                      3F4C0860
       SXA     ENDX,0                                                   3F4C0870
       LXA     LIST,4                LOCATE CALL IN MAIN PROGRAM        3F4C0880
       ZET     ONLIN                 IS THIS ONLINE OPERATION           3F4C0890
       TXI     *+1,4,1               YES-BUMP POINTER TO GET FORMAT LOC 3F4C0900
       CLA     4,4                   PICK UP LOCATION OF FORMAT         3F4C0910
       STA     STPNT                 SET FORMAT POINTER                 3F4C0920
       STA     FMTLOC                                                   3F4C0930
TST1   NOP     *+2                                                      3F4C0940
FSTLN  TSX     **,2                  IF INPUT, GET FIRST LINE           3F4C0950
STPNT  AXC     **,2                                                     3F4C0960
SCAN1  LDQ     0,2                   EXAMINE                            3F4C0970
       AXT     36,1                  NEXT                               3F4C0980
SCAN2  PXD     ,0                    FORMAT                             3F4C0990
       LGL     6                     CHARACTER,                         3F4C1000
       PAX     ,4                    AND                                3F4C1010
SCAN3  XEC     FRMTR,4             * TAKE INDICATED TRANSFER.           3F4C1020
       ADM     INT                   CONTROL COMES HERE ON ANY DIGIT.   3F4C1030
       LGL     3                     MULTIPLY PREVIOUS INT BY 10,       3F4C1040
       ADM     INT                   AND ADD IN                         3F4C1050
       ACL     INT                   CURRENT DIGIT.                     3F4C1060
SCAN4  SLW     INT                   SET INT.                           3F4C1070
       REM  ENTRY FROM CCRPAR, CCDCPT.                                  3F4C1080
SCAN5  TIX     SCAN2,1,6           * IF CHARACTER COUNT IS EXHAUSTED,   3F4C1090
FSET1  TXI     SCAN1,2,-1            EXAMINE NEXT FORMAT WORD.          3F4C1100
       REM  FORMAT TRANSFER TABLE.                                      3F4C1110
       TRA     STOP                  77                                 3F4C1120
       TRA     STOP                  76                                 3F4C1130
       TRA     STOP                  75                                 3F4C1140
       TRA     CCLPAR                74                                 3F4C1150
       TRA     CCCMMA                73                                 3F4C1160
       TRA     STOP                  72                                 3F4C1170
       TRA     STOP                  71                                 3F4C1180
       TRA     STOP                  70                                 3F4C1190
       TRA     CCBLNK                67                                 3F4C1200
       TRA     STOP                  66                                 3F4C1210
       TRA     STOP                  65                                 3F4C1220
       TRA     STOP                  64                                 3F4C1230
       TRA     STOP                  63                                 3F4C1240
       TRA     STOP                  62                                 3F4C1250
       TRA     CCSLSH                61                                 3F4C1260
       TRA     SCAN5                 60                                 3F4C1270
       TRA     STOP                  57                                 3F4C1280
       TRA     STOP                  56                                 3F4C1290
       TRA     STOP                  55                                 3F4C1300
       TRA     STOP                  54                                 3F4C1310
       TRA     STOP                  53                                 3F4C1320
       TRA     STOP                  52                                 3F4C1330
       TRA     STOP                  51                                 3F4C1340
       TRA     STOP                  50                                 3F4C1350
       TRA     CCSCFP                47                                 3F4C1360
       TRA     CCOCTL                46                                 3F4C1370
       TRA     STOP                  45                                 3F4C1380
       TRA     STOP                  44                                 3F4C1390
       TRA     CCLOGC                                                   3F4C1400
       TRA     STOP                  42                                 3F4C1410
       TRA     STOP                  41                                 3F4C1420
       TRA     CCSCFM                40                                 3F4C1430
       TRA     STOP                  37                                 3F4C1440
       TRA     STOP                  36                                 3F4C1450
       TRA     STOP                  35                                 3F4C1460
       TRA     CCRPAR                34                                 3F4C1470
       TRA     CCDCPT                33                                 3F4C1480
       TRA     STOP                  32                                 3F4C1490
       TRA     CCINTG                31                                 3F4C1500
       TRA     CCHOLL                30                                 3F4C1510
       TRA     STOP                  27                                 3F4C1520
       TRA     CCFFXD                26                                 3F4C1530
       TRA     CCEFLT                25                                 3F4C1540
       TRA     CCDFLT                24                                 3F4C1550
       TRA     STOP                  23                                 3F4C1560
       TRA     STOP                  22                                 3F4C1570
       TRA     CCALPH                21                                 3F4C1580
       TRA     STOP                  20                                 3F4C1590
       TRA     STOP                  17                                 3F4C1600
       TRA     STOP                  16                                 3F4C1610
       TRA     STOP                  15                                 3F4C1620
       TRA     STOP                  14                                 3F4C1630
       TRA     STOP                  13                                 3F4C1640
       TRA     STOP                  12                                 3F4C1650
       LGR     3                     11 - DIGIT 9                       3F4C1660
       LGR     3                     10 - DIGIT 8                       3F4C1670
       LGR     3                     7 - DIGIT 7                        3F4C1680
       LGR     3                     6 - DIGIT 6                        3F4C1690
       LGR     3                     5 - DIGIT 5                        3F4C1700
       LGR     3                     4 - DIGIT 4                        3F4C1710
       LGR     3                     3 - DIGIT 3                        3F4C1720
       LGR     3                     2 - DIGIT 2                        3F4C1730
       LGR     3                     1 - DIGIT 1                        3F4C1740
FRMTR  LGR     3                     0 - DIGIT 0                        3F4C1750
       REM  ENTRY FROM FORMAT SCAN ON LEFT PARENTHESIS.                 3F4C1760
CCLPAR LXA     GRCT,4                                                   3F4C1770
       TXI     *+1,4,1                                                  3F4C1780
       SXA     GRCT,4                                                   3F4C1790
       TXL     LPAR,4,2              GO TO SAVE IF ZERO OR FIRST LEVEL. 3F4C1800
       LXA     BX1,4                 SAVE FORMAT                        3F4C1810
       SXA     GRSAV1,4              SCAN POSITION                      3F4C1820
       LXA     BX2,4                 FOR FIRST LEVEL                    3F4C1830
       SXD     GRSAV1,4              PARENTHESIS.                       3F4C1840
       LXA     BX4,4                                                    3F4C1850
       SXD     GRCT,4                                                   3F4C1860
       CLA     MQR                                                      3F4C1870
       STO     GRSAV2                                                   3F4C1880
       LXA     GROUPX,4                                                 3F4C1890
       SXA     GRSAV3,4                                                 3F4C1900
       LXA     PARX,4                                                   3F4C1910
       SXD     GRSAV3,4                                                 3F4C1920
LPAR   SXA     BX1,1                 SAVE CURRENT                       3F4C1930
       SXA     BX2,2                 SCAN POSITION                      3F4C1940
       STQ     MQR                   FOR POSSIBLE RESCAN.               3F4C1950
       LXA     INT,4                 SAVE                               3F4C1960
       SXA     BX4,4                 GROUP COUNT, AND                   3F4C1970
       SXA     GROUPX,4              GROUP INDEX.                       3F4C1980
       LXA     ENDX,4                ADD 1 TO                           3F4C1990
       TXI     *+1,4,1               END PAREN COUNT                    3F4C2000
       SXA     ENDX,4                TO DETERMINE END OF FORMAT.        3F4C2010
       SXA     PARX,4                SAVE PAREN INDEX FOR RESCAN.       3F4C2020
       TRA     SCAN                * THEN CONTINUE SCAN.                3F4C2030
       REM  ENTRY FROM FORMAT SCAN ON COMMA.                            3F4C2040
CCCMMA AXC     RESUME-1,4            PROCESS CURRENT FIELD.             3F4C2050
       REM  FIELD,4 / CALLERS= CCCMMA, CCSLSH, CCRPAR, CCBLNK.          3F4C2060
FIELD  SXA     DONE,4                SAVE RETURN INDEX.                 3F4C2070
       SXA     CX2,2                 SAVE                               3F4C2080
       SXA     CX1,1                 CURRENT POSITION                   3F4C2090
       STQ     MQ                    OF FORMAT SCAN.                    3F4C2100
       LXA     INT,4                 PICKUP FIELD WIDTH,                3F4C2110
       TXL     DONE,4,0              IF NON-ZERO,                       3F4C2120
       SXA     WIDTH,4               SET WIDTH, AND                     3F4C2130
EXITSW TRA     LISTRT               *EXIT TO LIST CONTROL               3F4C2140
       CLA     TRA                   RESET SWITCH, IF THE END           3F4C2150
       STD     *-2                   OF FORMAT WAS JUST ENCOUNTERED.    3F4C2160
       TRA     ENDFSW+1            * EXIT TO CONVERSION.                3F4C2170
       REM  ENTRY FROM FORMAT SCAN ON SLASH.                            3F4C2180
CCSLSH TSX     FIELD,4             * GO PROCESS CURRENT FIELD.          3F4C2190
       AXC     RESUME-1,2            PREPARE FOR NEXT LINE OF I/O.      3F4C2200
       TRA     INOUTS                                                   3F4C2210
       REM  ENTRY FROM FORMAT SCAN ON P.                                3F4C2220
CCSCFP CLA     INT                   MOVE SCALE FACTOR                  3F4C2230
       STO     PEX                   INTO PEX.                          3F4C2240
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4C2250
       REM  ENTRY FROM FORMAT SCAN ON O.                                3F4C2260
CCOCTL NOP     *+2                   (INPUT/NOP, OUTPUT/TRA).           3F4C2270
       TXI     SETAD,4,ONPT-38       ADJUST FOR ONPT ENTRY, OR FOR      3F4C2280
       TXI     SETAD,4,OOUT-38       OOUT. EXIT TO SET CNVSW.           3F4C2290
       REM  ENTRY FROM FORMAT SCAN ON MINUS.                            3F4C2300
CCSCFM CLS     INT                   SET SIGN OF SCALE FACTOR NEGATIVE, 3F4C2310
       STO     INT                                                      3F4C2320
       TRA     SCAN5               * AND GO CONTINUE SCAN.              3F4C2330
       REM  ENTRY FROM FORMAT SCAN ON RIGHT PARENTHESIS.                3F4C2340
CCRPAR TSX     FIELD,4             * GO PROCESS CURRENT FIELD.          3F4C2350
BX4    AXT     **,4                  TEST GROUP COUNT, AND              3F4C2360
       TIX     GROUP,4,1             PROCESS GROUP UNTIL EXHAUSTED.     3F4C2370
       LXA     GRCT,4                RESET FORMAT SCAN POSITION         3F4C2380
       TXH     RSETGR,4,2            FOR FIRST LEVEL GROUP COUNT.       3F4C2390
       TXI     *+1,4,-1                                                 3F4C2400
       SXA     GRCT,4                                                   3F4C2410
ENDX   AXT     **,4                  THEN TEST END COUNT, AND           3F4C2420
       TNX     ENDFMT,4,1            IF NOT EXHAUSTED,                  3F4C2430
       SXA     ENDX,4                REDUCE COUNT, AND                  3F4C2440
       REM  ENTRY FROM CCSLSH, CCCMMA, CCHOLL, CCBLNK.                  3F4C2450
RESUME LDQ     MQ                    RESTORE                            3F4C2460
CX1    AXT     **,1                  CURRENT                            3F4C2470
CX2    AXT     **,2                  POSITION OF FORMAT SCAN.           3F4C2480
       REM  ENTRY FROM CCLPAR,CCSCFP,CCRPAR,CCINTG,CCHOLL.              3F4C2490
SCAN   STZ     INT                   CLEAR INT, AND                     3F4C2500
       TRA     SCAN5               * CONTINUE FORMAT SCAN.              3F4C2510
       REM  ENTRY FROM TOPACK ON LINE OVERFLOW.                         3F4C2520
OVER   TSX     SETWRD,2            * RESET WORD FOR OUTPUT.             3F4C2530
       REM  ENTRY FROM FORMAT SCAN ON ILLEGAL CONTROL CHARACTER.        3F4C2540
STOP   CLA*    FMTLOC                STORE FIRST WORD OF FORMAT         3F4C2550
       STO     E31MES+5              STATEMENT IN MESSAGE.              3F4C2560
       CLA     FMTLOC                CONVERT TO OCTAL AND STORE         3F4C2570
       TSX     CVBCD,4               IN MESSAGE.                        3F4C2590
       SLW     E31MES+2                                                 3F4C2600
FSTOP  CALL    .FXEM.(CODE)          EXIT FOR EXECUTION ERROR.          3F4C2620
       TRA     *+1                   INCORRECT FORMAT STATEMENT.        3F4C2630
ENDFMT CLA     TRA                   SET SWITCH IN IOCNV                3F4C2640
       STD     ENDFSW                FOR END OF FORMAT, AND             3F4C2650
       TRA     LISTRT               *GO SEE IF LIST IS EXHAUSTED        3F4C2660
       REM  REENTRY AFTER END OF FORMAT.                                3F4C2670
RESCAN CLA     CX1                   RESET TO NOP                       3F4C2680
       STD     ENDFSW                END OF FORMAT SWITCH.              3F4C2690
       STD     EXITSW                SET EXIT SWITCH IN FIELD.          3F4C2700
       TSX     INOUTS,2                                                 3F4C2710
PARX   AXT     **,4                  PICKUP PAREN INDEX TO              3F4C2720
       SXA     ENDX,4                RESET END COUNT.                   3F4C2730
       SXA     GRCT,4                                                   3F4C2740
GROUPX AXT     **,4                  PICKUP GROUP INDEX TO              3F4C2750
GROUP  SXA     BX4,4                 SET GROUP COUNT.                   3F4C2760
BX1    AXT     **,1                  RESET FORMAT POSITION              3F4C2770
BX2    AXT     **,2                  TO BEGINNING OF                    3F4C2780
       LDQ     MQR                   LAST GROUP, AND                    3F4C2790
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4C2800
RSETGR LXA     GRCT,4                                                   3F4C2810
       TXI     *+1,4,-1                                                 3F4C2820
       SXA     GRCT,4                                                   3F4C2830
       CLA     GRSAV1                RESET FORMAT SCAN POSITION         3F4C2840
       STA     BX1                   FOR FIRST LEVEL GROUP COUNT        3F4C2850
       ARS     18                    AFTER SECOND                       3F4C2860
       STA     BX2                   LEVEL GROUP                        3F4C2870
       CLA     GRSAV2                COUNT IS DEPLETED.                 3F4C2880
       STO     MQR                                                      3F4C2890
       CLA     GRSAV3                                                   3F4C2900
       STA     GROUPX                                                   3F4C2910
       ARS     18                                                       3F4C2920
       STA     PARX                                                     3F4C2930
       LXD     GRCT,4                                                   3F4C2940
       SXA     BX4,4                                                    3F4C2950
       TRA     ENDX                                                     3F4C2960
       REM  REENTRY FROM FORMAT SCAN FOR SINGLE PRECISION DECIMAL POINT.3F4C2970
CCDCPT CAL     DCPT                  MODIFY                             3F4C2980
       SLW     SCAN3                 SCAN.                              3F4C2990
       PXD     ,0                    CLEAR OR STORE DEC. SCALE          3F4C3000
DCPT1  STO     DIG                   ..                                 3F4C3010
       TRA     SCAN5               * GO CONTINUE SCAN.                  3F4C3020
       REM  REENTRY FROM FORMAT SCAN.                                   3F4C3030
DCPT   TRA     *+1                   COLLECT                            3F4C3040
       TXL     DCPT1,4,9             DECIMAL POSITION.                  3F4C3050
DCPT2  SUB     BLANK                 ON NEXT                            3F4C3060
       TZE     SCAN5               * CONTROL CHARACTER,                 3F4C3070
       CAL     *+2                   RESET                              3F4C3080
       SLW     SCAN3                 FORMAT SCAN                        3F4C3090
       XEC     FRMTR,4             * AND GO CONTINUE SCAN.              3F4C3100
       REM  REENTRY FROM FORMAT SCAN FOR DOUBLE PRECISION DECIMAL POINT.3F4C3110
DDCPT  TRA     *+1                                                      3F4C3120
       TXH     DCPT2,4,9             IF NUMERIC CHARACTER,              3F4C3130
       LGR     3                     MULTIPLY PREVIOUS DIGIT BY 10      3F4C3140
       ADM     DIG                   AND ADD IN CURRENT DIGIT.          3F4C3150
       LGL     3                                                        3F4C3160
       ADM     DIG                                                      3F4C3170
       ACL     DIG                                                      3F4C3180
       PAX     0,4                   TEST MAGNITUDE OF DIG.             3F4C3190
       TXL     DCPT1,4,17            IF GREATER THAN 17,                3F4C3200
       AXT     17,4                  SET VALUE OF DIG                   3F4C3210
       PXA     0,4                   EQUAL TO 17.                       3F4C3220
       TRA     DCPT1                                                    3F4C3230
       REM  ENTRY FROM FORMAT SCAN ON I.                                3F4C3240
CCINTG NOP     SETAD1                IF INPUT,                          3F4C3250
       CLA     TRA                   PICKUP TRA, AND                    3F4C3260
       REM  ENTRY FROM CCFFXD.                                          3F4C3270
SETFX  STD     FIXSW                 SET FIXSW, AND                     3F4C3280
       AXT     DBC,4                 PICKUP DBC TO                      3F4C3290
       REM  ENTRY FROM CCFFXD, CCEFLT, CCOCTL, CCALPH.                  3F4C3300
SETAD  SXA     CNVSW,4               SET CNVSW.                         3F4C3310
       LXA     INT,4                 PICKUP INT, AND                    3F4C3320
       SXA     COUNT,4               SET COUNT.                         3F4C3330
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4C3340
SETAD1 TXI     SETAD,4,INTG-25       OUTPUT INTEGER, SET CNVSW.         3F4C3350
       REM  ENTRY FROM FORMAT SCAN ON H.                                3F4C3360
CCHOLL LXA     INT,4                 REPLACE                            3F4C3370
       NOP     HOUT                  IF INPUT, THE                      3F4C3380
       LDQ     MQD                   HOLLERITH                          3F4C3390
       SXA     CX2,2                 FIELD                              3F4C3400
       CAL     0,2                   IN                                 3F4C3410
       LXA     .FDX1,2               FORMAT                             3F4C3420
       TNX     HNPT3,1,6             STATEMENT                          3F4C3430
       SXA     *+1,1                 WITH THE SPECIFIED NO.             3F4C3440
       ARS     **                                                       3F4C3450
HNPT1  TIX     HNPT2,2,1             OF                                 3F4C3460
       LXA     .FDX2,2               BCD                                3F4C3470
       TXI     *+1,2,-1              CHARACTERS                         3F4C3480
       LDQ*    .FBDBF                FROM                               3F4C3490
       SXA     .FDX2,2               THE                                3F4C3500
       AXT     6,2                   INPUT                              3F4C3510
HNPT2  LGL     6                     BUFFER.                            3F4C3520
       TNX     HNPT4,4,1             ..                                 3F4C3530
       TIX     HNPT1,1,6             ..                                 3F4C3540
HNPT3  LXA     CX2,1                 ..                                 3F4C3550
       SLW     0,1                   ..                                 3F4C3560
       TXI     *+1,1,-1              ..                                 3F4C3570
       SXA     CX2,1                 ..                                 3F4C3580
       AXT     36,1                  ..                                 3F4C3590
       TRA     HNPT1                 ..                                 3F4C3600
HNPT4  SXA     .FDX1,2               ..                                 3F4C3610
       LXA     CX2,2                 ..                                 3F4C3620
       STQ     MQD                   ..                                 3F4C3630
       SXA     CX1,1                 ..                                 3F4C3640
       TXL     HNPT5,1,6             ..                                 3F4C3650
       LDQ     0,2                   ..                                 3F4C3660
       RQL     42,1                  ..                                 3F4C3670
       STQ     MQ                    ..                                 3F4C3680
       TNX     HNPT5,1,6             ..                                 3F4C3690
       SXA     *+1,1                 ..                                 3F4C3700
       LGL     **                    ..                                 3F4C3710
HNPT5  SLW     0,2                   ..                                 3F4C3720
       TRA     RESUME              * GO RESUME FORMAT SCAN.             3F4C3730
       REM  ENTRY FROM CCBLNK.                                          3F4C3740
HOUT   CAL     .WORD                 MOVE OUT THE SPECIFIED             3F4C3750
       TNO     *+1                   NUMBER                             3F4C3760
HOUT1  TIX     HOUT2,1,6             OF                                 3F4C3770
HOUTA  AXT     36,1                  FORMAT                             3F4C3780
       TXI     *+1,2,-1              CHARACTERS                         3F4C3790
       LDQ     0,2                   (OR BLANKS)                        3F4C3800
HOUT2  LGL     6                     INTO                               3F4C3810
       TNO     HOUT6                 THE                                3F4C3820
       TXI     *+1,4,-1              OUTPUT                             3F4C3830
       XEC     .FPACK                BUFFER                             3F4C3840
       SXA     HOUT5+1,1             A                                  3F4C3850
       TXL     HOUT21,4,5            WORD                               3F4C3860
       TXI     *+1,1,-6              AT A TIME                          3F4C3870
       PXA     ,1                    AFTER THE PENDING                  3F4C3880
       STA     HOUT3                 WORD                               3F4C3890
       SUB     HOUTA                 ..                                 3F4C3900
       STA     HOUT4                 ..                                 3F4C3910
HOUT21 LXA     .FPACK,1              . .                                3F4C3920
       XEC     TEST                  (HAS LINE FORMATTING OVERFLOWED)   3F4C3930
       TXI     *+1,1,1               ..                                 3F4C3940
       SXA     .FPACK,1              . .                                3F4C3950
       TIX     HOUT3,4,6             ..                                 3F4C3960
       TXI     *+1,4,1               ..                                 3F4C3970
       TXL     *+2,4,6               ..                                 3F4C3980
       TXI     HOUT3,4,-7            ..                                 3F4C3990
       CAL     L(1)                  ..                                 3F4C4000
       TRA     HOUT5                 ..                                 3F4C4010
HOUT3  LGL     **                    ..                                 3F4C4020
       TXI     *+1,2,-1              ..                                 3F4C4030
       LDQ     ,2                    ..                                 3F4C4040
HOUT4  LGL     **                    ..                                 3F4C4050
       XEC     .FPACK                . .                                3F4C4060
       TRA     HOUT21+1              ..                                 3F4C4070
HOUT5  TNO     *+1                   ..                                 3F4C4080
       AXT     **,1                  ..                                 3F4C4090
HOUT6  TIX     HOUT1,4,1             ..                                 3F4C4100
       SLW     .WORD                 . .                                3F4C4110
       TRA     SCAN                * EXIT TO SCAN.                      3F4C4120
       REM  ENTRY FROM FORMAT SCAN ON X.                                3F4C4130
CCBLNK LXA     INT,4                 SET TO SKIP INT BLANKS CHARS.      3F4C4140
       STQ     MQ                    IN DATA OR OUTPUT BUFFER           3F4C4150
       SXA     CX1,1                 ..                                 3F4C4160
       SXA     CX2,2                 ..                                 3F4C4170
SKIP   NOP     BOUT                  IF INPUT. SKIP THE SPECIFIED       3F4C4180
       LDQ     MQD                   BCD                                3F4C4190
       LXA     .FDX1,1               CHARACTERS                         3F4C4200
SKIP1  TIX     SKIP2,1,1             IN                                 3F4C4210
       LXA     .FDX2,2               THE                                3F4C4220
       TXI     *+1,2,-1              INPUT                              3F4C4230
       TIX     *-1,4,6               BUFFER.                            3F4C4240
       LDQ*    .FBDBF                ..                                 3F4C4250
       SXA     .FDX2,2               ..                                 3F4C4260
       AXT     6,1                   ..                                 3F4C4270
SKIP2  LGL     6                     ..                                 3F4C4280
       TIX     SKIP1,4,1             ..                                 3F4C4290
       SXA     .FDX1,1               ..                                 3F4C4300
       STQ     MQD                   ..                                 3F4C4310
       TRA     RESUME              * GO RESUME FORMAT SCAN.             3F4C4320
BOUT   SXA     COUNT,0               PLACE BLANKS INTO THE OUTPUT       3F4C4330
       AXC     RESUME-1,2            BUFFER                             3F4C4340
       SXA     DONE,2                USING THE TOPACK ROUTINE           3F4C4350
       TXH     *+2,4,0               ..                                 3F4C4360
       AXT     1,4                   ..                                 3F4C4370
       SXA     WIDTH,4               AND                                3F4C4380
       AXT     0,4                   RESUME                             3F4C4390
       TRA     TOPACK              * THE FORMAT SCAN.                   3F4C4400
       REM  ENTRY FROM FORMAT SCAN ON A.                                3F4C4410
CCALPH NOP     *+2                   IF INPUT, ADJUST FOR               3F4C4420
       TXI     SETAD,4,ANPT-17     * ANPT ENTRY, OR FOR                 3F4C4430
       TXI     SETAD,4,AOUT-17     * AOUT. EXIT TO SET CNVSW.           3F4C4440
       REM  ENTRY FROM FORMAT SCAN ON F.                                3F4C4450
CCFFXD CLS     PEX                   MOVE NEGATIVE OF                   3F4C4460
       STO     .FEXP                 SCALE FACTOR INTO EXP              3F4C4470
       NOP     *+3                   IF INPUT,                          3F4C4480
       REM  ENTRY FROM CCEFLT.                                          3F4C4490
FXPT   CLA     CX1                   PICK UP NOP,AND                    3F4C4500
       TRA     SETFX               * GO SET FIXSW.                      3F4C4510
       AXT     FXD,4                 PICKUP FXD, AND                    3F4C4520
       SXA     CNVSW,4               SET GATE AT CNVSW.                 3F4C4530
       AXT     CHAR,4                IF OUTPUT,                         3F4C4540
       SXA     FXFL1,4               SET                                3F4C4550
       AXT     1,4                   FXFL1,2,3                          3F4C4560
       REM  ENTRY FROM CCEFLT.                                          3F4C4570
FXPT1  SXD     FXFL2,4               IN CONVERSION ROUTINE              3F4C4580
       SXD     FXFL3,4               FOR FIXED POINT,                   3F4C4590
       TRA     SETAD+1             * GO SET COUNT.                      3F4C4600
       REM  ENTRY FROM FORMAT SCAN ON E.                                3F4C4610
CCEFLT NOP     *+3                   IF INPUT,                          3F4C4620
       STZ     .FEXP                 CLEAR EXP AND                      3F4C4630
       TRA     FXPT                * EXIT TO CCFFXD.                    3F4C4640
       AXT     FLT,4                 PICKUP FLT, AND                    3F4C4650
       SXA     CNVSW,4               ..                                 3F4C4660
       AXT     CHAR-4,4              IF OUTPUT,                         3F4C4670
       SXA     FXFL1,4               SET                                3F4C4680
       AXT     5,4                   FXFL1,2,3                          3F4C4690
       TRA     FXPT1               * EXIT TO CCFFXD.                    3F4C4700
       REM  ENTRY FROM FORMAT SCAN ON D.                                3F4C4710
CCDFLT AXT     DDCPT,4               SET DOUBLE PRECISION EXIT IN       3F4C4720
       SXA     CCDCPT,4              DECIMAL POINT SCAN.                3F4C4730
       STL     DDDFLG                SET FLAG FOR D IN FORMAT SCAN.     3F4C4740
       NOP     CCDOUT                IF DOUBLE PRECISION INPUT,         3F4C4750
       STZ     .FEXP                 CLEAR EXP AND SET DOUBLE           3F4C4760
       LXA     DBC20,4               PRECISION EXITS FOR -              3F4C4770
       SXA     D1,4                  OVERFLOW IN DBC ROUTINE,           3F4C4780
       AXT     DDBC,4                                                   3F4C4790
       SXA     DBC20,4                                                  3F4C4800
       LXA     DDSW,4                DOUBLE PRECISION FIX,              3F4C4810
       SXA     D2,4                                                     3F4C4820
       AXT     DDFIX,4                                                  3F4C4830
       SXA     DDSW,4                                                   3F4C4840
       AXT     DEXPON,4              SCAN OF D IN EXPONENT FIELD.       3F4C4850
       SXA     DBC10,4                                                  3F4C4860
       TRA     FXPT                                                     3F4C4870
CCDOUT AXT     DFLT,4                IF OUTPUT, SET                     3F4C4880
       SXA     CNVSW,4               CONVERSION SWITCH,                 3F4C4890
       STL     DDFLAG                DOUBLE PRECISION FLAG,             3F4C4900
       AXT     5,4                   FXFL2 AND FXFL3.                   3F4C4910
       TRA     FXPT1                                                    3F4C4920
       REM  ENTRY FROM FORMAT SCAN ON L                                 3F4C4930
CCLOGC NOP     *+2                   (INPUT/NOP, OUTPUT/TRA)            3F4C4940
       TXI     SETAD,4,LNTP-35       LNTP ENTRY FOR INPUT OR            3F4C4950
       TXI     SETAD,4,LOUT-35       LOUT ENTRY FOR OUTPUT. SET CNVSW.  3F4C4960
       REM  ENTRY FROM MAIN PROGRAM.                                    3F4C4970
.FFIL. SXA     LISTDN,4                                                 3F4C4980
       SXA     LISTDN+2,1                                               3F4C4990
       SXA     LISTDN+1,2                                               3F4C5000
       STZ     ONLIN                                                    3F4C5010
       CLA     .FPACK                WHEN LIST                          3F4C5020
       SUB     FILT                  HAS BEEN                           3F4C5030
       TNZ     FINISH                SATISFIED,                         3F4C5040
       CLA     .WORD                 PROCESS                            3F4C5050
       SUB     L(1)                  ANY                                3F4C5060
       TZE     *+2                   REMAINING                          3F4C5070
FINISH TSX     INOUTS,2                                                 3F4C5080
       STZ     GRCT                  RESTORE GROUP COUNTER.             3F4C5090
       NZT     DDDFLG                TEST WHETHER DP EXITS RESTORED.    3F4C5100
       TRA     LISTDN                                                   3F4C5110
       STZ     DDDFLG                RESTORE DOUBLE PRECISION           3F4C5120
       STZ     DDFLAG                EXITS CHANGED FOR OUTPUT.          3F4C5130
       AXT     DCPT,4                                                   3F4C5140
       SXA     CCDCPT,4                                                 3F4C5150
LISTDN AXT     **,4                                                     3F4C5160
       AXT     **,2                                                     3F4C5170
       AXT     **,1                                                     3F4C5180
       TRA     1,4                                                      3F4C5190
       REM  ENTRY FROM MAIN PROGRAM.                                    3F4C5200
.FRTN. SXA     LISTDN,4                                                 3F4C5210
       SXA     LISTDN+1,2                                               3F4C5220
       SXA     LISTDN+2,1                                               3F4C5230
RTN1   STZ     GRCT                                                     3F4C5240
       NZT     DDDFLG                TEST WHETHER DP EXITS RESTORED.    3F4C5250
       TRA     LISTDN                                                   3F4C5260
       STZ     DDDFLG                RESTORE DOUBLE PRECISION           3F4C5270
       TSX     DDRST1,2              EXITS CHANGED FOR INPUT.           3F4C5280
       TRA     LISTDN                                                   3F4C5290
LISTRT ZET     DIVRT                                                    3F4C5300
       TRA     .LIST                 NO-LIST COMPLETE,RETURN TO M.P.    3F4C5310
       STL     DIVRT                                                    3F4C5320
SV2    AXT     **,2                                                     3F4C5330
SV1    AXT     **,1                                                     3F4C5340
LIST   AXT     **,4                                                     3F4C5350
       TRA     1,4                                                      3F4C5360
*      ROUTINE TO HANDLE INPUT OUTPUT ,CALCULATE S WORD COUNT           3F4C5370
*      AND RESETS BUFFER IF OUTPUT                                      3F4C5380
INOUTS SXA     RET,2                                                    3F4C5390
       NOP     FILWD                                                    3F4C5400
INOUT  TSX     **,2                                                     3F4C5410
       NOP     RESET+1                                                  3F4C5420
RET    AXT     **,2                                                     3F4C5430
       TRA     1,2                                                      3F4C5440
*      CALCULATE CHARACTER COUNT FOR THIS LINE,                      (8)3F4C5441
*      (XR1-OUTBUF)*6 + NUMBER OF CHARS IN .WORD                     (8)3F4C5442
*      IF IT IS GREATER THAN CHLIMT LINE OVERFLOWS                   (8)3F4C5443
FILWD  LXA     .FPACK,1                                                 3F4C5450
       TXI     *+1,1,-OUTBUF       GET (XR1-OUTBUF)                  (8)3F4C5451
       PXA     ,1                                                    (8)3F4C5460
       STA     NOP                                                   (8)3F4C5461
       ALS     1                                                     (8)3F4C5462
       ADD     NOP                                                   (8)3F4C5463
       ALS     1                                                     (8)3F4C5464
       PAX     ,2                  GET (XR1-OUTBUF)*6                (8)3F4C5465
       CAL     .WORD               PARTIAL WORD WITH                 (8)3F4C5466
       SUB     L(1)                BLANKS AND STORE                  (8)3F4C5467
       TZE     FTEST               IN OUTPUT BUFFER                  (8)3F4C5468
       TXI     *+1,2,6             BUMP CHAR COUNT 6 FOR AC CHAR     (8)3F4C5469
       CAL     .WORD                                                    3F4C5490
       TOV     *+1                                                      3F4C5500
       LDQ     BLANKS                                                   3F4C5510
       LGL     6                                                        3F4C5520
       TXI     *+1,2,-1            GET TRUE CHAR COUNT               (8)3F4C5521
       TNO     *-2                 GO BACK IF MORE CHARS             (8)3F4C5530
       TXL     *+2,2,CHLIMT        IF NO OVERFLOW                   (14)3F4C5531
       TRA*    TEST                IF LINE OVERFLOWS                 (8)3F4C5533
       XEC     .FPACK                STORE COMPLETED WORD               3F4C5540
       TXI     *+1,1,1                                                  3F4C5550
FILL2  TXH     INOUT,1,2           NUMBER OF WORDS STORED            (8)3F4C5570
       AXT     3,1                   LESS THAN THREE WORDS-FIX AT 3     3F4C5580
       TRA     INOUT                                                    3F4C5590
FTEST  TXL     FILL2,2,CHLIMT      IF NO OVERFLOW                    (8)3F4C5591
       TRA*    TEST                IF LINE OVERFLOWS                 (8)3F4C5593
BLANKS BCI     1,                                                       3F4C5600
L(1)   PZE     1                                                        3F4C5610
       OCT     20                                                       3F4C5620
BLANK  BCI     1,00000                                                  3F4C5630
FILT   SLW     OUTBUF                                                   3F4C5640
INT    PZE                                                              3F4C5650
MQR    PZE                                                              3F4C5660
MQ     PZE                                                              3F4C5670
CT     PZE     **                                                       3F4C5680
FMTLOC PZE     **                    LOCATION OF START OF FORMAT.       3F4C5690
FILEBK PZE     **                    LOCATION OF FILE CONTROL BLOCK.    3F4C5700
       REM                           OCCUPIES TWO CELLS.                3F4C5710
PPFLAG PZE     **                    NON-ZERO IF PRINT OR PUNCH OUTPUT. 3F4C5720
CDFLAG PZE     **                    NON-ZERO IF ON-LINE CARD INPUT.    3F4C5730
GRSAV3 PZE     **                                                       3F4C5740
GRSAV2 PZE     **                                                       3F4C5750
GRSAV1 PZE     **                                                       3F4C5760
GRCT   PZE     **                                                       3F4C5770
NOP    NOP                                                              3F4C5780
DIVRT  PZE                                                              3F4C5790
ONLIN  PZE                                                              3F4C5800
SETWRD CAL     L(1)                  RESET WORD                         3F4C5810
       SLW     .WORD                                                    3F4C5820
       TRA     1,2                   EXIT TO CALLER                     3F4C5830
RESET  SXA     RET,2                                                    3F4C5840
       CAL     FILT                  RESET POINTER TO START OF BUFFER   3F4C5850
       STA     .FPACK                                                   3F4C5860
       CAL     L(1)                  RESET WORD                         3F4C5870
       SLW     .WORD                                                    3F4C5880
       CAL     BLANKS                                                   3F4C5890
       SLW     OUTBUF                                                   3F4C5900
       SLW     OUTBUF+1                                                 3F4C5910
       SLW     OUTBUF+2                                                 3F4C5920
       TRA     RET                                                      3F4C5930
CVBCD  XCA                           CONVERT BINARY ADDRESS             3F4C5940
       RQL     21                    TO OCTAL.                          3F4C5950
       CLA     BLANKS                                                   3F4C5960
       SXA     *+5,1                                                    3F4C5970
       AXT     5,1                                                      3F4C5980
       ALS     3                                                        3F4C5990
       LGL     3                                                        3F4C6000
       TIX     *-2,1,1                                                  3F4C6010
       AXT     **,1                                                     3F4C6020
       TRA     1,4                                                      3F4C6030
CODE   PZE     31                                                       3F4C6040
ER31MS PZE     E31MES,,16                                               3F4C6050
ER31OP PZE     E31OMS,,4                                                3F4C6060
E31MES BCI ,0FORMAT AT   XXXXX,FIRST WORD XXXXXX, HAS ILLEGAL CONTROL CH3F4C6070
       BCI     6,ARACTER OR SPECIFIES TOO LONG A LINE                   3F4C6080
E31OMS BCI     4,0TREAT AS END OF FORMAT                                3F4C6090
LNKG   LDIR                                                             3F4C6100
       BCI     1,FIOH                                                   3F4C6110
BEG94  NULL                                                          $5$3F4C6120
*                                                                    $5$3F4C6130
*                                                                    $5$3F4C6140
       PCC     ON                                                    $5$3F4D0000
       IFT     M9094=90                                              $5$3F4D0010
       GOTO    END94                                                 $5$3F4D0020
       PCC     OFF                                                   $5$3F4D0030
       TTL     FIOH  -  FORMAT SCANNER                                  3F4D0040
       REM  FORMAT SCAN.                                                3F4D0050
*              FORMAT SCANNER                                           3F4D0060
*              CALLING SEQUENCE IS                                      3F4D0070
*              CALL .FIOH.(ARG)                                         3F4D0080
*              ARG= DECREMENT IS NOP FOR INPUT,TRA FOR OUTPUT           3F4D0090
*                   ADDRES IS LOCATION OF IO CALLING SEQUENCE           3F4D0100
*                                                                       3F4D0110
*                                                                       3F4D0120
       ENTRY   .FFIL.                                                   3F4D0130
       ENTRY   .FRTN.                                                   3F4D0140
       ENTRY   .FIOH.                                                   3F4D0150
TRA    EQU     FSET1+1                                                  3F4D0160
ANPT   EQU     .ANPT                                                    3F4D0170
AOUT   EQU     .AOUT                                                    3F4D0180
CNVSW  EQU     .CNVSW                                                   3F4D0190
COUNT  EQU     .KOUNT                                                   3F4D0200
D1     EQU     .D1                                                      3F4D0210
D2     EQU     .D2                                                      3F4D0220
DBC10  EQU     .DBC10                                                   3F4D0230
DBC20  EQU     .DBC20                                                   3F4D0240
DBC    EQU     .DBC                                                     3F4D0250
DDBC   EQU     .DDBC                                                    3F4D0260
DDDFLG EQU     .DDDFL                                                   3F4D0270
DDFIX  EQU     .DDFIX                                                   3F4D0280
DDFLAG EQU     .DDFLG                                                   3F4D0290
DDRST1 EQU     .DDRS1                                                   3F4D0300
DDSW   EQU     .DDSW                                                    3F4D0310
DEXPON EQU     .DEXPN                                                   3F4D0320
DFLT   EQU     .DFLT                                                    3F4D0330
DIG    EQU     .DIG                                                     3F4D0340
DONE   EQU     .DONE                                                    3F4D0350
ENDFSW EQU     .ENDFS                                                   3F4D0360
FIXSW  EQU     .FIXSW                                                   3F4D0370
FLT    EQU     .FLT                                                     3F4D0380
FXD    EQU     .FXD                                                     3F4D0390
INTG   EQU     .INTG                                                    3F4D0400
LNTP   EQU     .LNTP                                                    3F4D0410
LOUT   EQU     .LOUT                                                    3F4D0420
MQD    EQU     .MQD                                                     3F4D0430
ONPT   EQU     .ONPT                                                    3F4D0440
OOUT   EQU     .OOUT                                                    3F4D0450
OUTBUF EQU     .OUTBF                                                   3F4D0460
PEX    EQU     .PEX                                                     3F4D0470
XCF    EQU     .XCF                                                  $5$3F4D0480
HOUT   EQU     .HOUT                                                 $5$3F4D0490
GAIN   EQU     .GAIN                                                 $5$3F4D0500
GAIN1  EQU     .GAIN1                                                $5$3F4D0510
QSTO   EQU     .QSTO                                                 $5$3F4D0520
BUF    EQU     .BUF                                                  $5$3F4D0530
WIDTH  EQU     .WIDTH                                                   3F4D0540
TEST   EQU     .TEST                                                 (8)3F4D0543
.FIOH. SXA     LNKG,4                                                   3F4D0550
       SXA     SYSLOC,4                                                 3F4D0560
       SXA     SV1,1                 SAVE XR1 AND XR2 FROM              3F4D0570
       SXA     SV2,2                 ORIGINAL CALL FROM MAIN PROGRAM    3F4D0580
       LMTM                                                          (6)3F4D0581
       SXA     SV7,7                                                 (6)3F4D0582
       SXA     SV6,6                                                 (6)3F4D0583
       SXA     SV5,5                                                 (6)3F4D0584
       SXA     SV3,3                                                 (6)3F4D0585
       CLA     4,4                   GET RETURN FROM MAIN CALL AND      3F4D0590
       STA     LIST                  SAVE.STORE ADDRESS OF BUFFER       3F4D0600
       STD     ARG2                  IF FRCD CALL                       3F4D0610
       CLA     3,4                   GET TRA,NOP AND I/O RETURN         3F4D0620
       STT     ONLIN                 SET ONLINE OPERATION SWITCH        3F4D0630
       STA     INOUT                 SAVE RETURN TO TRANSMIT LINE       3F4D0640
       STA     FSTLN                                                    3F4D0650
       STD     CCOCTL                SET INPUT/OUTPUT SWITCHES          3F4D0660
       STD     CCINTG                NOP FOR INPUT                      3F4D0670
       STD     CCHOLL+1              TRA FOR OUTPUT                     3F4D0680
       STD     INOUTS+1                                                 3F4D0690
       STD     INOUT+1                                                  3F4D0700
       STD     CCFFXD+2                                                 3F4D0710
       STD     CCEFLT                                                   3F4D0720
       STD     CCDFLT+3                                                 3F4D0730
       STD     SKIP                                                     3F4D0740
       STD     CCALPH                                                   3F4D0750
       STD     CCLOGC                                                   3F4D0760
       STD     TST1                                                     3F4D0770
       AXT     OVER,2                                                $5$3F4D0780
       AXT     RESCAN,1                                                 3F4D0790
       CALL    .FCON.(ARG1,ARG2,ARG3)                                $5$3F4D0800
       ORG     *-3                                                   $5$3F4D0810
ARG1   PZE     DCPT,,CCDCPT                                             3F4D0820
ARG2   PZE     STOP,,**                                                 3F4D0830
ARG3   PZE     SCAN                                                  $5$3F4D0840
       TSX     RESET,2               RESET BUFFER FOR OUTPUT            3F4D0850
       CLA     FSET1+1                                                  3F4D0860
       STD     EXITSW                SET EXIT SWITCH                    3F4D0870
       STZ     DIVRT                 RESET SWITCH,RETURN THRU FCNV      3F4D0880
       STZ     INT                                                      3F4D0890
       SXA     ENDX,0                                                   3F4D0900
       LXA     LIST,4                LOCATE CALL IN MAIN PROGRAM        3F4D0910
       ZET     ONLIN                 IS THIS ONLINE OPERATION           3F4D0920
       TXI     *+1,4,1               YES-BUMP POINTER TO GET FORMAT LOC 3F4D0930
       CLA     4,4                   PICK UP LOCATION OF FORMAT         3F4D0940
       STA     STPNT                 SET FORMAT POINTER                 3F4D0950
       STA     FMTLOC                                                   3F4D0960
TST1   NOP     *+2                                                      3F4D0970
FSTLN  TSX     **,2                  IF INPUT, GET FIRST LINE           3F4D0980
STPNT  AXC     **,2                                                     3F4D0990
SCAN1  LDQ     0,2                   EXAMINE                            3F4D1000
       AXT     36,1                  NEXT                               3F4D1010
SCAN2  PXD     ,0                    FORMAT                             3F4D1020
       LGL     6                     CHARACTER,                         3F4D1030
       PAX     ,4                    AND                                3F4D1040
SCAN3  XEC     FRMTR,4             * TAKE INDICATED TRANSFER.           3F4D1050
       ADM     INT                   CONTROL COMES HERE ON ANY DIGIT.   3F4D1060
       LGL     3                     MULTIPLY PREVIOUS INT BY 10,       3F4D1070
       ADM     INT                   AND ADD IN                         3F4D1080
       ACL     INT                   CURRENT DIGIT.                     3F4D1090
SCAN4  SLW     INT                   SET INT.                           3F4D1100
       REM  ENTRY FROM CCRPAR, CCDCPT.                                  3F4D1110
SCAN5  TIX     SCAN2,1,6           * IF CHARACTER COUNT IS EXHAUSTED,   3F4D1120
FSET1  TXI     SCAN1,2,-1            EXAMINE NEXT FORMAT WORD.          3F4D1130
       REM  FORMAT TRANSFER TABLE.                                      3F4D1140
       TRA     STOP                  77                                 3F4D1150
       TRA     STOP                  76                                 3F4D1160
       TRA     STOP                  75                                 3F4D1170
       TRA     CCLPAR                74                                 3F4D1180
       TRA     CCCMMA                73                                 3F4D1190
       TRA     STOP                  72                                 3F4D1200
       TRA     STOP                  71                                 3F4D1210
       TRA     STOP                  70                                 3F4D1220
       TRA     CCBLNK                67                                 3F4D1230
       TRA     STOP                  66                                 3F4D1240
       TRA     STOP                  65                                 3F4D1250
       TRA     STOP                  64                                 3F4D1260
       TRA     STOP                  63                                 3F4D1270
       TRA     STOP                  62                                 3F4D1280
       TRA     CCSLSH                61                                 3F4D1290
       TRA     SCAN5                 60                                 3F4D1300
       TRA     STOP                  57                                 3F4D1310
       TRA     STOP                  56                                 3F4D1320
       TRA     STOP                  55                                 3F4D1330
       TRA     STOP                  54                                 3F4D1340
       TRA     STOP                  53                                 3F4D1350
       TRA     STOP                  52                                 3F4D1360
       TRA     STOP                  51                                 3F4D1370
       TRA     STOP                  50                                 3F4D1380
       TRA     CCSCFP                47                                 3F4D1390
       TRA     CCOCTL                46                                 3F4D1400
       TRA     STOP                  45                                 3F4D1410
       TRA     STOP                  44                                 3F4D1420
       TRA     CCLOGC                                                   3F4D1430
       TRA     STOP                  42                                 3F4D1440
       TRA     STOP                  41                                 3F4D1450
       TRA     CCSCFM                40                                 3F4D1460
       TRA     STOP                  37                                 3F4D1470
       TRA     STOP                  36                                 3F4D1480
       TRA     STOP                  35                                 3F4D1490
       TRA     CCRPAR                34                                 3F4D1500
       TRA     CCDCPT                33                                 3F4D1510
       TRA     STOP                  32                                 3F4D1520
       TRA     CCINTG                31                                 3F4D1530
       TRA     CCHOLL                30                                 3F4D1540
       TRA     STOP                  27                                 3F4D1550
       TRA     CCFFXD                26                                 3F4D1560
       TRA     CCEFLT                25                                 3F4D1570
       TRA     CCDFLT                24                                 3F4D1580
       TRA     STOP                  23                                 3F4D1590
       TRA     STOP                  22                                 3F4D1600
       TRA     CCALPH                21                                 3F4D1610
       TRA     STOP                  20                                 3F4D1620
       TRA     STOP                  17                                 3F4D1630
       TRA     STOP                  16                                 3F4D1640
       TRA     STOP                  15                                 3F4D1650
       TRA     STOP                  14                                 3F4D1660
       TRA     STOP                  13                                 3F4D1670
       TRA     STOP                  12                                 3F4D1680
       LGR     3                     11 - DIGIT 9                       3F4D1690
       LGR     3                     10 - DIGIT 8                       3F4D1700
       LGR     3                     7 - DIGIT 7                        3F4D1710
       LGR     3                     6 - DIGIT 6                        3F4D1720
       LGR     3                     5 - DIGIT 5                        3F4D1730
       LGR     3                     4 - DIGIT 4                        3F4D1740
       LGR     3                     3 - DIGIT 3                        3F4D1750
       LGR     3                     2 - DIGIT 2                        3F4D1760
       LGR     3                     1 - DIGIT 1                        3F4D1770
FRMTR  LGR     3                     0 - DIGIT 0                        3F4D1780
       REM  ENTRY FROM FORMAT SCAN ON LEFT PARENTHESIS.                 3F4D1790
CCLPAR LXA     GRCT,4                                                   3F4D1800
       TXI     *+1,4,1                                                  3F4D1810
       SXA     GRCT,4                                                   3F4D1820
       TXL     LPAR,4,2              GO TO SAVE IF ZERO OR FIRST LEVEL. 3F4D1830
       LXA     BX1,4                 SAVE FORMAT                        3F4D1840
       SXA     GRSAV1,4              SCAN POSITION                      3F4D1850
       LXA     BX2,4                 FOR FIRST LEVEL                    3F4D1860
       SXD     GRSAV1,4              PARENTHESIS.                       3F4D1870
       LXA     BX4,4                                                    3F4D1880
       SXD     GRCT,4                                                   3F4D1890
       CLA     MQR                                                      3F4D1900
       STO     GRSAV2                                                   3F4D1910
       LXA     GROUPX,4                                                 3F4D1920
       SXA     GRSAV3,4                                                 3F4D1930
       LXA     PARX,4                                                   3F4D1940
       SXD     GRSAV3,4                                                 3F4D1950
LPAR   SXA     BX1,1                 SAVE CURRENT                       3F4D1960
       SXA     BX2,2                 SCAN POSITION                      3F4D1970
       STQ     MQR                   FOR POSSIBLE RESCAN.               3F4D1980
       LXA     INT,4                 SAVE                               3F4D1990
       SXA     BX4,4                 GROUP COUNT, AND                   3F4D2000
       SXA     GROUPX,4              GROUP INDEX.                       3F4D2010
       LXA     ENDX,4                ADD 1 TO                           3F4D2020
       TXI     *+1,4,1               END PAREN COUNT                    3F4D2030
       SXA     ENDX,4                TO DETERMINE END OF FORMAT.        3F4D2040
       SXA     PARX,4                SAVE PAREN INDEX FOR RESCAN.       3F4D2050
       TRA     SCAN                * THEN CONTINUE SCAN.                3F4D2060
       REM  ENTRY FROM FORMAT SCAN ON COMMA.                            3F4D2070
CCCMMA AXC     RESUME-1,4            PROCESS CURRENT FIELD.             3F4D2080
       REM  FIELD,4 / CALLERS= CCCMMA, CCSLSH, CCRPAR, CCBLNK.          3F4D2090
FIELD  SXA     DONE,4                SAVE RETURN INDEX.                 3F4D2100
       SXA     CX2,2                 SAVE                               3F4D2110
       SXA     CX1,1                 CURRENT POSITION                   3F4D2120
       STQ     MQ                    OF FORMAT SCAN.                    3F4D2130
       LXA     INT,4                 PICKUP FIELD WIDTH,                3F4D2140
       TXL     DONE,4,0              IF NON-ZERO,                       3F4D2150
       SXA     WIDTH,4               SET WIDTH, AND                     3F4D2160
EXITSW TRA     LISTRT               *EXIT TO LIST CONTROL               3F4D2170
       CLA     TRA                   RESET SWITCH, IF THE END           3F4D2180
       STD     *-2                   OF FORMAT WAS JUST ENCOUNTERED.    3F4D2190
       TRA     ENDFSW+1            * EXIT TO CONVERSION.                3F4D2200
       REM  ENTRY FROM FORMAT SCAN ON SLASH.                            3F4D2210
CCSLSH TSX     FIELD,4             * GO PROCESS CURRENT FIELD.          3F4D2220
       AXC     RESUME-1,2            PREPARE FOR NEXT LINE OF I/O.      3F4D2230
       TRA     INOUTS                                                   3F4D2240
       REM  ENTRY FROM FORMAT SCAN ON P.                                3F4D2250
CCSCFP CLA     INT                   MOVE SCALE FACTOR                  3F4D2260
       STO     PEX                   INTO PEX.                          3F4D2270
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4D2280
       REM  ENTRY FROM FORMAT SCAN ON O.                                3F4D2290
CCOCTL NOP     *+2                   (INPUT/NOP, OUTPUT/TRA).           3F4D2300
       TXI     SETAD,4,ONPT-38       ADJUST FOR ONPT ENTRY, OR FOR      3F4D2310
       TXI     SETAD,4,OOUT-38       OOUT. EXIT TO SET CNVSW.           3F4D2320
       REM  ENTRY FROM FORMAT SCAN ON MINUS.                            3F4D2330
CCSCFM CLS     INT                   SET SIGN OF SCALE FACTOR NEGATIVE, 3F4D2340
       STO     INT                                                      3F4D2350
       TRA     SCAN5               * AND GO CONTINUE SCAN.              3F4D2360
       REM  ENTRY FROM FORMAT SCAN ON RIGHT PARENTHESIS.                3F4D2370
CCRPAR TSX     FIELD,4             * GO PROCESS CURRENT FIELD.          3F4D2380
BX4    AXT     **,4                  TEST GROUP COUNT, AND              3F4D2390
       TIX     GROUP,4,1             PROCESS GROUP UNTIL EXHAUSTED.     3F4D2400
       LXA     GRCT,4                RESET FORMAT SCAN POSITION         3F4D2410
       TXH     RSETGR,4,2            FOR FIRST LEVEL GROUP COUNT.       3F4D2420
       TXI     *+1,4,-1                                                 3F4D2430
       SXA     GRCT,4                                                   3F4D2440
ENDX   AXT     **,4                  THEN TEST END COUNT, AND           3F4D2450
       TNX     ENDFMT,4,1            IF NOT EXHAUSTED,                  3F4D2460
       SXA     ENDX,4                REDUCE COUNT, AND                  3F4D2470
       REM  ENTRY FROM CCSLSH, CCCMMA, CCHOLL, CCBLNK.                  3F4D2480
RESUME LDQ     MQ                    RESTORE                            3F4D2490
CX1    AXT     **,1                  CURRENT                            3F4D2500
CX2    AXT     **,2                  POSITION OF FORMAT SCAN.           3F4D2510
       REM  ENTRY FROM CCLPAR,CCSCFP,CCRPAR,CCINTG,CCHOLL.              3F4D2520
SCAN   STZ     INT                   CLEAR INT, AND                     3F4D2530
       TRA     SCAN5               * CONTINUE FORMAT SCAN.              3F4D2540
*         ENTRY ON LINE OVERFLOW                                     $5$3F4D2550
OVER   TSX     SETWRD,2                                              $5$3F4D2560
       REM  ENTRY FROM FORMAT SCAN ON ILLEGAL CONTROL CHARACTER.        3F4D2570
STOP   CLA*    FMTLOC                STORE FIRST WORD OF FORMAT         3F4D2580
       STO     E31MES+5              STATEMENT IN MESSAGE.              3F4D2590
       CLA     FMTLOC                CONVERT TO OCTAL AND STORE         3F4D2600
       TSX     CVBCD,4               IN MESSAGE.                        3F4D2620
       SLW     E31MES+2                                                 3F4D2630
FSTOP  CALL    .FXEM.(CODE)          EXIT FOR EXECUTION ERROR.          3F4D2650
       TRA     *+1                   INCORRECT FORMAT STATEMENT.        3F4D2660
ENDFMT CLA     TRA                   SET SWITCH IN IOCNV                3F4D2670
       STD     ENDFSW                FOR END OF FORMAT, AND             3F4D2680
       TRA     LISTRT               *GO SEE IF LIST IS EXHAUSTED        3F4D2690
       REM  REENTRY AFTER END OF FORMAT.                                3F4D2700
RESCAN CLA     CX1                   RESET TO NOP                       3F4D2710
       STD     ENDFSW                END OF FORMAT SWITCH.              3F4D2720
       STD     EXITSW                SET EXIT SWITCH IN FIELD.          3F4D2730
       TSX     INOUTS,2                                                 3F4D2740
PARX   AXT     **,4                  PICKUP PAREN INDEX TO              3F4D2750
       SXA     ENDX,4                RESET END COUNT.                   3F4D2760
       SXA     GRCT,4                                                   3F4D2770
GROUPX AXT     **,4                  PICKUP GROUP INDEX TO              3F4D2780
GROUP  SXA     BX4,4                 SET GROUP COUNT.                   3F4D2790
BX1    AXT     **,1                  RESET FORMAT POSITION              3F4D2800
BX2    AXT     **,2                  TO BEGINNING OF                    3F4D2810
       LDQ     MQR                   LAST GROUP, AND                    3F4D2820
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4D2830
RSETGR LXA     GRCT,4                                                   3F4D2840
       TXI     *+1,4,-1                                                 3F4D2850
       SXA     GRCT,4                                                   3F4D2860
       CLA     GRSAV1                RESET FORMAT SCAN POSITION         3F4D2870
       STA     BX1                   FOR FIRST LEVEL GROUP COUNT        3F4D2880
       ARS     18                    AFTER SECOND                       3F4D2890
       STA     BX2                   LEVEL GROUP                        3F4D2900
       CLA     GRSAV2                COUNT IS DEPLETED.                 3F4D2910
       STO     MQR                                                      3F4D2920
       CLA     GRSAV3                                                   3F4D2930
       STA     GROUPX                                                   3F4D2940
       ARS     18                                                       3F4D2950
       STA     PARX                                                     3F4D2960
       LXD     GRCT,4                                                   3F4D2970
       SXA     BX4,4                                                    3F4D2980
       TRA     ENDX                                                     3F4D2990
       REM  REENTRY FROM FORMAT SCAN FOR SINGLE PRECISION DECIMAL POINT.3F4D3000
CCDCPT CAL     DCPT                  MODIFY                             3F4D3010
       SLW     SCAN3                 SCAN.                              3F4D3020
       PXD     ,0                    CLEAR OR STORE DEC. SCALE          3F4D3030
DCPT1  STO     DIG                   ..                                 3F4D3040
       TRA     SCAN5               * GO CONTINUE SCAN.                  3F4D3050
       REM  REENTRY FROM FORMAT SCAN.                                   3F4D3060
DCPT   TRA     *+1                   COLLECT                            3F4D3070
       TXL     DCPT1,4,9             DECIMAL POSITION.                  3F4D3080
DCPT2  SUB     BLANK                 ON NEXT                            3F4D3090
       TZE     SCAN5               * CONTROL CHARACTER,                 3F4D3100
       CAL     *+2                   RESET                              3F4D3110
       SLW     SCAN3                 FORMAT SCAN                        3F4D3120
       XEC     FRMTR,4             * AND GO CONTINUE SCAN.              3F4D3130
       REM  REENTRY FROM FORMAT SCAN FOR DOUBLE PRECISION DECIMAL POINT.3F4D3140
DDCPT  TRA     *+1                                                      3F4D3150
       TXH     DCPT2,4,9             IF NUMERIC CHARACTER,              3F4D3160
       LGR     3                     MULTIPLY PREVIOUS DIGIT BY 10      3F4D3170
       ADM     DIG                   AND ADD IN CURRENT DIGIT.          3F4D3180
       LGL     3                                                        3F4D3190
       ADM     DIG                                                      3F4D3200
       ACL     DIG                                                      3F4D3210
       PAX     0,4                   TEST MAGNITUDE OF DIG.             3F4D3220
       TXL     DCPT1,4,17            IF GREATER THAN 17,                3F4D3230
       AXT     17,4                  SET VALUE OF DIG                   3F4D3240
       PXA     0,4                   EQUAL TO 17.                       3F4D3250
       TRA     DCPT1                                                    3F4D3260
       REM  ENTRY FROM FORMAT SCAN ON I.                                3F4D3270
CCINTG NOP     SETAD1                IF INPUT,                          3F4D3280
       CLA     TRA                   PICKUP TRA, AND                    3F4D3290
       REM  ENTRY FROM CCFFXD.                                          3F4D3300
SETFX  STD     FIXSW                 SET FIXSW, AND                     3F4D3310
       AXT     DBC,4                 PICKUP DBC TO                      3F4D3320
       REM  ENTRY FROM CCFFXD, CCEFLT, CCOCTL, CCALPH.                  3F4D3330
SETAD  SXA     CNVSW,4               SET CNVSW.                         3F4D3340
       LXA     INT,4                 PICKUP INT, AND                    3F4D3350
       SXA     COUNT,4               SET COUNT.                         3F4D3360
       TRA     SCAN                * GO CONTINUE SCAN.                  3F4D3370
SETAD1 TXI     SETAD,4,INTG-25       OUTPUT INTEGER, SET CNVSW.         3F4D3380
       REM  ENTRY FROM FORMAT SCAN ON H.                                3F4D3390
CCHOLL LXA     INT,4                 REPLACE                            3F4D3400
       NOP     HOUT                  IF INPUT, THE                      3F4D3410
       LDQ     MQD                   HOLLERITH                          3F4D3420
       SXA     CX2,2                 FIELD                              3F4D3430
       CAL     0,2                   IN                                 3F4D3440
       LXA     .FDX1,2               FORMAT                             3F4D3450
       TNX     HNPT3,1,6             STATEMENT                          3F4D3460
       SXA     *+1,1                 WITH THE SPECIFIED NO.             3F4D3470
       ARS     **                                                       3F4D3480
HNPT1  TIX     HNPT2,2,1             OF                                 3F4D3490
       LXA     .FDX2,2               BCD                                3F4D3500
       TXI     *+1,2,-1              CHARACTERS                         3F4D3510
       LDQ*    .FBDBF                FROM                               3F4D3520
       SXA     .FDX2,2               THE                                3F4D3530
       AXT     6,2                   INPUT                              3F4D3540
HNPT2  LGL     6                     BUFFER.                            3F4D3550
       TNX     HNPT4,4,1             ..                                 3F4D3560
       TIX     HNPT1,1,6             ..                                 3F4D3570
HNPT3  LXA     CX2,1                 ..                                 3F4D3580
       SLW     0,1                   ..                                 3F4D3590
       TXI     *+1,1,-1              ..                                 3F4D3600
       SXA     CX2,1                 ..                                 3F4D3610
       AXT     36,1                  ..                                 3F4D3620
       TRA     HNPT1                 ..                                 3F4D3630
HNPT4  SXA     .FDX1,2               ..                                 3F4D3640
       LXA     CX2,2                 ..                                 3F4D3650
       STQ     MQD                   ..                                 3F4D3660
       SXA     CX1,1                 ..                                 3F4D3670
       TXL     HNPT5,1,6             ..                                 3F4D3680
       LDQ     0,2                   ..                                 3F4D3690
       RQL     42,1                  ..                                 3F4D3700
       STQ     MQ                    ..                                 3F4D3710
       TNX     HNPT5,1,6             ..                                 3F4D3720
       SXA     *+1,1                 ..                                 3F4D3730
       LGL     **                    ..                                 3F4D3740
HNPT5  SLW     0,2                   ..                                 3F4D3750
       TRA     RESUME              * GO RESUME FORMAT SCAN.             3F4D3760
       REM  ENTRY FROM FORMAT SCAN ON X.                                3F4D3770
CCBLNK LXA     INT,4                 SET TO SKIP INT BLANKS CHARS.      3F4D3780
       STQ     MQ                    IN DATA OR OUTPUT BUFFER           3F4D3790
       SXA     CX1,1                 ..                                 3F4D3800
       SXA     CX2,2                 ..                                 3F4D3810
SKIP   NOP     BOUT                  IF INPUT. SKIP THE SPECIFIED       3F4D3820
       LDQ     MQD                   BCD                                3F4D3830
       LXA     .FDX1,1               CHARACTERS                         3F4D3840
SKIP1  TIX     SKIP2,1,1             IN                                 3F4D3850
       LXA     .FDX2,2               THE                                3F4D3860
       TXI     *+1,2,-1              INPUT                              3F4D3870
       TIX     *-1,4,6               BUFFER.                            3F4D3880
       LDQ*    .FBDBF                ..                                 3F4D3890
       SXA     .FDX2,2               ..                                 3F4D3900
       AXT     6,1                   ..                                 3F4D3910
SKIP2  LGL     6                     ..                                 3F4D3920
       TIX     SKIP1,4,1             ..                                 3F4D3930
       SXA     .FDX1,1               ..                                 3F4D3940
       STQ     MQD                   ..                                 3F4D3950
       TRA     RESUME              * GO RESUME FORMAT SCAN.             3F4D3960
BOUT   SXA     COUNT,0               PLACE BLANKS INTO THE OUTPUT       3F4D3970
       AXC     RESUME-1,2            BUFFER                             3F4D3980
       SXA     DONE,2                USING THE TOPACK ROUTINE           3F4D3990
       TXH     *+2,4,0                                               (6)3F4D3993
       AXT     1,4                IF 0 MAKE IT 1                     (6)3F4D3996
       TRA     XCF                                                   $5$3F4D4000
       REM  ENTRY FROM FORMAT SCAN ON A.                                3F4D4010
CCALPH NOP     *+2                   IF INPUT, ADJUST FOR               3F4D4020
       TXI     SETAD,4,ANPT-17     * ANPT ENTRY, OR FOR                 3F4D4030
       TXI     SETAD,4,AOUT-17     * AOUT. EXIT TO SET CNVSW.           3F4D4040
       REM  ENTRY FROM FORMAT SCAN ON F.                                3F4D4050
CCFFXD CLS     PEX                   MOVE NEGATIVE OF                   3F4D4060
       STO     .FEXP                 SCALE FACTOR INTO EXP              3F4D4070
       NOP     *+3                   IF INPUT,                          3F4D4080
       REM  ENTRY FROM CCEFLT.                                          3F4D4090
FXPT   CLA     CX1                   PICK UP NOP,AND                    3F4D4100
       TRA     SETFX               * GO SET FIXSW.                      3F4D4110
       AXT     FXD,4                 PICKUP FXD, AND                    3F4D4120
       SXA     CNVSW,4               SET GATE AT CNVSW.                 3F4D4130
       TRA     SETAD+1             * GO SET COUNT.                      3F4D4140
       REM  ENTRY FROM FORMAT SCAN ON E.                                3F4D4150
CCEFLT NOP     *+3                   IF INPUT,                          3F4D4160
       STZ     .FEXP                 CLEAR EXP AND                      3F4D4170
       TRA     FXPT                * EXIT TO CCFFXD.                    3F4D4180
       AXT     FLT,4                 PICKUP FLT, AND                    3F4D4190
       SXA     CNVSW,4               ..                                 3F4D4200
       TRA     SETAD+1       GO TO SET COUNT                         $5$3F4D4210
       REM  ENTRY FROM FORMAT SCAN ON D.                                3F4D4220
CCDFLT AXT     DDCPT,4               SET DOUBLE PRECISION EXIT IN       3F4D4230
       SXA     CCDCPT,4              DECIMAL POINT SCAN.                3F4D4240
       STL     DDDFLG                SET FLAG FOR D IN FORMAT SCAN.     3F4D4250
       NOP     CCDOUT                IF DOUBLE PRECISION INPUT,         3F4D4260
       STZ     .FEXP                 CLEAR EXP AND SET DOUBLE           3F4D4270
       LXA     DBC20,4               PRECISION EXITS FOR -              3F4D4280
       SXA     D1,4                  OVERFLOW IN DBC ROUTINE,           3F4D4290
       AXT     DDBC,4                                                   3F4D4300
       SXA     DBC20,4                                                  3F4D4310
       LXA     DDSW,4                DOUBLE PRECISION FIX,              3F4D4320
       SXA     D2,4                                                     3F4D4330
       AXT     DDFIX,4                                                  3F4D4340
       SXA     DDSW,4                                                   3F4D4350
       AXT     DEXPON,4              SCAN OF D IN EXPONENT FIELD.       3F4D4360
       SXA     DBC10,4                                                  3F4D4370
       TRA     FXPT                                                     3F4D4380
CCDOUT AXT     DFLT,4                IF OUTPUT, SET                     3F4D4390
       SXA     CNVSW,4               CONVERSION SWITCH,                 3F4D4400
       TRA     SETAD+1                                               $5$3F4D4410
       REM  ENTRY FROM FORMAT SCAN ON L                                 3F4D4420
CCLOGC NOP     *+2                   (INPUT/NOP, OUTPUT/TRA)            3F4D4430
       TXI     SETAD,4,LNTP-35       LNTP ENTRY FOR INPUT OR            3F4D4440
       TXI     SETAD,4,LOUT-35       LOUT ENTRY FOR OUTPUT. SET CNVSW.  3F4D4450
       REM  ENTRY FROM MAIN PROGRAM.                                    3F4D4460
.FFIL. SXA     LISTDN,4                                                 3F4D4470
       SXA     LISTDN+2,1                                               3F4D4480
       SXA     LISTDN+1,2                                               3F4D4490
       STZ     ONLIN                                                    3F4D4500
       XEC     GAIN1          RESET OUTBUF LOCATION COUNT            $5$3F4D4510
       TXH     *+2,2,LIMIT-1     IF OUTBUF EMPTY                     $5$3F4D4520
       TRA     FINISH         OUTBUF NOT EMPTY                       $5$3F4D4530
       XEC     GAIN           RESET OUTBUF CHARACTER COUNT           $5$3F4D4540
       TXH     *+2,1,5        NO CHARACTERS FOR OUTPUT               $5$3F4D4550
FINISH TSX     INOUTS,2                                                 3F4D4560
       STZ     GRCT                  RESTORE GROUP COUNTER.             3F4D4570
       NZT     DDDFLG                TEST WHETHER DP EXITS RESTORED.    3F4D4580
       TRA     LISTDN                                                   3F4D4590
       STZ     DDDFLG                RESTORE DOUBLE PRECISION           3F4D4600
       STZ     DDFLAG                EXITS CHANGED FOR OUTPUT.          3F4D4610
       AXT     DCPT,4                                                   3F4D4620
       SXA     CCDCPT,4                                                 3F4D4630
LISTDN AXT     **,4                                                     3F4D4640
       AXT     **,2                                                     3F4D4650
       AXT     **,1                                                     3F4D4660
       TRA     1,4                                                      3F4D4670
       REM  ENTRY FROM MAIN PROGRAM.                                    3F4D4680
.FRTN. SXA     LISTDN,4                                                 3F4D4690
       SXA     LISTDN+1,2                                               3F4D4700
       SXA     LISTDN+2,1                                               3F4D4710
RTN1   STZ     GRCT                                                     3F4D4720
       NZT     DDDFLG                TEST WHETHER DP EXITS RESTORED.    3F4D4730
       TRA     LISTDN                                                   3F4D4740
       STZ     DDDFLG                RESTORE DOUBLE PRECISION           3F4D4750
       TSX     DDRST1,2              EXITS CHANGED FOR INPUT.           3F4D4760
       TRA     LISTDN                                                   3F4D4770
LISTRT ZET     DIVRT                                                    3F4D4780
       TRA     .LIST                 NO-LIST COMPLETE,RETURN TO M.P.    3F4D4790
       STL     DIVRT                                                    3F4D4800
SV7    AXT     **,7                                                  (6)3F4D4802
SV6    AXT     **,6                                                  (6)3F4D4803
SV5    AXT     **,5                                                  (6)3F4D4804
SV3    AXT     **,3                                                  (6)3F4D4805
SV2    AXT     **,2                                                     3F4D4810
SV1    AXT     **,1                                                     3F4D4820
LIST   AXT     **,4                                                     3F4D4830
       TRA     1,4                                                      3F4D4840
*      ROUTINE TO HANDLE INPUT OUTPUT ,CALCULATE S WORD COUNT           3F4D4850
*      AND RESETS BUFFER IF OUTPUT                                      3F4D4860
INOUTS SXA     RET,2                                                    3F4D4870
       NOP     FILWD                                                    3F4D4880
INOUT  TSX     **,2                                                     3F4D4890
       NOP     RESET+1                                                  3F4D4900
RET    AXT     **,2                                                     3F4D4910
       TRA     1,2                                                      3F4D4920
FILWD  XEC     GAIN1          RESET OUTBUF LOCATION COUNT            $5$3F4D4930
       XEC     GAIN           RESET OUTBUF CHARACTER COUNT           $5$3F4D4940
*      CALCULATE CHARACTER COUNT FOR THIS LINE, (LIMIT-XR2)*6+(7-XR1)(8)3F4D4941
*      IF IT IS GREATER THAN CHLIMT LINE OVERFLOWS                   (8)3F4D4942
       SXA     CHRS,1              SAVE CHAR COUNT                   (8)3F4D4943
       TXI     *+1,1,-7            GET (XR1-7)                       (8)3F4D4944
       SXD     CHCNT,1                                               (8)3F4D4945
       TXI     *+1,2,-LIMIT        GET (XR2-LIMIT)                   (8)3F4D4946
       PXA     ,2                                                    (8)3F4D4947
       STA     NOP                                                   (8)3F4D4948
       ALS     1                                                     (8)3F4D4949
       ADD     NOP                                                   (8)3F4D4950
       ALS     1                                                     (8)3F4D4951
       PAX     ,1                  GET (XR2-LIMIT)*6                 (8)3F4D4952
CHCNT  TXI     *+1,1,**            ADD (XR1-6)                       (8)3F4D4953
       TXL     TEST,1,-CHLIMT-2    IF LINE OVERFLOWS                 (8)3F4D4954
CHRS   AXT     **,1                NO, NUMBER OF CHAR REMAINING      (8)3F4D4955
       TXH     OUT1,1,5            IF NO CHAR LEFT TO GO IN BUFFER   (8)3F4D4956
       LDQ     QSTO           BCD CHARACTERS                         $5$3F4D4960
       RQL     6              LEFT-JUSTIFY BCD CHARACTERS IN MQ      $5$3F4D4970
       TIX     *-1,1,1                                               $5$3F4D4980
       XEC     GAIN1               RESET OUTBUF LOC COUNTER          (8)3F4D4981
       STQ*    BUF           STORE INTO OUTPUT BUFFER                $5$3F4D4990
       TXI     *+1,2,-LIMIT-1                                        (8)3F4D5000
OUT1   PCA     ,2                  CALCULATE NUMBER OF WORDS         (8)3F4D5020
       PAX     ,1                                                    $5$3F4D5030
       TXH     INOUT,1,2                                             $5$3F4D5050
       AXT     3,1                   LESS THAN THREE WORDS-FIX AT 3     3F4D5060
       TRA     INOUT                                                    3F4D5070
SETWRD AXT     1,1                                                   $5$3F4D5080
       SXA     GAIN1,1                                               $5$3F4D5090
       AXT     6,1                                                   $5$3F4D5100
       SXA     GAIN,1                                                $5$3F4D5110
       TRA     1,2                                                   $5$3F4D5120
BLANKS BCI     1,                                                       3F4D5130
L(1)   PZE     1                                                        3F4D5140
       OCT     20                                                       3F4D5150
BLANK  BCI     1,00000                                                  3F4D5160
FILT   SLW     OUTBUF                                                   3F4D5170
INT    PZE                                                              3F4D5180
MQR    PZE                                                              3F4D5190
MQ     PZE                                                              3F4D5200
CT     PZE     **                                                       3F4D5210
FMTLOC PZE     **                    LOCATION OF START OF FORMAT.       3F4D5220
FILEBK PZE     **                    LOCATION OF FILE CONTROL BLOCK.    3F4D5230
       REM                           OCCUPIES TWO CELLS.                3F4D5240
PPFLAG PZE     **                    NON-ZERO IF PRINT OR PUNCH OUTPUT. 3F4D5250
CDFLAG PZE     **                    NON-ZERO IF ON-LINE CARD INPUT.    3F4D5260
GRSAV3 PZE     **                                                       3F4D5270
GRSAV2 PZE     **                                                       3F4D5280
GRSAV1 PZE     **                                                       3F4D5290
GRCT   PZE     **                                                       3F4D5300
NOP    NOP                                                              3F4D5310
DIVRT  PZE                                                              3F4D5320
ONLIN  PZE                                                              3F4D5330
LIMIT  EQU     LIMIT5/6+1          LINE LIMIT IN WORDS               (8)3F4D5340
LIMIT5 EQU     CHLIMT                                               (14)3F4D5341
RESET  SXA     RET,2                                                    3F4D5350
       AXT     6,2                                                   $5$3F4D5360
       SXA     GAIN,2                                                $5$3F4D5370
       AXT     LIMIT,2                                               $5$3F4D5380
       SXA     GAIN1,2                                               $5$3F4D5390
       LDQ     BLANKS                                                $5$3F4D5400
       STQ     QSTO                                                  $5$3F4D5410
       CAL     BLANKS                                                   3F4D5420
       SLW     OUTBUF                                                   3F4D5430
       SLW     OUTBUF+1                                                 3F4D5440
       SLW     OUTBUF+2                                                 3F4D5450
       TRA     RET                                                      3F4D5460
CVBCD  XCA                           CONVERT BINARY ADDRESS             3F4D5470
       RQL     21                    TO OCTAL.                          3F4D5480
       CLA     BLANKS                                                   3F4D5490
       SXA     *+5,1                                                    3F4D5500
       AXT     5,1                                                      3F4D5510
       ALS     3                                                        3F4D5520
       LGL     3                                                        3F4D5530
       TIX     *-2,1,1                                                  3F4D5540
       AXT     **,1                                                     3F4D5550
       TRA     1,4                                                      3F4D5560
CODE   PZE     31                                                       3F4D5570
ER31MS PZE     E31MES,,16                                               3F4D5580
ER31OP PZE     E31OMS,,4                                                3F4D5590
E31MES BCI ,0FORMAT AT   XXXXX,FIRST WORD XXXXXX, HAS ILLEGAL CONTROL CH3F4D5600
       BCI     6,ARACTER OR SPECIFIES TOO LONG A LINE                   3F4D5610
E31OMS BCI     4,0TREAT AS END OF FORMAT                                3F4D5620
LNKG   LDIR                                                             3F4D5630
       BCI     1,FIOH                                                   3F4D5640
END94  NULL                                                          $5$3F4D5650
       END                                                           $5$3F4D5660
$*     7090/7094 BCD WRITE ROUTINE-FWRD                                 3F4E0000
$IBMAP FWRD    30,()OK                                                  3F4E0010
       TTL     FWRD-BCD WRITE ROUTINE                                   3F4E0020
*              BCD WRITE ROUTINE                                        3F4E0030
*              CALLING SEQUENCE IS                                      3F4E0040
*              CALL .FWRD.(ARG,LF) COMPIKED FOR WRITE(N,F)              3F4E0050
*              ARG= LOC OF PZE UNITXX WHERE XX IS LOGICAL UNIT N.       3F4E0060
*      LF= LOC LF= LOC OF FORMAT STATEMENT F.                           3F4E0070
*                                                                       3F4E0080
       ENTRY   .FWRD.                                                   3F4E0090
OUTBUF EQU     .OUTBF                                                   3F4E0091
.FWRD. SXA     SYSLOC,4              SAVE RETURN TO MAIN PROGRAM AND SET3F4E0100
       SXA     LNKG,4                LINKAGE DIRECTOR FOR ERROR TRACE.  3F4E0110
       SXA     RTRN,4                RETURN TO MAIN PROGRAM             3F4E0115
       CALL    .FIOS.(ARG1,ARG2)     CALL I/O INITIALIZATION ROUTINE    3F4E0116
       ORG     *-2                   OVERLAY CALL WITH ARGUMENTS        3F4E0120
ARG1   PZE     0,,0                  ADDRESS= REED ,DEC. =BIN           3F4E0130
ARG2   IOCD    OUTBUF,,**            TRANSMIT A LINE                    3F4E0140
       CALL    .FIOH.(RTNWR,RTRN)    BUILD A BUFFER                     3F4E0150
       ORG     *-2                   OVERLAY CALL WITH ARGUMENTS        3F4E0160
RTNWR  TRA     WRENT                 TRA=OUTPUT,WRENT =LOC. OF WRITE    3F4E0170
RTRN   PZE                           CONTAINS RETURN TO MAIN PROGRAM    3F4E0180
WRENT  SXA     WRRT,2                COME HERE TO TRANSMIT              3F4E0190
       SXD     .FILL.,1              STORE WORD COUNT                   3F4E0200
       TSX     .FRTD.,4              WRITE A LINE                       3F4E0210
WRRT   AXT     **,2                  RESTORE XR                         3F4E0220
       TRA     1,2                   AND RETURN                         3F4E0230
LNKG   LDIR                                                             3F4E0240
       END                                                              3F4E0250
$*     7090/7094 BINARY WRITE ROUTINE                                   3F4F0000
$IBMAP FWRB                                                             3F4F0010
       TTL     BINARY WRITE ROUTINE                                     3F4F0020
*              BINARY WRITE ROUTINE                                     3F4F0030
       ENTRY   .FWRB.                                                   3F4F0040
.FWRB. SXA     LNKG,4                                                   3F4F0050
       SXA     SYSLOC,4                                                 3F4F0060
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3F4F0065
       CALL    .FIOS.(ARG1,ARG2)     CALL                               3F4F0066
       ORG     *-2                                                      3F4F0070
ARG1   PZE     0,,1                                                     3F4F0080
ARG2   IOSTN*  .FBIBF,,**            TRANSMIT I/O COMMAND               3F4F0090
       CLA     .FCKSZ                GET BLOCK SIZE FROM FIOS           3F4F0100
       CALL    .FIOB.(RTNWB,RTRN)    BUILD BUFFER                       3F4F0110
       ORG     *-2                   OVERLAY CALL WITH ARGS             3F4F0115
RTNWB  TRA     WRRB                  TRA=OUTPUT ,WRRB=LOC. OF WRITE     3F4F0120
RTRN   PZE                           TRANSMIT ADDRESS OF CALL           3F4F0130
WRRB   LXD     .FRITE,4              SET WORD COUNT                     3F4F0150
       SXD     .FRTB.+3,4            IN IOCS.                           3F4F0160
       TSX     .FRTB.,4              WRITE A RECORD                     3F4F0170
       TRA     1,2                                                      3F4F0180
LNKG   LDIR                                                             3F4F0200
       END                                                              3F4F0220
$*     7090/7094 BCD READ ROUTINE - FRDD                                3F4G0000
$IBMAP FRDD    15                                                       3F4G0010
       TTL     FRDD-BCD READ ROUTINE                                    3F4G0020
*              BCD READ ROUTINE                                         3F4G0030
*              CALLING SEQUENCE IS                                      3F4G0040
*              CAL .FRDD.(ARG,LF) COMPILED FOR READ(N,F)                3F4G0050
*              ARG= LOC OF PZE UNITXX WHERE XX= LOGICAL UNIT N.         3F4G0060
*              LF = LOC OF FORMAT STATEMENT F                           3F4G0070
*                                                                       3F4G0080
*                                                                       3F4G0090
       ENTRY   .FRDD.                                                   3F4G0100
.FRDD. SXA     LNKG,4                SAVE RETURN TO MAIN PROGRAM AND    3F4G0110
       SXA     SYSLOC,4              SET LINKAGE DIRECTOR FOR ERRORTRACE3F4G0120
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3F4G0125
       CALL    .FIOS.(ARG1,ARG2)     CALL I/O INITIALIZATION ROUTINE    3F4G0126
       ORG     *-2                                                      3F4G0130
ARG1   PZE     1,,0                                                     3F4G0140
ARG2   IORTN*  .FBDBF,,**            TRANSMIT I/O COMMAND               3F4G0150
       CALL    .FIOH.(RTNRD,RTRN)    CALL BUFFER BUILDER                3F4G0160
       ORG     *-2                                                      3F4G0170
RTNRD  NOP     RDENT                 NOP=READ,RDENT=ADDRESS OF READ     3F4G0180
RTRN   PZE     1                     TRANSMIT LOC. OF CALL              3F4G0190
RDENT  SXA     RDRT,2                ENTER HERE FOR LINE OF INPUT       3F4G0210
       TSX     .FSEL.,4            READ A RECORD                        3F4G0220
       AXT     1,2                   RESET BUFFER                       3F4G0230
       SXA     .FDX1,2               POINTER FOR                        3F4G0240
       SXA     .FDX2,2               BUFFER BUILDER                     3F4G0250
RDRT   AXT     **,2                  RETURN TO .FIOH.                   3F4G0260
       TRA     1,2                   TO CONVERT DATA                    3F4G0270
LNKG   LDIR                                                             3F4G0290
       END                                                              3F4G0310
$*     7090/7094 BINARY READ ROUTINE                                    3F4H0000
$IBMAP FRDB                                                             3F4H0010
       TTL     FRDB/BINARY READ ROUTINE.                                3F4H0020
       ENTRY   .FRDB.                                                   3F4H0030
.FRDB. SXA     LNKG,4                                                   3F4H0040
       SXA     SYSLOC,4                                                 3F4H0050
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3F4H0055
       CALL    .FIOS.(ARG1,ARG2)     CALL I/O INITIALIZATION ROUTINE    3F4H0056
       ORG     *-2                   OVERLAY CALL WITH ARGS.            3F4H0060
ARG1   PZE     1,,1                  ADD=REED,DEC.=BIN                  3F4H0070
ARG2   IORTN*  .FBIBF,,**            TRANSMIT IO COMMAND                3F4H0080
       CLA     .FCKSZ                GET BLOCK SIZE                     3F4H0090
       CALL    .FIOB.(RTNRB,RTRN)    CALL BUFFER BUILDER                3F4H0100
       ORG     *-2                                                      3F4H0110
RTNRB  NOP     RDDB                  NOP=READ                           3F4H0120
RTRN   PZE                           TRANSMIT LOC. OF CALL              3F4H0130
RDDB   TSX     .FSEL.,4              READ A RECORD.                     3F4H0150
       LXD     .FCT,4                STORE COUNT IN FIOB FROM           3F4H0160
       SXD     .FCNT,4               FIOS                               3F4H0170
       TRA     1,2                   RETURN TO FIOB.                    3F4H0180
LNKG   LDIR                                                             3F4H0200
       END                                                              3F4H0220
$*     7090/7094 BCD ONLINE PRINT ROUTINE                               3F4J0000
$IBMAP FPRN    ()OK                                                     3F4J0010
       TTL     FPRN - BCD ONLINE PRINT ROUTINE                       (6)3F4J0020
*              BCD ONLINE PRINT ROUTINE                                 3F4J0030
       ENTRY   .FPRN.                                                   3F4J0040
OUTBUF EQU     .OUTBF                                                   3F4J0041
.FPRN. SXA     LNKG,4                                                   3F4J0050
       SXA     SYSLOC,4                                                 3F4J0060
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3F4J0065
       CALL    .FIOH.(RTNPR,RTRN)                                       3F4J0066
       ORG     *-2                   OVERLAY CALL                       3F4J0070
RTNPR  TRA     FPRINT,1              TRA=OUTPUT,TAG=ONLIN SWITCH ON     3F4J0071
RTRN   PZE                           TRANSMIT LOC. OF CALL              3F4J0080
       REM  ROUTINE TO PRINT ONE BCD RECORD ON-LINE                     3F4J0130
FPRINT SXA     RETURN,2                                                 3F4J0140
       SXA     FILL,1                GET WORD COUNT FOR IOEX            3F4J0160
       AXT     0,1                                                      3F4J0170
       PXD     0,0                                                      3F4J0180
       LDQ     OUTBUF                                                   3F4J0190
       LGL     6                     GET CARRIAGE CONTROL CHARACTER.    3F4J0200
       TZE*    SP                    DOUBLE SPACE.                      3F4J0210
       AXT     3,2                                                      3F4J0220
       CAS     BLANK+1,2             DETERMINE WHETHER EJECT,           3F4J0230
       TRA     *+2                   SUPPRESS SPACE OR                  3F4J0240
       TRA*    SP,2                  SINGLE SPACE REQUESTED.            3F4J0250
       TIX     *-3,2,1                                                  3F4J0260
SINGL  STZ     SPACE                 ASSUME SINGLE SPACE.               3F4J0270
       TRA     PRN                                                      3F4J0280
SUPS   AXT     SUPSP,4               SUPPRESS SPACING                   3F4J0290
       TRA     DOUBL+1                                                  3F4J0300
DOUBL  STZ     SPACE                 DOUBLE SPACE REQUESTED.            3F4J0310
       CLA     DOUBL1-1                                                 3F4J0320
       STD     DBSPSW                                                   3F4J0330
       TRA     PRN                                                      3F4J0340
DOUBL1 CLA     NOP                                                      3F4J0350
       STD     DBSPSW                                                   3F4J0360
       STZ     PRNT+2,1                                                 3F4J0370
       TXI     DBSPSW+1,1,-1                                            3F4J0380
EJCT   CLA     EJECT                 EJECT REQUESTED. SET TO EJECT      3F4J0390
       STO     PRNT+2                PAGE BEFORE PRINTING.              3F4J0400
       TXI     SINGL,1,-1            SET FOR SINGLE SPACE AFTER PRINT.  3F4J0410
PRN    CLA     BLANK                 DELETE CARRIAGE CONTROL            3F4J0420
       LGR     6                     IN OUTPUT BUFFER.                  3F4J0430
       STQ     OUTBUF                                                   3F4J0440
FILL   AXT     **,2                                                     3F4J0450
       TXH     PRN2,2,12             MORE THAN 12 BCD WORDS TO PRINT.   3F4J0460
       PXD     0,2                   12 OR LESS BCD WORDS TO PRINT.     3F4J0470
       ADD     SPACE                 SET NUMBER OF WORDS AND SPACE      3F4J0480
       STD     PRNT1                 CONTROL IN MWR CALLING SEQUENCE    3F4J0490
       CLA     PRNT1                 WORD.                              3F4J0500
       STO     PRNT+2,1                                                 3F4J0510
PRN1   TXI     *+1,1,-1                                                 3F4J0520
DBSPSW NOP     DOUBL1                                                   3F4J0530
       PXA     0,1                   OBTAIN NUMBER OF WORDS IN          3F4J0540
       PAC     0,1                   CALLING SEQUENCE AND PLACE         3F4J0550
       SXA     PRNT+1,1              COUNT IN MWR CALLING               3F4J0560
       TRA     PRNT                  SEQUENCE. GO TO PRINT.             3F4J0570
PRN2   TXH     PRN4,2,20             MORE THAN 20 BCD WORDS TO PRINT.   3F4J0580
       TXI     *+1,2,-12             DETERMINE NUMBER OF CHARACTERS     3F4J0590
PRN3   PXD     0,2                   IN EXCESS OF 72. PLACE NUMBER      3F4J0600
       ADD     SPACE                 AND SPACE CONTROL IN MWR           3F4J0610
       STD     PRNT2                 CALLING SEQUENCE WORD.             3F4J0620
       AXT     12,2                  SET FOR FIRST 72 CHARACTERS        3F4J0630
       TXI     *+1,2,SUPSP           WITH SPACE SUPPRESS.               3F4J0640
       SXD     PRNT1,2                                                  3F4J0650
       CLA     PRNT1                 PLACE IN MWR CALLING SEQUENCE.     3F4J0660
       STO     PRNT+2,1                                                 3F4J0670
       TXI     *+1,1,-1                                                 3F4J0680
       CLA     PRNT2                                                    3F4J0690
       STO     PRNT+2,1                                                 3F4J0700
       TRA     PRN1                                                     3F4J0710
PRN4   AXT     8,2                   TRUNCATE OUTPUT REQUEST TO         3F4J0720
       TRA     PRN3                  120 CHARACTERS.                    3F4J0730
PRNT   TSX     .MWR,4                PRINT ONE RECORD ON-LINE.          3F4J0740
       PZE     **                                                       3F4J0750
       NOP                                                              3F4J0760
       NOP                                                              3F4J0770
       NOP                                                              3F4J0780
       NOP                                                              3F4J0790
       CLA     NOP                   RESET MWR                          3F4J0800
       STO     PRNT+2                CALLING                            3F4J0810
       STO     PRNT+3                SEQUENCE.                          3F4J0820
       STO     PRNT+4                                                   3F4J0830
       STO     PRNT+5                                                   3F4J0840
RETURN AXT     **,2                                                     3F4J0870
       TRA     1,2                                                      3F4J0880
       PZE     EJCT                                                     3F4J0890
       PZE     SUPS                                                     3F4J0900
       PZE     SINGL                                                    3F4J0910
SP     PZE     DOUBL                                                    3F4J0920
SPACE  PZE     **                                                       3F4J0930
EJECT  PZE     0,,512                                                   3F4J0940
SUPSP  EQU     512*9                                                    3F4J0950
PRNT1  PZE     OUTBUF,,**                                               3F4J0960
PRNT2  PZE     OUTBUF+12,,**                                            3F4J0970
       PZE     1                                                     (6)3F4J0980
       OCT     20                                                       3F4J0990
BLANK  BCI     1,00000                                                  3F4J1000
NOP    NOP                                                              3F4J1010
BLANKS BCI     1,                                                       3F4J1020
LNKG   LDIR                                                             3F4J1030
       END                                                              3F4J1050
$*     7090/7094 BCD PUNCH ROUTINE                                      3F4K0000
$IBMAP FPUN    ()OK                                                     3F4K0010
       TTL     BCD PUNCH ROUTINE                                        3F4K0020
*              BCD PUNCH ROUTINE                                        3F4K0030
       REM  ROUTINE TO PUNCH ONE BCD RECORD ON-LINE                     3F4K0040
       ENTRY   .FPUN.                                                   3F4K0050
OUTBUF EQU     .OUTBF                                                   3F4K0051
.FPUN. SXA     LNKG,4                SAVE RETURN TO OBJECT PROGRAM      3F4K0060
       SXA     SYSLOC,4                                                 3F4K0070
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3F4K0075
       CALL    .FIOH.(RTNPU,RTRN)                                       3F4K0076
       ORG     *-2                   OVERLAY CALL                       3F4K0080
RTNPU  TRA     FPUNCH,1              TRA=OUTPUT,TAG=ONLIN SWITCH ON     3F4K0081
RTRN   PZE     0,,0                                                     3F4K0090
*              ROUTINE TO PUNCH BCD RECORD ONLINE                       3F4K0140
FPUNCH SXA     RETURN+1,2                                               3F4K0150
       TXH     PUN3,1,12             IF WORD COUNT NOT GREATER THAN 12  3F4K0170
PUN1   SXD     PUN2,1                SET NUMBER OF BCD WORDS TO         3F4K0180
       TSX     .PUNCH,4              BE PUNCHED IN IOEX                 3F4K0190
       PZE     1                     CALLING SEQUENCE.                  3F4K0200
PUN2   PZE     OUTBUF,,**                                               3F4K0210
       TRA     RETURN                RETURN TO MAIN PROGRAM             3F4K0220
PUN3   AXT     12,1                                                     3F4K0230
       TRA     PUN1                                                     3F4K0240
RETURN CAL     PUN2                                                     3F4K0250
       AXT     **,2                                                     3F4K0270
       TRA     1,2                                                      3F4K0280
BLANKS BCI     1,                                                       3F4K0300
LNKG   LDIR                                                             3F4K0310
       END                                                              3F4K0330
$*     7090/7094 WRITE WITHOUT FORMAT STATEMENT                         3F4L0000
$IBMAP FWRU                                                             3F4L0010
       TTL     UNFORMATTED WRITE ROUTINE                                3F4L0020
*              UNFORMATTED WRITE ROUTINE                                3F4L0030
*      ENTRY POINT FOR WRITE (UNIT,XXX) - BCD WRITE -                   3F4L0040
*      WHERE XXX IS NAME OF TABLE OF ARRAYS                             3F4L0050
*      TO BE WRITTEN                                                    3F4L0060
       ENTRY   .FWRU.                                                   3F4L0070
OUTBUF EQU     .OUTBF                                                   3F4L0071
.FWRU. SXA     SYSLOC,4                                                 3F4L0080
       SXA     LNKG,4                                                   3F4L0090
       SXA     WRSAV,4                                                  3F4L0100
       CALL    .FIOS.(ARG,IOCOM)                                        3F4L0110
       ORG     *-2                   OVERLAY CALL                       3F4L0120
ARG    PZE     0,,0                                                     3F4L0130
IOCOM  IOCD    OUTBUF,,**                                               3F4L0140
       CALL    .FWRO.(WRITE,WRSAV)                                      3F4L0150
       ORG     *-2                                                      3F4L0155
WRITE  TRA     WRTNU                                                    3F4L0160
WRSAV  PZE                                                              3F4L0170
*      WRITE ROUTINE-ENTERED FROM FWRO.                                 3F4L0180
WRTNU  SXA     SV4,4                 ENTER HERE FROM FWRO               3F4L0200
       SXD     .FILL.,2              STORE WORD COUNT IN I/O COMMAND    3F4L0210
       TSX     .FRTD.,4              WRITE A LINE                       3F4L0220
SV4    AXT     **,4                                                     3F4L0230
       TRA     1,4                   RETURN TO FWRO                     3F4L0240
LNKG   LDIR                                                             3F4L0260
       END                                                              3F4L0270
$*     7090/7094 NAMELIST PROCESSOR FOR FORMATTLESS WRITE               3F4M0000
$IBMAP FWRO    ()OK                                                     3F4M0010
CHLIMT EQU     133                                                  (11)3F4M0011
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90 ,         $5$3F4M0012
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94 .        $5$3F4M0013
*                   (OR TO ANY VALUE NOT EQUAL TO 90.)               $5$3F4M0014
M9094  SET     90                                                    $5$3F4M0015
       PCC     ON                                                    $5$3F4M0016
       IFF     M9094=90                                              $5$3F4M0017
       GOTO    BEG94                                                 $5$3F4M0018
       PCC     OFF                                                   $5$3F4M0019
       TTL     NAMELIST PROCESSOR                                   (14)3F4M0020
*              NAMELIST PROCESSOR                                       3F4M0030
*              ENTRY POINT FOR CALL FWRO(ARG), WHERE                    3F4M0040
*              ARG IS LOCATION OF I/O ROUTINE.                          3F4M0050
       ENTRY   .FWRO.                                                   3F4M0060
       ENTRY   .FREST                                                   3F4M0070
NMLIMT EQU     CHLIMT-12             ALLOW FOR NAMELIST NAME        (11)3F4M0071
ICLIMT EQU     NMLIMT/16             INTEGER FIELDS PER LINE        (11)3F4M0072
ECLIMT EQU     NMLIMT/22             REAL F. P. FIELDS PER LINE     (11)3F4M0073
LCLIMT EQU     NMLIMT/7              LOGICAL FIELDS PER LINE        (11)3F4M0074
DBLIMT EQU     NMLIMT/29             D. P. FIELDS PER LINE          (11)3F4M0075
CMLIMT EQU     NMLIMT/44*2           2(COMPLEX FIELDS PER LINE)     (11)3F4M0076
CHAR   EQU     .CHAR                                                    3F4M0080
CNVSW  EQU     .CNVSW                                                   3F4M0090
COUNT  EQU     .KOUNT                                                   3F4M0100
DDDFLG EQU     .DDDFL                                                   3F4M0110
DDFLAG EQU     .DDFLG                                                   3F4M0120
DFLT   EQU     .DFLT                                                    3F4M0130
DIG    EQU     .DIG                                                     3F4M0140
DONE   EQU     .DONE                                                    3F4M0150
FLT    EQU     .FLT                                                     3F4M0160
FXFL1  EQU     .FXFL1                                                   3F4M0170
FXFL2  EQU     .FXFL2                                                   3F4M0180
FXFL3  EQU     .FXFL3                                                   3F4M0190
INTG   EQU     .INTG                                                    3F4M0200
LOUT   EQU     .LOUT                                                    3F4M0210
OUTBUF EQU     .OUTBF                                                   3F4M0220
TEST   EQU     .TEST                                                    3F4M0230
WIDTH  EQU     .WIDTH                                                   3F4M0240
.FWRO. SXA     SYSLOC,4                                                 3F4M0250
       SXA     LNKG,4                                                   3F4M0260
       SXA     SV1,1                 SAVE REGISTERS FOR                 3F4M0270
       SXA     SV2,2                 MAIN PROGRAM.                      3F4M0280
       CLA     4,4                                                      3F4M0290
       STA     .FOJP                                                    3F4M0300
       CLA     3,4                   GET ARG                            3F4M0310
       STA     INOUT                 STORE ADDRESS OF I/O ROUTINE.      3F4M0320
*      INITIALIZE BASIC FCNV ROUTINE.                                   3F4M0330
       AXT     0,2                                                      3F4M0340
       AXT     0,1                                                      3F4M0350
       CALL    .FCON.(ARG1,ARG2)                                        3F4M0360
       ORG     *-2                                                      3F4M0370
ARG1   PZE     0,,0                                                     3F4M0380
ARG2   PZE     0,,**                                                    3F4M0390
       TSX     .FREST,4              RESET BUFFER                       3F4M0400
       LXA     .FOJP,4               LOCATE CALL .FWRU.                 3F4M0410
       CLA     4,4                   GET NAMELIST ARGUMENT              3F4M0420
       PAC     ,2                    STORE TABLE ADDRESS                3F4M0430
       SXA     LOCW,2                                                   3F4M0440
       CAL*    4,4                   GET BCI TABLE NAME                 3F4M0450
       LDQ     BLANKS                                                   3F4M0460
       LGR     12                    MAKE ROOM FOR 1$                   3F4M0470
       ORA     H1                    INSERT 1$                          3F4M0480
       DST     OUTBUF                PUT 1$NAME IN OUTPUT BUFFER.       3F4M0490
       TSX     EMPTY,2               WRITE TABLE NAME.                  3F4M0500
       AXC     ENDLIN-1,4            END OF LINE EXIT FROM FCNV         3F4M0510
       SXA     DONE,4                WHEN COUNT IS EXHAUSTED.           3F4M0520
       AXT     77,4                                                     3F4M0530
       SXA     TEST,4                                                   3F4M0540
*      EXTRACT WORD FROM TABLE                                          3F4M0550
*      BEGIN AND RETURN HERE TO PROCESS NEW ARRAY.                      3F4M0560
LOCW   AXT     **,2                  LOCATE TABLE WORD.                 3F4M0570
       CAL     1,2                                                      3F4M0580
       TXI     *+1,2,-1              BUMP POINTER TO NEXT               3F4M0590
       SXA     LOCW,2                WORD OF TABLE.                     3F4M0600
       TZE     END                   END OF TABLE-WRITE $END,           3F4M0610
*                                    RETURN TO MAIN PROGRAM.            3F4M0620
       ZET     FSW                   IS THIS FIRST LINE OF ARRAY        3F4M0630
       TRA     BLK                   NO-SKIP TWO WORDS OF OUTBUF.       3F4M0640
       LDQ     EQL                   YES-INSERT ARRAY NAME AND =.       3F4M0650
       LGR     6                     SHIFT FOR CARRIAGE CONTROL         3F4M0660
       STL     FSW                   SET FIRST LINE SWITCH.             3F4M0670
       DST     OUTBUF                                                   3F4M0680
       TRA     LOCW                  GET WORD OF ARRAY INFO.            3F4M0690
BLK    LXA     .FPACK,1              ADD TWO TO ADDRESS OF              3F4M0700
       TXI     *+1,1,2               STORE INSTRUCTION.                 3F4M0710
       SXA     .FPACK,1                                                 3F4M0720
 BLK1  PBT                                                           $5$3F4M0730
       TRA     BLK2                                                  $5$3F4M0740
       TXI     *+1,2,-1                                              $5$3F4M0750
       STO     TPBT                                                  $5$3F4M0760
       CAL     0,2                                                   $5$3F4M0761
       PBT                                                           $5$3F4M0762
       TRA     *+2                                                   $5$3F4M0763
       TXI     *-3,2,-1                                              $5$3F4M0764
       SXA     LOCW,2                                                $5$3F4M0765
       CAL     TPBT                                                  $5$3F4M0766
 BLK2  STA     ARYLOC                                                $5$3F4M0770
       STD     ARYSIZ                STORE SIZE OF ARRAY.               3F4M0780
       ARS     15                    BLANK OUT ALL                      3F4M0790
       ANA     MSK                   BUT TYPE NUMBER.                   3F4M0800
       PAC     ,2                                                       3F4M0810
       XEC     TYPTBL,2                                                 3F4M0820
TYPTBL TRA     INTGR                 TYPE 0 - INTEGER                   3F4M0830
       TRA     REAL                       1 - REAL                      3F4M0840
       TRA     LOGIC                      2 - LOGICAL                   3F4M0850
       TRA     DBLPR                      3 - DOUBLE PRECISION          3F4M0860
       TRA     COMPLX                     4 - COMPLEX                   3F4M0870
*      INITIALIZE FCNV FOR INTEGER OUTPUT.                              3F4M0880
INTGR  AXT     INTG,4                PUT 'INTG' LOC IN                  3F4M0890
       SXA     CNVSW,4               CNVSW                              3F4M0900
       AXT     ICLIMT,4              FIELD COUNT PER LINE           (11)3F4M0910
       SXA     KOUNT,4                                                  3F4M0920
       AXT     14,2                  WIDTH OF INTEGERS.                 3F4M0930
       AXT     1,1                   SPACES BEFORE LINE.            (11)3F4M0940
       CLA     TWO                   SPACES BETWEEN WORDS               3F4M0950
       TRA     INITL                                                    3F4M0960
*      INITIALIZE FCNV FOR REAL FLOATING POINT NUMBERS                  3F4M0970
REAL   AXT     FLT,4                 SET CONVERSION SWITCH              3F4M0980
       SXA     CNVSW,4               FOR REAL FLOATING OUTPUT           3F4M0990
       AXT     CHAR-4,4                                                 3F4M1000
       SXA     FXFL1,4               SET FXFL1,2,3                      3F4M1010
       AXT     5,4                                                      3F4M1020
       SXD     FXFL2,4               IN CONVERSION ROUTINE FOR          3F4M1030
       SXD     FXFL3,4               FIXED POINT                        3F4M1040
       AXT     8,4                                                      3F4M1050
       SXA     DIG,4                 SET DECIMAL SCALE.                 3F4M1060
       AXT     ECLIMT,4              FIELD COUNT PER LINE           (11)3F4M1070
       SXA     KOUNT,4               SET WORD COUNT PER LINE.           3F4M1080
       AXT     19,2                  WIDTH IN CHARACTERS                3F4M1090
       AXT     2,1                   BLANKS TO INSERT               (11)3F4M1100
       CLA     THREE                 BLANKS BETWEEN WORDS           (11)3F4M1110
       TRA     INITL                                                    3F4M1120
*      INITIALIZE FCNV FOR LOGICAL OUTPUT                               3F4M1130
LOGIC  AXT     LOUT,4                SET CONVERSION SWITCH              3F4M1140
       SXA     CNVSW,4               FOR LOGICAL OUTPUT                 3F4M1150
       AXT     LCLIMT,4              FIELD COUNT PER LINE           (11)3F4M1160
       SXA     KOUNT,4                                                  3F4M1170
       AXT     5,2                   WORD WIDTH                         3F4M1180
       AXT     1,1                   SPACES BEFORE LINE             (11)3F4M1190
       CLA     TWO                   SPACES BETWEEN WORDS               3F4M1200
       TRA     INITL                                                    3F4M1210
*      INITIALIZE FCNV FOR DOUBLE PRECISION REAL OUTPUT                 3F4M1220
DBLPR  STL     DBLSW                 D.P. SWITCH FOR FWRO               3F4M1230
       AXT     DFLT,4                SET CONVERSION                     3F4M1240
       SXA     CNVSW,4               SWITCH FOR D.P.                    3F4M1250
       STL     DDDFLG                DOUBLE PRECISION SWITCHES FOR      3F4M1260
       STL     DDFLAG                FIOH COMPATIBILITY                 3F4M1270
       AXT     5,4                   SET FXFL2,3 FOR FIXED POINT        3F4M1280
       SXD     FXFL2,4                                                  3F4M1290
       SXD     FXFL3,4                                                  3F4M1300
       AXT     DBLIMT,4              FIELD COUNT PER LINE           (11)3F4M1310
       SXA     KOUNT,4               LINE                               3F4M1320
       AXT     16,4                  SET DECIMAL                        3F4M1330
       SXA     DIG,4                 SCALE                              3F4M1340
       AXT     27,2                  CHARACTER WIDTH PER WORD           3F4M1350
       AXT     1,1                   BLANKS BEFORE LINE             (11)3F4M1360
       CLA     TWO                   BLANKS BETWEEN WORDS               3F4M1370
       TRA     INITL                                                    3F4M1380
*      INITIALIZE FCNV FOR COMPLEX AND PROCESS                          3F4M1390
*      AS REAL FLOATING NUMBERS                                         3F4M1400
COMPLX STL     CMPLX                                                    3F4M1410
       AXT     FLT,4                                                    3F4M1420
       SXA     CNVSW,4                                                  3F4M1430
       AXT     CHAR-4,4                                                 3F4M1440
       SXA     FXFL1,4                                                  3F4M1450
       AXT     5,4                                                      3F4M1460
       SXD     FXFL2,4                                                  3F4M1470
       SXD     FXFL3,4                                                  3F4M1480
       AXT     8,4                                                      3F4M1490
       SXA     DIG,4                                                    3F4M1500
       AXT     CMLIMT,4              2(FIELD COUNT PER LINE)        (11)3F4M1510
       SXA     KOUNT,4                                                  3F4M1520
       AXT     19,2                                                     3F4M1530
       AXT     2,1                   SPACING BEFORE LINE.           (11)3F4M1540
       CLA     THREE                 BLANKS BETWEEN WORDS           (11)3F4M1550
       TRA     INITL                                                    3F4M1560
INITL  LXA     KOUNT,4               STORE COUNT PER LINE               3F4M1570
       SXA     COUNT,4                                                  3F4M1580
       SXA     WIDTH,2                     WIDTH OF WORD                3F4M1590
       SXA     SPACBF,1                    SPACE BEFORE LINE            3F4M1600
       STA     SPACBT                      SPACE BETWEEN WORDS          3F4M1610
*      BEGIN AND RETURN HERE FOR NEW LINE OF ARRAY.                     3F4M1620
SPACBF AXT     **,1                                                     3F4M1630
       TSX     BLNK,4                SKIP NECESSARY SPACES.             3F4M1640
CMPLP  NZT     CMPLX                 IS IT COMPLEX                      3F4M1650
       TRA     *+3                   NO - BEGIN PROCESSING.             3F4M1660
       AXT     1,1                   YES                                3F4M1670
       TSX     LPAR,4                INSERT LEFT PARENTHESIS.           3F4M1680
*      COME HERE TO GET NEXT BINARY WORD.                               3F4M1690
ARYPNT AXT     0,1                   ARRAY POINTER                      3F4M1700
       ZET     DBLSW                                                 $5$3F4M1710
       TRA     *+3                                                   $5$3F4M1720
       CLA*    ARYLOC                                                $5$3F4M1730
       TXI     SAVE1,1,-1                                            $5$3F4M1740
ARYLOC DLD     **,1                                                  $5$3F4M1741
       TXI     *+1,1,-2                                              $5$3F4M1742
SAVE1  SXA     ARYPNT,1            SAVE UPDATED ARRAY POINTER        $5$3F4M1750
       TSX     .FCNV.,4              CONVERT NUMBER, INTO OUT BUF       3F4M1760
SPACBT AXT     **,1                                                     3F4M1770
       NZT     CMPLX                 IS IT COMPLEX                      3F4M1780
       TRA     INCMA                 NO - INSERT COMMA.                 3F4M1790
       NZT     FSWD                  YES-IS IT FIRST WORD               3F4M1800
       TRA     SEC                   YES                                3F4M1810
       STZ     FSWD                  NO-RESET FSWD                      3F4M1820
       AXT     1,1                                                      3F4M1830
       TSX     RPAR,4                INSERT RIGHT PAREN.                3F4M1840
       AXT     3,1                   SET COUNTER FOR COMMA+2 BLANKS     3F4M1850
       TRA     INCMA                                                    3F4M1860
SEC    STL     FSWD                  SET FIRST WORD SWITCH.             3F4M1870
       AXT     1,1                                                      3F4M1880
INCMA  TSX     COMMA,4               INSERT COMMA AND BLANKS.           3F4M1890
*      CURRENT WORD IS STORED, TEST FOR COMPLETION                      3F4M1900
       LXD     ARYSIZ,4              GET ARRAY WORDS LEFT               3F4M1910
       TXL     EMTY,4,0              QUIT IF ONE WORD ARRAY             3F4M1920
       NZT     FSWD                  TIMES 2 FOR COMPLEX                3F4M1930
BUMP   TXI     *+1,4,-1              BUMP ARRAY COUNTER                 3F4M1940
       SXD     ARYSIZ,4              SAVE REMAINDER.                    3F4M1950
       TXL     EMTY-1,4,0            TRANSFER IF ARRAY DONE             3F4M1960
       ZET     LINFUL                IS LINE FULL                       3F4M1970
       TRA     EMTY                  YES-WRITE IT AND CONTINUE          3F4M1980
       ZET     FSWD                  NO - FIRST WORD OF COMPLEX         3F4M1990
       TRA     ARYPNT                GET NEXT WORD                      3F4M2000
       TRA     CMPLP                 INSERT LEFT PAREN IF COMPLEX       3F4M2010
       STZ     LINFUL                                                   3F4M2020
EMTY   ZET     FSWD                                                     3F4M2030
       TRA     BUMP+3                                                   3F4M2040
       TSX     EMPTY,2                                                  3F4M2050
       STZ     FSW                   RESET FIRST LINE SWITCH            3F4M2060
       NZT     LINFUL                WAS LINE FULL                      3F4M2070
       TRA     LOCW1                 NO-ARRAY DONE                      3F4M2080
       STZ     LINFUL                YES - ONLY LINE DONE               3F4M2090
       LXA     KOUNT,4                                                  3F4M2100
       SXA     COUNT,4               RESTORE LINE COUNT                 3F4M2110
       LXA     .FPACK,4              SKIP TWO WORDS OF                  3F4M2120
       TXI     *+1,4,2               BLANKS TO EVEN OFF                 3F4M2130
       SXA     .FPACK,4              COLUMNS                            3F4M2140
       TRA     SPACBF                BEGIN NEW LINE.                    3F4M2150
LOCW1  SXA     ARYPNT,0              RESET ARRAY POINTER                3F4M2160
       STZ     DDDFLG                                                   3F4M2170
       STZ     DDFLAG                                                   3F4M2180
       STZ     DBLSW                                                    3F4M2190
       STZ     CMPLX                                                    3F4M2200
       TRA     LOCW                                                     3F4M2210
EMPTY  SXA     RET,2                                                    3F4M2220
       LXA     .FPACK,2                                                 3F4M2230
       CAL     .WORD                 FILL                               3F4M2240
       SUB     L(1)                  PARTIAL                            3F4M2250
       TZE     FILL2                 WORD                               3F4M2260
       CAL     .WORD                 WITH                               3F4M2270
       TOV     *+1                   BLANKS                             3F4M2280
       LDQ     BLANKS                AND                                3F4M2290
       LGL     6                     STORE                              3F4M2300
       TNO     *-1                   IN                                 3F4M2310
       XEC     .FPACK                OUTPUT BUFFER                      3F4M2320
       TXI     *+1,2,1                                                  3F4M2330
FILL2  TNX     *+2,2,OUTBUF          CALCULATE WORD COUNT               3F4M2340
       TXH     *+2,2,2               IF LESS THAN 3 - SET AT 3.         3F4M2350
       AXT     3,2                                                      3F4M2360
INOUT  TSX     **,4                  WRITE A LINE                       3F4M2370
       TSX     .FREST,4                                                 3F4M2380
RET    AXT     **,2                                                     3F4M2390
       TRA     1,2                                                      3F4M2400
.FREST SXA     RETT,4                                                   3F4M2410
       AXT     OUTBUF,4                                                 3F4M2420
       SXA     .FPACK,4              RESTORE STORE ADDRESS              3F4M2430
       CAL     L(1)                                                     3F4M2440
       SLW     .WORD                 RESET WORD                         3F4M2450
       CAL     BLANKS                CLEAR                              3F4M2460
       SLW     OUTBUF                BUFFER                             3F4M2470
       SLW     OUTBUF+1              WITH                               3F4M2480
       SLW     OUTBUF+2              BLANKS                             3F4M2490
RETT   AXT     **,4                                                     3F4M2500
       TRA     1,4                                                      3F4M2510
*      COMMA,BLANK,LEFT AND RIGHT PARENTHESIS INSERTION                 3F4M2520
*                                                                       3F4M2530
*      ENTER HERE FOR COMMA INSERTION.                                  3F4M2540
COMMA  LDQ     CMA                                                      3F4M2550
       TRA     SKPSPC                                                   3F4M2560
*      ENTER HERE FOR LEFT PAREN.                                       3F4M2570
LPAR   LDQ     LPR                                                      3F4M2580
       TRA     SKPSPC                                                   3F4M2590
*      ENTER HERE FOR RIGHT PAREN                                       3F4M2600
RPAR   LDQ     RPR                                                      3F4M2610
       TRA     SKPSPC                                                   3F4M2620
*      ENTER HERE FOR BLANKS.                                           3F4M2630
BLNK   LDQ     BLANKS                                                   3F4M2640
       TRA     SKPSPC                                                   3F4M2650
RPR    BCI     1,)                                                      3F4M2660
LPR    BCI     1,(                                                      3F4M2670
CMA    BCI     1,,                                                      3F4M2680
*      BLANK INSERTION ROUTINE                                          3F4M2690
SKPSPC CAL     .WORD                                                    3F4M2700
       LXA     .FPACK,2                                                 3F4M2710
       TNO     *+1                                                      3F4M2720
       LGL     6                                                        3F4M2730
       TRA     SHFT+2                                                   3F4M2740
SHFT   ALS     6                                                        3F4M2750
       ADM     BLANK                 INSERT BLANK                       3F4M2760
       TNO     NXTCHR                                                   3F4M2770
       XEC     .FPACK                SLW IN OUTBUF                      3F4M2780
       TXI     *+1,2,1               BUMP STORE ADDRESS                 3F4M2790
       SXA     .FPACK,2              TO OUTBUF                          3F4M2800
       CAL     L(1)                  CONTINUE IF MORE BLANKS TO INSERT  3F4M2810
NXTCHR TIX     SHFT,1,1                                                 3F4M2820
       SLW     .WORD                 SAVE PARTIAL WORD                  3F4M2830
       TRA     1,4                                                      3F4M2840
BLANK  OCT     000000000060                                             3F4M2850
*      WRITE $END, RETURN TO MAIN PROGRAM-TABLE DONE.                   3F4M2860
END    CLA     ENDT                  PUT 0$END IN OUTBUF                3F4M2870
       STO     OUTBUF                AND WRITE IT.                      3F4M2880
       TSX     EMPTY,2                                                  3F4M2890
.FOJP  AXT     **,4                  RESTORE INDICES AND                3F4M2900
SV1    AXT     **,1                  RETURN TO MAIN                     3F4M2910
SV2    AXT     **,2                  OBJECT                             3F4M2920
       TRA     1,4                   PROGRAM.                           3F4M2930
*      END OF LINE REACHED, COUNT IS DONE - WRITE A LINE                3F4M2940
ENDLIN STL     LINFUL                FORCE LINE FULL EXIT               3F4M2950
       TRA     SPACBT                                                   3F4M2960
*      CONSTANTS                                                        3F4M2970
BLANKS BCI     1,                                                       3F4M2980
H1     BCI     1,1$0000                                                 3F4M2990
ENDT   BCI     1,0$ END                                                 3F4M3000
EQL    BCI     1, =                                                     3F4M3010
MSK    OCT     000000000007                                             3F4M3020
FSW    PZE                           FIRST LINE SWITCH.                 3F4M3030
CMPLX  PZE                           COMPLEX NUMBER SWITCH.             3F4M3040
DBLSW  PZE                           DOUBLE PRECISION SWITCH.           3F4M3050
FSWD   PZE                           FIRST WORD OF COMPLEX SWITCH.      3F4M3060
ARYSIZ PZE                                                              3F4M3070
L(1)   PZE     1                                                        3F4M3080
LINFUL PZE                           LINE FULL SWITCH                   3F4M3090
THREE  PZE     3                                                    (11)3F4M3100
TWO    PZE     2                                                        3F4M3110
 TPBT  PZE                                                           $5$3F4M3111
LNKG   LDIR                                                             3F4M3120
KOUNT  PZE                                                              3F4M3130
BEG94  NULL                                                          $5$3F4M3140
*                                                                    $5$3F4M3150
*                                                                    $5$3F4M3160
       PCC     ON                                                    $5$3F4M5000
       IFT     M9094=90                                              $5$3F4M5010
       GOTO    END94                                                 $5$3F4M5020
       PCC     OFF                                                   $5$3F4M5030
       TTL     NAMELIST PROCESSOR                                   (14)3F4M5040
*              NAMELIST PROCESSOR                                       3F4M5050
*              ENTRY POINT FOR CALL FWRO(ARG), WHERE                    3F4M5060
*              ARG IS LOCATION OF I/O ROUTINE.                          3F4M5070
       ENTRY   .FWRO.                                                   3F4M5080
       ENTRY   .FREST                                                   3F4M5090
NMLIMT EQU     CHLIMT-12             ALLOW FOR NAMELIST NAME        (11)3F4M5091
ICLIMT EQU     NMLIMT/16             INTEGER FIELDS PER LINE        (11)3F4M5092
ECLIMT EQU     NMLIMT/22             REAL F. P. FIELDS PER LINE     (11)3F4M5093
LCLIMT EQU     NMLIMT/7              LOGICAL FIELDS PER LINE        (11)3F4M5094
DBLIMT EQU     NMLIMT/29             D. P. FIELDS PER LINE          (11)3F4M5095
CMLIMT EQU     NMLIMT/44*2           2(COMPLEX FIELDS PER LINE)     (11)3F4M5096
LIMIT5 EQU     CHLIMT                                               (14)3F4M5097
LIMIT  EQU     LIMIT5/6+1                                           (11)3F4M5100
CNVSW  EQU     .CNVSW                                                   3F4M5110
COUNT  EQU     .KOUNT                                                   3F4M5120
DDDFLG EQU     .DDDFL                                                   3F4M5130
DDFLAG EQU     .DDFLG                                                   3F4M5140
DC     EQU     .DFLT                                                 $5$3F4M5150
DIG    EQU     .DIG                                                     3F4M5160
DONE   EQU     .DONE                                                    3F4M5170
EC     EQU     .FLT                                                  $5$3F4M5180
GAIN   EQU     .GAIN                                                 $5$3F4M5190
GAIN1  EQU     .GAIN1                                                $5$3F4M5200
QSTO   EQU     .QSTO                                                 $5$3F4M5210
BUF    EQU     .BUF                                                  $5$3F4M5220
IC     EQU     .INTG                                                 $5$3F4M5230
LC     EQU     .LOUT                                                 $5$3F4M5240
OUTBUF EQU     .OUTBF                                                   3F4M5250
TEST   EQU     .TEST                                                    3F4M5260
WIDTH  EQU     .WIDTH                                                   3F4M5270
.FWRO. SXA     SYSLOC,4                                                 3F4M5280
       SXA     LNKG,4                                                   3F4M5290
       SXA     SV1,1                 SAVE REGISTERS FOR                 3F4M5300
       SXA     SV2,2                 MAIN PROGRAM.                      3F4M5310
       CLA     4,4                                                      3F4M5320
       STA     .FOJP                                                    3F4M5330
       CLA     3,4                   GET ARG                            3F4M5340
       STA     INOUT                 STORE ADDRESS OF I/O ROUTINE.      3F4M5350
       LMTM                                                         (11)3F4M5353
       SXA     SV3,3                                                (11)3F4M5354
       SXA     SV5,5                                                (11)3F4M5355
       SXA     SV6,6                                                (11)3F4M5356
       SXA     SV7,7                                                (11)3F4M5357
*      INITIALIZE BASIC FCNV ROUTINE.                                   3F4M5360
       AXT     77,2                                                  $5$3F4M5370
       AXT     0,1                                                      3F4M5380
       CALL    .FCON.(ARG1,ARG2,ARG3)                                $5$3F4M5390
       ORG     *-3                                                   $5$3F4M5400
ARG1   PZE     0,,0                                                     3F4M5410
ARG2   PZE     0,,**                                                    3F4M5420
ARG3   PZE     1                                                     $5$3F4M5430
       TSX     .FREST,4              RESET BUFFER                       3F4M5440
       LXA     .FOJP,4               LOCATE CALL .FWRU.                 3F4M5450
       CLA     4,4                   GET NAMELIST ARGUMENT              3F4M5460
       PAC     ,2                    STORE TABLE ADDRESS                3F4M5470
       SXA     LOCW,2                                                   3F4M5480
       CAL*    4,4                   GET BCI TABLE NAME                 3F4M5490
       LDQ     BLANKS                                                   3F4M5500
       LGR     12                    MAKE ROOM FOR 1$                   3F4M5510
       ORA     H1                    INSERT 1$                          3F4M5520
       DST     OUTBUF                PUT 1$NAME IN OUTPUT BUFFER.       3F4M5530
       TSX     EMPTY,2               WRITE TABLE NAME.                  3F4M5540
       AXC     ENDLIN-1,4            END OF LINE EXIT FROM FCNV         3F4M5550
       SXA     DONE,4                WHEN COUNT IS EXHAUSTED.           3F4M5560
*      EXTRACT WORD FROM TABLE                                          3F4M5570
*      BEGIN AND RETURN HERE TO PROCESS NEW ARRAY.                      3F4M5580
LOCW   AXT     **,2                  LOCATE TABLE WORD.                 3F4M5590
       CAL     1,2                                                      3F4M5600
       TXI     *+1,2,-1              BUMP POINTER TO NEXT               3F4M5610
       SXA     LOCW,2                WORD OF TABLE.                     3F4M5620
       TZE     END                   END OF TABLE-WRITE $END,           3F4M5630
*                                    RETURN TO MAIN PROGRAM.            3F4M5640
       ZET     FSW                   IS THIS FIRST LINE OF ARRAY        3F4M5650
       TRA     BLK                   NO-SKIP TWO WORDS OF OUTBUF.       3F4M5660
       LDQ     EQL                   YES-INSERT ARRAY NAME AND =.       3F4M5670
       LGR     6                     SHIFT FOR CARRIAGE CONTROL         3F4M5680
       STL     FSW                   SET FIRST LINE SWITCH.             3F4M5690
       DST     OUTBUF                                                   3F4M5700
       TRA     LOCW                  GET WORD OF ARRAY INFO.            3F4M5710
BLK    LXA     GAIN1,1       LOAD XR1 WITH OUTBUF LOCATION COUNT     $5$3F4M5720
       TXI     *+1,1,-2                                              $5$3F4M5730
       SXA     GAIN1,1                                               $5$3F4M5740
 BLK1  PBT                                                           $5$3F4M5750
       TRA     BLK2                                                  $5$3F4M5760
       TXI     *+1,2,-1                                              $5$3F4M5770
       STO     TPBT                                                  $5$3F4M5780
       CAL     0,2                                                   $5$3F4M5790
       PBT                                                           $5$3F4M5800
       TRA     *+2                                                   $5$3F4M5810
       TXI     *-3,2,-1                                              $5$3F4M5820
       SXA     LOCW,2                                                $5$3F4M5830
       CAL     TPBT                                                  $5$3F4M5840
 BLK2  STA     ARYLOC                                                $5$3F4M5850
       STD     ARYSIZ                STORE SIZE OF ARRAY.               3F4M5860
       ARS     15                    BLANK OUT ALL                      3F4M5870
       ANA     MSK                   BUT TYPE NUMBER.                   3F4M5880
       PAC     ,2                                                       3F4M5890
       XEC     TYPTBL,2                                                 3F4M5900
TYPTBL TRA     INTGR                 TYPE 0 - INTEGER                   3F4M5910
       TRA     REAL                       1 - REAL                      3F4M5920
       TRA     LOGIC                      2 - LOGICAL                   3F4M5930
       TRA     DBLPR                      3 - DOUBLE PRECISION          3F4M5940
       TRA     COMPLX                     4 - COMPLEX                   3F4M5950
*      INITIALIZE FCNV FOR INTEGER OUTPUT.                              3F4M5960
INTGR  AXT     IC,4          PUT 'IC' LOC IN CNSW                    $5$3F4M5970
       SXA     CNVSW,4               CNVSW                              3F4M5980
       AXT     ICLIMT,4              FIELD COUNT PER LINE           (11)3F4M5990
       SXA     KOUNT,4                                                  3F4M6000
       AXT     15,2          WIDTH OF INTEGERS                       $5$3F4M6010
       AXT     1,1           SPACE FOR COMMA                         $5$3F4M6020
       TRA     INITL                                                    3F4M6030
*      INITIALIZE FCNV FOR REAL FLOATING POINT NUMBERS                  3F4M6040
REAL   AXT     EC,4         SET CONVERSION EWITCH                    $5$3F4M6050
       SXA     CNVSW,4               FOR REAL FLOATING OUTPUT           3F4M6060
       AXT     8,4                                                      3F4M6070
       SXA     DIG,4                 SET DECIMAL SCALE.                 3F4M6080
       AXT     ECLIMT,4              FIELD COUNT PER LINE           (11)3F4M6090
       SXA     KOUNT,4               SET WORD COUNT PER LINE.           3F4M6100
       AXT     21,2          WIDTH IN CHARACTERS                     $5$3F4M6110
       AXT     1,1           SPACE FOR COMMA                         $5$3F4M6120
       TRA     INITL                                                    3F4M6130
*      INITIALIZE FCNV FOR LOGICAL OUTPUT                               3F4M6140
LOGIC  AXT     LC,4         SET CONVERSION EWITCH                    $5$3F4M6150
       SXA     CNVSW,4               FOR LOGICAL OUTPUT                 3F4M6160
       AXT     LCLIMT,4              FIELD COUNT PER LINE           (11)3F4M6170
       SXA     KOUNT,4                                                  3F4M6180
       AXT     6,2           WORD WIDTH                              $5$3F4M6190
       AXT     1,1           SPACE FOR COMMA                         $5$3F4M6200
       TRA     INITL                                                    3F4M6210
*      INITIALIZE FCNV FOR DOUBLE PRECISION REAL OUTPUT                 3F4M6220
DBLPR  STL     DBLSW                 D.P. SWITCH FOR FWRO               3F4M6230
       AXT     DC,4         SET CONVERSION                           $5$3F4M6240
       SXA     CNVSW,4               SWITCH FOR D.P.                    3F4M6250
       STL     DDDFLG                DOUBLE PRECISION SWITCHES FOR      3F4M6260
       STL     DDFLAG                FIOH COMPATIBILITY                 3F4M6270
       AXT     DBLIMT,4              FIELD COUNT PER LINE           (11)3F4M6280
       SXA     KOUNT,4               LINE                               3F4M6290
       AXT     16,4                  SET DECIMAL                        3F4M6300
       SXA     DIG,4                 SCALE                              3F4M6310
       AXT     28,2          WIDTH PER WORD                          $5$3F4M6320
       AXT     1,1           SPACE FOR COMMA                         $5$3F4M6330
       CLA     TWO                   BLANKS BETWEEN WORDS               3F4M6340
       TRA     INITL                                                    3F4M6350
*      INITIALIZE FCNV FOR COMPLEX AND PROCESS                          3F4M6360
*      AS REAL FLOATING NUMBERS                                         3F4M6370
COMPLX STL     CMPLX                                                    3F4M6380
       AXT     EC,4                                                  $5$3F4M6390
       SXA     CNVSW,4                                                  3F4M6400
       AXT     8,4                                                      3F4M6410
       SXA     DIG,4                                                    3F4M6420
       AXT     CMLIMT,4              2(FIELD COUNT PER LINE)        (11)3F4M6430
       SXA     KOUNT,4                                                  3F4M6440
       AXT     2,1                   SKIP TWO SPACES BEFORE LINE    (11)3F4M6443
       TSX     BLNK,4                                               (11)3F4M6446
       AXT     19,2                  WORD WIDTH IN CHARACTERS       (11)3F4M6450
       AXT     4,1                                                   $5$3F4M6460
       CLA     FOUR                                                     3F4M6470
       TRA     INITL                                                    3F4M6480
INITL  LXA     KOUNT,4               STORE COUNT PER LINE               3F4M6490
       SXA     COUNT,4                                                  3F4M6500
       SXA     WIDTH,2                     WIDTH OF WORD                3F4M6510
       SXA     SPACBT,1                                              $5$3F4M6520
*      BEGIN AND RETURN HERE FOR NEW LINE OF ARRAY.                     3F4M6530
CMPLP  NZT     CMPLX                 IS IT COMPLEX                      3F4M6540
       TRA     *+3                   NO - BEGIN PROCESSING.             3F4M6550
       AXT     1,1                   YES                                3F4M6560
       TSX     LPAR,4                INSERT LEFT PARENTHESIS.           3F4M6570
*      COME HERE TO GET NEXT BINARY WORD.                               3F4M6580
ARYPNT AXT     0,1                   ARRAY POINTER                      3F4M6590
ARYLOC CLA     **,1               ARRAY POINTER                      $5$3F4M6600
       ZET     DBLSW               IS IT DOUBLE PRECISION            $5$3F4M6610
       TXI     *+1,1,-1                                              $5$3F4M6620
       LDQ*    *-3                                                   $5$3F4M6630
       TXI     *+1,1,-1            NO - BUMP ONE WORD                $5$3F4M6640
       SXA     ARYPNT,1            SAVE UPDATED ARRAY POINTER        $5$3F4M6650
       TSX     .FCNV.,4              CONVERT NUMBER, INTO OUT BUF       3F4M6660
SPACBT AXT     **,1                                                     3F4M6670
       NZT     CMPLX                 IS IT COMPLEX                      3F4M6680
       TRA     INCMA                 NO - INSERT COMMA.                 3F4M6690
       NZT     FSWD                  YES-IS IT FIRST WORD               3F4M6700
       TRA     SEC                   YES                                3F4M6710
       STZ     FSWD                  NO-RESET FSWD                      3F4M6720
       AXT     1,1                                                      3F4M6730
       TSX     RPAR,4                INSERT RIGHT PAREN.                3F4M6740
       TSX     COMMA,4                                               $5$3F4M6750
       AXT     3,1                   SET COUNTER FOR COMMA+2 BLANKS     3F4M6760
       LDQ     BLANKS                                                $5$3F4M6770
       AXT     2,1                                                   $5$3F4M6780
       TSX     SKPSPC,4                                              $5$3F4M6790
       TRA     INCMA+1                                               $5$3F4M6800
       TRA     INCMA                                                    3F4M6810
SEC    STL     FSWD                  SET FIRST WORD SWITCH.             3F4M6820
       AXT     1,1                                                      3F4M6830
INCMA  TSX     COMMA,4               INSERT COMMA AND BLANKS.           3F4M6840
*      CURRENT WORD IS STORED, TEST FOR COMPLETION                      3F4M6850
       LXD     ARYSIZ,4              GET ARRAY WORDS LEFT               3F4M6860
       TXL     EMTY,4,0              QUIT IF ONE WORD ARRAY             3F4M6870
       NZT     FSWD                  TIMES 2 FOR COMPLEX                3F4M6880
BUMP   TXI     *+1,4,-1              BUMP ARRAY COUNTER                 3F4M6890
       SXD     ARYSIZ,4              SAVE REMAINDER.                    3F4M6900
       TXL     EMTY-1,4,0            TRANSFER IF ARRAY DONE             3F4M6910
       ZET     LINFUL                IS LINE FULL                       3F4M6920
       TRA     EMTY                  YES-WRITE IT AND CONTINUE          3F4M6930
       ZET     FSWD                  NO - FIRST WORD OF COMPLEX         3F4M6940
       TRA     ARYPNT                GET NEXT WORD                      3F4M6950
       TRA     CMPLP                 INSERT LEFT PAREN IF COMPLEX       3F4M6960
       STZ     LINFUL                                                   3F4M6970
EMTY   ZET     FSWD                                                     3F4M6980
       TRA     BUMP+3                                                   3F4M6990
       TSX     EMPTY,2                                                  3F4M7000
       STZ     FSW                   RESET FIRST LINE SWITCH            3F4M7010
       NZT     LINFUL                WAS LINE FULL                      3F4M7020
       TRA     LOCW1                 NO-ARRAY DONE                      3F4M7030
       STZ     LINFUL                YES - ONLY LINE DONE               3F4M7040
       LXA     KOUNT,4                                                  3F4M7050
       SXA     COUNT,4               RESTORE LINE COUNT                 3F4M7060
       LXA     GAIN1,4       OUTBUF LOCATION COUNT TO XR4            $5$3F4M7070
       TXI     *+1,4,-2      SKIP TWO WORDS OF OUTBUF                $5$3F4M7080
       SXA     GAIN1,4       SAVE OUTBUF LOCATION COUNT              $5$3F4M7090
       NZT     CMPLX         IS THE NEW LINE COMPLEX                (11)3F4M7092
       TRA     CMPLP         NO. BEGIN NEW LINE                     (11)3F4M7094
       AXT     2,1           YES                                    (11)3F4M7096
       TSX     BLNK,4        SKIP TWO SPACES AND                    (11)3F4M7098
       TRA     CMPLP        BEGIN NEW LINE                           $5$3F4M7100
LOCW1  SXA     ARYPNT,0              RESET ARRAY POINTER                3F4M7110
       STZ     DDDFLG                                                   3F4M7120
       STZ     DDFLAG                                                   3F4M7130
       STZ     DBLSW                                                    3F4M7140
       STZ     CMPLX                                                    3F4M7150
       TRA     LOCW                                                     3F4M7160
EMPTY  SXA     RET,2                                                    3F4M7170
       XEC     GAIN1         RESET XR2 WITH OUTBUF LOCATION COUNT    $5$3F4M7180
       XEC     GAIN          RESET XR1 WITH OUTBUF CHARACTER COUNT   $5$3F4M7190
       TXH     FILL2,1,5     XR1=6                                   $5$3F4M7200
       LDQ     QSTO                                                  $5$3F4M7210
       RQL     6             LEFT-JUSTIFY BCD CHARACTERS IN MQ       $5$3F4M7220
       TIX     *-1,1,1                                               $5$3F4M7230
       STQ*    BUF           STORE WORD INTO OUTPUT BUFFER           $5$3F4M7240
       TIX     *+1,2,1                                               $5$3F4M7250
FILL2  TXI     *+1,2,-LIMIT  CALCULATE WORD COUNT                    $5$3F4M7260
       PCA     ,2                                                    $5$3F4M7270
       PAX     ,2                                                    $5$3F4M7280
       TXH     *+2,2,2               IF LESS THAN 3 - SET AT 3.         3F4M7290
       AXT     3,2                                                      3F4M7300
INOUT  TSX     **,4                  WRITE A LINE                       3F4M7310
       TSX     .FREST,4                                                 3F4M7320
RET    AXT     **,2                                                     3F4M7330
       TRA     1,2                                                      3F4M7340
.FREST SXA     RETT,4                                                   3F4M7350
       AXT     LIMIT,2       INITIALIZE XR2 TOO POINT TO FIRST LOC.  $5$3F4M7360
       SXA     GAIN1,2       OF OUTPUT BUFFER                        $5$3F4M7370
       AXT     6,1           INITIALIZE XR1 FOR BCD CHARACTER COUNT  $5$3F4M7380
       SXA     GAIN,1                                                $5$3F4M7390
       LDQ     BLANKS        INITIALIZE QSTO WITH BLANKS             $5$3F4M7400
       STQ     QSTO                                                  $5$3F4M7410
       CAL     BLANKS                CLEAR                              3F4M7420
       SLW     OUTBUF                BUFFER                             3F4M7430
       SLW     OUTBUF+1              WITH                               3F4M7440
       SLW     OUTBUF+2              BLANKS                             3F4M7450
RETT   AXT     **,4                                                     3F4M7460
       TRA     1,4                                                      3F4M7470
*      COMMA,BLANK,LEFT AND RIGHT PARENTHESIS INSERTION                 3F4M7480
*                                                                       3F4M7490
*      ENTER HERE FOR COMMA INSERTION.                                  3F4M7500
COMMA  LDQ     CMA                                                      3F4M7510
       TRA     SKPSPC                                                   3F4M7520
*      ENTER HERE FOR LEFT PAREN.                                       3F4M7530
LPAR   LDQ     LPR                                                      3F4M7540
       TRA     SKPSPC                                                   3F4M7550
*      ENTER HERE FOR RIGHT PAREN                                       3F4M7560
RPAR   LDQ     RPR                                                      3F4M7570
       TRA     SKPSPC                                                   3F4M7580
*      ENTER HERE FOR BLANKS.                                           3F4M7590
BLNK   LDQ     BLANKS                                                   3F4M7600
       TRA     SKPSPC                                                   3F4M7610
RPR    BCI     1,)                                                      3F4M7620
LPR    BCI     1,(                                                      3F4M7630
CMA    BCI     1,,                                                      3F4M7640
*      BLANK INSERTION ROUTINE                                          3F4M7650
SKPSPC CAL     QSTO          BCD CHARACTERS                          $5$3F4M7660
       LXA     GAIN,2          SET XR2 WITH OUTBUF CHARACTER COUNT   $5$3F4M7670
SHFT   LGL     6                                                     $5$3F4M7680
       TIX     NXTCHR,2,1                                            $5$3F4M7690
       XEC     GAIN1         RESET XR2 WITH OUBUF LOCATION COUNT     $5$3F4M7700
       SLW*    BUF           STORE WORD                              $5$3F4M7710
       TXI     *+1,2,-1      ADVANCE OUTPUT BUFFER ADDRESS           $5$3F4M7720
       SXA     GAIN1,2       SAVE OUTBUF LOCATION COUNT              $5$3F4M7730
       AXT     6,2           RESET OUTBUF CHARACTER COUNT WITH 6     $5$3F4M7740
       CAL     BLANKS                                                $5$3F4M7750
NXTCHR TIX     SHFT,1,1                                              $5$3F4M7760
       SLW     QSTO                                                  $5$3F4M7770
       SXA     GAIN,2        SAVE OUTBUF CHARACTER COUNT             $5$3F4M7780
       TRA     1,4                                                      3F4M7790
BLANK  OCT     000000000060                                             3F4M7800
*      WRITE $END, RETURN TO MAIN PROGRAM-TABLE DONE.                   3F4M7810
END    CLA     ENDT                  PUT 0$END IN OUTBUF                3F4M7820
       STO     OUTBUF                AND WRITE IT.                      3F4M7830
       TSX     EMPTY,2                                                  3F4M7840
SV3    AXT     **,3                                                 (11)3F4M7842
SV5    AXT     **,5                                                 (11)3F4M7844
SV6    AXT     **,6                                                 (11)3F4M7846
SV7    AXT     **,7                                                 (11)3F4M7848
.FOJP  AXT     **,4                  RESTORE INDICES AND                3F4M7850
SV1    AXT     **,1                  RETURN TO MAIN                     3F4M7860
SV2    AXT     **,2                  OBJECT                             3F4M7870
       TRA     1,4                   PROGRAM.                           3F4M7880
*      END OF LINE REACHED, COUNT IS DONE - WRITE A LINE                3F4M7890
ENDLIN STL     LINFUL                FORCE LINE FULL EXIT               3F4M7900
       TRA     SPACBT                                                   3F4M7910
*      CONSTANTS                                                        3F4M7920
BLANKS BCI     1,                                                       3F4M7930
H1     BCI     1,1$0000                                                 3F4M7940
ENDT   BCI     1,0$ END                                                 3F4M7950
EQL    BCI     1, =                                                     3F4M7960
MSK    OCT     000000000007                                             3F4M7970
FSW    PZE                           FIRST LINE SWITCH.                 3F4M7980
CMPLX  PZE                           COMPLEX NUMBER SWITCH.             3F4M7990
DBLSW  PZE                           DOUBLE PRECISION SWITCH.           3F4M8000
FSWD   PZE                           FIRST WORD OF COMPLEX SWITCH.      3F4M8010
ARYSIZ PZE                                                              3F4M8020
L(1)   PZE     1                                                        3F4M8030
LINFUL PZE                           LINE FULL SWITCH                   3F4M8040
FOUR   PZE     4                                                        3F4M8050
TWO    PZE     2                                                        3F4M8060
 TPBT  PZE                                                           $5$3F4M8070
LNKG   LDIR                                                             3F4M8080
KOUNT  PZE                                                              3F4M8090
END94  NULL                                                          $5$3F4M8100
       END                                                           $5$3F4M8110
$*     7090/7094 IBLIB SYSTEM LIBRARY - FRDU                            3F4N0000
$IBMAP FRDU    ()OK                                                     3F4N0010
       TTL     FRDU - UNFORMATTED INPUT/OUTPUT READ ROUTINE          (7)3F4N0020
       REM                                                              3F4N0040
       REM     CALLING SEQUENCE IS                                      3F4N0050
       REM       CALL .FRDU.(ARG,YYYY)                                  3F4N0060
       REM     ARG IS LOCATION OF PZE UNITXX WHERE XX = LOGICAL UNIT N. 3F4N0070
       REM     YYYY IS A NAMELIST NAME.                                 3F4N0080
       REM                                                              3F4N0090
       ENTRY   .FRDU.                                                   3F4N0100
       REM                                                              3F4N0120
.FRDU. SXA     LNKG,4        SAVE RETURN TO MAIN PROGRAM.               3F4N0130
       SXA     SYSLOC,4      SAVE LINKAGE DIRECTOR FOR ERROR TRACE.     3F4N0140
       SXA     RTRN,4                                                   3F4N0150
       CLA*    4,4           OBTAIN NAMELIST NAME.                      3F4N0160
       STO     .NAME.                                                   3F4N0170
       CLA     4,4                                                      3F4N0180
       STA     .NMLST        OBTAIN LOCATION OF NAMELIST NAME.          3F4N0190
       STZ     .INTAP         INITIALIZE                             (7)3F4N0191
       CLA*    3,4            AC = LOCATION OF FCB                   (7)3F4N0192
       PAX     0,4                                                   (7)3F4N0193
       TXI     *+1,4,2        IR4 = LOCATION OF 3RD WORD OF FCB      (7)3F4N0194
       SXA     *+1,4                                                 (7)3F4N0195
       LDI     **             IND. = 3RD WORD OF FCB                 (7)3F4N0196
       LFT     100000        IS THE INPUT UNIT SYSIN1/2              (7)3F4N0197
       STL     .INTAP         YES. SET FLAG TO INDICATE READING IN1  (7)3F4N0199
       CALL    .FIOS.(ARG1,ARG2) *CALL I/O INITIALIZATION ROUTINE.      3F4N0200
       ORG     *-2           OVERLAY CALL WITH ARGUMENTS.               3F4N0210
ARG1   PZE     1,,0          SET .REED ON, .BIN OFF IN FIOS.            3F4N0220
ARG2   IORTN*  .FBDBF,,**    TRANSMIT I/O COMMAND.                      3F4N0230
       CALL    .FIOU.(RTNUI,RTRN)  *ENTER UNFORMATTED I/O SCAN.         3F4N0240
       ORG     *-2           OVERLAY CALL WITH ARGUMENTS.               3F4N0250
RTNUI  NOP     RDUIO         NOP = READ, RDUIO = LOC. OF READ CALL.     3F4N0260
RTRN   PZE     **            CONTAINS RETURN TO MAIN PROGRAM.           3F4N0270
RDUIO  SXA     RDRT,2                                                   3F4N0280
       TSX     .FSEL.,4      READ A RECORD.                             3F4N0290
       LXD     .FILR.,4      SET WORD COUNT.                            3F4N0300
       SXA     .CTUIO,4                                                 3F4N0310
RDRT   AXT     **,2                                                     3F4N0320
       TRA     1,2           RETURN TO .FIOU.                           3F4N0330
LNKG   LDIR                                                             3F4N0350
       END                                                           $5$3F4N0360
$IBMAP FIOS.                                                         $5$3F4O0000
       TTL     ALTERNATE I/O SUPERVISOR AND TRANSMISSION VERFIER    (14)3F4O0010
       LBL     .IOS,BEGIN     FIOS.                                  (7)3F4O0015
*              TRANSMISSION CHECK LOGIC VIA ..FTCK ENTRY             $5$3F4O0020
*              SELECT SEQUENCE FOR .LXSL AT ..FSEL ENTRY             $5$3F4O0030
*              TESTS FOR VALIDITIY OF UNIT VIA ..FCHK ENTRY          $5$3F4O0040
*              I/O TRANSMISSION VIA ..FIOC ENTRY                     $5$3F4O0050
*              CHECK TRANSMISSION FOR BACKSPACE ROUTINE AT ..FBCK    $5$3F4O0060
       ENTRY   ..FIOC                                                $5$3F4O0070
       ENTRY   ..FTCK                                                $5$3F4O0080
       ENTRY   ..FIOS                                                $5$3F4O0090
       ENTRY   ..FSEL                                                $5$3F4O0100
       ENTRY   ..FCHK                                                $5$3F4O0110
       ENTRY   ..FBCK                                                $5$3F4O0120
       ENTRY   .LUNBL                                               (13)3F4O0124
       ENTRY   .LFBLK                                               (13)3F4O0126
       SPACE                                                         $5$3F4O0130
*              ..FIOS ENTRY IS CALLED AS FOLLOWS                     $5$3F4O0140
*                 ( FLAG IN PREFIX)          FLAG = 000  BCD-READ    $5$3F4O0150
*                   CALL ..FIOS(SEL)                001  BIN-READ    $5$3F4O0160
*                   ORG  *-1                        010  BCD-WRITE   $5$3F4O0170
*              SEL  IORT BUFFER,,COUNT              011  BIN-WRITE   $5$3F4O0180
*                                                                    $5$3F4O0190
*              INITIAL ENTRY FROM INTERFACE RTNES VIA FBIN. OR FBCD. $5$3F4O0200
..FIOS SXA     LK.DR,4             SAVE X4                           $5$3F4O0210
       SLW     TEMP                STORE AC                         (12)3F4O0212
       TSX     ..FTCK,4            CHECK PRIOR TRANSMISSION         (12)3F4O0214
       CAL     TEMP                RESTORE AC                       (12)3F4O0216
       STP     ..FSEL              SET UP MODE PREFIX                $5$3F4O0220
       LGR     35                  TEST FOR REQUEST TYPE             $5$3F4O0230
       STQ     RTYPE               SAVE REQUEST TYPE                 $5$3F4O0240
       LXA     SYSLOC,4            GET ORIGINAL CALL TO I/O SYSTEM   $5$3F4O0270
       CAL*    3,4                 GET .UNXX. CELL                   $5$3F4O0280
       STA     B1                  SAVE LOCATION OF FCB              $5$3F4O0320
       CLS     SYSUNI              COMPUTE                           $5$3F4O0330
       ANA     MASK1                RELATIVE                         $5$3F4O0340
       SSM                                                           $5$3F4O0350
       ADM*    3,4                   SYSUNI                          $5$3F4O0360
       STA     ..FSEL                                                $5$3F4O0370
*              TEST FOR VALID READ AND WRITE REQUESTS                $5$3F4O0380
       LAC     SYSUNI,4            ORIGIN OF SYSUNI TABLE            $5$3F4O0390
 B1    CAL     **                  GET FIRST                         $5$3F4O0400
       STA     *+1                  WORD OF                          $5$3F4O0401
       CAL     **                    UCB                             $5$3F4O0402
       TQP     B2                  IS IT A READ REQUEST              $5$3F4O0410
       ERA*    SYSIN1,4            NO, WRITE REQUEST                 $5$3F4O0420
       TRA     B3                                                    $5$3F4O0430
 B2    ERA*    SYSOU1,4            READ REQUEST                      $5$3F4O0440
 B3    ANA     MASK                TEST UNIT ONLY                    $5$3F4O0450
       TNZ     OK                  I/O IS OK                         $5$3F4O0460
       TQP     ER56                READ ERROR 56                     $5$3F4O0470
 ER54  CALL    .FXEM.(CODE7)       WRITE ERROR                       $5$3F4O0480
       TRA     .LXERR              NO OPTIONAL EXIT                  $5$3F4O0490
 ER56  CALL    .FXEM.(CODE8)       READ ERROR                        $5$3F4O0500
       TRA     .LXERR              NO OPTIONAL EXIT                  $5$3F4O0510
*                                                                    $5$3F4O0520
OK     LAC     B1,4                                                 (12)3F4O0530
       LDI     1,4                 MOVE 2ND WORD OF FCB TO SENSE IND(13)3F4O0535
       RIL     004001              TURN OFF OUTPUT AND MODE BITS    (14)3F4O0536
       TQP     *+2                 TEST FOR WRITE, IF WRITE         (13)3F4O0537
       SIL     001                 TURN ON OUTPUT BIT               (13)3F4O0538
       LGL     1                   MOVE MODE BIT TO SIGN OF MQ      (14)3F4O0539
       TQP     *+2                 TEST FOR BCD                     (14)3F4O053A
       SIL     004000              SET BINARY MODE BIT              (14)3F4O053B
       STI     1,4                 STORE SENSE IND IN 2ND WRD OF FCB(14)3F4O053C
       LDI     IND                 RESTORE SENSE INDICATORS         (14)3F4O053D
 RTN1  LXA     LK.DR,4             RESTORE X4                        $5$3F4O0540
       CAL     3,4                 GET I/O COMMAND                  (10)3F4O0541
       SLW     COMD                AND STORE IN .LXSL SEQUENCE      (10)3F4O0542
       TRA     1,4                                                   $5$3F4O0550
PON    PON                                                          (10)3F4O0551
       SPACE                                                         $5$3F4O0560
*              COMMON RETURN POINTS - PRIMARY CALLS ONLY             $5$3F4O0570
 X2    AXT     **,2                RESTORE X2                        $5$3F4O0580
 LDI   LDI     IND                 RESTORE SENSE INDICATORS          $5$3F4O0590
 RTN   AXT     **,4                RESTORE X4                        $5$3F4O0600
       TRA     1,4                 RETURN TO CALLER                  $5$3F4O0610
       SPACE                                                         $5$3F4O0620
*              .LXSEL COMMAND SEQUENCE LOGIC                         $5$3F4O0630
..FIOC STL     FCTL                SET REQUESTOR FLAG FOR FORTRAN    $5$3F4O0640
       SXA     OUT,4               SAVE X4                           $5$3F4O0650
       LDQ     RTYPE               GET REQUEST TYPE                  $5$3F4O0660
       CLA     SXA                 READ REQUEST                      $5$3F4O0670
       TQP     *+3                                                  (10)3F4O0680
       ZET*    SYSJOB+1            PREVENT WRITE OVERLAP IF DCS     (10)3F4O0681
       CLA     TRA                 WRITE REQUEST                     $5$3F4O0690
       STO     .LXOVL               PERMITS OVERLAP IF WRITE         $5$3F4O0700
       TSX     SET,4               .LXSL AND .LXCON INITIALIZATION   $5$3F4O0710
       CALL    .LXSEL(..FSEL)      REQUEST .LXSL TO PERFORM I/O      $5$3F4O0720
 OUT   AXT     **,4                                                  $5$3F4O0730
       STL     CKPG                CHECK PENDING SWITCH ON           $5$3F4O0740
       TRA     1,4                 RETURN TO CALLER                  $5$3F4O0750
..FSEL PZE     **,,COMD                                              $5$3F4O0760
 COMD  IORT    **,,**                                                $5$3F4O0770
       TCH     .LTCH                                                 $5$3F4O0780
       SPACE                                                         $5$3F4O0790
*      SET AND RESET INSTRUCTIONS FOR .LXSL AND .LXCON               $5$3F4O0800
 SET   CAL     TSX1                                                  $5$3F4O0810
       TRA     COM                                                   $5$3F4O0820
 RESET CAL     NOP                                                   $5$3F4O0830
       SLW     .LXOVL              .LXSL                             $5$3F4O0840
 COM   SLW     .LXTST              .LXSL                             $5$3F4O0850
       SLW     .LXCAL              .LXCON                            $5$3F4O0860
       TRA     1,4                                                   $5$3F4O0870
       SPACE                                                         $5$3F4O0880
*              OVERLAY CONSTANTS FOR .LXSL AND .LXCON                $5$3F4O0890
 TSX1  TSX     ..FREQ,2                                              $5$3F4O0900
 TRA   TRA     SXA                                                   $5$3F4O0910
 SXA   SXA     UCW,2               SAVE COMP OF CURRENT UCW          $5$3F4O0920
       TRA     .LXOVL+3             PERMIT WRITE OVERLAP             $5$3F4O0930
       EJECT                                                         $5$3F4O0940
*              CHECK VALIDITY OF TRANSMISSSION                       $5$3F4O0950
..FBCK STL     BSTFG               SET BACKSPACE CHECK REQUEST       $5$3F4O0960
       TRA     *+2                                                   $5$3F4O0970
..FTCK STZ     BSTFG               SET NORMAL CHECK REQUEST          $5$3F4O0980
       SXA     RTN,4               SAVE X4                           $5$3F4O0990
       SXA     X2,2                SAVE X2                           $5$3F4O1000
       STI     IND                 SAVE SENSE INDICATORS             $5$3F4O1010
       NZT     CKPG                TEST PENDING SWITCH               $5$3F4O1020
       TRA     X2                   NONE WAITING                     $5$3F4O1030
REPT   STZ     CKPG                SET PENDING SWITCH OFF           (12)3F4O1040
       LAC     UCW,2               GET APPROPRIATE UCB LOCATION     (12)3F4O1050
       SXA     UCW,2               COMP UCW IN SAVE CELL             $5$3F4O1060
       LAC     UCW,2               GET COMP OF UCW                   $5$3F4O1070
       ZET     1,2                 DELAY TILL DORMANT                $5$3F4O1080
       TRA     *-1                  PRIOR ACTIVITY COMPLETE          $5$3F4O1090
       LDI     .LXIND              POSTING ENTRY FROM IOEX           $5$3F4O1100
 A7607 LFT     200000              EOF OR EOT                        $5$3F4O1110
       TRA     COMEOF               YES                              $5$3F4O1120
       ZET     TYPE                READ OR WRITE CHECKING            $5$3F4O1130
 WOK   TRA     X2                  WRITE TRANSMISSION OK             $5$3F4O1140
       LNT     400000                                               (10)3F4O1150
       TRA     RDON                                                  $5$3F4O1175
RDRD   LFT     100000              REDUNDANT...                     (10)3F4O1180
       TRA     RDERR               YES                              (10)3F4O1181
       NZT     BSTFG               BACKSPACING...                   (10)3F4O1182
ACCPT  TRA     X2                                                    $5$3F4O1190
       LDI     .LXMOD              YES                              (10)3F4O1191
       STZ     .LXMOD              ZERO MODE SWITCH INDICATOR       (10)3F4O1192
       RNT     000020              AND TEST MODE                    (10)3F4O1193
       TRA     3,4                 BCD...                           (10)3F4O1194
       TRA     1,4                 BINARY...                        (10)3F4O1195
*      PROCESS READ ERROR                                            $5$3F4O1200
RDERR  AXT     42,4                                                  $5$3F4O1210
       NZT     MODE                                                  $5$3F4O1220
       AXT     35,4                BCD ERROR CODE                    $5$3F4O1230
       ZET     BSTFG                                                (10)3F4O1231
       AXT     48,4                FBST. ERROR CODE                 (10)3F4O1232
       SXA     CODE4,4                                               $5$3F4O1240
       LDQ*    UCW                 DEVELOP UNIT                      $5$3F4O1250
       TSX     .SYMUN,4             ADDRESS VIA IOEX                 $5$3F4O1260
       SLW     E42MES+6               AND PLACE IN MESSAGE           (7)3F4O1270
       CALL    .FXEM.(CODE4)                                         $5$3F4O1280
       NZT     BSTFG               BACKSPACING...                   (10)3F4O1281
       TRA     ACCPT                                                 $5$3F4O1290
       STZ     .LXMOD              RESET MODE SWITCH INDICATOR      (10)3F4O1291
       XEC     RTN                 RESTORE XR4                      (10)3F4O1292
       NZT     MODE                ASSUME MODE ACCORDING            (10)3F4O1293
       TRA     3,4                 TO MODE OF PRIOR TRANSMISSION    (10)3F4O1294
       TRA     1,4                 (I.E.,MODE OF FIRST READ ATTEMPT)(10)3F4O1295
       SPACE                                                         $5$3F4O1300
*              READ NEXT RECORD OPTION                               $5$3F4O1310
 RDON  TSX     ..FIOC,4            READ NEXT RECORD                  $5$3F4O1320
       TRA     REPT                 CHECK TRANSMISSION               $5$3F4O1330
       SPACE                                                         $5$3F4O1340
*              PROCESS EOF OR EOT                                    $5$3F4O1350
COMEOF ZET     BSTFG                                                 $5$3F4O1360
       TRA     2,4                 BST EOF                           $5$3F4O1361
       ZET     TYPE                READ OR WRITE CHECKING            $5$3F4O1362
       TRA     EOT                 WRITE EOT                         $5$3F4O1370
       ZET     MODE                                                  $5$3F4O1380
       TRA     BIN                                                   $5$3F4O1390
 BCD   LAC     SYSUNI,4            CHECK FOR SYSIN1                  $5$3F4O1400
       CAL*    SYSIN1,4             EOF CONDITION                    $5$3F4O1410
       ERA*    UCW                                                   $5$3F4O1420
       ANA     MASK                                                  $5$3F4O1430
       TZE     .LXRTN              TERMINATE JOB IF SYSIN1           $5$3F4O1440
       AXT     34,4                BCD ERROR CODE                    $5$3F4O1450
       TRA     *+2                                                   $5$3F4O1460
 BIN   AXT     41,4                BINARY ERROR CODE                 $5$3F4O1470
       SXA     CODE3,4                                               $5$3F4O1480
       LDQ*    UCW                 DEVELOP UNIT                      $5$3F4O1490
       TSX     .SYMUN,4             ADDRESS VIA IOEX                 $5$3F4O1500
       SLW     E41MES+6               AND PLACE IN MESSAGE           (7)3F4O1510
       CALL    .FXEM.(CODE3)                                         $5$3F4O1520
       TRA     RDON                                                  $5$3F4O1530
       SPACE                                                         $5$3F4O1540
*              PROCESS EOT - PERFORM REEL SWITCH                     $5$3F4O1550
 EOT   TSX     .NDSEL,4            WRITE                             $5$3F4O1560
       PZE     UCW,,7               END OF                           $5$3F4O1570
 NOP   NOP                           FILE   (USED AS NOP CONSTANT)   $5$3F4O1580
       TSX     .NDSEL,4            REWIND                            $5$3F4O1590
       PZE     UCW,,4               UNLOAD                           $5$3F4O1600
       LDQ*    UCW                 PRINT  UNIT XXXXXX AND            $5$3F4O1610
       TSX     .CVPRT,4             APPEND MESSAGE                   $5$3F4O1620
       PZE     MESOL,,6+512*2                                        $5$3F4O1640
       TSX     .PAUSE,4            PAUSE FOR OPERATOR ACTION         $5$3F4O1650
       TRA     WOK                 CONTINUE PROCESSING               $5$3F4O1660
       EJECT                                                         $5$3F4O1670
*              ..FCHK ENTRY TO CHECK VALIDITY OF UNITS               $5$3F4O1680
*                 ( LOCATION OF UCB IN ACC )                         $5$3F4O1690
*                   CALL ..FCHK(NOTE,ACTION)                         $5$3F4O1700
*                   ORG  *-2                                         $5$3F4O1710
*              NOTE BCI  1,FUNCTIONAL-NAME AS BST, RWD               $5$3F4O1720
*            ACTION PZE  FOUND,,N      N= 1 THRU 7 INDICATES WHICH   $5$3F4O1730
*                         SYSUNI IS REQ   1 = PP1, 2 = OU1 , 4 = IN1 $5$3F4O1740
*                      IF FOUND, IGNORE MESSAGE IS PRINTED AND       $5$3F4O1750
*                        RETURN IS MADE TO CALLER VIA FOUND ADDRESS  $5$3F4O1760
       SPACE                                                         $5$3F4O1770
..FCHK SXA     FX4,4               SAVE X4                           $5$3F4O1780
       SXA     FX2,2                                                 $5$3F4O1790
       STI     FIND                SAVE INDICATORS                   $5$3F4O1800
       LDI     4,4                 ACTION WORD TO INDICATORS         $5$3F4O1810
       STA     UNIT                SET UP UCB ADDRESS                $5$3F4O1820
       CLA     3,4                 PLACE FUNCTIONAL                  $5$3F4O1830
       STO     MESSG                NAME IN MESSAGE                  $5$3F4O1840
       TSX     ..FTCK,4            CHECK PRIOR TRANSMISSION          $5$3F4O1850
       AXT     3,2                 TEST RANGE = THREE UNITS          $5$3F4O1860
       LDQ     DECFOR              1 IN DECREMENT OF MQ              $5$3F4O1870
       LAC     SYSUNI,4            GET BASE OF SYSUNI TABLE          $5$3F4O1880
 UNIT  CAL     **                  GET FIRST WORD                    $5$3F4O1890
       STA     *+1                  OF UCB                           $5$3F4O1891
       CAL     **                  LOOP                              $5$3F4O1892
       XEC     LIST+3,2              FOR                             $5$3F4O1900
       ANA     MASK                   SYSUNI                         $5$3F4O1910
       TZE     FND                                                   $5$3F4O1920
       RQL     1                   ROTATE INDICATOR BIT ONE POSITION $5$3F4O1930
       TIX     UNIT,2,1                                              $5$3F4O1940
       TRA     FGD                 NOT FOUND                         $5$3F4O1950
 FND   XCL                                                           $5$3F4O1960
       TIF     FGD                 UNIT OK                           $5$3F4O1970
       CALL    .LXSEL(L)           PRINT IGNORE MESSAGE ON SYSOU1    $5$3F4O1980
       LDI     FIND                RESTORE SENSE INDICATORS          $5$3F4O1990
 FX2   AXT     **,2                RESET X2                          $5$3F4O2000
 FX4   AXT     **,4                RESET X4                          $5$3F4O2010
       TRA*    4,4                 TRA TO OPTIONAL EXIT - FOUND ADD  $5$3F4O2020
 FGD   XEC     FX2                 RESTORE X2                        $5$3F4O2030
       XEC     FX4                 RESTORE X4                        $5$3F4O2040
       LDI     FIND                RESTORE INDICATORS                $5$3F4O2050
       TRA     1,4                 OK RETURN                         $5$3F4O2060
 FIND  PZE     0,,0                INDICATOR SAVE AREA               $5$3F4O2070
 L     PTW     SYSOU1,,LCD                                           $5$3F4O2080
 LCD   IORT    MESSG,,6                                              $5$3F4O2090
 MESSG BCI     6,       IGNORED ON OU1, PP1, OR IN1                  $5$3F4O2100
 LIST  ERA*    SYSPP1,4            001                               $5$3F4O2110
       ERA*    SYSOU1,4            010                               $5$3F4O2120
       ERA*    SYSIN1,4            100                               $5$3F4O2130
       EJECT                                                         $5$3F4O2140
*              TEST USER OF .LXSL, IF FORTRAN RESET FCTL FLAG AND    $5$3F4O2150
*               RETURN.  IF OTHER THAN FORTRAN, CHECK TRANSMISSION   $5$3F4O2160
*               RESET .LXCON AND .LXSL AND RETURN TO .LXSL OR .LXCON $5$3F4O2170
..FREQ NZT     FCTL                REQUESTOR FLAG                    $5$3F4O2180
       TRA     CLOSE               NOT FORTRAN                       $5$3F4O2190
       STZ     FCTL                RESET REQUESTOR FLAG              $5$3F4O2200
       TRA     1,2                 RETURN TO .LXSL                   $5$3F4O2210
 CLOSE SXA     RS4,4               SAVE X4                           $5$3F4O2220
       ZET     CKPG                                                  $5$3F4O2230
       TSX     ..FTCK,4            CHECK TRANSMISSION                $5$3F4O2240
       TSX     RESET,4             RESET .LXCON AND .LXSL            $5$3F4O2250
 RS4   AXT     **,4                RESET X4                          $5$3F4O2260
 ZAC   ZAC                         ZERO ACC  (ALSO USED AS CONSTANT) $5$3F4O2270
       TRA     1,2                                                   $5$3F4O2280
       EJECT                                                         $5$3F4O2290
*              CONSTANTS AND FLAGS                                   $5$3F4O2300
 CODE3 PZE     **                                                    $5$3F4O2310
ER41MS PZE     E41MES,,7                                             $5$3F4O2320
ER41OP PZE     E41OMS,,3                                             $5$3F4O2330
E41MES BCI     7,0END OF FILE READING                                $5$3F4O2340
E41OMS BCI     3,0READ NEXT FILE                                     $5$3F4O2350
 CODE4 PZE     **                                                    $5$3F4O2360
ER42MS PZE     E42MES,,7                                             $5$3F4O2370
ER42OP PZE     E42OMS,,6                                             $5$3F4O2380
E42MES BCI     7,0PERMANENT READ REDUNDANCY                          $5$3F4O2390
E42OMS BCI     6,0RECORD USED AS READ THE 100TH TIME                 $5$3F4O2400
 CODE7 PZE     54                                                    $5$3F4O2410
ER54MS PZE     E54MES,,8                                             $5$3F4O2420
ER54OP PZE     NOOPXT,,7                                             $5$3F4O2430
E54MES BCI     8,0WRITE REQUEST ON UNIT DEFINED AS SYSIN1 ILLEGAL    $5$3F4O2440
 CODE8 PZE     56                                                    $5$3F4O2450
ER56MS PZE     E56MES,,8                                             $5$3F4O2460
ER56OP PZE     NOOPXT,,7                                             $5$3F4O2470
E56MES BCI     8,0READ REQUEST ON UNIT DEFINED AS SYSOU1 ILLEGAL     $5$3F4O2480
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED            $5$3F4O2490
       SPACE                                                         $5$3F4O2500
 TYPE  EQU     .LXIND+1            READ = 0  WRITE = NON ZERO        $5$3F4O2510
 MODE  EQU     .LXIND-1            BCD = 0   BINARY = NON ZERO       $5$3F4O2520
 IND   PZE     0,,0                INDICATOR STORAGE                 $5$3F4O2530
 MASK  OCT     017777000000                                          $5$3F4O2540
 MASK1 OCT     000000077777                                          $5$3F4O2550
 TEMP  PZE     0,,0                                                  $5$3F4O2560
 MESOL BCI     6, CHANGE TAPES ON UNIT SPECIFIED                     $5$3F4O2570
 UCW   PZE     **                  LOCATION OF UCB                   $5$3F4O2580
 BSTFG PZE     0,,0                BACKSPACE CHECK REQUEST           $5$3F4O2590
 FCTL  PZE     0,,0                REQUESTOR FLAG                    $5$3F4O2600
DECFOR PZE     0,,1                DECREMENT=1                       $5$3F4O2610
 CKPG  PZE     0,,0                = 0 NO CHECK   = NON 0  CHECK REQ $5$3F4O2620
 RTYPE PZE     0,,0                                                  $5$3F4O2630
.LUNBL BSS     1                   LOC AND LENGTH RESERVE UNIT BLOCK(13)3F4O2632
.LFBLK BSS     1                   L(FILE BLOCK),,SIZE              (13)3F4O2634
 LK.DR LDIR                                                          $5$3F4O2640
       ORG     .LUNB                                                (13)3F4O2642
       PZE     .LUNBL                                               (13)3F4O2644
       ORG     .CLSE                                                (13)3F4O2646
       TRA     2,4                 DUMMY CLOSE FOR .LXCON           (13)3F4O2648
       END                                                           $5$3F4O2650
$IBMAP FRDD.   22                                                       3F4P0000
       TTL  ALTERNATE I/O  READ DECIMAL INTERFACE ROUTINE               3F4P0010
       LBL     .RDD,BEGIN     FRDD.                                  (7)3F4P0013
*              CALLING SEQUENCE FOR -- READ (N,F) LIST --               3F4P0020
*                   CALL ..FRDD(ARG,LF)                                 3F4P0030
*                    WHERE  ARG = LOCATION OF  PZE UNITXX, XX IS        3F4P0040
*                                 LOCATION OF LOGICAL UNIT N            3F4P0050
*                            LF = LOCATION OF FORMAT STATEMENT F        3F4P0060
       ENTRY   ..FRDD                                                   3F4P0070
..FRDD SXA     SYSLOC,4            SAVE FORTRAN CALL LOCATION IN SYSLOC 3F4P0080
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR          3F4P0090
       SXA     ARG,4               SAVE ORIGINAL FORTRAN CALL           3F4P0100
       CALL    ..FBCD              READ ENTRY TO FBCD.                  3F4P0110
*                                   SETS UP .LXSL COMMAND AND           3F4P0120
*                                   GENERATES CALL TO FIOS.             3F4P0130
       CALL    .FIOH.(ENT,ARG)     CALL HOLLERITH COORDINATOR           3F4P0140
       ORG     *-2                                                      3F4P0150
 ENT   NOP     READ                 AND RELINQUISH                      3F4P0160
 ARG   PZE     0,,0                  CONTROL TO IT                      3F4P0170
*                                                                       3F4P0180
*                     PROCESS FIOH READ REQUEST                         3F4P0190
*                                                                       3F4P0200
 READ  TSX     ..FIOC,4            REQUEST SINGLE RECORD VIA ..FIOC     3F4P0210
       TSX     ..FTCK,4            CHECK CURRENT READ TRANSMISSION      3F4P0220
       AXT     ..FBCB,4            PLACE THE LOCATION                   3F4P0230
       SXA     .FBDBF,4             OF THE READ BUFFER IN FIOH          3F4P0240
       AXT     1,4                 RESET                                3F4P0250
       SXA     .FDX1,4              POINTERS                            3F4P0260
       SXA     .FDX2,4               IN FIOH                            3F4P0270
       TRA     1,2                 RETURN TO FIOH                       3F4P0280
 LK.DR LDIR                                                             3F4P0290
       END                                                              3F4P0300
$IBMAP FWRD.   33                                                       3F4Q0000
       TTL  ALTERNATE I/O WRITE DECIMAL INTERFACE ROUTINE               3F4Q0010
       LBL     .WRD,BEGIN     FWRD.                                  (7)3F4Q0013
*              CALLING SEQUENCE FOR -- WRITE (N,F) LIST --              3F4Q0020
*                   CALL ..FWRD(ARG,LF)                                 3F4Q0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS          3F4Q0040
*                                LOCATION OF LOGICAL UNIT N             3F4Q0050
*                          LF  = LOCATION OF FORMAT STATEMENT F         3F4Q0060
       ENTRY   ..FWRD                                                   3F4Q0070
..FWRD SXA     SYSLOC,4            SAVE FORTRAN CALL LOCATION IN SYSLOC 3F4Q0080
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR          3F4Q0090
       SXA     ARG,4               SAVE ORIGINAL FORTRAN CALL           3F4Q0100
       CALL    ..FBCW              WRITE ENTRY TO FBCD.                 3F4Q0110
*                                   SETS UP .LXSL COMMAND AND           3F4Q0120
*                                   GENERATES CALL TO FIOS.             3F4Q0130
       CALL    .FIOH.(ENT,ARG)     CALL HOLLERITH COORDINATOR           3F4Q0140
       ORG     *-2                  AND                                 3F4Q0150
 ENT   TRA     WRITE                 RELINQUISH                         3F4Q0160
 ARG   PZE     0,,0                  CONTROL TO IT   ORIGINAL X4        3F4Q0170
*                                                                       3F4Q0180
*                    PROCESS FIOH WRITE REQUEST                         3F4Q0190
*                                                                       3F4Q0200
 WRITE TSX     ..FTCK,4            CHECK PRIOR WRITE                    3F4Q0210
*                                                                       3F4Q0220
*                MOVE  DATA  TO  OUTPUT BUFFER                          3F4Q0230
       SXD     ..FSEL+1,1          STORE WORD COUNT                     3F4Q0240
       AXT     0,4                 MOVE                                 3F4Q0250
 LOOP  CAL     .OUTBF,4             DATA                                3F4Q0260
       SLW     ..FBCB,4              TO                                 3F4Q0270
       TXI     *+1,4,-1            OUTPUT                               3F4Q0280
       TIX     LOOP,1,1             BUFFER                              3F4Q0290
*                                                                       3F4Q0300
       TSX     ..FIOC,4            OUTPUT SINGLE RECORD VIA ..FIOC      3F4Q0310
       TRA     1,2                 RETURN TO FIOH                       3F4Q0320
 LK.DR LDIR                                                             3F4Q0330
       END                                                              3F4Q0340
$IBMAP FBCD.   35                                                    $5$3F4R0000
       TTL     ALTERNATE I/O BCD COORDINATOR AND BCD BUFFER  $5$    (11)3F4R0010
       LBL     .BCD,BEGIN     FBCD.                                  (7)3F4R0013
       ENTRY   ..FBCD                                                $5$3F4R0020
       ENTRY   ..FBCW                                                $5$3F4R0030
       ENTRY   ..FBCB                                                $5$3F4R0040
SIZE   SET     23                  SETS BCD BUFFER = 23             (11)3F4R0050
..FBCD ZAC                         READ REQUEST                      $5$3F4R0060
       TRA     *+2                                                   $5$3F4R0070
..FBCW CAL     PTW                 WRITE REQUEST                     $5$3F4R0080
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR       $5$3F4R0090
       CALL    ..FIOS(SEL)         CALL FIOS. AND                    $5$3F4R0100
       ORG     *-1                  SET UP I/O COMMAND               $5$3F4R0110
 SEL   IORT    ..FBCB,,SIZE        WORD COUNT = SIZE                 $5$3F4R0120
       LXA     LK.DR,4             RESTORE X4                        $5$3F4R0130
       TRA     1,4                 EXIT TO FRDD. OR FWRD.            $5$3F4R0140
*                              ZERO PREFIX INDICATES BCD READ        $5$3F4R0150
 PTW   PTW     0,,0                 PREFIX INDICATES BCD WRITE       $5$3F4R0160
..FBCB BSS     SIZE                BCD BUFFER LOCATION               $5$3F4R0170
 LK.DR LDIR                                                          $5$3F4R0180
       END                                                           $5$3F4R0190
$IBMAP FRDB.   26                                                       3F4S0000
       TTL  ALTERNATE I/O BINARY READ INTERFACE ROUTINE                 3F4S0010
       LBL     .RDB,BEGIN     FRDB.                                  (7)3F4S0013
*              CALLING SEQUENCE FOR -- READ (N) LIST --                 3F4S0020
*                   CALL ..FRDB(ARG)                                    3F4S0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS          3F4S0040
*                                LOCATION OF LOGICAL UNIT N             3F4S0050
       ENTRY   ..FRDB                                                   3F4S0060
..FRDB SXA     SYSLOC,4            SAVE FORTRAN CALL LOCATION IN SYSLOC 3F4S0070
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR          3F4S0080
       SXA     ARG,4               SAVE ORIGINAL FORTRAN CALL           3F4S0090
       CALL    ..FBID              READ ENTRY TO FBIN.                  3F4S0100
*                                   SETS UP .LXSL COMMAND AND           3F4S0110
*                                   GENERATES CALL TO FIOS.             3F4S0120
       CLA     SIZE                BUFFER SIZE TO ACCUMULATOR           3F4S0130
       CALL    .FIOB.(ENT,ARG)     CALL BINARY COORDINATOR              3F4S0140
       ORG     *-2                                                      3F4S0150
 ENT   NOP     READ                 AND RELINQUISH                      3F4S0160
 ARG   PZE     0,,0                  CONTROL TO IT                      3F4S0170
*                     PROCESS FIOB READ REQUEST                         3F4S0180
 READ  TSX     ..FIOC,4            REQUEST SINGLE RECORD VIA ..FIOC     3F4S0190
       TSX     ..FTCK,4            CHECK CURRENT READ TRANSMISSION      3F4S0200
       LAC     .COMM,4             OBTAIN RESULTS                       3F4S0210
       TXI     *+1,4,..FB1B         OF A STCH AND PLACE                 3F4S0220
       SXD     .FCNT,4               IN FIOB                            3F4S0230
       AXT     ..FB1B,4             AND LOCATION OF BUFFER              3F4S0240
       SXA     .FBIBF,4             IN FIOB                             3F4S0250
       TRA     1,2                 RETURN TO FIOB                       3F4S0260
 SIZE  PZE     0,,255              BINARY BUFFER SIZE (LOGICAL)         3F4S0270
 LK.DR LDIR                                                             3F4S0280
       END                                                              3F4S0290
$IBMAP FWRB.   297                                                      3F4T0000
       TTL  ALTERNATE I/O BIN WRITE ROUTINE AND SEC. BINARY BUFFER      3F4T0010
       LBL     .WRB,BEGIN     FWRB.                                  (7)3F4T0013
*              CALLING SEQUENCE FOR -- WRITE (N) LIST --                3F4T0020
*                   CALL ..FWRB(ARG)                                    3F4T0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS          3F4T0040
*                                LOCATION OF LOGICAL UNIT N             3F4T0050
       ENTRY   ..FWRB                                                   3F4T0060
 SIZE  SET     256                 SETS SECONDARY BUFFER = 256          3F4T0070
..FWRB SXA     SYSLOC,4            SAVE FORTRAN CALL LOCATION IN SYSLOC 3F4T0080
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR          3F4T0090
       SXA     ARG,4               SAVE ORIGINAL FORTRAN CALL           3F4T0100
       STZ     INFLG               SET FIRST TIME FLAG                  3F4T0110
       CALL    ..FBIW              WRITE ENTRY TO FBIN.                 3F4T0120
*                                   SETS UP .LXSL COMMAND AND           3F4T0130
*                                   GENERATES CALL TO FIOS.             3F4T0140
       CLA     BUF                 BUFFER SIZE IN AC                    3F4T0150
       CALL    .FIOB.(ENT,ARG)     CALL BINARY COORDINATOR              3F4T0160
       ORG     *-2                                                      3F4T0170
 ENT   TRA     WRITE                AND RELINQUISH                      3F4T0180
 ARG   PZE     0,,0                  CONTROL TO IT                      3F4T0190
*                     PROCESS FIOB WRITE REQUEST                        3F4T0200
 WRITE NZT     INFLG               TEST FOR INITIAL WRITE REQUEST       3F4T0210
       TRA     FIRST                IF FIRST TIME, BYPASS TRANSMISSION  3F4T0220
       TSX     ..FTCK,4            CHECK PRIOR TRANSMISSION             3F4T0230
       LXD     .FRITE,4            GET WORD COUNT                       3F4T0240
       SXD     SEL,4                SET                                 3F4T0250
       CAL     SEL                  UP DATA FOR CURRENT                 3F4T0260
       SLW     ..FSEL+1             BUFFER                              3F4T0270
       TSX     ..FIOC,4            REQUEST OUTPUT RECORD VIA ..FIOC     3F4T0280
       NZT     FLAG                ALTERNATE                            3F4T0290
       TRA     ALT                  BUFFER                              3F4T0300
       TRA     STD                 ADDRESSES                            3F4T0310
 FIRST STL     INFLG               RESET FIRST TIME FLAG                3F4T0320
 STD   CLA     PRI                                                      3F4T0330
       STZ     FLAG                 *                                   3F4T0340
       TRA     STO                  *                                   3F4T0350
 ALT   CLA     SEC                  *                                   3F4T0360
       STL     FLAG                 *                                   3F4T0370
 STO   STO     SEL                  *                                   3F4T0380
       STA     .FBIBF              PLACE BUFFER ADDRESS IN FIOB         3F4T0390
       TRA     1,2                 RETURN TO FIOB                       3F4T0400
 FLAG  PZE     0,,0                                                     3F4T0410
 SEL   IORT    **,,**              CURRENT SELECTED BUFFER              3F4T0420
 PRI   IORT    ..FB1B,,SIZE        PRIMARY BUFFER                       3F4T0430
 SEC   IORT    ..FB2B,,SIZE        SECONDARY BUFFER                     3F4T0440
 INFLG PZE     0,,0                FIRST TIME FLAG                      3F4T0450
 BUF   PZE     0,,SIZE-1           BUFFER SIZE (LOGICAL)                3F4T0460
..FB2B BSS     SIZE                LOCATION OF SECONDARY BUFFER         3F4T0470
 LK.DR LDIR                                                             3F4T0480
       END                                                              3F4T0490
$IBMAP FBIN.   270                                                      3F4U0000
       TTL  ALTERNATE I/O BINARY CORDINATOR AND PRIMARY BINARY BUFFER   3F4U0010
       ENTRY   ..FBID                                                   3F4U0020
       ENTRY   ..FBIW                                                   3F4U0030
       ENTRY   ..FB1B                                                   3F4U0040
 SIZE  SET     256                 SETS PRIMARY BUFFER LENGTH = 256     3F4U0050
..FBID CAL     PON                 READ REQUEST                         3F4U0060
       TRA     *+2                                                      3F4U0070
..FBIW CAL     PTH                 WRITE REQUEST                        3F4U0080
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR          3F4U0090
       CALL    ..FIOS(SEL)         CALL FIOS. AND SETS                  3F4U0100
       ORG     *-1                  UP I/O .LXSEL REQUEST LINKAGE       3F4U0110
 SEL   IORT    ..FB1B,,SIZE        I/O COMMAND FORMAT                   3F4U0120
       LXA     LK.DR,4             RESET X4                             3F4U0130
       STZ     ..FB1B              SET FIRST TIME FLAG                  3F4U0140
       TRA     1,4                 EXIT TO FRDB. OR FWRB.               3F4U0150
 PON   PON     0,,0                  PREFIX INDICATES BINARY READ       3F4U0160
 PTH   PTH     0,,0                  PREFIX INDICATES BINARY WRITE      3F4U0170
..FB1B BSS     SIZE                PRIMARY BINARY BUFFER LOCATION       3F4U0180
 LK.DR LDIR                                                             3F4U0190
       END                                                              3F4U0200
$IBMAP FEFT.   15                                                       3F4V0000
       TTL  ALTERNATE FORTRAN I/O END FILE ROUTINE                      3F4V0010
       LBL     .EFT,BEGIN     FEFT.                                  (7)3F4V0013
*              CALLING SEQUENCE FOR -- END FILE N --                    3F4V0020
*                   CALL ..FEFT(ARG)                                    3F4V0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS          3F4V0040
*                                LOCATION OF LOGICAL UNIT N             3F4V0050
       ENTRY   ..FEFT                                                   3F4V0060
..FEFT SXA     LK.DR,4             SAVE RETURN                          3F4V0070
       CAL*    3,4                 GET CONTENTS OF .UNIT. CELL          3F4V0080
       STA     WEOF                SET UP IOEX COMMAND                  3F4V0090
       CALL    ..FCHK(NOTE,ACTION) CHECK VALIDITY OF REQUEST            3F4V0100
       ORG     *-2                                                      3F4V0110
 NOTE  BCI     1, EOF               MESSAGE                             3F4V0120
ACTION PZE     IGNORE,,7            ACTION, 7 = IN1,OU1, AND PP1 TESTED 3F4V0130
       TSX     .NDSEL,4            EOF                                  3F4V0140
 WEOF  PZE     **,,7                VIA                                 3F4V0150
       NOP                           IOEX                               3F4V0160
IGNORE LXA     LK.DR,4             RESTORE X4                           3F4V0170
       TRA     1,4                 RETURN                               3F4V0180
 LK.DR LDIR                                                             3F4V0190
       END                                                              3F4V0200
$IBMAP FBST.   47                                                    $5$3F4W0000
       TTL     ALTERNATE FORTRAN I/O  BACKSPACE ROUTINE             (14)3F4W0010
       LBL     .BST,BEGIN     FBST.                                  (7)3F4W0013
*              CALLING SEQUENCE FOR -- BACKSPACE N --                $5$3F4W0020
*                   CALL ..FBST(ARG)                                 $5$3F4W0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS       $5$3F4W0040
*                                LOCATION OF LOGICAL UNIT N          $5$3F4W0050
       ENTRY   ..FBST                                                $5$3F4W0060
..FBST SXA     SYSLOC,4            SAVE FORTRAN CALL IN SYSLOC       $5$3F4W0070
       SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR       $5$3F4W0080
       SXA     X2,2                SAVE X2                           $5$3F4W0090
       STI     LDI                 SAVE SENSE INDICATORS             $5$3F4W0100
       CAL*    3,4                 GET CONTENTS OF  .UNIT. CELL      $5$3F4W0110
       STA     WEOF                                                  $5$3F4W0112
       STA     BST                 SET UP IOEX REFERENCE             $5$3F4W0120
       CALL    ..FCHK(NOTE,ACTION) VERIFY                            $5$3F4W0130
       ORG     *-2                  LEGALITY OF                      $5$3F4W0140
 NOTE  BCI     1, BST                UNIT REQUESTED                  $5$3F4W0150
ACTION PZE     IGNORE,,2           ACTION   2 = OU1 TESTED ONLY      $5$3F4W0160
       LAC     BST,4               -(FCB)                           (13)3F4W0162
       LDI     1,4                 MOVE 2ND WORD OF FCB TO SENSE IND(13)3F4W0164
       SPACE                                                         $5$3F4W0170
       LNT     001                 TEST IF OUTPUT FILE              (13)3F4W0171
       TRA     BCKSP               IF NOT, NO EOF                   (13)3F4W0172
       TSX     .NDSEL,4                                              $5$3F4W0173
WEOF   PZE     **,,7                                                 $5$3F4W0174
       NOP                                                           $5$3F4W0175
       TSX     BSTR,2              BACKSPACE OVER EOF JUST WRITTEN  (10)3F4W0176
BCKSP  TSX     BSTR,2              BACKSPACE ONE RECORD             (10)3F4W0200
       RIL     770000              PON OR PZE IN AC. DEP.           (14)3F4W0210
       PIA                         ON PREV. ACTION                  (14)3F4W0211
       ALS     4                                                    (14)3F4W0215
       CALL    ..FIOS(ENT)          UP                               $5$3F4W0220
       ORG     *-1                   .LXSEL COMMAND                  $5$3F4W0230
ENT    IORT    TEST,,3             VIA FIOS.                        (10)3F4W0240
       STL     .LXMOD              INDICATE MODE SWITCHING TO .LXSL (10)3F4W0241
REPEAT TSX     ..FIOC,4           READ SINGLE RECORD IN BINARY       $5$3F4W0250
       TSX     BSTR,2              BACKSPACE SINGLE RECORD           $5$3F4W0260
*              CHECK TRANSMISSION VIA ..FBCK ENTRY                   $5$3F4W0270
*              RETURN TO 1,4 IF BINARY RECORD                        $5$3F4W0280
*              RETURN TO 2,4 IF EOF DETECTED                         $5$3F4W0281
*              RETURN TO 3,4 IF BCD RECORD                           $5$3F4W0282
*                  X2 AND IND ARE DESTROYED BY ..FBCK ENTRY          $5$3F4W0290
       TSX     ..FBCK,4            TRANSMISSION CHECK                $5$3F4W0300
       TRA     BINARY              NO ERROR FOUND, ASSUME BINARY     $5$3F4W0310
       TRA     EOF                 EOF DETECTED                      $5$3F4W0311
       SPACE                                                         $5$3F4W0320
*                FINISHED BACKSPACING                                $5$3F4W0330
DONE   NULL                                                          $5$3F4W0340
IGNORE LDI     LDI                 RESTORE SENSE INDICATORS          $5$3F4W0360
 X2    AXT     **,2                RESTORE X2                        $5$3F4W0370
       LXA     LK.DR,4             RESTORE X4                        $5$3F4W0380
       TRA     1,4                 RETURN                            $5$3F4W0390
       SPACE                                                         $5$3F4W0400
*                BINARY RECORD BACKSPACE LOOP                        $5$3F4W0410
BINARY LXA     TEST,2              TEST FOR                          $5$3F4W0420
       TNX     DONE,2,1             ADDITIONAL RECORDS               $5$3F4W0430
       SXA     TEST,2                TO BACKSPACE                    $5$3F4W0440
       TSX     BSTR,2              BACKSPACE ONE RECORD              $5$3F4W0450
       TRA     BINARY              TEST AGAIN                        $5$3F4W0460
       SPACE                                                         $5$3F4W0470
*                BACKSPACE SUB PROGRAM                               $5$3F4W0480
                                                                     $5$3F4W0490
 BSTR  TSX     .NDSEL,4            BACKSPACE RECORD                  $5$3F4W0500
 BST   PZE     **,,5                VIA                              $5$3F4W0510
       TRA     1,2                   IOEX                            $5$3F4W0520
       SPACE                                                         $5$3F4W0530
*              EOF BACKSPACE CONTROL                                 $5$3F4W0531
 EOF   TSX     BSTR,2              BACKSPACE OVER EOF MARK           $5$3F4W0532
       TRA     REPEAT                                                $5$3F4W0533
       SPACE                                                         $5$3F4W0534
*                REQUIRED CONSTANTS                                  $5$3F4W0540
TEST   BSS     3                   TRANSMISSION DATA CELLS          (10)3F4W0560
 LDI   PZE     0,,0                INDICATOR STORAGE                 $5$3F4W0570
 LK.DR LDIR                                                          $5$3F4W0600
       END                                                           $5$3F4W0610
$IBMAP FRWT.   21                                                       3F4X0000
       TTL     ALTERNATE FORTRAN I/O REWIND ROUTINE                 (13)3F4X0010
       LBL     .RWT,BEGIN     FRWT.                                  (7)3F4X0015
*              CALLING SEQUENCE FOR -- REWIND N --                      3F4X0020
*                   CALL ..FRWT(ARG)                                    3F4X0030
*                    WHERE ARG = LOCATION OF PZE UNITXX, XX IS          3F4X0040
*                                LOCATION OF LOGICAL UNIT N             3F4X0050
       ENTRY   ..FRWT                                                   3F4X0060
..FRWT SXA     LK.DR,4             SAVE RETURN                          3F4X0070
       CAL*    3,4                 GET CONTENTS OF .UNIT. CELL          3F4X0080
       STI     IND                 SAVE SENSE INDICATORS            (13)3F4X0081
       STA     WEOF                SET UP                               3F4X0100
       STA     RWD                  IOEX COMMANDS                       3F4X0110
       CALL    ..FCHK(NOTE,ACTION) CHECK VALIDITY OF REQUEST            3F4X0120
       ORG     *-2                                                      3F4X0130
 NOTE  BCI     1, RWT              MESSAGE                              3F4X0140
ACTION PZE     IGNORE,,7           ACTION, 7 = IN1,OU1,AND PP1 TESTED   3F4X0150
       LAC     RWD,4               -(FCB)                           (13)3F4X0160
       LDI     1,4                 MOVE 2ND WORD OF FCB TO SENSE IND(13)3F4X0170
       SSP                         SET AC POSITIVE                  (13)3F4X0172
       LFT     001                 TEST IF  OUTPUT, IF OUTPUT       (13)3F4X0173
       SSM                         SET AC NEGATIVE                  (13)3F4X0174
       RIL     001                 SET FILE TO INPUT                (13)3F4X0175
       STI     1,4                 STORE SENSE IND IN 2ND WORD FCB  (13)3F4X0176
       TPL     INPUT               NO EOF IF INPUT                  (13)3F4X0178
       TSX     .NDSEL,4            EOF                                  3F4X0180
 WEOF  PZE     **,,7                VIA                                 3F4X0190
       NOP                           IOEX                               3F4X0200
 INPUT TSX     .NDSEL,4            RWD VIA                              3F4X0210
 RWD   PZE     **,,3                 IOEX                               3F4X0220
IGNORE LXA     LK.DR,4             RESTORE X4                           3F4X0230
       LDI     IND                 RESTORE SENSE INDICATORS         (13)3F4X0235
       TRA     1,4                 RETURN                               3F4X0240
IND    PZE     0                                                    (13)3F4X0245
 LK.DR LDIR                                                             3F4X0250
       END                                                              3F4X0260
$IBMAP FVIO.   30                                                    $5$3F4Y0000
       TTL     ALTERNATE I/O VARIABLE UNIT SPECIFICATION            (13)3F4Y0010
       LBL     .VIO,BEGIN     FVIO.                                  (7)3F4Y0013
       ENTRY   ..FVIO                                                $5$3F4Y0020
..FVIO SXA     LK.DR,4             SAVE X4 IN LINKAGE DIRECTOR       $5$3F4Y0030
       CAL*    3,4                 GET LOGICAL UNIT NUMBER           $5$3F4Y0040
       TZE     ERROR                TEST                             $5$3F4Y0050
       ADM     TBLORG               FOR                              $5$3F4Y0060
       STA     ENT                  RANGE                            $5$3F4Y0070
       SUB     TBLEND               ERROR                            $5$3F4Y0080
       TPL     ERROR                *                                $5$3F4Y0090
 ENT   CLA*    **                  PLACE LOCATION OF FCB             $5$3F4Y0100
       STO*    4,4                  IN CALLING PARAMETER             $5$3F4Y0110
       TRA     1,4                 EXIT                              $5$3F4Y0120
       SPACE                                                         $5$3F4Y0130
ERROR  CLA*    3,4                 CONVERT LOGICAL UNIT NUMBER       $5$3F4Y0140
       TSX     .DECVA,4             AND LEAVE IN MQ                  $5$3F4Y0150
       STQ     E47MES+6                                              $5$3F4Y0160
       CALL    .FXEM.(CODE)                                          $5$3F4Y0170
       TRA     .LXERR              NO OPTIONAL EXIT                  $5$3F4Y0180
       SPACE                                                         $5$3F4Y0190
TBLORG PZE     *                   TABLE ORGIN - 1                   $5$3F4Y0200
       PZE     .UN01.               **                               $5$3F4Y0210
       PZE     .UN02.               * *                              $5$3F4Y0220
       PZE     .UN03.               *  *                             $5$3F4Y0230
       PZE     .UN04.               *   * UNIT REFERENCES            $5$3F4Y0240
       PZE     .UN05.               *  *                             $5$3F4Y0250
       PZE     ..UN06               * *                              $5$3F4Y0260
       PZE     .UN07.               **                               $5$3F4Y0270
       PZE     .UN08.               *                                $5$3F4Y0280
*                    ADDITIONAL UNITS GO BETWEEN  TBLORG AND TBLEND  $5$3F4Y0290
TBLEND PZE     *                   TABLE END + 1                     $5$3F4Y0300
       SPACE                                                         $5$3F4Y0310
 CODE  PZE     47                                                    $5$3F4Y0320
ER47MS PZE     E47MES,,7                                             $5$3F4Y0330
ER47OP PZE     NOOPXT,,7                                             $5$3F4Y0340
E47MES BCI     7,0LOGICAL UNIT NOT DEFINED FOR VALUE                 $5$3F4Y0350
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED            $5$3F4Y0360
 LK.DR LDIR                        LINKAGE DIRECTOR                  $5$3F4Y0370
       END                                                           $5$3F4Y0380
$IBMAP UNIT06  6                                                        3F4Z0000
       TTL  ALTERNATE I/O SPECIFICATION FOR LOGICAL UNIT 6              3F4Z0010
       LBL     UNT6,BEGIN     UNIT06                                 (7)3F4Z0013
       ENTRY   ..UN06                                                   3F4Z0020
..UN06 PZE     UNIT06                                                   3F4Z0030
UNIT06 FILE    ,OU,READY,OUTPUT,BLK=22,MULTIREEL,BCD,NOLIST             3F4Z0040
       END                                                           $5$3F4Z0050
$*  7090/7094 IBLIB ALTERNATE INPUT/OUTPUT FORTRAN LIBRARY- FRDU.    $5$3F5A0000
$IBMAP FRDU.                                                         $5$3F5A0005
       TTL     FRDU. - ALTERNATE I/O UNFORMATTED READ ROUTINE        (7)3F5A0010
       SPACE                                                         $5$3F5A0020
       LBL     .RDU,BEGIN     FRDU.                                  (7)3F5A0025
       REM     CALLING SEQUENCE IS                                   $5$3F5A0030
       REM        CALL ..FRDU(ARG,YYY)                               $5$3F5A0040
       REM     WHERE ARG = LOCATION OF PZE UNITXX                    $5$3F5A0050
       REM           XX = LOGICAL UNIT N                             $5$3F5A0060
       REM         YYYY = NAMELIST NAME                              $5$3F5A0070
       SPACE                                                         $5$3F5A0080
       ENTRY   ..FRDU                                                $5$3F5A0090
       SPACE                                                         $5$3F5A0110
..FRDU SXA     LNKG,4                SAVE RETURN TO MAIN PROGRAM.    $5$3F5A0120
       SXA     SYSLOC,4                                              $5$3F5A0130
       SXA     RTRN,4                                                $5$3F5A0140
       CLA*    4,4                   OBTAIN NAMELIST NAME.           $5$3F5A0150
       STO     .NAME.                                                $5$3F5A0160
       CLA     4,4                                                   $5$3F5A0170
       STA     .NMLST                OBTAIN LOCATION OF NAMELIST NAME$5$3F5A0180
       STZ     .INTAP         INITIALIZE                             (7)3F5A0181
       CLA*    3,4            AC = LOCATION OF FCB                   (7)3F5A0182
       PAX     0,4                                                   (7)3F5A0183
       TXI     *+1,4,2        IR4 = LOCATION OF 3RD WORD OF FCB      (7)3F5A0184
       SXA     *+1,4                                                 (7)3F5A0185
       LDI     **             IND. = 3RD WORD OF FCB                 (7)3F5A0186
       LFT     100000        IS THE INPUT UNIT SYSIN1/2              (7)3F5A0187
       STL     .INTAP         YES. SET FLAG TO INDICATE READING IN1  (7)3F5A0189
       CALL    ..FBCD                                                $5$3F5A0190
       CALL    .FIOU.(RTNUI,RTRN)    ENTER UNFORMATTED I/O SCAN.     $5$3F5A0200
       ORG     *-2                   OVERLAY CALL WITH ARGUMENTS.    $5$3F5A0210
RTNUI  NOP     RDUIO                 NOP = READ, RDUIO = LOC. OF CALL$5$3F5A0220
RTRN   PZE     **                    CONTAINS RETURN TO MAIN PROGRAM.$5$3F5A0230
       SPACE                                                         $5$3F5A0240
       REM                  PROCESS FIOU READ REQUEST                $5$3F5A0250
       SPACE                                                         $5$3F5A0260
RDUIO  SXA     RDRT,2                                                $5$3F5A0270
       TSX     ..FIOC,4       REQUEST SINGLE RECORD                  $5$3F5A0280
       TSX     ..FTCK,4              CHECK CURRENT READ TRANSMISSION.$5$3F5A0290
       AXT     ..FBCB,4       PLACE LOC. OF BUFFER                   $5$3F5A0291
       SXA     .FBDBF,4         FOR FIOU                             $5$3F5A0292
       AXC     ..FBCB,4                                              $5$3F5A0300
       SXD     *+2,4                                                 $5$3F5A0301
       LXA     .COMM,4                                               $5$3F5A0302
       TXI     *+1,4,**                                              $5$3F5A0303
       SXA     .CTUIO,4                                              $5$3F5A0304
RDRT   AXT     **,2                                                  $5$3F5A0310
       TRA     1,2                   RETURN TO .FIOU.                $5$3F5A0320
LNKG   LDIR                                                          $5$3F5A0340
       END                                                           $5$3F5A0350
$*  7090/7094 IBLIB ALTERNATE INPUT/OUTPUT FORTRAN LIBRARY- FWRU.    $5$3F5B0000
$IBMAP FWRU.                                                         $5$3F5B0005
       TTL     ALTERNATE I/O UNFORMATTED WRITE ROUTINE.              $5$3F5B0010
       LBL     .WRU,BEGIN     FWRU.                                  (7)3F5B0013
       SPACE                                                         $5$3F5B0015
       REM     UNFORMATTED WRITE ROUTINE                             $5$3F5B0020
       SPACE                                                         $5$3F5B0025
       REM     CALLING SEQUENCE IS                                   $5$3F5B0030
       REM        CALL ..FWRU(ARG,YYY)                               $5$3F5B0040
       REM     WHERE  ARG = LOCATION OF PZE UNITXX, WHERE XX         $5$3F5B0050
       REM                  IS LOCATION OF LOGICAL UNIT N            $5$3F5B0060
       REM            YYY = NAMELIST NAME                            $5$3F5B0070
       SPACE                                                         $5$3F5B0080
       ENTRY   ..FWRU                                                $5$3F5B0100
OUTBUF EQU     .OUTBF                                                $5$3F5B0110
       SPACE                                                         $5$3F5B0120
..FWRU SXA     SYSLOC,4                                              $5$3F5B0130
       SXA     LNKG,4                                                $5$3F5B0140
       SXA     WRSAV,4                                               $5$3F5B0150
       CALL    ..FBCW         WRITE ENTRY TO FBCD                    $5$3F5B0160
       CALL    .FWRO.(WRITE,WRSAV)                                   $5$3F5B0170
       ORG     *-2                                                   $5$3F5B0180
WRITE  TRA     WRTNU                                                 $5$3F5B0190
WRSAV  PZE     0,,0                                                  $5$3F5B0200
       SPACE                                                         $5$3F5B0210
       REM     PROCESS FIOH WRITE REQUEST.                           $5$3F5B0220
       SPACE                                                         $5$3F5B0225
WRTNU  SXA     SV4,4                 ENTRY FROM FWRO                 $5$3F5B0230
       TSX     ..FTCK,4              CHECK PRIOR WRITE.              $5$3F5B0240
       SXD     ..FSEL+1,2     SET WORD COUNT                         $5$3F5B0250
       AXT     0,4                                                   $5$3F5B0260
LOOP   CAL     .OUTBF,4                OUTPUT BUFFER.                $5$3F5B0270
       SLW     ..FBCB,4                                              $5$3F5B0280
       TXI     *+1,4,-1                                              $5$3F5B0290
       TIX     LOOP,2,1                                              $5$3F5B0300
       TSX     ..FIOC,4              OUTPUT SINGLE RECORD VIA ..FIOC $5$3F5B0310
SV4    AXT     **,4                                                  $5$3F5B0320
       TRA     1,4                                                   $5$3F5B0330
LNKG   LDIR                                                          $5$3F5B0340
       END                                                           $5$3F5B0350
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN01              3F5UN100
$IBMAP UN01    6                                                        3F5UN110
       TTL     UN01/FILE SPECIFICATIONS FOR LOGICAL UNIT 1              3F5UN120
       ENTRY   .UN01.                                                   3F5UN130
.UN01. PZE     UNIT01                                                   3F5UN140
UNIT01 FILE    ,UT1,READY,INOUT,BLK=256,BIN,NOLIST                      3F5UN150
       END                                                              3F5UN160
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN02              3F5UN200
$IBMAP UN02    6                                                        3F5UN210
       TTL     UN02/FILE SPECIFICATIONS FOR LOGICAL UNIT 2              3F5UN220
       ENTRY   .UN02.                                                   3F5UN230
.UN02. PZE     UNIT02                                                   3F5UN240
UNIT02 FILE    ,UT2,READY,INOUT,BLK=256,BIN,NOLIST                      3F5UN250
       END                                                              3F5UN260
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN03              3F5UN300
$IBMAP UN03    6                                                        3F5UN310
       TTL     UN03/FILE SPECIFICATIONS FOR LOGICAL UNIT 3              3F5UN320
       ENTRY   .UN03.                                                   3F5UN330
.UN03. PZE     UNIT03                                                   3F5UN340
UNIT03 FILE    ,UT3,READY,INOUT,BLK=256,BIN,NOLIST                      3F5UN350
       END                                                              3F5UN360
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN04              3F5UN400
$IBMAP UN04    6                                                        3F5UN410
       TTL     UN04/FILE SPECIFICATIONS FOR LOGICAL UNIT 4              3F5UN420
       ENTRY   .UN04.                                                   3F5UN430
.UN04. PZE     UNIT04                                                   3F5UN440
UNIT04 FILE    ,UT4,READY,INOUT,BLK=256,BIN,NOLIST                      3F5UN450
       END                                                              3F5UN460
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN05              3F5UN500
$IBMAP UN05    6                                                        3F5UN510
       TTL     UN05/FILE SPECIFICATIONS FOR LOGICAL UNIT 5              3F5UN520
       ENTRY   .UN05.                                                   3F5UN530
.UN05. PZE     UNIT05                                                   3F5UN540
UNIT05 FILE    ,IN,READY,INPUT,BLK=14,MULTIREEL,BCD,NOLIST              3F5UN550
       END                                                              3F5UN560
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN06              3F5UN600
$IBMAP UN06    6                                                        3F5UN610
       USE                                                              3F5UN611
       TTL     UN06 - FILE SPECIFICATIONS FOR LOGICAL UNIT 6         (8)3F5UN620
       ENTRY   .UN06.                                                   3F5UN630
       ENTRY   .BUFSZ                                                   3F5UN631
.UN06. PZE     UNIT06                                                   3F5UN640
UNIT06 FILE    ,OU,READY,OUTPUT,BLK=115,MULTIREEL,BCD,NOLIST         (8)3F5UN650
.BUFSZ PZE     BUFSIZ                                                   3F5UN651
BUFSIZ MAX     MINSIZ,LIMIT                                          (8)3F5UN652
       USE     A                                                        3F5UN653
       ORG     .TOUT.                                                   3F5UN654
       CALL    .FOUT.(.FILL.)                                           3F5UN655
       USE                                                              3F5UN656
CHLIMT EQU     133                 LOGICAL RECORD SIZE IN CHARACTERS (8)3F5UN660
LIMIT5 EQU     CHLIMT+5                                              (8)3F5UN670
LIMIT  EQU     LIMIT5/6            LOGICAL RECORD SIZE IN WORDS      (8)3F5UN680
MINSIZ EQU     22                  MINIMUM LOGICAL RECORD SIZE       (8)3F5UN690
       END                                                           (8)3F5UN691
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN07              3F5UN700
$IBMAP UN07    6                                                        3F5UN710
       TTL     UN07/FILE SPECIFICATIONS FOR LOGICAL UNIT 7              3F5UN720
       ENTRY   .UN07.                                                   3F5UN730
.UN07. PZE     UNIT07                                                   3F5UN740
UNIT07 FILE    ,PP,READY,OUTPUT,BLK=28,MULTIREEL,BIN,NOLIST             3F5UN750
       END                                                              3F5UN760
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - UN08              3F5UN800
$IBMAP UN08    6                                                        3F5UN810
       TTL     UN08/FILE SPECIFICATIONS FOR LOGICAL UNIT 8              3F5UN820
       ENTRY   .UN08.                                                   3F5UN830
.UN08. PZE     UNIT08                                                   3F5UN840
UNIT08 FILE    ,,MOUNT,INOUT,BLK=22,BCD                                 3F5UN850
       END                                                              3F5UN860
$*     7090/7094 IBLIB SYSTEM LIBRARY - FIOU                            3F600000
$IBMAP FIOU    1500,()OK                                                3F600010
       TTL     FIOU - UNFORMATTED INPUT/OUTPUT SCANNING ROUTINE     (11)3F600020
       REM     UNFORMATTED I/O SCANNING ROUTINE - BCD                   3F600040
       REM                                                              3F600050
       REM     CALLING SEQUENCE IS                                      3F600060
       REM     CALL  .FIOU.(ARG1,ARG2)                                  3F600070
       REM     ARG1 = LOCATION OF I/O CALLING SEQUENCE.                 3F600080
       REM     ARG2 = LOCATION OF RETURN TO MAIN PROGRAM.               3F600090
       REM                                                              3F600100
       ENTRY   .FIOU.                                                   3F600110
       ENTRY   .CTUIO                                                   3F600120
       ENTRY   .NMLST                                                   3F600130
       ENTRY   .NAME.                                                $5$3F600140
       ENTRY   .INTAP                                                (7)3F600141
       REM                                                              3F600150
CNVSW  EQU     .CNVSW                                                   3F600160
COUNT  EQU     .KOUNT                                                   3F600170
D1     EQU     .D1                                                      3F600180
D2     EQU     .D2                                                      3F600190
DBC10  EQU     .DBC10                                                   3F600200
DBC20  EQU     .DBC20                                                   3F600210
DBC    EQU     .DBC                                                     3F600220
DDBC   EQU     .DDBC                                                    3F600230
DDDFLG EQU     .DDDFL                                                   3F600240
DDFIX  EQU     .DDFIX                                                   3F600250
DDRST2 EQU     .DDRS2                                                   3F600260
DDSW   EQU     .DDSW                                                    3F600270
DEXPON EQU     .DEXPN                                                   3F600280
DIG    EQU     .DIG                                                     3F600290
FIXSW  EQU     .FIXSW                                                   3F600300
MQD    EQU     .MQD                                                     3F600310
WIDTH  EQU     .WIDTH                                                   3F600320
DECRS  MACRO                                                            3F600330
       TXI     *+1,1,-1      DECREASE CHARACTER COUNT BY ONE.           3F600340
       TXH     *+4,1,0         TEST IF THIS WORD WAS THE LAST OF THE    3F600350
       SXA     *+2,4         RECORD.  IF NOT, AND IF XR1 = 0, THE MQ IS 3F600360
       TSX     CTREC,4         RELOADED WITH A NEW WORD.                3F600370
       AXT     **,4                                                     3F600380
       ENDM    DECRS                                                    3F600390
.FIOU. SXA     LNKG,4                                                   3F600400
       SXA     SYSLOC,4                                                 3F600410
       SXA     SV1,1         SAVE XR1 AND XR2.                          3F600420
       SXA     SV2,2                                                    3F600430
       CLA     4,4           STORE LOCATION OF RETURN TO MAIN PROGRAM.  3F600440
       STA     LIST                                                     3F600450
       CLA     3,4           SET INPUT/OUTPUT SWITCHES,                 3F600460
       STA     RDREC                                                    3F600470
       STA     NXTREC+1                                             (11)3F600480
       AXT     5,4                                                      3F600490
       STZ     VFLAG,4                                                  3F600500
       TIX     *-1,4,1                                                  3F600510
       STZ     VFLAG                                                    3F600520
       STZ     DOLSW                                                    3F600530
       STZ     SWAST                                                    3F600540
       STZ     VARNAM                                                   3F600550
       STZ     LPARSW                                                   3F600560
       STZ     NUMSW                                                    3F600570
       STZ     SWCMA                                                    3F600580
       STZ     SWDIM                                                    3F600590
       STZ     SWEQ                                                     3F600600
       AXT     0,1                                                   $5$3F600610
       STD     .ENDFS    RESET SWITCH IN CONVERT ROUTINE             $5$3F600620
       AXT     0,2                                                   $5$3F600630
       CALL    .FCON.(ARG1,ARG2)                                     $5$3F600640
       ORG     *-2                                                   $5$3F600650
ARG1   PZE     0,,0                                                  $5$3F600660
ARG2   PZE     0,,0                                                  $5$3F600670
RDREC  TSX     **,2         *READ FIRST RECORD                          3F600680
       TXL     CONTI-1,4,13   IS NO. OF WORDS EQUAL TO 14            (7)3F600681
       TXH     CONTI-1,4,14                                          (7)3F600682
       NZT     .INTAP         YES. READING FROM SYSIN UNIT           (7)3F600683
       STZ     .INTAP         NO.  THERE IS NO PROBLEM               (7)3F600684
CONTI  STZ     EOR            YES. CONTINUE                          (7)3F600690
       STZ     DOLNAM                                                   3F600700
       AXT     0,2                                                      3F600710
       LDQ*    .FBDBF                                                   3F600720
       LGL     6             IGNORE COLUMN 1.                           3F600730
       ZAC                   IS THE CHARACTER IN COLUMN TWO A $ .       3F600740
       LGL     6               IF NOT, CONTINUE READING.                3F600750
       ERA     DOLSGN    IF IT IS, PROCEED TO SCAN FOR               $5$3F600760
       TNZ     RDREC      NAMELIST NAME.                             $5$3F600770
       AXT     4,1           INITIALIZE COUNTERS.                       3F600780
       AXT     6,4                                                      3F600790
NSCAN1 ZAC                   LEFT-ADJUST NAMELIST NAME.                 3F600800
       LGL     6                                                        3F600810
       DECRS                                                            3F600820
       LAS     BLANK                                                    3F600830
       TRA     *+2                                                      3F600840
       TRA     NSCAN4                                                   3F600850
       TXI     *+1,4,-1                                                 3F600860
       TXL     NSCAN3,4,0                                            $5$3F600870
       ORA     DOLNAM                                                   3F600880
       ALS     6                                                        3F600890
       SLW     DOLNAM                                                   3F600900
       TRA     NSCAN1                                                   3F600910
NSCAN3 ORA     DOLNAM                                                   3F600920
       TRA     NSCAN5                                                   3F600930
NSCAN4 STQ     MQD        INSERT BLANKS AT RIGHT IF NAME IS LESS        3F600940
       CAL     DOLNAM           THAN SIX CHARACTERS.                    3F600950
       LDQ     BLANKS                                                   3F600960
       TXL     *+4,4,0                                                  3F600970
       ARS     6                                                        3F600980
       LGL     6                                                        3F600990
       TIX     *-1,4,1                                                  3F601000
       LDQ     MQD                                                      3F601010
NSCAN5 SLW     DOLNAM        COMPARE DATA NAMELIST NAME  TO THAT        3F601020
       ERA     .NAME.       OF READ REQUEST                          $5$3F601030
       TNZ     RDREC     IF THEY ARE NOT SAME,CONTINUE READING       $5$3F601040
       AXT     6,4                                                      3F601050
       TRA     SCAN2                                                    3F601060
NXTREC STZ     EOR                                                      3F601070
       TSX     **,2         *READ ONE RECORD.                           3F601080
       AXT     0,2                                                      3F601090
       LDQ*    .FBDBF                                                   3F601100
       LGL     6             IGNORE COLUMN 1 OF NEW RECORD.             3F601110
       ZAC                                                              3F601120
       LGL     6                                                        3F601130
       ERA     DOLSGN                                                $5$3F601140
       TZE     DOLEXT    EXIT IF THIS IS LAST RECORD OF DATA GROUP   $5$3F601150
SCAN1  LDQ*    .FBDBF        BEGIN CHARACTER SCAN.                      3F601160
       AXT     5,1                                                      3F601170
       AXT     6,4           CHARACTER COUNT(NON-BLANK)                 3F601180
       LGL     6                                                        3F601190
SCAN2  ZAC                                                              3F601200
       LGL     6                                                        3F601210
       CAS     NINE          DIGIT.                                     3F601220
       TRA     *+3                                                      3F601230
       TRA     VARFL         YES.                                       3F601240
       TRA     VARFL         YES.                                       3F601250
       CAS     PLUS                                                     3F601260
       TRA     *+2                                                      3F601270
       TRA     VARFL         +                                          3F601280
       CAS     MINUS                                                    3F601290
       TRA     *+2                                                      3F601300
       TRA     VARFL         -                                          3F601310
       CAS     PER                                                      3F601320
       TRA     *+2                                                      3F601330
       TRA     LOGSW         .                                          3F601340
       DECRS                                                            3F601350
       CAS     BLANK         NO.                                        3F601360
       TRA     *+2                                                      3F601370
       TRA     SCBLK                                                    3F601380
       CAS     LPAR                                                     3F601390
       TRA     *+2                                                      3F601400
       TRA     VARC          (                                          3F601410
       NZT     NUMSW          IS A CONSTANT EXPECTED.               (11)3F601412
       TRA     *+3            NO. OK CONTINUE.                      (11)3F601414
       NZT     VARLOG         YES. SHOULD IT BE A LOGICAL CONSTANT  (11)3F601416
       TRA     ERR4           NO. ERROR....                         (11)3F601418
       CAS     DOLSGN    IS THIS THE END OF A RECORD                 $5$3F601420
       TRA     *+2        NO, CONTINUE                               $5$3F601430
       TRA     DOLLAR     YES, TRA DOLLAR                            $5$3F601440
       TXH     SCAN5,4,5 IF THIS IS ONLY CHAR,SCAN THE NEXT ONE      $5$3F601450
       CAS     EQSGN                                                    3F601460
       TRA     *+2                                                      3F601470
       TRA     EQ1                                                      3F601480
       CAS     COMMA                                                    3F601490
       TRA     *+2                                                      3F601500
       TRA     COMSGM                                                   3F601510
       TRA     SCAN5     GO SCAN THE NEXT CHARACTER                  $5$3F601520
DOLLAR STL     DOLSW     SET DOLLAR SIGN SWITCH                      $5$3F601530
       TXH     DOLEXT,4,5 EXIT IF THIS IS THE ONLY CHAR. SCANNED     $5$3F601540
       TRA     COMSGM                                                   3F601550
SCAN5  TXI     *+1,4,-1      ADJUST CHARACTER COUNT.                    3F601560
       TXL     EQ,4,0    HAVE SIX CHARACTERS BEEN SCANNED            $5$3F601570
SCAN6  NZT     EOR                                                      3F601580
       TRA     CHSAV         NO.                                        3F601590
       TXL     ERR5,4,4                                                 3F601600
       SLW     VARNAM        BUILD VARIABLE NAME.                       3F601610
       TRA     COMSGN                                                   3F601620
EQ     ZET     EOR                                                      3F601630
       TRA     ERR5                                                     3F601640
       ORA     VARNAM                                                   3F601650
       SLW     VARNAM                                                   3F601660
SCAN7  STO     PREVCH                                               (10)3F601665
       PXD     0,0                                                  (10)3F601670
       LGL     6                                                        3F601680
       DECRS                                                            3F601690
       CAS     EQSGN                                                    3F601700
       TRA     *+2                                                      3F601710
       TRA     EQ1           VARIABLE NAME FOLLOWED BY =. OBTAIN LITERAL3F601720
       CAS     LPAR                                                     3F601730
       TRA     *+2                                                      3F601740
       TRA     VARC          VARIABLE NAME FOLLOWED BY (. DIMENSION.    3F601750
       CAS     BLANK                                                    3F601760
       TRA     *+2           NEXT CHARACTER NOT = OR ( OR BLANK.    (10)3F601770
       ZET     EOR                                                      3F601780
       TRA     ERTST         ERROR.  FIND TYPE.                     (10)3F601790
       TRA     SCAN7                                                    3F601800
ERTST  CAS     DOLSGN                                               (10)3F601802
       TRA     *+2                                                  (10)3F601803
       TRA     ERR5                                                 (10)3F601804
       CAS     BLANK                                                (10)3F601807
       TRA     *+2                                                  (10)3F601808
       TRA     ERR5                                                 (10)3F601809
       CAS     COMMA                                                (10)3F60180E
       TRA     *+2                                                  (10)3F60180F
       TRA     ERR4                                                 (10)3F60180G
       CLA     PREVCH                                               (10)3F60180K
       CAS     BLANK                                                (10)3F60180L
       TRA     ERR6                                                 (10)3F60180M
       TRA     ERR4                                                 (10)3F60180N
       TRA     ERR6                                                 (10)3F60180P
EQN    LDQ     BLANKS                                                   3F601810
       TXL     *+4,4,0                                                  3F601820
       ARS     6                                                        3F601830
       LGL     6                                                        3F601840
       TIX     *-1,4,1                                                  3F601850
       TRA     EQM                                                      3F601860
SCBLK  NZT     EOR                                                      3F601870
       TRA     SCAN2                                                    3F601880
       TXL     ERR5,4,4                                                 3F601890
       TXH     NXTREC,4,5                                               3F601900
       TRA     COMSGM                                                   3F601910
       REM                                                              3F601920
EQ1    STL     SWEQ                                                     3F601930
       ZET     NUMSW                                                    3F601940
       TRA     ERR4                                                     3F601950
       STQ     MQD                                                      3F601960
       CAL     VARNAM                                                   3F601970
       TRA     EQN                                                      3F601980
EQM    SLW     VARNAM                                                   3F601990
       TSX     NMLST,4                                                  3F602000
FFFIN  TRA     NMOK                                                     3F602010
COMSGM CAL     VARNAM                                                   3F602020
       ARS     6                                                        3F602030
COMSGN NZT     VARLOG                                                   3F602040
       TRA     ERR12                                                    3F602050
       STZ     VARNAM                                                   3F602060
       LAS     T                                                        3F602070
       TRA     *+2                                                      3F602080
       TRA     LOGTFA                                                   3F602090
       LAS     F                                                        3F602100
       TRA     *+2                                                      3F602110
       TRA     LOGF                                                     3F602120
       TRA     ERR11                                                    3F602130
VARC   TXH     *+3,4,5                                                  3F602140
       STL     SWDIM                                                    3F602150
       TRA     EQ1+1                                                    3F602160
       NZT     VARCOM                                                   3F602170
       TRA     ERR12        *ERROR.  VARIABLE NOT DEFINED AS COMPLEX.   3F602180
       ZET     SWCMA                                                    3F602190
       TRA     ERR10                                                    3F602200
LPDIB  ZET     EOR                                                      3F602210
       TRA     ERR5                                                     3F602220
       ZAC                                                              3F602230
       LGL     6                                                        3F602240
       LAS     BLANK                                                    3F602250
       TRA     *+2                                                      3F602260
       TRA     LPBLK                                                    3F602270
       LGR     6                                                        3F602280
       STL     LPARSW                                                   3F602290
       STZ     NUMSW                                                    3F602300
       TRA     LITRAL                                                   3F602310
LPBLK  DECRS                                                            3F602320
       TRA     LPDIB                                                    3F602330
VARFL  TXL     SCAN8,4,5                                                3F602340
       NZT     VFLAG                                                    3F602350
       TRA     ERR9         *ERROR. LITERAL NOT PRECEDED BY VAR. NAME.  3F602360
VARTRA STZ     NUMSW                                                    3F602370
       LGR     6                                                        3F602380
       TRA     LITRAL                                                   3F602390
SCAN8  DECRS                                                            3F602400
       TRA     SCAN5                                                    3F602410
       SPACE   3                                                        3F602420
       REM     LOGSW - ROUTINE CHECK FOR .TRUE., OR .FALSE.,            3F602430
       SPACE   1                                                        3F602440
LOGSW  TXL     ERR13,4,5     IF THE POINT THE FIRST CHARACTER.  NO      3F602450
       NZT     VARLOG        YES, IS A LOGICAL CONSTANT EXPECTED9       3F602460
       TRA     VARFL         NO, GO TO SCAN LITERAL                     3F602470
       DECRS                                                            3F602480
LOGDIB TXI     *+1,4,-1                                                 3F602490
       TXH     LOGSCN,4,0                                               3F602500
       TRA     LOGTF                                                    3F602510
LOGSCN ZET     EOR                                                      3F602520
       TRA     ERR11                                                    3F602530
LOGSCC LGL     6                                                        3F602540
       DECRS                                                            3F602550
       TRA     LOGDIB                                                   3F602560
LOGTF  LAS     TRUE                                                     3F602570
       TRA     ERR11                                                    3F602580
       TRA     LOGT1                                                    3F602590
       LAS     FALSE                                                    3F602600
       TRA     ERR11                                                    3F602610
       ZET     EOR                                                   $5$3F602620
       TRA     ERR11                                                    3F602630
LGAA   ZAC                                                              3F602640
       LGL     6                                                        3F602650
       DECRS                                                            3F602660
       LAS     PER                                                      3F602670
       TRA     ERR11                                                    3F602680
       TRA     LOGF1                                                    3F602690
       TRA     ERR11                                                    3F602700
LOGTT  SXA     LOGTX,4                                                  3F602710
LOGTS  ZET     EOR                                                      3F602720
       TRA     LOGTX                                                    3F602730
LOGTI  ZAC                                                              3F602740
       LGL     6                                                        3F602750
       DECRS                                                            3F602760
       LAS     COMMA                                                    3F602770
       TRA     ERR11                                                    3F602780
       TRA     LOGTX                                                    3F602790
       LAS     BLANK                                                    3F602800
       TRA     ERR11                                                    3F602810
       TRA     LOGTS                                                    3F602820
       LAS     DOLSGN                                                   3F602830
       TRA     ERR11                                                    3F602840
       TRA     LOGDOL                                                   3F602850
       TRA     ERR11                                                    3F602860
LOGDOL STL     DOLSW                                                    3F602870
       TRA     LOGTX                                                    3F602880
LOGTX  AXT     **,4                                                     3F602890
       TRA     1,4                                                      3F602900
LOGT1  TSX     LOGTT,4                                                  3F602910
       TRA     LOGTFA                                                   3F602920
LOGF1  TSX     LOGTT,4                                                  3F602930
       TRA     LOGF                                                     3F602940
LOGTFA CLA     =1                                                       3F602950
       TRA     *+2                                                      3F602960
LOGF   CLA     =0                                                       3F602970
       STZ     NUMSW                                                    3F602980
       STQ     MQSV                                                     3F602990
       TRA     LITSTR                                               *** 3F603000
CTREC  SXA     CTRET,4       IS THIS THE END OF RECORD.                 3F603010
.CTUIO AXT     **,4                                                     3F603020
       TNX     ENDREC,4,1    YES.                                       3F603030
       SXA     *-2,4         NO. RESET COUNT AND RETURN.                3F603040
       AXT     6,1                                                      3F603050
       TXH     CTRET-1,4,1    TRANSFER IF THIS IS NOT THE LAST WORD  (7)3F603051
       ZET     .INTAP         IS THIS SYSIN1/2                       (7)3F603052
       AXT     2,1            YES. USE ONLY CHARS 79 AND 80          (7)3F603053
       TXI     *+1,2,-1                                                 3F603060
CTRET  AXT     **,4                                                     3F603070
       LDQ*    .FBDBF                                                   3F603080
       TRA     1,4                                                      3F603090
ENDREC STL     EOR                                                      3F603100
       TRA     CTRET                                                    3F603110
CHSAV  ORA     VARNAM                                                   3F603120
       ALS     6                                                        3F603130
       SLW     VARNAM                                                   3F603140
       TRA     SCAN2                                                    3F603150
       REM                                                              3F603160
NMLST  SXA     NMRET1,4                                                 3F603170
       STZ     VFLAG                                                    3F603180
.NMLST AXT     **,4          USE NAMELIST NAME TO LOCATE                3F603190
       TRA     NMPLUS                                                $5$3F603200
NMMIN  TXI     *+2,4,2                                                  3F603210
NMPLUS TXI     *+1,4,1                                                  3F603220
       SXA     *+1,4                                                    3F603230
       CLA     **                                                       3F603240
       TZE     ERR6                                                     3F603250
NM1    CAS     VARNAM        COMPARE AGAINST DATA VARIABLE NAME.        3F603260
       TRA     *+2                                                      3F603270
       TRA     NMRET                                                    3F603280
       TXI     *+1,4,1       IF NOT EQUAL, CONTINUE SEARCH.             3F603290
       SXA     *+1,4                                                    3F603300
       CLA     **                                                       3F603310
       TPL     NMPLUS                                                   3F603320
       TRA     *-4                                                   $5$3F603330
NMRET  TXI     *+1,4,1                                                  3F603340
       SXA     NMPRES,4                                                 3F603350
NMRET1 AXT     **,4                                                     3F603360
       SLW     FXNAM                                                    3F603370
       STZ     VARNAM                                                   3F603380
       TRA     1,4                                                      3F603390
NMPRES PZE     **            ADDRESS OF FLAG FOR VARIABLE NAME IN N LIST3F603400
       SPACE   2                                                        3F603410
       REM          NMOCK  -   INITIALIZES THE STORE ROUTINE AND GIVE   3F603420
       REM                     CONTROL TO THE PICK-UP DIMENSION ROUTINE 3F603430
       REM                     IF NEEDED                                3F603440
       SPACE   2                                                        3F603450
NMOK   LAC     NMPRES,4        XR4  HAS ADDRESS OF THE ARRAY            3F603460
       CLA     0,4             X                                        3F603470
       STA     STOPE           X INITIALIZES STORE ROUTINE              3F603480
       STA     VADDR                                                    3F603490
       PDX     ,4              XR4 HAS SIZE OF ARRAY                    3F603500
       ZET     SWDIM                                                    3F603510
       TXL     ERR7,4,0                                                 3F603520
       TXH     *+2,4,0                                               $5$3F603530
       TXI     *+1,4,1                                                  3F603540
       SXA     VSIZ,4          X                                        3F603550
       STT     VTYPE           PICK-UP VARIABLE TYPE                    3F603560
       STL     NUMSW                                                    3F603570
       STL     VFLAG                                                    3F603580
       AXT     5,4             RESET  FLAGS                             3F603590
       STZ     VFLAG,4                                                  3F603600
       TIX     *-1,4,1         X                                        3F603610
       CLA     VTYPE           SET NEW FLAG                             3F603620
       ALS     3              X                                         3F603630
       PDX     0,4            X                                         3F603640
       STL     VFLAG-1,4      X                                         3F603650
       NZT     VARDP     INITIALIZE ACCORDING TO TYPE OF VARIABLE    $5$3F603660
       ZET     VARCOM         X                                         3F603670
       TRA     NMIDPC         X                                         3F603680
       CAL     NOP            REPLACE  STQ  BY  NOP  IN STORE  ROUTINE. 3F603690
       STD     STOPE1                                                   3F603700
       STP     STOPE1                                                   3F603710
       LAC     VSIZ,4         INITIALIZE  TEST IN STORE.                3F603720
       SXD     STORSZ,4       X                                         3F603730
       AXC     1,4            INITIALIZE INCREMENT OF THE LOOP IN STORE.3F603740
       SXD     STO1O2,4                                                 3F603750
       TRA     NMJ                                                      3F603760
NMIDPC CAL     STQ                                                      3F603770
       STD     STOPE1         X                                         3F603780
       STP     STOPE1         X                                         3F603790
       CLA     VADDR          X                                         3F603800
       ADD     =1                                                       3F603810
       STA     STOPE1         X                                         3F603820
       CLA     VSIZ           X                                         3F603830
       ADD     VSIZ           X                                         3F603840
       PAC     ,4             X                                         3F603850
       SXD     STORSZ,4       X                                         3F603860
       AXC     2,4            X                                         3F603870
       SXD     STO1O2,4       X                                         3F603880
NMJ    ZET     SWDIM                                                    3F603890
       TRA     DIM            GO PICK-UP DIMENSIONS.                    3F603900
       LDQ     MQD                                                      3F603910
       AXT     0,4            NO LPAR  ON THE INPUT CARD - INITIALIZE   3F603920
       SXA     STOR1,4        STORE ROUTINE FOR THIS CASE.              3F603930
NMJR   ZET     DOLSW                                                    3F603940
       TRA     DOLEXT                                                   3F603950
       ZET     EOR                                                      3F603960
       TRA     NXTREC         X                                         3F603970
       AXT     6,4            X                                         3F603980
       TRA     SCAN2                                                    3F603990
DOLEXT NZT     SWAST                                                 $5$3F604000
       ZET     SWCMA                                                 $5$3F604010
       TRA     ERR5                                                     3F604020
       ZET     NUMSW                                                    3F604030
       TRA     ERR5                                                     3F604040
       TRA     SV1                                                      3F604050
       SPACE   2                     SUBSCRIPT                          3F604060
       REM          DIM  - PICKS-UP  SUBSCRIPT - A(I,J,K)               3F604070
       REM               -COMPUTES THE  VALEE  OF THE ADDEND            3F604080
       REM                     (I-1) +(J-1) D1 + (K-1) D1 D2 FOR        3F604090
       REM                 THE  STORE  ROUTINE                          3F604100
       SPACE   2                                                        3F604110
DIM    STZ     VDIM1          .RESET TO ZERO CELLS CONTAINING VALUE OF  3F604120
       STZ     VDIM2          DIMENSIONS OF THE ARRAY                   3F604130
       STZ     VDIM3          X                                         3F604140
       STZ     VDIM4                                                 $5$3F604150
       STZ     VDIM5                                                 $5$3F604160
       STZ     VDIM6                                                 $5$3F604170
       STZ     VDIM7                                                 $5$3F604180
       STZ     DIMADD                                                   3F604190
       LAC     NMPRES,4                                                 3F604200
       CLA     0,4            AC HAS  PZE  ADDR,TYPE,SIZE               3F604210
       REM                        OR  MZE  ADDR,TYPE,SIZE               3F604220
       LDQ     VSIZ                                                     3F604230
       TPL     DIMB           ONLY ONE DIMENSION.                       3F604240
       CLA     1,4            AC  HAS   PZE  DIM1,,DIM2  IF THREE DIM.  3F604250
       REM                    X    OR   PZE  DIM1,, 0    IF TWO   DIM.  3F604260
       STA     VDIM1          SAVE  D1                                  3F604270
       TPL     *+2                                                   $5$3F604280
       TRA     DIM45                                                 $5$3F604290
       PDX     ,4                                                       3F604300
       ZAC                                                              3F604310
       TXL     DIMA,4,0       X                                         3F604320
       SXA     VDIM2,4        THREE DIMENSIONS - SAVE D2                3F604330
       DVP     VDIM1                                                    3F604340
       DVP     VDIM2                                                    3F604350
       STQ     VDIM3          X                                         3F604360
       AXT     3,4                                                      3F604370
       TRA     DIMRST         GO,PICK UP SUBSCRIPTS.                    3F604380
DIM45  PDX     ,4                                                    $5$3F604390
       SXA     VDIM2,4                                               $5$3F604400
       LAC     NMPRES,4                                              $5$3F604410
       CLA     2,4                                                   $5$3F604420
       STA     VDIM3                                                 $5$3F604430
       TPL     *+2                                                   $5$3F604440
       TRA     DIM67                                                 $5$3F604450
       PDX     ,4                                                    $5$3F604460
       ZAC                                                           $5$3F604470
       TXL     DIM4,4,0                                              $5$3F604480
       SXA     VDIM4,4     FIVE DIMENSIONS - SAVE D4                 $5$3F604490
       DVP     VDIM1                                                 $5$3F604500
       DVP     VDIM2                                                 $5$3F604510
       DVP     VDIM3                                                 $5$3F604520
       DVP     VDIM4                                                 $5$3F604530
       STQ     VDIM5                                                 $5$3F604540
       AXT     5,4                                                   $5$3F604550
       TRA     DIMRST                                                $5$3F604560
DIM4   DVP     VDIM1       FOUR DIMENSIONS.                          $5$3F604570
       DVP     VDIM2                                                 $5$3F604580
       DVP     VDIM3                                                 $5$3F604590
       STQ     VDIM4                                                 $5$3F604600
       AXT     4,4                                                   $5$3F604610
       TRA     DIMRST                                                $5$3F604620
DIM67  PDX     ,4                                                    $5$3F604630
       SXA     VDIM4,4                                               $5$3F604640
       LAC     NMPRES,4                                              $5$3F604650
       CLA     3,4                                                   $5$3F604660
       STA     VDIM5                                                 $5$3F604670
       PDX     ,4                                                    $5$3F604680
       ZAC                                                           $5$3F604690
       TXL     DIM6,4,0                                              $5$3F604700
       SXA     VDIM6,4     SEVEN DIMENSIONS                          $5$3F604710
       DVP     VDIM1                                                 $5$3F604720
       DVP     VDIM2                                                 $5$3F604730
       DVP     VDIM3                                                 $5$3F604740
       DVP     VDIM4                                                 $5$3F604750
       DVP     VDIM5                                                 $5$3F604760
       DVP     VDIM6                                                 $5$3F604770
       STQ     VDIM7                                                 $5$3F604780
       AXT     7,4                                                   $5$3F604790
       TRA     DIMRST                                                $5$3F604800
DIM6   DVP     VDIM1       SIX DIMENSIONS                            $5$3F604810
       DVP     VDIM2                                                 $5$3F604820
       DVP     VDIM3                                                 $5$3F604830
       DVP     VDIM4                                                 $5$3F604840
       DVP     VDIM5                                                 $5$3F604850
       STQ     VDIM6                                                 $5$3F604860
       AXT     6,4                                                   $5$3F604870
       TRA     DIMRST                                                $5$3F604880
DIMA   DVP     VDIM1                                                    3F604890
       STQ     VDIM2          X                                         3F604900
       AXT     2,4                                                      3F604910
       TRA     DIMRST                                                   3F604920
DIMB   STQ     VDIM1                                                    3F604930
       AXT     1,4                                                      3F604940
       SPACE   2                                                        3F604950
       REM           PICK-UP  SUBSCRIPTS.                               3F604960
       SPACE   2                                                        3F604970
DIMRST SXD     DIM222,4                                                 3F604980
       LDQ     MQD                                                      3F604990
       AXT     0,4            XR4 WILL HAVE NUMBER OF SUBSCRIPTS.       3F605000
DIMSC1 STZ     DTEMP          RESTORE TEMPORARY CELL FOR SUBSCRIT.      3F605010
DIMSCN ZAC                                                              3F605020
       LGL     6                                                        3F605030
       DECRS                  ADJUST XR1.                               3F605040
       CAS     NINE                                                     3F605050
       TRA     *+3                                                      3F605060
       TRA     DHOLD          CONVERT SUBSCRIPT.                        3F605070
       TRA     DHOLD                                                    3F605080
       LAS     BLANK                                                    3F605090
       TRA     *+2                                                      3F605100
       TRA     DBLK           IGNORE BLANK.                             3F605110
       LAS     COMMA                                                    3F605120
       TRA     *+2                                                      3F605130
       TRA     DIMCOM         ,                                         3F605140
       LAS     RPAR                                                     3F605150
       TRA     ERR14         PUNCTUATION ERROR                          3F605160
       TRA     DIMPAR                                                   3F605170
       TRA     ERR14                                                    3F605180
DIMDIG PZE     0                                                        3F605190
DHOLD  STO     DIMDIG         CONVERT THIS DIGIT AND SAVE IT.           3F605200
       CLA     DTEMP          X                                         3F605210
       ALS     2              X                                         3F605220
       ADD     DTEMP          X                                         3F605230
       ALS     1              X                                         3F605240
       ADD     DIMDIG         X                                         3F605250
       STO     DTEMP          X                                         3F605260
DIMTST ZET     EOR            END OF RECOR.                             3F605270
       TRA     ERR14                                                    3F605280
       TRA     DIMSCN         GO ON SCAN.                               3F605290
       REM                                                              3F605300
DBLK   TRA     DIMTST                                                   3F605310
       REM                                                              3F605320
DIMCOM TXI     *+1,4,1        INCREASE COUNTER OF SUBSCRIPT.            3F605330
DIM222 TXH     ERR7,4,** TEST FOR TOO MANY SUBSCRIPTS                $5$3F605340
       ZET     DTEMP                                                    3F605350
       TRA     DIMSUB                                                   3F605360
       TRA     ERR14         PUNCTUATION ERROR OR ZERO SUBSCRIPT        3F605370
VDIM7  PZE     **                                                    $5$3F605380
VDIM6  PZE     **                                                    $5$3F605390
VDIM5  PZE     **                                                    $5$3F605400
VDIM4  PZE     **                                                    $5$3F605410
       SPACE   2                                                        3F605420
VDIM3  PZE     **                                                       3F605430
VDIM2  PZE     **                                                       3F605440
VDIM1  PZE     **                                                       3F605450
VDIM   NULL                                                             3F605460
       SPACE   2                                                        3F605470
       REM                                                              3F605480
DIMLPR PZE     **                                                       3F605490
STO    STO     **                                                       3F605500
       REM                                                              3F605510
DIMPAR STL     DIMLPR                                                   3F605520
       TRA     DIMCOM         LEFT PARENT                               3F605530
       REM                                                              3F605540
DIM1TT ZET     DIMLPR                                                   3F605550
       TRA     DIMPPR         TRANSFER ON  )                            3F605560
       ZET     EOR            TRANSFER ON  ,                            3F605570
       TRA     ERR14                                                    3F605580
       TRA     DIMSC1                                                   3F605590
DIMADD PZE     0                                                        3F605600
       REM                                                              3F605610
       REM                                                              3F605620
DIMSUB SXA     DIMSUX,4                                                 3F605630
DIM2   CLA     DTEMP                                                    3F605640
       CAS     VDIM,4                                                   3F605650
       TRA     ERR7          SUBSCRIPT TOO LARGE                        3F605660
       TRA     *+1                                                      3F605670
       SUB     =1                                                       3F605680
       TXL     DIMOUT,4,1                                               3F605690
       STQ     MQD            SAVE INPUT WORD                           3F605700
       XCA                                                              3F605710
DIMDEC TXI     *+1,4,-1                                                 3F605720
       MPY     VDIM,4                                                   3F605730
       TXL     DIMOU1,4,1                                               3F605740
       TRA     DIMDEC                                                   3F605750
DIMOU1 XCA                                                              3F605760
       LDQ     MQD            RESTORE INPUT WORD                        3F605770
DIMOUT ADD     DIMADD                                                   3F605780
       STO     DIMADD         ADDEND HAS  (I-1)+(J-1)D1+(K-1)D1D2       3F605790
DIMSUX AXT     **,4                                                     3F605800
       TRA     DIM1TT                                                   3F605810
       REM                                                              3F605820
       REM         DIMPPR - TESTS FOR = AFTER  )                        3F605830
       REM                                                              3F605840
DIMPPR STZ     DIMLPR                                                   3F605850
       STZ     SWDIM                                                    3F605860
       ZET     EOR                                                      3F605870
       TRA     ERR14                                                    3F605880
       CLA     DIMADD                                                   3F605890
       ZET     VARCOM                                                   3F605900
       TRA     *+3                                                      3F605910
       NZT     VARDP                                                    3F605920
       TRA     DIM124                                                   3F605930
       ADD     DIMADD                                                   3F605940
DIM124 PAC     ,4                                                       3F605950
       SXA     STOR1,4                                                  3F605960
DIM333 ZAC                                                              3F605970
       LGL     6                                                        3F605980
       DECRS                                                            3F605990
       LAS     EQSGN                                                    3F606000
       TRA     *+2                                                      3F606010
       TRA     NMJR           = OK                                      3F606020
       LAS     BLANK                                                    3F606030
       TRA     ERR14                                                    3F606040
       ZET     EOR                                                   $5$3F606050
       TRA     ERR14                                                    3F606060
       TRA     DIM333                                                   3F606070
       SPACE   3                                                        3F606080
       REM        LITSTR   - STORE  ROUTINE  -  STORES CONVERTED        3F606090
       REM                    LITTERAL IN PROPER LOCATION.              3F606100
       SPACE   3                                                        3F606110
LITSTR NZT     VARCOM                                                   3F606120
       TRA     STOR           NO,                                       3F606130
STOCP  DLD     SAUV           YES,LOAD AC AND MQ.                       3F606140
STOR   SXA     STOX,1         SAVE XR1.                                 3F606150
       AXT     1,4                                                      3F606160
STOR1  AXT     **,1                                                     3F606170
       TXL     *+2,1,0                                                  3F606180
STORSZ TXL     ERR8,1,**      DECREMENT HAS TRUE SIZE OF THE ARRAY.     3F606190
STOPE  STO     **,1           ADDRESS FIELD =ADDRESS OF FIRST ELEMENT.  3F606200
STOPE1 NOP     **,1           NOP IS STQ FOR DOUBLE WORD.               3F606210
STO1O2 TXI     *+1,1,**       DECREMENT IS 1 FOR SINGLE WORD STORAGE    3F606220
       REM                       -      -  2  -  DOUBLE  -      -       3F606230
       SXA     STOR1,1                                                  3F606240
       LXD     STODEC,1  PICK UP REPEAT COUNT                        $5$3F606250
       TXH     STOAST,1,0 IF REPEAT IS NEEDED, TRA STOAST            $5$3F606260
STOX   AXT     **,1           RESET XR1.                                3F606270
       LDQ     MQSV                                                     3F606280
       TRA     NMJR           GO BACK TO MAIN SCAN.                     3F606290
STOAST TXI     *+1,4,1                                                  3F606300
STODEC TXL     STOR1,4,**                                               3F606310
       ZSD     STODEC    RESET REPEAT COUNT                          $5$3F606320
       TRA     STOX                                                     3F606330
STQ    STQ     **                                                       3F606340
       REM                   LITERAL SCANNING ROUTINE.                  3F606350
       REM     LITERAL SCAN -SET POINTERS FOR FCNV,                     3F606360
       REM                  -SCAN LITERAL FOR WIDTH AND TYPE,           3F606370
       REM                  -LINK TO PSUEDO-LIST TO CONVERT AND STORE   3F606380
       REM                  -RETURN TO MAIN SCAN FOR NEXT LITERAL OR    3F606390
       REM                   VARIABLE NAME.                             3F606400
LITRAL STQ     MQD                                                      3F606410
       TXI     *+1,1,1                                                  3F606420
       SXA     .FDX1,1      SET POINTERS AT 1ST DIGIT                   3F606430
       TXI     *+1,1,-1                                                 3F606440
       SXA     .FDX2,2      FOR FCNV                                    3F606450
       STZ     SWDCP                                                    3F606460
       STZ     SWREIN                                                   3F606470
       STZ     LCHK                                                     3F606480
       STZ     REALSW                                                   3F606490
       STZ     DPSW                                                     3F606500
       STZ     DIG                                                      3F606510
       AXT     0,4                   WIDTH COUNTER                      3F606520
SCAN11 ZET     EOR                                                      3F606530
       TRA     LCOM                  TREAT END OF RECORD AS COMMA       3F606540
       PXD     0,0                                                      3F606550
       LGL     6                                                        3F606560
       DECRS                         RELOAD MQ IF EMPTY,IF EOR SETSWITCH3F606570
       CAS     NINE                                                     3F606580
       TRA     CONT                                                     3F606590
       TXI     *+2,4,1               BUMP                               3F606600
       TXI     *+1,4,1               WIDTH COUNTER                      3F606610
CKBLK  ZET     LCHK                                                     3F606620
       TRA     ERR3                                                     3F606630
       TRA     SCAN11                                                   3F606640
CONT   CAS     BLANK                                                    3F606650
       TRA     *+2                                                      3F606660
       TRA     LBLNK                 SEE IF BLANK IS LEGAL              3F606670
       CAS     COMMA                                                    3F606680
       TRA     *+2                                                      3F606690
       TRA     LCOM                  END OF LITERAL-CONVERT IT          3F606700
       CAS     PLUS                                                     3F606710
       TRA     *+2                                                      3F606720
       TXI     CKBLK,4,1             ADD TO WIDTH                       3F606730
       CAS     MINUS                                                    3F606740
       TRA     *+2                                                      3F606750
       TXI     CKBLK,4,1             ADD TO WIDTH                       3F606760
       CAS     ASTRSK                                                   3F606770
       TRA     *+2                                                      3F606780
       TRA     LASTR                 SET COUNTER WITH NUMBER BEFORE *   3F606790
       CAS     PER                                                      3F606800
       TRA     *+2                                                      3F606810
       TRA     LPER                  CHECK FOR LEGALITY OF .            3F606820
       CAS     RPAR                                                     3F606830
       TRA     *+2                                                      3F606840
       TRA     LRPAR                 CHECK FOR LEGALITY OF )            3F606850
       CAS     E                                                        3F606860
       TRA     *+2                                                      3F606870
       TRA     EREAL                 REAL NUMBER FOUND                  3F606880
       CAS     D                                                        3F606890
       TRA     *+2                                                      3F606900
       TRA     LD                    DOUBLE PRECISION NUMBER FOUND      3F606910
       CAS     DOLSGN                                                   3F606920
       TRA     *+2                                                      3F606930
       TRA     LDOL                                                     3F606940
       ZET     EOR                                                      3F606950
       TRA     NMJR                  END OF RECORD- RETURN TO MAIN SCAN 3F606960
       TRA     ERR13                                                    3F606970
LBLNK  STL     LCHK                  SET BLANK SWITCH                   3F606980
       TRA     SCAN11                                                   3F606990
LDOL   STL     DOLSW                                                    3F607000
       TRA     LCOM                                                     3F607010
       REM     HERE ON COMMA                                            3F607020
LCOM   TXL     ERR14,4,0             NO LITERAL TO CONVERT-ERROR        3F607030
       NZT     LPARSW                                                   3F607040
       TRA     *+4                                                      3F607050
       ZET     SWCMA                                                    3F607060
       TRA     ERR14                                                    3F607070
       STL     SWCMA                 TURN ON COMMA SWITCH               3F607080
       SXA     WIDTH,4               SET WIDTH COUNT IN FCNV            3F607090
       ZET     VARCOM                                                   3F607100
       TRA     COMPLX                COMPLEX NUMBER EXPECTED            3F607110
       ZET     REALSW                                                   3F607120
       TRA     REAL                  REAL NUMBER FOUND                  3F607130
       ZET     DPSW                                                     3F607140
       TRA     DOUBL                 DOUBLE PRECISION NUMBER FOUND      3F607150
       ZET     VAREAL                                                   3F607160
       TRA     INRL                                                     3F607170
       NZT     VARINT                MUST BE INTEGER-CONVERT AS SUCH    3F607180
       TRA     DPTS                                                     3F607190
       ZET     SWREIN                                                   3F607200
       TRA     INRL                                                     3F607210
       TRA     RLICNV                CONVERT INTEGER                    3F607220
DPTS   NZT     VARDP                                                    3F607230
       TRA     ERR12                                                    3F607240
       TRA     DOUBL                                                    3F607250
       REM     PROCESS REAL NUMBER                                      3F607260
REAL   ZET     VAREAL                                                   3F607270
       TRA     INRL                  REAL EXPECTED-OK                   3F607280
       ZET     VARDP                                                    3F607290
       TRA     DOUBL                                                    3F607300
INRL   CLA     NOP                   INITIALIZE FOR REAL CONVERSION     3F607310
       STD     FIXSW                                                    3F607320
       STZ     .FEXP                                                    3F607330
       AXT     DBC,4                                                    3F607340
       SXA     CNVSW,4                                                  3F607350
       AXT     2,4                                                      3F607360
       SXA     COUNT,4                                                  3F607370
       STQ     MQSV                  SAVE MQ FOR AMIN SCAN              3F607380
       TSX     .FCNV.,4              CONVERT DATA                       3F607390
       AXT     EXPON,4                                                  3F607400
       SXA     DBC10,4                                                  3F607410
       NZT     VARCOM                WAS COMPLEX NUMBER EXPECTED        3F607420
       TRA     REINTS                NO-GO SAVE WHAT YOU HAVE           3F607430
       NZT     SWCMA                                                    3F607440
       TRA     STOIM                 GO STORE IMAGINARY PART OF COMPLEX 3F607450
       STO     SAUV                  LEFT PAREN-STORE REAL PORTION      3F607460
       LDQ     MQSV                                                     3F607470
       TRA     NMJR                                                     3F607480
       REM     SAVE IMAGINARY NUMBER-SCAN FOR COMMA AND RETURN TO MAIN  3F607490
STOIM  STO     SAUV+1                SAVE IMAGINARY NUMBER        SCAN  3F607500
       TRA     LITSTR                                                   3F607510
       REM     COME HERE TO PROCESS RIGHT PAREN,TREAT AS COMMA          3F607520
LRPAR  ZET     VARCOM                                                $5$3F607530
       NZT     LPARSW                                                   3F607540
       TRA     ERR14                 ANOTHER ONE                        3F607550
       STZ     LPARSW                RESET LEFT PAREN SWITCH            3F607560
       NZT     SWCMA                                                    3F607570
       TRA     ERR14                 STILL ANOTHER                      3F607580
       STZ     SWCMA                 KILL COMMA SWITCH                  3F607590
       SXA     WIDTH,4                                                  3F607600
       TSX     LOGTT,4                                                  3F607610
       TRA     REAL                  OK-PROCESS ASREAL NUMBER           3F607620
REINTS NZT     SWREIN                                                   3F607630
       TRA     LITSTR                                                   3F607640
       REM     RECONVERT TO INTEGER AND STORE                           3F607650
       UFA     =182B8                                                   3F607660
       RQL     8                                                        3F607670
       LRS     8                                                        3F607680
       XCA                                                              3F607690
       TRA     LITSTR                                                   3F607700
COMPLX NZT     SWDCP                                                 (7)3F607720
       TRA     ERR14                                                    3F607740
       NZT     LPARSW    IS THE LITERAL PRECEDED BY A LEFT PAREN.    $5$3F607750
       TRA     ERR10     NO, PUNCTUATION ERROR                       $5$3F607760
       TRA     REAL                                                     3F607770
       REM     CONVERT FACTOR AND STORE IN COUNTER                      3F607780
LASTR  NZT     LPARSW                                                $5$3F607790
       ZET     SWCMA                                                    3F607800
       TRA     ERR14                                                    3F607810
       NZT     REALSW                                                $5$3F607820
       ZET     SWAST                                                    3F607830
       TRA     ERR14                                                    3F607840
       STL     SWAST                                                    3F607850
       TXL     ERR14,4,0                                                3F607860
       SXA     WIDTH,4                                                  3F607870
       REM     CONVERT TO INTEGER                                       3F607880
       NZT     DPSW                                                  $5$3F607890
       ZET     REALSW                                                   3F607900
       TRA     ERR14                                                    3F607910
       ZET     SWDCP                                                    3F607920
       TRA     ERR14                                                    3F607930
RLICNV CLA     TRA                                                      3F607940
       STD     FIXSW                                                    3F607950
       AXT     DBC,4                                                    3F607960
       SXA     CNVSW,4                                                  3F607970
       AXT     2,4                                                      3F607980
       SXA     COUNT,4                                                  3F607990
       STQ     MQSV                                                     3F608000
       TSX     .FCNV.,4                                                 3F608010
       NZT     SWAST                                                    3F608020
       TRA     LITSTR                                                   3F608030
       ALS     18                                                       3F608040
       STD     STODEC                IF *,SAVE INTEGER AS COUNTER       3F608050
       STL     NUMSW                 SET SWITCH TO CATCH VARIABLE NAME  3F608060
       LDQ     MQSV                  TURNING UP AT THIS POINT           3F608070
       STZ     SWAST               RESET ASTERISK SWITCH             $5$3F608080
       TRA     NMJR                  RETURN TO MAIN SCAN                3F608090
       REM     PROCESS DECIMAL POINT-CHECK FOR MISPLACEMENT             3F608100
LPER   ZET     VARINT                                                   3F608110
       STL     SWREIN                RECONVERT TO INTEGER               3F608120
       ZET     SWDCP                                                    3F608130
       TRA     ERR14                 IF TWO ., ERROR                    3F608140
       STL     SWDCP                                                    3F608150
       TXI     CKBLK,4,1             COUNT . IN WIDTH AND CONTINUE      3F608160
       REM     PROCESS REAL NUMBER INDICATOR                            3F608170
 EREAL NZT     REALSW                                                $5$3F608180
       ZET     DPSW                                                     3F608190
       TRA     ERR14                 CANNOT BE DOUBLE PRECISION TOO     3F608200
       STL     REALSW                                                $5$3F608210
       ZET     VARINT                                                   3F608220
       STL     SWREIN                RECONVERT TO INTEGER               3F608230
       TXI     BLKCK,4,1             COUNT E IN WIDTH                   3F608240
       REM     PROCESS DOUBLE PRECISION INDICATOR                       3F608250
LD     NZT     DPSW                                                  $5$3F608260
       ZET     REALSW                                                   3F608270
       TRA     ERR14                 REDUNDANT QUALIFIER                3F608280
       STL     DPSW                                                  $5$3F608290
       ZET     VARINT                                                   3F608300
       STL     SWREIN                                                   3F608310
       NZT     VARCOM                                                $5$3F608320
       ZET     LPARSW                                                   3F608330
       TRA     ERR1          *MIXED MODES NOT ALLOWED                (7)3F608340
       ZET     SWCMA                                                    3F608350
       TRA     ERR14                 PUNCTUATION ERROR                  3F608360
       TXI     BLKCK,4,1             ADD D IN WIDTH                     3F608370
       REM     CHECK FOR BLANK FOLLOWING E OR D                         3F608380
BLKCK  PXD     0,0                                                      3F608390
       LGL     6                                                        3F608400
       CAS     BLANK                                                    3F608410
       TRA     *+2                                                      3F608420
       TRA     LBK                                                      3F608430
       LGR     6                                                        3F608440
       TRA     CKBLK                                                    3F608450
LBK    DECRS                                                            3F608460
       TXI     CKBLK,4,1                                                3F608470
       REM     CONVERT DOUBLE PRECISION NUMBER                          3F608480
DOUBL  NZT     VARDP                                                    3F608490
       TRA     VRREL                                                    3F608500
       STL     DDDFLG                                                   3F608510
       STZ     .FEXP                                                    3F608520
       LXA     DBC20,4                                                  3F608530
       SXA     D1,4                                                     3F608540
       AXT     DDBC,4                                                   3F608550
       SXA     DBC20,4                                                  3F608560
       LXA     DDSW,4                                                   3F608570
       SXA     D2,4                                                     3F608580
       AXT     DDFIX,4                                                  3F608590
       SXA     DDSW,4                                                   3F608600
       AXT     EXPON,4                                                  3F608610
       NZT     REALSW                                                   3F608620
       AXT     DEXPON,4                                                 3F608630
       SXA     DBC10,4                                                  3F608640
       CLA     NOP                                                      3F608650
       STD     FIXSW                                                    3F608660
       AXT     DBC,4                                                    3F608670
       SXA     CNVSW,4                                                  3F608680
       AXT     2,4                                                      3F608690
       SXA     COUNT,4                                                  3F608700
       STQ     MQSV                                                     3F608710
       TSX     .FCNV.,4                                                 3F608720
       SXA     *+2,2                                                    3F608730
       TSX     DDRST2,2                                                 3F608740
       AXT     **,2                                                     3F608750
       ZET     SWREIN                                                   3F608760
       TRA     REINTS+2              RECONVERT TO INTEGER               3F608770
       TRA     LITSTR                                                   3F608780
SV1    AXT     **,1          RESTORE INDEX REGISTERS.                   3F608790
SV2    AXT     **,2                                                     3F608800
LIST   AXT     **,4         *EXIT TO MAIN PROGRAM.                      3F608810
       TRA     1,4                                                      3F608820
VRREL  AXT     DEXPON,4                                                 3F608830
       SXA     DBC10,4                                                  3F608840
       TRA     INRL                                                     3F608850
       REM                                                              3F608860
ASTRSK OCT     54                                                       3F608870
BLANK  OCT     60                                                       3F608880
BLANKS BCI     1,                                                       3F608890
COMMA  OCT     73                                                       3F608900
D      OCT     24                                                       3F608910
DOLNAM PZE     **                                                       3F608920
DOLSGN OCT     53                                                       3F608930
DTEMP  PZE     **                                                       3F608940
E      OCT     25                                                       3F608950
EQSGN  BCI     1,00000=                                                 3F608960
F      BCI     1,00000F                                                 3F608970
FALSE  BCI     1,.FALSE                                                 3F608980
FXNAM  PZE     **                                                       3F608990
INT    PZE                                                              3F609000
LPAR   OCT     74                                                       3F609010
MINUS  OCT     40                                                       3F609020
NINE   OCT     11                                                       3F609030
PER    BCI     1,00000.                                                 3F609040
PREVCH BSS     1                                                    (10)3F609045
PLUS   OCT     20                                                       3F609050
RPAR   BCI     1,00000)                                                 3F609060
EXPON  BCI     1,00000E                                                 3F609070
T      BCI     1,00000T                                                 3F609080
TRUE   BCI     1,.TRUE.                                                 3F609090
TRA    TRA     0                                                        3F609100
NOP    NOP     0                                                        3F609110
       REM                                                              3F609120
       REM                                                              3F609130
EOR    PZE                                                              3F609140
DOLSW  PZE     **                                                       3F609150
DPSW   PZE                                                              3F609160
LPARSW PZE                                                              3F609170
NUMSW  PZE                                                              3F609180
REALSW PZE                                                              3F609190
SWAST  PZE                                                              3F609200
SWCMA  PZE     **                                                       3F609210
SWDCP  PZE                                                              3F609220
SWDIM  PZE                                                              3F609230
SWEQ   PZE                                                              3F609240
SWREIN PZE                                                              3F609250
MQSV   PZE     **                                                       3F609260
       REM                                                              3F609270
       REM                                                              3F609280
VADDR  PZE     **                                                       3F609290
VARNAM PZE     0                                                        3F609300
VMAX   PZE     **                                                       3F609310
VSIZ   PZE     ,,**                                                     3F609320
VTEMP  PZE     **                                                       3F609330
VTYPE  PZE     ,**                                                      3F609340
       REM                                                              3F609350
       REM                                                              3F609360
VARCOM                       COMPLEX            INDICATOR  4            3F609370
VARDP                        DOUBLE PRECISION   - -        3            3F609380
VARLOG                       LOGICAL            - -        2            3F609390
VAREAL                       REAL NUMBER        - -        1            3F609400
VARINT                       INTEGER            - -        0            3F609410
VFLAG  PZE     0             ZERO IF NO VARIABLE INDICATOR IS ON.       3F609420
.NAME. PZE     0,,0                                                  $5$3F609430
.INTAP BSS     1                                                     (7)3F609431
       REM                                                              3F609440
       EVEN                                                             3F609450
SAUV   BSS     2                                                        3F609460
LCHK   PZE                                                              3F609470
ERR1   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609480
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609482
       STD     CODE1          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609484
       CALL    .FXEM.(CODE1)  EXIT FOR EXECUTION ERROR               (6)3F609486
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609490
CODE1  PZE     58                                                       3F609500
ER58MS PZE     E58MES,,7                                                3F609510
ER58OP PZE     NOOPXT,,7                                                3F609520
E58MES BCI     7,0NO DOUBLE PRECISION COMPLEX ALLOWED                   3F609530
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED.              3F609540
ERR3   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609610
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609612
       STD     CODE3          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609614
       CALL    .FXEM.(CODE3)  EXIT FOR EXECUTION ERROR               (6)3F609616
       TRA     .LXERR                  NO OPTION EXIT                   3F609620
CODE3  PZE     60                                                       3F609630
ER60MS PZE     E60MES,,3                                                3F609640
ER60OP PZE     NOOPXT,,7                                                3F609650
E60MES BCI     3,0EMBEDDED BLANKS                                       3F609660
ERR4   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609670
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609672
       STD     CODE4          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609674
       CALL    .FXEM.(CODE4)  EXIT FOR EXECUTION ERROR               (6)3F609676
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609680
CODE4  PZE     61                                                       3F609690
ER61MS PZE     E61MES,,8                                                3F609700
ER61OP PZE     NOOPXT,,7                                                3F609710
E61MES BCI     8,0NUM FLD OR EQ SIGN MISSING OR PUNCTUATION ERR.    (10)3F609720
ERR5   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609730
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609732
       STD     CODE5          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609734
       CALL    .FXEM.(CODE5)  EXIT FOR EXECUTION ERROR               (6)3F609736
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609740
CODE5  PZE     62                                                       3F609750
ER62MS PZE     E62MES,,8                                                3F609760
ER62OP PZE     NOOPXT,,7                                                3F609770
E62MES BCI     8,0UNEXPECTED END OF NAMELIST OR END OF RECORD           3F609780
ERR6   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609790
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609792
       STD     CODE6          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609794
       CALL    .FXEM.(CODE6)  EXIT FOR EXECUTION ERROR               (6)3F609796
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609800
CODE6  PZE     63                                                       3F609810
ER63MS PZE     E63MES,,9                                                3F609820
ER63OP PZE     NOOPXT,,7                                                3F609830
E63MES BCI     9,0NAMELIST NAME NOT FOLLOWED BY MATCHING VARIABLE NAME  3F609840
ERR7   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F609850
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F609852
       STD     CODE7          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F609854
       CALL    .FXEM.(CODE7)  EXIT FOR EXECUTION ERROR               (6)3F609856
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609860
CODE7  PZE     64                                                       3F609870
ER64MS PZE     E64MES,,12                                               3F609880
ER64OP PZE     NOOPXT,,7                                                3F609890
E64MES BCI     9,0SUBSCRIPT TOO LARGE OR TOO MANY SUBSCRIPTS OR INCONSI 3F609900
       BCI     3,STENT DIMENSIONING                                     3F609910
MASK   OCT     000000000100                                             3F609920
ERR8   CAL     MASK                                                     3F609930
       ORS     .OPTW.+1                                                 3F609940
       CLA     .FBDBF         ADDITIONAL CARDS NEEDED TO PUT OUT     (6)3F609943
       ALS     18             THE EXTRA LINE CONTAINING THE          (6)3F609945
       STD     CODE8          DATA CARD THAT IS IN ERROR             (6)3F609947
       CALL    .FXEM.(CODE8) EXIT FOR EXECUTION ERROR                   3F609950
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F609960
CODE8  PZE     65                                                       3F609970
ER65MS PZE     E65MES,,7                                                3F609980
ER65OP PZE     E65AMS,,6                                                3F609990
E65MES BCI     7,0THE SIZE OF AN ARRAY HAS BEEN EXCEEDED                3F610000
E65AMS BCI     6,0READING OF ARRAY VALUES CONTINUES                     3F610010
ERR9   CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610020
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610022
       STD     CODE9          DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610024
       CALL    .FXEM.(CODE9)  EXIT FOR EXECUTION ERROR               (6)3F610026
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610030
CODE9  PZE     66                                                       3F610040
ER66MS PZE     E66MES,,7                                                3F610050
ER66OP PZE     NOOPXT,,7                                                3F610060
E66MES BCI     7,0LITERAL NOT PRECEDED BY VARIABLE NAME                 3F610070
ERR10  CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610080
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610082
       STD     CODE10         DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610084
       CALL    .FXEM.(CODE10) EXIT FOR EXECUTION ERROR               (6)3F610086
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610090
CODE10 PZE     67                                                       3F610100
ER67MS PZE     E67MES,,8                                                3F610110
ER67OP PZE     NOOPXT,,7                                                3F610120
E67MES BCI     8,0PUNCTUATION MISSING FOR COMPLEX LITERAL               3F610130
ERR11  CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610140
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610142
       STD     CODE11         DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610144
       CALL    .FXEM.(CODE11) EXIT FOR EXECUTION ERROR               (6)3F610146
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610150
CODE11 PZE     68                                                       3F610160
ER68MS PZE     E68MES,,7                                                3F610170
ER68OP PZE     NOOPXT,,7                                                3F610180
E68MES BCI     7,0ILLEGAL CHARACTER IN LOGICAL INPUT DATA               3F610190
ERR12  CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610200
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610202
       STD     CODE12         DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610204
       CALL    .FXEM.(CODE12) EXIT FOR EXECUTION ERROR               (6)3F610206
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610210
CODE12 PZE     69                                                       3F610220
ER69MS PZE     E69MES,,7                                                3F610230
ER69OP PZE     NOOPXT,,7                                                3F610240
E69MES BCI     7,0DATA TYPE DOES NOT MATCH VARIABLE NAME                3F610250
ERR13  CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610260
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610262
       STD     CODE13         DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610264
       CALL    .FXEM.(CODE13) EXIT FOR EXECUTION ERROR               (6)3F610266
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610270
CODE13 PZE     70                                                       3F610280
ER70MS PZE     E70MES,,16                                               3F610290
ER70OP PZE     NOOPXT,,7                                                3F610300
E70MES BCI     9,0ILLEGAL CHARACTER OR ALL BLANKS IN LITERAL OR VARIABL 3F610310
       BCI     7,E NAME BEGINS WITH NUMERICAL CHARACTER                 3F610320
ERR14  CLA     .FBDBF         LOCATION OF BUFFER CONTAINING DATA     (6)3F610330
       ALS     18             CARD WHICH HAS ERROR, IS PLACED IN     (6)3F610332
       STD     CODE14         DECREMENT OF CODE FOR PRINTOUT BY FXEM (6)3F610334
       CALL    .FXEM.(CODE14) EXIT FOR EXECUTION ERROR               (6)3F610336
       TRA     .LXERR                  NO OPTIONAL EXIT                 3F610340
CODE14 PZE     52                                                       3F610350
ER52MS PZE     E52MES,,7                                                3F610360
ER52OP PZE     NOOPXT,,7                                                3F610370
E52MES BCI     7,0PUNCTUATION ERROR OR ZERO SUBSCRIPT                   3F610380
STOP   HTR     STOP                                                     3F610390
LNKG   LDIR                                                             3F610400
       END                                                           $5$3F610410
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6A0000
$IBMAP FLOG    150                                                      3F6A0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6A0015
       TTL     FLOG-SINGLE PRECISION FLTG. PT. COMMON LOG + NATURAL LOG 3F6A0019
       ENTRY   ALOG                                                     3F6A0020
       ENTRY   ALOG10                                                   3F6A0030
       SPACE   3                                                        3F6A0040
       REM     LOGARITHM SUBROUTINE                                     3F6A0050
       SPACE   3                                                        3F6A0060
ALOG10 STL     FLAG                                                     3F6A0070
 ALOG  SXA     SYSLOC,4                                                 3F6A0080
       SXA     LINK,4                                                   3F6A0090
       CLA*    3,4           PICK UP ARG,T                              3F6A0100
       TZE     ERROR1        IF X IS 0 OR NEGATIVE, THIS IS ERROR       3F6A0110
       TMI     ERROR2                                                   3F6A0120
 BEGIN STO     BUFF                                                     3F6A0130
       FSB     FLONE         Z=X-1                                      3F6A0140
       LAS     TWOM7                                                    3F6A0150
       TRA     A             IF ARG IS AWAY FROM 1, SKIP                3F6A0160
       AXT     0,0                                                      3F6A0170
       STO     BUFF          FOR X APPROX. 1, USE POWER SERIES FOR Z    3F6A0180
       XCA                                                              3F6A0190
       FMP     D2              F=Z-(1/2+3*2**(-18))Z*Z+(1/3)Z*Z*Z       3F6A0200
       FAD     D1                                                       3F6A0210
       XCA                                                              3F6A0220
       FMP     BUFF                                                     3F6A0230
       FAD     FLONE                                                    3F6A0240
       XCA                                                              3F6A0250
       FMP     BUFF                                                     3F6A0260
       TRA     TEST                                                     3F6A0270
       SPACE                                                            3F6A0280
   A   LDQ     K3            NORMAL CASE                                3F6A0290
       CLA     BUFF                                                     3F6A0300
       LRS     27            SEND MANTISSA M TO MQ, SCALE CHARAC.       3F6A0310
       ALS     19              TO B16, AND SUBTRACT 128+1/2             3F6A0320
       SUB     K3                                                       3F6A0330
       STO     CHAR                                                     3F6A0340
       SPACE                                                            3F6A0350
       XCA                   PICK UP M IN AC, AND COMPUTE               3F6A0360
       LRS     1                  Z=(M-SQRT2/2)/(M+SQRT2/2)             3F6A0370
       ADD     K1                                                       3F6A0380
       STO     BUFF                                                     3F6A0390
       SUB     K2                                                       3F6A0400
       VDP     BUFF,,34                                                 3F6A0410
       STQ     Z               SCALE B1                                 3F6A0420
       SPACE                                                            3F6A0430
       MPY     Z             COMPUTE FRACTIONAL APPROXIMATION OF        3F6A0440
       STO     SQ               F=LOG((1+Z)/(1-Z)) BASE2                3F6A0450
       ADD     C4                                                       3F6A0460
       STO     BUFF             F=Z(C1+C2*SQ+C3/(C4+SQ))                3F6A0470
       CLA     C3                                                       3F6A0480
       DVP     BUFF                                                     3F6A0490
       STQ     BUFF            SCALE B2                                 3F6A0500
       LDQ     SQ                                                       3F6A0510
       MPY     C2                                                       3F6A0520
       ADD     BUFF                                                     3F6A0530
       ADD     C1              SCALE B2                                 3F6A0540
       XCA                                                              3F6A0550
       MPY     Z               F NOW READY     SCALE B3                 3F6A0560
       SPACE                                                            3F6A0570
       LRS     13            LEADING PART OF F IN B16, TAIL PART IN MQ  3F6A0580
       ADD     CHAR            LOG X BASE2 = CHAR.-128-1/2+F            3F6A0590
       STO     CHAR                                                     3F6A0600
       MPY     LOGTW         NOW LEADING PART AND TAIL PART MAY HAVE    3F6A0610
       STO     Z               DIFFERENT SIGN.  MULTIPLY LOG 2 BASE E   3F6A0620
       LDQ     CHAR            (IN B0) TO EACH PART, FLOAT THE PRODUCTS 3F6A0630
       MPY     LOGTW           AND ADD THEM UP TO OBTAIN ANSWER         3F6A0640
       ORA     K4                                                       3F6A0650
       STO     CHAR                                                     3F6A0660
       XCA                                                              3F6A0670
       ADD     Z                                                        3F6A0680
       ARS     9                                                        3F6A0690
       ORA     K5                                                       3F6A0700
       FAD     CHAR                                                     3F6A0710
       FRN                                                              3F6A0720
 TEST  NZT     FLAG                                                     3F6A0730
       TRA     1,4                                                      3F6A0740
       SPACE                                                            3F6A0750
       XCA                   COMMON LOG REQUESTED                       3F6A0760
       FMP     LOGE                                                     3F6A0770
       FRN                                                              3F6A0780
  RET  STZ     FLAG                                                     3F6A0790
       TRA     1,4                                                      3F6A0800
       SPACE                                                            3F6A0810
ERROR1 CALL    .FXEM.(ELOG1)                                            3F6A0820
       CLA     MOMEGA                                                   3F6A0830
       LXA     LINK,4                                                   3F6A0840
       STZ     FLAG                                                  (9)3F6A0845
       TRA     1,4                                                      3F6A0850
ERROR2 CALL    .FXEM.(ELOG2)                                            3F6A0860
       SSP                                                              3F6A0870
       LXA     LINK,4                                                   3F6A0880
       TRA     BEGIN                                                    3F6A0890
       SPACE                                                            3F6A0900
  K1   OCT     132404746320      SQRT2/2               B1               3F6A0910
  K2   OCT     265011714640      SQRT2                 B1               3F6A0920
  K3   OCT     401000000         128+1/2               B16              3F6A0930
  K4   OCT     210000000000                                             3F6A0940
  K5   OCT     156000000000                                             3F6A0950
 LOGTW OCT     261344137677      LOG 2 BASE E          B0               3F6A0960
 FLONE OCT     201400000000      1                  FLOAT POINT         3F6A0970
 TWOM7 OCT     172400000000      2 TO MINUS 7       FLOAT POINT         3F6A0980
 LOGE  OCT     177674557306      LOG10(E) + FUDGE   FLOAT POINT         3F6A0990
  D1   OCT     -200400003000     -1/2-3*2**(-18)    FLOAT POINT         3F6A1000
  D2   OCT     177525252525      1/3                FLOAT POINT         3F6A1010
  C1   OCT     160416433162      DEC 1.75825662752     B2               3F6A1020
  C2   OCT     047602722370      DEC 0.155295647459    B0               3F6A1030
  C3   OCT     -031150254334     DEC -1.57523642316    B4               3F6A1040
  C4   OCT     -131343172721     DEC -1.39755981619    B2               3F6A1050
MOMEGA OCT     777777777777                                             3F6A1060
       SPACE                                                            3F6A1070
 FLAG  PZE                                                              3F6A1080
 CHAR  BSS     1                                                        3F6A1090
   Z   BSS     1                                                        3F6A1100
  SQ   BSS     1                                                        3F6A1110
 BUFF  BSS     1                                                        3F6A1120
 ELOG1 DEC     9                                                        3F6A1130
       PZE     E9MES,,6                                                 3F6A1140
       PZE     E9OMS,,4                                                 3F6A1150
E9MES  BCI     6,0ALOG(0) OR ALOG10(0) NOT ALLOWED                      3F6A1160
 E9OMS BCI     4,0SET RESULT = -OMEGA                                   3F6A1170
 ELOG2 DEC     10                                                       3F6A1180
       PZE     E10MES,,6                                                3F6A1190
       PZE     E10OMS,,3                                                3F6A1200
E10MES BCI     6,0ALOG(-X) OR ALOG10(-X) NOT ALLOWED                    3F6A1210
E10OMS BCI     3,0EVALUATE FOR +X                                       3F6A1220
       SPACE                                                            3F6A1230
  LINK LDIR                                                             3F6A1240
       END                                                              3F6A1250
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6B0000
$IBMAP FXPF    150                                                      3F6B0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6B0015
       ENTRY   EXP                                                      3F6B0020
       SPACE   3                                                        3F6B0030
       REM     EXPONENTIAL SUBROUTINE                                   3F6B0040
       SPACE   3                                                        3F6B0050
  EXP  SXA     SYSLOC,4                                                 3F6B0060
       SXA     LINK,4                                                   3F6B0070
       CLA*    3,4           PICK UP ARG,T                              3F6B0080
       LDQ     MAXIM                                                    3F6B0090
       TLQ     ERROR         IF ARG TOO LARGE, GIVE ERROR               3F6B0100
       LDQ     MINIM                                                    3F6B0110
       TLQ     *+3                                                      3F6B0120
       ZAC                   IF ARG TOO SMALL, GIVE ZERO ANS            3F6B0130
       TRA     1,4                                                      3F6B0140
       LDQ     CNVRT         CLEAR MQ                                   3F6B0150
       LRS     27                                                       3F6B0160
       SSM                                                              3F6B0170
       ADD     CNVRT         CONVERT TO FIXED POINT                     3F6B0180
       STA     SHIFT                                                    3F6B0190
       MPY     LOGE2         MULTIPLY BY LOG E BASE 2                   3F6B0200
 SHIFT LRS     **                                                       3F6B0210
       ALS     27            SEPARATE INTEFER AND FRACTION              3F6B0220
       STO     SAVE1                                                    3F6B0230
       LRS     4                                                        3F6B0240
       STQ     SAVE2                                                    3F6B0250
       MPY     SAVE2         COMPUTE E**X*LN2                           3F6B0260
       STO     SAVE3           USING CONTINUED FRACTION                 3F6B0270
       ADD     A                                                        3F6B0280
       STO     SAVE4                                                    3F6B0290
       CLA     B                                                        3F6B0300
       DVP     SAVE4                                                    3F6B0310
       STQ     SAVE4                                                    3F6B0320
       LDQ     SAVE3                                                    3F6B0330
       MPY     C                                                        3F6B0340
       LLS     4                                                        3F6B0350
       SUB     SAVE4                                                    3F6B0360
       ADD     D                                                        3F6B0370
       SUB     SAVE2                                                    3F6B0380
       STO     SAVE4                                                    3F6B0390
       CLA     SAVE2                                                    3F6B0400
       LDQ     FPNT1                                                    3F6B0410
       VDP     SAVE4,0,28                                               3F6B0420
       XCA                                                              3F6B0430
       ORA     FPFRM                                                    3F6B0440
       FAD     FPNT1                                                    3F6B0450
       FRN                                                              3F6B0460
       ADD     SAVE1                                                    3F6B0470
       TRA     1,4           RETURN TO MAIN PROGRAM                     3F6B0480
       SPACE                                                            3F6B0490
 ERROR CALL    .FXEM.(EEXP)                                             3F6B0500
       CLA     OMEGA                                                    3F6B0510
       LXA     LINK,4                                                   3F6B0520
       TRA     1,4                                                      3F6B0530
       SPACE                                                            3F6B0540
 MAXIM OCT     207540074636        88.029692                            3F6B0550
 MINIM OCT     -207545523742       -89.415987                           3F6B0560
 OMEGA OCT     377777777777                                             3F6B0570
 LOGE2 OCT     270524354513  1.442695049B1                              3F6B0580
 CNVRT OCT     242                                                      3F6B0590
 FPNT1 OCT     201400000000                                             3F6B0600
 FPFRM OCT     200000000000                                             3F6B0610
   A   OCT     127325604305  87.417497202B8                             3F6B0620
   B   OCT     046477071524  617.9722695B12                             3F6B0630
   C   OCT     010676467775  0.03465735903B0                            3F6B0640
   D   OCT     237214030721  9.9545957821B4                             3F6B0650
 SAVE1 BSS     1                                                        3F6B0660
 SAVE2 BSS     1                                                        3F6B0670
 SAVE3 BSS     1                                                        3F6B0680
 SAVE4 BSS     1                                                        3F6B0690
  EEXP DEC     8                                                        3F6B0700
       PZE     E8MES,,7                                                 3F6B0710
       PZE     E8OMS,,4                                                 3F6B0720
 E8MES BCI     7,0EXP(X), X GRT THAN 88.029692 NOT ALLOWED              3F6B0730
 E8OMS BCI     4,0SET RESULT = + OMEGA                                  3F6B0740
       SPACE                                                            3F6B0750
  LINK LDIR                                                             3F6B0760
       END                                                              3F6B0770
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6C0000
$IBMAP FSCN    150                                                      3F6C0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6C0015
       ENTRY   SIN                                                      3F6C0020
       ENTRY   COS                                                      3F6C0030
       SPACE   3                                                        3F6C0040
       REM     SINE - COSINE SUBROUTINE                                 3F6C0050
       SPACE   3                                                        3F6C0060
  COS  STL     FLAG                                                     3F6C0070
  SIN  SXA     SYSLOC,4                                                 3F6C0080
       SXA     LINK,4                                                   3F6C0090
       CLA*    3,4           PICK UP ARG,T                              3F6C0100
       ZET     FLAG                                                     3F6C0110
       SSP                                                              3F6C0120
       STO     ARG           FLAG IS ZERO FOR SIN ENTRY                 3F6C0130
       SSP                                                              3F6C0140
       LDQ     LEAD0                                                    3F6C0150
       LRS     9                                                        3F6C0160
       PDX     ,4                                                       3F6C0170
       TXH     ERROR,4,153   ORIG. ARG. TOO LARGE FOR SIGNIF. RESULTS.  3F6C0180
       SXA     SXR2,2                                                   3F6C0190
       LLS     19                                                       3F6C0200
       LRS     156,4         THIS RIGHT SHIFT EXPRESS ARG IN B26        3F6C0210
       VDP     PIOV4,,26                                                3F6C0220
       STO     RI            REMAINDER MODULO PI/4                      3F6C0230
       LLS     32                                                       3F6C0240
       ZAC                                                              3F6C0250
       LLS     3                                                        3F6C0260
       PAX     ,2            XR2 KEEPS TRACK OF THE OCTANT X BELONGED   3F6C0270
       ZET     FLAG          IF COSINE REQUESTED, ADD PI/2 TO ARG       3F6C0280
       TXI     MOD1,2,2                                                 3F6C0290
       TXH     MOD2,4,115                                               3F6C0300
       CLA     ARG                                                      3F6C0310
       TRA     SXR2                                                     3F6C0320
 MOD1  TXL     MOD2,2,7                                                 3F6C0330
       TXI     *+1,2,-8                                                 3F6C0340
 MOD2  SXA     SIGN,2        FOR LATER ADJUSTMENT OF SIGN               3F6C0350
       TXL     *+2,2,3                                                  3F6C0360
       TXI     *+1,2,-4      WE NOW CONSIDER ONLY UPPER HALF            3F6C0370
       TXL     RED2,2,0      DEPENDING ON OCTANT, ADJUST AS FOLLOWS     3F6C0380
       TXL     RED1,2,1                        MOD.ARG  XR2             3F6C0390
       TXI     *+1,2,-1            1ST OCTANT     R      0              3F6C0400
       TXL     RED3,2,1            2ND OCTANT  PI/4-R    1              3F6C0410
       TXI     *+1,2,-2            3RD OCTANT     R      1              3F6C0420
 RED1  CLA     PIOV4               4TH OCTANT  PI/4-R    0              3F6C0430
       SUB     RI                                                       3F6C0440
       STO     RI                                                       3F6C0450
       TRA     RED3+1                                                   3F6C0460
 RED2  CAL     ARG           1ST OCTANT.   IF ABS ARG IS LESS THAN 1,   3F6C0470
       TXL     RED4,4,128      USE ORIGINAL ABS ARG FOR R2.             3F6C0480
 RED3  CLA     RI            WE NEED MOD. ARG IN BOTH FIXED POINT       3F6C0490
       TXH     RED4+1,2,0      AND FLOAT POINT FORMS                    3F6C0500
       LRS     8                                                        3F6C0510
       ORA     CHAR                                                     3F6C0520
       STO     R2                                                       3F6C0530
       XCA                                                              3F6C0540
       ARS     8                                                        3F6C0550
       ORA     CHAR+1                                                   3F6C0560
       FAD     R2                                                       3F6C0570
 RED4  STO     R2            R2 IS OUR FLOATING POINT ARGUMENT.         3F6C0580
       REM                   ARITHMETIC SECTION BEGINS                  3F6C0590
       SXD     EITHR,2       XR2=0 FOR SIN SERIES, =1 FOR COS SERIES.   3F6C0600
       LDQ     RI            RI IS OUR MOD.ARG. IN FX.PT.B0             3F6C0610
       MPY     RI                                                       3F6C0620
       STO     SQAR                                                     3F6C0630
       AXT     6,4                                                      3F6C0640
 EITHR TXI     *+1,4,**      XR4=6 FOR SIN LOOP, =7 FOR COS LOOP        3F6C0650
       CLA     CHAR-1,4                                                 3F6C0660
 LOOP  XCA                   POLYNOMIAL APPROXIMATION.                  3F6C0670
       MPY     SQAR                                                     3F6C0680
       ADD     CHAR+1,4                                                 3F6C0690
       TIX     LOOP,4,2                                                 3F6C0700
       CAS     CHAR          RESULT IS IN B1,   IF IT IS GREATER        3F6C0710
       CLA     CHAR            THAN 1, REDUCE IT TO 1 AND               3F6C0720
       ADD     MASK              ADJUST TO COME OUT WITH FLOAT 1        3F6C0730
       LRS     7             FLOAT THE RESULT                           3F6C0740
       ADD     CHAR                                                     3F6C0750
       RQL     28                                                       3F6C0760
       FRN                                                              3F6C0770
       TXL     LAST,4,1      XR4=1 AFTER COS LOOP, =2 AFTER SIN LOOP    3F6C0780
       XCA                                                              3F6C0790
       FMP     R2            R2= RI IN FLOATING FORM                    3F6C0800
       FRN                                                              3F6C0810
 LAST  LDQ     ARG           HERE ARE PROVISION FOR PROPER SIGN OF ANSWE3F6C0820
       LLS     0                                                        3F6C0830
 SIGN  AXT     **,2          AT THIS POINT XR2 HAD QUOTIENT OF (X/PI/4) 3F6C0840
       TXL     *+2,2,3             MODULI 8, IF GREATER THAN 3 X WAS IN 3F6C0850
       CHS                         LOWER HALF,WE SHOULD CHANGE SIGN.    3F6C0860
 SXR2  AXT     **,2                                                     3F6C0870
  RET  LXA     LINK,4                                                   3F6C0880
       STZ     FLAG                                                     3F6C0890
       TRA     1,4                                                      3F6C0900
       SPACE                                                            3F6C0910
 ERROR CALL    .FXEM.(ESCN)                                             3F6C0920
       ZAC                                                              3F6C0930
       TRA     RET                                                      3F6C0940
       SPACE                                                            3F6C0950
 LEAD0 OCT     000001462217    .2438663341E-4  B1    C4                 3F6C0960
       OCT     -000014620331   -.1950390425E-3 B1    S3                 3F6C0970
       OCT     -000133004045   -.1388671182E-2 B1    C3                 3F6C0980
       OCT     001042030565    .8332035786E-2  B1    S2                 3F6C0990
       OCT     005252523632    .4166662099E-1  B1    C2                 3F6C1000
       OCT     -025252517757   -.1666665067    B1    S1                 3F6C1010
       OCT     -077777777712   -.4999999969    B1    C1                 3F6C1020
       OCT     177777777713    .9999999969     B1    S0                 3F6C1030
 CHAR  OCT     200000000000    1. B1  ALSO USED TO FLOAT NUMBERS        3F6C1040
       OCT     145000000000                                             3F6C1050
 MASK  OCT     100000000000                                             3F6C1060
 PIOV4 OCT     +311037552421       PI/4 AS FIXED POINT NUMBER B0        3F6C1070
  ARG  BSS     1                                                        3F6C1080
  RI   BSS     1                                                        3F6C1090
  R2   BSS     1                                                        3F6C1100
 SQAR  BSS     1                                                        3F6C1110
 FLAG  PZE                                                              3F6C1120
 ESCN  DEC     12                                                       3F6C1130
       PZE     E12MES,,10                                               3F6C1140
       PZE     E12OMS,,3                                                3F6C1150
E12MES BCI ,0SIN(X) OR COS(X), /X/ GRT THAN OR EQ TO 2**25 NOT ALLOWED  3F6C1160
E12OMS BCI     3,0SET RESULT = 0                                        3F6C1170
       SPACE                                                            3F6C1180
  LINK LDIR                                                             3F6C1190
       END                                                              3F6C1200
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6D0000
$IBMAP FSQR    150                                                      3F6D0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6D0015
       ENTRY   SQRT                                                     3F6D0020
       SPACE   3                                                        3F6D0030
       REM     SQUARE ROOT SUBROUTINE                                   3F6D0040
       SPACE   3                                                        3F6D0050
 SQRT  SXA     SYSLOC,4                                                 3F6D0060
       SXA     LINK,4                                                   3F6D0070
       CLA*    3,4           PICK UP ARG,T                              3F6D0080
       TZE     1,4                                                      3F6D0090
       TPL     BEGIN                                                    3F6D0100
       SPACE                                                            3F6D0110
       CALL    .FXEM.(ESQRT)                                            3F6D0120
       SSP                                                              3F6D0130
       SPACE                                                            3F6D0140
 BEGIN STO     BUFF          1ST APPROX. IS OBTAINED AS FOLLOWS         3F6D0150
       ANA     K1              BETWEEN 1/2 AND 1, BY LINE PASSING THRU  3F6D0160
       ARS     1                 3/4 AND 1                              3F6D0170
       ADD     BUFF            BETWEEN 1/4 AND 1/2, BY LINE PASSINGTHRU 3F6D0180
       ARS     1                 1/2 AND 3/4                            3F6D0190
       ADD     K2                                                       3F6D0200
       SPACE                                                            3F6D0210
       AXT     3,4           REFINE APPROX. BY 3 PASSES OF NEWTON-      3F6D0220
 LOOP  STO     BUFF+1          RAPHSON LOOP                             3F6D0230
       CLA     BUFF                                                     3F6D0240
       FDP     BUFF+1                                                   3F6D0250
       XCA                                                              3F6D0260
       FAD     BUFF+1                                                   3F6D0270
       SUB     K1                                                       3F6D0280
       TIX     LOOP,4,1                                                 3F6D0290
       FRN                                                              3F6D0300
       LXA     LINK,4                                                   3F6D0310
       TRA     1,4                                                      3F6D0320
       SPACE                                                            3F6D0330
  K1   OCT     1000000000                                               3F6D0340
  K2   OCT     100400000000                                             3F6D0350
 BUFF  BSS     2                                                        3F6D0360
 ESQRT DEC     13                                                       3F6D0370
       PZE     E13MES,,4                                                3F6D0380
       PZE     E13OMS,,3                                                3F6D0390
E13MES BCI     4,0SQRT(-X) NOT ALLOWED                                  3F6D0400
E13OMS BCI     3,0EVALUATE FOR +X                                       3F6D0410
       SPACE                                                            3F6D0420
  LINK LDIR                                                             3F6D0430
       END                                                              3F6D0440
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6E0000
$IBMAP FTNH    150                                                      3F6E0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6E0015
       ENTRY   TANH                                                     3F6E0020
       SPACE   3                                                        3F6E0030
       REM     HYPERBOLIC TANGENT SUBROUTINE                            3F6E0040
       SPACE   3                                                        3F6E0050
  TANH SXA     SYSLOC,4                                                 3F6E0060
       SXA     LINK,4                                                   3F6E0070
       CLA*    3,4           PICK UP ARG,T                              3F6E0080
       STO     SAVE1         SAVE ARGUMENT                              3F6E0090
       SSP                                                              3F6E0100
       LDQ     MAXIM         RETURN WITH 1.0                            3F6E0110
       TLQ     ONE             IF BIGGER THAN 10.4                      3F6E0120
       LDQ     TRESH         TEST FOR                                   3F6E0130
       TLQ     OTHER           CIRCUIT                                  3F6E0140
       LDQ     SAVE1                                                    3F6E0150
       FMP     SAVE1         SQUARE                                     3F6E0160
       STO     SAVE2                                                    3F6E0170
       LDQ     K9                                                       3F6E0180
       STQ     SAVE3                                                    3F6E0190
       AXT     4,4                                                      3F6E0200
  LOOP FDP     SAVE3         COMPUTE                                    3F6E0210
       XCA                     CONTINUED                                3F6E0220
       FAD     K1+1,4            FRACTION                               3F6E0230
       STO     SAVE3                                                    3F6E0240
       CLA     SAVE2                                                    3F6E0250
       TIX     LOOP,4,1                                                 3F6E0260
       CLA     SAVE1                                                    3F6E0270
       FDP     SAVE3                                                    3F6E0280
       XCA                                                              3F6E0290
       TRA     RET           GO TO FINALIZE                             3F6E0300
       SPACE                                                            3F6E0310
 OTHER ADD     FMP2          MULTIPLY BY 2                              3F6E0320
       STO     SAVE3                                                    3F6E0330
       CALL    EXP(SAVE3)    COMPUTE BY EXPONENTIAL METHOD              3F6E0340
       FAD     K1              EXPONENTIAL                              3F6E0350
       STO     SAVE2             METHOD                                 3F6E0360
       CLS     K2                                                       3F6E0370
       FDP     SAVE2                                                    3F6E0380
       XCA                                                              3F6E0390
       FAD     K1                                                       3F6E0400
       FRN                                                              3F6E0410
  SIGN LDQ     SAVE1         SET                                        3F6E0420
       LLS     0               SIGN                                     3F6E0430
   RET LXA     LINK,4        RESTORE                                    3F6E0440
       TRA     1,4                                                      3F6E0450
       SPACE                                                            3F6E0460
   ONE CLA     K1            PUT ONE AS                                 3F6E0470
       TRA     SIGN              ANSWER                                 3F6E0480
       SPACE                                                            3F6E0490
 MAXIM OCT     204514631463  10.4                                       3F6E0500
 TRESH OCT     200431175237  0.5493061442                               3F6E0510
  FMP2 OCT     1000000000                                               3F6E0520
    K2 OCT     202400000000  2.0                                        3F6E0530
    K9 OCT     204440701331  9.0274307                                  3F6E0540
       OCT     203700000000  7.0                                        3F6E0550
       OCT     203500000000  5.0                                        3F6E0560
       OCT     202600000000  3.0                                        3F6E0570
    K1 OCT     201400000000  1.0                                        3F6E0580
 SAVE1 PZE                                                              3F6E0590
 SAVE2 PZE                                                              3F6E0600
 SAVE3 PZE                                                              3F6E0610
       SPACE                                                            3F6E0620
  LINK LDIR                                                             3F6E0630
       END                                                              3F6E0640
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6F0000
$IBMAP FATN    150                                                      3F6F0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F6F0015
       ENTRY   ATAN                                                     3F6F0020
       ENTRY   ATAN2                                                    3F6F0030
       SPACE   3                                                        3F6F0040
*              ARCTANGENT SUBROUTINE                                    3F6F0050
*                  ATAN ACCEPTS A SINGLE ARGUMENT AND ANSWER IS         3F6F0060
*                    BETWEEN -PI/2 AND PI/2                             3F6F0070
*                  ATAN2 ACCEPTS A PAIR OF ARGUMENTS - ORDINATE AND     3F6F0080
*                    ABSCISSA, AND ANSWER IS BETWEEN -PI AND PI         3F6F0090
       SPACE   3                                                        3F6F0100
 ATAN2 STL     FLAG                                                     3F6F0110
 ATAN  SXA     SYSLOC,4                                                 3F6F0120
       SXA     LINK,4                                                   3F6F0130
       CLA*    3,4           PICK UP ARG,T                              3F6F0140
       STO     ARG                                                      3F6F0150
       NZT     FLAG                                                     3F6F0160
       TRA     ATAN1         IF SINGLE ARGUMENT CALL, SKIP.             3F6F0170
       ZET*    4,4                                                      3F6F0180
       TRA     BB                                                       3F6F0190
       TNZ     AA                                                       3F6F0200
       CALL    .FXEM.(EATN)    IF THE ARG PAIR IS (0,0), ERROR.         3F6F0210
       ZAC                                                              3F6F0220
       LXA     LINK,4                                                   3F6F0230
       TRA     RET1                                                     3F6F0240
  AA   LDQ     PIHLF         CASE OF SMALL X                            3F6F0250
       LRS     0               GIVE + OR - PI/2 DEPENDING ON SIGN OF Y  3F6F0260
       XCA                                                              3F6F0270
       TRA     RET1                                                     3F6F0280
  BB   CLA*    4,4                                                      3F6F0290
       ACL     CH27                                                     3F6F0300
       SLW     BUFF                                                     3F6F0310
       CLA     ARG                                                      3F6F0320
       LAS     BUFF          IF Y/X IS GREATER THAN 2**27               3F6F0330
       TRA     AA              IN MAGNITUDE, GO TO AA. THIS AVOIDS      3F6F0340
       TRA     AA                FLOAT POINT OVEFLOW.                   3F6F0350
       FDP*    4,4                                                      3F6F0360
       XCA                   WITH X/Y, JOIN MAIN CIRCUIT                3F6F0370
       STO     ARG                                                      3F6F0380
       SPACE                                                            3F6F0390
 ATAN1 SXA     SXR1,1                                                   3F6F0400
       SSP                                                              3F6F0410
       LDQ     C5                                                       3F6F0420
       LRS     27                                                       3F6F0430
       PAX     ,1                                                       3F6F0440
       TXL     *+3,1,155                                                3F6F0450
       CLA     PIHLF         FOR LARGE ARGUMENT RETURN WITH HALF PI     3F6F0460
   A   TXL     SIGN,0,**                                                3F6F0470
       TXH     *+3,1,114                                                3F6F0480
       CLA     ARG           FOR SMALL ARGUMENT RETURN WITH THE ARGUMENT3F6F0490
       TRA     SXR1                                                     3F6F0500
       SPACE                                                            3F6F0510
       AXT     0,4                                                      3F6F0520
       TXL     B,1,128                                                  3F6F0530
       TXI     *+1,4,2       IF ARGUMENT GREATER THAN 1, TAKE THE RECI- 3F6F0540
       STQ     BUFF            PROCAL                                   3F6F0550
       CLA     ONE                                                      3F6F0560
       DVP     BUFF                                                     3F6F0570
       SXD     A,1                                                      3F6F0580
       LDC     A,1                                                      3F6F0590
       TXI     *+1,1,258                                                3F6F0600
       SPACE                                                            3F6F0610
   B   ZAC                                                              3F6F0620
       LRS     130,1         X OR 1 OVER X IN MQ, SCALING (2,33)        3F6F0630
       SPACE                                                            3F6F0640
       CLA     TAN15                                                    3F6F0650
       TLQ     C             IF ARGUMENT GREATER THAN TAN PI/12, COMPUTE3F6F0660
       XCA                     TAN Z WHERE TAN (Z+PI/6)=X.              3F6F0670
       ADD     RTTHR                                                    3F6F0680
       STO     BUFF            TAN Z = SQRT3-4/(X+SQRT3)                3F6F0690
       CLA     MFOUR                                                    3F6F0700
       DVP     BUFF                                                     3F6F0710
       XCA                                                              3F6F0720
       ADD     RTTHR                                                    3F6F0730
       LRS     34                                                       3F6F0740
       TXI     *+2,4,1                                                  3F6F0750
       SPACE                                                            3F6F0760
   C   LLS     1             MODIFIED ARGUMENT IN MQ , SCALE (1,34)     3F6F0770
       STQ     BUFF                                                     3F6F0780
       MPY     BUFF                                                     3F6F0790
       STO     SQ            X SQUARE, SCALE (2,33)                     3F6F0800
       ADD     C6            COMPUTE CONTINUED FRACTION FOR (ATAN X)/X  3F6F0810
       STO     BUFF+1                                                   3F6F0820
       CLA     C5             (ATAN X)/X = C1*SQ+C2                     3F6F0830
       DVP     BUFF+1                         +(C3/(SQ+C4+C5/(SQ+C6)))  3F6F0840
       XCA                                                              3F6F0850
       ADD     SQ                                                       3F6F0860
       ADD     C4                                                       3F6F0870
       STO     BUFF+1                                                   3F6F0880
       CLA     C3                                                       3F6F0890
       DVP     BUFF+1                                                   3F6F0900
       STQ     BUFF+1                                                   3F6F0910
       LDQ     SQ                                                       3F6F0920
       MPY     C1                                                       3F6F0930
       ADD     BUFF+1                                                   3F6F0940
       ADD     C2              SCALE (2,33)                             3F6F0950
       SPACE                                                            3F6F0960
       TXL     D,4,0                                                    3F6F0970
       XCA                   FOR ANGLE GREATER THAN PI/12, CONTINUE     3F6F0980
       MPY     BUFF            WITH FIXED POINT OPERATION.   OBTAIN Z   3F6F0990
       TXL     *+2,4,1         AND ADD TO (OR SUBTRACT FROM) APPROPRIATE3F6F1000
       CHS                     BASE ANGLE                               3F6F1010
       ADD     N+1,4                                                    3F6F1020
       AXT     0,1           CONVERT TO NORMALIZED FLOAT POINT NUMBER   3F6F1030
       LRS     33                                                       3F6F1040
       LLS     1                                                        3F6F1050
       LBT                                                              3F6F1060
       TXI     *-2,1,1                                                  3F6F1070
       LLS     26                                                       3F6F1080
       RQL     28                                                       3F6F1090
       ORA     CHAR,1                                                   3F6F1100
       FRN                                                              3F6F1110
       SPACE                                                            3F6F1120
 SIGN  LDQ     ARG                                                      3F6F1130
       LLS     0                                                        3F6F1140
  RET  LXA     LINK,4                                                   3F6F1150
 SXR1  AXT     **,1                                                     3F6F1160
       NZT     FLAG                                                     3F6F1170
       TRA     1,4                                                      3F6F1180
       SPACE                                                            3F6F1190
       LDQ*    4,4           TEST SIGN OF DENOMINATOR IF ATAN2 ENTRY    3F6F1200
       TQP     RET1          ANSWER RANGE FOR ATAN2 IS                  3F6F1210
       TPL     *+3             FROM - PI TO PI                          3F6F1220
       FAD     PI                                                       3F6F1230
       TRA     RET1                                                     3F6F1240
       FSB     PI                                                       3F6F1250
 RET1  STZ     FLAG                                                     3F6F1260
       TRA     1,4                                                      3F6F1270
       SPACE                                                            3F6F1280
   D   ARS     6             FOR ANGLE LESS THAN PI/12, USE FLOAT POINT 3F6F1290
       ORA     CHAR-1          OPERATION TO SAVE RELATIVE ACCURACY      3F6F1300
       XCA                                                              3F6F1310
       FMP     ARG                                                      3F6F1320
       FRN                                                              3F6F1330
       TRA     RET                                                      3F6F1340
       SPACE                                                            3F6F1350
  PI   OCT     202622077325      PI FLOAT POINT                         3F6F1360
 PIHLF OCT     201622077325        PI/2   FLOAT POINT                   3F6F1370
  ONE  OCT     100000000000        1                     B2             3F6F1380
 TAN15 OCT     021114121365        TAN PI/12             B2             3F6F1390
 RTTHR OCT     156663656413        SQRT 3                B2             3F6F1400
 MFOUR OCT     -100000000000       -4                    B4             3F6F1410
       OCT     041405221603        PI/3                  B3             3F6F1420
       OCT     062207732504        PI/2                  B3             3F6F1430
   N   OCT     020602510701        PI/6                  B3             3F6F1440
       OCT     177000000000                                             3F6F1450
       OCT     200000000000                                             3F6F1460
 CHAR  OCT     201000000000                                             3F6F1470
  C1   OCT     -004352472453       -0.0174149659864      B0             3F6F1480
  C2   OCT     033326050225        0.428408163265        B2             3F6F1490
  C3   OCT     022500447357        1.16413294461         B4             3F6F1500
  C4   OCT     215407354215        2.21116520610         B2             3F6F1510
  C5   OCT     -003701404617       -0.242371744720       B4             3F6F1520
  C6   OCT     130705255247        1.38883479390         B2             3F6F1530
 CH27  OCT     033000000000                                             3F6F1540
  ARG  BSS     1                                                        3F6F1550
  SQ   BSS     1                                                        3F6F1560
 BUFF  BSS     2                                                        3F6F1570
 FLAG  PZE                                                              3F6F1580
 EATN  DEC     11                                                       3F6F1590
       PZE     E11MES,,4                                                3F6F1600
       PZE     E11OMS,,3                                                3F6F1610
E11MES BCI     4,0ATAN2(0,0) NOT ALLOWED                                3F6F1620
E11OMS BCI     3,0SET RESULT = 0                                        3F6F1630
       SPACE                                                            3F6F1640
  LINK LDIR                                                             3F6F1650
       END                                                              3F6F1660
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6G0000
$IBMAP FXP1    50                                                       3F6G0010
       TTL     SINGLE PREC. EXPONENTIAL-FIXED PT. BASE, EXPT.-XP1       3F6G0020
.XP1.  SAVE    (4)                                                      3F6G0030
       CLA*    3,4                                                      3F6G0040
       LDQ*    4,4                                                      3F6G0050
       STO     BASE                                                     3F6G0060
       STQ     EXPT                                                     3F6G0070
       TZE     TEST           TRANSFER IF ZERO BASE                     3F6G0080
       CLA     ONE                                                      3F6G0090
       NZT     EXPT           IF EXPT IS ZERO,                          3F6G0100
 OUT   RETURN  .XP1.          EXIT WITH ONE AS ANSWER                   3F6G0110
       SBM     BASE                                                     3F6G0120
       TZE     NEW            CHECK FOR BASE OF + OR - ONE              3F6G0130
       TQP     NEW                                                      3F6G0140
       PXD     0,0            IF NEG EXPT, EXIT                         3F6G0150
       TRA     OUT            WITH ZERO ANSWER                          3F6G0160
 NEW   CLA     ONE                                                      3F6G0170
       STO     FACTR                                                    3F6G0180
 CLA1  CLA     EXPT                                                     3F6G0190
       LBT                    TEST EXPONENT                             3F6G0200
       TRA     CLA2                                                     3F6G0210
       LDQ     BASE           CHANGE FACTR ACCORDINGLY                  3F6G0220
       MPY     FACTR                                                    3F6G0230
       STQ     FACTR                                                    3F6G0240
 CLA2  CLA     EXPT           TEST EXPONENT                             3F6G0250
       ARS     1                                                        3F6G0260
       STO     EXPT                                                     3F6G0270
       TZE     EXIT           FINISHED IF EXPT NOW ZERO                 3F6G0280
       LDQ     BASE           OTHERWISE                                 3F6G0290
       MPY     BASE           CALCULATE NEW BASE                        3F6G0300
       STQ     BASE                                                     3F6G0310
       TRA     CLA1           START AGAIN                               3F6G0320
 EXIT  XCA                                                              3F6G0330
       TRA     OUT                                                      3F6G0340
 TEST  NZT     EXPT          TEST EXPONENT                              3F6G0350
       TRA     ERR           EXPONENT ZERO - ERROR                      3F6G0360
       TQP     OUT            EXPONENT POSITIVE, EXIT WITH 0            3F6G0370
ERR1   CALL    .FXEM.(E2XP1)                                            3F6G0380
 CALLM ZAC                                                              3F6G0390
       TRA     OUT                                                      3F6G0400
ERR    CALL    .FXEM.(E1XP1)                                            3F6G0410
       TRA     CALLM                                                    3F6G0420
 ONE   DEC     1                                                        3F6G0430
 BASE                                                                   3F6G0440
 EXPT                                                                   3F6G0450
 FACTR                                                                  3F6G0460
E1XP1  DEC     1              0**0                                      3F6G0470
ER1MS  PZE     E1MES,,5                                                 3F6G0480
ER1OP  PZE     E1OMS,,3                                                 3F6G0490
E1MES  BCI     5,0EXPONENTIATION ERROR 0**0                             3F6G0500
E1OMS  BCI     3,0SET RESULT = 0                                        3F6G0510
E2XP1  DEC     2              0**(-J)                                   3F6G0520
ER2MS  PZE     E2MES,,5                                                 3F6G0530
ER2OP  PZE     E1OMS,,3                                                 3F6G0540
E2MES  BCI     5,0EXPONENTIATION ERROR 0**(-J)                          3F6G0550
       END                                                              3F6G0560
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6H0000
$IBMAP FXP2    50                                                       3F6H0010
       TTL     SINGLE PREC. EXPONENTIAL-FLTG. PT. BASE, FIXED EXPT.-XP2 3F6H0020
.XP2.  SAVE    (4)                                                      3F6H0030
       CLA*    3,4                                                      3F6H0040
       LDQ*    4,4                                                      3F6H0050
       STQ     EXPT                                                     3F6H0060
       TZE     TEST           TRANSFER IF ZERO BASE                     3F6H0070
       STO     BASE                                                     3F6H0080
       CLA     FLONE                                                    3F6H0090
       NZT     EXPT           IF EXPONENT IS ZERO,                      3F6H0100
 OUT   RETURN  .XP2.          EXIT WITH ONE AS ANSWER                   3F6H0110
       TQP     MQPOS          TRANSFER IF POSITIVE EXPONENT             3F6H0120
       AXT     -1,4           SET FLAG, NEG EXPT                        3F6H0130
       TRA     *+2                                                      3F6H0140
MQPOS  AXT     0,4            SET FLAG, POS EXPT                        3F6H0150
       STO     FACTR                                                    3F6H0160
 CLA1  CLA     EXPT                                                     3F6H0170
       LBT                    TEST EXPONENT                             3F6H0180
       TRA     CLA2                                                     3F6H0190
       LDQ     BASE           CHANGE FACTR ACCORDINGLY                  3F6H0200
       FMP     FACTR                                                    3F6H0210
       STO     FACTR                                                    3F6H0220
 CLA2  CLA     EXPT           TEST EXPT                                 3F6H0230
       ARS     1                                                        3F6H0240
       STO     EXPT                                                     3F6H0250
       TZE     EXIT           FINISHED IF EXPT NOW ZERO                 3F6H0260
       LDQ     BASE           CALCULATE NEW BASE                        3F6H0270
       FMP     BASE                                                     3F6H0280
       STO     BASE                                                     3F6H0290
       TRA     CLA1           START AGAIN                               3F6H0300
 EXIT  CLA     FACTR                                                    3F6H0310
       TXL     EXIT2,4,0                                                3F6H0320
       CLA     FLONE                                                    3F6H0330
       FDP     FACTR                                                    3F6H0340
       XCA                                                              3F6H0350
 EXIT2 TRA     OUT                                                      3F6H0360
 TEST  NZT     EXPT          TEST EXPONENT                              3F6H0370
       TRA     ERR           EXPONENT ZERO - ERROR                      3F6H0380
       TQP     OUT            EXPONENT POSITIVE-EXIT WITH 0             3F6H0390
 ERR1  CALL    .FXEM.(E2XP2)                                            3F6H0400
 CALLM ZAC                                                              3F6H0410
       TRA     OUT                                                      3F6H0420
 ERR   CALL    .FXEM.(E1XP2)                                            3F6H0430
       TRA     CALLM                                                    3F6H0440
 FLONE DEC     1.0                                                      3F6H0450
 BASE                                                                   3F6H0460
 EXPT                                                                   3F6H0470
 FACTR                                                                  3F6H0480
E1XP2  DEC     3              0**0                                      3F6H0490
ER3MS  PZE     E3MES,,5                                                 3F6H0500
ER3OP  PZE     E3OMS,,3                                                 3F6H0510
E3MES  BCI     5,0EXPONENTIATION ERROR 0**0                             3F6H0520
E3OMS  BCI     3,0SET RESULT =0                                         3F6H0530
E2XP2  DEC     4              0**(-J)                                   3F6H0540
ER4MS  PZE     E4MES,,5                                                 3F6H0550
ER4OP  PZE     E3OMS,,3                                                 3F6H0560
E4MES  BCI     5,0EXPONENTIATION ERROR 0**(-J)                          3F6H0570
       END                                                              3F6H0580
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F6I0000
$IBMAP FXP3    45                                                       3F6I0010
       TTL     SINGLE PREC. EXPONENTIAL-FLTG. PT. BASE, EXPT.-XP3       3F6I0020
.XP3.  SAVE    (4)                                                      3F6I0030
       CLA*    3,4            OBTAIN BOTH                               3F6I0040
       LDQ*    4,4            ARGUMENTS                                 3F6I0050
       STO     BASE                                                     3F6I0060
       STQ     EXPT                                                     3F6I0070
       TZE     TEST           TRANSFER IF ZERO BASE                     3F6I0080
       XCA                                                              3F6I0090
       TZE     SPEC                                                     3F6I0100
       TQP     *+2                                                      3F6I0110
       TRA     ERR2                                                     3F6I0120
 CALLG CALL    ALOG(BASE)                                               3F6I0130
       XCA                                                              3F6I0140
       FMP     EXPT           CALCULATE EXPT * LOG (BASE)               3F6I0150
       STO     EXPT                                                     3F6I0160
 CALL1 CALL    EXP(EXPT)                                                3F6I0170
 OUT   RETURN  .XP3.          EXIT WITH ANSWER                          3F6I0180
 TEST  NZT     EXPT           TEST EXPONENT                             3F6I0190
       TRA     ERR            EXPT AND BASE BOTH ZERO                   3F6I0200
       TQP     OUT            EXPT POSITIVE, EXIT WITH ZERO             3F6I0210
 ERR1  CALL    .FXEM.(E3XP3)                                            3F6I0220
 CALLM ZAC                                                              3F6I0230
       TRA     OUT                                                      3F6I0240
 ERR   CALL    .FXEM.(E2XP3)                                            3F6I0250
       TRA     CALLM                                                    3F6I0260
 ERR2  CALL    .FXEM.(E1XP3)                                            3F6I0270
       CLS     BASE                                                     3F6I0280
       STO     BASE                                                     3F6I0290
       TRA     CALLG                                                    3F6I0300
 SPEC  CLA     FLONE                                                    3F6I0310
       TRA     OUT                                                      3F6I0320
 FLONE DEC     1.0                                                      3F6I0330
 BASE                                                                   3F6I0340
 EXPT                                                                   3F6I0350
E1XP3  DEC     5              (-A)**B                                   3F6I0360
ER5MS  PZE     E5MES,,5                                                 3F6I0370
ER5OP  PZE     E5OMS,,3                                                 3F6I0380
E5MES  BCI     5,0EXPONENTIATION ERROR (-B)**C                          3F6I0390
E5OMS  BCI     3,0EVALUATE FOR +B                                       3F6I0400
E2XP3  DEC     6              0**0                                      3F6I0410
ER6MS  PZE     E6MES,,5                                                 3F6I0420
ER6OP  PZE     E6OMS,,3                                                 3F6I0430
E6MES  BCI     5,0EXPONENTIATION ERROR 0**0                             3F6I0440
E6OMS  BCI     3,0SET RESULT = 0                                        3F6I0450
E3XP3  DEC     7              0**(-A)                                   3F6I0460
ER7MS  PZE     E7MES,,5                                                 3F6I0470
ER7OP  PZE     E6OMS,,3                                                 3F6I0480
E7MES  BCI     5,0EXPONENTIATION ERROR 0**(-C)                          3F6I0490
       END                                                              3F6I0500
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FBST              3F7A0000
$IBMAP FBST    95                                                       3F7A0010
       TTL     FBST/BACKSPACE RECORD ON DESIGNATED UNIT              (7)3F7A0020
       REM                                                              3F7A0030
       REM     CALLING SEQUENCE IS CALL .FBST. (ARG)                    3F7A0040
       REM     COMPILED FOR SOURCE STATEMENT BACKSPACE N.               3F7A0050
       REM     ARG IS LOCATION OF PZE UNITXX WHERE XX IS                3F7A0060
       REM     LOGICAL UNIT NUMBER.                                     3F7A0070
       REM                                                              3F7A0080
.FBST. SAVE    (2,1)I                                                   3F7A0090
       CLA*    3,4                   FILE CONTROL BLOCK LOCATION.       3F7A0100
       STA     CLS                                                      3F7A0110
       STA     CLS1                                                     3F7A0120
       STA     OPN                                                      3F7A0130
       STA     READ                                                     3F7A0140
       STA     BKRCD+1                                                  3F7A0150
       STA     BKRCD1                                                   3F7A0160
       LAC     SYSUNI,4              TEST WHETHER UNIT IS SYSOU1.       3F7A0170
       CLA     SYSOU1,4                                                 3F7A0180
       TSX     CHK,2                                                    3F7A0190
       TXL     IGNSOU,4,0            IF SYSOU1,IGNORE BACKSPACE REQUEST.3F7A0200
       TSX     .CLOSE,4              INPUT FILE CLOSED. OUTPUT FILE     3F7A0210
CLS    MZE     **                    CLOSED WITH EOF WRITTEN.           3F7A0220
       LAC     CLS,4                                                    3F7A0230
       LDI     1,4                                                      3F7A0240
       SIL     001000                SET BITS IN FCB FOR OUTPUT         3F7A0250
       RIL     002000                TO DEBUFFER ON OPENING FILE.       3F7A0260
       STI     1,4                                                      3F7A0270
       TSX     OPEN,2                OPEN FILE.                         3F7A0280
       TSX     .BSR,4                BACKSPACE RECORD. IF POSITIONED    3F7A0290
BKRCD1 PZE     **,,*-1               AFTER EOF, BSR POSITIONS IN FRONT  3F7A0300
       TSX     .CLOSE,4              OF EOF AND BOF EXIT IS TO BACKSPACE3F7A0310
CLS1   MON     **                    LAST RECORD.  CLOSE FILE AND       3F7A0320
       LAC     CLS,4                 SET BITS IN FCB TO INPUT.          3F7A0330
       LDI     1,4                                                      3F7A0340
       RIL     003000                                                   3F7A0350
       STI     1,4                                                      3F7A0360
       LAC     SYSUNI,4              IS THIS SYSIN1.                    3F7A0370
       CLA     SYSIN1,4                                                 3F7A0380
       TSX     CHK,2                                                    3F7A0390
       TXL     RTN,4,0               YES. EXIT TO CALLER.               3F7A0400
       LNT     004000                IS THIS A BCD FILE.                3F7A0410
RTN    RETURN  .FBST.                YES. EXIT TO CALLER.               3F7A0420
       TSX     OPEN,2                                                   3F7A0430
       AXT     1,1                 SET FOR ONE BACKSPACE IF EOF      (7)3F7A0431
REED   TSX     .READ,4               BINARY FILE. READ IN               3F7A0440
READ   PZE     **,,EOB               RECORD JUST BACKSPACED.            3F7A0450
       PZE     BKRCD,,ERR          RECORD JUST BACKSPACED            (7)3F7A0460
       IORTN*  BUFADD,,**                                               3F7A0470
       CLA*    BUFADD                FROM INTERNAL LABEL, GET NUMBER    3F7A0480
       PAX     0,1                   OF PHYSICAL RECORDS IN THIS LOGICAL3F7A0490
BKRCD  TSX     .BSR,4                BINARY RECORD. BACKSPACE THIS      3F7A0500
       PZE     **,,*+1               NUMBER OF RECORDS.                 3F7A0510
       TIX     BKRCD,1,1                                                3F7A0520
       RETURN  .FBST.                                                   3F7A0530
OPEN   TSX     .OPEN,4                                                  3F7A0540
OPN    MON     **                                                       3F7A0550
       TRA     1,2                                                      3F7A0560
CHK    PAX     0,4                                                      3F7A0570
       SXD     CHECK,4                                                  3F7A0580
       CLA*    CLS                                                      3F7A0590
       PAC     0,4                                                      3F7A0600
CHECK  TXI     *+1,4,**                                                 3F7A0610
       TRA     1,2                                                      3F7A0620
BUFADD PZE     **                                                       3F7A0630
FLNM   LAC     CLS,4                 OBTAIN 10 CHARACTER FILE NAME      3F7A0640
       CAL     10,4                  FROM FCB AND PLACE IN MESSAGE.     3F7A0650
       ARS     12                                                       3F7A0660
       LDQ     BLNKS                                                    3F7A0670
       LGR     24                                                       3F7A0680
       CLA     9,4                                                      3F7A0690
       STO     MES1+5                                                   3F7A0700
       STQ     MES1+6                                                   3F7A0710
       TRA     1,2                                                      3F7A0720
BLNKS  BCI     1,.                                                      3F7A0730
IGNSOU TSX     FLNM,2                WRITE MESSAGE THAT BACKSPACE       3F7A0740
       CALL    .FOUT.(7MES1)         REQUEST IGNORED FOR SYSOU1.        3F7A0750
       RETURN  .FBST.                RETURN TO CALLER.                  3F7A0760
MES1   BCI     7,0BACKSPACE REQUEST IGNORED ON                          3F7A0770
ERR    TSX     FLNM,2                REDUNDANCY READING.                3F7A0780
       STO     E48MES+5              EXECUTION ERROR.                   3F7A0790
       STQ     E48MES+6                                                 3F7A0800
RERRXT CALL    .FXEM.(CODE1)                                            3F7A0810
       TRA     REED                  OPTIONAL EXIT. PROCESS RECORD.     3F7A0820
EOB    TSX     FLNM,2                END-OF-BUFFER EXIT READING.        3F7A0830
       STO     E49MES+5              EXECUTION ERROR.                   3F7A0840
       STQ     E49MES+6                                                 3F7A0850
REOBXT CALL    .FXEM.(CODE2)                                            3F7A0860
       TRA     .LXERR                NO OPTIONAL EXIT.                  3F7A0870
7MES1  PZE     MES1,,7                                                  3F7A0880
CODE1  PZE     48                                                       3F7A0890
ER48MS PZE     E48MES,,7                                                3F7A0900
ER48OP PZE     E48OMS,,4                                                3F7A0910
E48MES BCI     7,0PERMANENT READ REDUNDANCY                             3F7A0920
E48OMS BCI     4,0RECORD USED AS READ.                                  3F7A0930
CODE2  PZE     49                                                       3F7A0940
ER49MS PZE     E49MES,,7                                                3F7A0950
ER49OP PZE     NOOPXT,,7                                                3F7A0960
E49MES BCI     7,0END-OF-BUFFER EXIT READING                            3F7A0970
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED.              3F7A0980
       END                                                              3F7A0990
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FEFT              3F7B0000
$IBMAP FEFT    49                                                       3F7B0010
       TTL     FEFT/WRITE AN END-OF-FILE MARK ON DESIGNATED UNIT        3F7B0020
       REM                                                              3F7B0030
       REM     CALLING SEQUENCE IS CALL .FEFT. (ARG)                    3F7B0040
       REM     COMPILED FOR SOURCE STATEMENT END FILE N.                3F7B0050
       REM     ARG IS LOCATION OF PZE UNITXX WHERE XX IS                3F7B0060
       REM     LOGICAL UNIT NUMBER.                                     3F7B0070
       REM                                                              3F7B0080
.FEFT. SAVE    (2)I                                                     3F7B0090
       CLA*    3,4                   FIRST WORD OF FILE CONTROL BLOCK.  3F7B0100
       STA     CLS+1                 STORE IN IOCS                      3F7B0110
       STA     OPN+1                 CALLING SEQUENCES.                 3F7B0120
       PAC     0,4                   EXAMINE THIRD WORD                 3F7B0130
       LDI     2,4                   IN FILE CONTROL BLOCK              3F7B0140
       LFT     200000                FOR MONITOR CONTROL BIT.           3F7B0150
       TRA     NOWEF                 SYSTEM FILE. DO NOT WRITE EOF MARK.3F7B0160
       LDI     1,4                   GET SECOND WORD IN FCB.            3F7B0170
       LFT     003000                IS FILE INPUT.                     3F7B0180
       TRA     OUTFIL                NO. GO TO CLOSE WITH EOF WRITTEN.  3F7B0190
       LFT     040000                YES. IS IT CLOSED.                 3F7B0200
       TSX     CLS,2                 NO. CLOSE IT.                      3F7B0210
       SIL     001000                SET BITS IN FCB                    3F7B0220
       STI     1,4                   FOR OUTPUT.                        3F7B0230
       TRA     *+2                                                      3F7B0240
OUTFIL LNT     040000                IS FILE CLOSED.                    3F7B0250
       TSX     OPN,2                 YES. OPEN FILE.                    3F7B0260
CLOSE  TSX     CLS,2                 CLOSE FILE WITH EOF WRITTEN.       3F7B0270
       RIL     003000                                                   3F7B0280
       STI     1,4                                                      3F7B0290
       NOP                                                              3F7B0300
       NOP                                                              3F7B0310
       RETURN  .FEFT.                RETURN TO OBJECT PROGRAM.          3F7B0320
CLS    TSX     .CLOSE,4                                                 3F7B0330
       MZE     **                                                       3F7B0340
       LAC     CLS+1,4                                                  3F7B0350
       LDI     1,4                                                      3F7B0360
       TRA     1,2                                                      3F7B0370
NOWEF  CALL    .FOUT.(ARG)           EOF WRITE REQUEST IGNORED          3F7B0380
       REM                           FOR SYSTEM FILE.                   3F7B0390
       RETURN  .FEFT.                RETURN TO OBJECT PROGRAM.          3F7B0400
ARG    PZE     EFMES,,14                                                3F7B0410
OPN    TSX     .OPEN,4                                                  3F7B0420
       MON     **                                                       3F7B0430
       TRA     1,2                                                      3F7B0440
EFMES  BCI     9,0REQUEST TO WRITE EOF ON UNIT ASSIGNED AS SYSIN1,SYSOU 3F7B0450
       BCI     5,1, OR SYSPP1 HAS BEEN IGNORED.                         3F7B0460
       END                                                              3F7B0470
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FRWT              3F7C0000
$IBMAP FRWT    61                                                       3F7C0010
       TTL     FRWT/REWIND DESIGNATED UNIT                           (7)3F7C0020
       REM                                                              3F7C0030
       REM     CALLING SEQUENCE IS CALL .FRWT.(ARG)                     3F7C0040
       REM     COMPILED FOR SOURCE STATEMENT REWIND N.                  3F7C0050
       REM     ARG IS LOCATION OF PZE UNITXX WHERE XX IS                3F7C0060
       REM     LOGICAL UNIT NUMBER.                                     3F7C0070
       REM                                                              3F7C0080
.FRWT. SAVE    (2)I                                                     3F7C0090
       CLA*    3,4                   FIRST WORD OF FILE CONTROL BLOCK.  3F7C0100
       STA     CLSEFR+1              STORE IN IOCS CALLING SEQUENCES.   3F7C0110
       STA     OPN+1                                                    3F7C0120
       STA     NILCLS                                                (7)3F7C0130
       PAC     0,4                   EXAMINE THIRD WORD                 3F7C0140
       LDI     2,4                   IN FILE CONTROL BLOCK              3F7C0150
       LFT     200000                FOR MONITOR CONTROL BIT.           3F7C0160
       TRA     NOREW                 SYSTEM FILE. DO NOT REWIND.        3F7C0170
       LDI     1,4                                                   (7)3F7C0190
       LFT     003000                                                   3F7C0200
       TRA     WEOF                  PREVIOUS ACTIVITY OUTPUT.          3F7C0210
       LFT     040000                INPUT.  IS FILE OPEN...         (7)3F7C0211
       TRA     INCLS                 YES                             (7)3F7C0212
       SIL     001000                NO.  OPEN AFTER                 (7)3F7C0213
       STI     1,4                   SETTING IT TO OUTPUT            (7)3F7C0214
       TSX     OPN,2                 TO PREVENT BUFFERING.           (7)3F7C0215
       TSX     .CLOSE,4              NOW CLOSE (TO PERMIT TYPE       (7)3F7C0216
NILCLS MON     **                    SWITCH) WITH NO EOF AND NO REW. (7)3F7C0217
       TSX     SETIN,2               SET FILE TO INPUT               (7)3F7C0218
INCLS  TSX     CLSEFR,2              AND CLOSE WITH REWIND ONLY.     (7)3F7C0220
       RETURN  .FRWT.                REWIND. RETURN TO OBJECT PROGRAM.  3F7C0230
NOREW  CALL    .FOUT.(ARG)           REWIND IGNORED FOR SYSTEM FILE.    3F7C0240
       RETURN  .FRWT.                RETURN TO OBJECT PROGRAM           3F7C0250
ARG    PZE     RWMES,,13                                                3F7C0260
WEOF   LNT     040000                IS FILE CLOSED.                    3F7C0270
       TSX     OPN,2                 YES. OPEN FILE.                    3F7C0280
       TSX     CLSEFR,2              CLOSE WITH EOF AND REWIND.         3F7C0290
       TSX     SETIN,2               EXIT SETTING FILE TO INPUT.     (7)3F7C0300
       RETURN  .FRWT.                RETURN TO OBJECT PROGRAM.          3F7C0340
RWMES  BCI     9,0REQUEST TO REWIND UNIT ASSIGNED AS SYSIN1, SYSOU1,OR  3F7C0350
       BCI     4,SYSPP1 HAS BEEN IGNORED.                               3F7C0360
CLSEFR TSX     .CLOSE,4                                                 3F7C0370
       PTW     **                                                       3F7C0380
       TRA     1,2                                                      3F7C0390
OPN    TSX     .OPEN,4                                                  3F7C0400
       MON     **                                                       3F7C0410
       TRA     1,2                                                      3F7C0420
SETIN  LAC     OPN+1,4               ROUTINE TO RESET BITS 7 AND 8   (7)3F7C0430
       LDI     1,4                   IN 2ND WORD OF FCB, SETTING     (7)3F7C0431
       RIL     003000                THE FILE TO INPUT.              (7)3F7C0432
       STI     1,4                                                   (7)3F7C0433
       TRA     1,2                                                   (7)3F7C0434
       END                                                              3F7C0440
$*     7090/7094 IBLIB FORTRAN SYSTEM LIBRARY - FDMP                    3F7D0000
$IBMAP FDMP    650,()OK                                              $5$3F7D0010
       TTL     FDMP - FORTRAN DUMP MONITOR ROUTINE                      3F7D0020
       REM                                                              3F7D0030
       REM                                                              3F7D0040
       REM     CALLING SEQUENCES ARE                                    3F7D0050
       REM     CALL DUMP (A1,B1,F1,...,AN,BN,FN)                        3F7D0060
       REM     CALL PDUMP (A1,B1,F1,...,AN,BN,FN)                       3F7D0070
       REM     WHERE A AND B INDICATE LIMITS                            3F7D0080
       REM     OF CORE STORAGE TO BE DUMPED.                            3F7D0090
       REM     F INDICATES THE FORMAT DESIRED.                          3F7D0100
       REM                                                              3F7D0110
       ENTRY   DUMP                                                     3F7D0120
       ENTRY   PDUMP                                                    3F7D0130
*                                                                       3F7D0140
*                                                                       3F7D0150
*                                                                       3F7D0160
SIZE   EQU     84                                                       3F7D0170
 ORGDP BOOL    72431                                                    3F7D0180
IOXCOM EQU     450                                                      3F7D0190
(FDAMT EQU     IOXCOM+33                                                3F7D0200
SYSCOM EQU     64                                                       3F7D0210
SYSTCH EQU     SYSCOM+23                                                3F7D0220
.CHXSP EQU     IOXCOM+38                                                3F7D0230
SYSTWT EQU     SYSCOM+25                                                3F7D0240
 SAVL  EQU     -ORGDP                                                   3F7D0250
*                                                                       3F7D0260
 DUMP  STL     DP            SET DUMP FLAG                              3F7D0270
       TTR     *+2                                                      3F7D0280
 PDUMP STZ     DP            SET PDUMP FLAG                             3F7D0290
SAV    SAVEN   (4)                                                      3F7D0300
       SXA     LNKG,4                                                   3F7D0310
       SXD     TABL-18,1                                                3F7D0320
       SXD     TABL-17,2                                                3F7D0330
       SXD     TABL-16,4     SAVE                                       3F7D0340
       SXD     TABL-15,3     INDEX                                      3F7D0350
       SXD     TABL-14,5     REGISTERS                                  3F7D0360
       SXD     TABL-13,6                                                3F7D0370
       SXD     TABL-12,7                                                3F7D0380
       STO     TABL-2        SAVE AC (S,1-35)                           3F7D0390
       ARS     1                                                        3F7D0400
       SLW     TABL-3        SAVE Q AND P BITS                          3F7D0410
       STI     TABL-6        SAVE INDICATORS                            3F7D0420
       STQ     TABL-11       SAVE MQ                                    3F7D0430
       STZ     TABL-30       TESTED IN DUMP RECORD                      3F7D0440
       STZ     TABL-10                                                  3F7D0450
       STZ     TABL-33                                                  3F7D0460
       STZ     TABL-34                                                  3F7D0470
       CLA     RETLC                                                    3F7D0480
       STA     TABL-31       LOCATION OF RET ROUTINE                    3F7D0490
       CLA     0                                                        3F7D0500
       STZ     0                                                        3F7D0510
       TXH     0,,0          TEST IF IN TRAP MODE                       3F7D0520
       LTM                                                              3F7D0530
       LXA     0,2                                                      3F7D0540
       SXA     TABL-10,2                                                3F7D0550
       STO     0             RESTORE LOCATION 0                         3F7D0560
       ENK                                                              3F7D0570
       STQ     TABL-1        SAVE KEYS                                  3F7D0580
       AXT     3,1                                                      3F7D0590
       STZ     TABL-6,1                                                 3F7D0600
       XEC     GARBG,1       TABL-7 NON-ZERO IF OVERFLOW ON             3F7D0610
       STL     TABL-6,1      TABL-8 NON-ZERO IF IOT ON                  3F7D0620
 LDTIX TIX     *-3,1,1       TABL-9 NON-ZERO IF DCT ON                  3F7D0630
       TRA     LITS                                                     3F7D0640
       DCT                                                              3F7D0650
       IOT                                                              3F7D0660
       TNO     LDTIX                                                    3F7D0670
 GARBG BSS     0                                                        3F7D0680
 LITS  AXT     4,2                                                      3F7D0690
       STZ     TABL-18,2                                                3F7D0700
       OCT     476000200145  SLT--TABL-19 THRU TABL-22                  3F7D0710
       TRA     *+2           NON-ZERO IF SENSE                          3F7D0720
       STL     TABL-18,2     LIGHTS 1,2,3,4 ON.                         3F7D0730
       TIX     LITS+1,2,1                                               3F7D0740
 SSWT  AXT     6,1                                                      3F7D0750
       STZ     TABL-22,1                                                3F7D0760
       OCT     076000100167  PSE--TABL-23 THRU TABL-28                  3F7D0770
       TRA     *+2           NON-ZERO IF SENSE                          3F7D0780
       STL     TABL-22,1     SWITCHES 1,2,3,4,5,6 ON                    3F7D0790
       TIX     SSWT+1,1,1                                               3F7D0800
       LDC     TABL-16,4                                                3F7D0810
       PXA     0,4                                                      3F7D0820
       STA     TABL-29       LOCATION OF -CALL- TO DUMP                 3F7D0830
       ADD     =3                                                       3F7D0840
       STA     IORP+2        LOCATION OF FIRST ARGUMENT                 3F7D0850
       STA     CPYP2+1                                                  3F7D0860
       STA     CPYDH2+1                                                 3F7D0870
       SUB     =1                                                       3F7D0880
       STA     FRMAT+1                                                  3F7D0890
       SUB     =1                                                       3F7D0900
       STA     *+1           LOCATION OF WORD WITH NO.                  3F7D0910
       CLA     **            OF ARGUMENTS IN DECREMENT                  3F7D0920
       PDX     0,4                                                      3F7D0930
       TXL     *+2,4,SIZE                                               3F7D0940
       LXD     *-1,4                                                    3F7D0950
       SXD     IORP+2,4                                                 3F7D0960
       SXD     CPYP2+1,4                                                3F7D0970
       SXD     CPYDH2+1,4                                               3F7D0980
       SXA     TABL-30,4     SAVE NO. ARGS.                             3F7D0990
       SXA     FRMAT,4                                                  3F7D1000
 FRMAT AXT     **,1          THIS SECTION TESTS FOR                     3F7D1010
       AXC     **,2          FORMAT STATEMENT GREATER                   3F7D1020
       TXL     THRU,1,2      THAN 3. IF GREATER, THE                    3F7D1030
       LDI     3,2           CONTENTS OF CELL IN                        3F7D1040
       RFT     77774         ADDRESS OF ARGUMENT IS                     3F7D1050
       TRA     *+3           SAVED IN DECREMENT OF                      3F7D1060
 MORE  TXI     *+1,2,-3      FORMAT STATEMENT.                          3F7D1070
       TXI     FRMAT+2,1,-3                                             3F7D1080
       CLA*    3,2                                                      3F7D1090
       ALS     18                                                       3F7D1100
       STD     3,2                                                      3F7D1110
       TRA     MORE                                                     3F7D1120
THRU   XEC     .DFOUT        UNBUFFER SYSOU1 IF FOUT IS IN CORE      $5$3F7D1130
*                                                                       3F7D1140
*                                                                       3F7D1150
*              THIS SECTION SAVES UPPER CORE, PANEL, AND ARGUMENTS      3F7D1160
*              READS THE DUMP RECORD INTO THAT                          3F7D1170
*              AREA. CONTROL IS TRANSFERRED TO                          3F7D1180
*              DUMP RECORD IF I-O IS SUCCESSFUL.                        3F7D1190
*                                                                       3F7D1200
*                                                                       3F7D1210
       LDI     SYSJOB        SAVE PRESENT SYSJOB                     $5$3F7D1211
       STI     SVSJOB                                                $5$3F7D1212
       SIL     000001        SET 'NOGO' BIT ON IN CASE               $5$3F7D1213
       STI     SYSJOB        DUMP IS UNSECCESSFUL                    $5$3F7D1214
       LAC     SYSUNI,4                                                 3F7D1220
       CLA     SYSOU1,4                                                 3F7D1230
       STO     SYUCB                                                    3F7D1240
       STL     TABL-35       SYSOU1-HYPER(7909)                         3F7D1250
       LDI*    SYUCB                                                    3F7D1260
       LNT     020000                                                   3F7D1270
       STZ     TABL-35       SYSOU1-TAPE(7607)                          3F7D1280
       LAC     SYSUNI,4                                                 3F7D1290
       CLA     SYSUT4,4                                                 3F7D1300
       STO     UT4                                                      3F7D1310
       ANA     MASK3                                                    3F7D1320
       ARS     6                                                        3F7D1330
       ORS     AA+4          HA2                                        3F7D1340
       LDI*    UT4                                                      3F7D1350
       STL     TABL-32                                                  3F7D1360
       STL     TABL-36                                                  3F7D1370
       LFT     020000                                                   3F7D1380
       TRA     *+3           7909 CHANNEL---DISK                        3F7D1390
       STZ     TABL-32       7607 CHANNEL---TAPE                        3F7D1400
       TRA     TSXRW                                                    3F7D1410
       LFT     000100                                                   3F7D1420
       TRA     *+4           DISK                                       3F7D1430
       AXT     34,2          HYPER                                      3F7D1440
       SXD     RET+4,2                                                  3F7D1450
       TRA     TSXRW                                                    3F7D1460
       STZ     TABL-36                                                  3F7D1470
       LNT     000040                                                   3F7D1480
       TRA     *+3                                                      3F7D1490
       CAL     =1                                                       3F7D1500
       ORS     AA+4                                                     3F7D1510
       LDC     SYSUNI,4                                                 3F7D1520
       SXD     *+2,4                                                    3F7D1530
       LAC     SYSUNI,4                                                 3F7D1540
       TXI     *+1,4,**                                                 3F7D1550
       CLA     SYSUT4,4      DISK LIMITS                                3F7D1560
       SSP                                                              3F7D1570
       STA     TABL-33       FIRST TRACK ON THIS UNIT                   3F7D1580
       ARS     18                                                       3F7D1590
       STA     TABL-34       LAST TRACK ON THIS UNIT                    3F7D1600
       SUB     TABL-33                                                  3F7D1610
       PAX     0,2                                                      3F7D1620
       TXL     EROR,2,11     TOO FEW TRACKS ATTACHED TO THIS UNIT       3F7D1630
       CLA     TABL-34                                                  3F7D1640
       SUB     =11                                                      3F7D1650
       STA     TABL-33       ADDRESS OF FIRST TRACK TO BE USED          3F7D1660
       ADD     =6                                                       3F7D1670
       STA     TABL-34       ADDRESS OF TRACK FOR SECOND SAVE           3F7D1680
*              ROUTINE TO WRITE ON SYSUT4                               3F7D1690
TSXRW  TSX     IOXRW,4                                                  3F7D1700
       MZE     UT4,,IORP     TAPE (729)                                 3F7D1710
       PZE     PRTMS,,PRTMS                                             3F7D1720
       MZE     CPYP,6,TABL-33 DISK                                      3F7D1730
       MZE     UT4,,CPYDH1   HYPERTAPE                                  3F7D1740
       TSX     IOXRW,4                                                  3F7D1750
       MZE     UT4,,IORP+1                                              3F7D1760
       PZE     PRTMS,,PRTMS                                             3F7D1770
       MZE     CPYP2,1,TABL-34                                          3F7D1780
       MZE     UT4,,CPYDH2                                              3F7D1790
*                                                                       3F7D1800
*              ROUTINE TO POSITION TAPE AND READ DUMP RECORD            3F7D1810
*                                                                       3F7D1820
       LDC     SYSUBC,1      WAIT UNTIL ALL CHANNEL                  $5$3F7D1830
WAIT   TXI     *+1,1,1       ACTIVITY CEASES                         $5$3F7D1840
       ZET*    .CHXSP                                                $5$3F7D1850
       TRA     *-1                                                   $5$3F7D1860
       TXH     WAIT,1,0                                              $5$3F7D1870
       STL     POSSW                                                    3F7D1920
       CAL     .FDPOS        USE IBJOB COMMUNICATION                    3F7D1960
       ANA     UCBMSK        WORD TO LOCATE AND READ                    3F7D1970
       ARS     15            IN DUMP RECORD.                            3F7D1980
       STA     POS1                                                     3F7D1990
       STA     POS2                                                     3F7D2000
       LAC     SYSUNI,2                                                 3F7D2010
       TXI     *+1,2,1                                                  3F7D2020
POS1   CLA     **,2                                                     3F7D2030
       PAX     0,2           INITIALIZE SYSLDR FOR                   $5$3F7D2031
       SXD     SYSLDR,2      CURRENT SYSTEM UNIT                     $5$3F7D2032
       PAC     0,2                                                      3F7D2040
       LDI     0,2                                                      3F7D2050
       STO     SYSTAP        L(UCB) FOR CURRENT SYSTEM UNIT             3F7D2060
       CLA     .FDPOS        DEVICE TEST.                               3F7D2070
       TMI     DISK          -0 DISK, +0 TAPE, +1 HYPERTAPE.            3F7D2080
       ALS     1                                                        3F7D2090
       PBT                                                              3F7D2100
       TRA     TAPE                                                     3F7D2110
       TRA     HTAPE                                                    3F7D2120
TAPE   ARS     1             TAPE AND HYPERTAPE.                        3F7D2130
       ANA     POMSK         MASK OUT TAG AND PREFIX.                   3F7D2140
       SLW     POTMP1        SAVE DESIRED TAPE POSITION.                3F7D2150
POLAC  LAC     SYSTAP,2                                                 3F7D2160
       CAL     2,2           CURRENT TAPE POSITION                      3F7D2170
       ANA     POMSK                                                    3F7D2180
       SUB     POTMP1        DESIRED TAPE POSITION                      3F7D2190
       TNZ     *+4           IS POSITIONING REQUIRED.                   3F7D2200
       NZT     1,2           APPARENTLY NOT.  CHECK FURTHER.            3F7D2210
       TRA     TAPES         NO.  READ DUMP RECORD.                     3F7D2220
       TRA     POLAC         POSSIBLY.                                  3F7D2230
       PDX     0,2           IS THERE A FILE DIFFERENCE.                3F7D2240
       TXL     POREC,2,0     NO. CHECK FOR RECORD DIFFERENCE.           3F7D2250
POFOB  TMI     POFOF         IF -, POSITION FORWARD N FILES.            3F7D2260
POBOF  TSX     .NDSEL,4      BACKSPACE ONE FILE.                        3F7D2270
       PZE     SYSTAP,,6                                                3F7D2280
       TIX     POBOF,2,1                                                3F7D2290
       TRA     POLAC         POSITION RECORD.                           3F7D2300
POFEOF TNX     POLAC,2,1     FORWARD SPACE N FILES.                     3F7D2310
POFOF  TSX     IOXTP,4       FORWARD SPACE ONE FILE.                    3F7D2320
       PZE     SYSTAP,,POFF                                             3F7D2330
       PZE     POFEOF,,POFOF                                            3F7D2340
       TRA     TAPES         IF APPROPRIATELY POSITIONED, EXIT.         3F7D2350
POREC  PAX     0,2           PROB. RIGHT FILE.  GET RECORD DIFFERENCE.  3F7D2360
       TXH     POFL1,2,16384 TEST FOR NEGATIVE RECORD COUNT.            3F7D2370
       TMI     POFOR         IF-, FORWARD SPACE N RECORDS.              3F7D2380
       TSX     .NDSEL,4      BACKSPACE ONE RECORD.                      3F7D2390
       PZE     SYSTAP,,5                                                3F7D2400
       TIX     *-2,2,1               DO N BACKSPACES.                   3F7D2410
       TRA     POLAC         GO TO TEST AND EXIT.                       3F7D2420
POFL1  AXT     1,2           SET FOR ONE FILE.                          3F7D2430
       TRA     POFOB         AND GO BACK TO FILE POSITION.              3F7D2440
POFOR  TSX     IOXTP,4       POSITION FORWARD ONE RECORD.               3F7D2450
       PZE     SYSTAP,,PORF                                             3F7D2460
       PZE     POLAC,,*+1                                               3F7D2470
       TIX     POFOR,2,1     DO N RECORDS.                              3F7D2480
       TRA     POLAC                                                    3F7D2490
POFF   IOCPN   **,,-1        POSITION FORWARD ONE FILE.                 3F7D2540
       TCH     *-1                                                      3F7D2550
PORF   IORTN   **,,-1        POSITION FORWARD ONE RECORD.               3F7D2560
POTMP1 PZE     **                                                       3F7D2580
POMSK  OCT     077777077777  FILE-RECORD POSITION MASK.                 3F7D2600
POSSW  PZE     **                                                       3F7D2610
DISK   STD     SYSTCH        LOC. OF RECORD ON DISK, FOR READ           3F7D2620
TAPES  LAC     SYSUNI,4                                                 3F7D2630
       TXI     *+1,4,1                                                  3F7D2640
POS2   CAL     **,4          ADDRESS OF UCB FOR UNIT ASSIGNED.          3F7D2650
       PAC     0,4                                                      3F7D2660
       LDI     0,4           PLACE FIRST WORD OF UCB IN SI              3F7D2670
       RIL     760000        MASK OUT EVERYTHING UP TO                  3F7D2680
       PIA                   CHANNEL BIT.                               3F7D2690
       ARS     9                                                        3F7D2700
       PDX     0,1                                                      3F7D2710
       TXI     *+1,1,-1                                                 3F7D2720
       SXA     DISK2,1                                                  3F7D2730
       LXA     .CHXSP,1      DELAY UNTIL CHANNEL                        3F7D2740
       SXA     DISK2+1,1     ACTIVITY CEASES.                           3F7D2750
       AXT     ORGDP,1       INITIALIZE RETURN FROM                  $5$3F7D2760
       SXA     SYSTRA,1      SYSLDR.                                    3F7D2770
DISK2  AXC     **,4                                                     3F7D2780
       ZET     **,4                                                     3F7D2790
       TRA     *-1                                                      3F7D2800
LOAD   TSX     SYSLDR,4      USE SYSLDR TO BRING IN                     3F7D2810
*      TRA     ORGDP         DUMP RECORD. RETURN TO RET.             $5$3F7D2820
HTAPE  CLA     POFOFH                                                   3F7D2830
       STO     POFOF                                                    3F7D2840
       STO     POFOR                                                    3F7D2850
       CLA     NOP                                                      3F7D2860
       STO     POFOR+2                                                  3F7D2870
       AXT     34,4                                                     3F7D2880
       SXD     POFL1-3,4                                                3F7D2890
       TXI     *+1,4,1                                                  3F7D2900
       SXD     POFOF-4,4                                                3F7D2910
       TXI     *+1,4,1                                                  3F7D2920
       SXD     POFOR+1,4                                                3F7D2930
       TXI     *+1,4,1                                                  3F7D2940
       SXD     POFOF+1,4                                                3F7D2950
       CLA     .FDPOS                                                   3F7D2960
       TRA     TAPE+1                                                   3F7D2970
POFOFH TSX     .NDSEL,4                                                 3F7D2980
NOP    NOP                                                              3F7D2990
SYSTAP PZE     **                                                       3F7D3000
UCBMSK OCT     000000700000                                          $5$3F7D3010
SVSJOB PZE     **            SYSJOB                                  $5$3F7D3020
*                                                                       3F7D3030
*                                                                       3F7D3040
*              THIS SECTION IS ENTERED AFTER                            3F7D3050
*              DUMP RECORD IS EXECUTED AND CORE                         3F7D3060
*              HAS BEEN RESTORED. THE PANEL, ETC. ARE                   3F7D3070
*              RESTORED AND APPROPRIATE RETURN MADE                     3F7D3080
*                                                                       3F7D3090
*                                                                       3F7D3100
 RET   LAC     UT4,1                                                    3F7D3110
       ZET     1,1                                                      3F7D3120
       TRA     *-1                                                      3F7D3130
       TSX     .NDSEL,4      REPOSITION UTILITY TAPE                    3F7D3140
       PZE     UT4,,5        TO INITIAL POSITION.                       3F7D3150
       LDI     SVSJOB        RESTORE SYSJOB                          $5$3F7D3151
       STI     SYSJOB                                                $5$3F7D3152
       LXA     TABL-30,1     NO. RESTORE                                3F7D3160
       LAC     TABL-29,2                                                3F7D3170
       TXI     *+1,2,-2                                                 3F7D3180
 MMORE TXL     DONE,1,2                                                 3F7D3190
       LDI     3,2                                                      3F7D3200
       RIL     77777         RESTORE DECREMENTS OF                      3F7D3210
       STI     3,2           FORMAT STATEMENTS                          3F7D3220
       TXI     *+1,2,-3      WITH ZEROES.                               3F7D3230
       TXI     MMORE,1,-3                                               3F7D3240
 DONE  LDI     TABL-6        RESTORE SENSE INDICATORS                   3F7D3250
       NZT     TABL-8        RESTORE IO CHECK INDICATOR                 3F7D3260
       TRA     *+4                                                      3F7D3270
       AXT     0,1                                                      3F7D3280
       XEC*    .RCHX         TURN ON I/O CHECK LIGHT                    3F7D3290
       TRA     *+3                                                      3F7D3300
       IOT                   TURN OFF IO CHECK LIGHT                    3F7D3310
       NOP                                                              3F7D3320
       NZT     TABL-9                                                   3F7D3330
       TRA     *+4                                                      3F7D3340
       CLA     =1                                                       3F7D3350
       DVP     =0            TURN ON DIVIDE CHECK LIGHT                 3F7D3360
       TRA     *+3                                                      3F7D3370
       DCT                   TURN OFF DIVIDE CHECK LIGHT                3F7D3380
       NOP                                                              3F7D3390
       AXT     4,2                                                      3F7D3400
 HERE1 NZT     TABL-18,2                                                3F7D3410
       TRA     *+3                                                      3F7D3420
       OCT     076000200145  SLN--TURN ON SENSE LIGHTS                  3F7D3430
       TRA     *+3                                                      3F7D3440
       OCT     476000200145  SLT--TURN OFF SENSE LIGHTS                 3F7D3450
       NOP                                                              3F7D3460
       TIX     HERE1,2,1                                                3F7D3470
       LXD     TABL-12,7                                                3F7D3480
       LXD     TABL-13,6                                                3F7D3490
       LXD     TABL-14,5     RESTORE                                    3F7D3500
       LXD     TABL-15,3     INDEX                                      3F7D3510
       LXD     TABL-16,4     REGISTERS                                  3F7D3520
       LXD     TABL-17,2                                                3F7D3530
       LXD     TABL-18,1                                                3F7D3540
       LDQ     TABL-2                                                   3F7D3550
       CAL     TABL-3        RESTORE AC                                 3F7D3560
       ARS     34                                                       3F7D3570
       LLS     35                                                       3F7D3580
       NZT     TABL-7                                                   3F7D3590
       TOV     *+1           TURN OFF OVERFLOW INDICATOR                3F7D3600
       ZET     TABL-10       RESTORE TRAPS IF NECESSARY.                3F7D3610
       ETM                                                              3F7D3620
       LDQ     TABL-11       RESTORE MQ                                 3F7D3630
       ZET     DP                                                       3F7D3640
       TRA     .LXERR              EXECUTION ERROR EXIT             (10)3F7D3650
       RETURN  SAV           RETURN TO CALLER                           3F7D3660
*                                                                       3F7D3670
*                                                                       3F7D3680
*                                                                       3F7D3690
*                                                                       3F7D3700
*                                                                       3F7D3710
*                                                                       3F7D3720
*                                                                       3F7D3730
*                                                                       3F7D3740
*                                                                       3F7D3750
*                                                                       3F7D3760
*                                                                       3F7D3770
 IORP  IORT    ORGDP,,SAVL   SAVE UPPER CORE                            3F7D3780
       IOCP    TABL-38,,38                                              3F7D3790
       IORT    **,,**        SAVE ARGUMENTS                             3F7D3800
*                                                                       3F7D3810
*                                                                       3F7D3820
*              CONSTANTS                                                3F7D3830
 UT4   PZE     **                                                       3F7D3840
 SYUCB PZE     0                                                        3F7D3850
 CODEN PZE     50                                                       3F7D3880
ER50MS PZE     E50MES,,10                                               3F7D3890
ER50OP PZE     NOOPXT,,7                                                3F7D3900
 DP    PZE     0                                                        3F7D3910
TABLJS PZE     .JLIN                                                    3F7D3911
TABLSF PZE     SYSFAZ                                                   3F7D3912
TABL   BES     36                                                       3F7D3920
 RETLC PZE     RET                                                      3F7D3930
 ISIT  NOP                                                              3F7D3940
 9IOSL PZE     CTLR,,SE                                                 3F7D3950
 XLIM  PZE     0                                                        3F7D3960
 DVTN  DVTN    ,,,                                                      3F7D3970
9IOSLI PZE     0                                                        3F7D3980
 NUM   PZE     0                                                        3F7D3990
 NUMX  PZE     0                                                        3F7D4000
 SE    PAC     0,2           SEL(+)                                     3F7D4010
       TMI     SM                                                       3F7D4020
       CLA     1,2                                                      3F7D4030
       STA*    .RCHX                                                    3F7D4040
       XEC*    .RCHX                                                    3F7D4050
       TRA     1,4           RETURN TO IOEX                             3F7D4060
 SM    STZ     1,2           SEL(-)                                     3F7D4070
       STI     9IOSLI                                                   3F7D4080
       TRA     1,4           RETURN TO IOEX                             3F7D4090
*                                                                       3F7D4100
*                                                                       3F7D4110
CPYP   CPYD    ORGDP,,465                                               3F7D4120
       TCH     SYSTWT                                                   3F7D4130
       CPYD    ORGDP+465,,465                                           3F7D4140
       TCH     SYSTWT                                                   3F7D4150
       CPYD    ORGDP+930,,465                                           3F7D4160
       TCH     SYSTWT                                                   3F7D4170
       CPYD    ORGDP+1395,,465                                          3F7D4180
       TCH     SYSTWT                                                   3F7D4190
       CPYD    ORGDP+1860,,465                                          3F7D4200
       TCH     SYSTWT                                                   3F7D4210
       CPYD    ORGDP+2325,,465                                          3F7D4220
       TCH     SYSTWT                                                   3F7D4230
CPYP2  CPYP    TABL-38,,38                                              3F7D4240
       CPYD    **,,**                                                   3F7D4250
       TCH     SYSTWT                                                   3F7D4260
*                                                                       3F7D4270
PRTMS  CALL    .FXEM.(CODEN)                                            3F7D4280
       TRA     .LXERR                                                   3F7D4290
PRTMSD TSX     IOXRW,4       OFF LINE MESSAGE                           3F7D4300
       MZE     SYUCB,1,MSD                                              3F7D4310
       PZE     *+3,,*+3                                                 3F7D4320
       NOP                                                              3F7D4330
       MZE     0,,0                                                     3F7D4340
       TRA     .LXERR                                                   3F7D4350
PRTMSH AXT     MSH,4                                                    3F7D4360
       SXD     PRTMSD+1,4                                               3F7D4370
       TRA     PRTMSD                                                   3F7D4380
MSH    IOCP    MESSG,,5                                                 3F7D4390
       IOCT    MESSGH,,3                                                3F7D4400
ERORH  CLA     MESGH                                                    3F7D4410
       STO     MESSGH                                                   3F7D4420
       CLA     MESGH+1                                                  3F7D4430
       STO     MESSGH+1                                                 3F7D4440
       TRA     PRTMSH                                                   3F7D4450
MESGH  BCI     2,EWA FLAG ON-                                           3F7D4460
 MSD   IOCP    MESSG,,5                                                 3F7D4470
       IOCT    MESSGD,,3                                                3F7D4480
MESSG  BCI     5,1EXECUTION TERMINATED BY DUMP-                         3F7D4490
MESSGD BCI     3,DISK ERROR.                                            3F7D4500
MESSGH BCI     3,UNUSUAL END-SYSUT4                                     3F7D4510
 EROR  TSX     IOXRW,4                                                  3F7D4520
       MZE     SYUCB,1,DEROR                                            3F7D4530
       PZE     *+3,,*+3                                                 3F7D4540
       NOP                                                              3F7D4550
       MZE     0,,0                                                     3F7D4560
       TRA     .LXERR                                                   3F7D4570
 DEROR IOCP    MESSG,,5                                                 3F7D4580
       IOCT    DERORM,,7                                                3F7D4590
DERORM BCI     7,LESS THAN 12 TRACKS ATTACHED TO SYSUT4.                3F7D4600
E50MES BCI ,0TAPE REDUNDANCY ON SYSUT4 ATTEMPTING TO WRITE MEMORY SAVE  3F7D4610
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED               3F7D4620
*                                                                       3F7D4630
*                                                                       3F7D4640
*              THIS ROUTINE PERFORMS AN IOEX                            3F7D4650
*              WRITE ON TAPE OR DISK                                    3F7D4660
*                                                                       3F7D4670
IOXRW  STZ     POSSW                                                    3F7D4680
       CAL     3,4                                                      3F7D4690
       ERA     ISIT                                                     3F7D4700
       TNZ     *+4                                                      3F7D4710
       NZT     TABL-35       SYSOU1                                     3F7D4720
       TRA     IOXTP         TAPE                                       3F7D4730
       TRA     IOXHYP        HYPER                                      3F7D4740
       NZT     TABL-32                                                  3F7D4750
       TRA     IOXTP                                                    3F7D4770
       NZT     TABL-36       DISK OR HYPER                              3F7D4780
       TRA     IOXDSK                                                   3F7D4790
       TRA     IOXHYP                                                   3F7D4800
 IOXTP SXA     IOXS4,4                                                  3F7D4810
       CLA     2,4                                                      3F7D4820
       STA     IOXEF         SET EOF EXIT                               3F7D4830
       ARS     18                                                       3F7D4840
       STA     IOXER         SET PERM. REDUNDANCY EXIT                  3F7D4850
       CAL     1,4           GET FIRST WORD OF CALL SEQ.                3F7D4860
       STT     IOXSLL        SAVE MODE FOR SELECT                       3F7D4870
       STP     IOXSLL        SAVE PREFIX FOR SELECT TYPE                3F7D4880
       STA     IOXND         PUT LOC IN ACTIVE CALL SEQ.                3F7D4890
       STA     *+1           SET TO PICK UP UCB                         3F7D4900
       LAC     **,4          -L(UCB)                                    3F7D4910
       ARS     18            I/O COMMANDS LOC TO ADDRESS                3F7D4920
       STA     IOXSLL        PUT IN SELECT WORD                         3F7D4930
       CLA     IOXSLL        GET SELECT WORD                            3F7D4940
       ZET     1,4           TEST FOR UNIT IN USE                       3F7D4950
       TRA     *-1           WAIT TILL THROUGH                          3F7D4960
       STO     1,4           SIGNED CONTROL WORD TO UCB WORD2           3F7D4970
       STZ     IOXIN         SET IN OPERATION WORD ON                   3F7D4980
       TSX     .ACTV,4                                                  3F7D4990
 IOXND PZE     **            UNIT                                       3F7D5000
       LDI     L(0)                                                     3F7D5010
       NZT     IOXIN         TEST FOR REQUEST COMPLETE                  3F7D5020
       TRA     *-1           NOT DONE, WAIT                             3F7D5030
       LDI     IOXIN         PICK UP BITS SET BY IOXSEL(-)              3F7D5040
 IOXS4 AXT     **,4          SET FOR EXIT                               3F7D5050
       LFT     200000        TEST EOF, EOT                              3F7D5060
 IOXEF TRA     **            EOF EXIT                                   3F7D5070
       LFT     100000        TEST FOR PERM. RTT                         3F7D5080
 IOXER TRA     **            YES, ERROR EXIT                            3F7D5090
       NZT     POSSW                                                    3F7D5100
       TRA     5,4           NORMAL RETURN                              3F7D5110
       TRA     3,4                                                      3F7D5120
*                                                                       3F7D5130
*                                                                       3F7D5140
IOXSLL PZE     0,,IOXSEL     LOCATION OF SELECT ROUTINE                 3F7D5150
 IOXMD PZE     **            MODE SWITCH                                3F7D5160
 IOXIN PZE     0                                                        3F7D5170
 L(0)  DEC     0                                                        3F7D5180
*                                                                       3F7D5190
*              IOXSEL--ENTERED TWICE BY IOEX                            3F7D5200
*                                                                       3F7D5210
IOXSEL SXA     IOXSS4,4      SAVE IR4                                   3F7D5220
       PAC     0,4           -L(UCB)                                    3F7D5230
       TMI     IOXPST        SEL(-) OR POSTING ENTRY                    3F7D5240
       CLA     0,4           UCB WORD 1                                 3F7D5250
       PDX     0,2           UNIT TO IR 2                               3F7D5260
       CLA     1,4           UCB WORD 2                                 3F7D5270
       STA*    .RCHX         STORE LOC TO RCHX FROM                     3F7D5280
       STT     IOXMD                                                    3F7D5290
       ZET     IOXMD         CHECK MODE                                 3F7D5291
       STZ     SYSJOB+2            BCD. RESET MODSW.                    3F7D5292
       NZT     IOXMD                                                    3F7D5300
       TXI     *+1,2,16      BINARY, BUMP TO BINARY MODE                3F7D5310
       TMI     IOXWR         WRITE                                      3F7D5320
       SXA     *+2,2         PLACE SELECT ADDRESS                       3F7D5330
       ZET*    SYSJOB+1      SKIP SELECT IF DCS.                        3F7D5331
       RDS     **            SELECT.                                    3F7D5340
       XEC*    .RCHX         RESET AND LOAD CHANNEL.                    3F7D5350
IOXSS4 AXT     **,4          RESTORE IR 4                               3F7D5360
       TRA     1,4           AND EXIT IOXSEL                            3F7D5370
IOXWR  SXA     *+2,2         PLACE SELECT ADDRESS.                      3F7D5380
       ZET*    SYSJOB+1      SKIP SELCT IF DCS.                         3F7D5381
       WRS     **            WRITE SELECT.                              3F7D5390
       XEC*    .RCHX         SELECT.                                    3F7D5400
       TRA     IOXSS4        GO EXIT.                                   3F7D5410
IOXPST STI     IOXIN         POST TIME, SAVE ERROR FLAGS, IF ANY        3F7D5420
       STL     IOXIN         SET IN OPERATION WORD OFF                  3F7D5430
       STZ     1,4           SET UCB WORD 2 ZERO                        3F7D5440
       TRA     IOXSS4        GO EXIT                                    3F7D5450
*                                                                       3F7D5460
IOXDSK SXA     IOXD,4                                                   3F7D5470
       CLA     3,4                                                      3F7D5480
       STA     CTLR+2                                                   3F7D5490
       STT     NUMX                                                     3F7D5500
       ARS     18                                                       3F7D5510
       STA     *+5                                                      3F7D5520
       CLA     NUMX                                                     3F7D5530
       ALS     3                                                        3F7D5540
       STD     NUM                                                      3F7D5550
       LAC     UT4,1                                                    3F7D5560
       CLA     **            TRACK ADDRESS                              3F7D5570
       STA     XLIM                                                     3F7D5580
 A     ZET     1,1           UCB 2 FREE                                 3F7D5590
       TRA     *-1                                                      3F7D5600
       STA     3,1                                                      3F7D5610
       CLS     2,1                                                      3F7D5620
       STO     2,1                                                      3F7D5630
       TSX     .ACTV,4                                                  3F7D5640
       PZE     UT4                                                      3F7D5650
 AA    CLA     XLIM                                                     3F7D5660
       TSX     .DECVA,4                                                 3F7D5670
       LAC     UT4,4                                                    3F7D5680
       TSX     (FDAMT,2                                                 3F7D5690
       OCT     000000000006                                             3F7D5700
       PZE     DVTN                                                     3F7D5710
       CLA     9IOSL                                                    3F7D5720
       STO     1,1                                                      3F7D5730
       TSX     .ACTV,4                                                  3F7D5740
       MZE     UT4                                                      3F7D5750
       ZET     1,1                                                      3F7D5760
       TRA     *-1                                                      3F7D5770
       LDI     9IOSLI                                                   3F7D5780
       LFT     001000        WAS IT UNUSUAL END.                        3F7D5790
       TRA     PRTMSD        YES. WRITE ERROR MESSAGE OFF-LINE.         3F7D5800
       LXD     NUM,2                                                    3F7D5810
       TNX     IOXD,2,1      TEST FOR ALL I/O COMPLETED                 3F7D5820
       SXD     NUM,2                                                    3F7D5830
       LXA     CTLR+2,2                                                 3F7D5840
       TXI     *+1,2,2                                                  3F7D5850
       SXA     CTLR+2,2                                                 3F7D5860
       LXA     XLIM,4                                                   3F7D5870
       TXI     *+1,4,1                                                  3F7D5880
       SXA     XLIM,4        UPDATE TRACK ADDRESS                       3F7D5890
       PXA     0,4                                                      3F7D5900
       LRS     35                                                       3F7D5910
       DVP     =40                                                      3F7D5920
       TNZ     AA            NO SEEK REQUIRED                           3F7D5930
       PXA     0,4                                                      3F7D5940
       TRA     A+2                                                      3F7D5950
 IOXD  AXT     **,4                                                     3F7D5960
       TRA     5,4           NORMAL RETURN                              3F7D5970
 CTLR  SMS*    AA+4                                                     3F7D5980
       CTLW    DVTN                                                     3F7D5990
       TCH     **            UPDATED EACH TIME.                         3F7D6000
*                                                                       3F7D6010
IOXHYP SXA     IOXH4,4                                                  3F7D6020
       SXA     IOXH4+1,2                                                3F7D6030
       SXA     IOXH4+2,1                                                3F7D6040
       CAL     4,4                                                      3F7D6050
       STA     IOXHND                                                   3F7D6060
       STT     IOXMD                                                    3F7D6070
       AXT     6,2                                                      3F7D6080
       ZET     IOXMD                                                    3F7D6090
       TXI     *+1,2,16      BUMP TO BCD MODE                           3F7D6100
       SXA     CTLWH,2                                                  3F7D6110
       STP     IOXSLH                                                   3F7D6120
       STA     *+1                                                      3F7D6130
       LAC     **,1                                                     3F7D6140
       LDI     0,1                                                      3F7D6150
       RFT     400000                                                   3F7D6160
       TRA     ERORH         END WARNING AREA MESSAGE                   3F7D6170
       ARS     18                                                       3F7D6180
       STA     CTLWH+2                                                  3F7D6190
       LNT     000040                                                   3F7D6200
       TRA     *+3                                                      3F7D6210
       CAL     =1                                                       3F7D6220
       ORS     CTLWH                                                    3F7D6230
       CLA     MASK1                                                    3F7D6240
       ANS     HSEL                                                     3F7D6250
       CLA     0,1                                                      3F7D6260
       ANA     MASK2                                                    3F7D6270
       ORS     HSEL          PLACE UNIT NO. IN 3RD BYTE OF COMMAND      3F7D6280
       CLA     IOXSLH                                                   3F7D6290
       ZET     1,1                                                      3F7D6300
       TRA     *-1                                                      3F7D6310
       STO     1,1                                                      3F7D6320
       TSX     .ACTV,4                                                  3F7D6330
IOXHND PZE     **                                                       3F7D6340
       ZET     1,1                                                      3F7D6350
       TRA     *-1                                                      3F7D6360
       LDI     IOSLIH                                                   3F7D6370
       LFT     001000                                                   3F7D6380
       TRA     PRTMSH        ERROR MESSAGE                              3F7D6390
IOXH4  AXT     **,4                                                     3F7D6400
       AXT     **,2                                                     3F7D6410
       AXT     **,1                                                     3F7D6420
       TRA     5,4           NORMAL RETURN                              3F7D6430
*                                                                       3F7D6440
SEH    PAC     0,2                                                      3F7D6450
       TMI     SMH           TRA TO SEL(-)                              3F7D6460
       CLA     1,2                                                      3F7D6470
       STA*    .RCHX                                                    3F7D6480
       XEC*    .RCHX                                                    3F7D6490
       TRA     1,4                                                      3F7D6500
SMH    STI     IOSLIH                                                   3F7D6510
       STZ     1,2                                                      3F7D6520
       TRA     1,4                                                      3F7D6530
*                                                                       3F7D6540
CTLWH  SMS     6                                                        3F7D6550
       CTLW    HSEL                                                     3F7D6560
       TCH     **                                                       3F7D6570
*                                                                       3F7D6580
CPYDH1 CPYD    ORGDP,,SAVL                                              3F7D6590
       TCH     SYSTWT                                                   3F7D6600
CPYDH2 CPYP    TABL-38,,38                                              3F7D6610
       CPYD    **,,**                                                   3F7D6620
       TCH     SYSTWT                                                   3F7D6630
*                                                                       3F7D6640
HSEL   OCT     120600120100                                             3F7D6650
MASK1  OCT     777700777777                                             3F7D6660
MASK2  OCT     000017000000                                             3F7D6670
MASK3  OCT     007777000000                                             3F7D6680
IOXSLH PZE     CTLWH,,SEH                                               3F7D6690
IOSLIH PZE     0                                                        3F7D6700
LNKG   LDIR                                                             3F7D6710
       END                                                              3F7D6720
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLDI             3F7E0000
$IBMAP FSLDI   33                                                       3F7E0010
       TTL     FSLDI/SHORT LIST INPUT (FOR DECIMAL ARRAYS)              3F7E0020
       LBL     SLDI,BEGIN     FSLDI                                  (7)3F7E0030
       REM                                                              3F7E0040
       REM     CALLING SEQUENCES ARE                                    3F7E0050
       REM     CALL .FSLI. (A,M) FOR SINGLE-PRECISION BCD ARRAYS,       3F7E0060
       REM     CALL .FSDI. (A,M) FOR DOUBLE-PRECISION BCD ARRAYS.       3F7E0070
       REM     A IS LOCATION OF THE ARRAY AND M IS THE LOCATION OF      3F7E0080
       REM     THE NUMBER OF ELEMENTS IN THE ARRAY.                     3F7E0090
       REM                                                              3F7E0100
       ENTRY   .FSLI.                                                   3F7E0110
       ENTRY   .FSDI.                                                   3F7E0120
SAVE   SAVEN   (2)I                                                     3F7E0130
       SXA     LNKG,4                                                   3F7E0140
       TRA     1,1                                                      3F7E0150
SXIT   AXT     **,1                                                     3F7E0160
       RETURN  SAVE                                                     3F7E0170
.FSLI. SXA     SXIT,1                ENTRY POINT FOR SINGLE-            3F7E0180
       TSX     SAVE,1                PRECISION BCD ARRAYS.              3F7E0190
       LXA     FCNV,1                INITIALIZE FOR LIST                3F7E0200
       SXA     .SLI1.,1              PROCESSING.                        3F7E0210
       TSX     .SLI.,4               GO TO SET UP LIST PROCESSING.      3F7E0220
       TRA     SXIT                                                     3F7E0230
.FSDI. SXA     SXIT,1                ENTRY POINT FOR DOUBLE-            3F7E0240
       TSX     SAVE,1                PRECISION BCD ARRAYS.              3F7E0250
       LXA     FCNV,1                INITIALIZE FOR LIST                3F7E0260
       SXA     .SDI1.,1              PROCESSING.                        3F7E0270
       TSX     .SDI.,4               GO TO SET UP LIST PROCESSING.      3F7E0280
       TRA     SXIT                                                     3F7E0290
FCNV   PZE     .FCNV.                                                   3F7E0300
LNKG   LDIR                                                             3F7E0310
       END                                                              3F7E0320
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLBI             3F7F0000
$IBMAP FSLBI   34                                                       3F7F0010
       TTL     FSLBI/SHORT LIST INPUT (FOR BINARY ARRAYS)               3F7F0020
       LBL     SLBI,BEGIN     FSLBI                                  (7)3F7F0030
       REM                                                              3F7F0040
       REM     CALLING SEQUENCES ARE                                    3F7F0050
       REM     CALL .FBLI. (A,M) FOR SINGLE-PRECISION BINARY ARRAYS,    3F7F0060
       REM     CALL .FBDI. (A,M) FOR DOUBLE-PRECISION BINARY ARRAYS.    3F7F0070
       REM     A IS LOCATION OF THE ARRAY AND M IS THE LOCATION OF      3F7F0080
       REM     THE NUMBER OF ELEMENTS IN THE ARRAY.                     3F7F0090
       REM                                                              3F7F0100
       ENTRY   .FBLI.                                                   3F7F0110
       ENTRY   .FBDI.                                                   3F7F0120
SAVE   SAVEN   (2)I                                                     3F7F0130
       SXA     LNKG,4                                                   3F7F0140
       TRA     1,1                                                      3F7F0150
SXIT   AXT     **,1                                                     3F7F0160
       RETURN  SAVE                                                     3F7F0170
.FBLI. SXA     SXIT,1                ENTRY POINT FOR SINGLE-            3F7F0180
       TSX     SAVE,1                PRECISION BINARY ARRAYS.           3F7F0190
       LXA     FBLT,1                INITIALIZE FOR LIST                3F7F0200
       SXA     .SLI1.,1              PROCESSING.                        3F7F0210
       TSX     .SLI.,4               GO TO SET UP LIST PROCESSING.      3F7F0220
       TRA     SXIT                                                     3F7F0230
.FBDI. SXA     SXIT,1                ENTRY POINT FOR DOUBLE-            3F7F0240
       TSX     SAVE,1                PRECISION BINARY ARRAYS.           3F7F0250
       LXA     FBDT,1                INITIALIZE FOR LIST                3F7F0260
       SXA     .SDI1.,1              PROCESSING.                        3F7F0270
       TSX     .SDI.,4               GO TO SET UP LIST PROCESSING.      3F7F0280
       TRA     SXIT                                                     3F7F0290
FBLT   PZE     .FBLT.                                                   3F7F0300
FBDT   PZE     .FBDT.                                                   3F7F0310
LNKG   LDIR                                                             3F7F0320
       END                                                              3F7F0330
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLI              3F7G0000
$IBMAP FSLI    41                                                       3F7G0010
       TTL     FSLI/SHORT LIST INPUT                                    3F7G0020
       REM                                                              3F7G0030
       REM     CONTROL IS TRANSFERRED TO THIS ROUTINE BY FSLDI AND      3F7G0040
       REM     FSLBI TO SET UP INDEXING FOR PROCESSING THE INPUT        3F7G0050
       REM     OF NON-SUBSCRIPTED ARRAYS.                               3F7G0060
       REM                                                              3F7G0070
       ENTRY   .SLI.                                                    3F7G0080
       ENTRY   .SLI1.                                                   3F7G0090
       ENTRY   .SDI.                                                    3F7G0100
       ENTRY   .SDI1.                                                   3F7G0110
.SLI.  SXA     SV4,4                                                    3F7G0120
       TSX     GTARGS,2              OBTAIN ARGUMENTS IN CALLING        3F7G0130
       PAC     0,4                   SEQUENGE TO FSLDI.                 3F7G0140
       SXD     SL3,4                                                    3F7G0150
       AXT     0,2                                                      3F7G0160
.SLI1. TSX     **,4                  LIST FOR INPUT OF                  3F7G0170
 SL2   STO     **,2                  NON-SUBSCRIPTED                    3F7G0180
       TXI     *+1,2,-1              SINGLE-PRECISION                   3F7G0190
 SL3   TXH     *-3,2,**              ARRAYS.                            3F7G0200
 SV4   AXT     **,4                                                     3F7G0210
       TRA     1,4                                                      3F7G0220
.SDI.  SXA     SV4,4                                                    3F7G0230
       TSX     GTARGS,2              OBTAIN ARGUMENTS IN CALLING        3F7G0240
       ALS     1                     SEQUENCE TO FSLBI.                 3F7G0250
       PAC     0,4                                                      3F7G0260
       SXD     SD3,4                                                    3F7G0270
       AXT     0,2                                                      3F7G0280
.SDI1. TSX     **,4                  LIST FOR INPUT OF                  3F7G0290
 SD2   DST     **,2                  NON-SUBSCRIPTED                    3F7G0300
       TXI     *+1,2,-2              DOUBLE-PRECISION                   3F7G0310
SD3    TXH     .SDI1.,2,**           ARRAYS.                            3F7G0320
       TRA     SV4                                                      3F7G0330
GTARGS LXA     SYSLOC,4              OBTAIN INCOMING ARGUMENTS.         3F7G0340
       CLA     3,4                   LOCATION OF ARRAY.                 3F7G0350
       STA     SL2                                                      3F7G0360
       STA     SD2                                                      3F7G0370
       CLA*    4,4                   NUMBER OF ELEMENTS IN ARRAY.       3F7G0380
       TRA     1,2                                                      3F7G0390
       END                                                              3F7G0400
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLDO             3F7H0000
$IBMAP FSLDO   33                                                       3F7H0010
       TTL     FSLDO/SHORT LIST OUTPUT (FOR DECIMAL ARRAYS)             3F7H0020
       LBL     SLDO,BEGIN     FSLDO                                  (7)3F7H0030
       REM                                                              3F7H0040
       REM     CALLING SEQUENCES ARE                                    3F7H0050
       REM     CALL .FSLO. (A,M) FOR SINGLE-PRECISION BCD ARRAYS,       3F7H0060
       REM     CALL .FSDO. (A,M) FOR DOUBLE-PRECISION BCD ARRAYS.       3F7H0070
       REM     A IS LOCATION OF THE ARRAY AND M IS THE LOCATION OF      3F7H0080
       REM     THE NUMBER OF ELEMENTS IN THE ARRAY.                     3F7H0090
       REM                                                              3F7H0100
       ENTRY   .FSLO.                                                   3F7H0110
       ENTRY   .FSDO.                                                   3F7H0120
SAVE   SAVEN   (2)I                                                     3F7H0130
       SXA     LNKG,4                                                   3F7H0140
       TRA     1,1                                                      3F7H0150
SXIT   AXT     **,1                                                     3F7H0160
       RETURN  SAVE                                                     3F7H0170
.FSLO. SXA     SXIT,1                ENTRY POINT FOR SINGLE-            3F7H0180
       TSX     SAVE,1                PRECISION BCD ARRAYS.              3F7H0190
       LXA     FCNV,1                INITIALIZE FOR LIST                3F7H0200
       SXA     .SLO2.,1              PROCESSING.                        3F7H0210
       TSX     .SLO.,4               GO TO SET UP LIST PROCESSING.      3F7H0220
       TRA     SXIT                                                     3F7H0230
.FSDO. SXA     SXIT,1                ENTRY POINT FOR DOUBLE-            3F7H0240
       TSX     SAVE,1                PRECISION BCD ARRAYS.              3F7H0250
       LXA     FCNV,1                INITIALIZE FOR LIST                3F7H0260
       SXA     .SDO2.,1              PROCESSING.                        3F7H0270
       TSX     .SDO.,4               GO TO SET UP LIST PROCESSING.      3F7H0280
       TRA     SXIT                                                     3F7H0290
FCNV   PZE     .FCNV.                                                   3F7H0300
LNKG   LDIR                                                             3F7H0310
       END                                                              3F7H0320
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLBO             3F7I0000
$IBMAP FSLBO   34                                                       3F7I0010
       TTL     FSLBO/SHORT LIST OUTPUT (FOR BINARY ARRAYS)              3F7I0020
       LBL     SLBO,BEGIN     FSLBO                                  (7)3F7I0030
       REM                                                              3F7I0040
       REM     CALLING SEQUENCES ARE                                    3F7I0050
       REM     CALL .FBLO. (A,M) FOR SINGLE-PRECISION BINARY ARRAYS,    3F7I0060
       REM     CALL .FBDO. (A,M) FOR DOUBLE-PRECISION BINARY ARRAYS.    3F7I0070
       REM     A IS LOCATION OF THE ARRAY AND M IS THE LOCATION OF      3F7I0080
       REM     THE NUMBER OF ELEMENTS IN THE ARRAY.                     3F7I0090
       REM                                                              3F7I0100
       ENTRY   .FBLO.                                                   3F7I0110
       ENTRY   .FBDO.                                                   3F7I0120
SAVE   SAVEN   (2)I                                                     3F7I0130
       SXA     LNKG,4                                                   3F7I0140
       TRA     1,1                                                      3F7I0150
SXIT   AXT     **,1                                                     3F7I0160
       RETURN  SAVE                                                     3F7I0170
.FBLO. SXA     SXIT,1                ENTRY POINT FOR SINGLE-            3F7I0180
       TSX     SAVE,1                PRECISION BINARY ARRAYS.           3F7I0190
       LXA     FBLT,1                INITIALIZE FOR LIST                3F7I0200
       SXA     .SLO2.,1              PROCESSING.                        3F7I0210
       TSX     .SLO.,4               GO TO SET UP LIST PROCESSING.      3F7I0220
       TRA     SXIT                                                     3F7I0230
.FBDO. SXA     SXIT,1                ENTRY POINT FOR DOUBLE-            3F7I0240
       TSX     SAVE,1                PRECISION BINARY ARRAYS.           3F7I0250
       LXA     FBDT,1                INITIALIZE FOR LIST                3F7I0260
       SXA     .SDO2.,1              PROCESSING.                        3F7I0270
       TSX     .SDO.,4               GO TO SET UP LIST PROCESSING.      3F7I0280
       TRA     SXIT                                                     3F7I0290
FBLT   PZE     .FBLT.                                                   3F7I0300
FBDT   PZE     .FBDT.                                                   3F7I0310
LNKG   LDIR                                                             3F7I0320
       END                                                              3F7I0330
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FSLO              3F7J0000
$IBMAP FSLO    41                                                       3F7J0010
       TTL     FSLO/SHORT LIST OUTPUT                                   3F7J0020
       REM                                                              3F7J0030
       REM     CONTROL IS TRANSFERRED TO THIS ROUTINE BY FSLDO AND      3F7J0040
       REM     FSLBO TO SET UP INDEXING FOR PROCESSING THE OUTPUT       3F7J0050
       REM     OF NON-SUBSCRITED ARRAYS.                                3F7J0060
       REM                                                              3F7J0070
       ENTRY   .SLO.                                                    3F7J0080
       ENTRY   .SLO2.                                                   3F7J0090
       ENTRY   .SDO.                                                    3F7J0100
       ENTRY   .SDO2.                                                   3F7J0110
.SLO.  SXA     SV4,4                                                    3F7J0120
       TSX     GTARGS,2              OBTAIN ARGUMENTS IN CALLING        3F7J0130
       PAC     0,4                   SEQUENCE TO FSLDO.                 3F7J0140
       SXD     SL3,4                                                    3F7J0150
       AXT     0,2                                                      3F7J0160
 SL1   CLA     **,2                  LIST FOR OUTPUT OF                 3F7J0170
.SLO2. TSX     **,4                  NON-SUBSCRIPTED                    3F7J0180
       TXI     *+1,2,-1              SINGLE-PRECISION                   3F7J0190
 SL3   TXH     *-3,2,**              ARRAYS.                            3F7J0200
 SV4   AXT     **,4                                                     3F7J0210
       TRA     1,4                                                      3F7J0220
.SDO.  SXA     SV4,4                                                    3F7J0230
       TSX     GTARGS,2              OBTAIN ARGUMENTS IN CALLING        3F7J0240
       ALS     1                     SEQUENCE TO FSLBO.                 3F7J0250
       PAC     0,4                                                      3F7J0260
       SXD     SD3,4                                                    3F7J0270
       AXT     0,2                                                      3F7J0280
 SD1   DLD     **,2                  LIST FOR OUTPUT OF                 3F7J0290
.SDO2. TSX     **,4                  NON-SUBSCRIPTED                    3F7J0300
       TXI     *+1,2,-2              DOUBLE-PRECISION                   3F7J0310
SD3    TXH     SD1,2,**              ARRAYS.                            3F7J0320
       TRA     SV4                                                      3F7J0330
GTARGS LXA     SYSLOC,4              OBTAIN INCOMING ARGUMENTS.         3F7J0340
       CLA     3,4                   LOCATION OF ARRAY.                 3F7J0350
       STA     SL1                                                      3F7J0360
       STA     SD1                                                      3F7J0370
       CLA*    4,4                   NUMBER OF ELEMENTS IN ARRAY.       3F7J0380
       TRA     1,2                                                      3F7J0390
       END                                                              3F7J0400
$*     7090/7094 IBLIB ERROR RETURN VALIDATION SUBROUTINE - FRET    (14)3F7K0000
$IBMAP FRET    ()OK                                                 (14)3F7K0010
       TTL     FRET - OPTIONAL ERROR RETURN VALIDATION ROUTINE      (14)3F7K0020
* PURPOSE -                                                         (14)3F7K0030
*    TO CHECK WHETHER A FORTRAN SUBROUTINE ATTEMPTED TO TAKE        (14)3F7K0040
*    AN OPTIONAL RETURN NOT SPECIFIED IN THE CALL TO THE SUBROUTINE (14)3F7K0050
*    IF IT DID AN ERROR MESSAGE WILL BE PRINTED                     (14)3F7K0060
*                                                                   (14)3F7K0070
* ENTRY -                                                           (14)3F7K0080
*    TSX   .FRET.                                                   (14)3F7K0090
*    AXT   N,4                                                      (14)3F7K0100
*   (LXA)                                                           (14)3F7K0110
*    TXI   SAVE+1,,LK.DR                                            (14)3F7K0120
* INPUT -                                                           (14)3F7K0130
*    1) N = RETURN NUMBER OR LOCATION WHERE RETURN NUMBER IS GIVEN  (14)3F7K0140
*    2) SAVE+1 = LOC OF EXIT OF SUBROUTINE                          (14)3F7K0150
*    3) LK.DR = LOC OF LINKAGE DIRECTOR OF SUBROUTINE               (14)3F7K0160
*                                                                   (14)3F7K0165
       ENTRY   .FRET.                                               (14)3F7K0170
.FRET. SXA     SAVE4,4             SAVE XR4 AND                     (14)3F7K0180
       STO     ACCUM               THE AC                           (14)3F7K0190
       XEC     1,4                 PLACE RETURN NO IN XR4           (14)3F7K0200
       SXD     RETRN,4             STORE RETURN NO                  (14)3F7K0210
       LAC     SYSLOC,4            PICK UP LOCATION OF CALL         (14)3F7K0240
       SXD     NEXT,4              STORE LOCATION OF CALL           (14)3F7K0250
       LXA     SYSLOC,4        PICK UP LOCATION OF CALL COMPLEMENTED(14)3F7K0260
       CLA     1,4                 PLACE TXI IN AC                  (14)3F7K0270
       PAX     0,4                 PLACE *+2+M+N IN XR4             (14)3F7K0280
RETRN  TNX     ERR,4,**            DECREMENT BY RETURN NO           (14)3F7K0290
       SXD     TEST,4              STORE XR4                        (14)3F7K0300
       PDX     0,4                 PLACE N = NO OF PARAMETERS IN XR4(14)3F7K0310
       TXI     *+1,4,3             MAKE XR4 = N +3                  (14)3F7K0320
NEXT   TXI     *+1,4,**            MAKE XR4 = *+N+2                 (14)3F7K0330
TEST   TIX     ERR,4,**            TEST IF INVALID RETURN           (14)3F7K0340
SAVE4  AXT     **,4                RESTORE XR4                      (14)3F7K0350
       CLA     2,4                 FIND LOCATION OF                 (14)3F7K0360
       SUB     L(1)                'SAVE'                           (14)3F7K0370
       STA     *+2                                                  (14)3F7K0380
       CLA     RETRN               PICK UP RETURN NO                (14)3F7K0390
       STD     **                  AND PLACE IN DECREMENT OF SAVE   (14)3F7K0400
       CLA     ACCUM               RESTORE AC                       (14)3F7K0410
       TRA     2,4                 AND EXIT                         (14)3F7K0420
ERR    LXA     SAVE4,4             RESTORE XR4                      (14)3F7K0430
       CLA     2,4                 FIND DECK NAME OF                (14)3F7K0440
       PDC     0,4                 SUBROUTINE                       (14)3F7K0450
       CLA     1,4                 AND STORE IT IN                  (14)3F7K0460
       STO     E72MES+2            ERROR MESSAGE                    (14)3F7K0470
       SXD     RETRN,0             SET RETURN NO = 0                (14)3F7K0480
       CALL    .FXEM.(CODE72)      PRINT ERROR MESSAGE              (14)3F7K0490
       TRA     SAVE4               AND RETURN                       (14)3F7K0500
CODE72 PZE     72                                                   (14)3F7K0510
ER72MS PZE     E72MES,,17                                           (14)3F7K0520
ER72OP PZE     E72OMS,,4                                            (14)3F7K0530
E72MES BCI     3,0SUBROUTINE                                        (14)3F7K0540
       BCI     8, ATTEMPTED TO TAKE A NONSTANDARD RETURN NOT SPEC   (14)3F7K0550
       BCI     6,IFIED IN THE CALL TO THE SUBROUTINE.               (14)3F7K0560
E72OMS BCI     4,0STANDARD RETURN TAKEN.                            (14)3F7K0570
L(1)   PZE     1                                                    (14)3F7K0580
ACCUM  PZE     0                                                    (14)3F7K0600
       END                                                          (14)3F7K0610
$*     7090/7094 IBLIB FORTRAN MATHEMATICS LIBRARY                      3F8A0000
$IBMAP FCAB    150                                                      3F8A0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8A0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8A0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8A0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8A0040
M9094  SET     90                                                       3F8A0050
       PCC     ON                                                       3F8A0060
       IFF     M9094=90                                                 3F8A0070
       GOTO    BEG94                                                    3F8A0080
       PCC     OFF                                                      3F8A0090
       ENTRY   CABS                                                     3F8A0100
       SPACE   3                                                        3F8A0110
       REM     COMPLEX ABSOLUTE VALUE SUBROUTINE                        3F8A0120
       SPACE   3                                                        3F8A0130
  CABS SXA     SYSLOC,4                                                 3F8A0140
       SXA     LINK,4                                                   3F8A0150
       CAL     3,4           OBTAIN ARGUMENT.   TAG ALLOWED.            3F8A0160
       ADD     K1A                                                      3F8A0170
       STO     BUFF                                                     3F8A0180
       CLA*    3,4           MAKE BOTH PARTS OF ARGUMENT POSITIVE       3F8A0190
       XCL                                                              3F8A0200
       CAL*    BUFF                                                     3F8A0210
  K1A  OCT     013100000001     XCA AS OPERATION,   K1A AS CONSTANT     3F8A0220
       TLQ     *+2                                                      3F8A0230
       XCA                                                              3F8A0240
       TZE     1,4                                                      3F8A0250
       STO     BUFF          LARGER OF TWO PARTS TO BUFF                3F8A0260
       XCA                   IF X GREATER THAN Y                        3F8A0270
       FDP     BUFF            ANS = /X/*SQRT(1+(Y/X)**2)               3F8A0280
       STQ     BUFF+1                                                   3F8A0290
       FMP     BUFF+1                                                   3F8A0300
       FAD     ONE                                                      3F8A0310
       FRN                                                              3F8A0320
       STO     BUFF+1                                                   3F8A0330
       CALL    SQRT(BUFF+1)                                             3F8A0340
       XCA                                                              3F8A0350
       FMP     BUFF                                                     3F8A0360
       FRN                                                              3F8A0370
       LDQ     ZERO          CLEAR MQ                                   3F8A0380
       LXA     LINK,4                                                   3F8A0390
       TRA     1,4                                                      3F8A0400
       SPACE                                                            3F8A0410
  ONE  OCT     201400000000                                             3F8A0420
  ZERO OCT     0                                                        3F8A0430
  BUFF BSS     2                                                        3F8A0440
       SPACE                                                            3F8A0450
  LINK LDIR                                                             3F8A0460
BEG94  NULL                                                             3F8A0470
       PCC     ON                                                       3F8A0480
       IFT     M9094=90                                                 3F8A0490
       GOTO    END94                                                    3F8A0500
       PCC     OFF                                                      3F8A0510
       EJECT                                                            3F8A0520
       ENTRY   CABS                                                     3F8A0530
       SPACE   3                                                        3F8A0540
       REM     COMPLEX ABSOLUTE VALUE SUBROUTINE                        3F8A0550
       SPACE   3                                                        3F8A0560
 CABS  SXA     SYSLOC,4                                                 3F8A0570
       SXA     LINK,4                                                   3F8A0580
       DLD*    3,4           PICK UP CARG,T                             3F8A0590
       SSP                                                              3F8A0600
       LRS     0                                                        3F8A0610
       TLQ     *+2                                                      3F8A0620
       XCA                                                              3F8A0630
       TZE     1,4                                                      3F8A0640
       STO     BUFF          LARGER OF TWO PARTS TO BUFF                3F8A0650
       XCA                   IF X GREATER THAN Y                        3F8A0660
       FDP     BUFF            ANS = /X/*SQRT(1+(Y/X)**2)               3F8A0670
       STQ     BUFF+1                                                   3F8A0680
       FMP     BUFF+1                                                   3F8A0690
       FAD     ONE                                                      3F8A0700
       FRN                                                              3F8A0710
       STO     BUFF+1                                                   3F8A0720
       CALL    SQRT(BUFF+1)                                             3F8A0730
       XCA                                                              3F8A0740
       FMP     BUFF                                                     3F8A0750
       FRN                                                              3F8A0760
       LDQ     ZERO          CLEAR MQ                                   3F8A0770
       LXA     LINK,4                                                   3F8A0780
       TRA     1,4                                                      3F8A0790
       SPACE                                                            3F8A0800
  ONE  OCT     201400000000                                             3F8A0810
 ZERO  OCT     0                                                        3F8A0820
 BUFF  BSS     2                                                        3F8A0830
       SPACE                                                            3F8A0840
  LINK LDIR                                                             3F8A0850
END94  NULL                                                             3F8A0860
       END                                                              3F8A0870
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F8B0000
$IBMAP FCXP    150                                                      3F8B0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8B0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8B0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8B0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8B0040
M9094  SET     90                                                       3F8B0050
       PCC     ON                                                       3F8B0060
       IFF     M9094=90                                                 3F8B0070
       GOTO    BEG94                                                    3F8B0080
       PCC     OFF                                                      3F8B0090
       ENTRY   CEXP                                                     3F8B0100
       SPACE   3                                                        3F8B0110
       REM     COMPLEX EXPONENTIAL SUBROUTINE                           3F8B0120
       SPACE   3                                                        3F8B0130
  CEXP SXA     SYSLOC,4                                                 3F8B0140
       SXA     LINK,4                                                   3F8B0150
       CAL     3,4           OBTAIN ARGUMENT POINTERS                   3F8B0160
       STO     ARG1                                                     3F8B0170
       ADD     K1A                                                      3F8B0180
       STO     ARG2                                                     3F8B0190
       STO     ARG3                                                     3F8B0200
       CLA*    3,4           SCREEN REAL ARG                            3F8B0210
       LDQ     EXPMAX                                                   3F8B0220
       TLQ     ERROR1                                                   3F8B0230
       TSX     EXP,4                                                    3F8B0240
       TXI     *+3,,1                                                   3F8B0250
       PZE     14,,LINK                                                 3F8B0260
  ARG1 PZE     **                                                       3F8B0270
 CEXP1 STO     BUFF                                                     3F8B0280
       CLA*    ARG2          SCREEN IMAG ARG                            3F8B0290
       LAS     SINMAX                                                   3F8B0300
       TRA     ERROR2        ARG TOO LARGE FOR SCN                      3F8B0310
  K1A  AXT     1,0                                                      3F8B0320
       TSX     SIN,4                                                    3F8B0330
       TXI     *+3,,1                                                   3F8B0340
       PZE     23,,LINK                                                 3F8B0350
  ARG2 PZE     **                                                       3F8B0360
       XCA                                                              3F8B0370
       FMP     BUFF          ANS = EXP(X)*(COS(Y)+ISIN(Y))              3F8B0380
       FRN                                                              3F8B0390
       STO     BUFF+1                                                   3F8B0400
       TSX     COS,4                                                    3F8B0410
       TXI     *+3,,1                                                   3F8B0420
       PZE     31,,LINK                                                 3F8B0430
  ARG3 PZE     **                                                       3F8B0440
       XCA                                                              3F8B0450
       FMP     BUFF                                                     3F8B0460
       FRN                                                              3F8B0470
       LDQ     BUFF+1                                                   3F8B0480
   RET LXA     LINK,4                                                   3F8B0490
       TRA     1,4                                                      3F8B0500
       SPACE                                                            3F8B0510
ERROR1 CALL    .FXEM.(ECEXP1)                                           3F8B0520
       CLA     OMEGA                                                    3F8B0530
       TRA     CEXP1                                                    3F8B0540
ERROR2 CALL    .FXEM.(ECEXP2)                                           3F8B0550
       ZAC                                                              3F8B0560
       LRS     35                                                       3F8B0570
       TRA     RET                                                      3F8B0580
       SPACE                                                            3F8B0590
 OMEGA OCT     377777777777                                             3F8B0600
EXPMAX OCT     207540074636  88.029692                                  3F8B0610
SINMAX OCT     232000000000                                             3F8B0620
  BUFF BSS     2                                                        3F8B0630
ECEXP1 DEC     26                                                       3F8B0640
       PZE     E26MES,,8                                                3F8B0650
       PZE     E26OMS,,6                                                3F8B0660
E26MES BCI     8,0CEXP(X+IY), X GRT THAN 88.029692 NOT ALLOWED          3F8B0670
E26OMS BCI     6,0SET RESULT = OMEGA*(COSY + ISINY)                     3F8B0680
ECEXP2 DEC     27                                                       3F8B0690
       PZE     E27MES,,8                                                3F8B0700
       PZE     E27OMS,,3                                                3F8B0710
E27MES BCI     8,0CEXP(X+IY), /Y/ GRT THAN 2**25 NOT ALLOWED            3F8B0720
E27OMS BCI     3,0SET RESULT = 0+0I                                     3F8B0730
       SPACE                                                            3F8B0740
  LINK LDIR                                                             3F8B0750
BEG94  NULL                                                             3F8B0760
       PCC     ON                                                       3F8B0770
       IFT     M9094=90                                                 3F8B0780
       GOTO    END94                                                    3F8B0790
       PCC     OFF                                                      3F8B0800
       EJECT                                                            3F8B0810
       ENTRY   CEXP                                                     3F8B0820
       SPACE   3                                                        3F8B0830
       REM     COMPLEX EXPONENTIAL SUBROUTINE                           3F8B0840
       SPACE   3                                                        3F8B0850
  CEXP SXA     SYSLOC,4                                                 3F8B0860
       SXA     LINK,4                                                   3F8B0870
       DLD*    3,4           PICK UP CARG,T                             3F8B0880
       DST     BUFF          REAL ARG TO BUFF,  IMAG ARG TO BUFF+1      3F8B0890
       LDQ     EXPMAX        SCREEN REAL ARG                            3F8B0900
       TLQ     ERROR1                                                   3F8B0910
       CALL    EXP(BUFF)                                                3F8B0920
 CEXP1 STO     BUFF                                                     3F8B0930
       CLA     BUFF+1        SCREEN IMAG ARG                            3F8B0940
       LAS     SINMAX                                                   3F8B0950
       TRA     ERROR2        ARG TOO LARGE FOR SCN                      3F8B0960
       AXT     0,0                                                      3F8B0970
       CALL    SIN(BUFF+1)                                              3F8B0980
       XCA                                                              3F8B0990
       FMP     BUFF          ANS = EXP(X)*(COS(Y)+ISIN(Y))              3F8B1000
       FRN                                                              3F8B1010
       STO     BUFF+2                                                   3F8B1020
       CALL    COS(BUFF+1)                                              3F8B1030
       XCA                                                              3F8B1040
       FMP     BUFF                                                     3F8B1050
       FRN                                                              3F8B1060
       LDQ     BUFF+2                                                   3F8B1070
   RET LXA     LINK,4                                                   3F8B1080
       TRA     1,4                                                      3F8B1090
       SPACE                                                            3F8B1100
ERROR1 CALL    .FXEM.(ECEXP1)                                           3F8B1110
       CLA     OMEGA                                                    3F8B1120
       TRA     CEXP1                                                    3F8B1130
ERROR2 CALL    .FXEM.(ECEXP2)                                           3F8B1140
       ZAC                                                              3F8B1150
       LRS     35                                                       3F8B1160
       TRA     RET                                                      3F8B1170
       SPACE                                                            3F8B1180
  BUFF BSS     3                                                        3F8B1190
 OMEGA OCT     377777777777                                             3F8B1200
EXPMAX OCT     207540074636  88.029692                                  3F8B1210
SINMAX OCT     232000000000                                             3F8B1220
ECEXP1 DEC     26                                                       3F8B1230
       PZE     E26MES,,8                                                3F8B1240
       PZE     E26OMS,,6                                                3F8B1250
E26MES BCI     8,0CEXP(X+IY), X GRT THAN 88.029692 NOT ALLOWED          3F8B1260
E26OMS BCI     6,0SET RESULT = OMEGA*(COSY + ISINY)                     3F8B1270
ECEXP2 DEC     27                                                       3F8B1280
       PZE     E27MES,,8                                                3F8B1290
       PZE     E27OMS,,3                                                3F8B1300
E27MES BCI     8,0CEXP(X+IY), /Y/ GRT THAN 2**25 NOT ALLOWED            3F8B1310
E27OMS BCI     3,0SET RESULT = 0+0I                                     3F8B1320
       SPACE                                                            3F8B1330
  LINK LDIR                                                             3F8B1340
END94  NULL                                                             3F8B1350
       END                                                              3F8B1360
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F8C0000
$IBMAP FCAS    150                                                      3F8C0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8C0015
       TTL     FCAS - FORTRAN COMPLEX FLOATING MULTIPLY AND DIVIDE.     3F8C0019
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8C0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8C0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8C0040
M9094  SET     90                                                       3F8C0050
       PCC     ON                                                       3F8C0060
       IFF     M9094=90                                                 3F8C0070
       GOTO    BEG94                                                    3F8C0080
       PCC     OFF                                                      3F8C0090
       ENTRY   .CFMP.                                                   3F8C0100
       ENTRY   .CFDP.                                                   3F8C0110
       SPACE   3                                                        3F8C0120
       REM     COMPLEX ARITHMETIC SUBROUTINE                            3F8C0130
       SPACE   3                                                        3F8C0140
.CFMP. STL     FLAG                                                     3F8C0150
.CFDP. SXA     SYSLOC,4                                                 3F8C0160
       SXA     LINK,4                                                   3F8C0170
       SXA     RET,4                                                 (9)3F8C0175
       CAL     3,4           OBTAIN THE TWO OPERANDS                    3F8C0180
       ADD     K1A             TAG IN ADDRESS POINTER ALLOWED           3F8C0190
       STO     B                                                        3F8C0200
       CLA*    3,4           A   REAL PART OPERAND 1                    3F8C0210
       STO     A             B   IMAG PART OPERAND1                     3F8C0220
       CLA*    B             C   REAL PART OPERAND2                     3F8C0230
       STO     B             D   IMAG PART OPERAND2                     3F8C0240
       CAL     4,4                                                      3F8C0250
       ADD     K1A                                                      3F8C0260
       STO     D                                                        3F8C0270
       CLA*    4,4                                                      3F8C0280
       STO     C                                                        3F8C0290
       LDQ*    D                                                        3F8C0300
       STQ     D                                                        3F8C0310
       NZT     FLAG                                                     3F8C0320
       TRA     DIV                                                      3F8C0330
 MULT  FMP     A             COMPLEX MULTIPLY                           3F8C0340
       STO     BUFF                                                     3F8C0350
       LDQ     B               (AC-BD) + I(AD+BC)                       3F8C0360
       FMP     C                                                        3F8C0370
       FAD     BUFF                                                     3F8C0380
       STO     BUFF                                                     3F8C0390
       LDQ     B                                                        3F8C0400
       FMP     D                                                        3F8C0410
       STO     B                                                        3F8C0420
       LDQ     A                                                        3F8C0430
       FMP     C                                                        3F8C0440
       FSB     B                                                        3F8C0450
       LDQ     BUFF                                                     3F8C0460
       STZ     FLAG                                                     3F8C0470
       TRA     1,4                                                      3F8C0480
       SPACE                                                            3F8C0490
  DIV  SSP                   COMPLEX DIVIDE                             3F8C0500
       NZT     D                                                     (9)3F8C0505
       TZE     ERR                                                   (9)3F8C0507
       SBM     D               COMPARE MAGNITUDES OF C AND D            3F8C0510
       TPL     CONT            IF ABS C GREATER THAN ABS D, SKIP        3F8C0520
       CLS     C               OTHERWISE SWITCH COMPONENTS AS FOLLOWS   3F8C0530
       STO     D                                                        3F8C0540
       STQ     C                 NEW A =  OLD  B                        3F8C0550
       CLS     A                 NEW B =  OLD -A                        3F8C0560
       LDQ     B                 NEW C =  OLD  D                        3F8C0570
       STO     B                 NEW D =  OLD -C                        3F8C0580
       STQ     A                                                        3F8C0590
 CONT  CLS     A               NOW ABS C IS GREATER THAN ABS D          3F8C0600
       FDP     C                                                        3F8C0610
       STQ     A               SCALE A, B, AND D BY C TO GET            3F8C0620
       CLA     B                 -A/C, B/C, AND D/C                     3F8C0630
       FDP     C                                                        3F8C0640
       STQ     B                                                        3F8C0650
       CLA     D                                                        3F8C0660
       FDP     C                                                        3F8C0670
       STQ     D                                                        3F8C0680
       FMP     D                                                        3F8C0690
       FAD     ONE                                                      3F8C0700
       STO     C                                                        3F8C0710
       LDQ     B               REAL PART OF ANSWER IS                   3F8C0720
       FMP     D                                                        3F8C0730
       FSB     A                 (A/C + B/C.D/C) / (1 + (D/C)**2)       3F8C0740
       FDP     C                                                        3F8C0750
       STQ     BUFF                                                     3F8C0760
       LDQ     A               IMAGINARY PART OF ANSWER IS              3F8C0770
       FMP     D                                                        3F8C0780
       FAD     B                 (-A/C.D/C + B/C) / (1 + (D/C)**2)      3F8C0790
       FDP     C                                                        3F8C0800
       CLA     BUFF                                                     3F8C0810
RET    AXT     **,4                                                  (9)3F8C0820
       TRA     1,4                                                   (9)3F8C0825
ERR    CALL    .FXEM.(CFDPE)                                         (9)3F8C0826
       TRA     RET                                                   (9)3F8C0828
CFDPE  DEC     25                                                    (9)3F8C0830
ER25MS PZE     E25MES,,4                                             (9)3F8C0832
ER25OP PZE     E25OMS,,3                                             (9)3F8C0834
E25MES BCI     4,0COMPLEX Z/0 NOT ALLOWED                            (9)3F8C0836
E25OMS BCI     3,0SET RESULT = 0                                     (9)3F8C0838
  ONE  OCT     201400000000                                             3F8C0840
  K1A  OCT     1                                                        3F8C0850
   A   BSS     1                                                        3F8C0860
   B   BSS     1                                                        3F8C0870
   C   BSS     1                                                        3F8C0880
   D   BSS     1                                                        3F8C0890
 BUFF  BSS     1                                                        3F8C0900
 FLAG  PZE                                                              3F8C0910
       SPACE                                                            3F8C0920
  LINK LDIR                                                             3F8C0930
BEG94  NULL                                                             3F8C0940
       PCC     ON                                                       3F8C0950
       IFT     M9094=90                                                 3F8C0960
       GOTO    END94                                                    3F8C0970
       PCC     OFF                                                      3F8C0980
       EJECT                                                            3F8C0990
       ENTRY   .CFMP.                                                   3F8C1000
       ENTRY   .CFDP.                                                   3F8C1010
       SPACE   3                                                        3F8C1020
       REM     COMPLEX ARITHMETIC SUBROUTINE                            3F8C1030
       SPACE   3                                                        3F8C1040
.CFMP. STL     FLAG                                                     3F8C1050
.CFDP. SXA     SYSLOC,4                                                 3F8C1060
       SXA     LINK,4                                                   3F8C1070
       SXA     RET,4                                                 (9)3F8C1075
       DLD*    3,4                                                      3F8C1080
       DST     A             REAL ARG1 TO A,  IMAG ARG1 TO B            3F8C1090
       DLD*    4,4                                                      3F8C1100
       DST     C             REAL ARG2 TO C,  IMAG ARG2 TO D            3F8C1110
       NZT     FLAG                                                     3F8C1120
       TRA     DIV                                                      3F8C1130
 MULT  FMP     A             COMPLEX MULTIPLY                           3F8C1140
       STO     BUFF                                                     3F8C1150
       LDQ     B               (AC-BD) + I(AD+BC)                       3F8C1160
       FMP     C                                                        3F8C1170
       FAD     BUFF                                                     3F8C1180
       STO     BUFF                                                     3F8C1190
       LDQ     B                                                        3F8C1200
       FMP     D                                                        3F8C1210
       STO     B                                                        3F8C1220
       LDQ     A                                                        3F8C1230
       FMP     C                                                        3F8C1240
       FSB     B                                                        3F8C1250
       LDQ     BUFF                                                     3F8C1260
       STZ     FLAG                                                     3F8C1270
       TRA     1,4                                                      3F8C1280
       SPACE                                                            3F8C1290
  DIV  SSP                   COMPLEX DIVIDE                             3F8C1300
       NZT     D                                                     (9)3F8C1305
       TZE     ERR                                                   (9)3F8C1307
       SBM     D               COMPARE MAGNITUDES OF C AND D            3F8C1310
       TPL     CONT            IF ABS C GREATER THAN ABS D, SKIP        3F8C1320
       CLS     C               OTHERWISE SWITCH COMPONENTS AS FOLLOWS   3F8C1330
       STO     D                                                        3F8C1340
       STQ     C                 NEW A =  OLD  B                        3F8C1350
       CLS     A                 NEW B =  OLD -A                        3F8C1360
       LDQ     B                 NEW C =  OLD  D                        3F8C1370
       STO     B                 NEW D =  OLD -C                        3F8C1380
       STQ     A                                                        3F8C1390
 CONT  CLS     A               NOW ABS C IS GREATER THAN ABS D          3F8C1400
       FDP     C                                                        3F8C1410
       STQ     A               SCALE A, B, AND D BY C TO GET            3F8C1420
       CLA     B                 -A/C, B/C, AND D/C                     3F8C1430
       FDP     C                                                        3F8C1440
       STQ     B                                                        3F8C1450
       CLA     D                                                        3F8C1460
       FDP     C                                                        3F8C1470
       STQ     D                                                        3F8C1480
       FMP     D                                                        3F8C1490
       FAD     ONE                                                      3F8C1500
       STO     C                                                        3F8C1510
       LDQ     B               REAL PART OF ANSWER IS                   3F8C1520
       FMP     D                                                        3F8C1530
       FSB     A                 (A/C + B/C.D/C) / (1 + (D/C)**2)       3F8C1540
       FDP     C                                                        3F8C1550
       STQ     BUFF                                                     3F8C1560
       LDQ     A               IMAGINARY PART OF ANSWER IS              3F8C1570
       FMP     D                                                        3F8C1580
       FAD     B                 (-A/C.D/C + B/C) / (1 + (D/C)**2)      3F8C1590
       FDP     C                                                        3F8C1600
       CLA     BUFF                                                     3F8C1610
RET    AXT     **,4                                                  (9)3F8C1620
       TRA     1,4                                                   (9)3F8C1625
ERR    CALL    .FXEM.(CFDPE)                                         (9)3F8C1626
       TRA     RET                                                   (9)3F8C1628
CFDPE  DEC     25                                                    (9)3F8C1630
ER25MS PZE     E25MES,,4                                             (9)3F8C1632
ER25OP PZE     E25OMS,,3                                             (9)3F8C1634
E25MES BCI     4,0COMPLEX Z/0 NOT ALLOWED                            (9)3F8C1636
E25OMS BCI     3,0SET RESULT = 0                                     (9)3F8C1638
       EVEN                                                             3F8C1640
   A   BSS     1                                                        3F8C1650
   B   BSS     1                                                        3F8C1660
   C   BSS     1                                                        3F8C1670
   D   BSS     1                                                        3F8C1680
  ONE  OCT     201400000000                                             3F8C1690
 BUFF  BSS     1                                                        3F8C1700
 FLAG  PZE                                                              3F8C1710
       SPACE                                                            3F8C1720
  LINK LDIR                                                             3F8C1730
END94  NULL                                                             3F8C1740
       END                                                              3F8C1750
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F8D0000
$IBMAP FCLG    150                                                      3F8D0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8D0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8D0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8D0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8D0040
M9094  SET     90                                                       3F8D0050
       PCC     ON                                                       3F8D0060
       IFF     M9094=90                                                 3F8D0070
       GOTO    BEG94                                                    3F8D0080
       PCC     OFF                                                      3F8D0090
       ENTRY   CLOG                                                     3F8D0100
       SPACE   3                                                        3F8D0110
       REM     COMPLEX LOGARITHM SUBROUTINE                             3F8D0120
       SPACE   3                                                        3F8D0130
  CLOG SXA     SYSLOC,4                                                 3F8D0140
       SXA     LINK,4                                                   3F8D0150
       CAL     3,4           OBTAIN ARGUMENT POINTERS                   3F8D0160
       STO     ADX1                                                     3F8D0170
       STO     ADX2                                                     3F8D0180
       ADD     K1A                                                      3F8D0190
       STO     ADY                                                      3F8D0200
       TSX     CABS,4        /X+IY/                                     3F8D0210
       TXI     *+3,,1                                                   3F8D0220
       PZE     11,,LINK                                                 3F8D0230
  ADX1 PZE                                                              3F8D0240
       TZE     ERROR         IF X=0 Y=0, ERROR                          3F8D0250
       STO     BUFF                                                     3F8D0260
       CALL    ALOG(BUFF)                                               3F8D0270
       STO     BUFF          ANS = LOG/X+IY/ + I ATAN2(Y/X)             3F8D0280
       TSX     ATAN2,4                                                  3F8D0290
       TXI     *+4,,2                                                   3F8D0300
       PZE     22,,LINK                                                 3F8D0310
   ADY PZE                                                              3F8D0320
  ADX2 PZE                                                              3F8D0330
  K1A  OCT     013100000001     XCA AS OPERATION,   K1A AS CONSTANT     3F8D0340
       CLA     BUFF                                                     3F8D0350
   RET LXA     LINK,4                                                   3F8D0360
       TRA     1,4                                                      3F8D0370
       SPACE                                                            3F8D0380
 ERROR CALL    .FXEM.(ECLOG)                                            3F8D0390
       CLA     MOMEGA                                                   3F8D0400
       TRA     RET                                                      3F8D0410
       SPACE                                                            3F8D0420
MOMEGA OCT     777777777777                                             3F8D0430
  BUFF BSS     1                                                        3F8D0440
 ECLOG DEC     28                                                       3F8D0450
       PZE     E28MES,,4                                                3F8D0460
       PZE     E28OMS,,5                                                3F8D0470
E28MES BCI     4,0CLOG(0+0I) NOT ALLOWED                                3F8D0480
E28OMS BCI     5,0SET RESULT = -OMEGA + 0I                              3F8D0490
       SPACE                                                            3F8D0500
  LINK LDIR                                                             3F8D0510
BEG94  NULL                                                             3F8D0520
       PCC     ON                                                       3F8D0530
       IFT     M9094=90                                                 3F8D0540
       GOTO    END94                                                    3F8D0550
       PCC     OFF                                                      3F8D0560
       EJECT                                                            3F8D0570
       ENTRY   CLOG                                                     3F8D0580
       SPACE   3                                                        3F8D0590
       REM     COMPLEX LOGARITHM SUBROUTINE                             3F8D0600
       SPACE   3                                                        3F8D0610
  CLOG SXA     SYSLOC,4                                                 3F8D0620
       SXA     LINK,4                                                   3F8D0630
       DLD*    3,4           PICK UP CARG,T                             3F8D0640
       DST     BUFF          REAL ARG TO BUFF,  IMAG ARG TO BUFF+1      3F8D0650
       CALL    CABS(BUFF)    /X+IY/                                     3F8D0660
       TZE     ERROR         IF X=0 Y=0, ERROR                          3F8D0670
       STO     BUFF+2                                                   3F8D0680
       CALL    ALOG(BUFF+2)                                             3F8D0690
       STO     BUFF+2        ANS = LOG/X+IY/ + I ATAN2(Y/X)             3F8D0700
       CALL    ATAN2(BUFF+1,BUFF)                                       3F8D0710
       XCA                                                              3F8D0720
       CLA     BUFF+2                                                   3F8D0730
   RET LXA     LINK,4                                                   3F8D0740
       TRA     1,4                                                      3F8D0750
       SPACE                                                            3F8D0760
 ERROR CALL    .FXEM.(ECLOG)                                            3F8D0770
       CLA     MOMEGA                                                   3F8D0780
       TRA     RET                                                      3F8D0790
       SPACE                                                            3F8D0800
       EVEN                                                             3F8D0810
  BUFF BSS     3                                                        3F8D0820
MOMEGA OCT     777777777777                                             3F8D0830
 ECLOG DEC     28                                                       3F8D0840
       PZE     E28MES,,4                                                3F8D0850
       PZE     E28OMS,,5                                                3F8D0860
E28MES BCI     4,0CLOG(0+0I) NOT ALLOWED                                3F8D0870
E28OMS BCI     5,0SET RESULT = -OMEGA + 0I                              3F8D0880
       SPACE                                                            3F8D0890
  LINK LDIR                                                             3F8D0900
END94  NULL                                                             3F8D0910
       END                                                              3F8D0920
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F8E0000
$IBMAP FCSC    150                                                      3F8E0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8E0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8E0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8E0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8E0040
M9094  SET     90                                                       3F8E0050
       PCC     ON                                                       3F8E0060
       IFF     M9094=90                                                 3F8E0070
       GOTO    BEG94                                                    3F8E0080
       PCC     OFF                                                      3F8E0090
       ENTRY   CSIN                                                     3F8E0100
       ENTRY   CCOS                                                     3F8E0110
       SPACE   3                                                        3F8E0120
       REM     COMPLEX SINE - COSINE SUBROUTINE                         3F8E0130
       SPACE   3                                                        3F8E0140
  CSIN STL     FLAG                                                     3F8E0150
  CCOS SXA     SYSLOC,4                                                 3F8E0160
       SXA     LINK,4                                                   3F8E0170
       CAL     3,4                                                      3F8E0180
       STO     ADX1                                                     3F8E0190
       STO     ADX2                                                     3F8E0200
       ADD     K1A                                                      3F8E0210
       STO     ADY1                                                     3F8E0220
       STO     ADY2                                                     3F8E0230
       CLA*    3,4           SCREEN REAL ARG                            3F8E0240
       LAS     MAXRL                                                    3F8E0250
       TRA     ERROR1                                                   3F8E0260
  K1A  AXT     1,0                                                      3F8E0270
       TSX     SIN,4                                                    3F8E0280
       TXI     *+3,,1                                                   3F8E0290
       PZE     17,,LINK                                                 3F8E0300
  ADX1 PZE                                                              3F8E0310
       STO     B1            B1 = SIN(X)                                3F8E0320
       TSX     COS,4                                                    3F8E0330
       TXI     *+3,,1                                                   3F8E0340
       PZE     22,,LINK                                                 3F8E0350
  ADX2 PZE                                                              3F8E0360
       STO     B2            B2 = COS(X)                                3F8E0370
       CLA*    ADY1          SCREEN IMAG ARG                            3F8E0380
       LAS     MAXIM                                                    3F8E0390
       TRA     ERROR2                                                   3F8E0400
       AXT     0,0                                                      3F8E0410
       TSX     COSH,4                                                   3F8E0420
       TXI     *+3,,1                                                   3F8E0430
       PZE     31,,LINK                                                 3F8E0440
  ADY1 PZE                                                              3F8E0450
       STO     B3            B3 = COSH(Y)                               3F8E0460
       TSX     SINH,4                                                   3F8E0470
       TXI     *+3,,1                                                   3F8E0480
       PZE     36,,LINK                                                 3F8E0490
  ADY2 PZE                                                              3F8E0500
       XCA                   MQ = SINH(Y)                               3F8E0510
  TEST ZET     FLAG                                                     3F8E0520
       TRA     SINE                                                     3F8E0530
       FMP     B1            ICOS = (COS X)(COSH Y)                     3F8E0540
       FRN                                                              3F8E0550
       CHS                             - I(SIN X)(SINH Y)               3F8E0560
       STO     B1                                                       3F8E0570
       LDQ     B2            ISIN = (SIN X)(COSH Y)                     3F8E0580
       TRA     CONT                    + I(COS X)(SINH Y)               3F8E0590
  SINE FMP     B2                                                       3F8E0600
       FRN                                                              3F8E0610
       LDQ     B1                                                       3F8E0620
       STO     B1                                                       3F8E0630
  CONT FMP     B3                                                       3F8E0640
       FRN                                                              3F8E0650
       LDQ     B1                                                       3F8E0660
   RET LXA     LINK,4                                                   3F8E0670
       STZ     FLAG                                                     3F8E0680
       TRA     1,4                                                      3F8E0690
       SPACE                                                            3F8E0700
ERROR1 CALL    .FXEM.(ECSC1)                                            3F8E0710
       ZAC                                                              3F8E0720
       LRS     35                                                       3F8E0730
       TRA     RET                                                      3F8E0740
ERROR2 CALL    .FXEM.(ECSC2)                                            3F8E0750
       LDQ     HFOMEG                                                   3F8E0760
       STQ     B3                                                       3F8E0770
       LRS     0                                                        3F8E0780
       TRA     TEST                                                     3F8E0790
       SPACE                                                            3F8E0800
 MAXRL OCT     232000000000     2**25                                   3F8E0810
 MAXIM OCT     207540074636        88.029692                            3F8E0820
HFOMEG OCT     376777777777                                             3F8E0830
  B1   PZE                                                              3F8E0840
  B2   PZE                                                              3F8E0850
  B3   PZE                                                              3F8E0860
 FLAG  PZE                                                              3F8E0870
 ECSC1 DEC     29                                                       3F8E0880
       PZE     E29MES,,10                                               3F8E0890
       PZE     E29OMS,,3                                                3F8E0900
E29MES BCI ,0CSIN(X+IY) OR CCOS(X+IY), /X/ GRT THAN 2**25 NOT ALLOWED   3F8E0910
E29OMS BCI     3,0SET RESULT = 0+0I                                     3F8E0920
 ECSC2 DEC     30                                                       3F8E0930
       PZE     E30MES,,11                                               3F8E0940
       PZE     E30OMS,,8                                                3F8E0950
E30MES BCI     9,0CSIN(X+IY) OR CCOS(X+IY), /Y/ GRT THAN 88.029692 NOT  3F8E0960
       BCI     2,ALLOWED                                                3F8E0970
E30OMS BCI     8,0REF IBLIB ERR MSG LIST FOR EVALUATION METHOD          3F8E0980
       SPACE                                                            3F8E0990
  LINK LDIR                                                             3F8E1000
BEG94  NULL                                                             3F8E1010
       PCC     ON                                                       3F8E1020
       IFT     M9094=90                                                 3F8E1030
       GOTO    END94                                                    3F8E1040
       PCC     OFF                                                      3F8E1050
       EJECT                                                            3F8E1060
       ENTRY   CSIN                                                     3F8E1070
       ENTRY   CCOS                                                     3F8E1080
       SPACE   3                                                        3F8E1090
       REM     COMPLEX SINE - COSINE SUBROUTINE                         3F8E1100
       SPACE   3                                                        3F8E1110
  CSIN STL     FLAG                                                     3F8E1120
  CCOS SXA     SYSLOC,4                                                 3F8E1130
       SXA     LINK,4                                                   3F8E1140
       DLD*    3,4           PICK UP CARG,T                             3F8E1150
       DST     BUFF          REAL ARG TO BUFF,  IMAG ARG TO BUFF+1      3F8E1160
       LAS     MAXRL         SCREEN REAL ARG                            3F8E1170
       TRA     ERROR1                                                   3F8E1180
       AXT     0,0                                                      3F8E1190
       CALL    SIN(BUFF)                                                3F8E1200
       STO     BUFF+2                                                   3F8E1210
       CALL    COS(BUFF)                                                3F8E1220
       STO     BUFF                                                     3F8E1230
       CLA     BUFF+1        SCREEN IMAG ARG                            3F8E1240
       LAS     MAXIM                                                    3F8E1250
       TRA     ERROR2                                                   3F8E1260
       AXT     0,0                                                      3F8E1270
       CALL    COSH(BUFF+1)                                             3F8E1280
       STO     BUFF+3                                                   3F8E1290
       CALL    SINH(BUFF+1)                                             3F8E1300
       XCA                                                              3F8E1310
  TEST ZET     FLAG                                                     3F8E1320
       TRA     SINE                                                     3F8E1330
       FMP     BUFF+2        ICOS = (COS X)(COSH Y)                     3F8E1340
       FRN                                                              3F8E1350
       CHS                             - I(SIN X)(SINH Y)               3F8E1360
       STO     BUFF+2                                                   3F8E1370
       LDQ     BUFF          ISIN = (SIN X)(COSH Y)                     3F8E1380
       TRA     CONT                    + I(COS X)(SINH Y)               3F8E1390
  SINE FMP     BUFF                                                     3F8E1400
       FRN                                                              3F8E1410
       LDQ     BUFF+2                                                   3F8E1420
       STO     BUFF+2                                                   3F8E1430
  CONT FMP     BUFF+3                                                   3F8E1440
       FRN                                                              3F8E1450
       LDQ     BUFF+2                                                   3F8E1460
   RET LXA     LINK,4                                                   3F8E1470
       STZ     FLAG                                                     3F8E1480
       TRA     1,4                                                      3F8E1490
       SPACE                                                            3F8E1500
ERROR1 CALL    .FXEM.(ECSC1)                                            3F8E1510
       ZAC                                                              3F8E1520
       LRS     35                                                       3F8E1530
       TRA     RET                                                      3F8E1540
ERROR2 CALL    .FXEM.(ECSC2)                                            3F8E1550
       LDQ     HFOMEG                                                   3F8E1560
       STQ     BUFF+3                                                   3F8E1570
       LRS     0                                                        3F8E1580
       TRA     TEST                                                     3F8E1590
       SPACE                                                            3F8E1600
  BUFF BSS     4                                                        3F8E1610
 MAXRL OCT     232000000000     2**25                                   3F8E1620
 MAXIM OCT     207540074636        88.029692                            3F8E1630
HFOMEG OCT     376777777777                                             3F8E1640
 FLAG  PZE                                                              3F8E1650
 ECSC1 DEC     29                                                       3F8E1660
       PZE     E29MES,,10                                               3F8E1670
       PZE     E29OMS,,3                                                3F8E1680
E29MES BCI ,0CSIN(X+IY) OR CCOS(X+IY), /X/ GRT THAN 2**25 NOT ALLOWED   3F8E1690
E29OMS BCI     3,0SET RESULT = 0+0I                                     3F8E1700
 ECSC2 DEC     30                                                       3F8E1710
       PZE     E30MES,,11                                               3F8E1720
       PZE     E30OMS,,8                                                3F8E1730
E30MES BCI     9,0CSIN(X+IY) OR CCOS(X+IY), /Y/ GRT THAN 88.029692 NOT  3F8E1740
       BCI     2,ALLOWED                                                3F8E1750
E30OMS BCI     8,0REF IBLIB ERR MSG LIST FOR EVALUATION METHOD          3F8E1760
       SPACE                                                            3F8E1770
  LINK LDIR                                                             3F8E1780
END94  NULL                                                             3F8E1790
       END                                                              3F8E1800
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F8F0000
$IBMAP FCSQ    150                                                      3F8F0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F8F0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F8F0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F8F0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F8F0040
M9094  SET     90                                                       3F8F0050
       PCC     ON                                                       3F8F0060
       IFF     M9094=90                                                 3F8F0070
       GOTO    BEG94                                                    3F8F0080
       PCC     OFF                                                      3F8F0090
       ENTRY   CSQRT                                                    3F8F0100
       SPACE   3                                                        3F8F0110
       REM     COMPLEX SQUARE ROOT SUBROUTINE                           3F8F0120
       SPACE   3                                                        3F8F0130
 CSQRT SXA     SYSLOC,4                                                 3F8F0140
       SXA     LINK,4                                                   3F8F0150
       CAL     3,4           OBTAIN ARGUMENT POINTERS                   3F8F0160
       STO     ARG1                                                     3F8F0170
       ADD     K1A                                                      3F8F0180
       STO     ARG2                                                     3F8F0190
       TSX     CABS,4        FIND THE ABSOLUTE VALUE OF THE ARGUMENT    3F8F0200
       TXI     *+3,,1                                                   3F8F0210
       PZE     10,,LINK                                                 3F8F0220
  ARG1 PZE                                                              3F8F0230
       FAM*    ARG1                                                     3F8F0240
       FRN                   /X/+/X+IY/                                 3F8F0250
       SUB     K1            DIVISION BY 2 HERE                         3F8F0260
       TPL     *+4           IF UNDERFLOW OCCURS, GIVE (0,0) AS THE     3F8F0270
       ZAC                   ANSWER                                     3F8F0280
       LRS     35                                                       3F8F0290
       TRA     RET                                                      3F8F0300
       STO     BUFF                                                     3F8F0310
       CALL    SQRT(BUFF)                                               3F8F0320
       STO     BUFF          S = SQRT((/X/+/X+IY/)/2)                   3F8F0330
       ADD     K1            MULTIPLY SAME BY 2 FOR DIVISION LATER      3F8F0340
       STO     BUFF+1                                                   3F8F0350
       CLA*    ARG2                                                     3F8F0360
       FDP     BUFF+1        Y/2S                                       3F8F0370
  K1A  OCT     013100000001     XCA AS OPERATION,   K1A AS CONSTANT     3F8F0380
       FRN                                                              3F8F0390
       LDQ*    ARG1                                                     3F8F0400
       TQP     XPOS          IF X IS POSITIVE THIS IS ANSWER            3F8F0410
       LDQ     BUFF          IF X IS NEGATIVE, ANS IS                   3F8F0420
       LRS     0               /Y//(2S) + I (SGN Y)*S                   3F8F0430
       SSP                                                              3F8F0440
       TRA     RET                                                      3F8F0450
  XPOS XCA                                                              3F8F0460
       CLA     BUFF                                                     3F8F0470
   RET LXA     LINK,4                                                   3F8F0480
       TRA     1,4                                                      3F8F0490
       SPACE                                                            3F8F0500
  K1   OCT     1000000000                                               3F8F0510
  BUFF BSS     2                                                        3F8F0520
  ARG2 BSS     1                                                        3F8F0530
       SPACE                                                            3F8F0540
  LINK LDIR                                                             3F8F0550
BEG94  NULL                                                             3F8F0560
       PCC     ON                                                       3F8F0570
       IFT     M9094=90                                                 3F8F0580
       GOTO    END94                                                    3F8F0590
       PCC     OFF                                                      3F8F0600
       EJECT                                                            3F8F0610
       ENTRY   CSQRT                                                    3F8F0620
       SPACE   3                                                        3F8F0630
       REM     COMPLEX SQUARE ROOT SUBROUTINE                           3F8F0640
       SPACE   3                                                        3F8F0650
 CSQRT SXA     SYSLOC,4                                                 3F8F0660
       SXA     LINK,4                                                   3F8F0670
       DLD*    3,4           PICK UP CARG,T                             3F8F0680
       DST     ARG1          REAL ARG TO ARG1,  IMAG ARG TO ARG2        3F8F0690
       CALL    CABS(ARG1)    FIND THE ABSOLUTE VALUE OF THE ARGUMENT    3F8F0700
       FAM     ARG1                                                     3F8F0710
       FRN                   /X/+/X+IY/                                 3F8F0720
       SUB     K1            DIVISION BY 2 HERE                         3F8F0730
       TPL     *+4           IF UNDERFLOW OCCURS, GIVE (0,0) AS THE     3F8F0740
       ZAC                   ANSWER                                     3F8F0750
       LRS     35                                                       3F8F0760
       TRA     RET                                                      3F8F0770
       STO     BUFF                                                     3F8F0780
       CALL    SQRT(BUFF)                                               3F8F0790
       STO     BUFF          S = SQRT((/X/+/X+IY/)/2)                   3F8F0800
       ADD     K1            MULTIPLY SAME BY 2 FOR DIVISION LATER      3F8F0810
       STO     BUFF+1                                                   3F8F0820
       CLA     ARG2                                                     3F8F0830
       FDP     BUFF+1        Y/2S                                       3F8F0840
       XCA                                                              3F8F0850
       FRN                                                              3F8F0860
       LDQ     ARG1                                                     3F8F0870
       TQP     XPOS          IF X IS POSITIVE THIS IS ANSWER            3F8F0880
       LDQ     BUFF          IF X IS NEGATIVE, ANS IS                   3F8F0890
       LRS     0               /Y//(2S) + I (SGN Y)*S                   3F8F0900
       SSP                                                              3F8F0910
       TRA     RET                                                      3F8F0920
  XPOS XCA                                                              3F8F0930
       CLA     BUFF                                                     3F8F0940
   RET LXA     LINK,4                                                   3F8F0950
       TRA     1,4                                                      3F8F0960
       SPACE                                                            3F8F0970
       EVEN                                                             3F8F0980
  BUFF BSS     2                                                        3F8F0990
  ARG1 BSS     1                                                        3F8F1000
  ARG2 BSS     1                                                        3F8F1010
    K1 OCT     1000000000                                               3F8F1020
       SPACE                                                            3F8F1030
  LINK LDIR                                                             3F8F1040
END94  NULL                                                             3F8F1050
       END                                                              3F8F1060
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9A0000
$IBMAP FDXP    150                                                      3F9A0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9A0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F9A0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F9A0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F9A0040
M9094  SET     90                                                       3F9A0050
       PCC     ON                                                       3F9A0060
       IFF     M9094=90                                                 3F9A0070
       GOTO    BEG94                                                    3F9A0080
       PCC     OFF                                                      3F9A0090
       ENTRY   DEXP                                                     3F9A0100
       SPACE   3                                                        3F9A0110
       REM     DOUBLE PRECISION EXPONENTIAL SUBROUTINE                  3F9A0120
       SPACE   3                                                        3F9A0130
*              DOUBLE PRECISION ARITHMETIC MACRO DEFINITION             3F9A0140
       SPACE                                                            3F9A0150
 DPOP  MACRO   SUBR,A,TAG                                               3F9A0160
       TSX     SUBR,4                                                   3F9A0170
 DTAG  SET     0                                                        3F9A0180
       IFT     TAG=1                                                    3F9A0190
 DTAG  SET     1                                                        3F9A0200
       IFT     TAG=2                                                    3F9A0210
 DTAG  SET     2                                                        3F9A0220
       PZE     A,DTAG                                                   3F9A0230
       PZE     A+1,DTAG                                                 3F9A0240
       ENDM    DPOP                                                     3F9A0250
       SPACE   3                                                        3F9A0260
 DEXP  SXA     SYSLOC,4                                                 3F9A0270
       SXA     LINK,4                                                   3F9A0280
       SXA     SXR2,2                                                   3F9A0290
       CAL     3,4           OBTAIN POINTER FOR LOW ARG                 3F9A0300
       ADD     K1A                                                      3F9A0310
       STO     L                                                        3F9A0320
       CLA*    3,4           HIGH ARG TO AC                             3F9A0330
       LDQ     MAXIM                                                    3F9A0340
       TLQ     ERROR         ERROR IF ARG TOO BIG                       3F9A0350
       LDQ     MINIM                                                    3F9A0360
       TLQ     BEGIN                                                    3F9A0370
       ZAC                   ARG TOO SMALL, GIVE 0 ANSWER               3F9A0380
       LRS     36                                                       3F9A0390
       TRA     1,4                                                      3F9A0400
 BEGIN STO     M                                                        3F9A0410
       LDQ*    L             LOW ARG TO MQ                              3F9A0420
       ARS     9                                                        3F9A0430
       PDX     ,2            CHARACTERISTIC TO XR2                      3F9A0440
       LLS     8                                                        3F9A0450
       CLA     M                                                        3F9A0460
       LRS     0                                                        3F9A0470
       LLS     8                                                        3F9A0480
       STO     CHAR          Y=X*LOGE(BASE2)   E**X=2**Y                3F9A0490
       MPR     LOG2E           MULTIPLY FIXED POINT FASHION             3F9A0500
       STO     L1                TO INSURE ACCURACY                     3F9A0510
       LDQ     CHAR                                                     3F9A0520
       MPY     LOG2E                                                    3F9A0530
       DST     M                                                        3F9A0540
       LDQ     CHAR                                                     3F9A0550
       MPR     LOG2E+1                                                  3F9A0560
       ADD     L1                                                       3F9A0570
       ADD     L                                                        3F9A0580
       LRS     35                                                       3F9A0590
       ADD     M                                                        3F9A0600
       LRS     135,2         PRODUCT READY, SCALE B8                    3F9A0610
       STO     M                                                        3F9A0620
       ARS     27            DECOMPOSE Y=Y1+Y2                          3F9A0630
       ALS     27              Y1 INTEGER PART, Y2 FRACTION PART        3F9A0640
       TPL     *+2                                                      3F9A0650
       SUB     CHONE         IF Y NEGATIVE,                             3F9A0660
       STO     CHAR            Y1-1 IS CHARACTERISTIC MODIFIER,         3F9A0670
       CLA     M               Y2+1 IS MODIFIED FRACTION                3F9A0680
       ALS     10                                                       3F9A0690
       ARS     2                                                        3F9A0700
       ORA     CHLP                                                     3F9A0710
       LRS     8                                                        3F9A0720
       ORA     CH2HD                                                    3F9A0730
       STQ     L                                                        3F9A0740
       TPL     *+2                                                      3F9A0750
       FAD     K1                                                       3F9A0760
       FAD     L                                                        3F9A0770
       DST     M             Y2 READY                                   3F9A0780
       DLD     K             COMPUTE 2**Y2                              3F9A0790
       AXT     22,2            BY POWER SERIES                          3F9A0800
 LOOP  DPOP    DFMP,M        DFMP (AC,MQ) WITH (M,L)                    3F9A0810
       DPOP    DFAD,K1+2,2   DFAD (AC,MQ) WITH (K1+2(2),K1+3(2))        3F9A0820
       TIX     LOOP,2,2                                                 3F9A0830
       ADD     CHAR          2**Y2 IS READY   MULTIPLY 2**Y1            3F9A0840
       XCA                                                              3F9A0850
       ADD     CHAR                                                     3F9A0860
       TPL     *+2                                                      3F9A0870
       ZAC                                                              3F9A0880
  K1A  OCT     013100000001    XCA AS OPERATION, K1A AS CONSTANT        3F9A0890
 SXR2  AXT     **,2                                                     3F9A0900
  RET  LXA     LINK,4                                                   3F9A0910
       TRA     1,4                                                      3F9A0920
       SPACE                                                            3F9A0930
 ERROR CALL    .FXEM.(EDEXP)                                            3F9A0940
       DLD     OMEGA                                                    3F9A0950
       TRA     RET                                                      3F9A0960
       SPACE                                                            3F9A0970
   K   OCT     142532374743,107537467743   CHEBYCHEV CONSTANTS          3F9A0980
       OCT     145701221314,112343676276                                3F9A0990
       OCT     151670457337,116044431210                                3F9A1000
       OCT     155542424727,122264337060                                3F9A1010
       OCT     160777640427,125426625754                                3F9A1020
       OCT     164503021727,131237013176                                3F9A1030
       OCT     167535417775,134747136776                                3F9A1040
       OCT     172473125333,137657134507                                3F9A1050
       OCT     174706541065,141603405315                                3F9A1060
       OCT     176753767577,143701275247                                3F9A1070
       OCT     200542710277,145575071765                                3F9A1080
  K1   OCT     201400000000,146000000001                                3F9A1090
 LOG2E OCT     270524354512,340577027357   LOGE(BASE2)   B1             3F9A1100
 OMEGA OCT     377777777777,344777777777                                3F9A1110
   M   PZE                   BUFFERS M AND L SHOULD BE TOGETHER         3F9A1120
   L   PZE                                                              3F9A1130
  L1   PZE                                                              3F9A1140
 CHAR  PZE                                                              3F9A1150
 MAXIM OCT     207540074635        88.029691                            3F9A1160
 MINIM OCT     -207545523741       -89.415986                           3F9A1170
 CHONE OCT     1000000000                                               3F9A1180
 CH2HD OCT     200000000000                                             3F9A1190
 CHLP  OCT     145                                                      3F9A1200
 EDEXP DEC     19                                                       3F9A1210
       PZE     E19MES,,7                                                3F9A1220
       PZE     E19OMS,,4                                                3F9A1230
E19MES BCI     7,0DEXP(X), X GRT THAN 88.029692 NOT ALLOWED             3F9A1240
E19OMS BCI     4,0SET RESULT = + OMEGA                                  3F9A1250
       SPACE                                                            3F9A1260
  LINK LDIR                                                             3F9A1270
BEG94  NULL                                                             3F9A1280
       PCC     ON                                                       3F9A1290
       IFT     M9094=90                                                 3F9A1300
       GOTO    END94                                                    3F9A1310
       PCC     OFF                                                      3F9A1320
       EJECT                                                            3F9A1330
       ENTRY   DEXP                                                     3F9A1340
       SPACE   3                                                        3F9A1350
       REM     DOUBLE PRECISION EXPONENTIAL SUBROUTINE                  3F9A1360
       SPACE   3                                                        3F9A1370
 DEXP  SXA     SYSLOC,4                                                 3F9A1380
       SXA     LINK,4                                                   3F9A1390
       DLD*    3,4           PICK UP DARG,T                             3F9A1400
       DST     M                                                        3F9A1410
       LDQ     MAXIM                                                    3F9A1420
       TLQ     ERROR         ERROR IF ARG TOO BIG                       3F9A1430
       LDQ     MINIM                                                    3F9A1440
       TLQ     BEGIN                                                    3F9A1450
       DLD     ZERO          ARG TOO SMALL, GIVE 0                      3F9A1460
       TRA     1,4                                                      3F9A1470
 BEGIN STI     IND                                                      3F9A1480
       ARS     9                                                        3F9A1490
       PDX     ,4            CHARACTERISTIC TO XR4                      3F9A1500
       LDQ     L                                                        3F9A1510
       LLS     8                                                        3F9A1520
       CLA     M                                                        3F9A1530
       LRS     0                                                        3F9A1540
       LLS     8                                                        3F9A1550
       STO     CHAR          Y=X*LOGE(BASE2)   E**X=2**Y                3F9A1560
       MPR     LOG2E           MULTIPLY FIXED POINT FASHION             3F9A1570
       STO     L1                TO INSURE ACCURACY                     3F9A1580
       LDQ     CHAR                                                     3F9A1590
       MPY     LOG2E                                                    3F9A1600
       DST     M                                                        3F9A1610
       LDQ     CHAR                                                     3F9A1620
       MPR     LOG2E+1                                                  3F9A1630
       ADD     L1                                                       3F9A1640
       ADD     L                                                        3F9A1650
       LRS     35                                                       3F9A1660
       ADD     M                                                        3F9A1670
       LRS     135,4         PRODUCT READY, SCALE B8                    3F9A1680
       STO     M                                                        3F9A1690
       ARS     27            DECOMPOSE Y=Y1+Y2                          3F9A1700
       ALS     27              Y1 INTEGER PART, Y2 FRACTION PART        3F9A1710
       TPL     *+2                                                      3F9A1720
       SUB     CHONE         IF Y NEGATIVE,                             3F9A1730
       STO     CHAR            Y1-1 IS CHARACTERISTIC MODIFIER,         3F9A1740
       CLA     M               Y2+1 IS MODIFIED FRACTION                3F9A1750
       ALS     10                                                       3F9A1760
       ARS     2                                                        3F9A1770
       ORA     CHLP                                                     3F9A1780
       LRS     8                                                        3F9A1790
       ORA     CH2HD                                                    3F9A1800
       STQ     L                                                        3F9A1810
       TPL     *+2                                                      3F9A1820
       FAD     K1                                                       3F9A1830
       FAD     L                                                        3F9A1840
       DST     M             Y2 READY                                   3F9A1850
       DLD     K                                                        3F9A1860
       AXT     22,4          COMPUTE E**X                               3F9A1870
 LOOP  DFMP    M               VIA POWER SERIES                         3F9A1880
       DFAD    K1+2,4                                                   3F9A1890
       TIX     LOOP,4,2                                                 3F9A1900
       ADD     CHAR                                                     3F9A1910
       DFAD    ZERO                                                     3F9A1920
       LDI     IND              RESTORE INDICATORS                      3F9A1930
  RET  LXA     LINK,4                                                   3F9A1940
       TRA     1,4                                                      3F9A1950
       SPACE                                                            3F9A1960
 ERROR CALL    .FXEM.(EDEXP)                                            3F9A1970
       DLD     OMEGA                                                    3F9A1980
       TRA     RET                                                      3F9A1990
       SPACE                                                            3F9A2000
 CHAR  PZE                                                              3F9A2010
       EVEN                                                             3F9A2020
 ZERO  OCT     0,0                                                      3F9A2030
   K   OCT     142532374743,107537467743  CHEBYCHEV CONSTANTS           3F9A2040
       OCT     145701221314,112343676276                                3F9A2050
       OCT     151670457337,116044431210                                3F9A2060
       OCT     155542424727,122264337060                                3F9A2070
       OCT     160777640427,125426625754                                3F9A2080
       OCT     164503021727,131237013176                                3F9A2090
       OCT     167535417775,134747136776                                3F9A2100
       OCT     172473125333,137657134507                                3F9A2110
       OCT     174706541065,141603405315                                3F9A2120
       OCT     176753767577,143701275247                                3F9A2130
       OCT     200542710277,145575071765                                3F9A2140
  K1   OCT     201400000000,146000000001                                3F9A2150
 LOG2E OCT     270524354512,340577027357                                3F9A2160
 OMEGA OCT     377777777777,344777777777                                3F9A2170
   M   PZE                                                              3F9A2180
   L   PZE                                                              3F9A2190
  L1   PZE                                                              3F9A2200
 CHLP  OCT     145                                                      3F9A2210
 MAXIM OCT     207540074635        88.029691                            3F9A2220
 MINIM OCT     -207545523741       -89.415986                           3F9A2230
 CHONE OCT     1000000000                                               3F9A2240
 CH2HD OCT     200000000000                                             3F9A2250
  IND  PZE                                                              3F9A2260
 EDEXP DEC     19                                                       3F9A2270
       PZE     E19MES,,7                                                3F9A2280
       PZE     E19OMS,,4                                                3F9A2290
E19MES BCI     7,0DEXP(X), X GRT THAN 88.029692 NOT ALLOWED             3F9A2300
E19OMS BCI     4,0SET RESULT = + OMEGA                                  3F9A2310
       SPACE                                                            3F9A2320
  LINK LDIR                                                             3F9A2330
END94  NULL                                                             3F9A2340
       END                                                              3F9A2350
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9B0000
$IBMAP FDLG    150                                                      3F9B0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9B0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F9B0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F9B0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F9B0040
M9094  SET     90                                                       3F9B0050
       PCC     ON                                                       3F9B0060
       IFF     M9094=90                                                 3F9B0070
       GOTO    BEG94                                                    3F9B0080
       PCC     OFF                                                      3F9B0090
       ENTRY   DLOG                                                     3F9B0100
       ENTRY   DLOG10                                                   3F9B0110
       SPACE   3                                                        3F9B0120
       REM     DOUBLE PRECISION LOGARITHM SUBROUTINE                    3F9B0130
       SPACE   3                                                        3F9B0140
*              DOUBLE PRECISION ARITHMETIC MACRO DEFINITION             3F9B0150
       SPACE                                                            3F9B0160
 DPOP  MACRO   SUBR,A,TAG                                               3F9B0170
       TSX     SUBR,4                                                   3F9B0180
 DTAG  SET     0                                                        3F9B0190
       IFT     TAG=1                                                    3F9B0200
 DTAG  SET     1                                                        3F9B0210
       IFT     TAG=2                                                    3F9B0220
 DTAG  SET     2                                                        3F9B0230
       PZE     A,DTAG                                                   3F9B0240
       PZE     A+1,DTAG                                                 3F9B0250
       ENDM    DPOP                                                     3F9B0260
       SPACE   3                                                        3F9B0270
DLOG10 STL     TEST          TEST DISTINGUISHES DLOG10 FROM DLOG ENTRY  3F9B0280
 DLOG  SXA     SYSLOC,4                                                 3F9B0290
       SXA     LINK,4                                                   3F9B0300
       CAL     3,4                                                      3F9B0310
       ADD     K1A                                                      3F9B0320
       STO     ARG+1                                                    3F9B0330
       LDQ*    ARG+1                                                    3F9B0340
       CLA*    3,4           ARGUMENT IN AC,MQ                          3F9B0350
       TNZ     A             IF ARG=0, ERROR                            3F9B0360
       CALL    .FXEM.(EDLOG1)                                           3F9B0370
       DLD     MOMEGA                                                   3F9B0380
       TRA     RET                                                      3F9B0390
   A   TPL     B             IF ARG NEGATIVE, ERROR                     3F9B0400
       CALL    .FXEM.(EDLOG2)                                           3F9B0410
       SSP                     MQ SIGN WILL BE IGNORED LATER            3F9B0420
   B   DST     ARG           ARGUMENT POSITIVE                          3F9B0430
       SXA     SXR2,2                                                   3F9B0440
       LRS     27                                                       3F9B0450
  K1A  OCT     013100000001    XCA AS OPERATION, K1A AS CONSTANT        3F9B0460
       AXT     0,2                                                      3F9B0470
       CAS     LIM           COMPARE MANTISSA WITH SQRT2/2              3F9B0480
       TXI     *+2,2,2         IF GREATER THAN SQRT2/2, XR2=2           3F9B0490
       TXI     *+1,2,2         IF SMALLER THAN SQRT2/2, XR2=0           3F9B0500
       XCA                                                              3F9B0510
       SUB     K1,2          =O200 OR O201 TO GET EXPONENT IF MANT      3F9B0520
       ORA     CHAR            WAS BIG, EXPONENT-1 IF IT WAS SMALL      3F9B0530
       FAD     CHAR          FLOAT AND NORMALIZE                        3F9B0540
       DPOP    DFMP,LOGTW      LOG X = (P-D)LOG2+LOG((1+Z)/(1-Z))       3F9B0550
       DST     BUFF              WHERE P IS EXPONENT, D=1 OR 0,         3F9B0560
       CLA     ARG+1               AND Z = (M-F)/(M+F)                  3F9B0570
       ANA     MASK          FLOAT MANTISSA                             3F9B0580
       ORA     HALF+1                                                   3F9B0590
       XCA                                                              3F9B0600
       CLA     ARG                                                      3F9B0610
       ANA     MASK                                                     3F9B0620
       ORA     HALF                                                     3F9B0630
       DST     ARG                                                      3F9B0640
       DPOP    DFAD,HALF,2   COMPUTE Z = (M-F)/(M+F)                    3F9B0650
       DST     Z               WHERE F = 1 IF M WAS BIG                 3F9B0660
       CLA     ARG                   F = 1/2 IF M WAS SMALL             3F9B0670
       FSB     HALF,2                                                   3F9B0680
       FAD     ARG+1                                                    3F9B0690
       DPOP    DFDP,Z                                                   3F9B0700
       DST     Z             Z NOW READY                                3F9B0710
       SPACE                                                            3F9B0720
       DPOP    DFMP,Z        ZSQ IN CELL ARG                            3F9B0730
       DST     ARG             LOG((1+Z)/(1-Z)) = Z(2+G(ZSQ))           3F9B0740
       AXT     14,2              WHERE F(ZSQ) IS A 7 DEGREE POLYNOM     3F9B0750
       DLD     COEF,2                                                   3F9B0760
 LOOP  DPOP    DFMP,ARG                                                 3F9B0770
       DPOP    DFAD,COEF+2,2                                            3F9B0780
       TIX     LOOP,2,2                                                 3F9B0790
       DPOP    DFMP,Z                                                   3F9B0800
       DPOP    DFAD,BUFF                                                3F9B0810
       NZT     TEST          NATURAL LOG READY                          3F9B0820
       TRA     SXR2                                                     3F9B0830
       DPOP    DFMP,CLOGE    MULTIPLY LOG E BASE 10                     3F9B0840
 SXR2  AXT     **,2            FOR COMMON LOG ENTRY                     3F9B0850
  RET  LXA     LINK,4                                                   3F9B0860
       STZ     TEST                                                     3F9B0870
       TRA     1,4                                                      3F9B0880
       SPACE                                                            3F9B0890
       OCT     200                                                      3F9B0900
  LIM  OCT     265011714640        SQRT2/2  B0                          3F9B0910
  K1   OCT     201                                                      3F9B0920
 CHAR  OCT     233000000000                                             3F9B0930
 MASK  OCT     777777777                                                3F9B0940
       OCT     201400000000,146000000000                                3F9B0950
 HALF  OCT     200400000000,145000000000                                3F9B0960
       OCT     176457233057,143452334563     0.1480971268990510         3F9B0970
       OCT     176471463374,143233335177     0.1531252792171731         3F9B0980
       OCT     176564315145,143220456006     0.1818363168880382         3F9B0990
       OCT     176707070500,143002037553     0.2222219705656678         3F9B1000
       OCT     177444444445,144050500411     0.2857142876064318         3F9B1010
       OCT     177631463146,144313656522     0.3999999999930233         3F9B1020
       OCT     200525252525,145252525533     0.6666666666666764         3F9B1030
 COEF  OCT     202400000000,147000000002     2. WITH COMPENSATOR        3F9B1040
 LOGTW OCT     200542710277,145575071737     LOG 2 WITH COMPENSATOR     3F9B1050
 CLOGE OCT     177674557305,144223345037       LOG10(E) + FUDGE         3F9B1060
MOMEGA OCT     777777777777,744777777777                                3F9B1070
  ARG  BSS     2                                                        3F9B1080
 BUFF  BSS     2                                                        3F9B1090
   Z   BSS     2                                                        3F9B1100
 TEST  PZE                                                              3F9B1110
EDLOG1 DEC     20                                                       3F9B1120
       PZE     E20MES,,6                                                3F9B1130
       PZE     E20OMS,,4                                                3F9B1140
E20MES BCI     6,0DLOG(0) OR DLOG10(0) NOT ALLOWED                      3F9B1150
E20OMS BCI     4,0SET RESULT = - OMEGA                                  3F9B1160
EDLOG2 DEC     21                                                       3F9B1170
       PZE     E21MES,,6                                                3F9B1180
       PZE     E21OMS,,3                                                3F9B1190
E21MES BCI     6,0DLOG(-X) OR DLOG10(-X) NOT ALLOWED                    3F9B1200
E21OMS BCI     3,0EVALUATE FOR +X                                       3F9B1210
       SPACE                                                            3F9B1220
  LINK LDIR                                                             3F9B1230
BEG94  NULL                                                             3F9B1240
       PCC     ON                                                       3F9B1250
       IFT     M9094=90                                                 3F9B1260
       GOTO    END94                                                    3F9B1270
       PCC     OFF                                                      3F9B1280
       EJECT                                                            3F9B1290
       ENTRY   DLOG                                                     3F9B1300
       ENTRY   DLOG10                                                   3F9B1310
       SPACE   3                                                        3F9B1320
       REM     DOUBLE PRECISION LOGARITHM SUBROUTINE                    3F9B1330
       SPACE   3                                                        3F9B1340
DLOG10 STL     TEST          CELL TEST TO DISTINGUISH DLOG10 FROM DLOG  3F9B1350
 DLOG  SXA     SYSLOC,4                                                 3F9B1360
       SXA     LINK,4                                                   3F9B1370
       STI     SVIND                                                    3F9B1380
       DLD*    3,4           PICK UP DARG,T                             3F9B1390
       TNZ     A                                                        3F9B1400
       CALL    .FXEM.(EDLOG1)   IF ARG = 0, ERROR                       3F9B1410
       DLD     MOMEGA                                                   3F9B1420
       TRA     RET                                                      3F9B1430
   A   TPL     B                                                        3F9B1440
       CALL    .FXEM.(EDLOG2)   IF ARG NEGATIVE, ERROR                  3F9B1450
       SSP                                                              3F9B1460
   B   DST     ARG                                                      3F9B1470
       LRS     27                                                       3F9B1480
       XCA                                                              3F9B1490
       AXT     0,4                                                      3F9B1500
       CAS     LIM           COMPARE MANTISSA WITH SQRT2/2              3F9B1510
       TXI     *+2,4,2         IF GREATER THAN SQRT2/2, XR4=2           3F9B1520
       TXI     *+1,4,2         IF SMALLER THAN SQRT2/2, XR4=0           3F9B1530
       XCA                                                              3F9B1540
       SUB     K1,4          =O200 OR O201 TO GET EXPONENT IF MANT      3F9B1550
       ORA     CHAR            WAS BIG, EXPONENT-1 IF IT WAS SMALL      3F9B1560
       FAD     CHAR          FLOAT AND NORMALIZE                        3F9B1570
       DFMP    LOGTW           LOG X = (P-D)LOG2+LOG((1+Z)/(1-Z))       3F9B1580
       DST     BUFF              WHERE P IS EXPONENT, D=1 OR 0,         3F9B1590
       DLD     ARG                 AND Z = (M-F)/(M+F)                  3F9B1600
       ANA     MASK                                                     3F9B1610
       ORA     HALF          GIVE CHARACTERISTIC O200 TO MANTISSA M     3F9B1620
       STO     ARG                                                      3F9B1630
       DFAD    HALF,4        COMPUTE Z = (M-F)/(M+F)                    3F9B1640
       DST     Z               WHERE F = 1   IF M WAS BIG               3F9B1650
       DLD     ARG                     = 1/2 IF M WAS SMALL             3F9B1660
       DFSB    HALF                                                     3F9B1670
       DFSB    ZERO,4          SUBTRACT F IN 2 STEPS                    3F9B1680
       DFDP    Z                                                        3F9B1690
       DST     Z             Z NOW READY                                3F9B1700
       SPACE                                                            3F9B1710
       DFMP    Z             ZSQ IN CELL ARG                            3F9B1720
       DST     ARG             LOG((1+Z)/(1-Z))=Z(2+G(ZSQ))             3F9B1730
       AXT     14,4              WHERE G(ZSQ) IS A 7 DEGREE POLYNOM     3F9B1740
       DLD     COEF,4                                                   3F9B1750
       DFMP    ARG                                                      3F9B1760
       DFAD    COEF+2,4                                                 3F9B1770
       TIX     *-2,4,2                                                  3F9B1780
       DFMP    Z                                                        3F9B1790
       DFAD    BUFF          NATURAL LOG READY                          3F9B1800
       ZET     TEST                                                     3F9B1810
       DFMP    CLOGE         LOG E BASE 10                              3F9B1820
       LDI     SVIND                                                    3F9B1830
  RET  LXA     LINK,4                                                   3F9B1840
       STZ     TEST                                                     3F9B1850
       TRA     1,4           RETURN TO MAIN PROGRAM                     3F9B1860
       SPACE                                                            3F9B1870
       OCT     200                                                      3F9B1880
  LIM  OCT     265011714640        SQRT2/2  B0                          3F9B1890
  K1   OCT     201                                                      3F9B1900
 CHAR  OCT     233000000000                                             3F9B1910
 MASK  OCT     777777777                                                3F9B1920
       EVEN                                                             3F9B1930
       OCT     201400000000,146000000000                                3F9B1940
 HALF  OCT     200400000000,145000000000                                3F9B1950
 ZERO  OCT     0,0                                                      3F9B1960
       OCT     176457233057,143452334563     0.1480971268990510         3F9B1970
       OCT     176471463374,143233335177     0.1531252792171731         3F9B1980
       OCT     176564315145,143220456006     0.1818363168880382         3F9B1990
       OCT     176707070500,143002037553     0.2222219705656678         3F9B2000
       OCT     177444444445,144050500411     0.2857142876064318         3F9B2010
       OCT     177631463146,144313656522     0.3999999999930233         3F9B2020
       OCT     200525252525,145252525533     0.6666666666666764         3F9B2030
 COEF  OCT     202400000000,147000000002     2. WITH COMPENSATOR        3F9B2040
 LOGTW OCT     200542710277,145575071737     LOG 2 WITH COMPENSATOR     3F9B2050
 CLOGE OCT     177674557305,144223345037       LOG10(E) + FUDGE         3F9B2060
MOMEGA OCT     777777777777,744777777777                                3F9B2070
  ARG  BSS     2                                                        3F9B2080
 BUFF  BSS     2                                                        3F9B2090
   Z   BSS     2                                                        3F9B2100
 TEST  PZE                                                              3F9B2110
 SVIND BSS     1                                                        3F9B2120
EDLOG1 DEC     20                                                       3F9B2130
       PZE     E20MES,,6                                                3F9B2140
       PZE     E20OMS,,4                                                3F9B2150
E20MES BCI     6,0DLOG(0) OR DLOG10(0) NOT ALLOWED                      3F9B2160
E20OMS BCI     4,0SET RESULT = - OMEGA                                  3F9B2170
EDLOG2 DEC     21                                                       3F9B2180
       PZE     E21MES,,6                                                3F9B2190
       PZE     E21OMS,,3                                                3F9B2200
E21MES BCI     6,0DLOG(-X) OR DLOG10(-X) NOT ALLOWED                    3F9B2210
E21OMS BCI     3,0EVALUATE FOR +X                                       3F9B2220
       SPACE                                                            3F9B2230
  LINK LDIR                                                             3F9B2240
END94  NULL                                                             3F9B2250
       END                                                              3F9B2260
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9C0000
$IBMAP FDMD    35                                                       3F9C0010
       TTL     DOUBLE PRECISION MODULUS FUNCTION-DMD                    3F9C0020
DMOD   SAVE    (4)                                                      3F9C0030
       DLD*    4,4                                                      3F9C0040
       DST     Y                                                        3F9C0050
       TZE     ARG2Z                                                    3F9C0060
       DLD*    3,4                                                      3F9C0070
       DST     X                                                        3F9C0080
       DFDP    Y             COMPUTE X/Y                                3F9C0090
       STQ     E1            COMPUTE INTF (X/Y)                         3F9C0100
       UFA     CONST                                                    3F9C0110
       STO     E2                                                       3F9C0120
       XCA                                                              3F9C0130
       UFA     E1                                                       3F9C0140
       UFA     E2                                                       3F9C0150
       STQ     E1            NORMALIZE                                  3F9C0160
       FAD     E1                                                       3F9C0170
       DFMP    Y             COMPUTE Y*INTF(X/Y)                        3F9C0180
       CHS                                                              3F9C0190
       LRS     0                                                        3F9C0200
       DFAD    X             COMPUTE X-Y*INTF(X/Y)                      3F9C0210
       TNZ     *+3                                                      3F9C0220
       SSP                                                              3F9C0230
       LRS     0                                                        3F9C0240
       RETURN  DMOD                                                     3F9C0250
 ARG2Z DLD*    3,4                                                      3F9C0260
       RETURN  DMOD                                                     3F9C0270
 CONST OCT     266000000000,233000000000                                3F9C0280
E1                                                                      3F9C0290
E2                                                                      3F9C0300
E3                                                                      3F9C0310
E4                                                                      3F9C0320
       EVEN                                                             3F9C0330
 X     DEC     0,0                                                      3F9C0340
 Y     DEC     0,0                                                      3F9C0350
       END                                                              3F9C0360
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9D0000
$IBMAP FDSC    150                                                      3F9D0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9D0015
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F9D0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F9D0040
M9094  SET     90                                                       3F9D0050
       PCC     ON                                                       3F9D0060
       IFF     M9094=90                                                 3F9D0070
       GOTO    BEG94                                                    3F9D0080
       PCC     OFF                                                      3F9D0090
       ENTRY   DSIN                                                     3F9D0100
       ENTRY   DCOS                                                     3F9D0110
       SPACE   3                                                        3F9D0120
       REM     DOUBLE PRECISION SINE - COSINE SUBROUTINE                3F9D0130
       SPACE   3                                                        3F9D0140
*              DOUBLE PRECISION ARITHMETIC MACRO DEFINITION             3F9D0150
       SPACE                                                            3F9D0160
 DPOP  MACRO   SUBR,A,TAG                                               3F9D0170
       TSX     SUBR,4                                                   3F9D0180
 DTAG  SET     0                                                        3F9D0190
       IFT     TAG=1                                                    3F9D0200
 DTAG  SET     1                                                        3F9D0210
       IFT     TAG=2                                                    3F9D0220
 DTAG  SET     2                                                        3F9D0230
       PZE     A,DTAG                                                   3F9D0240
       PZE     A+1,DTAG                                                 3F9D0250
       ENDM    DPOP                                                     3F9D0260
       SPACE   3                                                        3F9D0270
 DCOS  STL     TEST          TEST DISTINGUISHES DCOS FROM DSIN ENTRY    3F9D0280
 DSIN  SXA     SYSLOC,4                                                 3F9D0290
       SXA     LINK,4                                                   3F9D0300
       SXA     SXR1,1                                                   3F9D0310
       SXA     SXR2,2                                                   3F9D0320
       CAL     3,4                                                      3F9D0330
       ADM     K1A                                                      3F9D0340
       STO     ARG+1                                                    3F9D0350
       LDQ*    ARG+1                                                    3F9D0360
       CLA*    3,4           ARGUMENT IN AC,MQ                          3F9D0370
       NZT     TEST                                                     3F9D0380
       TRA     A                                                        3F9D0390
       SSM                   IF DCOS ENTRY, SUBTRACT ARG FROM PIOV2     3F9D0400
       LRS     0               AND COMPUTE SINE FOR THIS                3F9D0410
       DPOP    DFAD,PIOV2                                               3F9D0420
   A   DST     ARG           SAVE SIGNED ARGUMENT                       3F9D0430
       SSP                   FORCE POSITIVE                             3F9D0440
       LRS     0                                                        3F9D0450
       DPOP    DFDP,PIOV4    DIVIDE AC, MQ BY PI/4                      3F9D0460
       DST     MDARG         SAVE QUOTIENT                              3F9D0470
       RQL     9             LINE UP 54 BITS OF MANT, LOGICAL           3F9D0480
       LGR     9             CHAR IN AC DECR, MANT IN REST OF AC,MQ     3F9D0490
       PDC     ,2                                                       3F9D0500
       TXL     SMALL,2,0                                                3F9D0510
       TXH     SMALL,2,-103  IF QUOTIENT SMALLER THAN 2**(-26), SKIP    3F9D0520
       AXT     0,1                                                      3F9D0530
       TXH     B,2,-129      IF QUOTIENT SMALLER THAN 1, SKIP           3F9D0540
       TXL     ERROR,2,-181  IF QUOTIENT BIGGER THAN 2**52, ERROR       3F9D0550
       ANA     MASK1         REMOVE CHARACTERISTIC                      3F9D0560
       LGL     -128,2          BRING QUOTIENT TO B17                    3F9D0570
       ANA     MASK2             RETAIN ONLY 3 LOWER INTEGER BITS       3F9D0580
       PDX     ,1            LAST 3 INTEGER BITS TO XR1                 3F9D0590
       ANA     MASK1           THIS TELLS THE OCTANT ARG BELONGED TO    3F9D0600
       LGL     9             ISOLATE FRACTION PART                      3F9D0610
       ORA     CHAR            OF QUOTIENT AND FLOAT IT                 3F9D0620
       STO     MDARG                                                    3F9D0630
  K1A  OCT     -013000000001   (XCL AS OPERATION, K1A AS CONSTANT)      3F9D0640
       ARS     9                                                        3F9D0650
       ORA     CHAR+1                                                   3F9D0660
       STO     MDARG+1         SAVE LOW PART UNNORMALIZED               3F9D0670
       SXD     *+1,1         DOUBLE THE INDEX                           3F9D0680
       TXI     *+1,1,**                                                 3F9D0690
   B   CLA     MDARG         HIGH PART MDARG, POSSIBLY UNNORMALIZED     3F9D0700
       SXA     SIGN,1        SAVE OCTANT FOR SIGN CONTROL               3F9D0710
       TXL     *+2,1,6         AND REDUCE TO UPPER PLANE CASE           3F9D0720
       TXI     *+1,1,-8                                                 3F9D0730
       TXL     READY,1,0       OCTANT NO    RED.ARG   XR1               3F9D0740
       TXL     MOD,1,2           1(0)          F       0    SIN FORM    3F9D0750
       TXI     *+1,1,-2          2(2)         1-F      2    COS FORM    3F9D0760
       TXL     READY,1,2         3(4)          F       2    COS FORM    3F9D0770
       TXI     *+1,1,-4          4(6)         1-F      0    SIN FORM    3F9D0780
       SPACE                                                            3F9D0790
  MOD  CHS                   FOR 2ND AND 4TH OCTANT,                    3F9D0800
       UFA     HALF            TAKE COMPLEMENT OF FRACTION PART         3F9D0810
       UFS     MDARG+1           CARRY OUT 1-X IN AN EXACT FASHION      3F9D0820
       STQ     MDARG+1             NOTING X HAD CHARACTERISTIC O20      3F9D0830
       UFA     HALF                                                     3F9D0840
 READY FAD     MDARG+1                                                  3F9D0850
       DST     MDARG         NORMALIZED REDUCED ARGUMENT IS READY       3F9D0860
       SPACE                                                            3F9D0870
       SXD     EITHR,1       XR1=0 FOR SINE FORMULA, =2 FOR COSINE      3F9D0880
       DPOP    DFMP,MDARG                                               3F9D0890
       DST     SQ                                                       3F9D0900
       AXT     22,2          COMPUTE SINE OR COSINE OF REDUCED          3F9D0910
 EITHR TXI     *+1,2,**        ARG, USING POLYNOMIAL OF DEGREE 6        3F9D0920
       DLD     COEF-2,2          IN SQ                                  3F9D0930
 LOOP  DPOP    DFMP,SQ                                                  3F9D0940
       DPOP    DFAD,COEF+2,2                                            3F9D0950
       TIX     LOOP,2,4                                                 3F9D0960
       TXH     D,2,2         IF COSINE FORMULA, SKIP                    3F9D0970
       DPOP    DFMP,MDARG                                               3F9D0980
   D   STQ     ARG+1         ADJUST SIGN ACCORDING TO ORIG ARG          3F9D0990
       LDQ     ARG                                                      3F9D1000
       LLS     0                                                        3F9D1010
       LDQ     ARG+1                                                    3F9D1020
 SIGN  AXT     **,2                                                     3F9D1030
       TXL     *+2,2,6       IF MAGNITUDE WAS IN LOWER                  3F9D1040
       CHS                     PLANE, CHANGE SIGN                       3F9D1050
       LRS     0                                                        3F9D1060
  RET  LXA     LINK,4                                                   3F9D1070
 SXR1  AXT     **,1                                                     3F9D1080
 SXR2  AXT     **,2                                                     3F9D1090
       STZ     TEST                                                     3F9D1100
       TRA     1,4                                                      3F9D1110
       SPACE                                                            3F9D1120
 SMALL DLD     ARG                                                      3F9D1130
       TRA     RET                                                      3F9D1140
       SPACE                                                            3F9D1150
 ERROR CALL    .FXEM.(EDSC)                                             3F9D1160
       LRS     72                                                       3F9D1170
       TRA     RET                                                      3F9D1180
       SPACE                                                            3F9D1190
 CHAR  OCT     200000000000,145000000000                                3F9D1200
 MASK1 OCT     777777          THIS MASK IS USED ALSO                   3F9D1210
 MASK2 OCT     7777777           FOR NORMALING A NUMBER                 3F9D1220
  ARG  BSS     2                                                        3F9D1230
 MDARG BSS     2                                                        3F9D1240
  SQ   BSS     1                                                        3F9D1250
 TEST  PZE                         FLAG, ALSO LOW PART OF SQ            3F9D1260
 PIOV2 OCT     201622077325        =DEC MOST SIGNIFICANT PI/2           3F9D1270
       OCT     146042055061        =DEC LEAST SIGNIFICANT PI/2          3F9D1280
 PIOV4 OCT     200622077325,145042055060                                3F9D1290
       OCT     137763726026,104102620745    C6    1136682051698955E-9   3F9D1300
       OCT     133743747016,100265505502    S6   .6877360570940358E-11  3F9D1310
       OCT     -147646623713,-114740433061  C5  -.2460955082796532E-7   3F9D1320
       OCT     -143743000706,-110575743132  S5  -.1757150074693567E-8   3F9D1330
       OCT     156741751757,123324334421    C4   .3590859234205475E-5   3F9D1340
       OCT     153520360277,120320455223    S4   .3133616225433375E-6   3F9D1350
       OCT     -165525647437,-132344353644  C3  -.3259918865158837E-3   3F9D1360
       OCT     -162462645463,-127427133062  S3  -.3657620415891387E-4   3F9D1370
       OCT     173403603702,140015421766    C2   .1585434424375085E-1   3F9D1380
       OCT     170506327431,135672607757    S2   .2490394570188844E-2   3F9D1390
       OCT     -177473647462,-144337105501  C1  -.3084251375340389E+0   3F9D1400
       OCT     -175512567471,-142422676173  S1  -.8074551218828053E-1   3F9D1410
  ONE  OCT     201400000000,146000000000    C0   .1000000000000000E+1   3F9D1420
 COEF  OCT     200622077325,145042055063    S0   .7853981633974483E+0   3F9D1430
 HALF  OCT     200400000000                                             3F9D1440
 EDSC  DEC     23                                                       3F9D1450
       PZE     E23MES,,11                                               3F9D1460
       PZE     E23OMS,,3                                                3F9D1470
E23MES BCI     7,0DSIN(X) OR DCOS(X), /X/ GRT THAN OR EQ TO             3F9D1480
       BCI     4, PI*2**50 NOT ALLOWED                                  3F9D1485
E23OMS BCI     3,0SET RESULT = 0                                        3F9D1490
       SPACE                                                            3F9D1500
  LINK LDIR                                                             3F9D1510
BEG94  NULL                                                             3F9D1520
       PCC     ON                                                       3F9D1530
       IFT     M9094=90                                                 3F9D1540
       GOTO    END94                                                    3F9D1550
       PCC     OFF                                                      3F9D1560
       EJECT                                                            3F9D1570
       ENTRY   DSIN                                                     3F9D1580
       ENTRY   DCOS                                                     3F9D1590
       SPACE   3                                                        3F9D1600
       REM     DOUBLE PRECISION SINE - COSINE SUBROUTINE                3F9D1610
       SPACE   3                                                        3F9D1620
 DCOS  DLD*    3,4           ENTER HERE FOR COSINE                      3F9D1630
       SSM                                                              3F9D1640
       STI     SVIND                                                    3F9D1650
       DFAD    PIOV2                                                    3F9D1660
       TRA     *+3                                                      3F9D1670
 DSIN  DLD*    3,4           ENTER HERE FOR SINE                        3F9D1680
       STI     SVIND                                                    3F9D1690
       DST     ARG                                                      3F9D1700
       SXA     SYSLOC,4                                                 3F9D1710
       SXA     LINK,4                                                   3F9D1720
       SXA     SXR2,2                                                   3F9D1730
       SSP                                                              3F9D1740
       DFDP    COEF                                                     3F9D1750
       DST     MDARG                                                    3F9D1760
       RQL     9             LINE UP 54 BITS OF MANT, LOGICAL           3F9D1770
       LGR     9             CHAR IN AC DECR, MANT IN REST OF AC MQ     3F9D1780
       PDC     ,4                                                       3F9D1790
       TXL     SMALL,4,0                                                3F9D1800
       TXH     SMALL,4,-103  IF QUOTIENT SMALLER THAN 2**(-26), SKIP    3F9D1810
       AXT     0,2                                                      3F9D1820
       TXH     B,4,-129      IF QUOTIENT SMALLER THAN 1, SKIP           3F9D1830
       TXL     ERROR,4,-181  IF QUOTIENT BIGGER THAN 2**52, ERROR       3F9D1840
       ANA     MASK1         REMOVE CHARACTERISTIC                      3F9D1850
       LGL     -128,4          BRING QUOTIENT TO B17                    3F9D1860
       ANA     MASK2             RETAIN ONLY 3 LOWER INTEGER BITS       3F9D1870
       PDX     ,2            LAST 3 INTEGER BITS TO XR2                 3F9D1880
       ANA     MASK1           THIS TELLS THE OCTANT ARG BELONGED       3F9D1890
       LGL     9             ISOLATE FRACTION PART                      3F9D1900
       ORA     CHAR            OF QUOTIENT AND                          3F9D1910
       RQL     27                FLOAT AND NORMALIZE IT                 3F9D1920
       DFAD    MASK1                                                    3F9D1930
       SXD     *+1,2         DOUBLE THE INDEX                           3F9D1940
       TXI     *+2,2,**                                                 3F9D1950
   B   DLD     MDARG                                                    3F9D1960
       SXA     SIGN,2                                                   3F9D1970
       TXL     *+2,2,6       TAKES CARE OF THE UPPER PLANE.             3F9D1980
       TXI     *+1,2,-8      FOR THE LOWER HALF PLANE.                  3F9D1990
       TXL     READY,2,0                                                3F9D2000
       TXL     MOD,2,2                                                  3F9D2010
       TXI     *+1,2,-2      FOR FIRST AND THIRD OCTANTS OUR MOD.ARG IS 3F9D2020
       TXL     READY,2,2         THE FRACTIONAL QUOTIENT.               3F9D2030
       TXI     *+1,2,-4      NOW XR2 IS REDUCED TO 0 OR 2               3F9D2040
  MOD  CHS                   FOR SECOND AND FOURTH OCTANTS OUR MOD.ARG  3F9D2050
       DFAD    HALF              IS (1-FRACTION QUOTIENT).   ADD 1      3F9D2060
       DFAD    HALF              IN 2 STEPS                             3F9D2070
 READY DST     MDARG                                                    3F9D2080
       SPACE                                                            3F9D2090
       SXD     EITHR,2       XR2=0 USE SINE FORMULA, =2 COSINE FORMULA. 3F9D2100
       DFMP    MDARG                                                    3F9D2110
       DST     SQ                                                       3F9D2120
       AXT     22,4                                                     3F9D2130
 EITHR TXI     *+1,4,**      **=0 FOR SINE FORMULA, =2 FOR COSINE FORM. 3F9D2140
       DLD     COEF-2,4                                                 3F9D2150
 LOOP  DFMP    SQ                                                       3F9D2160
       DFAD    COEF+2,4                                                 3F9D2170
       TIX     LOOP,4,4      WHEN OUT OF LOOP XR4 EITHER 2 OR 4         3F9D2180
       TXH     *+2,4,2                                                  3F9D2190
       DFMP    MDARG         COMPLETE SINE FORMULA.                     3F9D2200
       STQ     ARG+1                                                    3F9D2210
       LDQ     ARG           ADJUSTMENT OF SIGN STARTS HERE.            3F9D2220
       LLS     0                                                        3F9D2230
       LDQ     ARG+1                                                    3F9D2240
 SIGN  AXT     **,2          AT THIS POINT XR2 = 0 OR 2,4,6,8,...OR 14  3F9D2250
       TXL     *+2,2,6                                                  3F9D2260
       CHS                   CHANGE SIGN FOR THE LOWER HALF PLANE.      3F9D2270
       LRS     0                                                        3F9D2280
  RET  LXA     LINK,4                                                   3F9D2290
 SXR2  AXT     **,2                                                     3F9D2300
       LDI     SVIND                                                    3F9D2310
       TRA     1,4                                                      3F9D2320
       SPACE                                                            3F9D2330
 SMALL DLD     ARG           FOR ARG LESS THAN PI*2**(-28)              3F9D2340
       TRA     RET             GIVE ARG AS VALUE OF SINE                3F9D2350
       SPACE                                                            3F9D2360
 ERROR CALL    .FXEM.(EDSC)                                             3F9D2370
       LRS     72                                                       3F9D2380
       TRA     RET                                                      3F9D2390
       SPACE                                                            3F9D2400
 CHAR  OCT     200000000000                                             3F9D2410
       EVEN                                                             3F9D2420
 MASK1 OCT     777777          THIS MASK IS USED ALSO                   3F9D2430
 MASK2 OCT     7777777           FOR NORMALING A NUMBER                 3F9D2440
  ARG  BSS     2                                                        3F9D2450
 MDARG BSS     2                                                        3F9D2460
  SQ   BSS     2                                                        3F9D2470
 PIOV2 OCT     201622077325        =DEC MOST SIGNIFICANT PI/2           3F9D2480
       OCT     146042055061        =DEC LEAST SIGNIFICANT PI/2          3F9D2490
       OCT     137763726026,104102620745    C6    1136682051698955E-9   3F9D2500
       OCT     133743747016,100265505502    S6   .6877360570940358E-11  3F9D2510
       OCT     -147646623713,-114740433061  C5  -.2460955082796532E-7   3F9D2520
       OCT     -143743000706,-110575743132  S5  -.1757150074693567E-8   3F9D2530
       OCT     156741751757,123324334421    C4   .3590859234205475E-5   3F9D2540
       OCT     153520360277,120320455223    S4   .3133616225433375E-6   3F9D2550
       OCT     -165525647437,-132344353644  C3  -.3259918865158837E-3   3F9D2560
       OCT     -162462645463,-127427133062  S3  -.3657620415891387E-4   3F9D2570
       OCT     173403603702,140015421766    C2   .1585434424375085E-1   3F9D2580
       OCT     170506327431,135672607757    S2   .2490394570188844E-2   3F9D2590
       OCT     -177473647462,-144337105501  C1  -.3084251375340389E+0   3F9D2600
       OCT     -175512567471,-142422676173  S1  -.8074551218828053E-1   3F9D2610
       OCT     201400000000,146000000000    C0   .1000000000000000E+1   3F9D2620
 COEF  OCT     200622077325,145042055061    S0   .7853981633974483E+0   3F9D2630
 HALF  OCT     200400000000,145000000000                                3F9D2640
 SVIND BSS     1                                                        3F9D2650
 EDSC  DEC     23                                                       3F9D2660
       PZE     E23MES,,11                                               3F9D2670
       PZE     E23OMS,,3                                                3F9D2680
E23MES BCI     7,0DSIN(X) OR DCOS(X), /X/ GRT THAN OR EQ TO             3F9D2690
       BCI     4, PI*2**50 NOT ALLOWED                                  3F9D2695
E23OMS BCI     3,0SET RESULT = 0                                        3F9D2700
       SPACE                                                            3F9D2710
  LINK LDIR                                                             3F9D2720
END94  NULL                                                             3F9D2730
       END                                                              3F9D2740
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9E0000
$IBMAP FDSQ    150                                                      3F9E0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9E0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F9E0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F9E0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F9E0040
M9094  SET     90                                                       3F9E0050
       PCC     ON                                                       3F9E0060
       IFF     M9094=90                                                 3F9E0070
       GOTO    BEG94                                                    3F9E0080
       PCC     OFF                                                      3F9E0090
       ENTRY   DSQRT                                                    3F9E0100
       SPACE   3                                                        3F9E0110
       REM     DOUBLE PRECISION SQUARE ROOT SUBROUTINE                  3F9E0120
       SPACE   3                                                        3F9E0130
 DSQRT SXA     SYSLOC,4                                                 3F9E0140
       SXA     LINK,4                                                   3F9E0150
       CAL     3,4           OBTAIN ARGUMENT                            3F9E0160
       ADD     K1A                                                      3F9E0170
       STO     ARG                                                      3F9E0180
       LDQ*    ARG                                                      3F9E0190
       CLA*    3,4                                                      3F9E0200
       TZE     1,4           IF ARG = 0, ANS = 0                        3F9E0210
       TPL     A             IF ARG NEGATIVE, ERROR                     3F9E0220
       SPACE                                                            3F9E0230
       CALL    .FXEM.(EDSQRT)                                           3F9E0240
       SSP                                                              3F9E0250
       LRS     0                                                        3F9E0260
       SPACE                                                            3F9E0270
   A   STO     ARG                                                      3F9E0280
       STQ     ARG+1                                                    3F9E0290
       ANA     K1            1ST APPROXIMATION IS MADE AS FOLLOWS       3F9E0300
       ARS     1               BETWEEN 1/2 AND 1, BY LINE PASSING THRU  3F9E0310
       ADD     ARG               3/4 AND 1                              3F9E0320
       ARS     1               BETWEEN 1/4 AND 1/2 BY LINE PASSING THRU 3F9E0330
       ADD     K2                1/2 AND 3/4                            3F9E0340
       SPACE                                                            3F9E0350
       AXT     3,4                                                      3F9E0360
 LOOP  STO     BUFF          THREE PASSES OF NEWTON RAPHSON LOOP IN     3F9E0370
       CLA     ARG             SINGLE PRECISION                         3F9E0380
       FDP     BUFF                                                     3F9E0390
  K1A  OCT     013100000001     XCA AS OPERATION, K1A AS CONSTANT       3F9E0400
       FAD     BUFF                                                     3F9E0410
       SUB     K1                                                       3F9E0420
       TIX     LOOP,4,1                                                 3F9E0430
       SPACE                                                            3F9E0440
       STO     BUFF          ONE MORE PASS OF NEWTON RAPHSON LOOP,      3F9E0450
       CLA     ARG             THIS TIME IN SIMULATED DOUBLE PRECISION  3F9E0460
       FDP     BUFF          A/C = Q1 + R1        (ARGUMENT X = A + B)  3F9E0470
       STQ     ARG           STORE Q1        (THREE PASS APPROX Y = C)  3F9E0480
       FAD     ARG+1                                                    3F9E0490
       FDP     BUFF          (R1 + B)/C = Q2 + R2   (DISCARD R2)        3F9E0500
       STQ     ARG+1         STORE Q2                                   3F9E0510
       CLA     BUFF                                                     3F9E0520
       FAD     ARG           C + Q1 = D1 + D2                           3F9E0530
       SUB     K1                                                       3F9E0540
       STO     ARG           STORE D1/2                                 3F9E0550
       XCA                                                              3F9E0560
       FAD     ARG+1         D2 + Q2                                    3F9E0570
       SUB     K1                                                       3F9E0580
       FAD     ARG           DOUBLE PRECISION ANSWER IS NOW IN PLACE    3F9E0590
       SPACE                                                            3F9E0600
       LXA     LINK,4                                                   3F9E0610
       TRA     1,4                                                      3F9E0620
       SPACE                                                            3F9E0630
  K1   OCT     1000000000                                               3F9E0640
  K2   OCT     100400000000                                             3F9E0650
  ARG  BSS     2                                                        3F9E0660
 BUFF  BSS     1                                                        3F9E0670
EDSQRT DEC     22                                                       3F9E0680
       PZE     E22MES,,4                                                3F9E0690
       PZE     E22OMS,,3                                                3F9E0700
E22MES BCI     4,0DSQRT(-X) NOT ALLOWED                                 3F9E0710
E22OMS BCI     3,0EVALUATE FOR +X                                       3F9E0720
       SPACE                                                            3F9E0730
  LINK LDIR                                                             3F9E0740
BEG94  NULL                                                             3F9E0750
       PCC     ON                                                       3F9E0760
       IFT     M9094=90                                                 3F9E0770
       GOTO    END94                                                    3F9E0780
       PCC     OFF                                                      3F9E0790
       EJECT                                                            3F9E0800
       ENTRY   DSQRT                                                    3F9E0810
       SPACE   3                                                        3F9E0820
       REM     DOUBLE PRECISION SQUARE ROOT SUBROUTINE                  3F9E0830
       SPACE   3                                                        3F9E0840
 DSQRT SXA     SYSLOC,4                                                 3F9E0850
       SXA     LINK,4                                                   3F9E0860
       DLD*    3,4           PICK UP DARG,T                             3F9E0870
       TZE     1,4                                                      3F9E0880
       STI     SVIND                                                    3F9E0890
       TPL     A                                                        3F9E0900
       SPACE                                                            3F9E0910
       CALL    .FXEM.(EDSQRT)                                           3F9E0920
       SSP                                                              3F9E0930
       SPACE                                                            3F9E0940
   A   DST     ARG                                                      3F9E0950
       ANA     K1            1ST APPROXIMATION IS MADE AS FOLLOWS       3F9E0960
       ARS     1               BETWEEN 1/2 AND 1, BY LINE PASSING THRU  3F9E0970
       ADD     ARG               3/4 AND 1                              3F9E0980
       ARS     1               BETWEEN 1/4 AND 1/2 BY LINE PASSING THRU 3F9E0990
       ADD     K2                1/2 AND 3/4                            3F9E1000
       SPACE                                                            3F9E1010
       AXT     3,4                                                      3F9E1020
 LOOP  STO     BUFF          THREE PASSES OF NEWTON RAPHSON LOOP IN     3F9E1030
       CLA     ARG             SINGLE PRECISION                         3F9E1040
       FDP     BUFF                                                     3F9E1050
       XCA                                                              3F9E1060
       FAD     BUFF                                                     3F9E1070
       SUB     K1                                                       3F9E1080
       TIX     LOOP,4,1                                                 3F9E1090
       DST     BUFF          ONE MORE PASS OF NEWTON RAPHSON LOOP,      3F9E1100
       DLD     ARG             THIS TIME IN DOUBLE PRECISION            3F9E1110
       DFDP    BUFF                                                     3F9E1120
       DFAD    BUFF                                                     3F9E1130
       SUB     K1                                                       3F9E1140
       XCA                                                              3F9E1150
       SUB     K1                                                       3F9E1160
       XCA                                                              3F9E1170
  RET  LXA     LINK,4                                                   3F9E1180
       LDI     SVIND                                                    3F9E1190
       TRA     1,4                                                      3F9E1200
       SPACE                                                            3F9E1210
  K1   OCT     1000000000                                               3F9E1220
  K2   OCT     100400000000                                             3F9E1230
       EVEN                                                             3F9E1240
  ARG  BSS     2                                                        3F9E1250
 BUFF  BSS     2                                                        3F9E1260
 SVIND BSS     1                                                        3F9E1270
EDSQRT DEC     22                                                       3F9E1280
       PZE     E22MES,,4                                                3F9E1290
       PZE     E22OMS,,3                                                3F9E1300
E22MES BCI     4,0DSQRT(-X) NOT ALLOWED                                 3F9E1310
E22OMS BCI     3,0EVALUATE FOR +X                                       3F9E1320
       SPACE                                                            3F9E1330
  LINK LDIR                                                             3F9E1340
END94  NULL                                                             3F9E1350
       END                                                              3F9E1360
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9F0000
$IBMAP FDAT    150                                                      3F9F0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9F0015
       REM     TO ASSEMBLE REGULAR ROUTINE, SET M9094 = 90,             3F9F0020
       REM     TO ASSEMBLE OPTIONAL ROUTINE, SET M9094 = 94.            3F9F0030
       REM       (OR TO ANY VALUE NOT EQUAL TO 90)                      3F9F0040
M9094  SET     90                                                       3F9F0050
       PCC     ON                                                       3F9F0060
       IFF     M9094=90                                                 3F9F0070
       GOTO    BEG94                                                    3F9F0080
       PCC     OFF                                                      3F9F0090
       ENTRY   DATAN                                                    3F9F0100
       ENTRY   DATAN2                                                   3F9F0110
       SPACE   3                                                        3F9F0120
*              DOUBLE PRECISION ARCTANGENT SUBROUTINE                   3F9F0130
*                  DATAN ACCEPTS A SINGLE ARGUMENT AND ANSWER IS        3F9F0140
*                    BETWEEN -PI/2 AND PI/2                             3F9F0150
*                  DATAN2 ACCEPTS A PAIR OF ARGUMENTS - ORDINATE AND    3F9F0160
*                    ABSCISSA, AND ANSWER IS BETWEEN -PI AND PI         3F9F0170
       SPACE   3                                                        3F9F0180
*              DOUBLE PRECISION ARITHMETIC MACRO DEFINITION             3F9F0190
       SPACE                                                            3F9F0200
 DPOP  MACRO   SUBR,A,TAG                                               3F9F0210
       TSX     SUBR,4                                                   3F9F0220
 DTAG  SET     0                                                        3F9F0230
       IFT     TAG=1                                                    3F9F0240
 DTAG  SET     1                                                        3F9F0250
       IFT     TAG=2                                                    3F9F0260
 DTAG  SET     2                                                        3F9F0270
       PZE     A,DTAG                                                   3F9F0280
       PZE     A+1,DTAG                                                 3F9F0290
       ENDM    DPOP                                                     3F9F0300
       SPACE   3                                                        3F9F0310
DATAN2 STL     FLAG          FLAG TO DISTINGUISH DATAN2                 3F9F0320
 DATAN SXA     SYSLOC,4                                                 3F9F0330
       SXA     LINK,4                                                   3F9F0340
       SXA     SXR1,1                                                   3F9F0350
       SXA     SXR2,2                                                   3F9F0360
       CAL     3,4                                                      3F9F0370
       ADD     K1A                                                      3F9F0380
       STO     ARG+1                                                    3F9F0390
       CLA*    3,4                                                      3F9F0400
       LDQ*    ARG+1         THE 1ST OR ONLY ARG IN AC,MQ               3F9F0410
       NZT     FLAG                                                     3F9F0420
       TRA     DATAN1        IF DATAN ENTRY, SKIP                       3F9F0430
       ZET*    4,4                                                      3F9F0440
       TRA     BB            IF X IS NOT ZERO,SKIP AND PROCEED          3F9F0450
       TNZ     AA                                                       3F9F0460
       CALL    .FXEM.(EDAT)  IF BOTH X AND Y ARE ZERO, ERROR            3F9F0470
       ZAC                                                              3F9F0480
       LRS     36                                                       3F9F0490
       TRA     RET                                                      3F9F0500
  AA   LDQ     PIOV2+1       IF ONLY X IS ZERO, ANSWER IS + OR -PI/2    3F9F0510
       LRS     0               DEPENDING ON SIGN OF Y                   3F9F0520
       CLA     PIOV2                                                    3F9F0530
       LLS     0                                                        3F9F0540
       TRA     RET                                                      3F9F0550
  BB   CAL     4,4           NOW X IS NOT ZERO                          3F9F0560
       STO     ADMX            SET ADDRESS POINTER FOR X PAIR           3F9F0570
       ADD     K1A                                                      3F9F0580
       STO     ADLX                                                     3F9F0590
       CLA*    4,4           IF X IS POSITIVE, RESET FLAG               3F9F0600
       TMI     *+2                                                      3F9F0610
       STZ     FLAG                                                     3F9F0620
       ACL     CH54                                                     3F9F0630
       SLW     TEST                                                     3F9F0640
       CLA*    3,4           OBTAIN Y AGAIN                             3F9F0650
       LDQ*    ARG+1                                                    3F9F0660
       LAS     TEST          IF Y IS GREATER THAN X*2**54 IN ABSOLUTE   3F9F0670
  K1A  AXT     1,0             VALUE, TREAT AS IF X WERE 0 TO AVOID     3F9F0680
       TRA     AA                DIVIDE OVERFLOW                        3F9F0690
       TSX     DFDP,4        OBTAIN Y/X AND JOIN WITH DATAN             3F9F0700
 ADMX  PZE                                                              3F9F0710
 ADLX  PZE                                                              3F9F0720
       SPACE                                                            3F9F0730
DATAN1 STO     TEST          USED FOR SIGN CONTROL ONLY. THEN           3F9F0740
       SSP                     FORCE SIGN TO BE +                       3F9F0750
       LRS     0                                                        3F9F0760
       DST     ARG                                                      3F9F0770
       ARS     9                                                        3F9F0780
       PDX     ,1                                                       3F9F0790
       TXL     *+4,1,182                                                3F9F0800
       DLD     PIOV2         IF ARG IS GREATER THAN 2**54,              3F9F0810
       TRA     SIGN            GIVE + OR -PI/2 AS ANSWER                3F9F0820
       CLA     ARG                                                      3F9F0830
       TXL     SIGN,1,101    IF ARG IS SMALLER THAN 2**(-27), ANS=ARG   3F9F0840
       AXT     0,2           XR2 IS USED TO DISTINGUISH SECTIONS        3F9F0850
       TXL     A,1,128                                                  3F9F0860
       CLS     MONE          IF ARG IS GREATER THAN 1, TAKE INVERSE     3F9F0870
       LDQ     MONE+1                                                   3F9F0880
       DPOP    DFDP,ARG                                                 3F9F0890
       TXI     *+1,2,4       XR2 TO DISTINGUISH CASES                   3F9F0900
   A   CAS     TAN15                                                    3F9F0910
       TXI     *+3,2,2                                                  3F9F0920
       TRA     B                                                        3F9F0930
       TRA     B                                                        3F9F0940
       DST     ARG           IF MODIFIED ARG, SAY X, IS GREATER THAN    3F9F0950
       DPOP    DFAD,RTTHR      TAN (PI/12), COMPUTE TAN Z WHERE         3F9F0960
       DST     BUFF              TAN (Z+PI/6) = X                       3F9F0970
       DLD     ARG                 TAN Z = (XSQRT3-1)/(X+SQRT3)         3F9F0980
       DPOP    DFMP,RT3M1    COMPUTE NUMERATOR WITH CARE                3F9F0990
       DPOP    DFAD,MONE       TO PRESERVE ACCURACY                     3F9F1000
       DPOP    DFAD,ARG                                                 3F9F1010
       DPOP    DFDP,BUFF                                                3F9F1020
       SPACE                                                            3F9F1030
   B   DST     ARG           NOW ARG IS REDUCED TO LESS THAN            3F9F1040
       DPOP    DFMP,ARG        TAN(PI/2) IN ABSOLUTE VALUE              3F9F1050
       DST     SQ                                                       3F9F1060
       AXT     16,1                                                     3F9F1070
       LRS     72                                                       3F9F1080
 LOOP  DPOP    DFAD,COEF+2,1 ATAN X = X(1+F*SQ) WHERE                   3F9F1090
       DPOP    DFAD,SQ         F = A1/(SQ+B1+A2/(SQ+B2+A3/.../(SQ+B4))) 3F9F1100
       DST     BUFF                                                     3F9F1110
       DLD     COEF+4,1                                                 3F9F1120
       DPOP    DFDP,BUFF                                                3F9F1130
       TIX     LOOP,1,4                                                 3F9F1140
       DPOP    DFMP,SQ                                                  3F9F1150
       DPOP    DFMP,ARG                                                 3F9F1160
       DPOP    DFAD,ARG                                                 3F9F1170
       TXL     *+3,2,2       REDUCED ANSWER READY                       3F9F1180
       CHS                   DEPENDING ON SECTION, ADD OR SUBTRACT      3F9F1190
       LRS     0               REDUCED ANS FROM PROPER BASE ANGLE       3F9F1200
       DPOP    DFAD,ZERO,2                                              3F9F1210
       SPACE                                                            3F9F1220
 SIGN  STQ     BUFF+1        AFFIX PROPER SIGN AND RETURN TO            3F9F1230
       LDQ     TEST            EITHER MAIN PROGRAM OR DATAN2 CIRCUIT    3F9F1240
       LLS     0                                                        3F9F1250
       LDQ     BUFF+1                                                   3F9F1260
       LRS     0             DATAN ANSWER IS READY                      3F9F1270
       NZT     FLAG            UNLESS DATAN2 ENTRY AND ABSCISSA         3F9F1280
       TRA     FIN               WAS NEGATIVE, JUMP                     3F9F1290
       DST     BUFF          IF ABSCISSA NEGATIVE, ADD OR SUBTRACT      3F9F1300
       CHS                     PI DEPENDING ON SIGN OF DATAN ANSWER     3F9F1310
       LDQ     PI+1                                                     3F9F1320
       LRS     0                                                        3F9F1330
       CLA     PI                                                       3F9F1340
       LLS     0                                                        3F9F1350
       DPOP    DFAD,BUFF                                                3F9F1360
  RET  STZ     FLAG          RETURN                                     3F9F1370
  FIN  LXA     LINK,4                                                   3F9F1380
 SXR1  AXT     **,1                                                     3F9F1390
 SXR2  AXT     **,2                                                     3F9F1400
       TRA     1,4                                                      3F9F1410
       SPACE                                                            3F9F1420
 CH54  OCT     66000000000                                              3F9F1430
 TAN15 OCT     177422302430                    TAN (PI/12)              3F9F1440
  PI   OCT     202622077325,147042055061       PI                       3F9F1450
 MONE  OCT     -201400000000,-146000000000                              3F9F1460
 RTTHR OCT     201673317272,146054114525       SQRT 3                   3F9F1470
 RT3M1 OCT     200566636564,145130231252      SQRT 3 - 1                3F9F1480
       OCT     201503750266,146215675354       B4=1.26544461067154890   3F9F1490
       OCT     -175502167171,-142623566535     A4=-.0786701382962415653 3F9F1500
       OCT     202421475516,147135555470       B3=2.13765949556336733   3F9F1510
       OCT     -201464652334,-146216516352     A3=-1.20637840447753071  3F9F1520
       OCT     203641102513,150504766775       B2=6.51765892712660257   3F9F1530
       OCT     -204667070204,-151374053176     A2=-13.7221837630692088  3F9F1540
       OCT     203464256777,150355624132       B1=4.81784054424956026   3F9F1550
 COEF  OCT     -200653574647,-145152175341     A1=-.835437113102598223  3F9F1560
       OCT     201414052216,146026563313       PI/3                     3F9F1570
 PIOV2 OCT     201622077325,146042055061       PI/2                     3F9F1580
       OCT     200414052216,145026563313       PI/6                     3F9F1590
 ZERO  OCT     0,0                                                      3F9F1600
  ARG  BSS     2                                                        3F9F1610
  SQ   BSS     2                                                        3F9F1620
 BUFF  BSS     2                                                        3F9F1630
 TEST  BSS     1                                                        3F9F1640
 FLAG  PZE                                                              3F9F1650
 EDAT  DEC     24                                                       3F9F1660
       PZE     E24MES,,4                                                3F9F1670
       PZE     E24OMS,,3                                                3F9F1680
E24MES BCI     4,0DATAN2(0,0) NOT ALLOWED                               3F9F1690
E24OMS BCI     3,0SET RESULT = 0                                        3F9F1700
       SPACE                                                            3F9F1710
  LINK LDIR                                                             3F9F1720
BEG94  NULL                                                             3F9F1730
       PCC     ON                                                       3F9F1740
       IFT     M9094=90                                                 3F9F1750
       GOTO    END94                                                    3F9F1760
       PCC     OFF                                                      3F9F1770
       EJECT                                                            3F9F1780
       ENTRY   DATAN                                                    3F9F1790
       ENTRY   DATAN2                                                   3F9F1800
       SPACE   3                                                        3F9F1810
*              DOUBLE PRECISION ARCTANGENT SUBROUTINE                   3F9F1820
*                  DATAN ACCEPTS A SINGLE ARGUMENT AND ANSWER IS        3F9F1830
*                    BETWEEN -PI/2 AND PI/2                             3F9F1840
*                  DATAN2 ACCEPTS A PAIR OF ARGUMENTS - ORDINATE AND    3F9F1850
*                    ABSCISSA, AND ANSWER IS BETWEEN -PI AND PI         3F9F1860
       SPACE   3                                                        3F9F1870
DATAN2 STL     FLAG                                                     3F9F1880
 DATAN SXA     SYSLOC,4                                                 3F9F1890
       SXA     LINK,4                                                   3F9F1900
       STI     SVIND                                                    3F9F1910
       DLD*    3,4           PICK UP DARG,T                             3F9F1920
       NZT     FLAG                                                     3F9F1930
       TRA     DATAN1        IF DATAN ENTRY, SKIP                       3F9F1940
       ZET*    4,4                                                      3F9F1950
       TRA     BB            IF X IS NOT ZERO, SKIP AND PROCEED         3F9F1960
       TNZ     AA                                                       3F9F1970
       CALL    .FXEM.(EDAT)  IF BOTH X AND Y ARE ZERO, ERROR            3F9F1980
       DLD     ZERO                                                     3F9F1990
       LXA     LINK,4                                                   3F9F2000
       TRA     RET                                                      3F9F2010
  AA   LDQ     PIOV2+1       IF ONLY X IS ZERO, ANSWER IS + OR -PI/2    3F9F2020
       LRS     0               DEPENDING ON SIGN OF Y                   3F9F2030
       CLA     PIOV2                                                    3F9F2040
       LLS     0                                                        3F9F2050
       TRA     RET                                                      3F9F2060
  BB   CLA*    4,4                                                      3F9F2070
       ACL     CH54          NOW X IS NOT ZERO                          3F9F2080
       SLW     TEST                                                     3F9F2090
       DLD*    3,4                                                      3F9F2100
       LAS     TEST            IF Y IS GREATER THAN X*2**54 IN ABSOLUTE 3F9F2110
       TRA     AA                VALUE, TREAT AS IF X WERE 0 TO AVOID   3F9F2120
       TRA     AA                DIVIDE OVERFLOW                        3F9F2130
       DFDP*   4,4           OBTAIN Y/X AND JOIN WITH DATAN             3F9F2140
DATAN1 SXA     SXR1,1                                                   3F9F2150
       STO     TEST          USED FOR SIGN CONTROL ONLY.   THEN FORCE   3F9F2160
       SSP                     SIGN TO BE +                             3F9F2170
       DST     ARG                                                      3F9F2180
       ARS     9                                                        3F9F2190
       PDX     ,1                                                       3F9F2200
       TXL     *+3,1,182                                                3F9F2210
       DLD     PIOV2         IF ARG IS GREATER THAN 2**54 GIVE + OR -   3F9F2220
       TRA     SIGN            PI/2 AS ANS                              3F9F2230
       DLD     ARG                                                      3F9F2240
       TXL     SIGN,1,101    IF ARG IS SMALLER THAN 2**(-27), ANS=ARG   3F9F2250
       AXT     0,4                                                      3F9F2260
       SPACE                                                            3F9F2270
       TXL     A,1,128                                                  3F9F2280
       DLD     ONE           IF ARG IS GREATER THAN 1, TAKE INVERSE     3F9F2290
       DFDP    ARG                                                      3F9F2300
       TXI     *+1,4,4         XR4 TO DISTINGUISH CASES                 3F9F2310
   A   CAS     TAN15                                                    3F9F2320
       TXI     *+3,4,2                                                  3F9F2330
       TRA     B                                                        3F9F2340
       TRA     B                                                        3F9F2350
       DST     ARG           IF MODIFIED ARG, SAY X, IS GREATER THAN    3F9F2360
       DFAD    RTTHR           TAN (PI/12), COMPUTE TAN Z WHERE         3F9F2370
       DST     BUFF              TAN (Z+PI/6) = X                       3F9F2380
       DLD     ARG             TAN Z = (X*SQRT3 - 1)/(X + SQRT3)        3F9F2390
       DFMP    RT3M1                                                    3F9F2400
       DFSB    HALF          COMPUTE NUMERATOR WITH CARE                3F9F2410
       DFSB    HALF            TO PRESERVE ACCURACY                     3F9F2420
       DFAD    ARG                                                      3F9F2430
       DFDP    BUFF                                                     3F9F2440
       SPACE                                                            3F9F2450
   B   DST     ARG           NOW ARG IS REDUCED TO LESS THAN TAN(PI/12) 3F9F2460
       DFMP    ARG             IN ABSOLUTE VALUE                        3F9F2470
       DST     SQ                                                       3F9F2480
       AXT     16,1                                                     3F9F2490
       DLD     ZERO                                                     3F9F2500
 LOOP  DFAD    COEF+2,1      ATAN X = X(1+F*SQ)  WHERE                  3F9F2510
       DFAD    SQ                                                       3F9F2520
       DST     BUFF            F = A1/(SQ+B1+A2/(SQ+B2+A3/.../(SQ+B4))) 3F9F2530
       DLD     COEF+4,1                                                 3F9F2540
       DFDP    BUFF                                                     3F9F2550
       TIX     LOOP,1,4                                                 3F9F2560
       DFMP    SQ                                                       3F9F2570
       DFMP    ARG                                                      3F9F2580
       DFAD    ARG           REDUCED ANSWER READY                       3F9F2590
       TXL     *+2,4,2       DEPENDING ON SECTION, ADD OR SUBTRACT      3F9F2600
       CHS                     REDUCED ANS FROM PROPER BASE ANGLE       3F9F2610
       DFAD    ZERO,4                                                   3F9F2620
       SPACE                                                            3F9F2630
 SIGN  STQ     BUFF          AFFIX PROPER SIGN AND RETURN TO EITHER     3F9F2640
       LDQ     TEST            MAIN PROGRAM OR DATAN2 CIRCUIT           3F9F2650
       LLS     0                                                        3F9F2660
       LDQ     BUFF                                                     3F9F2670
       LRS     0             DATAN ANSWER READY                         3F9F2680
 SXR1  AXT     **,1                                                     3F9F2690
       LXA     LINK,4                                                   3F9F2700
       NZT     FLAG                                                     3F9F2710
       TRA     FIN                                                      3F9F2720
       SPACE                                                            3F9F2730
       LDI*    4,4           HERE ONLY FOR DATAN2 ENTRY                 3F9F2740
       LNT     400000          IF ABSCISSA POSITIVE, ANS IS READY       3F9F2750
       TRA     RET                                                      3F9F2760
       TPL     *+3             IF ABSCISSA NEGATIVE, ADD OR             3F9F2770
       DFAD    PI                SUBTRACT PI TO OBTAIN ANSWER           3F9F2780
       TRA     *+2                 BETWEEN - PI AND PI                  3F9F2790
       DFSB    PI                                                       3F9F2800
  RET  STZ     FLAG                                                     3F9F2810
       SPACE                                                            3F9F2820
  FIN  LDI     SVIND         RETURN                                     3F9F2830
       TRA     1,4                                                      3F9F2840
       SPACE                                                            3F9F2850
 CH54  OCT     66000000000                                              3F9F2860
 TAN15 OCT     177422302430                    TAN (PI/12)              3F9F2870
       EVEN                                                             3F9F2880
  PI   OCT     202622077325,147042055061       PI                       3F9F2890
  ONE  OCT     201400000000,146000000000       1.                       3F9F2900
 RTTHR OCT     201673317272,146054114525       SQRT 3                   3F9F2910
 RT3M1 OCT     200566636564,145130231252      SQRT 3 - 1                3F9F2920
 HALF  OCT     200400000000,145000000000      1/2                       3F9F2930
       OCT     201503750266,146215675354       B4=1.26544461067154890   3F9F2940
       OCT     -175502167171,-142623566535     A4=-.0786701382962415653 3F9F2950
       OCT     202421475516,147135555470       B3=2.13765949556336733   3F9F2960
       OCT     -201464652334,-146216516352     A3=-1.20637840447753071  3F9F2970
       OCT     203641102513,150504766775       B2=6.51765892712660257   3F9F2980
       OCT     -204667070204,-151374053176     A2=-13.7221837630692088  3F9F2990
       OCT     203464256777,150355624132       B1=4.81784054424956026   3F9F3000
 COEF  OCT     -200653574647,-145152175341     A1=-.835437113102598223  3F9F3010
       OCT     201414052216,146026563313       PI/3                     3F9F3020
 PIOV2 OCT     201622077325,146042055061       PI/2                     3F9F3030
       OCT     200414052216,145026563313       PI/6                     3F9F3040
 ZERO  OCT     0,0                                                      3F9F3050
  ARG  BSS     2                                                        3F9F3060
  SQ   BSS     2                                                        3F9F3070
 BUFF  BSS     2                                                        3F9F3080
 TEST  BSS     1                                                        3F9F3090
 SVIND BSS     1                                                        3F9F3100
 FLAG  PZE                                                              3F9F3110
 EDAT  DEC     24                                                       3F9F3120
       PZE     E24MES,,4                                                3F9F3130
       PZE     E24OMS,,3                                                3F9F3140
E24MES BCI     4,0DATAN2(0,0) NOT ALLOWED                               3F9F3150
E24OMS BCI     3,0SET RESULT = 0                                        3F9F3160
       SPACE                                                            3F9F3170
  LINK LDIR                                                             3F9F3180
END94  NULL                                                             3F9F3190
       END                                                              3F9F3200
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9G0000
$IBMAP FDX1    115                                                      3F9G0010
       TTL     DOUBLE PRECISION AND COMPLEX EXPONENTIAL-DX1             3F9G0020
       REM     DOUBLE PRECISION EXPONENTIAL-FLTG. BASE, FIXED EXPT.     3F9G0030
       REM     COMPLEX EXPONENTIAL-COMPLEX BASE, FIXED EXPT.            3F9G0040
       ENTRY   .DXP1.                                                   3F9G0050
       ENTRY   .CXP1.                                                   3F9G0060
.CXP1. STL     INDIC                                                    3F9G0070
       TRA     *+2                                                      3F9G0080
.DXP1. STZ     INDIC                                                    3F9G0090
DEXP2  SAVEN   (4)                                                      3F9G0100
       SXA     LNKG,4                                                   3F9G0110
       CLA*    4,4                                                      3F9G0120
       STO     EXPT                                                     3F9G0130
       DLD*    3,4                                                      3F9G0140
       DST     BASE                                                     3F9G0150
       TNZ     DLOD           TEST BASE FOR PARTIAL ZERO                3F9G0160
       XCA                    PARTIAL ZERO EXISTS                       3F9G0170
       TNZ     DLOD           TEST BASE FOR COMPLETE ZERO               3F9G0180
       CLA     EXPT                                                     3F9G0190
       TZE     ERR                                                      3F9G0200
       TMI     ERR1                                                     3F9G0210
       ZAC                                                              3F9G0220
       RETURN  DEXP2                                                    3F9G0230
 DLOD  DLD     FLONE                                                    3F9G0240
       DST     FACTR                                                    3F9G0250
 CLA1  CLA     EXPT                                                     3F9G0260
       LBT                    TEST EXPONENT FOR LOW ORDER BIT           3F9G0270
       TRA     CLA2           NOT FOUND                                 3F9G0280
       DLD     FACTR                                                    3F9G0290
       ZET     INDIC                                                    3F9G0300
       TSX     CMPLY,4                                                  3F9G0310
       TSX     DFMP,4                                                   3F9G0320
 STO   DST     FACTR                                                    3F9G0330
 CLA2  CLA     EXPT           TEST EXPT FOR ZERO                        3F9G0340
       ARS     1                                                        3F9G0350
       STO     EXPT                                                     3F9G0360
       TZE     EXIT           FINISHED IF EXPT NOW ZERO                 3F9G0370
       DLD     BASE                                                     3F9G0380
       ZET     INDIC                                                    3F9G0390
       TSX     CMPLY,4                                                  3F9G0400
       TSX     DFMP,4                                                   3F9G0410
       DST     BASE                                                     3F9G0420
       TRA     CLA1           START AGAIN                               3F9G0430
 EXIT  CLA     EXPT                                                     3F9G0440
       TMI     NEGXP    TRANSFER IF NEG EXPONENT                        3F9G0450
       DLD     FACTR                                                    3F9G0460
       RETURN  DEXP2                                                    3F9G0470
       RETURN  DEXP2                                                    3F9G0480
 ERR   CALL    .FXEM.(DXP1E1)                                           3F9G0490
 COR   ZAC                                                              3F9G0500
       LDQ     FLONE+1                                                  3F9G0510
       RETURN  DEXP2                                                    3F9G0520
 ERR1  CALL    .FXEM.(DXP1E2)                                           3F9G0530
       TRA     COR                                                      3F9G0540
 NEGXP ZET     INDIC                                                    3F9G0550
       TRA     CAFDP                                                    3F9G0560
       DLD     FLONE                                                    3F9G0570
       DFDP    FACTR                                                    3F9G0580
       RETURN  DEXP2                                                    3F9G0590
 CAFDP DLD     FACTR   FIND RECIPROCAL OF COMPLEX NUMBER                3F9G0600
       XCL                                                              3F9G0610
       XCA                    ABS(A) IN AC - ABS(B) IN MQ               3F9G0620
       TLQ     AGRB                                                     3F9G0630
       CLS     FACTR            -A                                      3F9G0640
 PROCD FDP     FACTR+1       -A/B                                       3F9G0650
       STQ     E1                                                       3F9G0660
       FMP     E1            (A/B)**2                                   3F9G0670
       FAD     FLONE          (A/B)**2+1                                3F9G0680
       XCA                                                              3F9G0690
       FMP     FACTR+1       B((A/B)**2+1)                              3F9G0700
       STO     E2                                                       3F9G0710
       CLS     FLONE                                                    3F9G0720
       FDP     E2            -1/(B(A/B)**2+1)                           3F9G0730
       STQ     E2            STORE IMAG PART OF ANSWER                  3F9G0740
       FMP     E1            (A/B)/(B(A/B)**2+1)                        3F9G0750
       LDQ     E2                                                       3F9G0760
       NZT     INDIC                                                    3F9G0770
       XCA                    ARRANGE ANSWER                            3F9G0780
       STL     INDIC          RESTORE INDICATOR                         3F9G0790
       RETURN  DEXP2                                                    3F9G0800
AGRB   CLS     FACTR          EXCHANGE A AND B                          3F9G0810
       XCA                    WITH SIGNS REVERSED                       3F9G0820
       CLA     FACTR+1                                                  3F9G0830
       STQ     FACTR+1                                                  3F9G0840
       STZ     INDIC          SET INDICATOR                             3F9G0850
       TRA     PROCD                                                    3F9G0860
 CMPLY DST     E3                                                       3F9G0870
       FMP     BASE                                                     3F9G0880
       STO     E1                                                       3F9G0890
       LDQ     E3                                                       3F9G0900
       FMP     BASE+1                                                   3F9G0910
       FAD     E1                                                       3F9G0920
       STO     E1                                                       3F9G0930
       LDQ     E4                                                       3F9G0940
       FMP     BASE+1                                                   3F9G0950
       STO     E2                                                       3F9G0960
       LDQ     E3                                                       3F9G0970
       FMP     BASE                                                     3F9G0980
       FSB     E2                                                       3F9G0990
       LDQ     E1                                                       3F9G1000
       TRA     2,4                                                      3F9G1010
 DFMP  DFMP    BASE          CHANGE FACTOR ACCORDINGLY                  3F9G1020
       TRA     1,4                                                      3F9G1030
       EVEN                                                             3F9G1040
 FLONE DEC     1.0,0.0                                                  3F9G1050
 BASE  DEC     0,0                                                      3F9G1060
 FACTR DEC     0,0                                                      3F9G1070
 EXPT                                                                   3F9G1080
 INDIC                                                                  3F9G1090
E1                                                                      3F9G1100
E2                                                                      3F9G1110
E3                                                                      3F9G1120
E4                                                                      3F9G1130
*                                                                       3F9G1140
DXP1E1 DEC     14             0**0                                      3F9G1150
ER14MS PZE     E14MES,,5                                                3F9G1160
ER14OP PZE     E14OMS,,3                                                3F9G1170
E14MES BCI     5,0EXPONENTIATION ERROR 0**0                             3F9G1180
E14OMS BCI     3,0SET RESULT = 0                                        3F9G1190
DXP1E2 DEC     15             0**(-A)                                   3F9G1200
ER15MS PZE     E15MES,,5                                                3F9G1210
ER15OP PZE     E14OMS,,3                                                3F9G1220
E15MES BCI     5,0EXPONENTIATION ERROR 0**(-J)                          3F9G1230
LNKG   LDIR                                                             3F9G1240
       END                                                              3F9G1250
$*     7090/7094 IBLIB  FORTRAN MATHEMATICS LIBRARY                     3F9H0000
$IBMAP FDX2    50                                                       3F9H0010
       TTL     DOUBLE PRECISION EXPONENTIAL,FLTG. BASE AND EXPT.-DX2    3F9H0020
.DXP2. SAVE    (4)                                                      3F9H0030
       DLD*    4,4                                                      3F9H0040
       DST     EXPT                                                     3F9H0050
       DLD*    3,4                                                      3F9H0060
       DST     BASE                                                     3F9H0070
       NZT     EXPT                                                     3F9H0080
       TRA     TEST                                                     3F9H0090
       TZE     OUT                                                      3F9H0100
       TMI     ERR2                                                     3F9H0110
 CALLG CALL    DLOG(BASE)                                               3F9H0120
       DFMP    EXPT                                                     3F9H0130
       DST     EXPT                                                     3F9H0140
 CLEX  CALL    DEXP(EXPT)                                               3F9H0150
       RETURN  .DXP2.                                                   3F9H0160
 TEST  TZE     ERR                                                      3F9H0170
       DLD     FLONE                                                    3F9H0180
       RETURN  .DXP2.                                                   3F9H0190
 OUT   CLA     EXPT                                                     3F9H0200
       TMI     ERR1                                                     3F9H0210
       ZAC                                                              3F9H0220
       LDQ     ZERO                                                     3F9H0230
       RETURN  .DXP2.                                                   3F9H0240
 ERR   CALL    .FXEM.(DXP2E2)                                           3F9H0250
 CALLM ZAC                                                              3F9H0260
       LDQ     ZERO                                                     3F9H0270
       RETURN  .DXP2.                                                   3F9H0280
 ERR1  CALL    .FXEM.(DXP2E3)                                           3F9H0290
       TRA     CALLM                                                    3F9H0300
 ERR2  CALL    .FXEM.(DXP2E1)                                           3F9H0310
       SSP                                                              3F9H0320
       LRS     0                                                        3F9H0330
       DST     BASE                                                     3F9H0340
       TRA     CALLG                                                    3F9H0350
ZERO   DEC     0                                                        3F9H0360
       EVEN                                                             3F9H0370
FLONE  DEC     1.0                                                      3F9H0380
       OCT     146000000000                                             3F9H0390
 BASE  DEC     0,0                                                      3F9H0400
 EXPT  DEC     0,0                                                      3F9H0410
 E1                                                                     3F9H0420
 E2                                                                     3F9H0430
 E3                                                                     3F9H0440
 E4                                                                     3F9H0450
DXP2E1 DEC     16             (-A)**B                                   3F9H0460
ER16MS PZE     E16MES,,5                                                3F9H0470
ER16OP PZE     E16OMS,,3                                                3F9H0480
E16MES BCI     5,0EXPONENTIATION ERROR (-B)**C                          3F9H0490
E16OMS BCI     3,0EVALUATE FOR +B                                       3F9H0500
DXP2E2 DEC     17             0**0                                      3F9H0510
ER17MS PZE     E17MES,,5                                                3F9H0520
ER17OP PZE     E17OMS,,3                                                3F9H0530
E17MES BCI     5,0EXPONENTIATION ERROR 0**0                             3F9H0540
E17OMS BCI     3,0SET RESULT = 0                                        3F9H0550
DXP2E3 DEC     18             0**(-A)                                   3F9H0560
ER18MS PZE     E18MES,,5                                                3F9H0570
ER18OP PZE     E17OMS,,3                                                3F9H0580
E18MES BCI     5,0EXPONENTIATION ERROR 0**(-C)                          3F9H0590
       END                                                              3F9H0600
$*             LIBRARY TANGENT-COTANGENT SUBROUTINE                     3F9J0000
$IBMAP FTNC    150                                                      3F9J0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9J0015
       ENTRY   TAN                                                      3F9J0020
       ENTRY   COTAN                                                    3F9J0030
       ENTRY   CRIT                                                     3F9J0040
       SPACE   3                                                        3F9J0050
*              TANGENT-COTANGENT SUBROUTINE                             3F9J0060
*                  .FXEM. ERROR IS GIVEN IN ANY OF FOLLOWING 3 CASES    3F9J0070
*                    1. MAGNITUDE OF ARG IS GREATER THAN 2**20          3F9J0080
*                    2. MAGNITUDE OF ARG IS LESS THAN 2**(-126) AND     3F9J0090
*                         COTAN IS ASKED                                3F9J0100
*                    3. ARGUMENT IS SO CLOSE TO A SINGULARITY OF THE    3F9J0110
*                         FUNCTION THAT EVEN THE INPUT ROUNDING ERROR   3F9J0120
*                         CAUSES RELATIVE ERROR OF 1/3                  3F9J0130
*                 NO .FXEM. ERROR IS GIVEN IN THE NEIGHBORHOOD OF ZEROS 3F9J0140
*                    OF THE FUNCTION                                    3F9J0150
       SPACE   3                                                        3F9J0160
 COTAN STL     FLAG          COTANGENT ENTRY                            3F9J0170
  TAN  SXA     SYSLOC,4                                                 3F9J0180
       SXA     LINK,4                                                   3F9J0190
       CLA*    3,4           PICK UP ARG,T                              3F9J0200
       STO     ARG                                                      3F9J0210
       SSP                   ASSUME POSITIVE DURING REDUCTION           3F9J0220
       LDQ     MASK1         CLEAR HIGH PART MQ                         3F9J0230
       LRS     9                                                        3F9J0240
       PDX     ,4            CHARACTERISTIC TO XR1                      3F9J0250
       TXH     ERROR1,4,148  IF MAGNITUDE GREATER THAN 2**20, ERROR     3F9J0260
       SPACE                                                            3F9J0270
       SXA     SXR2,2                                                   3F9J0280
       LLS     19                                                       3F9J0290
       LRS     151,4                                                    3F9J0300
       VDP     PIOV4,,21     X=(PI/4)Q+R   R IN AC B0, Q IN MQ B35      3F9J0310
       STO     BUFF          SAVE REMAINDER                             3F9J0320
       XCA                                                              3F9J0330
       ANA     MASK1         LEAVE LAST 2 BITS OF QUOTIENT              3F9J0340
       PAC     ,2            OCTANT 0, 1, 2, OR 3 TO -XR2               3F9J0350
       ZET     FLAG          FOR TANGENT, CASE NUMBER = OCTANT NUMBER   3F9J0360
       ERA     MASK2         FOR COTANGENT, CASE0=OCTANT1, CASE1=OCT0   3F9J0370
       STO     FLAG              CASE2=OCT3, CASE3=OCT2                 3F9J0380
       TIX     *+1,2,-3      IF OCTANT0 OR OCTANT2,                     3F9J0390
       TXL     TEST1,2,1         REMAINDER IS REDUCED ARGUMENT          3F9J0400
       CLA     PIOV4         IF OCTANT1 OR OCTANT3, TAKE COMPLEMENT     3F9J0410
       SUB     BUFF              OF REMAINDER FOR REDUCED ARGUMENT      3F9J0420
       STO     BUFF                                                     3F9J0430
       SPACE                                                            3F9J0440
 TEST1 LXA     FLAG,2        CASE NUMBER TO XR1 (OCTANT FOR TANGENT)    3F9J0450
       TXH     TEST2,4,127   IF ORIGIONAL ARG MORE THAN 1/2, SKIP       3F9J0460
       TXH     COMP,4,114    IF LESS THAN 1/2, NO SCREENING IS GIVEN    3F9J0470
       CLA     FLONE           IF MORE THAN 2**-14, SKIP FLOATING AND   3F9J0480
       TXH     READY,4,2         PROCEED TO COMPUTE FACTOR              3F9J0490
       TXL     READY,2,0       IF LESS THAN 2**-126 FOR COTAN ARG, ERROR3F9J0500
       TRA     ERROR2          OTHERWISE, FACTOR=1, SKIP FLOATING       3F9J0510
       SPACE                                                            3F9J0520
 TEST2 CLA     BUFF                                                     3F9J0530
       TXL     FLOAT,2,0     IF CASE0 OR CASE3, NO SCREENING IS GIVEN   3F9J0540
       TXH     FLOAT,2,2         SKIP                                   3F9J0550
       LDQ     CRIT          SCREEN OUT NEIGHBORHOOD OF SINGULARITIES   3F9J0560
       SXA     *+1,4           DO THIS BY TESTING REDUCED ARGUMENT      3F9J0570
       AXC     **,4              AGAINST 2**(P-26) WHERE P IS EXPONENT  3F9J0580
       RQL     -119,4              OF ORIGIONAL ARGUMENT                3F9J0590
       TLQ     *+2                                                      3F9J0600
       TRA     ERROR2                                                   3F9J0610
 FLOAT LRS     8             FLOAT THE REDUCED ARGUMENT                 3F9J0620
       ORA     CHAR                                                     3F9J0630
       STO     BUFF                                                     3F9J0640
       XCA                                                              3F9J0650
       ARS     8                                                        3F9J0660
       ORA     LCHAR                                                    3F9J0670
       FAD     BUFF                                                     3F9J0680
       FRN                                                              3F9J0690
       LDQ     ARG           PRE-ADJUST SIGN OF REDUCED ARGUMENT        3F9J0700
       LLS     0                 SO THAT THE ANSWER COMES OUT WITH      3F9J0710
       TXL     *+2,2,1               CORRECT SIGN                       3F9J0720
       CHS                                                              3F9J0730
       STO     ARG                                                      3F9J0740
       SPACE                                                            3F9J0750
 COMP  LDQ     ARG           COMPUTE FACTOR BY                          3F9J0760
       FMP     ARG                        13.946SQ-313.11               3F9J0770
       STO     SQ                FACTOR=1+----------------              3F9J0780
       CLA     D                          SQ-104.46+939.33              3F9J0790
       FDP     SQ                                   ------              3F9J0800
       XCA                                            SQ                3F9J0810
       FAD     SQ                                                       3F9J0820
       FSB     C                                                        3F9J0830
       STO     BUFF                                                     3F9J0840
       LDQ     A                                                        3F9J0850
       FMP     SQ                                                       3F9J0860
       FSB     B                                                        3F9J0870
       FDP     BUFF                                                     3F9J0880
       XCA                                                              3F9J0890
       FAD     FLONE                                                    3F9J0900
       FRN                                                              3F9J0910
       SPACE                                                            3F9J0920
 READY TXL     *+4,2,0       NOW BOTH REDUCED ARG AND FACTOR ARE READY  3F9J0930
       TXH     *+3,2,2                                                  3F9J0940
       FDP     ARG           FOR CASE1 AND CASE2,                       3F9J0950
       TRA     *+4               ANSWER = FACTOR/ARGUMENT               3F9J0960
       STO     BUFF          FOR CASE0 AND CASE3                        3F9J0970
       CLA     ARG               ANSWER = ARGUMENT/FACTOR               3F9J0980
       FDP     BUFF                                                     3F9J0990
       XCA                                                              3F9J1000
       FRN                                                              3F9J1010
 SXR2  AXT     **,2                                                     3F9J1020
  RET  LXA     LINK,4                                                   3F9J1030
       STZ     FLAG                                                     3F9J1040
       TRA     1,4                                                      3F9J1050
       SPACE                                                            3F9J1060
ERROR1 CALL    .FXEM.(ETNC1)                                            3F9J1070
       ZAC                                                              3F9J1080
       TRA     RET                                                      3F9J1090
ERROR2 CALL    .FXEM.(ETNC2)                                            3F9J1100
       CLA     OMEGA                                                    3F9J1110
       TRA     SXR2                                                     3F9J1120
       SPACE                                                            3F9J1130
 FLAG  PZE                                                              3F9J1140
  ARG  BSS     1                                                        3F9J1150
 BUFF  BSS     1                                                        3F9J1160
  SQ   BSS     1                                                        3F9J1170
 CRIT  PZE     1             BIT TO TEST CLOSENESS TO SINGULARITIES     3F9J1180
 MASK1 OCT     3                                                        3F9J1190
 MASK2 OCT     1                                                        3F9J1200
 CHAR  OCT     200000000000                                             3F9J1210
 LCHAR OCT     145000000000                                             3F9J1220
 FLONE OCT     201400000000                                             3F9J1230
 PIOV4 OCT     +311037552421       =PI/4 AS FIXED POINT NUMBER IN B0    3F9J1240
   A   OCT     204676213207                                             3F9J1250
   B   OCT     211471070244                                             3F9J1260
   C   OCT     207641656051                                             3F9J1270
   D   OCT     212725524366                                             3F9J1280
 OMEGA OCT     377777777777                                             3F9J1290
 ETNC1 DEC     73                                                       3F9J1300
       PZE     E73MES,,10                                               3F9J1310
       PZE     E73OMS,,3                                                3F9J1320
E73MES BCI ,0TAN(X) OR COTAN(X), /X/ GRT THAN OR EQ TO 2**20 NOT ALLOWED3F9J1330
E73OMS BCI     3,0SET RESULT = 0                                        3F9J1340
 ETNC2 DEC     74                                                       3F9J1350
       PZE     E74MES,,10                                               3F9J1360
       PZE     E74OMS,,4                                                3F9J1370
E74MES BCI ,0TAN(X) OR COTAN(X), X TOO CLOSE TO SINGULARITY, NOT ALLOWED3F9J1380
E74OMS BCI     4,0SET RESULT = +OMEGA                                   3F9J1390
       SPACE                                                            3F9J1400
  LINK LDIR                                                             3F9J1410
       END                                                              3F9J1420
$*             LIBRARY ROUTINE TO MODIFY ACCURACY OF IBLIB TANGENT      3F9K0000
$IBMAP FMTN    150                                                      3F9K0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9K0015
       ENTRY   MTAN                                                     3F9K0020
       SPACE   3                                                        3F9K0030
*      ROUTINE TO MODIFY ACCURACY TEST OF IBLIB TANGENT                 3F9K0040
*           1. CALLING SEQUENCE IN FORTRAN     CALL  MTAN(K)            3F9K0050
*              THIS PROGRAM IS NOT DESIGNED FOR MAP USERS.              3F9K0060
*           2. STANDARD MINIMUM ACCURACY GUARANTEE OF TAN IS 1/3.       3F9K0070
*              WITH EXECUTION OF ABOVE CALLING SEQUENCE WITH K=0,1,2,3, 3F9K0080
*                4 OR 5, TAN CIRCUIT IS MODIFIED TO GIVE MINIMUM        3F9K0090
*                ACCURACY GUARANTEE OF 1/(2**(K+2)-1)                   3F9K0100
*              WITH EXECUTION OF ABOVE CALLING SEQUENCE WITH K GREATER  3F9K0110
*                THAN 5, TAN CIRCUIT IS MODIFIED TO SUSPEND ABOVE       3F9K0120
*                ACCURACY GUARANTEE FEATURE COMPLETELY SO THAT ANY ARG  3F9K0130
*                LESS THAN 2**20 IN ABSOLUTE VALUE WILL BE ACCEPTED.    3F9K0140
       SPACE   3                                                        3F9K0150
 MTAN  CAL*    3,4           PICK UP ARG,T                              3F9K0160
       CAS     K1            IF K=0,1,2,3,4,5, THIS IS SHIFT NUMBER     3F9K0170
       CLA     *+1           IF K BIGGER, GIVE SHIFT TO CLEAR AC        3F9K0180
       AXT     37,0                                                     3F9K0190
       STA     *+2                                                      3F9K0200
       CLA     K3            TEST BIT                                   3F9K0210
       ALS     **            SHIFT                                      3F9K0220
       STO     CRIT          SET INTO TNCT ROUTINE                      3F9K0230
       TRA     1,4           RETURN                                     3F9K0240
  K1   OCT     5                                                        3F9K0250
  K3   OCT     1                                                        3F9K0260
       END                                                              3F9K0270
$*             LIBRARY ARCSINE-ARCCOSINE SUBROUTINE                     3F9L0000
$IBMAP FASC    150                                                      3F9L0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9L0015
       ENTRY   ARCOS                                                    3F9L0020
       ENTRY   ARSIN                                                    3F9L0030
       SPACE   3                                                        3F9L0040
       REM     ARCSINE - ARCCOSINE SUBROUTINE                           3F9L0050
       SPACE   3                                                        3F9L0060
 ARCOS STL     FLAG1         ARCCOS ENTRY.   SET FLAG                   3F9L0070
 ARSIN SXA     SYSLOC,4                                                 3F9L0080
       SXA     LINK,4                                                   3F9L0090
       CLA*    3,4           PICK UP ARG, T                             3F9L0100
       STO     SIGN          ARCSIN ENTRY     SAVE SIGN                 3F9L0110
       SSP                                                              3F9L0120
       LDQ     ONE           IF MAGNITUDE GRT THAN 1, ERROR             3F9L0130
       TLQ     ERROR                                                    3F9L0140
       LDQ     HALF          IF MAGNITUDE GRT THAN 1/2, SKIP            3F9L0150
       TLQ     BIG                                                      3F9L0160
 SERIE STO     ARG           FOR /X/ SMALLER THAN 1/2,                  3F9L0170
       XCA                     COMPUTE ARCSIN(/X/) BY CHEBYSHEV         3F9L0180
       FMP     ARG               INTERPOLATION                          3F9L0190
       STO     SQ                                                       3F9L0200
       AXT     5,4                                                      3F9L0210
       ZAC                                                              3F9L0220
       FAD     COEF+5,4                                                 3F9L0230
       XCA                                                              3F9L0240
       FMP     SQ                                                       3F9L0250
       TIX     *-3,4,1                                                  3F9L0260
       XCA                   THIS PARTICULAR ORDER OF COMPUTATION HAS   3F9L0270
       FMP     ARG             A SUBSTANTIAL BEARING ON THE ACCURACY    3F9L0280
       FAD     ARG                                                      3F9L0290
       NZT     FLAG2         IF ORIG /X/ SMALLER THAN 1/2               3F9L0300
       TXI     *+3,4,-1        SET XR4=0, AND JUMP                      3F9L0310
       TZE     *+2           IF ORIG /X/ GREATER THAN 1/2               3F9L0320
       ADD     CH1             DOUBLE ARCSIN(SQRT((1-/X/)/2)), XR4=1    3F9L0330
       XEC     TEST+1,4                                                 3F9L0340
       TRA     *+3           IF ASIN AND BIG, OR IF ACOS AND SMALL,     3F9L0350
       CHS                     SUBTRACT THE WORK FROM PI/2              3F9L0360
       FAD     PIOV2                                                    3F9L0370
       LDQ     SIGN                                                     3F9L0380
       TQP     *+4           IF ORIGINAL ARG WAS +, ANSWER IS READY     3F9L0390
       CHS                   IF NEGATIVE AND ASIN, CHANGE SIGN OF ANS   3F9L0400
       ZET     FLAG1                                                    3F9L0410
       FAD     PI            IF NEGATIVE AND ACOS, SUBTRACT THE WORK    3F9L0420
       STZ     FLAG2           FROM PI                                  3F9L0430
  RET  STZ     FLAG1                                                    3F9L0440
       LXA     LINK,4                                                   3F9L0450
       TRA     1,4                                                      3F9L0460
       SPACE                                                            3F9L0470
  BIG  SSM                   CASE WHEN /X/ IS GRT THAN 1/2              3F9L0480
       FAD     ONE                                                      3F9L0490
       TZE     *+2           OBTAIN MODIFIED ARGUMENT,                  3F9L0500
       SUB     CH1             SQRT((1-/X/)/2) AND MERGE MAIN           3F9L0510
       STO     ARG                                                      3F9L0520
       STL     FLAG2                                                    3F9L0530
       TSX     SQRT,4                                                   3F9L0540
       TXI     SERIE,,1                                                 3F9L0550
       PZE     50,,LINK                                                 3F9L0560
       PZE     ARG                                                      3F9L0570
       SPACE                                                            3F9L0580
 TEST  ZET     FLAG1                                                    3F9L0590
       NZT     FLAG1                                                    3F9L0600
       SPACE                                                            3F9L0610
 ERROR CALL    .FXEM.(EASCN)                                            3F9L0620
       ZAC                                                              3F9L0630
       TRA     RET                                                      3F9L0640
       SPACE                                                            3F9L0650
 FLAG1 PZE                                                              3F9L0660
 FLAG2 PZE                                                              3F9L0670
 SIGN  BSS     1                                                        3F9L0680
  ARG  BSS     1                                                        3F9L0690
  SQ   BSS     1                                                        3F9L0700
 HALF  OCT     200400000000                                             3F9L0710
  CH1  OCT     1000000000                                               3F9L0720
 PIOV2 OCT     201622077325                                             3F9L0730
  PI   OCT     202622077325                                             3F9L0740
 COEF  OCT     174533367164    0.0424173419                             3F9L0750
       OCT     173611074307    0.0239940153                             3F9L0760
       OCT     174564717277    0.0455206330                             3F9L0770
       OCT     175462767135    0.0749469671                             3F9L0780
       OCT     176525253701    0.166667820                              3F9L0790
  ONE  OCT     201400000000                                             3F9L0800
 EASCN DEC     72                                                       3F9L0810
       PZE     E72MES,,8                                                3F9L0820
       PZE     E72OMS,,3                                                3F9L0830
E72MES BCI     8,0ARSIN(X) OR ARCOS(X),/X/ GRT THAN 1 NOT ALLOWED       3F9L0840
E72OMS BCI     3,0SET RESULT = 0                                        3F9L0850
       SPACE                                                            3F9L0860
  LINK LDIR                                                             3F9L0870
       END                                                              3F9L0880
$*             LIBRARY HYPERBOLIC SINE AND COSINE SUBROUTINE            3F9M0000
$IBMAP FSCH    150                                                      3F9M0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9M0015
       ENTRY   SINH                                                     3F9M0020
       ENTRY   COSH                                                     3F9M0030
       SPACE   3                                                        3F9M0040
       REM     HYPERBOLIC SINE AND COSINE SUBROUTINE                    3F9M0050
       SPACE   3                                                        3F9M0060
  SINH STL     FLAG          SET FLAG FOR SINH                          3F9M0070
  COSH SXA     SYSLOC,4                                                 3F9M0080
       SXA     LINK,4                                                   3F9M0090
       CLA*    3,4           PICK UP ARG,T                              3F9M0100
       STO     SAVE1         SAVE ARGUMENT                              3F9M0110
       SSP                                                              3F9M0120
       LDQ     MAXIM         TEST IF ARGUMENT IS TOO LARGE              3F9M0130
       TLQ     ERROR                                                    3F9M0140
       NZT     FLAG          IF COSH                                    3F9M0150
       TRA     EXPN            COMPUTE                                  3F9M0160
       LDQ     TRESH         TEST FOR                                   3F9M0170
       TLQ     EXPN            SINH CIRCUIT                             3F9M0180
       XCA                                                              3F9M0190
       FMP     SAVE1                                                    3F9M0200
       SLW     SAVE2         SQUARE                                     3F9M0210
       AXT     3,4                                                      3F9M0220
       LDQ     K7                                                       3F9M0230
  LOOP FMP     SAVE2         COMPUTE                                    3F9M0240
       FAD     K+1,4           INFINITE                                 3F9M0250
       FRN                       SERIE                                  3F9M0260
       XCA                                                              3F9M0270
       TIX     LOOP,4,1                                                 3F9M0280
       FMP     SAVE1                                                    3F9M0290
       FRN                                                              3F9M0300
       TRA     RET                                                      3F9M0310
  EXPN STO     SAVE2         COMPUTE                                    3F9M0320
       CALL    EXP(SAVE2)      BY                                       3F9M0330
       STO     SAVE2             EXPONENTIAL                            3F9M0340
       CLA     K                   FUNCTION                             3F9M0350
       FDP     SAVE2                                                    3F9M0360
       XCA                                                              3F9M0370
       ZET     FLAG          CHECK IF                                   3F9M0380
       CHS                     SINH OR                                  3F9M0390
       FAD     SAVE2             COSH                                   3F9M0400
       FRN                                                              3F9M0410
       SUB     K2                                                       3F9M0420
       LDQ     SAVE1                                                    3F9M0430
       ZET     FLAG                                                     3F9M0440
       LLS     0                                                        3F9M0450
   RET LXA     LINK,4                                                   3F9M0460
       STZ     FLAG          RESET FLAG                                 3F9M0470
       TRA     1,4                                                      3F9M0480
       SPACE                                                            3F9M0490
 ERROR CALL    .FXEM.(ESCNH)                                            3F9M0500
       CLA     OMEGA                                                    3F9M0510
       TRA     RET                                                      3F9M0520
       SPACE                                                            3F9M0530
 MAXIM OCT     207540074636      88.029692                              3F9M0540
 TRESH OCT     177542710300  0.3465735903                               3F9M0550
    K2 OCT     1000000000                                               3F9M0560
    K7 OCT     164640064502  0.000198413273                             3F9M0570
       OCT     172421042104  0.0083333333333                            3F9M0580
       OCT     176525252525  0.16666666667                              3F9M0590
     K OCT     201400000000  1.0                                        3F9M0600
 OMEGA OCT     377777777777                                             3F9M0610
  FLAG PZE                                                              3F9M0620
 SAVE1 PZE                                                              3F9M0630
 SAVE2 PZE                                                              3F9M0640
 ESCNH DEC     75                                                       3F9M0650
       PZE     E75MES,,10                                               3F9M0660
       PZE     E75OMS,,4                                                3F9M0670
E75MES BCI ,0SINH(X) OR COSH(X), /X/ GRT THAN 88.029692 NOT ALLOWED     3F9M0680
E75OMS BCI     4,0SET RESULT = +OMEGA                                   3F9M0690
       SPACE                                                            3F9M0700
  LINK LDIR                                                             3F9M0710
       END                                                              3F9M0720
$*             LIBRARY ERROR FUNCTION SUBROUTINE                        3F9N0000
$IBMAP FERF    150                                                      3F9N0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9N0015
       ENTRY   ERF                                                      3F9N0020
       SPACE   3                                                        3F9N0030
       REM     ERROR FUNCTION SUBROUTINE                                3F9N0040
       SPACE   3                                                        3F9N0050
  ERF  SXA     SYSLOC,4                                                 3F9N0060
       SXA     LINK,4                                                   3F9N0070
       CLA*    3,4           PICK UP ARG,T                              3F9N0080
       STO     ARG+1         FOR SIGN CONTROL                           3F9N0090
       SSP                                                              3F9N0100
       STO     ARG                                                      3F9N0110
       LDQ     MAX                                                      3F9N0120
       TLQ     INF           IF X GREATER THAN 4.17, GIVE ONE AS ANSWER 3F9N0130
       XCA                                                              3F9N0140
       FMP     ARG                                                      3F9N0150
       STO     FLTSQ         SQUARE IN FLOAT POINT FOR E**-FLTSQ        3F9N0160
       RQL     8                                                        3F9N0170
       LRS     27                                                       3F9N0180
       PAC     ,4                                                       3F9N0190
       ZAC                                                              3F9N0200
       LLS     -98,4                                                    3F9N0210
       RND                                                              3F9N0220
       STO     SQ            SQUARE IN FIXED POINT SCALING B5           3F9N0230
       SPACE                                                            3F9N0240
       LDQ     BREAK                                                    3F9N0250
       AXT     10,4                                                     3F9N0260
       TLQ     *+2           IF X GREATER THAN 1.51, XR4=10             3F9N0270
       TIX     *+1,4,1       IF X SMALLER THAN 1.51, XR4=9              3F9N0280
       ZAC                                                              3F9N0290
 LOOP  ADD     BETA+1,4      COMPUTE 5 TERM CONTINUED FRACTION WITH     3F9N0300
       ADD     SQ              APPROPRIATE SET OF CONSTANTS DEPENDING   3F9N0310
       STO     BUFF            ON THE RANGE                             3F9N0320
       CLA     ALPHA+1,4                                                3F9N0330
       DVP     BUFF                                                     3F9N0340
       XCA                                                              3F9N0350
       TIX     LOOP,4,2                                                 3F9N0360
       SPACE                                                            3F9N0370
       TXH     BIG,4,1       IF X WAS GREATER THAN 1.51, SKIP           3F9N0380
       XCA                                                              3F9N0390
       MPR     SQ                                                       3F9N0400
       SUB     ALPHA-1       FACTOR IS READY IN SCALING B5              3F9N0410
       ALS     5             FLOAT THE FACTOR                           3F9N0420
       PBT                                                              3F9N0430
       AXT     2,4                                                      3F9N0440
       LRS     10,4                                                     3F9N0450
       ORA     CHAR,4                                                   3F9N0460
       RQL     28                                                       3F9N0470
       FRN                   NOW FACTOR IS READY IN FLOAT POINT         3F9N0480
       XCA                                                              3F9N0490
       FMP     ARG                                                      3F9N0500
       TRA     MERGE         COMPUTATION ENDS FOR X LESS THAN 1.51      3F9N0510
       SPACE                                                            3F9N0520
  BIG  ARS     7             MAGNITUDE OF RESULT IS LESS THAN 0.22      3F9N0530
       ORA     CHAR            BRING THIS TO B6 AND FLOAT IT            3F9N0540
       XCA                                                              3F9N0550
       FMP     ARG                                                      3F9N0560
       STO     BUFF                                                     3F9N0570
       CLS     FLTSQ                                                    3F9N0580
       STO     FLTSQ                                                    3F9N0590
       CALL    EXP(FLTSQ)                                               3F9N0600
       XCA                                                              3F9N0610
       FMP     BUFF                                                     3F9N0620
       FAD     ONE                                                      3F9N0630
       SPACE                                                            3F9N0640
 MERGE FRN                                                              3F9N0650
       LDQ     ARG+1         ADJUST SIGN AND RETURN TO MAIN PROGRAM     3F9N0660
       LLS     0                                                        3F9N0670
       LXA     LINK,4                                                   3F9N0680
       TRA     1,4                                                      3F9N0690
       SPACE                                                            3F9N0700
  INF  CLA     ONE           THE CASE WHEN X IS GREATER THAN 4.17       3F9N0710
       TRA     MERGE+1                                                  3F9N0720
       SPACE                                                            3F9N0730
  MAX  OCT     203412702437    4.17                                     3F9N0740
 BREAK OCT     022173224200    1.51**2  IN FIXED POINT B5               3F9N0750
       OCT     200000000000    CHARACTERISTICS TO FLOAT NUMBERS         3F9N0760
  ONE  OCT     201400000000    CHARACTERISTICS, ALSO DOUBLES AS 1.      3F9N0770
 CHAR  OCT     176000000000    CHARACTERISTICS                          3F9N0780
       OCT     -002546632144   A5 FOR BIG ARG   -10.803134        B10   3F9N0790
       OCT     020037203556    A5 FOR SM. ARG   64.244197         B10   3F9N0800
       OCT     -001700000000   A4 FOR BIG ARG   -7.5              B10   3F9N0810
       OCT     007635131455    A4 FOR SM. ARG   31.227929         B10   3F9N0820
       OCT     -000600000000   A3 FOR BIG ARG   -3.               B10   3F9N0830
       OCT     062261376110    A3 FOR SM. ARG   201.38669         B10   3F9N0840
       OCT     -000100000000   A2 FOR BIG ARG   -0.5              B10   3F9N0850
       OCT     -051626106115   A2 FOR SM. ARG   -167.17295        B10   3F9N0860
       OCT     -011015656501   A1 FOR BIG ARG IN B4 = 2/SQRT(PI)  B5    3F9N0870
 ALPHA OCT     -011217512462   A1 FOR SM. ARG   -1.1600697        B5    3F9N0880
       OCT     042115730200    B5 FOR BIG ARG   4.2690240         B5    3F9N0890
       OCT     054500177563    B5 FOR SM. ARG   5.5781859         B5    3F9N0900
       OCT     064000000000    B4 FOR BIG ARG   6.5               B5    3F9N0910
       OCT     -016136305707   B4 FOR SM. ARG   -1.7730436        B5    3F9N0920
       OCT     044000000000    B3 FOR BIG ARG   4.5               B5    3F9N0930
       OCT     134436235275    B3 FOR SM. ARG   11.569899         B5    3F9N0940
       OCT     024000000000    B2 FOR BIG ARG   2.5               B5    3F9N0950
       OCT     116366667120    B2 FOR SM. ARG   9.8102679         B5    3F9N0960
       OCT     004000000000    B1 FOR BIG ARG   0.5               B5    3F9N0970
 BETA  OCT     121564517660    B1 FOR SM. ARG   10.215980         B5    3F9N0980
  ARG  BSS     2                                                        3F9N0990
 FLTSQ BSS     1                                                        3F9N1000
  SQ   BSS     1                                                        3F9N1010
 BUFF  BSS     1                                                        3F9N1020
       SPACE                                                            3F9N1030
  LINK LDIR                                                             3F9N1040
       END                                                              3F9N1050
$*             LIBRARY GAMMA AND LOG GAMMA SUBROUTINE                   3F9P0000
$IBMAP FGAM    150                                                      3F9P0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9P0015
       ENTRY   GAMMA                                                    3F9P0020
       ENTRY   ALGAMA                                                   3F9P0030
       SPACE   3                                                        3F9P0040
       REM     GAMMA AND LOG GAMMA FUNCTION SUBROUTINE                  3F9P0050
       SPACE   3                                                        3F9P0060
 GAMMA STL     FLAG          CELL FLAG TO DISTINGUISH GAMMA FROM LGAMA  3F9P0070
       LDQ     LIM1                                                     3F9P0080
       TRA     *+3                                                      3F9P0090
ALGAMA STZ     FLAG          LOG GAMMA ENTRY                            3F9P0100
       LDQ     LIM3                                                     3F9P0110
       SXA     SYSLOC,4                                                 3F9P0120
       SXA     LINK,4                                                   3F9P0130
       CLA*    3,4           OBTAIN ARGUMENT                            3F9P0140
       STO     ARG                                                      3F9P0150
       TLQ     ERROR         ARG TOO LARGE                              3F9P0160
       LDQ     LIM2                                                     3F9P0170
       TLQ     CONT                                                     3F9P0180
       ZET     FLAG                                                     3F9P0190
       TRA     ERROR         ARG TOO SMALL FOR GAMMA                    3F9P0200
       TMI     ERROR         ZERO OR NEGATIVE ARG IS ILLEGAL FOR        3F9P0210
       TZE     ERROR           LOGGAMMA                                 3F9P0220
       CALL    ALOG(ARG)       FOR SMALL ARG, LOGGAMMA(X) = -LOG(X)     3F9P0230
       CHS                                                              3F9P0240
       TRA     RET                                                      3F9P0250
       SPACE                                                            3F9P0260
 CONT  SXA     SXR1,1        NOW ARGUMENT IS LEGAL FOR BOTH CIRCUITS    3F9P0270
       LRS     9                                                        3F9P0280
       PDX     ,1                                                       3F9P0290
       TXH     SECT5,1,130   JUMP IF X IS AT LEAST 4.                   3F9P0300
       CLA     ARG                                                      3F9P0310
       TXH     SECT3,1,129   JUMP IF X IS BETWEEN 2. AND 4.             3F9P0320
       TXH     SECT2,1,128   JUMP IF X IS BETWEEN 1. AND 2.             3F9P0330
 SECT1 STO     FACTR         NOW X IS LESS THAN 1.                      3F9P0340
       FSB     K1              =0.5                                     3F9P0350
       TRA     SECT2+1                                                  3F9P0360
 SECT3 FSB     ONE             =1.0                                     3F9P0370
       STO     FACTR                                                    3F9P0380
       LDQ     K2              =2.0                                     3F9P0390
       TLQ     SECT4                                                    3F9P0400
 SECT2 FSB     K3              =1.5   ARG HAD BEEN REDUCED TO (1.,2.)   3F9P0410
       RQL     8             MOVE ORIGIN TO 1.5                         3F9P0420
       LRS     27                                                       3F9P0430
       PAC     ,4                                                       3F9P0440
       ZAC                                                              3F9P0450
       LLS     -97,4                                                    3F9P0460
       STO     ARG             MODIFIED ARGUMENT IN B4                  3F9P0470
       AXT     10,4                                                     3F9P0480
       ZAC                                                              3F9P0490
 LOOP1 ADD     COEF1+1,4     LOOP FOR A 5 TERM CONTINUED FRACTION       3F9P0500
       ADD     ARG                                                      3F9P0510
       STO     BUFF            GAMMA(1.5+Y)=A1/(B1+Y+A2/(B2+Y+A3/..     3F9P0520
       CLA     COEF1+2,4                         ..+A5/(B5+Y)))))       3F9P0530
       DVP     BUFF                                                     3F9P0540
       XCA                                                              3F9P0550
       TIX     LOOP1,4,2     ANSWER COMES OUT IN B1.   CONSTANT A1 WAS  3F9P0560
       LRS     7               SO CHOSEN TO AVOID A BIT IN POSITION 1.  3F9P0570
       ORA     CHAR            FLOAT GAMMA OF MODIFIED ARG              3F9P0580
       RQL     28                                                       3F9P0590
       FRN                                                              3F9P0600
       TXH     *+4,1,128     DEPENDING ON THE SECTION INTO WHICH ARG    3F9P0610
       FDP     FACTR           FELL, DIVIDE OR MULTIPLY WITH PROPER     3F9P0620
       XCA                     FACTOR                                   3F9P0630
       TRA     *+4                                                      3F9P0640
       TXL     *+4,1,129                                                3F9P0650
       XCA                                                              3F9P0660
       FMP     FACTR                                                    3F9P0670
       FRN                   NOW GAMMA IS READY                         3F9P0680
       STO     ARG                                                      3F9P0690
       NZT     FLAG                                                     3F9P0700
       CALL    ALOG(ARG)     IF LOGGAMMA, TAKE LOG OF RESULT            3F9P0710
 SXR1  AXT     **,1                                                     3F9P0720
  RET  LXA     LINK,4        RETURN                                     3F9P0730
       TRA     1,4                                                      3F9P0740
       SPACE                                                            3F9P0750
 SECT4 FSB     ONE           CASE WHEN ORIGINAL ARG WAS BETWEEN 3. AND  3F9P0760
       STO     ARG             4.   ARG HAS ALREADY BEEN REDUCED BY 1.  3F9P0770
       XCA                     FURTHER REDUCE IT BY 1., AND PROCEED TO  3F9P0780
       FMP     FACTR           SECTION2                                 3F9P0790
       FRN                                                              3F9P0800
       STO     FACTR                                                    3F9P0810
       CLA     ARG                                                      3F9P0820
       TRA     SECT2                                                    3F9P0830
       SPACE                                                            3F9P0840
 SECT5 CALL    ALOG(ARG)     CASE WHEN ARG IS GREATER THAN 4.   WE USE  3F9P0850
       SUB     K4              STIRLINGS FORMULA.                       3F9P0860
       STO     BUFF                                                     3F9P0870
       ADD     K4              LOGGAMMA(X)=X(LOGX-1)-0.5*LOGX           3F9P0880
       FSB     ONE                                   +0.5*LOG2PI+F      3F9P0890
       XCA                                                              3F9P0900
       FMP     ARG                                                      3F9P0910
       FRN                                                              3F9P0920
       STO     BUFF+1                                                   3F9P0930
       ZAC                     WE NOW COMPUTE CORRECTIONAL TERMS F OF   3F9P0940
       TXH     STIRG,1,140     ABOVE FORMULA.   IF ARG IS GREATER THAN  3F9P0950
       LDQ     ARG             2**12, AVOID FLOAT POINT OVERFLOW BY     3F9P0960
       FMP     ARG             TAKING F=0                               3F9P0970
       STO     FACTR                                                    3F9P0980
       AXT     3,4                                                      3F9P0990
       CLA     COEF2,4         F=C1/X+C2/X**3+C3/X**5+C4/X**7           3F9P1000
 LOOP2 FDP     FACTR                                                    3F9P1010
       XCA                                                              3F9P1020
       FAD     COEF2+1,4                                                3F9P1030
       TIX     LOOP2,4,1                                                3F9P1040
       FDP     ARG                                                      3F9P1050
       XCA                                                              3F9P1060
 STIRG FSB     BUFF                                                     3F9P1070
       FRN                                                              3F9P1080
       FAD     SL2PI           =(1/2)LOG(2PI)                           3F9P1090
       FAD     BUFF+1                                                   3F9P1100
       FRN                   LOG GAMMA READY                            3F9P1110
       STO     ARG                                                      3F9P1120
       ZET     FLAG                                                     3F9P1130
       TSX     EXP,4         IF GAMMA IS REQUESTED, CALL $EXP           3F9P1140
       TXI     SXR1,,1                                                  3F9P1150
       PZE     117,,LINK                                                3F9P1160
       PZE     ARG                                                      3F9P1170
       SPACE                                                            3F9P1180
 ERROR CLA     OMEGA                                                    3F9P1190
       NZT     FLAG                                                     3F9P1200
       TRA     ERROR2                                                   3F9P1210
ERROR1 CALL    .FXEM.(EGAM1)                                            3F9P1220
       TRA     RET                                                      3F9P1230
ERROR2 CALL    .FXEM.(EGAM2)                                            3F9P1240
       TRA     RET                                                      3F9P1250
       SPACE   2                                                        3F9P1260
 LIM1  OCT     206426574733        34.843                               3F9P1270
 LIM2  OCT     2400000000                                               3F9P1280
 LIM3  OCT     371614470000        1.54926*2**120                       3F9P1290
 CHAR  OCT     200000000000                                             3F9P1300
  ONE  OCT     201400000000        1.                                   3F9P1310
  K1   OCT     200400000000        0.5                                  3F9P1320
  K2   OCT     202400000000        2.                                   3F9P1330
  K3   OCT     201600000000        1.5                                  3F9P1340
  K4   OCT     1000000000          CHARACTERISTIC REDUCER               3F9P1350
 SL2PI OCT     200726376162        (1/2)LOG(2PI)                        3F9P1360
       OCT     026400372246        B5    CONTINUED FRACTION COEFFICIENTS3F9P1370
       OCT     006062361531        A5      FOR THE RANGE (1.,2.)        3F9P1380
       OCT     003200340365        B4                                   3F9P1390
       OCT     -003515345172       A4                                   3F9P1400
       OCT     201677777722        B3                                   3F9P1410
       OCT     073222266666        A3                                   3F9P1420
       OCT     -115244746515       B2                                   3F9P1430
       OCT     041640747057        A2                                   3F9P1440
       OCT     -273744427306       B1                                   3F9P1450
 COEF1 OCT     -012041435213       A1                                   3F9P1460
       OCT     -166451710112       C4 = -1/1760  STIRLINGS ASYMPTOTIC   3F9P1470
       OCT     166640064007        C3 =  1/1260    EXPANSION COEFFICTS  3F9P1480
       OCT     -170554055406       C2 = -1/360     MODIFIED             3F9P1490
 COEF2 OCT     175525252525        C1 =  1/12                           3F9P1500
 OMEGA OCT     377777777777                                             3F9P1510
 FLAG  PZE                                                              3F9P1520
  ARG  BSS     1                                                        3F9P1530
 FACTR BSS     1                                                        3F9P1540
 BUFF  BSS     2                                                        3F9P1550
 EGAM1 DEC     76                                                       3F9P1560
       PZE     E76MES,,14                                               3F9P1570
       PZE     E76OMS,,4                                                3F9P1580
E76MES BCI     9,0GAMMA(X), X LESS THAN OR EQ TO 2**-127 OR GRT THAN OR 3F9P1590
       BCI     5, EQ TO 34.843 NOT ALLOWED                              3F9P1600
E76OMS BCI     4,0SET RESULT = +OMEGA                                   3F9P1610
 EGAM2 DEC     77                                                       3F9P1620
       PZE     E77MES,,13                                               3F9P1630
       PZE     E76OMS,,4                                                3F9P1640
E77MES BCI     8,0ALGAMA(X), X NON-POSITIVE OR GRT THAN OR EQ TO        3F9P1650
       BCI     5,2.0593*10**36 NOT ALLOWED                              3F9P1660
       SPACE                                                            3F9P1670
  LINK LDIR                                                             3F9P1680
       END                                                              3F9P1690
$*             LIBRARY DFAD,DFMP,DFDP FOR D.P. FUNCTION SUBROUTINES     3F9Q0000
$IBMAP FDAS    150                                                      3F9Q0010
*RELEASED WITH REVISED MATHEMATICS SUBROUTINE LIBRARY (V5,M5)           3F9Q0015
       ENTRY   DFAD                                                     3F9Q0020
       ENTRY   DFMP                                                     3F9Q0030
       ENTRY   DFDP                                                     3F9Q0040
       SPACE   3                                                        3F9Q0050
*              DFAD,DFMP,DFDP SUBROUTINE FOR D. P. FUNCTION SUBROUTINES 3F9Q0060
*                1. CALLING SEQUENCE     TSX   DF**,4                   3F9Q0070
*                                        PZE   MSOP2,T                  3F9Q0080
*                                        PZE   LSOP2,T                  3F9Q0090
*                2. AC,MQ CONTAIN MS AND LS PARTS OF 1ST OPERAND.       3F9Q0100
*                3. (MSOP2,T),(LSOP2,T) ARE LOCATIONS OF MS AND LS      3F9Q0110
*                      PARTS OF 2ND OPERAND.                            3F9Q0120
*                4. ANSWER IS GIVEN IN AC,MQ.                           3F9Q0130
*                5. THESE CIRCUITS ARE LOGICALLY CONSIDERED TO BE PART  3F9Q0140
*                      OF THE CALLING PROGRAM, AND THEREFORE SYSLOC IS  3F9Q0150
*                      NOT RE-SET BY THIS PROGRAM. FOR THE SAME REASON  3F9Q0160
*                      A LINKAGE DIRECTOR IS NOT PROVIDED               3F9Q0170
       SPACE   3                                                        3F9Q0180
 DFAD  STQ     L1            (MA+LA)+(MB+LB)                            3F9Q0190
       FAD*    1,4             =LA+LB+L(MA+MB)+M(MA+MB)                 3F9Q0200
       STO     M2                IGNORE SMALLER TERM                    3F9Q0210
       STQ     L2                                                       3F9Q0220
       CLA     L1            ADD LA AND LB FIRST TO RETAIN SHARPNESS.   3F9Q0230
       FAD*    2,4             THIS ORDER IS ESPECIALLY IMPORTANT FOR   3F9Q0240
       FAD     L2                THE D. P. FUNCTION SUBROUTINES.        3F9Q0250
       FAD     M2                                                       3F9Q0260
       TRA     3,4                                                      3F9Q0270
       SPACE                                                            3F9Q0280
 DFMP  STO     M1            (MA+LA)*(MB+LB)                            3F9Q0290
       FMP*    1,4             = MA*LB + LA*MB + L(MA*MB) + M(MA*MB)    3F9Q0300
       STO     L1                IGNORE SMALLER TERMS                   3F9Q0310
       LDQ     M1                                                       3F9Q0320
       FMP*    1,4                                                      3F9Q0330
       STO     M2                                                       3F9Q0340
       STQ     L2                                                       3F9Q0350
       LDQ     M1                                                       3F9Q0360
       FMP*    2,4                                                      3F9Q0370
       FAD     L1                                                       3F9Q0380
       FAD     L2                                                       3F9Q0390
       FAD     M2                                                       3F9Q0400
       TRA     3,4                                                      3F9Q0410
       SPACE                                                            3F9Q0420
 DFDP  STQ     L1            (MA+LA)/(MB+LB)                            3F9Q0430
       FDP*    1,4             = ((MA+LA)/MB)*(1-LB/MB)                 3F9Q0440
       STO     L2              = (-Q(MA/MB)*LB + R(MA/MB)+LA)/MB        3F9Q0450
       STQ     M2                + Q(MA/MB)                             3F9Q0460
       FMP*    2,4                                                      3F9Q0470
       CHS                     WHERE Q IS QUOTIENT, R IS REMAINDER      3F9Q0480
       FAD     L2                                                       3F9Q0490
       FAD     L1                                                       3F9Q0500
       FDP*    1,4                                                      3F9Q0510
       XCA                                                              3F9Q0520
       FAD     M2                                                       3F9Q0530
       TRA     3,4                                                      3F9Q0540
       SPACE                                                            3F9Q0550
  M1   PZE                                                              3F9Q0560
  M2   PZE                                                              3F9Q0570
  L1   PZE                                                              3F9Q0580
  L2   PZE                                                              3F9Q0590
       END                                                              3F9Q0600
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FVIO              3FA00000
$IBMAP FVIO    50,()OK                                                  3FA00010
       TTL     FVIO - FORTRAN VARIABLE I/O LOGICAL UNIT              $5$3FA00020
       REM                                                              3FA00030
       REM     CALLING SEQUENCE IS CALL .FVIO.(LN,ERAS) WHERE LN IS     3FA00040
       REM     LOCATION OF VARIABLE LOGICAL UNIT AND ERAS WILL CONTAIN  3FA00050
       REM     CONTENTS OF APPROPRIATE .UNXX.  (.UNXX. CONTAINS         3FA00060
       REM     PZE UNITXX WHERE XX CORRESPONDS TO LOGICAL UNIT N).      3FA00070
       REM     FVIO IS CALLED FOR ANY I/O STATEMENT SPECIFYING          3FA00080
       REM     A VARIABLE LOGICAL UNIT.                                 3FA00090
       REM                                                              3FA00100
.FVIO. SAVE    (2)                                                   $5$3FA00110
       CLA*    3,4                   PICK UP LOGICAL UNIT NUMBER     $5$3FA00120
       PAC     ,2                                                    $5$3FA00130
       TXL     ERROR,2,-NUNITS-1     IS UNIT ZERO, OR TOO LARGE      $5$3FA00140
       CLA*    TABLE,2               SAVE ADDRESS OF                 $5$3FA00150
       STO*    4,4                   FILE CONTROL BLOCK              $5$3FA00160
       RETURN  .FVIO.                                                $5$3FA00170
ERROR  CLA*    3,4                   LOGICAL UNIT IN ERROR           $5$3FA00250
       ANA     ADMSK                 DEFINED FOR THIS UNIT VALUE.       3FA00260
       XCA                           CONVERT THIS ILLEGAL VALUE         3FA00270
       AXT     0,4                   TO DECIMAL FOR ERROR MESSAGE.      3FA00280
       STZ     TEMP                                                     3FA00290
CNVT   PXA     0,0                                                      3FA00300
       DVP     L(10)                                                    3FA00310
       ALS     0,4                                                      3FA00320
       ORS     TEMP                                                     3FA00330
       CLA     =1                                                       3FA00340
       TLQ     *+2                                                      3FA00350
       TXI     CNVT,4,-6                                                3FA00360
       CAL     BLANKS                                                   3FA00370
       ALS     6,4                                                      3FA00380
       ORA     TEMP                                                     3FA00390
       SLW     E47MES+6                                                 3FA00400
UNERR  CALL    .FXEM.(CODE)          EXIT FOR EXECUTION ERROR.          3FA00410
       TRA     .LXERR                NO OPTIONAL EXIT.                  3FA00420
CODE   PZE     47                                                       3FA00430
ER47MS PZE     E47MES,,7                                                3FA00440
ER47OP PZE     NOOPXT,,7                                                3FA00450
E47MES BCI     7,0LOGICAL UNIT NOT DEFINED FOR VALUE                    3FA00460
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED               3FA00470
ADMSK  OCT     000000077777                                             3FA00480
TEMP   PZE     **                                                       3FA00490
L(10)  DEC     10                                                       3FA00500
BLANKS BCI     1,                                                       3FA00510
TABLE  PZE     NUNITS                                                   3FA00550
       PZE     .UN01.                                                   3FA00560
       PZE     .UN02.                                                   3FA00570
       PZE     .UN03.                                                   3FA00580
       PZE     .UN04.                                                   3FA00590
       PZE     .UN05.                                                   3FA00600
       PZE     .UN06.                                                   3FA00610
       PZE     .UN07.                                                   3FA00620
       PZE     .UN08.                                                   3FA00630
*      ADDITIONAL UNITS MAY BE INSERTED HERE. FOR EACH UNIT             3FA00640
*      INSERTED, A CORRESPONDING ROUTINE MUST BE INSERTED TO            3FA00650
*      PRODUCE A $FILE CARD FOR THE ADDITIONAL UNIT.                    3FA00660
NUNITS EQU     *-TABLE-1                                                3FA00670
       END                                                              3FA00680
$*     7090/7094 IBLIB INPUT/OUTPUT FORTRAN LIBRARY - FRCD              3FB00000
$IBMAP FRCD    190                                                      3FB00010
       TTL     FRCD/ON-LINE CARD READ AND HOLLERITH TO BCD CONVERSION   3FB00020
       REM                                                              3FB00030
       REM     CALL .FRCD.(LF) IS COMPILED FOR READ F.                  3FB00040
       REM     LF IS LOCATION OF FORMAT STATEMENT F.                    3FB00050
       REM     ENTRY POINT .CARD. IS USED BY FRWD TO READ ONE CARD      3FB00060
       REM     ON-LINE AND TO CONVERT FROM HOLLERITH TO BCD.            3FB00070
       REM                                                              3FB00080
       ENTRY   .FRCD.                                                   3FB00090
.FRCD. SXA     LNKG,4                                                   3FB00191
       SXA     SYSLOC,4                                                 3FB00192
       SXA     RTRN,4                SAVE RETURN TO MAIN PROGRAM        3FB00193
       LAC     SYSUNI,4              OBTAIN LOCATION OF WORD            3FB00200
       CLA     SYSCRD,4              CONTAINING UCB OF SYSTEM CARD      3FB00210
       STA     UCBADD                READER. STORE FOR CALLING SEQUENCE.3FB00220
       CALL    .FIOH.(RDCRD,RTRN)                                       3FB00230
       ORG     *-2                   OVERLAY CALL WITH ARGS             3FB00240
RDCRD  NOP     CARD,1                NOP=READ,TAG=ONLIN SWITCH ON       3FB00250
RTRN   PZE     0,,BCDBUF             DEC. CONTAINS ADDRESS OF BUFFER    3FB00251
CARD   SXA     SVCARD,2              IOEX READ ROUTINE                  3FB00260
       SXA     SVCARD+1,4                                               3FB00261
       TSX     IOXRW,4               ONE CARD ON-LINE.                  3FB00270
       PTW     UCBADD,1,IOCRD                                           3FB00280
       PZE     CEOF                                                     3FB00290
       TSX     CONHB,4               CONVERT INPUT CARD TO BCD.         3FB00300
       AXT     1,2                                                      3FB00310
       SXA     .FDX1,2                                                  3FB00311
       SXA     .FDX2,2                                                  3FB00312
SVCARD AXT     **,2                                                     3FB00313
       AXT     **,4                                                     3FB00314
       TRA     1,2                                                      3FB00320
       REM  ROUTINE TO PERFORM IOEX READ                                3FB00330
IOXRW  SXA     IOXS4,4               SAVE FOR RETURN.                   3FB00340
       CLA     2,4                                                      3FB00350
       STA     IOXEF                 SET EOF EXIT.                      3FB00360
       CAL     1,4                   FIRST WORD OF CALLING SEQUENCE.    3FB00370
       STA     IOXND                 PUT LOC IN ACTIVE CALLING SEQ.     3FB00380
       STA     *+1                   SET TO PICK UP UCB.                3FB00390
       LAC     **,4                  -L(UCB)                            3FB00400
       ARS     18                    LOCATION OF I/O COMMAND.           3FB00410
       STA     IOXSLL                PUT IN SELECT WORD.                3FB00420
       CLA     IOXSLL                GET SELECT WORD.                   3FB00430
       ZET     1,4                   TEST FOR UNIT IN USE.              3FB00440
       TRA     *-1                   WAIT UNTIL OUT OF USE.             3FB00450
       STO     1,4                   SIGNED CONTROL TO UCB WORD 2.      3FB00460
       STZ     IOXIN                 SET IN-OPERATION WORD ON.          3FB00470
       TSX     .ACTV,4               GO ACTIVATE.                       3FB00480
IOXND  PZE     **                    UNIT.                              3FB00490
       NZT     IOXIN                 TEST FOR REQUEST COMPLETE.         3FB00500
       TRA     *-1                   WAIT UNTIL DONE.                   3FB00510
       LDI     IOXIN                 PICK UP COMPLETION BITS.           3FB00520
IOXS4  AXT     **,4                  SET FOR EXIT.                      3FB00530
       LFT     200000                TEST FOR EOF.                      3FB00540
IOXEF  TRA     **                    EOF EXIT.                          3FB00550
       TRA     3,4                   NORMAL RETURN.                     3FB00560
       REM                                                              3FB00570
IOXSLL PTW     **,1,IOXSEL           LOCATION OF SELECT ROUTINE.        3FB00580
IOXIN  PZE     **                    IN-OPERATION WORD.                 3FB00590
       REM                                                              3FB00600
       REM  SELECT ROUTINE                                              3FB00610
IOXSEL SXA     IOXSS4,4              SAVE FOR RETURN.                   3FB00620
       PAC     0,4                   -L(UCB)                            3FB00630
       TMI     IOXPST                POST ENTRY.                        3FB00640
       STZ     SYSJOB+2            ALWAYS BCD. SET MODSW.               3FB00641
       CLA     0,4                   UCB WORD 1.                        3FB00650
       PDX     0,2                   UNIT TO IR2.                       3FB00660
       CLA     1,4                   UCB WORD 2.                        3FB00670
       STA*    .RCHX                 STORE LOC TO RCHX FROM.            3FB00680
       SXA     *+2,2                 PUT UNIT IN SELECT.                3FB00690
       ZET*    SYSJOB+1              SKIP SELECT IF DCS.                3FB00691
       RDS     **                    READ SELECT.                       3FB00700
       XEC*    .RCHX                 ISSUE RESET LOAD CHANNEL.          3FB00710
IOXSS4 AXT     **,4                  RESTORE FOR RETURN.                3FB00720
       TRA     1,4                   EXIT.                              3FB00730
IOXPST STI     IOXIN                 POST TIME, SAVE ERROR FLAGS.       3FB00740
       STL     IOXIN                 SET IN-OPERATION WORD OFF.         3FB00750
       STZ     1,4                   SET UCB WORD 2 TO ZERO.            3FB00760
       TRA     IOXSS4                GO EXIT.                           3FB00770
       REM  HOLLERITH TO BCD CONVERSION                                 3FB00780
CONHB  SXA     SVCON,4                                                  3FB00790
       STI     CONJ                                                     3FB00800
       AXT     12,1                  CLEAR BCD BUFFER.                  3FB00810
       STZ     BCDBUF+12,1                                              3FB00820
       TIX     *-1,1,1                                                  3FB00830
       AXT     4,4                   INITIALIZE LEFT HALF.              3FB00840
CON1   AXC     13,2                                                     3FB00850
       LDI     CONG                  CLEAR SENSE INDICATORS.            3FB00860
       CAL*    COND+4,4              PLACE 3-ROW IN AC.                 3FB00870
       TXI     *+1,2,2                                                  3FB00880
       ORA*    COND+4,4              4-ROW INTO 3-ROW.                  3FB00890
       SLW     CONH                  3-OR 4-ROW TO CONH.                3FB00900
       TXI     *+1,2,-12                                                3FB00910
       LDI*    COND+4,4              Y-ROW TO INDICATORS.               3FB00920
       TXI     *+1,2,2                                                  3FB00930
       OFT*    COND+4,4              CHECK X-ROW AGAINST Y-ROW.         3FB00940
       TRA     ERR                   ZONE PUNCH ERROR.                  3FB00950
       OSI*    COND+4,4                                                 3FB00960
       STI     CONI                  STORE X OR Y.                      3FB00970
       TXI     *+1,2,20                                                 3FB00980
       LDI*    COND+4,4              9-ROW TO INDICATORS.               3FB00990
       TXI     *+1,2,-16                                                3FB01000
       AXT     7,1                                                      3FB01010
CON2   OFT*    COND+4,4              CHECK 9-ROW AGAINST 1 THRU 7.      3FB01020
       TRA     ERR                   NUMERIC PUNCH ERROR.               3FB01030
       OSI*    COND+4,4              ROWS 9 AND 1-7 ORED INTO SI.       3FB01040
       TXI     *+1,2,2                                                  3FB01050
       TIX     CON2,1,1                                                 3FB01060
       IIS     CONH                  TAKE 3 OR 4 OUT OF INDICATORS.     3FB01070
       OFT*    COND+4,4              CHECK 8-ROW AGAINST 9,7,6,5,2,1.   3FB01080
       TRA     ERR                   NUMERIC PUNCH ERROR.               3FB01090
       OSI*    COND+4,4              8-ROW ORED INTO INDICATORS.        3FB01100
       OSI     CONH                  9 THRU 1 ORED INTO INDICATORS.     3FB01110
       TXI     *+1,2,-16                                                3FB01120
       PIA                                                              3FB01130
       ANA*    COND+4,4                                                 3FB01140
       SLW     CONH                  STORE ZERO ZONES.                  3FB01150
       ANA     CONI                                                     3FB01160
       TNZ     ERR                   ZONE PUNCH ERROR.                  3FB01170
       CAL*    COND+4,4                                                 3FB01180
       OAI                                                              3FB01190
       OSI     CONI                  ALL PUNCHES ORED INTO INDICATORS.  3FB01200
       ANA     CONI                                                     3FB01210
       SLW*    COND+4,4                                                 3FB01220
       PIA                                                              3FB01230
       COM                                                              3FB01240
       ORA     CONH                                                     3FB01250
       TXI     *+1,2,-6                                                 3FB01260
       SLW*    COND+4,4                                                 3FB01270
CON3   AXT     6,1                                                      3FB01280
       CAL*    COND+4,4                                                 3FB01290
       SLW     CONH                                                     3FB01300
CON4   LDQ     CONH                                                     3FB01310
       SXA     X1,1                                                     3FB01320
       AXT     6,1                                                      3FB01330
CON5   ALS     5                                                        3FB01340
       LGL     1                                                        3FB01350
       TIX     CON5,1,1                                                 3FB01360
X1     AXT     **,1                                                     3FB01370
       STQ     CONH                                                     3FB01380
       XCL                                                              3FB01390
       MPY     CONA-1,2                                                 3FB01400
       LLS     35                                                       3FB01410
       ACL*    CONE+4,4                                                 3FB01420
       SLW*    CONE+4,4                                                 3FB01430
       TIX     CON4,1,1              THROUGH WITH THIS HALF.            3FB01440
       TXH     CON6,2,-3             YES.                               3FB01450
       TXI     CON3,2,2              NO.                                3FB01460
CON6   TIX     CON1,4,2              THROUGH WITH THIS CARD.            3FB01470
       LDI     CONJ                  YES. RESTORE INDICATORS.           3FB01480
SVCON  AXT     **,4                                                     3FB01490
       TRA     1,4                                                      3FB01500
ERR    CALL    .FXEM.(CODE1)         ILLEGAL CARD CHARACTER.            3FB01510
       TRA     CARD+2                OPTIONAL EXIT,READ NEXT CARD.      3FB01520
CEOF   CALL    .FXEM.(CODE2)         EOF CARD READER.                   3FB01530
       TRA     .LXERR                NO OPTIONAL EXIT.                  3FB01540
       REM                                                              3FB01550
       REM  CONSTANTS AND WORKING STORAGE                               3FB01560
CONA   OCT     11                                                       3FB01570
CONB   PZE     HBUF,0,24                                                3FB01580
       OCT     10                                                       3FB01590
       PZE                                                              3FB01600
       OCT     7                                                        3FB01610
       PZE                                                              3FB01620
       OCT     6                                                        3FB01630
       PZE                                                              3FB01640
       OCT     5                                                        3FB01650
COND   PZE     HBUF-1,2                                                 3FB01660
       OCT     4                                                        3FB01670
       PZE     HBUF,2                                                   3FB01680
       OCT     3                                                        3FB01690
CONE   PZE     BCDBUF+6,1                                               3FB01700
       OCT     2                                                        3FB01710
       PZE     BCDBUF+12,1                                              3FB01720
       OCT     1                                                        3FB01730
CONG   PZE                                                              3FB01740
       OCT     12                                                       3FB01750
CONH   PZE                                                              3FB01760
       OCT     40                                                       3FB01770
CONI   PZE                                                              3FB01780
       OCT     20                                                       3FB01790
CONJ   PZE                                                              3FB01800
       OCT     60                                                       3FB01810
CODE1  PZE     45                                                       3FB01820
ER45MS PZE     E45MES,,4                                                3FB01830
ER45OP PZE     E45OMS,,5                                                3FB01840
E45MES BCI     4,0ILLEGAL CARD CHARACTER                                3FB01850
E45OMS BCI     5,0IGNORE CARD. READ NEXT CARD                           3FB01860
CODE2  PZE     46                                                       3FB01870
ER46MS PZE     E46MES,,4                                                3FB01880
ER46OP PZE     NOOPXT,,7                                                3FB01890
E46MES BCI     4,0END-OF-FILE CARD READER                               3FB01900
NOOPXT BCI     7,0NO OPTIONAL EXIT - EXECUTION TERMINATED               3FB01910
UCBADD PZE     **                                                       3FB01930
IOCRD  IORT    HBUF,,24              I/O CARD READ COMMAND.             3FB01940
HBUF   BSS     26                    HOLLERITH INPUT BUFFER.            3FB01950
BCDBUF BSS     12                    BCD BUFFER.                        3FB01960
       BCI     2,                                                       3FB01970
LNKG   LDIR                                                             3FB01980
       END                                                              3FB01990
$*     7090/7094 FORTRAN MACHINE INDICATOR TEST - FDVCHK                3FC10000
$IBMAP FDVCHK  12                                                       3FC10010
       LBL     DVCK,BEGIN     FDVCHK                                 (7)3FC10013
       TTL     FDVCHK/DIVIDE CHECK TEST ROUTINE                         3FC10020
DVCHK  SAVE    (4)                                                      3FC10030
       CLA     =2                                                       3FC10040
       DCT                                                              3FC10050
       CLA     =1                                                       3FC10060
       STO*    3,4                                                      3FC10070
       RETURN  DVCHK                                                    3FC10080
       END                                                              3FC10090
$*     7090/7094 FORTRAN MACHINE INDICATOR TEST - FSLITE                3FC20000
$IBMAP FSLITE  40                                                       3FC20010
       LBL     SLIT,BEGIN     FSLITE                                 (7)3FC20013
       TTL     FSLITE/SENSE LIGHT ROUTINE                               3FC20020
       ENTRY   SLITET                                                   3FC20030
       ENTRY   SLITE                                                    3FC20040
SLITET CLA     4,4            ENTRY POINT FOR TESTING                   3FC20050
       STA     SLSTO          ADDRESS FOR RESULT                        3FC20060
       STL     SLTI           SET INDICATOR-TEST MODE.                  3FC20070
       TRA     SLSLT          CONTINUE.                                 3FC20080
SLITE  STZ     SLTI           E.P. FOR SETTING-INDICATE SET MODE        3FC20090
SLSLT  SAVEN   (4)            X                                         3FC20100
       SXA     SLLKG,4        SET UP LINKAGE.                           3FC20110
       CLA*    3,4            GET NUMBER OF SENSE LIGHT.                3FC20120
       PAX     0,4            X                                         3FC20130
       TXH     SLFX,4,4       ERROR IF G.T. 4                           3FC20140
       PAC     0,4            COMP. IN I.R.4                            3FC20150
       ZET     SLTI           TEST OR SET MODE                          3FC20160
       TRA     SLTST          TEST, TRANSFER                            3FC20170
       SLN     0,4            TURN ONE LIGHT ON, OR ALL OFF.            3FC20180
       RETURN  SLSLT          RETURN.                                   3FC20190
SLTST  TXL     SLFX,4,0       TEST SENSE LIGHT ZERO ILLEGAL             3FC20200
       CLA     =1             'ONE' MEANS LIGHT 'ON'.                   3FC20210
       SLT     0,4            EXECUTE TEST                              3FC20220
SLRT   CLA     =2             'TWO' MEANS LIGHT 'OFF'.                  3FC20230
SLSTO  STO     **             STORE RESULT                              3FC20240
       RETURN  SLSLT          RETURN                                    3FC20250
SLFX   CALL    .FXEM.(ER51)   TEST OR SET NON-EXISTENT LIGHT            3FC20260
       ZET     SLTI           WHICH, TEST OR SET                        3FC20270
       TRA     SLRT           TEST, DECLARE LIGHT 'OFF'.                3FC20280
       RETURN  SLSLT          SET, IGNORE REQUEST + RETURN.             3FC20290
       SPACE   3                                                        3FC20300
ER51   PZE     51                                                       3FC20310
       PZE     E51MES,,7                                                3FC20320
       PZE     E51OMS,,8                                                3FC20330
       SPACE                                                            3FC20340
E51MES BCI     7,0REFERENCE TO NON-EXISTENT SENSE LIGHT.                3FC20350
E51OMS BCI     8,0DECLARED 'OFF' IF TESTING. IGNORED IF SETTING.        3FC20360
       SPACE                                                            3FC20370
SLTI   PZE     **                                                       3FC20380
SLLKG  LDIR                                                             3FC20390
       END                                                              3FC20400
$*     7090/7094 FORTRAN MACHINE INDICATOR TEST - FOVERF                3FC40000
$IBMAP FOVERF  10                                                       3FC40010
       LBL     FOVF,BEGIN     FOVERF                                 (7)3FC40013
       TTL     FOVERF/OVERFLOW TEST ROUTINE                             3FC40020
OVERFL SAVE    (4)                                                      3FC40030
       CAL     OVFLOW         PICK UP INDICATOR CELL                    3FC40050
       STZ     OVFLOW         RESET CELL                                3FC40060
       ANA     =O000004000000 TEST FOR OVERFLOW BIT                     3FC40070
       LDQ     =1             'ONE' MEANS OVERFLOW                      3FC40080
       TNZ     *+2            X                                         3FC40090
       RQL     1              'TWO' MEANS NO OVERFLOW                   3FC40100
       STQ*    3,4            STORE TEST RESULT                         3FC40110
       RETURN  OVERFL         RETURN                                    3FC40120
       END                                                              3FC40130
$*     7090/7094 FORTRAN MACHINE INDICATOR TEST - FSSWTH                3FC50000
$IBMAP FSSWTH  20                                                       3FC50010
       LBL     SSWT,BEGIN     FSSWTH                                 (7)3FC50013
       TTL     FSSWTH/SENSE SWITCH TEST ROUTINE                         3FC50020
SSWTCH SAVE    (4)                                                      3FC50030
       CLA     4,4            INITIALIZE LOCATION                       3FC50040
       STA     SWSTO          FOR TEST RESULT                           3FC50050
       CLA*    3,4            SENSE SWITCH NUMBER                       3FC50060
       PAC     0,4            COMP. TO IR4                              3FC50070
       TXL     SWFX,4,-7      ERROR IF 0 OR G.T. 6                      3FC50080
       CLA     =1             1 IF SS DOWN                              3FC50090
       SWT     0,4            TEST                                      3FC50100
SWRT   CLA     =2             2 IF SS UP                                3FC50110
SWSTO  STO     **             STORE RESULT                              3FC50120
       RETURN  SSWTCH                                                   3FC50130
SWFX   CALL    .FXEM.(ER53)   ERROR                                     3FC50140
       TRA     SWRT           CONSIDER SS UP                            3FC50150
       SPACE   2                                                        3FC50160
ER53   PZE     53                                                       3FC50170
       PZE     E53MES,,6                                                3FC50180
       PZE     E53OMS,,4                                                3FC50190
       SPACE                                                            3FC50200
E53MES BCI     6,0NON-EXISTENT SENSE SWITCH TESTED.                     3FC50210
E53OMS BCI     4,0SWITCH DECLARED 'UP'.                                 3FC50220
       END                                                              3FC50230
$*     7090/7094 IBLIB SYSTEM LIBRARY - FPARST                          3FPST000
$IBMAP FPARST  28                                                       3FPST010
       LBL     PAST,BEGIN     FPARST                                 (7)3FPST013
       TTL     FPARST/PART AND STORE FUNCTIONS FOR SIFT                 3FPST020
       REM                                                              3FPST030
       REM     IF A REFERENCE TO A DOUBLE PRECISION (OR COMPLEX)        3FPST040
       REM     VARIABLE NAME ALSO APPEARS IN A STATEMENT WITHOUT A D    3FPST050
       REM     (OR AN I) IN COLUMN ONE IN A FORTRAN II SOURCE PROGRAM,  3FPST060
       REM     THAT VARIABLE OR ELEMENT OF AN ARRAY BECOMES AN ARGUMENT 3FPST070
       REM     TO A PART FUNCTION.  THE PART FUNCTION ALSO CONTAINS AS  3FPST080
       REM     ARGUMENTS THE NAME OF THE ARRAY AND ITS LENGTH.  AT      3FPST090
       REM     EXECUTION TIME THE PART FUNCTION RETURNS THE ADDRESS OF  3FPST100
       REM     THE DESIRED PART OF THE DOUBLE PRECISION (OR COMPLEX)    3FPST110
       REM     PAIR.  IF A REFERENCE SIMILAR TO THAT DESCRIBED ABOVE    3FPST120
       REM     OCCURS ON THE LEFT SIDE OF AN ARITHMETIC STATEMENT,      3FPST130
       REM     THEN THE STATEMENT SPECIFIES THAT A QUANTITY BE STORED   3FPST140
       REM     IN ONE PART OF THE NUMBER PAIR.  TO ACCOMPLISH THIS IN   3FPST150
       REM     FORTRAN IV, SIFT REPLACES THE ARITHMETIC STATEMENT BY    3FPST160
       REM     A CALL TO THE STORE SUBROUTINE. THE FIRST THREE ARGUMENTS3FPST170
       REM     ARE THE SAME AS IN A CALL TO PART, AND THE FOURTH        3FPST180
       REM     ARGUMENT IS THE EXPRESSION WHOSE VALUE IS TO  BE STORED. 3FPST190
       REM                                                              3FPST200
       ENTRY   PART                                                     3FPST210
       ENTRY   STORE                                                    3FPST220
PART   STZ     TEST                                                     3FPST230
       TRA     *+2                                                      3FPST240
STORE  STL     TEST                                                     3FPST250
OUT    SAVEN   (4)                                                      3FPST260
       SXA     LNKG,4                                                   3FPST270
       CLS*    5,4                   FORTRAN II ARRAY SIZE.             3FPST280
       ALS     1                     DOUBLE IT.                         3FPST290
       SUB     3,4                   START OF ARRAY.                    3FPST300
       ADD     4,4                   FORTRAN IV ARRAY ELEMENT.          3FPST310
       TZE     FIX                   IF ZERO OR POSITIVE, ADDRESS IS    3FPST320
       TPL     FIX                   FOR LOW ORDER OR IMAGINARY PART.   3FPST330
       CLA     4,4                   FORTRAN IV ADDRESS IS CORRECT.     3FPST340
SETADD STA     A                     SET ADDRESS.                       3FPST350
       STA     B                                                        3FPST360
       ZET     TEST                  TEST WHETHER PART OR STORE ENTRY.  3FPST370
       TRA     STOR                  STORE ENTRY.                       3FPST380
A      CLA     **                    PART ENTRY.                        3FPST390
       RETURN  OUT                   EXIT TO CALLER.                    3FPST400
FIX    ADD     =1                    GET PROPER FORTRAN IV ADDRESS.     3FPST410
       ADD     3,4                                                      3FPST420
       TRA     SETADD                                                   3FPST430
STOR   CLA*    6,4                   GET VALUE OF EXPRESSION TO         3FPST440
B      STO     **                    BE STORED AND STORE.               3FPST450
       RETURN  OUT                   EXIT TO CALLER.                    3FPST460
TEST   PZE     **                                                       3FPST470
LNKG   LDIR                                                             3FPST480
       END                                                              3FPST490
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCS                           3IO00000
$IBMAP .IOCS   5700,()OK                                             $5$3IO00010
       TTL     .IOCS - RELOCATABLE IOCS                             (12)3IO00020
*THIS IS IOCS VERSION -6- WHICH HAS BEEN PREPARED                       3IO00030
*  FROM THE DISTRIBUTED VERSION OF THE IOCS SYSTEM                      3IO00040
* HERE, IOCC IS PRESENTED AS A SET OF SUBROUTINES                       3IO00050
*  WHICH MAY BE USED BY ANY SYSTEM FOR BUFFERRED I/O.                   3IO00060
*  USE OF THE BASIC MONITOR AND EXECUTOR IS REQUIRED.                   3IO00070
*  REFER TO BASIC MONITOR AND IOCS MANUALS FOR                          3IO00080
*  DETAILED CONTENT AND RULES OF USEAGE.                                3IO00090
       SPACE   1                                                        3IO00100
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            3IO00110
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                3IO00120
       SPACE   1                                                        3IO00130
*SYSTEM PRINTER                                                         3IO00140
       SPACE   1                                                        3IO00150
*      PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10              3IO00160
EJECT  EQU     1                                                        3IO00170
       SPACE   1                                                        3IO00180
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       3IO00190
DBLSP  EQU     4                                                        3IO00200
       SPACE   1                                                        3IO00210
*SENSE SWITCHES                                                         3IO00220
       SPACE   1                                                        3IO00230
*SENSE SWITCH FOR CHECKPOINT CONTROL. DOWN INITIATES CHECKPOINT.        3IO00240
SWTCP  EQU     2                                                        3IO00250
       SPACE   1                                                        3IO00260
*SENSE SWITCH FOR LABEL CONTROL. DOWN IGNORES LABEL ERRORS.             3IO00270
LERIG  EQU     3                                                        3IO00280
       SPACE   1                                                        3IO00290
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 3IO00300
       SPACE   1                                                        3IO00310
NOHYP  EQU     0                                                        3IO00320
       SPACE   1                                                       $3IO00330
*END OF EQU CARDS TO BE DEFINED BY INSTALLATION.                        3IO00340
       TTL              IBSYS COMMUNICATION REGION                      3IO00350
IOEX   EQU     .ACTV                                                    3IO00360
(ACTIV EQU     IOEX                VALIDATE UNIT AND                    3IO00370
(ACTVX EQU     IOEX+1               ACTIVATE CHANNEL                    3IO00380
(NDATA EQU     IOEX+2              VALIDATE UNIT AND                    3IO00390
(NDSLX EQU     IOEX+3               NON-DATA SELECT                     3IO00400
(PROUT EQU     IOEX+4              MESSAGE WRITER                       3IO00410
(PUNCH EQU     IOEX+5              HOLLERITH PUNCH                      3IO00420
(FRCHX EQU     IOEX+6              FREE CHANNEL                         3IO00430
(PAWSX EQU     IOEX+7              ERROR PAUSE                          3IO00440
(PAUSE EQU     IOEX+8              OPERATOR ACTION PAUSE                3IO00450
(STOPX EQU     IOEX+9              SYSTEM STOP                          3IO00460
(SYMUN EQU     IOEX+10             SYMBOLIC UNIT CONVERSION             3IO00470
(DECVD EQU     IOEX+11             BIN TO DEC CONV. AC DECRE.           3IO00480
(DECVA EQU     IOEX+12             BIN TO DEC CONV. AC ADDR.            3IO00490
(CKWAT EQU     IOEX+13             CHECKPOINT DELAY ROUTINE             3IO00500
(BCD5R EQU     IOEX+14             BIN TO BCD CONV. MQ 3-17             3IO00510
(BCD5X EQU     IOEX+15             BIN TO BCD CONV. MQ S-14             3IO00520
(CVPRT EQU     IOEX+16             APPEND UNIT AND PRINT MESSAGE        3IO00530
(STOPD EQU     IOEX+17             DEAD STOP                            3IO00540
(CHXAC EQU     IOEX+18             CHANNEL ACTIVITY                     3IO00550
(URRXI EQU     IOEX+19             REDUNDANCY COUNTS                    3IO00560
(RCTXI EQU     IOEX+20             REDUNDANCY CONTROL                   3IO00570
(RCHXI EQU     IOEX+21             RCHX                                 3IO00580
(TCOXI EQU     IOEX+22             TCOX                                 3IO00590
(TRCXI EQU     IOEX+23             TRCX                                 3IO00600
(ETTXI EQU     IOEX+24             ETTX                                 3IO00610
(TEFXI EQU     IOEX+25             TEFX                                 3IO00620
(TRAPX EQU     IOEX+26             INDIRECT REF TRAP CELL               3IO00630
(TRAPS EQU     IOEX+27             CURRENT TRAPS (NORMAL)               3IO00640
(COMMM EQU     IOEX+28             SCHX RESULT AT TRAP                  3IO00650
(LTPOS EQU     IOEX+29             TP. POSITION BEFORE TRAP             3IO00660
(IOXSI EQU     IOEX+30             SI AT TRAP                           3IO00670
(CHPSW EQU     IOEX+31             CHECKPOINT SWITCH                    3IO00680
(TRPSW EQU     IOEX+32             TRAP SWITCH                          3IO00690
(FDAMT EQU     IOEX+33                                                 $3IO00700
(CHXSP EQU     IOEX+38                                                  3IO00710
       SPACE   1                                                        3IO00720
*                  INTERMEDIATE DEFINITIONS                             3IO00730
PROUT  EQU     (PROUT                                                   3IO00740
PAWS   EQU     (PAWSX                                                   3IO00750
PAUSE  EQU     (PAUSE                                                   3IO00760
STOP   EQU     (STOPX                                                   3IO00770
ACTV   EQU     (ACTIV                                                   3IO00780
TRAPS  EQU     (TRAPS                                                   3IO00790
CVPRT  EQU     (CVPRT                                                   3IO00800
       SPACE   1                                                        3IO00810
BCD5   EQU     (BCD5X                                                   3IO00820
COMM   EQU     (COMMM                                                   3IO00830
LTPOS  EQU     (LTPOS                                                   3IO00840
INTRAP EQU     (TRPSW                                                   3IO00850
SYUNCV EQU     (SYMUN                                                   3IO00860
NDATA  EQU     (NDATA                                                   3IO00870
BPRNT  EQU     (PROUT                                                   3IO00880
BSK1   EQU     EJECT                                                    3IO00890
BPAWS  EQU     (PAWSX                                                   3IO00900
TRPSW  EQU     (TRPSW                                                   3IO00910
STOPD  EQU     (STOPX                                                   3IO00920
       SPACE   1                                                        3IO00930
*                  ADDITIONAL OVERLAY EQUATES                           3IO00940
X09CH  EQU     NOCH+NOHYP                                               3IO00950
NOCHX  EQU     X09CH/X09CH                                              3IO00960
       SPACE   1                                                        3IO00970
       SPACE   1                                                        3IO00980
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $3IO00990
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $3IO01000
CP2    BOOL    100000              ARE 00,01,10                        $3IO01010
OPEND  BOOL    40000               IF=1 FILE OPEN                       3IO01020
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               3IO01030
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              3IO01040
MODE   BOOL    04000               IF=1 BINARY FILE                     3IO01050
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             3IO01060
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 3IO01070
LABEL  BOOL    00400               IF=1 LABELS                          3IO01080
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                3IO01090
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       3IO01100
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               3IO01110
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              3IO01120
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        3IO01130
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                3IO01140
NOEOT  BOOL    00004               IF=1 NO EOT                          3IO01150
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            3IO01160
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                3IO01170
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           3IO01180
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          3IO01190
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $3IO01200
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  3IO01210
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  3IO01220
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            3IO01230
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    3IO01240
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    3IO01250
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             3IO01260
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  3IO01270
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       3IO01280
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               3IO01290
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        3IO01300
STSH   BOOL    00100               IF =1 STASH ROUTINE                  3IO01310
CPYFN  BOOL    00040               IF =1 COPY MODE                      3IO01320
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         3IO01330
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  3IO01340
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    3IO01350
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    3IO01360
IOSY   BOOL    00004               IF=1, IOSY WRITE                     3IO01370
NORUN  BOOL    00002               IF=1 NO REW UNLD                     3IO01380
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 3IO01390
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          3IO01400
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $3IO01410
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               3IO01420
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        3IO01430
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     3IO01440
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 3IO01450
CDBTS  BOOL    24000               DISCN+EOB                            3IO01460
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     3IO01470
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        3IO01480
OUTPUT BOOL    03000               PTO+TTO                              3IO01490
OPDET  BOOL    40002               OPEND+DETACH                         3IO01500
RESOP  BOOL    60000               RESER+OPEND                          3IO01510
OPNEOT BOOL    40004               OPEND+NOEOT                          3IO01520
RANDG  BOOL    00030               RUSH+GIVUP                           3IO01530
EOBITS BOOL    44400               DONLY+EOB+HOLD                       3IO01540
DIGEN  BOOL    30000               DISCN+GENER                          3IO01550
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     3IO01560
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       3IO01570
NOREOF BOOL    00003               NORED + NOEOF                        3IO01580
RBITS  BOOL    00011               RUSH + RHIST                        $3IO01590
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 3IO01600
NETIH  BOOL    10004               NO EOT+NINHIB                        3IO01610
REWNUN BOOL    00006               NORUN + NOREW                       $3IO01620
       TTL     IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION    3IO01630
*      MINIUM COMMUNICATION REGION WITH .MINCR                          3IO01640
.DEFI. CONTRL  DEFIN.,DEFIN.                                            3IO01650
.JOINX CONTRL  JOINX,JOINX                                              3IO01660
.ATTC. CONTRL  ATTCH.,ATTCH.                                            3IO01670
.CLOS. CONTRL  CLOSE.,CLOSE.                                            3IO01680
.OPEN. CONTRL  OPEN.,OPEN.                                              3IO01690
.READ. CONTRL  READ.,READ.                                              3IO01700
.WRIT. CONTRL  WRITE.,WRITE.                                            3IO01710
.RER1. CONTRL  READR1,READR1                                            3IO01720
.RLSE. CONTRL  RELASE,RELASE                                            3IO01730
.SWITC CONTRL  SWITCH,SWITCH                                            3IO01740
.GTIOX CONTRL  GTIOX,GTIOX                                              3IO01750
.EOTOF CONTRL  EOTOF,EOTOF                                              3IO01760
.MONSW CONTRL  MONSW,MONSW                                              3IO01770
.TEOR  CONTRL  TEOR,TEOR                                                3IO01780
.RW7   CONTRL  RW7,RW7                                                  3IO01790
.ENDTR CONTRL  ENDTRK,ENDTRK                                            3IO01800
.TCHEX CONTRL  TCHEX,TCHEX                                              3IO01810
.L(0)  CONTRL  L(0),L(0)                                                3IO01820
.FEEIT CONTRL  FEEIT,FEEIT                                              3IO01830
.RER2. CONTRL  READR2,READR2                                            3IO01840
.OP4   CONTRL  OP4,OP4                                                  3IO01860
.SH1   CONTRL  SH1,SH1                                                  3IO01870
.RE7   CONTRL  RE7,RE7                                                  3IO01880
.SEL59 CONTRL  SEL5.9,SEL5.9                                            3IO01890
.ETOF3 CONTRL  ETOF3,ETOF3                                              3IO01900
.SH9   CONTRL  SH9,SH9                                                  3IO01910
.OP7   CONTRL  OP7,OP7                                                  3IO01920
.OP9.2 CONTRL  OP9.2,OP9.2                                              3IO01930
.MNT1A CONTRL  MNT1A,MNT1A                                              3IO01940
.EOFEX CONTRL  EOFEX,EOFEX                                              3IO01950
.BSF5  CONTRL  BSF5,BSF5                                                3IO01960
.BSR.  CONTRL  BSR.,BSR.                                                3IO01970
S5     BSS     0                                                        3IO01980
ENTRY  EQU     .ENTRY                                                   3IO01990
NOPXIT EQU     .NOPXI                                                   3IO02000
COMXIT EQU     .COMXI                                                   3IO02010
CPFILE EQU     .LFBLK+1                                                 3IO02020
CPSEQ  EQU     .LFBLK+2                                                 3IO02030
LTSX   EQU     .LFBLK+3                                                 3IO02040
XEOB   EQU     .LFBLK+4                                                 3IO02050
XEOF   EQU     .LFBLK+5                                                 3IO02060
XERR   EQU     .LFBLK+6                                                 3IO02070
LTRAD  EQU     .LFBLK+7                                                 3IO02080
TRANS  EQU     .LFBLK+8                                                 3IO02090
WDCT   EQU     .LFBLK+9                                                 3IO02100
CKPT1  EQU     .LUNBL+1                                                 3IO02110
SWITCD EQU     .LUNBL+2                                                 3IO02120
MONEOF EQU     .LUNBL+3                                                 3IO02130
IRS    EQU     .AREA1-3                                                 3IO02140
SENSE  EQU     .AREA1-2                                                 3IO02150
FCW    EQU     .AREA1-1                                                 3IO02160
LAREA1 EQU     .AREA1                                                   3IO02170
GO     EQU     .GO                                                      3IO02180
DATE   EQU     .JDATE                                                   3IO02190
ROUTE  EQU     .ENTRY+8                                                 3IO02200
MWR    EQU     .MWR                                                     3IO02210
LAREA  EQU     .LAREA                                                   3IO02220
LFLBLK EQU     .LFBLK                                                   3IO02230
LUNBLK EQU     .LUNBL                                                   3IO02240
* PRIMARY IOCS COMMUNICATIONS                                           3IO02250
       TTL              CONSTANT POOL                                   3IO02260
L(0)   PZE                                                              3IO02270
L(1)   PZE     1                                                        3IO02280
L(6)   PZE     6                                                        3IO02290
L(22)  PZE     22                                                       3IO02300
L(377) OCT     377                                                      3IO02310
L(400) OCT     400                                                      3IO02320
ADDRS  PZE     -1                                                       3IO02330
1DEC   PZE     0,,1                                                     3IO02340
1B17   EQU     1DEC                                                     3IO02350
TTOCT  OCT     17600000                                                 3IO02360
L(0)D  PZE     0,,L(0)                                                  3IO02370
DECRE  PZE     0,,-1                                                    3IO02380
1PRE   PON                                                              3IO02390
FOR    FOR                                                              3IO02400
SIX    SIX                                                              3IO02410
6PRE   EQU     SIX                                                      3IO02420
7PRE   SVN                                                              3IO02430
BLNKS  BCI     1,                                                       3IO02440
L(DWRC OCT     100677777777                                            $3IO02450
LDWRC  OCT     000600000000                                            $3IO02460
L(40)  PZE     40                                                      $3IO02470
BVDG   OCT     020100000000                                             3IO02480
DEC15  OCT     000017000000                                             3IO02490
       BES     *-5+NOCHX/NOCHX*5-*                                      3IO02500
MONSW  CAL     0,2                 NOTE SWITCH IN                       3IO02510
       SXA     MONS4,4             SYSTEM UNITS                         3IO02520
       PAC     0,4                 TEST FOR                             3IO02530
       STD     *+1                 SAME UNIT                            3IO02540
       TXI     *+1,4,**            X                                    3IO02550
       TXH     *+3,4,0             SWAP ENTRIES                         3IO02560
MONS4  AXT     **,4                SAME UNIT.                           3IO02570
       TRA     1,4                 EXIT                                 3IO02580
       STA     MONS1               DIFFERENT UNITS SAVE L(UCW)1         3IO02590
       ARS     18                  X                                    3IO02600
       STA     MONS2               SAVE L(UCW)2                         3IO02610
       CAL     SYSUNI              GET INDEX TO SYSUNI                  3IO02620
       ARS     18                  COMPUTE INDEX ADDRESS                3IO02630
       ACL     SYSUNI              X                                    3IO02640
       STA     MONS3               X                                    3IO02650
       SXA     MONS5,2             SAVE IR2                             3IO02660
       LXD     SYSUNI,4            NUMBER OF UNITS IN SYSUNI            3IO02670
       LXD     SYSUNI,2            X                                    3IO02680
       STA     *+1                 X                                    3IO02690
MONS6  CAL     **,4                FIND SYSTEM FUNCTION                 3IO02700
       ANA     ADDRS               USING UNIT 1                         3IO02710
       ERA     MONS1               X                                    3IO02720
       TZE     *+3                 FOUND.                               3IO02730
       TIX     *-4,4,1             NOT YET.                             3IO02740
       TRA     MONS5               ALL DONE                             3IO02750
MONS3  CAL     **,2                FIND SYSTEM FUNCTION                 3IO02760
       ANA     ADDRS               USING UNIT 2                         3IO02770
       ERA     MONS2               X                                    3IO02780
       TZE     *+3                 FOUND.                               3IO02790
       TIX     MONS3,2,1           NOT YET.                             3IO02800
       TRA     MONS5               ALL DONE.                            3IO02810
       CLA     MONS1               SWITCH                               3IO02820
       STA*    MONS3               SYSTEM UNITS.                        3IO02830
       CLA     MONS2               X                                    3IO02840
       STA*    MONS6               X                                    3IO02850
MONS5  AXT     **,2                RESTORE IR2                          3IO02860
       TRA     MONS4               GO RESTORE IR1 AND EXIT.             3IO02870
MONS1  PZE     **                  UNIT 1 (L(UCW))                      3IO02880
MONS2  PZE     **                  UNIT 2 (L(UCW))                      3IO02890
       TTL         TEST FOR   $ENDREEL   CARD AFTER EOF ON SYSTEM UNIT  3IO02900
TEOR   SXA     EORX4,4             SAVE IR4                             3IO02910
       STI     EORI                SAVE INDICATORS                      3IO02920
       CAL     EORT                SET UP SELECT                        3IO02930
       AXT     0,4                 TEST FOR                             3IO02940
       LDI*    0,2                 CARD UNIT                            3IO02950
       LFT     100                 X                                    3IO02960
       TRA     EORX4               ALWAYS EOF IF CARD UNIT              3IO02970
       AXC     1,4                 TO READ NEXT RECORD                  3IO02980
       SLW*    0,2                 AFTER END OF FILE                    3IO02990
       TSX     (NDATA,4            BACK SPACE OVER                      3IO03000
       PZE     0,2,BSROP           RECORD.                              3IO03010
       AXC     1,4                 WAIT TILL                            3IO03020
       ZET*    0,2                 ALL DONE.                            3IO03030
       TRA     *-1                 X                                    3IO03040
       CAL     LAREA               COMPARE WITH                         3IO03050
       ERA     MONEOR              MONITOR END REEL                     3IO03060
EORX4  AXT     **,4                RESTORE IR4                          3IO03070
       LDI     EORI                RESTORE INDICATORS                   3IO03080
       TZE     2,4                 EXIT IF END REEL                     3IO03090
       TRA     1,4                 END OF FILE.                         3IO03100
EORT   PZE     EORIOC,,*+1         SELECT WORD.                         3IO03110
       PAC     0,2                 SELECT ROUTINE.                      3IO03120
       TMI     EORM                TRANSFER IF POSTING.                 3IO03130
       LDI     0,2                                                     $3IO03140
       LFT     20000               HYPER                               $3IO03150
       TRA     EORH                YES                                 $3IO03160
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO03170
       CAL     0,2                 SET UP FOR                           3IO03180
       ARS     18                  READ                                 3IO03190
       STA     *+3                                                      3IO03200
       STZ     SYSJOB+2                                                 3IO03201
       ZET*    SYSJOB+1                                                 3IO03202
       RDS     **                  SELECT UNIT                          3IO03210
       CAL     1,2                 PICK UP COMMAND LOCATION.            3IO03220
       STA*    (RCHXI              INTO RCHX                            3IO03230
       XEC*    (RCHXI              READ INTO LABEL AREA.                3IO03240
       STZ*    (RCTXI              SUPPRESS REDUNDANCY CHECKING.        3IO03250
       TRA     1,4                 RETURN TO IOEX.                      3IO03260
EORM   STZ     1,2                 CLEAR UCB WORD 2                     3IO03270
       TRA     1,4                 RETURN TO IOEX.                      3IO03280
EORH   CLA     HYSEL                                                   $3IO03290
       ANS     HSMS+5                                                  $3IO03300
       PIA                                                             $3IO03310
       ANA     DEC15                                                   $3IO03320
       ORS     HSMS+5                                                  $3IO03330
       CAL     L(22)                                                   $3IO03340
       LFT     40                                                      $3IO03350
       ADD     L(1)                                                    $3IO03360
       STA     HSMS                                                    $3IO03370
       CAL     *-1                                                     $3IO03380
       TRA     EORM-4                                                  $3IO03390
HSMS   SMS     22                                                      $3IO03400
       CTLR    *+3                                                     $3IO03410
       CPYD    LAREA,,14                                               $3IO03420
       TCH     SYSTWT                                                  $3IO03430
       OCT     120600120112                                            $3IO03440
       BES     EORH+NOHYP/NOHYP**-NOHYP/NOHYP*EORH-*                    3IO03450
EORIOC IORT    LAREA,,14           COMMAND TO READ RECORD.              3IO03460
MONEOR BCI     1,$ENDREEL          MONITOR END OF REEL DESIGNATION.     3IO03470
EORI   PZE     **,,**              TEMP STORAGE FOR INDICATORS          3IO03480
       SPACE   1                                                        3IO03490
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              3IO03500
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  3IO03510
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              3IO03520
NTRES  SVN     -1-SWATT-NOREW-NORUN-NOEOFM,7,-1-RESER                   3IO03530
NOTIN  SVN     -1,7,-1-NINHIB                                           3IO03540
EOTBT  SVN     -1,7,-1-NOEOT                                            3IO03550
NEOTBT PZE     0,,NOEOT                                                 3IO03560
MODBT  PZE     0,0,MODE                                                 3IO03570
EOFBT  PZE     0,0,OUTPUT          MASK FOR BSF                        $3IO03580
       SPACE   1                                                        3IO03590
       TTL     DEFINE A. BUFFER POOL                                    3IO03600
*      CALLING SEQUENCE                                                 3IO03610
*              TSX  DEFINE,4                                            3IO03620
*              PZE  L(POOL)                                             3IO03630
*              PZE  N,,EFF BUF SIZE                                     3IO03640
*              RETURN                                                   3IO03650
*                                WHERE                                  3IO03660
*                  L(POOL) = LOCATION OF BUFFER POOL                    3IO03670
*                  N= NUMBER OF BUFFERS TO BE FORMED                    3IO03680
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            3IO03690
*      COMMENTS-                                                        3IO03700
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   3IO03710
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   3IO03720
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                3IO03730
*         3.THE MAXIMUM NUMBER OF BUFFERS PER POOL =32,767              3IO03740
       SPACE   1                                                        3IO03750
DEFIN. CLS     -1,4                SAVE                                 3IO03760
       ACL     L(1)                L(POOL+1)                            3IO03770
       STA     DE1                                                      3IO03780
       ACL     L(1)                SET LOCATION                         3IO03790
       STA     DE3                 OF 1ST BUFFER                        3IO03800
       STO*    FCW                 SET BPC= FOR BUF1,,0                 3IO03810
       CAL     0,4                 SET SECOND WORD                      3IO03820
       ANA     DECRE               OF POOL =                            3IO03830
       LGL     4                   S-13= BUF. SIZE                      3IO03840
DE1    SLW     **                  14-35 = 0                            3IO03850
       CLA     0,4                 SET IORT                             3IO03860
       STD     FCW                 =IORT POOL,,SIZE                     3IO03870
       PDX     0,1                 PLACE SIZE+2                         3IO03880
       TXI     *+1,1,2             INTO IR1                             3IO03890
       PAX     0,2                 NUMBER OF BUFFERS                    3IO03900
       ALS     18                  TO IR2                               3IO03910
       STD*    FCW                 AND POOL                             3IO03920
       CLA     DE3                 GO SETUP                             3IO03930
       TRA     DE5                 CHAIN MECHANISM                      3IO03940
DE2    CLA     FCW                 CHAIN BUFFER POOL                    3IO03950
DE3    STZ     **                  1ST BUFFER CONTROL WORD              3IO03960
       STA*    *-1                 = 0 00000 0 CHAIN                    3IO03970
DE4    STO     **                  2ND= IORT BPC,,SIZE                  3IO03980
       TNX     DE6,2,1             TEST IF N FORMED                     3IO03990
       PXA     0,1                 CHAIN LAST                           3IO04000
       ACL     DE3                 BUF TO NEXT                          3IO04010
       STA*    DE3                 FINAL BUFFER IS                      3IO04020
       STA     DE3                 CHAINED TO BPC                       3IO04030
DE5    ACL     L(1)                                                     3IO04040
       ANA     ADDRS                                                    3IO04050
       STA     DE4                                                      3IO04100
       TRA     DE2                                                      3IO04110
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              3IO04120
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         3IO04130
       TXI     .EX34,4,-1          EXIT AT 3,4                          3IO04140
DE7    PZE     .FDPOS,,0      LOWER BUFF LIMIT                          3IO04150
*                           JOIN ENTRY POINT                            3IO04160
*         PLACED HERE FOR L(ENTRY) CHECK IN EOT CHECK SUPPRESS          3IO04170
       SPACE   1                                                        3IO04180
JOINX  BSS     1                   TRA  JOIN                            3IO04190
       SPACE   1                                                        3IO04200
*                POOL DEFINITION OR JOIN ERROR HANDLER                  3IO04210
*   ENTRY AT TSXR STORES AC AS MESSAGE PARAM, ADDS L(TSX) AND PRINTS    3IO04220
PERR   CAL     PRR1                POOL ERROR MESSAGE USE               3IO04230
TSXR   LAC     LTSX,1              FIND L(TSX)                         $3IO04240
       SLW     TSXR1               STORE MESSAGE PARAM                  3IO04250
       PXA     0,1                 L(TSX) TO AC                         3IO04260
       LGR     15                                                       3IO04270
       ENB     L(0)                TRAP PROTECT BCD5 ROUTINE            3IO04280
       TSX     BCD5,4                                                   3IO04290
       SLW     TEMP                                                     3IO04300
       TSX     PROUT,4             PRINT MESSAGE                        3IO04310
L(2)   PZE     2                   ADDING L(TSX)                       $3IO04320
TSXR1  MZE     **,,**              TO END OF IT                         3IO04330
       PZE     TEMP,,1                                                  3IO04340
       TSX     STOP,4              STOP -IMPOSSIBLE TO CONTINUE         3IO04350
PRR1   MZE     MESS5,,3                                                 3IO04360
       TTL     ATTACH AND CLOSE ROUTINE                                 3IO04370
*                          CALLING SEQUENCES                            3IO04380
       SPACE   1                                                        3IO04390
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 3IO04400
*              PZE  POOL            TO SPECIFIED POOL                   3IO04410
*              PZE  LIST,,FILECT                                        3IO04420
       SPACE   1                                                        3IO04430
*              TSX  CLOSE,4        MULTIPLE FILE CLOSE                  3IO04440
*              PRE  LIST,,FILECT                                        3IO04450
       SPACE   1                                                        3IO04460
*              TSX CLOSE,4         SINGLE FILE CLOSE                    3IO04470
*              PRE  FILE                                                3IO04480
*                                   PRE=PZE REWIND UNLOAD               3IO04490
*                                      =PTW REWIND                      3IO04500
*                                      =MZE NO REWIND                   3IO04510
*                                      =MON NO EOF OR TRAILERS          3IO04520
*                             RESTRICTIONS                              3IO04530
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        3IO04540
*                  IN ONE ATTACH CALLING SEQUENCE                       3IO04550
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       3IO04560
*              3. THE BUFFERS SET ASIDE FOR A GROUP ARE REGAINED WHEN   3IO04570
*                  THE SVN WORD IS REFERENCED IN A CLOSE LIST           3IO04580
*              4. IF A RESERVE GROUP WORD APPEARS IN A CLOSE LIST       3IO04590
*                  THE ENTIRE GROUP OF RESERVE FILES MUST APPEAR AND    3IO04600
*                  BE INCLUDED IN THE FILECT.                           3IO04610
*              5. LAST RESERVE GROUP MUST HAVE AT LEAST ONE FILE        3IO04620
*              6. ALL IMMEDIATE FILES MUST PRECEDE ALL RESERVE FILES    3IO04630
*              7. FILES OF MORE THAN ONE POOL MAY APPEAR IN A CLOSE     3IO04640
*                  LIST.                                                3IO04650
*              8. A FILE IF REWOUND UNLOADED MAY NEVER AGAIN            3IO04660
*                  BE REFERENCED                                        3IO04670
       SPACE   1                                                        3IO04680
*                            CLOSE ROUTINE                              3IO04690
CLOSE. AXT     SHUT,1              PLACE CLOSE ACTION IN CALL           3IO04700
       STZ     7GRP                TO SUBROUTINES                       3IO04710
       CAL     -1,4                PLACE CLOSE                          3IO04720
       ARS     33                  MODE BITS IN                         3IO04730
       PAI                         SI                                   3IO04740
       CLA     -1,4                                                     3IO04750
       PDX     0,2                 TEST FOR SINGLE OR                   3IO04760
       TXH     CA1,2,0             MULTIPLE CLOSE                       3IO04770
       SXA     *+1,4               DUMMY LIST HANDLER TO                3IO04780
       AXC     **,2                HANDLE ONE FILE IN                   3IO04790
       TXI     CA2,2,-2            ACTUAL CALLING SEQUENCE              3IO04800
*                            ATTACH ROUTINE                             3IO04810
ATTCH. STA     LBC                 SAVE L(POOL)                         3IO04820
       CLA     1TAG                SET OUTPUT CHAIN =0                  3IO04830
       STA     1,2                 IF POOL HAS BEEN                     3IO04840
       ANA     1,2                 JOINED TO ANOTHER POOL GIVE          3IO04850
       TNZ     PERR                '' POOL ERROR ''                     3IO04860
       LDI     CA27                PLACE ATTACH MODE BIT IN SI          3IO04870
       AXT     OPAT,1              PLACE OPEN CALL                      3IO04880
       CLA     0,4                 FOR SUBROUTINE                       3IO04890
       TXI     CA1,4,-1            ADVANCE EXIT TO ACCT FOR XTRA WORD   3IO04900
       TTL     COMMON ROUTINE ATTACH AND CLOSE                          3IO04910
CA1    PAX     0,2                 PLACE L(LIST)-1                      3IO04920
       TXI     *+1,2,-1            IN LIST PROCESSOR                    3IO04930
CA2    SXA     CA51,2                                                   3IO04940
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       3IO04950
       SXA     GTIOX,4             SAVE L(EXIT)                         3IO04960
       SXA     CA23+1,1            PLACE CALL FOR OPEN OR SHUT          3IO04970
       RNT     SWATT               ATTACH OR                            3IO04980
       TRA     CA10                CLOSE                                3IO04990
*                          ATTACH SUPERVISOR                            3IO05000
CA3    TSX     CA50,4              GET ENTRY FROM LIST                  3IO05010
       TRA     CA6                 ENTRY IS PZE FILE                    3IO05020
       LAC     CA24,1              ENTRY IS SVN FILECT,,BUFCT           3IO05030
       SXD     CA4,1               STORE FILECT FOR REDUCING BUFCT      3IO05040
       PDX     0,1                 REDUCE                              $3IO05050
       PDX     0,4                 THE                                 $3IO05060
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             3IO05070
       PXD     0,4                 THAT THE SPECIFIED NUMBER            3IO05080
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        3IO05090
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        3IO05100
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   3IO05110
       SIL     RESER               SET RESERVE BIT                      3IO05120
CA5    PXD     **,1                REDUCE IBACT BY                      3IO05130
       TSX     ADIBC,1             BUFFER COUNT FOR THE GROUP           3IO05140
       TRA     CA3                 PROCESS FILE LIST                    3IO05150
*                        FILE HANDLER (ATTACH)                          3IO05160
       SPACE   1                                                        3IO05170
CA6    LFT     OPDET               IF ATTEMPTED ATTACH OF AN OPEN OR    3IO05180
       TRA     CA60                DETACHED FILE -ERROR STOP            3IO05190
       CLA     LBC                 PLACE L(POOL) IN                     3IO05200
       STA     2,2                 FILE CONTROL WORDS                   3IO05210
       ALS     18                  2ND WORD ADDRESS AND                 3IO05220
       STD     4,2                 5TH WORD DECREMENT                   3IO05230
       CAL     CA5                 IF THE FILE                          3IO05240
       LFT     RESER               IS A RESERVE FILE                    3IO05250
       STA     3,2                 PLACE L(SVN WORD)                    3IO05260
       TRA     CA20                IN FILE CONTROL BLOCK                3IO05270
*                           CLOSE SUPERVISOR                            3IO05280
CA10   TSX     CA50,4              PROCESS ENTRY IN FILE LIST           3IO05290
       TRA     CA13                ENTRY WAS PZE FILE                   3IO05300
       LXD     CA26,1              IF SINGLE FILE CLOSE                $3IO05310
       TXL     CA13,1,0            GO AS IF NO SUN                     $3IO05320
       ZET     7GRP                ENTRY IS SVN WORD                    3IO05330
       TSX     CA11,4              IF A SVN OCCURRED BEFORE-UPDATE      3IO05340
       CLA     CA51                ITS COUNTS AND SAVE THE              3IO05350
       STA     7GRP                LOCATION OF THE NEW SVN WORD         3IO05360
       TRA     CA10                PROCESS FILE LIST                    3IO05370
*POST-PROCESSOR OF SVN WORD (AFTER FILES OF THE GROUP HAVE BEEN CLOSED) 3IO05380
CA11   CLA*    7GRP                UP THE BUFFER COUNT                  3IO05390
       PAX     0,1                 BY THE FILECT OF THE                 3IO05400
       SXD     CA12,1              GROUP , THEN ADJUST                  3IO05410
       PDX     0,1                 IBACT BY THE INCREMENTED             3IO05420
CA12   TXI     *+1,1,**            BUFFER COUNT THAT WAS                3IO05430
       PXD     0,1                 RESERVED SOLELY FOR                  3IO05440
       STD*    7GRP                THE RESERVE GROUPS USAGE             3IO05450
       SSM                         SET TO ADD THIS COUNT.               3IO05460
       TSX     ADIBC,1                                                  3IO05470
       TRA     1,4                 EXIT                                 3IO05480
*                        FILE PROCESSOR(CLOSE)                          3IO05490
CA13   LFT     RESOP               IF FILE IS ALREADY                   3IO05500
       LFT     DETACH              PERMANENTLY CLOSED                   3IO05510
       TRA     CA25                THIS CLOSE IS A NOP                  3IO05520
       TSX     FNLBC,4             FIND L(POOL)                         3IO05530
*                GENERAL FILE HANDLER ATTACH AND CLOSE                  3IO05540
CA20   LAC     LBC,4               L(POOL) TO IR4                       3IO05550
       LFT     RESER               IF THE FILE IS A RESERVE, COUNTS     3IO05560
       TRA     CA23                HAVE BEEN ADJUSTED ALREADY           3IO05570
       LFT     TTO                 1ST TTO(ATTACH) AND LAST TTO (CLOSE) 3IO05580
       TRA     CA40                AFFECTS BY ONE BUFFER                3IO05590
CA22   CLS     1DEC                ADJUST IBACT BY                     $3IO05600
       TSX     ADIBC,1             1 EACH INPUT,PTO AND 1 ALL TTOS      3IO05610
CA23   ENB     TRAPS               ALLOW TRAPS                          3IO05620
       TSX     **,4                EITHER OPEN OR                       3IO05630
CA24   PZE     **                  SHUT THE FILE                        3IO05640
       PIA                         PLACE CONTROL BITS                   3IO05650
       STD     1,2                 IN FILE                              3IO05660
CA25   LXD     CA26,1              ADVANCE                              3IO05670
       TNX     CA27,1,1            ALONG FILE LIST                      3IO05680
       SXD     CA26,1              AS LONG AS MORE FILES                3IO05690
       RNT     SWATT               RETURN TO                            3IO05700
CA26   TXL     CA10,0,**           CA10 (CLOSE)                         3IO05710
       TRA     CA3                 CA3 (ATTACH)                         3IO05720
CA27   RNT     SWATT               IF A SVN APPEARED                    3IO05730
       NZT     7GRP                IN A CLOSE LIST AND                  3IO05740
       TRA     COMXIT+3            LIST ENDS ADJUST SVN WORD            3IO05750
       TSX     CA11,4              COUNTS BEFORE                        3IO05760
       TRA*    *-2                 EXITING                              3IO05770
       EJECT                                                            3IO05780
*                           TTO FILE HANDLER                            3IO05790
CA40   CAL     1,4                 DETERMINE IF THIS                    3IO05800
       RNT     SWATT               TTO IS THE FIRST ONE                 3IO05810
       SSM                         ATTACHED OR THE LAST                 3IO05820
       ADD     2TAG                ONE CLOSED, IF SO                    3IO05830
       SLW     1,4                 ADJUST IBACT BY ONE                  3IO05840
       ANA     TTOCT               NOTE.... RESERVE FILES (TTO)         3IO05850
       TZE     CA22                ARE NOT INCLUDED IN TTO CT           3IO05860
       ERA     2TAG                NOR DO THEY AFFECT                   3IO05870
       RFT     SWATT               ANY COUNTS AS THEY ARE HANDLED       3IO05880
       TZE     CA22                BY SVN WORD                          3IO05890
       TRA     CA23                                                     3IO05900
*                         FILE LIST PROCESSOR                           3IO05910
CA50   CLA     CA51                ADVANCE IN LIST                      3IO05920
       ACL     L(1)                NOTE... THAT L(LIST)-1 ORIGINALLY    3IO05930
       STA     CA51                IN LIST LOCATOR                      3IO05940
       RNT     SWATT               RESET ALL CONTROL BITS EXCEPT        3IO05950
       RIL     RESER               SWATT AND IF ATTACHING               3IO05960
       RIS     NTRES               RESERVE BIT                          3IO05970
       ENB     L(0)                TRAP PROTECT                         3IO05980
CA51   CAL     **                  WHILE ADJUSTING                      3IO05990
       PAC     0,2                 COUNTS                               3IO06000
       STA     CA24                L(FILE) TO IR2 AND CA24              3IO06010
       STA     FCW                 IN FCW CELL                          3IO06020
       ANA     6PRE                CHECK IF SIX OR                      3IO06030
       OAI                         SVN WORD APPEARS                     3IO06040
       CLA*    CA51                PICKUP LIST ENTRY                    3IO06050
       LNT     600000              SIX OR SVN                           3IO06060
       TRA     *+2                 IF SO EXIT                           3IO06070
       TRA     2,4                 AT 2,4                               3IO06080
       RFT     SWATT               IF ATTACHING                         3IO06090
       STD     2,2                 SAVE L(NON-STANDARD LABEL PKG.)      3IO06100
       CLA     1,2                 PLACE FILE CONTROL BITS              3IO06110
       RIL     700000              RESET SIX OR SVN CODE IN SI PREFIX   3IO06120
       ANA     PDMSK               IN SENSE INDICATORS                  3IO06130
       OAI                         AND EXIT AT                          3IO06140
       TRA     1,4                 1,4                                  3IO06150
*                      OPEN ERROR MESSAGE SENDER                        3IO06160
CA60   TSX     DRANO,4             UNIT NO. TO MESSAGE                  3IO06170
       TSX     PROUT,4             PRINT ERROR MESSAGE                  3IO06180
       PZE     3                   DETACHED FILE                        3IO06190
       MZE     MESS1,,2            AND STOP.                            3IO06200
       MZE     9,2,3               IF OPERATOR                          3IO06210
       PZE     MESS7,,6            PROCEEDS THEN FILE IS                3IO06220
       TSX     PAWS,4              NOT OPENED                           3IO06230
       TRA     OP1+1                                                    3IO06240
       TTL                         DE-ACTIVATE FILE                     3IO06250
*                           CALLING SEQUENCE                            3IO06260
*              TSX  SHUT,4         IR2 MUST= -L(FCW)                    3IO06270
*              **      **                                               3IO06280
*              RETURNS AT CA24+1                                        3IO06290
       SPACE   1                                                        3IO06300
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO06310
       LNT     RESOP               IF CLOSING AN OPEN                   3IO06320
       TRA     *+4                 RESERVE FILE                         3IO06330
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   3IO06340
       ACL     L(1)                ALLOWING ANOTHER FILE                3IO06350
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      3IO06360
       CLA     3,2                 HANDLE INTERNAL                      3IO06370
SH1    TRA     *+1                 FILE SEPARATELY   TMI  INTCL         3IO06380
       LNT     OUTPUT              IF CHECKPOINT FILE OR                3IO06390
       LNT     OPEND               IF FILE NEVER                        3IO06400
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $3IO06410
       LFT     OUTPUT              INPUT OR                             3IO06420
       TRA     SH5                 OUTPUT FILE                          3IO06430
       SPACE   1                                                        3IO06440
*                           CLOSE INPUT FILE                            3IO06450
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3IO06460
       CAL     0,2                 MAKE SURE EOF                       $3IO06470
       ANA     FOR                 FLAG IS OFF                         $3IO06480
       STP     0,2                                                     $3IO06490
       BES     *-3+NOCH/NOCH*3-*                                        3IO06500
SH2    CLA     5,2                 CHECK FOR HYPER                     $3IO06510
       ANA     SIX                                                     $3IO06520
       TNZ     SH4                                                     $3IO06530
       RNT     REWNUN                                                  $3IO06540
       TRA     SH6                 RETURN                              $3IO06550
       RIR     REWNUN              TAKE OUT HYPER OPTION               $3IO06560
       TRA     SH6                 RETURN                              $3IO06570
SH4    RNT     5                                                        3IO06580
       TRA     *+3                                                      3IO06590
       RNT     2                                                        3IO06600
       TRA     *+5                                                      3IO06610
       RNT     NOEOFM              TEST FOR FILE PROTECT                3IO06620
       TRA     *+3                 NO                                  $3IO06630
       TSX     (NDSLX,4            YES                                 $3IO06640
       PZE     0,2,HFPNP           FILE PROTECT                        $3IO06650
       RNT     REWNUN              TEST FOR UNLOAD                     $3IO06660
       TRA     SH6                 NO                                  $3IO06670
       TSX     (NDSLX,4            YES                                 $3IO06680
       PZE     0,2,HUNLP           UNLOAD                              $3IO06690
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $3IO06700
       TRA     SH4.1-2             EXIT                                $3IO06710
       BES     SH2+NOHYP/NOHYP**-NOHYP/NOHYP*SH2-*                      3IO06720
SH6    RNT     NOREW               IF NO REWIND FINISH UP              $3IO06730
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $3IO06740
       RFT     NOREW               IF NO REWIND                         3IO06750
       TRA     SH4.1               SPECIFIED SKIP OUT                   3IO06760
       CAL     3DEC                FORM REW CODE (=3)                   3IO06770
       RNT     NORUN               OR REW UNLOAD                        3IO06780
       ACL     1DEC                CODE (=4)                            3IO06790
       STD     *+2                                                      3IO06800
       TSX     NDSEL+1,4           ISSUE REW                            3IO06810
       PZE     0,2,**              OR RUN                               3IO06820
       RFT     REWNUN              IF REWOUND AND                      $3IO06830
       TRA     SH4.1               UNLOADED                             3IO06840
       SIL     DETACH              PRINT MESSAGE                        3IO06850
       TSX     UNMNT,4             TO OPERATOR                          3IO06860
SH4.1  LFT     RESER               RESET FILE                           3IO06870
       ZET     7GRP                BITS UNLESS SINGLE CLOSE             3IO06880
       RIL     SEVER               OF A RESERVE FILE                    3IO06890
       RIL     OPEND               RESET OPENED BIT                     3IO06900
       TRA     CA24+1              EXIT                                 3IO06910
       SPACE   1                                                        3IO06920
*                          CLOSE OUTPUT FILE                            3IO06930
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            3IO06940
       RNT     000005              CHECK FOR HYPER OPTIONS             $3IO06950
       TRA     *+3                 NOT MON OPTION                      $3IO06960
       RNT     NORUN               IF TRUE MON OPTION                  $3IO06970
       TRA     SH3                 SKIP EOF AND LABEL WRITES            3IO06980
       TSX     NDSEL+1,4           WRITE                                3IO06990
       PZE     0,2,WEFOP           EOF                                  3IO07000
       NOP                         IGNORE EOT                           3IO07010
SH9    LFT     LABEL               IF LABELED,WRITE TRAILER             3IO07020
       BSS     1                   TSX  LABCO,1                         3IO07030
SH3    LAC     LBC,4               L(POOL) TO IR4                       3IO07040
       SXD     SH33,2              REMOVE FILE FROM                     3IO07050
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              3IO07060
       PAX     0,1                 FILE THAT REFERENCES CLOSING         3IO07070
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           3IO07080
       TXL     SH34,1,0            FOUND.                               3IO07090
       PAC     0,4                 NOT FOUND. ADVANCE                   3IO07100
       TRA     SH32                ALONG CHAIN.                         3IO07110
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           3IO07120
       STA     1,4                 REFERENCED CLOSING FILE              3IO07130
       RNT     000005              IS THIS CLOSE                       $3IO07140
       TRA     *+3                 A TRUE MON OPTION                   $3IO07150
       RNT     NORUN                                                   $3IO07160
       TRA     SH4.1               YES,POST AND RETURN                 $3IO07170
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $3IO07180
       TTL                         OPEN ROUTINE                         3IO07190
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              3IO07200
       SPACE   1                                                        3IO07210
*                           CALLING SEQUENCE                            3IO07220
*              TSX OPEN,4                                               3IO07230
*               P  FILE,,1                                              3IO07240
*      WHERE                                                            3IO07250
*              P= PZE REWIND BEFORE OPEN                                3IO07260
*              P= MZE NO REWIND                                         3IO07270
*              P= MON NO REWIND, NO LABELS                              3IO07280
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  3IO07290
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           3IO07300
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE 3IO07310
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     3IO07320
*      ACTIONS ....                                                     3IO07330
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      3IO07340
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             3IO07350
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                3IO07360
       SPACE   1                                                        3IO07370
OPEN.  LNT     OPEND               IF FILE ALREADY OPN                  3IO07380
       TRA     OP2                 CLEAR INHIBITED INDICATOR            3IO07390
OP1    SIL     OPNEOT              SET OPEN AND NO EOT CODE             3IO07400
       RFT     SWATT               IF ATTACHING                         3IO07410
       TRA     CA24+1              RETURN THERE                         3IO07420
       TRA     COMXIT              ELSE EXIT TO USER                    3IO07430
OPAT   LNT     RESER               RESERVE FILES ARE                    3IO07440
       TXI     OP2,4,-2            NOT OPENED AT ATTACHMENT             3IO07450
       SIL     NETIH               SET NO EOT CODE+ NOT INHIBITED       3IO07460
       TRA     CA24+1                                                   3IO07470
OP2    SIL     NETIH               SET NO EOT + NOT INHIB               3IO07480
       LFT     DETACH              IF FILE HAS BEEN REWOUND-UNLOADED    3IO07490
       TRA     CA60                PRINT ERROR MESSAGE                  3IO07500
       LNT     RESER               IF FILE IS RESERVE TYPE              3IO07510
       TRA     OP4+1               CHECK TO MAKE                        3IO07520
       CLA*    3,2                 SURE THAT NO MORE                    3IO07530
       PAX     0,1                 THAN THE SPECIFIED                   3IO07540
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  3IO07550
       TXH     OP10,1,4096         SIMULTANEOUSLY OPENED                3IO07560
       PXA     0,1                                                      3IO07570
       STA*    3,2                                                      3IO07580
       CLA     3,2                 HANDLE INTERNAL FILE                 3IO07590
OP4    TRA     *+1                 SEPARATELY    TMI  INTOP             3IO07600
       SXA     2TAG+2,4            SAVE IR 4                            3IO07610
       LDQ     0,2                 CHECK                                3IO07620
       RQL     18                  REEL IS MOUNTED                      3IO07630
       TQP     OP11                IF NOT INFORM OPERATOR               3IO07640
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $3IO07650
       STA     4,2                 = L(0)                               3IO07660
       TSX     (NDATA,4            TEST LEGALITY                       $3IO07670
2TAG   PZE     0,2,TESTP           OF UNIT                              3IO07680
       TSX     DENSE,4             SET FILE DENSITY                     3IO07690
       AXT     **,4                                                     3IO07700
       CLA     -1,4                                                     3IO07710
       TPL     *+4                 IF PZE- REW                          3IO07720
       ANA     1PRE                MZE- NO REW                          3IO07730
       TNZ     OP9.3               MON-NO REW, NO LABELS                3IO07740
       TRA     OP6                                                      3IO07750
       TSX     NDSEL+1,4           REWIND BEFORE                        3IO07760
       PZE     0,2,REWOP           OPEN                                 3IO07770
OP6    TSX     OP7.1,1             CHECK FOR HYPER DETAILS              3IO07780
       BES     *-1+NOHYP/NOHYP*1-*                                      3IO07790
       CAL     SIX                 CLEAR ERROR INFO.                   $3IO07800
       ANS     5,2                 HISTORY AND                         $3IO07810
       STD     3,2                 BLOCK SEQUENCE                      $3IO07820
       LFT     OUTPUT                                                  $3IO07830
       TRA     OP9                 IS DONE EXCEPT LABELS                3IO07840
       SPACE   1                                                        3IO07850
*                           OPEN INPUT FILE                             3IO07860
       TSX     FNLBC,4             FIND L(POOL)                         3IO07870
       LFT     LABEL               LABEL ACTION                         3IO07880
OP7    BSS     1                   TSX   LABCI,1                        3IO07890
       PXD     0,0                 CLEAR BUFFER COUNT                   3IO07900
       STA     1,2                 IN FCB.                              3IO07910
       TSX     BORBF,1             INITIATE READ                        3IO07920
LBC    NOP                         IF POSSIBLE ... L(POOL)...           3IO07930
       TRA     OP1                 EXIT                                 3IO07940
       SPACE   1                                                        3IO07950
*                           OPEN OUTPUT FILE                            3IO07960
OP9    LNT     OUTPUT              LOOK FOR CHECKPOINT                  3IO07970
       TRA     OP9.1               FILE DEFINITION                      3IO07980
       CAL     FCW                 BY OPENING                           3IO07990
       STA     CPFILE              OUTPUT FILE                          3IO08000
       TRA     OP1                 CODE= PTO+TTO                        3IO08010
OP9.1  LFT     LABEL               ACTION                               3IO08020
OP9.2  BSS     1                   TSX   LABOO,1                        3IO08030
       TSX     FNLBC,4             FIND L(POOL)                         3IO08040
       LAC     LBC,4               L(POOL) TO IR4                       3IO08050
       CLA     1,4                 PLACE OUTPUT                         3IO08060
       STA     1,2                 FILE IN SYNCING                      3IO08070
       CLA     FCW                 CHAIN USED TO                        3IO08080
       STA     1,4                 RELEASED TO THE                      3IO08090
       TRA     OP1                 BUFFER POOL                          3IO08100
*                   BYPASS REWIND AND LABEL ACTION.                     3IO08110
OP9.3  TSX     OP7.1,1             CHECK FOR HYPER DETAILS              3IO08120
       BES     *-1+NOHYP/NOHYP*1-*                                      3IO08130
       LNT     OUTPUT              TEST FOR CHECKPOINT                 $3IO08140
       TRA     *+2                 NO.                                  3IO08150
       TRA     OP9+2               ASSIGN CHECKPOINT.                   3IO08160
       LFT     OUTPUT              INPUT OR                             3IO08170
       TRA     OP9.2+1             OUTPUT. ENTER IN CHAIN.              3IO08180
       TSX     FNLBC,4             INPUT. FIND L(POOL)                  3IO08190
       TRA     OP7+1               INITIATE READ.                       3IO08200
       SPACE   1                                                        3IO08210
*                     ERROR TOO MANY RESERVES OPEN                      3IO08220
OP10   TSX     PROUT,4             PRINT RESERVE FILE                   3IO08230
       PZE     2                   CONFLICT ERROR                       3IO08240
3DEC   MZE     9,2,3               AND STOP.... IF STARTED              3IO08250
       PZE     MESS6,,7            NO OPEN OCCURS                       3IO08260
       TSX     PAWS,4                                                   3IO08270
       TRA     OP1+1                                                    3IO08280
       SPACE   1                                                        3IO08290
*          FILE IS NOT MOUNTED SEND INSTRUCTIONS TO OPERATOR            3IO08300
OP11   CLA     5,2                 IF DISK,JUST                        $3IO08310
       TMI     MNTFLG              PUT MOUNT FLAG ON                 (4)3IO08313
       AXT     4,1                 CHANGE MSGE COUNT                 (4)3IO08317
       SXD     MNT2+5,1            FOR FILE SERIAL NOTICE            (4)3IO08320
       CAL     6,2                 ON LINE                           (4)3IO08323
       SLW     MES23+4             FOR DEFERRED OPEN                 (4)3IO08327
       CAL     7,2                 REEL NUMBER TO MOUNT                $3IO08330
       TSX     MOUNT,4                                                  3IO08340
       AXT     2,1                 RESTORE MSGE COUNT                (4)3IO08343
       SXD     MNT2+5,1            FOR ANY REEL SWITCH               (4)3IO08347
       TSX     PAUSE,4             WAIT FOR OPERATOR                    3IO08350
MNTFLG CLA     *-1                 PUT MOUNT FLAG ON                 (4)3IO08360
       STT     0,2                                                     $3IO08370
       TRA     OP4.5               PROCEED IN OPEN                     $3IO08380
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $3IO08390
OP7.1  CLA     5,2                 IS THIS HYPERTAPE                    3IO08400
       ANA     SIX                                                     $3IO08410
       TZE     OP7.3               NO                                  $3IO08420
       RIR     MXDMD               RESET BACKWARD READ                  3IO08430
       PIA                                                             $3IO08440
       STT     1,2                                                     $3IO08450
       LFT     OUTPUT              IF OUTPUT                           $3IO08460
       TRA     1,1                 ALL DONE                            $3IO08470
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $3IO08480
       TXL     OP7.2,4,0           NO                                  $3IO08490
       ORA     *-1                 SET READ                            $3IO08500
       STT     1,2                 BACKWARD                            $3IO08510
       AXC     2,4                                                     $3IO08520
       CLA*    0,2                                                     $3IO08530
       ANA     ADDRS               IF NEXT READ IS NOT A               $3IO08540
       TNZ     OP7.2               FILE MARK THEN PROCEED              $3IO08550
       TSX     (NDSLX,4            ELSE BACKSPACE FILE                 $3IO08560
       PZE     0,2,HBSFP                                               $3IO08570
OP7.2  LXA     2TAG+2,4                                                $3IO08580
       CLA     -1,4                TEST FOR THE                        $3IO08590
       ANA     SIX                 SETTING OF FILE PROTECT             $3IO08600
       TZE     *+3                 NO                                  $3IO08610
       TSX     (NDSLX,4                                                $3IO08620
       PZE     0,2,HFPNP           FILE PROTECT                        $3IO08630
       TRA     1,1                                                     $3IO08640
       BES     OP7.1+NOHYP/NOHYP**-NOHYP/NOHYP*OP7.1-*                 $3IO08650
OP7.3  LFT     OUTPUT                                                  $3IO08660
       TRA     1,1                                                     $3IO08670
       LXD     XEOB,4              IF READ                             $3IO08680
       TXL     OP7.3+1,4,0         BACKWARD                            $3IO08690
       TSX     NDSEL+1,4           REWIND 729                          $3IO08700
       PZE     0,2,REWOP           OR DISK INPUT                       $3IO08710
       TRA     1,1                                                     $3IO08720
       TTL     RELEASE BUFFER AND  READ WITH RETENTION                  3IO08730
RELASE ENB     L(0)                                                    $3IO08740
       LDC     XEOB,2              -L(FILE) IN IR2                     $3IO08750
       TSX     FNLBC,4             FIND THE BUFFER POOL                $3IO08760
       CAL     FCW                 GET BUFFER CONTROL                  $3IO08770
       SUB     L(2)                ADDRESS AND                         $3IO08780
       STA     *+1                 MAKE SURE IT IS                     $3IO08790
RELASD LDI     **                  ABLE TO BE RELEASED                 $3IO08800
       LNT     100000                                                  $3IO08810
       TRA     COMXIT+3                                                $3IO08820
       LDI     1,2                 FILE BITS TO INDICATORS             $3IO08830
       TSX     BCKBB,1             RESTORE BUF COUNT                   $3IO08840
       CAL     RELASD                                                  $3IO08850
       TSX     BTP2,1              PUT BUF IN POOL                     $3IO08860
       XCA                                                             $3IO08870
       ERA     2,2                 IF BUFFER RELEASED IS THE SAME      $3IO08880
       ANA     ADDRS               AS THE BUFFER IN USE PUT            $3IO08890
       TNZ     *+3                 THE BUFFER POOL ADDRESS IN          $3IO08900
       CLA     LBC                 THE THIRD WORD OF THE FCB           $3IO08910
       STA     2,2                                                     $3IO08920
       TRA     COMXIT+3            EXIT                                $3IO08930
READR1 STL     *+2                 SET READ/RETENTION SW               $3IO08940
       TRA     READ.                                                   $3IO08950
       BES     RELASE+NOCH/NOCH**-NOCH/NOCH*RELASE-*                   $3IO08960
READR2 PZE                                                              3IO08970
       TTL                         BUFFERED READ ROUTINE                3IO08980
*              TSX  READ,4              BUFFERED READ                   3IO08990
*              PZE  FILE,,EOB           END OF BLOCK                    3IO09000
*              PZE  EOF,,ERR              END OF FILE AND               3IO09010
*                   *                     ERROR EXITS                   3IO09020
*                   *                                                   3IO09030
*                  IO-LIST                                              3IO09040
*                   *                                                   3IO09050
*              RETURN                                                   3IO09060
       SPACE   1                                                        3IO09070
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3IO09080
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3IO09090
*                              IS GIVEN.                                3IO09100
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   3IO09110
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3IO09120
*                            BUFFER AREA ATTACHED TO THE FILE           3IO09130
       SPACE   1                                                        3IO09140
READ.  SIR     RDSWIT              SET READ SWITCH                     $3IO09150
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    3IO09160
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             3IO09170
       CLA     -1,4                SAVE MODAL EXITS                     3IO09180
       STA     XEOF                END OF FILE                          3IO09190
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     3IO09200
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     3IO09210
       TRA     EOFER               TAKE END OF FILE EXIT                3IO09220
       LFT     OUTPUT              IF OUTPUT FILE                       3IO09230
       TRA     NOPXIT              DO NOTHING, JUST EXIT.               3IO09240
       TSX     FNLBC,4             FIND L(POOL)                         3IO09250
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      3IO09260
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             3IO09270
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       3IO09280
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 3IO09290
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     3IO09300
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     3IO09310
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           3IO09320
       PZE     TRM1                3.TRANSMIT FROM                      3IO09330
       PZE     TRM2                BUFFER TO WORKING STORAGE            3IO09340
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   3IO09350
       TTL                         BUFFERED WRITE ROUTINE               3IO09360
*              TSX WRITE,4              BUFFERED WRITE                  3IO09370
*              PZE  FILE,,EOB            END OF BLOCK EXIT              3IO09380
*                    *                                                  3IO09390
*                    *                                                  3IO09400
*                  IO-LIST                                              3IO09410
*                   *                                                   3IO09420
*              RETURN                                                   3IO09430
       SPACE   1                                                        3IO09440
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3IO09450
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3IO09460
*                              IS GIVEN.                                3IO09470
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  3IO09480
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3IO09490
*                            BUFFER AREA ATTACHED TO THE FILE           3IO09500
       SPACE   1                                                        3IO09510
WRITE. LNT     OUTPUT              CAN'T WRITE ON CKPT FILE             3IO09520
       LNT     OPEND               IF FILE NOT OPEN                     3IO09530
       TRA     NOPXIT              DO NOTHING JUST EXIT                 3IO09540
       LFT     OUTPUT              IF OUTPUT FILE                       3IO09550
       TRA     *+2                 ALL IS WELL.                         3IO09560
       TRA     NOPXIT              INPUT, DO NOTHING, JUST EXIT         3IO09570
       TSX     FNLBC,4             FIND L(POOL)                         3IO09580
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    3IO09590
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    3IO09600
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   3IO09610
       PZE     TRM2                3.TRANSMIT FROM                      3IO09620
       PZE     TRM1                WORKING STORAGE TO BUFFER            3IO09630
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  3IO09640
       EJECT                                                            3IO09650
*                  FIND L(BPC) FROM FILE CONTROL WORD                   3IO09660
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            3IO09670
FNLBC  CLA     4,2                                                      3IO09680
       PDX     0,1                                                      3IO09690
       SXA     LBC,1                                                    3IO09700
       TRA     1,4                                                      3IO09710
       SPACE   1                                                        3IO09720
*     ADJUST INPUT BUFFER AVAILABILITY COUNT ( ATTACH AND CLOSE )       3IO09730
*              TSX  ADIBC,1                                             3IO09740
ADIBC  RFT     SWATT               ADJUST IBACT BY                      3IO09750
       SSP                                                             $3IO09760
L(0)A  ENB     L(0)                TRAP PROTECT                         3IO09770
       ADD*    LBC                 +1 CLOSE INPUT,PTO,LAST TTO          3IO09780
       TPL     AD1                 -1 ATTACH INPUT, PTO, 1ST TTO        3IO09790
       STD*    LBC                 +RESCT CLOSE RESERVE GROUP           3IO09800
       ENB     TRAPS                                                    3IO09810
       TRA     1,1                 -RESCT ATTACH RESERVE GROUP          3IO09820
*                         ERROR IBACT NEGATIVE                          3IO09830
AD1    CAL     AD2                 PICK UP MESSAGE PARAM                3IO09840
       TRA     TSXR                AND GO ADD L(TSX) ,PRINT AND STOP    3IO09850
AD2    MZE     MESS8,,3            '' ATTACH ERROR AT ***** ''          3IO09860
*            ROUTINE TO PREPARE REDUNDANCY ERROR COUNTS ON              3IO09870
*                       PRINTER FOR THE OPERATOR                        3IO09880
       SPACE   1                                                        3IO09890
REDCT  SXA     RCT1,4              SAVE IR4                             3IO09900
       CAL     5,2                 IF ASSIGNED SENSE                   $3IO09910
       ALS     4                   IS UP AND ERROR HISTORY             $3IO09920
       TZE     RCT0                PRINT OR ELSE PRINT IT              $3IO09930
       TSX     DRANO,4             DRIVE ADDRESS TO MESSAGE             3IO09940
       LDQ     7,2                 REEL SEQ                             3IO09950
       STQ     MES10+1             TO MESSAGE                           3IO09960
       CLA     3,2                 RECORD                               3IO09970
       TSX     (DECVD,4            COUNT                                3IO09980
       STQ     MES10+3                                                  3IO09990
       CLA     5,2                 REDUN                                3IO10000
       TSX     (DECVA,4            COUNT                               $3IO10010
       STQ     MES12                                                    3IO10020
       LDQ     BLNKS                                                   $3IO10030
       LFT     OUTPUT                                                  $3IO10040
       TRA     *+3                                                     $3IO10050
       CLA     5,2                 PERM. OR                             3IO10060
       TSX     (DECVD,4            ERASE COUNT                         $3IO10070
       STQ     MES12+3                                                  3IO10080
       CLA     MES13               PLACE ''ERASE'' FOR OUTPUT           3IO10090
       LFT     OUTPUT              OR ''PERM.'' FOR INPUT               3IO10100
       CLA     MES14               IN MESSAGE                           3IO10110
       STO     MES12+1                                                 $3IO10120
       CLA     MES26                                                   *3IO10130
       LDQ     5,2                 TEST FOR DISK                       *3IO10140
       TQP     *+2                 NO,TAPE                             *3IO10150
       CLA     MES25               YES,CHANGE PRINT OUT                *3IO10160
       STO     *+5                                                     *3IO10170
       BES     *-5+NOCH/NOCH*5-*                                        3IO10180
       TSX     PROUT,4             PRINT                                3IO10190
       PZE     4                                                        3IO10200
       MZE     MESS1,,2                                                 3IO10210
       MZE     9,2,3                                                    3IO10220
       PZE     MES10,,6                                                 3IO10230
       PZE     MES11,,9+512*DBLSP                                       3IO10240
RCT0   CAL     SIX                 SET BLOCK SEQUENCE                  $3IO10250
       ANS     5,2                 ERROR INFORMATION                   $3IO10260
       STD     3,2                 AND BLOCK COUNT 'IS ZERO            $3IO10270
RCT1   AXT     **,4                RESTORE IR4                          3IO10280
       TRA     1,4                 EXIT                                 3IO10290
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         3IO10300
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          3IO10310
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    3IO10320
       SPACE   1                                                        3IO10330
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            3IO10340
*                          IR4 MUST= -L(POOL)                           3IO10350
       SPACE   1                                                        3IO10360
TOKBB  ENB     L(0)                TRAP PROTECT                         3IO10370
TOKBF  SXA     TK3,4               SAVE IR4                             3IO10380
       LNT     RESER               IF A RESERVE FILE                    3IO10390
       TRA     TK1                 THEN REDUCE THE RESERVE BUFFER       3IO10400
       CLA*    3,2                 COUNT AND IF IT                      3IO10410
       PDX     0,1                 GOES NEGATIVE THEN                   3IO10420
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  3IO10430
       TXL     TK2,1,4096                                               3IO10440
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               3IO10450
       PDX     0,4                 IMMEDIATE FILES                      3IO10460
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              3IO10470
       SUB     1DEC                                                     3IO10480
       STD*    LBC                                                      3IO10490
TK2    PXD     0,1                 RESTORE RESERVE                      3IO10500
       LFT     RESER               BUFFER COUNT IF A RESERVE            3IO10510
       STD*    3,2                 FILE                                 3IO10520
TK3    AXT     **,4                RESTORE IR4                          3IO10530
       TRA     2,4                 EXIT                                 3IO10540
TK4    LXA     TK3,4               TAKE ERROR EXIT                      3IO10550
       TRA     1,4                                                      3IO10560
       SPACE   1                                                        3IO10570
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            3IO10580
       SPACE   1                                                        3IO10590
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      3IO10600
BCKBF  LNT     RESER               IF A ARESERVE                        3IO10610
       TRA     BK1                 FILE THEN INCREMENT                  3IO10620
       SXA     BK2,1               SAVE IR1                             3IO10630
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       3IO10640
       PDX     0,1                                                      3IO10650
       ACL     1DEC                                                     3IO10660
       STD*    3,2                                                      3IO10670
       TXL     BK3,1,4096          IF IT WAS NEGATIVE INCREMENT         3IO10680
BK2    AXT     **,1                RESTORE IR1                          3IO10690
BK1    CAL     0,4                 POOL CT ALSO                         3IO10700
       ADD     1DEC                                                     3IO10710
       STD     0,4                                                      3IO10720
       TRA     1,1                 EXIT                                 3IO10730
BK3    LXA     BK2,1               RESTORE IR1                          3IO10740
       TRA     1,1                 AND TAKE EXIT                        3IO10750
       TTL             MOUNT AND DISMOUNT INSTRUCTIONS TO OPERATOR      3IO10760
*                                                                       3IO10770
*        PRINT REEL DISMOUNTING INSTRUCTIONS TO OPERATOR                3IO10780
*      TSX     UNMNT,4                                                  3IO10790
*      RETURN                                                           3IO10800
*                                                                       3IO10810
UNMNT  SXA     UNM1,4              SAVE IR4                             3IO10820
       TSX     DRANO,4             ABS UNIT TO MESSAGE                  3IO10830
       CAL     =H DONE             IF REEL NO IS ZERO               (11)3IO10831
       ZET     7,2                 MOVE 'DONE' ELSE MOVE            (11)3IO10832
       CAL     7,2                 REEL NUMBER                          3IO10840
       SLW     MES23+2             TO MESSAGE                           3IO10850
       TSX     PROUT,4             PRINT                                3IO10860
L(3)   PZE     3                   --UNIT *****                        $3IO10870
       MZE     MESS1,,2            FILE-NAME                            3IO10880
       MZE     9,2,3               REMOVE REEL ***** ''                 3IO10890
       PZE     MES23,,3+512*DBLSP                                       3IO10900
UNM1   AXT     **,4                                                     3IO10910
       TRA     1,4                 EXIT                                 3IO10920
       SPACE   1                                                        3IO10930
*          PRINT INSTRUCTIONS TO OPERATOR TO MOUNT A NEW REEL           3IO10940
*                  THE REEL NUMBER MUST BE IN THE AC                    3IO10950
*      TSX     MOUNT,4                                                  3IO10960
*      RETURN                                                           3IO10970
*                                                                       3IO10980
MOUNT  SXA     MNT3,4              SAVE IR4                             3IO10990
       SLW     MES23+2             SAVE REEL NUMBER IN MESSAGE          3IO11000
       TSX     DRANO,4             UNIT NUMBER TO MESSAGE               3IO11010
       CLA     MNT4                IF INPUT FILE                        3IO11020
       LFT     OUTPUT              ''MOUNT REEL *****''                 3IO11030
       TRA     *+2                 IF NON-LABELED OUTPUT                3IO11040
       TRA     MNT1                ''MOUNT BLANK''                      3IO11050
       CLA     MNT5                IF LABELED OUTPUT                    3IO11060
       LFT     LABEL               '' MOUNT LABELED BLANK''             3IO11070
MNT1A  BSS     1                   CLA MNT6                             3IO11080
MNT1   STO     *+5                 EXTRA MESSAGE TO LIST                3IO11090
MNT2   TSX     PROUT,4             PRINT INSTRUCTIONS TO OPERATOR       3IO11100
       PTW     4                                                     $5$3IO11110
       MZE     MESS1,,2                                                 3IO11120
       MZE     9,2,3                                                    3IO11130
       MZE     **                                                       3IO11140
       PZE     MES23+1,,2                                               3IO11150
       CLA     MNT2                SET INDICATOR THAT UNIT IS           3IO11160
       STT     0,2                 MOUNTED                              3IO11170
MNT3   AXT     **,4                                                     3IO11180
       TRA     1,4                                                      3IO11190
MNT4   MZE     MES24,,1                                                 3IO11200
MNT5   MZE     MES24,,2                                                 3IO11210
L(4)   PZE     4                                                     $5$3IO11211
       TTL     FIND TAPE ADDRESS AND PLACE IN MESSAGEWUNIT*****W        3IO11220
*         TSX  DRANO,4             EXECUTES ENB L(0),NO ENB TRAPS       3IO11230
       SPACE   1                                                        3IO11240
DRANO  SXA     *+6,4               CLEAR IR4 FOR * ADDRESSING           3IO11250
       AXT     0,4                                                      3IO11260
       LDQ*    0,2                                                      3IO11270
       ENB     L(0)                TRAP PROTECT SYUNCV ROUTINE          3IO11280
       TSX     SYUNCV,4            CONVERT UNIT TO SYMBOLIC             3IO11290
       SLW     MESS1+1                                                  3IO11300
       AXT     **,4                                                     3IO11310
       TRA     1,4                                                      3IO11320
       SPACE   1                                                        3IO11330
*                      FOLDED CHECKSUM CALCULATOR                       3IO11340
*                   CHECKSUMS LOCATOR SPECIFICATION                     3IO11350
*                         FOR FILE AND LEAVES                           3IO11360
*                  FOLDED 18 BIT CHECKSUM IN MQ S-17                    3IO11370
       SPACE   1                                                        3IO11380
*                           CALLING SEQUENCE                            3IO11390
       SPACE   1                                                        3IO11400
*              TSX SUMMIT,1   IR2 MUST = -L(FILE)                       3IO11410
       SPACE   1                                                        3IO11420
SUMMIT CLA*    TR5                 SETUP NUMBER                         3IO11430
       SXA     SUM3,1              SAVE IR1                             3IO11440
       PDX     0,1                 WDS TO                               3IO11450
       PXA     0,0                 CHECKSUM                             3IO11460
       TRA     *+2                 DONT CHECKSUM BLOCK SEQ WORD         3IO11470
SUM1   ACL     **,1                CHECKSUM                             3IO11480
2PRE   TIX     *-1,1,1             BUFFER                               3IO11490
       XCL                         FOLD                                 3IO11500
       STZ     TEMP                CHECKSUM TO 18 BITS                  3IO11510
       SLQ     TEMP                UPPER BITS S-17                      3IO11520
       XCL                         ADDED TO LOWER BITS 18-35            3IO11530
       ALS     18                  THEN OVERFLOW ADDED                  3IO11540
       ACL     TEMP                TO SUM                               3IO11550
       LBT                         FOLDED 18-BIT                        3IO11560
       TRA     SUM2                CHECKSUM                             3IO11570
       ACL     1DEC                LEFT IN MQ                           3IO11580
SUM2   XCL                         CHECKSUM IN MQ S-17                  3IO11590
SUM3   AXT     **,1                                                     3IO11600
       TTR     1,1                                                      3IO11610
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    3IO11620
*                    HANDLES EOB,EOF,AND URR EXITS                      3IO11630
       SPACE   1                                                        3IO11640
EOFER  CLA     0,4                 END OF FILE                          3IO11650
       ANA     1PRE                EXIT INPUT FILE                      3IO11660
       RIL     100000              NOT OPEN                             3IO11670
       OAI                         PLACE 1ST COMMAND IN SI              3IO11680
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   3IO11690
       SXA     GTIOX,4             COMMAND                              3IO11700
       TRA     EOF.0               TAKE EOF EXIT                        3IO11710
EOFEX  LFT     LABEL               END OF FILE                          3IO11720
       BSS     1                   TSX   LAEOF,1                        3IO11730
       LFT     MULTI               MULTI-REEL                           3IO11740
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            3IO11750
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   3IO11760
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         3IO11770
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     3IO11780
EOF.1  SXA     TCHEX,4                                                  3IO11790
       TXL     GET4,4,0            ERROR AND ERROR EXIT = 0         (10)3IO11800
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             3IO11810
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     3IO11820
       LDQ     LTSX                LOAD EXIT HISTORY                    3IO11830
       RQL     18                                                      $3IO11840
       TRA     COMXIT              EXIT                                 3IO11850
SEQEX  CAL     1PRE                LOAD SEQUENCE ERROR CODE             3IO11860
       TRA     BLKEX               TAKE BLOCK ERROR EXIT                3IO11870
CKSEX  CLA     SY7.1               STORE UPDATED                        3IO11880
       STD     3,2                 BLOCK SEQ NUMBER                     3IO11890
       CAL     2PRE                LOAD CHECKSUM ERROR CODE             3IO11900
BLKEX  RNT     NORED               IF REDUNDANCY ERROR                  3IO11910
       ACL     FOR                 ALSO OCCURRED ADD REDUN BIT          3IO11920
       TRA     ERREX               TAKE ERROR EXIT                      3IO11930
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         3IO11940
ERREX  ARS     18                  CODE IN                             $3IO11950
       STT     LTSX                TAG OF HISTORY                      $3IO11960
       CLA*    2,2                 MAKE HISTORY                        $3IO11970
       STA     LTRAD               REFLECT THIS OP.                    $3IO11980
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                3IO11990
       LDC     XERR,4              ERROR EXITS                          3IO12000
       TRA     EOF.1                                                    3IO12010
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        3IO12020
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          3IO12030
       TRA     EOF.1                                                    3IO12040
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  3IO12050
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        3IO12060
       SXD     LTRAD,4             INTO HISTORY                         3IO12070
       ZET     TCHEX               HAS A TCH OCCURRED                   3IO12080
       TRA     TCHOC               YES-                                 3IO12090
       LFT     100000              NO-IS THIS OP AN IOXT                3IO12100
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            3IO12110
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          3IO12120
FEEIT  TXI     *+1,4,-1            NO-                                 $3IO12130
       CAL     -1,4                SEARCH                               3IO12140
       LGR     34                  FOR                                  3IO12150
       TZE     *+2                 EXIT                                 3IO12160
       TQP     *-4                                                      3IO12170
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  3IO12180
       TRA     *+2                                                      3IO12190
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  3IO12200
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $3IO12210
       TRA     1,1                 RETURN                               3IO12220
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       3IO12230
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  3IO12240
*                        MASTER CONTROL ROUTINE                         3IO12250
*                          FOR READ AND WRITE                           3IO12260
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   3IO12270
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         3IO12280
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            3IO12290
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              3IO12300
*              PRE TRM2 OR TRM1        TRANSMITTING                     3IO12310
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     3IO12320
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            3IO12330
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        3IO12340
*              XEC  N,4                                                 3IO12350
       SPACE   1                                                        3IO12360
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          3IO12370
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         3IO12380
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              3IO12390
       ANA     7PRE                SHOULD BE DISCONNECTED              $3IO12400
       TZE     GTIOX-1             NONE ATTACHED                        3IO12410
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   3IO12420
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO12430
*                         GET NEXT IO COMMAND                           3IO12440
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          3IO12450
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              3IO12460
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        3IO12470
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  3IO12480
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             3IO12490
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    3IO12500
       SPACE   1                                                        3IO12510
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           3IO12520
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         3IO12530
       TXI     *+1,1,-1            SETUP L(NEXT)                        3IO12540
       SXA     GTIOX,1             IOXY                                 3IO12550
       CAL     -1,1                THIS IO COMMAND TO AC                3IO12560
       STA     TRANS               SAVE TRANSMIT LOC                    3IO12570
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       3IO12580
       STD     WDCT                SAVE WORD COUNT                      3IO12590
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   3IO12600
       ANA     IOOP                AND NOT DISTURBING FILE              3IO12610
       OAI                         CONDITION OR HISTORY BITS           $3IO12620
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              3IO12630
       LFT     600000              SEPARATE TCH AND IOCD                3IO12640
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  3IO12650
       LFT     100000              IOCD OR TCH COMMAND                  3IO12660
       TRA     TCH                 TCH                                  3IO12670
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  3IO12680
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     3IO12690
       TRA     RW0                 NO                                   3IO12700
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   3IO12710
       CLA*    TRANS                                                    3IO12720
       STA     TRANS                                                    3IO12730
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   3IO12740
RW0    NZT     WDCT                IF WORD COUNT IS                     3IO12750
       LNT     400000              ZERO ON IOCY OR IOSY                 3IO12760
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           3IO12770
       TRA     RW8                                                      3IO12780
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD 3IO12790
       TPL     RW2                 BUFFER IS CONNECTED TO FILE          3IO12800
RW1.4  XEC     2,4                 GET NEXT BUFFER                      3IO12810
       CLA*    2,2                 PICKUP BUFFER CONTROL WORD           3IO12820
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                3IO12830
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        3IO12840
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        3IO12850
       TNZ     RW2.1               IF SOME WORDS ARE                    3IO12860
       PDX     0,1                 AVAILABLE AND COMMAND IS             3IO12870
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    3IO12880
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    3IO12890
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        3IO12900
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     3IO12910
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            3IO12920
*                       COUNT CONTROL EXECUTION                         3IO12930
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  3IO12940
       SIR     GENER               SET GENERATED DISCONNECT             3IO12950
       XEC     1,4                 DISCONNECT                           3IO12960
       RIR     GENER               RESET GENER BIT                      3IO12970
       TRA     RW1.4               AND GO ATTACH NEXT ONE               3IO12980
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              3IO12990
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   3IO13000
       TPL     RW5                 IS BUFFER OVERFLOWED                 3IO13010
       STD     DUMMY               YES- SAVE NUMBER OFF                 3IO13020
       LNT     200000              UNLESS COMMAND IS IOSY               3IO13030
       SIR     GENER               SET BIT FOR GENERATED COMMAND        3IO13040
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                3IO13050
RW4    STD     WDCT                ON THIS BUFFER                       3IO13060
       PXA     0,0                 SET ZERO REMAINING WORDS             3IO13070
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                3IO13080
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   3IO13090
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $3IO13100
       STD*    2,2                 TO ADJUST LOCATOR                    3IO13110
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   3IO13120
       RNT     200000              IF IOXYN **,,CT                      3IO13130
       TRA     RW6                 OR IOXYN* ADDR,,CT                   3IO13140
       CLA     TRANS               THEN PLACE L(WORDS)                  3IO13150
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $3IO13160
       STA     0,1                 RESPECTIVELY                         3IO13170
       SIR     XECNT               INDICATE IOXYN EXECUTED              3IO13180
RW6    LXD     WDCT,1              FORM FIRST                           3IO13190
       PXA     0,1                 TRANSMIT                             3IO13200
       ACL*    2,2                 ADDRESS                              3IO13210
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $3IO13220
       STA*    2,2                 ADJUST LOCATOR                       3IO13230
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           3IO13240
       PXA     0,1                 COMPUTE                              3IO13250
       ACL     TRANS               SECOND TRANSMIT ADDRESS              3IO13260
       STA*    4,4                 AND STORE IT                         3IO13270
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        3IO13280
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            3IO13290
       LXA     TRANS,1             TEST FIRST XMIT                      3IO13300
       TXL     *+2,1,0             ILLEGAL TO WRITE INSIDE IOCS        $3IO13310
       XEC     RW7                 FOR BOUNDS ERROR                     3IO13320
       LXA     TRM2,1              IF TRANSMIT INSIDE                   3IO13330
       TXL     *+2,1,0                                                 $3IO13340
RW7    TXL     BOUND,1,.JBCON+9                                         3IO13350
       RFT     200000              IF NON-TRANSMITTING                  3IO13360
       TRA     RW8                 SKIP OVER MOVES                      3IO13370
       LXD     WDCT,1              WDCT TO IR1                          3IO13380
TRM1   CAL     **,1                TRANSMIT                             3IO13390
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                3IO13400
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               3IO13410
*                         TERMINATE IO COMMAND                          3IO13420
RW8    NZT     XEOB                IF USER NOT LOCATING                 3IO13430
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        3IO13440
       RNT     EOB                 IF EOB DID NOT OCCUR                 3IO13450
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   3IO13460
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       3IO13470
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            3IO13480
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       3IO13490
       TRA     RW13                YES                                  3IO13500
RW10   LNT     100000              IS COMMAND                           3IO13510
       TRA     GTIOX               IOXP OR IOXT                         3IO13520
RW12   RFT     HELD                IF A HOLD OCCURRED                   3IO13530
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      3IO13540
       RFT     RDSWIT              IF READING EXECUTE                   3IO13550
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   3IO13560
       RFT     EOBXIT              EXIT AT                              3IO13570
       TRA     EOBEX               -EOB EXIT                            3IO13580
       TRA     COMXIT              -NORMAL EXIT                         3IO13590
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) 3IO13600
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       3IO13610
       TRA     RW10                -NO IT IS COMPLETE                   3IO13620
       RIR     GENER               RESET GENER BIT                      3IO13630
       LFT     200000              IF IOCY                              3IO13640
       TRA     RW14+2              NO- IOSY INTERRUPTED                 3IO13650
       RNT     200000              IF IOCYN                             3IO13660
       TRA     RW14                NO -IOC TRANSMITTING                 3IO13670
       ZET     XEOB                IF IOCYN LOCATING                    3IO13680
       TRA     RW16                TAKE EOB INTERRUPT EXIT              3IO13690
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   3IO13700
       STA     TRANS               ADDRESS                              3IO13710
       CLA     DUMMY               SET NEW                              3IO13720
       STD     WDCT                WORD COUNT                           3IO13730
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            3IO13740
RW16   CAL     2TAG                SET EOB IOCYN                       *3IO13750
       TRA     RW17+1              INTERRUPTED CODE                     3IO13760
RW17   CAL     RW13                SET END OF BUFFERS CODE             *3IO13770
       STT     LTSX                STORE CODE                          *3IO13780
       SIR     EOBXIT              SET AND TAKE                         3IO13790
       TRA     RW12                EOB EXIT                             3IO13800
       SPACE   1                                                        3IO13810
*                       BOUNDS ERROR IO COMMAND                         3IO13820
BOUND  LAC     GTIOX,1             PLACE L(IOXY) IN IR1                $3IO13830
       CAL     MESS9+4             PLACE ''WRITE''                     $3IO13840
       RFT     RDSWIT              ON IF READ                          $3IO13850
       CAL     MESS9+5             OR ''READ''                         $3IO13860
       SLW     MESS9+3             IN MESSAGE                          $3IO13870
       CAL     *+2                 PARAM TO AC                          3IO13880
       TXI     TSXR+1,1,-1         GO PRINT L(IOXY) IN IR1             $3IO13890
       MZE     MESS9,,4            ''BOUNDS ERROR READ (WRITE) *****'' $3IO13900
       EJECT                                                            3IO13910
*                  HANDLER FOR IORY AND IOSY READING                    3IO13920
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              3IO13930
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     3IO13940
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    3IO13950
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       3IO13960
       SIR     DISCN               SET COMMAND DISCONNECT               3IO13970
       TRA     RW4                 EXECUTE READ                         3IO13980
       SPACE   1                                                        3IO13990
*                  HANDLER FOR IORY AND IOSY WRITING                    3IO14000
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 3IO14010
       LNT     400000              IS IT ACTUALLY IOSY                  3IO14020
       IIR     EBDSY               NO-SET EOB DISCONNECT, TURN OFF IOSY 3IO14030
       SUB     WDCT                REDUCE WORD COUNT AVAILABLE          3IO14040
       TPL     RW5                 IF ENOUGH WERE AVAIL,EXECUTE COMMAND 3IO14050
       LNT     400000              NOT ENOUGH                           3IO14060
       TRA     RW3                 IORY- REDUCE CT AND EXECUTE          3IO14070
       LXD     DUMMY,1             IF SECOND ATTEMPT ON IOSY            3IO14080
       TXH     RW3,1,0             IS STILL TOO BIG, THEN REDUCE COUNT  3IO14090
       SIR     GENER               IOSY -SET GENER TO DO ON NEXT BUF    3IO14100
       CLA     WDCT                SETUP GENERATED                      3IO14110
       STD     DUMMY               COMMAND                              3IO14120
       RFT     XECNT               IF AN IOXYN WAS                      3IO14130
       SIR     EOB                 ALREADY EXECUTED SET EOB TESTS       3IO14140
       TRA     RW8                 GO RELEASE THIS BUF AND DO GENER     3IO14150
       SPACE   1                                                        3IO14160
*                         HANDLER TCH COMMAND                           3IO14170
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      3IO14180
       NZT     TCHEX               IF 1ST TCH THEN                      3IO14190
       STA     TCHEX               EXIT = L(TCH)+1                      3IO14200
       RNT     400000              IF NOT INDIRECT                      3IO14210
       TRA     GTIOX+1             TCH EXECUTED                         3IO14220
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             3IO14230
       PAC     0,1                 GO ONE MORE LEVEL AND                3IO14240
       TRA     GTIOX+1             EXIT                                 3IO14250
       SPACE   1                                                        3IO14260
*                     PRIORITY EXIT TESTS FOR READ                      3IO14270
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         3IO14280
       ANA     L(377)                                                   3IO14290
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        3IO14300
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        3IO14310
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  3IO14320
       RIL     PRIBTS              AND EXIT.                            3IO14330
       RFT     REINT               IF LAST BUF SYNCED                   3IO14340
       TRA     *+4                 GIVE FILE A KICK                     3IO14350
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    3IO14360
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         3IO14370
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  3IO14380
       TSX     BORBF,1             IF NO RUSH OCCURRED                  3IO14390
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      3IO14400
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  3IO14410
       TTL     READ SUBROUTINE - SYNCR-                                 3IO14420
*                   GETS A BUFFER FROM THE EXECUTOR                     3IO14430
*                         VIA THE SYNC ROUTINE                          3IO14440
       SPACE   1                                                        3IO14450
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   3IO14460
*              RETURN              INDEXS ARE NOT DISTRUBED             3IO14470
       SPACE   1                                                        3IO14480
SYNCR  SXA     SY8.2,4             SAVE IR4                             3IO14490
       SXA     SY8.1,1             IR1                                  3IO14500
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $3IO14510
       ENB     L(0)                TRAP PROTECT                        $3IO14520
       NZT*    4,2                 ANYTHING TO SYNC                     3IO14530
       TRA     SY10                -NO                                  3IO14540
       CLA     5,2           TEST FOR HYPERTAPE FILE.                   3IO14550
       ANA     SIX                                                      3IO14560
       TZE     *+5                 NO                                  $3IO14570
       LDQ     1,2                 WHAT                                $3IO14580
       RQL     18                  TYPE                                $3IO14590
       TQP     *+2                 READ                                $3IO14600
       SIR     100000              HYPER READ BACKWARD                 $3IO14610
       BES     *-7+NOHYP/NOHYP*7-*                                     $3IO14620
       CLA     4,2                 SYNCED BUFFER TO                     3IO14630
       STA     2,2                 BUFFER IN USE ADDRESS                3IO14640
       CAL     1,2                 REDUCE COUNT OF                      3IO14650
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     3IO14660
       STA     1,2                                                      3IO14670
       CLA*    4,2                 UPDATE SYNC                         $3IO14680
       STA     4,2                 CHAIN CARRYING L(END)                3IO14690
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             3IO14700
       STD*    4,2                 UNLESS NO CHAIN EXISTS               3IO14710
       ENB     TRAPS               ALLOW TRAPS                          3IO14720
       LGR     33                  SET EOF AND/ OR REDUN                3IO14730
       IIA                         BITS=0 IF CONDITION OCCURRED         3IO14740
       LXD     SYNCT,1             ADVANCE COUNT                        3IO14750
       TXI     *+1,1,1             OF BUFFERS                           3IO14760
       SXD     SYNCT,1             USED THIS READ                       3IO14770
       CAL     2,2                                                      3IO14780
       ACL     L(1)                                                     3IO14790
       PAC     0,4                 IR4 = -L(IORT)                       3IO14800
       ACL     L(1)                SET LOCATOR ADDRESS                  3IO14810
       ANA     XCPTP               CLEAR PREFIX                        $3IO14820
       STO*    2,2                                                     $3IO14830
       RNT     100000              READ BACKWARD                       $3IO14840
       TRA     SY4                 NO                                  $3IO14850
       ALS     18                  FIRST DATA WORD                     $3IO14860
       ACL     0,4                 IN BUFFER                           $3IO14870
       ARS     18                  LAST DATA WORD                      $3IO14880
       PAX     0,1                 +1 OF BUFFER                        $3IO14890
       ORA     7PRE                                                    $3IO14900
       BES     *-7+NOHYP/NOHYP*7-*                                     $3IO14910
SY4    SUB     0,4                 LOCATOR - IORT                      $3IO14920
       ALS     18                  =WORD COUNT                         $3IO14930
       STD*    2,2                                                     $3IO14940
       RNT     100000                                                  $3IO14950
       TRA     SY5                                                     $3IO14960
       CAL     0,4                 STARTING DATA                       $3IO14970
       STA*    2,2                                                     $3IO14980
       PXA     0,1                 LAST LOC+1 OF                       $3IO14990
       STA     0,4                 BUFFER IN TO IORT                   $3IO15000
       BES     *-6+NOHYP/NOHYP*6-*                                     $3IO15010
SY5    RNT     NOEOF               DID EOF OCCUR                       $3IO15020
       TRA     SY11                - YES                                3IO15030
       CLA     1,2                 IF LAST BUFFER                       3IO15040
       ANA     L(377)              AHEAD IS                             3IO15050
       PAX     0,1                 SYNCED OUT                           3IO15060
       CAL     3,2                 AND NOT                              3IO15070
       PBT                         AN INTERNAL FILE                     3IO15080
       TXL     SY9,1,0             INITIATE ANOTHER                     3IO15090
SY5.6  RNT     100000                                                  $3IO15100
       ADD     1DEC                BLOCK SEQUENCE                      $3IO15110
       LNT     BLKSEQ              BLOCK SEQ CHECK                      3IO15120
       TRA     SY7.6+1             - NO                                $3IO15130
       STD     SY7.1               SAVE SEQ NUMBER FOR TEST             3IO15140
       CAL*    2,2                 REDUCE                               3IO15150
       SUB     1DEC                USABLE WORD COUNT                    3IO15160
       STD*    2,2                 BY ONE                               3IO15170
       CAL     0,4                 GET L(SEQ. WD.)                     $3IO15180
       SUB     L(1)                FOR USE SOON                        $3IO15190
       RNT     100000              BACKWARD READ                       $3IO15200
       TRA     *+3                 NO                                  $3IO15210
       LNT     LABEL                                                   $3IO15220
       TRA     SY7.1+2                                                 $3IO15230
       BES     *-4+NOHYP/NOHYP*4-*                                     $3IO15240
       STA     *+1                                                     $3IO15250
       LAC     **,1                CHECK BLOCK                         $3IO15260
SY7.1  TXI     *+1,1,**            SEQUENCE                             3IO15270
       TXH     SEQEX,1,0           ADVANCED BY ONE                      3IO15280
       LNT     CKSUMS              ARE CHECKSUMS TO BE CHECKED          3IO15290
       TRA     SY7.6               -NO                                  3IO15300
       STA     SY7.5               -YES SAVE L(BLK WORD)                3IO15310
       STA     SUM1                SET LAST CKSUM ADDRESS+1             3IO15320
       CLA*    2,2                 CHECKSUM WDCT TO AC                  3IO15330
       ACL     1DEC                DONT CHECKSUM CKSUM WD               3IO15340
       TSX     SUMMIT+1,1          FORM FOLDED CHECKSUM                 3IO15350
       SLQ     TEMP                FOR COMPARE                          3IO15360
SY7.5  CAL     **                  DOES CHECKSUM COMPUTED               3IO15370
       ANA     PDMSK               COMPARE WITH                         3IO15380
       ERA     TEMP                CHECKSUM IN BLOCK WORD               3IO15390
       TNZ     CKSEX               IF NOT TAKE CKSUM ERROR EXIT         3IO15400
SY7.6  CLA     SY7.1               SEQ NUMBER TO AC                     3IO15410
       RFT     100000                                                  $3IO15420
       SUB     1DEC                                                    $3IO15430
       RIR     100000                                                  $3IO15440
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO15450
       RNT     NORED               IF URR OCCURRED                      3IO15460
       TRA     URREX               TAKE ERROR EXIT                      3IO15470
       STD     3,2                                                      3IO15480
SY8.2  AXT     **,4                RESTORE IR4                          3IO15490
SY8.1  AXT     **,1                IR1                                  3IO15500
       TTR     1,1                 RETURN                               3IO15510
       SPACE   1                                                        3IO15520
*                          LAST BUFFER SYNCED                           3IO15530
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        3IO15540
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    3IO15550
       CAL     3,2                 BLK SEQ NUMBER-1 TO AC               3IO15560
       TRA     SY5.6               CONTINUE                             3IO15570
       SPACE   1                                                        3IO15580
*                  NO BUFFER AVAILABLE WHEN NEEDED                      3IO15590
       RFT     NOREOF              IF ON TRY                           $3IO15600
       TRA     SY10-5              TO GET A BUFFER                   (8)3IO15610
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   3IO15620
       TRA     RW17                TAKE IT , ELSE GIVE                  3IO15630
       TRA     GET4                '' ILLEGAL FILE USE '' ERROR         3IO15640
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                3IO15650
       RIR     NOREOF              SET TRIED ONCE                      $3IO15660
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       3IO15670
       TSX     BORBF,1             INITIATE READ                        3IO15680
       TRA     SY9.3-2             COULD NOT                           $3IO15690
       TRA     ACT                                                   (8)3IO15691
SY10   CLA     3,2                 EOB ON INTERNAL                     $3IO15700
       TMI     EOFEX               FILE IS = END OF FILE                3IO15710
       SIL     RBITS               SET RUSH PRIORITY BITS              $3IO15720
       AXC     1,4                 IS THERE ANY REQUEST                 3IO15730
       NZT*    0,2                 TO BE SYNCED                         3IO15740
       TRA     SY10-3              -NO                               (8)3IO15750
ACT    TSX     ACTV+1,4            -YES, ACTIVATE PRIORITY           (8)3IO15760
       MZE     0,2                 THAT FILE                            3IO15770
       AXC     1,4                 WAIT UNTIL I/O IS                 (4)3IO15771
       ZET*    0,2                 COMPLETED ON THAT UNIT            (8)3IO15772
       TRA     *-1                                                   (8)3IO15773
       TRA     SY3                 CONTINUE SYNC OUT                    3IO15780
       SPACE   1                                                        3IO15790
*                             EOF ON SYNC                               3IO15800
SY11   STZ     READR2                                                   3IO15810
       TSX     DISCON,1            DISCONNECT BUFFER                    3IO15820
       LDQ     2,2                 CHECK FOR TRAILERS.                  3IO15830
       RQL     2                   ONLY SYSIN1 OR SYSIN2               $3IO15840
       TQP     EOFEX               MONITOR CONTROL OF EOF'S             3IO15850
       TSX     MONEOF,4            EXECUTE MONITOR EOF CONTROL          3IO15860
       TRA     EOFEX               AND TAKE EOF EXIT                    3IO15870
       TSX     SWITCH,1            2,4 RETURN CAUSES REEL SWITCH        3IO15880
       TRA     SYNCR+2             AND AUTOMATIC PROCEED                3IO15890
       TTL                         READ SUBROUTINE-BORBF-               3IO15900
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   3IO15910
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            3IO15920
       SPACE   1                                                        3IO15930
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  3IO15940
*              ERROR RETURN        INDEX REGISTERS ARE                  3IO15950
*              NORMAL RETURN        NOT DISTURBED                       3IO15960
       SPACE   1                                                        3IO15970
BORBF  SXA     BOR8,1              SAVE IR1                             3IO15980
       SXA     BOR2,4              SAVE IR4                             3IO15990
       LAC     LBC,4               IF NO BUFFERS                        3IO16000
       ENB     L(0)                                                    $3IO16010
       CLA*    0,4                 ARE PRESENTLY                        3IO16020
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               3IO16030
       LXA     BOR8,1              RESTORE IR1                          3IO16040
BOR2   AXT     **,4                RESTORE IR4                          3IO16050
       ENB     TRAPS                                                    3IO16060
       TRA     1,1                 AND EXIT                             3IO16070
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $3IO16080
       TXI     BOR2,1,-1           EXIT AT 2,1                          3IO16090
       STA     XERR                SAVE L(NEXT BUFFER)                 $3IO16100
       CLA     1,2                 IF INITIAL                           3IO16110
       PAX     0,4                 BUFFER DONT                          3IO16120
       TXL     *+3,4,0             ADJUST COUNTS                        3IO16130
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 3IO16140
       TRA     BOR2-1              NO BUFFER AVAILABLE                  3IO16150
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              3IO16160
       CLA     XERR                UPDATE POOL                         $3IO16170
       STA*    LBC                 BUFFER CHAIN                         3IO16180
       CAL     1,2                 UP COUNT BUFFERS                     3IO16190
       ADD     L(1)                IN USE BY                            3IO16200
       STA     1,2                 THE FILE                             3IO16210
       ENB     TRAPS               RESTORE TRAPPING                     3IO16220
       TSX     RDSEL,1             ISSUE STACKED SELECT                 3IO16230
BOR8   AXT     **,1                RESTORE IR1                          3IO16240
       TXI     BOR2,1,-1           EXIT AT 2,1                          3IO16250
       TTL                         INPUT BUFFER RELEASE ROUTINES        3IO16260
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  3IO16270
*              TSX  RELES,1        CANNOT BE USED AT TRAP               3IO16280
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     3IO16290
       SPACE   1                                                        3IO16300
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               3IO16310
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               3IO16320
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     3IO16330
       SPACE   1                                                        3IO16340
DISCON SIR     DONLY               SET DISCONNECT ONLY                  3IO16350
RELES  SIR     RDSWIT              SET RELEASE MODE                     3IO16360
       SXA     RE2,1               SAVE IR1                             3IO16370
       SXA     RE2+1,4             AND IR4                              3IO16380
RE1    CLA*    2,2                 IS A BUFFER                          3IO16390
       TPL     RE4                 CONNECTED NORMALLY                   3IO16400
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            3IO16410
       ANA     7PRE                IF BUFFER HELD                       3IO16420
       TZE     RE2                 OR NO BUFFER CONNECTED               3IO16430
       SPACE   1                                                        3IO16440
*                         RELEASE HELD BUFFERS                          3IO16450
       RNT     RDSWIT              RELEASE OR                           3IO16460
       TRA     TR1                 TRUNCATE                             3IO16470
       LAC     LBC,4                                                    3IO16480
       LDQ     2,2                 L(BUF TO MQ)                         3IO16490
       TSX     POOLRD,1            RELEASE BUFFER                       3IO16500
       RNT     DONLY               UNLESS DISCONNECT ONLY               3IO16510
       TSX     CKGIV,1             IF GIVUP ON REINITIATE               3IO16520
RE1.5  CLA     TCHAN               CHAIN HELD                           3IO16530
       STA     2,2                 BUFFERS                              3IO16540
       RNT     CPYFN               UNLESS COPYING                       3IO16550
       TRA     RE1                 RELEASE ALL HELD BUFFERS             3IO16560
RE2    AXT     **,1                RESTORE IR1                          3IO16570
       AXT     **,4                AND IR4                              3IO16580
       RNT     GENER               IF GENERATED DISCONNECT SAVE         3IO16590
       RIR     DISCN               COMMAND DISCONNECT BIT               3IO16600
       RIR     EOBITS                                                   3IO16610
       RFT     RDSWIT                                                   3IO16620
       RIR     XECNT                                                    3IO16630
       TRA     1,1                 EXIT                                 3IO16640
       SPACE   1                                                        3IO16650
*                        RELEASE BUFFER IN USE                          3IO16660
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            3IO16670
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    3IO16680
       RNT     RDSWIT              RELEASE OR                           3IO16690
       TRA     TR1.1               TRUNCATE                             3IO16700
       RNT     HOLD                IS HOLD BIT ON                       3IO16710
       TRA     RE5                 ENTER HOLD                           3IO16720
       TSX     ENTHLD,4            BUFFER INTO                          3IO16730
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          3IO16740
       TRA     RE6                 HOLD CHAIN                           3IO16750
RE5    LDQ     2,2                 L(BUF) TO MQ                         3IO16760
       LAC     LBC,4                                                    3IO16770
       TSX     POOLRD,1            BUFFER TO POOL                       3IO16780
RE6    CLA     LBC                 SET FILE TO REFER                    3IO16790
       STA     2,2                 TO POOL                              3IO16800
       RNT     DONLY               IF DISCONNECT ONLY                   3IO16810
       TSX     CKGIV,1             DONT PRIORITY INITIATE               3IO16820
       TRA     RE2                                                      3IO16830
*                  RELEASE BUFFER FROM INTERNAL FILE                    3IO16840
RE7    BSS     1                   TSX   ENTIN,1                        3IO16850
       ENB     TRAPS               ALLOW TRAPS                          3IO16860
       RNT     INSAT               EXIT EITHER TO                       3IO16870
       TRA     RE1.5               RELEASING HELD                       3IO16880
       TRA     RE6                 RELEASING THOSE IN USE               3IO16890
       TTL                         RELEASE INPUT BUFFER TO POOL         3IO16900
*                            IR2 = -L(FILE)                             3IO16910
*                            IR4 = -L(POOL)                             3IO16920
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        3IO16930
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        3IO16940
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               3IO16950
       SPACE   1                                                        3IO16960
TOPOOL LDI     1,2                 FILE BITS TO                         3IO16970
       RIR     77777               SI-RIGHT SIDE TO ZERO                3IO16980
TOCLOS ENB     L(0)                TRAP PROTECT                         3IO16990
       CAL     1,2                 REDUCE                               3IO17000
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     3IO17010
       STA     1,2                 USE COUNT                            3IO17020
*                      RELEASE INPUT BUF TO POOL                        3IO17030
POOLRD ENB     L(0)                TRAP PROTECT                         3IO17040
       CAL     1,2                 REDUCE CT                            3IO17050
       SUB     L(400)              OF BUFS LOGICALLY                    3IO17060
       STA     1,2                 IN USE BY FILE                       3IO17070
       RNT     RDSWIT              IS THE RELEASE MODE ON               3IO17080
       TRA     TCHAN               NO                                   3IO17090
       ZET     READR2                                                   3IO17100
       TRA     PRD2+1              YES                                  3IO17110
TCHAN  XCA     **                  L(BUF) TO AC                         3IO17120
       RNT     STSH                IF STASH AND XEOB IS NOT ZERO        3IO17130
       TRA     *+4                 (SIGNIFYING RELEASE ALREADY          3IO17140
       ZET     XEOB                ACCOUNTED FOR BY TSX BCKBF,1 )       3IO17150
       TRA     PRD2+1              SKIP TO EXIT, ALL STASHES ARE        3IO17160
       TRA     PRD1                DESTRUCTIVE RELEASES FROM INPUT      3IO17170
       LDQ     3,2                 IF AN INTERNAL FILE                  3IO17180
       TQP     *+2                 GO OUT AND CHECK DESTRUCTIVE         3IO17190
       TMI     RE7                 READ MODE OR NOT                     3IO17200
PRD1   SXA     PRD2,1              SAVE IR1                             3IO17210
       RNT     CPYFN               UNLESS COPYING                       3IO17220
       TSX     BTP2,1              RELEASE BUF TO POOL                  3IO17230
       CLA     1,2                 IF LAST                              3IO17240
       PAX     0,1                 BUFFER                               3IO17250
       TXL     PRD2,1,0            IN USE THEN SKIP                     3IO17260
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 3IO17270
PRD2   AXT     **,1                RESTORE IR1                          3IO17280
       NZT     INTRAP              UNLESS AT TRAP                       3IO17290
       ENB     TRAPS               RESTORE TRAPPING                     3IO17300
       TRA     1,1                 EXIT                                 3IO17310
       TTL     PRIORITY REINITIATE AN INPUT BUFFER                      3IO17320
CKGIV  CLA     3,2                 IF AN INTERNAL FILE                  3IO17330
       TMI     1,1                 SKIP PRIORITY                        3IO17340
       CAL     1,2                 IF NO                                3IO17350
       ANA     L(377)              BUFFERS                              3IO17360
       TZE     CK2                 AHEAD                                3IO17370
       LFT     GIVUP               OR BUFFER ALREADY                    3IO17380
       TRA     CK2                 GIVEN UP REINITIATE                  3IO17390
       SIL     GIVUP                                                    3IO17400
CK1    LNT     RUSH                IF RUSH OCCURRED                     3IO17410
       TRA     1,1                 REINITIATE , ELSE EXIT               3IO17420
       RIL     RANDG               RESET RUSH AND GIVUP BITS            3IO17430
CK2    SXA     *+3,1               SAVE IR1                             3IO17440
       TSX     BORBF,1             INITIATE BUFFER                      3IO17450
       SIR     REINT               COULDN'T SET REINITIATE AT EXIT      3IO17460
       AXT     **,1                RESTORE                             $3IO17470
       TRA     CK1                 GO TEST RUSH                         3IO17480
       TTL                         WRITE SUBROUTINE-TRUNC-              3IO17490
*                      TRUNCATE AN OUTPUT BUFFER                        3IO17500
       SPACE   1                                                        3IO17510
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          3IO17520
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    3IO17530
       SPACE   1                                                        3IO17540
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    3IO17550
       TRA     RELES+1             USE RELES ROUTINE                    3IO17560
       SPACE   1                                                        3IO17570
*                        TRUNCATE HELD BUFFERS                          3IO17580
TR1    CLA*    2,2                 HOLD CODE TO AC                      3IO17590
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         3IO17600
       CLA     TCHAN               UPDATE FILE                          3IO17610
       STA     2,2                 HOLD CHAIN                           3IO17620
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        3IO17630
       SPACE   1                                                        3IO17640
*                        TRUNCATE BUFFER IN USE                         3IO17650
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $3IO17660
       TRA     TR2                 NO, WRITTEN                         $3IO17670
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $3IO17680
       TRA     TR3                                                     $3IO17690
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $3IO17700
       SXA     TR10+2,1                                                $3IO17710
       CAL     2,2                 FIND                                $3IO17720
       ACL     L(1)                L(IORT)                              3IO17730
       STA     TR5                                                      3IO17740
       CLA*    2,2                 PICK UP LOCATOR                     $3IO17750
       TMI     TR5+1               IN HOLD CHAIN                       $3IO17760
TR5    STA     **                                                       3IO17770
       CLA*    TR5                 GET LOCATOR                         $3IO17780
       STA     TR10                FOR CHECKSUMMING CALC.               3IO17790
       STA     SUM1                AND STORE                            3IO17800
       SUB     TR5                 FORM COUNT AND STORE                $3IO17810
       LNT     BLKSEQ                                                   3IO17820
       SUB     L(1)                IN IORT                              3IO17830
       ALS     18                                                       3IO17840
       STD*    TR5                                                      3IO17850
       ANA     DECRE                                                    3IO17860
       LFT     BLKSEQ              IF ONLY ONE WORD (THE BLKSEQ WORD)   3IO17870
       SUB     1DEC                EXISTS OR IF NO DATA WORDS           3IO17880
       TNZ     TR9                 EXIST THEN                           3IO17890
       LDQ     2,2                 DONT WRITE BUFFER OUT                3IO17900
       LAC     LBC,4               L(POOL) TO IR4                       3IO17910
       CAL     1,4                 RESTORE                              3IO17920
       ARS     4                   SIZE TO                              3IO17930
       STD*    TR5                 IORT                                 3IO17940
       ENB     L(0)                TRAP PROTECT                         3IO17950
       TSX     BTP1,1              BUFFER IN POOL                       3IO17960
       CLA     3,2                 IF AN INTERNAL FILE THEN             3IO17970
       TPL     *+2                 ADJUST BUFFER COUNTS                 3IO17980
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         3IO17990
       ENB     TRAPS               ALLOW TRAPS AND EXIT SO              3IO18000
       LXA     TR10+2,1            NO WRITE                            $3IO18010
       TRA     1,1                 IS EXECUTED                         $3IO18020
TR9    LNT     CKSUMS              ARE CKSUMS DESIRED                   3IO18030
       TRA     *+3                                                      3IO18040
       TSX     SUMMIT,1            FORM AND STORE IN BLKSEQ             3IO18050
TR10   SLQ     **                  WORD THE 18 BIT                      3IO18060
       AXT     **,4                RESTORE IRS                         $3IO18070
       AXT     **,1                AND RETURN                          $3IO18080
       TRA     1,4                                                     $3IO18090
TR2    TSX     WRSEL,1             WRITE BUFFER                         3IO18100
TR3    CLA     LBC                 SET FILE REFERENCE                   3IO18110
       STA     2,2                 TO POOL                              3IO18120
       TRA     RE2                                                      3IO18130
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       3IO18140
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             3IO18150
*              TSX  GTBUF,1        IR2 =-L(FILE)                        3IO18160
*              RETURN               INDICES NOT DISTURBED               3IO18170
       SPACE   1                                                        3IO18180
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            3IO18190
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    3IO18200
*              RETURN               IR1 DESTROYED                       3IO18210
       SPACE   1                                                        3IO18220
OBTIB  SXA     GET8,4              SAVE IR4                             3IO18230
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $3IO18240
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           3IO18250
       TRA     1,4                 EXIT                                 3IO18260
       SPACE   1                                                        3IO18270
GTBUF  SXA     GET8,4              SAVE IR4                             3IO18280
       CLA     3,2                 IF AN INTERNAL FILE                  3IO18290
       TPL     GET0                CHECK TO MAKE SURE AFTER             3IO18300
       SXA     GET8+1,1            SAVING INDEX 1 ,                     3IO18310
       TSX     TOKBB,4             THAT FILE IS ALLOWED                 3IO18320
       TRA     SY9.3               TO TAKE A BUFFER , IF SO             3IO18330
       TRA     *+2                 SKIP SAVING OF IR1                   3IO18340
GET0   SXA     GET8+1,1            SAVE IR1                             3IO18350
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           3IO18360
       CLA     1,4                 NECESSARY IT WILL BE STARTED         3IO18370
       LDQ*    0,4                 WITH FIRST FILE                      3IO18380
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          3IO18390
       SPACE   1                                                        3IO18400
*                         NO BUFFER AVAILABLE                           3IO18410
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   3IO18420
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $3IO18430
       LAC     LBC,4               L(BPCW)                           $5$3IO18440
       LDQ*    0,4                                                   $5$3IO18450
       TQP     GET5                BUF AVAIL-JOIN IT                   $3IO18460
       TRA     SY9.3               NONE-TRY EOB                        $3IO18470
       STA     CPY7                SETUP SYNC SEQUENCE                  3IO18480
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           3IO18490
       CLA     0,1                 PLACE L(UCW)                         3IO18500
CPY7   PAC     **,4                IN IR4                               3IO18510
       CLA     1,4                 IF PRIORITY WORD                     3IO18520
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             3IO18530
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          3IO18540
       TSX     ACTV+1,4            ACTIVATE THIS UNIT GIVING            3IO18550
1TAG   MZE     0,1                 IT HIGH PRIORITY                     3IO18560
       LAC     LBC,4               WAIT UNTIL                           3IO18570
       CLA*    0,4                 A BUFFER PLACED IN                   3IO18580
       TPL     GET5                POOL BY TRAP                         3IO18590
       TRA     CPY7-2                                               (12)3IO18600
       EJECT                                                            3IO18610
*                     UNIT HAS NO REQUESTS WAITING                      3IO18620
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   3IO18630
       ANA     NEOTBT              AND EOT CONDITION                    3IO18640
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             3IO18650
GET3   CLA     1,1                 ADVANCE AROUND                       3IO18660
       TRA     GET1                OUTPUT CHAIN                         3IO18670
*        ERROR-NO FILES CAN GIVUP BUFFERS - ILLEGAL FILE USE -          3IO18680
GET4   TSX     PROUT,4             AN ILLEGAL FILE USAGE SUCH           3IO18690
       PZE     1                   AS USING A TTO AS A PTO              3IO18700
       PZE     MES22,,3            WILL CAUSE THIS ERROR                3IO18710
       TSX     STOP,4                                                   3IO18720
       SPACE   1                                                        3IO18730
*                  GOT A BUFFER - READY IT FOR OUTPUT                   3IO18740
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 3IO18750
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     3IO18760
       ENB     L(0)                TRAP PROTECT                         3IO18770
       RNT     HELD                IF A HELD BUFFER                     3IO18780
       TRA     GET6                EXIST,COUNT                          3IO18790
       CLA     3,2                 SHOULD BE ADJUSTED                   3IO18800
       TMI     *+4                 ( EXCEPT INTERNAL FILES)             3IO18810
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           3IO18820
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    3IO18830
       LAC     LBC,4               L(POOL) TO IR4                       3IO18840
       CAL     7PRE                SET CODE 7                           3IO18850
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            3IO18860
GET6   CLA*    0,4                 UPDATE AVAILABLE                     3IO18870
       STA     CPY7                BUFFER CHAIN                         3IO18880
       CLA     0,4                 SET L(BUF)                           3IO18890
       STA     2,2                 INTO FILE REFERENCE                  3IO18900
       ACL     L(1)                SAVE                                 3IO18910
       STA     GET7                L(IORT)                              3IO18920
       ACL     L(1)                SET LOCATOR                          3IO18930
       STA*    2,2                 = PZE *+2,,**                        3IO18940
       CAL     CPY7                UPDATE POOL TO REFER                 3IO18950
       STA     0,4                 TO NEXT BUFFER                       3IO18960
       ENB     TRAPS               ALLOW TRAPS                          3IO18970
GET7   CLA     **                  PICKUP IORT                          3IO18980
       LFT     BLKSEQ              AND FORM                             3IO18990
       SUB     1DEC                EFFECTIVE SIZE OF BUFFER             3IO19000
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     3IO19010
GET8   AXT     **,4                RESTORE IR4                          3IO19020
       AXT     **,1                1                                    3IO19030
       RIR     FREEUP              RESET FREEUP BIT                    $3IO19040
       TRA     1,1                 EXIT                                 3IO19050
       TTL                         HOLD FUNCTION SUBROUTINES            3IO19060
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              3IO19070
       SPACE   1                                                        3IO19080
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  3IO19090
*              RETURN              IR1 DESTROYED                        3IO19100
       SPACE   1                                                        3IO19110
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      3IO19120
       LFT     OUTPUT                                                  $3IO19130
       TRA     FIX                                                     $3IO19140
       TPL     FIX                 IF REGEN INTERNAL FILE              $3IO19150
FIX1   RFT     HELD                IF ALREADY HOLDING                  $3IO19160
       TRA     EN1                 SKIP INITIALIZATION                  3IO19170
       PAX     0,1                 ENTER 1ST BUFFER                     3IO19180
       SIR     HELD                IN CHAIN                             3IO19190
       SXD     HOLDS,1             PRESET * STORE                       3IO19200
       TRA     EN1+1                                                   $3IO19210
FIX    PAC     0,1                 BCW TO IR1                          $3IO19220
       CLA*    2,2                 GET LOCATOR AND                     $3IO19230
       STA     1,1                 SAVE FOR WRITE                      $3IO19240
       CLA     2,2                 IN ITS IORT                         $3IO19250
       TRA     FIX1                PUT IN HOLD CHAIN                   $3IO19260
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                3IO19270
       STA     HOLDS               UPDATE CHAIN                         3IO19280
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $3IO19290
       STP*    HOLDS               IN BUFFER                            3IO19300
       TRA     1,4                                                     $3IO19310
       SPACE   1                                                        3IO19320
*                           SETUP HOLD CHAIN                            3IO19330
*                           IN FILE AT EXIT                             3IO19340
*                          FROM READ OR WRITE                           3IO19350
       SPACE   1                                                        3IO19360
*                           CALLING SEQUENCE                            3IO19370
       SPACE   1                                                        3IO19380
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        3IO19390
*              RETURN                                                   3IO19400
       SPACE   1                                                        3IO19410
HOOK   CLA     2,2                                                      3IO19420
       STA*    HOLDS                                                    3IO19430
       LXD     HOLDS,1                                                  3IO19440
       PXA     0,1                                                      3IO19450
       STA     2,2                                                      3IO19460
       RIR     HELD                                                     3IO19470
       TRA     1,4                                                      3IO19480
       TTL             NON-DATA SELECT CODES FOR IOEX                   3IO19490
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        3IO19500
       SPACE   1                                                        3IO19510
HFPNP  EQU     42                  FILE PROTECT                         3IO19520
HUNLP  EQU     39                  UNLOAD                               3IO19530
HSKFP  EQU     37                  SKIP FILE                            3IO19540
HSKRP  EQU     36                  SKIP RECORD                          3IO19550
HBSFP  EQU     35                  BACKSPACE FILE                       3IO19560
HBSRP  EQU     34                  BACKSPACE RECORD                     3IO19570
HWTMP  EQU     33                  WRITE TAPE MARK                      3IO19580
HERGP  EQU     32                  ERASE LONG GAP                       3IO19590
HRUNP  EQU     31                  REWIND AND UNLOAD                    3IO19600
HRWDP  EQU     30                  REWIND                               3IO19610
WEFOP  EQU     7                   WEF                                  3IO19620
BSFOP  EQU     6                   BSF                                  3IO19630
BSROP  EQU     5                   BSR                                  3IO19640
RUNOP  EQU     4                   RUN                                  3IO19650
REWOP  EQU     3                   REW                                  3IO19660
SDNHP  EQU     2                   SDNH                                 3IO19670
SDNLP  EQU     1                   SDNL                                 3IO19680
TESTP  EQU     0                   TEST OP                              3IO19690
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         3IO19700
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 3IO19710
*      TSX  WRSEL,1                          2,2 (21-35)                3IO19720
*         TSX    WRSLH,1         WRITE HELD BUFFER                      3IO19730
*                                  IR4 IS DESTROYED                     3IO19740
       SPACE   1                                                        3IO19750
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $3IO19760
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      3IO19770
SEL4   PZE     **,,ISSUE           SELECT WORD                          3IO19780
WRSEL  CLA     3,2                 HANDLE INTERNAL FILE                 3IO19790
       TMI     SEL5.8              SEPARATELY                           3IO19800
       TSX     SETWR,4             SET UP TO WRITE                     $3IO19810
       LDQ     2,2                 L(BUF) TO MQ                         3IO19820
RDSEL  XCA                                                              3IO19830
       STA     SEL4                L(BUF) TO SEL4                       3IO19840
       LDQ     L(0)D               SET BUFFER                           3IO19850
       LGL     18                  1ST WD =                             3IO19860
       SLW*    SEL4                PZE L(0),,*                          3IO19870
SEL0   AXC     1,4                                                      3IO19880
       ENB     L(0)                                                     3IO19890
       CLA*    0,2                 CHECK FILE ALREADY                   3IO19900
       TZE     SEL3                ACTIVE                               3IO19910
       STA     SEL1                YES                                  3IO19920
       CAL     FCW                                                     $3IO19930
       AXT     0,4                                                     $3IO19940
       ERA*    0,2                 IS THIS THE SAME FILE               $3IO19950
       ANA     ADDRS                                                   $3IO19960
       TZE     SEL1                YES                                 $3IO19970
       TSX   (ACTVX,4              NO                                  $3IO19980
       MZE     0,2                                                     $3IO19990
       TRA     SEL0                                                    $3IO20000
SEL1   CLA     **                  ADD NEW                              3IO20010
       PDC     0,4                 BUFFER TO END                        3IO20020
       CLA     SEL4                OF EXISTING                          3IO20030
       STA     0,4                 BUFFER CHAIN                         3IO20040
       ALS     18                  SET L(NEW BUF) INTO                  3IO20050
       STD*    SEL1                DECREMENT 1ST ENTRY                  3IO20060
       ENB     TRAPS               ALLOW TRAPS                          3IO20070
       TRA     1,1                 EXIT                                 3IO20080
       SPACE   1                                                        3IO20090
*                         ENTER INITIAL SELECT                          3IO20100
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    3IO20110
       TRA     SEL6                GO HANDLE IT SPECIAL                 3IO20120
       AXT     0,4                 CHECK FOR                            3IO20130
       CLA*    0,2                 ENTERING INITIAL SELECT ON           3IO20140
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         3IO20150
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         3IO20160
       LGL     18                  HAS ENCOUNTERED EOT                  3IO20170
       STA     CPY7                IF SO THEN HANDLE                    3IO20180
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        3IO20190
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   3IO20200
       TSX     EOTOF,1                                                  3IO20210
       TSX     CPY6,4                                                   3IO20220
SEL2.4 AXT     **,1                RESTORE IR1                          3IO20230
SEL2.5 STI     TEMIND                                                  $3IO20240
       AXT     0,4                 GET FILE BLOCK ADDRESS              $3IO20250
       CAL     FCW                 AND STORE IN UCW ONE                $3IO20260
       STA*    0,2                                                     $3IO20270
       LDI*    0,2                 UCW 1                               $3IO20280
       LFT     20000               1301                                $3IO20290
       TRA     SEL2.6              MAYBE                               $3IO20300
SEL2.7 CAL     SEL4                NO                                  $3IO20310
       AXC     1,4                                                     $3IO20320
       LDI     TEMIND                                                  $3IO20330
       LFT     OUTPUT              OUTPUT                              $3IO20340
       ORA     FOR                 YES-SET BIT                         $3IO20350
       SLW*    0,2                 STORE ISSUE IN UCW 2                $3IO20360
       TSX     ACTV+1,4            ACTIVATE                             3IO20370
       PZE     0,2                 THIS FILE                            3IO20380
       TRA     1,1                                                      3IO20390
SEL2.6 LNT     100                 1301                                $3IO20400
       TRA     SEL8           NO                                       $3IO20410
       SXA     SEL2.8+1,1          YES                                 $3IO20420
       CLA     0,2                 PUT -L(UCB) IN IR4                  $3IO20430
       PAC     0,4                                                     $3IO20440
       LDQ     6,2                 CHECK IF EOF ON DISK                $3IO20450
       TQP     SEL2.8              NO                                  $3IO20460
       ARS     18                  PUT CORRECT SEEK                    $3IO20470
       STA     6,2                 IN WORD SEVEN                       $3IO20480
       STP     6,2                 AND TURN OFF EOF BIT                $3IO20490
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $3IO20500
       AXT     **,1                                                    $3IO20510
       TRA     SEL2.7         RETURN                                   $3IO20520
       TXI     *+1,1,-RELASE       IS THIS A RELEASE ENTRY             $3IO20530
       TXL     GO,1,0              YES GO THERE                        $3IO20540
ENDTRK TSX     PROUT,4             PRINT OUT NOTICE                    $3IO20550
       PZE     2                   TO OPERATOR                         $3IO20560
       MZE     9,2,3                                                    3IO20570
       PZE     MESS2,,3       AND STOP                                 $3IO20580
       LDI     1,2            RESTORE IND                              $3IO20590
       RIR     77777                                                   $3IO20600
       PXA     0,0                                                     $3IO20610
       STT     6,2                                                     $3IO20620
       TRA     BOFEX                                                   $3IO20630
       BES     SEL2.6+NOCH/NOCH**-NOCH/NOCH*SEL2.6-*                   $3IO20640
SEL8   PXD     0,0                                                     $3IO20650
       LDI     1,2                                                     $3IO20660
       RFT     400000              IS THIS READ BACKWARD               $3IO20670
       CLA     SIX                 YES, SET BACKWARD READ MODE         $3IO20680
       ACL     SEL4                YES                                 $3IO20690
       AXC     3,4                 STORE ZERO                          $3IO20700
       STZ*    0,2                 IN UCW 4                            $3IO20710
       TRA     SEL2.7+1                                                $3IO20720
       BES     *-8+NOHYP/NOHYP*8-*                                     $3IO20730
TEMIND PZE                                                              3IO20740
       TTL 0                                                            3IO20750
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         3IO20760
SEL5   CLA     3,2                 IF AN INTERNAL FILE                  3IO20770
       TMI     SEL5.8              HANDLE IT SEPARATELY                 3IO20780
       SXA     SEL5.6,1            SAVE IR1                             3IO20790
       ENB     L(0)                DISABLE TRAPS                        3IO20800
       TSX     BCKBB,1                                                  3IO20810
SEL5.6 AXT     **,1                RESTORE IR1                          3IO20820
       TRA     WRSEL+2             RETURN TO WRITE                      3IO20830
*                      WRITE INTERNAL FILE BUFFER                       3IO20840
SEL5.8 TSX     SETWR,4             SET UP TO WRITE                     $3IO20850
       SXA     SEL5.6,1            SAVE IR1                            $3IO20860
       CLA     2,2                 L(BUF)                               3IO20870
       PAC     0,1                 TO IR1                               3IO20880
       LAC     LBC,4               RESTORE SIZE TO                      3IO20890
       CAL     1,4                                                      3IO20900
       ARS     4                                                        3IO20910
       STD     1,1                                                      3IO20920
       CLA     2,2                 SET THIS BUFFER                      3IO20930
SEL5.9 STR                         TSX  ENTIN,1                         3IO20940
       CAL     3,2                 ADVANCE BLOCK SEQ                    3IO20950
       ACL     1DEC                                                     3IO20960
       STD     3,2                                                      3IO20970
       LXA     SEL5.6,1            RESTORE IR1                          3IO20980
       TRA     1,1                 EXIT                                 3IO20990
SEL9   STR                         BSF TRANSFER FOR DISK                3IO21000
       SPACE   1                                                        3IO21010
*                        EOF OR EOT ENCOUNTERED                         3IO21020
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            3IO21030
       TRA     SEL7-1                                                   3IO21040
       LDQ     SEL4                RELEASE BUFFER                       3IO21050
       LAC     LBC,4               -L(POOL) TO IR4                      3IO21060
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  3IO21070
       SPACE   1                                                        3IO21080
*                             EOT OCCURRED                              3IO21090
       SXA     *+2,1               SAVE IR1                             3IO21100
SEL7   TSX     EOTOF,1             HANDLE EOT                           3IO21110
       AXT     **,1                RESTORE IR1                          3IO21120
       TRA     SEL0                AND CONTINUE                         3IO21130
       TTL                         DENSITY SETTING ROUTINE              3IO21140
*                             TSX DENSE,4                               3IO21150
       SPACE   1                                                        3IO21160
DENSE  CLA     1,2                 PLACE FILE                           3IO21170
       ANA     1TAG                DENSITY BIT                          3IO21180
       ALS     3                   IN DECREMENT                         3IO21190
       ACL     1DEC                ADD 1 TO FORM                        3IO21200
       STD     *+3                 LOW DEN. = 1                         3IO21210
       SXA     *+3,4               HI DEN. = 2                          3IO21220
       TSX     NDSEL+1,4           SET DENSITY                         $3IO21230
       PZE     0,2,**                                                   3IO21240
       AXT     **,4                RESTORE IR4                          3IO21250
       TRA     1,4                 EXIT                                 3IO21260
       TTL                         UNBUFFER INPUT FILE                  3IO21270
*    TSX  UNBFI,4           DESTROYS IR1                                3IO21280
       SPACE   1                                                        3IO21290
UNBFI  SXA     UB7,4               SAVE IR4                             3IO21300
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       3IO21310
UB1    ENB     L(0)                TRAP PROTECT                         3IO21320
       AXC     1,4                 IF NO BUFS IN REQ                    3IO21330
       CLA*    0,2                 CHAIN THEN GO RELEASE                3IO21340
       TZE     UB4                 SYNC CHAIN                       (11)3IO21345
       STA     UB2                 SAVE L (1ST REQUEST)             (11)3IO21350
       CAL     FCW                 FCB OF FILE TO BE CLOSED         (11)3IO21351
       AXT     0,4                                                  (11)3IO21352
       ERA*    0,2                 IS SAME FILE ACTIVE              (11)3IO21353
       ANA     ADDRS                                                (11)3IO21354
       TZE     UB1.1               YES....CONTINUE                  (11)3IO21355
       TRA     UB3                 NO. GO FINISH ACTIVE FILE FIRST  (11)3IO21358
UB1.1  LDQ     5,2                   CHECK FOR DISK                     3IO21370
       TQP     *+2                                                     $3IO21390
       TRA     UB3                 DISK, GO TO UB3                     $3IO21400
       BES     UB1.1+NOCH/NOCH**-NOCH/NOCH*UB1.1-*                   $5$3IO21410
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       3IO21430
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         3IO21440
       TRA     UB3                 HOOKING REMAINDER OF REQ             3IO21450
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       3IO21460
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         3IO21470
       XCA                         ITS COMPLETION                       3IO21480
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    3IO21490
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           3IO21500
       LDQ     4,2                 ADD 2ND ON REQS                      3IO21510
       STA     4,2                 TO SYNC CHAIN                        3IO21520
       PDC     0,1                                                      3IO21530
       XCA                                                              3IO21540
       STA     0,1                                                      3IO21550
       CLA*    0,1                                                      3IO21560
       STD*    4,2                                                      3IO21570
UB3    TSX     ACTV+1,4            WHICH AT TRAP WILL                   3IO21580
       MZE     0,2                 BE ENTERED INTO                      3IO21590
       AXC     1,4                 SYNC CHAIN                           3IO21600
       ZET*    0,2                 WAIT                                 3IO21610
       TRA     *-1                                                      3IO21620
       SPACE   1                                                        3IO21630
*                      ALL BUFFERS IN SYNC CHAIN                        3IO21640
UB4    SXD     SYNCT,0             PRESET SYNC CT                       3IO21650
       STZ     TEMP                SET EOF DELETE SWITCH =0             3IO21660
UB4.1  CLA*    4,2                 PLACE BUFFERS                        3IO21670
       TZE     UB6                 FROM SYNC CHAIN                      3IO21680
       TPL     *+4                 TO POOL ,+ BUFFERS                   3IO21690
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          3IO21700
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 3IO21710
       SXD     SYNCT,1             NECESSARY TO REPOSITION              3IO21720
       LDQ     4,2                 TO POOL                              3IO21730
       STA     4,2                                                      3IO21740
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           3IO21750
       TZE     UB4.2               WITH THIS BUFFER                     3IO21760
       XCA                         YES- SO PICKUP                       3IO21770
       PAC     0,1                 THE TAPE POSITION                    3IO21780
       XCA                         AND SAVE FOR AFTER BSR               3IO21790
       CLA     2,1                 ACROSS EOF MARK                      3IO21800
       STO     TEMP                                                     3IO21810
UB4.2  LAC     LBC,4                                                    3IO21820
       TSX     TOCLOS,1                                                 3IO21830
       TRA     UB4.1                                                    3IO21840
       SPACE   1                                                        3IO21850
*                         FORM NEW SYNC CHAIN                           3IO21860
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  3IO21870
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $3IO21880
       TRA     UB3                 AND CONTINUE                         3IO21890
       SPACE   1                                                        3IO21900
*                            EXIT SEQUENCE                              3IO21910
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              3IO21920
       TXL     UB7,1,0             SETUP AND BACKSPACE                  3IO21930
       LDQ     5,2                                                     $3IO21940
       RQL     1                   HYPER                               $3IO21950
       TQP     *+7                 NO                                  $3IO21960
       LDQ     1,2                                                     $3IO21970
       RQL     18                  READ BACKWARD                       $3IO21980
       TQP     *+4                 NO                                  $3IO21990
       TSX     (NDSLX,4                                                $3IO22000
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $3IO22010
       TRA     UB6.3-1                                                 $3IO22020
       BES     *-9+NOHYP/NOHYP*9-*                                     $3IO22030
       TSX     NDSEL+1,4                                                3IO22040
       PZE     0,2,BSROP                                                3IO22050
       NZT     TEMP                IF BSR ACROSS EOF MARK               3IO22060
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $3IO22070
       CLA     5,2                                                   $5$3IO22071
       TMI     *+5                                                   $5$3IO22072
       CLA     TEMP                AND CONTINUE                         3IO22080
       AXC     2,4                                                      3IO22090
       STO*    0,2                                                      3IO22100
       STZ     TEMP                                                     3IO22110
       SIL     NINHIB              UN-INHIBIT FILE                      3IO22120
       TRA     UB6.3                                                    3IO22130
UB7    AXT     **,4                RESTORE IR4                          3IO22140
       TRA     1,4                 EXIT                                 3IO22150
       TTL     UNBUFFER OUTPUT FILE                                     3IO22160
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   3IO22170
*    TSX  UNBFO,4     DESTROYS IR1                                      3IO22180
       SPACE   1                                                        3IO22190
UNBFO  SXA     UNBO,4              SAVE IR4                             3IO22200
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         3IO22210
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 3IO22220
       NZT*    0,2                 TO DO GIVE IT                        3IO22230
       TRA     UNBO                PRIORITY AND WAIT.....               3IO22240
       TSX     ACTV+1,4            FOR ALL REQUESTS TO GET DONE         3IO22250
       MZE     0,2                                                      3IO22260
       TRA     UNBF1                                                    3IO22270
UNBO   AXT     **,4                                                     3IO22280
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        3IO22290
       TRA     1,4                 ELSE EXIT                            3IO22300
       TSX     EOTOF,1                                                  3IO22310
       TRA     UNBO-3                                                   3IO22320
       TTL                         IOCS SELECT ROUTINES                 3IO22330
*             (INITIATE A SELECT AND POST ITS COMPLETION)               3IO22340
       SPACE   1                                                        3IO22350
CHATY  PZE                         UNIT AND CHANNEL TYPE               $3IO22360
ISSUE  SXA     S3,4                SAVE IR4                             3IO22370
       SXA     S3+1,1              SAVE IR1                             3IO22380
       PAC     0,4                 -L(UCW) TO IR4                       3IO22390
       XCA                         SAVE + OR - ENTRY                    3IO22400
CHATT  CLA     0,4                 SET UP AND                          $3IO22410
       ANA     BVDG                TEST FOR UNIT                       $3IO22420
       PDX     0,2                 AND CHANNEL TYPE                    $3IO22430
       TXL     *+3,2,8191          7909 OR 7607                        $3IO22440
       TXL     *+3,2,8192          HYPER                               $3IO22450
       TXI     *+2,2,1             DISK                                $3IO22460
       AXT     0,2                 IF 7607'''ZERO IR2                  $3IO22470
       SXA     CHATY,2             SAVE INDICATION                     $3IO22480
       BES     *-8+NOCHX/NOCHX*8-*                                      3IO22490
       CLA     0,4                 0=7607, 20101=DISK, 20000=HYPER     $3IO22500
       PAC     0,2                 L(FILE) TO IR2                      $3IO22510
       TQP     SELP                SEPARATE SEL+ ENTRY                 $3IO22520
       CLA     CHATY               CHANNEL TYPE                        $3IO22530
       TNZ     MSEL-2              79O9 CHANNEL                        $3IO22540
*                  SELECT (-) ENTRY = POST COMPLETION                   3IO22550
       LFT     400000              IF SHORT RECORD                      3IO22560
       TRA     MXMDT               INDICATION IS ON                     3IO22570
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 3IO22580
       SUB     L(1)                THEN SETUP TO EXIT                   3IO22590
       STA     S3                  AT 2,4                               3IO22600
       CLA     1,4                 IF READING                           3IO22610
       TPL     S3                  DISCARD NOISE RECORD                 3IO22620
MXMDT  CLA     1,2                 IF MIXED MODE                        3IO22630
       TMI     MXMOD               PERFORM EXTRA CALCULATIONS           3IO22640
SELM1  CLA*    (URRXI              IF ANY TAPE                          3IO22650
       TZE     *+3                 ERRORS OCCURRED                      3IO22660
       ACL     5,2                 ADJUST ERROR                         3IO22670
       SLW     5,2                 COUNTS                               3IO22680
       TSX     URC1,1              UPDATE REQUEST CHAIN                 3IO22690
       NZT     CHATY                                                   $3IO22700
       TRA     HSEL1               729 OR CARD UNIT                    $3IO22710
       CLA     1,4                                                     $3IO22720
       TZE     *+4                 NO REQUEST CHAIN                    $3IO22730
       PXD     0,0                 PREFIX FOR REINSTRUCT               $3IO22740
       LNT     200000              OR IF EOF                           $3IO22750
       TRA     HSEL1                                                   $3IO22760
       STA     0,4                 ZERO FCB FROM UCW1                  $3IO22770
       CAL     S3                  RESTORE                             $3IO22780
       ADD     L(1)                ADDRESS                             $3IO22790
       STA     S3                  FOR RETURN                          $3IO22800
       BES     *-11+NOHYP/NOHYP*11-*                                   $3IO22810
HSEL1  LDC     COMM,1              RESTORE TO                          $3IO22820
       TQP     POSTR               IF MQ + READ IS DONE                 3IO22830
       SPACE   1                                                        3IO22840
*                        POST WRITE COMPLETION                          3IO22850
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $3IO22860
       PDC     0,4                                                      3IO22870
       CAL     1,4                 RESTORE BUFFER                       3IO22880
       ARS     4                   SIZE TO IORT                         3IO22890
       STD     -1,1                TO IORT                              3IO22900
       TSX     BTP1,1              PLACE BUF IN POOL                    3IO22910
       LNT     200000              DID EOT OCCUR                        3IO22920
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         3IO22930
*                        EOT HANDLE TRAP WRITE                          3IO22940
       AXC     1,4                                                      3IO22950
       CLA*    0,2                                                      3IO22960
       TZE     *+2                                                      3IO22970
       STA     4,2                                                      3IO22980
       CAL     EOTBT                                                   $3IO22990
*                         INHIBIT BITS TO FILE                          3IO23000
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $3IO23010
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $3IO23020
       LXA     FCW,1                                                    3IO23030
INEX2  TXI     *+1,1,**                                                 3IO23040
       TXH     INEX4,1,0                                                3IO23050
       ANS     (IOXSI                                                   3IO23060
INEX4  ANS     1,2                                                      3IO23070
       TRA     S3                                                       3IO23080
       SPACE   1                                                        3IO23090
*                         POST READ COMPLETION                          3IO23100
POSTR  CAL     COMM                                                     3IO23110
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $3IO23120
       PIA                                                              3IO23130
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $3IO23140
       CLA*    4,2                 DOES SYNC CHAIN EXIST                3IO23150
       TZE     PSTR8               NO                                   3IO23160
       PDC     0,1                 SAVE L(END)                          3IO23170
       XCA                         L(BUF) TO AC                         3IO23180
       STA     0,1                 UPDATE                               3IO23190
       LDQ     L(0)D               SYNC CHAIN                           3IO23200
       LGL     18                                                       3IO23210
       STA*    0,1                                                     $3IO23220
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $3IO23230
       LNT     200000         IF NO EOF                                $3IO23240
       TRA     S3                  THEN EXIT                            3IO23250
       SPACE   1                                                        3IO23260
*                        EOF HANDLER TRAP INPUT                         3IO23270
       SXA     PSTR5,4             SAVE L(UCW)                          3IO23280
       LXA     CHATY,1                                                 $3IO23290
       TXH     DEOF1,1,8192                                            $3IO23300
       LDQ     LTPOS               SAVE TAPE POSITION                   3IO23310
       STQ*    COMM                JUST PRIOR TO EOF MARK               3IO23320
PSTR4  NZT     1,4                 IF LAST BUFFER                       3IO23330
       TRA     PSTR6               DO NOTHING                           3IO23340
PSTR2  TSX     URC1,1              DELETE AHEAD                        $3IO23350
       CLA     4,2                 L(POOL) TO IR4                       3IO23360
       PDC     0,4                                                      3IO23370
       TSX     TOPOOL,1            BUFFERS                              3IO23380
PSTR5  AXT     **,4                RESTORE L(UCW)                       3IO23390
       TRA     PSTR4               DELETE ALL                           3IO23400
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              3IO23410
       CAL     NOTIN               WD UCW AND                          $3IO23420
       TRA     INEX                GO INHIBIT FILE                      3IO23430
       SPACE   1                                                        3IO23440
*                           START SYNC CHAIN                            3IO23450
PSTR8  XCA                         PUT BUF READ IN AC                  $3IO23460
       STA     4,2                                                      3IO23470
       LDQ     L(0)D                                                    3IO23480
       LGL     18                                                       3IO23490
       STA*    4,2                 L(1) IN BUF CW                      $3IO23500
       TRA     PSTR3                                                    3IO23510
       TTL     SELECT (+) ENTRY                                         3IO23520
*                      SIGN OF UCW WD2 0-RD 1-WR                        3IO23530
*                        INSERTS *+1 INTO IORT                          3IO23540
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   3IO23550
*                   AND INCREMENTS IT IN FILE WORDS                     3IO23560
       SPACE   1                                                        3IO23570
SELP   LDI     1,2                 FILE BITS TO SI                      3IO23580
       CLA     CHATY                                                   $3IO23590
       LBT                         UNIT TYPE TEST                      $3IO23600
       TNZ     HYPL                HYPER                               $3IO23610
       TNZ     DRWRS               DISK                                $3IO23620
       LFT     MXDMD               IF MIXED MODE                       $3IO23630
       TRA     MXMP                SKIP OUT                             3IO23640
       CLA     1,4                 GET ADDRESS OF                       3IO23650
       ACL     L(1)                THE IORT TO BE USED                  3IO23660
       STA*    (RCHXI                                                   3IO23670
       STA     S1+3                                                    $3IO23680
       TPL     S1             THIS IS READ                             $3IO23690
S4     ZET*    (URRXI              ERROR ON THIS BLOCK                 $3IO23700
       TRA     S1                  YES START ACTIVITY                   3IO23710
       STA     S0                  NO                                   3IO23720
       XCA                         SAVE ADDRESS OF IORT                $3IO23730
       CLA     3,2                 GET BLOCK SEQ                        3IO23740
       ACL     1DEC                UP BY ONE                            3IO23750
       STD     3,2                                                      3IO23760
       LNT     BLKSEQ              CHECK FOR BLOCK SEQING               3IO23770
       TRA     S1-1                NO                                   3IO23780
       ARS     18                  YES                                  3IO23790
S0     STA*    **                  STORE BLOCK SEQ IN LAST WORD OF BUFF 3IO23800
       XCA                         ADDRESS OF IORT IN MQ                3IO23810
S1     ACL     L(1)                                                     3IO23820
       ZET     CHATY                                                   $3IO23830
       TRA     HYSA                                                    $3IO23840
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      3IO23850
       CLA     1,2                 FORM SELECT                          3IO23860
       ANA     MODBT               INSERTING TAPE MODE BIT              3IO23870
       TNZ     *+2                                                      3IO23871
       STZ     SYSJOB+2                                                 3IO23872
       ARS     7                                                        3IO23880
       ORA     0,4                                                      3IO23890
RWRS   ARS     18                                                       3IO23900
       STA     SELCT               UNIT ADDRESS TO SELECT               3IO23910
       CLA     S2                                                       3IO23920
       LDQ     1,4                                                      3IO23930
       TQP     *+2                 RDS IN SELECT                        3IO23940
       ALS     15                  WRS IN SELECT                        3IO23950
       STD     SELCT                                                    3IO23960
       ZET*    SYSJOB+1                                                 3IO23961
SELCT  RDS     **                  SEL                                  3IO23970
       XEC*    (RCHXI              RCHX                                 3IO23980
S3     AXT     **,4                                                     3IO23990
       AXT     **,1                                                     3IO24000
       TRA     1,4                 RETURN TO IOEX                       3IO24010
S2     OCT     076200766000        RDS...WRS                            3IO24020
       TTL     7909 CHANNEL SELECT ROUTINES                             3IO24030
       LBT                         DISK                                $3IO24040
       TRA     HSELM               NO                                  $3IO24050
MSEL   LFT     7100                TEST UNUSUAL END                    $3IO24060
       TRA     DERR                                                     3IO24070
       LDI     0,2                                                     $3IO24080
       CLA*    1,4            GET FLAG WORD USED                       $3IO24090
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $3IO24100
       ADD     L(1)           FOR THIS OPERATION                       $3IO24110
       STA     *+3                                                     $3IO24120
       LFT     200000              EOF FROM LAST READ                  $3IO24130
       TRA     SEOFI               YES                                 $3IO24140
       LDI     **             PUT FLAG WORD IN INDICATORS              $3IO24150
       LNT     400000              IS RECORD COMPLETE                  $3IO24160
       TRA     FINREC         NO-FINISH RECORD                         $3IO24170
       LFT     200000         EOF OCCUR                                $3IO24180
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $3IO24190
       LDI     FOR            SET INDICATORS AS 7607                   $3IO24200
SELM2  CLA     1,2                 IF MIXED MODE                       $3IO24210
       TMI     1KA                 PERFORM EXTRA CALC.                 $3IO24220
       CLA*    (URRXI              IF ERRORS ADJUST                    $3IO24230
       TZE     *+3            ERROR COUNTS IN FCB                      $3IO24240
       ACL     5,2                                                     $3IO24250
       SLW     5,2                                                     $3IO24260
       CAL     1,4                                                     $3IO24270
       SUB     L(1)                                                    $3IO24280
       SXA     *+3,4          SAVE IR4                                 $3IO24290
       PAC     0,4            IR4=-L(COMM-1)                           $3IO24300
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $3IO24310
SELM5  AXT     **,4                RESTORE IR4                         $3IO24320
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $3IO24330
       CLA     1,4                 PUT ADDRESS OF                      $3IO24340
       PAC     0,1                 COMD CHAIN IN IR 1                  $3IO24350
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $3IO24360
       STZ     1,1                 ZERO OUT COUNT SAVED                $3IO24370
       CAL     8,1                                                     $3IO24380
       ACL     L(1)                                                    $3IO24390
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $3IO24400
       CAL     FCW                 RESTORE IORT                        $3IO24410
       STP     -1,1                IN BUFFER                           $3IO24420
       LDQ     1,4                                                     $3IO24430
       NZT*    1,4                 IF ZERO-ZERO OUT                    $3IO24440
       TRA     *+4                 AND KILL SEEK                       $3IO24450
       LFT     200000              IF EOF                              $3IO24460
       TRA     *+3                 KILL SEEK OR                        $3IO24470
       TRA     *+4                 ELSE PROCEED                        $3IO24480
       STZ     1,4                                                     $3IO24490
       CAL     2,4                                                     $3IO24500
       STO     2,4                                                     $3IO24510
       TQP     SELM4               IF MQ + READ IS DONE                $3IO24520
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $3IO24530
       TRA     SELM3               GO POST WRITE COMPLETION            $3IO24540
SELM4  CAL     *+1                                                     $3IO24550
       XCA     **                  MQ = ADDRESS OF BUF CW              $3IO24560
       SXA     C8,1                                                    $3IO24570
       CAL     -1,1                PICK UP COUNT FROM FLAG             $3IO24580
 ER    AXT     **,1                                                    $3IO24590
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $3IO24600
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $3IO24610
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $3IO24620
       LFT     200000              IF EOF GO                           $3IO24630
       TSX     EOF,4               TAKE CARE OF IT                     $3IO24640
       CLA     4,2                 PICK UP AND                         $3IO24650
       PDC     0,4                 RESTORE THE                         $3IO24660
       CAL     1,4                 BUFFER SIZE                         $3IO24670
       ARS     4                   IN THE IORT                         $3IO24680
       STD     -1,1                NOW GO POST                         $3IO24690
       XEC     SELM5               READ COMPLETION                     $3IO24700
       TRA     POSTR+2             SOME JOB                            $3IO24710
EOF    ENB     L(0)                                                    $3IO24720
       LDQ     0,2                 EXCHANGE START AND                  $3IO24730
       CAL     6,2                 FINISH OF FILE                      $3IO24740
       LGL     18                  PUT A MINUS                         $3IO24750
       STD     0,2                 IN WORD SEVEN                       $3IO24760
       STA     6,2                 TO INDICATE SPECIAL                 $3IO24770
       CLS     6,2                 HANDLING NEEDED                     $3IO24780
       STO     6,2                 FOR NEXT DATA OPER.                 $3IO24790
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $3IO24800
       TRA     1,4                 GO HOME                             $3IO24810
DEOF1  NZT     1,4            IF LAST BUFFER                           $3IO24820
       TRA     PSTR6          DO NOTHING                               $3IO24830
       CAL*    1,4                 DISK OPERATIONS                     $3IO24840
       STZ*    1,4                 ARE DONE FOR NOW                    $3IO24850
       STA     1,4                 RESTORE REQUEST CHAIN               $3IO24860
       TRA     PSTR2               AS TAPE (UCB2)                      $3IO24870
FINREC LFT     200000              IOCS EOF                            $3IO24880
       TRA     DEOF                YES                                 $3IO24890
       CLA     1,4                                                     $3IO24900
       PAC     0,1            -L(COMMANDS)IN IR1                       $3IO24910
       CLA     L(STL               IF READ HAS FILLED                  $3IO24920
       ERA     1,1                 BUFFER AREA,GO BACK                 $3IO24930
       TNZ     *+3                 AS FINISHED RECORD                  $3IO24940
       LXA     S3+1,1                                                  $3IO24950
       TRA     SEOF+1                                                  $3IO24960
       CLA     1,1            PICK UP AND COUNT                        $3IO24970
       SXA     *+2,2                                                   $3IO24980
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $3IO24990
D7     AXT     **,2                RESTORE IR2                         $3IO25000
       CLA     1,4            READ OR WRITE                            $3IO25010
       TPL     D4                  READ                                $3IO25020
       CAL     6,2                 UPDATE NEXT TRACK                   $3IO25030
       ACL     L(2)                TO BE USED BY FILE                  $3IO25040
       ALS     18                  STORE IN FLAG WORD                  $3IO25050
       STD*    8,1                                                     $3IO25060
 D4    CAL     9,1                 PUT THE NEXT READ                    3IO25070
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (3)3IO25080
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (3)3IO25081
       LXA     D7,2         RESTORE                                  (3)3IO25082
       STA     9,1            COMMAND                                  $3IO25090
       SXA     *+2,1                                                   $3IO25100
       TSX     CKSEE,1        IS SEEK NECESSARY                        $3IO25110
       AXT     **,1           RESTORE IR1                              $3IO25120
       CLA     6,2            CREATE BCD CHARACTERS                    $3IO25130
       SXA     *+2,4          FOR THE NEXT PREPARE                     $3IO25140
       TSX     (DECVA,4       TO VERIFY COMMAND                        $3IO25150
       AXT     **,4                                                    $3IO25160
       CLA     6,2            GET REC LAB                              $3IO25170
       ADD     TRKC                UP TRACK COUNT                      $3IO25180
       SLW     6,2                 FOR RECORD                          $3IO25190
       ARS     6                   AND PUT IN                          $3IO25200
       STO     *+2            P.V. WORD                                $3IO25210
       TSX     (FDAMT,2                                                $3IO25220
       PZE                                                             $3IO25230
       PZE     15,1                                                    $3IO25240
       XEC     D7                                                      $3IO25250
       TSX     WCHK,4                                                  $3IO25260
       TRA     S3             RETURN TO IOEX                           $3IO25270
DERR   LNT     100                     INTERFACT CHECK                  3IO25280
       TRA     *+4                 NO                                  $3IO25290
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3IO25300
       SXA     CHATT-1,4           RETURN 2,4                          $3IO25310
       TRA     DCHG                                                    $3IO25320
       CLA     1,4                 GET COMMAND LIST ADDRESS            $3IO25330
       PAC     0,1                 FOR STZ OPERATION                   $3IO25340
       STO     .DERR                   SET UNUSUAL END FLAG             3IO25350
       STZ     1,4                 ZERO OUT REQUEST                    $3IO25360
       CLA     4,2                 GET BUFFER POOL                     $3IO25370
       PDC     0,4                 AND PLACE IT IN IR4                 $3IO25380
       CLA     0,1                 GET BUFFER IN USE                   $3IO25390
       STZ     ,1                  ZERO OUT COMMAND LIST               $3IO25400
       STZ     1,1                 CONTROL WORDS                       $3IO25410
DERG   PAC     0,1                 RESTORE                             $3IO25420
       STA     *-1                 IORT                                $3IO25430
       CLA     FCW                 AND                                 $3IO25440
       STP     1,1                 BUFFER                              $3IO25450
       CLA     1,4                 COUNT                               $3IO25460
       ARS     4                                                       $3IO25470
       STD     1,1                                                     $3IO25480
       CLA     DERG                                                    $3IO25490
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $3IO25500
       TRA     S3                  GO BACK                             $3IO25510
TRKC   OCT     010000000000                                            $3IO25520
TRKRC  OCT     007777777777                                            $3IO25530
SEOH   CLA     SIX                 SET EOF BIT ON                      $3IO25540
       STP     0,2                 FOR STRANGE EOF                     $3IO25550
       TRA     SEOF+1              FINISH READ                         $3IO25560
SEOFI  RIL     200000              TURN OFF                            $3IO25570
       STI     0,2                 STRANGE EOF                         $3IO25580
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *3IO25590
       TRA     SELM2                                                   *3IO25600
       TTL     SELECT PLUS FOR 7909 CHANNEL                             3IO25610
DRWRS  CLA     1,4                                                      3IO25620
       PAX     0,1                 IF THIS IS A LIST WORD               3IO25630
       TXL     *+2,1,LCOMAD-1     FOR NOPOOL OPTION                  (6)3IO25635
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        3IO25640
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             3IO25650
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     3IO25660
       TZE     *+3                                                      3IO25670
       TIX     *-2,1,COMADL-LCOMAD                                      3IO25680
       TRA     DER1                                                     3IO25690
       PXA     0,1                                                      3IO25700
       SUB     DRWRX                                                    3IO25710
       PAC     0,1                                                     $3IO25720
       STA     DRWRS1-2            SAVE LIST ADDRESS                   $3IO25730
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          3IO25740
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  3IO25750
       CLA*    1,4                 GET BUFFERS AHEAD                   $3IO25760
       STD     0,1                                                      3IO25770
       CLA     DRWRS1-2            PICK UP LIST ADDRESS AND             3IO25780
       STA     1,4                 PUT IT IN UCW 2                      3IO25790
       CLA     1,4                                                     $3IO25800
DRWRW  LXA     S3+1,1              RESTORE IR 1                         3IO25810
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         3IO25820
       TPL     *+2                 READ                                $3IO25830
       ACL     L(3)                WRITE                               $3IO25840
       STA*    (RCHXI              SET START CHAN INST                 $3IO25850
       ZET*    (URRXI              FIRST TIME THRU                     $3IO25860
       TRA     C3                  NO                                  $3IO25870
       LXA     CHATT-1,1           WAS CHANNEL                         $3IO25880
       SXA     CHATT-1,0           LIST SET UP                         $3IO25890
       TXH     C3,1,0              YES                                 $3IO25900
       STA     C7                                                      $3IO25910
       CLA     1,4                 ADDRESS OF COMMD                    $3IO25920
       PAC     0,1                 LIST TO IR1                         $3IO25930
       ZET     1,1                 PARTIAL RECORD                      $3IO25940
       TRA     C3                  YES START CHANNEL                   $3IO25950
       TPL     DRWRS1              IF READ                             $3IO25960
       CAL     3,2                                                     $3IO25970
       ACL     1DEC                UP BLOCK COUNT                      $3IO25980
       STD     3,2                                                     $3IO25990
       LNT     BLKSEQ                                                  $3IO26000
       TRA     DRWRS1              NO BLOCK SEQ                        $3IO26010
       ARS     18                                                      $3IO26020
       XCA                    SAVE COUNT                               $3IO26030
       CLA*    1,4            LOC OF BUF TO BE USED                    $3IO26040
       ACL     L(1)                                                    $3IO26050
       STA     *+2                                                     $3IO26060
       XCA     **                  RESTORE COUNT                       $3IO26070
       STA*    **                  (L) OF LAST WORD OF BUF             $3IO26080
DRWRS1 CLA     L(6)                BCD MODE                            $3IO26090
       LNT     MODE                                                    $3IO26100
       CLA     L(22)               BINARY MODE                         $3IO26110
C7     STA     **                  ADDRESS OF SMS                      $3IO26120
       CLA     0,1            ADDRESS OF BUFFER                        $3IO26130
       ACL     L(1)                                                    $3IO26140
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $3IO26150
       ACL     L(1)                                                    $3IO26160
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $3IO26170
       CLA*    8,1            PICK UP COUNT                            $3IO26180
       ARS     18                  MOVE COUNT OVER                     $3IO26190
       ANA     ADDRS               MASK ALL BUT ADDRESS                $3IO26200
       SXA     *+2,2                                                   $3IO26210
       TSX     SIZE,2         CHECK RECORD SIZE                        $3IO26220
C9     AXT     **,2                                                    $3IO26230
       CAL     6,2                 CREATE BCD CHARACTER                $3IO26240
       ANA     TRKRC               CHANGE THE TRACK                    $3IO26250
       ADD     TRKC                COUNT TO ONE FOR RECORD             $3IO26260
       SLW     6,2                 PUT BACK TO FCB                     $3IO26270
       SXA     *+2,4          FOR PV COMMAND                           $3IO26280
       TSX     (DECVA,4                                                $3IO26290
C2     AXT     **,4                                                    $3IO26300
       CAL     6,2                 GET SEEK ADDRESS                    $3IO26310
       ADD     L(1)                                                    $3IO26320
       ALS     18                  MOVE SEEK ADDRESS OVER              $3IO26330
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $3IO26340
       CAL     6,2                 LABEL FOR                           $3IO26350
       ARS     6                   RECORD ADDRESS                      $3IO26360
       STO     *+2                                                     $3IO26370
       TSX     (FDAMT,2       PLACE P.V. COMMAND                       $3IO26380
       PZE                    BITS IN PROPER PLACE                     $3IO26390
       PZE     15,1                                                    $3IO26400
       XEC     C9                  RESTORE IR2                         $3IO26410
       CLA     *-3                 SET INTERFACE BIT                   $3IO26420
       ANA     L(1)                ON FOR SMS INST.                    $3IO26430
       ORS*    C7                                                      $3IO26440
       TSX     WCHK,4         CHECK FOR WRITE CHECK                    $3IO26450
C3     XEC     S3+1                RESTORE IR1                         $3IO26460
       CAL     0,2                 IS THERE A STRANGE                  $3IO26470
       ALS     1                   EOF ON THIS FILE -                  $3IO26480
       PBT                                                             $3IO26490
       TRA     S3-1                NO                                  $3IO26500
       XEC     C2                  YES - RESTORE XR4                   $3IO26510
       CLA*    1,4                 YES                                 $3IO26520
       ACL     L(1)                GET FLAG WORD                       $3IO26530
       STA     DRWRS2              ADDRESS AND SAVE                    $3IO26540
       CAL     6,2                 GET SEEK ADDRESS                    $3IO26550
       SUB     L(1)                MINUS 1 AND STORE                   $3IO26560
       STA     3,4                 IN UCB 4 AND FCB 7                  $3IO26570
       STA     6,2                                                     $3IO26580
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $3IO26590
       AXT     SYSTWT,2            START CHANNEL                       $3IO26600
       PXA     0,2                 FOR A                               $3IO26610
       STA*    (RCHXI              TRAP                                $3IO26620
       TRA     S3-1                GO                                  $3IO26630
       BES     MSEL+NOCH/NOCH**-NOCH/NOCH*MSEL-*                        3IO26640
LCOMAD PZE                         CHAIN TO BUFFERS                    $3IO26650
       PZE                         COUNT FOR MULTI TRACK RECORD        $3IO26660
       SMS     **                  SET MODE FOR READ                   $3IO26670
       CTLR    *+12                PREPARE DISK FOR READ               $3IO26680
       TCH     *+4                 GO DO DATA MOVEMENT                 $3IO26690
       SMS     **                  SET MODE FOR WRITE                  $3IO26700
       LCC     0                   COUNTER FOR WRITE CHECK             $3IO26710
       CTLW    *+8                 PREPARE DISK FOR WRITE              $3IO26720
       CPYP    **,,1               FLAG WORD MOVEMENT                  $3IO26730
       CPYP    **,,**              DATA MOVEMENT                       $3IO26740
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $3IO26750
       TDC     *+2                 CHECK FOR WRITE CHECK               $3IO26760
       TCH     SYSTWT              INTERUPT CPU                        $3IO26770
       CTLW    *+4                 PREPARE FOR WRITE CHECK             $3IO26780
       TCH     *-6                 GO DO WRITE CHECK                   $3IO26790
       DVTA    ,,                                                      $3IO26800
       DWRC    ,,                                                      $3IO26810
COMADL PZE                                                             $3IO26820
       PZE                                                             $3IO26830
       SMS     **                                                      $3IO26840
       CTLR    *+12                                                    $3IO26850
       TCH     *+4                                                     $3IO26860
       SMS     **                                                      $3IO26870
       LCC     0                                                       $3IO26880
       CTLW    *+8                                                     $3IO26890
       CPYP    **,,1                                                   $3IO26900
       CPYP    **,,**                                                  $3IO26910
       CPYD    0,,0                                                    $3IO26920
       TDC     *+2                                                     $3IO26930
       TCH     SYSTWT                                                  $3IO26940
       CTLW    *+4                                                     $3IO26950
       TCH     *-6                                                     $3IO26960
       DVTA    ,,                                                      $3IO26970
       DWRC    ,,                                                      $3IO26980
       PZE                                                             $3IO26990
       PZE                                                             $3IO27000
       SMS     **                                                      $3IO27010
       CTLR    *+12                                                    $3IO27020
       TCH     *+4                                                     $3IO27030
       SMS     **                                                      $3IO27040
       LCC     0                                                       $3IO27050
       CTLW    *+8                                                     $3IO27060
       CPYP    **,,1                                                   $3IO27070
       CPYP    **,,**                                                  $3IO27080
       CPYD    0,,0                                                    $3IO27090
       TDC     *+2                                                     $3IO27100
       TCH     SYSTWT                                                  $3IO27110
       CTLW    *+4                                                     $3IO27120
       TCH     *-6                                                     $3IO27130
       DVTA    ,,                                                      $3IO27140
       DWRC    ,,                                                      $3IO27150
       PZE                                                             $3IO27160
       PZE                                                             $3IO27170
       SMS     **                                                      $3IO27180
       CTLR    *+12                                                    $3IO27190
       TCH     *+4                                                     $3IO27200
       SMS     **                                                      $3IO27210
       LCC     0                                                       $3IO27220
       CTLW    *+8                                                     $3IO27230
       CPYP    **,,1                                                   $3IO27240
       CPYP    **,,**                                                  $3IO27250
       CPYD    0,,0                                                    $3IO27260
       TDC     *+2                                                     $3IO27270
       TCH     SYSTWT                                                  $3IO27280
       CTLW    *+4                                                     $3IO27290
       TCH     *-6                                                     $3IO27300
       DVTA    ,,                                                      $3IO27310
       DWRC    ,,                                                      $3IO27320
       PZE                                                             $3IO27330
       PZE                                                             $3IO27340
       SMS     **                                                      $3IO27350
       CTLR    *+12                                                    $3IO27360
       TCH     *+4                                                     $3IO27370
       SMS     **                                                      $3IO27380
       LCC     0                                                       $3IO27390
       CTLW    *+8                                                     $3IO27400
       CPYP    **,,1                                                   $3IO27410
       CPYP    **,,**                                                  $3IO27420
       CPYD    0,,0                                                    $3IO27430
       TDC     *+2                                                     $3IO27440
       TCH     SYSTWT                                                  $3IO27450
       CTLW    *+4                                                     $3IO27460
       TCH     *-6                                                     $3IO27470
       DVTA    ,,                                                      $3IO27480
       DWRC    ,,                                                      $3IO27490
       PZE                                                             $3IO27500
       PZE                                                             $3IO27510
       SMS     **                                                      $3IO27520
       CTLR    *+12                                                    $3IO27530
       TCH     *+4                                                     $3IO27540
       SMS     **                                                      $3IO27550
       LCC     0                                                       $3IO27560
       CTLW    *+8                                                     $3IO27570
       CPYP    **,,1                                                   $3IO27580
       CPYP    **,,**                                                  $3IO27590
       CPYD    0,,0                                                    $3IO27600
       TDC     *+2                                                     $3IO27610
       TCH     SYSTWT                                                  $3IO27620
       CTLW    *+4                                                     $3IO27630
       TCH     *-6                                                     $3IO27640
       DVTA    ,,                                                      $3IO27650
       DWRC    ,,                                                      $3IO27660
       PZE                                                             $3IO27670
       PZE                                                             $3IO27680
       SMS     **                                                      $3IO27690
       CTLR    *+12                                                    $3IO27700
       TCH     *+4                                                     $3IO27710
       SMS     **                                                      $3IO27720
       LCC     0                                                       $3IO27730
       CTLW    *+8                                                     $3IO27740
       CPYP    **,,1                                                   $3IO27750
       CPYP    **,,**                                                  $3IO27760
       CPYD    0,,0                                                    $3IO27770
       TDC     *+2                                                     $3IO27780
       TCH     SYSTWT                                                  $3IO27790
       CTLW    *+4                                                     $3IO27800
       TCH     *-6                                                     $3IO27810
       DVTA    ,,                                                      $3IO27820
       DWRC    ,,                                                      $3IO27830
       PZE                                                             $3IO27840
       PZE                                                             $3IO27850
       SMS     **                                                      $3IO27860
       CTLR    *+12                                                    $3IO27870
       TCH     *+4                                                     $3IO27880
       SMS     **                                                      $3IO27890
       LCC     0                                                       $3IO27900
       CTLW    *+8                                                     $3IO27910
       CPYP    **,,1                                                   $3IO27920
       CPYP    **,,**                                                  $3IO27930
       CPYD    0,,0                                                    $3IO27940
       TDC     *+2                                                     $3IO27950
       TCH     SYSTWT                                                  $3IO27960
       CTLW    *+4                                                     $3IO27970
       TCH     *-6                                                     $3IO27980
       DVTA    ,,                                                      $3IO27990
       DWRC    ,,                                                      $3IO28000
       PZE                                                             $3IO28010
       PZE                                                             $3IO28020
       SMS     **                                                      $3IO28030
       CTLR    *+12                                                    $3IO28040
       TCH     *+4                                                     $3IO28050
       SMS     **                                                      $3IO28060
       LCC     0                                                       $3IO28070
       CTLW    *+8                                                     $3IO28080
       CPYP    **,,1                                                   $3IO28090
       CPYP    **,,**                                                  $3IO28100
       CPYD    0,,0                                                    $3IO28110
       TDC     *+2                                                     $3IO28120
       TCH     SYSTWT                                                  $3IO28130
       CTLW    *+4                                                     $3IO28140
       TCH     *-6                                                     $3IO28150
       DVTA    ,,                                                      $3IO28160
       DWRC    ,,                                                      $3IO28170
       PZE                                                             $3IO28180
       PZE                                                             $3IO28190
       SMS     **                                                      $3IO28200
       CTLR    *+12                                                    $3IO28210
       TCH     *+4                                                     $3IO28220
       SMS     **                                                      $3IO28230
       LCC     0                                                       $3IO28240
       CTLW    *+8                                                     $3IO28250
       CPYP    **,,1                                                   $3IO28260
       CPYP    **,,**                                                  $3IO28270
       CPYD    0,,0                                                    $3IO28280
       TDC     *+2                                                     $3IO28290
       TCH     SYSTWT                                                  $3IO28300
       CTLW    *+4                                                     $3IO28310
       TCH     *-6                                                     $3IO28320
       DVTA    ,,                                                      $3IO28330
       DWRC    ,,                                                      $3IO28340
ENDLIS BES     LCOMAD+NOCH*19-*                                        $3IO28350
       TTL 0                                                           $3IO28360
*              THIS SETS UP FOR A WRITE CHECK                          $3IO28370
*              TSX WCHK,4                                              $3IO28380
*              RETURN                                                  $3IO28390
*                                                                      $3IO28400
WCHK   CLA     0,2                                                     $3IO28410
       TMI     *+3            WRITE CHECK NEC.                         $3IO28420
       PXA     0,0                 PUT ZERO IN LCC                     $3IO28430
       TRA     STCC                                                    $3IO28440
       CAL     15,1                PUT THE PREPARE                     $3IO28450
       ANA     L(DWRC         TO VERIFY IN THE                         $3IO28460
       ORA     LDWRC                                                   $3IO28470
       SLW     17,1                WRITE CHECK ORDER                   $3IO28480
       CLA     16,1                                                    $3IO28490
       STO     18,1                                                    $3IO28500
       CLA     L(1)                PUT ONE IN LCC                      $3IO28510
STCC   STA     6,1                                                     $3IO28520
       TRA     1,4            RETURN                                   $3IO28530
*                                                                      $3IO28540
*              TSX CKSEE,1                                             $3IO28550
*              RETURN                                                  $3IO28560
*                                                                      $3IO28570
*                                                                      $3IO28580
CKSEE  CAL     6,2            UPDATE SEEK                              $3IO28590
       ACL     L(4)                                                    $3IO28600
       ERA     7,2            ADDRESS                                  $3IO28610
       ANA     ADDRS                                                   $3IO28620
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $3IO28630
       TXH     D9,1,-TEMIND                                            $3IO28640
       CAL     6,2                                                     $3IO28650
       ADD     L(1)                                                    $3IO28660
       STA     6,2            NEXT ADDRESS FOR SEEK                    $3IO28670
       CAL     3,4                                                     $3IO28680
       ADD     L(1)                                                    $3IO28690
       STA     3,4                 UPDATE SEEK ADDRESS                 $3IO28700
       ERA     6,2                 SAME ARM POSITION                   $3IO28710
       ANA     ADDRS               AS DESIRED                          $3IO28720
       TZE     D8                  YES                                 $3IO28730
D9     CAL     6,2                 NO, PUT DESIRED                     $3IO28740
       STA     3,4                 POSITION IN REQUEST                 $3IO28750
       TRA     D6                  AND ASK FOR SEEK                    $3IO28760
D8     CLA     3,4                 GET POSITION AND                    $3IO28770
       ANA     ADDRS          CHECK IF ANOTHER                         $3IO28780
       XCA                    SEEK NEC. NOW                            $3IO28790
       PXA     0,0                                                     $3IO28800
       DVP     L(40)                                                   $3IO28810
       TNZ     1,1            RETURN IF NO SEEK                        $3IO28820
D6     CLS     2,4            SET 3RD UCW TO                           $3IO28830
       STO     2,4            DEMAND A SEEK                            $3IO28840
       TRA     1,1                                                     $3IO28850
*                                                                      $3IO28860
*              COUNT IN ACC                                            $3IO28870
*              TSX SIZE,2                                              $3IO28880
*              RETURN                                                  $3IO28890
*                                                                      $3IO28900
 SIZE  SXA     C11,2        SAVE IR2                                 (3)3IO28910
       XCA                  SAVE COUNT                               (3)3IO28920
       CAL     0,4          UCW1                                     (3)3IO28930
       ARS     6            MOVE AND                        7=1302   (3)3IO28940
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (3)3IO28950
       PDX     0,2          DEVICE TO IR2                   1=1301   (3)3IO28960
 SVCOD XCA     **           RESTORE COUNT IN AC. INST ADDR SAVES CODE(3)3IO28970
       TIX     *+1,2,5      IF 1302,MAKE CODE A 2                    (3)3IO28980
       SXA     *-2,2        SAVE THE CODE                            (3)3IO28990
       SUB     L(STL,2      SUB FULL TRACK FROM WORD COUNT           (3)3IO29000
       TMI     D1           LESS THAN OR                             (3)3IO29010
       TZE     D1           EQUAL TO FULL TRACK TRA TO D1            (3)3IO29020
       STA     1,1          SAVE EXTRA WORD COUNT                    (3)3IO29030
       CLA     L(STL,2      GET FULL TRACK                           (3)3IO29040
 C1    SLW*    8,1          PUT IN FLAG WORD                         (3)3IO29050
       ALS     18           PUT COUNT IN                             (3)3IO29060
       STD     9,1          COPY COMMAND                             (3)3IO29070
 C11   AXT     **,2         PREPARE TO RETURN                        (3)3IO29080
       TRA     1,2          RETURN                                   (3)3IO29090
D1     ADD     L(STL,2      GET COUNT BACK                           (3)3IO29100
       STL     1,1          MAKE FALSE COUNT                         (3)3IO29110
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (3)3IO29120
       TXI     C1,0,7       FINISH UP                                (3)3IO29130
 ENTRK CLA     TRKRC        SET END OF TRACK                         (3)3IO29140
       STT     6,2          INDICATION IN FCW7                       (3)3IO29150
       TRA     CKSEE+5      AND RETURN                               (3)3IO29160
       PZE     524          7320 DRUM TRACKSIZE                      (3)3IO29170
       PZE     969          1302 DISK TRACKSIZE                      (3)3IO29171
       PZE     465          1301 DISK TRACKSIZE                      (3)3IO29172
L(STL  PZE     D2           LOCATION OF STL FOR LATER COMPARE        (3)3IO29173
       BES     WCHK+NOCH/NOCH**-NOCH/NOCH*WCHK-*                        3IO29180
HBEG   SMS     **                  SET INTERFACE                       $3IO29190
       LIPT    *+1                 LEAVE INTERUPT STATUS               $3IO29200
       CTLR    *+7                 SELECT FOR READ                     $3IO29210
       TCH     *+3                 DO IO                               $3IO29220
       SMS     **                  SET INTERFACE                       $3IO29230
       CTLW    *+4                 SELECT FOR WRITE                    $3IO29240
       CPYP    **,,**              DO IO                               $3IO29250
       CPYD    0,,0                                                    $3IO29260
       TCH     SYSTWT              INTERUPT                            $3IO29270
       OCT     120600120112        HSEL AND EOS                        $3IO29280
HLIS   SMS     **                                                      $3IO29290
       LIPT    *+1                                                     $3IO29300
       CTLR    *+7                                                     $3IO29310
       TCH     *+3                                                     $3IO29320
       SMS     **                                                      $3IO29330
       CTLW    *+4                                                     $3IO29340
       CPYP    **,,**                                                  $3IO29350
       CPYD    0,,0                                                    $3IO29360
       TCH     SYSTWT                                                  $3IO29370
       OCT     120600120112                                            $3IO29380
       SMS     **                                                      $3IO29390
       LIPT    *+1                                                     $3IO29400
       CTLR    *+7                                                     $3IO29410
       TCH     *+3                                                     $3IO29420
       SMS     **                                                      $3IO29430
       CTLW    *+4                                                     $3IO29440
       CPYP    **,,**                                                  $3IO29450
       CPYD    0,,0                                                    $3IO29460
       TCH     SYSTWT                                                  $3IO29470
       OCT     120600120112                                            $3IO29480
       SMS     **                                                      $3IO29490
       LIPT    *+1                                                     $3IO29500
       CTLR    *+7                                                     $3IO29510
       TCH     *+3                                                     $3IO29520
       SMS     **                                                      $3IO29530
       CTLW    *+4                                                     $3IO29540
       CPYP    **,,**                                                  $3IO29550
       CPYD    0,,0                                                    $3IO29560
       TCH     SYSTWT                                                  $3IO29570
       OCT     120600120112                                            $3IO29580
HEND   BES     HBEG+NOHYP*10-*                                         $3IO29590
       PZE     HEND                                                    $3IO29600
       TTL     SELECT ROUTINES FOR HYPER                                3IO29610
HYPL   CLA     3,4                 IF REINSTRUCT                       $3IO29620
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $3IO29630
       AXT     HEND-HBEG,1         FIND CH. LIST POINTER               $3IO29640
       SXA     HSXA,1              SAVE CH. LIST POINTER               $3IO29650
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $3IO29660
       ANA     DECRE               THIS CHANNEL TO USE                 $3IO29670
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $3IO29680
       ARS     18                                                      $3IO29690
       SUB     S3+1                                                    $3IO29700
       ANA     ADDRS                                                   $3IO29710
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $3IO29720
       TIX     HYPL+3,1,HLIS-HBEG                                      $3IO29730
       TRA     DER1                                                    $3IO29740
       LXA     S3+1,1              GET CHANNEL NO                      $3IO29750
       PXD     0,1                                                     $3IO29760
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $3IO29770
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $3IO29780
       PXA     0,1                 COMPUTE THE                         $3IO29790
       SUB     HEND                CHANNEL LIST                        $3IO29800
       STA     HSXA                START ADDRESS                       $3IO29810
       CLA     1,4                                                     $3IO29820
       ACL     L(1)                                                    $3IO29830
       LXA     S3+1,1                                                  $3IO29840
       TMI     S4                  OUTPUT                              $3IO29850
       STA     S0                  SAVE ADDRESS OF IORT                $3IO29860
       ACL     L(1)                PUT LOCATION OF                     $3IO29870
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $3IO29880
       STA     6,1                 ADDRESS FOR START CH.               $3IO29890
       XCA                         SAVE READ OR WRITE                  $3IO29900
       CLA*    S0                  GET NO. OF WORDS                    $3IO29910
       STD     6,1                 STORE IN COPY                        3IO29920
       RNT     400000              READ BACKWARD                        3IO29930
       TRA     *+4                 NO                                   3IO29940
       ARS     18                  PUT LAST LOCATION                    3IO29950
       ACL     S0                  OF BUFFER IN                         3IO29960
       STA     6,1                 COPY COMMAND                         3IO29970
       CLA     3,4                 IS THIS A REINSTRUCT                 3IO29980
       TZE     HNSL                NO                                   3IO29990
       CLA     HYCLN               TURN OFF THE                         3IO30000
       ORS     2,1                 CONTROL OPERATION                    3IO30010
       ORS     5,1                                                      3IO30020
       LXA     S3+1,1                                                   3IO30030
       NZT*    (URRXI              IF NO ERROR                          3IO30040
       TRA     S3-1                START CHANNEL                        3IO30050
HNSL   CAL     HSXA                SMS ADDRESS                         $3IO30060
       STA     3,4                 SAVE CH LIST IN UCW4                $3IO30070
       TQP     *+2                 READ                                 3IO30080
       ADD     L(4)                WRITE                               $3IO30090
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $3IO30100
       STA*    (RCHXI              START CHANNEL ADDRESS               $3IO30110
       ZET*    (URRXI              BACK ON ERROR CONDITION             $3IO30120
       TRA     S3-1                YES, START CHANNEL                  $3IO30130
       CLA     CHATT-1             IF RETURN FROM                      $3IO30140
       ANA     ADDRS               SEL-WITH INTERFACE                  $3IO30150
       SXA     CHATT-1,0           NOT READY, THEN                     $3IO30160
       TNZ     S3-1                JUST TRY AGAIN                      $3IO30170
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $3IO30180
       CLA     0,4                 SAVE UNIT                           $3IO30190
       ANA     DEC15               NO. IN SEL ORDER                    $3IO30200
       ORA     HYSEL                                                   $3IO30210
       RFT     400000              IS THIS READ BACKWARD               $3IO30220
       ORA     L(64D)              YES, FIX SEL ORDER                  $3IO30230
       STD     9,1                                                     $3IO30240
       CLA     HYCTL               SET CONTROL                         $3IO30250
       ANS     2,1                 OPERATION ON                        $3IO30260
       ANS     5,1                                                     $3IO30270
       CLA     HSMSN               SET UP SMS COMMAND                  $3IO30280
       LNT     004000              IF OFF BCD MODE                     $3IO30290
       ORA     L(22)                                                   $3IO30300
       RFT     400000                                                  $3IO30310
       ORA     HSMSR               BACKWARD READ                       $3IO30320
       LDI     0,4                 PUT THE                             $3IO30330
       LFT     40                  INTERFACE                           $3IO30340
       ORA     L(1)                IN SMS                              $3IO30350
       STA     0,1                                                     $3IO30360
       STA     4,1                                                     $3IO30370
       LXA     S3+1,1                                                  $3IO30380
       TRA     S3-1                                                    $3IO30390
       TTL     SELECT MINUS FOR HYPER                                   3IO30400
HSELM  CLA     1,4                 UCW 2 TO AC                         $3IO30410
       ACL     L(1)                IORT ADDRESS OF BUF                 $3IO30420
       STA     HIORT                                                   $3IO30430
       ACL     L(1)                                                    $3IO30440
       LFT     7100                ERROR                               $3IO30450
       TRA     HEROR               YES                                 $3IO30460
       ALS     18                  DEC= 1ST WORD WRITTEN               $3IO30470
       STD     COMM                SAVE AS 76O7 CH.                    $3IO30480
HIORT  CLA     **                  LAST WORD WRITTEN                   $3IO30490
       STA     COMM                SAVE AS 7607 CH.                    $3IO30500
HRETN  CAL     S3                  FIX EXIT                            $3IO30510
       SUB     L(1)                FOR CONTINUED                       $3IO30520
       STA     S3                  PRIORITY ON UNIT                    $3IO30530
       CLA     1,2                 IF MIXED MODE                       $3IO30540
       TPL     SELM1               GO HANDEL IT                        $3IO30550
       STZ     3,4                 MAKE REINSTRUCT                     $3IO30560
       TRA     MXMOD+3             IMPOSSIBLE                          $3IO30570
HSMRD  LDI     FOR                 GOOD READ                           $3IO30580
       LDQ     COMM                MAKE COMM LOOK                      $3IO30590
       LGL     18                  LIKE 7607 CHANNEL                   $3IO30600
       SLW     COMM                                                    $3IO30610
       ANA     ADDRS                                                   $3IO30620
       LDQ     1,4                                                     $3IO30630
       RQL     1                   TYPE READ                           $3IO30640
       TQP     HREAD               READ FORWARD                        $3IO30650
       LNT     200000              END OF FILE TEST                    $3IO30660
       TNZ     *+2                 IF LONG LENGTH RECORD               $3IO30670
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $3IO30680
       ACL     L(1)                ELSE IT POINTS AT LAST              $3IO30690
       STA     COMM                WORD READ                           $3IO30700
HREAD  TNZ     HRETN                                                   $3IO30710
       CAL     COMM                MAKE IT POINT AT                    $3IO30720
       ADD*    HIORT               LAST REC IN BUFF+1                  $3IO30730
       ARS     18                  IF LONG RECORD READ                 $3IO30740
       TRA     HREAD-1                                                 $3IO30750
HEROR  RFT     377777              NCI INTERRUPT                       $3IO30760
       TRA     *+2                 NO                                  $3IO30770
       TRA     HSMRD               YES                                 $3IO30780
       LNT     100                 INTERFACE CHECK                     $3IO30790
       TRA     *+4                 NO                                  $3IO30800
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3IO30810
       SXA     CHATT-1,4           RETURN 2,4                          $3IO30820
       TRA     DCHG                                                    $3IO30830
       RFT     020014                                                  $3IO30840
       TRA     HYSEL+1             EOT, EOF, BOT                       $3IO30850
       LDI     1,4                                                     $3IO30860
       LFT     400000                                                  $3IO30870
       TRA     *+3                 WRITE ERROR                         $3IO30880
       LDI     1PRE                READ ERROR                          $3IO30890
       TRA     HSMRD+1             GO POST                             $3IO30900
       CAL     S3                                                      $3IO30910
       SUB     L(2)                CHANGE EXIT                         $3IO30920
       STO     S3                  TO 3,4                              $3IO30930
       CLA*    (URRXI              UPDATE ERROR                        $3IO30940
       ACL     5,2                                                     $3IO30950
       SLW     5,2                 HISTORY AND TRY                     $3IO30960
       TRA     S3                  TO WRITE AGAIN                      $3IO30970
HSMSR  OCT     000000000040        CONSTANTS                           $3IO30980
HSMSN  OCT     000000000106        FOR                                 $3IO30990
HYCTL  OCT     757777777777        HYPER                               $3IO31000
HYCLN  OCT     020000000000        SELECT                              $3IO31010
HYSEL  OCT     120600120112                                            $3IO31020
       LDI     SIX                                                     $3IO31030
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE              3IO31040
       TPL     HSMRD+1             READ EOF                            $3IO31050
       TRA     HIORT-2             WRITE EOT                           $3IO31060
       BES     HBEG+NOHYP/NOHYP**-NOHYP/NOHYP*HBEG-*                   $3IO31070
DER1   STL     .DERR                                                    3IO31080
       STZ     1,4                 ZERO OUT UCW2                       $3IO31090
       TRA     DCHG                RETURN 2,4                          $3IO31100
       BES     *-3+NOCHX/NOCHX*3-*                                      3IO31110
       TTL                         BTP (BUFFER TO POOL) ROUTINE         3IO31120
*              TSX BTP,1                                                3IO31130
       SPACE   1                                                        3IO31140
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           3IO31150
*              MQ                  TSX BTP1,1                           3IO31160
       SPACE   1                                                        3IO31170
BTP1   XCA                         L(BUF. IN USE IN AC                 $3IO31180
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $3IO31190
       STA     0,4                 PUT BUF IN USE BACK                 $3IO31200
       XCA                         BUF FROM CHAIN IN AC                $3IO31210
       STZ*    0,4                 ZERO IN BUF CW                      $3IO31220
       STA*    0,4                 ADDRESS OF CHAIN                    $3IO31230
       TRA     1,1                                                      3IO31240
       SPACE   1                                                        3IO31250
*                      URC (UPDATE REQUEST CHAIN)                       3IO31260
*                       IR4 = -L(UCW) TSX URC1,1                        3IO31270
       SPACE   1                                                        3IO31280
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $3IO31290
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $3IO31300
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $3IO31310
       NZT*    1,4                 LOC OF ZERO                         $3IO31320
       TRA     *+3                                                      3IO31330
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $3IO31340
       TRA     1,1                                                      3IO31350
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $3IO31360
       TRA     1,1                                                      3IO31370
       TTL     NON-DATA OPERATION CHECK FOR DISK                        3IO31380
*                                                                       3IO31390
D7909  AXT     **,4                                                    *3IO31400
       TRA     (NDSLX                                                $5$3IO31401
SVDID  PZE     **                                                      *3IO31410
       SXA     D7909,4                                                 *3IO31420
       CLA     1,4                                                   $5$3IO31421
       PDX     0,4                                                   $5$3IO31422
       CLA     5,2                                                     *3IO31430
       TMI     7KA                 1301                                *3IO31440
       ANA     SIX                                                     *3IO31450
       TZE     D7909                                                 $5$3IO31460
 HNDS  TXL     HND2,4,2                                              $5$3IO31490
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *3IO31500
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *3IO31510
       TNX     *+4,4,31            FOLLOWING ORDERS                    *3IO31520
       TXI     *+1,4,33            RWD,RUN                             *3IO31530
       TNX     *+2,4,35            BSR,BSF                             *3IO31540
       TXI     *+1,4,32            WTM                                 *3IO31550
HND1   SXD     *+2,4                                                   *3IO31560
       TSX     (NDSLX,4                                                *3IO31570
       PZE     0,2,**                                                  *3IO31580
HND2   LXA     D7909,4                                                 *3IO31590
       TRA     2,4                                                     *3IO31600
       BES     HNDS+NOHYP/NOHYP**-NOHYP/NOHYP*HNDS-*                    3IO31610
  7KA  TXL     DNDSEL+1,4,2                                          $5$3IO31611
       STI     SVDID                                                 $5$3IO31620
       STZ     TEMP                                                     3IO31630
       LDQ     6,2                 CHECK FOR EOF                      *$3IO31640
       TQP     7KAA          NO                                      $5$3IO31650
       STL     TEMP                                                     3IO31660
       SXA     *+2,4                                                 $5$3IO31661
       TSX     EOF,4               YES                                 $3IO31670
       AXT     **,4                                                  $5$3IO31680
 7KAA  ENB     TRAPS                                                 $5$3IO31690
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $3IO31730
       TXH     DWEF,4,5            BSF-6 WEF-7                         $3IO31740
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $3IO31750
       ZET     TEMP                                                     3IO31760
       TRA     7KB                                                      3IO31770
       CAL     7,2                 GET BOT. AND                         3IO31780
       ARS     18                  TEST IF POSITION                    $3IO31790
       SBM     6,2                 NOW, IS SAME                        $3IO31800
       ANA     ADDRS               IF SO                               $3IO31810
       TZE     DNDSEL              NO BACKSPACE - NOP                  $3IO31820
7KB    PXA     0,0                 NO. OF TRACKS IN RECORD              3IO31830
       LLS     5                   DEDUCT TRACKS                       $3IO31850
       SUB     6,2                 AND PUT IT BACK                     $3IO31860
       STA     6,2                 FOR NEXT SEEK                       $3IO31870
DNDSEL XEC     DIND                PLACE BACK AND                      $3IO31880
       LXA     D7909,4             RETURN                              $3IO31890
       TRA     2,4                                                     $3IO31900
DNDNOP LXA     D7909,4                                                 $3IO31910
DIND   LDI     SVDID                                                  *$3IO31920
       TRA     SEL9                                                     3IO31930
NDSEL  EQU     SVDID                                                   $3IO31940
DWEF   SXA     DWEF1,4                                                 $3IO31950
       SXA     DWEF1+1,1                                               $3IO31960
       TXL     DBSF,4,6            BSF                                 $3IO31970
DBSF1  AXC     1,4                                                     $3IO31980
       CLA*    0,2                 GET 2ND WORD OF UCB                 $3IO31990
       TNZ     *-1                 WAIT FOR LAST WRITE                 $3IO32000
       ENB     L(0)                                                    $3IO32010
       CLA     6,2                                                     $3IO32020
       ANA     DECRE                                                   $3IO32030
       ARS     6                                                       $3IO32040
       STO     DSMSB                                                   $3IO32050
       SXA     DWEF6,2                                                 $3IO32060
       CLA     1,2                 TEST MODE                           $3IO32070
       ANA     MODBT                                                    3IO32080
       TZE     *+3                 BCD MODE                             3IO32090
       CLA     L(6)                BINARY MODE                          3IO32100
       TRA     *+2                                                      3IO32110
       CLA     L(22)                                                    3IO32120
       ORS     DSMSB                                                    3IO32130
       CLA     0,2                 GET UCB ADDRESS                     $3IO32140
       STA     DAXC                                                    $3IO32150
       CLA     6,2                                                     $3IO32160
       TSX     (DECVA,4                                                $3IO32170
DAXC   AXC     **,4                'L(UCB)                             $3IO32180
       CLS     2,4                 REQUEST SEEK                        $3IO32190
       STO     2,4                 WITH MINUS SIGN                     $3IO32200
       CLA     6,2                 AND CORRECT                         $3IO32210
       STA     3,4                                                     $3IO32220
       TSX     (FDAMT,2            IOEX ROUTINE TO SET ORDER           $3IO32230
DSMSB  BCI     1,00I006                                                $3IO32240
       PZE     DVTA                                                    $3IO32250
DWEF6  AXT     **,2                L(FCB)                              $3IO32260
       STL     DWAIT               MAKE WAIT CELL NONZERO              $3IO32270
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $3IO32280
       PXD     0,1                                                     $3IO32290
       STD     1,4                 SECOND WORD OF UCB                  $3IO32300
       TSX     (ACTVX,4            ACTIVATE CHAIN OF CHANNEL COMMANDS  $3IO32310
       MZE     0,2                                                     $3IO32320
       ZET     DWAIT               WAIT FOR SELECT MINUS                3IO32330
       TRA     *-1                 TO FINISH                           $3IO32340
       XEC     DWEF1                                                   $3IO32350
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $3IO32360
       CAL     6,2                 SET UP SEEK                         $3IO32370
       ACL     L(1)                AND FILE START                      $3IO32380
       STA     6,2                 ADDRESS FOR                         $3IO32390
       TSX     EOF,4               BACKSPACE FILE                      $3IO32400
       ENB     TRAPS                                                   $3IO32410
DWEF1  AXT     **,4                AT LAST                             $3IO32420
       AXT     **,1                                                    $3IO32430
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $3IO32440
       CAL     7,2                 GET BOT ADDRESS                     $3IO32450
       STD     0,2                 AND PUT IN BOTH                     $3IO32460
       ARS     18                  WORD ONE AND SEVEN                  $3IO32470
       STA     6,2                                                     $3IO32480
       TXL     DNDSEL,4,3                                              $3IO32490
       PXA     0,0                                                     $3IO32500
       STA     0,2                 ZERO OUT UCB                        $3IO32510
       XEC     DIND                RESTORE INDICATORS                  $3IO32520
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $3IO32530
       TRA     DNDSEL+1            RETURN                              $3IO32540
DWAIT  PZE                                                             $3IO32550
DVTA   DVTA    ,,                                                      $3IO32560
DBSF   LDI     6,2                 1ST TIME AROUND                     $3IO32570
       CLA     7,2                                                     $3IO32580
       STD     *+3                 IF AT                               $3IO32590
       CLA     0,2                 BOT DO NOT                          $3IO32600
       PDC     0,1                 DO THE                              $3IO32610
       TXI     *+1,1,**            BACKSPACE                           $3IO32620
       TXL     DNDNOP,1,0          FILE                                $3IO32630
       LFT     600000                                                  $3IO32640
       TRA     DBSF4               NOT 1ST TIME                        $3IO32650
       CLA     0,2                 EXCHANGE SEEK POINTER               $3IO32660
DBSF6  ARS     18                  TO BE BEGINNING                     $3IO32670
       STA     6,2                 OF THE FILE                         $3IO32680
       CAL     SIX                 PUT NOT FIRST                       $3IO32690
       STP     6,2                 TIME THRU FLAG ON                   $3IO32700
       LXA     DWEF1+1,1                                               $3IO32710
       TIX     DBSF,1,1            THERE IS ANOTHER TO DO -            $3IO32720
       TRA     DNDNOP              EXIT                                $3IO32730
DBSF4  LFT     200000                                                  $3IO32740
       TRA     DBSF5               NOT FIRST TIME THRU                 $3IO32750
       PIA     **                  PUT SEEK ADDRESS                    $3IO32760
       ALS     18                  AND BEGINNING OF                    $3IO32770
       STD     0,2                 FILE EQUAL                          $3IO32780
       TRA     DBSF6+2             EXIT                                $3IO32790
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $3IO32800
       SXA     DSELP+2,4           FOR BACKSPACE                       $3IO32810
       PIA                                                             $3IO32820
       SUB     L(1)                MAKE SEEK ADDRESS                   $3IO32830
       STA     6,2                 EOF ADDRESS                         $3IO32840
       TRA     DBSF1               GET FLAG FOR EOF                    $3IO32850
DBSF3  AXT     DCTL,4              RESTORE START                       $3IO32860
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $3IO32870
       CAL     DFLAG               GET NEW B.O.F.                      $3IO32880
       STD     0,2                 AND PUT IT IN THE                   $3IO32890
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $3IO32900
*                                                                      $3IO32910
DISUE  ACL     L(1)                GET ADDRESS OF                      $3IO32920
       STA     DSELM1              UCB + 1                             $3IO32930
       LXA     DWEF6,2             -L (FILE) IN IR2                    $3IO32940
       TPL     DSELP                                                   $3IO32950
       STZ     DWAIT                                                   $3IO32960
DSELM1 STZ     **                                                      $3IO32970
       TRA     1,4                 RETURN                              $3IO32980
DSELP  CAL     0,2                 PUT FILE                            $3IO32990
       STD     DFLAG               START POINT IN FLAG                 $3IO33000
       AXT     DCTL,2              COMM. LIST                          $3IO33010
       PXA     0,2                                                     $3IO33020
       STA*    (RCHXI                                                  $3IO33030
       XEC*    (RCHXI              SEL+ START CHANNEL                  $3IO33040
       TRA     1,4                 EOF LOCATION                        $3IO33050
*              7909 CHANNEL PROGRAM                                    $3IO33060
*                                                                      $3IO33070
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              3IO33080
       CTLW    DVTA                                                    $3IO33090
       CPYD    DFLAG,,1                                                $3IO33100
       TCH     SYSTWT                                                  $3IO33110
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $3IO33120
       CTLR    DVTA                FOR BACK SPACE                      $3IO33130
       TCH     DCTL+2              FILE ROUTINE                        $3IO33140
DFLAG  PTW                         EOF FLAG WORD                       $3IO33150
       BES     7KA+NOCH/NOCH**-NOCH/NOCH*7KA-*                          3IO33160
       TTL                         BSR (BACKSPACE RECORD) ROUTINE       3IO33170
*      TSX     BSR,4                                                    3IO33180
*      PZE     FILE,,BOFEX         BOFEX= BEGINNING OF FILE EXIT        3IO33190
       SPACE   1                                                        3IO33200
*      ACTIONS                                                          3IO33210
*             1. UNBUFFERS FILE                                         3IO33220
*             2. IF TAPE HAS BEEN BACKED OVER FILE MARK - BOF EXIT      3IO33230
*             3. ELSE BSR GIVEN AND BLOCK SEQ. REDUCED BY ONE           3IO33240
       SPACE   1                                                        3IO33250
BSR.   TRA     BSCKS               PERFORM CHECKS AND UNBUFFER          3IO33260
       RNT     600000              READ BACKWARD                       $3IO33270
       TRA     BSR2-3              NO                                   3IO33280
       TSX     (NDSLX,4                                                $3IO33290
       PZE     0,2,HSKRP           SKIP FORWARD                        $3IO33300
       CAL     1DEC                INCREASE BLOCK SEQUENCE              3IO33310
       TRA     BSR2                                                    $3IO33320
       BES     *-6+NOHYP/NOHYP*6-*                                      3IO33330
       TSX     NDSEL+1,4           EXECUTE                              3IO33340
       PZE     0,2,BSROP           BACKSPACE                            3IO33350
       CLS     1DEC                REDUCE BLOCK SEQUENCE                3IO33360
BSR2   ADM     3,2                 AND PUT IN FCB                       3IO33370
       STD     3,2                                                      3IO33380
       LDQ     5,2                 IS THIS DISK                         3IO33390
       TQP     *+4                 NO                                   3IO33400
       ZET     TEMP                YES, DID EOF GET PASSED              3IO33410
       TRA     BOFEX               YES                                  3IO33420
       TRA     COMXIT              NO                                   3IO33430
       BES     *-5+NOCH/NOCH*5-*                                        3IO33440
       AXC     2,4                     IF BACKED OVER                   3IO33450
       CLA*    0,2                     A FILE MARK STORE                3IO33460
       ANA     ADDRS               ZERO IN BLOCK                        3IO33470
       ERA     ADDRS               COUNT AND GIVE THE                   3IO33480
       TNZ     COMXIT                                                   3IO33490
       STD     3,2                     BEGINNING OF FILE                3IO33500
       TRA     BOFEX                   EXIT OR ELSE NORMAL              3IO33510
*                 ENTRY ROUTINE COMMON TO BSR AND BSF                   3IO33520
BSCKS  LNT     OPEND               IF FILE NOT OPEN                     3IO33530
       TRA     COMXIT              TAKE NORMAL EXIT                     3IO33540
       TSX     FNLBC,4             FIND L(POOL)                         3IO33550
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO33560
       LFT     OUTPUT              IF INPUT FILE                        3IO33570
       TRA     BSC2                UNBUFFER                             3IO33580
       TSX     UNBFI,4             INPUT                                3IO33590
BSC1   LAC     GO,1                LOAD -L(BSR.) OR -L(BSF.)            3IO33600
       LDQ     5,2                                                     $3IO33610
       RQL     1                                                       $3IO33620
       RIR     200000                                                  $3IO33630
       TQP     *+2                 NOT HYPER                           $3IO33640
       SIR     200000              HYPER                               $3IO33650
       BES     *-5+NOHYP/NOHYP*5-*                                     $3IO33660
       TRA     1,1                 AND RETURN                           3IO33670
BSC2   TSX     UNBFO,4             UNBUFFER OUTPUT                      3IO33680
       TRA     BSC1                FILE                                 3IO33690
       TTL                         MESSAGES FOR MINIMUM IOCS            3IO33700
MESS1  BCI     2, UNIT  *****                                           3IO33710
MESS2  BCI     3,CYL. LIMITS XCEDED                                    $3IO33720
       BES     *-3+NOCH/NOCH*3-*                                        3IO33730
MESS5  BCI     3,POOL ERROR TSX AT                                      3IO33740
MESS6  BCI     7, OPEN COUNT EXCEEDED - OPEN NOT POSSIBLE               3IO33750
MESS7  BCI     6, NOT AVAILABLE FOR INITIALIZATION                      3IO33760
MESS8  BCI     3, ATTACH ERROR AT                                       3IO33770
MESS9  BCI     7, ILLEGAL TRANSMIT  ***** WRITE READ  *****            $3IO33780
MES10  BCI     6, REEL  *****   -   ***** RECORDS                       3IO33790
MES11  BCI     4,      REDUNDANCY HISTORY                               3IO33800
MES12  BCI     5, ***** RETRYS      ***** PERM.                        $3IO33810
MES13  BCI     1, RETRY                                                $3IO33820
MES14  BCI     1, ERASE                                                 3IO33830
MES22  BCI     3,ILLEGAL FILE USE                                       3IO33840
MES23  BCI     5,REMOVE REEL *****   S/N                             (4)3IO33850
MES24  BCI     2, MOUNT BLANK                                           3IO33860
MES25  PZE     MES10+3,,3                                              $3IO33870
MES26  PZE     MES10,,6                                                $3IO33880
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      3IO33890
*                    IN SEARCHING OUTPUT FILE CHAIN                     3IO33900
       SPACE   1                                                        3IO33910
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              3IO33920
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               3IO33930
       SPACE   1                                                        3IO33940
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      3IO33950
       TSX     EOTOF,1             HANDLE EOT                           3IO33960
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           3IO33970
       TRA     GET0+1              AND IR2 THEN EXIT                    3IO33980
       SPACE   1                                                        3IO33990
*                       EOT HANDLER OUTPUT FILE                         3IO34000
       SPACE   1                                                        3IO34010
*      TSX     EOTOF,1             IR2 = -L(FILE)                       3IO34020
*      RETURN                      INDICES NOT DISTURBED                3IO34030
       SPACE   1                                                        3IO34040
EOTOF  SXA     ETOF5,4             SAVE IR4                             3IO34050
       SXA     ETOF6,1             IR1                                  3IO34060
       TSX     NDSEL+1,4           WEF ON OLD                           3IO34070
       PZE     0,2,WEFOP           FILE                                 3IO34080
       NOP                         IGNORE EOT                           3IO34090
       LFT     LABEL               IF LABELLED                          3IO34100
ETOF3  STR                         WRITE TRAILER    TSX  LBEOT,1        3IO34110
       TSX     SWITCH,1            SWITCH REELS                         3IO34120
       LFT     LABEL               CHECK AND PREPARE LABEL              3IO34130
       STR                         TSX  LABOO,1                         3IO34140
       TRA     *+1                 TSX   CPINT,4                        3IO34150
       SIL     NOEOT               SET NO EOT CONDITION                 3IO34160
       NZT*    4,2                 IF NO SELECTS TO DO                  3IO34170
       TRA     ETOF5               SKIP OUT                             3IO34180
       CLA     4,2                 SET EOT CHAIN OF SELECTS             3IO34190
       STA     ETOF7               INTO UCW OF                          3IO34200
       CAL     ETOF7               NEW REEL                             3IO34210
       AXC     1,4                                                      3IO34220
       ZET*    0,2                                                     $3IO34230
       TRA     *-1                                                     $3IO34240
       ORS*    0,2                                                      3IO34250
       CLA     L(0)A               SET EOT CHAIN                        3IO34260
       STA     4,2                 = 0                                  3IO34270
       TSX     ACTV+1,4            ACTIVATE                             3IO34280
       PZE     0,2                 NEW REEL                             3IO34290
ETOF5  AXT     **,4                RESTORE IR4                          3IO34300
ETOF6  AXT     **,1                IR1                                  3IO34310
       TRA     1,1                 EXIT                                 3IO34320
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          3IO34330
       TTL                         REEL SWITCHING ROUTINE               3IO34340
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  3IO34350
*      RETURN                      INDICES NOT DISTURBED                3IO34360
       SPACE   1                                                        3IO34370
*                               ACTIONS                                 3IO34380
*            1. REWINDS UNLOADS OLD REEL                                3IO34390
*            2. SWITCHES TO ALTERNATE UNIT                              3IO34400
*            3. PRINTS MESSAGE TO OPERATOR                              3IO34410
*            4. ADVANCES REEL SEQ. NUMBER                               3IO34420
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  3IO34430
       SPACE   1                                                        3IO34440
SWITCH SXA     SW3,4               SAVE IR4                             3IO34450
       SXA     SW4,1               IR1                                  3IO34460
       LDQ     5,2                                                     $3IO34470
       RQL     1                   HYPER                               $3IO34480
       TQP     *+9                 NO                                  $3IO34490
       STI     TEMP                                                    $3IO34500
       LDI     1,2                                                     $3IO34510
       LFT     OUTPUT                                                  $3IO34520
       RNT     100000              FILE PROTECT                        $3IO34530
       TRA     *+3                 NO                                  $3IO34540
       TSX     (NDSLX,4                                                $3IO34550
       PZE     0,2,HFPNP                                               $3IO34560
       RFT     200000              UNLOAD                               3IO34570
       TRA     *+4                 NO                                  $3IO34580
       TSX     (NDSLX,4                                                $3IO34590
       PZE     0,2,HUNLP                                               $3IO34600
       TRA     *+3                                                     $3IO34610
       BES     *-15+NOHYP/NOHYP*15-*                                   $3IO34620
       TSX     NDSEL+1,4           REWIND UNLOAD                        3IO34630
       PZE     0,2,RUNOP           OLD REEL                             3IO34640
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           3IO34650
       TSX     UNMNT,4             PRINT UNMOUNT INSTRUCTIONS           3IO34660
       CLA     0,2                 SET IR1 =0                           3IO34670
       PAC     0,1                 FOR SINGLE DRIVE FILE                3IO34680
       STD     *+1                 NOT=0 FOR MULTI-DRIVE                3IO34690
       TXI     *+1,1,**                                                 3IO34700
       CAL     7,2                 UPDATE                               3IO34710
       TZE     SW.1                (UNLESS ZERO)                    (11)3IO34711
       ACL     1P5                 REEL SEQUENCE                        3IO34720
       TSX     BCDCV,4             NUMBER IN                            3IO34730
       ACL     HLBLK               FILE WORDS                           3IO34740
       SLW     7,2                                                      3IO34750
SW.1   CAL     0,2                 SAVE FOR SECOND DRIVE            (11)3IO34760
       STP     SW7                 MOUNTED TEST                        $3IO34770
       CLA     LFLBLK                                                  $3IO34780
       PDC     0,4                 TOTAL NO. OF FCW                    $3IO34790
       STA     SW5+5               ADDRESS OF 1ST FCB                  $3IO34800
       ACL     L(1)                                                    $3IO34810
       STA     SW5+2                                                   $3IO34820
       STI     TEMIND              SAVE INDICATORS                     $3IO34830
       CLA*    FCW                 L(FCB) BEING WORKED ON              $3IO34840
SW5    TXL     SW6,4,0             END OF FCB                          $3IO34850
       TXI     *+1,4,12            NEXT FCB                            $3IO34860
       LDI     **,4                CHECK IF FILE OPEN                  $3IO34870
       LNT     OPEND               IF NOT TRY NEXT FCB                 $3IO34880
       TRA     SW5                                                     $3IO34890
       CAS     **,4                IF MORE THAN ONE FCB                $3IO34900
       TRA     SW5                 USING THE SAME UCB                  $3IO34910
       TRA     *+2                 UPDATE FCW ONE                      $3IO34920
       TRA     SW5                                                     $3IO34930
       LDQ*    SW5+5               ROTATE PRIMARY UNIT                 *3IO34940
       RQL     18                  WITH SECONDARY UNIT                 $3IO34950
       STQ*    SW5+5                                                   *3IO34960
       TRA     SW5                 FINISH FCB                          $3IO34970
SW6    LDI     TEMIND              RESTORE INDICATORS                  $3IO34980
       CLA     FCW                 PLACE LOCATION                      $3IO34990
       AXT     0,4                 OF FILE IN                          $3IO35000
       STA*    0,2                 SECONDARY UNIT                      $3IO35010
       CAL     7,2                 RESTORE AC                          $3IO35020
       TXL     SW2,1,0             IF SINGLE DRIVE SKIP FURTHER TESTS  $3IO35030
       CLA     *+3                 CHECK LEGALITY                      $3IO35040
       TMI     SW1-1               OF UNIT TO BE MOUNTED               $3IO35050
       TSX     (NDATA,4                                                $3IO35060
SW7    PZE     0,2,TESTP                                               $3IO35070
       CAL     7,2                 IF NOT MOUNTED                       3IO35080
       TSX     MOUNT,4             TELL OPERATOR                        3IO35090
       TSX     PAUSE,4             TO MOUNT NOW                         3IO35100
       TSX     ROTAT,4                                                  3IO35110
SW1    CAL     7,2                 TELL OPERATOR                        3IO35120
       TZE     SW.2                (UNLESS N = 0)                   (11)3IO35121
       ACL     1P5                 TO MOUNT REEL N+2                    3IO35130
       TSX     BCDCV,4             ON UNIT OF REEL N                    3IO35140
       ACL     HLBLK               ( IF MULTI-DRIVE)                    3IO35150
SW2    TSX     MOUNT,4                                                  3IO35160
       TSX     ROTAT,4                                                  3IO35170
       TXH     *+2,1,0             IF SAME DRIVE                        3IO35180
       TSX     PAUSE,4             PAUSE FOR OPERATOR                   3IO35190
       TSX     DENSE,4                                                  3IO35200
       LDQ     5,2                                                     $3IO35210
       RQL     1                                                       $3IO35220
       TQP     *+6                                                     $3IO35230
       RNT     100000                                                  $3IO35240
       TRA     *+3                                                     $3IO35250
       TSX     (NDSLX,4                                                $3IO35260
       PZE     0,2,HFPNP                                               $3IO35270
       LDI     TEMP                                                    $3IO35280
       BES     *-8+NOHYP/NOHYP*8-*                                     $3IO35290
       TSX     NDSEL+1,4           INSURE REWIND ON NEWLY              $3IO35300
       PZE     0,2,REWOP           LOADED HYPERTAPE                    $3IO35310
       SIL     NINHIB              UN-INHIBIT FILE                      3IO35320
       LDQ     2,2                 IF MONITORED END OPTION              3IO35330
       RQL     1                   IS SPECIFIED                         3IO35340
       TQP     SW3                 LET SUPERVISORY                      3IO35350
       TSX     SWITCD,4            SYSTEM NOTE CHANGE                   3IO35360
SW3    AXT     **,4                RESTORE IR4                          3IO35370
SW4    AXT     **,1                                                     3IO35380
       TRA     1,1                 EXIT                                 3IO35390
SW.2   CAL     =H NEXT             MOVE 'NEXT' TO AC                (11)3IO35391
       TRA     SW2                                                  (11)3IO35392
       SPACE   1                                                        3IO35400
*                          ROTATE FILE WORD 1                           3IO35410
*                         (CHANGE TO ALT UCW)                           3IO35420
ROTAT  LDQ     0,2                                                      3IO35430
       RQL     18                                                       3IO35440
       STQ     0,2                                                      3IO35450
       TRA     1,4                                                      3IO35460
       SPACE   1                                                        3IO35470
*                     BCD CONVERT AFTER ADD IN AC                       3IO35480
       SPACE   1                                                        3IO35490
*      TSX     BCDCV,4                                                  3IO35500
       SPACE   1                                                        3IO35510
BCDCV  ANA     17SS                                                     3IO35520
       ACL     66SS                                                     3IO35530
       ANS     60SS                                                     3IO35540
       SBM     60SS                                                     3IO35550
       ALS     3                                                        3IO35560
       SBM     60SS                                                     3IO35570
       ARS     3                                                        3IO35580
       LDQ     BLNKS                                                    3IO35590
       STQ     60SS                                                     3IO35600
       TRA     1,4                                                      3IO35610
17SS   OCT     171717373717                                            *3IO35620
66SS   OCT     006666666666                                             3IO35630
60SS   OCT     606060606060                                             3IO35640
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             3IO35650
*                               ACTIONS                                 3IO35660
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          3IO35670
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      3IO35680
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                3IO35690
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              3IO35700
*                MODE WILL BE USED AND THE RECORD WILL BE READ          3IO35710
*                WITHOUT REDUNDANCY CHECKING                            3IO35720
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 3IO35730
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             3IO35740
*                            XX XX XX X5 XX XX    BIN   BIN             3IO35750
*                            XX XX XX X1 XX XX    BCD   BIN             3IO35760
*                            XX XX XX X1 XX XX    BIN   BCD             3IO35770
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   3IO35780
*                            XX XX 00 00 00 00    BCD   BCD             3IO35790
*                            00 01 00 05 00 04    BIN   BIN             3IO35800
*                            XX XX 11 11 07 07    BCD   BIN             3IO35810
*                            00 00 00 01 00 00    BIN   BCD             3IO35820
*             5. WRITE MIXED MODE WORKS ............                    3IO35830
MXMOD  CLA     0,4                 MIXED MODE                           3IO35840
       ANA     L(64D)              CARD EQUIPMENT                       3IO35850
       TNZ     CDMXM               CHECKS FOR EOF CARD                  3IO35860
       STI     MX2                 SAVE SI                              3IO35870
       LNT     100000              IF NO REDUNDANCY ANALYZE             3IO35880
       TRA     LKAD                LOOK AHEAD BITS                      3IO35890
       LDI     1,4                 IF CODE 3 THEN                       3IO35900
       LNT     300000              10 TRIES ON FIRST MODE DONE          3IO35910
       TRA     MX1                                                      3IO35920
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         3IO35930
MX0    STZ*    (URRXI              ERROR PRINT                          3IO35940
       STI     1,4                                                      3IO35950
       LDI     1,2                 REVERSE                              3IO35960
       IIL     MODE                MODE OF                              3IO35970
       STI     1,2                 SELECT                               3IO35980
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     3IO35990
       LXA     S3+1,1              RESTORE IR 1                         3IO36000
       LXA     S3,4                RETURN TO                            3IO36010
       TRA     3,4                 EXECUTOR TO RE-TRY                   3IO36020
*                   SECOND AND THIRD MODE TRIES SEL-                    3IO36030
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      3IO36040
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $3IO36050
       IIL     300000              IF SECOND GO TRY AGAIN               3IO36060
       TRA     MX0                 AT FIRST MODE                        3IO36070
MX2    PZE     **                  SI STORAGE                           3IO36080
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   3IO36090
MXMP   LDI     1,4                 IF FIRST TIME                        3IO36100
       LFT     300000              SELECT SET ALTERNATOR                3IO36110
       TRA     MX3                 CODE =3                              3IO36120
       IIL     300000                                                   3IO36130
       STI     1,4                 RESTORE UCW 2ND WORD                 3IO36140
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           3IO36150
       STZ*    (RCTXI              THIRD TRY DISABLE REDUNDANCY         3IO36160
       LDI     1,2                 RESTORE SI                           3IO36170
       TRA     S4-5                EXIT                                $3IO36180
       EJECT                                                            3IO36190
*                      INTERROGATE LOOKAHEAD BITS                       3IO36200
1KA    LFT     200000              EOF                                 $3IO36210
       TRA     SELM2+2             NO CHANGE IN MODE                   $3IO36220
       STI     MX2                 SAVE INDICATORS                     $3IO36230
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $3IO36240
       CLA     1,4                                                     $3IO36250
       PAC     0,1                                                     $3IO36260
       CLA     9,1                 LAST COMMAND                        $3IO36270
       ARS     18                                                      $3IO36280
       ADD     9,1                 LAST WORD READ + 1                  $3IO36290
       PAC     0,1                                                     $3IO36300
       TRA     LWRD+1                                                  $3IO36310
       BES     1KA+NOCH/NOCH**-NOCH/NOCH*1KA-*                         $3IO36320
       LDI     MX2                                                     $3IO36330
LKAD   LFT     200000              EOF                                 $3IO36340
       TRA     MX5                 NO CHANGE IN MODE                   $3IO36350
       LDI     1,2                                                     $3IO36360
LWRD   LAC     COMM,1              INTERROGATE                         $3IO36370
       CLA     -1,1                LAST WORD IN BUFFER                  3IO36380
       ANA     MXBB2                                                   $3IO36390
       LNT     MODE                TEST MODE                           $3IO36400
       TZE     MX5                 BCD TO BCD                          $3IO36410
       ANA     DISCON              BIN CHECK BIN'BIN                   $3IO36420
       TNZ     MX5                 BIN TO BIN                          $3IO36430
       IIL     MODE                CHANGE MODE BIT                     $3IO36440
       STI     1,2                 STORE IN FILE BITS                   3IO36450
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     3IO36460
MX5    LDI     MX2                 RESTORE SI FOR SELM                  3IO36470
       LXA     S3+1,1                                                  $3IO36480
       CLA     CHATY                                                   $3IO36490
       LBT                                                             $3IO36500
       TRA     *+2                                                     $3IO36510
       TRA     SELM2+2             DISK SEL-                           $3IO36520
       TNZ     SELM1               HYPER SEL-                          $3IO36530
       CAL     XCPT3               CLEAR READ                          $3IO36540
       ANS     1,4                 MODE SWITCH                         $3IO36550
       TRA     SELM1               POST COMPLETION                      3IO36560
MXBB2  OCT     000000050000                                            $3IO36570
XCPT3  OCT     477777777777                                             3IO36580
       SPACE   1                                                        3IO36590
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      3IO36600
*                     BEING REFERENCED BY THE IOBS                      3IO36610
INVM   SXA     INVM1,1             SAVE IR1                             3IO36620
       CLA     0,4                 IF FILE IS                           3IO36630
       ALS     18                  CURRENTLY BEING                      3IO36640
       STD     *+2                 REFERENCED BY IOBS                   3IO36650
       LAC     FCW,1               THEN MODIFY MODE                     3IO36660
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              3IO36670
       TXH     *+4,1,0             AS STORED BY                         3IO36680
       LDI     (IOXSI              IOEX.......                          3IO36690
       IIL     MODE                                                     3IO36700
       STI     (IOXSI                                                   3IO36710
INVM1  AXT     **,1                RESTORE IR1                          3IO36720
       TRA     1,1                 EXIT                                 3IO36730
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    3IO36740
CDMXM  SXA     CDMX4,4             SAVE IR4                             3IO36750
       CAL     1,4                 FIND L(9L)-2                         3IO36760
       PAC     0,4                 IF BOTH                              3IO36770
       CLA     4,4                 8L AND 7L                            3IO36780
       TPL     CDMX4               ARE                                  3IO36790
       CLA     6,4                 (-) TREAT IT AS                      3IO36800
       TPL     CDMX4               END OF FILE                          3IO36810
       LXD     COMM,4              SET L(IORT)+1                        3IO36820
       SXA     COMM,4              AS LAST WD STORED+1                  3IO36830
       SIL     200000              SET EOF BIT                          3IO36840
CDMX4  AXT     **,4                RESTORE IR4                          3IO36850
       TRA     SELM1               RETURN                               3IO36860
*                   ROUTINE TO REVERSE FILE CONTROLS                    3IO36870
*                   SI AND IR2 FROM FILE A TO FILE B                    3IO36880
CPY6   XCA     **                  SAVE AC                              3IO36890
       ENB     L(0)                TRAP PROTECT                         3IO36900
       PIA                         RESTORE CONTROL                      3IO36910
       STD     1,2                 BITS TO FILE                         3IO36920
       LXA     CPY7,1              SWITCH                               3IO36930
       LXA     FCW,2               TO OTHER                             3IO36940
       SXA     FCW,1               FILE                                 3IO36950
       SXA     CPY7,2                                                   3IO36960
       LAC     FCW,2               PLACE 2ND                            3IO36970
       CLA     1,2                 FILES CONTROL                        3IO36980
       ANA     DECRE               BITS IN SI                           3IO36990
       RIL     077777                                                   3IO37000
       OAI                                                              3IO37010
       TXH     *+2,4,-SEL2.4                                           $3IO37020
       ENB     TRAPS               ALLOW TRAPS                          3IO37030
       XCA                         RESTORE AC                           3IO37040
       TRA     1,4                 EXIT                                 3IO37050
       TTL     CONSTANT POOL                                            3IO37060
XCPTP  OCT     077777777777                                            $3IO37070
L(64D) PZE     0,,64                                                    3IO37080
PDMSK  SVN     ,,-1                                                     3IO37090
1P5    BCI     1,000010                                                *3IO37100
HLBLK  BCI     1, 0000                                                 $3IO37110
       SPACE   1                                                        3IO37120
*                          TEMPORARY STORAGE                            3IO37130
HOLDS  PZE     *                   CHAIN CELL                           3IO37140
TCHEX  PZE     **                  TCH SWITCH                           3IO37150
7GRP   PZE     **                  CLOSE RESERVE GROUP ERASEABLE        3IO37160
TEMP   PZE     **                  ERASEABLE STORAGE                    3IO37170
BASIO  BSS     0                   END MINIMUM IOBS                     3IO37180
B4FIN  BSS     0                   ...END MINIMUM IOCS STORAGE..........3IO37190
F5     BES     1                                                        3IO37200
       EJECT                                                            3IO37210
.BASIC CONTRL  S6,F7                                                    3IO37220
S6     BSS     0                                                        3IO37230
*      BASIC COMMUNICATION REGION WITH .BASCR                           3IO37240
.COPY. CONTRL  COPY.,COPY.                                              3IO37250
.REW.  CONTRL  REW.,REW.                                                3IO37260
.WEF.  CONTRL  WEF.,WEF.                                                3IO37270
.BSF.  CONTRL  BSF.,BSF.                                                3IO37280
.CKPT. CONTRL  CKPT.,CKPT.                                              3IO37290
.STAS. CONTRL  STASH.,STASH.                                            3IO37300
.CHCPT CONTRL  CHCPT,CHCPT                                              3IO37310
.CPINT CONTRL  CPINT,CPINT                                              3IO37320
.B5FIN CONTRL  B5FIN,B5FIN                                              3IO37330
.JOIN. CONTRL  JOIN.,JOIN.                                              3IO37340
.INTOP CONTRL  INTOP,INTOP                                              3IO37350
.INTCL CONTRL  INTCL,INTCL                                              3IO37360
.ENTIN CONTRL  ENTIN,ENTIN                                              3IO37370
.BASIO CONTRL  BASIO,BASIO                                              3IO37380
SWTC   SWT     SWTCP                                                    3IO37390
       TTL                         JOIN TWO BUFFER POOLS                3IO37400
*      TSX     JOIN,4                                                   3IO37410
*      PZE     POOL1,,POOL2                                             3IO37420
       SPACE   1                                                        3IO37430
*            1.POOL2 IS APPENDED TO POOL1                               3IO37440
*            2.POOL2 MUST HAVE AT LAST REFERENCE BEEN DEFINED           3IO37450
*            3.POOL1 MAY HAVE FILES ATTACHED                            3IO37460
*            4.POOL1 OR POOL2 MUST NOT HAVE                             3IO37470
*              PREVIOUSLY JOINED ELSEWHERE                              3IO37480
*            5.AFTER TSX JOIN,4 POOL2 NO LONGER EXISTS                  3IO37490
       SPACE   1                                                        3IO37500
JOIN.  LDC     XEOB,1              CHECK IF EITHER                      3IO37510
       LDI     1,1                 FILE JOINED                          3IO37520
       OSI     1,2                 ELSEWHERE                            3IO37530
       RFT     100000              IF SO GIVE                           3IO37540
       TRA     PERR                ''POOL ERROR''                       3IO37550
       CAL     1,1                 CHECK IF BUFFERS ARE                 3IO37560
       ERA     1,2                 THE SAME SIZE                        3IO37570
       ARS     22                  IF NOT GIVE                          3IO37580
       TNZ     PERR                POOL ERROR                           3IO37590
       ENB     L(0)                TRAP PROTECT                         3IO37600
       LDQ     0,2                 JOIN THE BUFFER POOLS                3IO37610
       CLA     0,1                 BY-                                  3IO37620
       STA     0,2                 CHAIN (1) TO END CHAIN(2)            3IO37630
       XCA                         CHAIN(2) TO CHAIN(1)                 3IO37640
       STA*    1,1                                                      3IO37650
       ACL     0,1                 SUM BUFFER COUNTS                    3IO37660
       STD     0,2                 AND SET IN POOL1                     3IO37670
       ENB     TRAPS               ALLOW TRAPS                          3IO37680
       CAL     *+1                 SET JOINED                           3IO37690
       STT     1,1                 CODE INTO POOL2                      3IO37700
       TRA     .EX34-3             EXIT                                 3IO37710
       TTL                         COPY AND STASH ROUTINES              3IO37720
*      TSX     COPY,4              TSX  STASH,4                         3IO37730
*      PZE     FILE1,,FILE2        PZE  FILE1,,FILE2                    3IO37740
*                                  PZE  NTS                             3IO37750
*                             COMMENTS...                               3IO37760
*             1. NO ACTION IF NO INPUT BUFFER                           3IO37770
*             2. PRESENT OUTPUT BUFFER,IF ANY, TRUNCATED                3IO37780
STASH. TXI     *+1,4,-1            SETUP L( NORMAL EXIT)                3IO37790
       SXA     GTIOX,4                                                  3IO37800
       CLA     -1,4                SAVE                                 3IO37810
       STA     XEOF                NTS EXIT                             3IO37820
       SIR     STSH                SET STASH MODE                       3IO37830
COPY.  LNT     OPEND               IF INPUT FILE                        3IO37840
       TRA     COMXIT              NOT OPEN THEN EXIT                   3IO37850
       TSX     FNLBC,4             FIND L(POOL)                         3IO37860
       LXD     XEOB,1              SET FILE2 INTO                       3IO37870
       SXA     CPY7,1              SWITCHING ROUTINE                    3IO37880
       LAC     CPY7,1                                                  $3IO37890
       ERA     4,1                 FIND OUT IF FILE1 AND               $3IO37900
       ANA     DECRE               FILE2 ARE IN THE SAME POOL          $3IO37910
       TNZ     GET4                THEY ARE NOT                        $3IO37920
       TSX     CPY6,4              SWITCH TO OTHER FILES CONTROLS       3IO37930
       LNT     OPEND               IF OUTPUT FILE                       3IO37940
       TRA     COMXIT              NOT OPEN ,THEN EXIT                  3IO37950
       STL     CPY2+1              SET COPY MODE                        3IO37960
       NOP     CPY2+2              TRA*                                 3IO37970
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO37980
       TSX     TRUNC,1             TRUNCATE ANY OUTPUT BUFFER           3IO37990
       RFT     STSH                BRANCH TO                            3IO38000
       TRA     STSH1               STASH ROUTINE                        3IO38010
CPY1   TSX     CPY6,4              REVERSE FILE BITS TO FILE1           3IO38020
       RIR     CPYHLD              RESET COPY HOLD                      3IO38030
CPY2   SIR     CPYFN               SET COPY MODE FOR RELES+TRUNC        3IO38040
       TRA*    **                  DUMMY TRANSFER FOR CASES 2 + 4 STASH 3IO38050
       CLA*    2,2                 IF NO BUFFERS ATTACHED               3IO38060
       STA     CPY6                SAVE L( POSSIBLE HOLD CHAIN)         3IO38070
       TPL     CPY3                TO FILE , THEN EXIT                  3IO38080
       SIR     CPYHLD              SET HOLD CHAIN COPY                  3IO38090
       ANA     1PRE                IS NEGATIVE BUFFER                   3IO38100
       TZE     COMXIT              A HELD BUFFER OR THE POOL            3IO38110
       CLA     2,2                 SETUP BUFFER AS                      3IO38120
       PAC     0,4                 IF JUST FILLED BY WRITE              3IO38130
       CLA     1,4                 ROUTINE                              3IO38140
       STA*    2,2                                                      3IO38150
       LDQ     L(0)                                                     3IO38160
       SLQ*    2,2                                                      3IO38170
CPY3   CLA     2,2                 ATTACH INPUT                         3IO38180
       TSX     CPY6,4              BUFFER TO                            3IO38190
       STA     2,2                 OUTPUT FILE                          3IO38200
       TSX     TRUNC,1             TRUNCATE TRANSFERRED BUFFER          3IO38210
       TSX     CPY6,4              RELEASE ASSIGNMENT                   3IO38220
       LAC     LBC,4               (-L(POOL) TO IR4)                    3IO38230
       LDQ     2,2                 FROM INPUT                           3IO38240
       TSX     POOLRD,1            FILE                                 3IO38250
       TSX     CKGIV,1             DO PRIORITY FOR RELEASE              3IO38260
       SIR     CPYFN               SET COPY FUNCTION BIT BACK ON        3IO38270
       RIL     GIVUP               RESET GIVUP PRIORITY                 3IO38280
       CLA     CPY6                                                     3IO38290
       RNT     CPYHLD              IF NOT A HELD BUFFER                 3IO38300
       CLA     LBC                 L(POOL) TO AC                        3IO38310
       STA     2,2                                                      3IO38320
       RNT     CPYHLD              IF COPYING A HELD BUFFER             3IO38330
       TRA     COMXIT              CONTINUE ELSE EXIT                   3IO38340
       TRA     CPY2-1                                                  $3IO38350
       SPACE   1                                                        3IO38360
*                     STASH MASTER CONTROL ROUTINE                      3IO38370
STSH1  STZ     XEOB                SET STASH SWITCH =0                  3IO38380
       CLA     3,2                 FOR CASES 2 AND 4 (FILE2 INTERNAL    3IO38390
       TMI     STSH3               OUTPUT) SKIP TO STSH3                3IO38400
       TSX     CPY6,4              IF FILE2 REGULAR OUTPUT              3IO38410
       LFT     OUTPUT              AND FILE1 IS AN INTERNAL OUTPUT      3IO38420
       TRA     STSH2               (CASE 1) , SKIP TO STSH2             3IO38430
       TRA     CPY2-1              CASE 3 USES COPY ROUTINE             3IO38440
*             TRANSFER OF FIRST BUFFER OF A FILE (CASE 1)               3IO38450
STSH2  TSX     TRUNC,1             TRUNCATE ANY OUTPUT PREPARED         3IO38460
       CLA*    0,2                 IF NO OUTPUT IN REGEN CHAIN          3IO38470
       TZE     EOF.0+1             YET TAKE NTS EXIT                    3IO38480
       LDQ     0,2                 REMOVE 1ST                           3IO38490
       STA     0,2                 BUFFER FROM                          3IO38500
       ZET*    0,2                 FILE1'S REGEN                        3IO38510
       STD*    0,2                 CHAIN AND PLACE                      3IO38520
       STQ     TEMP                INTO REGULAR OUTPUT FILE             3IO38530
       LAC     TEMP,4              FOR ACTUAL OUTPUT                    3IO38540
       CLA     1,4                 SETUP BUFFER SO LOCATOR              3IO38550
       STZ     0,4                 SHOWS BUFFER CONTENT                 3IO38560
       STA     0,4                                                      3IO38570
       ENB     L(0)                TRAP PROTECT                         3IO38580
       TSX     BCKBB,1             RELEASE ONE FROM OUTPUT-1            3IO38590
       CAL     3,2                 REDUCE                               3IO38600
       ACL     DECRE               SEQUENCE                             3IO38610
       STD     3,2                 COUNT BY ONE                         3IO38620
       TSX     CPY6+1,4            SWITCH TO FILE 2 BITS                3IO38630
       STA     2,2                 OUTPUT                               3IO38640
       SIR     CPYFN                                                    3IO38650
       TSX     TRUNC,1             BUFFER                               3IO38660
       TRA     COMXIT              EXIT                                 3IO38670
       EJECT                                                            3IO38680
*                       SETUP CASES 2 + 4 STASH                         3IO38690
STSH3  STL     CPY2+1              SET TRANSFER TO                      3IO38700
       NOP     STSH4               STASH EXIT TEST                      3IO38710
       TRA     CPY1                FOR NTS CONDITIONS                   3IO38720
*      CASES 2 AND 4 STASH EXECUTION (TESTS COUNTS BEFORE COPY)         3IO38730
STSH4  STZ     XEOB                SET STASH SWITCH=0                   3IO38740
       CLA*    2,2                 IF NO NEXT                           3IO38750
       TPL     STSH5               BUFFER TO BE                         3IO38760
       ANA     1PRE                STASHED,THEN                         3IO38770
       TZE     COMXIT              EXIT                                 3IO38780
STSH5  TSX     CPY6,4              CHANGE TO FILE 2 BITS                3IO38790
       TSX     TOKBB,4             CAN FILE2 ACCEPT A BUFFER            3IO38800
       TRA     STSH6               -NO                                  3IO38810
       TSX     CPY6,4              BACK TO FILE 1 BITS                  3IO38820
       TRA     CPY2+2              COPY THAT BUFFER                     3IO38830
STSH6  TSX     CPY6,4              BACK TO FILE 1 BITS                  3IO38840
       ZET     XEOB                IF SWITCH NOT =0 COUNT               3IO38850
       TRA     STSH7               MUST BE RESTORED AND NTS EXIT TAKEN  3IO38860
       CLA     1,2                 IF PRIME BUFFER                      3IO38870
       SUB     L(400)              COUNT SHOULD NOT                     3IO38880
       PAX     0,1                 BE ADJUSTED                          3IO38890
       TXL     EOF.0+1,1,0         TAKE NTS EXIT                        3IO38900
       STL     XEOB                STE SWITCH NOT =0 FOR 2 ND TIME THRU 3IO38910
       ENB     L(0)                TRAP PROTECT                         3IO38920
       TSX     BCKBB,1             RELEASE COUNT FROM INPUT             3IO38930
       TRA     STSH5               SEE IF THAT WILL ALLOW OUTPUT        3IO38940
STSH7  TSX     TOKBB,4             RESTORE BUFFER COUNT TO FILE1        3IO38950
       STL     XEOB                ERROR IF THIS INSTRUCTION EXECUTED   3IO38960
       TRA     EOF.0+1             TAKE NTS EXIT                        3IO38970
       TTL                         BSF (BACKSPACE FILE) ROUTINE         3IO38980
*      TSX     BSF,4                                                    3IO38990
*      PZE     FILE,,CT                                                 3IO39000
       SPACE   1                                                        3IO39010
*      ACTIONS                                                          3IO39020
*             1. UNBUFFERS FILE                                         3IO39030
*             2. GIVES CT NUMBER OF BSF'S                               3IO39040
*             3. FORWARD SPACE ONE RECORD (OVER EOF MARK) EXCPT AT LOAD 3IO39050
*             4. IF CT =0 ,FILE ONLY UNBUFFERS                          3IO39060
       SPACE   1                                                        3IO39070
BSF.   TRA     BSCKS               PREFORM CHECKS AND UNBUFFER          3IO39080
       LXD     XEOB,1              IF BSF COUNT                         3IO39090
       TXL     COMXIT,1,0          =0 JUST EXIT                         3IO39100
BSF4   RNT     600000                HYPER BACKWARD READ                3IO39110
       TRA     BSF1-1              NO                                  $3IO39120
       TSX     (NDSLX,4                                                $3IO39130
       PZE     0,2,HSKFP           FORWARD SPACE FILE                  $3IO39140
       AXC     0,4                                                     $3IO39150
       LDQ*    0,2                                                     $3IO39160
       RQL     18                                                      $3IO39170
       TQP     BSF1+4                                                  $3IO39180
       TRA     HBSF                                                    $3IO39190
       BES     *-9+NOHYP/NOHYP*9-*                                     $3IO39200
       TSX     NDSEL+1,4           BACKSPACE                            3IO39210
BSF1   PZE     0,2,BSFOP           N FILES                              3IO39220
       AXC     2,4                 IF AT LOAD                           3IO39230
       NZT*    0,2                 POINT DONT                           3IO39240
       TRA     BSF2                MOVE FORWARD                         3IO39250
       TIX     BSF4,1,1              OR CONTINUE TO BACKSPACE           3IO39260
       RNT     600000                                                  $3IO39270
       TRA     *+4                                                     $3IO39280
HBSF   TSX     (NDSLX,4            MOVE OVER FILE MARK                 $3IO39290
       PZE     0,2,HBSFP           BACKSPACE FILE                      $3IO39300
       TRA     BSF5                                                    $3IO39310
       RNT     400000              HYPER                               $3IO39320
       TRA     *+4                 NO                                  $3IO39330
       TSX     (NDSLX,4            SKIP OVER                           $3IO39340
       PZE     0,2,HSKFP           EOF                                 $3IO39350
       TRA     BSF5                                                    $3IO39360
       BES     *-10+NOHYP/NOHYP*10-*                                   $3IO39370
       RIL     OUTPUT              SET FOR READ                        $3IO39380
       LDQ     BSF3                ISSUE DUMMY READ                     3IO39390
       TSX     RDSEL,1             ACROSS EOF MARK                      3IO39400
       NZT*    4,2                 WAIT TILL                            3IO39410
       TRA     *-1                 READ DONE                            3IO39420
BSF5   SIL     NINHIB              SET NOT INHIBITED                    3IO39430
       CAL     1,2                 SET INDICATORS                      $3IO39440
       ANA     EOFBT               TO THE CORRECT                      $3IO39450
       OAI                         STATUS READ OR WRITE                $3IO39460
       CLA     L(0)A               SET SYNC                             3IO39470
       STA     4,2                 CHAIN EQUAL ZERO                     3IO39480
BSF2   PXA     0,0                 CLEAR BLOCK SEQUENCE                 3IO39490
       STD     3,2                                                   (8)3IO39500
       TRA     COMXIT                                                (8)3IO39501
BSF3   PZE     *+1                 DUMMY BUFFER FOR DUMMY               3IO39510
       PZE     L(0),,0             READ ACROSS EOF                      3IO39520
       IORT    **,,0                                                   $3IO39530
       PZE     **                                                      $3IO39540
       TTL                         REWIND AND WRITE EOF ROUTINES        3IO39550
*                          CALLING SEQUENCES                            3IO39560
*      TSX     REW(WEF),4                                               3IO39570
*      PZE     FILE,,EOT                                                3IO39580
*      RETURN                                                           3IO39590
*                                WHERE                                  3IO39600
*                   FILE SPECIFIES THE DESIRED FILE                     3IO39610
*                               COMMENTS                                3IO39620
*              1. WEF ON INPUT IS A NOP                                 3IO39630
*              2. WEF OR REW ON LABELLED FILE IS NOP                    3IO39640
*              3. EOT EXIT IS TAKEN IF EOT OCCURS ON WEF                3IO39650
*                 IF OP IS REW AND EOT NON-ZERO,HYPER IS FILE-PROTECTED 3IO39660
*              4. ANY EOF THAT HAS BEEN DETECTED BUT NOT                3IO39670
*                 YET LOGICALLY REACHED IS CANCELLED DUE TO THE         3IO39680
*                 UNBUFFERING PROCESS THAT TAKES PLACE                  3IO39690
       SPACE   1                                                        3IO39700
REW.   AXT     REWOP,1             REWIND ENTRY                         3IO39710
       CLA     5,2                                                     *3IO39720
       ANA     SIX                 IS THIS 7340                        *3IO39730
       TZE     *+7                 NO                                  *3IO39740
       LXD     XEOB,4              IS FILE PROTECT DESIRED             *3IO39750
       TXL     *+5,4,0             NO                                  *3IO39760
       TSX     (NDSLX,4            YES                                 *3IO39770
       PZE     0,2,HFPNP                                               *3IO39780
       BES     *-7+NOHYP/NOHYP*7-*                                      3IO39790
       TRA     *+2                 PRESET REW OP CODE                   3IO39800
WEF.   AXT     WEFOP,1             WEF ENTRY                            3IO39810
       LNT     LABEL               IF FILE IS LABELLED OR               3IO39820
       LNT     OPEND               NOT OPEN THEN                        3IO39830
       TRA     COMXIT              EXIT                                 3IO39840
       SXD     REW4,1              SET OP CODE                          3IO39850
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO39860
       LNT     OUTPUT              IF FILE IS A                         3IO39870
       TRA     *+2                 CKPT FILE THEN SKIP                  3IO39880
       TRA     REW3                DIRECTLY TO ND SEL                   3IO39890
       TSX     FNLBC,4             FIND L(POOL)                         3IO39900
       LFT     OUTPUT              IS FILE INPUT                        3IO39910
       TRA     REW2                OR OUTPUT                            3IO39920
       LXD     REW4,1              SELECT TO IR1                        3IO39930
       TXI     *+1,1,-WEFOP        WEF ON INPUT FILE                    3IO39940
       TXL     COMXIT,1,0          IS A NOP                             3IO39950
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3IO39960
       TRA     REW3                                                     3IO39970
REW2   TSX     UNBFO,4             UNBUFFER OUTPUT                      3IO39980
REW3   TSX     NDSEL+1,4           REQUEST                              3IO39990
REW4   PZE     0,2,**              REW OR WEF                           3IO40000
       SIL     NINHIB              CANCEL ANY EOF                       3IO40010
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           3IO40020
       NZT*    4,2                 CHECK FOR EOT                        3IO40030
       TRA     COMXIT              EXIT                                 3IO40040
       LDC     XEOB,4              TAKE                                 3IO40050
       SXA     GTIOX,4             EOT                                  3IO40060
       TRA     COMXIT              EXIT                                 3IO40070
       TTL                   INTERNAL FILE OPEN                         3IO40080
INTOP  CAL     -1,4                PLACE OPTION                         3IO40090
       ARS     33                  BITS IN SI                           3IO40100
       OAI                                                              3IO40110
       RNT     INTRD               READ OR                              3IO40120
       TRA     IOP3                WRITE                                3IO40130
       RIL     OUTPUT              SET INPUT TYPE                       3IO40140
       CLA     3,2                 SET                                  3IO40150
       ARS     18                  SEQ CT+1                             3IO40160
       ACL     L(1)                AS THE                               3IO40170
       STA     1,2                 NUMBER OF BUFFERS                    3IO40180
       STD     3,2                 AVAILABLE                            3IO40190
       CLA     0,2                 SET RE-GENERATIVE                    3IO40200
       STA     4,2                 BUFFER CHAIN SYNC                    3IO40210
       CLA     L(0)A               SET RE-GEN                           3IO40220
       STA     0,2                 = L(0)                               3IO40230
       PIA                         SET READ                             3IO40240
       ARS     2                   MODE (DESTRUCTIVE                    3IO40250
       ALS     35                  OR NOT)                              3IO40260
       STP     2,2                                                      3IO40270
       TRA     OP1                 EXIT                                 3IO40280
IOP3   RNT     RETAIN                                                   3IO40290
       TSX     DESTRY,4                                                 3IO40300
       SIL     PTO                                                      3IO40310
       CAL     L(0)A                                                   $3IO40320
       ENB     TRAPS                                                    3IO40330
       STA     4,2                                                     $3IO40340
       TRA     OP1                                                      3IO40350
       SPACE   1                                                        3IO40360
*              DESTROY CONTENT OF FILE (RELEASE TO POOL)                3IO40370
DESTRY PXA     0,0                 SET                                  3IO40380
       STA     1,2                 BUF IN USE CT                        3IO40390
       STD     3,2                 AND SEQ CT =0                        3IO40400
       SXA     DEST2,4             SAVE IR4                             3IO40410
       TSX     FNLBC,4             FIND L(POOL)                         3IO40420
       LAC     LBC,4               L(POOL) 0O IR4                       3IO40430
DEST1  CLA*    0,2                 RELEASE                              3IO40440
       TZE     DEST2               ALL                                  3IO40450
       LDQ     0,2                 BUFFERS                              3IO40460
       ENB     L(0)                                                     3IO40470
       STA     0,2                 IN USE                               3IO40480
       TSX     BTP1,1                                                   3IO40490
       TSX     BCKBF+2,1                                                3IO40500
       TRA     DEST1                                                    3IO40510
DEST2  AXT     **,4                RESTORE IR4                          3IO40520
       TRA     1,4                 EXIT                                 3IO40530
       TTL                         INTERNAL FILE CLOSE                  3IO40540
INTCL  LFT     OUTPUT              DISCONNECT                           3IO40550
       TRA     *+3                 ANY BUFFERS                          3IO40560
       TSX     DISCON,1            IN USE                               3IO40570
       TRA     *+2                                                      3IO40580
       TSX     TRUNC,1                                                  3IO40590
       CAL     3,2                 SUM                                  3IO40600
       ARS     18                  BUFFERS IN                           3IO40610
       ACL     1,2                 USE CT AND                           3IO40620
       ALS     18                  SEQ CT FOR                           3IO40630
       LFT     OPEND               FILE OPEN                           $3IO40640
       LFT     OUTPUT              TRUE NUMBER OF BUFFERS               3IO40650
       TRA     *+2                 ADJUST COUNT                         3IO40660
       SUB     1DEC                BY ONE AS AN EXTRA                   3IO40670
       STD     3,2                 WAS ADDED WHEN INPUT                 3IO40680
       STA     1,2                 WAS OPENED                           3IO40690
       CLA*    0,2                 FORM IN                              3IO40700
       TZE     ICL2                0,2 THE                              3IO40710
       PDC     0,1                 COMPLETE                             3IO40720
       CLA     4,2                 CHAIN OF                             3IO40730
       STA     0,1                 BUFFERS                              3IO40740
       CLA*    4,2                 THAT ARE                             3IO40750
       TZE     *+2                 CURRENTLY                            3IO40760
       STD*    0,2                 IN USE                               3IO40770
ICL1   CLA     L(0)A               BY THE FILE                          3IO40780
       STA     4,2                                                      3IO40790
       RNT     RETAIN              IF BUFFERS ARE NOT TO BE             3IO40800
       TSX     DESTRY,4            RETAINED RELEASE THEM TO POOL        3IO40810
       TRA     SH4.1               EXIT                                 3IO40820
ICL2   CLA     4,2                 IF RE-GEN =L(0)                      3IO40830
       STA     0,2                 SET SYNC CHAIN                       3IO40840
       TRA     ICL1                IN THERE                             3IO40850
       TTL                         ENTER BUFFER INTO INTERNAL FILE      3IO40860
ENTIN  SXA     EIN,1               SAVE IR1                             3IO40870
       XCA                         SAVE L(BUF) IN MQ                    3IO40880
       CLA*    0,2                 INSERT BUFFER                        3IO40890
       TNZ     *+3                 INTO RE-GENERATIVE CHAIN             3IO40900
       LAC     FCW,1               SETTING UP IR1 AS L(FILE)            3IO40910
       TRA     *+2                 IF NO CHAIN EXISTS                   3IO40920
       PDC     0,1                 L(END) CHAIN TO IR1                  3IO40930
       XCA                         L(BUF) TO AC                         3IO40940
       STA     0,1                                                      3IO40950
       LDQ     L(0)D                                                    3IO40960
       LGL     18                                                       3IO40970
       STO*    0,1                                                      3IO40980
       STD*    0,2                                                      3IO40990
EIN    AXT     **,1                                                     3IO41000
       TRA     1,1                                                      3IO41010
       TTL  IOCS REQUESTED CHECKPOINT BY USER ON CHECKPOINT FILE        3IO41020
*           OR OPERATOR VIA SENSE SWITCH ON CHECKPOINT FILE             3IO41030
       SPACE   1                                                        3IO41040
CKPT.  STI     CPT2                SET CKPT ON CKPT                     3IO41050
       LDI     1PRE                FILE CODE =(01)                      3IO41060
       TRA     CPINT+2             GO INITIATE CHECKPOINT               3IO41070
*                     INTERNAL INITIATE CHECKPOINT                      3IO41080
*              INITIATES ON CODE SPECIFIED WITH FILE BITS               3IO41090
       SPACE   1                                                        3IO41100
*      TSX     CPINT,4                                                  3IO41110
*      RETURN                                                           3IO41120
       SPACE   1                                                        3IO41130
CPINT  STI     CPT2                SAVE SI                              3IO41140
       LDI     1,2                 FILE BITS                            3IO41150
       SXA     CPT1,4              TO SI                                3IO41160
       LFT     CP1+CP2                                                 $3IO41170
       TRA     CPT3                IF CODE=(00) NO CKPTS                3IO41180
       LDI     CPT2                RESTORE SI                           3IO41190
CPT1   AXT     **,4                RESTORE IR4                          3IO41200
       TRA     1,4                 EXIT                                 3IO41210
CPT2   PZE     0,,0                SI TEMP STORAGE                      3IO41220
CPT3   LNT     CP2                 IS CHECKPOINT                       $3IO41230
       TRA     CPT4                REQ'D ON CKPT FILE                   3IO41240
       LXA     CPFILE,4            YES                                  3IO41250
       TRA     CPT5                                                     3IO41260
CPT4   LFT     OUTPUT              IS OUTPUT FILE                       3IO41270
       LNT     LABEL               LABELLED,IF NOT                      3IO41280
       TRA     CPT1-1              CKPT NOT ALLOWED                     3IO41290
       LXA     FCW,4               IF CKPT FILE OR FILE                 3IO41300
CPT5   SXA     CPT6,4              TO BE WRITTEN ON                     3IO41310
       TXL     CPT1-1,4,0          DOESNT EXIST THEN EXIT               3IO41320
       CLA     0,4                                                      3IO41321
       STA     *+1                                                      3IO41322
       CAL     **                                                       3IO41323
       ANA     CPT7                                                     3IO41324
       ARS     9                                                        3IO41325
       SXA     *+5,1                                                    3IO41326
       PDC     0,1                                                      3IO41327
       TXI     *+1,1,1                                                  3IO41328
       NZT*    SYSJOB+1                                                 3IO41329
       TRA     *+3                                                      3IO4132A
       AXT     **,1                                                     3IO4132B
       TRA     *+3                                                      3IO4132C
       XEC     *-2                                                      3IO4132D
       TRA     CPT1-1                                                   3IO4132E
       CAL     LFLBLK              MOVE FILE BLOCK LOCATION             3IO41330
       SLW     CPT6+1              INTO CKPT                            3IO41340
       TSX     CKPT1,4             CALL                                 3IO41350
CPT6   PZE     **,,CPSEQ                                                3IO41360
       PZE     **,,**                                                   3IO41370
       TRA     CPT1-1              IGNORE CKPT ERROR                    3IO41380
       CAL     CPSEQ               ADVANCE                              3IO41390
       ACL     L(1)                CPSEQ NUMBER                         3IO41400
       TSX     BCDCV,4                                                  3IO41410
       ACL     6PRE                ADD HI -BLANK                        3IO41420
       SLW     CPSEQ                                                    3IO41430
       TRA     CPT1-1              EXIT                                 3IO41440
       TTL     CHECKPOINT ROUTINE PART 1 -DUMP                          3IO41450
*                           CALLING SEQUENCE                            3IO41460
*      TSX     CKPT1,4                                                  3IO41470
*      PZE     FILE,T,L(ID)                                             3IO41480
*      P       L,,N                                                     3IO41490
*              ERROR RETURN                                             3IO41500
*              NORMAL RETURN                                            3IO41510
*               IF P=PZE, L IS LOCATION OF MESSAGE BLOCK                3IO41520
       SPACE   1                                                        3IO41530
*                  =MZE, LS IS LOCATION OF FCW BLOCK                    3IO41540
*       UPON RETURN THE ACCUMULATOR CONTAINS THE RESTART CODE--         3IO41550
*      PZE     FILE CT,DN,TAPE ADDRESS                                  3IO41560
       SPACE   1                                                        3IO41570
*   ERROR RETURN IS GIVEN, IF CHECKPOINT DUMP IS ATTEMPTED AT OTHER     3IO41580
*            THAN BEGINNING OF FILE OR ON UNAVAILABLE TAPE.             3IO41590
CHCPT  STL     CHP3                                                     3IO41600
       TTR     STORE                                                    3IO41610
       LXD     SYSUCW,2                                                 3IO41620
       SXD     *+2,2                                                    3IO41630
       LXA     SYSUCW,2                                                 3IO41640
       TXI     *+1,2,**                                                 3IO41650
       TXI     *+1,2,2                                                  3IO41660
       SXA     CHP41,2                                                  3IO41670
       LXD     SYSUCW,2                                                 3IO41680
       CLS     SYSUCW                                                   3IO41690
       STO     CHP25+1                                                  3IO41700
CHP41  LDI     **,2                TEST FOR COMPLEMENT RECORD COUNT.    3IO41710
       RFT     400000                                                   3IO41720
       TRA     CHP40                                                    3IO41730
       TIX     *-3,2,4                                                  3IO41740
       CAL     TRPCH                                                    3IO41750
       ALS     -1,1                IR1=CH. NO.                         $3IO41760
       ANA     (TRAPS                                                   3IO41770
       SLW     ONETRP                                                   3IO41780
       LAC     CHP1,1              -L(UCW)                              3IO41790
       LDI     0,1                 UCW WORD1                            3IO41800
       LFT     400000                                                  $3IO41810
       TXI     CHPX2,4,1           THE TAPE IS UNAVAILABLE              3IO41820
       AXT     ONETRP,4                                                 3IO41830
       SXA     (TRAPX,4                                                 3IO41840
       TSX     ACTV,4              HOLD UNTIL THIS UNIT IS FREE         3IO41850
       MZE     CHP1                                                     3IO41860
       ZET     1,1                                                      3IO41870
       TRA     *-1                                                      3IO41880
       LDI     2,1                 CURRENT TAPE POSITION                3IO41890
       LXA     CHPX4,4                                                  3IO41900
       RFT     777777              TEST FOR BEGINNING OF FILE           3IO41910
       TXI     CHPX2,4,1                                                3IO41920
       CAL     2,4                                                      3IO41930
       STA     CHP14+2             SET UP IORT FOR MESSAGE BLOCK        3IO41940
       STD     CHP14+2                                                  3IO41950
       ORA     FCW                                                     $3IO41960
       STP     CHP14+2                                                  3IO41970
       CAL     1,4                                                      3IO41980
       PDX     0,4                 SET UP IOCP FOR IO                   3IO41990
       SXA     CHP14,4                                                  3IO42000
       CAL*    CHP14               ID INTO MESSAGE                      3IO42010
       SLW     CMT5+2                                                   3IO42020
CHPSS  PIA     **                                                       3IO42030
       LGR     33                  MOVE INFO TO MQ                     $3IO42040
       CAL     0,1                                                      3IO42050
       ARS     15                                                       3IO42060
       LGR     21                                                       3IO42070
       AXT     36,4                                                     3IO42080
       ALS     3                   LEFT HALF OF RESTART CODE            3IO42090
       LGL     3                                                        3IO42100
       TIX     *-2,4,6                                                  3IO42110
       SLW     CMT5+4                                                   3IO42120
       PXD     0,0                                                      3IO42130
       ALS     3                   RIGHT HALF OF RESTART CODE           3IO42140
       LGL     3                                                        3IO42150
       TIX     *-2,4,1                                                  3IO42160
       LDQ     BLNKS                                                    3IO42170
       LGR     6                                                        3IO42180
       STQ     CMT5+6                                                   3IO42190
       ORA     SIX                                                      3IO42200
       SLW     CMT5+5                                                   3IO42210
       LDQ     0,1                                                      3IO42220
       TSX     CVPRT,4             PRINT CHECKPOINT LINE                3IO42230
       PZE     CMT5,,7+512*DBLSP                                        3IO42240
       AXT     (TRAPS,4                                                 3IO42250
       SXA     (TRAPX,4                                                 3IO42260
       STI     CHPTP                                                   $3IO42270
       LDI     0,1                                                     $3IO42280
       CLA     2,1                 UPDATE CHECKPOINT TAPE POSITION     $3IO42290
       LNT     20000               HYPER                               $3IO42300
       ADD     1DEC                BY BUMPING FILE CT                  $3IO42310
       SLW     2,1                                                      3IO42320
       SXA     CHPSS,0                                                  3IO42330
       AXT     6,4                 SAVE SENSE SWITCH CONDITION          3IO42340
       CAL     1B17                                                     3IO42350
       PSE     119,4               SWT 7,4                              3IO42360
       TRA     *+2                                                      3IO42370
       ORS     CHPSS                                                    3IO42380
       ARS     1                                                        3IO42390
       TIX     *-4,4,1                                                  3IO42400
       AXT     1,2                 1 INTO X2 FOR WRS                    3IO42410
       STL     (CHPSW                                                   3IO42420
       ENB     (TRAPS                                                   3IO42430
       TRA     CHP4                                                     3IO42440
CHP40  RFT     200000              TEST FOR READING OR WRITING          3IO42450
       TRA     CHP41+3                                                 $3IO42460
       TXI     CHPX2,4,1           EXIT-IMPROPER TAPE POSITION          3IO42470
CHP25  IOCP    CHP24,,1                                                 3IO42480
       IOCP    **,,**                                                   3IO42490
       IOCP    CHPSS,,1                                                 3IO42500
CHP14  IOCP    **,,1                                                    3IO42510
       IOCP    *+1,,1                                                   3IO42520
       IORT    **,,**                                                   3IO42530
       TCM     CHP27,0,0,0                                             $3IO42540
       CTL     CHP29-2             BACKSPACE                           $3IO42550
       TDC     CHP26+2                                                 $3IO42560
       TCH     HYGS                                                    $3IO42570
       BES     *-4+NOHYP/NOHYP*4-*                                     $3IO42580
CMT5   BCI     7, CHECKPOINT XXXXXX CODE XXXXXX XXXXXX                  3IO42590
CPT7   OCT     017000000000                                             3IO42591
       TTL                         STORE ROUTINE                        3IO42600
*                           CALLING SEQUENCE                            3IO42610
*     STL     CHC3                                                      3IO42620
*     TTR     STORE                                                     3IO42630
       SPACE   1                                                        3IO42640
*                     USED BY CHECK POINT ROUTINES                      3IO42650
*       1. SAVES INDEX REGISTERS                                        3IO42660
*       2. SETS UP INDIRECTLY ADDRESSABLE CELL FOR DUMP TAPE            3IO42670
*       3. SETS UP CHANNEL INSTRUCTIONS                                 3IO42680
*       4. PLACES -(CHANNEL NO.) INTO X1                                3IO42690
       SPACE   1                                                        3IO42700
STORE  ENB     L(0)                DISABLE TRAPS                        3IO42710
       STI     CHPSI               SAVE SENSE INDICATOR                 3IO42720
       SXA     CHPX4,4             SAVE INDEX REGISTERS                 3IO42730
       SXA     CHPX2,2                                                  3IO42740
       SXA     CHPX1,1                                                  3IO42750
       SXA     CHPX4-4,3                                               $3IO42760
       AXT     0,1                                                     $3IO42770
       AXT     1,3                                                      3IO42780
       TXH     *+5,1,0             7090                                 3IO42790
       STL     X94                 7094                                 3IO42800
       SXA     CHPX4-3,5                                               $3IO42810
       SXA     CHPX4-2,6                                               $3IO42820
       SXA     CHPX4-1,7                                               $3IO42830
       SXA     CHPSL,0                                                  3IO42840
       AXT     4,1                 SAVE SENSE LIGHT CONDITION           3IO42850
       CAL     L(1)                                                     3IO42860
       SLT     5,1                                                      3IO42870
       TRA     *+2                                                      3IO42880
       ORS     CHPSL                                                    3IO42890
       ALS     1                                                        3IO42900
       TIX     *-4,1,1                                                  3IO42910
       CAL     1,4                 FILE,T                               3IO42920
CHP2   PAI     16                                                       3IO42930
       STA     *+2                                                      3IO42940
       RNT     100000              TEST FOR INDIRECT ADDRESSING         3IO42950
       CAL     **                  ADDRESS=ADDRESS OF KEYS STORAGE     $3IO42960
       STA     CHP1                                                     3IO42970
CHP3   AXC     **,2                                                     3IO42980
       PXD     0,0                 TEST FOR 7090 OR 7094                3IO42990
       OCT     044300012000        DOUBLE LOAD                          3IO43000
       TZE     *+2                 THIS IS A 7090                       3IO43010
       OCT     476000000016        ENTER MULTIPLE TAG MODE              3IO43020
       TXL     CHP1,2,*            CHECKPOINT                          $3IO43030
       TSX     (NDATA,4                                                 3IO43040
       PZE     CHP1,0,TESTP                                             3IO43050
       LXA     CHPX4,4                                                 $3IO43060
CHP1   CAL     **                  UCW WORD1                            3IO43070
       STD     CHP19                                                    3IO43080
       ARS     18                  PHYSICAL TAPE ADDRESS                3IO43090
       ORA     CHP2                SET MODE TO BINARY                   3IO43100
       AXT     5,1                                                      3IO43110
       STA     CHP7+3,1            SET UP SELECT INSTRUCTIONS           3IO43120
       TIX     *-1,1,1                                                  3IO43130
       ARS     9                                                        3IO43140
       ANA     *+1                                                      3IO43150
       PAC     15,1                -(CHANNEL NO.)                       3IO43160
       TXI     *+1,1,1                                                  3IO43170
       LDQ*    (TRCXI                                                   3IO43180
       SLQ     CHP17               TRCX                                 3IO43190
       LDQ*    (TCOXI                                                   3IO43200
       CAL     (CKWAT                                                   3IO43210
       ACL     L(1)                                                     3IO43220
       STA     *+1                                                      3IO43230
       SLQ     **                  TCOX                                 3IO43240
       CAL*    (RCHXI                                                   3IO43250
       ORA     D48                                                      3IO43260
CHPSL  XCL     **                  SENSE LIGHT CONDITION                3IO43270
       SLQ     CHP15               RCHX*                                3IO43280
       LDQ*    (ETTXI                                                   3IO43290
       STQ     CHP16                                                    3IO43300
       LDQ*    (TEFXI                                                   3IO43310
       SLQ     CHP13               TEFX                                 3IO43320
       TXI     *+1,1,-1                                                 3IO43330
       TRA     1,2                                                      3IO43340
CHPSI                                                                   3IO43350
CHP19  PZE     0,,**                                                    3IO43360
       EJECT                                                            3IO43370
*                                 EXIT                                  3IO43380
*                         DUMP OR RESTORE CORE                          3IO43390
*                       RESTORE INDEX REGISTERS                         3IO43400
       SPACE   1                                                        3IO43410
CHP4   LDC     SYSUBC,1            -NO. OF CHANNELS TO X1               3IO43420
       TXI     *+1,1,1             DELAY UNTIL                          3IO43430
       ZET*    (CHXSP              ALL CHANNELS                        $3IO43440
       TRA     CHP4                BECOME DORMANT.                      3IO43450
       TXH     *-3,1,0                                                  3IO43460
       ENB     L(0)                DISABLE TRAPS                        3IO43470
       STZ     (CHPSW                                                  $3IO43480
CHP30  LDI*    CHP1                                                    $3IO43490
       LFT     20000               7909 CHANNEL                        $3IO43500
       TRA     CHGSH               YES                                 $3IO43510
       BES     *-3+NOHYP/NOHYP*3-*                                     $3IO43520
       TXL     *+5,2,0             ZERO IF RESTART                     $3IO43530
       AXT     6,1                                                     $3IO43540
       TSX     RDWR,4              WRITE MESSAGE BLOCK                 $3IO43550
       PZE     CHP25                                                    3IO43560
       TRA     CHP6                                                     3IO43570
       TSX     RDWR,4                                                   3IO43580
       PZE     CHP8                                                     3IO43590
       TRA     CHP6                RTC RETURN                           3IO43600
       AXT     2,2                 2 INTO X2 FOR WEF                    3IO43610
       TSX     RDWR,4                                                   3IO43620
       PZE                                                              3IO43630
       TRA     CHP6                                                     3IO43640
CHP76  AXT     L(0),4                                                  $3IO43650
       SXA     (TRAPX,4                                                 3IO43660
       LXD     SYSUBC,1                                                 3IO43670
       SXD     *+1,1                                                    3IO43680
       TXI     *+1,1,**                                                 3IO43690
       TXI     *+1,1,10                                                 3IO43700
       SXA     *+5,1                                                    3IO43710
       TXI     *+1,1,1                                                  3IO43720
       SXA     *+4,1                                                    3IO43730
       TXI     *+1,1,-11                                                3IO43740
       CAL     CHP10               ACTIVATE ALL CHANNELS                3IO43750
       STA     **,1                                                     3IO43760
       TRA     **,1                                                     3IO43770
CHP11  TIX     *-2,1,2                                                  3IO43780
       NZT     X94                 7090                                $3IO43790
       TRA     CHPX4               YES                                 $3IO43800
       OCT     076000000016        LEAVE MULTIPLE TAG MODE             $3IO43810
       AXT     **,3                RESTORE IR FOR 94                   $3IO43820
       AXT     **,5                                                    $3IO43830
       AXT     **,6                                                    $3IO43840
       AXT     **,7                                                    $3IO43850
CHPX4  AXT     **,4                RESTORE INDEX REGISTERS              3IO43860
CHPX2  AXT     **,2                                                     3IO43870
       SLF                                                              3IO43880
       AXT     4,1                 RESTORE SENSE LIGHTS                 3IO43890
       CAL     CHPSL                                                    3IO43900
       LBT                                                              3IO43910
       TRA     *+2                                                      3IO43920
       SLN     5,1                                                      3IO43930
       ARS     1                                                        3IO43940
       TIX     *-4,1,1                                                  3IO43950
       AXT     (TRAPS,1                                                 3IO43960
       SXA     (TRAPX,1                                                 3IO43970
CHPX1  AXT     **,1                                                     3IO43980
CHP10  PIA     CHP11               TAPE POSITION OF CHECK POINT         3IO43990
       STZ     X94                 ZERO 7094 SWITCH                    $3IO44000
       ENB     (TRAPS                                                   3IO44010
       TRA     4,4                 EXIT                                 3IO44020
X94    PZE                         7094 SWITCH                         $3IO44030
CHGSH  PIA                                                             $3IO44040
       ANA     DEC15               PUT UNIT NUMBER                     $3IO44050
       ORA     HYSEL               IN SELECT ORDER                     $3IO44060
       STD     CHP27-1                                                 $3IO44070
       CLA     CHP11+3                                                 $3IO44080
       STA     CHP26                                                   $3IO44090
       STA     CHP28                                                   $3IO44100
       PIA                                                             $3IO44110
       ARS     23                  SET THE SMS                         $3IO44120
       ANA     L(1)                TO CORRECT                          $3IO44130
       ORS     CHP26               INTERFACE                           $3IO44140
       ORS     CHP28                                                   $3IO44150
       CAL     CDTCT               MAKE COMMANDS                       $3IO44160
       STP     CHP14+2             COPY AND DISCONNECT                 $3IO44170
       TXL     *+3,2,0             ZERO IF RESTART                     $3IO44180
       TSX     *+4,4                                                   $3IO44190
       PZE     CHP26               CHECKPOINT CTLW                     $3IO44200
       TSX     *+2,4                                                   $3IO44210
CHP24  PZE     CHP28                                                    3IO44220
       XEC     CHP15               START CHANNEL                       $3IO44230
       TSX     (CKWAT,4            WAIT UNTIL FINISHED                 $3IO44240
       ZET     CHP29+1             WAS THERE AN ERROR                  $3IO44250
       TRA     CHP29               YES                                 $3IO44260
       CAL     FCW                 RESTORE COMMAND                     $3IO44270
       STP     CHP14+2             TO IORT                             $3IO44280
       TXL     *+3,2,0             ZERO IF RESTART                     $3IO44290
       TSX     (NDATA,4            WRITE TAPE MARK                     $3IO44300
       PZE     CHP1,,HWTMP                                             $3IO44310
       TRA     CHP76                                                   $3IO44320
CHP26  SMS     14                                                      $3IO44330
       LCC     4                                                       $3IO44340
       LIPT    *+1                                                     $3IO44350
       CTLW    CHP27-1                                                 $3IO44360
       TCH     CHP25                                                   $3IO44370
       OCT     120600120112                                            $3IO44380
CHP27  LCC     5                                                       $3IO44390
       LIPT    *+1                                                     $3IO44400
       CTLW    CHP27-1                                                 $3IO44410
       CPYP    0,,1                                                    $3IO44420
       CPYD    1,,-1                                                   $3IO44430
       TCM     HYGS+3,0,0,0                                            $3IO44440
       CTL     CHP29-2                                                 $3IO44450
       TDC     CHP27+1                                                 $3IO44460
HYGS   XMT     CHP29+1,,1                                              $3IO44470
       TRA     CHP29+2             ERROR TRANSFER                      $3IO44480
       CTL     CHP29-1                                                 $3IO44490
       LCC     0                                                       $3IO44500
       WTR     *                   WAIT                                $3IO44510
CHP28  SMS     14                                                      $3IO44520
       CTLR    CHP27-1                                                 $3IO44530
       CPYP    0,,1                                                    $3IO44540
       CPYD    1,,-1                                                   $3IO44550
       TCM     HYGS+3,0,0,0        TRANSFER NO ERRORS                  $3IO44560
       CTL     *+3                 BACKSPACE.                          $3IO44570
       LIPT    CHP28+1             RETRY                               $3IO44580
       OCT     030512010000        BACKSPACE CTL                       $3IO44590
       OCT     031112010000        UNLOAD CARTRIDGE                    $3IO44600
CHP29  IOT                                                             $3IO44610
       PZE     0                   ZERO IF NO ERROR ON C.P.            $3IO44620
       STZ     *-1                                                     $3IO44630
       TRA     CHP70+4             PRINT MSG. AND RETRY                $3IO44640
       BES     CHGSH+NOHYP/NOHYP**-NOHYP/NOHYP*CHGSH-*                 $3IO44650
       TTL                         READ OR WRITE CHECKPOINT             3IO44660
*                      UPON ENTRY X2 MUST CONTAIN                       3IO44670
*                              0 FOR RDS                                3IO44680
*                              1 FOR WRS                                3IO44690
*                              2 FOR WEF                                3IO44700
CHPRW  RUNA    **                                                       3IO44710
       WEFA    **                                                       3IO44720
CHP7   WTBA    **                                                       3IO44730
       RTBA    **                                                       3IO44740
CHP6   BSRA    **                                                       3IO44750
       TXL     RDWR+1,2,0          TXL IF RDS                           3IO44760
       XEC     CHP7                                                     3IO44770
       XEC     CHP16                                                    3IO44780
       TRA     CHP18               EOT ON ERASE                         3IO44790
RDWR   SXA     CHP20+4,4                                                3IO44800
       TXL     *+3,2,0                                                 $3IO44810
       TXH     *+2,2,1                                                 $3IO44820
       TNX     CHP70,1,1                                               $3IO44830
       XEC     CHP7+1,2            SELX                                 3IO44840
       TXH     *+2,2,1             TXH IF WEF                           3IO44850
CHP15  RCHA*   1,4                                                      3IO44860
       TSX     (CKWAT,4                                                 3IO44870
       LXA     CHP20+4,4                                                3IO44880
       IOT                                                              3IO44890
       TRA     CHP20               I/O CHECK                            3IO44900
CHP16  ETTA                                                             3IO44910
       TRA     CHP70                                                    3IO44920
CHP13  TEFA    *                                                        3IO44930
CHP17  TRCA    2,4                                                      3IO44940
       TRA     3,4                                                      3IO44950
CHP18  LDQ     CHP19                                                    3IO44960
       TSX     CVPRT,4                                                  3IO44970
       PZE     CMT4,,2                                                  3IO44980
       TSX     STOP,4                                                   3IO44990
CHP20  TSX     PROUT,4                                                  3IO45000
       PZE     1                                                        3IO45010
       PZE     CMT8,,2                                                  3IO45020
       TSX     PAWS,4                                                   3IO45030
       AXT     **,4                                                     3IO45040
       TRA     CHP16                                                    3IO45050
CHPTP  PZE     **                                                       3IO45060
CHP8   IOCP    0,,1                                                     3IO45070
       IOCD    1,,-1                                                    3IO45080
D48    PZE     0,0,48                                                   3IO45090
CHP70  LAC     CHP1,4              HERE ON EOT                          3IO45100
       CLA     1DEC                                                    $3IO45110
       STO     2,4                                                     $3IO45120
       XEC     CHPRW               RUN                                  3IO45130
       TSX     PROUT,4                                                  3IO45140
       PZE     1                                                        3IO45150
       PZE     CHP71,,8+512*DBLSP                                      $3IO45160
       CAL     BLNKS                                                   $3IO45170
       ANA     XCPTP                                                   $3IO45180
       LAC     CHP1,4                                                  $3IO45190
       SLW     CMT5+6                                                  $3IO45200
       LDQ     0,4                                                     $3IO45210
       TSX     CVPRT,4                                                 $3IO45220
       PZE     CMT5,,7+512*DBLSP                                       $3IO45230
       TRA     CHP30                                                   $3IO45240
CHP71  BCI     8,CHECKPOINT INVALID, MOUNT NEW REEL TO CONTINUE        $3IO45250
CMT4   BCI     2,EOT ON ERASE                                           3IO45260
CMT8   BCI     2,I/O CHECK                                              3IO45270
       TTL                         BASIC IOCS CONSTANTS                 3IO45280
TRPCH  PZE     1,,1                                                     3IO45290
ONETRP PZE     **                                                       3IO45300
FULIO  BSS     0                   END BASIC IOBS                       3IO45310
B5FIN  BSS     0                   ....END BASIC IOCS STORAGE........   3IO45320
F6     BES     1                                                        3IO45330
       EJECT                                                            3IO45340
.LABEL CONTRL  S7,F7                                                    3IO45350
S7     BSS     0                                                        3IO45360
*      LABEL COMMUNICATION REGION WITH .LABEL                           3IO45370
*                                                                       3IO45380
.LABRT CONTRL  LABRT1,LABRT1                                            3IO45390
.B6FIN CONTRL  B6FIN,B6FIN                                              3IO45400
.LABCO CONTRL  LABCO,LABCO                                              3IO45410
.LABCI CONTRL  LABCI,LABCI                                              3IO45420
.LABOO CONTRL  LABOO,LABOO                                              3IO45430
.MNT6  CONTRL  MNT6,MNT6                                                3IO45440
.LAEOF CONTRL  LAEOF,LAEOF                                              3IO45450
.LBEOT CONTRL  LBEOT,LBEOT                                              3IO45460
SWTE   SWT     LERIG                                                    3IO45470
       TTL     SET UP INDIRECT REFERENCES TO LABEL HANDLING ROUTINES    3IO45480
*           THE ROUTINE SPECIFIED IN THE DECREMENT OF WORD 3            3IO45490
*            OF THE FILE IS USED AS THE BASE ADDRESS OF THE             3IO45500
*                FIVE (5) IMAGE ROUTINES WHICH ARE USED                 3IO45510
       SPACE   1                                                        3IO45520
*      TSX     LBSET,1             -L(FILE) IN  IR2                     3IO45530
*      RETURN                      IR4  DESTROYED                       3IO45540
*                                                                       3IO45550
LBSET  STZ     HHDR                RESET HYPER LABEL FLAG              *3IO45560
       CLA     5,2                                                     *3IO45570
       ANA     SIX                                                     *3IO45580
       TZE     *+3                 729,1301                            *3IO45590
       STL     HHDR                                                    *3IO45600
       TRA     *+4                                                     *3IO45610
       BES     LBSET+NOHYP/NOHYP**-NOHYP/NOHYP*LBSET-*                  3IO45620
       CLA     2,2                                                     *3IO45630
       PDX     0,4                                                     *3IO45640
       TXH     *+2,4,0                                                 *3IO45650
       LXD     LBRTN,4             SETUP LIST OF                       *3IO45660
       PXA     0,4                 ENTRIES TO                          *3IO45670
       AXT     5,4                 IMAGE ROUTINES                       3IO45680
       STA     LABRT5+1,4                                               3IO45690
       ACL     L(1)                                                     3IO45700
       TIX     *-2,4,1                                                  3IO45710
       STZ     DHDR                DISK HEADER FLAG                    $3IO45720
       TRA     1,1                                                      3IO45730
LABRT1 TSX     **,1                INPUT LABEL CHECK                    3IO45740
LABRT2 TSX     **,1                INPUT TRAILER CHECK                  3IO45750
LABRT3 TSX     **,1                CHECK LABEL FOR VALID OUTPUT REEL    3IO45760
LABRT4 TSX     **,1                PREPARE OUTPUT TRAILER               3IO45770
LABRT5 TSX     **,1                PREPARE OUTPUT LABEL                 3IO45780
       SPACE   1                                                        3IO45790
*                    STANDARD LABEL IMAGE ROUTINES                      3IO45800
LBRTN  TXL     LCKIN,,LBRTN        INPUT LABEL CHECK                    3IO45810
       TRA     TCKIN               INPUT TRAILER CHECK                  3IO45820
       TRA     LCKOF               CHECK LABEL FOR VALID OUTPUT REEL    3IO45830
       TRA     TPROF               PREPARE OUTPUT TRAILER               3IO45840
       TRA     LPROF               PREPARE OUTPUT LABEL                 3IO45850
       TTL                         LABEL HANDLER AT EOF                 3IO45860
*      TSX     LAEOF,1                                                  3IO45870
*             EXITS AT SYNCR+2 IF EOR TRAILER ENCOUNTERED               3IO45880
*              EXITS AT EOF.1 IF EOF TRAILER ENCOUNTERED                3IO45890
*           (IN LAST CASE,EOF FOLLOWING TRAILER IS SKIPPED)             3IO45900
       SPACE   1                                                        3IO45910
LAEOF  SXA     LF1,4               SAVE IR4                             3IO45920
       SXA     LF1+1,1             AND IR1                              3IO45930
       TSX     LBSET,1             SETUP LABEL IMAGE CALLS              3IO45940
       TSX     RDLAB,4             READ TRAILER                         3IO45950
       TRA     LF3                 NO TRAILER EXIT OR EOF EXIT          3IO45960
       STZ     TEMP                                                     3IO45970
       XEC     LABRT2              XEC TRAILER CHECK                    3IO45980
       TQP     LF2                 EOR- SWITCH REELS AND CONTINUE      $3IO45990
       RIL     NOEOT                                                   $3IO46000
       CLA     5,2                 TEST FOR DISK                       $3IO46010
       TMI     *+2                 YES                                 $3IO46020
       TSX     SKIP,4              EOF-SKIP OVER EOF MARK AND EXIT     $3IO46030
       NZT     TEMP                IF SEQUENCE ERROR                    3IO46040
       TRA     EOF.0               TAKE EOF EXIT                        3IO46050
       TRA     SEQEX               TAKE SEQUENCE EXIT                   3IO46060
LF2    TSX     SWITCH,1            SWITCH REELS                        $3IO46070
       STI     CPT2                SAVE INDICATORS                     $3IO46080
       STL     SWING                                                (12)3IO46085
       TSX     LABCI,1             HANDLE LABELS NEW REEL               3IO46090
       STZ     SWING                                                (12)3IO46095
       LDI     CPT2                RESTORE INDICATORS                  $3IO46100
       TSX     CPINT,4             ISSUE CONDITIONAL CHECKPOINT         3IO46110
LF1    AXT     **,4                RESTORE IR4                          3IO46120
       AXT     **,1                AND IR1                              3IO46130
       NZT     TEMP                UNLESS SEQ ERROR IN TRAILER          3IO46140
       TRA     SYNCR+2             CONTINUE TO SYNC                     3IO46150
       TRA     SEQEX                                                    3IO46160
LF3    TSX     PROUT,4             WHEN TRAILER NOT RECOGNIZABLE        3IO46170
       PZE     2                   BECAUSE OF LENGTH                    3IO46180
       MZE     9,2,3               PRINT '' NO TRAILER''                3IO46190
       PZE     LMG11,,2+512*DBLSP  AND TAKE EOF EXIT                    3IO46200
       TRA     EOF.0                                                    3IO46210
       TTL                         LABEL HANDLER INPUT FILE             3IO46220
*      TSX     LABCI,1                                                  3IO46230
*      RETURN                                                           3IO46240
       SPACE   1                                                        3IO46250
LABCI  SXA     LH4,4               SAVE IR4                             3IO46260
       SXA     LH4+1,1             AND IR1                              3IO46270
       TSX     LBSET,1             SET UP LABEL IMAGE CALLS            $3IO46280
       CLA     5,2                 IS THIS DISK                        $3IO46290
       TPL     LH2                 NO                                  $3IO46300
       STL     DHDR                DISK HEADER FLAG                    $3IO46310
       TRA     LH2                 SKIP UNLOAD(FOR ERROR RETRY)         3IO46320
       ZET     DHDR                IF DISK NEXT JOB                    $3IO46330
       TSX     STOPD,4             YES                                 $3IO46340
LH1    TSX     NDSEL+1,4           UNLOAD IF ERROR                      3IO46360
       PZE     0,2,RUNOP           RE-TRY AFTER REEL SWITCH             3IO46370
LH2    TSX     LBDNR,4             SET DENSITY FOR READING LABEL        3IO46380
       TSX     RDLAB,4             READ LABEL                           3IO46390
       TRA     LH7                 EOF OR NO LABEL EXIT                 3IO46400
LH2.5  XEC     LABRT1              VALIDATE CORRECT LABEL               3IO46410
       TRA     LH3                 OK                                   3IO46420
       NZT     DHDR                                                    $3IO46430
       TRA     *+3                                                     $3IO46440
       CAL     LH6.5               DISK                                $3IO46450
       TRA     *+4                                                     $3IO46460
       BES     *-4+NOCH/NOCH*4-*                                        3IO46470
       LFT     SEARCH              IF SEARCHING GO OUT AND TEST         3IO46480
       TRA     LH8                                                      3IO46490
       CAL     LH6                 PRINT                                3IO46500
       TSX     LBERR,4             --INPUT REEL INVALID--              $3IO46510
       XEC     SWTE                IF SENSE SWITCH ASSIGNED IS UP       3IO46520
       TRA     LH1-2               TRY NEXT UNIT IF NOT DISK           $3IO46530
LH3    NZT     LH11                                                     3IO46540
       TRA     LH3.5                                                    3IO46550
*                  LABEL FOUND..... NOTIFY OPERATOR                     3IO46560
       TSX     PROUT,4                                                 *3IO46570
       PZE     2                                                       *3IO46580
       MZE     9,2,3               ''FILE-NAME''                       *3IO46590
       PZE     LMG10,,1            ''FOUND''                           *3IO46600
       STZ     LH11                RESET SEARCH SWITCH                 *3IO46610
*                                                                       3IO46620
LH3.5  ZET     DHDR                                                     3IO46630
       TRA     LH4                                                      3IO46640
       TSX     SKIP,4                                                   3IO46650
       TSX     DENSE,4             SET FILE DENSITY                     3IO46660
       CLA     LAREA+6             IF CHECKPOINT FOLLOWS,               3IO46670
       ZET     HHDR                                                     3IO46680
       CLA     LAREA+10                                                 3IO46690
       LBT                                                              3IO46700
       TRA     *+2                                                      3IO46710
       TSX     SKIP,4              SKIP OVER THAT FILE.                 3IO46720
LH4    AXT     **,4                RESTORE IR4                          3IO46730
       AXT     **,1                AND IR1                              3IO46740
       TRA     1,1                 EXIT                                 3IO46750
LH6    PZE     LMSG1,,3            ERROR MESSAGE PARAMETER              3IO46760
LH6.5  PZE     BLNKS,,1                                                $3IO46770
LH7    TSX     PROUT,4             IF NO LABEL ON OUTPUT                3IO46780
       PZE     2                   PRINT '' NO LABEL'' AND              3IO46790
       MZE     9,2,3               AND CONTINUE FURTHER                 3IO46800
       PZE     LMG13,,4+512*DBLSP  LABEL CHECKS WILL CATCH ERROR       *3IO46810
       TRA     LH2.5                                                    3IO46820
*                       LABEL SEARCHING ROUTINES                        3IO46830
LH8    ZET     LH11                IF INITIAL ENTRY                     3IO46840
       TRA     LH9                 PRINT LABEL SEARCHING MESSAGE        3IO46850
       STL     LH11                AND GIVE OPERATOR CHOICE             3IO46860
       TSX     PROUT,4             PRINT MESSAGE INFORMING OPERATOR OF  3IO46870
       PZE     2                   THE IMPENDING SEARCH                 3IO46880
       MZE     9,2,3                                                    3IO46890
       PZE     LMG12,,9                                                 3IO46900
       STL     SERSW               SET SWITCH CELL NON ZERO             3IO46910
       XEC     SWTE                IF SENSE SWITCH IS ORIGINALLY        3IO46920
       STZ     SERSW               DOWN                                 3IO46930
LH9    TSX     PROUT,4             PRINT THE LABEL OF BYPASSED          3IO46940
       PZE     2                   FILE FOR OPERATOR                   *3IO46950
       PZE     LAREA,,12                                                3IO46960
       PZE     LAREA1+2,,4                                             *3IO46970
       TSX     SKIP,4              SKIP OVER EOF FOLLOWING LABEL        3IO46980
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO46990
       TSX     DENSE,4             SET FILE DENSITY                     3IO47000
       CLA     LAREA+6                                                  3IO47010
       ZET     HHDR                                                    *3IO47020
       CLA     LAREA+10            IF CHECKPOINT FOLLOWS               *3IO47030
       LBT                         THEN SKIP OVER IT                    3IO47040
       TRA     *+3                                                      3IO47050
       TSX     SKIP,4              SKIP CKPT RECORD ( A FILE)           3IO47060
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO47070
       TSX     SKIP,4              SKIP OVER BODY OF DATA FILE          3IO47080
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO47090
       TSX     RDLAB,4             READ TRAILER                         3IO47100
       TRA     LH9.9               EOF OR NO TRAILER EXIT               3IO47110
LH9.2  XEC     LABRT2              VALIDATE TRAILER                     3IO47120
       TQP     *+3                 MQ + IF EOR                          3IO47130
       TSX     SKIP,4              SKIP OVER EOF AFTER TRAILER          3IO47140
       TRA     *+2                 GO CHECK NEXT FILE                  $3IO47150
       TSX     SWITCH,1            SWITCH REELS IF EOR                  3IO47160
       TSX     LH14,4              CHECK OPERATOR INTERVENTION         $3IO47170
       TRA     LH2                 GO CONTINUE SEARCH                   3IO47180
LH9.9  TSX     PROUT,4             PRINT                                3IO47190
       PZE     2                   '' NO TRAILER'' AND                  3IO47200
       MZE     9,2,3               AND CONTINUE                         3IO47210
       PZE     LMG11,,2+512*DBLSP                                       3IO47220
       TRA     LH9.2-2                                                 *3IO47230
       SPACE   1                                                        3IO47240
*       INTERRUPT SEARCH IF OPERATOR PLACES SENSE SWITCH 4 DOWN         3IO47250
LH14   NZT     SERSW               IF SENSE SWITCH WERE ORIGINALLY      3IO47260
       TRA     LH15                UP THEN TEST FOR INTERRUPT           3IO47270
       XEC     SWTE                IF DOWN THEN RECORD WHEN             3IO47280
       STZ     SERSW               IT IS PLACED UP                      3IO47290
       TRA     1,4                 EXIT                                 3IO47300
LH15   XEC     SWTE                IF SENSE SWITCH DOWN AFTER BEING UP  3IO47310
       TRA     1,4                 THEN INTERRUPT SEARCH                3IO47320
       TRA     LH1                 ELSE CONTINUE                        3IO47330
       TTL                         LABEL HANDLER OPEN OUTPUT FILE       3IO47340
*      TSX     LABOO,1                                                  3IO47350
       SPACE   1                                                        3IO47360
LABOO  SXA     LOO3,4              SAVE IR4                             3IO47370
       SXA     LOO3+1,1            IR1                                  3IO47380
       TSX     LBSET,1             SETUP CALLS ON IMAGE ROUTINES        3IO47390
       CLA     5,2                                                     $3IO47400
       TPL     *+3                                                     $3IO47410
       STL     DHDR                DISK HEADER FLAG                    $3IO47420
       TRA     LOO1                                                    $3IO47430
LOOZ   TSX     LBDNR,4             SET DENSITY FOR READING LABELS       3IO47440
       AXC     2,4                 IF REEL                              3IO47450
       CLA*    0,2                 NOT AT LOAD POINT                    3IO47460
       ANA     MSK3                SAVE ORIGINAL TAPE POSITION         *3IO47470
       STO     TEMP                                                     3IO47480
       TZE     LOO1                GO INTRODUCE *****                   3IO47490
       TSX     LOO5,4              AS TAPE SERIAL NUMBER                3IO47500
LOOA   ZET     DHDR                DISK                                $3IO47510
       TSX     STOPD,4             YES-NEXT JOB                        $3IO47520
       TSX     NDSEL+1,4           REWIND UNLOAD IF                     3IO47530
       PZE     0,2,RUNOP           REEL INVALID BEFORE RE-TRY           3IO47540
       STZ     TEMP                SET TEMP =0 SHOWING LOAD PT START    3IO47550
LOO1   TSX     RDLAB,4             READ LABEL ON OUTPUT REEL            3IO47560
       TRA     LOO10               EOF OR NO LABEL                      3IO47570
       XEC     LABRT3              VALIDATE OK FOR USE                  3IO47580
       TRA     LOO2                OK                                   3IO47590
       TRA     LOO7                RETENTION NOT EXPIRED                3IO47600
       ZET     DHDR                DISK-                               $3IO47610
       TRA     LOO4                YES                                 $3IO47620
LOO5   AXC     1,1                                                      3IO47630
       ZET     HHDR                                                     3IO47640
       AXC     5,1                                                      3IO47650
       LDQ     ASTER                                                    3IO47660
       ZET     HHDR                INTRODUCE  ***** AS                  3IO47670
       RQL     6                   REEL SERIAL NUMBER                   3IO47680
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO47690
       STQ     LAREA,1                                                  3IO47700
       TXI     *+1,4,LOOA-1                                             3IO47710
       TXL     LOO2A,4,0                                                3IO47720
       CAL     LOO8                -INVALID REEL                       *3IO47730
       TRA     *+2                                                      3IO47740
LOO7   CAL     LOO9                                                     3IO47750
       TSX     LBERR,4             PRINT LABEL ERROR                    3IO47760
       XEC     SWTE                AND CAUSE ... IF SENSE SWITCH        3IO47770
       TRA     LOOA                IS DOWN ACCEPT AS OK                $3IO47780
LOO2   ZET     DHDR                                                    $3IO47790
       TRA     LOO4                DISK                                $3IO47800
       BES     *-2+NOCH/NOCH*2-*                                        3IO47810
       AXC     1,1                                                     *3IO47820
       ZET     HHDR                                                    *3IO47830
       AXC     5,1                                                     *3IO47840
LOO2A  AXC     3,4                 IF TAPE WAS INITIALLY                3IO47850
       CAL     LAREA,1             AT LOAD POINT PLACE REEL            *3IO47860
       NZT     TEMP                SERIAL NUMBER INTO UCW               3IO47870
       SLW*    0,2                 WORD 4. IF NOT AT LOAD POINT         3IO47880
       CAL*    0,2                 PICK UP TAPE SERIAL NUMBER           3IO47890
       SLW     LAREA,1             FROM UCW WORD 4 AND PLACE           *3IO47900
       ZET     HHDR                IN LABEL AREA FOR FILE S/N          *3IO47910
       SLW     11,2                                                    *3IO47920
       LFT     OPEND                                                    3IO47930
       TRA     *+3                 IF FILE SERIAL IS                   *3IO47940
       NZT     6,2                 ZERO THEN ASSIGN REEL                3IO47950
       SLW     6,2                 SERIAL AS FILE SERIAL NUMBER         3IO47960
       ZET     TEMP                UNLESS TAPE WERE AT LD PT            3IO47970
       TRA     *+3                 INITIALLY, SKIP                      3IO47980
       TSX     NDSEL+1,4           BSR OF LABEL READ                   *3IO47990
       PZE     0,2,BSROP                                                3IO48000
LOO4   XEC     LABRT5              PREPARE LABEL RECORD                $3IO48010
       TSX     LBDNW,4             SET LABEL DENSITY FOR WRITING        3IO48020
       TSX     WRLAB,4             WRITE LABEL                         $3IO48030
       TRA     LOO6                EOT-CAUSE REEL SWITCH                3IO48040
       LFT     OPEND               IF FILE BEING                        3IO48050
       TRA     LOO3-1              OPENED PRINT                         3IO48060
       TSX     DRANO,4             LABEL ON LINE                        3IO48070
       AXT     LMSG9,4                                                 *3IO48080
       ZET     DHDR                                                    *3IO48090
       AXT     DLABEL,4            ''DISK FILE LABEL''                 $3IO48100
       BES     *-2+NOCH/NOCH*2-*                                        3IO48110
       NZT     HHDR                                                    *3IO48120
       TRA     *+3                                                     *3IO48130
       TSX     AB00,4                                                  *3IO48140
       AXT     HLABEL,4            ''HYPERTAPE LABEL''                 *3IO48150
       BES     *-4+NOHYP/NOHYP*4-*                                      3IO48160
       SXA     LOO2.6,4                                                *3IO48170
       CLA     1,2                 INSERT                              $3IO48180
       LGR     17                  LABEL DENSITY                       $3IO48190
       CLA     LMSG9+4             INTO MESSAGE                         3IO48200
       TQP     *+2                                                      3IO48210
       CLA     LMSG9+3                                                  3IO48220
       STO     LMSG9+1                                                  3IO48230
       TSX     PROUT,4                                                  3IO48240
       PZE     5                                                       *3IO48250
       MZE     MESS1,,2            '' UNIT ***** **FILE-NAME**''        3IO48260
       MZE     9,2,3               ''LABEL HIGH DENSITY'' OR            3IO48270
LOO2.6 PZE     LMSG9,,3            ''LABEL LOW DENSITY''               $3IO48280
       PZE     LAREA,,12                                                3IO48290
       PZE     LAREA1+2,,4+512*DBLSP                                   *3IO48300
       TSX     DENSE,4                                                  3IO48310
LOO3   AXT     **,4                RESTORE IR4                          3IO48320
       AXT     **,1                AND IR1                              3IO48330
       TRA     1,1                 EXIT                                 3IO48340
*                   EOT OCCURRED WHILE WRITING LABEL                    3IO48350
LOO6   TSX     NDSEL+1,4           WRITE EOF SIGNIFYING                 3IO48360
       PZE     0,2,WEFOP           END DATA                             3IO48370
       NOP                         IGNORE EOT                           3IO48380
       CAL     1EOR                PREPARE AND                          3IO48390
       XEC     LABRT4              WRITE EOR                            3IO48400
       TSX     WRLAB,4             TRAILER                              3IO48410
       NOP                         (IGNORING EOT)                       3IO48420
       TSX     SWITCH,1            SWITCH REELS                         3IO48430
       TRA     LOOZ                CONTINUE ON NEXT REEL                3IO48440
*                SHORT LABEL RECORD ON REEL TO BE USED                  3IO48450
LOO10  CAL     LOO11               PRINT '' NO LABEL ERROR              3IO48460
       TSX     LBERR,4             AND STOP                             3IO48470
       XEC     SWTE                IF SENSE SWITCH IS DOWN              3IO48480
       TRA     LOO1-3              ACCEPT REEL AS OK                    3IO48490
       TRA     LOOA-1              ELSE RUN AND RETRY                   3IO48500
SWING  PZE     0                                                    (12)3IO48505
LOO8   PZE     LMSG2,,4            ''OUTPUT REEL INVALID''              3IO48510
LOO9   PZE     LMSG3,,4            ''RETENTION NOT EXPIRED''            3IO48520
LOO11  PZE     LMSG4,,4+512*DBLSP  ''NO LABEL,BLANK CREATED''           3IO48530
DHDR   PZE     **                  DISK HEADER                         $3IO48540
HHDR   PZE     **                  HYPERTAPE HEADER                    *3IO48550
       TTL                         LABEL CLOSE OUTPUT FILE              3IO48560
*      TSX     LABCO,1                                                  3IO48570
*      RETURN                                                           3IO48580
       SPACE   1                                                        3IO48590
LABCO  SXA     LOO3,4              SAVE IR4                             3IO48600
       SXA     LOO3+1,1            AND IR1                              3IO48610
       TSX     LBSET,1             SETUP IMAGE CALLS                    3IO48620
       CAL     1EOF                PREPARE AND                          3IO48630
LCO1   XEC     LABRT4              WRITE EOF                            3IO48640
       TSX     WRLAB,4             TRAILER                              3IO48650
       TRA     LOO3                IGNORE EOT (IOEX DOES RECORD IT)     3IO48660
       TRA     LOO3                EXIT                                 3IO48670
       SPACE   1                                                        3IO48680
*                         LABEL OUTPUT AT EOT                           3IO48690
       SPACE   1                                                        3IO48700
*      TSX     LBEOT,1                                                  3IO48710
*      RETURN                                                           3IO48720
       SPACE   1                                                        3IO48730
LBEOT  SXA     LOO3,4              SAVE IR4                             3IO48740
       SXA     LOO3+1,1            AND IR1                              3IO48750
       TSX     LBSET,1             SETUP IMAGE CALLS                    3IO48760
       CAL     1EOR                FORM AND WRITE                       3IO48770
       TRA     LCO1                EOR TRAILER                          3IO48780
       SPACE   1                                                        3IO48790
*                       DENSITY SETTING ROUTINES                        3IO48800
*                    FOR LABEL READING AND WRITING                      3IO48810
       SPACE   1                                                        3IO48820
*      TSX     LBDNR,4             SET READ  DENSITY                    3IO48830
*      TSX     LBDNW,4             SET WRITE DENSITY                    3IO48840
       SPACE   1                                                        3IO48850
LBDNR  CLA     1,2                 SET DENSITY                          3IO48860
       ARS     2                   LABEL READING                        3IO48870
       TRA     DENSE+1                                                  3IO48880
LBDNW  CLA     1,2                 SET DENSITY                          3IO48890
       ARS     1                   LABEL WRITING                        3IO48900
       TRA     DENSE+1                                                  3IO48910
       TTL                         FORWARD SPACE FILE                   3IO48920
*      TSX     SKIP,4                                                   3IO48930
       SPACE   1                                                        3IO48940
SKIP   SXA     SK1,4               SAVE IR4                             3IO48950
       ZET     HHDR                                                    *3IO48960
       TRA     SK3                                                     *3IO48970
       CAL     SK2                 PLACE SKIP SELECT                    3IO48980
       AXC     1,4                 IN UNIT CONTROL                      3IO48990
       ORS*    0,2                 WORD                                 3IO49000
SKXWT  CLA     *+1                 SET                                  3IO49010
       STA     WAIT                WAIT FOR TRAP                        3IO49020
       TSX     ACTV+1,4            ACTIVATE WITH                        3IO49030
       MZE     0,2                 PRIORITY                             3IO49040
       XEC     WAIT                WAIT                                 3IO49050
*                  HYPERTAPE SKIP FILE                                  3IO49060
SK3    LDQ     1,2                                                     $3IO49070
       RQL     18                                                      $3IO49080
       TQP     *+4                 NOT IN READ BACKWARD MODE           $3IO49090
       TSX     (NDSLX,4                                                $3IO49100
       PZE     0,2,HBSFP           BACKSPACE FILE                      $3IO49110
       TRA     *+3                                                     $3IO49120
       TSX     (NDSLX,4            SKIP FILE                           $3IO49130
       PZE     0,2,HSKFP                                               $3IO49140
       BES     SK3+NOHYP/NOHYP**-NOHYP/NOHYP*SK3-*                      3IO49150
*                    RETURNS HERE WHEN EOF REACHED                      3IO49160
SK1    AXT     **,4                RESTORE IR4                          3IO49170
       TRA     1,4                 EXIT                                 3IO49180
SK2    PZE     SSL1,,SKSEL         SELECT CALL WORD                     3IO49190
       TTL                   READ OR WRITE LABEL                        3IO49200
*      TSX     RDLAB,4                                                  3IO49210
*              EOF OR SHORT RECORD RETURN                               3IO49220
*              NORMAL RETURN                                            3IO49230
*      TSX     WRLAB,4                                                  3IO49240
*              EOT OR SHORT RECORD WRITTEN (CAN'T HAPPEN)               3IO49250
*              NORMAL RETURN                                            3IO49260
       SPACE   1                                                        3IO49270
RDLAB  STZ     RWL3                                                   *$3IO49280
       SXA     WRL2,4                                                  *3IO49290
       AXT     4,4                 BLANK OUT WORDS 17-20               *3IO49300
       CLA     BLNKS               IN CASE IT IS NECESSARY             *3IO49310
       STO     LAREA1+6,4          TO PRINT LABEL                      *3IO49320
       TIX     *-1,4,1                                                 *3IO49330
       CLA     5,2                 IS THIS DISK                        $3IO49340
       TMI     RDLBD               YES                                 $3IO49350
       CLA     RWL1                                                    $3IO49360
RWL5   LDQ     1,2                                                     *3IO49370
       RQL     18                  READ BACKWARD                       *3IO49380
       TQP     RWL4                NO                                  *3IO49390
       ORA     SIX                                                     *3IO49400
       BES     RWL5+NOHYP/NOHYP**-NOHYP/NOHYP*RWL5-*                    3IO49410
       TRA     RWL4                                                    *3IO49420
WRLAB  CLA     5,2                 IS THIS DISK                        $3IO49430
       TMI     WRLBD               YES                                 $3IO49440
       CLS     RWL1                                                    $3IO49450
       STL     RWL3                                                     3IO49460
       SXA     WRL2,4              SAVE IR4                           *$3IO49470
RWL4   AXC     1,4                 SAVE FILE                            3IO49480
       STO*    0,2                 STORE SELECT WORD                   $3IO49490
       TRA     SKXWT                                                    3IO49500
RWL1   PZE     LSL1,,LBSEL         SELECT WORD                         $3IO49510
RWL3   PZE     **                  RD OR WR LABEL SWITCH                3IO49520
SERSW  PZE     **                  SENSE SWITCH TEST CELL SEARCHING     3IO49530
LH11   PZE     **                  LABEL SEARCHING SWITCH               3IO49540
       TTL                         RETURN HERE WHEN LABEL I/O COMPLETED 3IO49550
WRL1   NZT     RWL3                IF WRITE LABEL                      $3IO49560
       TRA     WRL2                THEN WRITE EOF                       3IO49570
       TSX     NDSEL+1,4           ALSO                                 3IO49580
       PZE     0,2,WEFOP                                                3IO49590
       NOP                         IGNORE EOT                           3IO49600
WRL2   AXT     **,4                RESTORE IR4                          3IO49610
       CLA     LBSHS               IF LABEL I/O HISTORY                 3IO49620
       TZE     2,4                 CELL IS ZERO THEN OK EXIT            3IO49630
*        READ GOT EOF OR NOT A SHORT LENGTH RECORD. WRITE GOT EOT       3IO49640
       AXT     13,4                BLANK OUT LABEL AREA                *3IO49650
       LDQ     BLNKS               LABEL RECORD                         3IO49660
       STQ     LAREA+14,4          BLANK OUT LABEL                      3IO49670
       TIX     *-1,4,1             AREA                                 3IO49680
       AXT     6,4                                                     *3IO49690
       STQ     LAREA1+6,4                                              *3IO49700
       TIX     *-1,4,1                                                 *3IO49710
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO49720
       LDQ     BLNK                SET UP                               3IO49730
       STQ     LAREA               STANDARD                             3IO49740
       LDQ     ASTER               BLANK LABEL                          3IO49750
       AXC     1,4                                                     *3IO49760
       ZET     HHDR                                                    *3IO49770
       AXC     5,4                 ****** AS                           *3IO49780
       STQ     LAREA,4             REEL SERIAL NUMBER                  *3IO49790
       LXA     WRL2,4              RESTORE IR4                          3IO49800
       TRA     1,4                 TAKE LABEL ERROR EXIT                3IO49810
       SPACE   1                                                        3IO49820
*                         SPECIAL SELECTS FOR                           3IO49830
*                          FORWARD SPACE FILE                           3IO49840
*                        READ AND WRITE LABELS                          3IO49850
       SPACE   1                                                        3IO49860
SKSEL  TMI     SKSM                SEL+ OR SEL-                         3IO49870
       STZ*    (RCTXI              NO REDUN CHECK FOR FORWARD SPACING  $3IO49880
*                             LABEL SEL+                                3IO49890
LBSEL  TMI     LBSM                LABEL SEL-                           3IO49900
       SXA     S3,4                SAVE IR4                             3IO49910
       SXA     S3+1,1              IR1                                  3IO49920
       PAC     0,4                 -L(UCW) TO IR4                       3IO49930
       CLA     1,4                 SET L(RCHX)                          3IO49940
       STA*    (RCHXI                                                   3IO49950
       CAL     0,4                 UNIT TO AC DECREMENT                 3IO49960
       STZ     SYSJOB+2                                                 3IO49961
       NZT     HHDR                                                    *3IO49970
       TRA     RWRS                ISSUE SELECT                         3IO49980
*                            HYPERTAPE SEL+                             3IO49990
LSL3   ANA     DEC15               HYPER UNIT NUMBER                   *3IO50000
       ORA     HYSEL               (120600120112)                      *3IO50010
       LDI     1,4                                                     $3IO50020
       LFT     200000                                                  $3IO50030
       ORA     L(64D)                                                  $3IO50040
       SLW     LPRFF                                                   *3IO50050
       CLA     LSL4                CONTROL AND READ                    *3IO50060
       ZET     RWL3                                                    *3IO50070
       CLA     LSL4+1              CONTROL AND WRITE                   *3IO50080
       STO     LSL2+2                                                  *3IO50090
       AXT     LSL5+1,2                                                $3IO50100
       LFT     200000                                                  *3IO50110
       AXT     LSL5+4,2                                                $3IO50120
       SXA     LSL5,2                                                  $3IO50130
       CAL     LPRFI                                                   *3IO50140
       LFT     200000              READ BACKWARD                       *3IO50150
       ORA     HSMSR               YES                                 *3IO50160
       LDI     0,4                                                     *3IO50170
       LFT     000040              INTERFACE 2                         *3IO50180
       ORA     L(1)                YES                                 *3IO50190
       SLW     LSL2                                                    *3IO50200
       CLA     *-1                                                     $3IO50210
       STA*    (RCHXI                                                  $3IO50220
       TRA     SELCT+1             ISSUE SELECT                        *3IO50230
       BES     LSL3+NOHYP/NOHYP**-NOHYP/NOHYP*LSL3-*                    3IO50240
LSL1   IORT    LAREA,,14           I/O LABEL                            3IO50250
LSL2   SMS     **                                                      *3IO50260
       LIPT    *+1                 IN CASE OF INTERRUPT                *3IO50270
       PZE     LPRFF               (1206XX120112)                      *3IO50280
LSL5   TCH     **                                                      $3IO50290
       CPYP    LAREA,,14                                               *3IO50300
       CPYD    LAREA1,,6                                               *3IO50310
       TCH     SYSTWT                                                  *3IO50320
       CPYP    LAREA1+5,,6                                             $3IO50330
       CPYD    LAREA+13,,14                                            $3IO50340
       TCH     SYSTWT                                                  $3IO50350
LSL4   CTLR    LPRFF                                                   *3IO50360
       CTLW    LPRFF                                                   *3IO50370
       BES     LSL2+NOHYP/NOHYP**-NOHYP/NOHYP*LSL2-*                    3IO50380
SSL1   IOCPN   **,,32767           IO FORWARD                           3IO50390
       TCH     *-1                 SPACE FILE                           3IO50400
SCHLS  IORT    LAREA+14,,LSL1+1    SCHX COMPARE FOR LABEL LENGTH CHECK  3IO50410
LBSHS  PZE     **                  SPECIAL SELECT HISTORY CELL          3IO50420
       TTL     POSTING ROUTINES FOR SPECIAL LABEL SELECTS               3IO50430
*                            TAPE SKIP SEL-                             3IO50440
SKSM   PAC     SK1,2               -L(UCW) TO IR2                       3IO50450
       CLA     *-1                 SET NO WAIT                          3IO50460
SKS1   STA     WAIT                IN WAIT SWITCH                       3IO50470
       STZ     1,2                 CLEAR UCW PRIORITY                   3IO50480
       TRA     1,4                 EXIT                                 3IO50490
*                            TAPE LABEL SEL-                            3IO50500
LBSM   PAC     WRL1,2                                                  *3IO50510
       ZET     HHDR                                                    *3IO50520
       TRA     LBS3                                                    *3IO50530
       LNT     400000              IF SHORT RECORD ( 2 WORD REDUN)     *3IO50540
       TRA     2,4                 IGNORE IT ( IT IS NOISE)             3IO50550
       RIS     XCPT2               STORE EOF OR EOT BIT                 3IO50560
       STI     LBSHS               IN HISTORY CELL                      3IO50570
       CAL     COMM                COMPARE SCHX VALUE                   3IO50580
       LAS     SCHLS               WITH PREDICTED TO CHECK              3IO50590
       STL     LBSHS                                                    3IO50600
       TRA     *+2                                                      3IO50610
       STL     LBSHS                                                    3IO50620
LBS2   CLA     LBSM                SET UP WAIT                          3IO50630
       TRA     SKS1                RETURN ADDRESS                       3IO50640
*                            HYPERTAPE SEL-                             3IO50650
LBS3   STZ     LBSHS               RESET ERROR SWITCH                  *3IO50660
       LFT     007100                                                  *3IO50670
       TRA     LBS2-1              ERROR                                3IO50680
       TRA     LBS2                NO ERRORS                           *3IO50690
       BES     LBS3+NOHYP/NOHYP**-NOHYP/NOHYP*LBS3-*                    3IO50700
       SPACE   1                                                        3IO50710
*               TRAP WAITING FOR SKIP AND LABEL SELECTS                 3IO50720
WAIT   TRA     **                  WAIT                                 3IO50730
       TTL              DISK LABEL ROUTINES                             3IO50740
       SPACE                                                           $3IO50750
RDLBD  LDQ     RWL1D               DISK READ SELECT WORD               $3IO50760
       LXA     WRL2,4                                                  *3IO50770
       TRA     *+2                                                     $3IO50780
WRLBD  LDQ     RWL2D               DISK WRITE SELECT WORD              $3IO50790
       SXA     WRL2D,4             SAVE IR4                            $3IO50800
       CAL     0,2                                                     *3IO50810
       PAC     ,4                  UCB                                 $3IO50820
       ZET     1,4                 WAIT FOR FREE ARM                   $3IO50830
       TRA     *-1                                                     $3IO50840
       STQ     1,4                 STORE SELECT WORD                   $3IO50850
       ARS     18                                                      $3IO50860
       NZT     DHDR                HEADER OR TRAILER                   $3IO50870
       TRA     TRAIL               TRAILER                             $3IO50880
       STA     3,4                 SEEK ADDRESS TO UCB                 $3IO50890
       TQP     *+2                 READING LABEL                       $3IO50900
       TRA     *+3                 WRITING LABEL                       $3IO50910
       LFT     003000              UNLESS                              $3IO50920
       TRA     *+3                 READING OUTPUT LABEL                $3IO50930
       ADD     L(1)                UP TRACK COUNT                      $3IO50940
       STA     6,2                                                     $3IO50950
       CLA     6,2                                                     $3IO50960
       ARS     6                                                       $3IO50970
       ANA     MSK1                HA2 TO FDAMT                        $3IO50980
       ORA     L(6)                FOR SMS                             $3IO50990
       STP     6,2                 MAKE ZERO                           $3IO51000
       STO     SMSX                                                    $3IO51010
       TRA     *+3                                                     $3IO51020
TRAIL  SUB     L(1)                SEEK ADDRESS                        $3IO51030
       STA     3,4                 TO UCB                              $3IO51040
       CLS     2,4                                                     $3IO51050
       STO     2,4                 SET ACTIVITY FLAG                   $3IO51060
       CAL     3,4                                                     *3IO51070
       TSX     (DECVA,4                                                *3IO51080
       STQ     TEMP                                                    *3IO51090
       TRA     SKXWT               GO ACTIVATE                         $3IO51100
WRL2D  AXT     **,4                                                    $3IO51110
       TRA     2,4                                                     $3IO51120
RWL1D  PZE     LSL1D,,LBSLD                                            $3IO51130
RWL2D  MZE     LSL2D,,LBSLD                                            $3IO51140
LBSLD  SXA     SAV,4                                                   $3IO51150
       PAC     ,4                                                      $3IO51160
       TMI     LBSDM               SEL(-)                              $3IO51170
       LDQ     TEMP                TTTT  TO MQ                         *3IO51180
       TSX     (FDAMT,2            PREPARE ORDER                       $3IO51190
SMSX   OCT     000012120006                                            $3IO51200
       PZE     DVTN                                                    $3IO51210
       CLA     1,4                                                     $3IO51220
       STA*    (RCHXI                                                  $3IO51230
       XEC*    (RCHXI                                                  $3IO51240
SAV    AXT     **,4                                                    $3IO51250
       TRA     1,4                                                     $3IO51260
LBSDM  CLA     WRLBD+1                                                 $3IO51270
       STA     WAIT                                                    $3IO51280
       STZ     1,4                                                     $3IO51290
       TRA     SAV                                                     $3IO51300
DVTN   DVTN    ,,                                                      $3IO51310
LSL1D  SMS*    SMSX                                                    $3IO51320
       CTLR    DVTN                                                    $3IO51330
       TCH     *+3                                                     $3IO51340
LSL2D  SMS*    SMSX                                                    $3IO51350
       CTLW    DVTN                                                    $3IO51360
       CPYD    LAREA,,14                                               $3IO51370
       TCH     SYSTWT                                                  $3IO51380
       BES     RDLBD+NOCH/NOCH**-NOCH/NOCH*RDLBD-*                     $3IO51390
       TTL         MESSAGE ROUTINE FOR ALL TYPES OF LABEL ERRORS        3IO51400
*                                                                       3IO51410
*      TSX     LBERR,4        AC= ERROR PROUT PARAM                     3IO51420
*      RETURN       AFTER PAUSE                                         3IO51430
       SPACE   1                                                        3IO51440
LBERR  SXA     LBR1,4              SAVE IR4                             3IO51450
       SLW     LBR0                STORE MESSAGE PARAM                  3IO51460
       TSX     DRANO,4             FIND UNIT ADDRESS                    3IO51470
       ZET     HHDR                                                    *3IO51480
       TSX     AB00,4                                                  *3IO51490
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO51500
       TSX     PROUT,4             PRINT                                3IO51510
       PTW     7                                                     $5$3IO51520
       MZE     MESS1,,2            ''UNIT ***** **FILE-NAME**           3IO51530
       MZE     9,2,3               LABEL ERROR''                        3IO51540
       PZE     LMSG8,,2            '' ** LABEL ** ''                    3IO51550
       PZE     LAREA,,12           '' ADDITIONAL MESSAGE ''             3IO51560
       PZE     LAREA1+2,,4                                             *3IO51570
LBR0   PZE     **,,**              ''IF SSW * DOWN IGNORED''            3IO51580
       PZE     LMSG6,,4                                                 3IO51590
       TSX     PAUSE,4,1     PAUSE                                   $5$3IO51600
LBR1   AXT     **,4                RESTORE IR4                          3IO51610
       TRA     1,4                 EXIT                                 3IO51620
*                                                                       3IO51630
*              THIS ROUTINE BLANKS THE CHECKPOINT INDICATOR             3IO51640
*              AND BLOCK COUNT IF FOUND TO BE ZERO,THUS                 3IO51650
*              PROVIDING A NEATER ON-LINE PRINT OUT                     3IO51660
*                                                                       3IO51670
*      TSX     AB00,4              MUST BE HYPERTAPE LABEL              3IO51680
*      RETURN                                                           3IO51690
*                                                                       3IO51700
AB00   CAL     LAREA+10                                                *3IO51710
       LBT                         SET CHECKPOINT INDICATOR            *3IO51720
       ORA     BL1K                TO BLANK IF ZERO                    *3IO51730
       SLW     LAREA+10                                                *3IO51740
       CAL     BLNKS                                                   *3IO51750
       NZT     LAREA+11            IF BLOCK COUNT IS ZERO,             *3IO51760
       SLW     LAREA+11            SET TO BLANKS                       *3IO51770
       TRA     1,4                                                     *3IO51780
       BES     AB00+NOHYP/NOHYP**-NOHYP/NOHYP*AB00-*                    3IO51790
       TTL                         LABEL MESSAGES                       3IO51800
LMSG1  BCI     3,INPUT REEL INVALID                                     3IO51810
LMSG2  BCI     4, OUTPUT REEL INVALID                                   3IO51820
LMSG3  BCI     4, RETENTION NOT EXPIRED                                 3IO51830
LMSG4  BCI     4, NO LABEL, BLANK CREATED                               3IO51840
LMSG5  BCI     3, MOUNT LAB. BLANK                                      3IO51850
LMSG6  BCI     1,IF SSW            * DOWN IGNORED                       3IO51860
       VFD     O6/60,6/LERIG,O24/60244666                               3IO51870
       BCI     2,N IGNORED                                              3IO51880
LMSG8  BCI     2,LABEL ERROR                                            3IO51890
LMSG9  BCI     5,LABEL **** DENSITYHIGH D LOW D                         3IO51900
LMG10  BCI     1, FOUND                                                 3IO51910
LMG11  BCI     2, NO TRAILER                                            3IO51920
LMG12  BCI     6, SEARCH SKIP LIST FOLLOWS... IF SSW  * DOWN REMOUNT    3IO51930
       VFD     6/LERIG,O30/6024466645                                   3IO51940
       BCI     2, REMOUNT                                               3IO51950
LMG13  BCI     4,  INPUT REEL,NO LABEL   TAPE POSITIONED AFTER 1ST REC  3IO51960
DLABEL BCI     3,DISK FILE LABEL                                       $3IO51970
       BES     *-3+NOCH/NOCH*3-*                                        3IO51980
HLABEL BCI     3, HYPERTAPE LABEL                                       3IO51990
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO52000
       TTL                         LABEL CHECK INPUT FILE               3IO52010
*      TSX     LCKIN,1  XEC  LABRT1                                     3IO52020
*      RETURN  LABEL OK                                                 3IO52030
*      RETURN  LABEL ERROR                                              3IO52040
       SPACE   1                                                        3IO52050
*  THIS ROUTINE COMPARES     1. FILE SERIAL NUMBER  ) FOR TAPE ONLY    $3IO52060
*                            2. REEL SEQUENCE NUMBER)                  $3IO52070
*                            3. 18 CHARACTER FILE NAME                  3IO52080
       SPACE   1                                                        3IO52090
LCKIN  SXA     LCKI7,1                                                  3IO52100
       CAL     FCW                 PLACE L(FILE)+12                     3IO52110
       ACL     L(12)               INTO COMPARE                         3IO52120
       STA     LCKI2                                                    3IO52130
       STZ     CHPSI               ZERO ERROR SWITCH                   $3IO52140
       ZET     HHDR                                                    *3IO52150
       TRA     LCK14               7340                                *3IO52160
LCKI4  NZT     DHDR                                                     3IO52170
       TRA     *+5                                                     $3IO52180
       AXT     3,4                 DISK                                $3IO52190
       AXT     3,1                                                     $3IO52200
       LDQ     L(0)                                                    $3IO52210
       TRA     LCKI1                                                   $3IO52220
       BES     LCKI4+NOCH/NOCH**-NOCH/NOCH*LCKI4-*                      3IO52230
       AXT     6,1                 COMPARE                              3IO52240
       AXT     8,4                 FILE WD. TO LABEL WD.                3IO52250
       LDQ     L(12)               7 3                                 $3IO52260
LCKI1  CAL     LAREA+10,4          8 4                                  3IO52270
       NZT*    *+2                 IF FILE NAME FIRST 6 CHAR            3IO52300
       TRA     *+4                 =0 SKIP NAME CHECK                  $3IO52310
LCKI2  ERA     **,1                ERROR CHECK                          3IO52320
       TZE     *+2                 IF ERROR                            $3IO52330
       STO     CHPSI               SET ERROR SWITCH                    $3IO52340
       TQP     *+3                                                      3IO52350
       TXI     *+1,1,-1                                                 3IO52360
       TXI     *+2,4,-4                                                 3IO52370
       TXI     *+1,4,-1                                                 3IO52380
       RQL     1                                                        3IO52390
       TIX     LCKI1,1,1                                                3IO52400
LCKI5  RIL     MXDMD+MODE+CKSUMS+BLKSEQ                             (12)3IO52410
       CAL     LAREA                                                   *3IO52420
       ERA     BLNK                BYPASS IF BLANK LABEL               *3IO52430
       TZE     LCKI3                                                   *3IO52440
       AXT     0,4                                                     *3IO52450
       ZET     HHDR                                                    *3IO52460
       AXC     1,4                                                     *3IO52470
       STI     TEMIND                                                   3IO52480
       PXA     0,0                                                     *3IO52490
       LDI*    LCK10,4                                                 *3IO52500
       XEC     LCK11,4                                                 *3IO52510
       ORA     FOR                 MIXED MODE                          *3IO52520
       XEC     LCK12,4                                                 *3IO52530
       ORA     MODBT               BINARY                              *3IO52540
       RNT     000100                                                  *3IO52550
       TRA     *+4                 NO BLOCK SEQUENCE                   *3IO52560
       RFT     010000                                                  *3IO52570
       ORA     L(64D)              BLOCK SEQUENCE AND CHECKSUMS        *3IO52580
       ORA     2P2                 BLOCK SEQ.,BUT NO CHECKSUMS         *3IO52590
       LDI     TEMIND                                                   3IO52600
       OAI                         BLOCK SEQUENCE AND CHECKSUMS        $3IO52680
       PIA                                                          (12)3IO52682
       NZT     SWING                                                (12)3IO52683
       STP     1,2                                                  (12)3IO52684
LCKI3  TSX     LPRFD-2,4                                               *3IO52690
       PZE     **                  OPTIONAL LABELS                     *3IO52700
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO52710
LCKI7  AXT     **,1                                                     3IO52720
       NZT     CHPSI               TEST ERROR SWITCH                   $3IO52730
       TRA     1,1                 EXIT                                $3IO52740
       TRA     2,1                 ERROR EXIT                          $3IO52750
*        LABEL CHECK HYPERTAPE INPUT HEADER                             3IO52760
LCK14  CAL     LAREA+2                           DDDIII                *3IO52770
       LDQ     LAREA+3                                     IIIIII      *3IO52780
       LGL     18                                IIIIII    III000      *3IO52790
       ERA     9,2                 FILE IDENTIFICATION                 *3IO52800
       TNZ     LCK15                                                   *3IO52810
       LGL     18                                XXXIII    000000      *3IO52820
       LDQ     LAREA+4                                     ISSSSS      *3IO52830
       LGL     6                                 XXIIII    SSSSS0      *3IO52840
       ALS     12                                IIII00                *3IO52850
       ORA     BL2K                              IIIIBB                *3IO52860
       ERA     10,2                FILE IDENTIFICATION                 *3IO52870
       TNZ     LCK15                                                   *3IO52880
       XCL                                       SSSSS0    XXXXXX      *3IO52890
       ARS     6                                 0SSSSS                *3IO52900
       ORA     BLK1                              BSSSSS                *3IO52910
       ERA     6,2                 FILE SERIAL NUMBER                  *3IO52920
       TNZ     LCK15                                                   *3IO52930
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *3IO52940
       RQL     6                                 XXXXXX    RRRRBB      *3IO52950
       XCL                                       RRRRBB                *3IO52960
       ERA     LAREA+6             REEL SEQUENCE NUMBER                *3IO52970
       TZE     *+2                                                     *3IO52980
LCK15  STL     CHPSI               ERROR SWITCH                        *3IO52990
       LDQ     1,2                                                     *3IO53000
       RQL     18                  IN READ BACKWARD MODE               *3IO53010
       TQP     LCKI5               NO                                  *3IO53020
*                  CONVERT BLOCK COUNT FROM BCD TO BINARY               3IO53030
       AXT     36,4                                                    *3IO53040
       LDQ     LAREA+11            BLOCK COUNT                         *3IO53050
       STZ     TEMP                                                    *3IO53060
       PXD     0,0                                                     *3IO53070
LCKI6  LGL     6                   GET NEXT DIGIT                      *3IO53080
       ACL     TEMP                                                    *3IO53090
       TNX     *+7,4,6                                                 *3IO53100
       STQ     RWL3                                                    *3IO53110
       XCL                                                             *3IO53120
       MPY     L(12A)                                                  *3IO53130
       STQ     TEMP                SAVE PARTIAL PRODUCT                *3IO53140
       LDQ     RWL3                                                    *3IO53150
       TRA     LCKI6                                                   *3IO53160
       ALS     18                                                      *3IO53170
       STD     3,2                                                     *3IO53180
       TRA     LCKI5                                                   *3IO53190
       BES     LCK14+NOHYP/NOHYP**-NOHYP/NOHYP*LCK14-*                  3IO53200
LCK10  LDI     LAREA+6                                                 *3IO53210
       LDI     LAREA+7                                                 *3IO53220
LCK11  LFT     2                                                       *3IO53230
       RFT     4                                                       *3IO53240
LCK12  LFT     1                                                       *3IO53250
       RFT     1                                                       *3IO53260
LCK13  LDQ     LAREA+6                                                 *3IO53270
       LDQ     LAREA+10                                                *3IO53280
       TTL              TRAILER CHECK INPUT FILE                        3IO53290
*      TSX     TCKIN,1  XEC  LABRT2                                     3IO53300
*      RETURN IF OK           TAKES SEQEX IF SEQ CHECK FAILS            3IO53310
*      AT EITHER RETURN  MQ +  EOR TRAILER                              3IO53320
*                        MQ -  HDR TRAILER (READ BACKWARD)              3IO53330
*                        MQ -  EOF TRAILER                              3IO53340
*                                                                       3IO53350
TCKIN  STI     TEMP                SAVE INDICATORS,NEED TAG            *3IO53360
       LDI     1,2                 FOR READ BACKWARD BIT               *3IO53370
       ONT     MSK2                                                    *3IO53380
       TRA     TCK3                                                    $3IO53390
       CAL     LAREA               CHECKPOINT AND READ BACKWARD        $3IO53400
       ERA     1HDR                                                    *3IO53410
       TZE     TCK3+3              1HDR-NORMAL SITUATION               *3IO53420
       TSX     (NDSLX,4                                                *3IO53430
       PZE     0,2,HBSFP           HYPERTAPE BACKSPACE FILE            *3IO53440
       TSX     RDLAB,4                                                 *3IO53450
       TRA     TCK4                                                    *3IO53460
       BES     *-10+NOHYP/NOHYP*10-*                                    3IO53470
TCK3   CAL     LAREA               PLACE TEMP + IF EOR                *$3IO53480
       ERA     1EOR                - IF EOF                             3IO53490
       TZE     *+2                                                      3IO53500
       SSM                                                              3IO53510
       LDI     TEMP                                                    *3IO53520
       STO     TEMP                CHECK FOR BOTH BCD AND               3IO53530
       CAL     3,2                 SPREAD OCTAL BLOCK COUNT             3IO53540
       TSX     (DECVD,4                                                $3IO53550
       XCL                                                              3IO53560
       SXA     TCK1,1                                                  *3IO53570
       AXC     1,1                                                     *3IO53580
       ZET     HHDR                WORD 2 IF 729,1301                  *3IO53590
       AXC     11,1                IF 7340,WORD 12                     *3IO53600
       ZET     HHDR                                                    *3IO53610
       ANA     MSK3                MASK OUT HIGH ORDER BLANK           *3IO53620
       ERA     LAREA,1                                                 *3IO53630
       TZE     *+4                                                     $3IO53640
       LDQ     3,2                 IF BLOCK COUNTS                     $3IO53650
       TSX     BCD5-1,4            AGREE THEN                           3IO53660
       ERA     LAREA,1             EXIT...ELSE TAKE                    *3IO53670
TCK2   STO     LPROO               SET SEQUENCE CONDITION              *3IO53680
       TSX     LPRFD-2,4           CHECK FOR                           *3IO53690
       PZE     ,,1                 OPTIONAL LABELS                     *3IO53700
       CLA     LPROO                                                   *3IO53710
       BES     TCK2+NOHYP/NOHYP**-NOHYP/NOHYP*TCK2-*                    3IO53720
       LDQ     TEMP                SEQUENCE ERROR EXIT                  3IO53730
       STO     TEMP                SAVE SEQ CONDITION (=0 OK)           3IO53740
TCK1   AXT     **,1                                                    *3IO53750
       TRA     1,1                 EXIT                                 3IO53760
TCK4   TSX     PROUT,4                                                 *3IO53770
       PZE     2                                                       *3IO53780
       MZE     9,2,3               ''FILE-NAME''                       *3IO53790
       PZE     LMG11,,2+512*DBLSP    ''NO TRAILER''                    *3IO53800
       TRA     LCK3                                                    *3IO53810
       BES     TCK4+NOHYP/NOHYP**-NOHYP/NOHYP*TCK4-*                    3IO53820
       TTL     CHECK LABEL OF SUPPOSED USEABLE OUTPUT REEL FOR LEGALITY 3IO53830
*      TSX     LCKOF,1  XEC  LABRT3                                     3IO53840
*      RETURN  USEABLE                                                  3IO53850
*              RETENTION NOT EXPIRED                                   $3IO53860
*              NOT USABLE                                              $3IO53870
       SPACE   1                                                        3IO53880
LCKOF  CAL     LAREA               IF 1ST WORD = 1BLANK                 3IO53890
       ERA     BLNK                REEL OK TO USE                       3IO53900
       TZE     1,1                                                      3IO53910
       CAL     LAREA                                                    3IO53920
       ERA     1HDR                                                     3IO53930
       TNZ     3,1                 REEL NOT USEABLE                     3IO53940
       ZET     HHDR                                                    *3IO53950
       TRA     LCK3                7340                                *3IO53960
       CAL     LAREA+4             IF DATE(CREATION)+ RETENTION DAYS    3IO53970
       ANA     17SS                HAS NOT BEEN REACHED                $3IO53980
       ACL     LAREA+5             THEN TAKE RETENTION NOT              3IO53990
LCK2   TSX     BCDCV,4             EXPIRED EXIT                        $3IO54000
       SLW     RWL3                                                    *3IO54010
       ANA     MSK4                                                    *3IO54020
       LAS     LDOYR               CHECK SUM OVERFLOW                   3IO54030
       TRA     LCK1                TO NEXT YEAR                        $3IO54040
       AXT     0,0                                                      3IO54050
       CAL     RWL3                                                    *3IO54060
       ACL     BLP4                                                    $3IO54070
       LAS     DATE                IF ''SAVE DATE''                     3IO54080
       TRA     2,1                 NOT REACHED                          3IO54090
       TRA     1,1                 THEN REEL IS                         3IO54100
       TRA     1,1                 '' RETENTION PROTECTED''             3IO54110
LCK1   CAL     RWL3                                                    *3IO54120
       ACL     M365                ADD 1 YEAR,SUBTRACT 365 DAYS       *$3IO54130
       TRA     LCK2                                                    *3IO54140
       SPACE   1                                                        3IO54150
*        CHECK RETENTION PERIOD FOR HYPERTAPE                           3IO54160
LCK3   CAL     LAREA+1             RETENTION PERIOD                    *3IO54170
       ARS     12                  00RRRR                              *3IO54180
       TZE     1,1                 NOT APPLICABLE IF ZERO              *3IO54190
       SLW     RWL3                                                    *3IO54200
       CAL     LAREA+1                                                 *3IO54210
       ALS     6                   RRRYY0                              *3IO54220
       LDQ     LAREA+2                     DDDIII                      *3IO54230
       LGR     18                  YY0DDD                              *3IO54240
       XCL                         BEWARE OF Q BIT                     *3IO54250
       ACL     RWL3                                                    *3IO54260
       TRA     LCK2                                                    *3IO54270
       BES     LCK3+NOHYP/NOHYP**-NOHYP/NOHYP*LCK3-*                    3IO54280
       TTL              PREPARE OUTPUT TRAILER                          3IO54290
*         LOGICAL AC MUST CONTAIN EITHER  1EOF  OR 1EOR                $3IO54300
*      TSX     TPROF,1  XEC  LABRT4                                     3IO54310
*      RETURN                                                           3IO54320
       SPACE   1                                                        3IO54330
TPROF  SLW     LAREA               SET 1EOR OR 1EOF                    $3IO54340
       CAL     3,2                 IN TRAILER                           3IO54350
       TSX     (DECVD,4            CONVERT BLOCK                        3IO54360
       ZET     HHDR                COUNT TO DECIMAL                    $3IO54370
       TRA     TPROH               7340                                *3IO54380
       STQ     LAREA+1                                                  3IO54390
       LDQ     0,2                 INSERT IN TRAILER                    3IO54400
       RQL     21                  CONVERT UCW USED                     3IO54410
       TSX     (BCD5X,4            TO SPREAD OCTAL                     $3IO54420
       SLW     LAREA+2             AND INSERT IN TRAILER                3IO54430
       AXT     11,4                FOR POSSIBLE VISUAL                  3IO54440
       LDQ     BLNKS               USE LATER ON                         3IO54450
       STQ     LAREA+14,4                                               3IO54460
       TIX     *-1,4,1                                                  3IO54470
       AXT     6,4                                                     *3IO54480
       LDQ     LAREA1+6,4          BLANK OUT                           *3IO54490
       TIX     *-1,4,1             WORDS 15 TO 20                      *3IO54500
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO54510
       TRA     1,1                 EXIT                                $3IO54520
TPROH  XCL                                                             *3IO54530
       ANA     MSK3                                                    *3IO54540
       SLW     LAREA+11            BLOCK COUNT                         $3IO54550
       LDQ     DATE                                                    *3IO54560
       STL     LPROO                                                   *3IO54570
       AXT     3,4                                                     *3IO54580
       TRA     LPRFC+2                                                 *3IO54590
       BES     TPROH+NOHYP/NOHYP**-NOHYP/NOHYP*TPROH-*                  3IO54600
       TTL                         PREPARE LABEL OUTPUT FILE            3IO54610
*      TSX     LPROF,1  XEC  LABRT5                                     3IO54620
*      RETURN                                                           3IO54630
       SPACE   1                                                        3IO54640
LPROF  CLA     1HDR                SET 1ST WORD                        $3IO54650
       STO     LAREA               = 1HDR                               3IO54660
       LDQ     DATE                5TH                                 $3IO54670
       ZET     HHDR                IF HYPERTAPE GO TO PREPARE          *3IO54680
       TRA     LPRFC               120 CHARACTER HEADER                *3IO54690
       STQ     LAREA+4             =TODAYS DATE                        $3IO54700
       CLA     8,2                 6TH                                 $3IO54710
       STO     LAREA+5             =RETENTION DAYS                     $3IO54720
LPRFG  NZT     DHDR                                                   *$3IO54730
       TRA     LPRFA               TAPE                                $3IO54740
       AXT     3,4                                                     $3IO54750
       CAL     BLNKS                                                   $3IO54760
       SLW     LAREA+4,4                                               $3IO54770
       TIX     *-1,4,1                                                 $3IO54780
       TRA     LPRFB                                                   $3IO54790
       BES     LPRFG+NOCH/NOCH**-NOCH/NOCH*LPRFG-*                      3IO54800
LPRFA  CLA     6,2                 3RD                                 $3IO54810
       STO     LAREA+2             = FILE SERIAL                        3IO54820
       CAL     7,2                 4TH                                  3IO54830
       SLW     LAREA+3             =REEL SEQUENCE NUMBER                3IO54840
LPRFB  CAL     6PRE                FIRST CHARACTER BLANK               $3IO54850
       STI     LAREA+10            SAVE SI TEMPORARILY                  3IO54860
       LDI     1,2                                                      3IO54870
       RFT     FDEN                FILE DENSITY                        $3IO54880
       ACL     L(64D)              =1 IF HI                            $3IO54890
       LFT     MODE                MODE                                 3IO54900
       ACL     1DEC                =1 IF BINARY                         3IO54910
       LFT     400000              IF MIXED MODE                        3IO54920
       ACL     2DEC                =2 OR 3 (M OR N)                     3IO54930
       LFT     CKSUMS              CHECKSUM                             3IO54940
       ACL     1P4                 =1 IF PRESENT                       *3IO54950
       LFT     BLKSEQ              BLOCK SEQ                            3IO54960
       ACL     1P5A                =1 IF PRESENT                       *3IO54970
       LNT     OPEND               IF OPENING                           3IO54980
       TRA     *+3                 NO CHECKPOINT                        3IO54990
       LFT     CP1                 BIT IN LABEL                        $3IO55000
       ACL     L(1)                CKPT BIT                             3IO55010
       SLW     LAREA+6             =1 IF CHECKPOINT FOLLOWS             3IO55020
       LDQ     9,2                 FILE NAME                            3IO55030
       STQ     LAREA+7             TO LABEL                             3IO55040
       LDQ     10,2                                                     3IO55050
       STQ     LAREA+8                                                  3IO55060
       LDQ     11,2                                                     3IO55070
       STQ     LAREA+9                                                  3IO55080
       LDI     LAREA+10            RESTORE SI                           3IO55090
       AXT     4,4                 BLANK OUT                            3IO55100
       CAL     BLNKS               WORDS 11 TO 14                       3IO55110
       SLW     LAREA+14,4                                               3IO55120
       TIX     *-1,4,1                                                  3IO55130
       AXT     4,4                                                     *3IO55140
       SLW     LAREA1+6,4          BLANK OUT                           *3IO55150
       TIX     *-1,4,1             WORDS 15 TO 20                      *3IO55160
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO55170
       TRA     1,1                 EXIT                                $3IO55180
       TTL     PREPARE 120 CHARACTER HEADER                             3IO55190
*                                                                       3IO55200
*          FIELD  WORD  LENGTH  CONTENTS    DESCRIPTION                 3IO55210
*            1      1      6    1XXXBB      LABEL IDENTIFIER            3IO55220
*            2      2      4    RRRR        RETENTION PERIOD            3IO55230
*            3     2-3     5    YYDDD       CREATION DATE               3IO55240
*            4     3-5    10    IIIIIIIIII  FILE IDENTIFICATION         3IO55250
*            5      5      5    SSSSS       FILE SERIAL                 3IO55260
*            6      6      6    NNNNNB      REEL SERIAL                 3IO55270
*            7      7      5    RRRRB       REEL SEQUENCE               3IO55280
*            8     7-8     3                RESERVE                     3IO55290
*            9      8      1    D  (NA)     DENSITY                     3IO55300
*           10      8      1    C           CHECK SUM                   3IO55310
*           11      8      1    S           BLOCK SEQUENCE              3IO55320
*           12      8      1    T           TAPE CHECK/INTERPRET        3IO55330
*           13      9      1    R  (8)      RECORDING TECHNIQUE         3IO55340
*           14      9      1    P  (6)      PROCESSING TECHNIQUE        3IO55350
*           15      9      4    7090(4)     CREATING SYSTEM             3IO55360
*           16     10      1    F           RECORD FORMAT               3IO55370
*           17     10      5    LLLLL       RECORD LENGTH               3IO55380
*           18     11      5    SSSSS       BLOCK SIZE                  3IO55390
*           19     11      1    C           CHECKPOINT                  3IO55400
*           20     12      6    CCCCCC      BLOCK COUNT (TRAILER ONLY)  3IO55410
*          21-26  13-17   28                RESERVE                     3IO55420
*           27    17-20   20                OPTIONAL                    3IO55430
*                                                                       3IO55440
*                                                                       3IO55450
LPRFC  STZ     LPROO               RESET OUTPUT SWITCH                 *3IO55460
       AXT     2,4                                                     *3IO55470
       SXD     LPRFH,4                                                 *3IO55480
       CAL     8,2                 RETENTION     BBRRRR    MMBDDD      *3IO55490
       LGL     12                                RRRRMM    BDDD00      *3IO55500
       SLW     LAREA+1                                                 *3IO55510
       LGL     24                                XXBDDD    000000      *3IO55520
       LDQ     9,2                 IDENT 1-6               IIIIII      *3IO55530
       LGL     18                                DDDIII    III000      *3IO55540
       SLW     LAREA+2                                                 *3IO55550
       LGL     18                                XXXIII    000000      *3IO55560
       NZT     LPROO               DO NOT SET BLOCK                    *3IO55570
       STQ     LAREA+11            COUNT IF TRAILER                    *3IO55580
       LDQ     10,2                IDENT 7-10              IIIIBB      *3IO55590
       LGL     18                                IIIIII    IBB000      *3IO55600
       SLW     LAREA+3                                                 *3IO55610
       LGL     6                                 XXXXXI    BB0000      *3IO55620
       LDQ     6,2                 FILE SERIAL             BSSSSS      *3IO55630
       RQL     6                                           SSSSSB      *3IO55640
       LGR     6                                 0XXXXX    ISSSSS      *3IO55650
       STQ     LAREA+4                                                 *3IO55660
LPRFK  BES     LPRFC+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFC-*                  3IO55670
       LDQ     11,2                REEL SERIAL NUMBER                  *3IO55680
       STQ     LAREA+5                           NNNNNB                *3IO55690
       AXC     3,4                                                     *3IO55700
       ZET     LPROO                                                   *3IO55710
       STQ*    0,2                                                     *3IO55720
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *3IO55730
       RQL     6                                           RRRRBB      *3IO55740
       STQ     LAREA+6                                                 *3IO55750
       STI     LAREA1              HOLD SI TEMPORARILY                 *3IO55760
       LDI     1,2                                                     *3IO55770
       CAL     BB0001              FIRST CHARACTER BLANK               *3IO55780
       LFT     CKSUMS                                                  *3IO55790
       ACL     1P4                 YES                                 *3IO55800
       LFT     BLKSEQ                                                  *3IO55810
       ACL     1P5A                YES                                 *3IO55820
       LNT     MODE                                                    *3IO55830
       ACL     L(1)                BCD                                 *3IO55840
       LFT     400000              BINARY                              *3IO55850
       ACL     L(4)                MIXED MODE                          *3IO55860
       SLW     LAREA+7                                                 *3IO55870
       PXA     0,0                                                     *3IO55880
       OCT     044300012000        DOUBLE LOAD                         *3IO55890
       TZE     *+2                 7090                                *3IO55900
       CAL     L(4)                                                    *3IO55910
LPRFL  BES     LPRFK+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFK-*                  3IO55920
       ADM     H7090               CHECKING INTERPRETING TECHNIQUE     *3IO55930
       SLW     LAREA+8             DATA RECORDING TECHNIQUE            *3IO55940
       CAL     BBBBB                                                   *3IO55950
       LNT     OPEND                                                   *3IO55960
       TRA     *+3                 CHECKPOINT ONLY IF REEL SWITCHING   *3IO55970
       LFT     CP1                                                     *3IO55980
       ADM     L(1)                CHECKPOINT                          *3IO55990
       SLW     LAREA+10                                                *3IO56000
       CLA     BLNKS                                                   *3IO56010
       STO     LAREA+9                                                 *3IO56020
       LDI     LAREA1              RESTORE SI                          *3IO56030
       AXT     2,4                                                     *3IO56040
       STO     LAREA+14,4                                              *3IO56050
       TIX     *-1,4,1                                                 *3IO56060
       AXT     6,4                                                     *3IO56070
       STO     LAREA1+6,4          RESERVE AND OPTIONAL                *3IO56080
       TIX     *-1,4,1                                                 *3IO56090
       TSX     LPRFD,4             CHECK FOR USER                      *3IO56100
LPRFH  PZE     **                  LABEL ACTION                        *3IO56110
       TRA     1,1                 EXIT                                *3IO56120
       BES     LPRFL+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFL-*                  3IO56130
       TTL     ADDITIONAL LABEL RECORD ROUTINE                          3IO56140
*      THIS ROUTINE CHECKS FOR USER LABEL ACTION REQUESTS               3IO56150
*      ALL INDEX REGISTERS AND SENSE INDICATORS ARE SAVED               3IO56160
*                                                                       3IO56170
*      TSX     LPRFD-2,4                                                3IO56180
*      PZE     ,,DECREMENT                                              3IO56190
*      RETURN                                                           3IO56200
*                                                                       3IO56210
*                  DECREMENT = 0   CHECK INPUT HEADER                   3IO56220
*                              1   CHECK INPUT TRAILER                  3IO56230
*                              2   PREPARE OUTPUT HEADER                3IO56240
*                              3   PREPARE OUTPUT TRAILER               3IO56250
*                                                                       3IO56260
       NZT     HHDR                                                    *3IO56270
       TRA     2,4                 EXIT IF NOT 7340                    *3IO56280
LPRFD  CLA     1,4                                                     *3IO56290
       STD     LPRFJ                                                   *3IO56300
       CLA     2,2                                                     *3IO56310
       SXA     LPRFE,4                                                 *3IO56320
       PDX     0,4                                                     *3IO56330
       TXL     LPRFE,4,0           EXIT IF NO USER LABEL ACTION        *3IO56340
       SXA     LPRFE-2,1                                               *3IO56350
       SXA     LPRFE-1,2           SAVE IRS AND SI                     *3IO56360
       STI     LPRFF                                                   *3IO56370
LPRFJ  TXI     *+1,4,**                                                *3IO56380
       SXA     *+1,4                                                   *3IO56390
       TSX     **,4                GO TO USER                          *3IO56400
       LDI     LPRFF                                                   *3IO56410
       AXT     **,1                                                    *3IO56420
       AXT     **,2                RESTORE IRS AND SI                  *3IO56430
LPRFE  AXT     **,4                                                    *3IO56440
       TRA     2,4                                                     *3IO56450
LPROO  PZE     **                  NON-ZERO IF PREPARING TRAILER        3IO56460
H7090  BCI     1,867090            RECORDING SYSTEM                     3IO56470
LPRFI  OCT     700000000126                                            $3IO56480
LPRFF  PZE     **                  TEMP STORAGE                         3IO56490
L(12A) PZE     10                                                       3IO56500
BLK1   BCI     1, 00000                                                 3IO56510
       BES     LPRFD+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFD-*                  3IO56520
       TTL                         CONSTANTS FOR LABEL IMAGE ROUTINES   3IO56530
L(12)  PTW     12                                                       3IO56540
2DEC   PZE     0,,2                                                     3IO56550
1EOR   BCI     1,1EOR                                                   3IO56560
1EOF   BCI     1,1EOF                                                   3IO56570
1HDR   BCI     1,1HDR                                                   3IO56580
BLNK   BCI     1,1BLANK                                                 3IO56590
ASTER  BCI     1, *****                                                 3IO56600
BBBBB  BCI     1,     0                                                 3IO56610
LDOYR  BCI     1,000365                                                *3IO56620
BLP4   BCI     1,00 000                                                 3IO56630
M365   BCI     1,009635                                                 3IO56640
XCPT2  OCT     577777777777                                             3IO56650
MSK1   OCT     000077770000                                            $3IO56660
MSK2   OCT     200000400000                                             3IO56670
MSK3   OCT     077777777777                                             3IO56680
MSK4   OCT     000077777777                                            *3IO56690
2P2    BCI     1,020000                                                 3IO56700
1P4    BCI     1,000100                                                 3IO56710
BL1K   BCI     1,00000                                                  3IO56720
BL2K   BCI     1,0000                                                   3IO56730
BB0001 BCI     1,  0001                                                 3IO56740
1P5A   BCI     1,000010                                                 3IO56750
MNT6   MZE     LMSG5,,3                                                 3IO56760
       SPACE   1                                                        3IO56770
B6FIN  BSS     0                   ...END LABEL IOCS STORAGE.........   3IO56780
F7     BES     1                                                        3IO56790
       END                   END OF OBJECT IOCS                         3IO56800
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCSM                          3IOA0000
$IBMAP .IOCSM  100,()OK                                                 3IOA0010
       TTL     .IOCSM/COMMUNICATION REGION FOR MINIMUM IOCS          (7)3IOA0020
       LBL     .IOM,BEGIN     .IOCSM                                 (7)3IOA0025
*      COMMUNICATION REGION FOR MINIUM IOCS                             3IOA0030
*              MUST FOLLOW .IOCSM ON LIBRARY TAPE                       3IOA0040
ENTRY  EQU     .ENTRY                                                   3IOA0050
ROUTE  EQU     .ENTRY+8                                                 3IOA0060
       ORG     .DEFIN                                                   3IOA0070
DEFINE STL     ROUTE               DEFINE A BUFFER POOL                 3IOA0080
       TXL     ENTRY,,.DEFI.                                            3IOA0090
       BES     2                                                        3IOA0100
ATTACH STL     ROUTE               ATTACH FILES TO A                    3IOA0110
       TXL     ENTRY,,.ATTC.       BUFFER POOL                          3IOA0120
CLOSE  STL     ROUTE               CLOSE FILE(S) OPTIONALLY             3IOA0130
       TXL     ENTRY,,.CLOS.       DETACHING FROM A POOL                3IOA0140
OPEN   STL     ROUTE               OPEN A FILE                          3IOA0150
       TXL     ENTRY,,.OPEN.                                            3IOA0160
READ   STL     ROUTE               BUFFERED READ                        3IOA0170
       TXL     ENTRY,,.READ.                                            3IOA0180
WRITE  STL     ROUTE               BUFFERED WRITE                       3IOA0190
       TXL     ENTRY,,.WRIT.                                            3IOA0200
       BES     7                                                        3IOA0210
       TXL     ENTRY,,.BSR.                                             3IOA0220
*                                                                       3IOA0230
       ORG     .READR                                                   3IOA0240
READR  STL     ROUTE                                                    3IOA0250
       TXL     ENTRY,,.RER1.                                            3IOA0260
RELESE STL     ROUTE                                                    3IOA0270
       TXL     ENTRY,,.RLSE.                                            3IOA0280
*                                                                       3IOA0290
*                                                                       3IOA0300
       ORG     .GOA                                                     3IOA0310
       TXL     .GO,1,.OPEN.                                             3IOA0320
       TXI     *+1,1,-.RLSE.                                            3IOA0330
*                                                                       3IOA0340
       ORG     .GO+5                                                    3IOA0350
       TSX     .SWITC,1                                                 3IOA0360
       NOP                                                              3IOA0370
       BES     1                                                        3IOA0380
       LXA     .GTIOX,4                                                 3IOA0390
       BES     1                                                        3IOA0400
       TSX     .EOTOF,1                                                 3IOA0410
*                                                                       3IOA0420
       ORG     .LUNBL+2                                                 3IOA0430
       TTR     .MONSW                                                   3IOA0440
       TTR     .TEOR                                                    3IOA0450
*                                                                       3IOA0460
       ORG     .ENTRY+5                                                 3IOA0470
       SXA     .GTIOX,4                                                 3IOA0480
*                                                                       3IOA0490
       ORG     .ENTRY+10                                                3IOA0500
       STZ     .TCHEX                                                   3IOA0510
       BES     1                                                        3IOA0520
       ENB     .L(0)                                                    3IOA0530
*                                                                       3IOA0540
       ORG     ENTRY+23                                              (7)3IOA0550
       TXH     .ENDTR-2,1,.ATTC.                                        3IOA0560
*                                                                       3IOA0570
       ORG     .ENTRY                                                   3IOA0580
       ZET     .L(0)                                                    3IOA0590
*                                                                       3IOA0600
       ORG     .NOPXI+1                                                 3IOA0610
       TSX     .FEEIT,1                                                 3IOA0620
*                                                                       3IOA0630
       ORG     .COMXI                                                   3IOA0640
       ENB     .L(0)                                                    3IOA0650
*                                                                       3IOA0660
       ORG     .COMXI+4                                                 3IOA0670
       SXA     .RER2.,0                                                 3IOA0680
*                                                                       3IOA0690
       ORG     .COMXI+6                                                 3IOA0700
       TRA     .EX34-4                                                  3IOA0710
*                                                                       3IOA0720
       ORG     .COMXI+15                                                3IOA0730
       LXA     .GTIOX,4                                                 3IOA0740
       ZET     .TCHEX                                                   3IOA0750
       LXA     .TCHEX,4                                                 3IOA0760
       END                   END OF MINIMUM OVERLAY                     3IOA0770
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCSB                          3IOB0000
$IBMAP .IOCSB  100,()OK                                                 3IOB0010
       LBL     .IOB,BEGIN     .IOCSB                                 (7)3IOB0013
       TTL     .IOCSB/COMMUNICATION REGION FOR BASIC IOCS               3IOB0020
*      COMMUNICATION REGION FOR BASIC IOCS                              3IOB0030
*              MUST FOLLOW .MINOR ON LIBRARY TAPE                       3IOB0040
*                                                                       3IOB0050
ENTRY  EQU     .ENTRY                                                   3IOB0060
ROUTE  EQU     .ENTRY+8                                                 3IOB0070
       ENTRY   .COPY                                                    3IOB0080
       ENTRY   .REW                                                     3IOB0090
       ENTRY   .WEF                                                     3IOB0100
       ENTRY   .BSF                                                     3IOB0110
       ENTRY   .CKPT                                                    3IOB0120
       ENTRY   .STASH                                                   3IOB0130
       ENTRY   .JOIN                                                    3IOB0140
.JOIN  TTR     .DEFIN+2                                                 3IOB0150
.COPY  TTR     .WRITE+2                                                 3IOB0160
.REW   TTR     .WRITE+4                                                 3IOB0170
.WEF   TTR     .WRITE+6                                                 3IOB0180
.BSF   TTR     .WRITE+10                                                3IOB0190
.CKPT  TTR     .WRITE+12                                                3IOB0200
.STASH TTR     .WRITE+14                                                3IOB0210
       ORG     .DEFIN+2                                                 3IOB0220
       STL     ROUTE               JOIN                                 3IOB0230
       TXL     ENTRY,,.JOINX                                            3IOB0240
       ORG     .WRITE+2                                                 3IOB0250
       STL     ROUTE               COPY                                 3IOB0260
       TXL     ENTRY,,.COPY.                                            3IOB0270
       STL     ROUTE               REW                                  3IOB0280
       TXL     ENTRY,,.REW.                                             3IOB0290
       STL     ROUTE               WEF                                  3IOB0300
       TXL     ENTRY,,.WEF.                                             3IOB0310
       BES     2                                                        3IOB0320
       STL     ROUTE               BSF                                  3IOB0330
       TXL     ENTRY,,.BSF.                                             3IOB0340
       STL     ROUTE               CKPT                                 3IOB0350
       TRA     .CKPT.                                                   3IOB0360
       STL     ROUTE               STASH                                3IOB0370
       TXL     ENTRY,,.STAS.                                            3IOB0380
*                                                                       3IOB0390
       ORG     .LUNBL+1                                                 3IOB0400
       TTR     .CHCPT                                                   3IOB0410
*                                                                       3IOB0420
       ORG     .GO+6                                                    3IOB0430
       TSX     .CPINT,4                                                 3IOB0440
*                                                                       3IOB0450
       ORG     .COMXI+6                                                 3IOB0460
       XEC     .BASIO+1                                                 3IOB0470
       BES     4                                                        3IOB0480
       TSX     .CKPT.,4                                                 3IOB0490
*                                                                       3IOB0530
       ORG     .JOINX                                                   3IOB0540
       TRA     .JOIN.                                                   3IOB0550
*                                                                       3IOB0560
       ORG     .OP4                                                     3IOB0570
       TMI     .INTOP                                                   3IOB0580
*                                                                       3IOB0590
       ORG     .SH1                                                     3IOB0600
       TMI     .INTCL                                                   3IOB0610
*                                                                       3IOB0620
       ORG     .RE7                                                     3IOB0630
       TSX     .ENTIN,1                                                 3IOB0640
*                                                                       3IOB0650
       ORG     .SEL59                                                   3IOB0660
       TSX     .ENTIN,1                                                 3IOB0670
       BSS     5                                                        3IOB0680
       TRA     .BSF5                                                    3IOB0690
*                                                                       3IOB0700
       ORG     .ETOF3+4                                                 3IOB0710
       TSX     .CPINT,4                                                 3IOB0720
*                                                                       3IOB0730
       ORG     .IOCSM                                                   3IOB0740
       END                    END OF BASIC OVERLAY                      3IOB0750
$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCSL                          3IOC0000
$IBMAP .IOCSL  100,()OK                                                 3IOC0010
       LBL     .IOL,BEGIN     .IOCSL                                 (7)3IOC0013
       TTL     .IOCSL/COMMUNICATION REGION FOR LABEL IOCS               3IOC0020
*      OVERLAY PACKAGE FOR LABEL IOCS                                   3IOC0030
*              MUST FOLLOW .BASCR ON LIBRARY UNIT                       3IOC0040
       ENTRY   .NSLB1                                                   3IOC0050
       ENTRY   .NSLB2                                                   3IOC0060
       ENTRY   .NSLB3                                                   3IOC0070
       ENTRY   .NSLB4                                                   3IOC0080
       ENTRY   .NSLB5                                                   3IOC0090
*                                                                       3IOC0100
.NSLB1 TTR     .LABRT                                                   3IOC0110
.NSLB2 TTR     .LABRT+1                                                 3IOC0120
.NSLB3 TTR     .LABRT+2                                                 3IOC0130
.NSLB4 TTR     .LABRT+3                                                 3IOC0140
.NSLB5 TTR     .LABRT+4                                                 3IOC0150
*                                                                       3IOC0160
       ORG     .SH9+1                                                   3IOC0190
       TSX     .LABCO,1                                                 3IOC0200
*                                                                       3IOC0210
*                                                                       3IOC0220
       ORG     .OP7                                                     3IOC0230
       TSX     .LABCI,1                                                 3IOC0240
*                                                                       3IOC0250
       ORG     .OP9.2                                                   3IOC0260
       TSX     .LABOO,1                                                 3IOC0270
*                                                                       3IOC0280
       ORG     .MNT1A                                                   3IOC0290
       CLA     .MNT6                                                    3IOC0300
*                                                                       3IOC0310
       ORG     .EOFEX+1                                                 3IOC0320
       TSX     .LAEOF,1                                                 3IOC0330
*                                                                       3IOC0340
       ORG     .ETOF3                                                   3IOC0350
       TSX     .LBEOT,1                                                 3IOC0360
*                                                                       3IOC0370
       ORG     .ETOF3+3                                                 3IOC0380
       TSX     .LABOO,1                                                 3IOC0390
*                                                                       3IOC0400
       ORG     .IOCSB                                                   3IOC0410
       END                    END OF LABEL OVERLAY                      3IOC0420
$IBMAP CMPAK   ADDREL                                                   3L000000
       LBL     MPAK,BEGIN     CMPAK                                  (7)3L000010
       TTL     CMPAK-COBOL MOVE SUBROUTINE                              3L000015
       ENTRY   .CMPAK                                                   3L000020
.CMPAK SXA     SAVE2,2                                                  3L000030
       AXC     MVP777-1,2          SET RETURN TO MVP777                 3L000040
MVP222 SXA     SAVXR4,4            SAVE XR4 FOR DEBUGGING               3L000050
       SXA     SAVE1,1                                                  3L000060
MVP333 CLA     1,4                                                      3L000070
       TPL     1,2                 TRA IF PZE LOC,,BYTE                 3L000080
       STP     *+1                                                      3L000090
       AXT     MVP666,0            TXI IF MON L(PI)                     3L000100
       PDC     0,1                 -L(DISPLACEMENT CONSTANT)            3L000110
       CAL*    1,4                 CAL L(BL)                            3L000120
       TZE     .CBLER              ERROR IF BL NOT ACTIVE.              3L000130
       ACL     0,1                 ACL L(DISPLACEMENT CONSTANT)         3L000140
       PDX     0,1                 SUM OF BYTE VALUES                   3L000150
       TXL     *+2,1,5             TEST FOR CARRY FROM BYTE ADDITION    3L000160
       ACL     BYTCON              FORCE CARRY TO ADDRESS               3L000170
       TRA     1,2                 RETURN                               3L000180
MVP666 CAL*    1,4                 CAL L(PI)                            3L000190
       TRA     1,2                 RETURN                               3L000200
MVP777 SLW     SPOINT              1ST RETURN - PLANT SOURCE ADDRESS    3L000210
       AXC     MVP888-1,2          SET RETURN TO MVP888                 3L000220
       TXI     MVP333,4,-1         GO GET TARGET ADDRESS.               3L000230
MVP888 SLW     TPOINT              PLANT TARGET ADDRESS                 3L000240
       TXI     NXTMAC+3,4,-2       BEGIN EXECUTION OF TXI STRING        3L000250
       ENTRY   .CMPK1                                                   3L000260
.CMPK1 SXA     SAVE2,2                                                  3L000270
       STO     SAVACC                                                   3L000280
       TSX     MVP222,2                                                 3L000290
       SLW     TPOINT                                                   3L000300
       CLA     SAVACC                                                   3L000310
       TXI     NXTMAC+3,4,-2                                            3L000320
       ENTRY   .CMPK2                                                   3L000330
.CMPK2 SXA     SAVE2,2                                                  3L000340
       TSX     MVP222,2                                                 3L000350
       SLW     SPOINT                                                   3L000360
       TXI     NXTMAC+3,4,-2                                            3L000370
SAVXR4 PZE     **                                                       3L000380
       ENTRY   .CMPK3                                                   3L000390
.CMPK3 SXA     SAVE1,1                                                  3L000400
       SXA     SAVE2,2                                                  3L000410
       SXA     SAVXR4,4            SAVE XR4 FOR DEBUGGING               3L000420
       TXI     NXTMAC+3,4,-1                                            3L000430
 NSWRD SXA     *+6,4                                                    3L000440
       LXA     SPOINT,4                                                 3L000450
       TXI     *+1,4,1                                                  3L000460
       SXA     SPOINT,4                                                 3L000470
       LDQ*    SPOINT                                                   3L000480
       AXT     6,4                                                      3L000490
       TRA     **                                                       3L000500
 NTWRD SXA     *+6,2                                                    3L000510
       SLW*    TPOINT                                                   3L000520
       LXA     TPOINT,2                                                 3L000530
       TXI     *+1,2,1                                                  3L000540
       SXA     TPOINT,2                                                 3L000550
       AXT     6,2                                                      3L000560
       TRA     **                                                       3L000570
NXTMAC SXA     SBYTE,4                                                  3L000580
       ENTRY   .CX4                                                     3L000590
MACCTR NULL                                                             3L000591
.CX4   AXT     **,4                                                     3L000600
       TXI     *+1,4,-1                                                 3L000620
       AXT     0,1                                                      3L000630
       XEC     0,4                                                      3L000640
       TIX     *-1,4,1                                                  3L000650
       ENTRY   .CXIT                                                    3L000660
MVPKXT NULL                                                             3L000661
.CXIT  LXA     .CX4,4                                                   3L000670
 SAVE1 AXT     **,1                                                     3L000690
 SAVE2 AXT     **,2                                                     3L000700
       TRA     1,4                                                      3L000710
       ENTRY   .CAREF                                                   3L000720
SPOINT NULL                                                             3L000721
.CAREF PZE     **,,**              ADDRESS,,BYTE                        3L000730
       ENTRY   .CBREF                                                   3L000750
TPOINT NULL                                                             3L000751
.CBREF PZE     **,,**              ADDRESS,,BYTE                        3L000760
       ENTRY   .COFLO                                                   3L000770
OVTRIG NULL                                                             3L000771
.COFLO PZE     **                                                       3L000780
       ENTRY   .CUFLO                                                   3L000790
MOVUNF NULL                                                             3L000791
.CUFLO PZE     **                                                       3L000800
RNTRIG PZE     0                                                        3L000840
STTRIG PZE     0                                                        3L000850
 OVSW  PZE     0                                                        3L000860
SCTRIG PZE     0                                                        3L000870
SAVTGT PZE     0                                                        3L000880
SRCWRD PZE     0                                                        3L000890
SGNCON PZE     0                                                        3L000900
BYTCON OCT     777772000000                                             3L000910
 OV17B OCT     000000000017                                             3L000920
 SBYTE PZE     0                                                        3L000930
BYTRIG PZE     0                                                        3L000940
SAVACC PZE     0                                                        3L000950
EDTBUF BSS     5                                                        3L000960
       AXT     0,0                                                      3L000970
       RQL     30                                                       3L000980
       RQL     24                                                       3L000990
       RQL     18                                                       3L001000
       RQL     12                                                       3L001010
       RQL     6                                                        3L001020
RQLTBL AXT     0,0                                                      3L001030
       RQL     6                                                        3L001040
       RQL     12                                                       3L001050
       RQL     18                                                       3L001060
       RQL     24                                                       3L001070
       RQL     30                                                       3L001080
       AXT     0,0                                                      3L001090
       LGL     30                                                       3L001100
       LGL     24                                                       3L001110
       LGL     18                                                       3L001120
       LGL     12                                                       3L001130
       LGL     6                                                        3L001140
LGLTBL AXT     0,0                                                      3L001150
       LGL     6                                                        3L001160
       LGL     12                                                       3L001170
       LGL     18                                                       3L001180
       LGL     24                                                       3L001190
       LGL     30                                                       3L001200
       AXT     0,0                                                      3L001210
       LGR     30                                                       3L001220
       LGR     24                                                       3L001230
       LGR     18                                                       3L001240
       LGR     12                                                       3L001250
       LGR     6                                                        3L001260
LGRTBL AXT     0,0                                                      3L001270
       LGR     6                                                        3L001280
       LGR     12                                                       3L001290
       LGR     18                                                       3L001300
       LGR     24                                                       3L001310
       LGR     30                                                       3L001320
       AXT     0,0                                                      3L001330
       AXT     0,0                                                      3L001340
       ALS     30                                                       3L001350
       ALS     24                                                       3L001360
       ALS     18                                                       3L001370
       ALS     12                                                       3L001380
       ALS     6                                                        3L001390
ALSTBL AXT     0,0                                                      3L001400
       ALS     6                                                        3L001410
       ALS     12                                                       3L001420
       ALS     18                                                       3L001430
       ALS     24                                                       3L001440
       ALS     30                                                       3L001450
       AXT     0,0                                                      3L001460
XITBL5 PZE     XITBL4,0,0                                               3L001470
       PZE     XITBL4,0,12500                                           3L001480
       PZE     XITBL4,0,25000                                           3L001490
       PON     XITBL4,0,04732                                           3L001500
       PON     XITBL4,0,17232                                           3L001510
       PON     XITBL4,0,29732                                           3L001520
       PTW     XITBL4,0,09464                                           3L001530
       PTW     XITBL4,0,21964                                           3L001540
       PTH     XITBL4,0,01696                                           3L001550
       PTH     XITBL4,0,14196                                           3L001560
       PZE     XITBL4,0,0                                               3L001570
       PZE     XITBL4,0,0                                               3L001580
       PZE     XITBL4,0,0                                               3L001590
       PZE     XITBL4,0,0                                               3L001600
       PZE     XITBL4,0,0                                               3L001610
       PZE     XITBL4,0,0                                               3L001620
XITBL4 PZE     XITBL3,0,0                                               3L001630
       PZE     XITBL3,0,01250                                           3L001640
       PZE     XITBL3,0,02500                                           3L001650
       PZE     XITBL3,0,03750                                           3L001660
       PZE     XITBL3,0,05000                                           3L001670
       PZE     XITBL3,0,06250                                           3L001680
       PZE     XITBL3,0,07500                                           3L001690
       PZE     XITBL3,0,08750                                           3L001700
       PZE     XITBL3,0,10000                                           3L001710
       PZE     XITBL3,0,11250                                           3L001720
       PZE     XITBL3,0,0                                               3L001730
       PZE     XITBL3,0,0                                               3L001740
       PZE     XITBL3,0,0                                               3L001750
       PZE     XITBL3,0,0                                               3L001760
       PZE     XITBL3,0,0                                               3L001770
       PZE     XITBL3,0,0                                               3L001780
XITBL3 PZE     XITBL2,0,0                                               3L001790
       PZE     XITBL2,0,00125                                           3L001800
       PZE     XITBL2,0,00250                                           3L001810
       PZE     XITBL2,0,00375                                           3L001820
       PZE     XITBL2,0,00500                                           3L001830
       PZE     XITBL2,0,00625                                           3L001840
       PZE     XITBL2,0,00750                                           3L001850
       PZE     XITBL2,0,00875                                           3L001860
       PZE     XITBL2,0,01000                                           3L001870
       PZE     XITBL2,0,01125                                           3L001880
       PZE     XITBL2,0,0                                               3L001890
       PZE     XITBL2,0,0                                               3L001900
       PZE     XITBL2,0,0                                               3L001910
       PZE     XITBL2,0,0                                               3L001920
       PZE     XITBL2,0,0                                               3L001930
       PZE     XITBL2,0,0                                               3L001940
XITBL2 PZE     XITBL1,0,0                                               3L001950
       PZE     XITBL1,4,12                                              3L001960
       PZE     XITBL1,0,25                                              3L001970
       PZE     XITBL1,4,37                                              3L001980
       PZE     XITBL1,0,50                                              3L001990
       PZE     XITBL1,4,62                                              3L002000
       PZE     XITBL1,0,75                                              3L002010
       PZE     XITBL1,4,87                                              3L002020
       PZE     XITBL1,0,100                                             3L002030
       PZE     XITBL1,4,112                                             3L002040
       PZE     XITBL1,0,0                                               3L002050
       PZE     XITBL1,0,0                                               3L002060
       PZE     XITBL1,0,0                                               3L002070
       PZE     XITBL1,0,0                                               3L002080
       PZE     XITBL1,0,0                                               3L002090
       PZE     XITBL1,0,0                                               3L002100
XITBL1 PZE     XITBL,0,0                                                3L002110
       PZE     XITBL,2,1                                                3L002120
       PZE     XITBL,4,2                                                3L002130
       PZE     XITBL,6,3                                                3L002140
       PZE     XITBL,0,5                                                3L002150
       PZE     XITBL,2,6                                                3L002160
       PZE     XITBL,4,7                                                3L002170
       PZE     XITBL,6,8                                                3L002180
       PZE     XITBL,0,10                                               3L002190
       PZE     XITBL,2,11                                               3L002200
       PZE     XITBL,0,0                                                3L002210
       PZE     XITBL,0,0                                                3L002220
       PZE     XITBL,0,0                                                3L002230
       PZE     XITBL,0,0                                                3L002240
       PZE     XITBL,0,0                                                3L002250
       PZE     XITBL,0,0                                                3L002260
 XITBL PZE     XITBL,0,0                                                3L002270
       PZE     XITBL,1,0                                                3L002280
       PZE     XITBL,2,0                                                3L002290
       PZE     XITBL,3,0                                                3L002300
       PZE     XITBL,4,0                                                3L002310
       PZE     XITBL,5,0                                                3L002320
       PZE     XITBL,6,0                                                3L002330
       PZE     XITBL,7,0                                                3L002340
       PZE     XITBL,0,1                                                3L002350
       PZE     XITBL,1,1                                                3L002360
       PZE     XITBL                                                    3L002370
       PZE     XITBL                                                    3L002380
       PZE     XITBL                                                    3L002390
       PZE     XITBL                                                    3L002400
       PZE     XITBL                                                    3L002410
       PZE     XITBL                                                    3L002420
       SPACE   4                                                        3L002430
* BINARY TO BCD DECIMAL LENGTH IN XR1. ADDRESS IN TPOINT                3L002440
       ENTRY   .CIDX1                                                   3L002450
.CIDX1 STZ     SGNCON                                                   3L002460
       SSP                                                              3L002470
       TRA     MVIX2                                                    3L002480
       ENTRY   .CIDX4                                                $5$3L002490
.CIDX4 AXT     1,2           MINUS OVERPUNCH CONVENTION ONLY         $5$3L002500
       TRA     .CIDX2+1                                              $5$3L002510
       ENTRY   .CIDX2              MOVIXM                               3L002520
.CIDX2 AXT     2,2                SIGN CONVENTION                       3L002530
       TPL     *+3                                                      3L002540
       TXI     *+1,2,3                                                  3L002550
       SSP                                                              3L002560
       SXA     SGNCON,2                                                 3L002570
 MVIX2 SXA     MACCTR,4                                                 3L002580
       LDC     TPOINT,2                                                 3L002590
       TXI     *+1,2,6                                                  3L002600
       LAC     TPOINT,4                                                 3L002610
       TIX     MVIXDP,1,10                                              3L002620
 MVIX5 LDQ     0,4                                                      3L002630
       STQ     UPPER                                                    3L002640
       XEC     RQLTBL+6,2                                               3L002650
 MVIX3 XEC     MVIX4,1                                                  3L002660
       LRS     0                                                        3L002670
       XEC     IX10,1                                                   3L002680
       TRA     IX10                                                     3L002690
       ALS     1                                                        3L002700
       ALS     1                                                        3L002710
       ALS     7                                                        3L002720
       TRA     IX6                                                      3L002730
       ALS     1                                                        3L002740
       ALS     7                                                        3L002750
       ALS     13                                                       3L002760
       ALS     19                                                       3L002770
       ALS     25                                                       3L002780
 MVIX4 PZE     **                                                       3L002790
       TRA     IX9                                                      3L002800
       TRA     IX8                                                      3L002810
       TRA     IX7                                                      3L002820
       PZE     **                                                       3L002830
       TRA     IX5                                                      3L002840
       TRA     IX4                                                      3L002850
       TRA     IX3                                                      3L002860
       TRA     IX2                                                      3L002870
       TRA     IX1                                                      3L002880
 IX10  RQL     5                                                        3L002890
       LRS     5                                                        3L002900
       VDP     9X2,,6                                                   3L002910
       TIX     *+2,2,1                                                  3L002920
       TSX     MVIXW,1                                                  3L002930
 IX9   VDP     8X2E7,,6                                                 3L002940
       TIX     *+2,2,1                                                  3L002950
       TSX     MVIXW,1                                                  3L002960
       ARS     6                                                        3L002970
 IX8   VDP     7X2E7,,6                                                 3L002980
       TIX     *+2,2,1                                                  3L002990
       TSX     MVIXW,1                                                  3L003000
 IX7   VDP     6X2E13,,6                                                3L003010
       TIX     *+2,2,1                                                  3L003020
       TSX     MVIXW,1                                                  3L003030
       ARS     13                                                       3L003040
 IX6   RQL     5                                                        3L003050
       LRS     5                                                        3L003060
       VDP     5X2,,6                                                   3L003070
       TIX     *+2,2,1                                                  3L003080
       TSX     MVIXW,1                                                  3L003090
 IX5   VDP     4X2E7,,6                                                 3L003100
       TIX     *+2,2,1                                                  3L003110
       TSX     MVIXW,1                                                  3L003120
 IX4   VDP     3X2E13,,6                                                3L003130
       TIX     *+2,2,1                                                  3L003140
       TSX     MVIXW,1                                                  3L003150
 IX3   VDP     2X2E19,,6                                                3L003160
       TIX     *+2,2,1                                                  3L003170
       TSX     MVIXW,1                                                  3L003180
 IX2   VDP     1X2E25,,6                                                3L003190
       TIX     *+2,2,1                                                  3L003200
       TSX     MVIXW,1                                                  3L003210
 IX1   VDP     2E31,,6                                                  3L003220
       ZET     DPTEST                                                   3L003230
       TRA     IXDP2                                                    3L003240
       XCA                                                              3L003250
 MVIXD PAI                         P7                                   3L003260
       LXA     SGNCON,1                                                 3L003270
       ACL     SGNTB2,1                                                 3L003280
       RFT     17                                                       3L003290
       TRA     *+2                                                      3L003300
       ACL     ZROTBL,1                                                 3L003310
       TNX     *+4,2,1                                                  3L003320
       LDQ     0,4                                                      3L003330
       XEC     RQLTBL+6,2                                               3L003340
       XEC     LGLTBL,2                                                 3L003350
       SLW     0,4                                                      3L003360
       LXD     TPOINT,1                                                 3L003370
       TXL     IXT,1,0             P7                                   3L003380
       CAL     UPPER                                                    3L003390
       STP*    TPOINT                                                   3L003400
 IXT   ZET     RPTRG                                                    3L003410
       TRA     IDRP2                                                    3L003420
       TRA     MVPKXT                                                   3L003430
 MVIXW STQ     0,4                                                      3L003440
       TXI     *+1,4,-1                                                 3L003450
       AXT     6,2                                                      3L003460
       TRA     1,1                                                      3L003470
MVIXDP DVP     10E10                                                    3L003480
       XCA                                                              3L003490
       SSP                                                              3L003500
       STQ     LOWER                                                    3L003510
       STL     DPTEST                                                   3L003520
       TRA     MVIX5                                                    3L003530
 IXDP2 TIX     *+2,2,1                                                  3L003540
       TSX     MVIXW,1                                                  3L003550
       CLA     LOWER                                                    3L003560
       SSP                                                              3L003570
       STZ     DPTEST                                                   3L003580
       TRA     IX10                                                     3L003590
10E10  OCT     112402762000        DEC 10000000000                      3L003600
9X2    OCT     016715312000        DEC 20000000000                      3L003610
8X2E7  OCT     137274100000        DEC 12800000000                      3L003620
7X2E7  OCT     011422640000        DEC 1280000000                       3L003630
6X2E13 OCT     075022000000        DEC 8192000000                       3L003640
5X2    OCT     000000606500        DEC 200000                           3L003650
4X2E7  OCT     000004704000        DEC 1280000                          3L003660
3X2E13 OCT     000037200000        DEC 8192000                          3L003670
2X2E19 OCT     000310000000        DEC 52428800                         3L003680
1X2E25 OCT     002400000000        DEC 335544320                        3L003690
 2E31  OCT     020000000000                                             3L003700
       ENTRY   .CXDID                                                   3L003710
.CXDID STZ     LOWER                                                    3L003720
 MOVXI EQU     .CXDID                                                   3L003730
       TRA     RELOC                                                    3L003740
       LAC     SPOINT,2                                                 3L003750
       LXD     SPOINT,4                                                 3L003760
 MVXI2 CAL     0,2                                                      3L003770
       LDQ     1,2                                                      3L003780
       XEC     LGLTBL,4                                                 3L003790
       PAI                                                              3L003800
       ANA     7TEENS                                                   3L003810
       XCL                                                              3L003820
       PXA     0,0                                                      3L003830
       TIX     MVXI3,1,6                                                3L003840
       XEC     CAQTBL+1,1                                               3L003850
       SUB     LOCDIF+1,1                                               3L003860
       ARS     15                                                       3L003870
       ADD     LOWER                                                    3L003880
 MVXIS IIS     HIZONE              P8                                   3L003890
       XEC     XFTTBL+1,1                                               3L003900
       TRA     MVXIXT                                                   3L003910
       SSM                                                              3L003920
       LRS     0                                                        3L003930
MVXIXT TRA     MVPKXT                                                   3L003940
 MVXI3 CAQ     XITBL5,,6                                                3L003950
       SUB     LOCDF5                                                   3L003960
       ARS     15                                                       3L003970
       XCL                                                              3L003980
       TXH     MVXI4,1,4                                                3L003990
       MPY     MPYTBL+1,1                                               3L004000
       STQ     LOWER                                                    3L004010
       TXI     MVXI2,2,-1                                               3L004020
 MVXI4 STZ     UPPER                                                    3L004030
       LDI     LGLTBL,4                                                 3L004040
       STI     MVXI6                                                    3L004050
       AXT     0,4                                                      3L004060
       TIX     MVXI8,1,6                                                3L004070
       TXI     MVXI8,4,-1                                               3L004080
 MVXI5 CAL     0,2                                                      3L004090
       LDQ     1,2                                                      3L004100
 MVXI6 LGL     **                                                       3L004110
       PAI                                                              3L004120
       ANA     7TEENS                                                   3L004130
       XCL                                                              3L004140
       PXA     0,0                                                      3L004150
       XEC     MVXI21,4                                                 3L004160
       XEC     MVXI24,4                                                 3L004170
       ARS     15                                                       3L004180
       ADD     LOWER                                                    3L004190
       LRS     35                                                       3L004200
       ADD     UPPER                                                    3L004210
 MVXI7 XEC     MVXI22,4                                                 3L004220
       AXT     -1,4                                                     3L004230
       XCA                                                              3L004240
       STO     LOWER                                                    3L004250
       XEC     MVXI23,4                                                 3L004260
       STQ     UPPER                                                    3L004270
       LDQ     LOWER                                                    3L004280
 MVXI8 XEC     MVXI23,4                                                 3L004290
       ADD     UPPER                                                    3L004300
       STO     UPPER                                                    3L004310
       STQ     LOWER                                                    3L004320
       TXI     MVXI5,2,-1                                               3L004330
 MVXI9 TRA     MVXIS               P9                                   3L004340
MVXI21 CAQ     XITBL5,,6                                                3L004350
       XEC     CAQTBL+1,1                                               3L004360
MVXI22 TIX     MVXI7+2,1,6                                              3L004370
       TRA     MVXI9                                                    3L004380
MVXI23 MPY     10EXP6                                                   3L004390
       MPY     MPYTBL+1,1                                               3L004400
MVXI24 SUB     LOCDF5                                                   3L004410
       SUB     LOCDIF+1,1                                               3L004420
HIZONE OCT     404040404040                                             3L004430
       RFT     000060                                                   3L004440
       RFT     006000                                                   3L004450
       RFT     600000                                                   3L004460
       LFT     000060                                                   3L004470
       LFT     006000                                                   3L004480
XFTTBL LFT     600000                                                   3L004490
7TEENS OCT     171717171717                                             3L004500
77EENS OCT     777777777717                                             3L004510
 LOWER EQU     MVIX4                                                    3L004520
 UPPER EQU     MVIX4+4                                                  3L004530
10EXP6 OCT     3641100             DEC 1000000                          3L004540
       OCT     303240              DEC 100000                           3L004550
       OCT     23420               DEC 10000                            3L004560
       OCT     1750                DEC 1000                             3L004570
       OCT     144                 DEC 100                              3L004580
MPYTBL OCT     000000000012                                             3L004590
       CAQ     XITBL5,,6                                                3L004600
       CAQ     XITBL4,,5                                                3L004610
       CAQ     XITBL3,,4                                                3L004620
       CAQ     XITBL2,,3                                                3L004630
       CAQ     XITBL1,,2                                                3L004640
CAQTBL CAQ     XITBL,,1                                                 3L004650
LOCDF5 PZE     XITBL4                                                   3L004660
       PZE     XITBL3                                                   3L004670
       PZE     XITBL2                                                   3L004680
       PZE     XITBL1                                                   3L004690
       PZE     XITBL                                                    3L004700
LOCDIF PZE     XITBL                                                    3L004710
 RELOC LDI     MVIX2                                                    3L004720
       STI     MOVXI+1                                                  3L004730
       AXT     0,2                                                      3L004740
       CLA     LOCDF5+5                                                 3L004750
       ADD     LOCDF5+4,2                                               3L004760
       STO     LOCDF5+4,2                                               3L004770
       TXH     MOVXI+1,2,3                                              3L004780
       TXI     *-3,2,1                                                  3L004790
DPTEST PZE     0                                                        3L004800
       PZE     10                  OP ZERO                              3L004810
       PZE     10                  OP ZERO                              3L004820
       PZE     0                   DECENT ZERO                          3L004830
       PZE     10                  OP ZERO                              3L004840
       PZE     0                  OP ZERO                            $5$3L004850
ZROTBL PZE     0                   OPZERO                               3L004860
       PZE     32                  YEH                                  3L004870
       PZE     32                  SI                                   3L004880
       PZE     0                   OUI                                  3L004890
       PZE     16                  JA                                   3L004900
       PZE     0                  OP ZERO                            $5$3L004910
SGNTB2 PZE     0                   YES                                  3L004920
       OCT     520000000000                                             3L004930
       OCT     520000000000                                             3L004940
       PZE     0                                                        3L004950
       OCT     320000000000                                             3L004960
       PZE     0                  OP ZERO                            $5$3L004970
ZRTBL2 PZE     0                                                        3L004980
       OCT     400000000000                                             3L004990
       OCT     400000000000                                             3L005000
       PZE     0                                                        3L005010
       OCT     200000000000                                             3L005020
       PZE     0                  OP ZERO                            $5$3L005030
SGNTB3 PZE     0                                                        3L005040
SUPTBL PZE     0                                                        3L005050
       PZE     1                                                        3L005060
       PZE     2                                                        3L005070
       PZE     3                                                        3L005080
       PZE     4                                                        3L005090
       PZE     5                                                        3L005100
       PZE     6                                                        3L005110
       PZE     7                                                        3L005120
       PZE     8                                                        3L005130
       PZE     9                                                        3L005140
       SPACE   4                                                        3L005150
*                                                                       3L005160
*      TXI     .CXDXD,1,TARGET.SIGN.CONVENTION                          3L005170
       ENTRY   .CXDXD              MOVXX                                3L005180
.CXDXD SXA     SGNCON,1                                                 3L005190
       LDC     TPOINT,2                                                 3L005200
       TXI     *+1,2,6                                                  3L005210
       CAL*    TPOINT                                                   3L005220
       XEC     LGRTBL,2                                                 3L005230
MOVXX2 LDC     SPOINT,1                                                 3L005240
       TXI     *+1,1,6                                                  3L005250
       SXA     SBYTE,1                                                  3L005260
       LDQ*    SPOINT                                                   3L005270
       XEC     RQLTBL+6,1                                               3L005280
       TXI     NXTMAC+3,4,-1                                            3L005290
       ENTRY   .CXMVS                                                   3L005300
.CXMVS STL     STTRIG                                                   3L005310
       ENTRY   .CXMOV                                                   3L005320
.CXMOV SXA     MACCTR,4                                                 3L005330
       LXA     SBYTE,4                                                  3L005340
 MVXX1 LGL     6                                                        3L005350
       PAI                                                              3L005360
       ANA     77EENS                                                   3L005370
       TIX     *+2,4,1                                                  3L005380
       TXI     NSWRD,4,*                                                3L005390
       TNX     MVXX2,1,1                                                3L005400
       TIX     MVXX1,2,1                                                3L005410
       TXI     NTWRD,2,MVXX1-1                                          3L005420
 MVXX2 ZET     STTRIG                                                   3L005430
       TSX     MSTRIP,1                                                 3L005440
       TIX     NXTMAC,2,1                                               3L005450
       TXI     NTWRD,2,NXTMAC-1                                         3L005460
       ENTRY   .CXBYS                                                   3L005470
.CXBYS STL     STTRIG                                                   3L005480
       ENTRY   .CXBYP                                                   3L005490
.CXBYP SXA     MACCTR,4                                                 3L005500
       LXA     SBYTE,4                                                  3L005510
 BYXX1 RQL     6                                                        3L005520
       TNX     BYXX2,1,1                                                3L005530
       TIX     BYXX1,4,1                                                3L005540
       TXI     NSWRD,4,BYXX1-1                                          3L005550
 BYXX2 ZET     STTRIG                                                   3L005560
       TSX     BSTRIP,1                                                 3L005570
       TIX     NXTMAC,4,1                                               3L005580
       TXI     NSWRD,4,NXTMAC-1                                         3L005590
       ENTRY   .CXNZS                                                   3L005600
.CXNZS STL     STTRIG                                                   3L005610
       ENTRY   .CXNZT                                                   3L005620
.CXNZT SXA     MACCTR,4                                                 3L005630
       LXA     SBYTE,4                                                  3L005640
       SLW     SAVACC                                                   3L005650
 OVXX1 LGL     6                                                        3L005660
       PAI                                                              3L005670
       ANA     OV17B                                                    3L005680
       CVR     EDTTBL,,1                                                3L005690
       ORS     OVTRIG                                                   3L005700
       TIX     *+2,4,1                                                  3L005710
       TXI     NSWRD,4,*                                                3L005720
       TIX     OVXX1,1,1                                                3L005730
       CAL     SAVACC                                                   3L005740
       ZET     STTRIG                                                   3L005750
       TSX     STRIP,1                                                  3L005760
       TRA     NXTMAC                                                   3L005770
BSTRIP STQ     SAVACC                                                   3L005780
       LDI     SAVACC                                                   3L005790
       TRA     STRIP                                                    3L005800
MSTRIP ANA     RNDMSK                                                   3L005810
       CVR     EDTTBL,,1                                                3L005820
       XCL                                                              3L005830
       RQL     6                                                        3L005840
       XCL                                                              3L005850
 STRIP STZ     STTRIG                                                   3L005860
       IIR     40                                                       3L005870
       RFT     60                                                       3L005880
       TRA     1,1                 RETURN ON + OR 0                     3L005890
       SXA     STRIP2,1                                                 3L005900
       LXA     SGNCON,1                                                 3L005910
       TXI     *+1,1,3                                                  3L005920
       SXA     SGNCON,1                                                 3L005930
       STL     MSIGN               THIS IS USED BY RP TXI STRING        3L005940
STRIP2 AXT     **,1                                                     3L005950
       TRA     1,1                                                      3L005960
       ENTRY   .CXINZ                                                   3L005970
.CXINZ ALS     6                                                        3L005980
 IZXX  EQU     .CXINZ                                                   3L005990
       TIX     *+2,2,1                                                  3L006000
       TXI     NTWRD,2,*                                                3L006010
       TIX     IZXX,1,1                                                 3L006020
       TXI     NXTMAC+3,4,-1                                            3L006030
       ENTRY   .CXRND                                                   3L006040
.CXRND XCL                                                              3L006050
       PAI                                                              3L006060
       ANA     RNXX2                                                    3L006070
       SUB     HITEN                                                    3L006080
       TPL     RNXX1                                                    3L006090
       ADD     HISIX                                                    3L006100
       TMI     RNXX1                                                    3L006110
       STL     RNTRIG                                                   3L006120
 RNXX1 PIA                                                              3L006130
       XCL                                                              3L006140
       TXI     NXTMAC+3,4,-1                                            3L006150
 RNXX2 OCT     170000000000                                             3L006160
 HITEN OCT     120000000000                                             3L006170
 HISIX OCT     060000000000                                             3L006180
 ROUND STZ     RNTRIG                                                   3L006190
       AXT     RNTBL+1,4                                                3L006200
       SXA     RNTBL+10,4                                               3L006210
       TXL     RND1,2,5                                                 3L006220
       LXA     TPOINT,2                                                 3L006230
       TXI     *+1,2,-1                                                 3L006240
       SXA     TPOINT,2                                                 3L006250
       AXT     0,2                                                      3L006260
       TRA     RND2                                                     3L006270
 RND1  XEC     LGRTBL+6,2                                               3L006280
       CAL*    TPOINT                                                   3L006290
       XEC     LGLTBL+6,2                                               3L006300
 RND2  SXA     *+1,1                                                    3L006310
       AXT     **,4                                                     3L006320
 RND3  ANA     RNDMSK                                                   3L006330
       CVR     RNTBL+1,1,1                                              3L006340
       TXL     RND8,1,RNTBL                                             3L006350
       LXA     SGNCON,1                                                 3L006360
       ACL     ZRTBL2,1                                                 3L006370
       TXI     RND5,2,1                                                 3L006380
 RND4  ANA     RNDMSK                                                   3L006390
       CVR     RNTBL+1,1,1                                              3L006400
       TXI     *+1,2,1                                                  3L006410
       TXL     RND7,1,RNTBL                                             3L006420
 RND5  TXL     RND6,2,5                                                 3L006430
       SLW*    TPOINT                                                   3L006440
       LXA     TPOINT,2                                                 3L006450
       TXI     *+1,2,-1                                                 3L006460
       SXA     TPOINT,2                                                 3L006470
       AXT     0,2                                                      3L006480
       CAL*    TPOINT                                                   3L006490
 RND6  TIX     RND4,4,1                                                 3L006500
       STL     OVTRIG                                                   3L006510
 RND7  XCL                                                              3L006520
       XEC     RQLTBL,2                                                 3L006530
       STQ*    TPOINT                                                   3L006540
       AXT     RNTBL,4                                                  3L006550
       SXA     RNTBL+10,4                                               3L006560
RNDXIT TRA     LSTWR1                                                   3L006570
 RND8  LXA     SGNCON,1                                                 3L006580
       ACL     SGNTB3,1                                                 3L006590
       TXI     RND7,2,1                                                 3L006600
RNDMSK OCT     777777777717                                             3L006610
 RNTBL PZE     RNTBL,0,0                                                3L006620
       PZE     RNTBL,0,4096                                             3L006630
       PZE     RNTBL,0,8192                                             3L006640
       PZE     RNTBL,0,12288                                            3L006650
       PZE     RNTBL,0,16384                                            3L006660
       PZE     RNTBL,0,20480                                            3L006670
       PZE     RNTBL,0,24576                                            3L006680
       PZE     RNTBL,0,28672                                            3L006690
       PON     RNTBL,0,0                                                3L006700
       PON     RNTBL,0,4096                                             3L006710
       PZE     RNTBL,0,0                                                3L006720
       PZE     RNTBL,0,0                                                3L006730
       PZE     RNTBL,0,0                                                3L006740
       PZE     RNTBL,0,0                                                3L006750
       PZE     RNTBL,0,0                                                3L006760
       PZE     RNTBL,0,0                                                3L006770
EDTTBL EQU     RNTBL                                                    3L006780
       ENTRY   .CXDXQ                                                   3L006790
.CXDXQ SXA     MACCTR,4                                                 3L006800
       ZET     RNTRIG                                                   3L006810
       TRA     ROUND                                                    3L006820
OVPNCH LXA     SGNCON,1                                                 3L006830
       ACL     SGNTB2,1                                                 3L006840
       PAI                                                              3L006850
       RFT     17                                                       3L006860
       TRA     *+2                                                      3L006870
       ACL     ZROTBL,1                                                 3L006880
LSTWRD LAC     TPOINT,1                                                 3L006890
       TXL     *+2,2,5                                                  3L006900
       TXI     *+4,1,1                                                  3L006910
       LDQ     0,1                                                      3L006920
       XEC     RQLTBL+6,2                                               3L006930
       XEC     LGLTBL,2                                                 3L006940
       SLW     0,1                                                      3L006950
LSTWR1 ZET     RPTRG                                                    3L006960
       TRA     .CXDRQ+2                                                 3L006970
       TRA     MVPKXT                                                   3L006980
       SPACE   4                                                        3L006990
*                                                                       3L007000
*  MOVE ALPHABETIC FIELD (A) TO ALPHABETIC FIELD (B)                    3L007010
*  WHERE APOINT = PZE L(A),,BYTE POSITION                               3L007020
*        BPOINT = PZE L(B),,BYTE POSITION                               3L007030
*        INDEX 1 = NUMBER OF CHARACTERS TO MOVE                         3L007040
*  NORMAL RETURN IS TO SAVE 1                                           3L007050
*  (THIS MAY BE USED AS A CLOSED SUBROUTINE AS FOLLOWS)                 3L007060
*      STL S239                                                         3L007070
*      TSX MOVAA+1                                                      3L007080
*                                                                       3L007090
       ENTRY   .CANA1                                                   3L007100
MOVAA  NULL                                                             3L007101
.CANA1 STZ     S239                SET UP NORMAL RETURN TO SAVE1        3L007110
       SXA     RB8,4               SAVE INDEX 4                         3L007130
       LAC     APOINT,2            GET LOCATION OF SOURCE FIELD         3L007140
       LAC     BPOINT,4            GET LOCATION OF TARGET FIELD         3L007150
R2     CAL     0,2                 GET FIRST 2 WORDS                    3L007160
       LDQ     1,2                    OF SOURCE FIELD                   3L007170
       SXA     RT,1                SAVE CHARACTER COUNT                 3L007180
       LDI     0,4                 GET FIRST WORD OF TARGET FIELD       3L007190
       LDC     BPOINT,1            SHIFT SOURCE FIELD RIGHT BY          3L007200
       XEC     LGRTBL,1               6X BYTE POSITION OF TARGET FIELD  3L007210
       LDC     APOINT,1            SHIFT SOURCE FIELD LEFT BY           3L007220
       XEC     LGLTBL,1               6X BYTE POSITION OF SOURCE FIELD  3L007230
       LDC     BPOINT,1            GET BYTE POSITION OF TARGET AND      3L007240
       XEC     TRATAB,1               TRANSFER TO PROPER SUBROUTINE     3L007250
TRATAB TRA     RB1                 TRANSFER POINT FOR BYTE 0            3L007260
       TRA     RB2                 TRANSFER POINT FOR BYTE 1            3L007270
       TRA     RB3                 TRANSFER POINT FOR BYTE 2            3L007280
       TRA     RB4                 TRANSFER POINT FOR BYTE 3            3L007290
       TRA     RB5                 TRANSFER POINT FOR BYTE 4            3L007300
       TRA     RB6                 TRANSFER POINT FOR BYTE 5            3L007310
RT     AXT     0,1                 MAKE SYS 239 A CLOSED SUBROUTINE     3L007320
RB1    XEC     RT                  NO. OF CHARACTERS STILL TO MOVE      3L007330
       TXH     RB14,1,5            BYTE 0 TEST IF AT LEAST              3L007340
RT2    RIL     770000                 6 CHARACTERS ARE TO BE MOVED      3L007350
       TIX     RB2A,1,1            NO - RESET BYTE 0 OF TARGET          3L007360
       ANA     RMSK10              TRANSFER IF MORE CHARACTERS          3L007370
       AXT     1,2                    ELSE ISOLATE BYTE 0 OF            3L007380
       TRA     RB7                    SOURCE FIELD AND TRANSFER         3L007390
RB2    XEC     RT                  NO OF CHARACTERS REMAINING           3L007400
       ANA     RMSK1               RESET BYTE 0 OF SOURCE               3L007410
RB2A   RIL     007700              RESET BYTE 1 /F TARGET               3L007420
       TIX     RB3A,1,1            TRANSFER IF MORE CHARACTERS          3L007430
       ANA     RMSK9               RESET BYTES 2-5 OF SOURCE FIELD      3L007440
       AXT     2,2                 MARK NEXT BYTE POSITION              3L007450
       TRA     RB7                    AND TRANSFER TO RB7               3L007460
RB3    XEC     RT                  NO. OF CHARACTERS STILL TO MOVE      3L007470
       ANA     RMSK2               RESET BYTES 0,1 OF SOURCE FIELD      3L007480
RB3A   RIL     000077              RESET BYTE 2 OF TARGET FIELD         3L007490
       TIX     RB4A,1,1            TRANSFER IF MORE CHARACTERS          3L007500
       ANA     RMSK8                  ELSE RESET BYTES 3 THRU 5         3L007510
       AXT     3,2                    OF SOURCE FIELD AND               3L007520
       TRA     RB7                    TRANSFER TO RB7                   3L007530
RB4    XEC     RT                  NO OF CHARACTERS STILL TO MOVE       3L007540
       ANA     RMSK3               RESET BYTES 0-2 OF SOURCE FIELD      3L007550
RB4A   RIR     770000              RESET BYTE 3 OF TARGET FIELD         3L007560
       TIX     RB5A,1,1            TRANSFER IF MORE CHARACTERS          3L007570
       ANA     RMSK7               RESET BYTES 4-5                      3L007580
       AXT     4,2                    OF SOURCE FIELD                   3L007590
       TRA     RB7                 AND TRANSFER TO RB7                  3L007600
RB5    XEC     RT                  NO OF CHARACTERS STILL TO MOVE       3L007610
       ANA     RMSK4               RESET BYTES 0 THRU 3 OF SOURCE FIELD 3L007620
RB5A   RIR     007700              RESET BYTE 4 OF TARGET FIELD         3L007630
       TIX     RB6A,1,1            TRANSFER IF MORE CHARACTERS          3L007640
       ANA     RMSK6                  ELSE RESET BYTE 5                 3L007650
       AXT     5,2                    OF SOURCE FIELD                   3L007660
       TRA     RB7                    AND TRANSFER TO RB7               3L007670
RB6    XEC     RT                  NO OF CHARACTERS STILL TO MOVE       3L007680
       ANA     RMSK5               RESET BYTES 0 THRU 4 OF SOURCE FIELD 3L007690
RB6A   RIR     000077              RESET BYTE 5 OF TARGET FIELD         3L007700
       TIX     RB10,1,1            TRANSFER IF MORE CHARACTERS          3L007710
       AXT     0,2                 INDICATE TARGET ENDS AT BYTE 5       3L007720
RB7    OAI                            ELSE OR SIGNIFICANT SOURCE        3L007730
       STI     0,4                    FIELD CHARACTERS INTO TARGET FIELD3L007740
       SXA     R243A,2             SAVE LAST TARGET FIELD BYTE POSITION 3L007750
       SXD     R243A,4             SAVE LAST TARGET FIELD ADDRESS       3L007760
RB8    AXT     0,4                 RESTORE INDEX 4                      3L007770
       ZET     S239                TEST FOR NORMAL RETURN               3L007780
       TRA     1,4                    NO - EXIT AS IF CLOSED SUBROUTINE 3L007790
       TRA     SAVE1                  ELSE RETURN TO MOVE DRIVER        3L007800
R243A  PZE     0                   PZE LAST TARGET BYTE,,LAST TARGET ADD3L007810
RB10   OAI                         OR SIGNIFICANT SOURCE CHARACTERS     3L007820
RB11   STI     0,4                    INTO TARGET FIELD.                3L007830
RB12   SXA     RT,1                SAVE REMAINING CHARACTER COUNT       3L007840
       CAL     APOINT              TEST IF BYTE POSITION OF A           3L007850
       SUB     BPOINT                 IS GREATER THAN BYTE OF B         3L007860
       TPL     RB15                YES - TRANSFER TO RB15               3L007870
RB12A  CAL     0,2                 GET NEXT 2 WORDS OF SOURCE           3L007880
       LDQ     1,2                    FIELD IN ACCUM. AND MQ            3L007890
       LDC     APOINT,1            SHIFT SOURCE FIELD LEFT BY           3L007900
       XEC     LGLTBL,1               6X BYTE POSITION OF A             3L007910
       LDC     BPOINT,1            SHIFT SOURCE FIELD RIGHT BY          3L007920
       XEC     LGRTBL,1               6X BYTE POSITION OF B             3L007930
       XCL                         PLACE SECOND WORD IN ACCUM           3L007940
       LDI     1,4                 NEXT WORD OF TARGET FIELD            3L007950
       TXI     *+1,2,-1            BUMP SOURCE INDEX                    3L007960
       TXI     *+1,4,-1            BUMP TARGET INDEX                    3L007970
       XEC     RT                  GET REMAINING CHARACTER COUNT        3L007980
       TNX     RT2,1,6             TRANSFER IF LESS THAN 6 CHARS LEFT   3L007990
       SXA     RT,1                SAVE REMAINING CHARACTER COUNT       3L008000
       SLW     0,4                 MOVE FULL WORD TO TARGET             3L008010
       TRA     RB12A                  AND REPEAT ABOVE LOOP             3L008020
RB13   CAL     0,2                 GET NEXT 2 WORDS OF SOURCE           3L008030
       LDQ     1,2                    FIELD INTO ACCUM AND MQ           3L008040
       LDC     BPOINT,1            SHIFT SOURCE FIELD RIGHT BY          3L008050
       XEC     LGRTBL,1               6 X BYTE POSITION OF B            3L008060
       LDC     APOINT,1            SHIFT SOURCE FIELD LEFT BY           3L008070
       XEC     LGLTBL,1               6 X BYTE POSITION OF A            3L008080
       XEC     RT                  GET REMAINING CHARACTER COUNT        3L008090
       LDI     0,4                 GET NEXT TARGET WORD                 3L008100
RB14   TNX     RT2,1,6             TRANSFER IF LESS THAN 6 CHARS LEFT   3L008110
       SXA     RT,1                SAVE REMAINING CHARACTER COUNT       3L008120
       SLW     0,4                 MOVE FULL WORD TO TARGET             3L008130
RB15   TXI     *+1,4,-1            BUMP TARGET INDEX                    3L008140
       TXI     RB13,2,-1           BUMP SOURCE INDEX AND REPEAT LOOP    3L008150
RMSK1  OCT     7777777777          BYTES 1-5 MASK                       3L008160
RMSK2  OCT     77777777            BYTES 2-5 MASK                       3L008170
RMSK3  OCT     777777              BYTES 3-5 MASK                       3L008180
RMSK4  OCT     7777                BYTES 4-5 MASK                       3L008190
RMSK5  OCT     77                  BYTE 5 MASK                          3L008200
RMSK6  OCT     777777777700        BYTES 0-4 MASK                       3L008210
RMSK7  OCT     777777770000        BYTES 0-3 MASK                       3L008220
RMSK8  OCT     777777000000        BYTES 0-2 MASK                       3L008230
RMSK9  OCT     777700000000        BYTES 0-1 MASK                       3L008240
RMSK10 OCT     770000000000        BYTE 0 MASK                          3L008250
S239   PZE     0                                                        3L008260
*                                                                       3L008270
*  MOVE ALPHABETIC FIELD (A) TO ALPHABETIC FIELD (B) WITH               3L008280
*  ADDITIONAL BLANK CHARACTERS                                          3L008290
*      WHERE   APOINT = PZE L(A),,BYTE POSITION                         3L008300
*              BPOINT = PZE L(B),,BYTE POSITION                         3L008310
*              INDEX 1 = NO OF CHARACTERS IN (A)                        3L008320
*  NORMAL RETURN IS TXI MACCTR+2,4,-1                                   3L008330
*                                                                       3L008340
       ENTRY   .CANA2                                                   3L008350
MOVAAB NULL                                                             3L008351
.CANA2 STL     S239                MAKE SYS239 A CLOSED SUBR            3L008360
       SXA     *+2,4               SAVE INDEX 4                         3L008380
       TSX     MOVAA+1,4           MOVE A TO B                          3L008390
       AXT     **,4                RESTORE INDEX 4                      3L008400
       TXI     MACCTR+2,4,-1       RETURN TO DRIVER                     3L008410
       ENTRY   .CANA3                                                   3L008420
MOVBAA NULL                                                             3L008421
.CANA3 STZ     S241                   AFTER A TO B MOVE                 3L008430
       SXA     R243C,4             SAVE INDEX 4                         3L008450
       LDC     R243A,2             GET ADDRESS OF TARGET FIELD          3L008460
       LXA     R243A,4             GET BYTE POSITION OF 1ST BLANK       3L008470
       TXH     *+2,4,0             TEST FOR BYTE 0                      3L008480
       TXI     *+1,2,1                YES - BUMP TARGET ADDRESS         3L008490
       SXA     BPOINT,2            MODIFY BPOINT (SYS133) TO            3L008500
       SXD     BPOINT,4               CONTAIN NEW ADDRESS AND BYTE      3L008510
       STL     S243                MAKE SYS243 A CLOSED SUBR            3L008520
       TSX     MOVBA+1,4           MOVE TRAILING BLANKS                 3L008530
R243C  AXT     0,4                 RESTORE INDEX 4                      3L008540
       ZET     S241                TEST FOR CLOSED SUBROUTINE           3L008550
       TRA     1,4                    YES - EXIT 1,4                    3L008560
       TRA     SAVE1               ELSE RETURN TO DRIVER                3L008570
S241   PZE     0                   CLOSED SUBROUTINE INDICATOR          3L008580
*                                                                       3L008590
*  MOVE ALPHABETIC FIELD TO ALPHABETIC FIELD WHEN INFORMATION           3L008600
*  IS UNKNOWN AT COMPILE TIME. THE ENTRY IS FOLLOWED BY                 3L008610
*  A CONTROL WORD OF THE FORM PZE C1,,C2                                3L008620
*  THE LOW ORDER 4 BITS OF INDEX 1 MEAN THE FOLLOWING.                  3L008630
*      BIT 15  C2 CONTAINS TARGET FIELDS LENGTH IN WORDS                3L008640
*      BIT 14  C1 CONTAINS SOURCE FIELDS LENGTH IN WORDS                3L008650
*      BIT 13  C2 IS LOCATION OF TARGET FIELDS LENGTH                   3L008660
*      BIT 12  C1 IS LOCATION OF SOURCE FIELDS LENGTH                   3L008670
*                                                                       3L008680
       ENTRY   .CANA4                                                   3L008690
.CANA4 PXA     0,1                 LOAD INDICATORS WITH                 3L008700
       PAI                            CONTENTS OF INDEX 1               3L008710
       CAL     1,4                 LOAD INDEX 2 WITH ADDRESS            3L008720
       PAC     ,2                  (C1) OF CONTROL WORD.                3L008730
       RFT     10                  IS C1 THE SOURCE FIELDS LENGTH       3L008740
       CAL     0,2                 NO-GET LENGTH OF SOURCE FIELD        3L008750
       RNT     2                   IS C1 EXPRESSED IN WORDS             3L008760
       TRA     *+5                    NO-TRANSFER TO *+5                3L008770
       STA     RA242               ELSE MULTIPLY NUMBER                 3L008780
       ALS     1                      OF WORDS BY 6                     3L008790
       ACL     RA242                  TO OBTAIN NUMBER                  3L008800
       ALS     1                      OF CHARACTERS.                    3L008810
       STA     RA242               STORE CHARACTER COUNT IN RA242       3L008820
       CAL     1,4                 LOAD INDEX 4                         3L008830
       ARS     18                     WITH COMPLEMENT                   3L008840
       PAC     ,2                        OF C2                          3L008850
       RFT     4                   IS C2 LOCATION OF LENGTH OF TARGET   3L008860
       CAL     0,2                    YES-GET LENGTH OF TARGET          3L008870
       RNT     1                   IS C2 EXPRESSED IN WORDS             3L008880
       TRA     *+5                    NO-TRANSFER TO *+5                3L008890
       STA     RB242               YES-MULTIPLY NUMBER                  3L008900
       ALS     1                      OF WORDS BY 6                     3L008910
       ACL     RB242                  TO OBTAIN NUMBER                  3L008920
       ALS     1                      OF CHARACTERS.                    3L008930
       STA     RB242               STORE CHARACTER COUNT IN RB242       3L008940
       LXA     RA242,1                AND IN INDEX 1                    3L008950
       CAS     RA242               COMPARE A AND B CHARACTER COUNTS     3L008960
       TRA     RBGTA               TRANSFER IF B GTR A                  3L008970
       TXI     MOVAA,4,-1          GO TO SYS 239 IF EQUAL               3L008980
       TRA     RAGTB               TRANSFER IF A GTR B                  3L008990
RBGTA  STL     S239                WHEN B IS LONGER THAN A              3L009000
       SXA     *+2,4               SAVE INDEX 4                         3L009010
       TSX     MOVAA+1,4           MOVE ENTIRE A TO B                   3L009020
       AXT     0,4                 RESTORE INDEX 4                      3L009030
       CLA     RB242               COMPUTE DIFFERENCE IN LENGTHS        3L009040
       SUB     RA242                  OF A AND B AND LOAD               3L009050
       PAX     ,1                        IN INDEX 1                     3L009060
       TXI     MOVBAA,4,-1         MOVE THAT NUMBER OF BLANKS TO B      3L009070
RAGTB  LXA     RB242,1             WHEN A IS LONGER THAN B              3L009080
       TXI     MOVAA,4,-1          MOVE NUMBER OF CHARACTERS IN B       3L009090
RA242  PZE     0                   LENGTH OF A                          3L009100
RB242  PZE     0                   LENGTH OF B                          3L009110
*                                                                       3L009120
*  MOVE BLANKS TO ALPHABETIC FIELD                                      3L009130
*     WHERE INDEX 1 = NO. OF BLANKS                                     3L009140
*           BPOINT = PZE L(TARGET),,BYTE OF TARGET                      3L009150
*                                                                       3L009160
       SPACE   4                                                        3L009170
       ENTRY   .CSPAN                                                   3L009180
MOVBA  NULL                                                             3L009181
.CSPAN STZ     S243                SET UP NORMAL RETURN                 3L009190
       SXA     RBY7,4              SAVE INDEX 4                         3L009210
       LAC     BPOINT,2            GET TARGET ADDRESS                   3L009220
       LDC     BPOINT,4            GET BYTE POSITION                    3L009230
       LDI     0,2                 GET FIRST TARGET WORD                3L009240
       TRA*    RBTAB,4             TRANSFER TO PROPER BYTE SUBR.        3L009250
RBY    TXH     RBY8,1,5            TRANSFER IF AT LEAST 6 BLANKS        3L009260
       RIL     770000              SET BYTE 0 OF TARGET                 3L009270
       SIL     600000                 FIELD BLANK                       3L009280
       TIX     *+2,1,1             TRANSFER IF MORE BLANKS              3L009290
       TRA     RBE                 ELSE GO TO RBE                       3L009300
RBY2   RIL     007700              SET BYTE 1 OF TARGET                 3L009310
       SIL     006000                 FIELD BLANK                       3L009320
       TIX     *+2,1,1             TRANSFER IF MORE BLANKS              3L009330
       TRA     RBE                 ELSE GO TO RBE                       3L009340
RBY3   RIL     000077              SET BYTE 2 OF TARGET                 3L009350
       SIL     000060                 FIELD BLANK                       3L009360
       TIX     *+2,1,1             TRANSFER IF MORE BLANKS              3L009370
       TRA     RBE                 ELSE GO TO RBE                       3L009380
RBY4   RIR     770000              SET BYTE 3 OF TARGET                 3L009390
       SIR     600000                 FIELD BLANK                       3L009400
       TIX     *+2,1,1             TRANSFER IF MORE BLANKS              3L009410
       TRA     RBE                 ELSE GO TO RBE                       3L009420
RBY5   RIR     007700              SET BYTE 4 OF TARGET                 3L009430
       SIR     006000                 FIELD BLANK                       3L009440
       TIX     *+2,1,1             TRANSFER IF MORE BLANKS              3L009450
       TRA     RBE                 ELSE GO TO RBE                       3L009460
RBY6   RIR     000077              SET BYTE 5 OF TARGET                 3L009470
       SIR     000060                 FIELD BLANK                       3L009480
RBE    STI     0,2                 STORE MODIFIED TARGET WORD           3L009490
       TIX     RMULT,1,1           TRANSFER IF MORE BLANKS              3L009500
RBY7   AXT     0,4                 RESTORE INDEX 4                      3L009510
       ZET     S243                TEST FOR NORMAL RETURN               3L009520
       TRA     1,4                    NO-TRANSFER 1,4                   3L009530
       TRA     SAVE1               RETURN TO DRIVER                     3L009540
RMULT  TXI     *+1,2,-1            BUMP TARGET INDEX                    3L009550
       LDI     0,2                 GET NEXT TARGET WORD                 3L009560
RBY8   TNX     RBY+1,1,6           TRANSFER IF LESS THAN 6 BLANKS       3L009570
       LDQ     BLANX               STORE 6 BLANKS                       3L009580
       STQ     0,2                    IN TARGET FIELD                   3L009590
       TRA     RMULT               REPEAT ABOVE LOOP                    3L009600
BLANX  OCT     606060606060        6 BLANK CHARACTERS                   3L009610
RBTAB  PZE     RBY                 TRANSFER ADDRESS FOR BYTE 0          3L009620
       PZE     RBY2                TRANSFER ADDRESS FOR BYTE 1          3L009630
       PZE     RBY3                TRANSFER ADDRESS FOR BYTE 2          3L009640
       PZE     RBY4                TRANSFER ADDRESS FOR BYTE 3          3L009650
       PZE     RBY5                TRANSFER ADDRESS FOR BYTE 4          3L009660
       PZE     RBY6                TRANSFER ADDRESS FOR BYTE 5          3L009670
S243   PZE     0                   NORMAL RETURN INDICATOR              3L009680
*                                                                       3L009690
*  MOVE ZEROES TO ALPHABETIC FIELD                                      3L009700
*      WHERE INDEX 1 = NO OF ZEROES TO MOVE                             3L009710
*            BPOINT = PZE L(B),,BYTE OF B                               3L009720
*                                                                       3L009730
       ENTRY   .CZEAN                                                   3L009740
MOVZA  NULL                                                             3L009741
.CZEAN STZ     S244                SET UP NORMAL RETURN                 3L009750
       SXA     RZY7,4              SAVE INDEX 4                         3L009770
       LAC     BPOINT,2            GET TARGET ADDRESS                   3L009780
       LDC     BPOINT,4            GET TARGET BYTE POSITION             3L009790
       LDI     0,2                 GET FIRST TARGET FIELD               3L009800
       TRA*    RZTAB,4             TRANSFER TO PROPER BYTE SUBR.        3L009810
RZY    TXH     RZY8,1,5            TRANSFER IF AT LEAST 6 ZEROES        3L009820
       RIL     770000              SET BYTE 0 TO ZERO                   3L009830
       TIX     *+2,1,1             TRANSFER IF MORE ZEROES              3L009840
       TRA     RZE                    ELSE TRANSFER TO RZE              3L009850
RZY2   RIL     007700              SET BYTE 1 TO ZERO                   3L009860
       TIX     *+2,1,1             TRANSFER IF MORE ZEROES              3L009870
       TRA     RZE                    ELSE TRANSFER TO RZE              3L009880
RZY3   RIL     000077              SET BYTE 2 TO ZERO                   3L009890
       TIX     *+2,1,1             TRANSFER IF MORE ZEROES              3L009900
       TRA     RZE                    ELSE TRANSFER TO RZE              3L009910
RZY4   RIR     770000              SET BYTE 3 TO ZERO                   3L009920
       TIX     *+2,1,1             TRANSFER IF MORE ZEROES              3L009930
       TRA     RZE                    ELSE TRANSFER TO RZE              3L009940
RZY5   RIR     007700              SET BYTE 4 TO ZERO                   3L009950
       TIX     *+2,1,1             TRANSFER IF MORE ZEROES              3L009960
       TRA     RZE                    ELSE TRANSFER TO RZE              3L009970
RZY6   RIR     000077              SET BYTE 5 TO ZERO                   3L009980
RZE    STI     0,2                 STORE MODIFIED TARGET WORD           3L009990
       TIX     ZMULT,1,1           TRANSFER IF MORE ZEROES              3L010000
RZY7   AXT     0,4                 RESTORE INDEX 4                      3L010010
       ZET     S244                TEST FOR NORMAL RETURN               3L010020
       TRA     1,4                    NO-TRANSFER 1,4                   3L010030
       TRA     SAVE1               ELSE RETURN TO DRIVER                3L010040
ZMULT  TXI     *+1,2,-1            BUMP TARGET INDEX                    3L010050
       LDI     0,2                 GET NEXT TARGET WORD                 3L010060
RZY8   TNX     RZY+1,1,6           TRANSFER IF LESS THAN 6 ZEROES       3L010070
       STZ     0,2                 ELSE STORE FULL WORD OF ZEROES       3L010080
       TRA     ZMULT               REPEAT ABOVE LOOP                    3L010090
RZTAB  PZE     RZY                 TRANSFER ADDRESS FOR BYTE 0          3L010100
       PZE     RZY2                TRANSFER ADDRESS FOR BYTE 1          3L010110
       PZE     RZY3                TRANSFER ADDRESS FOR BYTE 2          3L010120
       PZE     RZY4                TRANSFER ADDRESS FOR BYTE 3          3L010130
       PZE     RZY5                TRANSFER ADDRESS FOR BYTE 4          3L010140
       PZE     RZY6                TRANSFER ADDRESS FOR BYTE 5          3L010150
S244   PZE     0                   NORMAL RETURN INDICATOR              3L010160
*                                                                       3L010170
*  MOVE CHARACTERS TO ALPHABETIC FIELD WHERE THIS                       3L010180
*  ENTRY IS FOLLOWED BY A WORD CONTAINING 6 CHARACTERS                  3L010190
*  OF THE TYPE TO BE INSERTED.                                          3L010200
*                                                                       3L010210
       ENTRY   .CCHOP                                                   3L010211
.CCHOP STL     OPSW                FOR OVERPUNCH CONDITION              3L010212
       ENTRY   .CCHAN                                                   3L010220
.CCHAN STZ     S245                SET NORMAL RETURN                    3L010230
       SXA     2RB8,4              SAVE INDEX 4                         3L010240
       LAC     BPOINT,2            GET TARGET ADDRESS                   3L010250
       LDI     0,2                 GET FIRST TARGET WORD                3L010260
       CAL     1,4                 GET CHARACTERS TO INSERT             3L010270
       LDC     BPOINT,4            GET BYTE POSITION OF TARGET          3L010280
       XEC     TRATBL,4            GO TO PROPER BYTE SUBR               3L010290
2RB1   RIL     770000              RESET BYTE 0 OF TARGET               3L010300
       TIX     *+4,1,1             TRANSFER IF MORE CHARACTERS          3L010310
       AXT     0,4                 TO RESET BYTES 1-5 OF SOURCE         3L010320
       TRA     2RB7                   AND TRANSFER TO 2RB7              3L010330
2RB2   ANA     RMSK1               RESET BYTE 0 OF SOURCE               3L010340
       RIL     007700              RESET BYTE 1 OF TARGET               3L010350
       TIX     *+4,1,1             TRANSFER IF MORE CHARACTERS          3L010360
       AXT     1,4                 TO RESET BYTES 2-5 OF SOURCE         3L010370
       TRA     2RB7                   AND TRANSFER TO 2RB7              3L010380
2RB3   ANA     RMSK2               RESET BYTES 0-1 OF SOURCE            3L010390
       RIL     000077              RESET BYTE 2 OF TARGET               3L010400
       TIX     *+4,1,1             TRANSFER IF MORE CHARACTERS          3L010410
       AXT     2,4                 TO RESET BYTES 3-5 OF SOURCE         3L010420
       TRA     2RB7                   AND TRANSFER TO 2RB7              3L010430
2RB4   ANA     RMSK3               RESET BYTES 0-2 OF SOURCE            3L010440
       RIR     770000              RESET BYTE 3 OF TARGET               3L010450
       TIX     *+4,1,1             TRANSFER IF MORE CHARACTERS          3L010460
       AXT     3,4                 TO RESET BYTES 4-5 OF SOURCE         3L010470
       TRA     2RB7                   AND TRANSFER TO 2RB7              3L010480
2RB5   ANA     RMSK4               RESET BYTES 0-3 OF SOURCE            3L010490
       RIR     007700              RESET BYTE 4 OF TARGET               3L010500
       TIX     *+4,1,1             TRANSFER IF MORE CHARACTERS          3L010510
       AXT     4,4                 TO RESET BYTE 5 OF SOURCE            3L010520
       TRA     2RB7                   AND TRANSFER TO 2RB7              3L010530
2RB6   ANA     RMSK5               RESET BYTES 0-4 OF SOURCE            3L010540
       RIR     000077              RESET BYTE 6 OF TARGET               3L010550
       TIX     2RB10,1,1           TRANSFER IF MORE CHARACTERS          3L010560
       AXT     5,4                                                      3L010561
       TRA     *+2                 SKIP MASKING                         3L010562
2RB7   ANA     RMSK10,4            RESET APPROPRIATE SOURCE BYTES       3L010563
       NZT     OPSW                                                     3L010564
       TRA     2RB9                IF NO OVERPUNCH                      3L010565
       TNZ     *+2                                                      3L010566
       ORA     12S,4               PLUS ZERO OVERPUNCH = 32             3L010567
       ORA     20S,4               REGULAR OVERPUNCH                    3L010568
       STZ     OPSW                RESET OVERPUNCH SWITCH               3L010569
2RB9   OAI                         OR APPROPRIATE CHARACTERS            3L010570
       STI     0,2                    TO TARGET FIELD                   3L010580
2RB8   AXT     0,4                 RESTORE INDEX 4                      3L010590
       ZET     S245                TEST FOR NORMAL RETURN               3L010600
       TRA     2,4                    NO-TRANSFER 2,4                   3L010610
       TXI     SAVE1,4,-1          RETURN TO SUPERVISOR                 3L010620
2RB10  XEC     2RB8                LOCATE CHARACTER WORD                3L010630
       OAI                         OR APPROPRIATE CHARACTERS            3L010640
       STI     0,2                    TO TARGET FIELD                   3L010650
       CAL     1,4                 GET CHARACTER WORD                   3L010660
2RB11  TXI     *+1,2,-1            BUMP TARGET INDEX                    3L010670
       LDI     0,2                 GET NEXT TARGET WORD                 3L010680
       TNX     2RB1,1,6            TRANSFER IF LESS THAN 6 CHARACTERS   3L010690
       SLW     0,2                 STORE FULL WORD OF CHARACTERS        3L010700
       TRA     2RB11               REPEAT ABOVE LOOP                    3L010710
TRATBL TRA     2RB1                TRANSFER ADDRESS FOR BYTE 0          3L010720
       TRA     2RB2                TRANSFER ADDRESS FOR BYTE 1          3L010730
       TRA     2RB3                TRANSFER ADDRESS FOR BYTE 2          3L010740
       TRA     2RB4                TRANSFER ADDRESS FOR BYTE 3          3L010750
       TRA     2RB5                TRANSFER ADDRESS FOR BYTE 4          3L010760
       TRA     2RB6                TRANSFER ADDRESS FOR BYTE 5          3L010770
S245   PZE     0                   NORMAL RETURN INDICATOR              3L010780
APOINT EQU     SPOINT              SOURCE FIELD LOCATOR                 3L010790
BPOINT EQU     TPOINT              TARGET FIELD LOCATOR                 3L010800
OPSW   PZE     **                  OVERPUNCH SWITCH                     3L010801
       SPACE   1                                                        3L010802
       OCT     000000000012                                             3L010803
       OCT     000000001200                                             3L010804
       OCT     000000120000                                             3L010805
       OCT     000012000000                                             3L010806
       OCT     001200000000                                             3L010807
12S    OCT     120000000000                                             3L010808
       OCT     000000000020                                             3L010809
       OCT     000000002000                                             3L01080A
       OCT     000000200000                                             3L01080B
       OCT     000020000000                                             3L01080C
       OCT     002000000000                                             3L01080D
20S    OCT     200000000000                                             3L01080E
       SPACE   4                                                        3L010810
*                                                                       3L010820
*      TXI     .CRFLS,1,C5+64*C6                                        3L010830
*              C5 IF PLUS C6 IF MINUS                                   3L010840
       ENTRY   .CRFLS                                                   3L010850
.CRFLS SXA     MACCTR,4                                                 3L010860
       LXA     SBYTE,4             CHARS LEFT IN MQ                     3L010870
       SLW     MPTEMP                                                   3L010880
       PXA     0,1                 C5+64*C6                             3L010890
       ZET     MSIGN                                                    3L010900
       ARS     6                   C6                                   3L010910
       ANA     RMSK5               O77                                  3L010920
       SLW     FLTSW                                                    3L010930
       CAL     MPTEMP                                                   3L010940
       LDI     RMSK5                                                    3L010950
       LGL     6                                                        3L010960
       TIF     FZERO               ZERO                                 3L010970
       LGR     6                   NONZERO                              3L010980
       ALS     6                   INSERT CHARACTER                     3L010990
       ORA     FLTSW               X                                    3L011000
       STZ     FLTSW                                                    3L011010
       STL     SIGSW                                                    3L011020
       TRA     MPFL1                                                    3L011030
 FZERO ORA     MPO60               INSERT BLANK                         3L011040
       TIX     *+2,4,1                                                  3L011050
       TXI     NSWRD,4,*           GET NEXT SOURCE WORD                 3L011060
 MPFL1 TIX     NXTMAC,2,1                                               3L011070
       TXI     NTWRD,2,NXTMAC-1    STORE IN TARGET                      3L011080
       SPACE   4                                                        3L011090
*                                                                       3L011100
*      TXI     .CXDRP,1,0                                               3L011110
       ENTRY   .CXDRP                                                   3L011120
.CXDRP LDI     TPOINT                                                   3L011130
       STI     SVPYNT                                                   3L011140
       LDI     MCEBF                                                    3L011150
       STI     TPOINT                                                   3L011160
       STZ     MSIGN                                                    3L011170
       STZ     SIGSW                                                    3L011180
       STZ     SIKSW                                                    3L011190
       TRA     .CXDXD                                                   3L011200
       SPACE   4                                                        3L011210
*                                                                       3L011220
*      TXI     .CIDRP,1,NO.OF.DIGITS.TO.CONVERT                         3L011230
       ENTRY   .CIDRP                                                   3L011240
.CIDRP SXA     MACCTR,4                                                 3L011250
       LDI     TPOINT                                                   3L011260
       STI     SVPYNT                                                   3L011270
       LDI     MCEBF               PZE EDTBUF                           3L011280
       STI     TPOINT                                                   3L011290
       STZ     SIKSW                                                    3L011300
       STZ     SIGSW                                                    3L011310
       STZ     MSIGN                                                    3L011320
       TPL     *+2                                                      3L011330
       STL     MSIGN                                                    3L011340
 IDRP1 STL     RPTRG                                                    3L011350
       TRA     .CIDX1                                                   3L011360
 IDRP2 STZ     RPTRG                                                    3L011370
       LXA     MACCTR,4                                                 3L011380
       LDI     MCEBF               EDTBUF                               3L011390
       STI     SPOINT              TO SOURCE                            3L011400
       LDI     SVPYNT              SAVED TARGET                         3L011410
       STI     TPOINT                                                   3L011420
       TRA     .CXDXD+1                                                 3L011430
       SPACE   4                                                        3L011440
*                                                                       3L011450
*      TXI     .CXDRQ,1,NO.OF.DIGITS.DEVELOPED                          3L011460
       ENTRY   .CXDRQ                                                   3L011470
.CXDRQ STL     RPTRG                                                    3L011480
       TRA     .CXDXQ                                                   3L011490
       STZ     RPTRG                                                    3L011500
       LXA     MACCTR,4                                                 3L011510
       LDI     MCEBF               BEGINNING OF TPOINT                  3L011520
       STI     SPOINT                                                   3L011530
       LDI     SVPYNT                                                   3L011540
       STI     TPOINT                                                   3L011550
       TRA     .CXDXD+1                                                 3L011560
       SPACE   4                                                        3L011570
*                                                                       3L011580
*      TXI     .CRQIT,1,VALUE      WHERE VALUE=0                        3L011590
* UNLESS BLANK WHEN ZERO IS APPLICABLE, IN WHICH                        3L011600
* CASE VALUE IS EQUAL TO THE TARGET FIELDS TOTAL LENGTH                 3L011610
       ENTRY   .CRQIT                                                   3L011620
.CRQIT SXA     MACCTR,4                                                 3L011630
       ZET     SIGSW                                                    3L011640
       TRA     LSTWRD                                                   3L011650
       TXL     LSTWRD,1,0                                               3L011660
       LDI     SVPYNT              REFRESH                              3L011670
       STI     TPOINT              TPOINT                               3L011680
       TRA     .CSPAN                                                   3L011690
       SPACE   4                                                        3L011700
*                                                                       3L011710
*      TXI     .CRSIN,1,C1+64*C2                                        3L011720
* WHERE CHARACTER C1 IS INSERTED IF THE NUMBER                          3L011730
* IS POSITIVE AND C2 IF NEGATIVE.                                       3L011740
       ENTRY   .CRSIN                                                   3L011750
.CRSIN ALS     6                                                        3L011760
       SLW     MPTEMP                                                   3L011770
       PXA     0,1                                                      3L011780
       ZET     MSIGN                                                    3L011790
       ARS     6                   C2 WANTED IF NEGATIVE                3L011800
       ANA     RMSK5               IN CASE C1                           3L011810
       ORA     MPTEMP                                                   3L011820
       TIX     *+2,2,1                                                  3L011830
       TXI     NTWRD,2,*           STORE AND STEP UP COUNT              3L011840
       TXI     NXTMAC+3,4,-1                                            3L011850
*                                                                       3L011860
*      TXI     .CRSIG,1,C3+64*C4                                        3L011870
       ENTRY   .CRSIG                                                   3L011880
.CRSIG ALS     6                                                        3L011890
       SLW     MPTEMP                                                   3L011900
       PXA     0,1                                                      3L011910
       ARS     6                                                        3L011920
       ZET     SIKSW                                                    3L011930
       TRA     *+3                                                      3L011940
       NZT     SIGSW                                                    3L011950
       TRA     SIGC4                                                    3L011960
       CAL     FLTSW                                                    3L011970
       TZE     SIGC3                                                    3L011980
       STZ     FLTSW                                                    3L011990
 SIGC4 ORA     MPTEMP                                                   3L012000
       TIX     *+2,2,1                                                  3L012010
       TXI     NTWRD,2,*           -                                    3L012020
       TXI     NXTMAC+3,4,-1                                            3L012030
 SIGC3 PXA     0,1                                                      3L012040
       ANA     RMSK5                                                    3L012050
       TRA     SIGC4                                                    3L012060
       SPACE   4                                                        3L012070
*                                                                       3L012080
*      TXI     .CR999,1,NUMBER.OF.CONSECUTIVE.NINES                     3L012090
       ENTRY   .CR999                                                   3L012100
.CR999 SXA     MACCTR,4                                                 3L012110
       LXA     SBYTE,4                                                  3L012120
       LDI     RMSK5               OCT 77                               3L012130
       LGL     6                                                        3L012140
       TIF     *+2                                                      3L012150
 C991  STL     SIGSW                                                    3L012160
       TIX     *+2,2,1             ACC  FULL                            3L012170
       TXI     NTWRD,2,*           YES                                  3L012180
       TIX     *+2,4,1             MQ EMPTY                             3L012190
       TXI     NSWRD,4,*           YES                                  3L012200
       TIX     .CR999+3,1,1                                             3L012210
       TRA     NXTMAC                                                   3L012220
       SPACE   4                                                        3L012230
*                                                                       3L012240
*      TXI     .CR000,1,NUMBER.OF.ZEROES.TO.INSERT                      3L012250
       ENTRY   .CR000                                                   3L012260
.CR000 STZ     MPTEMP                                                   3L012270
       TRA     .CRBBB+2                                                 3L012280
*                                                                       3L012290
*      TXI     .CRBBB,1,NUMBER.OF.BLANKS.TO.INSERT                      3L012300
       ENTRY   .CRBBB                                                   3L012310
.CRBBB LDI     MPO60               O60                                  3L012320
       STI     MPTEMP                                                   3L012330
       ALS     6                                                        3L012340
       ORA     MPTEMP                                                   3L012350
       TIX     *+2,2,1                                                  3L012360
       TXI     NTWRD,2,*                                                3L012370
       TIX     .CRBBB+2,1,1                                             3L012380
       TXI     NXTMAC+3,4,-1                                            3L012390
       SPACE   4                                                        3L012400
*                                                                       3L012410
*      TXI     .CRZZZ,1,NO.OF.CONSECUTIVE.FLOATING.BLANKS               3L012420
       ENTRY   .CRZZZ                                                   3L012430
.CRZZZ LDI     MPO60               OCT 60                               3L012440
       TRA     .CRAAA+1                                                 3L012450
*                                                                       3L012460
*      TXI     .CRAAA,1,NO.OF.CONSECUTIVE.FLOATING.*                    3L012470
       ENTRY   .CRAAA                                                   3L012480
.CRAAA LDI     MPAST                                                    3L012490
       STI     MPTEMP                                                   3L012500
       ZET     SIGSW                                                    3L012510
       TRA     .CR999                                                   3L012520
       SXA     MACCTR,4                                                 3L012530
       LXA     SBYTE,4                                                  3L012540
       LDI     RMSK5                                                    3L012550
 CRAA1 LGL     6                                                        3L012560
       TIF     *+2                                                      3L012570
       TRA     C991                NONZERO                              3L012580
       ORA     MPTEMP              INSERT CHARACTER                     3L012590
       TIX     *+2,2,1                                                  3L012600
       TXI     NTWRD,2,*                                                3L012610
       TIX     *+2,4,1                                                  3L012620
       TXI     NSWRD,4,*                                                3L012630
       TIX     CRAA1,1,1                                                3L012640
       TRA     NXTMAC                                                   3L012650
       SPACE   4                                                        3L012660
*                                                                       3L012670
*      TXI     .CRFFQ,1,NO.OF.CONSECUTIVE.FLOATING.SIGN                 3L012680
*              OCCURRENCES WITH NO MORE TO FOLLOW                       3L012690
*              EXAMPLE   +++999                                         3L012700
       ENTRY   .CRFFQ                                                   3L012710
.CRFFQ STZ     SIKSW                                                    3L012720
       TRA     .CRFFC+1                                                 3L012730
*                                                                       3L012740
*      TXI     .CRFFC,1,NO.OF.CONSECUTIVE.FLOATING.SIGN.                3L012750
*              OCCURRENCES.WITH.NO.MORE.TO.FOLLOW.BUT                   3L012760
*              WITH.A.COMMA.BEFORE.THE.NEXT.DIGIT.                      3L012770
*              EXAMPLE   +++,999                                        3L012780
       ENTRY   .CRFFC                                                   3L012790
.CRFFC STL     SIKSW                                                    3L012800
       ZET     SIGSW                                                    3L012810
       TRA     .CR999                                                   3L012820
       SXA     MACCTR,4                                                 3L012830
       LXA     SBYTE,4                                                  3L012840
       TXI     *+1,1,-1            REDUCE COUNT BY 1 SINCE              3L012850
* THE FIRST DIGIT HAS BEEN EXAMINED BY .CRFFF OR                        3L012860
* .CRFLS AND HAS BEEN FOUND TO BE A ZERO.                               3L012870
       TXL     FFCQA,1,0                                                3L012880
       LDI     RMSK5               TO TEST FOR ZERO                     3L012890
 FFCQB LGL     6                                                        3L012900
       TIF     FFCQO                                                    3L012910
       LGR     6                   SHIFT CHARACTER BACK                 3L012920
       ALS     6                                                        3L012930
       ORA     FLTSW                                                    3L012940
       STZ     FLTSW                                                    3L012950
       STL     SIGSW                                                    3L012960
       TIX     *+2,2,1             ACC FULL                             3L012970
       TXI     NTWRD,2,.CR999+2    YES                                  3L012980
       TRA     .CR999+3                                                 3L012990
 FFCQO TIX     *+2,4,1                                                  3L013000
       TXI     NSWRD,4,*                                                3L013010
       ORA     MPO60                                                    3L013020
       TIX     *+2,2,1                                                  3L013030
       TXI     NTWRD,2,*                                                3L013040
       TNX     FFCQA,1,1           12-13                                3L013050
       TRA     FFCQB                                                    3L013060
 FFCQA ALS     6                                                        3L013070
       LDI     MPO60               BLANK                                3L013080
       ZET     SIKSW                                                    3L013090
       TRA     *+3                 .CRFFC                               3L013100
       LDI     FLTSW                                                    3L013110
       STZ     FLTSW                                                    3L013120
       OAI                         SHOULD HAVE                          3L013130
       PIA                         AN OIA INST                          3L013140
       TIX     *+2,2,1             ACC FULL                             3L013150
       TXI     NTWRD,2,NXTMAC-1 OUI                                     3L013160
       TRA     NXTMAC                                                   3L013170
       SPACE   4                                                        3L013180
*                                                                       3L013190
*      TXI     .CRFFF,1,NO.OF.CONSECUTIVE.FLOATING                      3L013200
*              SIGN.OCCURRENCES.WITH.MORE.TO.COME                       3L013210
*      EXAMPLE +++,+++,999                                              3L013220
       ENTRY   .CRFFF                                                   3L013230
.CRFFF ZET     SIGSW                                                    3L013240
       TRA     .CR999                                                   3L013250
       SXA     MACCTR,4                                                 3L013260
       LXA     SBYTE,4                                                  3L013270
       LDI     RMSK5               OCT 77                               3L013280
 RFFA  LGL     6                                                        3L013290
       TIF     RFFB                TRANSFER IF ZERO                     3L013300
       STL     SIGSW               NONZERO                              3L013310
       LGR     6                   SHIFT IT BACK                        3L013320
       ALS     6                                                        3L013330
       TNX     RFFB+2,1,1          LAST DIGIT                           3L013340
       ORA     FLTSW               NO                                   3L013350
       STZ     FLTSW                                                    3L013360
       TIX     *+2,2,1                                                  3L013370
       TXI     NTWRD,2,*                                                3L013380
       TRA     .CR999+3                                                 3L013390
 RFFB  TIX     *+2,4,1             MQ EMPTY                             3L013400
       TXI     NSWRD,4,*           YES                                  3L013410
       ORA     MPO60               INSERT A BLANK                       3L013420
       TIX     *+2,2,1             ACC FULL                             3L013430
       TXI     NTWRD,2,*           YES                                  3L013440
       TIX     RFFA,1,1                                                 3L013450
       TRA     NXTMAC                                                   3L013460
       SPACE   4                                                        3L013470
 MPO60 OCT     60                                                       3L013480
 MCEBF PZE     EDTBUF                                                   3L013490
MPTEMP PZE     **                  TEMPORARY STORAGE AND SWITCH         3L013500
 MPAST BCI     1,00000*                                                 3L013510
 RPTRG PZE     **                                                       3L013520
 FLTSW PZE     **                  THIS WILL CONTAIN C5 OR C6           3L013530
 SIKSW PZE     **                                                       3L013540
*  USED BY REPORT ROUTINES                                              3L013550
 MSIGN PZE     **                  NONZERO IF MINUS                     3L013560
 SIGSW PZE     **                  USED BY REPORT ROUTINES              3L013570
SVPYNT PZE     **                                                       3L013580
* MOVE FROM NON-JUSTIFIED TO JUSTIFIED.                                 3L013590
       ENTRY   .CINID                                                   3L013600
.CINID LXD     APOINT,2            SET IR2=BYTE                         3L013610
       SXD     *+1,1                                                    3L013620
       TXI     *+1,2,**            SET IR2 = BYTE+LENGTH                3L013630
       TXL     NJJ10,2,6                                                3L013640
       TXL     NJJ20,2,12                                               3L013650
       TRA     NJJ30                                                    3L013660
* MOVE FROM JUSTIFIED TO NON-JUSTIFIED                                  3L013670
       ENTRY   .CIDIN                                                   3L013680
.CIDIN LXD     BPOINT,2            SET IR2=BYTE                         3L013690
       SXD     *+1,1                                                    3L013700
       TXI     *+1,2,**            SET IR2 = BYTE + LENGTH              3L013710
       TXL     JNJ40,2,6                                                3L013720
       TXL     JNJ50,2,12                                               3L013730
       TRA     JNJ60                                                    3L013740
NJJ2   PZE     **,**,**                                                 3L013750
NJJ1   PZE     1                                                        3L013760
* 0 LT (BYTE + LENGTH) LT 7. JUSTIFY.                                   3L013770
NJJ10  LDQ*    APOINT              LDQ A                                3L013780
       LXD     APOINT,2            SET IR2 = BYTE                       3L013790
       XEC     RQLTBL,2            RQL 6*BYTE                           3L013800
       XCA                                                              3L013810
       XEC     ARSTBL+6,1          ARS 6*(6-LENGTH)                     3L013820
       TRA     OUT                                                      3L013830
* 6 LT (BYTE+LENGTH) LT 13. JUSTIFY.                                    3L013840
NJJ20  TXL     NJJ25,1,6                                                3L013850
       LDQ*    APOINT                                                   3L013860
       LXD     APOINT,1            SET IR1 = BYTE                       3L013870
       XEC     LGLTBL,1            LGL 6*BYTE                           3L013880
       PXA     0,0                                                      3L013890
       XEC     LLSTBL+6,1          LLS 6*(6-BYTE)                       3L013900
       LAC     APOINT,1                                                 3L013910
       LDQ     1,1                 LDQ A+1                              3L013920
       TQP     *+2                                                      3L013930
       ORA     NJJ1                ORA L(1)                             3L013940
       XEC     LRSTBL+12,2         LRS 6*(12-BYTE-LENGTH)               3L013950
       TRA     OUT                                                      3L013960
NJJ25  LAC     APOINT,2                                                 3L013970
       CAL     0,2                                                      3L013980
       LDQ     1,2                                                      3L013990
       LXD     APOINT,2                                                 3L014000
       XEC     LGRTBL+6,2                                               3L014010
       XCA                                                              3L014020
       XEC     ARSTBL+6,1                                               3L014030
       TRA     OUT                                                      3L014040
* 12 LT (BYTE+LENGTH) LT 19. JUSTIFY.                                   3L014050
NJJ30  SXA     NJJ35,4                                                  3L014060
       LAC     APOINT,4                                                 3L014070
       CAL     0,4                 CAL A                                3L014080
       LDQ     1,4                 LDQ A+1                              3L014090
       LXD     APOINT,2            SET IR2=BYTE                         3L014100
       XEC     LGRTBL+6,2          LGR 6*(6-BYTE)                       3L014110
       STQ     NJJ2                STQ TEMP                             3L014120
       CAL     1,4                 CAL A+1                              3L014130
       LDQ     2,4                 LDQ A+2                              3L014140
       XEC     LGRTBL+6,2          LGR 6*(6-BYTE)                       3L014150
       CLA     NJJ2                CLA TEMP                             3L014160
       ALS     1                                                        3L014170
       TQP     *+2                                                      3L014180
       ORA     NJJ1                ORA L(1)                             3L014190
       XEC     LRSTBL+12,1         LRS 6*(12-LENGTH)                    3L014200
NJJ35  AXT     **,4                                                     3L014210
       TRA     OUT                                                      3L014220
* 0 LT (BYTE+LENGTH) LT 7. PACK NON-JUSTIFIED.                          3L014230
JNJ40  LDQ*    BPOINT              LDQ B                                3L014240
       XEC     RQLTBL,2            RQL 6*(BYTE+LENGTH)                  3L014250
       XEC     LGLTBL+6,1          LGL 6*(6-LENGTH)                     3L014260
       XCA                                                              3L014270
       LXD     BPOINT,2            SET IR2 = BYTE                       3L014280
       XEC     RQLTBL+6,2          RQL 6*(6-BYTE)                       3L014290
       STQ*    BPOINT              STQ B                                3L014300
       TRA     OUT                                                      3L014310
* 6 LT (BYTE+LENGTH) LT 13. PACK NON-JUSTIFIED.                         3L014320
JNJ50  TXL     JNJ55,1,6                                                3L014330
       RQL     1                                                        3L014340
       LGR     1                                                        3L014350
       XEC     LGLTBL+12,2         LGL 6*(12-BYTE-LENGTH)               3L014360
       LXD     BPOINT,1            SET IR1 = BYTE                       3L014370
       XEC     ALSTBL,1            ALS 6*BYTE                           3L014380
       STO     NJJ2                STO TEMP                             3L014390
       SXA     NJJ35,4                                                  3L014400
       LAC     BPOINT,4                                                 3L014410
       CAL     1,4                 CAL B+1                              3L014420
       XEC     LGRTBL+12,2         LGR 6*(12-BYTE-LENGTH)               3L014430
       XEC     RQLTBL+12,2         RQL 6*(12-BYTE-LENGTH)               3L014440
       STQ     1,4                 STQ B+1                              3L014450
       LDQ     NJJ2                LDQ TEMP                             3L014460
       CAL     0,4                 CAL B                                3L014470
       XEC     ARSTBL+6,1          ARS 6*(6-BYTE)                       3L014480
       XEC     LGRTBL,1            LGR 6*BYTE                           3L014490
       STQ     0,4                 STQ B                                3L014500
       TRA     NJJ35                                                    3L014510
JNJ55  XEC     ALSTBL+6,1                                               3L014520
       XCA                                                              3L014530
       CAL*    BPOINT                                                   3L014540
       LXD     BPOINT,1                                                 3L014550
       XEC     ARSTBL+6,1                                               3L014560
       XEC     LGLTBL+6,1                                               3L014570
       LAC     BPOINT,1                                                 3L014580
       SLW     0,1                                                      3L014590
       CAL     1,1                                                      3L014600
       XEC     LGRTBL+12,2                                              3L014610
       XEC     RQLTBL+12,2                                              3L014620
       STQ     1,1                                                      3L014630
       TRA     OUT                                                      3L014640
* 12 LT (BYTE+LENGTH) LT 19. PACK NON-JUSTIFIED.                        3L014650
JNJ60  RQL     1                                                        3L014660
       LGR     1                                                        3L014670
       XEC     LGLTBL+12,1         LGL 6*(12-LENGTH)                    3L014680
       STO     NJJ2                STO TEMP                             3L014690
       LXD     BPOINT,1            SET IR1 = BYTE                       3L014700
       XEC     LGLTBL+6,1          LGL 6*(6-BYTE)                       3L014710
       SXA     NJJ35,4                                                  3L014720
       LAC     BPOINT,4                                                 3L014730
       SLW     1,4                 SLW B+1                              3L014740
       CAL     2,4                 CAL B+2                              3L014750
       XEC     LGRTBL+18,2         LGR 6*(18-BYTE-LENGTH)               3L014760
       XEC     RQLTBL+18,2         RQL 6*(18-BYTE-LENGTH)               3L014770
       STQ     2,4                 STQ B+2                              3L014780
       LDQ     NJJ2                LDQ TEMP                             3L014790
       CAL     0,4                 CAL B                                3L014800
       XEC     ARSTBL+6,1          ARS 6*(6-BYTE)                       3L014810
       XEC     LGRTBL,1            LGR 6*BYTE                           3L014820
       STQ     0,4                 STQ B                                3L014830
       TRA     NJJ35                                                    3L014840
LLSTBL LLS     0                                                        3L014850
       LLS     6                                                        3L014860
       LLS     12                                                       3L014870
       LLS     18                                                       3L014880
       LLS     24                                                       3L014890
       LLS     30                                                       3L014900
       LLS     36                                                       3L014910
LRSTBL LRS     0                                                        3L014920
       LRS     6                                                        3L014930
       LRS     12                                                       3L014940
       LRS     18                                                       3L014950
       LRS     24                                                       3L014960
       LRS     30                                                       3L014970
       LRS     36                                                       3L014980
ARSTBL AXT     0,0                                                      3L014990
       ARS     6                                                        3L015000
       ARS     12                                                       3L015010
       ARS     18                                                       3L015020
       ARS     24                                                       3L015030
       ARS     30                                                       3L015040
       CLM                                                              3L015050
 OUT   EQU     SAVE1                                                    3L015060
       END                                                              3L015070
$IBMAP CBLER   ADDREL                                                   3L100000
       LBL     BLER,BEGIN     CBLER                                  (7)3L100010
*              CALLING SEQUENCE                                         3L100020
*      LAC     BL)NN,IR                                                 3L100030
*      TXL     .CBLER,IR,0                                              3L100040
*              ROUTINE PRINTS ON SYSTEM OUTPUT UNIT MESSAGE DESIGNATING 3L100050
*              THAT A DATA ITEM IS REFERENCED BEFORE IT IS LOCATED      3L100060
       ENTRY   .CBLER                                                   3L100070
.CBLER TSX     .CDPLY,4                                                 3L100080
       PZE     C06MS1,,8                                                3L100090
       STR                                                              3L100100
*                                                                       3L100110
C06MS1 BCI     9,PROCESSING TERMINATED - DATA ITEM REFERENCED BEFORE IT 3L100120
       BCI     3,EM IS LOCATED.                                         3L100130
       END                                                              3L100140
$IBMAP COPEN   ADDREL                                                   3L200000
       LBL     OPEN,BEGIN     COPEN                                  (7)3L200010
       ENTRY   .CIOHS                                                   3L200020
.CIOHS PZE     **,,**              DECREMENT CONTAINS I/O CARD NUMBER   3L200030
       EJECT                                                            3L200040
*   THIS SUBROUTINE OPENS AN IOCS FILE.                                 3L200050
       SPACE   1                                                        3L200060
*   CALLING SEQUENCE                                                    3L200070
       SPACE   1                                                        3L200080
*      TSX     .COPEN,4                                                 3L200090
*      ROP     FILE,,ANYTHING                                           3L200100
*   WHERE ROP IS                                                        3L200110
*      PZE =   REWIND                                                   3L200120
*      MZE =   NO REWIND                                                3L200130
*      MON =   NO REWIND, NO LABEL ACTION                               3L200140
*   NOTE THE DECREMENT OF 1,4 MAY BE NON ZERO.                          3L200150
       SPACE   2                                                        3L200160
       ENTRY   .COPEN                                                   3L200170
.COPEN SXA     CIO1,4              SAVE XRS                             3L200180
       SXA     CIO2,1                                                   3L200190
       STI     CIO3                AND SI                               3L200200
       CAL     1,4                 GET CALL SEQUENCE WORD               3L200210
       LDI*    1,4                 GET FIRST WORD OF FILE BLOCK         3L200220
       RFT     77777               AND SEE IF A UNIT IS ATTACHED        3L200230
       TRA     CIO4                YES, GO OPEN FILE                    3L200240
       AXT     CIO6,4              NO, SET TO PRINT MESSAGE             3L200250
CIO5   SXA     CIO7,4              SAVE MESSAGE PARAMETER               3L200260
       PAX     0,4                 L(FILE BLOCK) TO XR4                 3L200270
       TXI     *+1,4,9             BUMP TO GET L(FILE NAME)             3L200280
       SXA     CIO9,4              SAVE IN MESSAGE PARAMETER            3L200290
       CLA     .CIOHS              CONVERT CARD NUMBER                  3L200300
       TSX     .DECVD,4            NUMBER TO BCD                        3L200310
       STQ     CIO12               AND SAVE                             3L200320
       TSX     .MWR,4                                                   3L200330
       PZE     5                                                        3L200340
       MZE     CIO8,,4             NO UNIT IS ASSIGNED TO               3L200350
CIO9   PZE     **,,3               'FILE NAME'                          3L200360
CIO7   MZE     **,,2               OPENING OR CLOSING                   3L200370
       MZE     CIO11,,7            OF FILE IS NOT PERFORMED AT CARD NUMB3L200380
       PZE     CIO12,,1+512*4      'CARD NUMBER'                        3L200390
CIO1   AXT     **,4                RELOAD XRS                           3L200400
CIO2   AXT     **,1                                                     3L200410
       LDI     CIO3                AND SI                               3L200420
       TRA     2,4                 AND EXIT                             3L200430
       SPACE   1                                                        3L200440
CIO4   TSX     CIOSYS,4            GO SEE IF UNIT IS OU, PP, OR IN.     3L200450
       SLW     *+2                 SAVE FILE NAME AND REWIND OPTION     3L200460
       TSX     .OPEN,4             GO OPEN FILE                         3L200470
       PZE     **                  WITH CORRECT REWIND OPTION           3L200480
       TRA     CIO1                GO EXIT                              3L200490
       SPACE   2                                                        3L200500
CIOSYS ANA     CIO13               MASK OUT DECREMENT AND TAG           3L200510
       PAC     0,1                 -L(FILE BLOCK) TO XR1                3L200520
       LDI     2,1                 GET 3RD WORD OF FILE BLOCK           3L200530
       LNT     200000              IS THIS SYSTEM UNIT                  3L200540
       TRA     1,4                 NO                                   3L200550
       ANA     CIO14               YES, MAKE SURE REWIND                3L200560
       ORA     CIO15                OPTION IS MON ON SYSTEM UNITS       3L200570
       TRA     1,4                                                      3L200580
       EJECT                                                            3L200590
*   THIS SUBROUTINE CLOSES AN IOCS FILE                                 3L200600
       SPACE   1                                                        3L200610
*   CALLING SEQUENCE                                                    3L200620
       SPACE   1                                                        3L200630
*      TSX     .CCLOSE,4                                                3L200640
*      ROP     FILE,,OPT                                                3L200650
*   WHERE ROP IS                                                        3L200660
*      PZE =   REWIND AND UNLOAD                                        3L200670
*      PTW =   REWIND                                                   3L200680
*      MZE =   NO REWIND                                                3L200690
*      MON =   NO REWIND, NO EOF MARK OR TRAILERS WRITTEN               3L200700
*   AND OPT IS                                                          3L200710
*      BIT 17 = 1 IF OPTIONAL FILE AND 0 IF NOT OPTIONAL.               3L200720
*      BIT 16 = 1 IF CLOSE REEL AND 0 IF NOT CLOSE REEL.                3L200730
       SPACE   1                                                        3L200740
*   NOTE THAT AN ATTEMPT TO CLOSE A REEL OF A SYSTEM UNIT RESULTS IN    3L200750
*   CLOSING WITH A MON CODE AND NO REOPENING OF THE FILE.               3L200760
       SPACE   1                                                        3L200770
       ENTRY   .CCLOS                                                   3L200780
.CCLOS SXA     CIO1,4              SAVE XRS                             3L200790
       SXA     CIO2,1                                                   3L200800
       STI     CIO3                AND SI                               3L200810
       CAL     1,4                 GET CALL SEQUENCE WORD               3L200820
       LDI*    1,4                 GET FIRST WORD OF FILE BLOCK         3L200830
       RFT     77777               AND SEE IF UNIT IS ATTACHED          3L200840
       TRA     *+3                 YES,                                 3L200850
       AXT     CIO10,4             NO, SET ERROR MESSAGE PARAMETER      3L200860
       TRA     CIO5                GO PRINT MESSAGE                     3L200870
       LDI     1,4                                                      3L200880
       LFT     000002              IS CLOSE REEL REQUESTED              3L200890
       TRA     CIO16               YES, GO                              3L200900
CIO26  TSX     CIOSYS,4            NO GO SEE IF UNIT IS OU, IN, OR PP   3L200910
       SLW     *+2                 SAVE FILE NAME AND REWIND OPTION     3L200920
       TSX     .CLOSE,4            GO CLOSE FILE                        3L200930
       PZE     **                  WITH CORRECT REWIND OPTION           3L200940
       TRA     CIO1                GO EXIT                              3L200950
       SPACE   2                                                        3L200960
CIO16  PAC     0,1                 CHECK FOR CLOSE REEL                 3L200970
       LDI     2,1                 OF SYSTEM UNIT                       3L200980
       LFT     200000                                                   3L200990
       TRA     CIO26               IF SYSTEM UNIT, USE STANDARD CLOSE   3L201000
       LDI     1,4                 PUT .CCLOS CALL SEQUENCE WORD IN SI  3L201010
       STA     CIO17               SAVE FILE LOCATION FOR               3L201020
       STA     CIO18                REOPEN                              3L201030
       STA     CIO19                REEL SWITCH                         3L201040
       STA     *+2                  TEMPORARY CLOSE                     3L201050
       TSX     .CLOSE,4            GO CLOSE TEMPORARILY                 3L201060
       MON     **                   WITH NO LABEL ACTION                3L201070
       TSX     .OPEN,4             REOPEN THE FILE (NEXT REEL)          3L201080
CIO18  MON     **                   WITH NO LABEL ACTION                3L201090
CIO17  AXC     **,4                GET SECOND WORD                      3L201100
       LDI     1,4                  OF FILE BLOCK                       3L201110
       RIL     000004              RESET EOT BIT INDICATING             3L201120
       STI     1,4                  REEL SWITCH IS NECESSARY            3L201130
       TSX     .WRITE,4            PERFORM DUMMY WRITE                  3L201140
CIO19  PZE     **,,0                SO IOCS WILL SWITCH UNITS           3L201150
       IOCD    0,,0                 AND PERFORM LABEL OPERATIONS        3L201160
       TRA     CIO1                GO EXIT                              3L201170
       SPACE   1                                                        3L201180
CIO3   PZE     **                  SI SAVED HERE                        3L201190
CIO6   BCI     2,OPENING                                                3L201200
CIO8   BCI     4,NO UNIT IS ASSIGNED TO                                 3L201210
CIO10  BCI     2,CLOSING                                                3L201220
CIO11  BCI     7,OF FILE IS NOT PERFORMED AT CARD NUMBER                3L201230
CIO12  BCI     1,******            SOURCE                               3L201240
CIO13  OCT     700000077777                                             3L201250
CIO14  OCT     000000077777                                             3L201260
CIO15  OCT     500000000000                                             3L201270
       END                                                              3L201280
$IBMAP CEOBP   ADDREL                                                   3L300000
       LBL     EOBP,BEGIN     CEOBP                                  (7)3L300010
       TTL     CEOBP-COBOL .READ AND .WRITE ERROR RETURN            (12)3L300015
* .CEOBP AND .CERRP OBJECT TIME SUBROUTINE                              3L300020
       SPACE   2                                                        3L300030
*  CONTROL IS TRANSFERRED TO ONE OF THESE ROUTINES WHEN ONE OF THE      3L300040
*  FOLLOWING CONDITIONS IS FOUND IN CONNECTION WITH .READ OR .WRITE     3L300050
*  CHECK SUM ERROR                                                      3L300060
*  SEQUENCE ERROR                                                       3L300070
*  UNRECOVERABLE REDUNDANCY                                             3L300080
*  ALL AVAILABLE BUFFERS IN USE                                         3L300090
*  END OF BUFFER WHILE EXECUTING AN IOCYN                               3L300100
       SPACE   2                                                        3L300110
*   MESSAGES APPEAR OFF-LINE.  EXIT VIA '.LXRTN'.                       3L300120
       SPACE   2                                                        3L300130
*   CONSTANTS                                                           3L300140
       SPACE   2                                                        3L300150
ERRP01 BCI     9,PROCESSING TERMINATED DUE TO TAPE CHECK SUM AND REDUND 3L300160
       BCI     3,ANCY ERRORS.                                           3L300170
ERRP02 BCI     9,PROCESSING TERMINATED DUE TO TAPE SEQUENCE AND REDUNDA 3L300180
       BCI     3,NCY ERRORS.                                            3L300190
ERRP03 BCI     9,PROCESSING TERMINATED DUE TO UNRECOVERABLE TAPE REDUND 3L300200
       BCI     3,ANCY ERRORS.                                           3L300210
ERRP04 BCI     9,PROCESSING TERMINATED DUE TO TAPE CHECK SUM ERROR.     3L300220
       BCI     3,                                                       3L300230
ERRP05 BCI     8,PROCESSING TERMINATED DUE TO BLOCK SEQUENCE ERRO   (12)3L300240
       BCI     4,R.                                                 (12)3L300250
ERRP06 BCI     9,PROCESSING TERMINATED DUE TO TAPE RECORD LENGTH ERROR. 3L300260
       BCI     3,                                                       3L300270
ERRP07 BCI     9,THIS ERROR IS ASSOCIATED WITH AN I/O VERB AT CARD NUMB 3L300280
       BCI     1,ER....                                                 3L300290
       BCI     1,******                                                 3L300300
       BCI     1,.                                                      3L300310
ERRP08 BCI     9,THE FOLLOWING INFORMATION IS ASSOCIATED WITH THE FILE  3L300320
       BCI     3,IN ERROR.....                                          3L300330
ERRP09 BCI     2,FILE NAME...                                           3L300340
       BCI     1,******                                                 3L300350
       BCI     1,******                                                 3L300360
       BCI     1,******                                                 3L300370
       BCI     5,      REEL SEQUENCE NUMBER....                         3L300380
       BCI     1,******                                                 3L300390
       BCI     1,.                                                      3L300400
ERRP10 BCI     4,FILE SERIAL NUMBER......                               3L300410
       BCI     1,******                                                 3L300420
       BCI     5,      FILE BLOCK COUNT........                         3L300430
       BCI     1,******                                                 3L300440
       BCI     1,.                                                      3L300450
ERRP11 PZE     ERRP01,,8                                                3L300460
       PZE     ERRP02,,8                                                3L300470
       PZE     ERRP03,,8                                                3L300480
       PZE     ERRP04,,8                                                3L300490
       PZE     ERRP05,,8                                                3L300500
       PZE     ERRP06,,8                                                3L300510
ERRP12 OCT     1                                                        3L300511
ERRP13 PZE     **            TEMPORARY STORAGE FOR AC                   3L300512
ERRP14 PZE     **            AND MQ                                     3L300513
ERRP15 TSX     .WRITE,4                                                 3L300514
       ENTRY   .CEOBP                                                   3L300515
.CEOBP STO     ERRP13                                                   3L300516
       STQ     ERRP14                                                   3L300517
       SXA     ERRP17-3,2    SAVE XR2                                   3L300518
       SXA     ERRP17-2,4    AND XR4 IN CASE RETRY SUCCESSFUL           3L300519
       ARS     18                                                       3L300520
       COM                   GET L(COMMAND BEING EXECUTED               3L300521
       STA     ERRP16+2        WHEN EOB ENCOUNTERED)                    3L300522
       XCL                                                              3L300523
       PDX     0,2           -(LOC OF TSX TO IOCS ROUTINE)              3L300524
       COM                   CALCULATE NORMAL RETURN                    3L300525
       ADD     ERRP12        FROM IOCS ROUTINE                          3L300526
       STA     ERRP17-1                                                 3L300527
       CLA     1,2           L(FILE BLOCK)                              3L300528
       STA     ERRP16+1                                                 3L300530
       CLA     0,2                                                      3L300531
       SUB     ERRP15        WAS TSX TO .READ OR .WRITE                 3L300532
       TNZ     ERRP17        TRA IF NOT WRITE                           3L300533
ERRP16 TSX     .WRITE,4                                                 3L300536
       PZE     **,,ERRP17    RETURN TO ERRP17 IF EOB CONDITION          3L300537
       TCH     **            STILL EXISTS                               3L300538
       AXT     **,2                                                     3L300539
       AXT     **,4                                                     3L300540
       TRA     **            NORMAL RETURN IF RETRY WORKS               3L300541
ERRP17 CAL     ERRP14                                                   3L300542
       LDQ     ERRP13                                                   3L300543
       AXT     0,1                                                      3L300550
       TRA     ERRP18                                                   3L300560
       ENTRY   .CERRP                                                   3L300570
.CERRP XCL                                                              3L300580
       PDX     0,2                 -LOC OF TSX TO XR2                   3L300590
       ARS     15                                                       3L300600
       PDX     0,1                 ERROR CODE TO XRT                    3L300610
ERRP18 TXL     *+2,1,3                                                  3L300620
       TXI     *+1,1,-1                                                 3L300630
       CLA     .CIOHS              GET CARD NO.                         3L300640
       TSX     .DECVD,4            CONVERT                              3L300650
       STQ     ERRP07+10           SAVE FOR MESSAGE                     3L300660
       CAL     1,2                 GET FILE BLOCK LOCATION              3L300670
       PAC     0,2                 -LOC                                 3L300680
       CAL     6,2                 FILE SERIAL NUMBER                   3L300690
       SLW     ERRP10+4                                                 3L300700
       CAL     .RLHLD                                               (12)3L300710
       SLW     ERRP09+10                                                3L300720
       CAL     9,2                 FILE NAME -- 18 CHARACTERS           3L300730
       SLW     ERRP09+2                                                 3L300740
       CAL     10,2                                                     3L300750
       SLW     ERRP09+3                                                 3L300760
       CAL     11,2                                                     3L300770
       SLW     ERRP09+4                                                 3L300780
       CAL     3,2                                                      3L300790
       TSX     .DECVD,4                                                 3L300800
       STQ     ERRP10+10                                                3L300810
       CAL     ERRP11+5,1                                               3L300820
       SLW     *+2                                                      3L300830
       TSX     .CDPLY,4                                                 3L300840
       PZE     **                                                       3L300850
       TSX     .CDPLY,4                                                 3L300860
       PZE     ERRP07,,8                                                3L300870
       TSX     .CDPLY,4                                                 3L300880
       PZE     ERRP08,,8                                                3L300890
       TSX     .CDPLY,4                                                 3L300900
       PZE     ERRP09,,8                                                3L300910
       TSX     .CDPLY,4                                                 3L300920
       PZE     ERRP10,,8                                                3L300930
       TRA     .LXERR                                                $5$3L300940
       END                                                              3L300950
$IBMAP CDPLY   ADDREL                                                   3L400000
       LBL     DPLY,BEGIN     CDPLY                                  (7)3L400010
* .CDPLY LIBRARY ROUTINE                                                3L400020
*  CALLING SEQUENCE...                                                  3L400030
*      TSX     .CDPLY,4                                                 3L400040
*      PZE     LOCATION,,DEVICE                                         3L400050
*      (RETURN)                                                         3L400060
* WHERE LOCATION IS THE FIRST WORD OF A TWELVE                          3L400070
*   WORD BCD IMAGE AND                                                  3L400080
* DEVICE HAS ONE OF THE FOLLOWING BIT CONFIGURATIONS-                   3L400090
*        BIT 15 = 0, DISPLAY ON PRINTER (USING 'MESSAGE-WRITER')        3L400100
*        BIT14=1   DISPLAY ON SYSTEM OUTPUT UNIT                        3L400110
*.CDPLY LEAVES XRS AND INDICATORS INTACT                                3L400140
       ENTRY   .CDPLY                                                   3L400150
.CDPLY SXA     CDPL01,4                                                 3L400160
       CAL     1,4                 PARAMETER                            3L400170
       STA     CDPL02               LOCATION                            3L400180
       STA     CDPL04               DEVICE                              3L400190
       PDX     0,4                  SYSOU1 TEST                         3L400200
       TXH     CDPL03,4,4          NO, ON LINE PRINT                    3L400210
       TSX     .MWR,4                                                   3L400220
       PZE     1                                                        3L400230
CDPL02 PZE     **,,12              LOCATION                             3L400240
       TRA     CDPL01                                                   3L400250
CDPL03 TSX     .CCDTY,4           CHECK SYSTEM ASSIGNMENT               3L400260
       PZE     DSPOU                                                    3L400270
       TRA     CDPL02-2           CARD                                  3L400280
       TSX     .OPEN,4            TAPE                                  3L400290
       MON     DSPOU                                                    3L400300
       STL     CDPL03             ONE-TIME                              3L400310
CTR    AXT     **,4                                                     3L400320
       LDQ     DPL1                                                     3L400330
       TXH     *+2,4,0                                                  3L400331
       LDQ     DPL2                                                     3L400332
       STQ     CRCNT              SET CARRIAGE CONTROL CHAR             3L400333
       TXI     *+1,4,1                                                  3L400340
       TXL     *+2,4,56            LINE CNTR. GOES TO 57                3L400350
       AXT     0,4                                                      3L400360
       SXA     CTR,4                                                    3L400370
       TSX     .WRITE,4            WRITE MESSAGE                        3L400380
       PZE     DSPOU,,.CEOBP                                            3L400390
       IOCP    CRCNT,,1                                                 3L400400
CDPL04 IOCD    **,,12                                                   3L400410
CDPL01 AXT     **,4                RESTORE XF4                          3L400420
       TRA     2,4                   AND EXIT                           3L400430
DSPOU  FILE    ,OU1,BLK=13,MIN=13,OUTPUT,NOLIST                         3L400440
CRCNT  PZE                        CARRIAGE CONTROL WORD                 3L400480
DPL1   OCT     606060606060                                             3L400490
DPL2   OCT     016060606060                                             3L400500
       END                                                              3L400510
$IBMAP CCOMP   ADDREL                                                   3L500000
       LBL     COMP,BEGIN     CCOMP                                  (7)3L500010
*              NOTE     CALLING SEQUENCE                                3L500020
*                                                                       3L500030
*              NOTE     TSX   SYSCOM,4                                  3L500040
*              NOTE     OP    SYSCOL,,6                                 3L500050
*              NOTE     PZE   A1,T,L(LOC1)                              3L500060
*              NOTE     PZE   LENGTH1,,6*BYTE1                          3L500070
*              NOTE     PZE   A2,T,L(LOC2)                              3L500080
*              NOTE     PZE   LENGTH2,,6*BYTE2                          3L500090
*              NOTE     HIGH RETURN                                     3L500100
*              NOTE     EQUAL RETURN                                    3L500110
*              NOTE     LOW RETURN                                      3L500120
*                                                                       3L500130
*              NOTE     WHRER  OP=CVR OR NOP ACCORDING TO WHETHER       3L500140
*              NOTE      COLLATING SEQUENCE ADJUSTMENT IS NEEDED        3L500150
*              NOTE      OR NOT.                                        3L500160
*                                                                       3L500170
*              NOTE     AJ IS THE BASE OF OPERAND J, L(LOCJ) IS THE     3L500180
*              NOTE      LOCATION OF ITS LOCATOR (=0 IF NO LOCATOR),    3L500190
*              NOTE      T IS NON-ZERO IF THE LOCATOR IS COMPLEX.       3L500200
*                                                                       3L500210
*              NOTE     LENGTHJ IS THE LENGTH OF OPERAND J IN           3L500220
*              NOTE      CHARACTERS, AND BYTEJ IS THE NOMINAL BYTE.     3L500230
*                                                                       3L500240
       ENTRY   .CCOMP                                                   3L500250
.CCOMP SXA     COMEX,4             SAVE INDEX                           3L500260
       SXA     COMEX+1,2             REGISTERS                          3L500270
       SXA     COMEX+2,1                                                3L500280
       CLA     1,4                                                      3L500290
       STO     CNVSN               COLLATING SEQUENCE CONVERSION        3L500300
       AXT     0,2                                                      3L500310
COMST  CLA     2,4                                                      3L500320
       STA     LOCTR,2             BASE ADDRESS                         3L500330
       STT     TAG                 COMPLEX INDICATOR                    3L500340
       PDC     0,1                 LOCATION OF LOCATOR                  3L500350
       CLA     3,4                                                      3L500360
       STA     LNGTH,2             LENGTH                               3L500370
       STZ     TEMP                                                     3L500380
       STD     TEMP                NOMINAL BYTE                         3L500390
       TXL     COMB,1,0            BYPASS IF NO LOCATOR                 3L500400
       NZT     0,1                 12-13                                3L500410
       TRA     .CBLER              12-13                                3L500420
       NZT     TAG                                                      3L500430
       TRA     COMA                                                     3L500440
       LDQ     0,1                 IF COMPLEX LOCATOR,                  3L500450
       MPY     L.6                   ADJUST BYTE                        3L500460
       XCA                           AND CORRECT BASE                   3L500470
       ACL     TEMP                  FOR POSSIBLE                       3L500480
       ANA     MSKDC                 OVERFLOW TO NEXT WORD.             3L500490
       LRS     35                                                       3L500500
       DVP     36B18                                                    3L500510
       STD     TEMP                                                     3L500520
       XCA                                                              3L500530
       ACL     LOCTR,2                                                  3L500540
       STA     LOCTR,2                                                  3L500550
COMA   CLA     0,1                                                      3L500560
       PAC     0,1                                                      3L500570
COMB   PXA     0,1                                                      3L500580
       STA     LOADS,2             BASE LOCATOR VALUE                   3L500590
       LXD     TEMP,1                                                   3L500600
       PXA     0,1                 SET UP SHIFT COMMAND                 3L500610
       STA     SHIFT,2               FROM OPERAND BYTE                  3L500620
       TXI     *+1,4,-2                                                 3L500630
       TXI     *+1,2,-1                                                 3L500640
       TXH     COMST,2,-2          BACK FOR SECOND OPERAND              3L500650
       STZ     DIFF                SET FOR EQUAL                        3L500660
       CLA     LNGTH                                                    3L500670
       SUB     LNGTH+1                                                  3L500680
       TNZ     OUT1                                                     3L500690
 IN1   LDQ     LNGTH                                              1127623L500700
       TMI     *+2                                                1127623L500710
       LDQ     LNGTH+1                                            1127623L500720
       PXD     0,0                                                      3L500730
       DVP     L.6                                                      3L500740
       XCA                                                              3L500750
       PAX     0,4                 NUMBER OF WHOLE WORDS                3L500760
       MPY     L.6                                                      3L500770
       PXA     0,0                                                      3L500780
       XCA                         FROM REMAINDER, COMPUTE              3L500790
       PAC     0,2                 VALUE OF TRAILER MASK                3L500800
       CAL     SEVENS                AND STORE FOR                      3L500810
       LGR     0,2                   LAST WORD                          3L500820
       STQ     MASK                                                     3L500830
LOADS  AXT     0,1                 PICK UP LOCATOR VALUES               3L500840
       AXT     0,2                    FOR OPERANDS                      3L500850
       TXL     COMD,4,0            SPECIAL IF LESS THAN ONE WORD        3L500860
COMC   CAL*    LOCTR+1                                                  3L500870
       TXI     *+1,2,-1            CURRENT WORD OF SECOND               3L500880
       LDQ*    LOCTR+1               OPERAND TO AC-MQ                   3L500890
       XEC     SHIFT+1                                                  3L500900
       ANA     SEVENS                                                   3L500910
CNVSN  NOP     0                                                        3L500920
       SLW     TEMP                                                     3L500930
       CAL*    LOCTR               CURRENT WORD OF FIRST                3L500940
       TXI     *+1,1,-1              OPERAND TO AC-MQ                   3L500950
       LDQ*    LOCTR                                                    3L500960
       XEC     SHIFT                                                    3L500970
       ANA     SEVENS                                                   3L500980
       XEC     CNVSN                                                    3L500990
       LAS     TEMP                COMPARE WORDS                        3L501000
       TRA     COMEX               EXIT IF HIGH                         3L501010
       TRA     *+2                 CONTINUE IF EQUAL                    3L501020
       TRA     COMEX               EXIT IF LOW                          3L501030
       TIX     COMC,4,1                                                 3L501040
COMD   CAL*    LOCTR+1             LAST CHARACTERS                      3L501050
       TXI     *+1,2,-1              OF SECOND                          3L501060
       LDQ*    LOCTR+1               OPERAND                            3L501070
       XEC     SHIFT+1                                                  3L501080
       ANA     MASK                                                     3L501090
       XEC     CNVSN                                                    3L501100
       SLW     TEMP                                                     3L501110
       CAL*    LOCTR               LAST CHARACTERS OF                   3L501120
       TXI     *+1,1,-1              FIRST OPERAND                      3L501130
       LDQ*    LOCTR                                                    3L501140
       XEC     SHIFT                                                    3L501150
       ANA     MASK                                                     3L501160
       XEC     CNVSN                                                    3L501170
COMEX  AXT     0,4                                                      3L501180
       AXT     0,2                                                      3L501190
       AXT     0,1                                                      3L501200
       LAS     TEMP                FINAL COMPARISON                     3L501210
       TRA     6,4                 EXIT HIGH                            3L501220
       TRA     OUT2                EQUAL                          1127623L501230
       TRA     8,4                      LOW                             3L501240
LOCTR  PZE     0,1                 INDIRECT OPERAND                     3L501250
       PZE     0,2                    REFERENCES                        3L501260
LNGTH  PZE     0                   TEMPORARY STORAGE FOR LENGTH         3L501270
       PZE     0                                                        3L501280
TAG    PZE     0                   COMPLEX INDICATOR                    3L501290
TEMP   PZE     0                   TEMPORARY                            3L501300
SHIFT  LGL     0                   SHIFT INSTRUCTIONS                   3L501310
       LGL     0                      FOR OPERANDS                      3L501320
MASK   PZE     0                   TRAILER MASK STORAGE                 3L501330
L.6    OCT     6                   CONSTANTS                            3L501340
36B18  OCT     44000000                                                 3L501350
SEVENS OCT     777777777777                                             3L501360
MSKDC  OCT     077777000000                                             3L501370
 OUT1  STA     DIFF                DIFFERENCE IN CHARACTERS             3L501380
       AXT     0,4                 INDICATE A IS LARGER                 3L501390
       TPL     *+2                                                      3L501400
       AXT     -1,4                INDICATE A+1 IS LARGER               3L501410
       SXA     AXT2,4                                                   3L501420
       TRA     IN1                                                      3L501430
       TRA     OUT2                                                     3L501440
 OUT2  NZT     DIFF                                                     3L501450
       TRA     7,4                                                      3L501460
 AXT2  AXT     **,4                                                     3L501470
       CLA     LOADS,4             INITIALIZE XR1 FOR CHECK ON          3L501471
       STA     COMC1-2             EXTRA CHARACTERS OF LONGER ITEM      3L501472
       LDQ     LNGTH+1                                                  3L501480
       PXD     0,0                                                      3L501490
       TXL     *+2,4,0                                                  3L501500
       LDQ     LNGTH               COMPUTE WORDS                        3L501510
       DVP     L.6                 AND                                  3L501520
       RQL     18                  BYTES                                3L501530
       LGL     18                  OF SMALLER                           3L501540
       SLW     TEMP                                                     3L501550
       CAL     SHIFT,4                                                  3L501560
       ANA     MONE                                                     3L501570
       LGR     36                                                       3L501580
       DVP     L.6                                                      3L501590
       LGL     36+18                                                    3L501600
       ACL     LOCTR,4             START OF LONGER                      3L501610
       ANA     MSKTG                                                    3L501620
       ACL     TEMP                                                     3L501630
       PDX     0,1                                                      3L501640
       TXL     *+2,1,5                                                  3L501650
       ACL     LM617               -6 BASE 17                           3L501660
       STA     START                                                    3L501670
       XCA                                                              3L501680
       MPY     L.6                                                      3L501690
       XCA                                                              3L501700
       PDX     0,1                                                      3L501710
       SXA     LGL1,1                                                   3L501720
       PXD     0,0                                                      3L501730
       LDQ     DIFF                                                     3L501740
       STZ     DIFF                                                     3L501750
       STZ     TEMP                                                     3L501760
       DVP     L.6                                                      3L501770
       XCA                                                              3L501780
       PAX     0,2                 NUMBER OF WHOLE WORDS                3L501790
       MPY     L.6                 REMAINDER TIMES 6                    3L501800
       PXD     0,0                                                      3L501810
       XCA                                                              3L501820
       PAC     0,1                                                      3L501830
       CAL     SEVENS                                                   3L501840
       LGR     0,1                                                      3L501850
       STQ     MASK                                                     3L501860
       AXT     0,1                                                      3L501870
       TXL     COMD1,2,0                                                3L501880
 COMC1 CAL*    START                                                    3L501890
       TXI     *+1,1,-1                                                 3L501900
       LDQ*    START                                                    3L501910
 LGL1  LGL     **                                                       3L501920
       ANA     SVTNS                                                    3L501930
       TNZ     COM11                                                    3L501940
       TIX     COMC1,2,1                                                3L501950
 COMD1 CAL*    START                                                    3L501960
       TXI     *+1,1,-1                                                 3L501970
       LDQ*    START                                                    3L501980
       XEC     LGL1                                                     3L501990
       ANA     SVTNS                                                    3L502000
       ANA     MASK                                                     3L502010
       TZE     COMEX                                                    3L502020
 COM11 TXL     COMEX,4,0                                                3L502030
       STL     TEMP                                                     3L502040
       PXD     0,0                                                      3L502050
       TRA     COMEX                                                    3L502060
 SVTNS OCT     171717171717                                             3L502070
 MSKTG TXL     -1,0,-1                                                  3L502080
 DIFF  PZE     **                                                       3L502090
 LM617 TXL     0,,-6                                                    3L502100
 START PZE     **,1                                                     3L502110
 MONE  PZE     -1                                                       3L502120
       END                                                              3L502130
$IBMAP CARS1   ADDREL                                                   3L600000
       LBL     ARS1,BEGIN     CARS1                                  (7)3L600010
*              NOTE     MULTIPLY SUBROUTINES.                           3L600020
       ENTRY   .CARS1                                                   3L600030
.CARS1 PZE     **                                                       3L600040
       END                                                              3L600050
$IBMAP CARS2   ADDREL                                                   3L700000
       LBL     ARS2,BEGIN     CARS2                                  (7)3L700010
       ENTRY   .CARS2                                                   3L700020
.CARS2 PZE     **                                                       3L700030
       END                                                              3L700040
$IBMAP CAR03   ADDREL                                                   3L800000
       LBL     AR03,BEGIN     CAR03                                  (7)3L800010
*              NOTE      PRECISION FIXED POINT NUMBERS.                 3L800020
*              NOTE      ENTER VIA,                                     3L800030
*                                                                       3L800040
*              NOTE  TSX  .CAR03,4                                      3L800050
*                                                                       3L800060
*              NOTE      WITH THE NUMBER IN THE AC-MQ. THE RESULT       3L800070
*              NOTE     IS LEFT IN THE AC-MQ.                           3L800080
       ENTRY   .CAR03                                                   3L800090
.CAR03 STQ     ADJB                SAVE LOWER HALF,L                    3L800100
       TZE     *+2                 IF UPPER NOT ZERO, PRODUCE           3L800110
       ACL     ADJA                  U-1 IN CELL ADJC AND               3L800120
       STO     ADJC                  SGN(U)*2**36) IN ACCUM.            3L800130
       SUB     ADJC                                                     3L800140
       ADD     ADJB                PRODUCE L OR (2**36)-L               3L800150
       LRS     35                    IN MQ, 0 OR 1 IN AC, SIGNS ALIKE.  3L800160
       ADD     ADJC                RESTORE CORRECTED U                  3L800170
       TRA     1,4                   IN AC, AND EXIT                    3L800180
ADJA   OCT     377777777777        ADJUST CONSTANT                      3L800190
ADJB   PZE     0                   TEMPORARY                            3L800200
ADJC   PZE     0                      STORAGE                           3L800210
       END                                                              3L800220
$IBMAP CAR04   ADDREL                                                   3L900000
       LBL     AR04,BEGIN     CAR04                                  (7)3L900010
*      CALLING SEQUENCE                                                 3L900020
*      TSX     .CARXX,4                                                 3L900030
*      PZE     L(C)                                                     3L900040
*      RETURN                                                           3L900050
*      WHERE L(C) IS THE LOCATION OF A SCALING                          3L900060
*      CONSTANT.  .CAR04 UPSCALES THE SINGLE                            3L900070
*      PRECISION AC BY 10**10 FOLLOWED BY C.                            3L900080
*      .CAR05 DOES THE SAME IF THE ORIGINAL                             3L900090
*      NUMBER IS IN THE MQ                                              3L900100
*      .CAR06 UPSCALES THE DOUBLE PRECISION AC-MQ                       3L900110
*      BY C, WHILE .CAR07 IS USED IF THE HIGH                           3L900120
*      ORDER IS ORIGINALLY IN THE MQ.                                   3L900130
       ENTRY   .CAR04                                                   3L900140
.CAR04 XCA                                                              3L900150
       ENTRY   .CAR05                                                   3L900160
.CAR05 MPY     L.1010              UPSCALE BY 10**10                    3L900170
       ENTRY   .CAR06                                                   3L900180
.CAR06 XCA                                                              3L900190
       ENTRY   .CAR07                                                   3L900200
.CAR07 STO     SCLA                SAVE LOW PART                        3L900210
       MPY*    1,4                 SAVE RESULT OF HIGH*C,               3L900220
       STQ     SCLB                  WHICH MUST BE SINGLE               3L900230
       LDQ     SCLA                                                     3L900240
       MPY*    1,4                 PRODUCT OF LOW*C IN AC-MQ            3L900250
       ADD     SCLB                FINAL RESULT                         3L900260
       TRA     2,4                                                      3L900270
L.1010 OCT     112402762000        10**10                               3L900280
SCLA   PZE     0                   TEMPORARY                            3L900290
SCLB   PZE     0                      STORAGE                           3L900300
       END                                                              3L900310
$IBMAP CAR08   ADDREL                                                   3LA00000
       LBL     AR08,BEGIN     CAR08                                  (7)3LA00010
*              NOTE     ENTER VIA                                       3LA00020
*                                                                       3LA00030
*              TSX  .CAR0X,4  X= 8 OR 9                                 3LA00040
*              NOTE      PZE   L(C)                                     3LA00050
*                                                                       3LA00060
*              NOTE     WHERE L(C) IS THE LOCATION OF A SCALING         3LA00070
*              NOTE      CONSTANT.                                      3LA00080
*                                                                       3LA00090
*              .CAR09 DOWNSCALES THE DOUBLE PRECISION AC-MQ             3LA00100
*              NOTE      BY C, LEAVING THE RESULT IN THE AC-MQ.         3LA00110
*              .CAR08 DOWNSCALES THE DOUBLE PRECISION AC-MQ BY          3LA00120
*              NOTE      10**10 FOLLOWED BY C, LEAVING THE RESULT IN    3LA00130
*              NOTE      THE MQ.                                        3LA00140
       ENTRY   .CAR08                                                   3LA00150
.CAR08 STQ     SCLAX               SAVE LOWER                           3LA00160
       LRS     35                  GET UPPER                            3LA00170
       DVP     L.101X                QUOTIENT                           3LA00180
       STQ     SCLBX                                                    3LA00190
       LDQ     SCLAX                                                    3LA00200
       DVP     L.101X              GET LOWER QUOTIENT AND               3LA00210
       CLA     SCLBX                 RESTORE NUMBER                     3LA00220
       ENTRY   .CAR09                                                   3LA00230
.CAR09 STQ     SCLAX               SAVE LOWER                           3LA00240
       LRS     35                  SECOND UPPER                         3LA00250
       DVP*    1,4                   QUOTIENT                           3LA00260
       STQ     SCLBX                                                    3LA00270
       LDQ     SCLAX               REMAINDER + LOWER QUOTIENT YIELDS    3LA00280
       DVP*    1,4                   FINAL LOWER QUOTIENT               3LA00290
       CLA     SCLBX                 AND RESULT                         3LA00300
       TRA     2,4                                                      3LA00310
L.101X OCT     112402762000        10**10                               3LA00320
SCLAX  PZE     0                   TEMPORARY                            3LA00330
SCLBX  PZE     0                      STORAGE                           3LA00340
       END                                                              3LA00350
$IBMAP CAR10   ADDREL                                                   3LB00000
       LBL     AR10,BEGIN     CAR10                                  (7)3LB00010
*              NOTE      FIXED POINT DIVIDE.                            3LB00020
*              NOTE      ENTER VIA                                      3LB00030
*                                                                       3LB00040
*              TSX  .CAR10,4                                            3LB00050
*                                                                       3LB00060
*              NOTE      WITH DIVISOR IN AC-MQ, HIGH ORDER DIVIDEND     3LB00070
*              NOTE      IN SYSOPH, AND LOW ORDER DIVIDEND IN SYSOPL.   3LB00080
*              NOTE     THE RESULT IS LEFT IN THE AC-MQ.                3LB00090
       ENTRY   .CAR10                                                   3LB00100
.CAR10 SXA     SDX,4               SAVE RETURN                          3LB00110
       AXT     0,4                                                      3LB00120
       TZE     *+3                 REDUCE DIVISOR TO                    3LB00130
       LRS     1                     SINGLE PRECISION AND               3LB00140
       TXI     *-2,4,-1              COUNT BINARY SHIFT                 3LB00150
       STQ     SDTP                                                     3LB00160
       CLA     SYSOPH                                                   3LB00170
       LDQ     SYSOPL              SHIFT DIVIDEND BY                    3LB00180
       LRS     0,4                   SAME AMOUNT                        3LB00190
       STQ     SYSOPL              SAVE LOWER                           3LB00200
       LRS     35                                                       3LB00210
       DVP     SDTP                PRODUCE UPPER QUOTIENT               3LB00220
       STQ     SYSOPH                AND SAVE                           3LB00230
       LDQ     SYSOPL                                                   3LB00240
       DVP     SDTP                FINAL QUOTIENT                       3LB00250
       CLA     SYSOPH                AND RESULT                         3LB00260
SDX    AXT     0,4                                                      3LB00270
       TRA     1,4                                                      3LB00280
SDTP   PZE     0                   TEMPORARY                            3LB00290
SYSOPH EQU     .CARS1                                                   3LB00300
SYSOPL EQU     .CARS2                                                   3LB00310
       END                                                              3LB00320
$IBMAP CAR11   ADDREL                                                   3LC00000
       LBL     AR11,BEGIN     CAR11                                  (7)3LC00010
*              NOTE      MULTIPLIES   ENTER VIA                         3LC00020
*                                                                       3LC00030
*              TSX  .CARX,4        X=11 OR 12                           3LC00040
*              NOTE      PZE   L(C)                                     3LC00050
*                                                                       3LC00060
*              NOTE     WHERE L(C) IS THE LOCATION OF A SCALING         3LC00070
*              NOTE      CONSTANT.                                      3LC00080
*              .CAR11 IS USED WHEN THE PRODUCT DOES NOT                 3LC00090
*              NOTE      EXCEED 103 BITS- THE RESULT IS SCALED DOWN BY  3LC00100
*              NOTE      C AND LEFT IN THE AC-MQ.                       3LC00110
*              .CAR12 IS USED WHEN THE PRODUCT DOES NOT                 3LC00120
*              NOTE      EXCEED 136 BITS- THE RESULT IS SCALED DOWN     3LC00130
*              NOTE      BY 10**10, FOLLOWED BY C, AND LEFT IN THE      3LC00140
*              NOTE      AC-MQ.                                         3LC00150
       ENTRY   .CAR11                                                   3LC00160
.CAR11 STZ     MPTP                SET SWITCH FOR ONE DIVIDE            3LC00170
       TRA     *+2                                                      3LC00180
       ENTRY   .CAR12                                                   3LC00190
.CAR12 STL     MPTP                SET FOR TWO DIVIDES                  3LC00200
       SXA     SYSMX,2                                                  3LC00210
       STO     CELLS               SAVE SECOND OPERAND                  3LC00220
       STQ     CELLS+1                                                  3LC00230
       MPY     SYSOPL                                                   3LC00240
       STQ     CELLS+3             SAVE (L1L2)6                         3LC00250
       STO     CELLS+2             PART FIRST (L1L2)U                   3LC00260
       LDQ     CELLS+1             L1 TO MQ                             3LC00270
       MPY     SYSOPH                                                   3LC00280
       STQ     CELLS+1             PART FIRST (L1U2)L                   3LC00290
       LDQ     SYSOPL              L2 TO MQ                             3LC00300
       STO     SYSOPL              SAVE (L1U2)U                         3LC00310
       MPY     CELLS                                                    3LC00320
       XCA                                                              3LC00330
       ADD     CELLS+2                                                  3LC00340
       ADD     CELLS+1                                                  3LC00350
       STO     CELLS+2             FIRST- (L1L2)U+(L1U2)L+(L2U1)L       3LC00360
       STQ     CELLS+1             SAVE (L2U1)U                         3LC00370
       LRS     35                                                       3LC00380
       LDQ     CELLS               U2 TO MQ                             3LC00390
       STO     CELLS               SAVE (FIRST)U                        3LC00400
       MPY     SYSOPH                                                   3LC00410
       XCA                                                              3LC00420
       ADD     CELLS                                                    3LC00430
       ADD     SYSOPL                                                   3LC00440
       ADD     CELLS+1             SECOND- (FIRST)U+(L2U1)U+            3LC00450
       STO     CELLS+1               (L1U2)+(U1U2)L                     3LC00460
       STQ     CELLS                                                    3LC00470
       LRS     35                                                       3LC00480
       ADD     CELLS               THIRD- (SECOND)U+(U1U2)U             3LC00490
       AXT     3,2                                                      3LC00500
       NZT     MPTP                                                     3LC00510
       TXI     SYSMB,2,-2                                               3LC00520
       STZ     MPTP                SETUP TO FIRST DIVIDE                3LC00530
       LDQ     L.101Y                BY 10**10                          3LC00540
SYSMA  STQ     MPTP+1                                                   3LC00550
       LDQ     CELLS+4,2           LOWER DIVIDE                         3LC00560
       DVP     MPTP+1              DIVIDE AND STORE                     3LC00570
       STQ     CELLS+4,2                                                3LC00580
       TIX     *-3,2,1                                                  3LC00590
       ZET     MPTP                                                     3LC00600
       TRA     SYSMX               EXIT IF SCALING DONE                 3LC00610
SYSMB  LDQ*    1,4                                                      3LC00620
       STL     MPTP                SETUP FOR DIVIDE                     3LC00630
       CLA     CELLS+1               BY C.                              3LC00640
       TXI     SYSMA,2,1                                                3LC00650
SYSMX  AXT     0,2                                                      3LC00660
       CLA     CELLS+2                                                  3LC00670
       TRA     2,4                                                      3LC00680
SYSOPH EQU     .CARS1                                                   3LC00690
SYSOPL EQU     .CARS2                                                   3LC00700
L.101Y OCT     112402762000        10**10                               3LC00710
CELLS  BSS     4                                                        3LC00720
MPTP   BSS     2                                                        3LC00730
       END                                                              3LC00740
$IBMAP CCTAB   ADDREL                                                   3LD00000
       LBL     CTAB,BEGIN     CCTAB                                  (7)3LD00010
*              NOTE CONVERSION FROM 709 TO 705 COLLATING SEQUENCE.      3LD00020
*                                                                       3LD00030
       ENTRY   .CCTAB                                                   3LD00040
.CCTAB BSS     0                                                        3LD00050
SYSCOL SYN     .CCTAB                                                   3LD00060
       FVE     SYSCOL,,8192                                             3LD00070
       FVE     SYSCOL,,12288                                            3LD00080
       FVE     SYSCOL,,16384                                            3LD00090
       FVE     SYSCOL,,20480                                            3LD00100
       FVE     SYSCOL,,24576                                            3LD00110
       FVE     SYSCOL,,28672                                            3LD00120
       SIX     SYSCOL,,0                                                3LD00130
       SIX     SYSCOL,,4096                                             3LD00140
       SIX     SYSCOL,,8192                                             3LD00150
       SIX     SYSCOL,,12288                                            3LD00160
       SIX     SYSCOL,,16384                                            3LD00170
       PON     SYSCOL,,12288                                            3LD00180
       PON     SYSCOL,,16384                                            3LD00190
       SIX     SYSCOL,,20480                                            3LD00200
       SIX     SYSCOL,,24576                                            3LD00210
       SIX     SYSCOL,,28672                                            3LD00220
       PZE     SYSCOL,,16384                                            3LD00230
       PON     SYSCOL,,24576                                            3LD00240
       PON     SYSCOL,,28672                                            3LD00250
       PTW     SYSCOL,,0                                                3LD00260
       PTW     SYSCOL,,4096                                             3LD00270
       PTW     SYSCOL,,8192                                             3LD00280
       PTW     SYSCOL,,12288                                            3LD00290
       PTW     SYSCOL,,16384                                            3LD00300
       PTW     SYSCOL,,20480                                            3LD00310
       PTW     SYSCOL,,24576                                            3LD00320
       PON     SYSCOL,,20480                                            3LD00330
       PZE     SYSCOL,,4096                                             3LD00340
       PZE     SYSCOL,,8192                                             3LD00350
       PZE     SYSCOL,,12288                                            3LD00360
       SVN     SYSCOL,,0                                                3LD00370
       SVN     SYSCOL,,4096                                             3LD00380
       PZE     SYSCOL,,28672                                            3LD00390
       PTH     SYSCOL,,0                                                3LD00400
       PTH     SYSCOL,,4096                                             3LD00410
       PTH     SYSCOL,,8192                                             3LD00420
       PTH     SYSCOL,,12288                                            3LD00430
       PTH     SYSCOL,,16384                                            3LD00440
       PTH     SYSCOL,,20480                                            3LD00450
       PTH     SYSCOL,,24576                                            3LD00460
       PTH     SYSCOL,,28672                                            3LD00470
       FOR     SYSCOL,,0                                                3LD00480
       PTW     SYSCOL,,28672                                            3LD00490
       PZE     SYSCOL,,20480                                            3LD00500
       PZE     SYSCOL,,24576                                            3LD00510
       SVN     SYSCOL,,8192                                             3LD00520
       SVN     SYSCOL,,12288                                            3LD00530
       SVN     SYSCOL,,16384                                            3LD00540
       PZE     SYSCOL,,0                                                3LD00550
       PON     SYSCOL,,0                                                3LD00560
       FOR     SYSCOL,,8192                                             3LD00570
       FOR     SYSCOL,,12288                                            3LD00580
       FOR     SYSCOL,,16384                                            3LD00590
       FOR     SYSCOL,,20480                                            3LD00600
       FOR     SYSCOL,,24576                                            3LD00610
       FOR     SYSCOL,,28672                                            3LD00620
       FVE     SYSCOL,,0                                                3LD00630
       FVE     SYSCOL,,4096                                             3LD00640
       FOR     SYSCOL,,4096                                             3LD00650
       PON     SYSCOL,,4096                                             3LD00660
       PON     SYSCOL,,8192                                             3LD00670
       SVN     SYSCOL,,20480                                            3LD00680
       SVN     SYSCOL,,24576                                            3LD00690
       SVN     SYSCOL,,28672                                            3LD00700
       END                                                              3LD00710
$IBMAP CHBCD   ADDREL                                                   3LE00000
       LBL     HBCD,BEGIN     CHBCD                                  (7)3LE00010
*      TSX     .CHBCD,4            HOLLERITH TO BCD CONVERSION          3LE00020
*      PZE     BL+NNN,,TS+8                                             3LE00030
*      RETURN                                                           3LE00040
* THE HOLLERITH IMAGE IS LOCATED IN AN AREA INDICATED                   3LE00050
* BY THE BASE LOCATOR(BYTE MUST BE ZERO).  THE                          3LE00060
* BCD IMAGE IS PLACED INTO THE 12 WORD TEMPORARY                        3LE00070
* STORAGE AREA BEGINNING AT TS+8.                                       3LE00080
       ENTRY   .CHBCD                                                   3LE00090
.CHBCD SXA     OUT1,1                                                   3LE00100
       SXA     OUT1+1,2                                                 3LE00110
       SXA     OUT1+2,4                                                 3LE00120
       CAL     1,4                                                      3LE00130
       PDX     0,2                 TS+8 OR OUTPUT-START                 3LE00140
       TXI     *+1,2,6             OUTPUT-START+6                       3LE00150
       SXA     IMG,2                                                    3LE00160
       TXI     *+1,2,6             OUTPUT-START+12                      3LE00170
       SXA     HSTZ,2                                                   3LE00180
       SXA     NXHLF+1,2                                                3LE00190
       CAL*    1,4                 INPUT-START                          3LE00200
       PAX     0,4                                                      3LE00210
       TXI     *+1,4,24                                                 3LE00220
       SXA     GETH,4              INPUT-START+24                       3LE00230
       AXT     24,4                                                     3LE00240
       AXT     12,2                                                     3LE00250
 HSTZ  STZ     **,2                OUTPUT-START+12                      3LE00260
       TIX     *-1,2,1                                               12 3LE00270
 FULL  AXT     12,1                                                  13 3LE00280
       STZ     ZROW                                                  14 3LE00290
       STZ     BLNKR                                                 15 3LE00300
 GETH  CAL     **,4                                                  16 3LE00310
       ORS     BLNKR                                                 17 3LE00320
       TXL     *+2,1,3                                               18 3LE00330
       ORS     ZROW                                                  19 3LE00340
       TXL     *+2,1,2                                               20 3LE00350
       ANA     ZROW                                                  21 3LE00360
 BLNKX XCL                                                           22 3LE00370
       AXT     6,2                 J                                 23 3LE00380
 CAQLP PXD     0,0                                                   24 3LE00390
       CAQ     MSKTB,,1                                              25 3LE00400
       ANA     VALTB+12,1                                            26 3LE00410
 IMG   ORS     **,2                                                  27 3LE00420
       TIX     CAQLP,2,1                                             28 3LE00430
       TXI     *+1,1,-1                                              29 3LE00440
       TIX     GETH,4,2                                              30 3LE00450
       TXH     NXHLF,1,1                                             3013LE00460
       CAL     BLNKR                                                 31 3LE00470
       COM                                                           32 3LE00480
       TXH     *+3,1,1                                               33 3LE00490
       TXI     BLNKX,1,2                                             34 3LE00500
 NXHLF TXL     OUT1,4,1                                              35 3LE00510
       AXT     **,1                START+12                             3LE00520
       SXA     IMG,1                                                 38 3LE00530
       TXI     FULL,4,21                                             39 3LE00540
 OUT1  AXT     **,1                                                  40 3LE00550
       AXT     **,2                                                  41 3LE00560
       AXT     **,4                                                  42 3LE00570
       TRA     2,4                                                      3LE00580
 6N24  OCT     000006000030                                          44 3LE00590
 ZROW  PZE     0                                                     45 3LE00600
 BLNKR PZE     0                                                     46 3LE00610
 MSKTB OCT     0,77,7700,7777,770000,770077,777700,777777             0 3LE00620
       OCT     77000000,77000077,77007700,77007777,77770000           8 3LE00630
       OCT     77770077,77777700,77777777                            13 3LE00640
       OCT     007700000000,007700000077,007700007700,007700007777   16 3LE00650
       OCT     007700770000,007700770077,007700777700,007700777777   20 3LE00660
       OCT     007777000000,007777000077,007777007700,007777007777   24 3LE00670
       OCT     007777770000,007777770077,007777777700,007777777777   28 3LE00680
       OCT     770000000000,770000000077,770000007700,770000007777   32 3LE00690
       OCT     770000770000,770000770077,770000777700,770000777777   36 3LE00700
       OCT     770077000000,770077000077,770077007700,770077007777   40 3LE00710
       OCT     770077770000,770077770077,770077777700,770077777777   44 3LE00720
       OCT     777700000000,777700000077,777700007700,777700007777   48 3LE00730
       OCT     777700770000,777700770077,777700777700,777700777777   52 3LE00740
       OCT     777777000000,777777000077,777777007700,777777007777   56 3LE00750
       OCT     777777770000,777777770077,777777777700,777777777777   60 3LE00760
 VALTB OCT     111111111111,101010101010,070707070707,060606060606    9 3LE00770
       OCT     050505050505,040404040404,030303030303,020202020202    5 3LE00780
       OCT     010101010101,606060606060,404040404040,202020202020    1 3LE00790
*              7090 TIME FOR 1 CONV = 5.1MS                             3LE00800
       END                                                              3LE00810
$IBMAP CBCDH   ADDREL                                                   3LF00000
       LBL     BCDH,BEGIN     CBCDH                                  (7)3LF00010
*      BCD TO HOLLERITH FOR COBOL                                       3LF00020
*      CALLING SEQUENCE                                                 3LF00030
*      TSX     .CBCDH,4                                                 3LF00040
*      PZE     BL+NNN,,TS+8                                             3LF00050
*      RETURN                                                           3LF00060
* THE BCD IMAGE IS STORED IN THE 12 WORD                                3LF00070
* TEMPORARY STORAGE AREA BEGINNING AT TS+8                              3LF00080
* AND THE HOLLERITH IMAGE IS PLACED IN THE                              3LF00090
* AREA LOCATED BY THE BASE LOCATOR.                                     3LF00100
       ENTRY   .CBCDH                                                   3LF00110
.CBCDH SXA     BCX1,4                                                   3LF00120
       SXA     BCX1+1,2                                                 3LF00130
       SXA     BCX1+2,1                                                 3LF00140
       CAL*    1,4                                                      3LF00150
       STA     ZONE                RECEIVING BUFFER LOCATION            3LF00160
       CAL     1,4                                                      3LF00170
       PDX     0,1                                                      3LF00180
       SXA     BCD2,1              INPUT START                          3LF00190
       LDQ     STROBE                                                06 3LF00200
       ZET     PRINT                                                 07 3LF00210
       TRA     BCD0                                                  08 3LF00220
       AXT     0,1                                                   09 3LF00230
       STZ*    ZONE                                                  10 3LF00240
       TXI     *+1,1,-1                                              11 3LF00250
       TXH     *-2,1,-24                                             12 3LF00260
       LDQ     HFROL                                                 13 3LF00270
       STQ     HAFRO                                                 14 3LF00280
       LDQ     MZE                                                   15 3LF00290
 BCD0  LXA     ZONE,1                                                16 3LF00300
       TXI     *+1,1,-1                                              17 3LF00310
       SXA     ZONE,1                                                18 3LF00320
       SXA     *+1,1                                                 19 3LF00330
 NUMBR AXT     **,2                                                  20 3LF00340
       AXT     0,4                                                   26 3LF00350
       XCL                                                           27 3LF00360
 BCD1  TNZ     *+4                                                   28 3LF00370
       CAL     MZE                                                   29 3LF00380
       LDQ     HFROR                                                 30 3LF00390
       STQ     HAFRO                                                 31 3LF00400
       SLW     STROBE                                                32 3LF00410
 BCD2  LDQ     **,4                                                  33 3LF00420
       SXA     BCD6,4                                                34 3LF00430
       AXT     6,4                                                   35 3LF00440
 BCD3  PXD     0,0                                                   36 3LF00450
       LGL     2                                                     37 3LF00460
       ALS     14                                                    38 3LF00470
       LGL     4                                                     39 3LF00480
       ALS     1                                                     40 3LF00490
       ACL     HAFRO                                                 41 3LF00500
       PDX     0,1                 ZONE                              42 3LF00510
       PAX     0,2                 NUMBR                             43 3LF00520
       CAL     STROBE                                                44 3LF00530
       TXH     *+4,2,-19           NUMBR GR ZERO                     45 3LF00540
       TXL     *+3,2,-21                                             46 3LF00550
       TXH     BCD5X,1,-21         ZONE  GR 2                        47 3LF00560
       TXL     BCD4+1,1,-25        ZONE  LR-EQ ZERO                  48 3LF00570
       TXL     *+2,1,-25           ZONE  LR-EQ ZERO                  49 3LF00580
       ORS*    ZONE                                                  50 3LF00590
       TXH     BCD4,2,6            NUMBR GR 9                        51 3LF00600
       LXA     HAFRO,1                                               52 3LF00610
       TXI     *+1,1,16                                              53 3LF00620
       ORS*    ZONE                ENTER 8 PUNCH                     54 3LF00630
       TXI     *+2,2,-16                                             55 3LF00640
 BCD4  TXL     *+2,2,-19           NUMBR LR-EQ ZERO                  56 3LF00650
       ORS*    NUMBR                                                 57 3LF00660
 BCD5X ARS     1                                                     58 3LF00670
       SLW     STROBE                                                59 3LF00680
       TIX     BCD3,4,1            RETURN ON 6-CHAR LOOP             60 3LF00690
 BCD6  AXT     **,4                                                  61 3LF00700
       TXI     *+1,4,-1                                              62 3LF00710
 BCD7  TXH     BCD1,4,-12          RETURN ON 12 WORD LOOP               3LF00720
 BCX1  AXT     **,4                EXIT                              64 3LF00730
       AXT     **,2                                                  65 3LF00740
       AXT     **,1                                                  66 3LF00750
       TRA     2,4                                                      3LF00760
 PRINT PZE     0                                                     71 3LF00770
STROBE PZE     0                                                     72 3LF00780
 HAFRO PZE     0                                                     73 3LF00790
 HFROL PZE     -19,,-25                                              74 3LF00800
 HFROR PZE     -20,,-26                                              75 3LF00810
 ZONE  AXT     **,1                                                     3LF00820
 MZE   MZE     0                                                        3LF00830
       END                                                              3LF00840
$IBMAP CAR13   ADDREL                                                   3LG00000
       LBL     AR13,BEGIN     CAR13                                  (7)3LG00010
*                   SINGLE PRECISION EXPONENTIAL A**B,                  3LG00030
*                   FLOATING POINT.                                     3LG00040
*      NOTE                        CALLING SEQUENCE-                    3LG00050
*                       TSX SYSEX1,4                                    3LG00060
*      PZE     CP+NNN                                                   3LG00070
*                                  PZE L1,,L2                           3LG00080
*                   WITH A IN ACCUMULATOR, B IN SYSOPH-                 3LG00090
*                   RESULT LEFT IN ACCUMULATOR.                         3LG00100
*              NOTE                OUT OF RANGE CONDITIONS              3LG00110
* RESULT IN ON LINE MESSAGES (CP+NNN IS THE                             3LG00120
* LOCATION OF THE SOURCE LANGUAGE CARD NUMBER)                          3LG00130
*                   AND A RETURN WITH AC SET TO MAXIMUM.                3LG00140
 EXNG  EQU     .CEXNG              EXIT FOR AN ERROR                    3LG00150
EXPERR EQU     .CEXPR                                                   3LG00160
SYSOPH EQU     .CARS1              STORAGE FOR B                        3LG00170
*                                                                       3LG00180
       ENTRY   .CAR13                                                   3LG00190
.CAR13 TZE     2,4                 ZERO TO ANYTHING IS ZERO             3LG00200
       LDQ     1,4                                                      3LG00210
       STQ     EXCDN                                                    3LG00220
       SXA     SYSEXX,4                                                 3LG00230
       TMI     EXTST                                                    3LG00240
*                                                                       3LG00250
*  COMPUTE LOG BASE 2 OF A                                              3LG00260
       LRS     27                                                       3LG00270
       SUB     L.200               SAVE TRUE POWER                      3LG00280
       STO     SADJ                   FOR ADJUST                        3LG00290
       CLA     L.200                                                    3LG00300
       LLS     27                  REPLACE BY EQUIVALENT                3LG00310
       STO     X                      FRACTION                          3LG00320
       FAD     FL.1                                                     3LG00330
       STO     Z                   POWER SERIES IN                      3LG00340
       CLA     X                                                        3LG00350
       FSB     FL.1                   Z=(X-1)/(X+1).                    3LG00360
       FDP     Z                                                        3LG00370
       STQ     Z                   AND Z**2.                            3LG00380
       FMP     Z                                                        3LG00390
       STO     X                                                        3LG00400
       AXT     7,4                                                      3LG00410
       CLA     SLOC                                                     3LG00420
LLOOP  XCA                         COMPUTE LOG OF                       3LG00430
       FMP     X                      FRACTION BY                       3LG00440
       FAD     SLOC+8,4          POWER SERIES                           3LG00450
       TIX     LLOOP,4,1                                                3LG00460
       XCA                         COMPLETE SERIES WITH                 3LG00470
       FMP     Z                      MULTIPLICATION BY Z               3LG00480
       XCA                            AND THEN 2LN2                     3LG00490
       FMP     L2E                                                      3LG00500
       STO     Z                                                        3LG00510
       CLA     SADJ                ADD TRUE POWER                       3LG00520
       ACL     SXZ                 TO GET                               3LG00530
       FAD     SXZ                 FINAL                                3LG00540
       FAD     Z                   RESULT                               3LG00550
*                                                                       3LG00560
       XCA                                                              3LG00570
       FMP     SYSOPH              PRODUCT B*LOG(A)                     3LG00580
*                                                                       3LG00590
*FINISH WITH 2**B*LOG(A)                                                3LG00600
       STO     X                   SAVE NUMBER                          3LG00610
       UFA     SXZ                 GET INTEGRAL PART                    3LG00620
       LAS     SMAX                IF OUT OF RNAGE,                     3LG00630
       TRA     EXPER                  GO TO TEST                        3LG00640
       TRA     EXPER               FOR HIGH OR LOW                      3LG00650
       ALS     27                                                       3LG00660
       STO     SADJ                CHARACTERIST ADJUSTMENT              3LG00670
       TZE     *+2                                                      3LG00680
       STQ     X                   ADJUST TO FRACTION IF NOT            3LG00690
       AXT     9,4                                                      3LG00700
       CLA     SCOF                                                     3LG00710
SLOOP  XCA                         COMPUTE EXPONENTIAL                  3LG00720
       FMP     X                      BY POLYNOMIAL                     3LG00730
       FAD     SCOF+10,4                                                3LG00740
       TIX     SLOOP,4,1                                                3LG00750
       ADD     SADJ                GET TRUE CHAR                        3LG00760
*                                                                       3LG00770
SYSEXX AXT     **,4                                                     3LG00780
       TXL     PAR,4,0                                                  3LG00790
       TRA     2,4                                                      3LG00800
EXPER  TSX     EXPERR,4                                                 3LG00810
EXCDN  PZE     **                                                       3LG00820
       TRA     SYSEXX                                                   3LG00830
* THIS CODING ENTERED IF 'A' IS NEGATIVE                                3LG00840
EXTST  STO     A                                                        3LG00850
       CLA     .CARS1                                                   3LG00860
       STO     B                                                        3LG00870
       SLW     K                                                        3LG00880
*DETERMINE IF B IS AN INTEGER                                           3LG00890
INTST  CAL     K                                                        3LG00900
       UFA     SXZ                                                      3LG00910
       LGL     35                                                       3LG00920
       SLW     PBIT                                                     3LG00930
       LGL     4                                                        3LG00940
       TNZ     EXNG                                                     3LG00950
       CLS     A                                                        3LG00960
       SXA     SYSEXX,0                                                 3LG00970
       SXA     KS,4                                                     3LG00980
       TRA     .CAR13+5                                                 3LG00990
*REENTER .CAR13 SR TO CALC A(MAG)**B(MAG)                               3LG01000
       ENTRY   PAR                                                      3LG01010
PAR    STO     R                                                        3LG01020
       XCA                                                              3LG01030
       CLA     B                                                        3LG01040
       TPL     KEVTS                                                    3LG01050
       CLA     FL.1                                                     3LG01060
       FDP     R                                                        3LG01070
KEVTS  CLA     PBIT                                                     3LG01080
       LRS     0                                                        3LG01090
       XCA                                                              3LG01100
KS     AXT     **,4                                                     3LG01110
       TRA     2,4                                                      3LG01120
K      SYN     .CARS1                                                   3LG01130
A      PZE                                                              3LG01140
B      PZE                                                              3LG01150
R      PZE                                                              3LG01160
PBIT   PZE                                                              3LG01170
 X     PZE     0                   TEMPORARY                            3LG01180
 Z     PZE     0                      STORAGE                           3LG01190
 SADJ  PZE     0                   ADJUST STORAGE                       3LG01200
 L.200 OCT     200                 TO GET POWER                         3LG01210
 SXZ   OCT     233000000000        INTEGER ZERO                         3LG01220
SMAX   OCT     233000000177        RANGE TEST WORD                      3LG01230
L2E    OCT     202561250731        2*LOGE                               3LG01240
SLOC   OCT     175421042104      POLY COEFF. -  1/15                    3LG01250
       OCT     175473047305      1/13                                   3LG01251
       OCT     175564272135        1/11                                 3LG01260
       OCT     175707070707           1/9                               3LG01270
       OCT     176444444445           1/7                               3LG01280
       OCT     176631463146           1/5                               3LG01290
       OCT     177525252525           1/3                               3LG01300
FL.1   OCT     201400000000        FLOATING ONE                         3LG01310
*                                                                       3LG01320
*                                                                       3LG01330
SCOF   OCT     151665112404        POLYNOMIAL COEFFICIENTS-             3LG01340
       OCT     155542600231        C9  .10178087 X 10-6                 3LG01350
       OCT     160777627761        C8  .13215489 X 10-5                 3LG01360
       OCT     164503022114        C7  .15252738 X 10-4                 3LG01370
       OCT     167535417772        C6  .15403530 X 10-3                 3LG01380
       OCT     172473125334        C5  .13333558 X 10-2                 3LG01390
       OCT     174706541066        C4  .96181291 X 10-2                 3LG01400
       OCT     176753767600        C3  .55504109 X 10-1                 3LG01410
       OCT     200542710300        C2  .24022561                        3LG01420
       OCT     201400000000        C1  .69314718                        3LG01430
       END                                                              3LG01440
$IBMAP CAR14   ADDREL                                                   3LH00000
       LBL     AR14,BEGIN     CAR14                                  (7)3LH00010
*                   DOUBLE PRECISION EXPONENTIAL A**B,                  3LH00030
*                   FLOATING POINT.                                     3LH00040
*              NOTE                CALLING SEQUENCE-                    3LH00050
*                           TSX SYSEXN,4                                3LH00060
*                           PZE CP+NNN                                  3LH00070
*                   WITH A IN AC-MQ AND B IN SYSOPH-SYSOPL,             3LH00080
*                   WHERE N IS                                          3LH00090
*                          2 IF A IS SINGLE, B DOUBLE                   3LH00100
*                          3 IF A IS DOUBLE, B SINGLE                   3LH00110
*                          4 IF BOTH ARE DOUBLE                         3LH00120
*                   PRECISION NUMBERS - THE RESULT IS ALWAYS            3LH00130
*                   DOUBLE PRECISION AND IS LEFT IN THE AC-MQ.          3LH00140
*      NOTE                        OUT OF RANGE CONDITIONS RESULT       3LH00150
* IN ON-LINE MESSAGES. CP+NNN IS THE LOCATION                           3LH00160
* OF THE SOURCE LANGUAGE CARD NUMBER AT WHICH                           3LH00170
* THE ORIGINAL COMPUTATION WAS SPECIFIED                                3LH00180
*                   A RETURN WITH AC-MQ SET TO MAXIMUM.                 3LH00190
 EXNG  EQU     .CEXNG              EXIT FOR A NEGATIVE                  3LH00200
EXPERR EQU     .CEXPR              OVER(UNDER) FLOW EXIT                3LH00210
SYSOPH EQU     .CARS1              SECOND OPERAND                       3LH00220
SYSOPL EQU     .CARS2              SOTRAGE                              3LH00230
       ENTRY   .CAR14                                                   3LH00240
.CAR14 LDQ     DXZ                 SET LOWER A TO ZERO                  3LH00250
       TRA     .CAR02                                                   3LH00260
       ENTRY   .CAR01                                                   3LH00270
.CAR01 STZ     SYSOPL              SET LOWER B TO ZERO                  3LH00280
       ENTRY   .CAR02                                                   3LH00290
.CAR02 TZE     2,4                 ZERO TO ANYTHING IS ZERO             3LH00300
       SXA     XX4,4                                                    3LH00310
       STQ     EMALO                                                    3LH00320
       LDQ     1,4                                                      3LH00330
       STQ     EMCDN                                                    3LH00340
       LDQ     EMALO                                                    3LH00350
       TMI     EXTST2                                                   3LH00360
EMRTN  SXA     XX1,1               SAVE                                 3LH00370
       SXA     XX2,2                  INDEX REGISTERS                   3LH00380
*                                                                       3LH00390
* COMPUTE LOG BASE 2 OF A                                               3LH00400
       STO     Y                                                        3LH00410
       LLS     8                   REDUCE LOWER PART                    3LH00420
       CLA     L145                   TO LOWER PART                     3LH00430
       LRS     8                      OF PURE FRACTION                  3LH00440
       STQ     Y+1                                                      3LH00450
       CLA     Y                                                        3LH00460
       LRS     27                  SAVE TRUE POWER                      3LH00470
       SUB     L200                   FOR ADJUST                        3LH00480
       STO     ADJ                                                      3LH00490
       CLA     L200                                                     3LH00500
       LLS     27                  REDUCE UPPER TO                      3LH00510
       STO     Y                      NORMALIZED FRACTION               3LH00520
       FAD     FP.1                                                     3LH00530
       STO     W                                                        3LH00540
       XCA                                                              3LH00550
       FAD     Y+1                                                      3LH00560
       FAD     W                                                        3LH00570
       STO     W                   DOUBLE PRECISION                     3LH00580
       STQ     W+1                    Y+1.                              3LH00590
       CLA     Y                                                        3LH00600
       FSB     FP.1                                                     3LH00610
       FDP     W                                                        3LH00620
       STQ     Y                      W=(Y-1)/(Y+1)                     3LH00630
       FAD     Y+1                                                      3LH00640
       FDP     W                   BY DP DIVISION                       3LH00650
       STQ     Y+1                                                      3LH00660
       CLS     W+1                                                      3LH00670
       FDP     W                                                        3LH00680
       FMP     Y                                                        3LH00690
       FAD     Y+1                                                      3LH00700
       FAD     Y                                                        3LH00710
       STO     W                   THIS IS IT                           3LH00720
       STQ     W+1                                                      3LH00730
       AXC     W,1                 NOW COMPUTE                          3LH00740
       TSX     DPMP,2                 Y=W*W FOR                         3LH00750
       STO     Y                      POWER SERIES                      3LH00760
       STQ     Y+1                                                      3LH00770
       AXT     26,4                                                     3LH00780
       CLA     DLOC                                                     3LH00790
       LDQ     DLOC+1                                                   3LH00800
GLOOP  AXC     Y,1                 POWER SERIES                         3LH00810
       TSX     DPMP,2                EVALUATION                         3LH00820
       STQ     PL                                                       3LH00830
       FAD     DLOC+28,4                                                3LH00840
       STO     PH                                                       3LH00850
       XCA                                                              3LH00860
       FAD     DLOC+29,4                                                3LH00870
       FAD     PL                                                       3LH00880
       FAD     PH                                                       3LH00890
       TIX     GLOOP,4,2                                                3LH00900
       AXC     W,1                 NOW MULTIPLY BY W                    3LH00910
       TSX     DPMP,2                 AND THEN BY                       3LH00920
       AXC     DL2E,1                 2*LOGE TO GET                     3LH00930
       TSX     DPMP,2                 LOG OF FRACTION                   3LH00940
       STO     Y                                                        3LH00950
       STQ     Y+1                                                      3LH00960
       CLA     ADJ                 ADD TRUE POWER                       3LH00970
       ACL     DXZ                    TO GET FINAL                      3LH00980
       FAD     DXZ                    RESULT                            3LH00990
       FAD     Y                                                        3LH01000
       STO     Y                                                        3LH01010
       XCA                                                              3LH01020
       FAD     Y+1                                                      3LH01030
       FAD     Y                                                        3LH01040
*                                                                       3LH01050
       AXC     SYSOPH,1            PRODUCT                              3LH01060
       TSX     DPMP,2              B*LOG(A)                             3LH01070
*  FINISH WITH 2**B*LOG(A)                                              3LH01080
       STO     Y                   SAVE ORIGINAL                        3LH01090
       STQ     Y+1                    NUMBER                            3LH01100
       UFA     DXZ                 FIND INTEGRAL PART                   3LH01110
       LAS     MAX                 IF OUT OF RANGE,                     3LH01120
       TRA     EXPER                  GO TO TEST                        3LH01130
       TRA     EXPER                  FOR HIGH OR LOW                   3LH01140
       ALS     27                                                       3LH01150
       STO     ADJ                 CHARACTERISTIC ADJUSTMENT            3LH01160
       TZE     OK                                                       3LH01170
       STQ     Y                   ADJUST NUMBER TO                     3LH01180
       CLA     Y+1                    PURE FRACTION                     3LH01190
       FAD     Y                      IF POWER WAS                      3LH01200
       STQ     Y+1                    POSITIVE                          3LH01210
       STO     Y                                                        3LH01220
OK     AXT     26,4                SETUP LOOP                           3LH01230
       CLA     COEF                                                     3LH01240
       LDQ     COEF+1                                                   3LH01250
DLOOP  AXC     Y,1                 COMPUTE EXPONENTIAL                  3LH01260
       TSX     DPMP,2                 OF FRACTION                       3LH01270
       STQ     PL                     BY POLYNOMIAL-                    3LH01280
       FAD     COEF+28,4                                                3LH01290
       STO     PH                                                       3LH01300
       XCA                                                              3LH01310
       FAD     PL                                                       3LH01320
       FAD     COEF+29,4                                                3LH01330
       FAD     PH                                                       3LH01340
       TIX     DLOOP,4,2                                                3LH01350
       XCA                         ADJUST CHAR TO                       3LH01360
       ADD     ADJ                    REFLECT TRUE POWER                3LH01370
       TPL     *+2                                                      3LH01380
       PXA     0,0                                                      3LH01390
       TIX     *-4,4,1                                                  3LH01400
*                                                                       3LH01410
XX4    AXT     0,4                                                      3LH01420
       TXL     EMRET,4,0                                                3LH01430
XX1    AXT     0,1                 RESTORE AND                          3LH01440
XX2    AXT     0,2                    EXIT                              3LH01450
       TRA     2,4                                                      3LH01460
*                                                                       3LH01470
EXPER  TSX     EXPERR,4                                                 3LH01480
EMCDN  PZE     **                                                       3LH01490
       TRA     XX4                                                      3LH01500
DPMP   STO     PH                  DOUBLE PRECISION                     3LH01510
       FMP     0,1                    MULTIPLY OF                       3LH01520
       STO     PL                     AC-MQ WITH                        3LH01530
       LDQ     PH                     OPERAND WHOSE                     3LH01540
       FMP     1,1                 ADDRESS IS IN                        3LH01550
       FAD     PL                  IR1 (COMP).                          3LH01560
       STO     PL                                                       3LH01570
       LDQ     PH                                                       3LH01580
       FMP     0,1                                                      3LH01590
       STO     PH                                                       3LH01600
       XCA                                                              3LH01610
       FAD     PL                                                       3LH01620
       FAD     PH                                                       3LH01630
       TRA     1,2                                                      3LH01640
*      NEGATIVE A, STRIP OFF SIGN AND CALC. A(MAG)**B.                  3LH01650
EXTST2 STO     EMAHI               A                                    3LH01660
       CLA     SYSOPH                                                   3LH01670
       STO     EMSBIT                                                   3LH01680
       SSP                                                              3LH01690
       TZE     EMEXOK                                                   3LH01700
       STO     SYSOPH              B ABS.                               3LH01710
       LRS     27                                                       3LH01720
       SUB     L200                                                     3LH01730
       TZE     *+2                                                      3LH01740
       TMI     EXNG                NON-INTEGER EXP.                     3LH01750
EMEXOK PAC     0,4                 TRUE EXP TO IR4 (COMPLEMENTED).      3LH01760
       CAL     SYSOPL                                                   3LH01770
       STO     SYSOPL              B ABS. LOW                           3LH01780
       ALS     9                   CLEAR OUT LOW-ORDER EXP              3LH01790
       XCA                                                              3LH01800
       CLA     SYSOPH                                                   3LH01810
       LLS     8,4                                                      3LH01820
       LXA     XX4,4                                                    3LH01830
       SLW     EMPBIT              LOW O-DER BIT OF B INTEGER           3LH01840
       LLS     2                                                        3LH01850
       TNZ     EXNG                NON-INTEGER EXPONENT                 3LH01860
       XCA                           NOT ALLOWED FOR                    3LH01870
       TNZ     EXNG                    NEGATIVE A VALUES.               3LH01880
       LXA     XX4,4               SAVE .CAR14 RETURN POINT             3LH01890
       SXA     EMXX4,4                                                  3LH01900
       STA     XX4                 C(AC)=0   SET UP NEG. A RETURN FLAG  3LH01910
       CLS     EMAHI               FORCE SIGN PLUS                      3LH01920
       LDQ     EMALO                                                    3LH01930
       LRS     0                   FORCE MQ S+GN PLUS                   3LH01940
       TRA     EMRTN               MAGNITUDE EPONENTIATION              3LH01950
EMRET  STO     EMAHI                                                    3LH01960
       STQ     EMALO                                                    3LH01970
       CLA     EMSBIT                                                   3LH01980
       TPL     EMSIGN                                                   3LH01990
*      DFDP MAC-O EXPANSION FOR RECIPROCAL.                             3LH02000
       CLA     EM1HI                                                    3LH02010
       FDP     EMAHI                                                    3LH02020
       STO     E.2                                                      3LH02030
       STQ     E.3                                                      3LH02040
       FMP     EMALO                                                    3LH02050
       CHS                                                              3LH02060
       FAD     E.2                                                      3LH02070
       FAD     EM1LO                                                    3LH02080
       FDP     EMAHI                                                    3LH02090
       XCA                                                              3LH02100
       FAD     E.3                                                      3LH02110
*                                                                       3LH02120
       STO     EMAHI                                                    3LH02130
EMSIGN CAL     EMPBIT                                                   3LH02140
       ANA     EMCLR              CLEAR TO P-BIT ONLY                   3LH02150
       ORS     EMAHI               AFFIX SIGN                           3LH02160
       CLA     EMAHI                                                    3LH02170
EMMQSN LRS     0                                                        3LH02180
EMXX4  AXT     **,4                                                     3LH02190
       TRA     XX1                                                      3LH02200
*                                                                       3LH02210
EMCLR  OCT     400000000000                                             3LH02220
EM1HI  OCT     201400000000                                             3LH02230
EM1LO  OCT     146000000000                                             3LH02240
EMAHI  PZE     **                                                       3LH02250
EMALO  PZE     **                                                       3LH02260
E.2    PZE     **                                                       3LH02270
E.3    PZE     **                                                       3LH02280
EMPBIT PZE     **                                                       3LH02290
EMSBIT PZE     **                                                       3LH02300
*                                                                       3LH02310
Y      PZE     0                   VARIOUS                              3LH02320
       PZE     0                      TEMPORARY                         3LH02330
W      PZE     0                      STORAGES                          3LH02340
       PZE     0                                                        3LH02350
PH     PZE     0                                                        3LH02360
PL     PZE     0                                                        3LH02370
ADJ    PZE     0                   ADJUST STORAGE                       3LH02380
L145   OCT     145                 FOR CHAR                             3LH02390
L200   OCT     200                    ADJUST                            3LH02400
DL2E   OCT     202561250731        2*LOGE IN                            3LH02410
       OCT     147225602774           DOUBLE PRECISION                  3LH02420
DXZ    OCT     233000000000        INTEGER ZERO                         3LH02430
MAX    OCT     233000000177        RANGE TEST WORD                      3LH02440
*                                                                       3LH02450
DLOC   OCT     174457104611      POLYNOMIAL COEFF. - 1/27               3LH02460
       OCT     141353460410                                             3LH02461
       OCT     174507534121      1/25                                   3LH02462
       OCT     141727024365                                             3LH02470
       OCT     174544131026        1/23                                 3LH02480
       OCT     141205441310                                             3LH02490
       OCT     174606060606        1/21                                 3LH02500
       OCT     141060606061                                             3LH02510
       OCT     174657120657          1/19                               3LH02520
       OCT     141120657121                                             3LH02530
       OCT     174741703607          1/17                               3LH02540
       OCT     141417036074                                             3LH02550
       OCT     175421042104          1/15                               3LH02560
       OCT     142210421042                                             3LH02570
       OCT     175473047304          1/13                               3LH02580
       OCT     142730473047                                             3LH02590
       OCT     175564272135          1/11                               3LH02600
       OCT     142056427214                                             3LH02610
       OCT     175707070707          1/9                                3LH02620
       OCT     142070707071                                             3LH02630
       OCT     176444444444          1/7                                3LH02640
       OCT     143444444445                                             3LH02650
       OCT     176631463146          1/5                                3LH02660
       OCT     143314631463                                             3LH02670
       OCT     177525252525          1/3                                3LH02680
       OCT     144252525253                                             3LH02690
FP.1   OCT     201400000000        FLOATING ONE                         3LH02700
       OCT     000000000000                                             3LH02710
*                                                                       3LH02720
COEF   OCT     131604546627        POLYNOMIAL COEFFICIENTS-             3LH02730
       OCT     076373672054                                             3LH02740
       OCT     135707734771        C13  .1380942553937516 X 10-11       3LH02750
       OCT     102726002460        C12  .2591671190111412 X 10-10       3LH02760
       OCT     141750613453        C11  .4445361131688115 X 10-9        3LH02770
       OCT     106071130534        C10  .7054583523083176 X 10-8        3LH02780
       OCT     145744623056        C9  .1017808736329201 X 10-6         3LH02790
       OCT     112716354342        C8  .1321548902877208 X 10-5         3LH02800
       OCT     151665112404        C7  .1525273379851831 X 10-4         3LH02810
       OCT     116110420624        C6  .1540353038554321 X 10-3         3LH02820
       OCT     155542600230        C5  .1333355814644007 X 10-2         3LH02830
       OCT     122524313370        C4  .9618129107641535 X 10-2         3LH02840
       OCT     160777627761        C3  .5550410866482143 X 10-1         3LH02850
       OCT     125253306674        C2  .2402265069590998                3LH02860
       OCT     164503022113        C1  .6931471805599453                3LH02870
       OCT     131655247146                                             3LH02880
       OCT     167535417771                                             3LH02890
       OCT     134705174104                                             3LH02900
       OCT     172473125333                                             3LH02910
       OCT     137735153674                                             3LH02920
       OCT     174706541065                                             3LH02930
       OCT     141602240523                                             3LH02940
       OCT     176753767577                                             3LH02950
       OCT     143701305332                                             3LH02960
       OCT     200542710277                                             3LH02970
       OCT     145575071736                                             3LH02980
       OCT     201400000000                                             3LH02990
       OCT     000000000000                                             3LH03000
       END                                                              3LH03010
$IBMAP CEXPR   ADDREL                                                   3LI00000
       LBL     EXPR,BEGIN     CEXPR                                  (7)3LI00010
*      ERROR, UNDERFLOW, OVERFLOW HANDLER FOR EXPONENTIAL ROUTINES.     3LI00020
       SPACE   2                                                        3LI00030
       ENTRY   .CEXPR                                                   3LI00040
.CEXPR TPL     EXOV                OVERFLOW IF POSITIVE                 3LI00050
       PXA     0,0                                                      3LI00060
       LRS     35                                                       3LI00070
       TRA     2,4                 EXIT                                 3LI00080
       SPACE   2                                                        3LI00090
EXOV   SXA     EXOVX,4                                                  3LI00100
       CAL*    1,4                                                      3LI00110
       SLW     OVW+6               CARD NUMBER                          3LI00120
       TSX     .CDPLY,4            ISSUE OVERFLOW MESSAGE               3LI00130
       PZE     OVW,,8                                                   3LI00140
       CLA     OMAX                PLACE LARGEST NUMBER                 3LI00150
       LDQ     OMAX+1              IN AC-MQ                             3LI00160
EXOVX  AXT     **,4                AND                                  3LI00170
       TRA     2,4                 EXIT                                 3LI00180
       SPACE   2                                                        3LI00190
       ENTRY   .CEXNG                                                   3LI00200
.CEXNG SXA     EXOVX,4                                                  3LI00210
       CAL*    1,4                                                      3LI00220
       SLW     NGW+6                                                    3LI00230
       TSX     .CDPLY,4                                                 3LI00240
       PZE     NGW,,8                                                   3LI00250
       TRA     EXOVX-2                                                  3LI00260
OVW    BCI     6,EXPONENTIAL OVERFLOW AT CARD NUMBER                    3LI00270
       BCI     1,******                                                 3LI00280
       BCI     5,.                                                      3LI00290
NGW    BCI     6,ERROR IN EXPONENTIAL AT CARD NUMBER                    3LI00300
       BCI     1,******                                                 3LI00310
       BCI     5,.                                                      3LI00320
OMAX   OCT     377777777777                                             3LI00330
       OCT     344777777777                                             3LI00340
       END                                                              3LI00350
$IBMAP CAR15   ADDREL                                                   3LJ00000
       LBL     AR15,BEGIN     CAR15                                  (7)3LJ00010
       ENTRY   .CAR15                                                   3LJ00020
.CAR15 STO     TEMP                                                     3LJ00030
       ANA     C1                                                       3LJ00040
       SUB     C2                                                       3LJ00050
       TPL     *+2                                                      3LJ00060
       PXA     0,0                                                      3LJ00070
       XCA                                                              3LJ00080
       CLA     TEMP                                                     3LJ00090
       LRS     0                                                        3LJ00100
       TRA     1,4                                                      3LJ00110
C1     OCT     377000000000                                             3LJ00120
C2     OCT     033000000000                                             3LJ00130
TEMP   BSS     1                                                        3LJ00140
       END                                                              3LJ00150
$IBMAP CKEYS   ADDREL                                                   3LK00000
       LBL     KEYS,BEGIN     CKEYS                                  (7)3LK00010
* .CKEYS LIBRARY ROUTINE                                                3LK00020
       SPACE   4                                                        3LK00030
* CALLING SEQUENCE                                                      3LK00040
       SPACE                                                            3LK00050
*      TSX     .CKEYS,4                                                 3LK00060
*      (RETURN)                                                         3LK00070
       SPACE                                                            3LK00080
* THE PANEL KEY SETTING IS PLACED IN THE MQ REGISTER                    3LK00090
       SPACE   2                                                        3LK00100
       ENTRY   .CKEYS                                                   3LK00110
.CKEYS ENK                                                              3LK00120
       TRA     1,4                                                      3LK00130
       END                                                              3LK00140
$IBMAP CCDTY   ADDREL                                                   3LL00000
       LBL     CDTY,BEGIN     CCDTY                                  (7)3LL00010
*   THIS SUBROUTINE DETERMINES IF THE UNIT ATTACHED TO A FILE IS CARD   3LL00020
*   MEDIA OR TAPE MEDIA.                                                3LL00030
       SPACE   1                                                        3LL00040
*   CALLING SEQUENCE                                                    3LL00050
*      TSX     .CCDTY,4                                                 3LL00060
*      PZE     FILE                                                     3LL00070
*      FILE IS ATTACHED TO CARD RETURN.                                 3LL00080
*      FILE IS ATTACHED TO TAPE RETURN.                                 3LL00090
       SPACE   1                                                        3LL00100
*   WHERE FILE IS THE LOCATION OF THE IOBS FILE BLOCK                   3LL00110
*   NOTE THAT SENSE INDICATORS ARE DESTROYED, AND ALSO THAT THE         3LL00120
*   RETURN POINT IS UNPREDICTABLE WHEN THERE IS NO UNIT ATTACHED (NONE).3LL00130
       ENTRY   .CCDTY                                                   3LL00140
.CCDTY SXA     CCDTY1,4            SAVE XR4                             3LL00150
       CAL*    1,4                 GET 1RST WORD OF FILE BLOCK          3LL00160
       PAC     0,4                 GET -L(UNIT BLOCK) TO XR4            3LL00170
       LDI     0,4                 GET FIRST WORD OF UNIT BLOCK         3LL00180
CCDTY1 AXT     **,4                RELOAD XR4 TO RETURN                 3LL00190
       LFT     020000              IS THIS INTERFACE CHANNEL            3LL00200
       TRA     3,4                 YES, NOT CARD EQUIPMENT              3LL00210
       LNT     000100              NO, TEST IF CARD EQUIPMENT           3LL00220
       TRA     3,4                 NO, GO TO TAPE RETURN                3LL00230
       TRA     2,4                 YES GO TO CARD RETURN                3LL00240
       END     .CCDTY                                                   3LL00250
$IBMAP CFPAK   ADDREL                                                   3LM00000
       LBL     FPAK,BEGIN     CFPAK                                  (7)3LM00010
       TTL     CFPAK - COBOL CONVERSION ROUTINE                     (14)3LM00015
MOVOVF EQU     .COFLO                                                   3LM00020
MOVERR PZE     **                                                       3LM00030
APOINT EQU     .CAREF                                                   3LM00040
BPOINT EQU     .CBREF                                                   3LM00050
MOVUNF EQU     .CUFLO                                                   3LM00060
 MOVX4 EQU     .CX4                                                     3LM00070
MVPKXT EQU     .CXIT                                                    3LM00080
 MOVX1 EQU     .CXIT+1                                                  3LM00090
 MOVX2 EQU     .CXIT+2                                                  3LM00100
MOVXIT EQU     .CXIT+1                                                  3LM00110
*SOURCE FIELD OF ZERO                                                   3LM00120
*                                                                       3LM00130
MOVZER CLA     MOVT1                                                    3LM00140
       STO     MOVT2                                                    3LM00150
       LDQ     MOVT2                                                    3LM00160
       STZ     SWFF                                                     3LM00170
       ZET     SWXF                                                     3LM00180
       TRA     MOVXF                                                    3LM00190
       NZT     SWXI                                                     3LM00200
       TRA     MOVXS                                                    3LM00210
       STZ     SWXI                                                     3LM00220
       TXI     MOVXIT,4,-1                                              3LM00230
*SOURCE FIELD OF INTERNAL DECIMAL                                       3LM00240
*                                                                       3LM00250
*      CALLING SEQUENCE                                                 3LM00260
*                                                                       3LM00270
*      TRA     .CIDSD                                                   3LM00280
*      P       S.SCL,,S.NL                                              3LM00290
*      P       T.SCL,T.SC,T.TL                                          3LM00300
*      CALLING SEQUENCE                                                 3LM00310
*                                                                       3LM00320
*      TSX     .CIDF2,4                                                 3LM00330
*      P       S.SCL,,S.NL                                              3LM00340
*                                                                       3LM00350
       ENTRY   .CIDF2                                                   3LM00360
.CIDF2 STL     SWFF                                                     3LM00370
       ENTRY   .CIDF1                                                   3LM00380
.CIDF1 STL     SWXF                TARGET FIELD IS INTERNAL FLOATING    3LM00390
       SXA     MOVX1,1             SAVE INDEX REGISTERS                 3LM00400
       SXA     MOVX2,2                                                  3LM00410
       STI     SAVIND                                                (4)3LM00411
       ENTRY   .CIDSD                                                   3LM00420
.CIDSD LDI     1,4                 SPECIFICATIONS OF SOURCE FIELD       3LM00430
       TXI     *+1,4,-1            ADJUST X4 TO NEXT PARAMETER          3LM00440
       SXA     MOVX4,4                                                  3LM00450
       STI     MOVT1                                                    3LM00460
       RIL     377777                                                   3LM00470
       IIL     400000              -S.SCL                               3LM00480
       STI     MOVDS                                                    3LM00490
       LXD     MOVT1,1             S.NL                                 3LM00500
 MV800 TSX     MOVNRM,4                                                 3LM00510
       LXA     MOVX4,4                                                  3LM00520
       TZE     MOVZER+1                                                 3LM00530
       ZET     SWXF                                                     3LM00540
       TRA     MOVXF               TARGET IS INTERNAL FLOATING          3LM00550
       STO     MOVT1                                                    3LM00560
       PXA     0,1                                                      3LM00570
       ADD     MOVDS                                                    3LM00580
       STO     MOVXP                                                    3LM00590
       PXA     0,1                                                      3LM00600
       SSM                                                              3LM00610
       STO     MOVDS                                                    3LM00620
       TRA     MOVXS+1             TARGET FIELD IS SCIENTIFIC DECIMAL   3LM00630
 MV805 AXC     MV800,4                                                  3LM00640
       TRA     MV905                                                    3LM00650
*SOURCE FIELD OF INTERNAL FLOATING                                      3LM00660
*                                                                       3LM00670
*      CALLING SEQUENCE                                                 3LM00680
*                                                                       3LM00690
*      TSX     .CF2ID,4                                                 3LM00700
*      P       T.SCL,,T.NL                                              3LM00710
*                                                                       3LM00720
*      CALLING SEQUENCE                                                 3LM00730
*                                                                       3LM00740
*      TRA     .CF1SD                                                   3LM00750
*      P       T.SCL,T.SC,T.TL                                          3LM00760
*                                                                       3LM00770
       ENTRY   .CF2ID                                                   3LM00780
.CF2ID STL     SWXI                                                     3LM00790
       SXA     MOVX1,1                                                  3LM00800
       SXA     MOVX2,2                                                  3LM00810
       ENTRY   .CF2SD                                                   3LM00820
.CF2SD STL     SWFF                                                     3LM00830
       STQ     MOVT2                                                    3LM00840
       TRA     .CF1SD+1                                                 3LM00850
       ENTRY   .CF1ID                                                   3LM00860
.CF1ID STL     SWXI                                                     3LM00870
       SXA     MOVX1,1                                                  3LM00880
       SXA     MOVX2,2                                                  3LM00890
       ENTRY   .CF1SD                                                   3LM00900
.CF1SD LDQ     MVD00               L(0)                                 3LM00910
       SXA     MOVX4,4                                                  3LM00920
       TZE     MOVZER+1                                                 3LM00930
       LRS     27                                                       3LM00940
       STQ     MOVT1                                                    3LM00950
       PAX     0,2                 MOVBS=128+B                          3LM00960
       PXA     0,2                                                      3LM00970
       SUB     MVD05               128B35                               3LM00980
       TZE     MV701                                                    3LM00990
       XCA                                                              3LM01000
       VLM     MVD03,,7            L(-.30103B12)                        3LM01010
       TMI     *+2                 MOVDS AT BS=19                       3LM01020
       ADD     MVD06               L(1B19)                              3LM01030
       ARS     16                                                       3LM01040
 MV701 STO     MOVDS               -DS AT BS=35                         3LM01050
       CHS                                                              3LM01060
       STO     MOVXP                                                    3LM01070
       ZET     SWFF                                                     3LM01080
       TXI     MV700,2,1                                                3LM01090
       CLA     MOVT1                                                    3LM01100
       LDQ     MVD00               L(0)                                 3LM01110
       LRS     1                                                        3LM01120
       TXI     MOVXS,2,1                                                3LM01130
 MV700 STZ     SWFF                                                     3LM01140
       LDQ     MOVT2                                                    3LM01150
       LLS     8                                                        3LM01160
       CLA     MOVT1                                                    3LM01170
       ARS     8                                                        3LM01180
       LRS     0                                                        3LM01190
       LLS     7                                                        3LM01200
       TRA     MOVXS                                                    3LM01210
*SOURCE FIELD OF SCIENTIFIC DECIMAL                                     3LM01220
*                                                                       3LM01230
*      SENSE INDICATOR USAGE                                            3LM01240
*      BIT 0   400000    IF 1, DECIMAL POINT IN WORD 1                  3LM01250
*          1   200000    IF 1, DECIMAL POINT IN WORD 2                  3LM01260
*          2   100000    IF 1, DECIMAL POINT HAS APPEARED               3LM01270
*          3   040000    IF 1, SIGN HAS APPEARED                        3LM01280
*          4   020000    IF 1, LEADING ZERO HAS APPEARED                3LM01290
*          5   010000    IF 1, CONVERTING EXPONENT                      3LM01300
*          6   004000    IF 1, END OF FIELD HAS BEEN ENCOUNTERED        3LM01310
*      CALLING SEQUENCE                                                 3LM01320
*                                                                       3LM01330
*      TRA     .CSDID                                                   3LM01340
*      P       S.SCL,S.SC,S.TL                                          3LM01350
*      P       T.SCL,,T.NL                                              3LM01360
*                                                                       3LM01370
       ENTRY   .CSDID                                                   3LM01380
.CSDID STL     SWXI                                                     3LM01390
       TRA     .CSDSD                                                   3LM01400
*      CALLING SEQUENCE                                                 3LM01410
*                                                                       3LM01420
*      TRA     .CSDF1                                                   3LM01430
*      P       S.SCL,S.SC,S.TL                                          3LM01440
*                                                                       3LM01450
       ENTRY   .CSDF2                                                   3LM01460
.CSDF2 STL     SWFF                                                     3LM01470
       ENTRY   .CSDF1                                                   3LM01480
.CSDF1 STL     SWXF                                                     3LM01490
*      CALLING SEQUENCE                                                 3LM01500
*                                                                       3LM01510
*      TRA     .CSDSD                                                   3LM01520
*      P       S.SCL,S.SC,S.TL                                          3LM01530
*      P       T.SCL,T.SC,T.TL                                          3LM01540
*                                                                       3LM01550
       ENTRY   .CSDSD                                                   3LM01560
.CSDSD LDQ*    APOINT                                                   3LM01570
       LDC     APOINT,1                                                 3LM01580
       TXI     *+1,1,6             NO. OF REMAINING BYTES               3LM01590
       SXD     MV301,1                                                  3LM01600
       XEC     RQL1,1                                                   3LM01610
       CAL     1,4                 SPECIFICATIONS OF SOURCE FIELD       3LM01620
       TXI     *+1,4,-1            ADJUST X4                            3LM01630
       SXA     MOVX4,4                                                  3LM01640
       PDX     0,4                 S.TL                                 3LM01650
       STZ     MOVDS                                                    3LM01660
       STZ     MOVPT                                                    3LM01670
       STZ     MOVT2                                                    3LM01680
       PBT                                                              3LM01690
       STA     MOVDS               S.SCL FOR IMPLIED POINT              3LM01700
       SXA     MV501,4                                                  3LM01710
 MV301 TXL     *+2,4,0                                                  3LM01720
       LXD     *-1,4                                                    3LM01730
       SXD     MV501+1,4                                                3LM01740
       PXD     0,0                                                      3LM01750
       LDI     MVD10               200000000000                         3LM01760
       AXT     10,2                                                     3LM01770
       TSX     MOVCV1,1                                                 3LM01780
       TRA     MV305               END OF FIELD                         3LM01790
       STO     MOVT1                                                    3LM01800
       ZET     MOVPT                                                    3LM01810
       IIL     600000                                                   3LM01820
       TXH     MV302,1,MVXXX+11    TERMINATOR                           3LM01830
       AXT     10,2                                                     3LM01840
       TZE     MV307                                                    3LM01850
       CLM                                                              3LM01860
       ORA     MVD11               MZE                                  3LM01870
       TSX     MV310,1                                                  3LM01880
       TRA     MV305+1             END OF FIELD                         3LM01890
       STO     MOVT2                                                    3LM01900
 MV302 RIL     060000                                                   3LM01910
       SIL     010000                                                   3LM01920
       PXD     0,0                                                      3LM01930
       TXL     MV303,1,MVXXX+11                                         3LM01940
       AXC     MV303+1,2           TERMINATOR                           3LM01950
       SXA     MV503,2             SETUP RETURN                         3LM01960
       TXI     MV500+1,2,MV303+3   SET X2=2                             3LM01970
 MV303 AXT     2,2                                                      3LM01980
       TSX     MOVCV1,1                                                 3LM01990
       TRA     MV308               END OF FIELD                         3LM02000
       TXH     MV308,1,MVXXX+11    TERMINATOR                           3LM02010
       SUB     MOVPT                                                    3LM02020
 MV306 LXA     MOVX4,4                                                  3LM02030
       NZT     MOVT1                                                    3LM02040
       TRA     MOVZER                                                   3LM02050
       LNT     400000                                                   3LM02060
       ADD     TAB11+8             L(10B35)                             3LM02070
       ZET     MOVT2                                                    3LM02080
       SUB     TAB11+8             L(10B35)                             3LM02090
       LNT     100000                                                   3LM02100
       SUB     MOVDS                                                    3LM02110
       STO     MOVDS               ADJUSTED MOVDS                       3LM02120
       NZT     MOVT2                                                    3LM02130
       TRA     MV304                                                    3LM02140
       LDQ     MOVT1                                                    3LM02150
       TSX     MOVMPY,1            (10**10)*MOVT1+MOVT2                 3LM02160
       AXT     128+70,2            MOVBS=BS+128                         3LM02170
       AXT     20,1                                                     3LM02180
       TRA     MV309                                                    3LM02190
*                                                                       3LM02200
 MV304 CLA     MOVT1                                                    3LM02210
       LDQ     MVD00                                                    3LM02220
       LRS     0                                                        3LM02230
       AXT     128+35,2                                                 3LM02240
       AXT     10,1                                                     3LM02250
 MV309 NZT     SWXI                                                     3LM02260
       TRA     MV805                                                    3LM02270
       SXA     MOVNL,1                                                  3LM02280
       TRA     MOVXI               TARGET FIELD IS INTERNAL DECIMAL     3LM02290
*                                                                       3LM02300
 MV305 IIL     600000                                                   3LM02310
       XEC     2,2                 STO                                  3LM02320
       CLS     MOVPT                                                    3LM02330
       TRA     MV306                                                    3LM02340
*                                                                       3LM02350
 MV307 TSX     MV310,1                                                  3LM02360
       TRA     MV305+1             END OF FIELD                         3LM02370
       STO     MOVT1                                                    3LM02380
       TRA     MV302                                                    3LM02390
*                                                                       3LM02400
 MV308 TZE     MV306-1                                                  3LM02410
       XCA                                                              3LM02420
       VLM     MVD04,,7            L(.1B27)                             3LM02430
       LRS     1                                                        3LM02440
       RND                                                              3LM02450
       TRA     MV306-1                                                  3LM02460
*                                                                       3LM02470
 MV310 SXA     MV503,1                                                  3LM02480
       TRA     MV501-1                                                  3LM02490
*TARGET FIELD OF INTERNAL FLOATING                                      3LM02500
*      INTERMEDIATE RESULT LEFT IN AC AND MQ WITH THE MOST SIGNIFICANT  3LM02510
*      BIT IN POSITION 2 OF AC                                          3LM02520
*      X2=128+BS                                                        3LM02530
*      MOVDS=SCALING FACTOR                                             3LM02540
*                                                                       3LM02550
MOVXF  STZ     SWXF                                                     3LM02560
       TZE     MOVIND+1                                              (4)3LM02570
       SXA     MOVX4,4                                                  3LM02580
       LFTM                                                             3LM02590
       ZET     SWFF                                                     3LM02600
       TRA     MV104               DOUBLE PRECISION                     3LM02610
*SINGLE PRECISION                                                       3LM02620
*                                                                       3LM02630
       TSX     MOVSC1,1                                                 3LM02640
       TXH     MV107,2,255         OVERFLOW OR UNDERFLOW                3LM02650
       XCA                         FRACTION INTO MQ                     3LM02660
       PXA     0,2                 CHARACTERISTIC                       3LM02670
       LLS     27                  FORM FLOATING POINT NUMBER           3LM02680
       RQL     28                                                       3LM02690
       TOV     *+1                                                      3LM02700
       FRN                                                              3LM02710
       TNO     MV100                                                    3LM02720
       TRA     MV106               OVERFLOW                             3LM02730
*DOUBLE PRECISION                                                       3LM02740
*                                                                       3LM02750
 MV104 STZ     SWFF                                                     3LM02760
       TSX     MOVSC2,1                                                 3LM02770
       TXH     MV107,2,255         OVERFLOW OR UNDERFLOW                3LM02780
       STQ     MOVT2                                                    3LM02790
       XCA                                                              3LM02800
       PXA     0,2                                                      3LM02810
       LLS     27                  FORM FLOATING POINT NUMBER           3LM02820
       TXI     *+1,2,-27                                                3LM02830
       TXL     MV105,2,256                                              3LM02840
       RQL     28                  PART2 UNDERFLOW                      3LM02850
       FRN                                                              3LM02860
       LDQ     MVD00               L(0)                                 3LM02870
       LRS     0                                                        3LM02880
       TRA     MV100                                                    3LM02890
 MV105 STO     MOVT1                                                    3LM02900
       PXA     0,2                 FORM PART2                           3LM02910
       LLS     8                                                        3LM02920
       LDQ     MOVT2                                                    3LM02930
       LLS     19                                                       3LM02940
       RQL     28                                                       3LM02950
       TOV     *+1                                                      3LM02960
       FRN                                                              3LM02970
       FAD     MOVT1               ADD PART1 TO PART2                   3LM02980
       TNO     MV100                                                    3LM02990
 MV106 STL     MOVOVF              OVERFLOW                             3LM03000
       CLM                                                              3LM03010
       ORA     MVD01               377777777777                         3LM03020
       LDQ     MVD02               344777777777                         3LM03030
       TRA     MV105-2                                                  3LM03040
 MV107 TXL     MV106,2,4096        OVERFLOW                             3LM03050
       STL     MOVUNF              UNDERFLOW                            3LM03060
       MPY     MVD00               L(0)                                 3LM03070
 MV100 EFTM                                                             3LM03080
MOVIND LXA     MOVX4,4                                               (4)3LM03090
       LDI     SAVIND                                                (4)3LM03091
       TRA     MOVXIT                                                (4)3LM03092
SAVIND PZE     **                                                    (4)3LM03093
*TARGET FIELD OF SCIENTIFIC DECIMAL                                     3LM03100
*      INTERMEDIATE RESULT LEFT IN AC AND MQ WITH THE MOST SIGNIFICANT  3LM03110
*      BIT IN POSITION 2 OF AC                                          3LM03120
*      X2=128+BS                                                        3LM03130
*      MOVDS=SCALING FACTOR                                             3LM03140
*      MOVXP=DECIMAL EXPONENT OR ITS APPROXIMATION FOR NORMALIZED       3LM03150
*              DECIMAL FRACTION AFTER SCALING                           3LM03160
*                                                                       3LM03170
MOVXS  STO     MOVT1                                                    3LM03180
       ZET     SWXI                                                     3LM03190
       TRA     MV201                                                    3LM03200
       CLA     1,4                 SPECIFICATIONS OF TARGET FIELD       3LM03210
       TXI     *+1,4,-1            ADJUST X4 AND STORE                  3LM03220
       SXA     MOVX4,4                                                  3LM03230
       STO     MOVPT                                                    3LM03240
       PDX     0,1                 T.TL                                 3LM03250
       ALS     1                                                        3LM03260
       STT     MV211               T.SC                                 3LM03270
       TMI     *+2                                                      3LM03280
       TIX     MV201+1,1,4                                              3LM03290
       TIX     MV201+1,1,5                                              3LM03300
       AXT     1,1                                                      3LM03310
       TRA     MV201+1                                                  3LM03320
*DUMMY INTERMEDIATE TARGET FIELD SPECIFICATIONS FOR INTERNAL DECIMAL    3LM03330
*                                                                       3LM03340
 MV201 AXT     20,1                DUMMY T.NL=20 FOR MOVFI              3LM03350
       SXA     MOVNL,1                                                  3LM03360
       NZT     MOVT1                                                    3LM03370
       TRA     MV212                                                    3LM03380
       TXH     MV206,1,10          T.NL IS GREATER THAN 10              3LM03390
       PXA     0,1                                                      3LM03400
       ADD     MOVDS               T.NL-DS                              3LM03410
       STO     MOVDS                                                    3LM03420
       CLA     MOVT1                                                    3LM03430
       TXL     *+3,1,8                                                  3LM03440
       TSX     MOVSC2,1                                                 3LM03450
       TRA     *+2                                                      3LM03460
       TSX     MOVSC1,1                                                 3LM03470
       LXA     MOVNL,1                                                  3LM03480
       TNX     MV202,2,128+35                                           3LM03490
       SXA     *+1,2                                                    3LM03500
       LLS     0                                                        3LM03510
       ACL     TAB15+9             L(5B35)                              3LM03520
       TRA     MV203                                                    3LM03530
 MV202 LRS     128+35,2                                                 3LM03540
       RND                                                              3LM03550
       LAS     TAB11+9,1                                                3LM03560
       TRA     *+4                                                      3LM03570
       TRA     *+3                                                      3LM03580
       STO     MOVT1                                                    3LM03590
       TRA     MV209+1                                                  3LM03600
       RQL     1                                                        3LM03610
       TQP     MV202-2                                                  3LM03620
       ACL     TAB14+9             L(4B35)                              3LM03630
 MV203 LRS     35                                                       3LM03640
       DVP     TAB11+8             L(10B35)                             3LM03650
       CLA     TAB11+9             L(1B35)                              3LM03660
       ADD     MOVXP                                                    3LM03670
       STO     MOVXP               ADJUST EXPONENT                      3LM03680
 MV209 STQ     MOVT1                                                    3LM03690
       CLA     MOVPT               TARGET FIELD SPECIFICATIONS          3LM03700
       TMI     *+2                                                      3LM03710
       STZ     MOVPT                                                    3LM03720
       ANA     MVD12                                                    3LM03730
       ADD     MOVXP                                                    3LM03740
       SUB     MOVNL               ADJUST EXPONENT                      3LM03750
       TXL     *+2,1,10                                                 3LM03760
       NZT     MOVT2                                                    3LM03770
       ZET     MOVT1                                                    3LM03780
       TRA     *+2                                                      3LM03790
       PXD     0,0                                                      3LM03800
       STO     MOVXP                                                    3LM03810
       AXT     0,2                                                      3LM03820
       AXT     0,4                                                      3LM03830
       LDI     MV211                                                    3LM03840
       RNT     600000                                                   3LM03850
       TRA     MV211                                                    3LM03860
       AXT     1,2                                                      3LM03870
       AXT     1,4                                                      3LM03880
       TRA     *+2                                                      3LM03890
MV211  AXT     1,**                                                     3LM03900
       LDI     MOVT1                                                    3LM03910
       TPL     *+2                                                      3LM03920
       AXT     2,2                                                      3LM03930
       CAL     MVD13+2,2                                                3LM03940
       SLW     MOVT1               SIGN OF EXPONENT                     3LM03950
       TQP     *+2                                                      3LM03960
       AXT     2,4                                                      3LM03970
       CAL     MVD13+2,4                                                3LM03980
       LAC     BPOINT,2            TARGET WORD                          3LM03990
       LDC     BPOINT,4                                                 3LM04000
       TXI     *+1,4,6             NO. OF BYTES REMAINING IN WORD       3LM04010
       TNX     MV210,1,10          T.NL IS GREATER THAN 10              3LM04020
       LXA     MOVPT,2                                                  3LM04030
       SXA     MV205,0                                                  3LM04040
       TIX     MV207,2,10          DECIMAL POINT IN WORD1               3LM04050
       ZET     MOVPT                                                    3LM04060
       TXI     *+1,2,100                                                3LM04070
       SXA     MV205,2             DECIMAL POINT IN WORD2               3LM04080
       STZ     MOVPT                                                    3LM04090
 MV208 LAC     BPOINT,2            RELOAD TARGET POINTER                3LM04100
       STL     MV012                                                    3LM04110
       AXT     *+2,0                                                    3LM04120
       TRA     MOVCV2              STORE WORD1                          3LM04130
MV205  AXT     0,1                                                      3LM04140
       TXL     *+4,1,0                                                  3LM04150
       SXD     MOVPT,1                                                  3LM04160
       TXI     *+1,1,-100                                               3LM04170
       SXA     MOVPT,1                                                  3LM04180
       PXD     0,0                                                      3LM04190
       LDI     MOVT2                                                    3LM04200
       AXT     10,1                                                     3LM04210
 MV210 STL     MV012               STORE WORD2                          3LM04220
       AXT     *+2,0                                                    3LM04230
       TRA     MOVCV2                                                   3LM04240
       CAL     MOVT1                                                    3LM04250
       LDI     MOVXP                                                    3LM04260
       AXT     2,1                                                      3LM04270
       STL     MV012                                                    3LM04280
       AXT     MVPKXT,0                                                 3LM04290
       TRA     MOVCV2              STORE EXPONENT                       3LM04300
*                                                                       3LM04310
 MV207 SXA     MOVPT,2                                                  3LM04320
       TRA     MV208                                                    3LM04330
*                                                                       3LM04340
 MV206 CLA     MOVT1                                                    3LM04350
       TSX     MOVSC2,1                                                 3LM04360
       LXA     MOVNL,4             T.NL                                 3LM04370
       TXL     MV204,2,127         LESS THAN .5                         3LM04380
       STO     MOVT1                                                    3LM04390
       TXH     MV200,2,128         GREATER THAN 1                       3LM04400
       STQ     MOVT2                                                    3LM04410
       CAL     TAB21+11,4                                               3LM04420
       ARS     18                                                       3LM04430
       STA     *+2                                                      3LM04440
       CAL     MVD01               ONES                                 3LM04450
       LLS     0                                                        3LM04460
       ANA     MOVT1                                                    3LM04470
       ANA     MVD01                                                    3LM04480
       RND                                                              3LM04490
       LDQ     MOVT2                                                    3LM04500
       PBT                                                              3LM04510
       TRA     MV204-1                                                  3LM04520
 MV200 TXI     *+1,4,-1            GREATER THAN OR EQUAL TO 1           3LM04530
       CLA     TAB11+9             1B35                                 3LM04540
       ADD     MOVXP                                                    3LM04550
       STO     MOVXP                                                    3LM04560
       CLA     MOVT1                                                    3LM04570
 MV204 TSX     MV403-1,1                                                3LM04580
       TSX     MOVRND,1                                                 3LM04590
       ZET     SWXI                                                     3LM04600
       TRA     MV607                                                    3LM04610
       DVP     TAB11-1             L(10**10B35)                         3LM04620
       STO     MOVT2                                                    3LM04630
       LXA     MOVNL,1                                                  3LM04640
       TRA     MV209                                                    3LM04650
*                                                                       3LM04660
 MV212 NZT     SWXI                                                     3LM04670
       TRA     MV209+1                                                  3LM04680
       TRA     MV607+1                                                  3LM04690
*TARGET FIELD OF INTERNAL DECIMAL                                       3LM04700
*      INTERMEDIATE RESULT LEFT IN AC AND MQ WITH THE MOST SIGNIFICANT  3LM04710
*      BIT IN POSITION 2 OF AC                                          3LM04720
*      X2=128+BS                                                        3LM04730
*      MOVDS=SCALING FACTOR                                             3LM04740
*                                                                       3LM04750
 MV607 STO     MOVT1                                                    3LM04760
       CLA     MOVXP                                                    3LM04770
       SUB     MOVNL                                                    3LM04780
       STO     MOVDS                                                    3LM04790
       CLA     MOVT1                                                    3LM04800
       AXT     128+70,2                                                 3LM04810
       LXA     MOVX4,4                                                  3LM04820
MOVXI  STZ     SWXI                                                     3LM04830
       STO     MOVT1                                                    3LM04840
       CLA     1,4                                                      3LM04850
       TXI     *+1,4,-1                                                 3LM04860
       SXA     MOVX4,4                                                  3LM04870
       STO     MOVT2                                                    3LM04880
       SXD     MOVT2,0             T.SCL                                3LM04890
       PDX     0,1                 T.NL                                 3LM04900
       CLA     MOVT2                                                    3LM04910
       ADD     MOVDS                                                    3LM04920
       STO     MOVDS               D.SCL=T.SCL-S.SCL                    3LM04930
       PXA     0,1                                                      3LM04940
       SUB     MOVDS               T.NL-D.SCL                           3LM04950
       TZE     MV606                                                    3LM04960
       TMI     MV606                                                    3LM04970
       PAX     0,4                                                      3LM04980
       SUB     MOVNL               D.NL=(T.NL-D.SCL)-S.NL               3LM04990
       TPL     MV604                                                    3LM05000
       CLA     MOVDS                                                    3LM05010
       TZE     MV602                                                    3LM05020
       TPL     MV602                                                    3LM05030
       CLA     MOVT1                                                    3LM05040
       SXA     *+2,1                                                    3LM05050
       TSX     MOVSC3,1                                                 3LM05060
       AXT     0,4                                                      3LM05070
       TSX     MOVMOD,1                                                 3LM05080
       LXA     *-2,1                                                    3LM05090
       TXH     MVPKXT,1,10                                              3LM05100
       XCA                                                              3LM05110
       TRA     MVPKXT                                                   3LM05120
*                                                                       3LM05130
 MV602 CLA     MOVT1                                                    3LM05140
       SXA     MV609,1                                                  3LM05150
       SXA     MV611,4                                                  3LM05160
       LXA     MOVNL,1                                                  3LM05170
       TXL     MV601,1,10                                               3LM05180
       TSX     MOVMOD,1                                                 3LM05190
       LXA     MV611,1                                                  3LM05200
       TXH     MV611+1,1,10                                             3LM05210
       XCA                                                              3LM05220
       TXI     MV611+1,2,-35                                            3LM05230
 MV601 LRS     35                                                       3LM05240
       DVP     TEN2,4                                                   3LM05250
       TSX     MV608,1                                                  3LM05260
MV611  AXT     0,1                                                      3LM05270
       TSX     MOVNRM,4                                                 3LM05280
       TZE     MVPKXT                                                   3LM05290
MV609  AXT     0,1                                                      3LM05300
       TXH     MV603,1,10                                               3LM05310
       TXL     *+3,1,9                                                  3LM05320
       TSX     MOVSC2,1                                                 3LM05330
       TRA     *+2                                                      3LM05340
       TSX     MOVSC1,1                                                 3LM05350
       TXH     MV610,2,128+35                                           3LM05360
       LRS     128+35,2                                                 3LM05370
       RND                                                              3LM05380
       TRA     MVPKXT                                                   3LM05390
*                                                                       3LM05400
 MV603 TSX     MOVSC3,1                                                 3LM05410
       TRA     MVPKXT                                                   3LM05420
*                                                                       3LM05430
 MV604 CLA     MOVT1                                                    3LM05440
       SXA     MV609,1                                                  3LM05450
       LXA     MOVNL,1                                                  3LM05460
       TRA     MV611+1                                                  3LM05470
*                                                                       3LM05480
 MV606 XCL                                                              3LM05490
       ORA     MOVT1                                                    3LM05500
       ORS     MOVOVF                                                   3LM05510
       XCL                                                              3LM05520
 MV610 MPY     MVD00                                                    3LM05530
       TRA     MVPKXT                                                   3LM05540
*                                                                       3LM05550
 MV608 XCA                                                              3LM05560
       ORS     MOVOVF                                                   3LM05570
       CLM                                                              3LM05580
       XCA                                                              3LM05590
       TRA     1,1                                                      3LM05600
*MODULO 10**N OF INTEGER IN AC AND MQ                                   3LM05610
*                                                                       3LM05620
*      CALLING SEQUENCE                                                 3LM05630
*                                                                       3LM05640
*      TSX     MOVMOD,1                                                 3LM05650
*              UPON ENTRY, X4=N                                         3LM05660
*                                                                       3LM05670
MOVMOD TNX     MV650,4,10                                               3LM05680
       DVP     TEN2-10             L(10**10)                            3LM05690
       STO     MOVT2                                                    3LM05700
       CLM                                                              3LM05710
       DVP     TEN2,4                                                   3LM05720
       STQ     MOVOVF                                                   3LM05730
       XCA                                                              3LM05740
MOVMPY MPY     TEN2-10             (10**10)MOVT1+MOVT2                  3LM05750
       STO     MOVT1                                                    3LM05760
       XCA                                                              3LM05770
       ADD     MOVT2                                                    3LM05780
       LRS     35                                                       3LM05790
       ADD     MOVT1                                                    3LM05800
       TRA     1,1                                                      3LM05810
 MV650 STQ     MOVT2                                                    3LM05820
       LRS     35                                                       3LM05830
       DVP     TEN2,4                                                   3LM05840
       XCA                                                              3LM05850
       ORS     MOVOVF                                                   3LM05860
       XCA                                                              3LM05870
       LDQ     MOVT2                                                    3LM05880
       DVP     TEN2,4                                                   3LM05890
       XCA                                                              3LM05900
       ORS     MOVOVF                                                   3LM05910
       CLM                                                              3LM05920
       TRA     1,1                                                      3LM05930
*SCALING ROUTINE                                                        3LM05940
*      CALLING SEQUENCE                                                 3LM05950
*                                                                       3LM05960
*      TSX     MOVSC1,1  (MOVSC2)                                       3LM05970
*                                                                       3LM05980
*      AC=WORD1                                                         3LM05990
*      MQ=WORD2 IF DOUBLE PRECISION                                     3LM06000
*      X2=BS+128                                                        3LM06010
*      MOVDS=DECIMAL SCALE TO BE USED                                   3LM06020
*                                                                       3LM06030
MOVSC1 LXA     MOVDS,4                                                  3LM06040
       TXL     MV400,4,0                                                3LM06050
       LDI     MOVDS                                                    3LM06060
       LFT     400000              TEST SIGN OF MOVDS                   3LM06070
       TRA     MV402                                                    3LM06080
 MV408 XCA                                                              3LM06090
       TNX     MV407,4,15                                               3LM06100
       MPY     TEN1-15             (10**15)B50                          3LM06110
       TXI     MV408,2,50                                               3LM06120
 MV407 MPY     TEN1,4                                                   3LM06130
       XEC     TXI1,4                                                   3LM06140
 MV400 TNZ     *+4                                                      3LM06150
       XCA                                                              3LM06160
       TZE     1,1                                                      3LM06170
       TXI     *+1,2,-35                                                3LM06180
       LDI     MVD10               200000000000                         3LM06190
       TIF     *+2                 NORMALIZE NUMBER                     3LM06200
       TRA     1,1                                                      3LM06210
 MV401 LLS     1                                                        3LM06220
       TXI     *-3,2,-1                                                 3LM06230
 MV402 TNX     MV406,4,15                                               3LM06240
       DVP     TEN1-15                                                  3LM06250
       XCA                                                              3LM06260
       LDI     MVD10                                                    3LM06270
       TIF     *+3                                                      3LM06280
       LRS     1                                                        3LM06290
       TXI     MV402,2,-49                                              3LM06300
       TXI     MV402,2,-50                                              3LM06310
 MV406 DVP     TEN1,4                                                   3LM06320
       CLM                                                              3LM06330
       XCA                                                              3LM06340
       XEC     TXI2,4                                                   3LM06350
*                                                                       3LM06360
MOVSC2 LXA     MOVDS,4                                                  3LM06370
       TXL     MV400,4,0                                                3LM06380
       LDI     MOVDS                                                    3LM06390
       LFT     400000                                                   3LM06400
       TRA     MV404                                                    3LM06410
       LDI     TEN1-15                                                  3LM06420
 MV403 TXL     *+2,4,15                                                 3LM06430
       TXI     *+2,2,50                                                 3LM06440
       LDI     TEN1,4                                                   3LM06450
       STI     MOVT2                                                    3LM06460
       STO     MOVT1                                                    3LM06470
       MPY     MOVT2                                                    3LM06480
       LDQ     MOVT1                                                    3LM06490
       STO     MOVT1                                                    3LM06500
       MPY     MOVT2                                                    3LM06510
       XCA                                                              3LM06520
       ADD     MOVT1                                                    3LM06530
       STQ     MOVT1                                                    3LM06540
       LRS     35                                                       3LM06550
       ADD     MOVT1                                                    3LM06560
       TIX     MV403,4,15                                               3LM06570
       XEC     TXI1,4                                                   3LM06580
 MV404 TNX     MV405,4,15                                               3LM06590
       DVP     TEN1-15                                                  3LM06600
       STQ     MOVT1                                                    3LM06610
       DVP     TEN1-15                                                  3LM06620
       CLA     MOVT1                                                    3LM06630
       LDI     MVD10                                                    3LM06640
       TIF     *+3                                                      3LM06650
       LRS     1                                                        3LM06660
       TXI     MV404,2,-49                                              3LM06670
       TXI     MV404,2,-50                                              3LM06680
 MV405 DVP     TEN1,4                                                   3LM06690
       STQ     MOVT1                                                    3LM06700
       DVP     TEN1,4                                                   3LM06710
       CLA     MOVT1                                                    3LM06720
       XEC     TXI2,4                                                   3LM06730
*SCALE AND ROUND DOUBLE PRECISION NUMBER                                3LM06740
*                                                                       3LM06750
MOVSC3 SXA     *+2,1                                                    3LM06760
       TSX     MOVSC2,1                                                 3LM06770
       AXT     0,1                                                      3LM06780
       TXL     *+3,2,128+70                                             3LM06790
       MPY     MVD00                                                    3LM06800
       TRA     1,1                                                      3LM06810
       TXH     *-1,2,128+69                                             3LM06820
MOVRND LRS     128+69,2            BS AT 69                             3LM06830
       STO     MOVT1                                                    3LM06840
       STQ     MOVT2                                                    3LM06850
       XCA                                                              3LM06860
       LRS     1                                                        3LM06870
       RND                                                              3LM06880
       LRS     34                                                       3LM06890
       ADD     MOVT1                                                    3LM06900
       LRS     1                                                        3LM06910
       TRA     1,1                 BS=70                                3LM06920
*SCAN AND CONVERT BCD FIELD TO DECIMAL INTEGER                          3LM06930
*                                                                       3LM06940
*      CALLING SEQUENCE                                                 3LM06950
*                                                                       3LM06960
*      TSX     MOVCV1,1                                                 3LM06970
*                                                                       3LM06980
*      X4=REMAINING NO. OF CHARACTERS IN MQ                             3LM06990
*      X2=MAXIMUM NO. OF DIGITS TO BE CONVERTED                         3LM07000
*                                                                       3LM07010
MOVCV1 SXA     MV503,1                                                  3LM07020
 MV500 CRQ     TAB10,1,1                                                3LM07030
       XEC     TAB20+MVXXX,1       BRANCH ON CHARACTER                  3LM07040
       TNX     MV503,2,1           COUNT NO. OF DIGITS CONVERTED        3LM07050
       TIX     *-3,4,1             COUNT NO. OF CHARACTERS EXAMINED     3LM07060
MV501  AXT     0,4                                                      3LM07070
       TNX     MV508,4,0                                                3LM07080
       SXA     *-2,4                                                    3LM07090
       TXL     *+2,4,6                                                  3LM07100
       AXT     6,4                                                      3LM07110
       SXD     MV501+1,4                                                3LM07120
 MV502 LXA     APOINT,1            SOURCE FIELD POINTER                 3LM07130
       TXI     *+1,1,1                                                  3LM07140
       SXA     APOINT,1                                                 3LM07150
       LDQ*    APOINT                                                   3LM07160
       TRA     MV500                                                    3LM07170
MV503  AXT     0,2                                                      3LM07180
       TRA     2,2                 EXIT                                 3LM07190
* ILLEGAL CHARACTER                                                     3LM07200
*                                                                       3LM07210
 MV504 STL     MOVERR                                                   3LM07220
       TXI     MV500+1,1,-10                                            3LM07230
* LEADING ZERO                                                          3LM07240
*                                                                       3LM07250
 MV509 SIL     020000                                                   3LM07260
       LFT     010000                                                   3LM07270
       TRA     MV501-2                                                  3LM07280
       LXA     MOVPT,1                                                  3LM07290
       TXL     MV501-1,1,0                                              3LM07300
       TXI     *+1,1,1                                                  3LM07310
       SXA     MOVPT,1                                                  3LM07320
       TRA     MV501-1                                                  3LM07330
* DECIMAL POINT                                                         3LM07340
*                                                                       3LM07350
 MV505 LFT     110000                                                   3LM07360
       TRA     MV504                                                    3LM07370
       SXA     MOVPT,2                                                  3LM07380
       SIL     100000                                                   3LM07390
       TRA     MV501-1                                                  3LM07400
* PLUS OR MINUS                                                         3LM07410
*                                                                       3LM07420
 MV506 LFT     060000                                                   3LM07430
       TRA     MV508+1                                                  3LM07440
       LNT     010000                                                   3LM07450
       LNT     100000                                                   3LM07460
       TZE     *+MVXXX+15,1                                             3LM07470
       TRA     MV508+1                                                  3LM07480
       SSM                                                              3LM07490
       SIL     040000                                                   3LM07500
       TRA     MV501-1                                                  3LM07510
* BLANK                                                                 3LM07520
*                                                                       3LM07530
 MV507 LFT     010000                                                   3LM07540
       TRA     *+3                                                      3LM07550
       LFT     100000                                                   3LM07560
       TRA     MV508+1                                                  3LM07570
       LNT     020000                                                   3LM07580
       TZE     MV501-1             LEADING BLANK                        3LM07590
       TRA     *+2                                                      3LM07600
 MV508 SIL     004000              END OF FIELD                         3LM07610
       NZT     MOVPT               TERMINATOR                           3LM07620
       LFT     010000                                                   3LM07630
       TRA     *+2                                                      3LM07640
       SXA     MOVPT,2                                                  3LM07650
       LNT     004000                                                   3LM07660
       TRA     MV503                                                    3LM07670
       LXA     MV503,2                                                  3LM07680
       TRA     1,2                 END OF FIELD EXIT                    3LM07690
*                                                                       3LM07700
       TRA     MV507               14   BLANK                           3LM07710
       TRA     MV506               13   -                               3LM07720
       TRA     MV506               12   +                               3LM07730
       TRA     MV505               11   .                               3LM07740
       TRA     MV504               10   ILLEGAL CHARACTER               3LM07750
       ACL     TAB19+10,2          9                                    3LM07760
       ACL     TAB18+10,2          8                                    3LM07770
       ACL     TAB17+10,2          7                                    3LM07780
       ACL     TAB16+10,2          6                                    3LM07790
       ACL     TAB15+10,2          5                                    3LM07800
       ACL     TAB14+10,2          4                                    3LM07810
       ACL     TAB13+10,2          3                                    3LM07820
       ACL     TAB12+10,2          2                                    3LM07830
       ACL     TAB11+10,2          1                                    3LM07840
 TAB20 TZE     MV509               0                                    3LM07850
*CONVERT INTEGER IN SI TO BCD AND STORE RESULT AS SPECIFIED             3LM07860
*      CONVERTED FIELD MAY CONTAIN MAXIMUM OF 10 DIGITS, SIGN AND       3LM07870
*              DECIMAL POINT                                            3LM07880
*                                                                       3LM07890
*      CALLING SEQUENCE                                                 3LM07900
*                                                                       3LM07910
*      STL     MV012                                                    3LM07920
*      NOP     RETURN ADDRESS                                           3LM07930
*      TRA     MOVCV2                                                   3LM07940
*                                                                       3LM07950
*      X1=NUMERIC LENGTH                                                3LM07960
*      X2=-TARGET                                                       3LM07970
*      X4=WORD LENGTH (6-BYTE)                                          3LM07980
*      AC=0 FOR UNSIGNED INTEGER                                        3LM07990
*        =SIGN (+,-,BLANK)                                              3LM08000
*      SI=INTEGER                                                       3LM08010
*                                                                       3LM08020
MOVCV2 RIL     400000                                                   3LM08030
       LDQ     0,2                                                      3LM08040
       XEC     RQL1,4                                                   3LM08050
       TNZ     *+3                                                      3LM08060
       PIA                                                              3LM08070
       TRA     MV010                                                    3LM08080
       XCL                                                              3LM08090
       LGL     6                                                        3LM08100
       XCL                                                              3LM08110
       PIA                                                              3LM08120
       TNX     MV015,4,1           TARGET WORD IS FULL                  3LM08130
 MV010 TXL     MV003,1,6           NL=1,2,3,4,5,6                       3LM08140
       TXL     MV001,1,9           NL=7,8,9                             3LM08150
       RQL     5                   NL=10                                3LM08160
       LRS     5                                                        3LM08170
       VDP     TAB1-1,,6           2*(10**9)                            3LM08180
       RQL     1                                                        3LM08190
       LGR     1                                                        3LM08200
       AXT     9,1                 SET NL=1                             3LM08210
       TNX     MV002,4,1           TARGET WORD IS FULL                  3LM08220
 MV001 XEC     TIX,4                                                    3LM08230
       VDP     TAB1+3,1,6          FL=6                                 3LM08240
       ARS     6                                                        3LM08250
       VDP     TAB1+4,1,6             5                                 3LM08260
       ARS     6                                                        3LM08270
       VDP     TAB1+5,1,6             4                                 3LM08280
       ARS     6                                                        3LM08290
       VDP     TAB1+6,1,6             3                                 3LM08300
       ARS     6                                                        3LM08310
       VDP     TAB1+7,1,6             2                                 3LM08320
       ARS     6                                                        3LM08330
       VDP     TAB1+8,1,6             1                                 3LM08340
       RQL     1                                                        3LM08350
       LGR     1                                                        3LM08360
       ARS     5                                                        3LM08370
       TXH     *+2,1,5                                                  3LM08380
       XEC     ALS,1                                                    3LM08390
 MV002 NZT     MOVPT                                                    3LM08400
       TRA     MV015+2                                                  3LM08410
       LXA     MOVPT,4                                                  3LM08420
       SXD     *+1,1                                                    3LM08430
       TNX     MV015+2,4,0                                              3LM08440
       STZ     MOVPT               DECIMAL POINT TO BE INSERTED         3LM08450
       PAI                                                              3LM08460
       XEC     LGL1,4                                                   3LM08470
       ALS     6                                                        3LM08480
       ORA     POINT               INSERT DECIMAL POINT                 3LM08490
       XEC     LGL2,4                                                   3LM08500
       SLW     0,2                                                      3LM08510
       CAL     1,2                                                      3LM08520
       LGL     6                                                        3LM08530
       XCL                                                              3LM08540
       PIA                                                              3LM08550
       AXT     5,4                 SET FL=5                             3LM08560
       TXH     MV004,1,6           NL=7,8,9                             3LM08570
       TXI     MV003+1,2,-1                                             3LM08580
 MV008 SXD     MV009,1                                                  3LM08590
       SXD     MV016,1                                                  3LM08600
       LXA     MOVPT,1                                                  3LM08610
       STZ     MOVPT                                                    3LM08620
       TXH     *+2,1,0                                                  3LM08630
MV016  TXL     MV017,4,0                                                3LM08640
       XEC     LGL1,1                                                   3LM08650
       ALS     6                                                        3LM08660
       ORA     POINT                                                    3LM08670
MV009  TNX     MV014,4,0                                                3LM08680
       XEC     LGL2-1,1                                                 3LM08690
       XCL                                                              3LM08700
       TIX     MV007,4,1                                                3LM08710
 MV013 AXT     6,4                                                      3LM08720
       STQ     0,2                                                      3LM08730
       TXI     MV012,2,-1                                               3LM08740
 MV017 CAL     POINT+1                                                  3LM08750
       TRA     MV018                                                    3LM08760
 MV014 XEC     LGL2,1                                                   3LM08770
       XCL                                                              3LM08780
 MV018 LDI     1,2                                                      3LM08790
       RIL     770000                                                   3LM08800
       OAI                                                              3LM08810
       STI     1,2                                                      3LM08820
       AXT     5,4                                                      3LM08830
       TRA     MV013+1                                                  3LM08840
 MV015 TXH     *+2,1,5                                                  3LM08850
       XEC     ALS,1                                                    3LM08860
       AXT     6,4                 SET FL=6                             3LM08870
       STQ     0,2                                                      3LM08880
       LDQ     1,2                                                      3LM08890
       TXL     MV008-1,1,6         NL=1,2,3,4,5,6                       3LM08900
 MV004 TXI     MV010+1,2,-1        NL=7,8,9,10                          3LM08910
 MV003 XEC     ALS,1                                                    3LM08920
       SXD     *+1,4                                                    3LM08930
       TNX     MV006,1,0                                                3LM08940
       TRA     MV005+1,4                                                3LM08950
       VDP     TAB2+1,1,6          FL=5                                 3LM08960
       VDP     TAB2+2,1,6             4                                 3LM08970
       VDP     TAB2+3,1,6             3                                 3LM08980
       VDP     TAB2+4,1,6             2                                 3LM08990
 MV005 VDP     TAB2+5,1,6             1                                 3LM09000
       RQL     1                                                        3LM09010
       LGR     1                                                        3LM09020
       ALS     1                                                        3LM09030
       TRA     MV002                                                    3LM09040
 MV006 TRA     MV011+1,1                                                3LM09050
       VDP     TAB2,,6             NL=6                                 3LM09060
       VDP     TAB2+1,,6              5                                 3LM09070
       VDP     TAB2+2,,6              4                                 3LM09080
       VDP     TAB2+3,,6              3                                 3LM09090
       VDP     TAB2+4,,6              2                                 3LM09100
 MV011 XCL                            1                                 3LM09110
       LGL     6                                                        3LM09120
       XCL                                                              3LM09130
       ZET     MOVPT                                                    3LM09140
       TRA     MV008                                                    3LM09150
       SXD     *+1,1                                                    3LM09160
       TNX     MV013,4,0                                                3LM09170
 MV007 XEC     RQL2,4                                                   3LM09180
       STQ     0,2                                                      3LM09190
MV012  TRA*    0                                                        3LM09200
*NORMALIZE (AC+MQ) TO BIT 2                                             3LM09210
*      CALLING SEQUENCE                                                 3LM09220
*      S.NL IN X1                                                       3LM09230
*      TSX     MOVNRM,4                                                 3LM09240
*                                                                       3LM09250
*      UPON RETURN                                                      3LM09260
*        X1=TRUE SIZE IN NO. OF DECIMAL DIGITS                          3LM09270
*        X2=128+BS                                                      3LM09280
*                                                                       3LM09290
MOVNRM TXL     MV900,1,10          SOURCE FIELD IS LESS THAN 10 DIGITS  3LM09300
       TZE     MV901               SOURCE FIELD=0                       3LM09310
       LAS     TEN3+20,1                                                3LM09320
       TRA     MV902+1                                                  3LM09330
       TRA     *+3                                                      3LM09340
       TXI     *-3,1,-1                                                 3LM09350
 MV901 AXT     11,1                                                     3LM09360
       XCA                                                              3LM09370
       LAS     TEN4+20,1                                                3LM09380
       TRA     MV902                                                    3LM09390
       TRA     MV902                                                    3LM09400
       TXI     *+1,1,-1                                                 3LM09410
       TXL     MV903,1,10                                               3LM09420
 MV902 XCA                                                              3LM09430
       XEC     AXT+9,1                                                  3LM09440
       LLS     128+40,2                                                 3LM09450
       TXI     MV905,2,30                                               3LM09460
 MV900 LDQ     MVD00                                                    3LM09470
       LRS     0                                                        3LM09480
 MV903 TZE     1,4                                                      3LM09490
       LAS     TAB11+10,1          FIND ACTUAL SIZE                     3LM09500
       TRA     *+3                                                      3LM09510
       TRA     *+2                                                      3LM09520
       TXI     *-3,1,-1                                                 3LM09530
       XEC     AXT,1               SET X2=MOVBS AND SHIFT               3LM09540
       ALS     128+35,2                                                 3LM09550
 MV905 LDI     MVD09               100000000000                         3LM09560
       TZE     1,4                                                  (14)3LM09565
       TIF     MV904                                                    3LM09570
       TRA     1,4                                                      3LM09580
 MV904 LLS     1                                                        3LM09590
       TXI     MV905+2,2,-1                                         (14)3LM09600
*TABLES AND CONSTANTS                                                   3LM09610
 MVD00 OCT     0                                                        3LM09620
 MVD01 OCT     377777777777                                             3LM09630
 MVD02 OCT     344777777777                                             3LM09640
 MVD03 OCT     400011504046        -.30103B12                           3LM09650
 MVD04 OCT     000000000031        .1B27                                3LM09660
 MVD05 OCT     200                                                      3LM09670
 MVD06 OCT     000000200000                                             3LM09680
 MVD09 PON     0                                                        3LM09690
 MVD10 PTW     0                                                        3LM09700
 MVD11 MZE     0                                                        3LM09710
 MVD12 PZE     -1,0,0                                                   3LM09720
 MVD13 OCT     406060606060                                             3LM09730
       OCT     206060606060                                             3LM09740
       OCT     606060606060                                             3LM09750
SWFF   PZE     0                                                        3LM09760
SWXI   PZE     0                                                        3LM09770
SWXF   PZE     0                                                        3LM09780
MOVT1  PZE     0                                                        3LM09790
MOVT2  PZE     0                                                        3LM09800
MOVDS  PZE     0                                                        3LM09810
MOVXP  PZE     0                                                        3LM09820
MOVNL  PZE     0                                                        3LM09830
MOVPT  PZE     0                                                        3LM09840
*                                                                       3LM09850
 POINT OCT     000000000033                                             3LM09860
       OCT     330000000000                                             3LM09870
       OCT     016715312000        2*(10**9)                            3LM09880
 TAB1  OCT     057536040000        (2**6)*(10**8)                       3LM09890
       OCT     004611320000        (2**6)*(10**7)                       3LM09900
       OCT     000364110000        (2**6)*(10**6)                       3LM09910
       OCT     000030324000        (2**6)*(10**5)                       3LM09920
       OCT     000002342000        (2**6)*(10**4)                       3LM09930
       OCT     000000175000        (2**6)*(10**3)                       3LM09940
       OCT     000000014400        (2**6)*(10**2)                       3LM09950
       OCT     000000001200        (2**6)*(10**1)                       3LM09960
 TAB2  OCT     000030324000        (2**6)*(10**5)                       3LM09970
       OCT     000234200000        (2**12)*(10**4)                      3LM09980
       OCT     001750000000        (2**18)*(10**3)                      3LM09990
       OCT     014400000000        (2**24)*(10**2)                      3LM10000
       OCT     120000000000        (2**30)*(10**1)                      3LM10010
*TIX TABLE     NL=NL-FL                                                 3LM10020
*                                                                       3LM10030
       TIX     MV001+1,1,6         FL=6                                 3LM10040
       TIX     MV001+3,1,5            5                                 3LM10050
       TIX     MV001+5,1,4            4                                 3LM10060
       TIX     MV001+7,1,3            3                                 3LM10070
       TIX     MV001+9,1,2            2                                 3LM10080
       TIX     MV001+11,1,1           1                                 3LM10090
 TIX   BSS     0                                                        3LM10100
*RQL TABLE TO ADJUST BEGINNING AND END FIELD                            3LM10110
*                                                                       3LM10120
       AXT     0,0                 FL=6                                 3LM10130
       RQL     6                      5                                 3LM10140
       RQL     12                     4                                 3LM10150
       RQL     18                     3                                 3LM10160
       RQL     24                     2                                 3LM10170
       RQL     30                     1   FL-NL=5                       3LM10180
 RQL1  RQL     24                               4                       3LM10190
       RQL     18                               3                       3LM10200
       RQL     12                               2                       3LM10210
       RQL     6                                1                       3LM10220
 RQL2  AXT     0,0                              0                       3LM10230
*ALS TABLE TO ADJUST DIVIDEND                                           3LM10240
*                                                                       3LM10250
       AXT     0,0                 NL=6                                 3LM10260
       ALS     6                      5                                 3LM10270
       ALS     12                     4                                 3LM10280
       ALS     18                     3                                 3LM10290
       ALS     24                     2                                 3LM10300
       ALS     30                     1                                 3LM10310
 ALS   BSS     0                                                        3LM10320
*LGL TABLE FOR INSERTING DECIMAL POINT                                  3LM10330
*                                                                       3LM10340
       AXT     0,0                 SC-NL=6                              3LM10350
       LGL     6                         5                              3LM10360
       LGL     12                        4                              3LM10370
       LGL     18                        3                              3LM10380
       LGL     24                        2                              3LM10390
       LGL     30                        1                              3LM10400
 LGL1  XCL                               0                              3LM10410
       LGL     30                                 6                     3LM10420
       LGL     24                                 5                     3LM10430
       LGL     18                               4                       3LM10440
       LGL     12                               3                       3LM10450
       LGL     6                                2                       3LM10460
       AXT     0,0                              1                       3LM10470
 LGL2  BSS     0                                                        3LM10480
*AXT TABLE TO SET X2=MOVBS                                              3LM10490
*                                                                       3LM10500
       AXT     128+38,2                                                 3LM10510
       AXT     128+35,2                                                 3LM10520
       AXT     128+31,2                                                 3LM10530
       AXT     128+28,2                                                 3LM10540
       AXT     128+25,2                                                 3LM10550
       AXT     128+21,2                                                 3LM10560
       AXT     128+18,2                                                 3LM10570
       AXT     128+15,2                                                 3LM10580
       AXT     128+11,2                                                 3LM10590
       AXT     128+8,2                                                  3LM10600
       AXT     128+5,2                                                  3LM10610
 AXT   BSS     0                                                        3LM10620
*TABLE OF POWERS OF TEN (LEFT JUSTIFIED)                                3LM10630
*                                                                       3LM10640
       OCT     343277244615        (10**15)B50                          3LM10650
       OCT     265714203644        (10**14)B47                          3LM10660
       OCT     221411634520        (10**13)B44                          3LM10670
       OCT     350651224200        (10**12)B40                          3LM10680
       OCT     272207335000        (10**11)B37                          3LM10690
       OCT     225005744000        (10**10)B34                          3LM10700
       OCT     356326240000        (10**9)B30                           3LM10710
       OCT     276570200000        (10**8)B27                           3LM10720
       OCT     230455000000        (10**7)B24                           3LM10730
       OCT     364110000000        (10**6)B20                           3LM10740
       OCT     303240000000        (10**5)B17                           3LM10750
       OCT     234200000000        (10**4)B14                           3LM10760
       OCT     372000000000        (10**3)B10                           3LM10770
       OCT     310000000000        (10**2)B7                            3LM10780
       OCT     240000000000        (10**1)B4                            3LM10790
 TEN1  BSS     0                                                        3LM10800
*                                                                       3LM10810
 MVXXX EQU     MV400-10                                                 3LM10820
 TAB10 PZE     MVXXX+0,,32         0    0    NL=20                      3LM10830
       PZE     MVXXX+1,,29         1    1       19                      3LM10840
       PZE     MVXXX+2,,25         2    2       18                      3LM10850
       PZE     MVXXX+3,,22         3    3       17                      3LM10860
       PZE     MVXXX+4,,19         4    4       16                      3LM10870
       PZE     MVXXX+5,,15         5    5       15                      3LM10880
       PZE     MVXXX+6,,12         6    6       14                      3LM10890
       PZE     MVXXX+7,,9          7    7       13                      3LM10900
       PZE     MVXXX+8,,5          10   8       12                      3LM10910
 TAB21 PZE     MVXXX+9,,2          11   9       11                      3LM10920
       PZE     MVXXX+10            12                                   3LM10930
       PZE     MVXXX+10            13                                   3LM10940
       PZE     MVXXX+10            14                                   3LM10950
       PZE     MVXXX+10            15                                   3LM10960
       PZE     MVXXX+10            16                                   3LM10970
       PZE     MVXXX+10            17                                   3LM10980
       PZE     MVXXX+12            20   +                               3LM10990
       PZE     MVXXX+10            21                                   3LM11000
       PZE     MVXXX+10            22                                   3LM11010
       PZE     MVXXX+10            23                                   3LM11020
       PZE     MVXXX+10            24                                   3LM11030
       PZE     MVXXX+10            25                                   3LM11040
       PZE     MVXXX+10            26                                   3LM11050
       PZE     MVXXX+10            27                                   3LM11060
       PZE     MVXXX+10            30                                   3LM11070
       PZE     MVXXX+10            31                                   3LM11080
       PZE     MVXXX+10            32                                   3LM11090
       PZE     MVXXX+11            33   .                               3LM11100
       PZE     MVXXX+10            34                                   3LM11110
       PZE     MVXXX+10            35                                   3LM11120
       PZE     MVXXX+10            36                                   3LM11130
       PZE     MVXXX+10            37                                   3LM11140
       PZE     MVXXX+13            40   -                               3LM11150
*TXI TABLES TO ADJUST MOVBS DURING SCALING                              3LM11160
*                                                                       3LM11170
       TXI     MV400,2,50          41   DS=15                           3LM11180
       TXI     MV400,2,47          42      14                           3LM11190
       TXI     MV400,2,44          43      13                           3LM11200
       TXI     MV400,2,40          44      12                           3LM11210
       TXI     MV400,2,37          45      11                           3LM11220
       TXI     MV400,2,34          46      10                           3LM11230
       TXI     MV400,2,30          47      9                            3LM11240
       TXI     MV400,2,27          50      8                            3LM11250
       TXI     MV400,2,24          51      7                            3LM11260
       TXI     MV400,2,20          52      6                            3LM11270
       TXI     MV400,2,17          53      5                            3LM11280
       TXI     MV400,2,14          54      4                            3LM11290
       TXI     MV400,2,10          55      3                            3LM11300
       TXI     MV400,2,7           56      2                            3LM11310
       TXI     MV400,2,4           57      1                            3LM11320
 TXI1  PZE     MVXXX+14            60   BLANK                           3LM11330
       TXI     MV400,2,-50         61   DS=-15                          3LM11340
       TXI     MV400,2,-47         62      -14                          3LM11350
       TXI     MV400,2,-44         63      -13                          3LM11360
       TXI     MV400,2,-40         64      -12                          3LM11370
       TXI     MV400,2,-37         65      -11                          3LM11380
       TXI     MV400,2,-34         66      -10                          3LM11390
       TXI     MV400,2,-30         67      -9                           3LM11400
       TXI     MV400,2,-27         70      -8                           3LM11410
       TXI     MV400,2,-24         71      -7                           3LM11420
       TXI     MV400,2,-20         72      -6                           3LM11430
       TXI     MV400,2,-17         73      -5                           3LM11440
       TXI     MV400,2,-14         74      -4                           3LM11450
       TXI     MV400,2,-10         75      -3                           3LM11460
       TXI     MV400,2,-7          76      -2                           3LM11470
       TXI     MV400,2,-4          77      -1                           3LM11480
 TXI2  BSS     0                                                        3LM11490
*                                                                       3LM11500
 TEN3  OCT     002126162140        WORD1 10**19                         3LM11510
       OCT     000157013326              10**18                         3LM11520
       OCT     000013064257              10**17                         3LM11530
       OCT     000001070336              10**16                         3LM11540
       OCT     000000070657              10**15                         3LM11550
       OCT     000000005536              10**14                         3LM11560
       OCT     000000000443              10**13                         3LM11570
       OCT     000000000035              10**12                         3LM11580
       OCT     000000000002              10**11                         3LM11590
       OCT     000000000000              10**10                         3LM11600
*                                                                       3LM11610
 TEN4  OCT     221172000000        WORD2 10**19                         3LM11620
       OCT     164731000000              10**18                         3LM11630
       OCT     013542400000              10**17                         3LM11640
       OCT     115760200000              10**16                         3LM11650
       OCT     324461500000              10**15                         3LM11660
       OCT     142036440000              10**14                         3LM11670
       OCT     011634520000              10**13                         3LM11680
       OCT     032451210000              10**12                         3LM11690
       OCT     351035564000              10**11                         3LM11700
       OCT     112402762000              10**10                         3LM11710
*                                                                       3LM11720
 TAB11 OCT     007346545000        1000000000                           3LM11730
       OCT     000575360400        100000000                            3LM11740
       OCT     000046113200        10000000                             3LM11750
       OCT     000003641100        1000000                              3LM11760
       OCT     000000303240        100000                               3LM11770
       OCT     000000023420        10000                                3LM11780
       OCT     000000001750        1000                                 3LM11790
       OCT     000000000144        100                                  3LM11800
       OCT     000000000012        10                                   3LM11810
 TEN2  OCT     000000000001        1                                    3LM11820
 TAB12 OCT     016715312000        2000000000                           3LM11830
       OCT     001372741000        200000000                            3LM11840
       OCT     000114226400        20000000                             3LM11850
       OCT     000007502200        2000000                              3LM11860
       OCT     000000606500        200000                               3LM11870
       OCT     000000047040        20000                                3LM11880
       OCT     000000003720        2000                                 3LM11890
       OCT     000000000310        200                                  3LM11900
       OCT     000000000024        20                                   3LM11910
       OCT     000000000002        2                                    3LM11920
 TAB13 OCT     026264057000        3000000000                           3LM11930
       OCT     002170321400        300000000                            3LM11940
       OCT     000162341600        30000000                             3LM11950
       OCT     000013343300        3000000                              3LM11960
       OCT     000001111740        300000                               3LM11970
       OCT     000000072460        30000                                3LM11980
       OCT     000000005670        3000                                 3LM11990
       OCT     000000000454        300                                  3LM12000
       OCT     000000000036        30                                   3LM12010
       OCT     000000000003        3                                    3LM12020
 TAB14 OCT     035632624000        4000000000                           3LM12030
       OCT     002765702000        400000000                            3LM12040
       OCT     000230455000        40000000                             3LM12050
       OCT     000017204400        4000000                              3LM12060
       OCT     000001415200        400000                               3LM12070
       OCT     000000116100        40000                                3LM12080
       OCT     000000007640        4000                                 3LM12090
       OCT     000000000620        400                                  3LM12100
       OCT     000000000050        40                                   3LM12110
       OCT     000000000004        4                                    3LM12120
 TAB15 OCT     045201371000        5000000000                           3LM12130
       OCT     003563262400        500000000                            3LM12140
       OCT     000276570200        50000000                             3LM12150
       OCT     000023045500        5000000                              3LM12160
       OCT     000001720440        500000                               3LM12170
       OCT     000000141520        50000                                3LM12180
       OCT     000000011610        5000                                 3LM12190
       OCT     000000000764        500                                  3LM12200
       OCT     000000000062        50                                   3LM12210
       OCT     000000000005        5                                    3LM12220
 TAB16 OCT     054550136000        6000000000                           3LM12230
       OCT     004360643000        600000000                            3LM12240
       OCT     000344703400        60000000                             3LM12250
       OCT     000026706600        6000000                              3LM12260
       OCT     000002223700        600000                               3LM12270
       OCT     000000165140        60000                                3LM12280
       OCT     000000013560        6000                                 3LM12290
       OCT     000000001130        600                                  3LM12300
       OCT     000000000074        60                                   3LM12310
       OCT     000000000006        6                                    3LM12320
 TAB17 OCT     064116703000        7000000000                           3LM12330
       OCT     005156223400        700000000                            3LM12340
       OCT     000413016600        70000000                             3LM12350
       OCT     000032547700        7000000                              3LM12360
       OCT     000002527140        700000                               3LM12370
       OCT     000000210560        70000                                3LM12380
       OCT     000000015530        7000                                 3LM12390
       OCT     000000001274        700                                  3LM12400
       OCT     000000000106        70                                   3LM12410
       OCT     000000000007        7                                    3LM12420
 TAB18 OCT     073465450000        8000000000                           3LM12430
       OCT     005753604000        800000000                            3LM12440
       OCT     000461132000        80000000                             3LM12450
       OCT     000036411000        8000000                              3LM12460
       OCT     000003032400        800000                               3LM12470
       OCT     000000234200        80000                                3LM12480
       OCT     000000017500        8000                                 3LM12490
       OCT     000000001440        800                                  3LM12500
       OCT     000000000120        80                                   3LM12510
       OCT     000000000010        8                                    3LM12520
 TAB19 OCT     103034215000        9000000000                           3LM12530
       OCT     006551164400        900000000                            3LM12540
       OCT     000527245200        90000000                             3LM12550
       OCT     000042252100        9000000                              3LM12560
       OCT     000003335640        900000                               3LM12570
       OCT     000000257620        90000                                3LM12580
       OCT     000000021450        9000                                 3LM12590
       OCT     000000001604        900                                  3LM12600
       OCT     000000000132        90                                   3LM12610
       OCT     000000000011        9                                    3LM12620
       END                                                              3LM12630
$IBMAP CEXAM   ADDREL                                                   3LN00000
       LBL     EXAM,BEGIN     CEXAM                                  (7)3LN00010
* CEXAM - SUBROUTINE TO EXAMINE DATUM PER D.O.D. COBOL SPECIFICATIONS   3LN00020
*                                                                       3LN00030
       ENTRY   .CEXAM                                                   3LN00040
.CEXAM SXA     CXMAX2,2            SAVE INDICES                         3LN00050
       SXA     CXMAX2+1,4                                               3LN00060
       CLA     1,4                 GET PARAMETER WORD                   3LN00070
       LGR     18                                                       3LN00080
       STA     TLYING                                                   3LN00090
       ZET     TLYING              IF TALLYING, SET TALLY = ZERO        3LN00100
       STZ*    TLYING                                                   3LN00110
       TXL     CXMAX2,1,0          PROTECT AGAINST LENGTH = ZERO        3LN00120
       STZ     CSWTCH                                                   3LN00130
       TPL     *+2                 SET REPLACING QUESTION               3LN00140
       STL     CSWTCH                                                   3LN00150
       STZ     LEADNG                                                   3LN00160
       STZ     C1ST                SET MINOR QUESTIONS TO NO            3LN00170
       STZ     TIL1ST                                                   3LN00180
       STZ     COP                                                      3LN00185
       PXA     0,0                                                      3LN00190
       LGL     3                                                        3LN00200
       PAC     0,2                 GET CODE                             3LN00210
       TQP     *+2                                                      3LN00211
       STL     COP                 PERMIT OVERPUNCH CHECKING            3LN00212
       LGL     1                                                        3LN00213
       PXA     0,0                                                      3LN00220
       LGL     8                                                        3LN00230
       SLW     LIT.2               SET LITERAL.2                        3LN00240
       PXA     0,0                                                      3LN00250
       LGL     6                                                        3LN00260
       SLW     LIT.1               SET LITERAL.1                        3LN00270
       XEC     STLTBL,2                                                 3LN00280
       SPACE   1                                                        3LN00290
       LXD     .CAREF,2                                                 3LN00300
CXMGET TSX     .CHGET,4            GET NEXT CHARACTER                   3LN00310
       TRA     CXMAX2              EXIT AT END                          3LN00320
       LGL     6                                                        3LN00330
       SUB     LIT.1               SEE IF CHAR = LIT.1                  3LN00340
       TZE     CTIL1                                                    3LN00350
       TXH     CXAM1,1,1                                                3LN00351
       NZT     COP                 IF LAST CHAR, CHECK OVERPUNCH QUERY  3LN00352
       TRA     CXAM1               NO - FORGET IT                       3LN00353
       TMI     CXAM1               YES - NO USE IF NEGATIVE REMAINDER   3LN00354
       PAX     0,4                                                      3LN00355
       ZET     LIT.1                                                    3LN00356
       TXI     *+2,4,-16           ADJUST FOR + O.P. FOR 1 - 9          3LN00357
       TXI     *+1,4,-26           ADJUST FOR + O.P. FOR ZERO           3LN00358
       TXL     CXAM2,4,0           TRANSFER IF + O.P.                   3LN00359
       TXH     CXAM1,4,16                                               3LN00360
       TXL     CXAM1,4,15          IF NOT NEGATIVE O.P., FORGET IT      3LN00361
CXAM2  ZET     LIT.2                                                    3LN00362
       TXI     *+2,4,16            READJUST O.P. FOR LIT.2 VALUES 1 - 9 3LN00363
       TXI     *+1,4,26            READJUST O.P. FOR LIT.2 VALUE ZERO   3LN00364
       PXA     0,4                                                      3LN00365
       ORS     LIT.2               OR O.P. INTO LIT.2                   3LN00366
       TRA     CTIL1                                                    3LN00367
CXAM1  ZET     LEADNG                                                   3LN00368
       TRA     CXMAX2              EXIT IF 'LEADING'                    3LN00370
       ZET     TIL1ST                                                   3LN00380
       TRA     CTIL1+2                                                  3LN00390
       TXI     CXMGET,1,-1                                              3LN00400
       SPACE   1                                                        3LN00410
CTIL1  ZET     TIL1ST                                                   3LN00420
       TRA     CXMAX2              EXIT IF 'UNTIL FIRST'                3LN00430
       ZET     TLYING                                                   3LN00440
       TRA     TLYADD              GO TO ADD TO TALLY IF 'TALLYING'     3LN00450
CXAM3  CAL     LIT.2                                                    3LN00460
       LGR     6                                                        3LN00470
       XEC     RQLTB2,2            REPLACE CHAR BY LIT.2                3LN00480
       TXH     CXAM4,2,0           NO PROBLEM                           3LN00490
       LAC     .CAREF,4                                                 3LN00500
       STQ     -1,4                                                     3LN00510
       TRA     CXAM4+1                                                  3LN00520
CXAM4  STQ*    .CAREF                                                   3LN00530
       NZT     C1ST                                                     3LN00540
       TXI     CXMGET,1,-1                                              3LN00550
       TRA     CXMAX2                                                   3LN00560
       SPACE   1                                                        3LN00570
       PZE     1                                                        3LN00580
TLYADD CLA*    TLYING                                                   3LN00590
       ADD     TLYADD-1            ADD 1 TO TALLY                       3LN00600
       STO*    TLYING                                                   3LN00610
       ZET     CSWTCH                                                   3LN00620
       TRA     CXAM3               DO REPLACING IF REQUESTED            3LN00630
       TXI     CXMGET,1,-1                                              3LN00640
       SPACE   1                                                        3LN00650
TLYING PZE     **                                                       3LN00660
CSWTCH PZE     **                                                       3LN00670
LEADNG PZE     **                                                       3LN00680
C1ST   PZE     **                                                       3LN00690
TIL1ST PZE     **                                                       3LN00700
COP    PZE     **                  CHECK OVERPUNCH SWITCH               3LN00705
LIT.1  PZE     **                                                       3LN00710
LIT.2  PZE     **                                                       3LN00720
       SPACE   1                                                        3LN00730
STLTBL AXT     0,0                       0                              3LN00740
       STL     LEADNG              0     1                              3LN00750
       STL     C1ST                      2                              3LN00760
       STR                               3                              3LN00770
       STL     TIL1ST                    4                              3LN00780
       STR                               5                              3LN00790
       STR                         7     6                              3LN00800
       STR                         6     7                              3LN00810
       RQL     12                  5                                    3LN00820
       RQL     18                  4                                    3LN00830
       RQL     24                  3                                    3LN00840
       RQL     30                  2                                    3LN00850
       AXT     0,0                 1                                    3LN00860
RQLTB2 RQL     6                   0                                    3LN00870
       SPACE   2                                                        3LN00880
*  SUBROUTINES TO EXAMINE A DATA ITEM                                   3LN00890
*    TO TEST IF NUMERIC (.CXAMN) OR                                     3LN00900
*    TO TEST IF ALPHABETIC (.CXAMA)                                     3LN00910
*                                                                       3LN00920
       ENTRY   .CXAMN                                                   3LN00930
.CXAMN SXA     CXMAX2,2            SAVE XR2                             3LN00940
       AXT     2,2                                                      3LN00950
       SXA     CXTEST,2            SET UP FOR NUMERIC TEST              3LN00960
       AXT     CXAMN1,2                                                 3LN00970
       TRA     CXAMNC                                                   3LN00980
       SPACE   1                                                        3LN00990
       ENTRY   .CXAMA                                                   3LN01000
.CXAMA SXA     CXMAX2,2            SAVE XR2                             3LN01010
       AXT     1,2                                                      3LN01020
       SXA     CXTEST,2            SET UP FOR ALPHABETIC                3LN01030
       AXT     CXMAX2,2                                                 3LN01040
CXAMNC SXA     CXTEST+1,2                                               3LN01050
       SXA     CXMAX2+1,4          SAVE RETURN                          3LN01060
       CLA     1,4                                                      3LN01070
       PDX     0,2                                                      3LN01080
       SXA     CXMA1,2             GET TS CELL                          3LN01090
       STL*    CXMA1               SET 'NO' ANSWER                      3LN01100
       TXL     CXMAX2,1,0          PROTECT AGAINST LENGTH = 0           3LN01110
       LXD     .CAREF,2            GET FIRST BYTE                       3LN01120
       SPACE   1                                                        3LN01130
CXGET  TSX     .CHGET,4            GET NEXT CHARACTER                   3LN01140
       TRA     CXMA1                (AT END SET 'YES')                  3LN01150
CLOOK  TQP     *+4                                                      3LN01160
       CAQ     CXMATB-32,,1                                             3LN01170
       ARS     18                                                       3LN01180
       TRA     *+2                                                      3LN01190
       CAQ     CXMATB,,1                                                3LN01200
       PAI                                                              3LN01210
CXTEST RNT     **                                                       3LN01220
       TXI     **,1,-1                                                  3LN01230
       TXI     CXGET,1,-1                                               3LN01240
CXAMN1 TXH     CXMAX2,1,0          EXIT IF STRANGER NOT LAST            3LN01250
       RNT     000010                OR IF STRANGER AT END              3LN01260
       TRA     CXMAX2                NOT AN OVERPUNCH CHAR.             3LN01270
CXMA1  STZ     **                  SET 'YES' ANSWER                     3LN01280
CXMAX2 AXT     **,2                                                     3LN01290
       AXT     **,4                                                     3LN01300
       TRA     2,4                                                      3LN01310
       SPACE   1                                                        3LN01320
*  TABLE OF CHARACTERS FOR IF CLASS TESTS.                              3LN01330
       SPACE   1                                                        3LN01340
CXMATB PZE     2,,20               0    -                               3LN01350
       PZE     2,,9                1    J                               3LN01360
       PZE     2,,9                2    K                               3LN01370
       PZE     2,,9                3    L                               3LN01380
       PZE     2,,9                4    M                               3LN01390
       PZE     2,,9                5    N                               3LN01400
       PZE     2,,9                6    O                               3LN01410
       PZE     2,,9                7    P                               3LN01420
       PZE     2,,9                8    Q                               3LN01430
       PZE     2,,9                9    R                               3LN01440
       PZE     0,,8                     -OP                             3LN01450
       PZE     16,,16              =    $                               3LN01460
       PZE     16,,16              '    *                               3LN01470
       PZE                                                              3LN01480
       PZE                                                              3LN01490
       PZE                                                              3LN01500
       PZE     20,,1              +    SPACE                            3LN01510
       PZE     9,,16               A    /                               3LN01520
       PZE     9,,1                B    S                               3LN01530
       PZE     9,,1                C    T                               3LN01540
       PZE     9,,1                D    U                               3LN01550
       PZE     9,,1                E    V                               3LN01560
       PZE     9,,1                F    W                               3LN01570
       PZE     9,,1                G    X                               3LN01580
       PZE     9,,1                H    Y                               3LN01590
       PZE     9,,1                I    Z                               3LN01600
       PZE     8,,0                +OP                                  3LN01610
       PZE     16,,16              .    ,                               3LN01620
       PZE     16,,16              )    (                               3LN01630
       PZE                                                              3LN01640
       PZE                                                              3LN01650
       PZE                                                              3LN01660
       SPACE   2                                                        3LN01670
*  SUBROUTINE TO GET A CHARACTER FOR .CEXAM, .CXAMA, AND .CXAMN         3LN01680
       SPACE   1                                                        3LN01690
*   CALLING SEQUENCE               (ENTER WITH REMAINING LENGTH         3LN01700
*      TSX     .CHGET,4             IN XR1 AND CURRENT BYTE IN XR2)     3LN01710
*      END OF ITEM RETURN                                               3LN01720
*      NORMAL RETURN                                                    3LN01730
*                                                                       3LN01740
.CHGET TXL     CHEND,1,0           IF NO MORE CHARACTER EOI EXIT        3LN01750
       LDQ*    .CAREF              GET NEXT CHARACTER LEFT              3LN01760
       XEC     RQLTB1,2              JUSTIFIED IN MQ                    3LN01770
       PXA     0,0                 ZERO OUT AC                          3LN01780
       TXI     *+1,2,1             UPDATE BYTE NUMBER                   3LN01790
       TXL     *+5,2,5             DONE IF LESS THAN SIX                3LN01800
       LXA     .CAREF,2            ELSE UPDATE SOURCE WORD              3LN01810
       TXI     *+1,2,1                                                  3LN01820
       SXA     .CAREF,2                                                 3LN01830
       AXT     0,2                 RESET TO FIRST BYTE                  3LN01840
       TRA     2,4                                                      3LN01850
CHEND  TRA     1,4                                                      3LN01860
       STR                         7                                    3LN01870
       STR                         6                                    3LN01880
       RQL     30                  5                                    3LN01890
       RQL     24                  4                                    3LN01900
       RQL     18                  3                                    3LN01910
       RQL     12                  2                                    3LN01920
       RQL     6                   1                                    3LN01930
RQLTB1 AXT     0,0                 0                                    3LN01940
       END                                                              3LN01950
$IBMAP CBDCV   ADDREL                                                   3LO00000
       LBL     BDCV,BEGIN     CBDCV                                  (7)3LO00010
* .CBDCV LIBRARY SUBROUTINE                                             3LO00020
* CALLING SEQUENCE                                                      3LO00030
*      TSX     .CBDCV,4                                                 3LO00040
*      RETURN                                                           3LO00050
*  ON ENTRY - BCD CONTROL WORD IN MQ (COUNT CONTROL IN CHARACTERS)      3LO00060
*  ON EXIT - COUNT CONTROL IN WORDS IN BINARY FORM IN DECREMENT OF ACC  3LO00070
*  COUNT DECREASED BY ONE FOR ACTUAL RECORD LENGTH                      3LO00080
       ENTRY   .CBDCV                                                   3LO00090
.CBDCV SXA     BCDCV2,4                                                 3LO00100
       SXA     BCDCV2+1,2                                               3LO00110
       AXT     30,4                                                     3LO00120
       PXD     0,0                                                      3LO00130
       STZ     BINO                                                     3LO00140
BCDCV1 LGL     6                                                        3LO00150
       PAX     0,2                                                      3LO00160
       TXH     BCDEX1,2,9                                               3LO00170
       ACL     BINO                                                     3LO00180
       TNX     BCDCV2,4,6                                               3LO00190
       STQ     BINO+1                                                   3LO00200
       XCL                                                              3LO00210
       MPY     BCB10                                                    3LO00220
       STQ     BINO                                                     3LO00230
       LDQ     BINO+1                                                   3LO00240
       TRA     BCDCV1                                                   3LO00250
BCDCV2 AXT     **,4                                                     3LO00260
       AXT     **,2                                                     3LO00270
       XCA                                                              3LO00280
       PXD     0,0                                                      3LO00290
       DVP     BCB6                                                     3LO00300
       TNZ     BCDEX                                                    3LO00310
       XCA                                                              3LO00320
       SUB     BCB1                                                     3LO00330
       ALS     18                                                       3LO00340
       TRA     1,4                                                      3LO00350
BCDEX  TSX     .CDPLY,4                                                 3LO00360
       PZE     IOMESS,,8                                                3LO00370
       STR                                                              3LO00380
BCDEX1 TSX     .CDPLY,4                                                 3LO00390
       PZE     IOMSS1,,8                                                3LO00400
       STR                                                              3LO00410
BCB1   DEC     1                                                        3LO00420
BCB6   DEC     6                                                        3LO00430
BCB10  DEC     10                                                       3LO00440
BINO   BSS     2                                                        3LO00450
IOMESS BCI     9,JOB TERMINATED - ENCOUNTERED INPUT RECORD LENGTH NOT A 3LO00460
       BCI     3, MULTIPLE OF SIX.                                      3LO00470
IOMSS1 BCI     9,JOB TERMINATED - COUNT CONTROL CONTAINS A NON-NUMERIC  3LO00480
       BCI     3,BCD CHARACTER.                                         3LO00490
       END                                                              3LO00500
$IBMAP CBNCV   ADDREL                                                   3LP00000
       LBL     BNCV,BEGIN     CBNCV                                  (7)3LP00010
* .CBNCV LIBRARY SUBROUTINE                                             3LP00020
* CALLING SEQUENCE                                                      3LP00030
*      TSX     .CBNCV,4                                                 3LP00040
*      RETURN                                                           3LP00050
*  ON ENTRY-UNSIGNED BINARY WORD LENGTH OF RECORD IN MQ + 1 FOR CONTROL 3LP00060
*  ON EXIT CONTROL WORD IN BCD IN LOGICAL AC - 5 DIGIT BCD LENGTH FIELD 3LP00070
*  WITH SIXTH CHARACTER ZEROES).                                        3LP00080
       ENTRY   .CBNCV                                                   3LP00090
.CBNCV SXA     BINX,4                                                   3LP00100
       MPY     BIN6                                                     3LP00110
       AXT     36,4                                                     3LP00120
       STZ     BCDNO                                                    3LP00130
BNCV1  PXD     0,0                                                      3LP00140
       DVP     BIN10                                                    3LP00150
       ALS     36,4                                                     3LP00160
       ORS     BCDNO                                                    3LP00170
BNCV2  TIX     BNCV1,4,6                                                3LP00180
       CAL     BCDNO                                                    3LP00190
       LGL     6                                                        3LP00200
BINX   AXT     **,4                                                     3LP00210
       TRA     1,4                                                      3LP00220
BCDNO  BSS     1                                                        3LP00230
BIN6   DEC     6                                                        3LP00240
BIN10  DEC     10                                                       3LP00250
       END                                                              3LP00260
$IBMAP ACEPT   ADDREL                                                   3LQ00000
       LBL     ACPT,BEGIN     ACEPT                                  (7)3LQ00007
*  ACEPT LIBRARY SUBROUTINE                                             3LQ00010
*  CALLING SEQUENCE                                                     3LQ00020
*      LDI     A                                                        3LQ00030
*      TSX     .ACEPT,4                                                 3LQ00040
*      TXI     *+3,,1                                                   3LQ00050
*      PZE     8888,,LINKAGE-DIRECTOR                                   3LQ00060
*      PZE     FWA,,BYTE           (OF DATA ITEM ACCEPTED)              3LQ00070
*                                                                       3LQ00080
       ENTRY   .ACEPT                                                   3LQ00090
.ACEPT SXA     ACEXIT,4                                                 3LQ00100
       CAL     3,4                                                      3LQ00110
       SLW     .CBREF              SET TARGET CELL                      3LQ00120
       STI     ACIND                                                    3LQ00130
       LXA     ACIND,4                                                  3LQ00140
       SXD     ACLNG,4             SET LENGTH IN MOVE                   3LQ00150
       LNT     400000              SYSIN1 TEST                          3LQ00160
       TRA     ACE                 NO - CARD READER                     3LQ00170
ACOPEN TSX     .CCDTY,4            YES - TEST ASSIGNMENT                3LQ00180
       PZE     ACIN1                                                    3LQ00190
       TRA     ACOPEN-1            SYSIN1 IS  CARD READER               3LQ00200
       TSX     .OPEN,4             SYSIN1 NOT CARD READER               3LQ00210
       MZE     ACIN1                 THEN OPEN SYSIN1 ONCE              3LQ00220
       STL     ACOPEN                                                   3LQ00230
       STZ     .CAREF                                                   3LQ00240
       TSX     .READ,4                                                  3LQ00250
       PZE     ACIN1,,.CEOBP       FILE,,END OF BUFFER                  3LQ00260
       PZE     ACEOF,,.CERRP       END OF FILE,,ERROR                   3LQ00270
       IOCDN*  .CAREF,,12                                               3LQ00280
ACMOVE TSX     .CMPK3,4            MOVE DATA TO TARGET                  3LQ00290
ACLNG  TXI     .CANA1,1,**                                              3LQ00300
ACEXIT AXT     **,4                                                     3LQ00310
       TRA     1,4                                                      3LQ00320
ACE    TSX     .OPEN,4             OPEN CARD FILE ONCE                  3LQ00330
       MZE     ACCRD                                                    3LQ00340
       STL     ACOPEN-1                                                 3LQ00350
       TSX     .READ,4                                                  3LQ00360
       PZE     ACCRD,,.CEOBP                                            3LQ00370
       PZE     ACEOF,,.CERRP                                            3LQ00380
       IOCDN*  X,,24                                                    3LQ00390
       TSX     .CHBCD,4            CONVERT HOLLERITH TO BCD             3LQ00400
       PZE     X,,ACIM                                                  3LQ00410
       CAL     ACIMLO                                                   3LQ00420
       SLW     .CAREF              SET SOURCE CELL                      3LQ00430
       TRA     ACMOVE                                                   3LQ00440
ACEOF  LXA     ACIND,4                                                  3LQ00450
       SXD     *+2,4                                                    3LQ00460
       TSX     .CMPK3,4                                                 3LQ00470
       TXI     .CZEAN,1,**                                              3LQ00480
       LDI     ACIND                                                    3LQ00490
       CAL     ACSYTP                                                   3LQ00500
       LNT     400000                                                   3LQ00510
       CAL     ACSYCD                                                   3LQ00520
       SLW     ACMESS+2                                                 3LQ00530
       TSX     .CDPLY,4            ISSUE EOF MESSAGE                    3LQ00540
       PZE     ACMESS,,8                                                3LQ00550
       TRA     ACEXIT                                                   3LQ00560
ACMESS BCI     5,ACCEPT FROM ****** ENCOUNTERED                         3LQ00570
       BCI     7, END OF FILE. ZERO VALUE PROVIDED.                     3LQ00580
ACSYTP BCI     1,SYSIN1                                                 3LQ00590
ACSYCD BCI     1,SYSCRD                                                 3LQ00600
ACIMLO PZE     *+1                                                      3LQ00610
ACIM   BSS     12                                                       3LQ00620
ACIND  PZE     **                                                       3LQ00630
X      PZE     **                  BASE LOCATOR FOR CARDS               3LQ00640
ACIN1  FILE    ACIN1,IN1,BLK=24,MIN=24,MXBCD,OPTHCV,NOLIST              3LQ00650
ACCRD  FILE    ACCRD,CRD,BLK=24,MIN=24,MXBCD,REQHCV                     3LQ00660
       END                                                              3LQ00670
$IBMAP CDISP                                                         $5$3MD00000
       TTL     CDISP - COBOL DISPLAY SUBROUTINE                         3MD00009
*  COBOL DISPLAY SUBROUTINE                                          $5$3MD00010
       TTL     CDISP - COBOL DISPLAY ROUTINE                         (6)3MD00015
*  CALLING SEQUENCE                                                  $5$3MD00020
*      TSX     .CDPLY,4                                              $5$3MD00030
*      TXI     *+2+N,,N            (N = ITEM.COUNT)                  $5$3MD00040
*      PZE     DISPLAY.DEVICE.CODE,,LINKAGE.DIRECTOR                 $5$3MD00050
*      PZE     FWA.1,,BYTE.1                                         $5$3MD00060
*      PZE     FWA.2,,BYTE.2                                         $5$3MD00070
*       .        .      .                                            $5$3MD00080
*       .        .      .                                            $5$3MD00090
*       .        .      .                                            $5$3MD00100
*      PZE     FWA.N,,BYTE.N                                         $5$3MD00110
*      TRA     *+1+N                                                 $5$3MD00120
*      PZE     L.1,,FORMAT.CODE.1                                    $5$3MD00130
*      PZE     L.2,,FORMAT.CODE.2  (WHERE L.I = ITEM LENGTH OR THE   $5$3MD00140
*       .       .     .   .   .     ADDRESS OF A CELL CONTAINING     $5$3MD00150
*       .       .     .   .   .     THAT LENGTH - DEPENDING ON THE   $5$3MD00160
*       .       .     .   .   .     FORMAT CODE.)                    $5$3MD00170
*      PZE     L.N,,FORMAT.CODE.N                                    $5$3MD00180
*                                                                    $5$3MD00190
*  THE FORMAT CODES ARE                                              $5$3MD00200
*   0 = AN ITEMS, FIXED LENGTHS,        L.I. = LENGTH IN CHARACTERS  $5$3MD00210
*   1 = XD, SD, AND REPORT ITEMS        L.I. = LENGTH IN CHARACTERS  $5$3MD00220
*   2 = INTERNAL DECIMAL                L.I. = LENGTH IN CHARACTERS  $5$3MD00230
*      3 = FLOATING POINT,     L.I = LENGTH IN CHARACTERS            $5$3MD00240
*      4 = BCD,                L.I = CELL CONTAINING CHARACTER LENGTH$5$3MD00250
*      5 = BCD,                L.I = CELL CONTAINING WORD LENGTH     $5$3MD00260
*                                                                    $5$3MD00270
       ENTRY   .CDISP                                                $5$3MD00280
.CDISP SXA     CDV1,4              SET UP FIRST-VECTOR-WORD FETCH    $5$3MD00290
       SXD     LINECT,0            SET CUMULATIVE CHARACTER COUNT = 0$5$3MD00300
       CLA     1,4                                                   $5$3MD00310
       PDX     0,1                                                   $5$3MD00320
       SXA     ITEMS,1             SET UP WORKING ITEM COUNT         $5$3MD00330
       TXI     *+1,1,4                                               $5$3MD00340
       SXA     CDV2,1              SET UP SECOND-VECTOR-WORD FETCH   $5$3MD00350
       CLA     2,4                                                   $5$3MD00360
       PAX     0,1                 SOURCE LANGUAGE DEVICE CODE       $5$3MD00370
       TXL     CDF,1,0                                               $5$3MD00380
CDG    TSX     .CCDTY,4            BECOMES CDF-1                     $5$3MD00390
       PZE     DSPFIL                (.CCDTY DOES NOT DESTROY XR1)   $5$3MD00400
       TXI     *+3,1,-1            ADJUST TO ZERO                    $5$3MD00410
       TSX     .OPEN,4             IF SYSOU1 IS TAPE, OPEN FILE      $5$3MD00420
       MON     DSPFIL                (.OPEN DOES NOT DESTROY XR1)    $5$3MD00430
       SXA     *+2,1               SAVE OBJECT-TIME SYSOU1 CODE      $5$3MD00440
       STL     CDG                 SET ONCE THRU TRANSFER            $5$3MD00450
       AXT     **,1                                                  $5$3MD00460
CDF    SXA     DEVICE,1            SET OBJECT-TIME DEVICE CODE       $5$3MD00470
       AXT     72,2                                                  $5$3MD00480
       TXL     *+2,1,0            SELECT PRINT-LINE SIZE             $5$3MD00490
       AXT     120,2                                                 $5$3MD00500
       SXD     CDPAD,2                                               $5$3MD00510
       SXD     CDPLSZ,2            INITIALIZE LINE-SIZE TESTS        $5$3MD00520
       TXI     *+1,2,-1                                              $5$3MD00530
       SXD     CDPLSZ+1,2                                            $5$3MD00540
ITEMS  AXT     **,4                REMAINING ITEM COUNT              $5$3MD00550
       CLA     WCBREF                                                $5$3MD00560
       STO     .CBREF              SET NEW TARGET POINTER.           $5$3MD00570
       TXL     CDOUT,4,0           TRANSFER IF NONE LEFT             $5$3MD00580
       TXI     *+1,4,-1                                              $5$3MD00590
       SXA     ITEMS,4             UPDATE REMAINING ITEMS COUNT      $5$3MD00600
CDV1   AXT     **,4                                                  $5$3MD00610
       CLA     3,4                                                   $5$3MD00620
       STO     .CAREF              SET SOURCE POINTER                $5$3MD00630
CDV2   CLA     **,4                                                  $5$3MD00640
       TXI     *+1,4,-1                                              $5$3MD00650
       SXA     CDV1,4              SET UP FOR NEXT VECTOR-FETCH      $5$3MD00660
       PDX     0,4                 FORMAT CODE TO XR4                $5$3MD00670
       TXL     CDA,4,3             TRANSFER IF LENGTH IS KNOWN       $5$3MD00680
       TXL     *+3,4,5             IS FORMAT CODE 6                  (6)3MD00681
       STL     SIXTP               YES, LEAVE INDICATION             (6)3MD00682
       TXI     CDA,4,-4              AND TREAT AS IF CODE 2          (6)3MD00683
       STA     *+1                                                   $5$3MD00690
       LDQ     **                  GET LENGTH                        $5$3MD00700
       TXL     *+3,4,4                                               $5$3MD00710
       PXA     0,0                                                   $5$3MD00720
       MPY     L(6)                CONVERT TO CHARACTERS             $5$3MD00730
       XCA                                                           $5$3MD00740
       AXT     0,4                 RESET WORKING FORMAT CODE = 0     $5$3MD00750
CDA    PAX     0,1                 ITEM LENGTH TO XR1                $5$3MD00760
       PAX     0,2                                                   $5$3MD00770
LINECT TXI     *+1,2,**            CALCULATE AND SAVE CUMULATIVE     $5$3MD00780
       SXD     LINECT,2               CHARACTER COUNT                $5$3MD00790
CDPLSZ TIX     CDB,2,**            TRANSFER IF GT LINE-SIZE          $5$3MD00800
       TXL     *+3,2,**            TRANSFER IF LINE NOT FILLED       $5$3MD00810
       STL     PRNTSW              PRINT SWITCH ON IF LINE FILLED    $5$3MD00820
       TRA     CDFC2,4                                               $5$3MD00830
       PXA     0,2                                                   $5$3MD00840
       XCL                                                           $5$3MD00850
       PXA     0,0                                                   $5$3MD00860
       DVP     L(6)                                                  $5$3MD00870
       PAX     0,2                 CALCULATE AND SAVE NEXT           $5$3MD00880
       XCL                            TARGET POINTER                 $5$3MD00890
       ADD     ICBREF                                                $5$3MD00900
       STA     WCBREF                                                $5$3MD00910
       SXD     WCBREF,2                                              $5$3MD00920
       TRA     CDFC2,4                                               $5$3MD00930
       TRA     CDFC3               FP  = 3                           $5$3MD00940
       TRA     CDFC1         ID = 2                                  $5$3MD00950
       TRA     CDFC2              XD, SD, RPT = 1                    $5$3MD00960
CDFC2  SXD     *+2,1              BCD, XD, SD, RPT                   $5$3MD00970
       TSX     .CMPK3,4            MOVE BCD CHARACTERS               $5$3MD00980
       TXI     .CANA1,1,**                                           $5$3MD00990
       TRA     CDE                                                   $5$3MD01000
CDB    SXD     X,2                                                   $5$3MD01010
       SXA     D,1                 SAVE ITEM LENGTH                  $5$3MD01020
X      TIX     *+1,1,**                                              $5$3MD01030
       SXA     FCSAVE,4            SAVE WORKING FORMAT CODE          $5$3MD01040
       TXH     CDC,4,0             TRANSFER TO PAD OUT LINE          $5$3MD01050
       SXD     CDMLCH,1            SET NO. OF CHARS TO MOVE          $5$3MD01060
       TSX     .CMPK3,4            MOVE ENOUGH CHARACTERS TO         $5$3MD01070
CDMLCH TXI     .CANA1,1,**            FILL THE PRINT LINE            $5$3MD01080
       CLA     .CAREF                                                $5$3MD01090
       STD     *+1                                                   $5$3MD01100
       TXI     *+1,1,**                                              $5$3MD01110
       PXA     0,1                                                   $5$3MD01120
       XCL                                                           $5$3MD01130
       PXA     0,0                 CALCULATE AND SAVE NEXT .CAREF    $5$3MD01140
       DVP     L(6)                                                  $5$3MD01150
       PAX     0,1                                                   $5$3MD01160
       XCL                                                           $5$3MD01170
       ADD     .CAREF                                                $5$3MD01180
       STA     .CAREF                                                $5$3MD01190
       SXD     .CAREF,1                                              $5$3MD01200
       TRA     CDD                                                   $5$3MD01210
CDC    SXD     *+2,1                                                 $5$3MD01220
       TSX     .CMPK3,4            PAD OUT REST OF PRINT LINE        $5$3MD01230
       TXI     .CSPAN,1,**            WITH SPACES                    $5$3MD01240
CDD    TSX     SHOWIT+1,4          RESET .CBREF AND DISPLAY LINE     $5$3MD01250
FCSAVE AXT     **,4                RESTORE WORKING FORMAT CODE       $5$3MD01260
D      AXT     **,1                ORIGINAL ITEM LENGTH              $5$3MD01270
       TXH     *+2,4,0                                               $5$3MD01280
       LXD     X,1                 CHANGE TO EXCESS IF ITEM SPLIT    $5$3MD01290
       SXD     LINECT,1            RESET CUMULATIVE CHARACTER COUNT  $5$3MD01300
       LXD     LINECT,2               AND PUT IT IN XR2              $5$3MD01310
       TRA     CDPLSZ                                                $5$3MD01320
CDFC1  TXL     ITEMS,1,0           PROTECT AGAINST LENGTH = ZERO     $5$3MD01330
       TXL     *+2,1,18            PROTECT AGAINST LENGTH GT 18      $5$3MD01340
       AXT     18,1                                                  $5$3MD01350
       SXD     CDIDX1,1            SET CHARACTER LENGTH              $5$3MD01360
       NZT     SIXTP               WAS FORMAT CODE 6                 (6)3MD01361
       TRA     SIXTP+1             NO, NEEDS UNPACKING               (6)3MD01362
       STZ     SIXTP               YES, RESET SWITCH                 (6)3MD01363
       LAC     .CAREF,4            GET SOURCE IN REGISTERS           (6)3MD01364
       LDQ     1,4                                                   (6)3MD01365
       CLA     0,4                                                   (6)3MD01366
       TRA     CDINID+1                                              (6)3MD01367
SIXTP  PZE     0                                                     (6)3MD01368
       PXA     0,1                                                   $5$3MD01370
       LRS     1                                                     $5$3MD01380
       TXL     *+2,1,6                                               $5$3MD01390
       RND                         CALCULATE BYTE LENGTH             $5$3MD01400
       ACL     *-3                 (FAKE CONSTANT = 1)               $5$3MD01410
       TIX     *-1,1,17            SPECIAL CASE FOR 18               $5$3MD01420
       PAX     0,1                                                   $5$3MD01430
       SXD     CDINID,1            SET BYTE LENGTH                   $5$3MD01440
       TSX     .CMPK3,4                                              $5$3MD01450
CDINID TXI     .CINID,1,**         MOVE ITEM TO PRINT LINE           $5$3MD01460
       TSX     .CMPK3,4                                              $5$3MD01470
CDIDX1 TXI     .CIDX4,1,**                                           $5$3MD01480
       TRA     CDE                                                   $5$3MD01490
CDFC3  LAC     .CAREF,4            FLOATING POINT                    $5$3MD01500
       CLA     0,4                                                   $5$3MD01510
       TXL     CDFPSP,1,13                                           $5$3MD01520
       LDQ     1,4                                                   $5$3MD01530
       TSX     .CMPK3,4            DOUBLE PRECISION                  $5$3MD01540
       ENTRY   .CDIS2                                                (9)3MD01545
.CDIS2 TXI     CDSTR,1,0    ADDRESS ALTERED BY CDIF  AT OBJECT TIME  (9)3MD01550
*                           WHEN DISPLAY OF FLOATING POINT REQUIRED  (9)3MD01555
       MZE     16,3,21                                               $5$3MD01560
       TRA     CDE                                                   $5$3MD01570
CDFPSP TSX     .CMPK3,4            SINGLE PRECISION                  $5$3MD01580
       ENTRY   .CDIS1                                                (9)3MD01585
.CDIS1 TXI     CDSTR,1,0    ADDRESS ALTERED BY CDIF  AT OBJECT TIME  (9)3MD01590
*                           WHEN DISPLAY OF FLOATING POINT REQUIRED  (9)3MD01595
       MZE     8,3,13                                                $5$3MD01600
CDE    NZT     PRNTSW              PRINT SWITCH TEST                 $5$3MD01610
       TRA     ITEMS                  OFF - GO FOR ANOTHER ITEM      $5$3MD01620
       AXC     ITEMS-1,4              ON  - PRINT A LINE             $5$3MD01630
SHOWIT STZ     PRNTSW                                                $5$3MD01640
       SXA     SHOWX4,4                                              $5$3MD01650
DEVICE AXT     **,4                                                  $5$3MD01660
       TXL     SHOW1,4,0           TEST DEVICE CODE                  $5$3MD01670
CDCTR  AXT     **,4                                                  $5$3MD01680
       AXT     BLANKS,2                                              $5$3MD01690
       TXH     *+2,4,0             SELECT CARRIAGE CONTROL WORD      $5$3MD01700
       AXT     CARSKP,2                                              $5$3MD01710
       SXA     CRCNT,2             SET CARRIAGE CONTROL              $5$3MD01720
       TXI     *+1,4,1             UPDATE COUNTER                    $5$3MD01730
       TXL     *+2,4,56                                              $5$3MD01740
       AXT     0,4                 RESET COUNTER EVERY 57 LINES      $5$3MD01750
       SXA     CDCTR,4                                               $5$3MD01760
       TSX     .WRITE,4                                              $5$3MD01770
       PZE     DSPFIL,,.CEOBP      DISPLAY LINE ON SYSOU1            $5$3MD01780
CRCNT  IOCP    **,,1                                                 $5$3MD01790
       IOCD    PRNTLN,,20                                            $5$3MD01800
SHOWX4 AXT     **,4                                                  $5$3MD01810
       CLA     ICBREF                                                $5$3MD01820
       STO     WCBREF              REINITIALIZE WORKING TARGET POINTE$5$3MD01830
       STO     .CBREF              SET TARGET POINTER                $5$3MD01840
       SXD     LINECT,0           SET LINE LENGTH BACK TO ZERO       $5$3MD01850
       TRA     1,4                 EXIT SHOWIT SUBROUTINE            $5$3MD01860
SHOW1  TSX     .MWR,4                                                $5$3MD01870
       PZE     1                                                     $5$3MD01880
       PZE     PRNTLN,,12          DISPLAY 72 CHARACTERS ON-LINE     $5$3MD01890
       TRA     SHOWX4                                                $5$3MD01900
CDOUT  LDC     LINECT,4            IF NO MORE ITEMS                  $5$3MD01910
       TXL     CDEXIT,4,0          EMPTY LINE, BYPASS PADDING        $5$3MD01920
CDPAD  TXI     *+1,4,**            BUMP BY LINE SIZE                 $5$3MD01930
       TXL     CDEXIT,4,0                                            $5$3MD01940
       SXD     *+2,4                                                 $5$3MD01950
       TSX     .CMPK3,4            PAD OUT LINE WITH SPACES          $5$3MD01960
       TXI     .CSPAN,1,**                                           $5$3MD01970
       TSX     SHOWIT+1,4          DISPLAY IT, RESET TARGET POINTERS,$5$3MD01980
CDEXIT LXA     CDV1,4          AND EXIT                              $5$3MD01990
       TRA     3,4                                                   $5$3MD02000
CDSTR  STR                  ERRONEOUS ATTEMPT TO DISPLAY FLOATING    (9)3MD02005
*                           POINT WITHOUT GOING THRU CDIF            (9)3MD02006
       SPACE   2                                                     $5$3MD02010
*  CONSTANTS, TEMPORARY STORAGE (INCLUDING PRINT LINE), ETC.         $5$3MD02020
       SPACE   1                                                     $5$3MD02030
BLANKS BCI     1,                  CARRIAGE CONTROL NEW LINE         $5$3MD02040
CARSKP BCI     1,1                 CARRIAGE CONTROL NEW PAGE         $5$3MD02050
ICBREF PZE     PRNTLN              INITIAL .CBREF VALUE              $5$3MD02060
L(6)   PZE     6                   CONSTANT 6                        $5$3MD02070
PRNTLN BSS     20                  PRINT LINE                        $5$3MD02080
PRNTSW PZE     **                  PRINT SWITCH                      $5$3MD02090
WCBREF PZE     PRNTLN              WORKING TARGET POINTER (INIT VALUE$5$3MD02100
       SPACE   1                                                     $5$3MD02110
DSPFIL FILE    ,OU1,BLK=21,MIN=21,OUTPUT,NOLIST                      $5$3MD02120
       END                                                           $5$3MD02130
$IBMAP .CGOGO                                                        $5$3MF00000
       LBL     GOGO,BEGIN     .CGOGO                                 (7)3MF00007
.CGOGO SXA     X,4                 C(AC) = EITHER NOP FORTRAN-NAME   $5$3MF00010
       STA     Y                                                     $5$3MF00020
       STD     Z                                  TRA FORTRAN-NAME   $5$3MF00030
       CLA     4,4                 2ND. PARAM                        $5$3MF00040
       STO     Y+3                 PUT IN FORTRAN CALLING SEQ.       $5$3MF00050
       CLA     5,4                 3RD PARAM                         $5$3MF00060
       STO     Y+4                                                   $5$3MF00070
Y      CALL    **(Y,Y)             CALL UPON FORTRAN S.R.            $5$3MF00080
X      AXT     **,4                                                  $5$3MF00090
       STO*    3,4                 AC PART OF ANSWER                 $5$3MF00100
Z      PZE     1,4,**              ** DETERMINES OP-CODE TRA OR NOP  $5$3MF00110
       CLA     3,4                 IF DOUBLE PRECISION               $5$3MF00120
       ADD     L1                   FIND LOC OF 2ND. PART OF ANSWER I$5$3MF00130
       STA     *+1                                                   $5$3MF00140
       STQ     **                  2ND HALF OF RESULT IS IN MQ.      $5$3MF00150
       TRA     1,4                 EXIT                              $5$3MF00160
L1     PZE     1                                                     $5$3MF00170
       END                                                           $5$3MF00180
$IBMAP .CXP1                                                         $5$3MF00190
       LBL     CXP1,BEGIN     .CXP1                                  (7)3MF00193
.CXP1  CAL     *+2            A ** B                                 $5$3MF00200
       TRA     .CGOGO                                                $5$3MF00210
       TRA     .XP1.                                                 $5$3MF00220
       END                                                           $5$3MF00230
$IBMAP .CXP2                                                         $5$3MF00240
       LBL     CXP2,BEGIN     .CXP2                                  (7)3MF00243
.CXP2  CAL     *+2            A ** B                                 $5$3MF00250
       TRA     .CGOGO                                                $5$3MF00260
       TRA     .XP2.                                                 $5$3MF00270
       END                                                           $5$3MF00280
$IBMAP .CXP3                                                         $5$3MF00290
       LBL     CXP3,BEGIN     .CXP3                                  (7)3MF00293
.CXP3  CAL     *+2            A ** B                                 $5$3MF00300
       TRA     .CGOGO                                                $5$3MF00310
       TRA     .XP3.                                                 $5$3MF00320
       END                                                           $5$3MF00330
$IBMAP .CEXP                                                         $5$3MF00340
       LBL     CEXP,BEGIN     .CEXP                                  (7)3MF00343
.CEXP  CAL     *+2            E ** A                                 $5$3MF00350
       TRA     .CGOGO                                                $5$3MF00360
       TRA     EXP                                                   $5$3MF00370
       END                                                           $5$3MF00380
$IBMAP .CALOG                                                        $5$3MF00390
       LBL     CLOG,BEGIN     .CALOG                                 (7)3MF00393
.CALOG CAL     *+2            LN (A)                                 $5$3MF00400
       TRA     .CGOGO                                                $5$3MF00410
       TRA     ALOG                                                  $5$3MF00420
       ENTRY   .CAL10                                                $5$3MF00430
.CAL10 CAL     *+2            LOG BASE 10 (A)                        $5$3MF00440
       TRA     .CGOGO                                                $5$3MF00450
       TRA     ALOG10                                                $5$3MF00460
       END                                                           $5$3MF00470
$IBMAP .CATAN                                                        $5$3MF00480
       LBL     CATN,BEGIN     .CATAN                                 (7)3MF00483
.CATAN CAL     *+2            ARCTAN (A)                             $5$3MF00490
       TRA     .CGOGO                                                $5$3MF00500
       TRA     ATAN                                                  $5$3MF00510
       ENTRY   .CATN2                                                $5$3MF00520
.CATN2 CAL     *+2            ARCTAN (A/B)                           $5$3MF00530
       TRA     .CGOGO                                                $5$3MF00540
       TRA     ATAN2                                                 $5$3MF00550
       END                                                           $5$3MF00560
$IBMAP .CSIN                                                         $5$3MF00570
       LBL     CSIN,BEGIN     .CSIN                                  (7)3MF00573
.CSIN  CAL     *+2            SIN (A)                                $5$3MF00580
       TRA     .CGOGO                                                $5$3MF00590
       TRA     SIN                                                   $5$3MF00600
       ENTRY   .CCOS                                                 $5$3MF00610
.CCOS  CAL     *+2            COS (A)                                $5$3MF00620
       TRA     .CGOGO                                                $5$3MF00630
       TRA     COS                                                   $5$3MF00640
       END                                                           $5$3MF00650
$IBMAP .CTANH                                                        $5$3MF00660
       LBL     CTNH,BEGIN     .CTANH                                 (7)3MF00663
.CTANH CAL     *+2            TANH (A)                               $5$3MF00670
       TRA     .CGOGO                                                $5$3MF00680
       TRA     TANH                                                  $5$3MF00690
       END                                                           $5$3MF00700
$IBMAP .CSQRT                                                        $5$3MF00710
       LBL     CSQR,BEGIN     .CSQRT                                 (7)3MF00713
.CSQRT CAL     *+2                 SQRT (A)                          $5$3MF00720
       TRA     .CGOGO                                                $5$3MF00730
       TRA     SQRT                                                  $5$3MF00740
       END                                                           $5$3MF00750
$IBMAP .CDMOD                                                        $5$3MF00760
       LBL     CDMD,BEGIN     .CDMOD                                 (7)3MF00763
.CDMOD CAL     *+2            A  MOD B                               $5$3MF00770
       TRA     .CGOGO                                                $5$3MF00780
       NOP     DMOD                                                  $5$3MF00790
       END                                                           $5$3MF00800
$IBMAP .CDXP1                                                        $5$3MF00810
       LBL     CDX1,BEGIN     .CDXP1                                 (7)3MF00813
.CDXP1 CAL     *+2            A ** B                                 $5$3MF00820
       TRA     .CGOGO                                                $5$3MF00830
       NOP     .DXP1.                                                $5$3MF00840
       ENTRY   .CCXP1                                                $5$3MF00850
.CCXP1 CAL     *+2            A ** B                                 $5$3MF00860
       TRA     .CGOGO                                                $5$3MF00870
       NOP     .CXP1.                                                $5$3MF00880
       END                                                           $5$3MF00890
$IBMAP .CDXP2                                                        $5$3MF00900
       LBL     CDX2,BEGIN     .CDXP2                                 (7)3MF00903
.CDXP2 CAL     *+2            A ** B                                 $5$3MF00910
       TRA     .CGOGO                                                $5$3MF00920
       NOP     .DXP2.                                                $5$3MF00930
       END                                                           $5$3MF00940
$IBMAP .CDEXP                                                        $5$3MF00950
       LBL     CDXP,BEGIN     .CDEXP                                 (7)3MF00953
.CDEXP CAL     *+2            E ** A                                 $5$3MF00960
       TRA     .CGOGO                                                $5$3MF00970
       NOP     DEXP                                                  $5$3MF00980
       END                                                           $5$3MF00990
$IBMAP .CDLOG                                                        $5$3MF01000
       LBL     CDLG,BEGIN     .CDLOG                                 (7)3MF01003
.CDLOG CAL     *+2            LN (A)                                 $5$3MF01010
       TRA     .CGOGO                                                $5$3MF01020
       NOP     DLOG                                                  $5$3MF01030
       ENTRY   .CDL10                                                $5$3MF01040
.CDL10 CAL     *+2            LOG BASE 10 (A)                        $5$3MF01050
       TRA     .CGOGO                                                $5$3MF01060
       NOP     DLOG10                                                $5$3MF01070
       END                                                           $5$3MF01080
$IBMAP .CDSQR                                                        $5$3MF01090
       LBL     CDSQ,BEGIN     .CDSQR                                 (7)3MF01093
.CDSQR CAL     *+2                 SQRT (A)                          $5$3MF01100
       TRA     .CGOGO                                                $5$3MF01110
       NOP     DSQRT                                                 $5$3MF01120
       END                                                           $5$3MF01130
$IBMAP .CDSIN                                                        $5$3MF01140
       LBL     CDSN,BEGIN     .CDSIN                                 (7)3MF01143
.CDSIN CAL     *+2            SIN (A)                                $5$3MF01150
       TRA     .CGOGO                                                $5$3MF01160
       NOP     DSIN                                                  $5$3MF01170
       ENTRY   .CDCOS                                                $5$3MF01180
.CDCOS CAL     *+2            COS (A)                                $5$3MF01190
       TRA     .CGOGO                                                $5$3MF01200
       NOP     DCOS                                                  $5$3MF01210
       END                                                           $5$3MF01220
$IBMAP .CDATN                                                        $5$3MF01230
       LBL     CDAT,BEGIN     .CDATN                                 (7)3MF01233
.CDATN CAL     *+2            ARCTAN (A)                             $5$3MF01240
       TRA     .CGOGO                                                $5$3MF01250
       NOP     DATAN                                                 $5$3MF01260
       ENTRY   .CDAT2                                                $5$3MF01270
.CDAT2 CAL     *+2            ARCTAN (A/B)                           $5$3MF01280
       TRA     .CGOGO                                                $5$3MF01290
       NOP     DATAN2                                                $5$3MF01300
       END                                                           $5$3MF01310
$IBMAP .CCFMP                                                        $5$3MF01320
       LBL     CFMP,BEGIN     .CCFMP                                 (7)3MF01323
.CCFMP CAL     *+2            A * B                                  $5$3MF01330
       TRA     .CGOGO                                                $5$3MF01340
       NOP     .CFMP.                                                $5$3MF01350
       ENTRY   .CCFDP                                                $5$3MF01360
.CCFDP CAL     *+2            A / B                                  $5$3MF01370
       TRA     .CGOGO                                                $5$3MF01380
       NOP     .CFDP.                                                $5$3MF01390
       END                                                           $5$3MF01400
$IBMAP .CCABS                                                        $5$3MF01410
       LBL     CCAB,BEGIN     .CCABS                                 (7)3MF01413
.CCABS CAL     *+2            ABSOLUTE A                             $5$3MF01420
       TRA     .CGOGO                                                $5$3MF01430
       NOP     CABS                                                  $5$3MF01440
       END                                                           $5$3MF01450
$IBMAP .CCEXP                                                        $5$3MF01460
       LBL     CCXP,BEGIN     .CCEXP                                 (7)3MF01463
.CCEXP CAL     *+2            E ** A                                 $5$3MF01470
       TRA     .CGOGO                                                $5$3MF01480
       NOP     CEXP                                                  $5$3MF01490
       END                                                           $5$3MF01500
$IBMAP .CCLOG                                                        $5$3MF01510
       LBL     CCLG,BEGIN     .CCLOG                                 (7)3MF01513
.CCLOG CAL     *+2            LN (A)                                 $5$3MF01520
       TRA     .CGOGO                                                $5$3MF01530
       NOP     CLOG                                                  $5$3MF01540
       END                                                           $5$3MF01550
$IBMAP .CCSQR                                                        $5$3MF01560
       LBL     CCSQ,BEGIN     .CCSQR                                 (7)3MF01563
.CCSQR CAL     *+2                 SQRT (A)                          $5$3MF01570
       TRA     .CGOGO                                                $5$3MF01580
       NOP     CSQRT                                                 $5$3MF01590
       END                                                           $5$3MF01600
$IBMAP .CCSIN                                                        $5$3MF01610
       LBL     CCSN,BEGIN     .CCSIN                                 (7)3MF01613
.CCSIN CAL     *+2            SIN (A)                                $5$3MF01620
       TRA     .CGOGO                                                $5$3MF01630
       NOP     CSIN                                                  $5$3MF01640
       ENTRY   .CCCOS                                                $5$3MF01650
.CCCOS CAL     *+2            COS (A)                                $5$3MF01660
       TRA     .CGOGO                                                $5$3MF01670
       NOP     CCOS                                                  $5$3MF01680
       END                                                           $5$3MF01690
$IBMAP .CTAN                                                            3MG00010
.CTAN  CAL     *+2                 TAN (A)                              3MG00020
       TRA     .CGOGO                                                   3MG00030
       TRA     TAN                                                      3MG00040
       ENTRY   .CCOTN                                                   3MG00050
.CCOTN CAL     *+2                COTAN (A)                             3MG00060
       TRA     .CGOGO                                                   3MG00070
       TRA     COTAN                                                    3MG00080
       END                                                              3MG00090
$IBMAP .CARSN                                                           3MG00100
.CARSN CAL     *+2                ARCSIN (A)                            3MG00110
       TRA     .CGOGO                                                   3MG00120
       TRA     ARSIN                                                    3MG00130
       ENTRY   .CARCS                                                   3MG00140
.CARCS CAL     *+2                 ARCCOS (A)                           3MG00150
       TRA     .CGOGO                                                   3MG00160
       TRA     ARCOS                                                    3MG00170
       END                                                              3MG00180
$IBMAP .CSINH                                                           3MG00190
.CSINH CAL     *+2                SINH (A)                              3MG00200
       TRA     .CGOGO                                                   3MG00210
       TRA     SINH                                                     3MG00220
       ENTRY   .CCOSH                                                   3MG00230
.CCOSH CAL     *+2                 COSH (A)                             3MG00240
       TRA     .CGOGO                                                   3MG00250
       TRA     COSH                                                     3MG00260
       END                                                              3MG00270
$IBMAP .CERF                                                            3MG00280
.CERF  CAL     *+2                ERF (A)                               3MG00290
       TRA     .CGOGO                                                   3MG00300
       TRA     ERF                                                      3MG00310
       END                                                              3MG00320
$IBMAP .CGAMA                                                           3MG00330
.CGAMA CAL     *+2                GAMMA (A)                             3MG00340
       TRA     .CGOGO                                                   3MG00350
       TRA     GAMMA                                                    3MG00360
       ENTRY   .CALGM              LOG OF GAMMA(A)                      3MG00370
.CALGM CAL     *+2                                                      3MG00380
       TRA     .CGOGO                                                   3MG00390
       TRA     ALGAMA                                                   3MG00400
       END                                                              3MG00410
$IBMAP .CBBLE  LIST,DECK,300                                            3MH00000
       TTL     BLOCKING AND DEBLOCKING COBOL FILES                  (11)3MH00009
*    THIS SR BLOCKS (WRITE) AND DEBLOCKS (READ) FILES FOR COBOL     (10)3MH00010
*                OBJECT TIME PROGRAMS.     DATA USED ARE...         (10)3MH00020
*              S = WD. COUNT REQUESTED IN CALLING SEQ.,             (10)3MH00030
*              M = WORD COUNT REMAINING IN BUFFER,                  (10)3MH00040
*              B = L(NX.WD.IN.BUFFER).                              (10)3MH00050
       ENTRY   .CBBLR                                               (10)3MH00060
       ENTRY   .CBBLW                                               (10)3MH00070
       ENTRY   .CBCLO                                               (10)3MH00080
.CBCLO TRA     .CCLOS        USE STANDARD COBOL CLOSE ROUTINE       (11)3MH00085
.CBBLR STL     RDSW           RDSW NOT = 0                          (10)3MH00090
       TRA     *+2                                                  (10)3MH00100
.CBBLW STZ     RDSW           RDSW = 0                              (10)3MH00110
       CLA     2,4           SETUP READ ERROR RETURNS               (11)3MH00120
       STO     CBDURD+2                                             (11)3MH00122
       SXA     NORM1,1       SAVE REGISTERS                         (11)3MH00124
       SXA     NORM1+1,2                                            (11)3MH00126
       STI     CBIND                                                (11)3MH00128
       STZ     EXIT           INITIALIZE EXIT = 0                   (10)3MH00130
       CAL     1,4            PZE FN                                (10)3MH00140
       TXI     *+1,4,-3      POINT IR4 TO FIRST COMMAND             (11)3MH00150
       NZT     RDSW                                                 (11)3MH00160
       TXI     *+1,4,1          WRITE REQUEST                       (11)3MH00170
       SXA     X,4           AND SAVE                               (11)3MH00180
       PAC     ,2            IR2 = -L(FCB)                          (11)3MH00190
       STA     CBDURD+1      INITIALIZE .IOCS CALLS                 (11)3MH00200
       STA     PUTBUF+1                                             (11)3MH00210
       CLA*    2,2           IS THERE A BUFFER ATTACHED NORMALLY    (11)3MH00220
       TPL     CBCOM            TRANSFER IF YES                     (11)3MH00230
       ZET     RDSW             NO, SEPERATE READ FROM WRITE        (11)3MH00240
       TRA     *+3              READ                                (11)3MH00250
       TSX     PUTBUF,1      WRITE, GET BUFFER                      (11)3MH00260
       TRA     CBCOM                                                (11)3MH00270
       LDI     TCHXXX        SETUP NULL COMMAND FOR UPDATE          (11)3MH00280
       TSX     GETBUF,1         AND GET INPUT BUFFER                (11)3MH00290
 CBCOM LDI     0,4           FIRST COMMAND TO INDICATORS            (11)3MH00540
       NZT     RDSW                                                 (10)3MH00550
       TRA     CBBLW                                                (10)3MH00560
       ONT     IOCTNA         IOCTN* MASK...                        (10)3MH00570
       TRA     CBBL1          NO, NEXT MASK TEST                    (10)3MH00580
CBBL10 TSX     UPDATE,1                                             (10)3MH00590
       TSX     GETBUF,1                                             (10)3MH00600
CBBL4  RIR     700000                                               (10)3MH00610
       STI     PNT            C (ADDR)=L(BL)                        (10)3MH00620
       STA*    PNT            B TO BL                               (10)3MH00630
       TRA     NORM1          OUT                                   (10)3MH00640
CBBL1  ONT     IOCPXX         IOCP INST...                          (10)3MH00650
       TRA     CBBL2          NO                                    (10)3MH00660
       OFT     XXXXNA         PERHAPS,ENSURE N,* OFF                (10)3MH00670
       TRA     CBBL2          NO                                    (10)3MH00680
       TSX     UPDATE,1           UPDATE                            (10)3MH00690
       TSX     GETBUF,1           OBTAIN NEW BUFFER FOR READ        (10)3MH00700
       STA     PNT                                                  (10)3MH00710
       CAL*    PNT                                                  (10)3MH00720
       SLW*    0,4                                                  (10)3MH00730
       LFT     100000             IOCT OR IOCP ...                  (10)3MH00740
       TRA     NORM1              IOCT, FINISHED                    (10)3MH00750
       TXI     *+1,4,-1           IOCP, CONTINUE WITH NEXT IOXY TYPE(10)3MH00760
       LDI     0,4                                                  (10)3MH00770
       SXA     X,4            UPDATE X                              (10)3MH00780
       ONT     IOCTNX         IOCTN INSTR                           (10)3MH00790
       TRA     ILLEX          NO,ILLEGAL                            (10)3MH00800
       OFT     XXXXXA         PERHAPS,ENSURE * OFF                  (10)3MH00810
       TRA     ILLEX          NO,ILLEGAL                            (10)3MH00820
       TSX     UPDATE,1                                             (10)3MH00830
       TSX     GETBUF,1                                             (10)3MH00840
       STA     0,4            B TO CALLING SEQ                      (10)3MH00850
       TRA     NORM1                                                (10)3MH00860
CBBL2  ONT     TCHXXX         TCH INSTR                             (10)3MH00870
       TRA     ILLEX          NO,ILLEGAL                            (10)3MH00880
       OFT     XXXQQQ         YES,PERHAPS                           (10)3MH00890
       TRA     ILLEX          NO,ILLEGAL                            (10)3MH00900
       SXA     EXIT,4         C (EXIT) = - X                        (10)3MH00910
       PIA                                                          (10)3MH00920
       PAC     0,4            C(ADDR) BECOMES X                     (10)3MH00930
       SXA     X,4            UPDATE X                              (10)3MH00940
       LDI     0,4            C(IND) = NEW X                        (10)3MH00950
       LFT     700000       IOCDN  INSTRUCTION...                   (10)3MH00960
       TRA     CBBL3          NO                                    (10)3MH00970
       RNT     200000                                               (10)3MH00980
       TRA     CBBL3                                                (10)3MH00990
       OFT     XXXXXA         YES,PERHAPS                           (10)3MH01000
       TRA     CBBL3          NO                                    (10)3MH01010
       TSX     UPDATE,1                                             (10)3MH01020
       TSX     GETBUF,1                                             (10)3MH01030
       STA     0,4           LOC OF NEXT WORD                       (11)3MH01040
       ZAC                   SIMULATE BUFFER DISCONNECT             (11)3MH01050
       STD*    2,2                                                  (11)3MH01060
       TRA     NORM1            AND EXIT                            (11)3MH01070
CBBL3  NZT     RDSW                                                 (10)3MH01080
       TRA     CBBL5          WRITE SIDE                            (10)3MH01090
CBBL8  ONT     IOCPNX         IOCPN...                              (10)3MH01100
       TRA     ILLEX                                                (10)3MH01110
       OFT     XXXXXA                                               (10)3MH01120
       TRA     ILLEX                                                (10)3MH01130
       TSX     UPDATE,1       UPDATE B,,M                           (10)3MH01140
       TSX     GETBUF,1       GET NEW BUFFER                        (10)3MH01150
       STA     0,4            PUT B IN CALLING SEQ                  (10)3MH01160
       TXI     *+1,4,-1       X = X + 1                             (10)3MH01170
       SXA     X,4            UPDATE X                              (10)3MH01180
       LDI     0,4            NEW X                                 (10)3MH01190
       ONT     IOCTNA         IOCTN*...                             (10)3MH01200
       TRA     ILLEX          NO,ERROR                              (10)3MH01210
       TRA     CBBL10                                               (10)3MH01220
CBBLW  BSS     0                                                    (10)3MH01230
CBBL5  OFT     XXXXXA         INDIRECT REF...                       (10)3MH01240
       TRA     CBBL6        YES, CANNOT BE IORPN OR IOCPN           (10)3MH01250
       ONT     IOCPNX                                               (10)3MH01260
       TRA     *+2                                                  (10)3MH01270
       TRA     *+3            IORPN AND IOCPN O. K.                 (10)3MH01280
       ONT     IORPNX                                               (10)3MH01290
       TRA     CBBL6                                                (10)3MH01300
       TSX     UPDATE,1       UPDATE                                (10)3MH01310
       TRA     EOBEX         ENOUGH ROOM NOT LOCATED LAST TIME      (11)3MH01320
       STA     0,4           SET LOCATOR INTO CALLING SEQ.          (11)3MH01330
       ZAC                   ASSUME LAST RECORD IN BLOCK            (11)3MH01332
       ONT     IOCPNX           IORPN   ...                         (11)3MH01334
       STD*    2,2              YES, SET FOR BUFFER DISCONNECT      (11)3MH01336
       TXI     *+1,4,-1       X = X + 1                             (10)3MH01340
       SXA     X,4          SAVE  X                                 (10)3MH01350
       LDI     0,4            NEXT INSTR                            (10)3MH01360
CBBL6  ONT     IOSTNA         IOSTN*...                             (10)3MH01370
       TRA     CBBL2          NO                                    (10)3MH01380
       PIA                   PROCESS  IOSTN*  ON OUTPUT             (11)3MH01390
       PDX     ,1            IR1 = WORD COUNT                       (11)3MH01400
       CLA*    2,2           PICK UP BUFFER CONTROL WORD            (11)3MH01410
       STD     *+1              AND CHECK FOR ENOUGH ROOM           (11)3MH01420
       TXL     *+2,1,**                                             (11)3MH01430
       TSX     PUTBUF,1      M L.T. S, PUT BUFFER OUT, FIND NEXT    (10)3MH01460
       TRA     CBBL4         GO TO SET B INTO BL                    (10)3MH01470
*                                                                   (10)3MH01700
*      SUBROUTINES            (INTERNAL ONLY)                       (10)3MH01710
* ASSUME UPON ENTRY... C(AC) = CBTBLN ENTRY, PZE   B,,M             (10)3MH01720
*                      C (XR2) = DISPL WITHIN CBTBLN TABLE          (10)3MH01730
*                                                                   (10)3MH01740
UPDATE PIA                   COMMAND TO AC                          (11)3MH01750
       STD     PZED          SETUP DISPLACEMENT COUNT               (11)3MH01760
       ARS     18                                                   (11)3MH01770
       STA     PZEA                                                 (11)3MH01780
       CAL*    2,2           PICK UP BUFFER CONTROL WORD            (11)3MH01790
       ANA     ADMASK           AND ISOLATE  LOCATOR,,WORDS LEFT    (11)3MH01800
       SUB     PZED          CHECK FOR ENOUGH ROOM                  (11)3MH01810
       TMI     1,1           TAKE EOB RETURN IF NOT                 (11)3MH01820
       ADD     PZEA          ADJUST LOCATOR                         (11)3MH01830
       STD*    2,2              AND UPDATE IOCS BUFFER CONTROL WORD (11)3MH01840
       STA*    2,2                                                  (11)3MH01850
       SUB     PZEA          ADDR(AC) = AVAILABLE LOCATION          (11)3MH01860
       TRA     2,1           NORMAL EXIT                            (11)3MH01870
* GET A NEW BUFFER (READ).                                          (10)3MH01890
GETBUF CLA*    2,2           IF BUFFER ATTACHED NORMALLY,           (11)3MH01900
       TMI     *+3                                                  (11)3MH01910
       ZAC                      FORCE BUFFER RELEASE                (11)3MH01920
       STD*    2,2                                                  (11)3MH01930
CBDURD TSX     .READ,4        DUMMY READ                            (10)3MH01950
       PZE     **,,0                                                (11)3MH01960
       PZE     **,,**                                               (10)3MH01970
       IOCTN   **,,1         LOCATE NEXT BUFFER AND SKIP ONE WORD   (11)3MH01980
       CAL*    2,2           BACK OVER WORD SKIPPED                 (11)3MH01990
       SUB     ADDR1                                                (11)3MH01995
       ADD     DCR1                                                 (11)3MH02000
       SLW*    2,2                                                  (11)3MH02010
X      AXT     **,4           X POINTER IN ADDR                     (10)3MH02020
       SXA     *+3,1                                                (10)3MH02030
       TSX     UPDATE,1                                             (10)3MH02040
       TRA     EOBEX          BUFFER LENGTH L.T.S                   (10)3MH02050
       AXT     **,1                                                 (10)3MH02060
       TRA     1,1            EXIT FROM GETBUF                      (10)3MH02070
*                                                                   (10)3MH02080
* GET A NEW BUFFER (WRITE).                                         (10)3MH02090
PUTBUF TSX     .WRITE,4      OUTPUT PRESENT BUFFER AND GET NEXT     (11)3MH02100
       PZE     **,,0                                                (11)3MH02110
       IOSTN   **,,-1                                               (11)3MH02120
       CAL*    2,2           AC = LOCATOR,,WORDS LEFT               (11)3MH02130
       LXA     X,4            C(XR4) = - X                          (10)3MH02510
       TRA     1,1                                                  (10)3MH02530
 NORM1 AXT     **,1          RESTORE REGISTERS                      (11)3MH02540
       AXT     **,2                                                 (11)3MH02542
       LDI     CBIND                                                (11)3MH02544
       NZT     EXIT          TCH EXECUTED...                        (11)3MH02546
       TRA     1,4            EXIT FOR NON TCH                      (10)3MH02550
       LXA     EXIT,4                                               (10)3MH02560
       TRA     1,4            EXIT FOR TCH                          (10)3MH02570
 CBIND                                                              (11)3MH02575
 EOBEX AXC     CBDURD,4      FORCE EOB DIAGNOSTIC FOR THIS FILE     (11)3MH02580
       PXD     ,4                                                   (11)3MH02590
       XCA                                                          (11)3MH02600
       TRA     .CEOBP                                               (11)3MH02610
ILLEX  CALL    .CDISP(M1)'0'                                        (10)3MH02620
       TRA     *+2                                                  (10)3MH02630
       PZE     72                                                   (10)3MH02640
       STR                                                          (10)3MH02650
M1     BCI     6, CALL UPON .CBBLE SUBROUTINE HAS ILL               (10)3MH02660
       BCI     6,EGAL CALLING SEQUENCE. CORE DUMPED.                (10)3MH02670
*                                                                   (10)3MH02680
*      CONSTANTS                                                    (10)3MH02690
*                                                                   (10)3MH02700
RDSW   PZE     **             NON-ZERO READ,ZERO WRITE              (10)3MH02710
EXIT   PZE     **             0 IF NO TCH, NON-0 IF TCH             (10)3MH02720
PNT    PZE     **                                                   (10)3MH02730
PZEA   PZE     **,0,0                                               (10)3MH02740
PZED   PZE     0,0,**                                               (10)3MH02750
 ADDR1 PZE     1                                                    (11)3MH02752
DCR1   PZE     0,,1                                                 (10)3MH02755
ADMASK OCT     077777077777                                         (10)3MH02760
IOCTNA IOCTN*  0,,0           POS INSTRUCTION MASKA                 (10)3MH02780
IOCPXX IOCP    0,,0                                                 (10)3MH02790
IOCTNX IOCTN   0,,0                                                 (10)3MH02800
TCHXXX TCH     0                                                    (10)3MH02810
IOCPNX IOCPN   0,,0                                                 (10)3MH02830
IORPNX IORPN   0,,0                                                 (10)3MH02840
IOSTNA IOSTN*  0,,0                                                 (10)3MH02850
XXXXNA OCT     000000600000   NEG. INSTRUCTION MASKS                (10)3MH02860
XXXXXA OCT     000000400000                                         (10)3MH02870
XXXQQQ SYN     XXXXXA                                               (10)3MH02890
       END                                                          (10)3MH02920
$IBMAP CDIF                                                             3MI00000
       TTL     CDIF - ROUTINE TO MODIFY CDISP FOR CFPAK                 3MI00009
*  COBOL DISPLAY SUBROUTINE FOR FLOATING POINT TO BE USED IN            3MI00010
*                                              CONJUNCTION WITH CD2SP   3MI00020
       ENTRY   .CDISF                                                   3MI00030
.CDISF TRA     *+1                                                      3MI00040
       CAL     C1                                                       3MI00050
       STA     .CDIS1                                                   3MI00060
       CAL     C2                                                       3MI00070
       STA     .CDIS2                                                   3MI00080
       CAL     *+2                                                      3MI00090
       SLW     .CDISF                                                   3MI00100
       TRA     .CDISP                                                   3MI00110
                                                                        3MI00120
C1     PZE     .CF1SD                                                   3MI00130
C2     PZE     .CF2SD                                                   3MI00140
       END                                                              3MI00150
$*     7090/7094 IBLIB SYSTEM LIBRARY - .RAND                           3RN00000
$IBMAP .RAND   1600,()OK                                                3RN00010
       LBL     RAND,BEGIN     .RAND                                  (7)3RN00013
       TTL     .RAND/1301 RANDOM IOCS                                   3RN00020
*                                                                       3RN00030
       ENTRY   .RANDE                                                   3RN00040
       ENTRY   .RANRE                                                   3RN00050
       ENTRY   .RANCL                                                   3RN00060
       ENTRY   .RANRP                                                   3RN00070
       ENTRY   .RANFL                                                   3RN00080
       ENTRY   .RANCA                                                   3RN00090
IOEX   EQU     .ACTV                                                    3RN00120
(ACTIV EQU     IOEX                                                     3RN00130
(PROUT EQU     IOEX+4                                                   3RN00140
(DECVA EQU     IOEX+12                                                  3RN00150
(BCD5R EQU     IOEX+14                                                  3RN00160
(URRXI EQU     IOEX+19                                                  3RN00170
(RCTXI EQU     IOEX+20                                                  3RN00180
(RCHXI EQU     IOEX+21                                                  3RN00190
(TRAPX EQU     IOEX+26                                                  3RN00200
(FDAMT EQU     IOEX+33                                                  3RN00210
       TITLE                                                            3RN00220
       SPACE                                                            3RN00230
*                      COMMUNICATION REGION                             3RN00240
       SPACE                                                            3RN00250
.RANDE STL     DEREJ                                                    3RN00260
       TXL     ENTER,,RNDEF                                             3RN00270
.RANRE STL     DEREJ                                                    3RN00280
       TXL     ENTER,,RNREQ                                             3RN00290
.RANCL STL     DEREJ                                                    3RN00300
       TXL     ENTER,,RNCLS                                             3RN00310
.RANRP TRA     RNRPL                                                    3RN00320
.RANFL PZE     RANFLG                                                   3RN00330
.RANCA PZE     RANCAV                                                   3RN00340
       SPACE                                                            3RN00350
*                      STORAGE CELLS                                    3RN00360
RANFLG PZE     **                                                       3RN00361
RANCAV PZE     **                                                       3RN00362
       SPACE                                                            3RN00370
PQUEUE PZE     **,2                QUEUE,2   QUEUE SEGMENT POINTER      3RN00380
SQUEUE PZE                         QUEUE+S   QUEUE POOL CONTROL WORD    3RN00390
L(S)   PZE                         S, REQUEST BUFFER COUNT              3RN00400
L(R)   PZE                         R, BETA RECORD WORD COUNT            3RN00410
PDRHA  PZE                         DRHA POOL CONTROL WORD               3RN00420
RSENS  PZE                         SENSE INDICATORS STORAGE             3RN00430
CLSFLG PZE                         CLOSE FLAG                           3RN00440
RTNFLG PZE                         RETAIN FLAG                          3RN00450
SENSW  PZE                         SENSE WORD AT SEL(-)                 3RN00460
ERRFLG PZE                         ERROR FLAG                           3RN00470
ERRIND PZE                         UNRECOVERABLE ERROR                  3RN00480
       SPACE                                                            3RN00490
*                      CONSTANTS AND MASKS                              3RN00500
       SPACE                                                            3RN00510
L(0)   PZE                                                              3RN00520
L(1)   PZE     1                                                        3RN00530
L(6)   PZE     6                                                        3RN00540
ADDR   OCT     000000077777                                             3RN00550
DECRE  OCT     077777000000                                             3RN00560
1DECR  OCT     000001000000                                             3RN00570
MSK1   OCT     600000606060                                             3RN00580
MSK3   OCT     770777777777                                             3RN00590
MSK2   OCT     200000000000        HEADER                               3RN00600
MSK4   OCT     004000000000        SEEK AND READ WAITING                3RN00610
MSK7   OCT     001000000000        PROCESSING WAITING                   3RN00620
MSK8   OCT     000300000000                                             3RN00630
MSK9   OCT     040000000000        COMMON BETA CHAIN HEADER             3RN00640
MSK10  OCT     020000000000        MUTUAL DEPENDENCE                    3RN00650
MSK11  OCT     000200000000        SEEK AND WRITE WAITING               3RN00660
MSK12  OCT     770077777777                                             3RN00670
MSK13  OCT     100600000000                                            *3RN00680
MSK14  OCT     777777770000                                             3RN00690
MSK15  OCT     000077777777                                             3RN00700
MSK17  OCT     000100000000        SEEK AND WRITE ISSUED                3RN00710
MSK19  OCT     000040000000        BETA BUFFER ASSIGNED                 3RN00720
MSK20  OCT     400000000000                                             3RN00730
MSK21  OCT     000000700000                                             3RN00740
MSK23  OCT     000000200000        FULL TRACK WITH ADDRESSES            3RN00750
MSK24  OCT     000000400000        XR4-INCOMPLETE BETA SET              3RN00760
MSK25  OCT     000000000020        BCD MODE                             3RN00770
MSK26  OCT     000000000014                                             3RN00780
MSKI   OCT     000037000000        I NUMBER                             3RN00790
       SPACE                                                            3RN00800
*                      COMMON ENTRY ROUTINE                             3RN00810
       SPACE                                                            3RN00820
ENTER  ENB     L(0)                                                     3RN00830
       SXA     SVXR4,4                                                  3RN00840
       SXA     SVXR2,2             SAVE REGISTERS                       3RN00850
       SXA     SVXR1,1                                                  3RN00860
       STI     RSENS               AND SENSE INDICATORS                 3RN00870
       CAL     ERRIND                                                   3RN00880
       TNZ     RNSLM0              PERSISTENT ERROR - KILL THE JOB      3RN00890
DEREJ  LDC     **,1                                                     3RN00900
       TRA     0,1                 GO TO ROUTINE                        3RN00910
       SPACE                                                            3RN00920
*                      COMMON EXIT ROUTINE                              3RN00930
       SPACE                                                            3RN00940
RANDEX STZ     RANFLG              RESET RANFLG                         3RN00950
       ZET     RANCAV              ANY REQUEST UNSERVICED               3RN00960
       TRA     RRQ020-1            YES                                  3RN00970
RNDX2  ENB*    (TRAPX                                                   3RN00980
       NZT     RTNFLG              IF RETAIN REQUESTED                  3RN00990
       TRA     RNDX3                                                    3RN01000
       ZET     RANCAV              AND RANCAV IS NON ZERO               3RN01010
       TRA     SCHED               RETURN TO SCHEDULER                  3RN01020
       STZ     RTNFLG              OTHERWISE RESET RETAIN FLAG          3RN01030
RNDX3  NZT     CLSFLG              IS THIS A CLOSE ENTRY                3RN01040
       TRA     SVXR4               NO                                   3RN01050
       AXT     0,2                 YES                                  3RN01060
       ZET*    PQUEUE              ANY REQUESTS PENDING                 3RN01070
       TRA     SCHED               YES, GO TO WORK                      3RN01080
       STZ     CLSFLG              NO, RESET CLOSE FLAG                 3RN01090
SVXR4  AXT     **,4                                                     3RN01100
SVXR2  AXT     **,2                RESTORE REGISTERS                    3RN01110
SVXR1  AXT     **,1                                                     3RN01120
       LDI     RSENS               AND SENSE INDICATORS                 3RN01130
       TRA     1,4                 EXIT                                 3RN01140
       SPACE                                                            3RN01150
*  TSX     RANCLS,4    CLOSE MICROROUTINE                               3RN01160
*  RETURN                                                               3RN01170
       SPACE                                                            3RN01180
RNCLS  STL     CLSFLG              SET CLOSE FLAG                       3RN01190
       TRA     SCHED               AND GO TO SCHEDULER                  3RN01200
       SPACE                                                            3RN01210
*  TSX     RANDEF,4    1. RESERVES AT QUEUE A PUSH UP LIST OF S WORDS.  3RN01220
*  PZE     QUEUE,,DRHA 2. DEFINES AT QUEUE+S S BUFFERS OF 6 WORDS EACH  3RN01230
*  PZE     ,,S         PLUS ONE BUFFER POOL CONTROL WORD.               3RN01240
*  PZE     R,,N        3. DEFINES AT DRHA N BUFFERS OF SIZE R+1         3RN01250
*  RETURN              PLUS ONE BUFFER POOL CONTROL WORD.               3RN01260
*                      4. STORES ALL PARAMETERS.                        3RN01270
       SPACE                                                            3RN01280
RNDEF  CAL     3,4                                                      3RN01290
       PDX     0,1                                                     $3RN01300
       CAL     2,4                                                     $3RN01310
       STD     *+1                                                     $3RN01320
       TXL     *+3,1,**                                                $3RN01330
       CAL     2,4                                                     $3RN01340
       TRA     *+2                                                     $3RN01350
       PXD     0,1                                                      3RN01360
       STD     L(S)                SAVE S                              $3RN01370
       ARS     18                                                      $3RN01380
       ACL     1,4                                                      3RN01390
       STA     SQUEUE              QUEUE+S                              3RN01400
       ANA     ADDR                                                     3RN01410
       XCL                                                              3RN01420
       CAL     L(S)                SET PARAMETERS FOR QUEUE            $3RN01430
       ACL     L(6)                                                     3RN01440
       TSX     RNDF,1              AND GO TO RNDF                       3RN01450
       CAL     1,4                                                      3RN01460
       STA     PQUEUE              SAVE QUEUE                           3RN01470
       ARS     18                                                       3RN01480
       STA     PDRHA               SAVE DRHA                            3RN01490
       XCL                                                              3RN01500
       CAL     3,4                                                      3RN01510
       STA     L(R)                SAVE R                               3RN01520
       ACL     L(1)                                                     3RN01530
       TSX     RNDF,1              AGAIN                                3RN01540
       LDC     L(S),2                                                  $3RN01550
       SXD     RRQ020+6,2                                               3RN01560
       SXD     RNSLM9,2                                                 3RN01570
       SXD     SCHD2,2                                                  3RN01580
       SXD     SCHD3,2                                                  3RN01590
       SXD     SCHD10,2                                                 3RN01600
       SXD     CHCK3,2                                                  3RN01610
       SXD     LKP015,2                                                 3RN01620
       SXD     SCHD17,2                                                 3RN01630
       SXD     PRC017,2                                                 3RN01640
       SXD     RNRL5,2                                                  3RN01650
       SXD     RPL04-1,2                                                3RN01660
       SXD     LKP04+2,2                                                3RN01670
       SXD     PREDY4,2                                                 3RN01680
       SXD     RLQS2,2                                                  3RN01690
       TXI     *+1,2,1                                                  3RN01700
       STZ*    PQUEUE              CLEAR QUEUE AREA                     3RN01710
       TXH     *-2,2,0                                                  3RN01720
       TXI     *+1,4,-3                                                 3RN01730
       STZ     ERRIND                                                   3RN01740
       TRA     SVXR2               EXIT                                 3RN01750
       SPACE                                                            3RN01760
*  TSX     RNDF,1   1. DEFINES IN N*M+1 LOCATIONS STARTING AT POOL      3RN01770
*  RETURN           N BUFFERS OF TOTAL SIZE M.                          3RN01780
*                   2. UPON ENTRY, AC CONTAINS M,,N, MQ CONTAINS POOL.  3RN01790
       SPACE                                                            3RN01800
RNDF   STQ     RNDF3               SAVE L(POOL)                         3RN01810
       STA     RNDF2               SAVE M                               3RN01820
       PDX     0,2                 AND N                                3RN01830
       CLS     RNDF3                                                    3RN01840
       ACL     L(1)                L(POOL)+1                            3RN01850
       STO*    RNDF3               TO L(POOL)                           3RN01860
       STA     RNDF1                                                    3RN01870
       SSP                                                              3RN01875
       TNX     RNDF4,2,1                                                3RN01880
       ACL     RNDF2               STORE POOL+XM+1                      3RN01890
RNDF1  STO     **                IN POOL+(X-1)M+1                       3RN01900
       STA     *-1                                                      3RN01910
       TRA     RNDF1-2                                                  3RN01920
RNDF4  CLA     RNDF3                                                    3RN01930
       STO*    RNDF1             LAST BUFFER POINTS TO POOL             3RN01940
       TRA     1,1                 RETURN                               3RN01950
RNDF2  PZE                         M                                    3RN01960
RNDF3  PZE                         L(POOL)                              3RN01970
       SPACE                                                            3RN01980
*  TSX     RANREQ,4    1. THIS ROUTINE SETS UP THE REQUESTS ENTRIES,    3RN01990
*  P       ALPHA,T,M   ONE PER BETA RECORD.                             3RN02000
*  P       ERRET       2. WHEN NO MORE QUEUE SEGMENTS ARE AVAILABLE, IT 3RN02010
*  P       A,T,PROCES  RETAINS THE CALLING SEQUENCE.                    3RN02020
*  P       PHYS. ADDR.                                                  3RN02030
*  VERIFICATION ADDR.                                                   3RN02040
*  -----------------                                                    3RN02050
*  RETURN                                                               3RN02060
       SPACE                                                            3RN02070
RNREQ  LDI     1,4                                                      3RN02080
       RFT     700000              IF REQUESTED                         3RN02090
       STL     RTNFLG              SET RETAIN FLAG                      3RN02100
       LFT     077777                                                   3RN02110
       TRA     *+2                                                      3RN02120
       TRA     RRQ070             IF BETA COUNT = 0    GO               3RN02130
       STI     ALPHA                                                    3RN02140
       PIA                                                              3RN02150
       PDC     0,2                                                      3RN02160
       SXD     RRQ010,2                                                 3RN02170
       CLA     2,4                                                      3RN02180
       STO     ERRET               SAVE ERROR RETURN                    3RN02190
       SXA     SVRQ4,4                                                  3RN02200
       ZET     RANCAV              IF RANCAV IS NON ZERO                3RN02210
       TRA     RRQ080              GIVE ERROR MESSAGE                   3RN02220
       AXT     3,1                                                      3RN02230
RRQ010 TXI     *+1,4,**            COMPUTE AND SAVE                     3RN02240
       TIX     *-1,1,1                                                  3RN02250
       TXI     *+1,4,-2                                                 3RN02260
       SXA     SVXR4,4             RETURN ADDRESS                       3RN02270
       LXA     SVRQ4,4                                                  3RN02280
RRQ020 ENB     L(0)                                                     3RN02290
       AXT     0,2                                                      3RN02300
       SXA     SVRQ4,4                                                  3RN02310
       NZT*    PQUEUE              GET SEGMENT                          3RN02320
       TRA     RRQ050                                                   3RN02330
       TXI     *+1,2,-1                                                 3RN02340
       TXH     RRQ020+3,2,**       TRY AGAIN                            3RN02350
       CLA     ANTE                NONE AVAILABLE.  IF AT LEAST ONE BETA3RN02360
       TZE     RRQ035              WAS ALREADY SERVICED                 3RN02370
RRQ030 TXI     *+1,2,1             SET POINTER TO QUEUE+S-1             3RN02380
       CAL*    PQUEUE              AND SET THE INCOMPLETE BETA SET FLAG 3RN02390
       ORA     MSK24               IN ALL BETA REQUESTS ALREADY SERVICED3RN02400
       SLW*    PQUEUE              IN THIS SET                          3RN02410
       ANA     MSK2                                                     3RN02420
       TNZ     *+2                                                      3RN02430
       TRA     RRQ030                                                   3RN02440
RRQ035 ZET     SLM060                                                   3RN02450
       TRA     SCHED+1                                                  3RN02460
       CAL     RANCAV              RUN OUT OF SEGMENTS                  3RN02470
       TNZ     RNDX2               EARLIER, EXIT                        3RN02480
       SXA     RANCAV,4            JUST NOW, SET RANCAV AND GO          3RN02490
       TRA     SCHED                                                    3RN02500
RRQ050 CLA*    SQUEUE              SEGMENT ADDRESS                      3RN02510
       STA*    PQUEUE              TO POINTER                           3RN02520
       STA     *+2                                                      3RN02530
       PAC     0,1                 AND XR1                              3RN02540
       LDQ     **                                                       3RN02550
       XCA                                                              3RN02560
       STA*    SQUEUE              UPDATE                               3RN02570
       STQ*    *-3                 AVAILABILITY CHAIN                   3RN02580
       CAL     ALPHA                                                    3RN02590
       SUB     1DECR                                                    3RN02600
       SLW     ALPHA               UPDATE BETA COUNT                    3RN02610
       NZT     ANTE                IF FIRST BETA                        3RN02620
       ORA     MSK2                SET HEADER FLAG                      3RN02630
       STP*    PQUEUE              POINTER PREFIX                       3RN02640
       ALS     18                                                       3RN02650
       STD     0,1                 ALPHA RECORD                         3RN02660
       CLA     ERRET                                                    3RN02670
       STO     2,1                                                      3RN02680
       CLA     3,4                                                      3RN02690
       STT     0,1                 MODE                                 3RN02700
       STD     2,1                 PROCES                               3RN02710
       ARS     2                                                        3RN02720
       TMI     *+4                 WRITE ONLY                           3RN02730
       ANA     MSK10                                                    3RN02740
       ORA     MSK4                                                     3RN02750
       TRA     *+3                                                      3RN02760
       ANA     MSK10                                                    3RN02770
       ORA     MSK7                                                     3RN02780
       STD*    PQUEUE              POINTER DECREMENT                    3RN02790
       CLA     3,4                                                      3RN02800
       STA     *+1                                                      3RN02810
       CLA     **                                                       3RN02820
       STA     1,1                 L(UCB)                               3RN02830
       CAL     4,4                                                      3RN02840
       SLW     3,1                 PHYSICAL ADDRESS                     3RN02850
       LDI     5,4                                                      3RN02860
       TSX     H2ZBCD,4            CONVERT ZEROS IN HA2                 3RN02870
       STI     4,1                 VERIFICATION ADDRESS                 3RN02880
       STZ     5,1                 CLEAR CHAIN WORD                     3RN02890
       CAL     ANTE                                                     3RN02900
       ADD     1DECR                                                    3RN02910
       STD     ANTE                                                     3RN02920
       ORS*    PQUEUE              BETA I NUMBER                        3RN02930
       TSX     CHECK,4             CHECK FOR COMMON BETA RECORDS        3RN02940
SVRQ4  AXT     **,4                                                     3RN02950
       CAL     ALPHA                                                    3RN02960
       ANA     DECRE               MORE BETA RECORDS                    3RN02970
       TZE     *+2                 NO                                   3RN02980
       TXI     RRQ020+2,4,-3       PROCESS NEXT BETA                    3RN02990
       STZ     ANTE                KEEP HOUSE                           3RN03000
       CLA     RANCAV                                                   3RN03010
       TZE     SCHED                                                    3RN03020
       STZ     RANCAV                                                   3RN03030
RRQ060 LDI*    PQUEUE                                                   3RN03040
       RIR     400000                                                   3RN03050
       STI*    PQUEUE              RESET INCOMPLETE BETA FLAGS          3RN03060
       LNT     200000                                                   3RN03070
       TXI     RRQ060,2,1                                               3RN03080
       ZET     SLM060              IF ENTERED FROM SEL(-)               3RN03090
       TRA     SCHED+1             GO TO SCHEDULER                      3RN03100
       TRA     RNDX2               OTHERWISE EXIT                       3RN03110
RRQ070 TXI     *+1,4,-1            SET UP RETURN ADDRESS                3RN03120
       SXA     SVXR4,4                                                  3RN03130
       TRA     SCHED               GO TO SCHEDULER                      3RN03140
RRQ080 TSX     (PROUT,4                                                 3RN03150
       PZE     1                                                        3RN03160
       PZE     MESSA,,5                                                 3RN03170
       TRA     RNSLM7              KILL THE JOB                         3RN03180
ALPHA  PZE                                                              3RN03190
ANTE   PZE                                                              3RN03200
ERRET  PZE                                                              3RN03210
MESSA  BCI     5,BETA REQUEST(S) UNSERVICED                             3RN03220
       SPACE                                                            3RN03230
*                      MAIN SCHEDULING ROUTINE                          3RN03240
*          DETERMINES THE STATUS OF THE REQUESTS                        3RN03250
*          AND TAKES SUITABLE ACTION.                                   3RN03260
       SPACE                                                            3RN03270
SCHED  ENB*    (TRAPX              RESTORE TRAPS                        3RN03280
       AXT     0,2                 WRITE SCAN                           3RN03290
       ENB     L(0)                DISABLE TRAPS                        3RN03300
SCHD1  NZT*    PQUEUE                                                   3RN03310
       TRA     SCHD2+1             GO TO READ SCAN                      3RN03320
       CAL     MSK11                                                    3RN03330
       ANA*    PQUEUE              TEST FOR WRITE WAITING               3RN03340
       TNZ     SCHD4               YES                                  3RN03350
       TXI     *+1,2,-1                                                 3RN03360
SCHD2  TXH     SCHD1,2,**          NO, REPEAT                           3RN03370
       AXT     0,2                 READ SCAN                            3RN03380
       NZT*    PQUEUE                                                   3RN03390
       TRA     SCHD16              GO TO ERROR SCAN                     3RN03400
       LDI*    PQUEUE                                                   3RN03410
       LNT     044000              READ WAITING,SINGLE REQUEST          3RN03420
       TRA     *+2                 OR BETA CHAIN HEADER                 3RN03430
       TRA     SCHD4+2                                                  3RN03440
       TXI     *+1,2,-1                                                 3RN03450
SCHD3  TXH     SCHD2+2,2,**                                             3RN03460
       TRA     SCHD16                                                   3RN03470
SCHD4  AXT     SCHD2-1,1                                                3RN03480
       TRA     *+2                                                      3RN03490
       AXT     SCHD3-1,1                                                3RN03500
       SXA     SCHD6,1                                                  3RN03510
       CLA*    PQUEUE                                                   3RN03520
       PAC     ,4                  QUEUE SEGMENT TO XR4                 3RN03530
       CLA     1,4                                                      3RN03540
       PAC     0,4                 L(UCB) TO XR4                        3RN03550
       ZET     1,4                                                      3RN03560
SCHD6  TRA     **                  UNIT BUSY, BACK TO SCANNER           3RN03570
       TRA     ACT                 GO ACTIVATE                          3RN03580
SCHD16 ZET     SLM060              IF ENTERED FROM SEL(-)               3RN03590
       TRA     SLM050              RETURN THERE                         3RN03600
       AXT     0,2                 ERROR SCAN                           3RN03610
       NZT*    PQUEUE                                                   3RN03620
       TRA     SCHD9               GO TO PROCESSING SCAN                3RN03630
       LDI*    PQUEUE                                                   3RN03640
       RFT     200000                                                   3RN03650
       TRA     ERROR               GO TO ERROR ROUTINE                  3RN03660
       TXI     *+1,2,-1                                                 3RN03670
SCHD17 TXH     SCHD16+3,2,**                                            3RN03680
SCHD9  AXT     0,2                 PROCESSING SCAN                      3RN03690
       NZT*    PQUEUE                                                   3RN03700
       TRA     RANDEX                                                   3RN03710
       CAL     MSK7                                                     3RN03720
       ANA*    PQUEUE                                                   3RN03730
       TNZ     SCHD11              PROCESSING WAITING                   3RN03740
       TXI     *+1,2,-1            NO                                   3RN03750
SCHD10 TXH     SCHD9+1,2,**                                             3RN03760
       TRA     RANDEX                                                   3RN03770
SCHD11 CLA*    PQUEUE                                                   3RN03780
       TPL     SCHD14              NOT FORCE SEQUENTIAL                 3RN03790
       TXL     SCHD14,2,0          FORCE SEQUENT. BUT FIRST REQUEST     3RN03800
       SXA     SCHD13,2            SAVE XR2                             3RN03810
SCHD12 TXI     *+1,2,1             CHECK NEXT HIGHER REQUEST            3RN03820
       CAL     MSK8                                                     3RN03830
       ANA*    PQUEUE              IF REQUEST NOT AT SEEK+WRITE WAITING 3RN03840
       TZE     SCHD15              OR ISSUED RETURN TO SCANNER          3RN03850
       TXH     SCHD12,2,0          HIT TOP OF QUEUE                     3RN03860
SCHD13 AXT     **,2                RESTORE XR2                          3RN03870
SCHD14 TSX     PREADY,1            IF THE OTHER MUT. DEP. REQUESTS      3RN03880
       TRA     PROC                ARE READY GO PROCESSING              3RN03890
       TRA     SCHD10-1                                                 3RN03900
SCHD15 LXA     SCHD13,2                                                 3RN03910
       TRA     SCHD10-1                                                 3RN03920
       SPACE                                                            3RN03930
*                      PRE-ACTIVATE ROUTINE                             3RN03940
       SPACE                                                            3RN03950
ACT    CLA*    PQUEUE                                                   3RN03960
       PAC     0,1                                                      3RN03970
       CLA     3,1                                                      3RN03980
       TPL     ACT1                BINARY SEEK ADDRESS                  3RN03990
       CAL     MSK14               BCD                                  3RN04000
       ANS     2,4                 CLEAR TT IN UCB3                     3RN04010
       CLA     3,1                                                      3RN04030
       ANA     MSK15                                                    3RN04040
       XCA                           SET BCD ZEROS                      3RN04041
       XEC     .IBCDZ                INTO SEEK                          3RN04042
       PXD     0,0                   ORDER                              3RN04043
       XCA                                                              3RN04044
       ANA     MSK15                                                    3RN04045
       LGR     12                                                       3RN04050
       ORS     2,4                 AND STORE TT                         3RN04060
       XCA                                                              3RN04070
       SSM                         SET TRACK FLAG                       3RN04080
ACT1   STO     3,4                                                      3RN04090
       CLS     2,4                                                      3RN04100
       STO     2,4                 SET ACTIVITY FLAG                    3RN04110
       CAL*    PQUEUE                                                   3RN04120
       STA     1,4                 QUEUE SEGMENT TO UCB2                3RN04130
       ANA     MSK11                                                    3RN04140
       TZE     ACT3                READ                                 3RN04150
       CLS     1,4                 SET WRITE FLAG                       3RN04160
       STO     1,4                                                      3RN04170
       CAL*    PQUEUE                                                   3RN04180
       ANA     MSK12               CHANGE STATUS                        3RN04190
       ORA     MSK17               SEEK+WRITE ISSUED                    3RN04200
       SLW*    PQUEUE                                                   3RN04210
       TRA     ACT4                                                     3RN04220
ACT3   LDI*    PQUEUE                                                   3RN04230
       RIL     004000              CHANGE STATUS TO S2                  3RN04240
       SIL     002000                                                   3RN04250
       STI*    PQUEUE                                                   3RN04260
ACT4   AXT     RNSEL,2             SEL TO UCB2                          3RN04270
       PXD     0,2                                                      3RN04280
       STD     1,4                                                      3RN04290
       TSX     (ACTIV,4            GO ACTIVATE                          3RN04300
       PZE     1,1                                                      3RN04310
       ZET     SLM060              ENTERED FROM SEL(-)                  3RN04320
       TRA     SCHED+1                                                  3RN04330
       TRA     SCHED                                                    3RN04340
       SPACE                                                            3RN04350
*                      SELECT (+) ROUTINE                               3RN04360
       SPACE                                                            3RN04370
RNSEL  SXA     SVSL1,1                                                  3RN04380
       SXA     SVSL4,4                                                  3RN04390
       PAC     0,4                 L(UCB) TO XR4                        3RN04400
       TMI     RNSLM               GO TO SEL (-)                        3RN04410
       NZT*    (URRXI              IF ATTEMPTING TO RECOVER             3RN04420
       TRA     *+4                                                      3RN04430
       CLA     0,4                                                      3RN04440
       STA*    (RCHXI              GO STRAIGHT TO EXECUTE               3RN04450
       TRA     RNSL07                                                   3RN04460
       CLA     1,4                                                      3RN04470
       TMI     RNSL01                                                   3RN04480
       TSX     LOOKUP,1            IF READ                              3RN04490
       CAL*    PQUEUE                                                   3RN04500
       ANA     MSK19               AND NO BETA BUFFER ASSIGNED          3RN04510
       TNZ     RNSL01-1                                                 3RN04520
       TSX     GETBF,1             ASSIGN ONE                           3RN04530
       TMI     RNSL06              IF NONE AVAILABLE, EXIT              3RN04540
       LXA     SVSL1,1                                                  3RN04550
RNSL01 AXT     0,2                                                      3RN04560
       CLS     CMND,2              GET FREE COMMAND LIST                3RN04570
       TMI     *+2                                                      3RN04580
       TXI     *-2,2,-17                                                3RN04590
       STO     CMND,2              SET IN USE FLAG                      3RN04600
       LDQ     0,4                                                      3RN04610
       STA*    (RCHXI              CMNDX TO RCHX VIA XR1                3RN04620
       STA     0,4                 TO UCB                               3RN04630
       PAC     0,2                 AND XR2                              3RN04640
       XCA                                                              3RN04650
       ALS     18                                                       3RN04660
       STD     -1,2                SAVE CHAINING                        3RN04670
       CLA     1,4                                                      3RN04680
       PAC     0,1                 QUEUE SEGMENT TO XR1                 3RN04690
       TMI     *+3                                                      3RN04700
       CLA     CTLR                READ                                 3RN04710
       TRA     *+2                                                      3RN04720
       CLA     CTLW                WRITE                                3RN04730
       STO     2,2                                                      3RN04740
       CAL     MSK23                                                    3RN04750
       ANA     0,1                                                      3RN04760
       TNZ     RNSL02                                                   3RN04770
       CLA     14,2                SINGLE RECORD                        3RN04780
       TRA     *+2                                                      3RN04790
RNSL02 CLA     15,2                OR FULL TRACK WITH ADDRESSES ORDER   3RN04800
       STA     2,2                 TO CONTROL+READ OR WRITE COMMAND     3RN04810
       CAL     1,1                                                      3RN04820
       ARS     18                                                       3RN04830
       ADD     L(1)                                                     3RN04840
       STA     3,2                 BETA BUFFER ADDRESS                  3RN04850
       CLA     L(R)                                                     3RN04860
       ALS     18                  AND WORD COUNT                       3RN04870
       STD     3,2                 TO CPYD                              3RN04880
       LDQ     1,4                 DO NOT WRITE                        *3RN04890
       TQP     *+3                 CHECK IF READING                    *3RN04900
       CLA     2,1                                                      3RN04910
       TMI     *+3                                                      3RN04920
       PXD     0,0                                                      3RN04930
       TRA     *+2                                                      3RN04940
       CLA     L(1)                WRITE CHECK REQUESTED                3RN04950
       STA     1,2                                                      3RN04960
       LDQ     L(0)                CLEAR MQ                             3RN04970
       CAL     4,1                                                      3RN04980
       LGR     12                  SET UP FDAMT                         3RN04990
       XCL                                                              3RN05000
       ARS     12                                                       3RN05010
       STO     RNSL03                                                   3RN05020
       CLA     2,2                                                      3RN05030
       STA     RNSL03+1                                                 3RN05040
       CAL     MSK24                                                    3RN05050
       ANA     0,1                                                      3RN05060
       TZE     *+2                                                      3RN05070
       CAL     MSK25               BCD MODE                             3RN05080
       ORA     L(6)                AND INHIBIT ATTENTION BITS           3RN05090
       ORS     RNSL03              TO SMS COMMAND                       3RN05100
       SXA     RNSL04,2                                                 3RN05110
       TSX     (FDAMT,2            SET UP DVSR OR DVTA                  3RN05120
RNSL03 PZE                                                              3RN05130
       PZE                                                              3RN05140
RNSL04 AXT     **,2                                                     3RN05150
       CLA     2,1                                                      3RN05160
       TPL     RNSL05                                                   3RN05170
       CLA     2,2                                                      3RN05180
       PAC     0,4                 IF WRITE CHECK REQUESTED             3RN05190
       CLA     0,4                                                      3RN05200
       ANA     MSK15               SET UP DWRC                         *3RN05210
       ORA     MSK13                                                   *3RN05220
       SLW     12,2                                                    =3RN05230
       CLA     1,4                                                      3RN05240
       STO     13,2                                                    =3RN05250
RNSL05 CLA     RNSL03                                                   3RN05260
       STA     0,2                 SET UP SMS COMMAND                   3RN05270
       LXA     SVSL1,1                                                  3RN05280
RNSL07 LXA     SVSL4,4                                                  3RN05290
       XEC*    (RCHXI              RESET AND START CHANNEL              3RN05300
       TRA     1,4                 EXIT                                 3RN05310
CTLR   CTLR    **                                                       3RN05320
CTLW   CTLW    **                                                       3RN05330
       PZE     ,,DSELM                                                  3RN05340
       PZE     DCMND                                                    3RN05350
RNSL06 CLA     *-1                 DUMMY COMMAND LIST                   3RN05360
       LXA     SVSL1,1                                                  3RN05370
       STA*    (RCHXI              TO RCHX                              3RN05380
       CAL*    PQUEUE                                                   3RN05390
       ANA     MSK12               CHANGE STATUS BACK TO 1              3RN05400
       ORA     MSK4                                                     3RN05410
       SLW*    PQUEUE                                                   3RN05420
       CLA     0,4                                                      3RN05430
       ARS     23                                                       3RN05440
       ANA     L(1)                                                     3RN05450
       ORA     MSK26               SET SMS                              3RN05460
       STA     DCMND                                                    3RN05470
       CLA     RNSL06-2            DUMMY SEL (-) TO UCB2                3RN05480
       STD     1,4                                                      3RN05490
       CLA     FLBITS              SET TOTAL EXCLUSION BITS             3RN05500
       STO*    (RCTXI                                                   3RN05510
       TRA     RNSL07                                                   3RN05520
FLBITS PZE     *+1                                                      3RN05530
       OCT     777777770000                                             3RN05540
       SPACE                                                            3RN05550
*                      SEL (-) ROUTINE                                  3RN05560
       SPACE                                                            3RN05570
RNSLM  CLA     0,4                                                      3RN05580
       PAC     0,2                                                      3RN05590
       CLS     -1,2                                                     3RN05600
       STO     -1,2                RELEASE COMMAND LIST                 3RN05610
       ARS     18                                                       3RN05620
       STA     0,4                 RESTORE CHAINING                     3RN05630
       CLA     1,4                                                      3RN05640
       TSX     LOOKUP,1            GET POINTER                          3RN05650
       CLA     1,4                                                      3RN05660
       STZ     1,4                 CLEAR UCB2                           3RN05670
       TPL     *+2                                                      3RN05680
       SIL     000040              SET WRITE FLAG IN INDICATORS         3RN05690
       STI     SENSW               SAVE SENSE DATA                      3RN05700
       LFT     001000              IF UNUSUAL END                       3RN05710
       TRA     RNSLM4              GO TO ERROR PROCEDURES               3RN05720
       TMI     RNSLM1                                                   3RN05730
       STL     RANFLG              SET RANFLG                          $3RN05740
       LDI*    PQUEUE              READ COMPLETED                       3RN05750
       RIL     002000                                                   3RN05760
       SIL     001000                                                   3RN05770
       STI*    PQUEUE              CHANGE S2 TO S3                      3RN05780
       LNT     100000                                                   3RN05790
       TRA     SLM025                                                   3RN05800
       PIA                         IF IN BETA CHAIN                     3RN05810
       STA     SLM010                                                   3RN05820
SLM020 PAC     0,1                 CHANGE EQUALLY ALL OTHER REQUESTS    3RN05830
       CAL     5,1                                                      3RN05840
       LAS     SLM010                                                   3RN05850
       TRA     *+2                                                      3RN05860
       TRA     SLM025                                                   3RN05870
       TSX     LOOKUP,1                                                 3RN05880
       LDI*    PQUEUE                                                   3RN05890
       PIA                                                              3RN05900
       RIL     006000                                                   3RN05910
       SIL     001000                                                   3RN05920
       STI*    PQUEUE                                                   3RN05930
       TRA     SLM020                                                   3RN05940
RNSLM1 LDI*    PQUEUE                                                   3RN05950
       LFT     100000              IF IN BETA CHAIN                     3RN05960
       TSX     RELEM,4             REMOVE REQUEST                       3RN05970
       TSX     RELBF,4             RELEASE BETA BUFFER                  3RN05980
       TSX     RELQS,4             AND QUEUE SEGMENT, ZERO OUT POINTER  3RN05990
SLM025 STL     SLM060                                                   3RN06000
       ZET     RANCAV              START NEW CHANNEL ACTIVITY           3RN06010
       TRA     RRQ020-1                                                 3RN06020
       TRA     SCHED+1                                                  3RN06030
SLM050 STZ     SLM060                                                   3RN06040
SVSL4  AXT     **,4                                                     3RN06050
SVSL1  AXT     **,1                RESTORE  REGISTERS                   3RN06060
       TRA     1,4                 EXIT                                 3RN06070
RNSLM3 LDI*    PQUEUE              ERROR FLAG TO POINTER                3RN06080
       SIR     200000                                                   3RN06090
       STI*    PQUEUE                                                   3RN06100
       LNT     100000                                                   3RN06110
       TRA     SLM025                                                   3RN06120
       PIA                         COMMON BETA                          3RN06130
       STA     SLM010                                                   3RN06140
SLM030 PAC     0,1                                                      3RN06150
       CAL     5,1                                                      3RN06160
       LAS     SLM010                                                   3RN06170
       TRA     *+2                                                      3RN06180
       TRA     SLM025                                                   3RN06190
       TSX     LOOKUP,1            SET ERROR FLAG                       3RN06200
       LDI*    PQUEUE                                                   3RN06210
       SIR     200000                                                   3RN06220
       STI*    PQUEUE              IN ALL ELEMENTS OF CHAIN             3RN06230
       PIA                                                              3RN06240
       TRA     SLM030                                                   3RN06250
RNSLM4 STL     RANFLG              SET RANFLG                          $3RN06260
       RFT     763777              IF INVALID ADDRESS OR NO RECORD     $3RN06270
       TRA     *+3                                                      3RN06280
       LNT     000040              IN A READ                            3RN06290
       TRA     RNSLM3              SET ERROR FLAG                       3RN06300
       STI     ERRIND                                                   3RN06310
       CLA*    PQUEUE                                                   3RN06320
       PAC     0,1                                                      3RN06330
       LDI     4,1                                                      3RN06340
       TSX     H2BCDZ,4            CONVERT ZEROS                        3RN06350
       STI     MESSB+4                                                  3RN06360
       TRA     SVSL4                                                    3RN06370
SLM060 PZE                                                              3RN06380
RNSLM0 PAI                                                              3RN06390
       TSX     (PROUT,4                                                 3RN06400
       PZE     1                   FOR ALL OTHER ERRORS                 3RN06410
       PZE     MESSB,,5            PRINT ERROR MESSAGE                  3RN06420
       AXT     0,2                                                      3RN06430
       ZET*    PQUEUE              IF NO REQUESTS WAITING               3RN06440
       TRA     RNSLM6                                                   3RN06450
       TSX     (PROUT,4            SAY IT SO                            3RN06460
       PZE     1                                                        3RN06470
       PZE     MESSC,,3                                                 3RN06480
RNSLM5 TRA     SYSDMP              TERMINATE-UNSURMOUNTABLE ERROR      $3RN06490
RNSLM6 RFT     000700                                                   3RN06500
       TRA     *+2                                                      3RN06510
       TRA     RNSLM7                                                   3RN06520
       LNT     000040                                                   3RN06530
       TRA     RNSLM7                                                   3RN06540
       TSX     (PROUT,4            DATA CHECK WHILE WRITING             3RN06550
       PZE     1                                                        3RN06560
       PZE     MESSD,,6                                                 3RN06570
RNSLM7 TSX     (PROUT,4                                                 3RN06580
       PZE     2                                                        3RN06590
       PZE     MESSE,,5+512*4      PREPARE TO LIST REQUESTS             3RN06600
       PZE     MESSF,,6+512*4                                           3RN06610
       STZ     COUNT2              RESET COUNTER                        3RN06620
       AXT     0,2                                                      3RN06630
RNSLM8 AXT     6,1                                                      3RN06640
       LDQ*    PQUEUE                                                   3RN06650
       RQL     6                                                        3RN06660
       TQP     *+4                                                      3RN06670
RNSLM2 CAL     STATUS+6,1          DETERMINE STATUS                     3RN06680
       SLW     MESSG+5                                                  3RN06690
       TRA     *+3                                                      3RN06700
       RQL     1                                                        3RN06710
       TIX     RNSLM2-1,1,1                                             3RN06720
       CLA*    PQUEUE                                                   3RN06730
       PAC     0,1                                                      3RN06740
       LDI     4,1                                                      3RN06750
       TSX     H2BCDZ,4                                                 3RN06760
       STI     MESSG+3             VERIFICATION ADDRESS                 3RN06770
       LDQ     0,1                                                      3RN06780
       TSX     (BCD5R,4                                                 3RN06790
       SLW     MESSG+1             ALPHA RECORD                         3RN06800
       CAL     COUNT2                                                   3RN06810
       ADD     L(1)                                                     3RN06820
       STO     COUNT2                                                   3RN06830
       TSX     (DECVA,4                                                 3RN06840
       XCL                                                              3RN06850
       ALS     24                                                       3RN06860
       ARS     6                                                        3RN06870
       ORA     MSK1                                                     3RN06880
       SLW     MESSG               REQUEST NUMBER                       3RN06890
       TSX     (PROUT,4                                                 3RN06900
       PZE     1                                                        3RN06910
       PZE     MESSG,,6                                                 3RN06920
       TXI     *+1,2,-1                                                 3RN06930
       ZET*    PQUEUE                                                   3RN06940
RNSLM9 TXH     RNSLM8,2,**                                              3RN06950
       TRA     RNSLM5                                                   3RN06960
MESSB  BCI     5,PERSISTENT ERROR - BETA XXXXXX                         3RN06970
MESSC  BCI     3,NO REQUESTS WAITING                                    3RN06980
MESSD  BCI     6,DATA CHECK WHILE WRITING ON DISK                       3RN06990
MESSE  BCI     5,STATUS OF REQUESTS FOLLOWS                             3RN07000
MESSF  BCI     6,       ALPHA       BETA       STATUS                   3RN07010
MESSG  BCI     6,                                                       3RN07020
STATUS BCI     1,RDWAIT                                                 3RN07030
       BCI     1,RDISSD                                                 3RN07040
       BCI     1,PRWAIT                                                 3RN07050
       BCI     1,PRISSD                                                 3RN07060
       BCI     1,WRWAIT                                                 3RN07070
       BCI     1,WRISSD                                                 3RN07080
COUNT2 PZE                                                              3RN07090
DSELM  PAC     0,2                 DUMMY SEL (-)                        3RN07100
       STZ     1,2                                                      3RN07110
       TRA     1,4                                                      3RN07120
SLM010 PZE                                                              3RN07130
       SPACE                                                            3RN07140
*                      COMMAND LISTS                                    3RN07150
       SPACE                                                            3RN07160
CMND   PZE     *+1,,**                                                  3RN07170
CMND1  SMS     **                                                       3RN07180
       LCC     **                  ONE IF WRITE CHECK, ZERO OTHERWISE   3RN07190
       PZE                         CTLR OR CTLW FROM DVSR OR DVTA       3RN07200
       CPYD    **,,**                                                   3RN07210
       TDC     *+2                 WRITE CHECK IF REQUESTED             3RN07220
       TCH     SYSTWT                                                   3RN07230
       CTLW    DWRC1               PREPARE TO WRITE CHECK               3RN07240
       TCH     CMND1+3                                                  3RN07250
       DVSR    ,,                                                       3RN07260
       DVTA    ,,                                                       3RN07270
DWRC1  DWRC    ,,                                                       3RN07280
       PZE     *-6                                                      3RN07290
       PZE     *-5                                                      3RN07300
       PZE     *+1,,**                                                  3RN07310
CMND2  SMS     **                                                       3RN07320
       LCC     **                  ONE IF WRITE CHECK, ZERO OTHERWISE   3RN07330
       PZE                         CTLR OR CTLW FROM DVSR OR DVTA       3RN07340
       CPYD    **,,**                                                   3RN07350
       TDC     *+2                 WRITE CHECK IF REQUESTED             3RN07360
       TCH     SYSTWT                                                   3RN07370
       CTLW    DWRC2               PREPARE TO WRITE CHECK               3RN07380
       TCH     CMND2+3                                                  3RN07390
       DVSR    ,,                                                       3RN07400
       DVTA    ,,                                                       3RN07410
DWRC2  DWRC    ,,                                                       3RN07420
       PZE     *-6                                                      3RN07430
       PZE     *-5                                                      3RN07440
       PZE     *+1,,**                                                  3RN07450
CMND3  SMS     **                                                       3RN07460
       LCC     **                  ONE IF WRITE CHECK, ZERO OTHERWISE   3RN07470
       PZE                         CTLR OR CTLW FROM DVSR OR DVTA       3RN07480
       CPYD    **,,**                                                   3RN07490
       TDC     *+2                 WRITE CHECK IF REQUESTED             3RN07500
       TCH     SYSTWT                                                   3RN07510
       CTLW    DWRC3               PREPARE TO WRITE CHECK               3RN07520
       TCH     CMND3+3                                                  3RN07530
       DVSR    ,,                                                       3RN07540
       DVTA    ,,                                                       3RN07550
DWRC3  DWRC    ,,                                                       3RN07560
       PZE     *-6                                                      3RN07570
       PZE     *-5                                                      3RN07580
       PZE     *+1,,**                                                  3RN07590
CMND4  SMS     **                                                       3RN07600
       LCC     **                  ONE IF WRITE CHECK, ZERO OTHERWISE   3RN07610
       PZE                         CTLR OR CTLW FROM DVSR OR DVTA       3RN07620
       CPYD    **,,**                                                   3RN07630
       TDC     *+2                 WRITE CHECK IF REQUESTED             3RN07640
       TCH     SYSTWT                                                   3RN07650
       CTLW    DWRC4               PREPARE TO WRITE CHECK               3RN07660
       TCH     CMND4+3                                                  3RN07670
       DVSR    ,,                                                       3RN07680
       DVTA    ,,                                                       3RN07690
DWRC4  DWRC    ,,                                                       3RN07700
       PZE     *-6                                                      3RN07710
       PZE     *-5                                                      3RN07720
DCMND  SMS     **                  DUMMY COMMAND LIST                   3RN07730
       CTLR    *+3                                                      3RN07740
       CPYD    ,,                                                       3RN07750
       TCH     SYSTWT                                                   3RN07760
       OCT     100212121212                                             3RN07770
       OCT     121212121212                                             3RN07780
       SPACE                                                            3RN07790
*  TSX     LOOKUP,1    1. ENTER LOOKUP WITH REQ IN AC OR TO LOOKUP -1   3RN07800
*  RETURN              WITH REQ,,I IN AC.                               3RN07810
*                      2. EXIT WITH QUEUE,2 = REQUEST POINTER.          3RN07820
       SPACE                                                            3RN07830
       STD     LKP07                                                    3RN07840
LOOKUP AXT     0,2                 START AT QUEUE                       3RN07850
       STA     LKP06                                                    3RN07860
LKP01  CAL*    PQUEUE                                                   3RN07870
       ANA     ADDR                                                     3RN07880
       CAS     LKP06               COMPARE QUEUE SEGMENT ADDRESSES      3RN07890
       TXI     *+3,2,-1                                                 3RN07900
       TRA     LKP02               EQUAL                                3RN07910
       TXI     *+1,2,-1            TRY AGAIN                            3RN07920
LKP015 TXH     LKP01,2,**                                               3RN07930
       TRA     ERRR1                                                    3RN07940
LKP02  CLA     LKP07                                                    3RN07950
       TZE     1,1                 EXIT                                 3RN07960
       LDI*    PQUEUE                                                   3RN07970
       LNT     200000              FIND HEADER                          3RN07980
       TXI     *-2,2,1                                                  3RN07990
LKP03  CAL*    PQUEUE              COMPARE I NUMBERS                    3RN08000
       ANA     MSKI                                                     3RN08010
       CAS     LKP07                                                    3RN08020
       TXI     LKP04,2,-1                                               3RN08030
       TRA     LKP05                                                    3RN08040
       TXI     *+1,2,-1                                                 3RN08050
LKP04  LDI*    PQUEUE                                                   3RN08060
       LNT     200000              IF HEADER OR END OF                  3RN08070
       TXH     LKP03,2,**          QUEUE                                3RN08080
ERRR1  TSX     (PROUT,4                                                 3RN08090
       PZE     1                   PRINT ERROR MESSAGE                  3RN08100
       PZE     MESSH,,4                                                 3RN08110
       TRA     RNSLM7              KILL THE JOB                         3RN08120
LKP05  STZ     LKP07                                                    3RN08130
       TRA     1,1                 EXIT                                 3RN08140
LKP06  PZE                         REQ                                  3RN08150
LKP07  PZE                         I NUMBER                             3RN08160
MESSH  BCI     4,INVALID REQ IDENTIFIER                                 3RN08170
       SPACE                                                            3RN08180
*  TSX     PREADY,1    1. DETERMINES IF A GROUP OF MUTUALLY DEPENDENT   3RN08190
*  READY RETURN        BETAS IS READY FOR FOR PROCESSING.               3RN08200
*  NOT READY RETURN    2. ENTER WITH QUEUE,2 = REQUEST POINTER.         3RN08210
       SPACE                                                            3RN08220
PREADY SXA     SVRDY2,2                                                 3RN08230
       LDI*    PQUEUE                                                   3RN08240
       LNT     020000                                                   3RN08250
       TRA     1,1                 INDEPENDENT REQUEST                  3RN08260
       RFT     400000                                                   3RN08270
       TRA     2,1                 INCOMPLETE BETA SET                  3RN08280
       LFT     200000                                                   3RN08290
       TRA     PREDY3                                                   3RN08300
PREDY1 TXI     *+1,2,1             ARE THE OTHER MUTUALLY DEPENDENT     3RN08310
       CAL     MSK10               REQUESTS IN PROCESSING WAITING STATUS3RN08320
       ANA*    PQUEUE                                                   3RN08330
       TZE     PREDY2              INDEPENDENT                          3RN08340
       CAL     MSK7                                                     3RN08350
       ANA*    PQUEUE                                                   3RN08360
       TNZ     *+3                 DEPENDENT, PROCESSING WAITING        3RN08370
SVRDY2 AXT     **,2                                                     3RN08380
       TRA     2,1                 EXIT                                 3RN08390
PREDY2 CAL     MSK2                                                     3RN08400
       ANA*    PQUEUE                                                   3RN08410
       TZE     PREDY1              NOT A HEADER                         3RN08420
       LXA     SVRDY2,2                                                 3RN08430
PREDY3 TXI     *+1,2,-1            NOW SCAN DOWN                        3RN08440
       LDI*    PQUEUE                                                   3RN08450
       LNT     200000              IS THIS A HEADER OR                  3RN08460
PREDY4 TXH     *+3,2,**            END OF QUEUE                         3RN08470
       LXA     SVRDY2,2            YES                                  3RN08480
       TRA     1,1                 READY TO PROCESS                     3RN08490
       CAL     MSK10               NO, CHECK FOR DEPENDENCE             3RN08500
       ANA*    PQUEUE                                                   3RN08510
       TZE     PREDY3              NO, CHECK NEXT                       3RN08520
       CAL     MSK7                                                     3RN08530
       ANA*    PQUEUE              YES, IS IT PROCESSING WAITING        3RN08540
       TNZ     PREDY3              YES, CHECK NEXT                      3RN08550
       TRA     SVRDY2              NO                                   3RN08560
       SPACE                                                            3RN08570
*          THIS ROUTINE SETS UP THE CALLING SEQUENCE FOR THE USERS      3RN08580
*          PROCESSING ROUTINE AND TRANSFERS TO IT.                      3RN08590
       SPACE                                                            3RN08600
PROC   STZ     PRC040                                                   3RN08610
       STZ     PROCCS                                                   3RN08620
       CLA*    PQUEUE                                                   3RN08630
       PAC     0,1                                                      3RN08640
       STA     PROCCS              SET QUEUE SEGMENT, ALPHA RECORD      3RN08650
       CLA     0,1                                                      3RN08660
       STD     PROCCS                                                   3RN08670
       CLA     2,1                 AND PROCESSING ROUTINE ADDRESSES     3RN08680
       ARS     18                                                       3RN08690
       STA     PRC070                                                   3RN08700
       CAL     MSK10                                                    3RN08710
       ANA*    PQUEUE              TEST FOR DEPENDENCE                  3RN08720
       TZE     PRC050                                                   3RN08730
PRC010 CAL     MSK2                                                     3RN08740
       ANA*    PQUEUE                                                   3RN08750
       TNZ     *+2                                                      3RN08760
       TXI     PRC010,2,1          FIND HEADER                          3RN08770
PRC015 CAL*    PQUEUE                                                   3RN08780
       ANA     MSK10               DEPENDENCE                           3RN08790
       TZE     *+2                                                      3RN08800
       TSX     PRC020,4            SET I AND BETA ADDRESS               3RN08810
       TXI     *+1,2,-1                                                 3RN08820
       LDI*    PQUEUE                                                   3RN08830
       LNT     200000                                                   3RN08840
PRC017 TXH     PRC015,2,**         IF HEADER OR END OF QUEUE            3RN08850
       TRA     PRC060              LEAVE                                3RN08860
PRC020 SXA     PRC030,4                                                 3RN08870
       LXA     PRC040,4                                                 3RN08880
       TXI     *+1,4,-1                                                 3RN08890
       STZ     PROCCS,4                                                 3RN08900
       LDI*    PQUEUE                                                   3RN08910
       RIL     001000              CHANGE STATUS                        3RN08920
       SIL     000400                                                   3RN08930
       STI*    PQUEUE              TO PROCESSING ISSUED                 3RN08940
       LFT     100000                                                   3RN08950
       TRA     PRC040+1            COMMON BETA                          3RN08960
       LNT     000040                                                   3RN08970
       TSX     GETBF,1             WRITE ONLY REQUEST                   3RN08980
       PIA                                                              3RN08990
PRC025 PAC     0,1                                                      3RN09000
       CAL     1,1                                                      3RN09010
       ARS     18                                                       3RN09020
       ADD     L(1)                                                     3RN09030
       STA     PROCCS,4            SET BETA ADDRESS                     3RN09040
       RIL     777740                                                   3RN09050
       PIA                                                              3RN09060
       STD     PROCCS,4            AND I NUMBER                         3RN09070
       SXA     PRC040,4            SAVE COUNT                           3RN09080
PRC030 AXT     **,4                                                     3RN09090
       TRA     1,4                                                      3RN09100
PRC040 PZE                                                              3RN09110
       SXA     SVPRC2,2                                                 3RN09120
       PIA                                                              3RN09130
       PAC     0,1                                                      3RN09140
       STA     PRC048                                                   3RN09150
PRC044 CAL     5,1                                                      3RN09160
       LAS     PRC048                                                   3RN09170
       TRA     *+2                                                      3RN09180
       TRA     SVPRC2              END OF CHAIN                         3RN09190
       TSX     LOOKUP,1                                                 3RN09200
       LDI*    PQUEUE                                                   3RN09210
       PIA                                                              3RN09220
       PAC     0,1                                                      3RN09230
       LNT     001000              ANY REQUEST IN S=3                   3RN09240
       TRA     PRC044                                                   3RN09250
       LDQ     1,1                 YES                                  3RN09260
       LXA     SVPRC2,2                                                 3RN09270
       TSX     GETBF,1             COPY INTO PROCESSING BUFFER          3RN09280
       TSX     COPY,1                                                   3RN09290
SVPRC2 AXT     **,2                                                     3RN09300
       LDI*    PQUEUE                                                   3RN09310
       TRA     PRC025-1                                                 3RN09320
PRC048 PZE                                                              3RN09330
PRC050 TSX     PRC020,4                                                 3RN09340
PRC060 ENB*    (TRAPX              RESTORE TRAPS                        3RN09350
       LXA     PRC040,4                                                 3RN09360
       CLS     PROCCS,4            SET SIGN MINUS IN LAST WORD          3RN09370
       STO     PROCCS,4            OF CALLING SEQUENCE                  3RN09380
       AXC     PROCCS-1,4          SET XR4                              3RN09390
PRC070 TSX     **,2                GO TO PROCESSING ROUTINE             3RN09400
       SPACE                                                            3RN09410
*          UPON RETURN FROM THE PROCESSING ROUTINE, BETA REQUESTS       3RN09420
*          ARE PROCESSED AS SPECIFIED BY THE USER.                      3RN09430
       SPACE                                                            3RN09440
       CLA     PROCCS                                                   3RN09450
       TMI     SCHED               RANRPL WAS ENTERED, NO ACTION NEEDED 3RN09460
       ENB     L(0)                DISABLE TRAPS                        3RN09470
       TSX     LOOKUP,1            SEEK REQUEST POINTER                 3RN09480
       STZ     COUNT               RESET PROCCS COUNTER                 3RN09490
       CAL     MSK10                                                    3RN09500
       ANA*    PQUEUE              MUTUALLY DEPENDENT                   3RN09510
       TNZ     RNRL1                                                    3RN09520
       TSX     RNRL4,1             NO, TAKE REQUIRED ACTION             3RN09530
       TRA     SCHED               AND EXIT                             3RN09540
RNRL1  LDI*    PQUEUE                                                   3RN09550
       LNT     200000                                                   3RN09560
       TXI     *-2,2,1                                                  3RN09570
RNRL2  CAL     MSK10                                                    3RN09580
       ANA*    PQUEUE              MUTUAL DEPENDENCE                    3RN09590
       TZE     RNRL3                                                    3RN09600
       TSX     RNRL4,1             PROCESS                              3RN09610
RNRL3  TXI     *+1,2,-1            SEARCH NEXT                          3RN09620
       LDI*    PQUEUE                                                   3RN09630
       LNT     200000              UNLESS HEADER OR END OF QUEUE        3RN09640
RNRL5  TXH     RNRL2,2,**          REPEAT                               3RN09650
       TRA     SCHED                                                    3RN09660
RNRL4  SXA     SVRL1,1                                                  3RN09670
       SXA     SVRL2,2             SAVE XRS                             3RN09680
       LXA     COUNT,4                                                  3RN09690
       TXI     *+1,4,-1            INCREMENT COUNT                      3RN09700
       SXA     COUNT,4                                                  3RN09710
       CAL     PROCCS,4                                                 3RN09720
       ANA     MSK21               SHOULD THIS RECORD BE WRITTEN        3RN09730
       TNZ     RNRL9                                                    3RN09740
       LDI*    PQUEUE                                                   3RN09750
       RIL     010400                                                   3RN09760
       SIL     000200                                                   3RN09770
       STI*    PQUEUE                                                   3RN09780
       LFT     100000                                                   3RN09790
       TRA     RNRL10              COMMON BETA                          3RN09800
SVRL1  AXT     **,1                                                     3RN09810
SVRL2  AXT     **,2                RESTORE XRS                          3RN09820
       TRA     1,1                 EXIT                                 3RN09830
COUNT  PZE                                                              3RN09840
RNRL9  LDI*    PQUEUE                                                   3RN09850
       LFT     100000                                                   3RN09860
       TRA     RNRL15                                                   3RN09870
       TSX     RELBF,4             RELEASE BUFFER,                      3RN09880
       TSX     RELQS,4             QUEUE SEGMENT AND POINTER            3RN09890
       TRA     SVRL1                                                    3RN09900
RNRL10 PIA                                                              3RN09910
       STA     RNRL14              SAVE ADDRESS                         3RN09920
       PAC     0,1                                                      3RN09930
       CAL     5,1                                                      3RN09940
       LAS     RNRL14                                                   3RN09950
       TRA     *+2                                                      3RN09960
       TRA     RNRL12                                                   3RN09970
       TSX     LOOKUP,1                                                 3RN09980
       LDI*    PQUEUE              ANY OTHER REQUEST IN S5              3RN09990
       RIL     010000                                                   3RN10000
       PIA                                                              3RN10010
       LNT     000200                                                   3RN10020
       TRA     RNRL10+2                                                 3RN10030
       TSX     RELEM,4             YES - REMOVE REQUEST FROM CHAIN      3RN10040
       TSX     RELBF,4             BETA BUFFER                          3RN10050
       TSX     RELQS,4             AND QUEUE SEGMENT                    3RN10060
       CLA     RNRL14                                                   3RN10070
       TSX     LOOKUP,1                                                 3RN10080
       SXA     SVRL2,2             NEW POINTER POSITION - RESTORE XR2   3RN10090
RNRL12 LXA     SVRL2,2                                                  3RN10100
       CLA*    PQUEUE                                                   3RN10110
       PAC     0,1                                                      3RN10120
       LDQ     1,1                 SAVE BETA BUFFER                     3RN10130
RNRL13 CAL     5,1                                                      3RN10140
       LAS     RNRL14              ANY REQUEST IN S3                    3RN10150
       TRA     *+2                                                      3RN10160
       TRA     SVRL1               NO                                   3RN10170
       TSX     LOOKUP,1                                                 3RN10180
       LDI*    PQUEUE                                                   3RN10190
       RIL     010000                                                   3RN10200
       PIA                                                              3RN10210
       PAC     0,1                                                      3RN10220
       LNT     001000                                                   3RN10230
       TRA     RNRL13                                                   3RN10240
       TSX     COPY,1              COPY RECORD INTO BACK-UP BUFFER      3RN10250
       TRA     SVRL1                                                    3RN10260
RNRL14 PZE                                                              3RN10270
RNRL15 LFT     010000                                                   3RN10280
       TRA     *+3                 UNLESS SPECIAL FLAG ON               3RN10290
       TSX     RELEM,4             REMOVE FROM BETA CHAIN               3RN10300
       TRA     RNRL9+3             AND RETURN                           3RN10310
       STL     RNRL18                                                   3RN10320
       PIA                                                              3RN10330
       STA     RNRL14                                                   3RN10340
RNRL16 PAC     0,1                                                      3RN10350
       CAL     5,1                                                      3RN10360
       LAS     RNRL14                                                   3RN10370
       TRA     *+2                                                      3RN10380
       TRA     RNRL17                                                   3RN10390
       TSX     LOOKUP,1                                                 3RN10400
       LDI*    PQUEUE                                                   3RN10410
       PIA                                                              3RN10420
       RIL     011000              RESET SPECIAL FLAG AND S3            3RN10430
       SIL     040000              SET S1                               3RN10440
       ZET     RNRL18                                                   3RN10450
       SIL     040000              MAKE HEADER ONE OF THEM              3RN10460
       STI*    PQUEUE                                                   3RN10470
       STZ     RNRL18                                                   3RN10480
       TRA     RNRL16                                                   3RN10490
RNRL17 LXA     SVRL2,2                                                  3RN10500
       TRA     RNRL15+2                                                $3RN10510
RNRL18 PZE                                                              3RN10520
       SPACE                                                            3RN10530
*  TSX     RANRPL,4    1. REPLACES THE ADDRESS OF A BETA RECORD         3RN10540
*  PZE     REQ,,I      ALREADY DELIVERED WITH A NEW ONE.                3RN10550
*  PZE     A           2. CHANGES STATUS OF ALL REQUESTS IN THE GROUP.  3RN10560
*  P       PHYS. ADDR. 3. SAVES XRS AND SENSE INDICATORS.               3RN10570
*  VERIFICATION ADDRESS                                                 3RN10580
*  RETURN                                                               3RN10590
       SPACE                                                            3RN10600
RNRPL  ENB     L(0)                DISABLE TRAPS                        3RN10610
       SXA     SVRP1,1                                                  3RN10620
       SXA     SVRP2,2             SAVE XRS                             3RN10630
       SXA     SVRP4,4                                                  3RN10640
       STI     SENSRP              AND SENSE INDIC                      3RN10650
       CLA     1,4                                                      3RN10660
       TSX     LOOKUP-1,1          MATCH REQ,,I                         3RN10670
       CLA*    PQUEUE                                                   3RN10680
       PAC     0,1                                                      3RN10690
       CLA     2,4                                                      3RN10700
       STA     *+1                                                      3RN10710
       CLA     **                                                       3RN10720
       STA     1,1                                                      3RN10730
       CAL     3,4                 REPLACE ADDRESSES                    3RN10740
       SLW     3,1                                                      3RN10750
       LDI     4,4                                                      3RN10760
       TSX     H2ZBCD,4            CONVERT ZEROS IN HA2                 3RN10770
       STI     4,1                                                      3RN10780
       LDI*    PQUEUE                                                   3RN10790
       LFT     100000                                                   3RN10800
       TRA     RPL06               REQUEST IN BETA CHAIN                3RN10810
       TSX     RELBF,4             RELEASE BETA BUFFER                  3RN10820
RPL01  RIL     142440                                                   3RN10830
       SIL     004000              SET S1                               3RN10840
       STI*    PQUEUE                                                   3RN10850
       LNT     020000                                                   3RN10860
       TRA     RPL05               INDEPENDENT BETA                     3RN10870
       SXA     RPL04,2                                                  3RN10880
       LDI*    PQUEUE                                                   3RN10890
       LNT     200000                                                   3RN10900
       TXI     *-2,2,1             FIND HEADER                          3RN10910
RPL02  LNT     020400              IF MUTUAL DEPENDENT AND S=4          3RN10920
       TRA     RPL03                                                    3RN10930
       RIL     000400                                                   3RN10940
       SIL     001000                                                   3RN10950
       STI*    PQUEUE              CHANGE TO S3                         3RN10960
       LFT     100000                                                   3RN10970
       TRA     RPL07               REQUEST IN BETA CHAIN                3RN10980
RPL03  TXI     *+1,2,-1                                                 3RN10990
       LDI*    PQUEUE                                                   3RN11000
       LNT     200000              IF HEADER OR END OF QUEUE            3RN11010
       TXH     RPL02,2,**          PROCEED                              3RN11020
RPL04  AXT     **,2                RESTORE XR2                          3RN11030
RPL05  TSX     CHECK,4             CHECK FOR IDENTICAL BETAS            3RN11040
SVRP4  AXT     **,4                                                     3RN11050
       NZT     ERRFLG              IF ENTERED FROM ERRET                3RN11060
       TRA     *+3                                                      3RN11070
       STZ     ERRFLG              GO TO SCHEDULER                      3RN11080
       TRA     SCHED                                                    3RN11090
       CLA     PROCCS              IF ENTERED FROM PROCES               3RN11100
       SSM                         SET FLAG                             3RN11110
       STO     PROCCS              AND RETURN THERE                     3RN11120
SVRP1  AXT     **,1                                                     3RN11130
SVRP2  AXT     **,2                RESTORE XRS                          3RN11140
       LDI     SENSRP              AND SENSE INDICATORS                 3RN11150
       ENB*    (TRAPX              RESTORE TRAPS                        3RN11160
       TRA     5,4                 EXIT                                 3RN11170
RPL06  TSX     ERR05,4                                                  3RN11180
       LDI*    PQUEUE                                                   3RN11190
       TRA     RPL01                                                    3RN11200
RPL07  SXA     RPL08,2                                                  3RN11210
       PIA                                                              3RN11220
       STA     RPL09                                                    3RN11230
       PAC     0,1                                                      3RN11240
       CAL     5,1                                                      3RN11250
       LAS     RPL09               IF ANY OTHER REQUEST                 3RN11260
       TRA     *+2                                                      3RN11270
       TRA     RPL10                                                    3RN11280
       TSX     LOOKUP,1            IN CHAIN IS IN S=3                   3RN11290
       LDI*    PQUEUE                                                   3RN11300
       PIA                                                              3RN11310
       PAC     0,1                                                      3RN11320
       LNT     001000                                                   3RN11330
       TRA     RPL07+4                                                  3RN11340
       LDI     1,1                                                      3RN11350
RPL08  AXT     **,2                                                     3RN11360
       TSX     RELBF,4             RELEASE BUFFER                       3RN11370
       CLA*    PQUEUE                                                   3RN11380
       PAC     0,1                 ASSIGN COMMON BACK-UP                3RN11390
       PIA                                                              3RN11400
       STD     1,1                                                      3RN11410
RPL10  LXA     RPL08,2                                                  3RN11420
       TRA     RPL03                                                    3RN11430
RPL09  PZE                                                              3RN11440
SENSRP PZE                                                              3RN11450
       SPACE                                                            3RN11460
*  TSX     CHECK,4     1. COMPARES BETA ADDRESS WITH ALL OTHERS.        3RN11470
*  RETURN              2. CHAINS REQUESTS OF THE SAME BETA.             3RN11480
*                      3. P IS THE REQUEST GENERATING THE TEST,         3RN11490
*                      P(N) IS A REQUEST IN THE COMMON BETA CHAIN.      3RN11500
*                      4. ENTER WITH QUEUE,2 = REQUEST POINTER.         3RN11510
       SPACE                                                            3RN11520
CHECK  SXA     SVCK4,4                                                  3RN11530
       SXA     SVCK2,2             SAVE XRS                             3RN11540
       AXT     0,2                 SCAN FROM TOP                        3RN11550
       CLA     1,1                                                      3RN11560
       STA     CHCK4               GET UCB                              3RN11570
CHCK1  PXA     0,2                                                      3RN11580
       ERA     SVCK2               IS THIS THE REQUEST                  3RN11590
       TNZ     *+2                 PRODUCING THE CHECK                  3RN11600
       TXI     *+1,2,-1            JUMP OVER IT                         3RN11610
       CLA*    PQUEUE                                                   3RN11620
       PAC     0,4                 NEW QUEUE SEGMENT TO XR4             3RN11630
       CAL     1,4                                                      3RN11640
       ANA     ADDR                                                     3RN11650
       ERA     CHCK4               COMPARE  UCB'S                       3RN11660
       TNZ     CHCK2                                                    3RN11670
       CAL     4,4                                                      3RN11680
       ERA     4,1                 COMPARE VERIF. ADDRESSES             3RN11690
       TNZ     CHCK2                                                    3RN11700
       CAL     3,4                                                      3RN11710
       ERA     3,1                 COMPARE PHYSICAL ADDRESSES           3RN11720
       TZE     CHCK6               EQUAL, GO TO CHAINING ROUTINE        3RN11730
       CLA     3,4                                                      3RN11740
       LDQ     3,1                                                      3RN11750
       TMI     *+3                                                      3RN11760
       TQP     CHCK2               BOTH ADDR. IN BINARY                 3RN11770
       TRA     *+4                 AC BIN, MQ BCD                       3RN11780
       TQP     *+2                 AC BCD, MQ BIN                       3RN11790
       TRA     CHCK2               BOTH IN BCD                          3RN11800
       XCA                                                              3RN11810
       STQ     CHCK5                                                    3RN11820
       SXA     SVCK44,4                                                 3RN11830
       TSX     (DECVA,4            CONVERT TO BCD THE ONE IN BINARY     3RN11840
SVCK44 AXT     **,4                                                     3RN11850
       XCL                                                              3RN11860
       ANA     MSK15                                                    3RN11870
       ORA     MSK20                                                    3RN11880
       ERA     CHCK5               COMPARE                              3RN11890
       TZE     CHCK6               EQUAL                                3RN11900
CHCK2  TXI     *+1,2,-1                                                 3RN11910
       CLA*    PQUEUE                                                   3RN11920
       TZE     *+2                                                      3RN11930
CHCK3  TXH     CHCK1,2,**                                               3RN11940
       LXA     SVCK2,2             UNIQUE REQUEST                       3RN11950
       CAL     MSK9                FOR THIS BETA                        3RN11960
       ORS*    PQUEUE                                                   3RN11970
SVCK4  AXT     **,4                                                     3RN11980
       TRA     1,4                 EXIT                                 3RN11990
SVCK2  PZE                         XR2                                  3RN12000
CHCK4  PZE                                                              3RN12010
CHCK5  PZE                                                              3RN12020
CHCK6  SXA     SVCK22,2                                                 3RN12030
       CLA     CHCK12+2                                                 3RN12040
       STA     CHCK75                                                   3RN12050
       CLA*    PQUEUE                                                   3RN12060
       PAC     0,1                 P(N) TO XR1                          3RN12070
       LXA     SVCK2,2                                                  3RN12080
       CLA*    PQUEUE                                                   3RN12090
       PAC     0,4                 P TO XR4                             3RN12100
       LDI     5,1                                                      3RN12110
       STA     5,1                 P TO P(N)                            3RN12120
SVCK22 AXT     **,2                                                     3RN12130
       CLA*    PQUEUE                                                   3RN12140
       RFT     077777                                                   3RN12150
       TRA     *+3                                                      3RN12160
       STA     5,4                 IF NEW CHAIN, STORE                  3RN12170
       TRA     *+2                                                      3RN12180
       STI     5,4                                                      3RN12190
       LDI*    PQUEUE              RECIPROCAL ADDRESSES                 3RN12200
       SIL     100000              COMMON BETA FLAG TO P(N)             3RN12210
       STI*    PQUEUE                                                   3RN12220
       LFT     007000              IS P(N) IN S=3 OR LESS               3RN12230
       TRA     *+2                                                      3RN12240
       TRA     CHCK8                                                    3RN12250
       SXA     CHCK7,1             YES                                  3RN12260
       LNT     010000                                                   3RN12270
       TRA     *+3                                                      3RN12280
       CLA     CHCK12+1            IF REQUIRED SET SPECIAL FLAG         3RN12290
       STA     CHCK75                                                   3RN12300
       LNT     000040              IF NO BUFFER ASSIGNED TO P(N)        3RN12310
       TSX     GETBF,1             ASSIGN ONE                           3RN12320
CHCK7  AXT     **,1                                                     3RN12330
       LDQ     1,1                                                      3RN12340
       LXA     SVCK2,2                                                  3RN12350
       CAL     MSK3                SET NEW REQUEST                      3RN12360
       ANA*    PQUEUE                                                   3RN12370
       RIS     MSK3                                                     3RN12380
       OAI                                                              3RN12390
CHCK75 SIL     100040                                                   3RN12400
       STI*    PQUEUE              IN THE SAME STATUS                   3RN12410
       XCA                                                              3RN12420
       STD     1,4                 AND ASSIGN THE SAME BUFFER           3RN12430
       TRA     SVCK4                                                    3RN12440
CHCK8  PIA                                                              3RN12450
       STA     CHCK12              P(N) IS END OF CHAIN                 3RN12460
       CAL     5,4                                                      3RN12470
       LAS     CHCK12                                                   3RN12480
       TRA     *+2                                                      3RN12490
       TRA     CHCK9               ALL CHAIN SCANNED                    3RN12500
       TSX     LOOKUP,1                                                 3RN12510
       LDI*    PQUEUE                                                   3RN12520
       PIA                                                              3RN12530
       PAC     0,1                                                      3RN12540
       LFT     007000              STATUS 3 OR LOWER                    3RN12550
       TRA     CHCK7+1             YES                                  3RN12560
       CAL     5,1                 NO, REPEAT                           3RN12570
       TRA     CHCK8+3                                                  3RN12580
CHCK9  LXA     SVCK22,2                                                 3RN12590
       LDI*    PQUEUE                                                   3RN12600
       LFT     000300              P(N) IN S = 5 OR 6                   3RN12610
       TRA     *+2                 YES                                  3RN12620
       TRA     CHCK10              NO, SEARCH                           3RN12630
       PIA                                                              3RN12640
       PAC     0,1                                                      3RN12650
CHCK11 LDQ     1,1                 OLD REQUEST BUFFER                   3RN12660
       LXA     SVCK2,2                                                  3RN12670
       TSX     GETBF,1             GET ONE FOR NEW SEGMENT              3RN12680
       TSX     COPY,1              AND COPY OLD ONE                     3RN12690
       LDI*    PQUEUE                                                   3RN12700
       RIL     004000                                                   3RN12710
       SIL     101000              COMMON BETA AND S=3                  3RN12720
       STI*    PQUEUE                                                   3RN12730
       TRA     SVCK4                                                    3RN12740
CHCK10 CAL     5,4                                                      3RN12750
       LAS     CHCK12                                                   3RN12760
       TRA     *+2                                                      3RN12770
       TRA     CHCK13                                                   3RN12780
       TSX     LOOKUP,1                                                 3RN12790
       LDI*    PQUEUE                                                   3RN12800
       PIA                                                              3RN12810
       PAC     0,1                                                      3RN12820
       LFT     000300              S = 5 OR 6                           3RN12830
       TRA     CHCK11              YES                                  3RN12840
       CAL     5,1                                                      3RN12850
       TRA     CHCK10+1            KEEP SEARCHING                       3RN12860
CHCK12 PZE                                                              3RN12870
       OCT     000000010040                                             3RN12880
       OCT     000000000040                                             3RN12890
CHCK13 TSX     GETBF,1             WHOLE CHAIN IN S4                    3RN12900
       LDI*    PQUEUE              ASSIGN BUFFER                        3RN12910
       RIL     004000              AND SET NEW REQUEST                  3RN12920
       SIL     111000              IN S3, COMMON BETA, SPECIAL FLAG     3RN12930
CHCK14 STI*    PQUEUE                                                   3RN12940
       PIA                                                              3RN12950
       PAC     0,1                                                      3RN12960
       CAL     5,1                                                      3RN12970
       LAS     CHCK12                                                   3RN12980
       TRA     *+2                                                      3RN12990
       TRA     SVCK4                                                    3RN13000
       TSX     LOOKUP,1            SET SPECIAL FLAG IN THE REMAINING    3RN13010
       LDI*    PQUEUE                                                   3RN13020
       SIL     010000              ELEMENTS OF THE CHAIN                3RN13030
       TRA     CHCK14                                                   3RN13040
       SPACE                                                            3RN13050
*  TSX     RELBF,4   1. RELEASES BETA BUFFER, RESTORES                  3RN13060
*  RETURN            AVAILABILITY CHAIN.                                3RN13070
       SPACE                                                            3RN13080
RELBF  CLA*    PQUEUE                                                   3RN13090
       SXA     RELBSV,1                                                 3RN13100
       PAC     0,1                                                      3RN13110
       CAL     1,1                                                      3RN13120
       PDC     0,1                                                      3RN13130
       CLA     0,1                                                      3RN13140
       LDQ*    PDRHA                                                    3RN13150
       STA*    PDRHA                                                    3RN13160
       XCA                                                              3RN13170
       STA     0,1                                                      3RN13180
RELBSV AXT     **,1                                                     3RN13190
       TRA     1,4                                                      3RN13200
       SPACE                                                            3RN13210
*  TSX     RELQS,4   1. RELEASES QUEUE SEGMENT, RESTORES AVAILABILITY   3RN13220
*  RETURN            CHAIN.  2. RESTORES REQUEST POINTER QUEUE.         3RN13230
       SPACE                                                            3RN13240
RELQS  CLA*    PQUEUE                                                   3RN13250
       PAC     0,1                                                      3RN13260
       CLA     0,1                 RESTORE AVAIL CHAIN                  3RN13270
       LDQ*    SQUEUE                                                   3RN13280
       STA*    SQUEUE                                                   3RN13290
       XCA                                                              3RN13300
       STA     0,1                                                      3RN13310
       CAL*    PQUEUE              IS THIS THE HEADER                   3RN13320
       STZ*    PQUEUE                                                   3RN13330
       ANA     MSK2                                                     3RN13340
       TXI     *+1,2,-1                                                 3RN13350
       TZE     *+3                                                      3RN13360
       ZET*    PQUEUE                                                   3RN13370
       ORS*    PQUEUE                                                   3RN13380
RLQS2  TXL     RLQS4,2,**          DONT GO TOO FAR                      3RN13390
       CLA*    PQUEUE                                                   3RN13400
       TZE     1,4                                                      3RN13410
       STZ*    PQUEUE                                                   3RN13420
       TXI     *+1,2,1             RESTORE QUEUE                        3RN13430
       STO*    PQUEUE                                                   3RN13440
       TXI     RLQS2,2,-2                                               3RN13450
RLQS4  TRA     1,4                                                      3RN13460
       SPACE                                                            3RN13470
*  TSX     GETBF,1     1. FINDS AN AVAILABLE BUFFER IN DRHA, AND STORES 3RN13480
*  RETURN              ITS ADDRESS IN THE QUEUE SEGMENT.                3RN13490
*                      2. IF NO BUFFER IS AVAILABLE, RETURNS            3RN13500
*                      WITH THE AC NEGATIVE.                            3RN13510
       SPACE                                                            3RN13520
GETBF  SXA     SVGBF1,1                                                 3RN13530
       CLA*    PDRHA                                                    3RN13540
       STA     *+1                                                      3RN13550
GTBF1  CLA     **                                                       3RN13560
       TMI     1,1                 NONE AVAILABLE, EXIT                 3RN13570
       STA*    PDRHA                                                    3RN13580
       CLA     GTBF1               UPDATE AVAIL CHAIN                   3RN13590
       STA*    GTBF1                                                    3RN13600
       CLA*    PQUEUE                                                   3RN13610
       PAC     0,1                                                      3RN13620
       CLA     GTBF1                                                    3RN13630
       ALS     18                  STORE BUFFER ADDRESS                 3RN13640
       STD     1,1                 IN QUEUE SEGMENT                     3RN13650
       CAL     MSK19                                                    3RN13660
       ORS*    PQUEUE              AND SET BUFFER ASSIGNED FLAG         3RN13670
SVGBF1 AXT     **,1                                                     3RN13680
       TRA     1,1                                                      3RN13690
       SPACE                                                            3RN13700
*  TSX     RELEM,4     1. RELEASES REQUEST FROM COMMON BETA CHAIN.      3RN13710
*  RETURN              2. ENTER WITH QUEUE,2 = REQUEST POINTER.         3RN13720
       SPACE                                                            3RN13730
RELEM  CLA*    PQUEUE                                                   3RN13740
       STA     RELM2                                                    3RN13750
       PAC     0,1                                                      3RN13760
       LDQ     5,1                 NEXT ELEMENT ADDRESS                 3RN13770
RELM1  CAL     5,1                 GET CHAIN WORD                       3RN13780
       LAS     RELM2               COMPARE                              3RN13790
       TRA     *+2                                                      3RN13800
       TRA     *+3                 EQUAL                                3RN13810
       PAC     0,1                                                      3RN13820
       TRA     RELM1                                                    3RN13830
       XCL                                                              3RN13840
       STA     5,1                 HEALED IS THE WOUND                  3RN13850
       TRA     1,4                 EXIT                                 3RN13860
RELM2  PZE                                                              3RN13870
       SPACE                                                            3RN13880
*  TSX     COPY,1      1.INTO A BUFFER ATTACHED TO REQUEST QUEUE,2      3RN13890
*  RETURN              COPY ANOTHER ONE WHOSE ADDRESS IS GIVEN          3RN13900
*                      BY THE MQ DECREMENT.                             3RN13910
       SPACE                                                            3RN13920
COPY   SXA     SVCPY1,1                                                 3RN13930
       XCL                                                              3RN13940
       ARS     18                                                       3RN13950
       ADD     L(1)                                                     3RN13960
       STA     CPY1                                                     3RN13970
       CLA*    PQUEUE                                                   3RN13980
       PAC     0,1                                                      3RN13990
       CAL     1,1                                                      3RN14000
       ARS     18                                                       3RN14010
       ADD     L(1)                                                     3RN14020
       STA     CPY1+1                                                   3RN14030
       LAC     L(R),1                                                   3RN14040
       TXI     *+1,1,1                                                  3RN14050
CPY1   CAL     **,1                                                     3RN14060
       SLW     **,1                                                     3RN14070
       TXH     CPY1-1,1,0                                               3RN14080
SVCPY1 AXT     **,1                                                     3RN14090
       TRA     1,1                                                      3RN14100
       SPACE                                                            3RN14110
*  TSX     H2BCDZ,4    CONVERTS BCD 12S TO ZEROS IN HA2.                3RN14120
       SPACE                                                            3RN14130
H2BCDZ RNT     001200                                                   3RN14140
       TRA     *+4                                                      3RN14150
       RFT     006500                                                   3RN14160
       TRA     *+2                                                      3RN14170
       RIR     007700                                                   3RN14180
       RNT     000012                                                   3RN14190
       TRA     1,4                                                      3RN14200
       RFT     000065                                                   3RN14210
       TRA     1,4                                                      3RN14220
       RIR     000077                                                   3RN14230
       TRA     1,4                                                      3RN14240
       SPACE                                                            3RN14250
*  TSX     H2ZBCD,4    CONVERTS ZEROS TO BCD 12S IN HA2.                3RN14260
       SPACE                                                            3RN14270
H2ZBCD RFT     007700                                                   3RN14280
       TRA     *+2                                                      3RN14290
       SIR     001200                                                   3RN14300
       RFT     000077                                                   3RN14310
       TRA     *+2                                                      3RN14320
       SIR     000012                                                   3RN14330
       TRA     1,4                                                      3RN14340
       SPACE                                                            3RN14350
*  THIS ERROR ROUTINE DEALS WITH NO RECORD FOUND AND INVALID ADDRESS    3RN14360
*     ERROR CONDITIONS.                                                 3RN14370
       SPACE                                                            3RN14380
ERROR  CAL*    PQUEUE                                                   3RN14390
       PAC     0,4                                                      3RN14400
       STA     ERR01+2             SET REQ,,I                           3RN14410
       ANA     MSKI                                                     3RN14420
       STD     ERR01+2                                                  3RN14430
       CLA     0,4                                                      3RN14440
       ARS     18                  ALPHA AND ERRET                      3RN14450
       STA     ERR01+1                                                  3RN14460
       CLA     2,4                                                      3RN14470
       STA     ERR01                                                    3RN14480
       LDI*    PQUEUE                                                   3RN14490
       RIR     200000                                                   3RN14500
       STI*    PQUEUE                                                   3RN14510
       STL     ERRFLG                                                   3RN14520
       ENB*    (TRAPX                                                   3RN14530
ERR01  TSX     **,4                GO TO USERS ERROR ROUTINE            3RN14540
       PZE                                                              3RN14550
       PZE                                                              3RN14560
       TRA     ERR03                                                    3RN14570
       ENB     L(0)                                                     3RN14580
       CLA     ERR01+2                                                  3RN14590
       TSX     LOOKUP,1                                                 3RN14600
       LDI*    PQUEUE                                                   3RN14610
       LNT     200000                                                   3RN14620
       TXI     *-2,2,1                                                  3RN14630
ERR02  LNT     100000                                                   3RN14640
       TRA     *+3                                                      3RN14650
       TSX     ERR05,4             COMMON BETA                          3RN14660
       TRA     *+2                                                      3RN14670
       TSX     RELBF,4             RELEASE BETA BUFFERS                 3RN14680
       SXA     *+2,2                                                    3RN14690
       TSX     RELQS,4             AND QUEUE SEGMENTS                   3RN14700
       AXT     **,2                FOR THE WHOLE SET                    3RN14710
       LDI*    PQUEUE                                                   3RN14720
       ZET*    PQUEUE                                                   3RN14730
       LFT     200000                                                   3RN14740
       TRA     ERR04                                                    3RN14750
       TRA     ERR02                                                    3RN14760
ERR03  ENB     L(0)                                                     3RN14770
       CLA     ERR01+2                                                  3RN14780
       TSX     LOOKUP-1,1                                               3RN14790
       LDI*    PQUEUE                                                   3RN14800
       LNT     100000                                                   3RN14810
       TRA     *+3                                                      3RN14820
       TSX     ERR05,4                                                  3RN14830
       TRA     *+2                                                      3RN14840
       TSX     RELBF,4             RELEASE BETA BUFFER                  3RN14850
       TSX     RELQS,4             AND QUEUE SEGMENT                    3RN14860
ERR04  STZ     ERRFLG              RESET ERROR FLAG                     3RN14870
       TRA     SCHED               RETURN TO SCHEDULER                  3RN14880
ERR05  SXA     SVERR2,2                                                 3RN14890
       SXA     ERR06,4                                                  3RN14900
       STL     ERR11                                                    3RN14910
       LDI*    PQUEUE              IS REQUEST IN S2                     3RN14920
       LFT     002000                                                   3RN14930
       TRA     ERR06+2             YES - RANRPL ENTERED FROM ERRET      3RN14940
       LFT     010000                                                  $3RN14950
       TRA     ERR10                                                   $3RN14960
       TSX     RELBF,4                                                  3RN14970
       TSX     RELEM,4                                                  3RN14980
ERR06  AXT     **,4                                                     3RN14990
       TRA     1,4                                                      3RN15000
       PIA                                                              3RN15010
       STA     ERR09                                                    3RN15020
ERR07  PAC     0,1                                                      3RN15030
       CAL     5,1                                                      3RN15040
       LAS     ERR09               SEARCH FOR OTHER REQUESTS IN S2      3RN15050
       TRA     *+2                                                      3RN15060
       TRA     ERR08                                                    3RN15070
       TSX     LOOKUP,1                                                 3RN15080
       LDI*    PQUEUE              TO DETERMINE IF BUFFER               3RN15090
       PIA                                                              3RN15100
       LNT     002000                                                   3RN15110
       TRA     ERR07               SHOULD BE RELEASED                   3RN15120
SVERR2 AXT     **,2                                                     3RN15130
       TRA     ERR06-1                                                  3RN15140
ERR08  LXA     SVERR2,2                                                 3RN15150
       TRA     ERR06-2                                                  3RN15160
ERR09  PZE                                                              3RN15170
ERR10  PIA                                                             $3RN15180
       STA     ERR09                                                   $3RN15190
       PAC     0,1                                                     $3RN15200
       CAL     5,1                                                      3RN15210
       LAS     ERR09                                                    3RN15220
       TRA     *+2                                                      3RN15230
       TRA     ERR08                                                    3RN15240
       TSX     LOOKUP,1                                                 3RN15250
       LDI*    PQUEUE                                                   3RN15260
       PIA                                                              3RN15270
       RIL     011000              RESET SPECIAL FLAG AND S3            3RN15280
       SIL     004000              SET S1                               3RN15290
       ZET     ERR11                                                    3RN15300
       SIL     040000              MAKE HEADER ONE OF THEM              3RN15310
       STI*    PQUEUE                                                   3RN15320
       STZ     ERR11                                                    3RN15330
       TRA     ERR10                                                    3RN15340
ERR11  PZE                                                              3RN15350
PROCCS BSS     10                  PROCESSING ROUTINE CALL. SEQ. AREA   3RN15360
       END                                                          (14)3RN15370
$IBSYS                                                                  3RN99998
$STOP                                                                   3RN99999
