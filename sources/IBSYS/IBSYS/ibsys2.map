$JOB   7090-PR-130   7090/7094 IBSYS PROCESSOR   7090-SV-918 VERSION $6$IBB00000
$EXECUTE       IBJOB                                                 $6$IBB00005
$IBJOB         NOGO                                                  $6$IBB00010
$TITLE NODAT   7090-PR-130   7090/7094 IBSYS PROCESSOR   7090/SV/918 $6$IBB00015
$IBMAP IBSYS   8500,ABSMOD,()OK                                      $6$IBB00020
* 7090-PR-130   7090/7094 IBSYS    7090-SV-918   VERSION 6  MOD. 11 (11)IBB00025
       SPACE   3                                                     $6$IBB00030
       PCC     ON                                                    $6$IBB00035
       PMC     ON                                                    $6$IBB00040
       TITLE                                                         $6$IBB00045
       TTL     MACROS - TABLE GENERATORS, ETC.                       $6$IBB00051
GETCHN MACRO   X             CNTCHN=NO. OF HIGHEST EXISTING CHAN(A=1)$6$IBB00053
CNTCHN SET     0                                                     $6$IBB00054
       IRP     X                                                     $6$IBB00055
CNTCHN SET     CNTCHN+1                                              $6$IBB00056
       IFF     CH'X'4=0                                              $6$IBB00057
LSTCHN SET     CNTCHN                                                $6$IBB00058
       IRP                                                           $6$IBB00059
       ENDM    GETCHN                                                $6$IBB0005A
       REM                                                           $6$IBB0005B
COMMDS MACRO   COMTYP,ADDITL       TABLE GENERATOR                   $6$IBB0005C
       CALCOM  (A,B,C,D,E,F,G,H),COMTYP,(ADDITL)                     $6$IBB0005D
       ENDM    COMMDS,NOCRS                                          $6$IBB0005E
       REM                                                           $6$IBB0005F
CALCOM MACRO   X,COMTYP,ADDITL     CALLS COMTYP ONCE FOR EACH CHAN   $6$IBB0005G
FINI   SET     0                                                     $6$IBB0005H
       IRP     X                                                     $6$IBB0005I
FINI   SET     FINI+1                                                $6$IBB0005J
       IFT     FINI=+HGHCHN                                          $6$IBB0005K
       GOTO    ENDIRP                                                $6$IBB0005L
       COMTYP  X,ADDITL                                              $6$IBB0005M
       IRP                                                           $6$IBB0005N
       ENDM    CALCOM,NOCRS                                          $6$IBB0005O
       REM     'COMTYP' MACROS                                       $6$IBB0005P
UCWLOC MACRO   X,NULARG                                              $6$IBB0005Q
UCB'X' VFD     3/CDRD'X'+PRNT'X'+PNCH'X',15/CH'X'0,18/UE'X'11        $6$IBB0005R
       ENDM    UCWLOC,NOCRS                                          $6$IBB0005S
       REM                                                           $6$IBB0005T
VARLOC MACRO   X,LOC,OP,AD                                           $6$IBB0005U
LOC'X' OP      AD                                                    $6$IBB0005V
       ENDM    VARLOC                                                $6$IBB0005W
       REM                                                           $6$IBB0005X
STCMAC MACRO   X,NULARG                                              $6$IBB0005Y
       STC'X'  UE'X'11+4*CH'X'0-4                                    $6$IBB0005Z
       ENDM    STCMAC,NOCRS                                          $6$IBB00060
       REM                                                           $6$IBB00061
VAROP  MACRO   X,OP,AD                                               $6$IBB00062
       OP'X'   AD                                                    $6$IBB00063
       ENDM    VAROP                                                 $6$IBB00064
       REM                                                           $6$IBB00065
TEFMAC MACRO   X,NULARG                                              $6$IBB00066
       TEF'X'  4*CH'X'0                                              $6$IBB00067
       ENDM    TEFMAC,NOCRS                                          $6$IBB00068
       REM                                                           $6$IBB00069
ETTSDC MACRO   X,NULARG                                              $6$IBB0006A
       IFF     CH'X'3=0                                              $6$IBB0006B
       SCD'X'  COMMD                                                 $6$IBB0006C
       IFT     CH'X'3=0                                              $6$IBB0006D
       ETT'X'                                                        $6$IBB0006E
       ENDM    ETTSDC,NOCRS                                          $6$IBB0006F
       REM     'MOVLDR' MOVES IBNUC,SPOUT,SYSLB LOADERS              $6$IBB0006G
MOVLDR MACRO   BGNLDR,ENDLDR,LOADAD,XR1,AC                           $6$IBB0006H
       IFF     /XR1/=//                                              $6$IBB0006I
       SXA     XR1SAV,1                                              $6$IBB0006J
       IFF     /AC/=//                                               $6$IBB0006K
       SLW     ACKEP                                                 $6$IBB0006L
       AXT     ENDLDR-BGNLDR,1                                       $6$IBB0006M
       CAL     LOADAD+ENDLDR-BGNLDR,1                                $6$IBB0006N
       SLW     ENDLDR,1                                              $6$IBB0006O
       TIX     *-2,1,1                                               $6$IBB0006P
       IFF     /XR1/=//                                              $6$IBB0006Q
       LXA     XR1SAV,1                                              $6$IBB0006R
       IFF     /AC/=//                                               $6$IBB0006S
       CAL     ACKEP                                                 $6$IBB0006T
       ENDM    MOVLDR,NOCRS                                          $6$IBB0006U
       TTL     INSTALLATION MACHINE CONFIGURATION                       IBB00070
*    THE FOLLOWING 'EQU' CARDS MUST BE PROPERLY SET UP ACCORDING TO     IBB00080
*       THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD         IBB00090
EQU    OPSYN   SET                                                   $6$IBB00095
       SPACE   1                                                        IBB00100
*                     MACHINE TYPE.....709 OR 7090                      IBB00110
*      EXPANSION FACTOR=12 CELLS IN IOEX FOR 7090 OVER 709              IBB00120
IBM    EQU     7090                                                     IBB00130
       SPACE   1                                                        IBB00140
*             BASIC MONITOR ORG FOR NUCLEUS ALWAYS IN CORE              IBB00150
*      (MINIMUM=LAST MACHINE TRAP/INTERUPT CELL+1)                      IBB00160
IBSORG EQU     64                                                       IBB00170
       SPACE   1                                                        IBB00180
*                    IOEX ORIGIN (TRAP SUPERVISOR)                      IBB00190
*      (MINIMUM=LAST UNIT CONTROL BLOCK CELL+1)                         IBB00200
IOXORG EQU     450                                                      IBB00210
       SPACE   1                                                        IBB00220
*                  COMMON SYSTEM ORIGIN (ALL SYSTEMS)                   IBB00230
*      (MINIMUM=LAST INSTALLATION TRAP ROUTINE CELL+51)                 IBB00240
SYSORG EQU     1450                                                     IBB00250
       SPACE   1                                                        IBB00260
*             COMMON SYSTEM UPPER CORE LIMIT (ALL SYSTEMS)              IBB00270
*      (MOVE DOWN TO MAKE ROOM FOR INSTALLATION ACCOUNTING ETC.ROUTINES)IBB00280
SYSEND EQU     -1                                                       IBB00290
       SPACE                                                            IBB00300
*      DENSITY TO BE ASSUMED ON $AS CARD IF NOT SPECIFIED               IBB00310
*              HIGH IF HIGHLO = 1,  LOW IF HIGHLO = 0                   IBB00320
HIGHLO EQU     1                                                     $6$IBB00330
       REM                                                           $6$IBB00331
*      DENSITY TO BE ASSUMED WHEN WRITING BLANK TAPE                 $6$IBB00332
ASDENS EQU     800                 CHARACTERS/INCH                   $6$IBB00333
       SPACE                                                            IBB00340
*PP    EQU     CUU      WHERE C = CHAN, UU = UNIT OF ALTERNATE SYSTEM   IBB00350
*                       TAPE     IF EQU 0, NO PING PONG WILL TAKE PLACE IBB00360
PP     EQU     0                                                        IBB00370
       SPACE   1                                                        IBB00380
*                            SYSTEM PRINTER                             IBB00390
       SPACE   1                                                        IBB00400
*         PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10           IBB00410
EJECT  EQU     1                                                        IBB00420
       SPACE   1                                                        IBB00430
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       IBB00440
DBLSP  EQU     4                                                        IBB00450
       SPACE   1                                                        IBB00460
*          NUMBER OF RECOVERY TRIES FOR EACH READ REDUNDANCY.           IBB00470
RDUNRT EQU     100                                                      IBB00480
       SPACE   1                                                        IBB00490
*      TRANSFER TRAP MODE. IF=1, TRAP MODE WILL BE SAVED BY IOEX.       IBB00500
*            IF=0, TRAP MODE WILL REMAIN IN EFFECT IN IOEX.             IBB00510
* IF=1 ADDS 13 CELLS IN IOEX AND COSTS 18 CYCLES PER TRAP               IBB00520
ETMODE EQU     0                                                        IBB00530
       EJECT                                                            IBB00540
*                             CHANNEL 'A'                               IBB00550
*              729 TAPE DRIVES                                          IBB00560
*                    NO. OF TAPES.....0 THROUGH 10                      IBB00570
 CHA1  EQU     10                                                       IBB00580
       SPACE   1                                                        IBB00590
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB00600
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB00610
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB00620
CHAAT  BOOL    00000              CR, PU, PR, AND 10 TAPES ATTACHED     IBB00630
       SPACE   1                                                        IBB00640
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB00650
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB00660
CHAMD  BOOL    01777               ALL TAPES MODEL IV                   IBB00670
       SPACE   1                                                        IBB00680
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB00690
PRNTA  EQU     1                                                        IBB00700
       SPACE   1                                                        IBB00710
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB00720
PNCHA  EQU     1                                                        IBB00730
       SPACE   1                                                        IBB00740
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB00750
CDRDA  EQU     1                                                        IBB00760
       SPACE   1                                                        IBB00770
*                             7340 TAPE DRIVES (REDUNDAMT ON CHANNEL A) IBB00780
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB00790
HTA1   EQU     0                                                        IBB00800
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB00810
HTAA1  BOOL    1777                                                     IBB00820
       SPACE   1                                                        IBB00830
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB00840
HTA2   EQU     0                                                        IBB00850
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB00860
HTAA2  BOOL    1777                                                     IBB00870
       SPACE   1                                                        IBB00880
*              1301 DISK AND 7320 NEED FILES                            IBB00890
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB00900
DFA1   EQU     0                                                        IBB00910
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB00920
DFA3   EQU     0                                                     $6$IBB00930
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB00940
NFA1   EQU     0                                                        IBB00950
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB00960
DFAA1  BOOL    1777                                                     IBB00970
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB00980
IFA1   EQU     0                                                        IBB00990
       SPACE   1                                                        IBB01000
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB01010
DFA2   EQU     0                                                        IBB01020
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB01030
DFA4   EQU     0                                                     $6$IBB01040
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB01050
NFA2   EQU     0                                                        IBB01060
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB01070
DFAA2  BOOL    1777                                                     IBB01080
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB01090
IFA2   EQU     0                                                        IBB01100
       EJECT                                                            IBB01110
*                             CHANNEL 'B'                               IBB01120
*              729 TAPE DRIVES                                          IBB01130
*                    NO. OF TAPES.....0 THROUGH 10                      IBB01140
 CHB1  EQU     10                                                       IBB01150
       SPACE   1                                                        IBB01160
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB01170
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB01180
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB01190
CHBAT  BOOL    16000              10 729 TAPES ATTACHED                 IBB01200
       SPACE   1                                                        IBB01210
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB01220
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB01230
CHBMD  BOOL    01777               ALL TAPES MODEL IV                   IBB01240
       SPACE   1                                                        IBB01250
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB01260
PRNTB  EQU     0                                                        IBB01270
       SPACE   1                                                        IBB01280
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB01290
PNCHB  EQU     0                                                        IBB01300
       SPACE   1                                                        IBB01310
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB01320
CDRDB  EQU     0                                                        IBB01330
       SPACE   1                                                        IBB01340
*              7340 TAPE DRIVES                                         IBB01350
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB01360
HTB1   EQU     0                                                        IBB01370
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB01380
HTBA1  BOOL    1777                                                     IBB01390
       SPACE   1                                                        IBB01400
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB01410
HTB2   EQU     0                                                        IBB01420
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB01430
HTBA2  BOOL    1777                                                     IBB01440
       SPACE   1                                                        IBB01450
*              1301 DISK AND 7320 NEED FILES                            IBB01460
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB01470
DFB1   EQU     0                                                        IBB01480
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB01490
DFB3   EQU     0                                                     $6$IBB01500
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB01510
NFB1   EQU     0                                                        IBB01520
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB01530
DFBA1  BOOL    1777                                                     IBB01540
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB01550
IFB1   EQU     0                                                        IBB01560
       SPACE   1                                                        IBB01570
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB01580
DFB2   EQU     0                                                        IBB01590
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB01600
DFB4   EQU     0                                                     $6$IBB01610
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB01620
NFB2   EQU     0                                                        IBB01630
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB01640
DFBA2  BOOL    1777                                                     IBB01650
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB01660
IFB2   EQU     0                                                        IBB01670
       EJECT                                                            IBB01680
*                             CHANNEL 'C'                               IBB01690
*              729 TAPE DRIVES                                          IBB01700
*                    NO. OF TAPES.....0 THROUGH 10                      IBB01710
CHC1   EQU     0                                                        IBB01720
       SPACE   1                                                        IBB01730
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB01740
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB01750
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB01760
CHCAT  BOOL    17777                                                 $6$IBB01770
       SPACE   1                                                        IBB01780
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB01790
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB01800
CHCMD  BOOL    1777                ALL DRIVES MODEL IV                  IBB01810
       SPACE   1                                                        IBB01820
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB01830
PRNTC  EQU     0                                                        IBB01840
       SPACE   1                                                        IBB01850
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB01860
PNCHC  EQU     0                                                        IBB01870
       SPACE   1                                                        IBB01880
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB01890
CDRDC  EQU     0                                                        IBB01900
       SPACE   1                                                        IBB01910
*              7340 TAPE DRIVES                                         IBB01920
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB01930
HTC1   EQU     0                                                        IBB01940
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB01950
HTCA1  BOOL    1777                                                     IBB01960
       SPACE   1                                                        IBB01970
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB01980
HTC2   EQU     0                                                        IBB01990
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB02000
HTCA2  BOOL    1777                                                     IBB02010
       SPACE   1                                                        IBB02020
*              1301 DISK AND 7320 NEED FILES                            IBB02030
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB02040
DFC1   EQU     0                                                        IBB02050
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB02060
DFC3   EQU     0                                                     $6$IBB02070
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB02080
NFC1   EQU     0                                                        IBB02090
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB02100
DFCA1  BOOL    1777                                                     IBB02110
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB02120
IFC1   EQU     0                                                        IBB02130
       SPACE                                                            IBB02140
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB02150
DFC2   EQU     0                                                        IBB02160
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB02170
DFC4   EQU     0                                                     $6$IBB02180
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB02190
NFC2   EQU     0                                                        IBB02200
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB02210
DFCA2  BOOL    1777                                                     IBB02220
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB02230
IFC2   EQU     0                                                        IBB02240
       EJECT                                                            IBB02250
*                             CHANNEL 'D'                               IBB02260
*              729 TAPE DRIVES                                          IBB02270
*                    NO. OF TAPES.....0 THROUGH 10                      IBB02280
CHD1   EQU     0                                                        IBB02290
       SPACE   1                                                        IBB02300
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB02310
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB02320
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB02330
CHDAT  BOOL    17777                                                 $6$IBB02340
       SPACE   1                                                        IBB02350
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB02360
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB02370
CHDMD  BOOL    1777                ALL DRIVES MODEL IV                  IBB02380
       SPACE   1                                                        IBB02390
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB02400
PRNTD  EQU     0                                                        IBB02410
       SPACE   1                                                        IBB02420
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB02430
PNCHD  EQU     0                                                        IBB02440
       SPACE   1                                                        IBB02450
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB02460
CDRDD  EQU     0                                                        IBB02470
       SPACE   1                                                        IBB02480
*              7340 TAPE DRIVES                                         IBB02490
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB02500
HTD1   EQU     0                                                        IBB02510
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB02520
HTDA1  BOOL    1777                                                     IBB02530
       SPACE   1                                                        IBB02540
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB02550
HTD2   EQU     0                                                        IBB02560
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB02570
HTDA2  BOOL    1777                                                     IBB02580
       SPACE   1                                                        IBB02590
*              1301 DISK AND 7320 NEED FILES                            IBB02600
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB02610
DFD1   EQU     0                                                        IBB02620
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB02630
DFD3   EQU     0                                                     $6$IBB02640
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB02650
NFD1   EQU     0                                                        IBB02660
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB02670
DFDA1  BOOL    1777                                                     IBB02680
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB02690
IFD1   EQU     0                                                        IBB02700
       SPACE   1                                                        IBB02710
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB02720
DFD2   EQU     0                                                        IBB02730
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB02740
DFD4   EQU     0                                                     $6$IBB02750
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB02760
NFD2   EQU     0                                                        IBB02770
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB02780
DFDA2  BOOL    1777                                                     IBB02790
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB02800
IFD2   EQU     0                                                        IBB02810
       EJECT                                                            IBB02820
*                             CHANNEL 'E'                               IBB02830
*              729 TAPE DRIVES                                          IBB02840
*                    NO. OF TAPES.....0 THROUGH 10                      IBB02850
CHE1   EQU     0                                                        IBB02860
       SPACE   1                                                        IBB02870
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB02880
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB02890
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB02900
CHEAT  BOOL    17777                                                    IBB02910
       SPACE   1                                                        IBB02920
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB02930
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB02940
CHEMD  BOOL    1777                                                     IBB02950
       SPACE   1                                                        IBB02960
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB02970
PRNTE  EQU     0                                                        IBB02980
       SPACE   1                                                        IBB02990
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB03000
PNCHE  EQU     0                                                        IBB03010
       SPACE   1                                                        IBB03020
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB03030
CDRDE  EQU     0                                                        IBB03040
       SPACE   1                                                        IBB03050
*              7340 TAPE DRIVES                                         IBB03060
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB03070
HTE1   EQU     0             -                                          IBB03080
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB03090
HTEA1  BOOL    1777                                                     IBB03100
       SPACE   1                                                        IBB03110
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB03120
HTE2   EQU     0                                                        IBB03130
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB03140
HTEA2  BOOL    1777                                                     IBB03150
       SPACE   1                                                        IBB03160
*              1301 DISK AND 7320 NEED FILES                            IBB03170
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB03180
DFE1   EQU     0                                                        IBB03190
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB03200
DFE3   EQU     0                                                     $6$IBB03210
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB03220
NFE1   EQU     0                                                        IBB03230
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB03240
DFEA1  BOOL    1777                                                     IBB03250
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB03260
IFE1   EQU     0                                                        IBB03270
       SPACE   1                                                        IBB03280
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB03290
DFE2   EQU     0                                                        IBB03300
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB03310
DFE4   EQU     0                                                     $6$IBB03320
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB03330
NFE2   EQU     0                                                        IBB03340
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB03350
DFEA2  BOOL    1777                                                     IBB03360
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB03370
IFE2   EQU     0                                                        IBB03380
       EJECT                                                            IBB03390
*                             CHANNEL 'F'                               IBB03400
*              729 TAPE DRIVES                                          IBB03410
*                    NO. OF TAPES.....0 THROUGH 10                      IBB03420
CHF1   EQU     0                                                        IBB03430
       SPACE   1                                                        IBB03440
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB03450
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB03460
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB03470
CHFAT  BOOL    17777                                                    IBB03480
       SPACE   1                                                        IBB03490
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB03500
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB03510
CHFMD  BOOL    1777                                                     IBB03520
       SPACE   1                                                        IBB03530
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB03540
PRNTF  EQU     0                                                        IBB03550
       SPACE   1                                                        IBB03560
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB03570
PNCHF  EQU     0                                                        IBB03580
       SPACE   1                                                        IBB03590
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB03600
CDRDF  EQU     0                                                        IBB03610
       SPACE   1                                                        IBB03620
*              7340 TAPE DRIVES                                         IBB03630
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB03640
HTF1   EQU     0                                                        IBB03650
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB03660
HTFA1  BOOL    1777                                                     IBB03670
       SPACE   1                                                        IBB03680
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB03690
HTF2   EQU     0                                                        IBB03700
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB03710
HTFA2  BOOL    1777                                                     IBB03720
       SPACE   1                                                        IBB03730
*              1301 DISK AND 7320 NEED FILES                            IBB03740
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB03750
DFF1   EQU     0                                                        IBB03760
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB03770
DFF3   EQU     0                                                     $6$IBB03780
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB03790
NFF1   EQU     0                                                        IBB03800
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB03810
DFFA1  BOOL    1777                                                     IBB03820
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB03830
IFF1   EQU     0                                                        IBB03840
       SPACE   1                                                        IBB03850
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB03860
DFF2   EQU     0                                                        IBB03870
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB03880
DFF4   EQU     0                                                     $6$IBB03890
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB03900
NFF2   EQU     0                                                        IBB03910
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB03920
DFFA2  BOOL    1777                                                     IBB03930
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB03940
IFF2   EQU     0                                                        IBB03950
       EJECT                                                            IBB03960
*                             CHANNEL 'G'                               IBB03970
*              729 TAPE DRIVES                                          IBB03980
*                    NO. OF TAPES.....0 THROUGH 10                      IBB03990
CHG1   EQU     0                                                        IBB04000
       SPACE   1                                                        IBB04010
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB04020
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB04030
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB04040
CHGAT  BOOL    17777                                                    IBB04050
       SPACE   1                                                        IBB04060
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB04070
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB04080
CHGMD  BOOL    1777                                                     IBB04090
       SPACE   1                                                        IBB04100
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB04110
PRNTG  EQU     0                                                        IBB04120
       SPACE   1                                                        IBB04130
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB04140
PNCHG  EQU     0                                                        IBB04150
       SPACE   1                                                        IBB04160
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB04170
CDRDG  EQU     0                                                        IBB04180
       SPACE   1                                                        IBB04190
*              7340 TAPE DRIVES                                         IBB04200
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB04210
HTG1   EQU     0                                                        IBB04220
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB04230
HTGA1  BOOL    1777                                                     IBB04240
       SPACE   1                                                        IBB04250
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB04260
HTG2   EQU     0                                                        IBB04270
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB04280
HTGA2  BOOL    1777                                                     IBB04290
       SPACE   1                                                        IBB04300
*              1301 DISK AND 7320 NEED FILES                            IBB04310
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB04320
DFG1   EQU     0                                                        IBB04330
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB04340
DFG3   EQU     0                                                     $6$IBB04350
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB04360
NFG1   EQU     0                                                        IBB04370
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB04380
DFGA1  BOOL    1777                                                     IBB04390
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB04400
IFG1   EQU     0                                                        IBB04410
       SPACE   1                                                        IBB04420
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB04430
DFG2   EQU     0                                                        IBB04440
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB04450
DFG4   EQU     0                                                     $6$IBB04460
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB04470
NFG2   EQU     0                                                        IBB04480
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB04490
DFGA2  BOOL    1777                                                     IBB04500
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB04510
IFG2   EQU     0                                                        IBB04520
       EJECT                                                            IBB04530
*                             CHANNEL 'H'                               IBB04540
*              729 TAPE DRIVES                                          IBB04550
*                    NO. OF TAPES.....0 THROUGH 10                      IBB04560
CHH1   EQU     0                                                        IBB04570
       SPACE   1                                                        IBB04580
*      TAPES ATTACHED..... 1 BIT PER UNIT SIGNIFYING WHETHER UNIT       IBB04590
*    IS ATTACHED TO MACHINE (I.E.-LEGALLY DIALABLE) BITS GO LEFT TO     IBB04600
*       RIGHT (CR,PU,PR,TAPES 1 TO 10) AND = 1 IF NOT ATTACHED          IBB04610
CHHAT  BOOL    17777                                                    IBB04620
       SPACE   1                                                        IBB04630
*          MODEL TYPES OF UNITS ON CHANNEL.... 1 BIT PER UNIT           IBB04640
*   =1 IF MOD IV, =0 IF MOD II (BITS GO LEFT TO RIGHT (UNIT 1 TO 10)    IBB04650
CHHMD  BOOL    1777                                                     IBB04660
       SPACE   1                                                        IBB04670
*              PRINTER.....1 IF IT EXISTS. OTHERWISE, 0.                IBB04680
PRNTH  EQU     0                                                        IBB04690
       SPACE   1                                                        IBB04700
*               PUNCH.....1 IF IT EXISTS. OTHERWISE, 0.                 IBB04710
PNCHH  EQU     0                                                        IBB04720
       SPACE   1                                                        IBB04730
*            CARD READER.....1 IF IT EXISTS. OTHERWISE, 0.              IBB04740
CDRDH  EQU     0                                                        IBB04750
       SPACE   1                                                        IBB04760
*              7340 TAPE DRIVES                                         IBB04770
*          NUMBER OF TAPES ON INTERFACE 1.....0 THROUGH 10.             IBB04780
HTH1   EQU     0                                                        IBB04790
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB04800
HTHA1  BOOL    1777                                                     IBB04810
       SPACE   1                                                        IBB04820
*          NUMBER OF TAPES ON INTERFACE 2.....0 THROUGH 10.             IBB04830
HTH2   EQU     0                                                        IBB04840
*              TAPES ATTACHED.(SAME FUNCTION AS CHAAT)                  IBB04850
HTHA2  BOOL    1777                                                     IBB04860
       SPACE   1                                                        IBB04870
*              1301 DISK AND 7320 NEED FILES                            IBB04880
*          NUMBER OF DISK MODULES ON INTERFACE 1       (0 THRU 10)      IBB04890
DFH1   EQU     0                                                        IBB04900
*          NUMBER OF 1302 MODULES ON INTERFACE 1                     $6$IBB04910
DFH3   EQU     0                                                     $6$IBB04920
*          NUMBER OF NEED MODULES ON INTERFACE 1       (0 THRU 5)       IBB04930
NFH1   EQU     0                                                        IBB04940
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB04950
DFHA1  BOOL    1777                                                     IBB04960
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB04970
IFH1   EQU     0                                                        IBB04980
       SPACE                                                            IBB04990
*          NUMBER OF DISK MODULES ON INTERFACE 2       (0 THRU 10)      IBB05000
DFH2   EQU     0                                                        IBB05010
*          NUMBER OF 1302 MODULES ON INTERFACE 2                     $6$IBB05020
DFH4   EQU     0                                                     $6$IBB05030
*          NUMBER OF NEED MODULES ON INTERFACE 2       (0 THRU 5)       IBB05040
NFH2   EQU     0                                                        IBB05050
*          MODULES ATTACHED. (SIMILAR TO CHAAT - FIRST DISK THEN NEED)  IBB05060
DFHA2  BOOL    1777                                                     IBB05070
* MODEL OF 7631.=1 IF MODEL III OR IV, ELSE=0.                          IBB05080
IFH2   EQU     0                                                        IBB05090
       EJECT                                                            IBB05100
*                         CONTROL CARD FORMAT                           IBB05110
       SPACE   1                                                        IBB05120
*      COL           COL                                                IBB05130
*      1             16                                                 IBB05140
*      $AS           SYSUNI,HI     ASSIGN LAST ATTACH UNIT TO NAME      IBB05150
*      $ATTACH       UNI,II        ATTACH SPECIFIED UNIT                IBB05160
*      $CARDS                      NEXT IBSYS CONTROL CARD ON SYSCRD    IBB05170
*      $DATE         MMDDYY        ENTER DATE                           IBB05180
*      $DETACH       UNI           DETACH SPECIFIED UNIT                IBB05190
*      $ENDFILE      SYSUNI        WRITE EOF ON SPEC. SYSTEM UNIT       IBB05200
*      $EXECUTE      SYSTEM        LOAD AND EXECUTE SPECIFIED SYSTEM    IBB05210
*      $IBSYS                      RELOAD'IBSUP'                        IBB05220
*      $JOB                        FIRST CARD OF A NEW JOB              IBB05230
*      $IBEDT                      CALL SYSTEM EDITOR                   IBB05240
*      $ID                         CALL INSTALLATION ACCOUNTING ROUTINE IBB05250
*      $UNITS                      PRINT STATUS OF ATTACHED UNITS       IBB05260
*      $PAUSE                      PAUSE FOR OPERATOR                   IBB05270
*      $PROTECT      SYSUNI        FILE PROTECT UNIT (HYPER)            IBB05280
*      $RELEASE      SYSUNI        RELEASE UNIT FROM SPEC. SYSUNI       IBB05290
*      $REMOVE       SYSUNI        REW-UNLOAD SPEC. SYSTEM UNIT         IBB05300
*      $RESTORE                    RELOAD 'IBNUC' EXCEPT TAPE POSITIONS IBB05310
*      $REWIND       SYSUNI        REWIND SPECIFIED SYSTEM UNIT         IBB05320
*      $STOP                       STOP                                 IBB05330
*      $SWITCH       SYSUNI,SYSUNI SWITCH UNITS FOR SPEC. SYS. FUNCTIONSIBB05340
*      $TAPE                       NEXT IBSYS CONTROL CARD ON SYSIN1    IBB05350
*      $LIST                       LIST IBSYS CONTROL CARDS             IBB05360
*      $UNLIST                     SUPPRESS LISTING CONTROL CARDS       IBB05370
*      $UNLOAD       SYSUNI        UNLOAD UNIT (HYPER) WITHOUT REWIND   IBB05380
*      $RESET                      REASSIGN RELEASED SYSUNI FUNCTIONS   IBB05390
*      $RESTART      N             RESTART A JOB ON A SYSIN1 STACK      IBB05400
*      $*..COMMENT......           COMMENT CARD (NO ACTION)             IBB05410
*   WHERE...                                                            IBB05420
*      SYSUNI = ANY NAME FROM THE SET                                   IBB05430
*      ''SYSLB1,SYSLB2,SYSLB3,SYSLB4,SYSCRD,SYSPRT,SYSPCH,SYSIN1,SYSIN2,IBB05440
*        SYSOU1,SYSOU2,SYSPP1,SYSPP2,SYSUT1,SYSUT2,SYSUT3,SYSUT4,SYSCK1,IBB05450
*        OR SYSCK2''                                                    IBB05460
*                                                                       IBB05470
*      UNI    =  SYMBOLIC UNIT REFERENCE OF THE SET                     IBB05480
*      '' A1,A2,...,A9,A0,RDA,PRA,PUA,B1,....,PUH''                     IBB05490
*      ''AD00/0,...,HD19/1,AN00/0,...,HN08/1,AH0/0,...,HH9/1''          IBB05500
*                                                                       IBB05510
*      MMDDYY   =  MONTH DAY YEAR                                       IBB05520
*                                                                       IBB05530
*      SYSTEM  = SYSTEM NAME                                            IBB05540
       EJECT                                                            IBB05550
*                       INTERMEDIATE DEFINITIONS FOR 7909 CHANNEL       IBB05560
       SPACE                                                            IBB05570
*                    NO. OF DISK ARMS + NEED DRUMS FOR EACH CHANNEL     IBB05580
DUCA   EQU     DFA1+DFA3*2+DFA2+DFA4*2+NFA1+NFA2                     $6$IBB05590
DUCB   EQU     DFB1+DFB3*2+DFB2+DFB4*2+NFB1+NFB2                     $6$IBB05600
DUCC   EQU     DFC1+DFC3*2+DFC2+DFC4*2+NFC1+NFC2                     $6$IBB05610
DUCD   EQU     DFD1+DFD3*2+DFD2+DFD4*2+NFD1+NFD2                     $6$IBB05620
DUCE   EQU     DFE1+DFE3*2+DFE2+DFE4*2+NFE1+NFE2                     $6$IBB05630
DUCF   EQU     DFF1+DFF3*2+DFF2+DFF4*2+NFF1+NFF2                     $6$IBB05640
DUCG   EQU     DFG1+DFG3*2+DFG2+DFG4*2+NFG1+NFG2                     $6$IBB05650
DUCH   EQU     DFH1+DFH3*2+DFH2+DFH4*2+NFH1+NFH2                     $6$IBB05660
       SPACE                                                            IBB05670
*                    NO. HYPERTAPE UNITS EACH CHANNEL                   IBB05680
 HTCA  EQU     HTA1+HTA2                                                IBB05690
 HTCB  EQU     HTB1+HTB2                                                IBB05700
 HTCC  EQU     HTC1+HTC2                                                IBB05710
 HTCD  EQU     HTD1+HTD2                                                IBB05720
 HTCE  EQU     HTE1+HTE2                                                IBB05730
 HTCF  EQU     HTF1+HTF2                                                IBB05740
 HTCG  EQU     HTG1+HTG2                                                IBB05750
 HTCH  EQU     HTH1+HTH2                                                IBB05760
       SPACE                                                            IBB05770
*                    NO. 7909 CHANNEL DEVICES EACH CHANNEL              IBB05780
 CHA2  EQU     DUCA+HTCA                                                IBB05790
 CHB2  EQU     DUCB+HTCB                                                IBB05800
 CHC2  EQU     DUCC+HTCC                                                IBB05810
 CHD2  EQU     DUCD+HTCD                                                IBB05820
 CHE2  EQU     DUCE+HTCE                                                IBB05830
 CHF2  EQU     DUCF+HTCF                                                IBB05840
 CHG2  EQU     DUCG+HTCG                                                IBB05850
 CHH2  EQU     DUCH+HTCH                                                IBB05860
       SPACE                                                            IBB05870
*                    EQUALS 1 IF CHANNEL IS 7909 - ELSE 0.              IBB05880
CHA3   EQU     CHA2/CHA2      A                                         IBB05890
CHB3   EQU     CHB2/CHB2      B                                         IBB05900
CHC3   EQU     CHC2/CHC2      C                                         IBB05910
CHD3   EQU     CHD2/CHD2      D                                         IBB05920
CHE3   EQU     CHE2/CHE2      E                                         IBB05930
CHF3   EQU     CHF2/CHF2      F                                         IBB05940
CHG3   EQU     CHG2/CHG2      G                                         IBB05950
CHH3   EQU     CHH2/CHH2      H                                         IBB05960
       EJECT                                                            IBB05970
*                    TOTAL DISK ARMS AND NEED DRUMS ALL CHANNELS        IBB05980
 TDUAC EQU     DUCA+DUCB+DUCC+DUCD+DUCE+DUCF+DUCG+DUCH                  IBB05990
*                    EQUALS 1 IF DISK OR NEED EXISTS -ELSE 0.           IBB06000
 DUEX  EQU     TDUAC/TDUAC                                              IBB06010
       SPACE                                                            IBB06020
*                    TOTAL HYPERTAPE UNITS ALL CHANNELS                 IBB06030
 THTAC EQU     HTCA+HTCB+HTCC+HTCD+HTCE+HTCF+HTCG+HTCH                  IBB06040
*                    EQUALS 1 IF HYPERTAPE EXISTS - ELSE 0.             IBB06050
 HTEX  EQU     THTAC/THTAC                                              IBB06060
       SPACE                                                            IBB06070
*                    NO. OF 7909 CHANNELS THAT EXIST                    IBB06080
 T7909 EQU     CHA3+CHB3+CHC3+CHD3+CHE3+CHF3+CHG3+CHH3                  IBB06090
*                    EQUALS 1 IF 7909 CHANNEL EXISTS - ELSE 0.          IBB06100
 CHEX  EQU     T7909/T7909                                              IBB06110
       SPACE                                                            IBB06120
*                    NO. OF SECOND DISK ARMS - EACH INTERFACE, EACH CH. IBB06130
DDA1   EQU     DFA3                                                  $6$IBB06140
DDA2   EQU     DFA4                                                  $6$IBB06150
DDB1   EQU     DFB3                                                  $6$IBB06160
DDB2   EQU     DFB4                                                  $6$IBB06170
DDC1   EQU     DFC3                                                  $6$IBB06180
DDC2   EQU     DFC4                                                  $6$IBB06190
DDD1   EQU     DFD3                                                  $6$IBB06200
DDD2   EQU     DFD4                                                  $6$IBB06210
DDE1   EQU     DFE3                                                  $6$IBB06220
DDE2   EQU     DFE4                                                  $6$IBB06230
DDF1   EQU     DFF3                                                  $6$IBB06240
DDF2   EQU     DFF4                                                  $6$IBB06250
DDG1   EQU     DFG3                                                  $6$IBB06260
DDG2   EQU     DFG4                                                  $6$IBB06270
DDH1   EQU     DFH3                                                  $6$IBB06280
DDH2   EQU     DFH4                                                  $6$IBB06290
       EJECT                                                            IBB06300
*                       INTERMEDIATE DEFFINITIONS FOR 7607 CHANNEL      IBB06310
       SPACE                                                            IBB06320
*                     CONSTANTS FOR UCW GENERATION                      IBB06330
 UG1   EQU     32*CDRDA+16*PNCHA+8*PRNTA+4*CDRDB+2*PNCHB+PRNTB          IBB06340
 UG2   EQU     32*CDRDC+16*PNCHC+8*PRNTC+4*CDRDD+2*PNCHD+PRNTD          IBB06350
 UG3   EQU     32*CDRDE+16*PNCHE+8*PRNTE+4*CDRDF+2*PNCHF+PRNTF          IBB06360
 UG4   EQU     32*CDRDG+16*PNCHG+8*PRNTG+4*CDRDH+2*PNCHH+PRNTH          IBB06370
       SPACE                                                            IBB06380
*                       INTERMEDIATE DEFINITIONS                        IBB06390
       SPACE   1                                                        IBB06400
*                    NO. OF IO DEVICES EACH CHANNEL   CHX0=CHX(ZERO)    IBB06410
 CHA0  EQU     CDRDA+PNCHA+PRNTA+CHA1+CHA2                              IBB06420
 CHB0  EQU     CDRDB+PNCHB+PRNTB+CHB1+CHB2                              IBB06430
 CHC0  EQU     CDRDC+PNCHC+PRNTC+CHC1+CHC2                              IBB06440
 CHD0  EQU     CDRDD+PNCHD+PRNTD+CHD1+CHD2                              IBB06450
 CHE0  EQU     CDRDE+PNCHE+PRNTE+CHE1+CHE2                              IBB06460
 CHF0  EQU     CDRDF+PNCHF+PRNTF+CHF1+CHF2                              IBB06470
 CHG0  EQU     CDRDG+PNCHG+PRNTG+CHG1+CHG2                              IBB06480
 CHH0  EQU     CDRDH+PNCHH+PRNTH+CHH1+CHH2                              IBB06490
       SPACE                                                            IBB06500
*                  NO. OF IO DEVICES FOR ALL CHANNELS                   IBB06510
NOUCW  EQU     CHA0+CHB0+CHC0+CHD0+CHE0+CHF0+CHG0+CHH0                  IBB06520
       SPACE   1                                                        IBB06530
*                    EQUALS 1 IF CHANNEL EXISTS - ELSE 0.               IBB06540
CHA4   EQU     CHA0/CHA0      A                                         IBB06550
CHB4   EQU     CHB0/CHB0      B                                         IBB06560
CHC4   EQU     CHC0/CHC0      C                                         IBB06570
CHD4   EQU     CHD0/CHD0      D                                         IBB06580
CHE4   EQU     CHE0/CHE0      E                                         IBB06590
CHF4   EQU     CHF0/CHF0      F                                         IBB06600
CHG4   EQU     CHG0/CHG0      G                                         IBB06610
CHH4   EQU     CHH0/CHH0      H                                         IBB06620
       SPACE                                                            IBB06630
*                    NO. OF CHANNELS THAT EXIST                         IBB06640
CHH5   EQU     CHA4+CHB4+CHC4+CHD4+CHE4+CHF4+CHG4+CHH4                  IBB06650
       SPACE                                                            IBB06660
*                       PING/PONG DEFINITIONS                           IBB06670
PPC    EQU     PP/100              DEFINES PING/PONG CHANNEL            IBB06680
PPU    EQU     PP-PPC*100          DEFINES PING/PONG UNIT               IBB06690
PPE    EQU     PPC/PPC             DEFINES PING/PONG EXISTENCE          IBB06700
       REM                                                           $6$IBB06701
*      NO. CORRESPONDING TO HIGHEST EXISTING CHANNEL                 $6$IBB06702
       GETCHN  (A,B,C,D,E,F,G,H)                                     $6$IBB06703
HGHCHN SET     LSTCHN                                                $6$IBB06704
       TTL     STORE CHANNEL DIAGNOSTIC CATECHISM FOR IBMAP          $6$IBB06705
 SCDA  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/0644                    $6$IBB06706
 SCDB  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/4644                    $6$IBB06707
 SCDC  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/0645                    $6$IBB06708
 SCDD  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/4645                    $6$IBB06709
 SCDE  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/0646                    $6$IBB06710
 SCDF  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/4646                    $6$IBB06711
 SCDG  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/0647                    $6$IBB06712
 SCDH  OPVFD   O6/43,5/,1/,2/,2/1,2/3,6/,O12/4647                    $6$IBB06713
       TTL  SYSTEM LOADING TABLES AND TRANSFER INFORMATION              IBB06715
*                         BASIC MONITOR 'IBS'                           IBB06720
*   1. RECEIVES CONTROL AT 'COLD' IF COLD START                         IBB06730
*      -THEN MOVES IBSNUC (TABLES AND REST OF NUCLEUS WHICH STAYS IN)   IBB06740
*       TO ITS RESTING PLACE                                            IBB06750
*      -GENERATES THE UNIT CONTROL WORD TABLES,INCLUDING ALL            IBB06760
*       ATTACHMENT,MODEL TYPE BITS AND FORMS UNIT CHAINS                IBB06770
       SPACE   1                                                        IBB06780
*   2. RECEIVES CONTROL AT IBSYS IF LOADED BY IBSNUC OR AFTER           IBB06790
*      COLD START PROCEDURE                                             IBB06800
       SPACE   1                                                        IBB06810
SLTBLS EQU     410                                                      IBB06820
SLTABL EQU     SLTBLS*2                                                 IBB06830
CLDORG EQU     SYSORG+100+7+SLTABL                                      IBB06840
       REM                                                           $6$IBB06841
EMTM   OPVFD   O6/46,6/,2/3,2/1,2/2,3/1,O15/16  MAKE OK FOR M90      $6$IBB06842
TSX    OPVFD   O6/43,6/,2/,2/,2/1,O18/0074      SPECIFY DECREMENT OK $6$IBB06843
TCH    OPVFD   O6/42,6/1,2/,2/3,2/1,O18/1000    SPECIFY DECREMENT OK $6$IBB06844
EQU    OPSYN   SYN                                                   $6$IBB06845
       BES     SYSCUR-*                                              $6$IBB06850
       BCI     1,IBSYS             NAME CELL FOR MAINTAINANCE           IBB06860
       BES     SYSORG-*                                                 IBB06870
*      DUP     2,50                SYSTEM NAME AND LOCATION INDEX TABLE IBB06880    
*
* TAPE TABLE OF CONTENTS.
*      BCI     1,SYSNAM
*      PZE     FILE,SYSLBN,???
*
       BCI     1,IBJOB
       PZE     4,1,1                 000001100004
       BCI     1,IBSFAP
       PZE     1,1,5                 000005100001
       BCI     1,FORTRAN
       PZE     5,1,6                 000006100005
       BCI     1,IOCS
       PZE     3,1,11                000013100003
       BCI     1,IBLDRM
       PZE     3,2,0                 000000200003
       BCI     1,SORT
       PZE     2,2,3                 000003200002
       BCI     1,DK90UT
       PZE     1,2,5                 000005200001
       BCI     1,RESTART
       PZE     1,2,6                 000006200001
       BCI     1,UPDATE
       PZE     1,2,7                 000007200001
       BCI     1,EDITOR
       PZE     1,2,8                 000010200001
       DUP     2,40
       BCI     1,                                                       IBB06890
       PZE                                                              IBB06900
       DUP     1,7                                                      IBB06910
       PZE                                                              IBB06920
DSYSNM DUP     1,SLTABL                                                 IBB06930
       PZE                                                              IBB06940
       BES     3-*                                                      IBB06950
       TRA     COLD                TRA PT FOR COLD START                IBB06960
       BES     IBSORG-*                                                 IBB06970
       TRA     TPPS                TRA PT FOR RESTORE LOAD              IBB06980
       TTL     IBSUP COLD START INITIALIZATION                          IBB07370
*                         COLD START PROCEDURE                          IBB07380
       SPACE   1                                                        IBB07390
       BES     CLDORG-*                                                 IBB07400
COLD   STZ     0                   SET STOP IF REDUNDANCY ENCOUNTERED   IBB07410
       STZ     COLD                SET COLD START EXECUTED SWITCH       IBB07420
*      CHECK IF CHANNEL  FROM WHICH IBS WAS LOADED ENCOUNTERED       $6$IBB07430
*      TAPE CHECK.  SINCE END OF COLD START LOADING PROCEDURE WILL   $6$IBB07440
*      HAVE CAUSED A TRAP AND IOEX KNOWS NOT OF ANY I/O ACTION IT    $6$IBB07450
*      WILL RETURN TO CELL 3 AND OFF WE GO.  CELL 3 GETS CONTROL     $6$IBB07460
*      SINCE HPR IN CELL 2 EXECUTED IN LOAD SEQUENCE                 $6$IBB07470
       COMMDS  VAROP,(TRC,0)                                         $6$IBB07480
       SPACE                                                            IBB07520
*       COLD START LOADED W/O REDUNDANCY - MOVE IBSNUC TO IBSORG        IBB07530
       MOVLDR  SYSDAT,CALIB2,IBSNUC+1   MOVE IBNUC EXECEPT SYSTRA    $6$IBB07540
       MOVLDR  CALIB3,NUCEND,CALB3L                                  $6$IBB07550
       ENK                                                              IBB07580
       STQ     SYSKEY                                                $6$IBB07590
       LDI     SYSSWS                                                $6$IBB07600
       SWT     6                   PLACE CURRENT                        IBB07610
       RIR     40                  SETTING SENSE SWITCHES               IBB07620
       SWT     5                   INTO IBSSWS BITS                     IBB07630
       RIR     20                  30-35                                IBB07640
       SWT     4                                                        IBB07650
       RIR     10                                                       IBB07660
       SWT     3                                                        IBB07670
       RIR     4                                                        IBB07680
       SWT     2                                                        IBB07690
       RIR     2                                                        IBB07700
       SWT     1                                                        IBB07710
       RIR     1                                                        IBB07720
       STI     SYSSWS                                                $6$IBB07730
DRCOLD ZAC                                                              IBB07740
       STT     SYSLB4              RESET PING PONG FLAG              $6$IBB07750
       MOVLDR  SPOUT,SPTEND,SPTLD                                    $6$IBB07760
*      MOVE INTERCEPT DUMP ROUTINE                                   $6$IBB07800
       MOVLDR  CEMBGN,CEMBGN+50,GENITD                               $6$IBB07810
       CLA     SYSORG+101          IS SYSLB1 A 7909 DEVICE              IBB07840
       TZE     RCOLD               IF NO TRA TO RCOLD                   IBB07850
       STO     SYSLB1              IF YES - FIRST SET UP             $6$IBB07860
       CLA     SYSORG+100          SYSUNI ENTRY OF SYSLB1               IBB07870
       STO     SYSLB1+SUNLG                                          $6$IBB07880
RCOLD  NULL                                                          $6$IBB07890
 RCLD  AXC     4*NOUCW,4           CLEAR                                IBB07930
       LDQ     FOR                 UCW BLOCK TO                         IBB07940
       STZ     UEA11-1,4           WORD 4 PZE                           IBB07950
       STQ     UEA11-2,4           3 MZE                                IBB07960
       STZ     UEA11-3,4           2 PZE                                IBB07970
       STQ     UEA11-4,4           1 MZE                                IBB07980
       TXI     *+1,4,4             STEP TO NEXT UNIT                    IBB07990
       TXH     *-5,4,0             BACK FOR NEXT BLOCK                  IBB08000
       AXC     UEA11,4             L(1ST UCW)                           IBB08010
       SPACE                                                            IBB08020
*                    GENERATE CARD EQUIPMENT UNIT CONTROL BLOCKS        IBB08030
       SPACE                                                            IBB08040
IGCDE  AXT     3,2                                                      IBB08050
       LDQ     ROCTST                                                   IBB08060
CHN    AXC     1,1                                                      IBB08070
       LDI     AAMT-1,1                                                 IBB08080
       CAL     UFWCT               PLACE CARD ADDRESS IN AC (E.G. 1321) IBB08090
       TQP     SUNCDE              EXISTANT                             IBB08100
       RFT     10000               -YES ATTACHED                        IBB08110
       ORA     PTW                 -NO                                  IBB08120
       LFT     10000               MODEL                                IBB08130
       ORA     PON                 HI                                   IBB08140
       ORS     0,4                 STORE                                IBB08150
       TXI     *+1,4,-4            ADVANCE L(UCW)                       IBB08160
*                     STEP UNIT FOR CARD EQUIPMENT                      IBB08170
SUNCDE PDX     0,1                 ADVANCE                              IBB08180
       TXI     *+1,1,16            UNIT ADDRESS                         IBB08190
       PIA                         SHIFT                                IBB08200
       LGL     1                   CARD AND ATTACHMENT                  IBB08210
       PAI                         AND MODEL BITS                       IBB08220
       PXD     0,1                 NEXT UNIT ADDRESS                    IBB08230
       TIX     CHN+3,2,1           ALL CARD EQUIP                       IBB08240
       SPACE                                                            IBB08250
*                    GENERATE 729 TAPE UNIT CONTROL BLOCKS              IBB08260
       SPACE                                                            IBB08270
       STQ     ROCTST              SAVE CARD BITS                       IBB08280
       CAL     NTONCH              EXTRACT                              IBB08290
       LGR     32                  NUMBR OF TAPES                       IBB08300
       STQ     NTONCH              THIS CHANNEL                         IBB08310
       PAX     0,1                                                      IBB08320
       CLA     TWFCH               1ST TAPE ADDRESS                     IBB08330
       TXL     GNXD1,1,0      IF NONE-TO DISKS                          IBB08340
       TSX     GNXUN,2        GO GENERATE UNIT                          IBB08350
       TIX     *-1,1,1                                                  IBB08360
       SPACE                                                            IBB08370
*                    GENERATE DISK AND NEED INTERFACE 0 UCB'S           IBB08380
*              GENERATE DISK FILE UNIT CONTROL BLOCKS (ACCESS 0)        IBB08390
GNXD1  LAC     CHN,1                                                    IBB08400
       LDI     AADF1-1,1                                                IBB08410
       CAL     DFONC1                                                   IBB08420
       LGR     32                                                       IBB08430
       STQ     DFONC1                                                   IBB08440
       PAX     0,1                                                      IBB08450
       CLA     DFWC1                                                    IBB08460
       TXL     GNX02,1,0                                             $6$IBB08470
       TSX     GNSEK,2             GO GENERATE UCB AND UCB+2            IBB08480
       TIX     *-1,1,1                                               $6$IBB08482
       EJECT                                                         $6$IBB08484
*              GENERATE 1302 UNIT CONTROL BLOCKS (ACCESS 0)          $6$IBB08486
 GNX02 STI     AAD02               SAVE ATTACH BITS FOR ACC 1        $6$IBB08488
       PDX     ,2                                                    $6$IBB08490
       TXI     *+1,2,384                                             $6$IBB08492
       CAL     DFONC2                                                $6$IBB08493
       LGR     32                                                    $6$IBB08494
       PAX     ,1                                                    $6$IBB08495
       PXD     ,2                                                    $6$IBB08496
       TXL     GNXN1,1,0                                             $6$IBB08498
       STL     DSK02               SET SAVE SWITCH                   $6$IBB08500
       TSX     GNSEK,2                                               $6$IBB08502
       TIX     *-1,1,1                                               $6$IBB08504
       STZ     DSK02                                                 $6$IBB08506
       SPACE                                                         $6$IBB08508
*              GENERATE NEED FILE UNIT CONTROL BLOCKS                   IBB08510
 GNXN1 LAC     CHN,1                                                    IBB08520
       PDX     ,2                  PICK UP NEXT DISK ADDRESS.           IBB08530
       TIX     *+1,2,256                                             $6$IBB08540
       CAL     NDONC1                                                   IBB08550
       LGR     32                                                       IBB08560
       STQ     NDONC1                                                   IBB08570
       PAX     ,1                  SET XR1= NO. OF NEED DRUMS.          IBB08580
       PXD     ,2                                                       IBB08590
       TXL     GNXD2,1,0           MOVE ON IF THERE ARE NONE.           IBB08600
       TSX     GNEED,2                                                  IBB08610
       TIX     *-1,1,1                                                  IBB08620
       SPACE                                                            IBB08630
*              GENERATE 1302 UNIT CONTROL BLOCKS (ACCESS 1)          $6$IBB08640
GNXD2  LAC     CHN,1                                                    IBB08650
       LDI     AAD02               RETRIEVE ATTACH BITS              $6$IBB08660
       CAL     DFONC2                                                   IBB08670
       LGR     32                                                       IBB08680
       STQ     DFONC2                                                   IBB08690
       PAX     0,1                                                      IBB08700
       TXL     GNXD3,1,0                                                IBB08720
       CAL     TBL02,1                                               $6$IBB08722
       ORA     ACC02               CREATE ACCESS 1 BIT               $6$IBB08724
       TSX     GNSEK,2             GO GENERATE UCB AND UCB+2            IBB08730
       TIX     *-3,1,1                                               $6$IBB08740
       SPACE   2                                                        IBB08750
*                    GENERATE DISK AND NEED INTERFACE 1 UCB'S           IBB08760
       SPACE                                                            IBB08770
*              GENERATE DISK FILE UNIT CONTROL BLOCKS (ACCESS 0)        IBB08780
GNXD3  LAC     CHN,1                                                    IBB08790
       LDI     AADF2-1,1                                                IBB08800
       CAL     DFONC3                                                   IBB08810
       LGR     32                                                       IBB08820
       STQ     DFONC3                                                   IBB08830
       PAX     0,1                                                      IBB08840
       CLA     DFWC3                                                    IBB08850
       TXL     GNX12,1,0                                             $6$IBB08860
       TSX     GNSEK,2             GO GENERATE UCB AND UCB+2            IBB08870
       TIX     *-1,1,1                                               $6$IBB08872
       EJECT                                                         $6$IBB08874
*              GENERATE 1302 UNIT CONTROL BLOCKS (ACCESS 0)          $6$IBB08876
 GNX12 STI     AAD02               SAVE ATTACH BITS FOR ACC 1        $6$IBB08878
       PDX     ,2                                                    $6$IBB08880
       TXI     *+1,2,384                                             $6$IBB08882
       CAL     DFONC4                                                $6$IBB08883
       LGR     32                                                    $6$IBB08884
       PAX     ,1                                                    $6$IBB08885
       PXD     ,2                                                    $6$IBB08886
       TXL     GNXN2,1,0                                             $6$IBB08888
       STL     DSK02               SET SAVE SWITCH                   $6$IBB08890
       TSX     GNSEK,2                                               $6$IBB08892
       TIX     *-1,1,1                                               $6$IBB08894
       STZ     DSK02                                                 $6$IBB08896
       SPACE                                                         $6$IBB08898
*              GENERATE NEED FILE UNIT CONTROL BLOCKS                   IBB08900
 GNXN2 LAC     CHN,1                                                    IBB08910
       PDX     ,2                  PICK UP NEXT DISK ADDRESS.           IBB08920
       TIX     *+1,2,256                                             $6$IBB08930
       CAL     NDONC2                                                   IBB08940
       LGR     32                                                       IBB08950
       STQ     NDONC2                                                   IBB08960
       PAX     ,1                  SET XR1= NO. OF NEED DRUMS.          IBB08970
       PXD     ,2                                                       IBB08980
       TXL     GNXD4,1,0           MOVE ON IF THERE ARE NONE.           IBB08990
       TSX     GNEED,2                                                  IBB09000
       TIX     *-1,1,1                                                  IBB09010
       SPACE                                                            IBB09020
*              GENERATE 1302 UNIT CONTROL BLOCKS (ACCESS 1)          $6$IBB09030
GNXD4  LAC     CHN,1                                                    IBB09040
       LDI     AAD02               RETREIVE ATTACH BITS              $6$IBB09050
       CAL     DFONC4                                                   IBB09060
       LGR     32                                                       IBB09070
       STQ     DFONC4                                                   IBB09080
       PAX     0,1                                                      IBB09090
       TXL     GNXH1,1,0                                                IBB09110
       CAL     TBL02,1                                               $6$IBB09112
       ORA     ACC02                                                 $6$IBB09114
       TSX     GNSEK,2             GO GENERATE UCB AND UCB+2            IBB09120
       TIX     *-3,1,1                                               $6$IBB09130
       SPACE   2                                                        IBB09140
*                    GENERATE HYPERTAPE INTERFACE 0 UNIT CONTROL BLOCKS IBB09150
       SPACE                                                            IBB09160
 GNXH1 LAC     CHN,1                                                    IBB09170
       LDI     AAHT1-1,1                                                IBB09180
       CAL     HTONC1                                                   IBB09190
       LGR     32                                                       IBB09200
       STQ     HTONC1                                                   IBB09210
       PAX     ,1                                                       IBB09220
       CLA     HTWC1                                                    IBB09230
       TXL     GNXH2,1,0                                                IBB09240
 GNXHA STZ     2,4                                                      IBB09250
       TSX     GNXUN,2                                                  IBB09260
       TIX     GNXHA,1,1                                                IBB09270
       SPACE   2                                                        IBB09280
*                    GENERATE HYPERTAPE INTERFACE 1 UNIT CONTROL BLOCKS IBB09290
       SPACE                                                            IBB09300
GNXH2  LAC     CHN,1                                                    IBB09310
       LDI     AAHT2-1,1                                                IBB09320
       CAL     HTONC2                                                   IBB09330
       LGR     32                                                       IBB09340
       STQ     HTONC2                                                   IBB09350
       PAX     0,1                                                      IBB09360
       CLA     HTWC2                                                    IBB09370
       TXL     GNXCH,1,0                                                IBB09380
 GNXHB STZ     2,4                                                      IBB09390
       TSX     GNXUN,2                                                  IBB09400
       TIX     GNXHB,1,1                                                IBB09410
       SPACE   2                                                        IBB09420
*                       ADVANCE TO NEXT CHANNEL                         IBB09430
       SPACE                                                            IBB09440
GNXCH  LXD     UFWCT,1             ADVANCE                              IBB09450
       TXI     *+1,1,512           CHANNEL IN                           IBB09460
       SXD     UFWCT,1             CARD SELECT ADDR.                    IBB09470
       LXD     TWFCH,1             ADVANCE                              IBB09480
       TXI     *+1,1,512           CHANNEL IN TAPE SELECT               IBB09490
       SXD     TWFCH,1             ADDRESS                              IBB09500
       LXD     DFWC1,1                                                  IBB09510
       TXI     *+1,1,512                                                IBB09520
       SXD     DFWC1,1                                                  IBB09530
       LXD     DFWC2,1                                                  IBB09540
       TXI     *+1,1,512                                                IBB09550
       SXD     DFWC2,1                                                  IBB09560
       LXD     HTWC1,1                                                  IBB09570
       TXI     *+1,1,512                                                IBB09580
       SXD     HTWC1,1                                                  IBB09590
       LXD     DFWC3,1                                                  IBB09600
       TXI     *+1,1,512                                                IBB09610
       SXD     DFWC3,1                                                  IBB09620
       LXD     DFWC4,1                                                  IBB09630
       TXI     *+1,1,512                                                IBB09640
       SXD     DFWC4,1                                                  IBB09650
       LXD     HTWC2,1                                                  IBB09660
       TXI     *+1,1,512                                                IBB09670
       SXD     HTWC2,1                                                  IBB09680
       AXT     UCAA,1              ADVANCE                           $6$IBB09690
       TXI     *+1,1,1             STARTING                             IBB09700
       SXA     *-2,1               LOC AVAILABILITY                     IBB09710
       SXA     LUCAC,1             CHAIN                                IBB09720
       LXA     CHN,1               ADVANCE                              IBB09730
       TXI     *+1,1,1             CHANNEL                              IBB09740
       SXA     CHN,1                                                    IBB09750
       CAL     IBGBIT                                                   IBB09760
       SLW     GAPBIT              RESTORE THE GAP BIT                  IBB09770
       NZT     ACSAV                                                    IBB09780
       TRA     *+6                 RESET D(UCAA,1) TO ZERO IF           IBB09790
       CLA     IBLD1               NO 2ND DEVICE FOR THE                IBB09800
       TNZ     *+2                 7909 CHANNEL.                        IBB09810
       STD*    ACSAV                                                    IBB09820
       STZ     ACSAV                                                    IBB09830
       STZ     IBLD1                                                    IBB09840
       TXL     IGCDE,1,HGHCHN                                        $6$IBB09850
       CAL     PTW                 AVOID SETTING DENSITY                IBB09860
       STP     SELX-2              UNTIL UNITS ARE                      IBB09870
       STP     SELX-1              REFERENCED BY IBSYS                  IBB09880
       SPACE   1                                                        IBB09890
*              FORM UEXY REFERENCES IN SYSTEM UNITS TABLE               IBB09900
       CLA     SYSUNI              PICKUP                               IBB09910
       PAC     0,2                 LOC 1ST SYSTEM UNIT                  IBB09920
       PDX     0,1                 AND NO. OF SYSTEM UNITS              IBB09930
IUEF1  CLA     0,2                 AC= PRE CHAN,,UNIT                   IBB09940
       SXA     IUEF2,2             SAVE IR2                             IBB09950
       TSX     IBVAL,4             VALIDATE AND GENERATE L(UCW)         IBB09960
       LNT     600000                                                   IBB09970
       TRA     *+2                 IS UNIT ATTACHED                     IBB09980
       PXA     0,0                 -NO                                  IBB09990
IUEF2  AXT     **,2                RESTORE SYSUNI POINTER               IBB10000
       STA     0,2                 SET SYSUNI REF=                      IBB10010
       ANA     IBADDR              CLEAR DECREMENT                   $6$IBB10012
       ORA     HA2TBL-SYSLB1,2                                       $6$IBB10013
       LNT     020100              IS DISK ATTACHED                  $6$IBB10014
       CLA     0,2                                                   $6$IBB10015
       STD     0,2                 YES                               $6$IBB10016
       LNT     020100              IF DISK OR NEED DO NOT               IBB10020
       TSX     RSYUR,4             REMOVE UNIT FROM AVAILABLE           IBB10030
       LXA     IUEF2,2             RESTORE SYSUNI POINTER               IBB10040
       SXA     *+2,1                                                    IBB10050
       TSX     INITUS,1            INITIALIZE FOR USE                   IBB10060
       AXT     **,1                                                     IBB10070
       TXI     *+1,2,-1            TO NEXT UNIT                         IBB10080
       TIX     IUEF1,1,1           COUNT ALL                            IBB10090
       PXD     0,0                 RESTORE SET DENSITY                  IBB10100
       STP     SELX-2              INSTRUCTIONS                         IBB10110
       STP     SELX-1              IN IOEX                              IBB10120
       AXC     SYSOU1,2            SET DENSITY OF SYSOU              $6$IBB10121
       TSX     INITUS,1                                              $6$IBB10122
       AXT     SYSTT,1             MOVE SYSNAM TABLE                    IBB10130
       CAL     SYSORG+SYSTT,1      TO WORKING AREA                      IBB10140
       SLW     SYNEND,1            X                                    IBB10150
       TIX     *-2,1,1             X                                    IBB10160
       AXT     SYSTT,1             LENGTH OF SYSNAM TABLE TO            IBB10170
       CAL     SYNEND+1,1          IR1. MODIFY INDEX TO                 IBB10180
       ARS     15                  SYSLBX TO CONFORM WITH               IBB10190
       ANA     L(7)                NORMAL OPERATION.                    IBB10200
       STA     SYNEND+1,1          X                                    IBB10210
       STT     SYNEND+1,1          CLEAR TAG                            IBB10220
       TIX     *-5,1,2             BACK FOR NEXT ONE                    IBB10230
RCOLDX TRA     *+1                 SWITCH EXIT IF $RESTORE              IBB10240
       CAL     SYSLB1                                                $6$IBB10241
       SLW     CLDLB1                                                $6$IBB10242
       CAL     SYSLB1+SUNLG                                          $6$IBB10243
       SLW     CLDLB1+1                                              $6$IBB10244
       SPACE                                                            IBB10250
*         SIMULATE 'CARDS' OR 'TAPE' CONTROL VIA SSW 1 SETTING          IBB10260
 CLDX2 STZ     IBSINP              IF S.S.1 IS DOWN                  $6$IBB10270
       SWT     1                   SET INPUT SWITCH=0                   IBB10280
 CLDX1 STL     IBSINP              (CARDS CARD EQUIV.),              $6$IBB10290
       CLA     SYSCRD              IF UP INPUT SWITCH NOT =0         $6$IBB10300
       ZET     IBSINP              (TAPE CARD EQUIV)                 $6$IBB10310
       CLA     SYSIN1              L(UCW) IN AC                      $6$IBB10320
       STZ     IBSAV                                                 $6$IBB10330
       ZET     IBSINP              SET IBSAV TO SAVE ORIGINAL        $6$IBB10340
       STL     IBSAV               SS1 SETTING                       $6$IBB10350
       PAC     0,2                 TEST IF                              IBB10360
       TXL     IUEF3,2,0           UNIT ASSIGNED                        IBB10370
       CLA     2,2                 SET (+) TAPE POSITION                IBB10380
       SLW     2,2                 AS IT IS ABOUT TO BE USED            IBB10390
       TRA     TPSTR                                                    IBB10400
IUEF3  SWT     1                   NO- UNIT IS TAPE                     IBB10410
       TRA     IBNOIN              GO ASK OPERATOR                      IBB10420
       TSX     PROUT,4             CARD READER NOT KNOWN CAUSES         IBB10430
       PZE     2                   AUTOMATIC SWITCH TO SYSIN1.          IBB10440
       PZE     NORDA,,5                                                 IBB10450
       PZE     NORDB,,4                                                 IBB10460
       CLA     *+3                                                      IBB10470
       STO     IUEF3                                                    IBB10480
       TRA     CLDX1                                                    IBB10490
       TRA     *+1                                                      IBB10500
       TSX     PROUT,4             HERE IF NO SYSIN1 EITHER             IBB10510
       PZE     1                                                        IBB10520
       PZE     NOIN1,,4                                                 IBB10530
       TSX     IBPASP,4            PAUSE ON-LINE ONLY                   IBB10540
       TRA     CLDX2                                                    IBB10550
       SPACE                                                            IBB10560
 NORDA BCI     5,SYSCRD NO ASSIGNMENT MADE                              IBB10570
 NORDB BCI     4,S.S.1 SETTING IGNORED.                                 IBB10580
 NOIN1 BCI     4,NO SYSIN1 EITHER - HELP..........                      IBB10590
       EJECT                                                            IBB10600
*              NEED ENTRANCE TO GNSEK                                   IBB10610
 GNEED STD     0,4                                                      IBB10620
       ANA     1B17                                                     IBB10630
       TNZ     *+3                                                      IBB10640
       CLA     0,4                                                      IBB10650
       TRA     GNSEK+1             IF NEXT MODULE IS EVEN MOVE ON.      IBB10660
       CAL     GAPBIT              IF IT IS ODD - - -                   IBB10670
       ARS     1                                                        IBB10680
       SLW     GAPBIT              1. SET GAPBIT TO PUT SPACE IN IBSGAP IBB10690
       PIA                                                              IBB10700
       ALS     1                   2. POSITION THE ATTACH BIT        $6$IBB10710
       PAI                                                              IBB10720
       CLS     0,4                 3. BUMP MODULE ADDRESS UP ONE        IBB10730
       ADD     1B17                                                     IBB10740
       STL     NDGCT               4. SET SWITCH SO GAP IS COUNTED LATERIBB10750
       SPACE                                                            IBB10760
*              SUBROUTINE TO GENERATE UCB+2 FOR DISK                    IBB10770
 GNSEK STD     0,4                                                      IBB10780
       LDQ     L(0)                                                     IBB10790
       LGR     22                                                       IBB10800
       RQL     34                                                       IBB10810
       ANA     GNXS                                                     IBB10820
       LGR     12                  SET MQ BITS S,1-17 = 0AM  (BCD)      IBB10830
       XEC     .IBCDZ              CHANGE A OR M OF 00 TO 12)8.      $6$IBB10840
       CAL     GNXE                PLACE 8 (FOR SEEK ORDER) IN AC.      IBB10850
       LGL     30                  PLACE 80AM  (BCD)  IN AC AND         IBB10860
       ANA     IBMK1                                                    IBB10870
       SLW     2,4                 THEN SLW INTO UCB+2.                 IBB10880
       CLA     0,4                 SET UP AC FOR GNXUN AND FALL THRU    IBB10890
       SPACE                                                            IBB10900
*              SUBROUTINE TO GENERATE UNIT CONTROL WORD 1.              IBB10910
GNXUN  SXA     GNXUX,2        SAVE IR2                                  IBB10920
       RFT     10000                                                    IBB10930
       ORA     PTW                 NOT ATTACHED                         IBB10940
       LFT     10000                                                    IBB10950
       ORA     PON                 MODEL IV                             IBB10960
       ORS     0,4                 STORE                                IBB10970
 GNXE  PDX     8,2                 BUMP TAPE                            IBB10980
       TXI     *+1,2,1             ADDRESS                              IBB10990
       ANA     D8192               7909 CHANNEL DEVICE...               IBB11000
       TNZ     GNXH                TO GNXH IF YES                       IBB11010
       RFT     10000               IF ATTACHED                          IBB11020
       TRA     *+6                 ENTER IT IN                          IBB11030
 GNXS  PXA     1,4                 AVAIL CHAIN                          IBB11040
       COM                                                              IBB11050
       ACL     L(1)                                                     IBB11060
       STA*    LUCAC                                                    IBB11070
       STA     LUCAC                                                    IBB11080
       PIA                         SHIFT                                IBB11090
       ALS     1                   MODEL AND                            IBB11100
       PAI                         ATTACH BITS                          IBB11110
       PXD     0,2                 NEXT UNIT ADDRESS TO AC DECRE        IBB11120
       TXI     *+1,4,-4            TO NEXT UCW                          IBB11130
GNXUX  AXT     **,2           RESTORE IR2                               IBB11140
       TRA     1,2            RETURN                                    IBB11150
 GNXH  SXA     GNAX,1                                                $6$IBB11152
       CLA     0,4                                                   $6$IBB11154
       ZET     DSK02                                                 $6$IBB11156
       STD     TBL02,1             SAVE MODULE = FOR ACCESS 1        $6$IBB11158
       ANA     ACC02                                                 $6$IBB11160
       TNZ     GNAX                SKIP GAPBIT FOR ACCESS 1          $6$IBB11162
       LAC     CHN,1                                                    IBB11170
       CAL     GAPBIT                                                   IBB11180
       ZET     DSK02               IF 1302, SET GAPBIT TO ALLOW      $6$IBB11182
       ARS     10                  FOR ACCESS 1 ATTENTIONS           $6$IBB11184
       ORA     GAPBIT                                                $6$IBB11186
       ORS     IBSGAP-1,1                                            $6$IBB11190
       ANA     GAPBIT              CLEAR OUT 1302 ACC 1 BITS         $6$IBB11200
       ARS     1                                                        IBB11210
       SLW     GAPBIT                                                   IBB11220
 GNAX  AXT     **,1                                                  $6$IBB11222
       ZET     IBLD1                                                    IBB11230
       TRA     GNEXT                                                    IBB11240
       CAL     0,4                                                      IBB11250
       ZET     ACSAV               IN THE L.O. END OF THE DECR          IBB11260
       TRA     GNXEH               OF THE AVAILABILITY CHAIN HEADER     IBB11270
       LDQ     LUCAC               PUT 36 MINUS THE NUMBER OF UNITS     IBB11280
       STQ     ACSAV               FOR THE INTERFACE COMING FIRST.      IBB11290
       STD     ACSAV               NOTE, LATER ON IF THERE IS           IBB11300
       TRA     GNEXT               NO SECOND TYPE OF DEVICE FOR THE     IBB11310
 GNXEH ERA     ACSAV               CHANNEL, ZERO OUT THE DECR OF        IBB11320
       ANA     1B12                THE CHAIN HEADER.                    IBB11330
       TZE     *+3                                                      IBB11340
       STO     IBLD1                                                    IBB11350
       TRA     GNEXT                                                    IBB11360
       CLA*    ACSAV                                                    IBB11370
       SUB     1B17                                                     IBB11380
       ZET     NDGCT               WAS THERE A NEED GAP...              IBB11390
       SUB     1B17                THE GAP MUST BE COUNTED              IBB11400
       STO*    ACSAV                                                    IBB11410
 GNEXT STZ     NDGCT                                                    IBB11420
       TRA     GNXS-2                                                   IBB11430
       SPACE                                                            IBB11440
 LUCAC PZE     UCAA                LOC OF CHAN A AVAIL CHAIN HEADER  $6$IBB11450
 IBLD1 PZE                                                              IBB11460
 ACSAV PZE                                                              IBB11470
IBGBIT MZE     1                                                        IBB11480
GAPBIT MZE     1                                                        IBB11490
 NDGCT PZE                                                              IBB11500
ACKEP  PZE                                                           $6$IBB11501
XR1SAV PZE                                                           $6$IBB11502
 TBL02 BES     10                                                       IBB11503
 DSK02 PZE     0                                                     $6$IBB11504
 ACC02 PZE     ,,16                                                  $6$IBB11506
 AAD02 PZE     0                                                     $6$IBB11508
       TTL     IBSUP / CONTROL                                          IBB11510
*                IBS BASIC MONITOR SUPERVISORY CONTROL                  IBB11520
*    RECIEVES CONTROL WHEN EACH SYSTEM RELINQUISHES CONTROL TO IBS      IBB11530
*                AND AFTER COLD START SETUP IS COMPLETE                 IBB11540
*   READS CONTROL CARDS,EXECUTES THE SPECIFIED FUNCTION AND RELEASES    IBB11550
*        CONTROL TO ANOTHER SYSTEM UPON PRESENCE OF 'EXEC' CARD         IBB11560
       SPACE   1                                                        IBB11570
IBSYS  AXC     SYSCRD,2            PICK UP INPUT UNIT                $6$IBB11580
       ZET     IBSINP              FROM CARD-TAPE SWITCH             $6$IBB11590
       AXC     SYSIN1,2                                              $6$IBB11600
       CLA     0,2                                                      IBB11610
       PAC     0,4                                                      IBB11620
       TXL     IBNOIN,4,0                                               IBB11630
       TSX     INITUS,1                                                 IBB11640
       AXT     IBWAT,4             SET WAIT =                           IBB11650
       SXA     IBWAT,4             TRA *                                IBB11660
       CLA     0,2                 -L(UCW)                              IBB11670
       PAC     0,1                 TO IR1                               IBB11680
       ZET     1,1                 WAIT TILL                            IBB11690
       TRA     *-1                 DORMANT                              IBB11700
       LDI     0,1                 USE SELECT                           IBB11710
       LDQ     IBITP               DEPENDENT                            IBB11720
       LFT     000100              ON CARD READER                       IBB11730
       LDQ     IBICD               OR TAPE                              IBB11740
       LNT     020000                                                   IBB11750
       TRA     IBSY1                                                    IBB11760
       PIA                         HERE IF HYPERTAPE - SET UP THE       IBB11770
       ARS     23                 SELECT ROUTINE BEFORE ENTERING IT.    IBB11780
       ANA     L(1)                                                     IBB11790
       ORA     L(22)                                                    IBB11800
       STA     IBIHT+1             SMS (BCD MODE)                       IBB11810
       CAL     INMK2                                                    IBB11820
       ANS     IBHTU                                                    IBB11830
       PIA                                                              IBB11840
       ANA     L(15D)                                                   IBB11850
       ORS     IBHTU               UNIT SELECT                          IBB11860
       LDQ     IBIHT                                                    IBB11870
 IBSY1 STQ     1,1                                                      IBB11880
       TSX     ACTV,4              ENTER SELECT                         IBB11890
       MZE     0,2                 AND WAIT FOR                         IBB11900
IBWAT  TRA     *                   TRAP                                 IBB11910
IBICD  PZE     *+2,,IBON                                                IBB11920
IBITP  PTW     *+2,,IBOF                                                IBB11930
       IORT    IBMAG,,24           CARD INPUT                           IBB11940
       IORT    ICARD,,14           TAPE INPUT                        $6$IBB11950
 IBIHT PZE     *+1,,IBHTS          HYPERTAPE INPUT                      IBB11960
       SMS     **                                                       IBB11970
       CTLR    IBHTU                                                    IBB11980
       CPYD    ICARD,,14                                             $6$IBB11990
       TCH     SYSTWT                                                   IBB12000
 IBHTU OCT     120600120100                                             IBB12010
       EJECT                                                            IBB12020
*                       CARD READER SELECT ROUTINE                      IBB12030
       SPACE                                                            IBB12040
IBON   TPL     IBSPL               SEL (+) BRANCH CARDS                 IBB12050
       LNT     200000              IF EOF                               IBB12060
       TRA     IBONC               IN CARD                              IBB12070
       NZT     IBSAV               READER, PROCEED TO READ           $6$IBB12080
       TRA     IBONA               INPUT FROM SYSIN1 IF                 IBB12090
       STL     JBINT                                                    IBB12100
       STL     IBSINP              ORIGINAL IBSYS INPUT IS SYSIN1    $6$IBB12110
       AXT     IBSYS,2             AND SYSIN1 IS NOT ATTACHED AS        IBB12120
       LDI*    SYSIN1              THE CARD READER                   $6$IBB12130
       LNT     000300                                                   IBB12140
       TRA     IBOF1+1                                                  IBB12150
 IBONA SXA     IBONB,4             OTHERWISE PRINT                      IBB12160
       TSX     PROUT,4             MESSAGE AND                          IBB12170
       PZE     1                   PAUSE                                IBB12180
       PZE     *+4,,7                                                   IBB12190
       TSX     IBPASP,4            PAUSE ON-LINE ONLY                   IBB12200
 IBONB AXT     **,4                AND TRY AGAIN.                       IBB12210
       TRA     1,4                                                      IBB12220
       BCI     7, CONTROL CARDS NEEDED IN CARD READER                   IBB12230
IBONC  AXT     IBCDIN,2            SET HOLLERITH                        IBB12240
       TRA     IBOF1+1                                               $6$IBB12250
       SPACE   2                                                        IBB12260
*                       SYSIN1=729 TAPE SELECT ROUTINE                  IBB12270
       SPACE                                                            IBB12280
IBOF   TPL     IBSPL               SEL (+) BRANCH TAPE                  IBB12290
       LFT     200000              IF EOF                               IBB12300
       TRA     1,4                 IGNORE IT                            IBB12310
       LNT     400000              TEST FOR NOISE RECORD             $6$IBB12311
       TRA     2,4                                                   $6$IBB12312
 IBOF1 AXT     IBTPIN,2            SET DIRECT                           IBB12320
       SXA     IBWAT,2             EXIT (NO CONV. NECESSARY)            IBB12330
       PAC     0,2                 CLEAR UCW                            IBB12340
       STZ     1,2                 ACTIVITY                             IBB12350
       TRA     1,4                 BACK TO IOEX                         IBB12360
IBSPL  PAC     0,2                 -L(UCW)                              IBB12370
       CLA     1,2                 L(IORT) TO                           IBB12380
       STA     RCHX,1              RCHX COMMAND                         IBB12390
       CLA     0,2                 UNIT                                 IBB12400
       ARS     18                  ADDRESS                              IBB12410
       STA     *+1                 TO SELECT                            IBB12420
       RDS     **                  RDS                                  IBB12430
       XEC     RCHX,1              RCHX                                 IBB12440
       CLA     TMPGET                                                   IBB12450
       CAS     IBSXEC                                                   IBB12460
       TRA     *+2                                                      IBB12470
       STZ     RCTX,1                                                   IBB12480
       CAS     IBSNXT                                                   IBB12490
       TRA     1,4                 SUPPRESS REDUNDANCY RECOVERY IF      IBB12500
       STZ     RCTX,1              SKIP JOB IS IN EFFECT.               IBB12510
       TRA     1,4                 BACK TO IOEX                         IBB12520
       SPACE   2                                                        IBB12530
*                       SYSIN1=7340 HYPER SELECT ROUTINE                IBB12540
       SPACE                                                            IBB12550
 IBHTS TPL     IBHSP                                                    IBB12560
       LFT     007100              ANY ERROR...                         IBB12570
       TRA     *+2                                                      IBB12580
       TRA     IBOF1               TO IBOF IF NO                        IBB12590
       LFT     001000              HERE IF YES                          IBB12600
       RFT     000010              IGNORE ERROR IF I/O CK,              IBB12610
       TRA     1,4                 SEQ CK, INTF CK, OR EOF.             IBB12620
       TRA     IBOF1               ACCEPT IF ANYTHING ELSE.             IBB12630
 IBHSP PAC     0,2                 SELECT PLUS                          IBB12640
       CLA     1,2                                                      IBB12650
       STA     RCHX,1                                                   IBB12660
       XEC     RCHX,1              START THE CHANNEL                    IBB12670
       TRA     1,4                 AND RETURN TO IOEX.                  IBB12680
       SPACE   3                                                        IBB12690
*                      EXIT PROCEED WHEN CARD IN                        IBB12700
       SPACE                                                            IBB12710
IBCDIN TSX     RHBCD,4             HOLL TO BCD                          IBB12720
       TRA     IBRCIN                                                $6$IBB12721
IBTPIN LDQ     ICARD+13            BLANK OUT COLS 81-84              $6$IBB12722
       LGL     12                                                    $6$IBB12723
       LDQ     ALBLK                                                 $6$IBB12724
       LGR     12                                                    $6$IBB12725
       STQ     ICARD+13                                              $6$IBB12726
IBRCIN CLA     TMPGET                                                $6$IBB12730
       SUB     IBSNXT                                                   IBB12740
       TZE     IBT2                                                     IBB12750
       SUB     NXTXEC                                                   IBB12760
       TNZ     IBT1                                                     IBB12770
       CLA     ICARD               HERE IF SYSGET=IBSXEC.               IBB12780
       CAS     EXCRD                                                    IBB12790
       TRA     IBSYS                                                    IBB12800
       TRA     IBXCC                                                    IBB12810
       SUB     IBCRD                                                    IBB12820
       TZE     IBSCD                                                    IBB12830
 IBT2  CLA     ICARD               HERE IF SYSGET=IBSNXT.               IBB12840
       CAS     JBCRD               DO NOT WRITE OUT ANY CARDS           IBB12850
       TRA     IBSYS               WHILE HUNTING FOR NEXT               IBB12860
       TRA     IBJBA               $JOB OR $STOP CARD.                  IBB12870
       SUB     STCRD                                                    IBB12880
       TNZ     IBSYS                                                    IBB12890
       TRA     IBSTP                                                    IBB12900
 IBT1  CAL     ICARD                                                    IBB12910
       AXT     IBOPL,4             CONTROL OP                           IBB12920
       LAS     IBOPT+IBOPL,4       IN OP TABLE                          IBB12930
       TRA     *+2                 IF NOT FOUND                         IBB12940
       TRA     IBOPX+IBOPL,4       GO GET NEXT                          IBB12950
       TIX     *-3,4,1             CARD                                 IBB12960
       PAI                                                              IBB12970
       LNT     003124              HERE IF $*, $ID, OR AN               IBB12980
       TRA     IBT5                ILLEGAL CARD. CHECK                  IBB12990
       LFT     004653              FIRST FOR AN $ID CARD.               IBB13000
       TRA     IBT5                                                     IBB13010
       ZET     SYSACC              HERE IF IT IS AN $ID CARD.           IBB13020
       TRA     IBT4                PRINT IT OUT ONLY IF                 IBB13030
       TSX     PROPR,4             SYSACC=0                             IBB13040
       PZE     1                                                        IBB13050
       PZE     ICARD,,14           IN ANY CASE, GO TO                $6$IBB13060
 IBT4  TSX     SYSIDR,4            SYSIDR IF AN $ID CARD                IBB13070
       PZE     ICARD,,14           AND                               $6$IBB13080
       TRA     IBSYS               RETURN TO READ NEXT CARD.            IBB13090
 IBT5  TSX     PROPR,4             HERE IF $* COMMENT CARD OR           IBB13100
       PZE     1                   AN ILLEGAL CARD. ALWAYS              IBB13110
       PZE     ICARD,,14           PRINT IT ON LINE.                 $6$IBB13120
       LNT     005400              FOR *                                IBB13130
       TRA     *+4                 IN COL 2                             IBB13140
       LFT     002300                                                   IBB13150
       TRA     *+2                                                      IBB13160
       TRA     IBSYS                                                    IBB13170
       TSX     PROPR,4             HERE IF AN ILLEGAL CARD              IBB13180
       PZE     1                                                        IBB13190
       PZE     *+2,,6                                                   IBB13200
       TRA     IBT3                                                     IBB13210
       BCI     6, NOT A BASIC MONITOR CONTROL CARD                      IBB13220
       SPACE                                                            IBB13230
ICARD  BSS     14                  BCD CONTROL CARD                  $6$IBB13240
 IBMAG BSS     24                  ON-LINE HOLLERITH IMAGE              IBB13250
NXTXEC OCT     000000213540        IBSXEC-IBSNXT                        IBB13260
 CARD  EQU     ICARD                                                    IBB13270
       TTL     IBSUP / OPERATION TABLE                                  IBB13280
*                 OP TABLE BASIC MONITOR CONTROL CARDS                  IBB13290
IBOPT  BCI     1,$AS                                                    IBB13300
       BCI     1,$ATTAC                                                 IBB13310
       BCI     1,$CARDS                                                 IBB13320
       BCI     1,$DATE                                                  IBB13330
       BCI     1,$DETAC                                                 IBB13340
       BCI     1,$ENDFI                                                 IBB13350
 EXCRD BCI     1,$EXECUTE                                               IBB13360
 IBCRD BCI     1,$IBSYS                                                 IBB13370
 JBCRD BCI     1,$JOB                                                   IBB13380
       BCI     1,$UNITS                                                 IBB13390
       BCI     1,$PAUSE                                                 IBB13400
       BCI     1,$PROTE                                                 IBB13410
       BCI     1,$RELEA                                                 IBB13420
       BCI     1,$REMOV                                                 IBB13430
       BCI     1,$RESTO                                                 IBB13440
       BCI     1,$REWIN                                                 IBB13450
 STCRD BCI     1,$STOP                                                  IBB13460
       BCI     1,$SWITC                                                 IBB13470
       BCI     1,$TAPE                                                  IBB13480
       BCI     1,$LIST                                                  IBB13490
       BCI     1,$UNLIS                                                 IBB13500
       BCI     1,$UNLOA                                                 IBB13510
       BCI     1,$IBEDT                                                 IBB13520
       BCI     1,$RESET                                                 IBB13530
       BCI     1,$RESTA                                                 IBB13540
IBOPE  BSS     0                                                        IBB13550
       SPACE   1                                                        IBB13560
*                        TRA TABLE FOR OP CODES                         IBB13570
IBOPX  TRA     IBASC               $AS                                  IBB13580
       TRA     IBATC               $ATTACH                              IBB13590
       TRA     IBCCC               $CARDS                               IBB13600
       TRA     IBDAT               $DATE                                IBB13610
       TRA     IBDTC               $DETACH                              IBB13620
       TRA     IBWEF               $ENDFILE                             IBB13630
       TRA     IBXCC               $EXECUTE                             IBB13640
       TRA     IBSCD               $IBSYS                               IBB13650
       TRA     IBJBA               $JOB                                 IBB13660
       TRA     IBUNT               $UNITS                               IBB13670
       TRA     IBPAC               $PAUSE                               IBB13680
       TRA     IBPRO               $PROTECT                             IBB13690
       TRA     IBREL               $RELEASE                             IBB13700
       TRA     IBRUN               $REMOVE                              IBB13710
       TRA     IBRES               $RESTORE                             IBB13720
       TRA     IBREW               $REWIND                              IBB13730
       TRA     IBSTP               $STOP                                IBB13740
       TRA     IBSWC               $SWITCH                              IBB13750
       TRA     IBTCC               $TAPE                                IBB13760
       TRA     IBLIS               $LIST                                IBB13770
       TRA     IBUNL               $UNLIST                              IBB13780
       TRA     IBULD               $UNLOAD                              IBB13790
       TRA     IBEDT               $IBEDT                               IBB13800
       TRA     RESET               $RESET                               IBB13810
       TRA     RSTRT               $RESTART                             IBB13820
       TTL     IBSUP / ATTACH PROCESSOR                                 IBB13830
*                            $ATTACH   UNI                              IBB13840
       SPACE   1                                                        IBB13850
 IBATC TSX     PRCRD,4                                                  IBB13860
       PZE     1                                                        IBB13870
       PZE     ICARD,,14                                             $6$IBB13880
       TSX     SYUCU,4                                                  IBB13890
       TRA     IBAT1               ILLEGAL SYMBOLIC                     IBB13900
       TSX     IBVAL,4             FROM CHANNEL UNIT CODE               IBB13910
       STA     LATUN               TO L(UCW)                            IBB13920
       TZE     IBAT1               ILLEGAL UNIT                         IBB13930
       LFT     000100                                                   IBB13940
       TRA     IBATC2                                                   IBB13950
       SXD     IBATC1,2            CHECK FOR SYSUNI FUNCTION            IBB13960
       AXT     SUNLG,4             LOAD LENGTH OF SYSUNI TABLE          IBB13970
       CLA     SYSLB1+SUNLG,4      GET FIRST ENTRY                   $6$IBB13980
       PAX     0,1                                                      IBB13990
IBATC1 TXI     *+1,1,**                                                 IBB14000
       TXL     IBSYS,1,0           SYSUNI FOUND EXIT                    IBB14010
       TIX     *-4,4,1                                                  IBB14020
IBATC2 CAL     LATUN               PLACE                                IBB14030
       ARS     20                  MODEL TYPE                           IBB14040
       STT     *+1                 IN UCW                               IBB14050
       RIL     **                  IF II OR V WAS SPECIFIED.            IBB14060
       SIL     400000              SET UN-AVAILABLE                     IBB14070
       RIL     200000              SET ATTACHED                         IBB14080
       STI     0,2                 STORE CODES                          IBB14090
       LNT     020000                                                   IBB14100
       LNT     300                IF CARD EQUIPMENT                     IBB14110
       TRA     *+2                ENTER IT IN CHAIN                     IBB14120
       TRA     IBSYS               EXIT, ELSE                           IBB14130
       PIA                         PLACE                                IBB14140
       ARS     9                   UCW IN                               IBB14150
       ANA     L(15D)              CORRESPONDING                        IBB14160
       PDC     0,1                 CHANNEL AVAILABILITY                 IBB14170
       CLA     LATUN               JUST IN CASE ALREADY ATTACHED        IBB14180
       TSX     RSYUR,4             REMOVE BEFORE ENTERING               IBB14190
       CLA     UCAA-1,1            CHAIN                             $6$IBB14200
       STA     0,2                                                      IBB14210
       CLA     LATUN                                                    IBB14220
       STA     UCAA-1,1                                              $6$IBB14230
       TRA     IBSYS               BACK TO IBSYS                        IBB14240
       SPACE                                                            IBB14250
*                  LAST UNIT SPECIFIED ON ATTACH CARD                   IBB14260
 LATUN PZE     **                  PRE  L(UCB),,0   (PRE=- IF II SPEC.) IBB14270
       TTL     IBSUP / RELEASE, AS PROCESSOR                            IBB14280
*                            $RELEASE   SYSUNI                          IBB14290
       SPACE   1                                                        IBB14300
IBREL  STZ     LATUN                                                    IBB14310
       SPACE   1                                                        IBB14320
*                            $AS   SYSUNI                               IBB14330
       SPACE   1                                                        IBB14340
 IBASC TSX     PRCRD,4                                                  IBB14350
       PZE     1                                                        IBB14360
       PZE     ICARD,,14                                             $6$IBB14370
       CAL     ICARD+2             LOOKUP                               IBB14380
       LDQ     ICARD+3             NAME IN                              IBB14390
       LGL     18                  SYSTEM                               IBB14400
       AXT     SUNLG,2             NAME                                 IBB14410
       LAS     SYUNAM+SUNLG,2      TABLE                                IBB14420
       TRA     *+2                 NO                                   IBB14430
       TRA     *+3                 YES                                  IBB14440
       TIX     *-3,2,1             NO                                   IBB14450
       TRA     IBAS1               NOT FOUND                            IBB14460
       CLA     SYUEND,2            SAVE UNIT THAT                    $6$IBB14470
       STA     IBASX               WAS ASSIGNED FOR FURTHER TEST        IBB14480
       CLA     LATUN               PLACE UNIT                           IBB14490
       STA     SYUEND,2            SPECIFIED ON                      $6$IBB14500
       TZE     IBAS7                                                    IBB14510
       LDI*    SYUEND,2            LAST ATTACH IN SYSUNI TABLE.      $6$IBB14520
       LNT     020100              IF DISK OR NEED DO NOT REMOVE        IBB14530
       TSX     RSYUR,4             FROM AVAIL CHAIN. IF NOT DISK        IBB14540
       LDQ     ICARD+3             REMOVE FROM                          IBB14550
       RQL     24                  AVAIL UNIT CHAIN                     IBB14560
       PXA     0,0                 AND CHECK FOR                        IBB14570
       LGL     6                   DENSITY SPECIFICATION                IBB14580
       CAS     LOWL                IF NON SPECIFIED, SET DENSITY        IBB14590
       ACL     HILOW+HIGHLO        ACCORDING TO THE ASSEMBLY            IBB14600
       ACL     MZE                 PARAMETER HIGHLO.                    IBB14610
       ACL     MZE                                                      IBB14620
       STP     SYUEND,2            SET SYSTEM CELL (-) FOR HI-DEN    $6$IBB14630
IBAS7  TXI     *+1,2,-SYUEND       INITIALIZE USAGE                  $6$IBB14640
       TSX     INITUS,1            RECALL AT A LATER TIME               IBB14650
       TXI     *+1,2,SYUEND        RESTORE POINTER                   $6$IBB14660
       LDI*    SYUEND,2                                              $6$IBB14670
       ZET     LATUN               IF A RELEASE - TO IBAS3              IBB14680
       LNT     020000              IS A 7909 DEVICE BEING ASSIGNED...   IBB14690
       TRA     IBAS3               NO                                   IBB14700
       LFT     000700              IS IT HYPER...                       IBB14710
       TRA     IBAS6                                                    IBB14720
       CLA     SYUEND,2            IF YES-                           $6$IBB14730
       PAC     ,1                  MAKE SURE IT IS IN READY STATUS      IBB14740
       PIA                                                              IBB14750
       ARS     23                                                       IBB14760
       ANA     L(1)                                                     IBB14770
       IFT     CHEX=0                                                $6$IBB14771
       NOP                    (ORS   CHNS4 IF 7909 CH. EXISTS)       $6$IBB14772
       IFF     CHEX=0                                                $6$IBB14773
       ORA     CHNS4                                                    IBB14780
       STA     ASSMS                                                    IBB14790
       PIA                                                              IBB14800
       ANA     L(15D)                                                   IBB14810
       ORA     DPH1                                                     IBB14820
       STD     ASSEL                                                    IBB14830
       CAL     ASHSL                                                    IBB14840
       ZET     1,1                                                      IBB14850
       TRA     *-1                                                      IBB14860
       SLW     1,1                                                      IBB14870
       TSX     ACTIV,4                                                  IBB14880
       PZE     SYUEND,2                                              $6$IBB14890
       ZET     1,1                                                      IBB14900
       TRA     *-1                                                      IBB14910
       CAL     2,1                 ADJUST REC COUNT BECAUSE             IBB14920
       SUB     L(1)                NO RECORD WAS READ.                  IBB14930
       SLW     2,1                                                      IBB14940
       TRA     IBAS3                                                    IBB14950
 IBAS6 LDQ     ICARD+4             IF DISK OR NEED, SET PZE DORG,,DEND  IBB14960
       RQL     12                  LOAD H.O. END OF MQ WITH MMM         IBB14970
       AXT     6,4                                                      IBB14980
       AXT     6,1                                                      IBB14990
       STZ     IBDSK                                                    IBB15000
 IBAS4 PXD     ,0                  COMMENCE TO CONVERT                  IBB15010
       LGL     6                   MMM (THEN NNN) FROM                  IBB15020
       CAS     L(9)                BCD TO BINARY.                       IBB15030
       TRA     IBAS1               MAKE SURE NO CHARACTER               IBB15040
       NOP                         IS GREATER THAN 9                    IBB15050
       ADD     IBDSK                                                    IBB15060
       SLW     IBDSK                                                    IBB15070
       ALS     2                                                        IBB15080
       ADD     IBDSK                                                    IBB15090
       ALS     1                                                        IBB15100
       SLW     IBDSK                                                    IBB15110
       TIX     IBAS4,1,2                                                IBB15120
       ALS     2                   GET 40*MMM  (THEN 40*NNN)            IBB15130
       TNX     IBAS2,4,3                                                IBB15140
       STA     SYUEND+SUNLG,2      SET UP DORG IN SYSUNI+SUNLG       $6$IBB15150
       CLA     ICARD+3             NOW GET 40*NNN                       IBB15160
       LDQ     ICARD+4                                                  IBB15170
       LGR     12                                                       IBB15180
       TXI     IBAS4-1,1,4         RESTORE XR1 TO 6                     IBB15190
 IBAS2 ACL     SYUEND+SUNLG,2      NOW SET UP DEND IN SYSUNI+SUNLG   $6$IBB15200
       SUB     IBL(1)                                                $6$IBB15210
       PAX     ,4                                                       IBB15220
       LFT     000400                                                $6$IBB15222
       TRA     *+3                                                   $6$IBB15224
       LFT     000200              REDUCE DEND MODULO -                 IBB15230
       TIX     *,4,400             400   IF NEED OR                     IBB15240
       TIX     *,4,10000           10000 IF DISK.                       IBB15250
       PXD     ,4                                                       IBB15260
       STD     SYUEND+SUNLG,2      DEND=40*(MMM+NNN)-1               $6$IBB15270
       CAL     SYUEND,2                                              $6$IBB15280
       ANA     IBADR               NEXT - SET RA ADDRESS                IBB15290
       SLW     SYUEND,2            SPECIFIED ON THE $AS CARD         $6$IBB15300
       LDQ     ICARD+5             IN THE DECR OF THE SYSUNI FUNCTION.  IBB15310
       AXT     0,4                                                      IBB15320
 IBAS5 PXD     ,0                                                       IBB15330
       LGL     6                   CONVERT BLANKS AND 0 TO 12'S         IBB15340
       TZE     *+3                                                      IBB15350
       CAS     L(48)                                                    IBB15360
       TRA     *+2                                                      IBB15370
       CAL     L(10)                                                    IBB15380
       ALS     24,4                                                     IBB15390
       ORS     SYUEND,2                                              $6$IBB15400
       TXH     IBAS3,4,1                                                IBB15410
       TXI     IBAS5,4,6                                                IBB15420
 IBAS3 NZT     IBASX               IF LAST UNIT ASSIGNED                IBB15430
       TRA     STJBSW              WERE NON-ZERO                        IBB15440
       AXT     SUNLG,4             AND UNIT NO LONGER IN USE            IBB15450
       CLA     SYUEND,4            IN ANY OTHER SYSTEM ASSIGNMENT    $6$IBB15460
       ANA     IBADR               MASK OFF ADDRESS                     IBB15470
       LAS     IBASX               THEN ENTER IT INTO                   IBB15480
       TRA     *+2                 CORRECT CHANNEL CHAIN                IBB15490
       TRA     STJBSW              STILL IN USE                         IBB15500
       TIX     *-5,4,1             CONTINUE TESTS ON ALL SYS UNITS      IBB15510
       LAC     IBASX,2             SET IR2=-L(UCW)                      IBB15520
       LDI     0,2                 IF CARD EQUIP LEAVE OUT OF CHAIN     IBB15530
       LNT     020000                                                   IBB15540
       LNT     000300              OTHERWISE                            IBB15550
       TRA     *+2                 ENTER IT IN CHAIN                    IBB15560
       TRA     STJBSW              GO SET SYSJOB SWITCH MINUS           IBB15570
       RIL     200000              RESET NO REPOSITIONING FLAG          IBB15580
       SIL     400000              SET UNIT NOT ASSIGNED                IBB15590
       STI     0,2                 PUT UNIT                             IBB15600
       PIA                         INTO AVAILABLE                       IBB15610
       ARS     9                   CHANNEL CHAIN                        IBB15620
       ANA     L(15D)              -CHANNEL NUMBER TO AC                IBB15630
       PDC     0,1                 TO IR1                               IBB15640
       CLA     IBASX               L(UCW) TO AC                         IBB15650
       TSX     RSYUR,4             REMOVE BEFORE ENTRY TO PREVENT DUPS  IBB15660
       CLA     UCAA-1,1            ENTER UNIT INTO AVAILABILITY      $6$IBB15670
       STA     0,2                 CHAIN FOR CORRECT                    IBB15680
       CLA     IBASX               CHANNEL                              IBB15690
       STA     UCAA-1,1                                              $6$IBB15700
STJBSW CLA     SYSJOB              SET S(SYSJOB) = - TO INDICATE        IBB15710
       SSM                         NECESSITY OF SYSUNI AND              IBB15720
       STO     SYSJOB              SYSUAV RESTORATION ON THE            IBB15730
       TRA     IBSYS               NEXT $JOB CARD.                      IBB15740
       SPACE                                                            IBB15750
 ASHSL PZE     ASSMS,,*+1                                               IBB15760
       PAC     ,2                                                       IBB15770
       TPL     ASHT1+2                                                  IBB15780
       SXA     ASHX4,4                 SELECT MINUS                     IBB15790
       LDI     ASSNS                                                    IBB15800
       STZ     ASSNS                                                    IBB15810
       LNT     200000              CHECK FOR NOT READY                  IBB15820
       TRA     *+3                                                      IBB15830
       SIL     020000                                                   IBB15840
       TRA     ASHX4-1                                                  IBB15850
       LNT     000004              CHECK FOR NOT LOADED                 IBB15860
       TRA     ASHT1                                                    IBB15870
       RIL     070000                                                   IBB15880
       SIL     010000                                                   IBB15890
       IFF     HTEX=0                                                $6$IBB15895
       TSX     HOPRQ,4             GO PRINT ERROR MESSAGE               IBB15900
 ASHX4 AXT     **,4                                                     IBB15910
       TRA     1,4                                                      IBB15920
 ASHT1 STZ     1,2                                                      IBB15930
       TRA     1,4                                                      IBB15940
       CLA     ASHSL                                                    IBB15950
       STA     RCHX,1                                                   IBB15960
       XEC     RCHX,1                                                   IBB15970
       TRA     1,4                                                      IBB15980
 ASSMS SMS     **                                                       IBB15990
       CTL     ASSEL                                                    IBB16000
       SNS                                                              IBB16010
       CPYD    ASSNS,,1                                                 IBB16020
       TCH     SYSTWT                                                   IBB16030
 ASSEL OCT     120600120112                                             IBB16040
       SPACE                                                            IBB16050
       SPACE                                                            IBB16060
*                    CHECK CELL FOR HI DENSITY CALL                     IBB16070
 LOWL  BCI     1,00000L                                                 IBB16080
 HILOW BCI     2,000000-00000                                           IBB16090
*            LAST ASSIGNMENT OF NEWLY ASSIGNED SYSTEM UNIT              IBB16100
IBASX  PZE     **                                                       IBB16110
 IBDSK PZE                                                              IBB16120
 ASSNS PZE     **                                                       IBB16130
       TTL     IBSUP / DETACH PROCESSOR                                 IBB16140
*                            $DETACH   UNI                              IBB16150
       SPACE   1                                                        IBB16160
 IBDTC TSX     PRCRD,4                                                  IBB16170
       PZE     1                                                        IBB16180
       PZE     ICARD,,14                                             $6$IBB16190
       TSX     SYUCU,4             CONVERT SYMB TO CHAN UNIT            IBB16200
       TRA     IBAT1               ILLEGAL SYMBOLIC                     IBB16210
       TSX     IBVAL,4             CONVERT CHANNEL UNIT TO L(UCW)       IBB16220
       TZE     IBAT1               NO UCW                               IBB16230
       STA     IBDT1               SAVE AND COMPARE                     IBB16240
       SIL     600000              SET NOT AVAILABLE AND                IBB16250
       STI     0,2                 NOT ATTACHED                         IBB16260
       TSX     RSYUR,4             REMOVE FROM AVAILABILITY CHAIN       IBB16270
       AXC     SYSLB1,2                                              $6$IBB16280
IBDTG  CLA     0,2                 GET FIRST SYSUNI ENTRY               IBB16290
       ANA     IBADR               MASK OFF ADDRESS PORTION             IBB16300
       SUB     IBDT1                                                    IBB16310
       TNZ     IBDT4                                                    IBB16320
       STA     0,2                 SYSUNI FOUND CLEAR ADDRESS           IBB16330
       TSX     INITUS,1            CHECK FOR PP2 AND OU1                IBB16340
IBDT4  TXL     IBSYS,2,-SYSLB1-SUNLG+1                               $6$IBB16350
       TXI     IBDTG,2,-1                                               IBB16360
       SPACE                                                            IBB16370
 IBDT1 PZE     **                                                       IBB16380
       SPACE   10                                                       IBB16390
*                            $IBSYS                                     IBB16400
       SPACE                                                            IBB16410
 IBSCD TSX     PRCRD,4                                                  IBB16420
       PZE     1                   PRINT THE CARD AND                   IBB16430
       PZE     ICARD,,14           LOAD IN IBSUP.                    $6$IBB16440
       TRA     CALIB1                                                $6$IBB16450
       TTL     IBSUP / SWITCH PROCESSOR                                 IBB16460
*                            $SWITCH   SYSUNI,SYSUNI                    IBB16470
       SPACE   1                                                        IBB16480
 IBSWC TSX     PRCRD,4                                                  IBB16490
       PZE     1                                                        IBB16500
       PZE     ICARD,,14                                             $6$IBB16510
       CAL     ICARD+2             LOOKUP                               IBB16520
       LDQ     ICARD+3             1ST SYSUNI                           IBB16530
       LGR     18                  SPECIFIED                            IBB16540
       STZ     IBSWT                                                    IBB16550
       TSX     IBSWX,1                                                  IBB16560
       SXA     *+1,2                                                    IBB16570
       AXT     **,4                                                     IBB16580
       CAL     ICARD+3             LOOKUP                               IBB16590
       LDQ     ICARD+4             2ND SYSUNI                           IBB16600
       LGR     12                  SPECIFIED                            IBB16610
       TSX     IBSWX,1                                                  IBB16620
       ZET     IBSWT                                                    IBB16630
       TRA     IBSW2                                                    IBB16640
       LDQ     SYUEND+SUNLG,4      SWITCH                            $6$IBB16650
       CLA     SYUEND+SUNLG,2      SYSUNI+SUNLG ENTRIES              $6$IBB16660
       STQ     SYUEND+SUNLG,2      AND                               $6$IBB16670
       STO     SYUEND+SUNLG,4      THEN                              $6$IBB16680
 IBSW2 LDQ     SYUEND,4            SWITCH                            $6$IBB16690
       CLA     SYUEND,2            UCW                               $6$IBB16700
       STO     SYUEND,4                                              $6$IBB16710
       STQ     SYUEND,2                                              $6$IBB16720
       TRA     *+3                                                   $6$IBB16730
       STA     SYUEND,2                                              $6$IBB16740
       STD     SYUEND,2                                              $6$IBB16750
       SXD     *+3,4               INITIALIZE FOR USE                   IBB16760
       SXD     *+5,2               BOTH UNITS                           IBB16770
       AXC     SYUEND,2            COMPUTE INDEX TO                  $6$IBB16780
       TXI     *+1,2,**            SYSUNI UNIT 1.                       IBB16790
       TSX     INITUS,1            INITIALIZE                           IBB16800
       AXC     SYUEND,2            COMPUTE INDEX TO                  $6$IBB16810
       TXI     *+1,2,**            SYSUNI UNIT 2.                       IBB16820
       TSX     INITUS,1            INITIALIZE                           IBB16830
       TRA     STJBSW              SET SYSJOB = - AND GET NEXT CARD     IBB16840
 IBSWX AXT     SUNLG,2                                                  IBB16850
       XCA                                                              IBB16860
       CAS     SYUNAM+SUNLG,2                                           IBB16870
       TRA     *+2                                                      IBB16880
       TRA     *+3                                                      IBB16890
       TIX     *-3,2,1                                                  IBB16900
       TRA     IBAS1                                                    IBB16910
       CAS     SYUCRD                                                   IBB16920
       TRA     1,1                                                      IBB16930
       STL     IBSWT                                                    IBB16940
       CAS     SYUPCH                                                   IBB16950
       TRA     1,1                                                      IBB16960
       STL     IBSWT                                                    IBB16970
       SUB     SYUPRT                                                   IBB16980
       TZE     *-2                                                      IBB16990
       TRA     1,1                                                      IBB17000
 IBSWT PZE     **                                                       IBB17010
       TTL     IBSUP / EXECUTE PROCESSOR                                IBB17020
*                            $EXECUTE   SYSNAM                          IBB17030
       SPACE                                                            IBB17040
 IBXCC TSX     PRCRD,4                                                  IBB17050
       PZE     1                                                        IBB17060
       PZE     ICARD,,14                                             $6$IBB17070
 IBXED AXC     SYSLB1,2            IF COLD START WERE                $6$IBB17080
       NZT     COLD                EXECUTED THEN INITIALIZE             IBB17090
       TSX     INITUS,1            SYSLB1 USED IN COLD START PROC.      IBB17100
       TSX     IFIND,4             POSITION TO CORRECT SYSTEM           IBB17110
 IBXC1 CAL     0,2                 ENTRY FROM IBEDT                     IBB17120
       PAC     0,2                 -L(UCW) TO IR2                       IBB17130
       ALS     18                                                       IBB17140
       STD     SYSLDR                                                   IBB17150
       CAL     0,2                 UNIT TO AC                           IBB17160
       ARS     9                                                        IBB17170
       ANA     L(15D)              SET D(AC)=CHANNEL NUMBER             IBB17180
       STD     *+2                                                      IBB17190
       AXT     CHXSP-1,1                                                IBB17200
       TXI     *+1,1,**                                                 IBB17210
       SXA     CALIB3,1            INITIALIZE ENTRANCE TO SYSLBN LOAD$6$IBB17220
       PDC     ,1                  SET XR1=-(CHANNEL NO.-1)             IBB17230
       TXI     *+1,1,+1                                                 IBB17240
       IFF     DUEX=0                                                $6$IBB17245
       TQP     DDX1                TRA ONLY IF SYSLB1 AND LBN ARE DISK  IBB17250
       LDQ     TCOX,1                                                   IBB17260
       PXA     ,2                                                       IBB17270
       PAC     ,4                                                       IBB17280
       TXI     *+1,4,2             SET XR4=L(UCB+2)                     IBB17290
       IFT     CHEX=0                                                $6$IBB17291
       GOTO    IBCX2                                                 $6$IBB17292
       LFT     020000              (INDICATORS SET IN IFIND)            IBB17300
       TRA     9EX1                                                     IBB17310
IBCX2  TRA     TEX1                                                  $6$IBB17311
IBCX3  CAL     CALB3L+7                                              $6$IBB17312
       STA     CALIB4-1            ADJUST THE ENTRANCE               $6$IBB17313
       STA     CALIB4              ADDRESSES IN SYSLDR               $6$IBB17314
       TSX     SYSLDR,4                                              $6$IBB17315
       SPACE   2                                                        IBB17320
       REM     HERE IF SYSLBN IS 729 TAPE                            $6$IBB17328
TEX1   MOVLDR  CATLBN,ENTLBN,CTLBNL,XR1                              $6$IBB17329
       SLQ     LBNT4               HERE IF SYSLBN IS 729 TAPE           IBB17330
       LDQ     RCHX,1                                                   IBB17340
       SLQ     LBNT2                                                    IBB17350
       SLQ     LBNT7                                                    IBB17360
       LDQ     TRCX,1                                                   IBB17370
       SLQ     LBNT3                                                    IBB17380
       SLQ     LBNT5                                                    IBB17390
       TRA     IBCX3                                                 $6$IBB17400
       EJECT                                                            IBB17490
       IFT     CHEX=0                                                $6$IBB17491
       GOTO    IBPAC                                                 $6$IBB17492
 9EX1  CLA     0,2                 HERE IF 7909 CHANNEL                 IBB17500
       ARS     18                                                       IBB17510
       ANA     INMK1                                                    IBB17520
       ORA     RICA                SET AC=RICX INSTRUCTION              IBB17530
       IFT     DUEX=0                                                $6$IBB17531
       GOTO    HEX1                                                  $6$IBB17532
       IFT     HTEX=0                                                $6$IBB17533
       GOTO    DEX1                                                  $6$IBB17534
       LFT     000700                                                   IBB17540
       TRA     DEX1                                                  $6$IBB17541
       SPACE   2                                                        IBB17550
       REM                                                           $6$IBB17551
HEX1   MOVLDR  CAHLBN,ENHLBN,CHLBNL,XR1,AC  SYSLBN=7340 HYPER        $6$IBB17560
       SLQ     LBNH4                                                    IBB17570
       SLW     LBNH1                                                    IBB17580
       LDQ     RCHX,1                                                   IBB17590
       SLQ     LBNH2                                                    IBB17600
       SLQ     LBNH6                                                    IBB17610
       LDQ     SDCX,1                                                   IBB17620
       SLQ     LBNH3                                                    IBB17630
       CLA     0,2                                                      IBB17640
       ARS     23                                                       IBB17650
       ANA     IBL(1)                                                $6$IBB17660
       ORA     CHNS4                                                    IBB17670
       STA     LBNH7               SMS                                  IBB17680
       TRA     IBCX3               LOAD FIRST RECORD OF SUBSYSTEM    $6$IBB17690
       EJECT                                                            IBB17780
       IFT     DUEX=0                                                $6$IBB17781
       GOTO    IBPAC                                                 $6$IBB17782
       REM                                                           $6$IBB17788
DEX1   MOVLDR  CADLBN,ENDLBN,CDLBNL,XR1,AC    SYSLBN=DISK (OR DRUM)  $6$IBB17790
       SLQ     LBND4                                                 $6$IBB17791
       SLW     LBND1                                                    IBB17800
       LDQ     RCHX,1                                                   IBB17810
       SLQ     LBND2                                                    IBB17820
       LDQ     SDCX,1                                                   IBB17830
       SLQ     LBND3                                                    IBB17840
 DEX3  LDI     SYSPOS                                                   IBB17970
       STI     SYSTCH                                                   IBB17980
       TRA     IBCX3                                                 $6$IBB17990
       SPACE   2                                                        IBB18030
       REM     HERE IF BOTH SYSLB1 AND SYSLBN DISK                   $6$IBB18040
DDX1   MOVLDR  CADLBX,ENDLBX,CDLBXL,XR1                              $6$IBB18050
       LDQ     TCOX,1                                                $6$IBB18051
       SLQ     LBXDB                                                 $6$IBB18052
       CLA     0,2                                                      IBB18060
       ARS     18                                                       IBB18070
       ANA     INMK1                                                    IBB18080
       ORA     RICA                                                     IBB18090
       SLW     LBXD5                                                    IBB18100
       CAL     RCHX,1                                                   IBB18110
       ORA     IBIDA                                                    IBB18120
       STD     LBXD6                                                    IBB18130
       STP     LBXD6               RSCX*                                IBB18140
       LDQ     SDCX,1                                                   IBB18150
       SLQ     LBXD7                                                    IBB18160
       CAL*    SYSLB1              NOW FIX UP SYSLB1                 $6$IBB18170
       ARS     9                   PORTION OF LOADER                    IBB18180
       ANA     L(15D)                                                   IBB18190
       PDC     ,1                                                       IBB18200
       TXI     *+1,1,1                                                  IBB18210
       CAL*    SYSLB1                                                $6$IBB18220
       ARS     18                                                       IBB18230
       ANA     INMK1                                                    IBB18240
       ORA     RICA                                                     IBB18250
       SLW     LBXD1               RICX                                 IBB18260
       CAL     RCHX,1                                                   IBB18270
       ORA     IBIDA                                                    IBB18280
       STD     LBXD2                                                    IBB18290
       STP     LBXD2               RCHX*                                IBB18300
       LDQ     SDCX,1                                                   IBB18310
       SLQ     LBXD3                                                    IBB18320
       LDQ     TCOX,1                                                   IBB18330
       SLQ     LBXD4                                                    IBB18340
       CAL*    SYSLB1                                                $6$IBB18350
       ARS     23                                                       IBB18360
       ANA     IBL(1)                                                $6$IBB18370
       ORA     CHNS4                                                    IBB18380
       STA     LBXDC               SMS                                  IBB18390
       CAL     SYSORG+102    SET UP DSER AND DVCY FOR                   IBB18400
       TSX     BCVDEC-1,4    SPARE TRACKS OF IBSYS CYLINDER.            IBB18410
       LAC     SYSLB1,4                                              $6$IBB18420
       TSX     FDAMT,2                                                  IBB18430
       BCI     1,00BM00                                                 IBB18440
       PZE     LBXD8                                                    IBB18450
       SLW     LBXD9+1                                                  IBB18460
       LDI     LBXD8                                                    IBB18470
       IIL     001700                                                   IBB18480
       STI     LBXD9                                                    IBB18490
       CAL     SYSLB1+SUNLG        FINALLY SET UP DVCY FOR           $6$IBB18500
       TSX     BCVDEC,4            ORIGIN TTTT OF IBSYS                 IBB18510
       LAC     SYSLB1,4                                              $6$IBB18520
       TSX     FDAMT,2                                                  IBB18530
       BCI     1,00BM00                                                 IBB18540
       PZE     LBXDA                                                    IBB18550
       CAL     LDCRA               BEFORE GOING TO LOADER,              IBB18600
       STA     CALIB4-1            ADJUST THE ENTRANCW ADDRESSES     $6$IBB18610
       ADD     L(2)                IN SYSLDR.                           IBB18620
       STA     CALIB4                                                $6$IBB18630
       LDI     SYSPOS                                                   IBB18640
       STI     SYSTCH                                                   IBB18650
       TSX     SYSLDR,4                                                 IBB18660
       SPACE                                                            IBB18670
 LDCRA PZE     CADX1                                                 $6$IBB18740
       TTL     IBSUP / PROCESS MISCELLANY                               IBB18750
*                            $PAUSE                                     IBB18760
 IBPAC TSX     PROPR,4             ALWAYS PRINT $PAUSE ON-LINE          IBB18770
       PZE     1                                                        IBB18780
       PZE     ICARD,,14                                             $6$IBB18790
       TSX     IBPAS,4             PAUSE AND WAIT                       IBB18800
       TRA     IBSYS               FOR OPERATOR                         IBB18810
       SPACE   1                                                        IBB18820
*                            $DATE   MMDDYY                             IBB18830
IBDAT  CAL     ICARD+2                                                  IBB18840
       LDQ     ICARD+3                                                  IBB18850
       LGR     18                                                       IBB18860
       STQ     SYSDAT                                                $6$IBB18870
       TSX     PRCRD,4                                                  IBB18880
       PZE     1                                                        IBB18890
       PZE     ICARD,,14                                             $6$IBB18900
       TRA     IBSYS                                                    IBB18910
       SPACE                                                            IBB18920
*                            $CARDS                                     IBB18930
IBCCC  STZ     IBSINP                                                $6$IBB18940
       STZ     IBSAV                                                 $6$IBB18950
       TRA     IBUNL+1             ALWAYS PRINT $CARDS CARD             IBB18960
       SPACE   1                                                        IBB18970
*                            $TAPE                                      IBB18980
IBTCC  STL     IBSINP                                                $6$IBB18990
       STL     IBSAV                                                 $6$IBB19000
       TRA     IBUNL+1             ALWAYS PRINT $TAPE CARD              IBB19010
       SPACE   1                                                        IBB19020
*                            $LIST                                      IBB19030
 IBLIS STL     LSTSW                                                    IBB19040
       TRA     IBUNL+1             ALWAYS PRINT $LIST ON-LINE           IBB19050
       SPACE   1                                                        IBB19060
*                            $UNLIST                                    IBB19070
 IBUNL STZ     LSTSW                                                    IBB19080
       TSX     PROPR,4             ALWAYS PRINT $UNLIST ON-LINE         IBB19090
       PZE     1                                                        IBB19100
       PZE     ICARD,,14                                             $6$IBB19110
       TRA     IBSYS                                                    IBB19120
       SPACE                                                            IBB19130
*                            $REWIND   SYSUNI                           IBB19140
IBREW  AXT     3,1                 PLACE REW CODE                       IBB19150
       TRA     IBRUN+1             FOR ND SELECT                        IBB19160
REWOU1 PZE                         $REWIND SYSOU1 SWITCH                IBB19170
       SPACE   1                                                        IBB19180
*                            $ENDFILE   SYSUNI                          IBB19190
IBWEF  AXT     7,1                 WEF CODE                             IBB19200
       TRA     IBRUN+1             USE IBRVN ROUTINE                    IBB19210
       SPACE                                                            IBB19220
*                            $PROTECT   SYSUNI                          IBB19230
 IBPRO AXT     16,1                                                     IBB19240
       TRA     IBRUN+1                                                  IBB19250
       SPACE                                                            IBB19260
*                            $UNLOAD   SYSUNI                           IBB19270
 IBULD AXT     13,1                                                     IBB19280
       TRA     IBRUN+1                                                  IBB19290
       TTL     IBSUP / REMOVE PROCESSOR                                 IBB19300
*                            $REMOVE   SYSUNI                           IBB19310
IBRUN  AXT     4,1                 SET RUN CODE                         IBB19320
       TSX     PRCRD,4                                                  IBB19330
       PZE     1                                                        IBB19340
       PZE     ICARD,,14                                             $6$IBB19350
       CAL     ICARD+2             LOOKUP                               IBB19360
       LDQ     ICARD+3             SYSTEM UNIT                          IBB19370
       LGL     18                  NAME IN                              IBB19380
       TXL     *+3,1,4             TABLE.                               IBB19390
       TXH     IBRN5,1,15                                               IBB19400
       TXL     IBRN5,1,12                                               IBB19410
       LAS     SYUOU1              SET REWOU1 SWITCH IFF                IBB19420
       TRA     IBRN5               SYSOU1 IS BEING REWOUND.             IBB19430
       STL     REWOU1                                                   IBB19440
 IBRN5 AXT     0,2                                                      IBB19450
IBRN1  LAS     SYUNAM,2                                                 IBB19460
       TRA     *+2                 -NO                                  IBB19470
       TRA     IBRN2               -YES                                 IBB19480
       TXI     *+1,2,-1            -NO                                  IBB19490
       TXL     IBAS1,2,-SUNLG      TABEL EXHAUSTED                      IBB19500
       TRA     IBRN1               -NO                                  IBB19510
 IBRN2 CLA     SYSLB1,2                                              $6$IBB19520
       PAX     ,4                  IS UNIT ASSIGNED...                  IBB19530
       TXL     IBSYS,4,0           TO IBSYS IF NO.                      IBB19540
       LDI*    SYSLB1,2                                              $6$IBB19550
       LNT     020000                                                   IBB19560
       TRA     IBRN3               IF HYPERTAPE CHANGE                  IBB19570
       TNX     *+2,1,6             16 TO 42, 13 TO 39,                  IBB19580
       TXI     *+1,1,5             7 TO 33, 4 TO 31, AND 3 TO 33.       IBB19590
       TXI     IBRN4,1,27                                               IBB19600
 IBRN3 TXH     IBSYS,1,15          IF 729 TAPE IGNORE PROTECTAND        IBB19610
       TIX     *+1,1,9             CHANGE UNLOAD TO REMOVE.             IBB19620
 IBRN4 SXD     *+2,1                                                    IBB19630
       TSX     NDSEL+1,4                                                IBB19640
       PZE     SYSLB1,2,**                                           $6$IBB19650
       NOP                         NORMAL RETURN                        IBB19660
       LFT     020000                                                   IBB19670
       TRA     IBSYS               EXIT IF HYPERTAPE                    IBB19680
       CLA     SYSLB1,2            GET SYSUNI ENTRY                  $6$IBB19690
       PAC     0,1                 -L(UCW)TO IR1                        IBB19700
       CLA     2,1                 PICKUP POSITION                      IBB19710
       TMI     IBSYS               EXIT IF UNLOADED                     IBB19720
       TNZ     IBSYS               OR NOT AT LOAD POINT.                IBB19730
       CAL     SYSLB1,2            UNIT IS REWOUND                   $6$IBB19740
       ARS     17                  SET DENSITY                          IBB19750
       ADD     1B17                ACCORDING TO                         IBB19760
       STD     *+2                 SIGN OF SYSUNI ENTRY                 IBB19770
       TSX     NDSEL+1,4           X                                    IBB19780
       PZE     SYSLB1,2,**         X                                 $6$IBB19790
       TRA     IBSYS               TO NEXT CONTROL CARD                 IBB19800
       TTL     IBSUP / UNITS PROCESSOR                                  IBB19820
*                            $UNITS                                     IBB19830
       SPACE                                                            IBB19840
 IBUNT TSX     PRCRD,4                                                  IBB19850
       PZE     2                   PRINT THE $UNITS CARD                IBB19860
       PZE     ICARD,,14           AND THEN THE MAP                  $6$IBB19870
       PZE     HDMAP,,4            HEADING                              IBB19880
       AXT     SUNLG,2             CONVERT                              IBB19890
 IBMP7 CLA     SYUEND,2            UCWS TO UNIT                      $6$IBB19900
       PAC     0,1                 SAVE L(UCW)                          IBB19910
       TXH     IBMP6,1,0           SET NO UNIT CODE                     IBB19920
       CAL     IBLNK               IN MESSAGE                           IBB19930
       SLW     MPRAD               IF NO UNIT ASSIGNED.                 IBB19940
       SLW     MPUNI                                                    IBB19950
       SLW     MPUNI+2                                                  IBB19960
       SLW     MPUNI+3                                                  IBB19970
       CAL     INONE                                                    IBB19980
       TRA     RUBC3                                                    IBB19990
 IBMP6 LDI     0,1                                                      IBB20000
       LNT     020100              TEST FOR DISK OR NEED                IBB20010
       TRA     IBMP4               TO IBMP4 IF NO                       IBB20020
       CAL     SYUEND+SUNLG,2      HERE IF YES - -                   $6$IBB20030
       TSX     .DECVA,4            APPEND DORG AND DEND              $6$IBB20040
       CAL     IBLNK                                                    IBB20050
       RQL     12                                                       IBB20060
       LGR     12                                                       IBB20070
       STQ     MPUNI+2                                                  IBB20080
       CAL     SYUEND+SUNLG,2                                        $6$IBB20090
       TSX     .DECVD,4                                              $6$IBB20100
       XCA                                                              IBB20110
       LDQ     IBLNK                                                    IBB20120
       LGL     12                                                       IBB20130
       SLW     MPUNI+3                                                  IBB20140
       LDQ     CLPER                                                    IBB20150
       CAL     SYUEND,2            SET UP THE RECORD                 $6$IBB20160
       ARS     18                  ADDRESS FROM THE DECREMENT           IBB20170
       LGR     12                  OF THE SYSUNI TABLE.                 IBB20180
       CAL     OPPER                                                    IBB20190
       LGR     12                                                       IBB20200
       STQ     MPRAD                                                    IBB20210
       CAL     ITHRU                                                    IBB20220
       TRA     IBMP5                                                    IBB20230
 IBMP4 LDQ     IBLNK                                                    IBB20240
       STQ     MPUNI+2                                                  IBB20250
       STQ     MPUNI+3                                                  IBB20260
       STQ     MPRAD                                                    IBB20270
       LFT     020500              IF NOT 729 TAPE,                     IBB20280
       TRA     IBMP5-1             FORGET ABOUT DENSITY.                IBB20290
       XCA                         DENSITY BIT TO MQ                    IBB20300
       PXA     0,0                 CLEAR AC                             IBB20310
       LGL     3                   IF HIGH DENSITY APPEND UNIT          IBB20320
       TZE     *+3                 WITH WORDS ''HI DEN''                IBB20330
       CAL     HIDEN                                                    IBB20340
       TRA     *+2                                                      IBB20350
       CAL     IBLNK                                                    IBB20360
 IBMP5 SLW     MPUNI               STORE BLANK, HIDEN, OR THRU          IBB20370
       LDQ     0,1                                                      IBB20380
       TSX     SYUNCV,4            CONVERT UNIT TO SYMBOLIC             IBB20390
RUBC3  SLW     MPUNI+1                                                  IBB20400
       TSX     PRCRD,4             PRINT MAPPING MESSAGE                IBB20410
       PZE     7                                                        IBB20420
       MZE     IBLNK,,1                                                 IBB20430
       MZE     SYUNAM+SUNLG,2,1    NAME XXXXXX HI DEN                   IBB20440
       MZE     MPRAD,,1                                                 IBB20450
       MZE     MPUNI+1,,1          OR NAME NONE NONE                    IBB20460
       MZE     MPUNI+2,,1                                               IBB20470
       MZE     MPUNI,,1                                                 IBB20480
       PZE     MPUNI+3,,1                                               IBB20490
       TIX     IBMP7,2,1                                                IBB20500
       TSX     PRCRD,4             PRINT HEADING FOR                    IBB20510
       PZE     1                   ATTACHED UNITS                       IBB20520
       PZE     HDMP2,,7            NOT ASSIGNED OR RESERVED.            IBB20530
       AXT     4*NOUCW,2           NUMBER OF UNIT CONTROL WORDS.        IBB20540
       STZ     MAPSW               RESET MAP SWITCH.                    IBB20550
IBMP1  LDI     UEA11+4*NOUCW,2     PICKUP UNIT STATUS BITS.             IBB20560
       LFT     400000              PRINT ONLY IF NOT ASSIGNED A         IBB20570
       LFT     240000              SYSUNI FUNCTION (A=1), NOT           IBB20580
       TRA     IBMPT               RESERVED (R=0), AND ATTACHED (M=0).  IBB20590
       LDQ     UEA11+4*NOUCW,2     NO. PICKUP UNIT ADDRESS.             IBB20600
       TSX     SYUNCV,4            CONVERT TO SYMBOLIC.                 IBB20610
       SLW     MPUNI               PUT IT INTO LINE.                    IBB20620
       STL     MAPSW               FLAG IT AS PRINTED.                  IBB20630
       TSX     PRCRD,4             PRINT                                IBB20640
       PZE     2                   UNIT.                                IBB20650
       MZE     IBLNK,,1            X                                    IBB20660
       PZE     MPUNI,,1            X                                    IBB20670
IBMPT  TIX     IBMP1,2,4           BACK FOR NEXT UNIT.                  IBB20680
       ZET     MAPSW               ANY UNITS PRINTED.                   IBB20690
       TRA     IBMP2               YES.                                 IBB20700
       TSX     PRCRD,4             NO. PRINT                            IBB20710
       PZE     2                   NONE.                                IBB20720
       MZE     IBLNK,,1                                                 IBB20730
       PZE     INONE,,1                                                 IBB20740
IBMP2  STZ     MAPSW               RESET MAP SWITCH.                    IBB20750
       TSX     PRCRD,4             PRINT HEADING FOR                    IBB20760
       PZE     1                   INTRA SYSTEM RESERVE UNITS.          IBB20770
       PZE     HDMP3,,5            X                                    IBB20780
       AXT     4*NOUCW,2           NO. OF UNIT CONTROL WORDS.           IBB20790
IBMP3  LDI     UEA11+4*NOUCW,2     PICKUP UNIT STATUS BITS.             IBB20800
       LNT     40000               TEST FOR RESERVE STATUS.             IBB20810
       TRA     IBMTX               NO.                                  IBB20820
       LDQ     UEA11+4*NOUCW,2     YES. PICKUP UNIT ADDRESS.            IBB20830
       TSX     SYUNCV,4            CONVERT TO SYMBOLIC.                 IBB20840
       SLW     MPUNI               PUT IT INTO LINE.                    IBB20850
       STL     MAPSW               FLAG UNIT PRINTED.                   IBB20860
       TSX     PRCRD,4             PRINT SYMBOLIC UNIT ADDRESS          IBB20870
       PZE     2                   X                                    IBB20880
       MZE     IBLNK,,1            X                                    IBB20890
       PZE     MPUNI,,1            X                                    IBB20900
IBMTX  TIX     IBMP3,2,4           BACK FOR NEXT UNIT.                  IBB20910
       ZET     MAPSW               ANY UNITS PRINTED.                   IBB20920
       TRA     IBSYS                                                    IBB20930
       TSX     PRCRD,4             NO. PRINT                            IBB20940
       PZE     2                                                        IBB20950
       MZE     IBLNK,,1                                                 IBB20960
       PZE     INONE,,1            NONE.                                IBB20970
       TRA     IBSYS                                                    IBB20980
MAPSW  PZE     **                  MAP SWITCH.                          IBB20990
 MPRAD BCI     1,                                                       IBB21000
 OPPER BCI     1,     (                                                 IBB21010
 CLPER BCI     1,)                                                      IBB21020
HDMP2  BCI     7, ATTACHED UNITS NOT ASSIGNED OR RESERVED.              IBB21030
HDMP3  BCI     5, INTER SYSTEM RESERVE UNITS.                           IBB21040
IBLNK  BCI     1,                                                       IBB21050
INONE  BCI     1, NONE                                                  IBB21060
HIDEN  BCI     1,HI DEN                                                 IBB21070
MPUNI  BSS     4                                                        IBB21080
 HDMAP BCI     4,     FUNCTION      UNIT                                IBB21090
ITHRU  BCI     1, THRU                                                  IBB21100
       TTL     IBSUP / RESTORE PROCESSOR                                IBB21110
       SPACE   2                                                        IBB21120
*                            $RESTORE                                   IBB21130
       SPACE                                                            IBB21140
 IBRES TSX     PRCRD,4                                                  IBB21150
       PZE     1                                                        IBB21160
       PZE     ICARD,,14                                             $6$IBB21170
       CLA     CLDLB1              PICK UP ORIGINAL SYSLB1              IBB21180
       STO     SYSLB1                                                $6$IBB21190
       CLA     CLDLB1+1            ALSO ORIGINAL DISK LIMITS            IBB21210
       STO     SYSLB1+SUNLG        IN CASE SYSLB1 WAS DISK.          $6$IBB21220
       STZ     PNGSW               RESET ING-PONG FLAG                  IBB21230
       AXC     SYSLB1,2                                              $6$IBB21240
       TSX     INITUS,1            INITIALIZE LOADER FOR EVENTUAL       IBB21250
       LXA     SYSLB1,4            LOADING OF ORIGINAL IBSUP.        $6$IBB21260
       SXD     SYSLDR,4                                                 IBB21270
       AXT     IBRS1,4             SET THE LOADER RETURNS TO            IBB21280
       SXA     CALIBN-1,4          IBRS1 INSTEAD OF SYSTRA.             IBB21290
       TRA     CALIB1              GO LOAD IN ORIGINAL IBSUP         $6$IBB21300
       SPACE                                                            IBB21310
 IBRS1 LDQ     IBNOP               HERE AFTER IBSUP IS LOADEDE          IBB21320
       STQ     RCLD+3              NOP TO AVOID DESTROYING UCB+2        IBB21330
       STQ     GNXHA                                                    IBB21340
       STQ     GNXHB                                                    IBB21350
       CLA     SYSJOB              SAVE INPUT JOB COUNT                 IBB21360
       SLW     SYSJOB+.                                              $6$IBB21370
       ZET     IBSAV                                                 $6$IBB21380
       STL     IBSAV+.                                               $6$IBB21390
       CLA     IBSINP              SAVE CARDS OR TAPE                $6$IBB21400
       STO     IBSINP+.            MODE                              $6$IBB21410
       ENB     L(0)                                                     IBB21420
       AXT     2*HGHCHN,4                                            $6$IBB21430
       LDQ     CHXSP+2*HGHCHN,4                                      $6$IBB21440
       STQ     CHXSP+2*HGHCHN+.,4                                    $6$IBB21450
       TIX     *-2,4,1                                                  IBB21460
       REM     MOVE IBNUC (EXCEPT COLD START CELLS)                  $6$IBB21470
       MOVLDR  SYSPOS,CALIB2,IBSNUC+6   MOVE IBNUC EXECEPT SYSTRA    $6$IBB21480
       MOVLDR  CALIB3,NUCEND,CALB3L                                  $6$IBB21490
       REM                                                           $6$IBB21500
       STZ     COLD                SET COLD START INTITALIZATION SWITCH IBB21510
       AXT     IBSYS,4             SET IBSYS PROCESSING                 IBB21520
       SXA     RCOLDX,4            AFTER                                IBB21530
       TRA     DRCOLD              GO THRU COLD START                   IBB21540
       SPACE                                                            IBB21550
 IBNOP NOP                                                              IBB21560
       TTL     IBSUP / JOB PROCESSOR                                    IBB21570
*                            $JOB                                       IBB21580
       SPACE                                                            IBB21590
 IBJBA ZET     IBNCT               IBNCT NOT ZERO MEANS                 IBB21600
       TRA     RSSCAN              $RESTART IS IN PROGRESS.             IBB21610
       CLA     SYSGET+.                                              $6$IBB21620
       STO     TMPGET                                                   IBB21630
       NZT     IBSINP              BEFORE PROCESSING THE $JOB CARD   $6$IBB21640
       TRA     IBJ9                CHECK FOR A POSSIBLE OPERATOR        IBB21650
       LDI*    SYSIN1              INTERRUPT. (DO NOT CHECK IF THE   $6$IBB21660
       LNT     000100              JOB CARD WAS READ FROM THE CARD      IBB21670
       ZET     JBINT               READER OR IF JUST COMPLETING AN      IBB21680
       TRA     IBJ9                INTERRUPT IN WHICH CASE JBINT WILL   IBB21690
       SWT     1                   BE NON-ZERO).                        IBB21700
       TRA     IBJ9                NOTE)) JBINT SET NON-ZERO IN THE EOF IBB21710
       STZ     IBSINP              PORTION OF THE ROUTINE IBSYS      $6$IBB21720
       TRA     ENTTP               WHEN READING CRD READER AND NORMAL   IBB21730
 IBJ9  STZ     JBINT               IBSINP IS TAPE.                      IBB21740
       STZ     REWOU1              RESET NO OFF-LINE SWITCH             IBB21750
       ZET     SYSACC                                                   IBB21760
       TRA     *+5                 PRINT THE $JOB CARD ONLY IF          IBB21770
       TSX     PROPR,4             SYSACC=0                             IBB21780
       PZE     2                                                        IBB21790
       PZE     *,,0+512*EJECT                                           IBB21800
       PZE     ICARD,,14                                             $6$IBB21810
       CAL     SYSJOB                                                   IBB21820
       ANA     MN1617                                                $6$IBB21830
       NZT     IBSINP                                                $6$IBB21840
       TRA     IBJ1                SET S(SYSJOB)=+. ALSO,               IBB21850
       LDI     SYSIN1              IF INPUT IS NOT FROM              $6$IBB21860
       LNT     000100              CARD READER,INCREASE                 IBB21870
       ADD     L(1)                JOB COUNT BY ONE.                    IBB21880
 IBJ1  STO     SYSJOB                                                   IBB21890
       AXT     HGHCHN,1            NOW RESTORE AVAILABILITY          $6$IBB21900
       AXT     UCAA,2              CHAIN FOR EACH CHANNEL.           $6$IBB21910
 IBJ2  SXA     IBJCC,2                                                  IBB21920
       SXA     IBJIN,2             CHAIN EVERY UNIT ON A                IBB21930
       CLA     UCBA+HGHCHN,1       CHANNEL UNLESS IT IS              $6$IBB21940
       PDX     ,2                  DETACHED OR A CARD UNIT.             IBB21950
       PAX     ,4                                                       IBB21960
 IBJ3  SXA     IBJ4,4                                                   IBB21970
       LDI*    IBJ4                                                     IBB21980
       LNT     000300                                                   IBB21990
       TRA     *+3                                                      IBB22000
       LNT     020000                                                   IBB22010
       TRA     IBJ5                IF CARD EQUIP-TO IBJ5                IBB22020
       LNT     600000                                                   IBB22030
       TRA     *+2                                                      IBB22040
       TRA     IBJ5                TO IBJ5 ALSO IF UNIT DETACHED.       IBB22050
       SIL     400000              RE-INITIALIZE FLAG BITS              IBB22060
       RIL     240000              A=1                                  IBB22070
 IBJ4  STI     **                  M=0                                  IBB22080
       CLA     IBJ4                R=0                                  IBB22090
       STA*    IBJIN                                                    IBB22100
       STA     IBJIN                                                    IBB22110
 IBJ5  LXA     IBJ4,4                                                   IBB22120
       TNX     *+2,2,1             ALL UNITS ON CHANNEL DONE...         IBB22130
       TXI     IBJ3,4,4            TO IBJ3 IF NO.                       IBB22140
       PXD     ,0                  HERE IF YES-END CHAIN AND            IBB22150
       STA*    IBJIN               MOVE ON TO NEXT CHANNEL.             IBB22160
       LXA     IBJCC,2                                                  IBB22170
       TNX     *+2,1,1             ALL CHANNELS DONE...                 IBB22180
       TXI     IBJ2,2,1            TO IBJ2 IF NO.                       IBB22190
       AXT     -SYSLB1,2           HERE IF YES                       $6$IBB22200
       CAL     PTW                 AVOID SETTING DENSITIES              IBB22210
       STP     SELX-2              ON THE SYSUNI RESTORE.               IBB22220
       STP     SELX-1                                                   IBB22230
       CLA     CLDLB1              USE ORIGINAL SYSLB1 INSTEAD OF       IBB22240
       ZET     PNGSW               ASSEMBLED IF NOT IN PING PONG MODE.  IBB22250
       TRA     IBJ6                                                  $6$IBB22251
       LDI*    CLDLB1                                                $6$IBB22252
       TRA     IBJ7-5                                                $6$IBB22253
 IBJ6  CLA     .,2                                                      IBB22260
       TXH     *+2,2,-SYSOU1                                         $6$IBB22270
       TXH     IBJ7-3,2,-SYSPP2-1                                    $6$IBB22280
       SXA     *+2,2                                                    IBB22290
       TSX     IBVAL,4             ASSIGN TO THE NUCLEUS                IBB22300
       AXT     **,2                FUNCTION, THE ASSEMBLED              IBB22310
       TZE     IBJ7                FUNCTIONS UNIT IFF                   IBB22320
       LNT     600000              THAT UNIT IS NOT DETACHED.           IBB22330
       TRA     IBJ7                (INDICATORS=C(UCB) UPON IBVAL EXIT)  IBB22340
       CLA     0,2                                                      IBB22350
       STA     IBJCC                                                    IBB22360
       TRA     IBJ7A                                                    IBB22370
 IBJ7  STA     IBJCC                                                    IBB22380
       CAL     HA2TBL-SYSLB1,2                                       $6$IBB22381
       LNT     020100              IS DISK ASSIGNED                  $6$IBB22382
       CAL     .,2                                                      IBB22390
       ANA     IBDCR                                                    IBB22400
       ORA     IBJCC                                                    IBB22410
       IFT     CHEX=0                                                (9)IBB22419
       SLW     0,2                                                      IBB22420
       IFT     CHEX=1                                                (9)IBB22421
       TRA     RSTOR                                                 (9)IBB22422
 IBJ7A ZET     IBJCC                                                    IBB22430
       LNT     020100              IF NOT DISK, REMOVE THE              IBB22440
       TSX     RSYUR,4             UNIT FROM THE AVAIL CHAIN.           IBB22450
       TSX     INITUS,1                                                 IBB22460
IBJ8   TXL     *+2,2,-SYSLB1-SUNLG+1                                 $6$IBB22470
       TXI     IBJ6,2,-1                                                IBB22480
       PXD     ,0                  RESET THE DENSITY                    IBB22490
       STP     SELX-2              INSTRUCTIONS IN NDATA.               IBB22500
       STP     SELX-1                                                   IBB22510
       TSX     SYSIDR,4                                                 IBB22520
       PZE     ICARD                                                    IBB22530
       ZET     IBFLP                                                    IBB22540
       TSX     IBPNG,4                                                  IBB22550
       TRA     IBSYS               GO READ NEXT CARD                    IBB22560
       SPACE                                                            IBB22570
IBPNG  LDQ     SYSLB1                                                $6$IBB22580
       CAL     SYSLB4              SWITCH SYSLB1 WITH                $6$IBB22590
       STQ     SYSLB4              SYSLB4 FOR PING/PONG              $6$IBB22600
       SLW     SYSLB1              SYSTEM TAPES                      $6$IBB22610
       TRA     1,4                                                      IBB22620
       SPACE                                                            IBB22630
PNGSW  PZE                                                              IBB22640
IBFLP  PZE                                                              IBB22650
 IBJIN PZE     **                                                       IBB22660
 IBJCC PZE     **                                                       IBB22670
 JBINT PZE     **                                                       IBB22680
       TTL     IBSUP / STOP PROCESSOR                                   IBB22690
*                            $STOP                                      IBB22700
       SPACE                                                            IBB22710
 IBSTP ZET     IBNCT               IBNCT NOT ZERO MEANS                 IBB22720
       TRA     RSSTOP              $RESTART IN PROCESS.                 IBB22730
       STZ     SYSJOB              RE-INITIALIZE JOB COUNT              IBB22740
       CLA     SYSGET+.            REINIT TMPGET TO IBSYST           $6$IBB22750
       STO     TMPGET                                                   IBB22760
       TSX     PROPR,4             ALWAYS WRITE OUT THE                 IBB22770
       PZE     1                   $STOP CARD.                          IBB22780
       PZE     ICARD,,14                                             $6$IBB22790
 IBST1 LAC     SYSPP1,2            NEXT, WRITE TRAILER ON            $6$IBB22800
       STZ     FARPP               SYSPP1 (IF THERE IS A                IBB22810
       TXL     IBST2,2,0           FILE AND RECORD COUNT) AND           IBB22820
       CAL     2,2                 THEN BACKSPACE OVER IT.              IBB22830
       ANA     IBABP                                                    IBB22840
       STO     FARPP                                                    IBB22850
       TZE     IBST2                                                    IBB22860
       STZ     COMUNT              CLEAR COMBINED SWITCH             $6$IBB22861
       SXD     *+2,2                                                 $6$IBB22862
       LXA     SYSOU1,4                                              $6$IBB22863
       TXI     *+1,4,**                                              $6$IBB22864
       TXH     IBST2-2,4,0         GO AND WRITE TRAILER              $6$IBB22865
       STL     COMUNT                                                $6$IBB22866
       TRA     IBST2                                                 $6$IBB22867
       CLA     IBST1                                                    IBB22870
       TSX     WRTRL,4                                                  IBB22880
 IBST2 CLA     NOUNT               NEXT, WRITE OUT THE                  IBB22890
       LDQ     NOUNT+1             PERIPHERAL TAPE POSITIONS            IBB22900
       LDI     STZER               AT THE END OF JOBS.                  IBB22910
       AXT     18,1                                                     IBB22920
 IBST3 STO     STLR-1,1            (REINITIALIZE MESSAGES IN CASE       IBB22930
       STQ     STLR,1              OF A SECOND $STOP CARD               IBB22940
       STI     STLR+2,1            WITHOUT A RECALL OF IBSUP)           IBB22950
       STI     STLR+4,1                                                 IBB22960
       TIX     IBST3,1,7                                                IBB22970
       CLA     FARPP                                                    IBB22980
       AXT     18,1                                                     IBB22990
 IBST4 TXL     IBST5,2,0                                                IBB23000
       STO     STFRC               CONVERT                              IBB23010
       TSX     BCVDEC-1,4          FILE COUNT TO                        IBB23020
       STQ     STLR+4,1            BCD.                                 IBB23030
       CLA     STFRC               CONVERT                              IBB23040
       TSX     BCVDEC,4            RECORD COUNT TO                      IBB23050
       STQ     STLR+2,1            BCD.                                 IBB23060
       LDQ     0,2                 CONVERT                              IBB23070
       TSX     SYUNCV,4            UNIT TO                              IBB23080
       SLW     STLR,1              SYMBOLIC.                            IBB23090
       CLA     NEWLN                                                    IBB23100
       STO     STLR-1,1                                                 IBB23110
 IBST5 TXL     IBST6+1,1,12                                             IBB23120
       LAC     SYSOU1,2                                              $6$IBB23130
       STZ     FAROU                                                    IBB23140
       TXL     IBST6,2,0                                                IBB23150
       CAL     2,2                                                      IBB23160
       NZT     REWOU1              ADJUST REC COUNT FOR                 IBB23170
       TRA     *+1                                                   $6$IBB23180
       STO     FAROU                                                    IBB23190
 IBST6 TXI     IBST4,1,-7                                               IBB23200
       TXL     IBST7,1,5                                                IBB23210
       LAC     SYSIN1,2                                              $6$IBB23220
       CAL     2,2                                                      IBB23230
       TXI     IBST4,1,-7                                               IBB23240
 IBST7 TSX     PROPR,4                                                  IBB23250
       PZE     6                                                        IBB23260
       PZE     *,,0+512*DBLSP                                           IBB23270
       PZE     STHED,,7+512*DBLSP                                       IBB23280
       PZE     LINE1,,7                                                 IBB23290
       PZE     LINE2,,7                                                 IBB23300
       PZE     LINE3,,7+512*DBLSP                                       IBB23310
       PZE     STHED+5,,2+512*EJECT                                     IBB23320
       ZET     REWOU1              IF REWIND SYSOU1 SWITCH              IBB23330
       TRA     IBSTA               NOT ON, WRITE A                      IBB23340
       LAC     SYSOU1,2                                              $6$IBB23350
       CLA     *-1                 TRAILER ON SYSOU1                    IBB23360
       TXL     *+2,2,0                                                  IBB23370
       TSX     WRTRL,4                                                  IBB23380
 IBSTA NZT     FARPP               FINALLY, BACK SPACE OVER             IBB23390
       TRA     IBST8               THE TRAILERS.                        IBB23400
       ZET     COMUNT              IS THIS COMBINED UNIT             $6$IBB23401
       TRA     IBST8                                                 $6$IBB23402
       LAC     SYSPP1,2                                              $6$IBB23410
       LDI     0,2                                                      IBB23420
       AXT     6,4                                                      IBB23430
       LFT     020000                                                   IBB23440
       AXT     35,4                                                     IBB23450
       AXT     2,1                                                      IBB23460
       SXD     *+2,4                                                    IBB23470
       TSX     NDATA,4                                                  IBB23480
       PZE     SYSPP1,,**                                            $6$IBB23490
       TIX     *-2,1,1                                                  IBB23500
       CLA     FARPP                                                    IBB23510
       STO     2,2                                                      IBB23520
 IBST8 ZET     REWOU1                                                   IBB23530
       TRA     IBST9                                                    IBB23540
       LAC     SYSOU1,2                                              $6$IBB23550
       TXL     IBST9,2,0                                                IBB23560
       LDI     0,2                                                      IBB23570
       AXT     6,4                                                      IBB23580
       LFT     020000                                                   IBB23590
       AXT     35,4                                                     IBB23600
       AXT     2,1                                                      IBB23610
       SXD     *+2,4                                                    IBB23620
       TSX     NDATA,4                                                  IBB23630
       PZE     SYSOU1,,**                                            $6$IBB23640
       TIX     *-2,1,1                                                  IBB23650
       CLA     FAROU                                                    IBB23660
       STO     2,2                                                      IBB23670
 IBST9 STL     REWOU1              SUSPEND  IBSYS OFF-LINE UNTILL       IBB23680
       STZ     IBSINP              A NEW JOB CARD. IF START IS PRESSE$6$IBB23690
       HTR     IBSYS               SELECT CARD READER.                  IBB23700
       SPACE                                                            IBB23710
*                                  WRITE TRAILER ROUTINE                IBB23720
       SPACE                                                            IBB23730
 WRTRL SXA     ACCTL+1,4           ON ENTRY -                           IBB23740
       STA     NDCTL               XR2 = - L(UCB)                       IBB23750
       AXT     7,4                 A(AC) = L(SYSPP1) OR L(SYSOU1)       IBB23760
       LDI     0,2                                                      IBB23770
       LFT     020000              TRAILER CONSISTS OF -                IBB23780
       AXT     33,4                EOF                                  IBB23790
       SXD     NDCTL,4             END OF OUTPUT                        IBB23800
       TSX     NDATA,4             EOF                                  IBB23810
 NDCTL PZE     **,,**                                                   IBB23820
       NOP                                                              IBB23830
       CLA     NDCTL                                                    IBB23840
       STA     1,2                                                      IBB23850
       STA     ACCTL                                                    IBB23860
       CLA     WRSL7                                                    IBB23870
       LFT     020000                                                   IBB23880
       CLA     WRSLH                                                    IBB23890
       ORS     1,2                                                      IBB23900
       TSX     ACTIV,4                                                  IBB23910
 ACCTL PZE     **                                                       IBB23920
       AXT     **,4                                                     IBB23930
       TRA     1,4                                                      IBB23940
       SPACE                                                            IBB23950
*                                  729 TAPE SELECT                      IBB23960
       SPACE                                                            IBB23970
 STSL7 PAC     ,2                                                       IBB23980
       TMI     WRS7M                                                    IBB23990
       CLA     0,2                                                      IBB24000
       ARS     18                                                       IBB24010
       LDQ     RCHX,1                                                   IBB24020
       STA     *+1                                                      IBB24030
       WRS     **                                                       IBB24040
       SLQ     *+1                                                      IBB24050
       RCHA    WR729                                                    IBB24060
       TRA     1,4                                                      IBB24070
 WRS7M SXA     WRS7X,4                                                  IBB24080
       CLA     1,2                                                      IBB24090
       STA     *+2                                                      IBB24100
       TSX     NDATA,4             FINISH UP TRAILER WITH               IBB24110
       PZE     **,,7               AN END OF FILE.                      IBB24120
       NOP                                                              IBB24130
 WRS7X AXT     **,4                                                     IBB24140
       STZ     1,2                                                      IBB24150
       TRA     1,4                                                      IBB24160
       SPACE                                                            IBB24170
*                                  7340 HYPER SELECT                    IBB24180
       SPACE                                                            IBB24190
 STSLH PAC     ,2                                                       IBB24200
       TMI     WRSHM                                                    IBB24210
       CLA     0,2                                                      IBB24220
       ARS     23                                                       IBB24230
       ANA     L(1)                                                     IBB24240
       ORA     L(22)                                                    IBB24250
       STA     HYPCP               SET SMS (BCD MODE)                   IBB24260
       CLA     0,2                                                      IBB24270
       ANA     L(15D)                                                   IBB24280
       ORA     STHTU               SET HYPER UNIT SELECT                IBB24290
       SLW     STHUN                                                    IBB24300
       LDQ     RCHX,1                                                   IBB24310
       SLQ     *+1                                                      IBB24320
       RCHA    HYPCP                                                    IBB24330
       TRA     1,4                                                      IBB24340
 WRSHM CLA     1,2                                                      IBB24350
       SXA     WRSHX,4                                                  IBB24360
       STA     *+2                                                      IBB24370
       TSX     NDATA,4             FINISH UP WITH AN                    IBB24380
       PZE     **,,33              END OF FILE                          IBB24390
 WRSHX AXT     **,4                                                     IBB24400
       STZ     1,2                                                      IBB24410
       TRA     1,4                                                      IBB24420
       SPACE                                                            IBB24430
 STHUN OCT     120600120112                                             IBB24440
 HYPCP SMS     **                                                       IBB24450
       CTLW    STHUN                                                    IBB24460
       CPYD    TRAIL,,4                                                 IBB24470
       TCH     SYSTWT                                                   IBB24480
       SPACE                                                            IBB24490
       SPACE                                                            IBB24500
 STFRC PZE                                                              IBB24510
 FAROU PZE                                                              IBB24520
 FARPP PZE     **                                                       IBB24530
 WRSL7 MZE     ,,STSL7                                                  IBB24540
 WRSLH MZE     ,,STSLH                                                  IBB24550
 WR729 IORT    TRAIL,,4                                                 IBB24560
 STHTU OCT     120600120112                                             IBB24570
 STHED BCI     7, PERIPHERAL UNIT POSITIONS AT END OF JOBS              IBB24580
 LINE1 BCI     7, SYSPP1  IS UNIT    REC.     0, FILE     0             IBB24590
 LINE2 BCI     7, SYSOU1  IS UNIT    REC.     0, FILE     0             IBB24600
 LINE3 BCI     7, SYSIN1  IS UNIT    REC.     0, FILE     0             IBB24610
 NEWLN BCI     1,1  IS                                                  IBB24620
 NOUNT BCI     2,1  NO UNIT                                             IBB24630
 STZER BCI     1,     0                                                 IBB24640
 TRAIL BCI     4,1EOF  END OF OUTPUT                                    IBB24650
 STLR  EQU     LINE3+6                                                  IBB24660
       TTL     IBSUP / IBEDT PROCESSOR                                  IBB24670
*                            $IBEDT                                     IBB24680
       SPACE                                                            IBB24690
 IBEDT TSX     PRCRD,4                                                  IBB24700
       PZE     1                                                        IBB24710
       PZE     ICARD,,14                                             $6$IBB24720
       CAL     EDT7                                                     IBB24760
       LGR     18                  PLACE NAME (EDITOR) IN               IBB24770
       SLW     ICARD+2             ICARD+2 AND +3 AND THEN ESSENTIALLY  IBB24780
       STQ     ICARD+3             DO AN    $EXECUTE  EDITOR.           IBB24790
       TRA     IBXED                                                    IBB24800
 EDT7  BCI     1,EDITOR            EDITOR NAME IF SYSLB1 ON DISK.       IBB25370
       TTL     IBSUP / RESET PROCESSOR                                  IBB25380
*                            $RESET                                     IBB25390
       SPACE                                                            IBB25400
 RESET TSX     PRCRD,4                                                  IBB25410
       PZE     1                                                        IBB25420
       PZE     ICARD,,14                                             $6$IBB25430
       CAL     PTW                 AVOID DENSITY SETTINGS.              IBB25440
       STP     SELX-2                                                   IBB25450
       STP     SELX-1                                                   IBB25460
       AXT     SUNLG,4             TRY TO ASSIGN A UNIT TO              IBB25470
 RST1  CAL     SYSLB1+SUNLG,4      ANY RELEASED SYSUNI               $6$IBB25480
       PAX     ,2                  FUNCTION (WHICH HAD A UNIT AT        IBB25490
       TXH     RST6,2,0            COLD START) AS FOLLOWS - - - -       IBB25500
       CAL     SYSLB1+SUNLG+.,4                                      $6$IBB25510
       SXA     *+2,4               1. IF ASSEMBLED FUNCTIONS UNIT       IBB25520
       TSX     IBVAL,4                IS NOT DETACHED OR RESERVED       IBB25530
       AXT     **,4                   ASSIGN IT TO THE NUCLEUS FUNCTION.IBB25540
       TZE     RST6                                                     IBB25550
       LDI     0,2                 (XR2 SET ON IBVAL EXIT)              IBB25560
       LFT     240000              2. OTHERWISE - PICK UP A             IBB25570
       TRA     RST2                   UNIT (NOT DISK) FROM THE          IBB25580
       LFT     400000                 AVAILABILITY CHAIN. START         IBB25590
       TRA     RST4                   LOOKING FOR A FREE UNIT           IBB25600
RST2   AXT     HGHCHN,1              WITH THE CHANNEL A CHAIN        $6$IBB25610
       CAL     UCAA+HGHCHN,1                                         $6$IBB25620
       PAC     ,2                                                       IBB25630
       TXL     RST3,2,0                                                 IBB25640
       LDI     0,2                                                      IBB25650
       LNT     020100                                                   IBB25660
       TRA     RST4                                                     IBB25670
       CAL     0,2                                                      IBB25680
       TRA     RST2+2                                                   IBB25690
 RST3  TIX     RST2+1,1,1                                               IBB25700
       TRA     RST6                                                     IBB25710
 RST4  STA     RSTSV                                                    IBB25720
       CAL     SYSLB1+SUNLG+.,4                                      $6$IBB25730
       ANA     IBDCR                                                    IBB25740
       ORA     RSTSV                                                    IBB25750
       SLW     SYSLB1+SUNLG,4                                        $6$IBB25760
       SXA     RST5,4                                                   IBB25770
       TSX     RSYUR,4                                                  IBB25780
       LXA     RST5,2                                                   IBB25790
       TXI     *+1,2,-SYSLB1-SUNLG                                   $6$IBB25800
       TSX     INITUS,1                                                 IBB25810
 RST5  AXT     **,4                                                     IBB25820
 RST6  TIX     RST1,4,1                                                 IBB25830
       PXD     ,0                  RESET THE SET DENSITY                IBB25840
       STP     SELX-2              INSTRUCTIONS IN NDATA.               IBB25850
       STP     SELX-1                                                   IBB25860
       TRA     IBSYS                                                    IBB25870
       SPACE                                                            IBB25880
 RSTSV PZE     **                                                       IBB25890
       TTL     IBSUP / RESTART PROCESSOR                                IBB25900
*                            $RESTART                                   IBB25910
       SPACE                                                            IBB25920
RSTRT  LDI*    SYSIN1              MAKE SURE SYSIN1=TAPE             $6$IBB25930
       LNT     000100                                                   IBB25940
       ZET     IBSINP              AND THAT $RESTART=SYSCRD          $6$IBB25950
       TRA     IBSYS               TEST FAILS,RETURN                    IBB25960
       STL     IBSAV               SIMULATE PRECEDING $TAPE          $6$IBB25965
       TSX     PROPR,4                                                  IBB25970
       PZE     1                                                        IBB25980
       PZE     ICARD,,14                                             $6$IBB25990
       CLA     SYSJOB              SAVE MAGNITUDE OF SYSJOB             IBB26000
       STA     RSHJB               IN CASE OF FUTURE ERROR              IBB26010
       CAL     ICARD+2             NOW LOCATE OPERAND IN                IBB26020
       LDQ     ICARD+3             ACCUMULATOR,RIGHT-AJDUSTED           IBB26030
       STL     RSMTSW              AND INITIALIZE MATCH                 IBB26040
       STZ     RSFSTM              SWITCHES                             IBB26050
       STZ     RSMTER                                                   IBB26060
       STZ     RSERSW                                                   IBB26070
       LGL     18                                                       IBB26080
       LGR     6                                                        IBB26090
       LAS     RSMTCH              COMPARE WITH'OMATCH'                 IBB26100
       TRA     *+2                                                      IBB26110
       TRA     RSCONT              MATCH OPTION FOUND,EXIT              IBB26120
       LGR     24                  NON-MATCH,GET COL.16                 IBB26130
       STZ     RSQUAN              INITIALIZE QUANTITY AT               IBB26140
       STZ     RSMTSW              ZERO,RESET MATCH SWITCH              IBB26150
       STL     RSSIGN              AND INITIALIZE SIGN TO MINUS         IBB26160
       LAS     L(48)               NOW COMPARE COL.16 WITH BLANK        IBB26170
       TRA     IBRT1               INVALID CARD,EXIT                    IBB26180
       ZAC                         TREAT BLANK AND ZERO AS              IBB26190
       TZE     RSEOS               MZE,BYPASS CONVERSION                IBB26200
       LAS     L(32)               CHECK FOR COL 16=MINUS               IBB26210
       TRA     IBRT1               INVALID CARD                         IBB26220
       TRA     *+2                 MINUS FOUND,CLEAR A.C.               IBB26230
       STZ     RSSIGN              MUST BE PLUS,RESET SIGN              IBB26240
       ANA     L(15)               FORCE NUMERIC,AND SHIFT              IBB26250
       LGR     6                   INTO MQ FOR SCANNER                  IBB26260
       STZ     RSTOT               INITIALIZE TOTAL                     IBB26270
       AXT     6,1                                                      IBB26280
RSBOS  ZAC                         CONVERT QUANTITY TO BINARY           IBB26290
       LGL     6                   GET FIRST NUMBER                     IBB26300
       LAS     L(48)                                                    IBB26310
       TRA     IBRT1               INVALID CHARACTER,EXIT               IBB26320
       TRA     RSEOS               BLANK TERMINATES SCANNER             IBB26330
       LAS     L(9)                                                     IBB26340
       TRA     IBRT1               NON-NUMERIC,EXIT                     IBB26350
RSFUL  NOP     63                                                       IBB26360
       ADD     RSTOT               ADD DIGIT TO TOTAL,THEN              IBB26370
       SLW     RSQUAN              SAVE RESULT INQUANTITY               IBB26380
       TNX     RSEOS,1,1           EXIT WHEN FIELD TERMINATED           IBB26390
       XCL                                                              IBB26400
       SLW     RSIDCD              SAVE REMAINING DIGITS                IBB26410
       MPY     L(10)               THEN MULTIPLY TOTAL BY 10            IBB26420
       XCL                                                              IBB26430
       SLW     RSTOT                                                    IBB26440
       LDQ     RSIDCD              PICK UP REMAINING DIGITS             IBB26450
       TRA     RSBOS               AND GO ROUND AGAIN                   IBB26460
RSEOS  CLA     RSSIGN                                                   IBB26470
       ZET     RSQUAN              SKIP JOB REQUEST IF SIGN             IBB26480
       TZE     RSCONT              PLUS AND QUANTITY NON-ZERO           IBB26490
RSMIN  CLA     RSHJB               BACK-UP REQUEST,COMPUTE              IBB26500
       SUB     RSQUAN              'SYSJOB'-QUANTITY AND                IBB26510
       STO     RSQUAN              SAVE RESULT                          IBB26520
       SUB     L(1)                NOW CHECK FOR VALID COUNT            IBB26530
       TMI     IBRT3               ABSOLUTE VALUE TOO HIGH,EXIT         IBB26540
RSMTEN LDI*    SYSIN1              PICK UP VCB(1) FOR SYSIN1         $6$IBB26550
       AXT     30,1                                                     IBB26560
       LNT     020000              TEST FOR 7909 D.C.                   IBB26570
       AXT     3,1                                                      IBB26580
       SXD     *+2,1               HERE FOR 7340 TAPE UNIT              IBB26590
       TSX     NDSEL,4                                                  IBB26600
       PZE     SYSIN1,,**          REWIND SYSIN1                     $6$IBB26610
       STZ     SYSJOB              AND SET SYSJOB TO ZERO               IBB26620
RSCONT CAL     IBSNXT              O.K. TO TELL IBSUP TO                IBB26630
       SLW     TMPGET              SKIP TILL $JOB OR$STOP               IBB26640
       STL     IBNCT               SET SKIP JOB SWITCH                  IBB26650
       ZET     RSMTSW              IF MATCH OPTION NEED                 IBB26660
       TRA     IBSYS               $JOB CARD FROM READER                IBB26670
       TRA     NDINT               INDICATE INTERRUPT COMPLETED      (6)IBB26680
RSPLRT SUB     L(1)                DECREMENT COUNTER BY ONE          (6)IBB26690
       STO     RSQUAN              SAVE,RETURN UNLESS COUNT             IBB26700
       TNZ     IBSYS               REDUCED TO ZERO                      IBB26710
       ZET     RSERSW              PREVIOUS ERROR OCCURED               IBB26720
       TRA     RSERBK              YES,GO TO BACKSPACE                  IBB26730
       STZ     IBNCT               NO,RESET SKIP JOB SWITCH             IBB26740
       TRA     IBSYS               AND RETURN,JOB COMPLETE              IBB26750
RSSCAN ZET     RSMTSW              IBSYS RETURNS HERE WITH              IBB26760
       TRA     RSMTRT              $JOB, GO TO MATCH ROUTINE            IBB26770
       NZT     IBSINP              OTHERWISE TEST INPUT              $6$IBB26780
       TRA     IBSYS               DEVISE,IGNORE SYSCRO                 IBB26790
       LXA     SYSJOB,1            IS TAPE,BUMP SYSJOB                  IBB26800
       TXI     *+1,1,1             TO REFLECT PASSING OF                IBB26810
       SXA     SYSJOB,1            $JOB CARD AND GO TO TEST             IBB26820
       TRA     RSPLUS              COUNTER                              IBB26830
RSMTRT ZET     RSFSTM              MATCH ROUTINE ENTERED BEFORE         IBB26840
       TRA     RSNXTM              YES,EXIT                             IBB26850
       STL     RSMTER                                                   IBB26860
       ZET     IBSINP              TEST IBSINP FOR SYSCRD            $6$IBB26870
       TRA     RSERBK              ERROR IF TAPE $JOB CARD              IBB26880
       STZ     RSMTER                                                   IBB26890
       AXT     12,1                O.K.,SET UP MATCH                    IBB26900
RSAX2  AXT     6,2                 BUFFER FROM $JOB                     IBB26910
       LDQ     ICARD+12,1          CARD FOR LATER USE                   IBB26920
RSCLR  ZAC                                                              IBB26930
       LGL     6                                                        IBB26940
       ERA     L(48)                                                    IBB26950
       TZE     *+2                                                      IBB26960
       ORA     RSFUL                                                    IBB26970
       LGR     6                                                        IBB26980
       RQL     6                                                        IBB26990
       TIX     RSCLR,2,1                                                IBB27000
       STQ     RSMSK+12,1          CREATE MASK BUFFER                   IBB27010
       CAL     ICARD+12,1                                               IBB27020
       ANA     RSMSK+12,1                                               IBB27030
       SLW     RSIDCD+12,1         CREATE MATCH BUFFER                  IBB27040
       TIX     RSAX2,1,1           LOOP TILL COMPLETE                   IBB27050
       STL     RSFSTM              SET SWITCH TO BYPASS                 IBB27060
       TRA     NDINT1              INDICATE INTERRUPT COMPLETED      (6)IBB27070
RSNXTM NZT     IBSINP                                                $6$IBB27080
       TRA     IBSYS         IGNORE CARD READER $JOB                    IBB27090
       LXA     SYSJOB,2            BUMP SYSJOB BY ONE                   IBB27100
       TXI     *+1,2,1                                                  IBB27110
       SXA     SYSJOB,2                                                 IBB27120
       AXT     12,2                AND MATCH TAPE $JOB                  IBB27130
RSLOP  CAL     ICARD+12,2          WITH ORIGINAL $JOB                   IBB27140
       ANA     RSMSK+12,2                                               IBB27150
       ERA     RSIDCD+12,2                                              IBB27160
       TNZ     IBSYS               EXIT ON FIRST NON-MATCH              IBB27170
       TIX     RSLOP,2,1           OR ELSE LOOP TILL COMPLETE           IBB27180
RSERBK LXA     SYSJOB,2            PERFECT MATCH FOUND,                 IBB27190
       TXI     *+1,2,-1            BUMP SYSJOB DOWN                     IBB27200
       SXA     SYSJOB,2            BY ONE,,                             IBB27210
       LDI*    SYSIN1              BACKSPACE SYSIN1                  $6$IBB27220
       AXT     34,1                ONE RECORD                           IBB27230
       LNT     020000                                                   IBB27240
       AXT     5,1                                                      IBB27250
       SXD     *+2,1                                                    IBB27260
       TSX     NDSEL,4                                                  IBB27270
       PZE     SYSIN1,,**                                            $6$IBB27280
RSERBL STZ     IBNCT               RESET SKIP JOB SWITCH             (6)IBB27290
       CAL     SYSGET+.       AND SET TMPGET TO                      $6$IBB27300
       SLW     TMPGET              'IBSYST' TO ALLOW FURTHER            IBB27310
       ZET     RSMTER              MATCH JOB ERROR FOUND                IBB27320
       TRA     IBRT2               YES,PRINT ERROR MESSAGE              IBB27330
       ZET     RSERSW              WAS THERE  A SKIP JOB ERRER          IBB27340
       TRA     IBRT3               YES PRINT MESSAGE                    IBB27350
       TRA     IBSYS               NO,GOOD MATCH FOUND                  IBB27360
RSSTOP TRA     RSTOPP                                                (6)IBB27370
       NOP                         OLD CODING, PATCH SPACE           (6)IBB27380
       CLS     L(2)                OTHERWISE CAUSE ROUTINE              IBB27390
       STO     RSQUAN              TO REPOSITION SYSIN1                 IBB27400
       STL     RSERSW              TO ORIGINAL NEXT JOB                 IBB27410
       CLA     RSMTSW                                                   IBB27420
       STZ     RSMTSW                                                   IBB27430
       TZE     RSMIN                                                    IBB27440
       STL     RSMTER              FOR MATCH ERROR                      IBB27450
       TRA     RSMIN               AND GO REWIND SYSIN1                 IBB27460
RSMTCH BCI     1,0MATCH                                                 IBB27470
RSMTSW PZE                                                              IBB27480
RSMTER PZE                                                              IBB27490
RSFSTM PZE                                                              IBB27500
RSQUAN PZE                                                              IBB27510
RSSIGN PZE                                                              IBB27520
RSTOT  PZE                                                              IBB27530
RSHJB  PZE                                                              IBB27540
IBNCT  PZE                                                              IBB27550
RSERSW PZE                                                              IBB27560
RSMSK  BSS     12                                                       IBB27570
RSIDCD BSS     12                                                       IBB27580
       TTL     IBSUP ERROR MESSAGES                                     IBB27590
*                     GENERAL ERROR PRINT ROUTINE                       IBB27600
       SPACE   1                                                        IBB27610
 PUNT  CLA     IBSINP              FIRST - PRINT THE PREVIOUS CARD   $6$IBB27620
       NZT     REWOU1                      ON-LINE IF NOT ALREADY.      IBB27630
       ZET     LSTSW                                                    IBB27640
       TRA     PUNT1                                                    IBB27650
       TZE     PUNT1                                                    IBB27660
       TSX     PROUT,4                                                  IBB27670
       PZE     1                                                        IBB27680
       PZE     ICARD,,14                                             $6$IBB27690
 PUNT1 LDQ     1,1                                                      IBB27700
       STQ     *+3                 SECOND - PRINT WHATS WRONG           IBB27710
       TSX     PROPR,4                                                  IBB27720
       PZE     2                                                        IBB27730
       PZE     **,,**                                                   IBB27740
       PZE     IBERM,,6                                                 IBB27750
       TSX     IBPAS,4                                                  IBB27760
       STZ     IBSINP              SIMULATE $CARDS CARD              $6$IBB27770
       TRA     IBSYS                                                    IBB27780
 IBERM BCI     6,PROVIDE CLARIFICATION IN CARD READER                   IBB27790
       SPACE   1                                                        IBB27800
 IBAS1 TSX     PUNT,1                                                   IBB27810
       PZE     *+1,,5                                                   IBB27820
       BCI     5,ILLEGAL SYSUNI DEFINITION                              IBB27830
       SPACE   1                                                        IBB27840
 IBAT1 TSX     PUNT,1                                                   IBB27850
       PZE     *+1,,4                                                   IBB27860
       BCI     4, ILLEGAL UNIT SPECIFIED                                IBB27870
       SPACE                                                            IBB27880
IBNOIN LDQ     SYUNAM+9                                                 IBB27890
 IFND5 STQ     IFND4+1                                                  IBB27900
       TSX     PUNT1,1                                                  IBB27910
 IFND4 PZE     *+1,,5                                                   IBB27920
       BCI     5,****** NO ASSIGNMENT MADE                              IBB27930
       SPACE                                                            IBB27940
 IFND2 SLW     IFND3+1                                                  IBB27950
       TSX     PUNT,1                                                   IBB27960
 IFND3 PZE     *+1,,4                                                   IBB27970
       BCI     4,****** UNKNOWN SYSTEM                                  IBB27980
       SPACE                                                            IBB27990
 IBT3  TSX     PUNT1,1                                                  IBB28000
       PZE     *+1,,4                                                   IBB28010
       BCI     4,PRESS START TO IGNORE OR                               IBB28020
       SPACE                                                            IBB28030
 IBRT1 TSX     PUNT1,1                                                  IBB28040
       PZE     *+1,,6                                                   IBB28050
       BCI     6,$RESTART IGNORED - ILLEGAL FIELD                       IBB28060
       SPACE                                                            IBB28070
 IBRT2 TSX     PUNT1,1                                                  IBB28080
       PZE     *+1,,6                                                   IBB28090
       BCI     6,$RESTART IGNORED - NO MATCH FOUND                      IBB28100
       SPACE                                                            IBB28110
 IBRT3 TSX     PUNT1,1                                                  IBB28120
       PZE     *+1,,9                                                   IBB28130
       BCI     9,$RESTART IGNORED - ABSOLUTE VALUE OF COUNT TOO LARGE   IBB28140
       TTL     IBSUP / SUBROUTINES                                      IBB28150
*              CONVERT SYMBOLIC UNIT TO CHANNEL UNIT FORM               IBB28160
*      TSX     SYUCU,4             UNIT IN COLS 16-18 OF ICARD          IBB28170
*      ERROR RETURN                  ILLEGAL UNIT (SYMBOLIC)            IBB28180
*      NORMAL RETURN                 AC=  PRE  CHAN,,UNIT               IBB28190
       SPACE   1                                                        IBB28200
*     ACCEPTABLE A1,...,A9,A0,B1,...,H0 RDA,PRA,PUA,RDB,PRB,PUB,..      IBB28210
*              AD00/0,...,HD19/1,AN00/0,...,HN08/1,AH0/0,...,HH9/1      IBB28220
       SPACE   1                                                        IBB28230
* LATUN OR LOGICAL AC.  A0(II) -  MZE 1,,10      A4(IV) -  PZE 1,,4     IBB28240
*                       B3(V)  -  MZE 2,,3       B1(VI) -  PZE 2,,1     IBB28250
*                       0      -  PZE 0,,0       RDB    -  PZE 2,,11    IBB28260
*                       PUC    -  PZE 3,,12      PRG    -  PZE 7,,13    IBB28270
*                       CD01/0 -  PZE 3,,(23101)8                       IBB28280
*                       CN01/0 -  PZE 3,,(23301)8                       IBB28290
*                       EH7/1  -  PZE 5,,(25047)8                       IBB28300
SYUCU  LDQ     ICARD+2             PLACE SYMBOLIC                       IBB28310
       RQL     18                  UNIT IN MQ                           IBB28320
       PXA     0,0                 HI 3 CHAR.                           IBB28330
       LGL     6                   PLACE CHANNEL                        IBB28340
       PAX     0,1                 NUMBER (IF TAPE)                     IBB28350
       TIX     SYUC2,1,16          IN IR1                               IBB28360
SYUC1  TRA     1,4                 CHANNEL LESS THAN 'A'                IBB28370
*    TAPE SYMBOLIC OF FORM XN, X=CHANNEL A THRU H,N = UNIT 0 THRU 9     IBB28380
SYUC2  TIX     SYUC5,1,22          IF 'P' OR GRT THEN CD EQUIP          IBB28390
       PXA     0,0                 CLEAR AC                             IBB28400
       LGL     6                   PLACE UNIT NUMBER                    IBB28410
       PAX     0,2                 IN IR2                               IBB28420
       TXH     SYUC6,2,9           UNIT GR THAN 9, TRY 7909 DEVICE      IBB28430
       TXH     *+2,2,0             SET '0'                              IBB28440
       TXI     *+1,2,10            TO '10'                              IBB28450
       LDQ     ICARD+3             PICKUP MODEL                         IBB28460
       PXA     0,0                 DESIGNATION                          IBB28470
       LGL     12                  IF ANY                               IBB28480
       ERA     LOII                'II' SETS MODEL II UNIT              IBB28490
       TZE     SYUC3-2             'V' SET MODEL V UNIT                 IBB28500
       ERA     LOII                (IN $ATTACH PROCESSEOR THE T BIT     IBB28510
       ERA     LOV                  IN UCW WILL BE TO ZERO IF II OR V   IBB28520
       TNZ     SYUC3                IS SPECIFIED -OTHERWISE LEFT AS IS) IBB28530
       CAL     FOR                                                      IBB28540
       TRA     SYUC3+1                                                  IBB28550
SYUC3  PXA     0,0                                                      IBB28560
       STP     LATUN                                                    IBB28570
       SXA     LATUN,1                                                  IBB28580
       SXD     LATUN,2                                                  IBB28590
       CAL     LATUN                                                    IBB28600
       TRA     2,4                 TO NORMAL RETURN                     IBB28610
* CARD EQUIPMENT SYMBOLIC OF FORM RDX,PRX OR PUX ,X= CHANNEL A THRU H   IBB28620
SYUC5  TXH     *+2,1,2             INDEX ALLOWABLE                      IBB28630
       TXH     SYUC1,1,1           1 OR 3 (P OR R)                      IBB28640
       TXH     SYUC1,1,3                                                IBB28650
       PXA     0,0                 PLACE IN                             IBB28660
       LGL     6                   INDEX 2                              IBB28670
       AXT     3,2                 11 FOR RDX                           IBB28680
       LAS     SYUC9+3,2           12 FOR PUX                           IBB28690
       TRA     *+2                 13 FOR PRX                           IBB28700
       TRA     *+3                                                      IBB28710
       TIX     *-3,2,1                                                  IBB28720
       TRA     SYUC1                                                    IBB28730
       TXI     *+1,2,10                                                 IBB28740
       PXA     0,0                 FORM CHANNEL                         IBB28750
       LGL     6                   IN IR1                               IBB28760
       PAX     0,1                                                      IBB28770
       TIX     SYUC3,1,16                                               IBB28780
       TRA     1,4                 ILLEGAL CHANNEL                      IBB28790
 SYUC6 PXA     **,1                HERE TO TEST FOR DISK, NEED, HYPER   IBB28800
       ALS     5                                                        IBB28810
       STA     SYUC6                                                    IBB28820
       PXD     ,0                                                       IBB28830
       CAL     SYDSK                                                    IBB28840
       TXL     SYUC1,2,19          ERROR IF LS THAN 20 (20=D)           IBB28850
       TXL     SYC6A,2,20          IF 20 WE HAVE DISK                   IBB28860
       TXL     SYUC7,2,36          MAY BE HYPER IF LS THAN 37 (37=N)    IBB28870
       TXH     SYUC1,2,37          ERROR IF GR THAN 37                  IBB28880
       CAL     SYNED                                                    IBB28890
 SYC6A STD     SYC6B                                                    IBB28900
       LGL     6                                                        IBB28910
       PAX     ,2                                                       IBB28920
       TXH     SYUC1,2,1           ERROR IF GR THAN 1  (ACCESS 2 =1)    IBB28930
       ORA     SYUC6                                                    IBB28940
       ALS     4                                                        IBB28950
       STA     SYUC6                                                    IBB28960
       PXD     ,0                                                       IBB28970
       LDQ     ICARD+3                                                  IBB28980
       LGL     6                                                        IBB28990
       PAX     ,2                                                       IBB29000
       TXH     SYUC1,2,9           CHECK FOR LEGAL MODULE               IBB29010
       ORA     SYUC6                                                    IBB29020
       RQL     11                                                       IBB29030
       TQP     *+2                                                      IBB29040
       ORA     *+1                 ADD IN INTERFACE BIT IF NEEDED       IBB29050
       PAX     32,2                                                     IBB29060
 SYC6B TXI     SYUC3,2,**          ADD IN 7909 CHANNEL AND DEVICE BITS  IBB29070
 SYUC7 TXH     SYUC1,2,24          MUST HAVE AN H OR THERE              IBB29080
       TXL     SYUC1,2,23          IS AN ERROR                          IBB29090
       LGL     6                                                        IBB29100
       PAX     ,2                                                       IBB29110
       TXH     SYUC1,2,9           CHECK FOR LEGAL TAPE NO.             IBB29120
       PXA     ,2                                                       IBB29130
       LGR     4                                                        IBB29140
       CLA     SYUC6                                                    IBB29150
       LGL     4                                                        IBB29160
       LDQ     ICARD+3                                                  IBB29170
       RQL     11                                                       IBB29180
       TQP     *+2                                                      IBB29190
       ORA     *+1                                                      IBB29200
       PAX     32,2                ADD IN INTERFACE BIT IF NEEDED       IBB29210
       TXI     SYUC3,2,8192        ADD IN 7909 CHANNEL BIT              IBB29220
 SYUC9 BCI     3,00000R00000U00000D                                     IBB29230
 SYDSK PZE     ,,8192+64                                                IBB29240
 SYNED PZE     ,,8192+192                                               IBB29250
LOII   BCI     1,0000II                                                 IBB29260
LOV    BCI     1,0000V                                                  IBB29270
       EJECT                                                            IBB29280
*                    INITIALIZE SYSTEM TAPE USEAGE                      IBB29290
       SPACE   1                                                        IBB29300
*      TSX     INITUS,1            IR2=-L(INDIRECT REF TO UCW)          IBB29310
*      RETURN                       IR4 DESTROYED                       IBB29320
       SPACE   1                                                        IBB29330
*         IF THE REFERENCE IS TO SYSLB1 THE SELF LOAD SEQUENCE          IBB29340
*        FOR THE RESTORATION OF THE BASIC MONITOR IS GENERATED          IBB29350
       SPACE   1                                                        IBB29360
INITUS CLA     0,2                 CHECK                                IBB29370
       PAC     0,4                 TAPE AT                              IBB29380
       TXH     *+2,4,0                                                  IBB29390
       TRA     INITL3              TEST FOR DUMP TAPE                   IBB29400
       LDI     0,4                                                      IBB29410
       RIL     600000              RESET A AND M FLAGS TO 0             IBB29420
       STI     0,4                                                      IBB29430
       TXH     INLB1,2,-SYSLB2     TO INLB2 IF UNIT IS SYSLB1        $6$IBB29440
       TXH     *+2,2,-SYSPP2                                         $6$IBB29450
       TXH     INPP2,2,-SYSPP2-1   TO INPP2 IF UNIT IS SYSPP2        $6$IBB29460
INITL1 LFT     020000                                                   IBB29470
       TRA     INITL2              IF 7909 CHANNEL AVOID SETTING        IBB29480
       CAL     0,2                 DENSITY. OTHERWISE SET               IBB29490
       ARS     17                  DENSITY                              IBB29500
       ADD     1B17                ACCORDING TO                         IBB29510
       STD     *+2                 SIGN OF SYSUNI                       IBB29520
       TSX     .NDSEL,4                                              $6$IBB29530
       PZE     0,2,**              X                                    IBB29540
INITL2 LNT     020100                                                   IBB29550
       TRA     *+2                                                      IBB29560
       TRA     1,1                 IF DISK ASSIGNMENT, EXIT NOW         IBB29570
       TXH     *+2,2,-SYSUT1                                         $6$IBB29580
       TRA     1,1                                                      IBB29590
       TXH     *-1,2,-SYSOU1                                         $6$IBB29600
       TXL     INITL9,2,-SYSCK1    SET M FLAG FOR SYSCK'S            $6$IBB29610
       TXH     INITL8,2,-SYSOU2                                      $6$IBB29620
       TXH     INITL9,2,-SYSOU2-1  SET M FLAG FOR SYSOU'S            $6$IBB29630
       TXH     *+2,2,-SYSIN2-1                                       $6$IBB29640
       TXH     INITL9,2,-SYSPP2    SET M FLAG FOR SYSPP1             $6$IBB29650
       TRA     1,1                                                      IBB29660
INITL9 CLA     0,2                 HERE IF SOME OUTPUT UNIT             IBB29670
       PAC     0,4                 SET NO REPOSITIONING                 IBB29680
       CAL     PTW                 FLAG IN                              IBB29690
       ORS     0,4                 UCW                                  IBB29700
       TRA     1,1                                                      IBB29710
       EJECT                                                            IBB29720
*              INITIALIZE SYSLB1 LOADER AND MOVE INTO NUCLEUS           IBB29730
       SPACE                                                            IBB29740
 INLB1 SXA     TIN2,1                                                   IBB29750
       ZET     PNGSW                                                    IBB29760
       TRA     1,1                 RETURN IF PING/PONG IS IN EFFECT     IBB29770
       CLA     SISTRA              (WHEN SYSLB1 LOADERS ARE DONE THEY   IBB29780
       STO     CALIBN-1            TRA TO CALIBN-1 SO SET = TRA SYSTRA) IBB29790
       PIA                                                              IBB29800
       ARS     9                                                        IBB29810
       ANA     L(15D)                                                   IBB29820
       STD     *+2                                                      IBB29830
       AXT     CHXSP-1,1                                                IBB29840
       TXI     *+1,1,**                                                 IBB29850
       SXA     CALIB1,1            INITIALIZE ENTRANCE TO SYSLB1 LOAD$6$IBB29860
       PDC     ,1            SET XR1 = -(CHANNEL NUMBER)                IBB29870
       LXA     SYSLB1,4                                              $6$IBB29880
       TXI     *+1,4,2       SET XR4 = L(UCB+2)                         IBB29890
       LDQ     RCHX-1,1            SET MQ=CORRECT RCHX (RSCX) INTR.     IBB29900
       IFT     CHEX=0                                                $6$IBB29901
       GOTO    TIN1                                                  $6$IBB29902
       LFT     020000        NOW DETERMINE TYPE OF DEVICE               IBB29910
       TRA     9IN1                                                     IBB29920
       SPACE   3                                                        IBB29930
TIN1   LFT     000500              HERE IF 7607 CHANNEL              $6$IBB29940
       TRA     IBAS1               GO PRINT ILLEGAL SYSUNI MESSAGE      IBB29950
       MOVLDR  CATLB1,ENTLB1,CTLB1L,XR1                              $6$IBB29951
       SLQ     LB1T4                                                    IBB29960
       SLQ     LB1T8         RCHX                                       IBB29970
       SXA     LB1T1,4       STZ VCB+2                                  IBB29980
       LDQ     TCOX-1,1                                                 IBB29990
       SLQ     LB1T2               TCOX                                 IBB30000
       SLQ     LB1T6                                                    IBB30010
       LDQ     TRCX-1,1                                                 IBB30020
       SLQ     LB1T5         TRCX                                       IBB30030
       SLQ     LB1T7                                                    IBB30040
       PIA                                                              IBB30050
       ARS     18                                                       IBB30060
       ORA     L(16)                                                    IBB30070
       STA     CATLB1        REW X                                      IBB30080
       STA     LB1T3         RDS X                                      IBB30090
       STA     LB1T9         BSR X                                      IBB30100
 TIN2  AXT     **,1                                                  $6$IBB30101
       TRA     INITL1+2                                              $6$IBB30110
       EJECT                                                            IBB30210
       IFT     CHEX=0                                                $6$IBB30218
       GOTO    SISTRA                                                $6$IBB30219
 9IN1  PIA                   HERE IF 7909 CHANNEL                       IBB30220
       ARS     18                                                       IBB30230
       ANA     INMK1                                                    IBB30240
       ORA     RICA          SET AC = RICX INSTR                        IBB30250
       IFT     DUEX=0                                                $6$IBB30251
       GOTO    HIN1                                                  $6$IBB30252
       IFT     HTEX=0                                                $6$IBB30253
       GOTO    DIN1                                                  $6$IBB30254
       LFT     000700                                                   IBB30260
       TRA     DIN1                                                     IBB30270
       SPACE   3                                                        IBB30280
HIN1   MOVLDR  CAHLB1,ENHLB1,CHLB1L,XR1,AC  7340 HYPERTAPE           $6$IBB30289
       SLQ     LB1H3         HERE IF 7340 HYPERTAPE                     IBB30290
       SLQ     LB1H5                                                    IBB30300
       SLQ     LB1H8         RSCX                                       IBB30310
       SXA     CAHLB1,4      STZ UCB+2                                  IBB30320
       SLW     LB1H2         RICX                                       IBB30330
       LDQ     TCOX-1,1                                                 IBB30340
       SLQ     LB1H4         TCOX                                       IBB30350
       SLQ     LB1H7                                                    IBB30360
       LDQ     SDCX-1,1                                                 IBB30370
       SLQ     LB1H6         SCDX                                       IBB30380
       PIA                                                              IBB30390
       ARS     23                                                       IBB30400
       ANA     IBL(1)                                                $6$IBB30410
       ORA     CHNS4                                                    IBB30420
       STA     LB1H9         SMS                                        IBB30430
       CAL     INMK2                                                    IBB30440
       ANS     LBNH8                                                    IBB30450
       PIA                                                              IBB30460
       ANA     L(15D)                                                   IBB30470
       TNZ     *+2                                                      IBB30480
       CAL     L(10D)                                                   IBB30490
       ORA     LBNH8                                                    IBB30500
       STD     LB1HA         HRWD                                       IBB30510
       STD     LB1HB         HBSR                                       IBB30520
       STD     LB1HC               HSEL                                 IBB30530
       LXA     TIN2,1                                                $6$IBB30540
       TRA     1,1                                                   $6$IBB30550
       EJECT                                                            IBB30640
       IFT     DUEX=0                                                $6$IBB30648
       GOTO    SISTRA                                                $6$IBB30649
 DIN1  LNT     000100                                                   IBB30650
       TRA     IBAS1               GO PRINT ILLEGAL SYSUNI MESSAGE      IBB30660
       SXA     DIN3,2        HERE IF DISK (OR NEED DRUM)                IBB30670
       MOVLDR  CADLB1,ENDLB1,CDLB1L,XR1,AC                           $6$IBB30671
       SLW     LB1D1                                                    IBB30680
       SLQ     LB1D2         RSCX                                       IBB30690
       LDQ     SDCX-1,1                                                 IBB30700
       SLQ     LB1D3         SCDX                                       IBB30710
       LDQ     TCOX-1,1                                                 IBB30720
       SLQ     LB1D4         TCOX                                       IBB30730
 DIN3  AXT     **,2                                                     IBB30860
       LXA     TIN2,1                                                   IBB30870
       CAL     DRABM               SET BM AS RECORD ADDRESS             IBB30880
       STD     SYSLB1              FOR DISK SYSLB1.                  $6$IBB30890
       TRA     1,1                                                      IBB30900
       SPACE                                                            IBB30910
SISTRA TRA     SYSCEM                                                   IBB30980
 DRABM BCI     1,0BM000                                                 IBB30990
       SPACE                                                            IBB31000
 LCHXT LCHA    *                                                        IBB31010
       LCHB    *                                                        IBB31020
       LCHC    *                                                        IBB31030
       LCHD    *                                                        IBB31040
       LCHE    *                                                        IBB31050
       LCHF    *                                                        IBB31060
       LCHG    *                                                        IBB31070
       LCHH    *                                                        IBB31080
       EJECT                                                            IBB31090
*                    INITIALIZE DUMP SPILL FOR SYSPP2                   IBB31100
       SPACE                                                            IBB31110
 INPP2 LNT     000100                                                   IBB31120
       TRA     INPPW                                                    IBB31130
       TSX     PROPR,4             PRINT DUMP WARNING IF                IBB31140
       PZE     1                   SYSPP2 IS NOT 729 OR HYPER.          IBB31150
       PZE     INMS1,,9                                                 IBB31160
       TRA     INITL7                                                   IBB31170
 INPPW CLA     SYSPP2              HERE IF SYSPP2 IS 729 OR HYPER    $6$IBB31180
       ALS     18                                                       IBB31190
       STD     DPUCB               SET D(DPUCB) = L(SPILL UCB)       $6$IBB31200
       CAL*    0,2                                                      IBB31210
       ARS     9                                                        IBB31220
       ANA     L(15D)                                                   IBB31230
       PDC     ,4                  SET XR4= -(CHANNEL NUMBER)           IBB31240
       LDQ     LCHXT-1,4                                                IBB31250
       SLQ     DPH4                SET LCHX OR STCX                  $6$IBB31260
       LDQ     RCHX-1,4                                                 IBB31270
       SLQ     DPH3                SET RCHX OR RSCX                  $6$IBB31280
       LDQ     DUMP+.                                                $6$IBB31281
       CLA*    0,2                 NOW SPLIT FOR 729 OR HYPER           IBB31290
       LFT     020000                                                   IBB31300
       TRA     INPPX                                                    IBB31310
       ARS     18                  HERE IF 729 TAPE=SYSPP2              IBB31320
       ORA     L(16)                                                    IBB31330
       STA     DHENT+.                                               $6$IBB31340
       CLA     DHENT+.                                               $6$IBB31350
       STO     DHENT                                                 $6$IBB31360
       STQ     DUMP                                                  $6$IBB31361
       CLA     DPH2+.                                                $6$IBB31370
       STO     DPH2                                                  $6$IBB31380
       CLA     DPH3+.                                                $6$IBB31390
       STA     DPH3                RCHX  DMPCW                       $6$IBB31400
       CLA     INDP1                                                    IBB31410
       TRA     INPPZ                                                    IBB31420
 INPPX ANA     L(15D)              HERE IF HYPERTAPE = SYSPP2           IBB31430
       CLA     DPH1+.                                                $6$IBB31440
       SLW     DPH1                                                  $6$IBB31450
       STQ     DHENT                                                 $6$IBB31451
       CLA*    0,2                                                      IBB31460
       ARS     23                                                       IBB31470
       ANA     L(1)                                                     IBB31480
       IFT     CHEX=0                                                $6$IBB31481
       NULL                        (ORA CHNS4 IF 7909 EXISTS)        $6$IBB31482
       IFF     CHEX=0                                                $6$IBB31483
       ORA     CHNS4               SMS                                  IBB31490
 INPPY SLW     DUMP                                                  $6$IBB31500
       CLA     INCTL               CTLW  *-2                            IBB31510
       STO     DPH2                                                  $6$IBB31520
       CLA     INPPY                                                    IBB31530
       STA     DPH3                RSCX                              $6$IBB31540
       CLA     INDP2                                                    IBB31550
 INPPZ LXA     SYSOU1,4            NOW JOIN 729 AND HYPER            $6$IBB31560
       TXL     INPPV,4,0           PREVENT DUMP SPILL IF                IBB31570
       LDI*    SYSOU1              SYSOU1 IS NOT 729 OR HYPER        $6$IBB31580
       LNT     020100                                                   IBB31590
       TRA     INPPV+1                                                  IBB31600
 INPPV CAL     INDP3                                                    IBB31610
       LDI*    SYSPP2                                                $6$IBB31620
       STO     SYSDMP                                                   IBB31630
       STO     2                                                        IBB31640
       TRA     INITL1                                                   IBB31650
       SPACE                                                            IBB31660
 INDP1 TTR     DUMP                                                  $6$IBB31670
 INDP2 TTR     DHENT                                                 $6$IBB31680
 INCTL CTLW    DPH1                                                  $6$IBB31690
 INMS1 BCI     9,SYSPP2 IS NOT 729 OR HYPER. NO DUMP CAN BE TAKEN.      IBB31700
       SPACE                                                            IBB31710
*                    CHECK IF SYSPP2 OR SYSOU1 NOT ASSIGNED             IBB31720
       SPACE                                                            IBB31730
INITL3 TXH     INITL4,2,-SYSOU1+.                                       IBB31740
       TXH     INITL5,2,-SYSOU2+.                                       IBB31750
       TXH     INITL4,2,-SYSPP2+.                                       IBB31760
       TXH     INITL6,2,-SYSPP2-1+.                                     IBB31770
INITL4 TRA     1,1                                                      IBB31780
INITL5 TSX     PROPR,4             NO SYSOU1, TELL OPR NO DUMP --    $6$IBB31810
       PZE     2                                                        IBB31820
       MZE     SYUNAM+7,,1                                              IBB31830
       PZE     INMS2,,7                                                 IBB31840
       TRA     INITL7                                                   IBB31850
INITL6 TSX     PROPR,4                                                  IBB31860
       PZE     2                                                        IBB31870
       MZE     SYUNAM+12,,1                                             IBB31880
       PZE     INMS2,,7                                                 IBB31890
INITL7 CAL     INDP3                                                    IBB31900
       SLW     SYSDMP                                                   IBB31910
       SLW     2                                                        IBB31920
       TRA     1,1                                                      IBB31930
       SPACE                                                            IBB31940
 INDP3 TTR     CALIB1                                                $6$IBB31950
 INMS2 BCI     7, IS NOT ASSIGNED. NO DUMP CAN BE TAKEN.                IBB31960
       SPACE   3                                                        IBB31970
*                    RESTORE DUMP SPILL AND SPOUT IF SYSOU1 ASSIGNED.   IBB31980
       SPACE                                                            IBB31990
INITL8 LXA     SYSPP2,4                                              $6$IBB32000
       CLA     SPTLD               RESTORE SPOUT                     $6$IBB32010
       LDI*    SYSOU1              IF SYSOU1 IS 729 OR HYPER.        $6$IBB32020
       LFT     000100              KILL IT OTHERWISE.                   IBB32030
       CLA     SPTLD+1                                               $6$IBB32040
       STO     SPOUT               NEXT RESTORE DUMP SPILL           $6$IBB32050
       TXL     INITL9,4,0                                               IBB32060
       LDI*    SYSPP2              FORGET ALL ABOUT IT THOUGH        $6$IBB32070
       LFT     000100              IF SYSPP2 IS NOT 729 OR HYPER.       IBB32080
       TRA     INITL9                                                   IBB32090
       LDQ     DUMP                                                  $6$IBB32100
       CLA     INDP1                                                    IBB32110
       TQP     *+2                                                      IBB32120
       CLA     INDP2                                                    IBB32130
       STO     SYSDMP                                                   IBB32140
       STO     2                                                        IBB32150
       TRA     INITL9                                                   IBB32160
       EJECT                                                            IBB32170
*           REMOVE UNIT REFERENCE FROM AVAILABLE UNIT CHAIN             IBB32180
       SPACE   1                                                        IBB32190
*      TSX     RSYUR,4             AC ADDR=L(UCW), IF ZERO EXIT OCCURS  IBB32200
*      RETURN                       INDICES PRESERVED                   IBB32210
       SPACE   1                                                        IBB32220
RSYUR  SXA     RSY2,4              SAVE IR4                             IBB32230
       SXA     RSY2+1,2            SAVE IR2                             IBB32240
       SXA     RSY2+2,1            SAVE IR1                             IBB32250
       STA     RSY5                SET COMPARE CELL                     IBB32260
       NZT     RSY5                IF ZERO                              IBB32270
       TRA     1,4                 EXIT                                 IBB32280
       PAC     0,2                                                      IBB32290
       CLA     0,2                                                      IBB32300
       ARS     9                                                        IBB32310
       ANA     L(15D)              MASK OUT CHANNEL                     IBB32320
       ARS     18                  AND FORM ADDRESS OF START            IBB32330
       ACL     SYSUAV              OF AVAILABILITY CHAIN             $6$IBB32340
       PAC     0,4                 FOR THAT CHANNEL                     IBB32350
       TXI     *+1,4,1                                                  IBB32360
RSY1   CLA     0,4                 FIND REFERENCE                       IBB32370
       ANA     IBADR               TO UCW BEING                         IBB32380
       CAS     RSY5                DELETED                              IBB32390
       TRA     *+2                 NO-                                  IBB32400
       TRA     RSY3                YES                                  IBB32410
       PAC     0,4                 AT CHAIN                             IBB32420
       TXH     RSY1,4,0            END                                  IBB32430
RSY2   AXT     **,4                YES RESTORE IR4                      IBB32440
       AXT     **,2                YES RESTORE IR2                      IBB32450
       AXT     **,1                YES RESTORE IR1                      IBB32460
       TRA     1,4                 EXIT                                 IBB32470
RSY3   CLA     0,2                 FOUND REF. HOOK CHAIN                IBB32480
       STA     0,4                 FROM UCW TO REF                      IBB32490
       TRA     RSY2                AND EXIT                             IBB32500
       SPACE                                                            IBB32510
RSY5   PZE     **                  TEMPORARY                            IBB32520
       EJECT                                                            IBB32530
*             VALIDATE CHANNEL AND UNIT,IF OK FORM L(UCW)               IBB32540
       SPACE   1                                                        IBB32550
*      TSX     IBVAL,4             AC= PARAM                            IBB32560
*      RETURN                       IR1 NOT DESTROYED                   IBB32570
       SPACE   1                                                        IBB32580
*                  PARAM OF FORMAT PZE CHANNEL,,UNIT                    IBB32590
*               CHANNEL=1-8,UNIT=1-13 11=CRD,12=PU,13=PR                IBB32600
*            AT EXIT - AC = PZE L(UCW) OR PZE 0 IF ILLEGAL              IBB32610
*                             IR2= -L(UCW)                              IBB32620
*                             SI = C(UCW)                               IBB32630
       SPACE   1                                                        IBB32640
IBVAL  SXA     IBV2+2,4            SAVE IR4                             IBB32650
       SXA     IBV2+3,1            1                                    IBB32660
       PAC     0,1                 CHECK                                IBB32670
       TXL     IBV5+2,1,-HGHCHN-1  LEGIT CHANNEL                     $6$IBB32680
       PDX     0,2                 CHECK UNIT                           IBB32690
       TXH     IBV7,2,16      VALIDATE DISK OR HYPER TAPE               IBB32700
       TXL     IBV5+2,2,0          GR THAN ZERO                         IBB32710
       TIX     IBV3,2,10           IF GR THAN 10 NOT TAPE               IBB32720
       SPACE                                                            IBB32730
*                     REFERENCE TO 729 TAPE                             IBB32740
       ZET     IBSGAP-1,1                                            $6$IBB32750
       TRA     IBV5+2              EXIT IF 7909 CHANNEL                 IBB32760
       CAL     UCBA-1,1                                              $6$IBB32770
       STD     IBV1                SET TOTAL UNIT CT ON CHANNEL         IBB32780
       ARS     15                  BUMP TAPE                            IBB32790
       STD     *+1                 NUMBER BY CARD                       IBB32800
       TXI     *+1,2,**            EQUIP CT TO FORM                     IBB32810
       PXD     0,2                 POSITION NUMBER                      IBB32820
       PDC     0,4                                                      IBB32830
IBV1   TXI     *+1,4,**            TEST IF THAT                         IBB32840
       TXH     IBV5+2,4,12         UNIT EXISTS                          IBB32850
       ARS     16                  YES - IT DOES                        IBB32860
       ACL     UCBA-1,1            FORM UCW LOC BY                   $6$IBB32870
       SUB     L(4)                4*POS+L(UEX11)-4                     IBB32880
       PAC     0,2                 -L(UCW) TO IR2                       IBB32890
IBV2   ANA     IBADR               CLEAR AC EXCEPT UCW LOC              IBB32900
       LDI     0,2                 C(UCW) TO SI                         IBB32910
       AXT     **,4                RESTORE IR4                          IBB32920
       AXT     **,1                                                     IBB32930
       TRA     1,4                 EXIT                                 IBB32940
       SPACE   1                                                        IBB32950
*                     REFERENCE TO CARD EQUIPMENT                       IBB32960
IBV3   TXH     IBV5+2,2,3          TEST GR THAN 3 (LAST CD TYPE ALLOWED)IBB32970
       CLA     UCBA-1,1            SAVE                              $6$IBB32980
       STA     IBV4                SAVE L(UCW)                          IBB32990
       ARS     15                  AND NUMBER                           IBB33000
       PDX     0,4                 CARD DEVICES (ILLEGAL IF NONE)       IBB33010
       TXL     IBV5+2,4,0                                               IBB33020
       PXD     0,2                 FORM CORRECT                         IBB33030
       ALS     4                   MASK IF IR2=1,321                    IBB33040
       ACL     I301D               2,341                                IBB33050
       STO     IBV9                3,361                                IBB33060
IBV4   AXC     **,2                -L(UEX11)                            IBB33070
       LDI     0,2                 TEST IF                              IBB33080
       TIO     *+2                 CORRECT                              IBB33090
       TRA     IBV5                CARD UNIT                            IBB33100
       COM                         EXISTS                               IBB33110
       ANA     I377D                                                    IBB33120
       TIF     IBV6                                                     IBB33130
       CLA     IBV9                NOT YET FOUND                        IBB33140
IBV5   TXI     *+1,2,-4                                                 IBB33150
       TIX     IBV4+1,4,1                                               IBB33160
       PXA     0,0                 NON-EXISTANT                         IBB33170
       TRA     IBV2+2                                                   IBB33180
IBV6   PXA     0,2                 FOUND                                IBB33190
       PAC     0,4                 +L(UCW)                              IBB33200
       PXA     0,4                 TO AC                                IBB33210
       TRA     IBV2+1              EXIT                                 IBB33220
       SPACE                                                            IBB33230
*                     REFERENCE TO 7909 CHANNEL DEVICE                  IBB33240
IBV7   CLA     UCBA-1,1                                              $6$IBB33250
       PAC     ,4                  SET XR4=-L(FIRST UCB ON CHANNEL)     IBB33260
       PDX     ,1                  SET XR1= NO. OF UCBS ON CHANNEL      IBB33270
 IBV8  PXD     ,2                  SET D(AC)=FULL UNIT ADDRESS (2XXXX)  IBB33280
       LDI     0,4                                                      IBB33290
       ORA     IBVD                CHECK FOR 1302 REQUEST            $6$IBB33292
       TIO     *+4                 TRANSFER FOR 1302                 $6$IBB33294
       PXD     0,2                                                   $6$IBB33296
       TIO     *+2                                                      IBB33300
       TRA     *+4                                                      IBB33310
       COM                                                              IBB33320
       ANA     I377D                                                    IBB33330
       TIF     *+4                                                      IBB33340
       TXI     *+1,4,-4                                                 IBB33350
       TIX     IBV8,1,1                                                 IBB33360
       TRA     IBV5+2                                                   IBB33370
       PXA     0,4                                                      IBB33380
       PAX     ,2                  SET XR2=-L(UCW)                      IBB33390
       TRA     IBV6+1                                                   IBB33400
       SPACE                                                            IBB33410
IBV9   PZE     0,,**                                                    IBB33420
 IBVD  PZE     ,,384                                                 $6$IBB33422
       EJECT                                                            IBB33430
*                        PROCESS FIND FUNCTION                          IBB33440
       SPACE   1                                                        IBB33450
*                LOOKS UP LOCATION OF SPECIFIED SYSTEM                  IBB33460
*       AND CALLS GENERAL TP POSITIONER TO POSITION CORRECT REEL        IBB33470
*               IN FRONT OF FIRST RECORD OF THAT SYSTEM                 IBB33480
       SPACE   1                                                        IBB33490
*      TSX     IFIND,4             COLS 16-21 OF ICARD=NAME             IBB33500
*              RETURN        ON RETURN XR2 = L(SYSLBX)                  IBB33510
       SPACE   1                                                        IBB33520
IFIND  SXA     IFND7,1             SAVE IR1                             IBB33530
       SXA     IFND9,4             SAVE IR4                             IBB33540
       CAL     ICARD+2                                                  IBB33550
       LDQ     ICARD+3             POSITION SYSTEM NAME IN AC           IBB33560
       LGL     18                                                       IBB33570
       LAS     ALBLK                                                 $6$IBB33650
       TRA     *+2                                                      IBB33660
       TRA     IFND2               ALL BLANKS IS UNKNOWN SYSTEM         IBB33670
       LAC     SYSNAM,4                                                 IBB33680
       LXD     SYSNAM,1            O.K. - COLS 16 THRU 21 NOT ALL       IBB33690
       LAS     0,4                 BLANK - LETS GO TRY AND FIND         IBB33700
       TRA     *+2                 IT IN THE SYSTEM NAME TABLE.         IBB33710
       TRA     IFND1               HERE IT IS - TO IFND1                IBB33720
       TXI     *+1,4,-2                                                 IBB33730
       TIX     *-4,1,1                                                  IBB33740
       TRA     IFND2               UNKNOWN SYSTEM                       IBB33750
IFND1  SLW     SYSCUR              STORE CURRENT SYSTEM NAME            IBB33760
       CLA     1,4                                                      IBB33770
       STO     SYSPOS                                                   IBB33780
       PAC     ,4                  NOW DETERMINE SYSLBN              $6$IBB33790
       ACL     SYSUNI                                                   IBB33800
       SUB     L(1)                                                     IBB33810
       PAC     ,2                  SET XR2 = -L(SYSLBN)                 IBB33820
       CLA     0,2                                                      IBB33830
       ANA     IBADR               MAKE SURE SYSLBN IS ASSIGNED         IBB33840
       TNZ     IFND6                                                    IBB33850
       LDQ     SYUNAM-1,4          IF NOT, PRINT ERROR MESSAGE       $6$IBB33860
       TRA     IFND5                                                 (9)IBB33870
       STR                         * PATCH SPACE *                   (9)IBB33880
       STR                         * PATCH SPACE *                   (9)IBB33890
IFND6  LDI*    SYSLB1                                                $6$IBB33900
       LNT     020100              IS SYSLB1 DISK OR NEED...         $6$IBB33905
       TRA     IFNDA               NO                                   IBB33910
       LDI*    0,2                 YES.                                 IBB33920
       LNT     020100              IF YES - HOW ABOUT SYSLBN...         IBB33930
       TRA     IFNDB               NO                                   IBB33940
       AXT     0,4                 YES - THEN LOCATE THE TRACK          IBB33950
       CAL     SYSCUR              POSITION OF THE SYSTEM BY            IBB33960
       LAS     DSYSNM,4            LOOKUP IN DISK NAME TABLE.           IBB33970
       TRA     *+2                                                      IBB33980
       TRA     IFND8               --FOUND--                            IBB33990
       TXI     *+1,4,-2                                                 IBB34000
       TXH     *-4,4,-SLTABL                                            IBB34010
       TRA     IFND2               OH WELL, CANT FIND IT.               IBB34020
 IFND8 CLA     DSYSNM+1,4          HERE IF FOUND                        IBB34030
       STD     SYSPOS              SET D,SYSPOS.= TTTT ORIGIN           IBB34040
       LDQ     L(0)                RETURN WITH S(MQ)=+ TO               IBB34050
       TRA     IFND7               INDICATE LB1 AND LBN = DISK (NEED).  IBB34060
 IFNDA LDI*    0,2                 HERE IF SYSLB1 IS TAPE               IBB34070
       LNT     020100              HOW ABOUT SYSLBN - IT BETTER         IBB34080
       TRA     IFNDB               BE TAPE ALSO                         IBB34090
       LDQ     SYUNAM-1,4                                               IBB34100
       STQ     IFNDX                                                    IBB34110
       TSX     PUNT,1                                                   IBB34120
       PZE     *+1,,7                                                   IBB34130
 IFNDX BCI     7,SYSLBN NOT TAPE (LB1 IS)-CANT $EXECUTE                 IBB34140
 IFNDB CLA     SYSPOS                                                   IBB34150
       TSX     RGTPO,4             IF SYSLBN IS NOT DISK THEN ----      IBB34160
       LDQ     MZE                 A (SYSPOS) = N OF SYSLBN             IBB34170
 IFND7 AXT     **,1                D (SYSPOS) = NUMBER OF FILES TO SKIP IBB34180
 IFND9 AXT     **,4                RETURN WITH TAPE POSITIONED          IBB34190
       TRA     1,4                 AND WITH S(MQ) = -                   IBB34200
       TTL     SYSTEM RETURN VIA SYSRET                                 IBB34210
*                    RETURN TO IBSUP VIA SYSRET                         IBB34220
       SPACE                                                            IBB34230
TPPS   CLA     SYSLB4+.            TEST FOR EXISTENCE                $6$IBB34240
       LAC     SYSLB4,1            DUPLICATE SYSTEM TAPE             $6$IBB34250
       STT     *+1                 FROM ASSEMBLED SYSLB4 ASSSIGNMENT    IBB34260
       PXA     0,**                                                     IBB34270
       TZE     TPPNM               NON-EXISTENT, EXIT                   IBB34280
       LDI     0,1                                                      IBB34290
       LFT     000100                                                   IBB34300
       TRA     TPPNM               IGNORE REQUEST IF EITHER OF          IBB34310
       LDI*    SYSLB1              THE PING PONG UNITS ARE DISK TYPE $6$IBB34320
       LFT     000100                                                   IBB34330
       TRA     TPPNM                                                    IBB34340
       AXT     30,4                ALL TESTS PASSED,                    IBB34350
       LNT     020000              REWIND SYSLB1                        IBB34360
       AXT     3,4                 HERE IF 7607                         IBB34370
       SXD     *+2,4               HERE IF 7909                         IBB34380
       TSX     NDATA,4                                                  IBB34390
       PZE     SYSLB1,,**                                            $6$IBB34400
       CAL     PTW                                                      IBB34410
       STP     SELX-2              NOP THE DENSITY SETTING INSTX        IBB34420
       STP     SELX-1                                                   IBB34430
       AXC     SYSLB1,2                                              $6$IBB34440
       TSX     INITUS,1            GO TO INITUS FOR SYSLB1              IBB34450
       ZAC                                                              IBB34460
       STP     SELX-2              RESTORE DENSITY SETTING INSTX        IBB34470
       STP     SELX-1                                                   IBB34480
       CLA     SYSLB4+.                                              $6$IBB34490
       TSX     IBVAL,4                                                  IBB34500
       STA     IBFLP                                                    IBB34510
       CLA     SYSLB1              TEST ASSEMBLED AGAINST NEW SYSLB1 $6$IBB34520
       ANA     IBADR               MASK OFF ADDRESS                     IBB34530
       SUB     IBFLP                                                    IBB34540
       STA     IBFLP               AND USE RESULTS  AS SWITCH FOR $JOB  IBB34550
       TSX     IBPNG,4                                                  IBB34560
       STL     PNGSW                                                    IBB34570
 TPPNM MOVLDR  SPOUT,SPTEND,SPTLD                                    $6$IBB34580
       CAL     SYSDMP                                                $6$IBB34600
       SLW     2                   SO THAT STR RESULTS IN CORE DUMP  $6$IBB34610
       LXA     SYSOU1,1                                              $6$IBB34620
       TXL     *+4,1,0             KILL SPOUT IF SYSOU1                 IBB34630
       LDI*    SYSOU1              IS NOT 729 OR HYPERTAPE.          $6$IBB34640
       LNT     000100                                                   IBB34650
       TRA     *+3                                                      IBB34660
       CLA     SPTLD+1                                               $6$IBB34670
       STO     SPOUT                                                 $6$IBB34680
       AXT     SYSTT,1             RESTORE SYSTEM NAME                  IBB34690
       CAL     SYSORG+SYSTT,1      TABLE TO                             IBB34700
       SLW     SYNEND,1            WORKING AREA                         IBB34710
       TIX     *-2,1,1             X                                    IBB34720
       AXT     SYSTT,1             MODIFY WORKING NAME                  IBB34730
       CAL     SYNEND+1,1          TABLE INDEX WORDS TO                 IBB34740
       ARS     15                  COMPLY WITH NORMAL                   IBB34750
       ANA     L(7)                OPERATION OF SYSTEM                  IBB34760
       STA     SYNEND+1,1          FROM THE EDITED FORMAT               IBB34770
       STT     SYNEND+1,1          X                                    IBB34780
       TIX     *-5,1,2             X                                    IBB34790
       EMTM                                                          $6$IBB34800
TPSTR  LDQ     SYSGET+.                                              $6$IBB34810
       CLA     SYSGET                                                   IBB34820
       STQ     SYSGET                                                   IBB34830
       STO     TMPGET              NOW TAKE A LOOK AT SYSGET...         IBB34840
       CAS     SYSGET+.                                              $6$IBB34850
       TRA     *+2                                                      IBB34860
       TRA     IBSYS               IF IBSYST GO TO IBSYS                IBB34870
       CAS     IBSBSR                                                   IBB34880
       TRA     *+2                                                      IBB34890
       TRA     TPP5                IF IBSBSR GO TO TPP5                 IBB34900
       CAS     IBSNXT                                                   IBB34910
       TRA     *+2                                                      IBB34920
       TRA     IBSYS               IF IBSNXT GO TO IBSYS                IBB34930
       CAS     IBSXEC                                                   IBB34940
       TRA     *+2                                                      IBB34950
       TRA     IBSYS               IF IBSXEC GO TO IBSYS                IBB34960
       CAS     STCRD                                                    IBB34970
       TRA     *+2                                                      IBB34980
       TRA     TPP1                IF $STOP GO TO TPP1                  IBB34990
       LDQ     ALBLK                                                    IBB35000
       CAL     TMPGET                                                   IBB35010
       LGR     18                  IF NONE OF THE ABOVE ASSUME          IBB35020
       STQ     ICARD+3             SYSNAM IS IN SYSGET.                 IBB35030
       LDQ     ESS                                                      IBB35040
       STQ     ICARD+1             SIMULATE $EXECUTE SYSNAM             IBB35050
       LDQ     EXCRD                                                    IBB35060
       TRA     TPP8                                                     IBB35070
 TPP1  STO     ICARD               HERE IF SYSGET=$STOP                 IBB35080
       AXT     13,1                                                  $6$IBB35090
       LDQ     ALBLK                                                    IBB35100
       STQ     ICARD+14,1                                            $6$IBB35110
       TIX     *-1,1,1                                                  IBB35120
       TRA     IBT1                                                     IBB35130
 TPP5  LXA     SYSJOB,2            HERE IF SYSGET = IBSBSR              IBB35140
       TXI     *+1,2,-1            A $JOB CARD HAS BEEN READ            IBB35150
       NZT     IBSINP                                                $6$IBB35160
       TRA     TPP6                                                     IBB35170
       SXA     SYSJOB,2                                                 IBB35180
       SWT     1                                                        IBB35190
       TRA     TPP6                                                     IBB35200
       STZ     IBSINP                                                $6$IBB35210
 TPP6  NZT     IBSAV                IF READ FROM THE CARD            $6$IBB35220
       TRA     TPP7                READER, DUMMY UP A $JOB              IBB35230
       LDI*    SYSIN1              CARD AND PROCEED AS IF            $6$IBB35240
       LFT     000100              IBSYS HAD READ IT IN.                IBB35250
       TRA     TPP7                                                     IBB35260
 ENTTP AXT     5,1                 IF READ FROM 729 OR                  IBB35270
       LFT     020000              HYPERTAPE, BACK SPACE                IBB35280
       AXT     34,1                OVER IT AND CONTINUE.                IBB35290
       SXD     *+2,1                                                    IBB35300
       TSX     NDATA,4                                                  IBB35310
       PZE     SYSIN1,,**                                            $6$IBB35320
       TRA     IBSYS                                                    IBB35330
 TPP7  LDQ     ALBLK                                                    IBB35340
       STQ     ICARD+1                                                  IBB35350
       CAL     XXESS                                                    IBB35360
       LGR     18                                                       IBB35370
       STQ     ICARD+3                                                  IBB35380
       LDQ     JBCRD                                                    IBB35390
 TPP8  STQ     ICARD                                                    IBB35400
       ORA     HOBLK                                                    IBB35410
       SLW     ICARD+2                                                  IBB35420
       AXT     10,1                                                  $6$IBB35430
       LDQ     ALBLK                                                    IBB35440
       STQ     ICARD+14,1                                            $6$IBB35450
       TIX     *-1,1,1                                                  IBB35460
       TRA     IBT1                                                     IBB35470
       SPACE                                                            IBB35480
TMPGET PZE     **                                                       IBB35490
IBSBSR BCI     1,IBSBSR                                                 IBB35500
IBSNXT BCI     1,IBSNXT                                                 IBB35510
IBSXEC BCI     1,IBSXEC                                                 IBB35520
 ESS   BCI     1,TE                                                     IBB35530
 XXESS BCI     1,XXXXXX                                                 IBB35540
       TTL     IBSUP GENERAL TAPE POSITIONER                            IBB35550
*            GENERAL TAPE POSITIONER ROUTINE BY FILE NUMBER             IBB35560
       SPACE   1                                                        IBB35570
*      TSX     RGTPO,4             IR2=-L(INDIRECT REF UCW), AC DEC=FILEIBB35580
*      RETURN                       IR1 DESTROYED                       IBB35590
       SPACE   1                                                        IBB35600
 RGTPO SXA     RGT2+2,4                                                 IBB35610
       STD     RGT3                STORE DESIRED TAPE POSITION          IBB35620
       TSX     INITUS,1            INITIALIZE THAT SYS TAPE USEAGE      IBB35630
       LDI*    0,2                                                      IBB35640
       CLA     RGT3                                                     IBB35650
       TNZ     RGT1                                                     IBB35660
       AXT     30,4                IF NUMBER OF FILES TO                IBB35670
       LNT     020000              SKIP = 0, THEN REWIND THE            IBB35680
       AXT     3,4                 TAPE ANE EXIT                        IBB35690
       SXD     *+2,4                                                    IBB35700
       TSX     NDSEL,4                                                  IBB35710
       PZE     0,2,**                                                   IBB35720
       CLA     0,2                                                      IBB35730
       PAC     0,1                                                      IBB35740
       TRA     RGT2                                                     IBB35750
RGT1   CLA     0,2                 COMPARE DESIRED                      IBB35760
       PAC     0,1                 TAPE POSITION                        IBB35770
       CLA     2,1                 WITH ACTUAL POSITION                 IBB35780
       ANA     IBABP                                                    IBB35790
       CAS     RGT3                                                     IBB35800
       TRA     *+3                 MOVE TAPE BACKWARD                   IBB35810
       TRA     RGT2                POSITION IS CORRECT                  IBB35820
       TRA     RGT4                MOVE TAPE FORWARD                    IBB35830
       AXT     35,4                                                     IBB35840
       LNT     020000                                                   IBB35850
       AXT     6,4                                                      IBB35860
       SXD     *+2,4                                                    IBB35870
       TSX     NDSEL,4             BSF                                  IBB35880
       PZE     0,2,**              AND CHECK                            IBB35890
       TRA     RGT1+2              AGAIN                                IBB35900
 RGT2  ZET     1,1                                                      IBB35910
       TRA     *-1                                                      IBB35920
       AXT     **,4                                                     IBB35930
       TRA     1,4                 EXIT                                 IBB35940
       SPACE   1                                                        IBB35950
*                        DESIRED TAPE POSITION                          IBB35960
RGT3   PZE     0,,**                                                    IBB35970
       SPACE   1                                                        IBB35980
*                   MOVE FORWARD PAST NEXT EOF MARK                     IBB35990
RGT4   ZET     1,1                 WAIT TILL                            IBB36000
       TRA     *-1                 UNIT DORMANT                         IBB36010
       LNT     020000                                                   IBB36020
       TRA     *+4                                                      IBB36030
       TSX     NDSEL,4             HERE TO HSKF                         IBB36040
       PZE     0,2,37                                                   IBB36050
       TRA     RGT1                                                     IBB36060
       AXT     RGT5,4              SET WAIT                             IBB36070
       SXA     RGT5,4              TRA *                                IBB36080
       CAL     RGT6                ENTER                                IBB36090
       SLW     1,1                 SELECT                               IBB36100
       TSX     ACTV,4                                                   IBB36110
       MZE     0,2                                                      IBB36120
RGT5   TRA     *                   WAIT TILL DONE                       IBB36130
*                  SELECT WORD FOR FORWARD SPACE FILE                   IBB36140
RGT6   PTW     *+1,,RGT7           DISABLE REDUN. MESSAGE               IBB36150
       IORTN   **,,0                                                    IBB36160
       SPACE                                                            IBB36170
*              SELECT ROUTINE FSF - (FORWARD SPACE FILE)                IBB36180
RGT7   PAC     0,2                 -L(UCW) TO IR2                       IBB36190
       TMI     RGT8                SEL (-) BRANCH                       IBB36200
       STZ     RCTX,1              SET NO REDUN. CHECK                  IBB36210
       CLA     1,2                 SET L(IORT)                          IBB36220
       STA     RCHX,1              TO RCHX                              IBB36230
       CLA     0,2                 FORM                                 IBB36240
       ARS     18                  BINARY                               IBB36250
       ORA     L(16)               SELECT                               IBB36260
       STA     *+1                                                      IBB36270
       RDS     **                  RDS                                  IBB36280
       XEC     RCHX,1              RCHX                                 IBB36290
       TRA     1,4                 BACK TO IOEX                         IBB36300
RGT8   CLA     2,2                 COMPARE TP POSITION                  IBB36310
       LAS     RGT3                WITH DESIRED                         IBB36320
       TRA     *+3                 GOT PAST                             IBB36330
       TRA     *+2                 EQUAL                                IBB36340
       TRA     1,4                 PROCEED FORWARD                      IBB36350
       STZ     1,2                 CLEAR ACTIVITY                       IBB36360
       AXT     RGT1,2              SETUP WAIT                           IBB36370
       SXA     RGT5,2              PROCEED                              IBB36380
       TRA     1,4                 AND BACK TO IOEX                     IBB36390
       TTL     PROUT / PAUSE CONTROL                                    IBB36400
*                            PROUT AND PAUSE CONTROL REOUTINES          IBB36410
       SPACE                                                            IBB36420
 PRCRD ENB     L(0)                ENTER HERE TO WRITE ON-LINE          IBB36430
       STZ     PRCSW               ONLY IF CANT WRITE OFF-LINE OR       IBB36440
       TRA     PROPR+2             IN LIST MODE OR READ FROM SYSCRD.    IBB36450
 PROPR ENB     L(0)                ENTER HERE TO WRITE ON-LINE AND,     IBB36460
       STL     PRCSW               IF POSSIBLE, OFF-LINE.P              IBB36470
       PXD     ,0                                                       IBB36480
       ZET     REWOU1                                                   IBB36490
       TRA     PRCHM                                                    IBB36500
       CAL     *                                                        IBB36510
       ZET     PRCSW                                                    IBB36520
       TRA     PRCHM                                                    IBB36530
       NZT     LSTSW                                                    IBB36540
       NZT     IBSINP                                                $6$IBB36550
       TXI     PRCHM,0,0                                                IBB36560
       ORA     *-1                                                      IBB36570
 PRCHM STP     1,4                                                      IBB36580
       TTR     PROUT                                                    IBB36590
       SPACE                                                            IBB36600
 IBPAS ENB     L(0)                ENTER HERE TO WRITE PAUSE            IBB36610
       STZ     PRCSW               ON-LINE AND IF POSSIBLE OFF-LINE.    IBB36620
       TRA     IBPASP+2                                                 IBB36630
IBPASP ENB     L(0)                ENETER HERE TO WRITE PAUSE           IBB36640
       STL     PRCSW               ON-LINE ONLY.                        IBB36650
       SXA     PASX4,4                                                  IBB36660
       STL     ENBSW                                                    IBB36670
       ZET     PRCSW                                                    IBB36680
       TRA     PASHM                                                    IBB36690
       ZET     REWOU1                                                   IBB36700
       TRA     PASHM                                                    IBB36710
       CAL     *                                                        IBB36720
       STP     PWSP1                                                    IBB36730
       STP     PWSP2                                                    IBB36740
       TSX     PAUSE,4                                                  IBB36750
       PXD     ,0                                                       IBB36760
       STP     PWSP1                                                    IBB36770
       STP     PWSP2                                                    IBB36780
       TRA     *+2                                                      IBB36790
 PASHM TSX     PAUSE,4                                                  IBB36800
       SXA     ENBSW,0                                                  IBB36810
 PASX4 AXT     **,4                                                     IBB36820
       ENB*    TRAPX                                                    IBB36830
       TRA     1,4                                                      IBB36840
       SPACE                                                            IBB36850
 PRCSW PZE     **                                                       IBB36860
       TTL     SPOUT                                                    IBB36870
*              OFF-LINE MESSAGE PRINTING ROUTINE                        IBB36880
       SPACE   2                                                        IBB36890
*                                  CALLING SEQUENCE                     IBB36900
*      TSX     PROUT,4                                                  IBB36910
*      MZE     N                                                        IBB36920
       SPACE   2                                                        IBB36930
* THE FOLLOWING PARAMETER MUST BE CHANGED IF SPOUT IS                $6$IBB36931
*  MODIFIED IN SUCH A WAY AS TO CHANGE ITS LENGTH                    $6$IBB36932
       REM                                                           $6$IBB36933
SPARE  BOOL    310                 LENGTH OF SPOUT                   $6$IBB36934
       REM                                                           $6$IBB36935
SPTLD  ORG     *                                                     $6$IBB36936
SPOUT  LOC     SYSEND-SPARE+1                                        $6$IBB36937
       ZET     TRPSW                                                 $6$IBB36940
       TRA     PRT7                                                     IBB36950
       SXA     SPXR4,4                                               $6$IBB36960
       SXA     SPXR2,2                                               $6$IBB36970
       SXA     SPX1,1                                                $6$IBB36980
       CLA     ENBSW                                                    IBB36990
       STO     SPESW                                                 $6$IBB37000
       STZ     ENBSW                                                    IBB37010
       LAC     SYSOU1,2                                              $6$IBB37020
       TXL     PRT7,2,0            NO SYSOU1                         $6$IBB37025
       NZT     1,2                                                      IBB37030
       TRA     SPT1                                                  $6$IBB37040
       TSX     ACTIV,4                                                  IBB37050
       MZE     SYSOU1                                                $6$IBB37060
       ZET     1,2                                                      IBB37070
       TRA     *-1                                                   $6$IBB37080
SPT1   CLA     SPM3                                                  $6$IBB37090
       STO     1,2                                                      IBB37100
       TSX     ACTIV,4                                                  IBB37110
       MZE     SYSOU1                                                $6$IBB37120
       ZET     1,2                                                      IBB37130
       TRA     *-1                                                   $6$IBB37140
       ENB     L(0)                                                     IBB37150
       CLA     SPESW                                                 $6$IBB37160
       STO     ENBSW                                                    IBB37170
SPXR4  AXT     **,4                                                     IBB37180
SPXR2  AXT     **,2                                                     IBB37190
       REM     COMPUTE CALLING SEQUENCE END                          $6$IBB37200
       PXA     2,4                                                   $6$IBB37210
       SBM     *-1                                                   $6$IBB37220
       ACL     1,4                 GET L(TSX) +2+N+PREFIX            $6$IBB37230
       STA     PRTEX                                                    IBB37240
       ALS     2                                                        IBB37250
       PBT                                                              IBB37260
SPT1A  TXI     PRT7,,15                                                 IBB37270
SPT1B  TXI     PRTAX+1,,8576                                            IBB37280
       EJECT                                                            IBB37290
*                    SPOUT SELECT ROUTINE                               IBB37300
       SPACE                                                            IBB37310
 SPSEL SXA     SPSX4,4                                               $6$IBB37320
       TMI     SPSLM                                                 $6$IBB37330
       LDI*    SYSOU1                                                $6$IBB37340
       ZET     URRX,1              IN WRITE RECOVERY...                 IBB37350
       TRA     SPWRS-1                                               $6$IBB37360
       ZET     SPTSW               HERE IF NO. FIRST TIME HERE...    $6$IBB37370
       TRA     SPSX2                                                 $6$IBB37380
       LXA     SPXR4,2             HERE IF YES-INITIALIZE            $6$IBB37390
       CLA     1,2                                                      IBB37400
       STA     SPTSW               SET SPTSW=ENTRY COUNT             $6$IBB37410
 SPS1  PIA     SPIOC                                                 $6$IBB37420
       ARS     18                  NO. SYSOU1 IS 729 TAPE               IBB37430
       STA     SPWRS                                                 $6$IBB37440
SPS2   ARS     5                   SET UP SMS FOR HT                    IBB37450
       ANA     L(1)                                                     IBB37460
       ORA     SPS3A                                                 $6$IBB37470
 SPS3  STA     SPHT2               SET UP THE SMS                    $6$IBB37480
SPS3A  PIA     22                                                       IBB37490
       ANA     SPT1A                                                 $6$IBB37500
       ORA     SPT1B                                                 $6$IBB37510
       STD     SPHT1               SET H.T. UNIT SELECT              $6$IBB37520
       CLA     SPS1                                                  $6$IBB37530
       LFT     020000                                                   IBB37540
       CLA     SPS3                                                  $6$IBB37550
 SPS4  STO     SPWRS+1             SET UP RCHX ADDRESS               $6$IBB37560
       LDQ     RCHX,1                                                   IBB37570
       SLQ     SPWRS+1             SET UP RCHX OP CODE               $6$IBB37580
       TXI     *+2,2,-2                                              $6$IBB37590
 SPSX2 AXT     **,2                                                     IBB37600
       AXT     14,4                NOW SET UP I/O COMMANDS              IBB37610
       ZET     SPEOR                                                 $6$IBB37620
       TRA     SPS7                                                  $6$IBB37630
 SPS5  CLA     0,2                                                      IBB37640
       ANA     MSK1                                                     IBB37650
       STD     SPCOM+14,4                                            $6$IBB37660
       SXA     SPS1X,1                                               $6$IBB37670
       SXA     SPS2X,2                                               $6$IBB37680
       LXA     SPXR2,2                                               $6$IBB37690
SPX1   AXT     **,1                                                     IBB37700
       STT     *+1                                                   $6$IBB37710
       PXA     ,**                                                      IBB37720
SPS1X  AXT     **,1                                                     IBB37730
SPS2X  AXT     **,2                                                     IBB37740
       SBM     0,2                                                      IBB37750
       STA     SPCOM+14,4                                            $6$IBB37760
       CAL     *                                                     $6$IBB37770
       STP     SPCOM+14,4          SET COMMAND TO IOCP (CPYP)        $6$IBB37780
       CAL     0,2                                                      IBB37790
       ANA     SPCN4                                                 $6$IBB37800
       PBT                         MZE ENTRY...                         IBB37810
       TRA     SPS5A                                                 $6$IBB37820
       TXL     SPS6,4,1                                              $6$IBB37830
       CLA     SPTSW                                                 $6$IBB37840
       SUB     L(1)                                                     IBB37850
       TZE     SPS6                                                  $6$IBB37860
       STA     SPTSW                                                 $6$IBB37870
       TIX     *+1,4,1                                               $6$IBB37880
       TXI     SPS5,2,-1           HERE IF YES. GET NEXT ENTRY       $6$IBB37890
 SPS5A TZE     SPS6                HERE IF PZE. SENSE...             $6$IBB37900
       ARS     3                   HERE IF YES                          IBB37910
       ANA     SPCN6                                                 $6$IBB37920
       TNZ     *+2                 IS IT AN EJECT...                 $6$IBB37930
       ORA     SPCN8               NO - ITS A DOUBLE SPACE           $6$IBB37940
       ORA     SPCN7               YES                               $6$IBB37950
       SLW     SPRCM                                                 $6$IBB37960
       CAL     SPCTL                                                 $6$IBB37970
       SLW     SPCOM+15,4          SET UP IOCT RECORD MARK           $6$IBB37980
       TXI     SPS7,4,-1                                             $6$IBB37990
 SPS6  CAL     SPCTL               IF NO SENSE, SET LAST I/O         $6$IBB38000
       STP     SPCOM+14,4          TO IOCT (CPYD)                    $6$IBB38010
SPS7   CAL     SYSCYD+1            ADD ON A TCH SYSTWT FOR H.T.         IBB38020
       SLW     SPCOM+15,4          JUST IN CASE ITS HYPER            $6$IBB38030
       TXI     *+1,2,-1                                              $6$IBB38040
       SXA     SPSX2,2             SAVE XR2 FOR NEXT (SEL+)          $6$IBB38050
       LNT     020000                                                   IBB38060
 SPWRS WRS     **                                                       IBB38070
       RCHA    **                                                       IBB38080
 SPSX4 AXT     **,4                                                     IBB38090
       TRA     1,4                                                      IBB38100
       SPACE                                                            IBB38110
*                             SELECT MINUS                              IBB38120
       SPACE                                                            IBB38130
 SPSLM LFT     000010              TEST FOR 7340 DATA CHECK             IBB38140
       TRA     3,4                 ON, RETRY                            IBB38150
       LNT     000100              TEST FOR INT. CHK.                   IBB38160
       TRA     SPM1                OFF, CARRY ON                     $6$IBB38170
       CLA     L(1)                ON, GO BACK FOR ANOTHER              IBB38180
       STA     URRX,1              TRY                                  IBB38190
       TRA     END13                                                    IBB38200
 SPM1  LAC     SYSOU1,4                                              $6$IBB38210
SPM1A  CLA     SPTSW                                                 $6$IBB38220
       SUB     L(1)                                                     IBB38230
       STO     SPTSW                                                 $6$IBB38240
       TNZ     END13               KEEP CONTROL UNTIL SPTSW=0           IBB38250
       LDI*    SYSOU1              TEST UCB1 FOR EOT                 $6$IBB38260
       RFT     400000              FLAG (EWA FLAG)                      IBB38270
       TRA     SPM2                ON , WRITE TRAILER                $6$IBB38280
       STZ     1,4                 OFF, ZERO OUT UCB 2                  IBB38290
       TRA     SPSX4               AND EXIT.                         $6$IBB38300
SPM2   AXT     33,4                                                     IBB38310
       LNT     020000              WRITE EOF, TRAILER, EOF              IBB38320
       AXT     7,4                 ON SYSOU1                            IBB38330
       SXD     *+2,4                                                 $6$IBB38340
       TSX     NDATA,4                                                  IBB38350
       PZE     SYSOU1,,**                                            $6$IBB38360
       NOP                                                              IBB38370
       CLA     SPTWD               MESSAGE = TRAILER                 $6$IBB38380
       STO     SPCOM                                                 $6$IBB38390
       AXT     1,4                 NOP IOCP IN COMMAND                  IBB38400
       SXA     SPTSW,4             SEQUENCE AND SET SPTSW            $6$IBB38410
       ZET     SPEOR                                                 $6$IBB38420
       TXI     SPM2A,4,1           TRANSFER IF SECOND TIME           $6$IBB38430
       SXD     SPIOC,0             TO ONE AND EOR SWITCH             $6$IBB38440
       STL     SPEOR               NON-ZERO                          $6$IBB38450
       TRA     END13               GO WRITE TRAILER ON SYSOU1           IBB38460
SPM2A  SXD     SPIOC,4             RESET IOCP IN COMMAND             $6$IBB38470
       STZ     SPEOR               SEQUENCE AND EOR SWITCH           $6$IBB38480
       TSX     PROUT,4             AND TELL OPERATOR TO                 IBB38490
SPM3   MZE     1,,SPSEL            MOUNT NEW SYSOU1                  $6$IBB38500
SPTWD  PTH     EORMSG,,4                                             $6$IBB38510
       TSX     PAUSE,4                                                  IBB38520
       LAC     SYSOU1,4                                              $6$IBB38530
       STZ     2,4                 ZERO OUT FILE + REC. CNT             IBB38540
       RIS     4TAG                RESET EOT FLAG IN UCB1               IBB38550
       STI     0,4                                                      IBB38560
       TRA     SPM1A                                                 $6$IBB38570
       SPACE   3                                                        IBB38580
 SPTSW PZE     **                                                       IBB38590
SPEOR  PZE                                                              IBB38600
 SPCN4 MZE     ,,2560                                                   IBB38610
 SPCN6 PZE     ,,64                                                     IBB38620
 SPCN7 OCT     720060606060                                             IBB38630
 SPCN8 PZE     ,,3072                                                   IBB38640
 SPHT1 OCT     120600120112                                             IBB38650
 SPCTL IOCT    SPRCM,,1            (CPYD FOR H.T.)                   $6$IBB38660
SPFWD  BCI     2,                                                       IBB38670
EORMSG BCI     4,1EOR  MOUNT NEW SYSOU1..                               IBB38680
       BSS     6                   SPOUT PATCH AREA                     IBB38690
 SPHT2 SMS     **                                                       IBB38700
       CTLW    SPHT1                                                 $6$IBB38710
 SPIOC IOCP    SPFWD,,2            MESSAGES S/B AT LEAST 3 WORDS     $6$IBB38720
 SPCOM PZE     1                   SPCOM MUST = SPIOC+1                 IBB38730
       DUP     1,13                   REST OF SPCOM                     IBB38740
       PZE                                                              IBB38750
 SPXTR BSS     3                                                        IBB38760
 SPESW PZE     **                  THE 19 CELLS FROM SPCOM THRU SPRCM   IBB38770
 SPRCM PZE     **                  IS SNAP DUMP SNEAK OFF AREA.         IBB38780
SPTEND BSS     0                                                        IBB38790
       ORG     *+SPTLD-SPOUT                                         $6$IBB38791
       TTL     CEMON                                                    IBB38800
*              GENITD THRU GENITD+49 COMPRISES THE DIAGNOSTIC ROUTINE   IBB38810
*              FOR THE CEMON AREA (SYSORG-50 THRU SYSORG-1). GENITD IS  IBB38820
*              PLACED (FRESH) IN THE CEMON AREA AT COLD START OR        IBB38830
*              AT $RESTORE TIME BY IBSUP.                               IBB38840
       SPACE   2                                                        IBB39020
GENITD BSS     0                   50 WORD INTERCEPT DUMP ROUTINE       IBB39030
CEMBGN LOC     SYSORG-50                                             $6$IBB39031
SECT   BSFA    8                   POSITION DUMP TAPE                $6$IBB39040
LOCAT  TRA     DCT-1               GO SAVE PANEL                     $6$IBB39050
INSTR  TRA     SYSORG-50           TRA 3636 OCT                      $6$IBB39060
IOWD   DCT                         DIVIDE CHECK                      $6$IBB39070
DCT    STZ     DCT                 NO                                $6$IBB39080
IOT    IOT                         I/O CHECK                         $6$IBB39090
ACCG   STZ     IOT                 NO                                $6$IBB39100
MQG    STO     ACCG                SAVE ACC                          $6$IBB39110
PRFIX  ARS     35                                                    $6$IBB39120
OVER   STO     PRFIX               SAVE PREFIX                       $6$IBB39130
       TNO     OVER+3              OVFLW ON                             IBB39140
       STZ     OVER                YES                                  IBB39150
IR4    STQ     MQG                 SAVE MQ                           $6$IBB39160
       SXA     IR4-2,1             SAVE                                 IBB39170
       SXA     IR4-1,2             INDEX                                IBB39180
       SXA     IR4,4               REGISTERS                            IBB39190
ON4    AXT     4,4                                                   $6$IBB39200
       SLT     5,4                 SENSE LITE ON                        IBB39210
       TRA     ON4+4               NO, LEAVE NON-ZERO                   IBB39220
       STZ     ON4+1,4             YES                                  IBB39230
       TIX     ON4+1,4,1                                                IBB39240
       AXT     6,4                                                      IBB39250
SWT6   SWT     7,4                 SSW DOWN                          $6$IBB39260
INDIA  STZ     SWT6+1,4            NO                                $6$IBB39270
CKUM   TIX     SWT6,4,1            YES, LEAVE NON ZERO               $6$IBB39280
       STI     INDIA               SAVE INDICATORS                      IBB39290
       ZAC                                                              IBB39300
       AXC     100,4               GENERATE                             IBB39310
       ACL     0,4                                                   $6$IBB39320
       TIX     CKUM+4,4,1          100-32767                            IBB39330
       SLW     CKUM                                                     IBB39340
       CLA     IOLSTA+2            SET I/O WORD                         IBB39350
       STO     IOWD                TO DUMP COMMAND                      IBB39360
       ENK                                                              IBB39370
       SLQ     SECT                SET INSTRUCTION AND LOCATION         IBB39380
       STQ     LOCAT               FROM KEYS                            IBB39390
       WTBA    8                                                        IBB39400
       RCHA    IOLSTA              WRITE INTERCEPT DUMP                 IBB39410
       WEFA    8                   IN BINARY ON A-8                     IBB39420
       HTR     SYSRET              DUMP COMPLETED                       IBB39430
IOLSTA IORP    1,,100                                                $6$IBB39440
       IOCP    SECT,,25                                                 IBB39450
       IOCD    1,,-1                                                    IBB39460
       REM                                                           $6$IBB39470
       SPACE                                                            IBB39480
       REM                         PATCH SPACE HERE TO CEMEND        $6$IBB39490
CEMEND BES     SYSORG-*                                              $6$IBB39500
       ORG     *+GENITD-CEMBGN     RESET LOC                         $6$IBB39510
       TTL     HOLLERITH TO BCD CONVERSION                              IBB39520
*               HOLLERITH TO BCD CONVERSION 1025 CYCLES                 IBB39530
*                        FOR ON-LINE CARD READ                          IBB39540
       SPACE   1                                                        IBB39550
*      TSX     RHBCD,4             24 WORDS IN IBMAG                    IBB39560
*      RETURN                       12 WORDS IN CARD                    IBB39570
       SPACE   1                                                        IBB39580
RHBCD  SXA     RHB3,4              SAVE IR4                             IBB39590
       AXT     12,4                CLEAR                                IBB39600
       STZ     CARD+12,4           CARD                                 IBB39610
       TIX     *-1,4,1                                                  IBB39620
       AXT     12,2                SET 12 ROWS                          IBB39630
       AXT     24,4                SET 24 WORDS BIN                     IBB39640
RHB1   AXT     6,1                 1ST 6 BCD                            IBB39650
       LDQ     IBMAG+24,4          9L,8L,7L,...ETC                      IBB39660
       PXA     0,0                                                      IBB39670
       CAQ     RCVT2,,1            MASK FOR PUNCHED COLS                IBB39680
       ANA     RCVT1+12,2          MASK OUT ROW VALUE                   IBB39690
       ORS     CARD+6,1            OR ROW TO CARD                       IBB39700
       TIX     *-4,1,1             6 WORDS BCD                          IBB39710
       LDQ     IBMAG+25,4          9R,8R,7R,...ETC                      IBB39720
       AXT     6,1                 2ND 6 BCD                            IBB39730
       PXA     0,0                                                      IBB39740
       CAQ     RCVT2,,1            MASK FOR PUNCHED COLS                IBB39750
       ANA     RCVT1+12,2          MASK OUT ROW VALUE                   IBB39760
       ORS     CARD+12,1           OR ROW TO CARD                       IBB39770
       TIX     *-4,1,1             6 WORDS BCD                          IBB39780
       TXI     *+1,4,-2            MOVE TO NEXT ROW                     IBB39790
       TIX     RHB1,2,1            DO 12 ROWS                           IBB39800
       AXT     12,4                REPLACE                              IBB39810
       LDQ     CARD+12,4           00 BY 60                             IBB39820
       CRQ     RCVT3,,6            60 BY 00                             IBB39830
       STQ     CARD+12,4           AND GIVE ILLEGALS                    IBB39840
       TIX     *-3,4,1             A VALUE 54 (*)                       IBB39850
       LDQ     ALBLK                                                 $6$IBB39851
       STQ     CARD+12                                               $6$IBB39852
       STQ     CARD+13                                               $6$IBB39853
RHB3   AXT     **,4                RESTORE IR4                          IBB39860
       TRA     1,4                 EXIT                                 IBB39870
       SPACE                                                            IBB39880
*            MASKS FOR 9,8,7,.... ROWS IN HOLL TO BCD CONV.             IBB39890
       SPACE   1                                                        IBB39900
RCVT1  BCI     9,999999888888777777666666555555444444333333222222111111 IBB39910
       BCI     3,      ------++++++                                     IBB39920
       SPACE                                                            IBB39930
*              CONVERT TABLE FOR HOLLERITH TO BCD VIA CAQ               IBB39940
       SPACE   1                                                        IBB39950
RCVT2  OCT     0                                                        IBB39960
       OCT     0077                                                     IBB39970
       OCT     7700                                                     IBB39980
       OCT     7777                                                     IBB39990
       OCT     770000                                                   IBB40000
       OCT     770077                                                   IBB40010
       OCT     777700                                                   IBB40020
       OCT     777777                                                   IBB40030
       OCT     77000000                                                 IBB40040
       OCT     77000077                                                 IBB40050
       OCT     77007700                                                 IBB40060
       OCT     77007777                                                 IBB40070
       OCT     77770000                                                 IBB40080
       OCT     77770077                                                 IBB40090
       OCT     77777700                                                 IBB40100
       OCT     77777777                                                 IBB40110
       OCT     7700000000                                               IBB40120
       OCT     7700000077                                               IBB40130
       OCT     7700007700                                               IBB40140
       OCT     7700007777                                               IBB40150
       OCT     7700770000                                               IBB40160
       OCT     7700770077                                               IBB40170
       OCT     7700777700                                               IBB40180
       OCT     7700777777                                               IBB40190
       OCT     7777000000                                               IBB40200
       OCT     7777000077                                               IBB40210
       OCT     7777007700                                               IBB40220
       OCT     7777007777                                               IBB40230
       OCT     7777770000                                               IBB40240
       OCT     7777770077                                               IBB40250
       OCT     7777777700                                               IBB40260
       OCT     7777777777                                               IBB40270
       OCT     770000000000                                             IBB40280
       OCT     770000000077                                             IBB40290
       OCT     770000007700                                             IBB40300
       OCT     770000007777                                             IBB40310
       OCT     770000770000                                             IBB40320
       OCT     770000770077                                             IBB40330
       OCT     770000777700                                             IBB40340
       OCT     770000777777                                             IBB40350
       OCT     770077000000                                             IBB40360
       OCT     770077000077                                             IBB40370
       OCT     770077007700                                             IBB40380
       OCT     770077007777                                             IBB40390
       OCT     770077770000                                             IBB40400
       OCT     770077770077                                             IBB40410
       OCT     770077777700                                             IBB40420
       OCT     770077777777                                             IBB40430
       OCT     777700000000                                             IBB40440
       OCT     777700000077                                             IBB40450
       OCT     777700007700                                             IBB40460
       OCT     777700007777                                             IBB40470
       OCT     777700770000                                             IBB40480
       OCT     777700770077                                             IBB40490
       OCT     777700777700                                             IBB40500
       OCT     777700777777                                             IBB40510
       OCT     777777000000                                             IBB40520
       OCT     777777000077                                             IBB40530
       OCT     777777007700                                             IBB40540
       OCT     777777007777                                             IBB40550
       OCT     777777770000                                             IBB40560
       OCT     777777770077                                             IBB40570
       OCT     777777777700                                             IBB40580
       OCT     777777777777                                             IBB40590
       SPACE   1                                                        IBB40600
*  BCD TO BCD WITH ZERO AND BLANK ALTERATION AND * REPLACES ILLEGALS    IBB40610
RCVT3  VFD     O6/60,15/0,15/RCVT3 00 00 TO BLANK                       IBB40620
       VFD     O6/01,15/0,15/RCVT3 01 1 TO 1                            IBB40630
       VFD     O6/02,15/0,15/RCVT3 02 2 TO 2                            IBB40640
       VFD     O6/03,15/0,15/RCVT3 03 3 TO 3                            IBB40650
       VFD     O6/04,15/0,15/RCVT3 04 4 TO 4                            IBB40660
       VFD     O6/05,15/0,15/RCVT3 05 5 TO 5                            IBB40670
       VFD     O6/06,15/0,15/RCVT3 06 6 TO 6                            IBB40680
       VFD     O6/07,15/0,15/RCVT3 07 7 TO 7                            IBB40690
       VFD     O6/10,15/0,15/RCVT3 10 8 TO 8                            IBB40700
       VFD     O6/11,15/0,15/RCVT3 11 9 TO 9                            IBB40710
       VFD     O6/00,15/0,15/RCVT3 12 0 TO 0                            IBB40720
       VFD     O6/13,15/0,15/RCVT3 13 = TO =                            IBB40730
       VFD     O6/14,15/0,15/RCVT3 14 - TO -                            IBB40740
       VFD     O6/54,15/0,15/RCVT3 15 15 TO *                           IBB40750
       VFD     O6/54,15/0,15/RCVT3 16 16 TO *                           IBB40760
       VFD     O6/54,15/0,15/RCVT3 17 17 TO *                           IBB40770
       VFD     O6/20,15/0,15/RCVT3 20 + TO +                            IBB40780
       VFD     O6/21,15/0,15/RCVT3 21 A TO A                            IBB40790
       VFD     O6/22,15/0,15/RCVT3 22 B TO B                            IBB40800
       VFD     O6/23,15/0,15/RCVT3 23 C TO C                            IBB40810
       VFD     O6/24,15/0,15/RCVT3 24 D TO D                            IBB40820
       VFD     O6/25,15/0,15/RCVT3 25 E TO E                            IBB40830
       VFD     O6/26,15/0,15/RCVT3 26 F TO F                            IBB40840
       VFD     O6/27,15/0,15/RCVT3 27 G TO G                            IBB40850
       VFD     O6/30,15/0,15/RCVT3 30 H TO H                            IBB40860
       VFD     O6/31,15/0,15/RCVT3 31 I TO I                            IBB40870
       VFD     O6/32,15/0,15/RCVT3 32 32 +0                             IBB40880
       VFD     O6/33,15/0,15/RCVT3 33 . .                               IBB40890
       VFD     O6/34,15/0,15/RCVT3 34 ) )                               IBB40900
       VFD     O6/54,15/0,15/RCVT3 35 35 *                              IBB40910
       VFD     O6/54,15/0,15/RCVT3 36 36 *                              IBB40920
       VFD     O6/54,15/0,15/RCVT3 37 37 *                              IBB40930
       VFD     O6/40,15/0,15/RCVT3 40 - -                               IBB40940
       VFD     O6/41,15/0,15/RCVT3 41 J J                               IBB40950
       VFD     O6/42,15/0,15/RCVT3 42 K K                               IBB40960
       VFD     O6/43,15/0,15/RCVT3 43 L L                               IBB40970
       VFD     O6/44,15/0,15/RCVT3 44 M M                               IBB40980
       VFD     O6/45,15/0,15/RCVT3 45 N N                               IBB40990
       VFD     O6/46,15/0,15/RCVT3 46 O O                               IBB41000
       VFD     O6/47,15/0,15/RCVT3 47 P P                               IBB41010
       VFD     O6/50,15/0,15/RCVT3 50 Q Q                               IBB41020
       VFD     O6/51,15/0,15/RCVT3 51 R R                               IBB41030
       VFD     O6/52,15/0,15/RCVT3 52 -0 -0                             IBB41040
       VFD     O6/53,15/0,15/RCVT3 53 $ $                               IBB41050
       VFD     O6/54,15/0,15/RCVT3 54 * *                               IBB41060
       VFD     O6/54,15/0,15/RCVT3 55 55 *                              IBB41070
       VFD     O6/54,15/0,15/RCVT3 56 56 *                              IBB41080
       VFD     O6/54,15/0,15/RCVT3 57 57 *                              IBB41090
       VFD     O6/00,15/0,15/RCVT3 60 BLANK TO ZERO                     IBB41100
       VFD     O6/61,15/0,15/RCVT3 61 / TO /                            IBB41110
       VFD     O6/62,15/0,15/RCVT3 62 S TO S                            IBB41120
       VFD     O6/63,15/0,15/RCVT3 63 T TO T                            IBB41130
       VFD     O6/64,15/0,15/RCVT3 64 U TO U                            IBB41140
       VFD     O6/65,15/0,15/RCVT3 65 V TO V                            IBB41150
       VFD     O6/66,15/0,15/RCVT3 66 W TO W                            IBB41160
       VFD     O6/67,15/0,15/RCVT3 67 X TO X                            IBB41170
       VFD     O6/70,15/0,15/RCVT3 70 Y TO Y                            IBB41180
       VFD     O6/71,15/0,15/RCVT3 71 Z TO Z                            IBB41190
       VFD     O6/72,15/0,15/RCVT3 72 RM TO RM                          IBB41200
       VFD     O6/73,15/0,15/RCVT3 73 , TO ,                            IBB41210
       VFD     O6/74,15/0,15/RCVT3 74 ( TO (                            IBB41220
       VFD     O6/54,15/0,15/RCVT3 75 75 TO *                           IBB41230
       VFD     O6/54,15/0,15/RCVT3 76 76 TO *                           IBB41240
       VFD     O6/54,15/0,15/RCVT3 77 77 TO *                           IBB41250
       REM                                                              IBB41260
       TTL     IBSUP / CONSTANTS FOR INITIALIZATION                     IBB41269
*                            CONSTANT POOL                              IBB41270
PON    PON     0                                                        IBB41280
PTW    PTW     0                                                        IBB41290
L(10D) PZE     ,,10                                                     IBB41300
L(15D) PZE     ,,15                                                     IBB41310
IBIDA  PZE     ,,48                                                     IBB41320
I301D  PZE     ,,193                                                    IBB41330
I377D  PZE     ,,255                                                    IBB41340
D8192  PZE     ,,8192                                                   IBB41350
L(2)   PZE     2                                                        IBB41360
L(4)   PZE     4                                                        IBB41370
 L(6)  PZE     6                                                        IBB41380
L(7)   PZE     7                                                        IBB41390
L(9)   PZE     9                                                        IBB41400
L(10)  PZE     10                                                       IBB41410
L(15)  PZE     15                                                       IBB41420
L(16)  PZE     16                                                       IBB41430
L(22)  PZE     22                                                       IBB41440
L(32)  PZE     32                                                       IBB41450
L(48)  PZE     48                                                       IBB41460
INMK1  OCT     000000017000                                             IBB41470
INMK2  OCT     777700777777                                             IBB41480
IBDCR  OCT     777777000000                                             IBB41490
 IBMK1 OCT     777777770000                                             IBB41500
IBABP  OCT     077777777777                                             IBB41510
IBALL  OCT     777777777777                                             IBB41520
RICA   OCT     076000000350                                             IBB41530
ALBLK  BCI     1,                                                       IBB41540
HOBLK  BCI     1,   000                                                 IBB41550
*                   SYSTEM UNITS EXTERNAL NAME TABLE                    IBB41560
SYUNAM BCI     1,SYSLB1                                                 IBB41570
       BCI     1,SYSLB2                                                 IBB41580
       BCI     1,SYSLB3                                                 IBB41590
       BCI     1,SYSLB4                                                 IBB41600
SYUCRD BCI     1,SYSCRD                                                 IBB41610
SYUPRT BCI     1,SYSPRT                                                 IBB41620
SYUPCH BCI     1,SYSPCH                                                 IBB41630
SYUOU1 BCI     1,SYSOU1                                                 IBB41640
       BCI     1,SYSOU2                                                 IBB41650
       BCI     1,SYSIN1                                                 IBB41660
       BCI     1,SYSIN2                                                 IBB41670
       BCI     1,SYSPP1                                                 IBB41680
       BCI     1,SYSPP2                                                 IBB41690
       BCI     1,SYSCK1                                                 IBB41700
       BCI     1,SYSCK2                                                 IBB41710
       BCI     1,SYSUT1                                                 IBB41720
       BCI     1,SYSUT2                                                 IBB41730
       BCI     1,SYSUT3                                                 IBB41740
       BCI     1,SYSUT4                                                 IBB41750
       BCI     1,SYSUT5                                              $6$IBB41751
       BCI     1,SYSUT6                                              $6$IBB41752
       BCI     1,SYSUT7                                              $6$IBB41753
       BCI     1,SYSUT8                                              $6$IBB41754
       BCI     1,SYSUT9                                              $6$IBB41755
HA2TBL BCI     1,0BM000            SYSLB1 HA2                        $6$IBB41756
       BCI     1,0BM000            SYSLB2 HA2                        $6$IBB41757
       BCI     1,0BM000            SYSLB3 HA2                        $6$IBB41758
       BCI     1,0BM000            SYSLB4 HA2                        $6$IBB41759
       PZE                         SYSCRD HA2                        $6$IBB4175A
       PZE                         SYSPRT HA2                        $6$IBB4175B
       PZE                         SYSPCM HA2                        $6$IBB4175C
       OCT     001212000000        SYSOU1 HA2                        $6$IBB4175D
       OCT     001212000000        SYSOU2 HA2                        $6$IBB4175E
       OCT     001212000000        SYSIN1 HA2                        $6$IBB4175F
       OCT     001212000000        SYSIN2 HA2                        $6$IBB4175G
       OCT     001212000000        SYSPP1 HA2                        $6$IBB4175H
       OCT     001212000000        SYSPP2 HA2                        $6$IBB4175I
       OCT     001212000000        SYSCK1 HA2                        $6$IBB4175J
       OCT     001212000000        SYSCK2 HA2                        $6$IBB4175K
       OCT     001212000000        SYSUT1 HA2                        $6$IBB4175L
       OCT     001212000000        SYSUT2 HA2                        $6$IBB4175M
       OCT     001212000000        SYSUT3 HA2                        $6$IBB4175N
       OCT     001212000000        SYSUT4 HA2                        $6$IBB4175O
       OCT     001212000000        SYSUT5 HA2                        $6$IBB4175P
       OCT     001212000000        SYSUT6 HA2                        $6$IBB4175Q
       OCT     001212000000        SYSUT7 HA2                        $6$IBB4175R
       OCT     001212000000        SYSUT8 HA2                        $6$IBB4175S
       OCT     001212000000        SYSUT9 HA2                        $6$IBB4175T
COMUNT PZE                         COMBINED OUTPUT CELL              $6$IBB4175U
IBADDR OCT     700000777777        MASK FOR CLEARING DECRE.          $6$IBB4175V
NDINT  STL     IBSINP              INDICATE INTERRUPT                (6)IBB4175W
       STL     JBINT               COMPLETED                         (6)IBB4175X
RSPLUS CLA     RSQUAN              NON-MATCH LOOP, DECREMENT COUNTER (6)IBB4175Y
       TRA     RSPLRT              RETURN                            (6)IBB4175Z
NDINT1 STL     IBSINP              INDICATE INTERRUPT                (6)IBB41760
       STL     JBINT               COMPLETED                         (6)IBB41761
       TRA     RSMTEN              AND REWIND SYSIN1                 (6)IBB41762
RSTOPP ZET     IBSINP              IS $STOP FROM SYSCRD              (6)IBB41763
       TRA     *+3                 NO                                (6)IBB41764
       STL     RSMTER              YES, MATCH ERROR                  (6)IBB41765
       TRA     RSERBL              ISSUE MESSAGE                     (6)IBB41766
       ZET     RSERSW              HAS ERROR ALREADY OCCURRED        (6)IBB41767
       TRA     RSERBK+3            YES, ISSUE MESSAGE                (6)IBB41768
       TRA     RSSTOP+2            NO, RETURN                        (6)IBB41769
       IFT     CHEX=0                                                (9)IBB4176A
       GOTO    RSTORE                                                (9)IBB4176B
RSTOR  SLW     0,2                                                   (9)IBB4176C
       TXL     *+2,2,-SYSPCH-1                                      (11)IBB4176D
       TXL     *+3,2,-SYSPCH                                        (11)IBB4176E
       LDQ     .+SUNLG,2           RESTORE DRUM LIMIT TABLE         (11)IBB4176F
       STQ     SUNLG,2                                              (11)IBB4176G
       TRA     IBJ7A                                                (11)IBB4176H
RSTORE NULL                                                         (11)IBB4176I
IBSPAT BES     6720-*              IBSUP PATCH AREA HERE TO IBSNUC   (9)IBB4176V
       TTL     IBNUC                                                    IBB41770
       BES     6720-*                                                   IBB41780
*            NUCLEUS OF BASIC MONITOR TO ALWAYS BE IN CORE              IBB41790
*             ITS ACTUAL LOCATION IS IBSORG WHICH=64 (DEC)              IBB41800
       SPACE   1                                                        IBB41810
*                        ONE WORD ENTRIES TABLE                         IBB41820
       SPACE   1                                                        IBB41830
IBSNUC ORG     *                                                     $6$IBB41831
       LOC     IBSORG                                                $6$IBB41832
SYSTRA TRA     **                  ENTRY TO EACH SYSTEM              $6$IBB41840
SYSDAT BCI     1,120164            CURRENT DATE                      $6$IBB41850
SYSCUR BCI     1,                  CURRENT SYSTEM NAME               $6$IBB41860
SYSRET TRA     CALIB1              RETURN FROM EACH SYSTEM           $6$IBB41870
SYSKEY PZE     **,,**              ENTRY KEYS AT COLD START          $6$IBB41880
SYSSWS OCT     77                  SENSE SWITCHES AT COLD START      $6$IBB41890
SYSPOS PZE     **,,**              LOCATION INDEX TO CUR SYSTEM      $6$IBB41900
SYSUNI PZE     SYSLB1,,SUNLG       LOC + LENGTH SYSTEM UNITS TABLE   $6$IBB41910
SYSUBC PZE     UCBA,,HGHCHN   LOCATION + LENGTH OF UCW LOCATOR TABLE $6$IBB41920
SYSUAV PZE     UCAA,,HGHCHN   LOCATION + LENGTH OF UCW AVAIL CHAINS  $6$IBB41930
SYSUCW PZE     UEA11,,NOUCW*4      LOC + LENGTH UNIT CONTROL WDS     $6$IBB41940
SYSRPT TRA     INTRUP              OPERATOR INTERRUPT TEST ROUTINE   $6$IBB41950
SYSCEM TRA     SYSTRA-2            CEMON AREA ENTRY                  $6$IBB41960
SYSDMP TTR     DUMP                DUMP CALL ROUTINE                 $6$IBB41970
SYSIOX PZE     IOEX,,IXCEND-IOEX   LOC,,LENGTH IOEX COMMUNICATIONS   $6$IBB41980
SYSIDR TRA     2,4                 INSTALLATION ACCOUNTING ROUTINE   $6$IBB41990
SYSCOR PZE     SYSEND,,SYSORG      CORE LIMITS FOR SYSTEMS           $6$IBB42000
SYSLDR TXI     CALIB3,,UEA1        SYSTEM LOAD ROUTINE               $6$IBB42010
SYSACC PZE                         INSTALLATION ACCOUNTING CELLS     $6$IBB42020
SYSPID PZE                         INSTALLATION ACCOUNTING CELLS     $6$IBB42030
SYSCYD CPYD    0,,0                1301/729 DISCONNECT               $6$IBB42040
       TCH     SYSTWT                                                $6$IBB42050
SYSSLD CPYP    *+1,,1              IOCP/CPYP                         $6$IBB42060
SYSTCH CPYD    0,,0                                                  $6$IBB42070
       TCH     *-2                                                   $6$IBB42080
       IFT     CHEX=0                                                $6$IBB42081
SYSTWT                             (TWT CHNS3 IF 7909 EXISTS)        $6$IBB42082
       IFF     CHEX=0                                                $6$IBB42083
SYSTWT TWT     CHNS3                                                 $6$IBB42090
SYSGET BCI     1,IBSYST                                              $6$IBB42100
SYSJOB PZE                                                           $6$IBB42110
.CHEXI PZE     *                   D.C. CELL                         $6$IBB42120
.MODSW PZE                         D.C. CELL                         $6$IBB42121
       PZE                         SPARES                            $6$IBB42122
       PZE                                                              IBB42130
       EJECT                                                            IBB42140
*                          SYSTEM UNITS TABLE                           IBB42150
       SPACE   1                                                        IBB42160
*   THESE ENTRIES SHOULD BE PATCHED OR THE CARDS REPLACED               IBB42170
*   TO REFLECT THE STANDARD SYSTEM UNIT CONFIGURATION                   IBB42180
*   ADOPTED BY THE INSTALLATION. FORMAT=                                IBB42190
*      P       C,,U                                                     IBB42200
*   WHERE-                                                              IBB42210
*      P=PZE= LOW DENSITY                                               IBB42220
*       =MZE= HIGH DENSITY                                              IBB42230
*      C= CHANNEL NUMBER.(1....8)                                       IBB42240
*      U=UNIT NUMBER OR ADDRESS.  (1...10=TAPES, 11=READER, 12=PUNCH,   IBB42250
*                    13=PRINTER, 2X0XX=H.T., 2X1XX=DISK, 2X3XX=NEED)    IBB42260
       SPACE                                                            IBB42270
SYUNIL EQU     *+IBSNUC-IBSORG                                       $6$IBB42279
SYSLB1 MZE     1,,1                SYSTEM LIBRARY-1 HIGH DEN A1         IBB42280
SYSLB2 MZE     1,,2                SYSTEM LIBRARY-2                     IBB42290
SYSLB3 MZE     0                   SYSTEM LIBRARY-3                     IBB42300
SYSLB4 MZE     PPC,PPE,PPU         SYSTEM LIBRARY-4                     IBB42310
SYSCRD PZE     1,,11               SYSTEM CARD READER CHANNEL A         IBB42320
SYSPRT PZE     1,,13               SYSTEM PRINTER CHANNEL A             IBB42330
SYSPCH PZE     1,,12               SYSTEM PUNCH CHANNEL A               IBB42340
SYSOU1 MZE     2,,1                                                  $6$IBB42350
SYSOU2 MZE     2,,2                                                  $6$IBB42360
SYSIN1 MZE     1,,3                                                  $6$IBB42370
SYSIN2 MZE     1,,3                                                  $6$IBB42380
SYSPP1 MZE     2,,3                                                  $6$IBB42390
SYSPP2 MZE     2,,4                                                     IBB42400
SYSCK1 MZE     0                   SYSTEM CHECKPOINT-1 UNASSIGNED       IBB42410
SYSCK2 MZE     1,,7                SYSCK2 FOR DEBUG                  $6$IBB42420
SYSUT1 MZE     1,,5                                                     IBB42430
SYSUT2 MZE     2,,5                                                     IBB42440
SYSUT3 MZE     1,,6                                                     IBB42450
SYSUT4 MZE     2,,6                                                     IBB42460
SYSUT5 MZE     0                                                     $6$IBB42461
SYSUT6 MZE     0                                                     $6$IBB42462
SYSUT7 MZE     0                                                     $6$IBB42463
SYSUT8 MZE     0                                                     $6$IBB42464
SYSUT9 MZE     0                                                     $6$IBB42465
SYUEND BSS     0                                                        IBB42470
       SPACE                                                            IBB42480
*              DISK AND NEED LIMITS TABLE FOR SYSTEM UNITS              IBB42490
*              (SYSCRD, SYSPRT, AND SYSPCH NEVER DISK OR NEED)          IBB42500
       PZE                                                              IBB42510
       PZE                                                              IBB42520
       PZE                                                              IBB42530
       PZE                                                              IBB42540
 DMPSW PZE     **                  DUMP SWITCH                          IBB42550
 DMPSV PZE     **,7,**             DUMP INFO SAVE                       IBB42560
 IBSAV PZE     **                  S.S.1 SAVE                           IBB42570
       PZE                                                              IBB42580
       PZE                                                              IBB42590
       PZE                                                              IBB42600
       PZE                                                              IBB42610
       PZE                                                              IBB42620
       PZE                                                              IBB42630
       PZE                                                              IBB42640
       PZE                                                              IBB42650
       PZE                                                              IBB42660
       PZE                                                              IBB42670
       PZE                                                              IBB42680
       PZE                                                              IBB42690
       PZE                                                           $6$IBB42691
       PZE                                                           $6$IBB42692
       PZE                                                           $6$IBB42693
       PZE                                                           $6$IBB42694
       PZE                                                           $6$IBB42695
       SPACE   2                                                     $6$IBB42700
*                    LOCATORS FOR UCW'S BY CHANNEL                      IBB42710
       SPACE   1                                                        IBB42720
       COMMDS  UCWLOC                                                $6$IBB42730
       SPACE   1                                                        IBB42820
*            LOCATORS FOR AVAILABLE UNIT CHAINS BY CHANNEL              IBB42830
       SPACE   1                                                        IBB42840
       COMMDS  VARLOC,(UCA,PZE,(**,,35))                             $6$IBB42850
       SPACE                                                            IBB42940
IBSGAP NULL                                                          $6$IBB42950
       DUP     1,HGHCHN                                              $6$IBB42960
       PZE     **,**,**                                              $6$IBB42970
       SPACE                                                            IBB43040
IBL(0) PZE     0                   CONSTANTS                            IBB43050
IBL(1) PZE     1                                                        IBB43060
SKWMSK OCT     040000300000                                          $6$IBB43070
MN1617 OCT     777774777777                                          $6$IBB43100
IBSINP PZE     **                  INPUT UNIT FOR IBSUP                 IBB43110
 LSTSW PZE     **                  LIST/UNLIST SWITCH                $6$IBB43120
       SPACE   3                                                        IBB43130
IBXSP  DUP     1,HGHCHN                                              $6$IBB43140
       PZE                                                           $6$IBB43141
IBXAC  DUP     1,HGHCHN                                              $6$IBB43150
       PZE                                                           $6$IBB43151
       SPACE                                                            IBB43160
       EJECT                                                            IBB43170
*                       SYSTEM DUMP CALL ROUTINE                        IBB43180
       SPACE   1                                                        IBB43190
DPCLL  EQU     *+IBSNUC-IBSORG                                       $6$IBB43199
 DPH1  OCT     120600120112                                             IBB43200
DUMP   ENB     L(0)                                                  $6$IBB43210
 DPH2  TTR     DHENT                             (CTLW *-2  IF HYPER)$6$IBB43220
 DMPCW IOCT    0,,ENDDMP                         (CPYD      IF HYPER)   IBB43230
DHENT  WTBA    **                  HT ENTRANCE                       $6$IBB43240
 DPH3  RCHA    DMPCW                             (RSCX DUMP IF HYPER)$6$IBB43250
 DPH4  LCHA    L(0)                              (STCX      IF HYPER)   IBB43260
       STL     DMPSW                                                 $6$IBB43270
       STZ     0                                                        IBB43280
 DPTWO TIX     0,0,0                                                    IBB43290
       LTM                                                              IBB43300
       SXD     D$IR2,2                                                  IBB43310
       AXT     *+3,2                                                 $6$IBB43320
       SXA     SAVE4,2                                                  IBB43330
       TRA     SAVE2                                                    IBB43340
       STP     QP                                                       IBB43350
       CAL     0                   MOVE TRA TRAP INDICATION             IBB43360
       SLW     D$TRIG+1            FOR DUMP                             IBB43370
 DPUCB TXI     CADLBX,0,**                                           $6$IBB43380
       SPACE                                                            IBB43390
*                    INTERRUPT BETWEEN JOBS                             IBB43400
       SPACE   1                                                        IBB43410
INTRPL EQU     *+IBSNUC-IBSORG                                       $6$IBB43419
INTRUP CLA     SYSJOB                                                   IBB43420
       LRS     0                                                        IBB43430
       ANA     MN1617                                                $6$IBB43440
       ZET     IBSINP                                                $6$IBB43450
       ADD     L(1)                                                     IBB43460
       SLW     SYSJOB              ADJUST JOB COUNT                     IBB43470
       ZET     IBSINP              IBSYS INPUT FROM SYSCRD...        $6$IBB43480
       SWT     1                   IF NO - TEST S.S.1                   IBB43490
       TQP     1,4                 IF YES - FORGET ANY INTERRUPT        IBB43500
*                FALL THRU TO CALIB1 TO LOAD IBSUP                      IBB43510
       TTL     SYSTEM LOADER ROUTINES                                   IBB43520
       SPACE                                                            IBB43530
CALB1L EQU     *+IBSNUC-IBSORG                                       $6$IBB43539
CALIB1 ZET     **                  CHECK CLEARENCE THRU PRIORITY CELL   IBB43540
       TRA     *-1                 WHEN CLEAR - -                    $6$IBB43550
       STZ     0                   LOAD IBSUP (OR SYSDMP)               IBB43560
       ENB     0                   INTO CORE FROM SYSLB1                IBB43570
CALIB2 EQU     *                                                     $6$IBB43571
       SPACE                                                            IBB43580
*                                  SYSLB1 AND SYSLBN=DISK-NEED LOADER.  IBB43590
*                                  THEY MAY BE ON DIFFERENT CHANNELS    IBB43600
       SPACE                                                            IBB43610
CDLBXL EQU     *+IBSNUC-IBSORG                                       $6$IBB43616
CADLBX LOC     CALIB2                                                $6$IBB43617
       IFT     DUEX=0                                                $6$IBB43618
       GOTO    ENDLBX                                                $6$IBB43619
       LXA     SYSLB1,4            LOAD IBSUP OR SYSDMP FROM DISC    $6$IBB43620
       SXD     SYSLDR,4                                                 IBB43630
       LXA     SYSLB1+SUNLG,4                                        $6$IBB43640
       SXD     CADSV,4                                                  IBB43650
       CLA     CADX2+1                                               $6$IBB43660
       TRA     CADX2-2                                               $6$IBB43670
 CADX1 LDI     SYSTCH              N=0 CALL                             IBB43680
       TRA     CADX2                                                 $6$IBB43690
       CAL     1,4                 N=1 CALL                             IBB43700
       SLW     CADSV                                                    IBB43710
       CLA     CADX2+1                                               $6$IBB43720
       STA     CADX5                                                 $6$IBB43730
       TSX     CADX4,2             GO WRITE CHECK POINT ON           $6$IBB43740
       PZE     LBXDC               SPARE TRACKS BEHIND IBSYS         $6$IBB43750
       TSX     CADX4,2             NOW READ IN SLTABL                $6$IBB43760
       PZE     CDCP3                                                 $6$IBB43770
       AXT     2,4                                                      IBB43780
       CAL     SYSORG+110,4        SCAN SLTABL AGAINST REQUEST          IBB43790
       ERA     CADSV                                                    IBB43800
       TZE     *+2                                                   $6$IBB43810
       TXI     *-3,4,-2                                              $6$IBB43820
       CLA     SYSORG+111,4        FOUND                                IBB43830
       STO     CADSV                                                    IBB43840
       TSX     CADX4,2             NOW GO RESTORE CORE               $6$IBB43850
       PZE     CDCP2                                                 $6$IBB43860
       CLA     CDCP2-1                                               $6$IBB43870
       LDI     CADSV                                                    IBB43880
       STA     CADX5                                                 $6$IBB43890
 CADX2 RIL     040000                                                   IBB43900
       PIA     LBXD1               PUT CORRECT TTTT IN D(AC)         $6$IBB43910
       TSX     BCVDEC-1,4                                               IBB43920
       LDC     SYSLDR,4            SET XR4 = -L(UCW)                    IBB43930
       TSX     FDAMT,2             GO SET UP DSEK FOR                   IBB43940
 CDSMS OCT     000022440016        INDICATED TTTT.                      IBB43950
       PZE     CADX6               NEXT SET UP DVCY                  $6$IBB43960
       SLW     CADX7+1             (2ND WORD OF DVCY SAME AS DSEK)   $6$IBB43970
       LDI     CADX6                                                 $6$IBB43980
       IIL     001700                                                   IBB43990
       STI     CADX7                                                 $6$IBB44000
 CADX3 TSX     CADX4,2             O.K., ORDERS ARE ALL SET UP       $6$IBB44010
       PZE     CADXA               GO READ IN A RECORD               $6$IBB44020
       LDI     SYSTCH                                                   IBB44030
       NZT     DMPSW               IF DMPSW NOT ZERO, GO LOOP        $6$IBB44040
       LNT     040000              BACK TO READ IN SYSDMP               IBB44050
       TRA     CADX2               ALSO, IF BIT 3 OF SYSTCH=0, THEN  $6$IBB44060
       TRA     SYSCEM              MUST LOOP BACK TO GET THE            IBB44070
 CADX4 STL     0                   REST OF RECORD.                      IBB44080
       AXT     10,4                                                     IBB44090
 CADX5 TRA     LBXD5                                                 $6$IBB44100
 LBXD1 RICA                                                             IBB44110
 LBXD2 RSCA*   1,2                 START SYSLB1 CHANNEL                 IBB44120
 LBXD3 PZE     TSDCX               STORE CHANNEL DIAGNOSTIC             IBB44130
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB44140
       LFT     007100              IS THERE AN ERROR...                 IBB44150
       TRA     CADX9               YES - THEN RETRY UP TO 10 TIMES   $6$IBB44160
 LBXD4 TCOA    LBXD3                                                 $6$IBB44170
       TRA     CADX8               HERE IF SUCCESS                   $6$IBB44180
 LBXD5 RICB                                                             IBB44190
 LBXD6 RSCB*   1,2                 START SYSLBN CHANNEL                 IBB44200
 LBXD7 PZE     TSDCX               STORE CHANNEL DIAGNOSTIC             IBB44210
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB44220
       LFT     007100                                                   IBB44230
       TRA     CADX9                                                 $6$IBB44240
 LBXDB TCOB    LBXD7                                                 $6$IBB44250
 CADX8 XEC*    CADX5                                                 $6$IBB44260
       TRA     2,2                                                      IBB44270
 CADX9 TIX     CADX5,4,1                                             $6$IBB44280
       TRA     0                                                        IBB44290
 CADX6 DSEK    ,,                  THIS SEER ORDER SET UP BY CADLBX     IBB44300
 CADX7 DVCY    ,,                  THIS DVCY ORDER SET UP BY CALLBX     IBB44310
 LBXD8 DSEK    ,,                  THIS SEEK ORDER SET UP BY IBSUP      IBB44320
 LBXD9 DVCY    ,,                  THIS DVCY ORDER SET UB BY IBSUP      IBB44330
 LBXDA DVCY    ,,                  THIS DVCY SET UP BY IBSUP            IBB44340
       SPACE                                                            IBB44350
 CADXA SMS*    CDSMS               CHANNEL PROGRAM TO -----          $6$IBB44360
       CTL     CADX6                                                 $6$IBB44370
       TCM     *,,,                                                  $6$IBB44380
       CTLR    CADX7                                                 $6$IBB44390
       TCH     SYSTCH-1            1. READ IN A RECORD                  IBB44400
 LBXDC SMS     **                                                       IBB44410
       CTL     LBXD8                                                 $6$IBB44420
       TCM     *,,,                                                  $6$IBB44430
       CTLW    LBXD9               2. WRITE A CHECK POINT            $6$IBB44440
       CPYD    SYSORG,,SLTABL+110                                       IBB44450
       WTR     LBXD5                                                 $6$IBB44460
 CDCP2 SMS*    LBXDC               3. READ THE CHECK POINT           $6$IBB44470
       CTLR    LBXD9                                                 $6$IBB44480
       TCH     *-4                                                   $6$IBB44490
 CDCP3 SMS*    LBXDC               4. READ SLTABLP                   $6$IBB44500
       CTLR    LBXDA                                                 $6$IBB44510
       TCH     *-7                                                   $6$IBB44520
ENDLBX BSS     0                                                        IBB44530
       SPACE                                                            IBB44540
CALB3L EQU     *+CDLBXL-CADLBX                                       $6$IBB44548
CALIB3 LOC     MAXLBN                                                $6$IBB44549
       ZET     **                  HERE TO LOAD A RECORD FROM SYSLBN $6$IBB44550
       TRA     *-1                                                   $6$IBB44560
       STZ     0                                                        IBB44570
       ENB     0                                                        IBB44580
       CAL     0,4                                                      IBB44590
 BLANK PDX     48,2                                                     IBB44600
       TXL     CALIBN,2,3840       N=0     NOTE.. CALIBN REPLACED WITH  IBB44610
CALIB4 TRA     CALIBN              N=1     CADX1+ IF CADLBX LOADER      IBB44620
NUCEND BSS     0                   END OF NUCLEUS                       IBB44630
       EJECT                                                            IBB44640
*              ALTERNATE LOADING ROUTINES WHICH MAY, DEPENDING ON       IBB44650
*              SYSLBX CONFIGURATION, BE LOADED INTO IBNUC BY IBSUP.     IBB44660
       SPACE                                                            IBB44670
*                        SYSLB1 IS 729 TAPE       (ANY CHANNEL)         IBB44680
       SPACE                                                            IBB44690
CTLB1L EQU     *+CALB3L-CALIB3                                       $6$IBB44698
CATLB1 LOC     CALIB2                                                $6$IBB44699
       REW     **                                                    $6$IBB44700
 LB1T1 STZ     **                  ZERO OUT FILE AND RECORD COUNT       IBB44710
 LB1T2 TCOA    *                   WAIT FOR COMPLETION OF REWIND        IBB44720
       STL     0                                                        IBB44730
       AXT     10,4                                                     IBB44740
       CLA     SYSSLD                                                $6$IBB44741
       STO     SYSTCH                                                $6$IBB44742
 LB1T3 RDS     **                  SELECT SYSLB1 AND                    IBB44750
 LB1T4 RCHA    SYSSLD              READ IN ONE RECORD.                  IBB44760
 LB1T5 TRCA    LB1T8               CONTINUALLY TEST FOR                 IBB44770
       CLA     SYSTCH              GET I/O COMMAND                   $6$IBB44771
       TPL     LB1T8               SIGN BIT OFF, SKEW CHECK          $6$IBB44772
       ANA     SKWMSK                                                $6$IBB44773
       TNZ     LB1T8               IF NOT ZERO,ASSUME SKEW           $6$IBB44774
LB1T6  TCOA    LB1T5                                                 $6$IBB44780
 LB1T7 TRCA    LB1T9               TEST FOR ERROR ON THE LAST WORD.     IBB44790
       CAL*    LB1T1               HERE IF NO ERROR.                    IBB44800
       ACL     IBL(1)                                                $6$IBB44810
       STA*    LB1T1               ADJUST RECORD COUNT                  IBB44820
       NZT     DMPSW               WAS THIS A DUMP CALL...           $6$IBB44830
 TPRET TRA     CALIBN-1            NO - THEN GO TO SYSTRA               IBB44840
       TRA     LB1T2               YES-THEN READ IN SYSDMP.             IBB44850
 LB1T8 RCHA    IBL(1)              STOP CHANNEL AND                  $6$IBB44860
 LB1T9 BSR     **                  REPOSITION TAPE TO RETRY             IBB44870
       TIX     LB1T3-2,4,1         LOADING IF AN ERROR.              (3)IBB44880
       TRA     0                                                        IBB44890
ENTLB1 BSS     0                                                        IBB44900
       SPACE                                                            IBB44910
*                        SYSLB1 IS 7340 HYPERTAPE (ANY CHANNEL)         IBB44920
       SPACE                                                            IBB44930
CHLB1L EQU     *+CTLB1L-CATLB1                                       $6$IBB44936
CAHLB1 LOC     CALIB2                                                $6$IBB44937
       IFT     HTEX=0                                                $6$IBB44938
       GOTO    ENHLB1                                                $6$IBB44939
       STZ     **                  ZERO OUT FILE AND RECORD COUNT    $6$IBB44940
 LB1H2 RICA                        CLEAR CHANNEL                        IBB44950
 LB1H3 RSCA    LB1H9               REWIND SYSLB1                        IBB44960
       STL     0                                                        IBB44970
       AXT     10,4                                                     IBB44980
 LB1H4 TCOA    *                                                        IBB44990
 LB1H5 RSCA    CAH3                NEW READ IN ONE RECORD               IBB45000
 LB1H6 PZE     TSDCX               STORE CHENNEL DIAGNOSTIC             IBB45010
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB45020
       LFT     007100              IS THERE AN ERROR...                 IBB45030
       TRA     LB1H8-1             YES - THEN TRY UP TO 10 TIMES        IBB45040
 LB1H7 TCOA    LB1H6                                                    IBB45050
       CAL*    CAHLB1                                                   IBB45060
       ACL     IBL(1)              ADJUST RECORD COUNT               $6$IBB45070
       STA*    CAHLB1                                                   IBB45080
       NZT     DMPSW               WAS THIS A DUMP CALL...           $6$IBB45090
 HTRET TRA     CALIBN-1            NO - THEN GO TO SYSTRA               IBB45100
       TRA     LB1H4-1             YES-THEN LOAD IN SYSDMP              IBB45110
       XEC     LB1H2                                                    IBB45120
 LB1H8 RSCA    CAH2                IF AN ERROR,BSR AND RETRY            IBB45130
       TIX     LB1H4,4,1                                                IBB45140
       TRA     0                                                        IBB45150
 LB1H9 SMS     **                  CHANNEL PROGRAM                      IBB45160
       CTL     LB1HA                                                    IBB45170
       TCM     *,,,                                                     IBB45180
       WTR     *                                                        IBB45190
 CAH3  CTLR    LB1HC                                                    IBB45200
       TCH     SYSTCH-1                                                 IBB45210
 CAH2  SMS*    LB1H9                                                    IBB45220
       CTL     LB1HB                                                    IBB45230
       WTR     *                                                        IBB45240
 LB1HA OCT     120600031212        HRWD                                 IBB45250
       OCT     010000000000                                             IBB45260
 LB1HB OCT     120600030412        HBSR                                 IBB45270
       OCT     010000000000                                             IBB45280
 LB1HC OCT     120600120112        HSEL                                 IBB45290
ENHLB1 BSS     0                                                        IBB45300
       SPACE                                                            IBB45310
*                        SYSLB1 IS DISK/NEED         (ANY CHANNEL)      IBB45320
       SPACE                                                            IBB45330
CDLB1L EQU     *+CHLB1L-CAHLB1                                       $6$IBB45336
CADLB1 LOC     CALIB2                                                $6$IBB45337
       IFT     DUEX=0                                                $6$IBB45338
       GOTO    ENDLB1                                                $6$IBB45339
       LXA     SYSLB1+SUNLG,4                                        $6$IBB45340
       PXD     ,4                  PUT TTTT ORG OF IBSYS IN D(AC)       IBB45350
       TRA     *+3                                                      IBB45360
 CAD1  RIL     040000                                                   IBB45370
       PIA                                                              IBB45380
       TSX     BCVDEC-1,4                                               IBB45390
       LAC     SYSLB1,4            SET XR4=-L(UCW) OF SYSLB1         $6$IBB45400
       TSX     FDAMT,2             NOW SET UP SEEK ORDER                IBB45410
 CAD6  OCT     000022440016                                             IBB45420
       PZE     CAD3                                                     IBB45430
       SLW     CAD4+1              2ND WORD OF DVCY SAME AS DSEK        IBB45440
       LDI     CAD3                                                     IBB45450
       IIL     001700                                                   IBB45460
       STI     CAD4                SET DVCY                             IBB45470
       STL     0                                                        IBB45480
       AXT     10,4                                                     IBB45490
 LB1D1 RICA                                                             IBB45500
 LB1D2 RSCA    CAD5                                                     IBB45510
 LB1D3 PZE     TSDCX               STORE CHANNEL DIAGNOSTIC             IBB45520
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB45530
       LFT     007100              IS THERE AN ERROR...                 IBB45540
       TRA     CAD2                YES-THEN RETRY UP TO 10 TIMES        IBB45550
 LB1D4 TCOA    LB1D3                                                    IBB45560
       XEC     LB1D1               HERE IF SUCCESS                      IBB45570
       LDI     SYSTCH                                                   IBB45580
       LNT     040000              IF BIT 3 OF SYSTCH=0 THEN RECORD     IBB45590
       TRA     CAD1+1              RAN OVER CYLINDER-GO GET THE REST    IBB45600
       NZT     DMPSW               HERE IF RECORD COMPLETELY IN.     $6$IBB45610
 DKRET TRA     CALIBN-1            GO TO SYSTRA                         IBB45620
       TRA     CAD1                IF DUMP CALL GO LOAD SYSDMP          IBB45630
 CAD2  TIX     LB1D1,4,1                                                IBB45640
       TRA     0                                                        IBB45650
 CAD3  DSEK    ,,                                                       IBB45660
 CAD4  DVCY    ,,                                                       IBB45670
 CAD5  SMS*    CAD6                START CHANNEL                        IBB45680
       CTL     CAD3                SEEK                                 IBB45690
       TCM     *,,,                WAIT FOR ATTENTION                   IBB45700
       CTLR    CAD4                                                     IBB45710
       TCH     SYSTCH-1            GO TO SCATTER LOAD LOOP              IBB45720
ENDLB1 BSS     0                                                        IBB45730
       SPACE                                                            IBB45740
*                        SYSLBN IS 729 TAPE       (ANY CHANNEL)         IBB45750
       SPACE                                                            IBB45760
CTLBNL EQU     *+CDLB1L-CADLB1                                       $6$IBB45768
CATLBN LOC     CALIBN                                                $6$IBB45769
       LDC     SYSLDR,4                                              $6$IBB45770
       CLA     0,4                                                      IBB45780
       ARS     18                                                       IBB45790
       ORA     CAT16                                                    IBB45800
       STA     LBNT1                                                    IBB45810
       STA     LBNT8                                                    IBB45820
 CAT16 PXA     16,4                                                     IBB45830
       PAC     ,4                                                       IBB45840
       TXI     *+1,4,2                                                  IBB45850
       SXA     LBNT6,4                                                  IBB45860
       STL     0                                                        IBB45870
       AXT     10,4                                                     IBB45880
       CLA     SYSSLD                                                $6$IBB45881
       STO     SYSTCH                                                $6$IBB45882
 LBNT1 RDS     **                  READ IN ONE RECORD                   IBB45890
 LBNT2 RCHB    SYSSLD                                                   IBB45900
 LBNT3 TRCB    LBNT7                                                    IBB45910
       CLA     SYSTCH              GET I/O COMMAND                   $6$IBB45911
       TPL     LBNT7               IF NO SIGN BIT,SKEW               $6$IBB45912
       ANA     SKWMSK              CHECK FOR MORE POSSIBLE SKEW      $6$IBB45913
       TNZ     LBNT7               IF NOT ZERO ASSUME ZERO           $6$IBB45914
LBNT4  TCOB    LBNT3                                                 $6$IBB45920
 LBNT5 TRCB    LBNT8                                                    IBB45930
 LBNT6 CAL     **                  HERE IF SUCCESS                      IBB45940
       ACL     IBL(1)              ADJUST RECORD COUNT               $6$IBB45950
       STA*    LBNT6               AND                                  IBB45960
       TRA     SYSCEM              RETURN THRU SYSTRA.                  IBB45970
 LBNT7 RCHB    IBL(1)              IF AN ERROR, STOP CHANNEL         $6$IBB45980
 LBNT8 BSR     **                  AND REPOSITION TAPE TO               IBB45990
       TIX     LBNT1-2,4,1         RETRY LOADING.                    (3)IBB46000
       TRA     0                                                        IBB46010
ENTLBN BSS     0                                                        IBB46020
       SPACE                                                            IBB46030
*                        SYSLBN IS 7340 HYPERTAPE (ANY CHANNEL)         IBB46040
       SPACE                                                            IBB46050
CHLBNL EQU     *+CTLBNL-CATLBN                                       $6$IBB46056
CAHLBN LOC     CALIBN                                                $6$IBB46057
       IFT     HTEX=0                                                $6$IBB46058
       GOTO    ENHLBN                                                $6$IBB46059
       LDC     SYSLDR,4                                              $6$IBB46060
       CAL     0,4                                                      IBB46070
       ANA     LBNH7-1                                                  IBB46080
       ORA     LBNHK                                                    IBB46090
       STD     LBNH8                                                    IBB46100
       STD     LBNH9                                                    IBB46110
       PXA     ,4                                                       IBB46120
       PAC     ,4                                                       IBB46130
       TXI     *+1,4,2                                                  IBB46140
       SXA     LBNH5,4                                                  IBB46150
       STL     0                                                        IBB46160
       AXT     10,4                                                     IBB46170
 LBNH1 RICB                                                             IBB46180
 LBNH2 RSCB    LBNH7               READ ONE RECORD                      IBB46190
 LBNH3 PZE     TSDCX               STORE CHANNEL DIAGNOSTIC             IBB46200
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB46210
       LFT     007100              IS THER AN ERROR...                  IBB46220
       TRA     LBNH6-1             YES - THEN TRY UP TO 10 TIMES        IBB46230
 LBNH4 TCOB    LBNH3                                                    IBB46240
 LBNH5 CAL     **                  HERE IF NO ERROR                     IBB46250
       ACL     IBL(1)              ADJUST RECORD COUNT               $6$IBB46260
       STA*    LBNH5               AND                                  IBB46270
       TRA     SYSCEM              RETURN THRU SYSTRA.                  IBB46280
       XEC     LBNH1                                                    IBB46290
 LBNH6 RSCB    CAHN1               IF AN ERROR - REPOSITION             IBB46300
       TIX     LBNH2,4,1                                                IBB46310
       TXI     0,0,15                                                   IBB46320
 LBNH7 SMS     **                  CHANNEL PROGRAM                      IBB46330
       CTLR    LBNH8                                                    IBB46340
       TCH     SYSTCH-1                                                 IBB46350
 CAHN1 SMS*    LBNH7                                                    IBB46360
       CTL     LBNH9                                                    IBB46370
       WTR     *                                                        IBB46380
 LBNH8 OCT     120600120100        UNIT SELECT                          IBB46390
 LBNH9 OCT     120600030412        HBSR                                 IBB46400
       OCT     010000000000                                             IBB46410
 LBNHK OCT     120600000000                                             IBB46420
ENHLBN BSS     0                                                        IBB46430
       SPACE                                                            IBB46440
*                        SYSLBN IS DISK/NEED         (ANY CHANNEL)      IBB46450
       SPACE                                                            IBB46460
CDLBNL EQU     *+CHLBNL-CAHLBN                                       $6$IBB46466
CADLBN LOC     CALIBN                                                $6$IBB46467
       IFT     DUEX=0                                                $6$IBB46468
       GOTO    ENDLBN                                                $6$IBB46469
       LDI     SYSTCH              IN IBNUC CADLBN=CATLBN            $6$IBB46470
       TRA     *+2                                                      IBB46480
       LDI     SYSTCH                                                   IBB46490
       RIL     040000              GET TRACK ORIGIN FROM D(SYSTCH)      IBB46500
 CADN1 PIA                         O.K., CORRECT TTTT IN D(AC).         IBB46510
       TSX     BCVDEC-1,4                                               IBB46520
       LDC     SYSLDR,4            SET XR4=-L(UCW) OF SYSLBN            IBB46530
       TSX     FDAMT,2             NOW SET UP THE SEER ORDER            IBB46540
 CADN6 OCT     000022440016                                             IBB46550
       PZE     CADN3                                                    IBB46560
       SLW     CADN4+1                                                  IBB46570
       LDI     CADN3                                                    IBB46580
       IIL     001700                                                   IBB46590
       STI     CADN4               SET DVCY                             IBB46600
       STL     0                                                        IBB46610
       AXT     10,4                                                     IBB46620
 LBND1 RICB                                                             IBB46630
 LBND2 RSCB    CADN5               START THE CHANNEL                    IBB46640
 LBND3 PZE     TSDCX               STORE CHANNEL DIAGNOSTIC             IBB46650
       LDI     TSDCX               SET D=DIAGNOSTIC CHANNEL RESULTS     IBB46660
       LFT     007100              IS THERE AN ERROR...                 IBB46670
       TRA     CADN2               YES- THEN RETRY UP TO 10 TIMES       IBB46680
 LBND4 TCOB    LBND3                                                    IBB46690
       XEC     LBND1               HERE IF SUCCESS                      IBB46700
       LDI     SYSTCH                                                   IBB46710
       LNT     040000                                                   IBB46720
       TRA     CADN1                                                    IBB46730
       TRA     SYSCEM              RETURN THRU SYSTRA.                  IBB46740
 CADN2 TIX     LBND1,4,1                                                IBB46750
       TRA     0                                                        IBB46760
 CADN3 DSEK    ,,                                                       IBB46770
 CADN4 DVCY    ,,                                                       IBB46780
 CADN5 SMS*    CADN6                                                    IBB46790
       CTL     CADN3                                                    IBB46800
       TCM     *,,,                                                     IBB46810
       CTLR    CADN4                                                    IBB46820
       TCH     SYSTCH-1                                                 IBB46830
ENDLBN BSS     0                                                        IBB46840
       TTL     UNITS CONFIGURATION CELLS                                IBB46850
RSTLOC ORG     *+CDLBNL-CADLBN                                       $6$IBB46859
       BES     8192-*                                                   IBB46860
       SPACE                                                            IBB46870
       SPACE                                                            IBB46880
AAMT   PZE     CHAAT,,CHAMD                                             IBB46890
       PZE     CHBAT,,CHBMD                                             IBB46900
       PZE     CHCAT,,CHCMD                                             IBB46910
       PZE     CHDAT,,CHDMD                                             IBB46920
       PZE     CHEAT,,CHEMD                                             IBB46930
       PZE     CHFAT,,CHFMD                                             IBB46940
       PZE     CHGAT,,CHGMD                                             IBB46950
       PZE     CHHAT,,CHHMD                                             IBB46960
       SPACE                                                            IBB46970
AADF1  VFD     15/IFA1*1023,18/DFAA1                                    IBB46980
       VFD     15/IFB1*1023,18/DFBA1                                    IBB46990
       VFD     15/IFC1*1023,18/DFCA1                                    IBB47000
       VFD     15/IFD1*1023,18/DFDA1                                    IBB47010
       VFD     15/IFE1*1023,18/DFEA1                                    IBB47020
       VFD     15/IFF1*1023,18/DFFA1                                    IBB47030
       VFD     15/IFG1*1023,18/DFGA1                                    IBB47040
       VFD     15/IFH1*1023,18/DFHA1                                    IBB47050
       SPACE                                                            IBB47060
AADF2  VFD     15/IFA2*1023,18/DFAA2                                    IBB47070
       VFD     15/IFB2*1023,18/DFBA2                                    IBB47080
       VFD     15/IFC2*1023,18/DFCA2                                    IBB47090
       VFD     15/IFD2*1023,18/DFDA2                                    IBB47100
       VFD     15/IFE2*1023,18/DFEA2                                    IBB47110
       VFD     15/IFF2*1023,18/DFFA2                                    IBB47120
       VFD     15/IFG2*1023,18/DFGA2                                    IBB47130
       VFD     15/IFH2*1023,18/DFHA2                                    IBB47140
       SPACE                                                            IBB47150
AAHT1  VFD     33/HTAA1                                                 IBB47160
       VFD     33/HTBA1                                                 IBB47170
       VFD     33/HTCA1                                                 IBB47180
       VFD     33/HTDA1                                                 IBB47190
       VFD     33/HTEA1                                                 IBB47200
       VFD     33/HTFA1                                                 IBB47210
       VFD     33/HTGA1                                                 IBB47220
       VFD     33/HTHA1                                                 IBB47230
       SPACE                                                            IBB47240
AAHT2  VFD     33/HTAA2                                                 IBB47250
       VFD     33/HTBA2                                                 IBB47260
       VFD     33/HTCA2                                                 IBB47270
       VFD     33/HTDA2                                                 IBB47280
       VFD     33/HTEA2                                                 IBB47290
       VFD     33/HTFA2                                                 IBB47300
       VFD     33/HTGA2                                                 IBB47310
       VFD     33/HTHA2                                                 IBB47320
       EJECT                                                            IBB47330
ROCTST VFD     6/UG1,6/UG2,6/UG3,6/UG4,12/0                             IBB47340
NTONCH VFD     4/CHA1,4/CHB1,4/CHC1,4/CHD1,4/CHE1,4/CHF1,4/CHG1,4/CHH1  IBB47350
HTONC1 VFD     4/HTA1,4/HTB1,4/HTC1,4/HTD1,4/HTE1,4/HTF1,4/HTG1,4/HTH1  IBB47360
HTONC2 VFD     4/HTA2,4/HTB2,4/HTC2,4/HTD2,4/HTE2,4/HTF2,4/HTG2,4/HTH2  IBB47370
DFONC1 VFD     4/DFA1,4/DFB1,4/DFC1,4/DFD1,4/DFE1,4/DFF1,4/DFG1,4/DFH1  IBB47380
DFONC2 VFD     4/DDA1,4/DDB1,4/DDC1,4/DDD1,4/DDE1,4/DDF1,4/DDG1,4/DDH1  IBB47390
DFONC3 VFD     4/DFA2,4/DFB2,4/DFC2,4/DFD2,4/DFE2,4/DFF2,4/DFG2,4/DFH2  IBB47400
DFONC4 VFD     4/DDA2,4/DDB2,4/DDC2,4/DDD2,4/DDE2,4/DDF2,4/DDG2,4/DDH2  IBB47410
NDONC1 VFD     4/NFA1,4/NFB1,4/NFC1,4/NFD1,4/NFE1,4/NFF1,4/NFG1,4/NFH1  IBB47420
NDONC2 VFD     4/NFA2,4/NFB2,4/NFC2,4/NFD2,4/NFE2,4/NFF2,4/NFG2,4/NFH2  IBB47430
       SPACE                                                            IBB47440
 UFWCT VFD     O18/1321            1ST CRD EQUIP ADDR                   IBB47450
 TWFCH VFD     O18/1201            1ST TAPE ADDR                        IBB47460
 HTWC1 VFD     O18/21000           1ST H.T. ADDR (INTF 0)               IBB47470
 HTWC2 VFD     O18/21040           1ST H.T. ADDR (INTF 1)               IBB47480
 DFWC1 VFD     O18/21100           1ST DISK ADDR (INTF 0, ARM 0)        IBB47490
DFWC2  VFD     O18/21700           1ST 1302 ADDRESS (INTF 0,ARM 0)   $6$IBB47500
 DFWC3 VFD     O18/21140           1ST DISK ADDR (INTF 1, ARM 0)        IBB47510
DFWC4  VFD     O18/21740           1ST 1302 ADDRESS (INTF 1,ARM0)    $6$IBB47520
ACTORG BSS     0                                                     $6$IBB47525
       SPACE                                                            IBB47530
*                 SYSTEM NAME AND LOCATION INDEX TABLE                  IBB47540
SYSNAM PZE     SYSTMS,,SYSCT                                            IBB47550
       SPACE   1                                                        IBB47560
SYSTMS BSS     100                                                      IBB47570
SYNEND BSS     0                   END OF IBSUP                         IBB47580
       TTL     IOEX / DEFINITIONS                                       IBB47590
 SYSTT EQU     SYNEND-SYSTMS       LENGTH OF TAPE SYSTEMS NAME TABLE    IBB47600
 SYSCT EQU     SYSTT/2             TOTAL ALLOWABLE NUMBER OF SYSTEMS    IBB47610
 IBOPL EQU     IBOPE-IBOPT         LENGTH OF IBSYS CONTROL CARD TABLE   IBB47620
 SUNLG EQU     SYUEND-SYSLB1       LENGTH OF SYSUNI TABLE               IBB47630
LIBSN  EQU     NUCEND-IBSORG       LENGTH OF NUCLEUS                 $6$IBB47640
.      EQU     IBSNUC-IBSORG       DIFF IN LOAD AND STORE NUCLEUS    $6$IBB47660
 QP    EQU     DMPSV                                                 $6$IBB47680
 L(0)  EQU     IBL(0)                                                $6$IBB47690
 L(1)  EQU     IBL(1)                                                $6$IBB47700
 TWO   EQU     DPTWO                                                 $6$IBB47740
 CHXSP EQU     IBXSP                                                 $6$IBB47750
 CHXAC EQU     IBXAC                                                 $6$IBB47760
R      EQU     SPOUT-SPTLD                                           $6$IBB47870
CALIBN MAX     ENTLB1+1,ENHLB1+1,ENDLB1+1                            $6$IBB47871
MAXLBN MAX     ENTLBN,ENHLBN,ENDLBN,ENDLBX                           $6$IBB47872
 UEA11 EQU     NUCEND              LOC OF FIRST UCB AFTER NUCLEUS    $6$IBB47880
 UEA12 EQU     UEA11+4*CDRDA                                            IBB47890
 UEA13 EQU     UEA12+4*PNCHA                                            IBB47900
 UEA1  EQU     UEA13+4*PRNTA                                            IBB47910
 UEB11 EQU     UEA11+4*CHA0        LOC OF FIRST CHANNEL B UCB           IBB47920
 UEC11 EQU     UEB11+4*CHB0        LOC OF FIRST CHANNEL C UCB           IBB47930
 UED11 EQU     UEC11+4*CHC0        LOC OF FIRST CHANNEL D UCB           IBB47940
 UEE11 EQU     UED11+4*CHD0        LOC OF FIRST CHANNEL E UCB           IBB47950
 UEF11 EQU     UEE11+4*CHE0        LOC OF FIRST CHANNEL F UCB           IBB47960
 UEG11 EQU     UEF11+4*CHF0        LOC OF FIRST CHANNEL G UCB           IBB47970
 UEH11 EQU     UEG11+4*CHG0        LOC OF FIRST CHANNEL H UCB           IBB47980
       TTL     IOEX/TRAP CELLS                                       $6$IBB47990
       LBL     IOEX0000,1                                               IBB48000
       BES     10-*                DSC TRAP CELLS                       IBB48010
ATRAP  NULL                                                          $6$IBB48020
       DUP     2,HGHCHN                                              $6$IBB48030
       PZE                                                           $6$IBB48040
       TTR     SAVE                                                  $6$IBB48050
       SPACE                                                            IBB48190
AGOOF  NULL                                                          $6$IBB48200
       DUP     2,8-HGHCHN                                            $6$IBB48210
       PZE     *+1                                                   $6$IBB48220
       HTR*    *-1                                                   $6$IBB48230
       REM     SPACE BETWEEN TRAP AND INTERRUPT CELLS USED...        $6$IBB48370
 ACTSI PZE                         S.I. SAVE FOR ACTIV                  IBB48380
 DUESI PZE                         S.I. SAVE FOR 7909R                  IBB48390
 NDSSI PZE                         S.I. SAVE FOR NDATA                  IBB48400
 NDTSI PZE                         S.I. SAVE FOR NDATA (TRAP TIME)      IBB48410
 ISSSI PZE                         S.I. SAVE FOR ISSK1                  IBB48420
 ISSSP PZE                         ISSEK SPARE STORAGE                  IBB48430
 NDSSW PZE                         NDATA/ACTIV SWITCH                   IBB48440
 FRSW1 PZE                         PRINTER TRAP SWITCH                  IBB48450
       SPACE                                                            IBB48460
       REM     DSC INTERRUPT CELLS                                   $6$IBB48470
       IFT     CHEX=0                                                $6$IBB48471
CHNSNS EQU     0             DEFINED IN IOEX ONLY IF 7909 CHANNEL    $6$IBB48472
       PZE                                                              IBB48480
       TCH     CHNSNS,,0                                                IBB48490
       PZE                                                              IBB48500
       TCH     CHNSNS,,1                                                IBB48510
       PZE                                                              IBB48520
       TCH     CHNSNS,,2                                                IBB48530
       PZE                                                              IBB48540
       TCH     CHNSNS,,3                                                IBB48550
       PZE                                                              IBB48560
       TCH     CHNSNS,,4                                                IBB48570
       PZE                                                              IBB48580
       TCH     CHNSNS,,5                                                IBB48590
       PZE                                                              IBB48600
       TCH     CHNSNS,,6                                                IBB48610
       PZE                                                              IBB48620
       TCH     CHNSNS,,7                                                IBB48630
       SPACE                                                            IBB48640
 IOEXT BSS     9                   IOEX SPARE STORAGE                   IBB48650
CLDLB1 BSS     2                   ORIGINAL COLD START SYSLB1 SAVE      IBB48660
 IOPR  IOCD    IMAGE,,24                                                IBB48670
       SPACE   2                                                        IBB48680
       NZT     .ENBSW              SYSLDR RETURNS HERE TO ENABLE     $6$IBB48690
       ENB*    .TRAPX              TRAPS BEFORE GOING TO SYSTRA      $6$IBB48700
       TTL     IOEX / COMMUNICATION REGION                              IBB48710
*            COMMUNICATION REGION TO IOEX (TRAP SUPERVISOR)             IBB48720
       SPACE   1                                                        IBB48730
       BES     IOXORG-*                                                 IBB48740
       REM                                                           $6$IBB48750
 IOEX  BSS     0                                                     $6$IBB48760
       REM                                                           $6$IBB48770
.ACTV  TTR     TEST                VALIDATE UNIT AND                 $6$IBB48780
       TTR     ACTIV               ACTIVATE CHANNEL                  $6$IBB48790
.NDSEL TTR     TEST                VALIDATE UNIT AND                 $6$IBB48800
       TTR     NDATA               NON DATA SELECT                   $6$IBB48810
.MWR   TTR     PROUT               MESSAGE WRITER                    $6$IBB48820
.PUNCH TTR     PUNCH               HOLLERITH PUNCH                   $6$IBB48830
.ENBSW PZE     **                  ENABLE SWITCH                     $6$IBB48840
.PAWS  TTR     PAWS                ERROR PAUSE                       $6$IBB48850
.PAUSE TTR     PAUSE               OPERATOR ACTION PAUSE             $6$IBB48860
.STOP  TTR     SYSDMP              POST-MORTEM DUMP                  $6$IBB48870
.SYMUN TTR     SYUNCV              SYMBOLIC UNIT CONVERSION          $6$IBB48880
.DECVD TTR     BCVDEC-1            BIN TO DEC CONV AC DECREMENT      $6$IBB48890
.DECVA TTR     BCVDEC              BIN TO DEC CONV AC ADDRESS        $6$IBB48900
.CKWAT TTR     CKWAIT              CHECKPOINT DELAY ROUTINE          $6$IBB48910
.BCD5R TTR     BCD5-1              BIN TO OCT CONV MQ 3-17           $6$IBB48920
.BCD5X TTR     BCD5                BIN TO OCT CONV MQ S-14           $6$IBB48930
.CVPRT TTR     CVPRT               APPEND UNIT AND PRINT MESSAGE     $6$IBB48940
.STOPD TTR     SYSDMP              POST-MORTEM DUMP                  $6$IBB48950
.CHXAC PZE     CHXAC,1             INDIRECT REF CHANNEL ACTIVITY     $6$IBB48960
.URRX  PZE     URRX,1              INDIRECT REF REDUNDANCY COUNTS    $6$IBB48970
.RCTX  PZE     RCTX,1              INDIRECT REF REDUNDANCY CONTROL   $6$IBB48980
.RCHX  PZE     RCHX,1              INDIRECT REF RESET LOAD CHANNEL   $6$IBB48990
.TCOX  PZE     TCOX,1              INDIRECT REF CHANNEL DELAY        $6$IBB49000
.TRCX  PZE     TRCX,1              INDIRECT REF REDUNDANCY TEST      $6$IBB49010
.ETTX  PZE     ETTX,1              INDIRECT REF END TAPE TEST        $6$IBB49020
.TEFX  PZE     TEFX,1              INDIRECT REF END FILE TEST        $6$IBB49030
.TRAPX PZE     .TRAPS              INDIRECT REF TRAP CELL            $6$IBB49040
.TRAPS OCT     377                 TRAP CELL (CURRENT TRAPS ENABLED) $6$IBB49050
.COMM  ***     **,,**              STORE CHANNEL RESULTS AT TRAP     $6$IBB49060
.LTPOS         **,,**              TAPE POSITION BEFORE LAST TRAP    $6$IBB49070
.IOXSI BSS     1                   SENSE INDICATORS AT TRAP          $6$IBB49080
.CHPSW PZE     **                  CHECKPOINT SWITCH                 $6$IBB49090
.TRPSW PZE     **                  TRAP SWITCH                       $6$IBB49100
.FDAMT TTR     FDAMT               DISK ORDER FORMATION              $6$IBB49110
.SDCXI PZE     SDCX,1              INDIRECT REF SDCX TABLE           $6$IBB49120
.STCXI PZE     STCX,1              INDIRECT REF STCX TABLE           $6$IBB49130
.COMMD PZE     **                  STORE CHANNEL DIAGNOSTIC RESULTS  $6$IBB49140
.IBCDZ CRQ     DECRQ,,6            BCD ZERO CONVERT ROUTINE          $6$IBB49150
.CHXSP PZE     CHXSP,1             PRIORITY SWITCH TABLE             $6$IBB49160
.BLKSW PZE     0,,150                                                (6)IBB49165
       DUP     1,3                                                   (6)IBB49166
       PZE                         SPARE                             (6)IBB49167
IXCEND BSS     0                   END OF IOEX COMMUNICATIONS REGION.   IBB49170
       EJECT                                                            IBB49180
*                       INTERMEDIATE DEFINITIONS                        IBB49190
 TRAPX SYN     .TRAPX                                                $6$IBB49220
 TRAP  SYN     .TRAPS                                                $6$IBB49230
 COMM  SYN     .COMM                                                 $6$IBB49240
 COMMD SYN     .COMMD                                                $6$IBB49250
 CHPSW SYN     .CHPSW                                                $6$IBB49260
 TRPSW SYN     .TRPSW                                                $6$IBB49270
 ENBSW SYN     .ENBSW                                                $6$IBB49280
 LTPOS SYN     .LTPOS                                                $6$IBB49290
 ACTV  SYN     .ACTV                                                 $6$IBB49310
 NDSEL SYN     .NDSEL                                                $6$IBB49320
       SPACE   5                                                        IBB49330
*                    XTRAP SAVE   (ALSO USED BY DUMP SPILL)             IBB49340
       SPACE                                                            IBB49350
 SAVE  ZET     FRSW1                                                    IBB49360
       TTR     PRT3                                                     IBB49370
       IFT     DUEX=0                                                $6$IBB49378
       GOTO    SAVE2                                                 $6$IBB49379
       ZET     TRPSW               SAVE - - - -                         IBB49380
       TTR     9SGT2                                                    IBB49390
 SAVE2 STQ     MQ                  MQ,                                  IBB49400
 SAVE3 STO     ACC                 AC                                   IBB49410
       ARS     35                  INCLUDING                            IBB49420
       STA     QP                  QP,                                  IBB49430
       STI     .IOXSI              SENSE INDICATORS                  $6$IBB49440
       IFT     ETMODE=0                                              (3)IBB49441
       GOTO    SAVE3A                                                (3)IBB49442
       LDQ     0                   SAVE CELL ZERO                    (3)IBB49443
       STZ     0                                                     (3)IBB49444
       TIX     0,0,0               IF IN TRANSFER TRAP MODE          (3)IBB49445
       LDI     0                   C(0) ARE NOW NON-ZERO             (3)IBB49446
       STI     TTR                                                   (3)IBB49447
       STQ     0                   RESTORE CELL 0                    (3)IBB49448
       LTM                                                           (3)IBB49449
SAVE3A TNO     *+2                 OVERFLOW                          (3)IBB49450
       CLA     TWO                 INDICATOR,                           IBB49460
       STP     OUT1                AND                                  IBB49470
       SXD     QP,4                INDEX REGISTER 4.                    IBB49480
 SAVE4 TTR     SAVE1                                                    IBB49490
       SPACE                                                            IBB49500
 MQ    BSS     1                                                        IBB49510
 ACC   BSS     1                                                        IBB49520
       TTL     IOEX / TRAP SUPERVISOR                                   IBB49530
*   CHECKPOINT DELAY ROUTINE FOR READING OR WRITING 32K WORD RECORD.    IBB49540
CKWAIT SXA     *+2,4               IN CONSTANT LOCATION FOR             IBB49550
       TCOA    *                   DIFFERENCE IN LOCATIONS OF           IBB49560
       AXT     **,4                CHECKPOINT AND RESTART               IBB49570
       TRA     1,4                 ROUTINES.                            IBB49580
       SPACE                                                            IBB49590
*                    CRQ CONVERSION TABLE TO REPLACE 00,S WITH 12,S     IBB49600
       SPACE                                                            IBB49610
 DECRQ PON     *,,8192                                                  IBB49620
       PZE     *-1,,4096                                                IBB49630
       PZE     *-2,,8192                                                IBB49640
       PZE     *-3,,12288                                               IBB49650
       PZE     *-4,,16384                                               IBB49660
       PZE     *-5,,20480                                               IBB49670
       PZE     *-6,,24576                                               IBB49680
       PZE     *-7,,28672                                               IBB49690
       PON     *-8,,0                                                   IBB49700
       PON     *-9,,4096                                                IBB49710
       SPACE                                                            IBB49730
*                    BINARY TO BCD DECIMAL CONVERSION                   IBB49740
       SPACE                                                            IBB49750
*      TSX     .DECVD,4      D(AC)= NUMBER TO BE CONVERTED           $6$IBB49760
*      TSX     .DECVA,4      A(AC)= NUMBER TO BE CONVERTED           $6$IBB49770
*      ON RETURN             C(MQ)= 60 XX XX XX XX XX                   IBB49780
       SPACE                                                            IBB49790
       ARS     18                                                       IBB49800
BCVDEC ANA     IBADR                                                    IBB49810
       LDQ     BLNKS                                                    IBB49820
       VDP     BCVDT,,6                                                 IBB49830
       VDP     BCVDT+1,,6                                               IBB49840
       VDP     BCVDT+2,,6                                               IBB49850
       VDP     BCVDT+3,,6                                               IBB49860
       VDP     BCVDT+4,,6                                               IBB49870
       TRA     1,4                                                      IBB49880
 IBADR OCT     77777                                                 $6$IBB49885
 BCVDT DEC     -640000,-4096000,-26214400,-167772160,-1073741824        IBB49890
       EJECT                                                            IBB49900
FDAMT  NULL    FORMS DISK/NEED ADDRESS AND GENERATES ORDER           $6$IBB49910
       IFT     CHEX=0                                                $6$IBB49911
       GOTO    STCX                                                  $6$IBB49912
       IFT     DUEX=0                                                $6$IBB49913
       GOTO    ENBAT                                                 $6$IBB49914
       SPACE   1                                                        IBB49920
*              CALLING SEQUENCE                                         IBB49930
*      TSX     .FDAMT,2                                              $6$IBB49940
*      BCI     1,00RR0X                                                 IBB49950
*      PZE     ORDER,T                                                  IBB49960
*      RETURN                                                           IBB49970
       SPACE   1                                                        IBB49980
* ENTRY        RR=RECORD IDENTIFIER                                     IBB49990
*              X=SMS STATUS LESS INTERFACE NUMBER.                      IBB50000
*              ORDER=LOCATION OF ORDER TO BE SET UP, T CAN BE XR1       IBB50010
*              IR4=-L(UCB)                                              IBB50020
*              MQ=XXTTTT           TRACK ADDRESS IN BCD.                IBB50030
       SPACE   1                                                        IBB50040
* EXIT         X=SMS STATUS + INTERFACE NUMBER.                         IBB50050
*              L(ORDER)=ZZAMTT                                          IBB50060
*              L(ORDER+1)=TTRR00                                        IBB50070
       SPACE   1                                                        IBB50080
       CAL     MSK2                MASK OFF RECORD IDENTIFIER        $6$IBB50090
       ANS     1,2                 3RD AND 4TH CHARACTERS.              IBB50100
       LGL     12                  SHIFT OFF GARBAGE                    IBB50110
       CAL     0,4                 PICKUP UCB WORD 1                    IBB50120
       ARS     18                  UNIT TO ADDRESS.                     IBB50130
       LGR     5                   ACCESS AND MODULE TO MQ.             IBB50140
       ANA     L(1)                MASK INTERFACE NUMBER.               IBB50150
       ORS     1,2                 PUTINTERFACE IN ID WORD              IBB50160
       PXD     0,0                 FOR SMS. CLEAR AC.                   IBB50170
       LGL     1                   ACCESS TO AC                         IBB50180
       ALS     2                   INSERT ZEROS FOR ZONE BITS           IBB50190
       LGR     8                   AMTTTT NOW IN MQ                     IBB50200
       XEC     .IBCDZ              REPLACE BCD ZEROS (OCTAL 12)      $6$IBB50210
       CAL     2,2                 GET ORDER LOCATION                   IBB50220
       ADD     L(1)                +1                                   IBB50230
       STT     *+8                                                      IBB50240
       STA     *+7                 TO FILL IN ORDER                     IBB50250
       CAL     MSK3                MASK OFF ORDER                       IBB50260
       ANS*    2,2                 X                                    IBB50270
       LGL     24                  AMTT TO AC                           IBB50280
       ORS*    2,2                 INSERT IN ORDER FIRST WORD           IBB50290
       XCL                                                              IBB50300
       ACL     1,2                 FORM TTRR                            IBB50310
       SLW     **                  INSERT IN ORDER SECOND WORD          IBB50320
       TRA     3,2                 RETURN TO CALLER                     IBB50330
 MSK2  OCT     77777776                                              $6$IBB50331
 MSK3  OCT     777700000000                                          $6$IBB50332
       TTL     IOEX / TRAP SUPERVISOR                                   IBB50350
*                            DSC TRAP SUPERVISOR                        IBB50360
       SPACE                                                            IBB50370
*                    CHENNEL PROGRAM TO ENABLE ATTN INTERRUPTS          IBB50380
       SPACE                                                            IBB50390
 ENBAT ICC     ,,,0                LOAD AR (BYTE 6) WITH LAST SMS       IBB50400
       TCM     *+3,,65,6           TEST THE INTERFACE BIT               IBB50410
       SMS     8                   INTERFACE 0                          IBB50420
       WTR     ENBAT                                                    IBB50430
       SMS     9                   INTERFACE 1                          IBB50440
       WTR     ENBAT                                                    IBB50450
       SPACE                                                            IBB50460
*                            CHANNEL SENSE PROGRAM                      IBB50470
       SPACE                                                            IBB50480
*                  WILL DO A SENSE ON CURRENT INTERFACE INTO SNSDTA.    IBB50490
*                  IF ATTN FOR OTHER INTF IS PRESENT (TEST CH. CK. REG) IBB50500
*                  A SENSE INTO SNSDT2 WILL BE DONE FOR THE INTERFACE.  IBB50510
       SPACE                                                            IBB50520
CHNSNS TWT     CHNS3               NORMAL INTERRUPT STOPS CHANNEL HERE. IBB50530
       SMS     1                   AN INTERRUPT BECAUSE OF THIS CHANNEL IBB50540
       ICC     ,,,0                PROGRAM COMES HERE.                  IBB50550
       TCH     CHNS7                                                 (2)IBB50560
       SMS     15                                                       IBB50570
       XMT     CHNS2,,1                                                 IBB50580
       TCM     CHNS5,,64+4,0                                            IBB50590
 CHNS1 SNS                         CHANNEL SENSE ON CURRENT INTF.       IBB50600
       CPYD    SNSDTA,,2                                                IBB50610
 CHNS2 TCM     **,,**,0            ATTN ON OTHER INTERFACE . . .        IBB50620
       LIPT    CHWTR               NO - THEN QUIT.                      IBB50630
 CHNS3 ICC     ,,,0                                                     IBB50640
       TCM     CHNSNS+1,,64+1,6    WHAT IS CURRENT INTERFACE . . .      IBB50650
       SMS     0                   HERE IF 0, TO CHNSNS+1 IF 1          IBB50660
 CHNS4 SMS     14                                                       IBB50670
       XMT     CHNS2,,1                                                 IBB50680
       TCM     CHNS6,,64+2,0                                            IBB50690
       TCH     CHNS1                                                    IBB50700
 CHNS5 SMS     14                                                       IBB50710
       TCH     *+2                                                      IBB50720
 CHNS6 SMS     15                                                       IBB50730
       SNS                         CHANNEL SENSE ON OTHER INTERFACE     IBB50740
       CPYD    SNSDT2,,2                                                IBB50750
       LIPT    CHWTR                                                    IBB50760
       SPACE                                                            IBB50770
*                  CHANNEL PROGRAM FOR ISSUEING ORDERS                  IBB50780
       SPACE                                                            IBB50790
 CHPRG SMS     **                                                       IBB50800
       LIPT    *+1                                                      IBB50810
       CTL     **                                                       IBB50820
 CHWTR WTR     ENBAT                                                    IBB50830
       EJECT                                                            IBB50840
STCX   NULL                                                          $6$IBB50847
       IFT     CHEX=0                                                $6$IBB50848
       GOTO    RCHX                                                  $6$IBB50849
       COMMDS  STCMAC                                                $6$IBB50850
       SPACE   1                                                        IBB50940
       BES     ENBAT-CHEX*ENBAT+CHEX**-*                  -7909 OVERLAY-IBB50950
       SPACE   1                                                        IBB50960
RCHX   COMMDS  VAROP,(RCH,**)                                        $6$IBB50970
       SPACE                                                            IBB51060
SCHX   COMMDS  VAROP,(SCH,COMM)                                      $6$IBB51070
       SPACE   1                                                        IBB51160
TCOX   COMMDS  VAROP,(TCO,**)                                        $6$IBB51170
       SPACE                                                            IBB51260
TRCX   COMMDS  VAROP,(TRC,**)                                        $6$IBB51270
       EJECT                                                            IBB51360
TEFX   COMMDS  TEFMAC                                                $6$IBB51370
       SPACE   1                                                        IBB51460
*                        REDUNDANCY COUNT CELLS                         IBB51470
       SPACE   1                                                        IBB51480
URRX   NULL                                                          $6$IBB51490
       DUP     1,HGHCHN                                              $6$IBB51500
       PZE                                                           $6$IBB51510
       SPACE   1                                                        IBB51590
RCTX   NULL                                                          $6$IBB51600
       DUP     1,HGHCHN                                              $6$IBB51610
       PZE     0                                                     $6$IBB51620
       EJECT                                                            IBB51690
ETTX   NULL                                                          $6$IBB51700
SDCX   COMMDS  ETTSDC                                                $6$IBB51710
       SPACE                                                            IBB52040
*                        NON-DATA SELECT TABLE                          IBB52050
       SPACE   1                                                        IBB52060
       WEF     **                  7 WEF                                IBB52070
       BSF     **                  6 BSF                                IBB52080
       BSR     **                  5 BSR                                IBB52090
       RUN     **                  4 RUN                                IBB52100
       REW     **                  3 REW                                IBB52110
       SDN     **                  2 SDNH                               IBB52120
       SDN     **                  1 SDNL                               IBB52130
SELX   BSS     0                                                        IBB52140
       EJECT                                                            IBB52150
*                            X-T-R-A-P                                  IBB52160
       SPACE                                                            IBB52170
 SAVE1 SXA     X2,2                CONTINUE SAVE                        IBB52180
       SXA     X1,1                                                     IBB52190
       SPACE                                                            IBB52280
       SPACE   1                                                        IBB52290
 XTRAP AXT     16,2                FIRST FIND CHANNEL THAT TRAPPED      IBB52300
       NZT     26,2                                                     IBB52310
       TIX     *-1,2,2                                                  IBB52320
       CLA     26,2                                                     IBB52330
       SXA     OUT,2               ONCE FOUND, SAVE ITS INDEX           IBB52340
       PAI                         AND                                  IBB52350
       NZT     TRPSW               EXIT ALREADY SET IF TRPSW NOT 0 HERE IBB52360
       STA     EXIT                SET UP EXIT.                         IBB52370
       CLA     51,2                                                     IBB52380
       PDC     ,1                  SET XR1= -(CHANNEL NO. -1)           IBB52390
       IFT     CHEX=0                                                (9)IBB52399
       CLA     CHXAC,1             CHANNEL ACTIVITY                     IBB52400
       IFT     CHEX=1                                                (9)IBB52401
       TSX     ZERDC2,4            ZERO CHXAC,1 DECREMENT            (9)IBB52402
       TNZ     XTRA1                                                    IBB52410
       CLA     CHXSP,1                                                  IBB52420
       TZE     END9                NON-STANDARD TRAP ENTRY              IBB52430
       STO     CHXAC,1                                                  IBB52440
 XTRA1 STO     TRPSW               SET TRAP SWITCH                      IBB52450
       LDQ     ACOMM                                                    IBB52460
       STQ     COMM                                                     IBB52470
       NZT     FRSW1                                                    IBB52480
       XEC     SCHX,1              STORE CHANNEL INFO IN COMM           IBB52490
       STZ     FRSW1                                                    IBB52500
       IFT     CHEX=0                                                $6$IBB52508
       GOTO    NDEND                                                 $6$IBB52509
 XTRA2 NZT     IBSGAP,1            7909 CHANNEL...                   $6$IBB52510
       TRA     NDEND               IF NO - TO NDEND                     IBB52520
       XEC     SDCX,1              STORE DIAGNOSTIC CHANNEL IN COMMD    IBB52530
       LDI     COMMD               SET D=COMMD                          IBB52540
       STZ     SDSAV                                                    IBB52550
       RIS     ISMK2               INITIALIZE SENSE BITS                IBB52560
 DEND4 LNT     001000              TEST FOR AN UNUSUAL END              IBB52570
       TRA     DEND3                                                    IBB52580
       CLA     50,2                HERE IF AN UNUSUAL END               IBB52590
       SLW     COMM                SET COMM IN CASE OF AN NCI           IBB52600
       TSX     DATNS,4                                                  IBB52610
       CAL     SNSDTA              SET SENSE INDICATORS - - -           IBB52620
       SLW     SDSAV               BITS 12 THRU 35 =SNSDTA AS RECEIVED  IBB52630
       ARS     12                  FROM DATNS. BITS 0 THRU 11 =7909     IBB52640
       IIA                         CONTROL COUNTER AND CHANNEL CK REG.  IBB52650
       TRA     7909R               TO 7909 RECOV. (AC MUST BE NON ZERO) IBB52660
 DEND3 LFT     000600              IS THERE AN ATTENTION SIGNAL...      IBB52670
       TSX     DATNS,4             TO DATNS IF YES                      IBB52680
       LFT     006100              I/O, SEQUENCE, OR INTF CK...         IBB52690
 DEND5 TSX     DEND1,2             TO DEND1 IF YES                      IBB52700
       LXA     COMM,4                                                   IBB52710
       PXD     ,0                                                       IBB52720
       TXH     END9+1,4,SYSTWT     EXIT NOW IF ONLY REASON FOR THE      IBB52730
       TXL     END9+1,4,SYSTWT-1   TRAP WAS AN ATTENTION INTERRUPT.     IBB52740
 DEND2 STZ     DUELL,1             REINITIALIZE U.E. TEST WORD TO ZERO  IBB52750
       LAC     TRPSW,2                                                  IBB52760
       CLA*    TRPSW                                                    IBB52770
       ANA     MSK1                                                     IBB52780
       PDX     ,4                                                       IBB52790
       TXH     END14,4,63          ....    DISK/NEED- 100 THRU 377      IBB52800
       IFT     HTEX=0                                                $6$IBB52809
       GOTO    NDEND                                                 $6$IBB52809
 HTESM LFT     000160              ....    HYPER----- 000 THRU 077      IBB52810
       TRA     END14               DON'T BUMP RECORD COUNT IF AN        IBB52820
       LDQ     1,2                 INTERFACE CK, OPREQ, PRGCK,          IBB52830
       CAL     2,2                 OR IF NDTRN ON A WRITE.              IBB52840
       TQP     *+4                                                      IBB52850
       RFT     000002                                                   IBB52860
       TRA     END14                                                    IBB52870
       TRA     END5-1                                                   IBB52880
       RQL     1                                                        IBB52890
       LLS     0                                                        IBB52900
       TRA     END5                                                     IBB52910
 NDEND IOT                                                              IBB52940
       TSX     END1,4              TO END1 IF I/O CHECK                 IBB52950
 END2  LAC     TRPSW,2             SET XR2=-L(UCW)                      IBB52960
       RIL     777770                                                   IBB52970
       SIL     400000                                                   IBB52980
       LFT     000006                                                   IBB52990
       TRA     END10               EOF OR REDUNDANT WRITE               IBB53000
       TMI     END13               BLANK TAPE WRITTEN                   IBB53010
       LDQ     1,2                                                      IBB53020
       TQP     RED12               TRANSFER IF READ                     IBB53030
       SIL     040000              INDICATE WRITE                       IBB53040
       CAL     4TAG                                                     IBB53050
       XEC     ETTX,1                                                   IBB53060
       ORS     0,2                                                      IBB53070
       ANA     0,2                                                      IBB53080
       TZE     *+2                                                      IBB53090
       SIL     200000              INDICATE EOT CONDITION               IBB53100
       TSX     NRTST,4             TEST FOR NOISE RECORD                IBB53110
       CAL     1B17                TURN OFF REDUNDANCY                  IBB53120
       ALS     0,1                 TRAP BIT                             IBB53130
       COM                                                              IBB53140
       ANS     TRAP                                                     IBB53150
END15  STI     RWIND                                                    IBB53160
END16  CAL     2,2                 ADJUST TAPE POSITION                 IBB53170
       LFT     040000                                                   IBB53180
       ANA     TGMSK                                                    IBB53190
END5   ADD     L(1)                                                     IBB53200
       SLW     2,2                                                      IBB53210
END14  CAL     1,2                                                      IBB53220
       PDX     0,4                                                      IBB53230
       SXA     *+2,4                                                    IBB53240
       CLS     CHXAC,1                                                  IBB53250
       TSX     **,4                ENTER SEL(-)                         IBB53260
       TRA     END9                NORMAL RETURN                        IBB53270
       TRA     END11               STANDARD NOISE RECORD ACTION         IBB53280
       IFT     CHEX=0                                                $6$IBB53288
       GOTO    END14A                                                $6$IBB53289
       ZET     IBSGAP,1                                              $6$IBB53290
       TRA     7909R1                                                   IBB53300
END14A LAC     TRPSW,2                                               $6$IBB53310
       CAL     2,2                                                      IBB53320
       SUB     L(1)                                                     IBB53330
       SLW     2,2                                                      IBB53340
       TRA     RED18                                                    IBB53350
END10  LFT     000002                                                   IBB53360
       TRA     RED22               REDUNDANT WRITE                      IBB53370
       SIL     200000              EOF                                  IBB53380
       STL     TRCX,1                                                   IBB53390
       XEC     TRCX,1              TURN OFF REDUNDANCY                  IBB53400
       CLA     2,2                 UPDATE TAPE POSITION                 IBB53410
       STO     LTPOS               SAVE POSITION BEFORE EOF             IBB53420
       SSP                         CLEAR NOISE CONDITION                IBB53430
       ORA     RHMSK               FOR END OF FILE                      IBB53440
       TRA     END5                                                     IBB53450
 END11 STZ     URRX,1              CLEAR REDUNDANCY COUNTS              IBB53460
       ZET     IBSGAP,1                                              $6$IBB53470
       TRA     END13                                                    IBB53480
       LDI     RWIND               NOISE RECORD                         IBB53490
       LFT     040000                                                   IBB53500
       TRA     END12               TRANSFER IF WRITE                    IBB53510
       TSX     RED10,4             NOISE RECORD DISCARDED               IBB53520
       PZE     TRPSW,,CMT2C                                             IBB53530
       LAC     TRPSW,2                                                  IBB53540
       CAL     2,2                                                      IBB53550
       ORA     MZE                 NOISE RECORD CONDITION               IBB53560
       SUB     L(1)                                                     IBB53570
       SLW     2,2                                                      IBB53580
END13  CAL     CHXAC,1                                                  IBB53590
       TRA     BG1+2               TO READ NEXT RECORD                  IBB53600
END12  TSX     RED10,4             SHORT RECORD WRITTEN                 IBB53610
       PZE     TRPSW,,CMT2B                                             IBB53620
 END9  CLA     CHXSP,1                                                  IBB53630
       SPACE                                                            IBB53640
*                   INITIATE NEXT CHANNEL OPERATION                     IBB53650
       SPACE   1                                                        IBB53660
 BG1   STZ     URRX,1              RESET REDUNDANCY COUNT               IBB53670
       STP     CHXSP,1             RESET SIGN OF CHXSP TO +             IBB53680
       NZT     IBSGAP,1            IGNORE CHECK POINT IF             $6$IBB53690
       NZT     .CHPSW              7909 CHANNEL                      $6$IBB53700
       TRA     *+4                                                      IBB53710
       STZ     CHXSP,1                                                  IBB53720
       STZ     CHXAC,1                                                  IBB53730
       TRA     OUT                 EXIT RIGHT AWAY IF CHECKPOINT        IBB53740
       LRS     0                   SET S(MQ) FOR ISSEK ENTRY            IBB53750
       TSX     ISSEK,4                                                  IBB53760
       EJECT                                                            IBB53770
*                   RESTORE REGISTERS AND INDICATORS                    IBB53780
       SPACE   1                                                        IBB53790
 OUT   AXT     **,2                                                     IBB53800
       STZ     26,2                                                     IBB53810
       ZET     10                                                       IBB53820
       TRA     XTRAP                                                    IBB53830
       STZ     TRPSW                                                    IBB53840
       IFT     CHEX=0                                                (9)IBB53849
       LDI     .IOXSI              RESTORE SENSE INDICATORS,         $6$IBB53850
       IFT     CHEX=1                                                (9)IBB53851
       TSX     CHXA,4              ENSURE CHXAC,1 NE ZERO IF SEEKING (9)IBB53852
 X1    AXT     **,1                                                     IBB53860
X2     AXT     **,2                INDEX REGISTERS,                     IBB53870
       LXD     QP,4                                                     IBB53880
       CAL     QP                  AC INCLUDING QP,                     IBB53890
       LDQ     ACC                                                      IBB53900
       LLS     35                                                       IBB53910
OUT1   TOV     *+1                 AC OVERFLOW INDICATOR,               IBB53920
       LDQ     MQ                  MQ,                                  IBB53930
       IFT     ETMODE=0                                              $6$IBB53938
       GOTO    OUT3                                                  $6$IBB53939
OUT2   ZET     TTR                 RESTORE TRA TRAP MODE                IBB53940
       ETM                         IF ON.                               IBB53950
       STZ     TTR            CLEAR INDICATION                          IBB53960
OUT3   NZT     ENBSW                                                 $6$IBB53980
       ENB*    TRAPX                                                    IBB53990
EXIT   TTR     **                                                       IBB54000
       IFF     ETMODE=0                                              $6$IBB54009
TTR    PZE     **                                                       IBB54010
       TTL     IOEX / ERROR RECOVERY                                    IBB54030
*                          NOISE RECORD TEST                            IBB54040
 NRTST SXA     END1A,4                                                  IBB54050
       LDC     COMM,4                                                   IBB54060
       CAL     COMM                                                     IBB54070
       ORA     FOR                                                      IBB54080
       SBM     -1,4                                                     IBB54090
       PAX     0,4                 WORD COUNT TO IR4                    IBB54100
       TXH     END1A,4,2                                             (9)IBB54110
       TRA     NTEST                                                 (9)IBB54120
       STR                         * PATCH SPACE *                   (9)IBB54130
       SPACE                                                            IBB54140
*                              I/O CHECK                                IBB54150
 END1  AXT     3,2                                                      IBB54160
       SXA     END1A,4                                                  IBB54170
       TSX     PROUT,4                                                  IBB54180
 TST3  PZE     1,1,192                                                  IBB54190
       PZE     CMT8+3,2,1                                               IBB54200
       TSX     PAWS,4                                                   IBB54210
       CLA     TRPSW                                                    IBB54220
 END1A AXT     **,4                                                     IBB54230
       TRA     1,4                                                      IBB54240
       SPACE                                                            IBB54250
       IFT     CHEX=0                                                $6$IBB54258
       GOTO    RED12                                                 $6$IBB54259
*                  7909 I/O, SEQUENCE, AND/OR INTERFACE CHECK           IBB54260
 DEND1 AXC     DEND2,4                                                  IBB54270
       LDQ     RCHX,1                                                   IBB54280
       SLQ     *+1                                                      IBB54290
       RSCA    CHNS2+1             CLEAR CHANNEL CHECK REGISTER         IBB54300
 DEN1A IOT                                                              IBB54310
       TXI     END1+1,2,DEND5+3    I/O CHECK                            IBB54320
       LNT     002000                                                   IBB54330
       TXI     END1+1,2,DEND5+1    INTF CHECK                           IBB54340
       TXI     END1+1,2,DEND5+2    SEQ CHECK                            IBB54350
       EJECT                                                            IBB54370
RED12  NULL                        REDUNDANCY RECOVERY-READ          $6$IBB54380
       SPACE   1                                                        IBB54390
       TSX     NRTST,4             TEST FOR NOISE                    (7)IBB54400
       LNT     400000                                                (7)IBB54410
       TRA     END15               NOISE RECORD                      (7)IBB54420
       LDQ     TRCX,1              IF NOT NOISE                      (7)IBB54430
       SLQ     *+1                 TEST FOR REDUNDANCY               (7)IBB54440
       TRCA    *+2                                                   (7)IBB54450
       TRA     END15               NOT REDUNDANT                     (7)IBB54460
       NZT     RCTX,1              REDUNDANT BUT IS REDUNDANCY       (7)IBB54470
       TRA     END15               SUPPRESSED - YES                  (7)IBB54480
RED18  TSX     RED50,4                                                  IBB54490
       STA     RED13                                                    IBB54500
       TXH     RED15,2,RDUNRT-1    TRANSFER IF PERMANENT REDUNDANCY     IBB54510
RED14  BSRA    **                                                       IBB54520
       TIX     *,2,10              SHOE SHINE EVERY 10 TIMES            IBB54530
       TXH     END13,2,1           TRANSFER IF NOT FIRST TIME           IBB54540
       LAC     TRPSW,4                                                  IBB54550
       CLA     2,4                                                      IBB54560
       TMI     END13                                                    IBB54570
       PAX     0,4                                                      IBB54580
       TXL     END13,4,1                                                IBB54590
       ANA     4TAG                TEST FOR COMPLEMENT RECORD COUNT     IBB54600
       TNZ     END13                                                    IBB54610
       XEC     RED14               BSR                                  IBB54620
       XEC     RED14               BSR                                  IBB54630
RED13  RTBA    **                  RDS                                  IBB54640
       XEC     *-1                 RDS                                  IBB54650
       STL     TCOX,1                                                   IBB54660
       XEC     TCOX,1              HOLD                                 IBB54670
       TRA     END13                                                    IBB54680
RED15  LAC     TRPSW,2             HERE IF PERMANENT REDUNDANCY         IBB54690
       CAL     2,2                                                      IBB54700
       ADD     L(1)                                                     IBB54710
       SLW     2,2                                                      IBB54720
       CLA     TWO                 TEST FOR REDUNDANCY MESSAGE          IBB54730
       ANA     1,2                 SUPPRESSION                          IBB54740
       TNZ     *+3                                                      IBB54750
       TSX     RED10,4                                                  IBB54760
       PZE     TRPSW,,CMT2                                              IBB54770
       CAL     1B17                PERMANENT REDUNDANCY COUNT           IBB54780
       SLW     URRX,1                                                   IBB54790
       SIL     100000                                                   IBB54800
       TRA     STI                                                   (9)IBB54810
       EJECT                                                            IBB54820
*                     REDUNDANCY RECOVERY - WRITE                       IBB54830
       SPACE   1                                                        IBB54840
RED20  TSX     RED10,4             NOISE IN ERASED AREA                 IBB54850
       PZE     TRPSW,,CMT3                                              IBB54860
       TRA     END13                                                    IBB54870
RED22  TMI     RED20               TO REDUNDANT ERASE                   IBB54880
       SSM                         HERE IF REDUNDANT WRITE              IBB54890
       STO     CHXAC,1                                                  IBB54900
       TSX     RED50,4                                                  IBB54910
       STA     RED6                                                     IBB54920
       XEC     RED14               BSR                                  IBB54930
       CAL     4TAG                                                     IBB54940
       XEC     ETTX,1                                                   IBB54950
       ORS*    CHXAC,1             SET EOT BIT IN UCB.                  IBB54960
       TIX     *,2,25              PRINT MESSAGE EVERY 25 TIMES         IBB54970
       TXL     RED5,2,24                                                IBB54980
       TSX     RED10,4             25 ERASES                            IBB54990
       PZE     TRPSW,,CMT2A                                             IBB55000
RED5   CAL     RED7                                                     IBB55010
       STA     RCHX,1                                                   IBB55020
       TSX     NRTST,4             USE NOISE RECORD TEST ROUTINE     $6$IBB55021
       PAX     ,4                  TO COMPUTE PARTIAL RECORD LENGTH  $6$IBB55022
       ENB     L(0)                ALLOW WRS TO RESET COMMAND TRAP      IBB55030
RED6   WRS     **                  WRITE BLANK TAPE                     IBB55040
       TIX     RED6,4,ASDENS*7/12  TO COVER ALL OF IT                $6$IBB55041
       XEC     RCHX,1                                                   IBB55050
       CAL     1B17                INDICATE ERASE AREA WRITTEN          IBB55060
       ORS     URRX,1                                                   IBB55070
       TRA     OUT                                                      IBB55080
RED50  CAL     URRX,1              UPDATE COUNT                         IBB55090
       ADD     L(1)                                                     IBB55100
       SLW     URRX,1                                                   IBB55110
RED7   PAX     PTH,2                                                    IBB55120
       CAL*    CHXAC,1                                                  IBB55130
       ARS     18                  UNIT TO ADDRESS                      IBB55140
       STA     RED14                                                    IBB55150
       TRA     1,4                                                      IBB55160
       EJECT                                                            IBB55170
*                       PRINT TAPE ERROR MESSAGE                        IBB55180
       SPACE   1                                                        IBB55190
RED10  SXA     RED11,2                                                  IBB55200
       SXA     RED11+1,4                                                IBB55210
       CAL     1,4                 MOVE VARIABLE PART OF MESSAGE        IBB55220
       PDX     0,2                                                      IBB55230
       SXA     REDL2,2                                                  IBB55240
       CAL*    1,4                                                      IBB55250
       PAC     0,2                 -L(UCW)                              IBB55260
       CLA     2,2                 TAPE POSITION                        IBB55270
       TSX     BCVDEC-1,4                                               IBB55280
       STQ     CMT1+3              FILE COUNT                           IBB55290
       CLA     2,2                                                      IBB55300
       TSX     BCVDEC,4                                                 IBB55310
       STQ     CMT1+1              RECORD COUNT                         IBB55320
       LDQ     0,2                                                      IBB55330
       TSX     CVPRT,4                                                  IBB55340
       PZE     CMT1,,4                                                  IBB55350
       TSX     PROUT,4                                                  IBB55360
       PZE     1                                                        IBB55370
 REDL2 PZE     **,,3+512*DBLSP                                          IBB55380
RED11  AXT     **,2                                                     IBB55390
       AXT     **,4                                                     IBB55400
       TRA     2,4                                                      IBB55410
       EJECT                                                            IBB55420
       IFT     CHEX=0                                                $6$IBB55428
       GOTO    ACTIV                                                 $6$IBB55429
*                   SUBROUTINE TO HAVE CHANNEL DO A SENSE. WHEN THE     IBB55430
*                   CHANNEL IS DONE THE ROUTINE WILL TURN OFF ALL       IBB55440
*                   AF AND PF FLAGS FOR THOSE UCBS RECEIVING ATTN.      IBB55450
*                   A PACKING ROUTINE FOR EACH 7909 DEVICE IS NEEDED.   IBB55460
       SPACE                                                            IBB55470
 DATNS SXA     DATN6,4                                                  IBB55480
       STZ     SNSDT2                                                   IBB55490
       STZ     SNSDT2+1                                                 IBB55500
       SXD     *+2,1                                                    IBB55510
       LXD     *+1,2                                                    IBB55520
 DATK  TXI     *+1,2,**            SET XR2= 2*(1-CHANNEL NO.)           IBB55530
       CAL     DATN1+1             SET UP CHANNEL INTERUPT CELL         IBB55540
       STA     35,2                SO THAT IF CHANNEL SENSE PROGRAM     IBB55550
       XEC     STCX,1              CAUSES AN INTERRUPT CHANNEL WILL GO  IBB55560
       STL     TCOX,1              TO CHNSNS+2 INSTEAD OF CHNSNS.       IBB55570
       XEC     TCOX,1                                                   IBB55580
       SUB     ADJ1                WHEN CHANNEL IS DONE,                IBB55590
       STA     35,2                RESTORE INTERRUPT CELL.              IBB55600
       CLA     SNSDTA                                                   IBB55610
       STO     TRUSD                                                    IBB55620
       AXT     4,4                                                      IBB55630
       CLA*    CHXAC,1                                                  IBB55640
 DATN1 ANA     MSK1                NOW DETERMINE DEVICE INDICATED IN    IBB55650
       PDX     CHNSNS+2,2          AC AND TRA TO CORRECT PACK ROUTINE   IBB55660
       CLA     SNSDTA+4,4          SET AC AND MQ TO THE                 IBB55670
       LDQ     SNSDTA+5,4          APPLICABLE SENSE DATA.               IBB55680
       IFF     HTEX=0                                                $6$IBB55689
       TXL     HTPAC,2,63          ....    HYPER----- 000 THRU 077      IBB55690
 DKPAC LGR     6                   ....    DISK------ 100 THRU 177      IBB55700
       TSX     PAKER,2             GO PACK ATTENTION BITS               IBB55710
 DATN2 CLA     UCAA,1              RETURN HERE WHEN BITS ARE PACKED  $6$IBB55720
       PDC     ,2                                                       IBB55730
       TXL     DATN4,2,0           IS THERE A SECOND DEVICE...          IBB55740
       CLA*    UCBA,1              HERE IF YES                       $6$IBB55750
       ERA*    CHXAC,1                                                  IBB55760
       ANA     1B12                                                     IBB55770
       TNX     DAT2A,4,2                                                IBB55780
       STQ     DATSV                                                    IBB55790
       TZE     *+3                                                      IBB55800
       CLA*    UCBA,1                                                $6$IBB55810
       TRA     DATN1                                                    IBB55820
       CLA*    STCX,1                                                   IBB55830
       TRA     DATN1                                                    IBB55840
 DAT2A TZE     DATN3                                                    IBB55850
       CAL     DATSV                                                    IBB55860
       XCL                                                              IBB55870
       TRA     *+2                                                      IBB55880
 DATN3 CAL     DATSV                                                    IBB55890
       ARS     ,2                                                       IBB55900
       LGL     ,2                                                       IBB55910
       XCL                         JOIN ALL BITS TOGETHER IN MQ         IBB55920
 DATN4 CAL     STCX,1                                                   IBB55930
       ADD     *+3                                                      IBB55940
       STA     DATN7                                                    IBB55950
       CAL     TEFX,1                                                   IBB55960
       PAX     6,2                                                      IBB55970
       CAL     IBSGAP,1            GET NEED GAP CONSTANT ($*),=$*)   $6$IBB55980
 DATN5 PBT                         IS THERE A UNIT...                   IBB55990
       TXI     DATN8,2,4           NO- ITS A NEED GAP.                  IBB56000
       TQP     DATN8               YES- IF S(MQ)=- THEN                 IBB56010
       SLW     DATSV               THERE IS AN ATTENTION                IBB56020
       CAL     DATK                RECEIVED FOR THE UCB.                IBB56030
 DATN7 STP     **,2                TURN OFF THE AF AND PF FLAGS.        IBB56040
       CAL     DATSV                                                    IBB56050
 DATN8 LGL     1                   O.K. - MOVE ON TO NEXT BIT           IBB56060
       TIX     DATN5,2,4                                                IBB56070
 DATN6 AXT     **,4                                                     IBB56080
       TRA     1,4                                                      IBB56090
       SPACE                                                            IBB56100
 PAKER SXA     *+7,2                                                    IBB56110
       AXT     6,2                 PACK 6 BYTES (BITS2,4,5,6) OF MQ     IBB56120
       LLS     1                   INTO H.O. 24 BITS OF MQ              IBB56130
       RQL     2                                                        IBB56140
       LGL     3                                                        IBB56150
       TIX     *-3,2,1                                                  IBB56160
       LGR     24                                                       IBB56170
       AXT     **,2                                                     IBB56180
       TRA     1,2                                                      IBB56190
       SPACE                                                            IBB56200
       IFT     HTEX=0                                                $6$IBB56208
       GOTO    7909R1                                                $6$IBB56209
*                   PACKING ROUTINES NEEDED FOR DATNS.                  IBB56210
*                   THE FOLLOWING MUST BE DONE FOR EACH DEVICE.         IBB56220
*                       1. IF IT IS THE CURRENT DEVICE, ALTER SNSDTA    IBB56230
*                       SO IT MAY BE PUT IN THE SENSE IND. UPON         IBB56240
*                       ENTRANCE TO (SEL-). ALSO FOR USE IN RECOVERY.   IBB56250
*                       2. PACK THE ATTN BITS IN THE H.O. OF MQ.        IBB56260
       SPACE                                                            IBB56270
 HTPAC TXL     HTP1,4,3            HYPERTAPE                            IBB56280
       LGR     24                                                       IBB56290
       ARS     6                                                        IBB56300
       LGR     6                                                        IBB56310
       TSX     PAKER,2             FIX UP SNSDTA ONLY IF H.T.           IBB56320
       STQ     SNSDTA              IS THE CURRENT DEVICE.               IBB56330
       LDQ     SNSDTA+5,4                                               IBB56340
 HTP1  RQL     12                                                       IBB56350
       TRA     DKPAC+1             GO PACK ATTENTION BITS               IBB56360
       SPACE                                                            IBB56380
       EJECT                                                            IBB56400
7909R1 NULL                        7909 CHANNEL DEVICE RECOVERY      $6$IBB56410
       SPACE                                                            IBB56420
       PXD     ,0                  LATER, IF 9CHEM=0 THEN WILL       $6$IBB56430
 7909R STO     9CHEM               SET UCB+2=LTPOS IF H.T.              IBB56440
       IOT                         TURN OFF I/O CHECK                   IBB56450
 CHNPT NOP     CHNS3               INDICATOR IF ON.                     IBB56460
       CLA     URRX,1                                                   IBB56470
       PAX     ,2                  SET XR2=URRX                         IBB56480
       CLA*    TRPSW                                                    IBB56490
       ANA     MSK1                                                     IBB56500
 HIGH7 PDX     28672,4                                                  IBB56510
       CAL     SDSAV               SDSAV=SENSE DATA                     IBB56520
       ANA     DUEK5               REMOVE UNWANTED BITS                 IBB56530
       ZET     RCTX,1                                                   IBB56540
       ORA*    RCTX,1                                                   IBB56550
       ZET     RCTX,1                                                   IBB56560
       ERA*    RCTX,1                                                   IBB56570
       TZE     DEND2                                                    IBB56580
       STI     DUESI               HERE FOR A RECOVERY ATTEMPT          IBB56590
 DNGAD PAI     588                 SET AC NOT ZERO IF U.E. IS THE SAME  IBB56600
       ANA     DUELL,1             ONE AS THE IMMEDIATE LAST ONE.       IBB56610
       IFF     HTEX=0                                                $6$IBB56619
       TXL     HTRCV,4,63          ....    HYPER----- 000 THRU 077      IBB56620
       SPACE                                                            IBB56630
       IFT     DUEX=0                                                $6$IBB56638
       GOTO    UEMES                                                 $6$IBB56639
*                                  ....    DISK/NEED- 100 THRU 377      IBB56640
       SPACE                                                            IBB56650
 DKRCV TXL     9RESP+1,2,3         1. ENTER (SEL+) 4 MORE TIMES         IBB56660
       TXH     DKREN,4,191         2. IF NEED ENTER (SEL-), IF DISK-    IBB56670
       TXH     DKREN,2,7           3. SEEK C.E., SEEK 0, SEEK X         IBB56680
       TXH     9RESP+1,2,4         4. ENTER (SEL+) 4 MORE TIMES         IBB56690
       LAC     TRPSW,2             5. ENTER (SEL-)                      IBB56700
       CAL     2,2                                                      IBB56710
       SLW     TTTT1               SAVE THE PRESENT TTTT LOCATED IN     IBB56720
       ANA     HIGH7               THE UCB.                             IBB56730
       ORA     DNGAD               NOW PLACE AN ILLEGAL TTTT  (9'00)    IBB56740
       STA     2,2                 IN THE UCB.                          IBB56750
       CLA     3,2                                                      IBB56760
       STO     TTTT2                                                    IBB56770
       CLS     L(0)                                                     IBB56780
       AXT     0,4                                                      IBB56790
DUEN7  STO     3,2                 SET S(UCB+3) = -                     IBB56800
       SXA     DUEX4,4             SAVE K                               IBB56810
       TSX     ISSK1,4             GO ISSUE ONE SEEK                    IBB56820
 9SGT1 XEC     STCX,1              ALLOW FOR TESTING OF                 IBB56830
       CAL     TRPCH               INTERRUPTS AND ENABLE                IBB56840
       ALS     0,1                 TRAPS ON THE TRAPPED                 IBB56850
       TRA     PRT0                CHANNEL AND WAIT.                    IBB56860
 9SGT2 TSX     DATNS,4             PROCESS ALL ATTENTIONS RECEIVED.     IBB56870
       LAC     TRPSW,2                                                  IBB56880
       CLA     2,2                 IF AF FLAG STILL ON LOOP             IBB56890
       TMI     9SGT1               BACK AND CONTINUE TO WAIT            IBB56900
 DUEX4 AXT     **,4                HERE IF DESIRED ATTENTION RECEIVED   IBB56910
       TXH     9RESP+3,4,4                                              IBB56920
       CLS     3,2                                                      IBB56930
       TXH     DUE10,4,0           HERE IF K LS OR = TO 4               IBB56940
       CAL     TTTT1               IF K=0, RESTORE THE ORIGINAL         IBB56950
       SLW     2,2                 TTTT IN THE UCB.                     IBB56960
       CLS     TTTT2                                                    IBB56970
 DUE10 TXI     DUEN7,4,3           REISSUE SEEK WITH K INCREASED BY 3   IBB56980
 DKREN LAC     TRPSW,4                                                  IBB56990
       LDQ     3,4                                                      IBB57000
       CAL     2,4                                                      IBB57010
       LGL     12                                                       IBB57020
       ANA     ISMK2                                                    IBB57030
       SLW     9MSS1+3                                                  IBB57040
       LDQ     1,4                                                      IBB57050
       AXT     4,4                 FALL INTO UEMES                      IBB57060
       SPACE                                                            IBB57080
 UEMES CAL     CMT2+1              END OF 7909 RECOVERY -               IBB57090
       TQP     *+2                                                      IBB57100
       CAL     CMT2A+2             PRINT UNUSUAL END MESSAGE AND THEN   IBB57110
       SLW     9MSS1               GO ENTER (SEL-).                     IBB57120
       SXD     UEMS4,4                                                  IBB57130
       LDQ     TRUSD               UPON ENTRY TO UEMES - - -            IBB57140
       AXT     4,2                   1. MQ=UCB+1                        IBB57150
 UEMS1 TSX     BCD5A,4               2. XR4=4 IF DISK                   IBB57160
       SLW     ERMES+4,2                   =2 IF HYPER                  IBB57170
       TSX     BCD5A,4                                                  IBB57180
       SLW     ERMES+5,2                                                IBB57190
       LDQ     SNSDTA+1                                                 IBB57200
       TIX     UEMS1,2,2                                                IBB57210
       LDQ*    TRPSW                                                    IBB57220
       TSX     CVPRT,4             PRINT FIRST LINE                     IBB57230
 UEMS4 PZE     9MSS1,,**                                                IBB57240
       TSX     PROUT,4             PRINT SECOND LINE                    IBB57250
       PZE     1                                                        IBB57260
       PZE     ERMES,,4                                                 IBB57270
 UEMS5 LDI     DUESI               RESTORE SENSE INDICATORS AND         IBB57280
       TRA     DEND2               RETURN FOR ENTRY TO (SEL-)           IBB57290
 DUEK5 OCT     577777770000                                             IBB57300
DUELL  BSS     HGHCHN                                                $6$IBB57310
       SPACE                                                            IBB57320
       IFT     HTEX=0                                                $6$IBB57328
       GOTO    9RESP                                                 $6$IBB57329
 HOPRQ SXA     HOPR1,4             SUBROUTINE (USED BY HT RECOV AND     IBB57330
       RIL     743777              ISSEK AND $AS) TO PRINT              IBB57340
       PIA                         NTRDY                                IBB57350
       ARS     11                  NTLOD                                IBB57360
       LDQ*    CHXAC,1             OR                                   IBB57370
       PDX     ,2                  FILPR.  ROUTINE WILL EXIT ONLY       IBB57380
       TXL     *+2,2,3             AFTER OPERATOR PRESSES START.        IBB57390
       TXI     *-1,2,-1                                                 IBB57400
       TSX     CVPRT,4                                                  IBB57410
       PZE     HTMS2+3,2,1                                              IBB57420
       TSX     PAUSE,4                                                  IBB57430
 HOPR1 AXT     **,4                                                     IBB57440
       TRA     1,4                                                      IBB57450
 HTMS2 BCI     3, NTRDY NTLOD FILPR                                     IBB57460
       EJECT                                                            IBB57470
*                            HYPERTAPE RECOVERY                         IBB57480
       SPACE                                                            IBB57490
 HTRCV LAC     TRPSW,4                                                  IBB57500
       LDQ     2,4                 IF FROM RETURN 3 OF (SEL -) THEN     IBB57510
       NZT     9CHEM               SET 2,4=LTPOS AND DON'T CHANGE       IBB57520
       LDQ     LTPOS               LTPOS. IF OTHERWISE (9CHEM NOT 0)    IBB57530
       STQ     LTPOS               SET LTPOS=2,4 AND DON'T CHANGE 2,4.  IBB57540
       STQ     2,4                                                      IBB57550
       LDQ     1,4                                                      IBB57560
       TQP     *+2                                                      IBB57570
       LNT     004000              IS THERE A FILPR ON WRITE,           IBB57580
       LFT     030000              OR NTRDY OR NTLOD                    IBB57590
       TRA     HOPRE               IF YES - TO HOPRE                    IBB57600
 HFPRT RNT     400000                                                   IBB57610
       LFT     000037              IS THERE A DATA CHECK                IBB57620
       TRA     HDATC               TO HDATC IF YES                      IBB57630
       LFT     001500              IS THERE A PROGRAM CK                IBB57640
       TRA     HPRGC               IF YES - TO HPRGC                    IBB57650
 HEXCN RFT     100000              HERE IF AN EXCEPTIONAL CONDITION     IBB57660
       TRA     HEXC2                                                    IBB57670
       RNT     040000                                                   IBB57680
       TRA     HNDTR                                                    IBB57690
 HEXC1 CAL     4TAG                IF EWA WRITE - PUT EWA               IBB57700
       ORS     0,4                 FLAG ON IN UCB AND RETURN            IBB57710
       TRA     UEMS5               TO ENTER (SEL-)                      IBB57720
 HEXC2 CAL     2,4                                                      IBB57730
       ORA     RHMSK               IF EOF - SET TAG AND ADDR IN UCB+2   IBB57740
       RQL     1                                                        IBB57750
       TQP     *+2                 TO 777777 IF READ FORWARD, OR        IBB57760
       ERA     RHMSK               TO 000000 IF READ BACKWARD.          IBB57770
       SLW     2,4                                                      IBB57780
       TRA     UEMS5                                                    IBB57790
 HNDTR CLA     SDSAV               HERE IF AT BOT OR NDTRN              IBB57800
       ANA     CHNS1               IF NEITHER - JUST EXIT.              IBB57810
       TZE     UEMS5               MAY BE AN NCI.                       IBB57820
       LNT     000200              IF ATBOT - TO HPRGC                  IBB57830
       TQP     HDATC               MUST HAVE A NDTRN                    IBB57840
       TZE     9RESP                                                    IBB57850
       LDI     0,4                 IF AT BOT                            IBB57860
       RIR     400000              TURN OFF EWA FLAG IF ON              IBB57870
       STI     0,4                 AND                                  IBB57880
       STZ     2,4                 ZERO OUT FILE AND RECORD COUNT.      IBB57890
 HPRGC TZE     9RESP                                                    IBB57900
 HTFIN AXT     2,4                                                      IBB57910
       TRA     UEMES                                                    IBB57920
 HDATC TNZ     *+3                 HERE IF A DATA CHECK.                IBB57930
       STZ     URRX,1                                                   IBB57940
       AXT     0,2                                                      IBB57950
       TXH     HTFIN,2,9                                                IBB57960
       AXT     34,2                                                     IBB57970
       STQ     HDATS                                                    IBB57980
       TQP     HDAT2                                                    IBB57990
 HDAT1 SXD     *+2,2                                                    IBB58000
       TSX     NDSEL+1,4           DATA CHECK ERROR                     IBB58010
       PZE     TRPSW,,**           IF WRITE - HBSR THEN HERG            IBB58020
       LAC     TRPSW,4             CANCEL NDATA RECORD AND FILE         IBB58030
       CLA     LTPOS               ADJUSTMENT.                          IBB58040
       STO     2,4                                                      IBB58050
       CLA     HDATS               IF RDFWD HBSR                        IBB58060
       TPL     9RESP+1             IF RDBWD HSKR                        IBB58070
       STZ     HDATS                                                    IBB58080
       TXI     HDAT1,2,-2                                               IBB58090
 HDAT2 RQL     1                                                        IBB58100
       TQP     HDAT1                                                    IBB58110
       TXI     HDAT1,2,2                                                IBB58120
 HOPRE CLA     NDS1                HERE IF NTRDY, NTLOD, OR FILPR       IBB58130
       ORA     1,4                 **** TAKE ACTION 4. ****             IBB58140
       STP     1,4                                                      IBB58150
       TSX     HOPRQ,4             AFTER HOPRQ FALL INTO 9RESP          IBB58160
       SPACE                                                            IBB58180
 9RESP STZ     URRX,1              HERE TO REENTER (SEL+)               IBB58190
       CAL     SDSAV                                                    IBB58200
       SLW     DUELL,1             SAVE THE UE INDICATION FOR NEXT TIME IBB58210
       TSX     RED50,4             INCREMENT URRX BY ONE.               IBB58220
       TRA     END13               ERROR CONDITION. NEXT, REENTER (SEL+)IBB58230
       TTL     IOEX / (ACTIV                                            IBB58250
ACTIV  NULL                                                          $6$IBB58259
*      TSX     ACTV,4                                                   IBB58260
*      P       FILE,T                                                   IBB58270
       SPACE   1                                                        IBB58280
*            EFFECTIVE ADDRESS (FILE,) MUST CONTAIN UCW IN              IBB58290
*             IN ITS ADDRESS. IR1 AND IR2 ARE PERMISSIBLE               IBB58300
*                                FOR T.                                 IBB58310
*           P,PZE, ACTIVATES THE CHANNEL ASSOCIATED WITH THE            IBB58320
*                  SPECIFIED UNIT, IF IT IS DORMANT.                    IBB58330
*           =MZE, ASSIGNS CHANNEL PRIORITY TO THE SPECIFIED             IBB58340
*              UNIT. IF ACTV IS ENTERED AT NON-TRAP TIME,               IBB58350
*              IT WAITS UNTIL XTRAP ENTERS SEL(+) FOR THE UNIT          IBB58360
       SPACE   1                                                        IBB58370
       ENB     L(0)                                                  $6$IBB58380
       NZT     TRPSW                                                    IBB58390
       IFT     CHEX=0                                                (9)IBB58399
       SXA     ACTX1,1             SAVE IR1                             IBB58400
       IFT     CHEX=1                                                (9)IBB58401
       SXA     ACTX1B,1            SAVE IR1                          (9)IBB58402
       SXA     ACTY1,1                                                  IBB58410
       CAL*    1,4                                                      IBB58420
       STA     *+1                 L(UCW)                               IBB58430
ACT1   CAL     **                                                       IBB58440
       ARS     9                                                        IBB58450
       ANA     ACT2                                                     IBB58460
       PDC     ,1             SET XR1=-(CHANNEL NO.)                    IBB58470
       NZT     TRPSW                                                    IBB58480
       TXI     ACTY1+2,1,1         SET XR1=-(CHANNEL NO -1)             IBB58490
       CAL     ACT1                                                     IBB58500
       STA     CHXSP-1,1           IF TRAP TIME - JUST GIVE             IBB58510
 ACTY1 AXT     **,1                UNIT PRIORITY AND THEN               IBB58520
       TRA     2,4                 EXIT.                                IBB58530
       SXA     ACTX2,2        SAVE XR2                                  IBB58540
       SXA     ACTX2+1,4      SAVE XR4                                  IBB58550
       IFT     CHEX=0                                                (9)IBB58559
       STI     ACTSI          SAVE SI                                   IBB58560
       IFT     CHEX=1                                                (9)IBB58561
       TRA     ZERDC1                                                (9)IBB58562
       CLS     1,4                                                      IBB58570
       ZET     CHXAC,1             IS CHANNEL DORMANT...                IBB58580
 ACT2  TXI     ACT6,0,15           NO-TRA TO ACT6                       IBB58590
       STO     ACSSV                                                    IBB58600
       IFT     CHEX=0                                                $6$IBB58608
       GOTO    ACT9                                                  $6$IBB58609
 ACT2A CLA     CHXSP,1                                                  IBB58610
       TZE     ACT9                HERE IF JUST AN ATTN EXPECTED        IBB58620
       STA     CHXAC,1                                                  IBB58630
       LDQ     RCHX,1                                                   IBB58640
       SLQ     *+1                                                      IBB58650
       RCHA    CHNPT               POINT CHNNEL TO CHNS3                IBB58660
       TSX     DATNS,4                                                  IBB58670
       STZ     CHXAC,1                                                  IBB58680
 ACT9  LDQ     ACSSV                                                    IBB58700
       STZ     URRX,1              SET S(MQ)=-S(1,4), URRX=0,           IBB58710
       CAL     ACT1                           A(AC)=L(UCB)              IBB58720
       STD     TRPSW                                                    IBB58730
       STD     ENBSW                                                    IBB58740
       TSX     ISSEK,4             UPON EXIT FROM ISSEK, NON ZERO       IBB58750
       STZ     TRPSW               AC MEANS AN MZE ACTIV ENTRY          IBB58760
       AXT     ACTX2-1,4           WITH A SEEK NEEDED.                  IBB58770
       ZET     FRSW1                                                    IBB58780
       TRA     PRT2                GO PROCESS THE CHANNEL A TRAP.       IBB58790
       SXD     ENBSW,0                                                  IBB58800
 ACTX2 AXT     **,2           RESTORE XR2                               IBB58810
       AXT     **,4           RESTORE XR4                               IBB58820
       LDI     ACTSI          RESTORE SI                                IBB58830
       TNZ     ACT8                DO WE HAVE TO WAIT FOR A (SEL+)...   IBB58840
       IFT     CHEX=0                                                (9)IBB58849
 ACTX1 AXT     **,1           NO-RESTORE XR1, ENABLE, AND RETURN        IBB58850
       IFT     CHEX=1                                                (9)IBB58851
ACTX1P TRA     ACTX1A              NO-RESTORE XR1,ENABLE, AND RETURN (9)IBB58852
       IFT     CHEX=0                                                (9)IBB58859
       TXI     PWEX2+1,4,-1        EXIT THRU PAUSE                      IBB58860
       IFT     CHEX=1                                                (9)IBB58861
       STR                         *PATCH SPACE*                     (9)IBB58862
 ACT6  TPL     ACT7                HERE IF CHANNEL IS ACTIVE            IBB58870
       IFT     CHEX=0                                                $6$IBB58878
       GOTO    ACT6B                                                 $6$IBB58879
 ACT6A LAC     ACT1,2                                                   IBB58880
       CAL     2,2                 ON A PZE ENTRY,                      IBB58890
       ANA     MZE                 IF A 7909 CHANNEL AND THE AF FLAG    IBB58900
       ZET     IBSGAP,1            IS ON - SET S(CHXSP,1)=-          $6$IBB58910
       ORS     CHXSP,1                                                  IBB58920
 ACT6B ZAC                                                           $6$IBB58940
       TRA     ACTX2                                                    IBB58950
 ACT7  CAL     ACT1                HERE IF AN MZE ENTRY                 IBB58960
       STA     CHXSP,1             SET CHANNEL PRIORITY                 IBB58970
 ACT8  CLA     CHXSP,1             HERE TO ENABLE TRAPS AND             IBB58980
       ENB*    TRAPX               WAIT UNTIL XTRAP ENTERS (SEL+) FOR   IBB58990
       LAS     CHXAC,1                THE SPECIFIED UNIT,               IBB59000
       NZT     CHXSP,1             OR THE CHANNEL GOES                  IBB59010
       IFT     CHEX=0                                                (9)IBB59019
       TRA     ACTX1                    DORMANT, BEFORE RETURNING.      IBB59020
       IFT     CHEX=1                                                (9)IBB59021
       TRA     ACTX1P              DORMANT, BEFORE RETURNING.        (9)IBB59022
       ZET     NDSSW               NDSSW WILL BE NON ZERO ONLY          IBB59030
       IFT     CHEX=0                                                (9)IBB59039
       TRA     ACTX1               IF NON TRAP TIME NON DATA SELECT     IBB59040
       IFT     CHEX=1                                                (9)IBB59041
       TRA     ACTX1P              IF NON TRAP TIME NON DATA SELECT  (9)IBB59042
       TRA     ACT8+2              PLUS HAS BEEN ENTERED.               IBB59050
       TTL     IOEX / NON-DATA SELECT (NDSEL)                           IBB59060
*                       NON-DATA SELECT ROUTINE                         IBB59070
       SPACE   1                                                        IBB59080
*      TSX     NDSEL,4                                                  IBB59090
*      PZE     FILE,T,ND                                                IBB59100
*      EOT RETURN                  APPLIES ONLY TO WEF                  IBB59110
*      NORMAL RETURN                                                    IBB59120
       SPACE   1                                                        IBB59130
*          ND= 00=NOP        05=BSR      31=HRUN  36=HSKR               IBB59140
*              01=SDNL       06=BSF      32=HERG  37=HSKF               IBB59150
*              02=SDNH       07=WEF      33=HWTM  38=HCHC               IBB59160
*              03=REW        28=HCCR     34=HBSR  39=HUNL               IBB59170
*              04=RUN        30=HRWD     35=HBSF  42=HFPN               IBB59180
       SPACE   1                                                        IBB59190
 NDATA ENB     L(0)                                                     IBB59200
       CAL*    1,4                                                      IBB59210
       ZET     TRPSW                                                    IBB59220
       TRA     NDS6                                                     IBB59230
       STA     WEF1                SET WEF1=L(UCW) ONLY IF              IBB59240
       SXA     NDSX1,1             AT NON-TRAP TIME.                    IBB59250
       SXA     NDSX1+1,2                                                IBB59260
       STI     NDSSI                                                    IBB59270
 NDS6  STA     WEF2                ALWAYS SET WEF2=L(UCW)               IBB59280
       SXA     NDTX1,1                                                  IBB59290
       SXA     NDTX1+1,2                                                IBB59300
       STI     NDTSI                                                    IBB59310
       CAL     1,4                                                      IBB59320
 NDOUT PDX     **,2                SET XR2=ND                           IBB59330
       SXA     *+1,4                                                    IBB59340
       AXC     **,1                                                     IBB59350
       TXI     *+1,1,2             SET XR1=EXIT=L(TSX+2)                IBB59360
       SXA     NDOUT,1                                                  IBB59370
       TXL     NDTX1,2,0           TRA OUT IF ND=0 (NOP)                IBB59380
       LDI*    WEF2                                                     IBB59390
       LFT     000100                                                   IBB59400
 NDS6A TXL     NDTX1,0,15          EXIT IF CARD, DISK, OR NEED          IBB59410
       LAC     WEF2,4              SET XR4=-L(UCB)                      IBB59420
       ZET     TRPSW                                                    IBB59430
       TRA     NDSGH+1             TO NDSGH+1 IF AT TRAP TIME           IBB59440
       NZT     1,4                 FREE THE UNIT IF IT IS ACTIVE.       IBB59450
       TRA     NDS4                OTHERWISE, GO TO NDS4                IBB59460
       TSX     ACTV+1,4                                                 IBB59470
       MZE     WEF1                                                     IBB59480
       LAC     WEF1,4              RESTORE XR4                          IBB59490
       ZET     1,4                                                      IBB59500
       TRA     *-1                                                      IBB59510
       ENB     L(0)                WHEN UNIT FREE, DISABLE TRAPS        IBB59520
 NDS4  SXA     NDS1,2                                                   IBB59530
       CLA     NDS1                                                     IBB59540
       STO     1,4                                                      IBB59550
       SXA     NDSGH,1                                                  IBB59560
       IFT     HTEX=0                                                $6$IBB59568
       GOTO    NDS7                                                  $6$IBB59569
 NDS4A TXL     NDS7,2,27                                                IBB59570
       TXL     *+2,2,31                                                 IBB59580
       TXL     NDS7,2,37                                                IBB59590
       SLW     1,4                 IF ND=28,30,31,38,39, OR 42 GO TO    IBB59600
 NDS7  TSX     ACTV+1,4            ACTV (MZE) WITH S(UCB+1)=+           IBB59620
       MZE     WEF1                                                     IBB59630
       STZ     NDSSW               ON RETURN FROM ACTIV                 IBB59640
 NDSX1 AXT     **,1                TRAPS WILL BE ENABLED.               IBB59650
       AXT     **,2                                                     IBB59660
       LDI     NDSSI                                                    IBB59670
 NDSGH TRA     **                                                       IBB59680
       IFT     HTEX=0                                                $6$IBB59688
       GOTO    NDS7B                                                 $6$IBB59689
 NDS7A TXL     *+3,2,27            NDSEL ILLEGAL DURING TRAP TIME       IBB59690
       TXL     NDERR,2,31          FOR ATTENTION TYPE ORDERS.           IBB59700
       TXH     NDERR,2,37                                               IBB59710
NDS7B  IIS*    TRPSW               ALSO -                            $6$IBB59730
       LFT     017000              ERROR IF UNIT NOT ON THE SAME        IBB59740
       TRA     NDERR               CHANNEL AS THE TRAP CHANNEL.         IBB59750
       CLA*    TRPSW                                                    IBB59760
       ARS     9                                                        IBB59770
       ANA     NDS6A                                                    IBB59780
       PDC     ,1                                                       IBB59790
       TXI     *+1,1,1             SET XR1=-(CHANNEL NUMBER-1)          IBB59800
       CLA     1,4                                                      IBB59810
       STO     NDSAV                                                    IBB59820
       SXA     NDS1,2                                                   IBB59830
       CLA     NDS1                                                     IBB59840
       STO     1,4                                                      IBB59850
       CLA     WEF2                                                     IBB59860
       TSX     NDS1+2,4            ENTER (SEL+) DIRECTLY                IBB59870
 WEF2  PZE     **                                                       IBB59880
       CLA     NDSAV                                                    IBB59890
       STO     1,2                 RESTORE UCB+1                        IBB59900
 NDTX1 AXT     **,1                                                     IBB59910
       AXT     **,2                                                     IBB59920
       LDI     NDTSI                                                    IBB59930
       LAC     NDOUT,4             NOW EXIT                             IBB59940
       TXI     PWEX2,4,1           EXIT THRU PAUSE                      IBB59950
       SPACE                                                            IBB59960
 NDERR LAC     NDOUT,4                                                  IBB59970
       TXI     TST1,4,2                                                 IBB59980
       EJECT                                                            IBB59990
*      SELECT ROUTINE FOR NON DATA OPERATIONS.                          IBB60000
 NDS1  MON     **,,*+1                                                  IBB60010
       STL     NDSSW                                                    IBB60020
       PAC     16,2                                                     IBB60030
       STA     NDS5A                                                    IBB60040
       CAL     1,2                                                      IBB60050
 NDS3  SXA     NDSX4,4                                                  IBB60060
       PAX     0,4                                                      IBB60070
       LDI     0,2                                                      IBB60080
       IFT     HTEX=0                                                $6$IBB60088
       GOTO    NDS3A                                                 $6$IBB60089
       LFT     020000              7909 CHANNEL...                      IBB60090
       TRA     NDH1                TO NDH1 IF YES                       IBB60100
NDS3A  CAL     0,2                                                   $6$IBB60110
       ARS     18                                                       IBB60120
       TXL     *+2,4,1                                                  IBB60130
       ORA     NDS1+2                                                   IBB60140
       STA     SELX,4                                                   IBB60150
       IFT     IBM=7090              SO -                            $6$IBB60160
       GOTO    NDS3B                                                 (9)IBB60170
       TXL     NDSX4,4,2                                             $6$IBB60180
NDS3B  TXH     NDWEF,4,6                                             (9)IBB60185
       XEC     SELX,4              DENSITY BITS IN UCB WORD 1           IBB60190
 NDS5  CLA     2,2                 TAPE POSITION IN UCB WORD 3          IBB60200
       LRS     0                   SAVE NOISE RECORD CONDITION          IBB60210
       SSP                         PREPARE FOR ARITHMETIC               IBB60220
       XEC     TBLTP+8,4                                                IBB60230
       TNX     *+2,4,5                                                  IBB60240
       XEC     TBLTP+2,4                                                IBB60250
       TZE     NDS5A+1             -0 IS REWOUND AND UNLOADED (729)     IBB60260
       TPL     NDS5A+3             +0 IS AT BOT                         IBB60270
 NDS5A PXD     **,0                                                     IBB60280
       LRS     0                                                        IBB60290
       RIR     400000              TURN OFF EOT (OR EWA) IF ON          IBB60300
       LLS     0                   RESTORE NOISE RECORD CONDITION       IBB60310
       STO     2,2                                                      IBB60320
       IFT     IBM=709                                               $6$IBB60328
       GOTO    NDSX4A                                                $6$IBB60329
UPD1   TZE     UPD3                TRANSFER IF REWOUND POSITION         IBB60330
       TRA     NDSX4                                                    IBB60340
UPD6   RIR     100000              CLEAR DENSITY BIT 2                  IBB60350
       TXL     *+2,4,1             LOW                                  IBB60360
UPD7   SIR     100000                                                   IBB60370
       ZET     2,2                 TEST TAPE POSITION                   IBB60380
       TRA     *+4                 NOT AT LOAD POINT                    IBB60390
UPD3   RIR     200000              LOAD POINT                           IBB60400
       RFT     100000              SET BIT 1 SAME AS BIT 2              IBB60410
       SIR     200000                                                   IBB60420
UPD4   BSS     0                                                        IBB60430
NDSX4A STI     0,2                                                   $6$IBB60460
NDSX4  AXT     **,4                RESTORE IR4                          IBB60470
       STZ     1,2                 CLEAR UCB+1                          IBB60480
       TRA     2,4                 RETURN TO TRAP SUPERVISOR            IBB60490
       NOP                         HSKR(2)                              IBB60500
 TBLTP ADD     L(1)                HSKR(1) WEF(2)  HWTM(2) HSKF(2)      IBB60510
       ORA     RHMSK               WEF(1)  HWTM(1) HSKF(1) BSF(2) HBSF(2IBB60520
       SUB     1B17                BSF(1)  HBSF(1)                      IBB60530
       SUB     L(1)                BSR     HBSR                         IBB60540
       CLS     L(0)                RUN                                  IBB60550
       PXD     ,0                  REW     HCCR HRWD HRUN HCHC HUNL     IBB60560
       IFT     IBM=709                                               $6$IBB60568
       GOTO    WEF1                                                  $6$IBB60569
UPD2   TRA     UPD7                SDNH                                 IBB60570
       TRA     UPD6                SDNL                                 IBB60580
NDS12  BSS     0                                                        IBB60590
WEF1   PZE     **                  L(UCW)                               IBB60620
       SPACE                                                            IBB60630
*                          WRITE EOF ROUTINE                            IBB60640
       SPACE   1                                                        IBB60650
NDWEF  STA     WEF7                SET UP BSR AND WEF                   IBB60660
       LDQ     TRCX,1              SET UP TRCS                          IBB60670
       SLQ     WEF3                                                     IBB60680
 WEF4  AXT     25,4                                                     IBB60690
       XEC     SELX-7              EXECUTE WEF                          IBB60700
       STL     TCOX,1                                                   IBB60710
       XEC     TCOX,1              DELAY UNTIL DONE                     IBB60720
WEF3   TRCA    WEF7                TEST RTC ON WEF                      IBB60730
       XEC     ETTX,1              FINE WEF. BUT EOT...                 IBB60740
       TRA     WEF7A               YES - TO WEF7A                       IBB60750
       LXA     NDSGH,4             NO - ADJUST EXITS TO L(TSX+3)        IBB60760
       TXI     *+1,4,1                                                  IBB60770
       ZET     NDSSW                                                    IBB60780
       SXA     NDSGH,4                                                  IBB60790
       LXA     NDOUT,4                                                  IBB60800
       TXI     *+1,4,1                                                  IBB60810
       SXA     NDOUT,4                                                  IBB60820
       TRA     *+3                                                      IBB60830
 WEF7A CAL     4TAG                                                     IBB60840
       ORS     0,2                 TURN ON EOT BIT                      IBB60850
       AXT     7,4                 RESTORE XR4 TO ND                    IBB60860
       TRA     NDS5                UPDATE POSITION AND EXIT             IBB60870
WEF7   BSRA    **                                                       IBB60880
       CAL     4TAG                                                     IBB60890
       XEC     ETTX,1                                                   IBB60900
       ORS     0,2                                                      IBB60910
       TIX     WEF4+1,4,1                                               IBB60920
       TSX     RED10,4                                                  IBB60930
       PZE     NDS5A,,CMT2A                                             IBB60940
       TRA     WEF4                                                     IBB60950
       EJECT                                                            IBB60960
       IFT     HTEX=0                                                $6$IBB60968
       GOTO    TEST                                                  $6$IBB60969
*                   7909 PORTION OF SELECT                              IBB60970
       SPACE                                                            IBB60980
 NDH1  LDI     1,2                 IF BIT 2 OF UCB+1 IS A 1 THEN THE    IBB60990
       LFT     100000              ORDER HAS NOT BEEM STARTED - OR IT   IBB61000
       TRA     NDH2                HAS NOT BEEN DONE SATISFACTORILY.    IBB61010
       STZ     NDSSW                                                    IBB61020
       TXH     NDSX4,4,41                                               IBB61030
       LDI     0,2                                                      IBB61040
       TRA     NDS5A                                                    IBB61050
 NDH2  SXA     NDH3,4                                                   IBB61060
       TSX     ISSK1,4             GO ISSUE THE ORDER.                  IBB61070
       LFT     400000              WAS IT AN ATTENTION TYPE ...         IBB61080
       TRA     NDH3                NO                                   IBB61090
       LXA     NDSX4,4             YES-THEN                             IBB61100
       RIL     100000              CLEAR BIT 2 OF UCB+1, AND            IBB61110
       STI     1,2                 RETURN - ATTN WILL CAUSE REENTRY.    IBB61120
       TRA     2,4                                                      IBB61130
 NDH3  AXT     **,4                                                     IBB61140
       LDI     0,2                                                      IBB61150
       CLA     SNSDTA                                                   IBB61160
       ANA     TST3                                                     IBB61170
       STP     2,2                 TURN OFF AF AND PF FLAGS             IBB61180
       TZE     NDH3A               NO U.E. IF C(SNSDTA)=0               IBB61190
       LGR     25                                                       IBB61200
       TNZ     NDS5A               BOT                                  IBB61210
       TQP     *+2                                                      IBB61220
       TRA     NDSX4               EOT                                  IBB61230
       TXI     NDH4,4,-28          TAPE MARK                            IBB61240
 NDH3A TXL     NDSX4,4,32          EXIT IF ND=32 (HERG)                 IBB61250
       TXH     *+2,4,33                                                 IBB61260
       TXI     NDS5,4,-26          IF ND=33 SET K=7 AND PROCESS WTM     IBB61270
       TXI     *+1,4,-29                                                IBB61280
 NDH4  TXL     NDS5,4,6                                                 IBB61290
       TIX     *+1,4,7             IF K=8 SET IT TO 7                   IBB61300
       TIX     *+1,4,5             IF K=7 SET IT TO 8                   IBB61310
       TXI     NDS5,4,6                                                 IBB61320
       TTL     IOEX / TEST VALIDITY OF UNIT REQUESTED (TEST)            IBB61340
TEST   NULL                                                          $6$IBB61349
*                      TEST VALIDITY OF (FILE,T)                        IBB61350
*                        USED BY ACTV AND NDSEL                         IBB61360
       SPACE   1                                                        IBB61370
       ENB     L(0)                DISABLE TRAP                      $6$IBB61380
       SXA     TSTX1,1             SAVE X1                              IBB61390
TST2   CAL*    1,4                                                      IBB61400
       PAX     0,1                                                      IBB61410
       TXL     TST1,1,UEA11-1                                           IBB61420
       TXH     TST1,1,UEA11+4*NOUCW-1                                   IBB61430
       SXA     *+1,1                                                    IBB61440
       CLA     **                                                       IBB61450
       TMI     TST1                UNIT IS UNAVAILABLE                  IBB61460
       CAL     0,4                                                      IBB61470
       ACL     TST2                                                     IBB61480
       STA     *+2                 ACTV+1 OR NDSEL+1                    IBB61490
TSTX1  AXT     **,1                                                     IBB61500
       TRA     **                                                       IBB61510
TST1   PXA     0,4                 COMPUTE EFFECTIVE ADDRESS            IBB61520
       ADD     TST2                OF (1,4)                             IBB61530
       LGR     15                                                       IBB61540
       STL     ENBSW                                                    IBB61550
       TSX     BCD5,4                                                   IBB61560
       SLW     CMT7+3                                                   IBB61570
       TSX     PROUT,4             PRINT ILLEGAL UNIT REFERENCE         IBB61580
       PZE     1                   AND GO DUMP.                         IBB61590
       PZE     CMT7,,4                                                  IBB61600
       TSX     .STOP,4                                               $6$IBB61610
       TTL     IOEX / ERROR MESSAGES                                    IBB61620
*                             BCD MESSAGES                              IBB61630
       SPACE                                                            IBB61640
 CMT0  BCI     2, UNIT XXXXXX                                           IBB61650
 CMT2B BCI     9,WROTE SHORT  REC.  XXXXX  FILE XXXXX ERROR-TRCK 00XXXX IBB61660
CMT2   BCI     3,PERM.  READ REDUN.                                     IBB61670
 CMT2A BCI     3,25 ERASES ON WRITE                                     IBB61680
 CMT2C BCI     5,REC DISCRDED-NOISE  ON ERASE-                          IBB61690
 CMT7  BCI     5,ILL UNIT REQ'ST AT XXXX 1=HEOS                         IBB61700
 CMT8  BCI     3,I/O CKSEQ CKINT CK                                     IBB61710
       SPACE                                                            IBB61720
 CMT1  EQU     CMT2B+2                                                  IBB61730
 CMT3  EQU     CMT2C+2                                                  IBB61740
 HTP   EQU     CMT7+3                                                   IBB61750
 9MSS1 EQU     CMT2B+5                                                  IBB61760
 TTTT1 EQU     9MSS1                                                    IBB61770
 TTTT2 EQU     9MSS1+3                                                  IBB61780
       TTL     IOEX / ISSUE SEEKS AND/OR NEXT SELECT (ISSEK)            IBB61790
       IFT     CHEX=0                                                $6$IBB61798
       GOTO    ISS0                                                  $6$IBB61799
 ISSK1 SXA     ISX42,4        ENTRANCE TO PROCESS THE ONE               IBB61800
       STI     ISSSI          UCB POINTED TO BY XR2.                    IBB61810
       CLS     2,2                                                      IBB61820
       STO     2,2                 TURN ON THE AF FLAG                  IBB61830
 ISS0  STZ     ISSSP                                                    IBB61850
       AXT     0,4                                                      IBB61860
       TRA     ISS2                                                     IBB61870
 ISSEK SXA     ISX41,4        GENERAL ENTRANCE                          IBB61880
       PAC     ,2                                                       IBB61890
       STA     ISSSP          SET P=PRIORITY UNIT                       IBB61900
       TXL     ISS1,2,0                                                 IBB61910
       LDI     1,2            IT KEEPS ITS PRIORITY ONLY                IBB61920
       LFT     077777         IF A SEL ROUTINE IS SPECIFIED             IBB61930
       TRA     ISS1-1                                                   IBB61940
       STZ     1,2                                                      IBB61950
 ISS10 STZ     ISSSP                                                    IBB61960
       TRA     ISS1                                                     IBB61970
       TQP     ISS0                                                     IBB61980
 ISS1  CLA     UCBA,1                                                $6$IBB61990
       PAC     ,2             XR2=FIRST UCB TO EXAMINE                  IBB62000
       PDX     ,4             XR4=NO OF UCBS TO EXAMINE                 IBB62010
 ISS2  STZ     ISSST                                                    IBB62020
       SXA     ISX44,4                                                  IBB62030
 ISS3  PXA     ,2                                                       IBB62040
       COM                                                              IBB62050
       ADD     L(1)           SET AC=L(UCB)                             IBB62060
       IFT     CHEX=0                                                $6$IBB62068
       GOTO    ISS4                                                  $6$IBB62069
       ZET     IBSGAP,1            NOW START CHANNEL SCAN            $6$IBB62070
       TRA     ISS6           TO ISS6 IF 7909 CHANNEL                   IBB62080
 ISS4  ZET     ISSSP                                                    IBB62090
       TRA     ISS5           P NOT ZERO MEANS UCB HAS PRIORITY         IBB62100
       LDI     1,2            IF P=0, GIVE UNIT PRIORITY                IBB62110
       LFT     077777         IF A SEL ROUTINE IS SPECIFIED.            IBB62120
       STA     ISSSP          IF NO SEL, GO TO NEXT UCB.                IBB62130
 ISS5  TNX     ISS7,4,1                                                 IBB62140
       TXI     ISS3,2,-4                                                IBB62150
       IFT     CHEX=0                                                $6$IBB62158
       GOTO    ISS7                                                  $6$IBB62159
 ISS6  LDI     2,2            HERE IF 7909 CHANNEL.                     IBB62160
       LNT     400000         IF AF FLAG OFF UNIT IS FREE               IBB62170
       TRA     ISS4           FOR A POSSIBLE (SEL+) ENTRY.              IBB62180
       STL     ISSST               IF NOT, CHECK THE PF FLAG            IBB62190
       LFT     200000                                                   IBB62200
       TRA     ISS5           IF ON, FORGET THE UNIT.                   IBB62210
       SXA     ISX43,4        IF OFF, AN ORDER MUST BE ISSUED.          IBB62220
       STA     CHXSP,1                                                  IBB62230
       STP     2,2            TURN ON THE PF FLAG                       IBB62240
       CAL     0,2                                                      IBB62250
       ARS     23                                                       IBB62260
       ORA     CHNS4          SET UP THE SMS IN CH PROG                 IBB62270
 ISCAD SLW     CHPRG          FOR THE CORRECT INTERFACE.                IBB62280
       CLA     0,2                                                      IBB62290
       ANA     MSK1           NOW GO TO SPECIAL DEVICE                  IBB62300
       PDX     ,4             ROUTINE TO FINISH UP.                     IBB62310
       IFF     HTEX=0                                                $6$IBB62319
       TXL     HTISS,4,63     ....    HYPER----- 000 THRU 077           IBB62320
       IFF     DUEX=0                                                $6$IBB62328
       TRA     DKISS               ....    DISK/NEED- 100 THRU 377      IBB62330
 ISS7  ZET     ISSSP                                                    IBB62350
       TRA     ISS9           IF P NOT ZERO, GO ENTER (SEL+)            IBB62360
 ISX44 AXT     **,4                                                     IBB62370
       CLA     ISSST                                                    IBB62380
       IFT     CHEX=0                                                $6$IBB62388
       GOTO    ISS8                                                  $6$IBB62389
 ISS7A TZE     ISS8                                                     IBB62390
       ZET     ISSSI                                                    IBB62400
       TRA     ISS8-2                                                   IBB62410
       LDQ     RCHX,1         HERE IF ATTENTION INTERRUPTS              IBB62420
       SLQ     *+1            HAVE TO BE ENABLED.                       IBB62430
       RSCA    ENBAT                                                    IBB62440
       TXL     ISX41,4,0                                                IBB62450
       TRA     ISS8+2                                                   IBB62460
 ISS8  TXL     ISX41,4,0                                                IBB62480
       STZ     CHXSP,1        HERE IF ABSOLUTELY NO                     IBB62490
       STZ     CHXAC,1        CHANNEL ACTIVITY                          IBB62500
       TRA     ISS12                                                    IBB62510
 ISS9  LAC     ISSSP,2             HERE TO ENTER (SEL+)                 IBB62520
       STL     RCTX,1                                                   IBB62530
       IFT     CHEX=0                                                $6$IBB62538
       GOTO    ISS9B                                                 $6$IBB62539
 ISS9A CLA     2,2                                                      IBB62540
       ZET     IBSGAP,1            IF 7909 CHANNEL - DO NOT ENTER    $6$IBB62550
       TMI     ISX44          (SEL+) IF AF FLAG IS ON                   IBB62560
       ZET     IBSGAP,1                                              $6$IBB62570
       STZ     RCTX,1                                                   IBB62580
ISS9B  STL     TRCX,1              MAKE SURE REDUNDANCY              $6$IBB62600
       XEC     TRCX,1         INDICATOR IS OFF                          IBB62610
       LDQ     TEFX,1              MAKE SURE EOF INDICATOR IS OFF       IBB62620
       SLQ     *+1                                                      IBB62630
       TEFA    *+1                                                      IBB62640
       CAL     1,2                                                      IBB62650
       PDX     ,4                                                       IBB62660
       CAL     ISSSP                                                    IBB62670
       STO     CHXAC,1        SET AC=CHXAC=CHXSP=L(UCB)                 IBB62680
       STO     CHXSP,1                                                  IBB62690
       STL     TCOX,1                                                   IBB62700
       XEC     TCOX,1                                                   IBB62710
       SXA     *+1,4                                                    IBB62720
       TSX     **,4           ENTER (SEL+)                              IBB62730
       TRA     ISS11          NORMAL RETURN                             IBB62740
       TRA     ISS10                                                    IBB62750
 ISS11 LAC     ISSSP,4                                                  IBB62760
       CLA     1,4                                                      IBB62770
       TPL     ISS12                                                    IBB62780
       CAL     1B17           IF SELECT IS A WRITE                      IBB62790
       ALS     0,1            PERMIT REDUNDANCY TRAPS.                  IBB62800
       ORS     TRAP                                                     IBB62810
 ISS12 PXD     ,0                                                       IBB62820
 ISX41 AXT     **,4                                                     IBB62830
       ZET     ISSSI                                                    IBB62840
 ISX42 AXT     **,4                                                     IBB62850
       LDI     ISSSI                                                    IBB62860
       STZ     ISSSI                                                    IBB62870
       TRA     1,4            RETURN WHENCE YOU CAME PLUS ONE           IBB62880
       EJECT                                                            IBB62890
       IFT     CHEX=0                                                $6$IBB62898
       GOTO    ENDISS                                                $6$IBB62899
*                  ROUTINES NECESSARY FOR ISSEK                         IBB62900
       SPACE                                                            IBB62910
       IFT     HTEX=0                                                $6$IBB62918
       GOTO    DKISS                                                 $6$IBB62919
 HTISS AXT     HTP,4               POINT CTL TO HTP                     IBB62920
       SXA     CHPRG+2,4                                                IBB62930
       CLA     1,2                 IN HTP AND HTP+1 SET UP              IBB62940
       TSX     BCVDEC,4            1206XXYYYY1201    WHERE              IBB62950
 HTIS1 LGL     24                  XX=UNIT    YYYY=ORDER.               IBB62960
       CLA     0,2                                                      IBB62970
       ARS     18                                                       IBB62980
       LGR     4                                                        IBB62990
       CAL     HTIS1                                                    IBB63000
       LGR     14                                                       IBB63010
       CRQ     DECRQ,,6            CHANGE 00 TO 12                      IBB63020
       STQ     HTP                                                      IBB63030
       TRA     HTSTC                                                    IBB63040
       SPACE                                                            IBB63050
 HTST1 TSX     HOPRQ,4                                                  IBB63060
 HTSTC STZ     SNSDTA              START CHANNEL AND                    IBB63070
       TSX     UETST,4        RETURN ONLY IF AN UN. END                 IBB63080
       LDQ     RCHX,1                                                   IBB63090
       SLQ     *+1                                                      IBB63100
       RCHA    CHNPT               POINT CHNNEL TO CHNS3                IBB63110
       TSX     DATNS,4             O.K. LETS SEE WHATS WRONG            IBB63120
       LDI     SNSDTA                                                   IBB63130
       LXA     HTP,4                                                    IBB63140
       TXL     *+3,4,12416         IGNORE FILPR IF                      IBB63150
       TXH     *+2,4,12520         OTHER THAN HERG OR HWTM.             IBB63160
       LNT     004000                                                   IBB63170
       LFT     030000                                                   IBB63180
       TRA     HTST1               TO HOPRQ IF NTRDY, NTLOD, OR FILPR   IBB63190
       TRA     ISX43                                                    IBB63200
       SPACE                                                            IBB63220
       IFT     DUEX=0                                                $6$IBB63228
       GOTO    UETST                                                 $6$IBB63229
 DKISS CAL     CHXSP,1        DISK                                      IBB63230
       ADD     ADJ1                                                     IBB63240
       STA     CHPRG+2        POINT THE CTL AT UCB+2                    IBB63250
       CLA     3,2                                                      IBB63260
       STP     3,2                 TURN OFF TRACK FLAG IN UCB+3         IBB63270
       TMI     DKSTC                                                    IBB63280
       TSX     BCVDEC,4            CONVERT BINARY TTTT TO BCD           IBB63290
       LGL     12                                                       IBB63300
       CRQ     DECRQ,,6                                                 IBB63310
       CAL     2,2                                                      IBB63320
       ARS     12                                                       IBB63330
       LGL     12                                                       IBB63340
       SLW     2,2                 STORE H.O. TT OF TTTT IN UCB+2       IBB63350
       SLQ     3,2                 PLACE L.O. TT OF TTTT IN UCB+3       IBB63360
 DKSTC TSX     UETST,4                                                  IBB63370
       LDQ*    CHXSP,1                                                  IBB63380
       TSX     CVPRT,4                                                  IBB63390
       PZE     DKSTM,,2                                                 IBB63400
       TSX     PAWS,4                                                   IBB63410
       TRA     DKSTC                                                    IBB63420
 DKSTM BCI     2, SEEK UN END                                           IBB63430
       SPACE                                                            IBB63450
 UETST CLA     ISCAD          SUBROUTINE TO DO---                       IBB63460
       STA     RCHX,1                                                   IBB63470
       XEC     RCHX,1              1. START THE CHANNEL                 IBB63480
       LDQ     SDCX,1         2. TEST FOR U.E. WHEN DONE                IBB63490
       SLQ     *+3            3. RETURN 1,4 IF AN UN. END               IBB63500
       STL     TCOX,1         4. IF NO U.E., RESTORE THE                IBB63510
       XEC     TCOX,1            ORIGINAL C(XR4) AND C(XR2)             IBB63520
       PZE     TSDCX                  AND RETURN DIRECTLY TO ISS5       IBB63530
       LDI     TSDCX                                                    IBB63540
       LFT     001000                                                   IBB63550
       TRA     1,4                                                      IBB63560
       AXC     DEND5,2             I/O, SEQ, OR INT CHECK...            IBB63570
       LFT     006100              IF YES, PRINT MESSAGE AND            IBB63580
       TXI     DEN1A,4,1           RETURN TO L(TSX UETST,4)             IBB63590
 ISX43 AXT     **,4                                                     IBB63600
       CAL     CHXSP,1                                                  IBB63610
       PAC     ,2                                                       IBB63620
       TRA     ISS5                                                     IBB63630
ENDISS NULL    END OF ISSUE ROUTINES                                 $6$IBB63640
       TTL     IOEX / MESSAGE WRITER (PROUT/PUNCH)                      IBB63650
*                    ON LINE MESSAGE PRINT ROUTINE.                     IBB63660
       SPACE   1                                                        IBB63670
       SPACE   1                                                        IBB63680
*                           CALLING SEQUENCE                            IBB63690
       SPACE   1                                                        IBB63700
*      TSX     PROUT,4                                                  IBB63710
*      PFX     N                       PFX=PZE, ON-LINE ONLY            IBB63720
*      Q       L1,T,M1+SPR*512         PFX=MZE, ON AND OFF-LINE         IBB63730
*       .        .    .                PFX=MON, OFF-LINE ONLY           IBB63740
*       .        .    .                                                 IBB63750
*      Q       LN,T,MN+SPR*512                                          IBB63760
*      RETURN                                                           IBB63770
       SPACE   1                                                        IBB63780
 PUNCH ENB     L(0)                                                  $6$IBB63790
       CLA     SPUN                                                     IBB63800
       TRA     PRT6                                                     IBB63810
 PROUT ENB     L(0)                                                  $6$IBB63820
       CLA     1,4                                                      IBB63830
       TMI     SPOUT                                                 $6$IBB63840
 PRT7  CLA     PSE                                                      IBB63850
 PRT6  STO     PRPUS               SET UP SENSE                         IBB63860
       ADD     L(1)                                                     IBB63870
       STA     PRT5                SET UP SELECT                        IBB63880
       REM     COMPUTE RETURN FROM SUBROUTINE                        $6$IBB63890
       PXA     2,4                 -L(TSX)                           $6$IBB63900
       SBM     *-1                 -(L(TSX)+2)                       $6$IBB63910
       ACL     1,4                 TSX+2+N                              IBB63920
       STA     PRTEX               SET RETURN ADDRESS.                  IBB63930
       SXA     PRTAX,2             SAVE XR2.                            IBB63940
       REM     FIND NUMBER OF CALLING SEQUENCE REQUESTS              $6$IBB63950
       CAL     1,4                                                      IBB63960
       PAX     0,2                 N                                    IBB63970
       NZT     ATRAP               IS CHANNEL A FREE...              $6$IBB63980
       NZT     CHXAC                                                    IBB63990
       TRA     PRT1-1              TO PRT1-1 IF YES                     IBB64000
       STL     FRSW1               BLOCK PANEL SAVE IN TRAP SUP.        IBB64010
       CAL     TRPCH               SET UP TO                            IBB64020
       ANA     .TRAPS              TRAP ON PRINTER                   $6$IBB64030
 PRT0  SLW     ONETRP              CHANNEL ONLY.                        IBB64040
       ENB     ONETRP              ENABLE TRAPS                         IBB64050
       TRA     *                   WAIT FOR TRAP                        IBB64060
 PRT3  SCHA    ACOMM               SAVE CHANNEL A INFORMATION           IBB64070
       ZAC                                                           $6$IBB64080
PRT1   TCOA    *                                                     $6$IBB64090
PRT5   WRS     **                  SELECT PRINTER OR PUNCH           $6$IBB64100
       STZ     PRINT                                                    IBB64110
PRT4   TSX     SPRT,4              SET UP ASSOCIATED                 $6$IBB64120
PRTEX  CLA     **,2                LOAD NEXT C.S. WORD               $6$IBB64125
 BCDHC SXA     BCX1,1              BCD TO HOLLERITH CONVERSION          IBB64130
       SXA     BCX1+1,2                                                 IBB64140
       REM     TEST REINITIALIZATION NEEDED                          $6$IBB64150
       ZET     PRINT                                                    IBB64160
       TRA     BCD0                                                     IBB64170
       AXT     24,4                                                     IBB64180
       STZ     IMAGE+24,4                                               IBB64190
       TIX     *-1,4,1                                                  IBB64200
       SXA     HAFRO,4                                                  IBB64210
       SXD     HAFRO,4                                                  IBB64220
       LDQ     MZE                                                      IBB64230
       STQ     STROBE              RESET COLUMN POINTER              $6$IBB64235
 BCD0  STO     PRINT                                                    IBB64240
       ANA     MSK1                                                     IBB64250
       PDC     0,4                                                      IBB64260
       TXL     BCX1+2,4,0                                               IBB64270
       STT     *+2                                                      IBB64280
       LXA     PRTAX,2                                                  IBB64290
       PXA     0,**                                                     IBB64300
       SBM     PRINT                                                    IBB64310
       STA     BCD2                                                     IBB64320
       SXD     BCD7,4                                                   IBB64330
       AXT     0,4                                                      IBB64340
       CAL     STROBE              LOAD CURRENT COLUMN BIT           $6$IBB64350
BCD1   TNZ     BCD2-1              36 COLUMNS COMPLETED              $6$IBB64360
       NZT     HAFRO               YES,WAS IT SECOND HALF IMAGE      $6$IBB64361
       TRA     BCX1                YES,IGNORE REMAINDER OF LINE      $6$IBB64362
       CAL     MZE                                                      IBB64370
       STZ     HAFRO                                                    IBB64380
       SLW     STROBE                                                   IBB64390
BCD2   LDQ     **,4                                                     IBB64400
       SXA     BCD6,4                                                   IBB64410
       AXT     6,4                                                      IBB64420
BCD3   PXD     0,0                                                      IBB64430
       LGL     2                                                        IBB64440
       ALS     14                                                       IBB64450
       LGL     4                                                        IBB64460
       ALS     1                                                        IBB64470
       ACL     HAFRO                                                    IBB64480
       PDX     0,1                                                      IBB64490
       PAX     0,2                                                      IBB64500
       CAL     STROBE                                                   IBB64510
       REM     STORE BITS IN CARD IMAGE                              $6$IBB64520
       TXL     BCD3A,1,5           IS THERE A ZERO-ZONE              $6$IBB64530
       TXL     BCD5X,2,1           YES,BLANK IF NO NUMERIC           $6$IBB64540
BCD3A  TXL     BCD3B,1,1           IS THERE ANY ZONE                 $6$IBB64550
       ORS     IMAGE+25,1          YES,INSERT IN IMAGE               $6$IBB64560
       TXL     BCD5X,2,1           IS THERE A NUMERIC                $6$IBB64570
 BCD3B TXL     BCD4,2,19           YES, IS IT MULTIPLE PUNCH         $6$IBB64580
       TXH     *+2,2,21                                              $6$IBB64581
       TXI     BCD4,2,-20                                            $6$IBB64582
       LXA     HAFRO,1             YES,INSERT 8 PUNCH                $6$IBB64590
       ORS     IMAGE+3,1           IN CORRECT CARD HALF              $6$IBB64600
       TXI     BCD4,2,-16          ADJUST FOR OTHER (2-7)            $6$IBB64610
BCD4   ORS     IMAGE+19,2          INSERT NUMERIC PUNCH              $6$IBB64620
       REM                                                           $6$IBB64630
BCD5X  ARS     1                                                        IBB64640
       SLW     STROBE                                                   IBB64650
       TIX     BCD3,4,1                                                 IBB64660
BCD6   AXT     **,4                                                     IBB64670
       TXI     *+1,4,-1                                                 IBB64680
BCD7   TXH     BCD1,4,**                                                IBB64690
BCX1   AXT     **,1                                                     IBB64700
       AXT     **,2                                                     IBB64710
       ZET     *+1                                                   $6$IBB64711
SPR    SPRA    **                                                    $6$IBB64712
       CLA     PRINT                                                    IBB64720
       TPL     *+2                 END OF CONVERSION                    IBB64730
       TIX     PRT4,2,1            TO PRT4 IF PARTIAL LINE              IBB64740
       RCHA    IOPR                                                     IBB64780
       TIX     PRT1,2,1            GO TO NEXT LINE                      IBB64790
       TSX     SPRT,4                                                   IBB64800
       TZE     PRTAX                                                    IBB64810
       XEC     PRT5                                                     IBB64820
       XEC     SPR                                                      IBB64830
       TCOA    *                                                        IBB64840
 PRTAX AXT     **,2                                                     IBB64850
       LAC     PRTEX,4                                                  IBB64860
       PXD     ,0                  ALWAYS EXIT PROUT WITH AC=0          IBB64870
       ZET     FRSW1                                                    IBB64880
       ZET     TRPSW                                                    IBB64890
       TXI     PWEX1,4,1           EXIT THRU PAUSE                      IBB64900
       LXA     PRTEX,4             HERE IF A CHANNEL A TRAP             IBB64910
PRT2   SXA     ATRAP,4             NEEDS TO BE SERVICED.             $6$IBB64920
       TRA     SAVE3                                                    IBB64930
       SPACE   1                                                        IBB64940
       REM     SET UP SENSE PRINTER OR PUNCH                         $6$IBB64950
SPRT   ARS     27                                                    $6$IBB64960
       TZE     *+2                                                   $6$IBB64970
       ACL     PRPUS               SENSE PR OR PU                       IBB64980
       SLW     SPR                                                      IBB64990
       TRA     1,4                                                      IBB65000
       SPACE                                                            IBB65010
IMAGE  BSS     24                                                    $6$IBB65020
       TTL     IOEX / PAUSE                                             IBB65030
*                            PAUSE ROUTINE                              IBB65040
       SPACE   1                                                        IBB65050
 PAUSE ENB     L(0)                                                     IBB65060
       SXA     PWSX2,2                                                  IBB65070
       AXT     6,2                 SET UP PAUSE MESSAGE REFERENCE       IBB65080
       TRA     *+4                                                      IBB65090
 PAWS  ENB     L(0)                                                     IBB65100
       SXA     PWSX2,2                                                  IBB65110
       AXT     3,2                 SET UP PAWS  MESSAGE REFERENCE       IBB65120
       SXA     PWSX4,4                                                  IBB65130
       CAL     4TAG                                                     IBB65140
       STT     ENBSW               SET ENBSW NOT ZERO TO PRVENT TRAPS   IBB65150
 PAW1  TSX     PROUT,4                                                  IBB65160
 PWSP1 PZE     1                                                        IBB65170
       PZE     PMREF,2,3+512*DBLSP                                      IBB65180
       HPR     -1                                                       IBB65190
       TSX     PROUT,4                                                  IBB65200
 PWSP2 PZE     1                                                        IBB65210
       PZE     PMREF,,2+512*DBLSP                                       IBB65220
       STT     ENBSW               AC=0 WHEN FROM PROUT                 IBB65230
 PWSX2 AXT     **,2                                                     IBB65240
 PWSX4 AXT     **,4                                                     IBB65250
 PWEX1 ZET     ENBSW               EXITS ALSO- BCD5, PROUT, AND CVPRT   IBB65260
       TRA     1,4                                                      IBB65270
 PWEX2 NZT     TRPSW               EXITS ALSO- ACTIV, AND NDATA         IBB65280
       ENB*    TRAPX                                                    IBB65290
       TRA     1,4                                                      IBB65300
       SPACE                                                            IBB65310
       BCI     3,OPER. ACTION PAUSE              PAUSE LINE 1           IBB65320
       BCI     3,PRES STRT TO GO ON              PAWS  LINE 1           IBB65330
 PMREF BCI     2,..CONTINUING                                           IBB65340
       TTL     IOEX / SYMBOLIC UNIT CONVERSION (SYMUN)                  IBB65350
*                   SYMBOLIC UNIT CONVERSION ROUTINE                    IBB65360
*      TSX     SYUNCV,4            MQ DECREMENT= UNIT ADDRESS           IBB65370
       SPACE   1                                                        IBB65380
SYUNCV PXA     0,0                                                      IBB65390
       RQL     4                                                        IBB65400
       LLS     4                                                        IBB65410
       RQL     3                                                        IBB65420
       TPL     SY7607                                                   IBB65430
       IFT     CHEX=0                                                $6$IBB65438
       GOTO    12ZONE                                                $6$IBB65439
SY7909 ALS     5                   HERE IF 7909 CHANNEL DEVICE          IBB65440
       TQP     *+2                                                      IBB65450
       ALS     6                   IF DISK, MAKE ROOM FOR ACCESS        IBB65460
       RQL     1                                                        IBB65470
       LLS     1                   ACCESS TO AC (ZERO IF H.T.)          IBB65480
       ALS     2                                                        IBB65490
       LLS     4                   MODULE (OR UNIT NUMBER) TO AC        IBB65500
       ALS     11                                                       IBB65510
       LGL     1                   INTERFACE TO AC                      IBB65520
       RQL     24                                                       IBB65530
       CAQ     HZONE-8,,1                                               IBB65540
       TRA     1,4                                                      IBB65550
 HZONE BCI     1, +H0/0                                                 IBB65560
       BCI     1,+D00/0                                                 IBB65570
12ZONE BCI     1,  +0                                                   IBB65590
       BCI     1,+N00/0                                                 IBB65600
SYUNTB BCI     1,  RD+                                               $6$IBB65602
       BCI     1,  PU+                                               $6$IBB65604
       BCI     1,  PR+                                               $6$IBB65606
       BCI     1,+D00/0            1302 CONVERSION                   $6$IBB65608
SY7607 TQP     *+5                                                      IBB65610
       ALS     6                                                        IBB65620
       RQL     33                                                       IBB65630
       CAQ     SYUNTB-13,,1                                             IBB65640
       TRA     1,4                                                      IBB65650
       LLS     6                                                        IBB65660
       ALS     12                                                       IBB65670
       ACL     12ZONE                                                   IBB65680
       TRA     1,4                                                      IBB65690
       TTL     IOEX / CONVERSION                                        IBB65730
*                            BINARY TO BCD OCTAL CONVERSION             IBB65740
       SPACE   1                                                        IBB65750
*      CALLING SEQUENCE                                                 IBB65760
*      LDQ     (OCT)                                                    IBB65770
*      TSX     BCD5,4                                                   IBB65780
*      RETURN                                                           IBB65790
       SPACE   1                                                        IBB65800
       IFT     CHEX=0                                                $6$IBB65808
       GOTO    BCD5C                                                 $6$IBB65809
 BCD5A SXA     BCDX4,4             PRIVATE IOEX ENTRANCE                IBB65810
       AXT     6,4                                                      IBB65820
       TRA     BCD5B                                                    IBB65830
BCD5C  RQL     3                                                     $6$IBB65850
 BCD5  ENB     L(0)                                                     IBB65860
       SXA     BCDX4,4                                                  IBB65870
       AXT     5,4                                                      IBB65880
       CAL     BLNKS                                                    IBB65890
 BCD5B ALS     3                                                        IBB65900
       LGL     3                                                        IBB65910
       TIX     *-2,4,1                                                  IBB65920
 BCDX4 AXT     **,4                                                     IBB65930
       TRA     PWEX1               EXIT THRU PAUSE                      IBB65940
       SPACE   1                                                        IBB65950
*                    UNIT ADDRESS IN LEFT HALF OF MQ IS CONVERTED TO    IBB65960
*                    SYMBOLIC AND ''UNIT XXXXXX'' IS                    IBB65970
*                    APPENDED TO THE MASSAGE.                           IBB65980
       SPACE   1                                                        IBB65990
*      CALLING SEQUENCE                                                 IBB66000
*      LDQ     (TAPE NO.)                                               IBB66010
*      TSX     CVPRT,4                                                  IBB66020
*      PFX     L,,N+SPR*512        PFX FOR ON-LINE, OFF-LINE, OR BOTH   IBB66030
       SPACE   1                                                        IBB66040
 CVPRT ENB     L(0)                                                     IBB66050
       SXA     CVP1+1,4                                                 IBB66060
       CAL     1,4                 SETUP PARAMETER FOR PROUT            IBB66070
       STO     CVP1                                                     IBB66080
       STP     CVP2                                                     IBB66090
       TSX     SYUNCV,4            CONVERT TO SYMBOLIC UNIT             IBB66100
       SLW     CMT0+1                                                   IBB66110
       STP     ENBSW               SET ENBSW NOT ZERO TO PRVENT TRAPS   IBB66120
       TSX     PROUT,4                                                  IBB66130
CVP2   PZE     2                                                        IBB66140
       MZE     CMT0,,2                                                  IBB66150
CVP1   PZE     **,,**                                                   IBB66160
       AXT     **,4                                                     IBB66170
       STP     ENBSW               AC=0 WHEN FROM PROUT                 IBB66180
       TXI     PWEX1,4,-1          EXIT THRU PAUSE                      IBB66190
       SPACE                                                            IBB66200
       TTL     IOEX / CONSTANTS                                         IBB66210
*                              CONSTANTS                                IBB66220
       SPACE   1                                                        IBB66230
 PTH   PTH     0,0,0                                                    IBB66240
 FOR   FOR     0,0,0                                                    IBB66250
 MZE   EQU     FOR                                                      IBB66260
 1B17  PZE     0,0,1                                                    IBB66270
 1B12  PZE     ,,32                                                     IBB66280
 4TAG  PZE     0,4,0                                                    IBB66290
 TRPCH PZE     1,0,1                                                    IBB66300
 ADJ1  PZE     2,1,0                                                    IBB66310
       SPACE                                                            IBB66320
 RHMSK OCT     000000777777                                             IBB66330
 ISMK2 OCT     000077777777                                             IBB66340
 MSK1  OCT     000777777777                                             IBB66350
 TGMSK OCT     777777477777                                             IBB66360
       SPACE                                                            IBB66370
 PSE   SPRA    0                   SENSE PRINTER CHANNEL A              IBB66380
 SPUN  SPUA    0                   SENSE PUNCH CHANNEL A                IBB66390
 BLNKS EQU     BLANK                                                 $6$IBB66400
       SPACE                                                            IBB66410
       SPACE   1                                                        IBB66420
*                    TEMPORARY STORAGE AND SWITCHES                     IBB66430
       SPACE   1                                                        IBB66440
 TSDCX EQU     IOEXT     I L       FOR STORE CHANNEL DIAGNOSTIC         IBB66450
 DATSV EQU     IOEXT     D         TO SAVE SNSDTA WHILE GETTING SNSDT2  IBB66460
 PRINT EQU     IOEXT     P         FOR BCD TO CARD IMAGE CONVERSION     IBB66470
ONETRP EQU     IOEXT     P R       FOR ENABLING TRAPS ON ONE CHANNEL    IBB66480
 CADSV EQU     IOEXT+1   L         SPARE STORAGE FOR CADLBX LOADER      IBB66490
 HAFRO EQU     IOEXT+1   P         FOR BCD TO CARD IMAGE CONVERSION     IBB66500
 TRUSD EQU     IOEXT+1   D         FOR SAVING SNSDTA FOR ERROR MESSAGE  IBB66510
 SDSAV EQU     IOEXT+2   X         FOR SAVING SNSDTA WHILE IN (SEL-)    IBB66520
STROBE EQU     IOEXT+3   P         FOR BCD TO CARD IMAGE CONVERSION     IBB66530
SNSDTA EQU     IOEXT+3   D         FOR GATHERING SNSDTA (2 LOCS)        IBB66540
 PRPUS EQU     IOEXT+4   P         PRINTER OR PUNCH SENSE SAVE          IBB66550
 RWIND EQU     IOEXT+5   X         SAVE TAPE RD/WR CONDITION IN (SEL-)  IBB66560
 9CHEM EQU     IOEXT+5   R         LTPOS - 2,4 SWITCH FOR HYPER         IBB66570
 HDATS EQU     IOEXT+5   R         SWITCH IN HDATC                      IBB66580
 ERMES EQU     IOEXT+5   R         7909 ERROR MESSAGE   (4 LOCS)        IBB66590
 ISSST EQU     IOEXT+7   I         FOR SAVING AF FLAG ON CONDITION      IBB66600
 ACSSV EQU     IOEXT+7   A         FOR SAVING S(1,4) IN ACTIV           IBB66610
 NDSAV EQU     IOEXT+8   N         TRAP TIME NDATA SAVE OF UCB+1        IBB66620
SNSDT2 EQU     SNSDTA+2                                                 IBB66630
 ACOMM EQU     FRSW1                                                    IBB66640
NTEST  TXL     END1A,4,0                                             (9)IBB66641
       RIL     400000              NOISE RECORD INDICATION           (9)IBB66642
       TRA     END1A                                                 (9)IBB66643
STI    STI     RWIND                                                 (9)IBB66644
       TRA     END14                                                 (9)IBB66645
       IFT     CHEX=0                                                (9)IBB66646
       GOTO    CHXEND                                                (9)IBB66647
ZERDC1 STI     ACTSI               REPLACE DELETED INSTRUCTION       (9)IBB66648
       ZAC                                                           (9)IBB66649
       STD     CHXAC,1                                               (9)IBB6664A
       TRA     ACT2-2                                                (9)IBB6664B
ZERDC2 ZAC                                                           (9)IBB6664C
       STD     CHXAC,1             ZERO CHXAC,1 DECREMENT            (9)IBB6664D
       CLA     CHXAC,1             FOR ACTV AND XTRAP                (9)IBB6664E
       TRA     1,4                                                   (9)IBB6664F
ACTX1A TSX     CHXA1,4             SET CHXAC,1 DEC IF NECESSARY      (9)IBB6664G
       LXA     ACTX2+1,4           RESTORE XR4                       (9)IBB6664H
ACTX1B AXT     **,1                RESTORE XR1                       (9)IBB6664I
       TXI     PWEX2+1,4,-1                                          (9)IBB6664J
CHXA   LDI     .IOXSI              REPLACE DELETED INSTRUCTION       (9)IBB6664K
CHXA1  CLA     CHXSP,1             IF A SEEK IS BEING PERFORMED      (9)IBB6664L
       ALS     18                  SET CHXAC,1 DEC TO POINT TO UCB   (9)IBB6664M
       NZT     CHXAC,1             DON'T SET DEC IF ADDRESS NE ZERO  (9)IBB6664N
       STD     CHXAC,1             IF NOTHING AT ALL, WILL BE ZERO   (9)IBB6664P
       TRA     1,4                                                   (9)IBB6664Q
CHXEND NULL                                                          (9)IBB6664R
       EJECT                                                            IBB66650
       IFT     CHEX=1                                                (2)IBB66651
CHNS7  TCM     CHNS1-3,,64+1,6                                       (2)IBB66652
       IFT     CHEX=1                                                (2)IBB66653
       TCH     CHNS4                                                 (2)IBB66654
IOXPAT BSS     0                   FIRST CELL OF IOEX PATCH AREA        IBB66660
       SPACE                                                            IBB66670
IOXPEN BES     SYSORG-51-*         LAST  CELL OF IOEX PATCH AREA        IBB66680
       SPACE   10                                                       IBB66690
       BES     SYSORG-50-*                                              IBB66700
       SPACE                                                            IBB66710
*              CEMON AREA   (SYSORG-50 THRU SYSORG-1)                   IBB66720
       SPACE                                                            IBB66730
*  50 CELLS ARE REQUIRED AT SYSORG-50 FOR A DIAGNOSTIC ROUTINE          IBB66740
*  WHEN THE SYSTEMS UNDER IBSYS ARE PLACED IN THE DIAGNOSTIC MODE.      IBB66750
       SPACE                                                            IBB66760
*  GENITD IS LOADED INTO THIS AREA BY IBSUP AT COLD START OR            IBB66770
*  UPON PROCESSING A $RESTORE CARD.                                     IBB66780
       SPACE                                                            IBB66790
*  GENITD IS ASSEMBLED IN THE IBSUP AREA OF CODING.                     IBB66800
       SPACE   2                                                        IBB66810
       TCD     *                                                     $6$IBB66820
       TTL     SYSTEM CORE-STORAGE DUMP PROGRAM                         IBD00000
*                         SYSTEM DUMP ROUTINE                           IBD00010
       LBL     DUMP0000,1                                               IBD00020
       BES     SYSCUR-*                                                 IBD00030
       BCI     1,SYSDMP                                                 IBD00040
       BES     SYSTRA-*                                                 IBD00050
       TRA     IBDUMP                                                   IBD00060
       BES     DMPSW-*                                               $6$IBD00070
       PZE                                                              IBD00080
       BES     .ENBSW-*            SET ENABLE SWITCH NON-ZERO SO     $6$IBD00090
       BCI     1,                  SYSLDR DOSNT ENB TRAPS WHEN DONE     IBD00100
       BES     SYSTMS-*                                                 IBD00110
       QUAL    D                                                     $6$IBD00120
HAC    BSS     1                                                        IBD00130
HMQ    BSS     1                                                        IBD00140
HSI    BSS     1                                                        IBD00150
HQP    BSS     1                                                        IBD00160
IR2    BSS     1                                                        IBD00170
IR4    BSS     1                                                        IBD00180
TRIG   BSS     4                                                        IBD00190
       BES     SYSORG-*                                                 IBD00200
ONLIN  BOOL    1                                                        IBD00210
DBLSPC BOOL    0                                                        IBD00220
KEYSWT EQU     4                                                        IBD00230
FORMAT EQU     3                                                        IBD00240
       SPACE   2                                                        IBD00250
IBDUMP SXD     SVPNL0,1                                                 IBD00260
       AXT     4*$NOUCW,1                                               IBD00270
       CAL     SVPNL3                                                   IBD00280
GETUCB LDI     $UEA11+4*$NOUCW,1                                        IBD00290
       LNT     020000                                                   IBD00300
       TRA     NT7909                                                   IBD00310
       LFT     000700                                                   IBD00320
       STP     $UEA11+2+4*$NOUCW,1                                      IBD00330
       LDQ     $UEA11+2+4*$NOUCW,1                                      IBD00340
       TQP     *+2                                                      IBD00350
       STZ     $UEA11+2+4*$NOUCW,1                                      IBD00360
NT7909 STZ     $UEA11+1+4*$NOUCW,1                                      IBD00370
       TIX     GETUCB,1,4                                               IBD00380
       AXT     HGHCHN,1            AND                               $6$IBD00390
       STZ     CHXAC+HGHCHN,1      ACTIVITY AND PRIORITY             $6$IBD00400
       STZ     CHXSP+HGHCHN,1      CELLS                             $6$IBD00410
       TIX     *-2,1,1             X                                    IBD00420
       STZ     .ENBSW                                                $6$IBD00430
       CLA     $ACC                                                     IBD00440
       STO     SET8                                                     IBD00450
       STO     HAC                                                      IBD00460
       CLA     $MQ                                                      IBD00470
       STO     SET8+1                                                   IBD00480
       TRA     J-1                                                      IBD00490
SVPNL0 PZE                                                              IBD00500
SVPNL1 PZE                                                              IBD00510
SVPNL2 PZE                                                              IBD00520
SVPNL3 PON                                                              IBD00530
OUTBUF OCT     ,,,,,,,,,,,,,,,,,,,,                                     IBD00540
 BLANK BCI     1,                                                       IBD00550
 ALSME BCI     9,WORDS         TO         ALL CONTAIN                   IBD00560
       STO     HMQ                                                      IBD00570
J      CAL     $QP                                                      IBD00580
       SLW     HQP                                                      IBD00590
       STD     IR4                                                      IBD00600
       STP     TAPBUF+3                                                 IBD00610
       CLA     .IOXSI                                                $6$IBD00620
       STO     HSI                                                      IBD00630
       STO     SET8+2                                                   IBD00640
       ENK                                                              IBD00650
       TNX     *+1,0,3072                                               IBD00660
       STQ     SET8+3                                                   IBD00670
       CLA     TRIG+1                                                   IBD00680
       AXT     4,1                                                      IBD00690
       STZ     TRIG+4,1                                                 IBD00700
       XEC     *+8,1                                                    IBD00710
       STL     TRIG+4,1                                                 IBD00720
       TIX     *-3,1,1                                                  IBD00730
       TRA     *+5                                                      IBD00740
TAPBUF TZE     *-2                                                      IBD00750
       DCT                                                              IBD00760
       IOT                                                              IBD00770
       TRA     *-5                                                      IBD00780
       LXD     IR2,2                                                    IBD00790
       LXD     IR4,4                                                    IBD00800
       SXA     SVPNL0,2       AC,                                       IBD00810
       SXD     SVPNL1,3       MQ,                                       IBD00820
       SXA     SVPNL1,4       KEYS,                                     IBD00830
       SXD     SVPNL2,5       INDEX                                     IBD00840
       SXA     SVPNL2,6       REGISTERS,                                IBD00850
       SXD     SVPNL3,7       SENSE                                     IBD00860
       AXT     0,1                                                      IBD00870
       AXT     0,2                                                      IBD00880
       TXI     *+1,3,1        LIGHTS,                                   IBD00890
       TXL     NINT4,1,0      SENSE                                     IBD00900
       STL     NINSWT         SWITCHES,                                 IBD00910
       AXT     4400,1                AND                                IBD00920
       SXA     PANEL+13,1     INDICATORS                                IBD00930
       LXA     SVPNL1,1       IN                                        IBD00940
       SXD     SVPNL1,1       PANEL                                     IBD00950
       AXT     6,1            AREA                                      IBD00960
       CAL     PANEL          FOR                                       IBD00970
       SLW     PANEL+20,1     DUMP                                      IBD00980
       TIX     *-1,1,1        HEADING                                   IBD00990
NINT4  AXT     4,2                                                      IBD01000
       CAL     SET8+4,2                                                 IBD01010
       XCA                                                              IBD01020
       TSX     OCTED,4                                                  IBD01030
OCTRTN AXT     8,4            EDIT AC, MQ, S.I. AND                     IBD01040
       SLW     J+8,4          KEYS FOR CORE DUMP                        IBD01050
       STQ     J+9,4                                                    IBD01060
       TXI     *+1,4,-2                                                 IBD01070
       SXA     OCTRTN,4                                                 IBD01080
       ZET     2NDSWT                                                   IBD01090
       TXI     EDITXR,2,-1                                              IBD01100
       TIX     NINT4+1,2,1                                              IBD01110
       STL     JSWT                                                     IBD01120
       TRA     ZROBUF+3                                                 IBD01130
JRTRN  STZ     JSWT                                                     IBD01140
       AXT     10,2                                                     IBD01150
       CAL     J+6,2                                                    IBD01160
       SLW     PANEL+30,2                                               IBD01170
       TIX     *-2,2,1                                                  IBD01180
       STL     2NDSWT                                                   IBD01190
       AXT     8,2                                                      IBD01200
       SXA     OCTRTN,2                                                 IBD01210
       AXT     4,2                                                      IBD01220
EDITXR LDQ     SVPNL0+4,2     EDIT INDEX REGISTERS                      IBD01230
       LGL     3                                                        IBD01240
       TXH     NINT4+3,2,0                                              IBD01250
       AXT     7,2                                                      IBD01260
       CAL     J+7,2                                                    IBD01270
       ORA     SIXTY                                                    IBD01280
       SLW     J+7,2                                                    IBD01290
       TIX     *-3,2,1                                                  IBD01300
       AXT     29,1                                                     IBD01310
       AXT     7,2                                                      IBD01320
XRNORM CLA     J+7,2                                                    IBD01330
       STO     PANEL+59,1                                               IBD01340
       LDQ     J+8,2                                                    IBD01350
       TNX     XRFIN,2,2                                                IBD01360
       CAL     3BLKS                                                    IBD01370
       LGL     18                                                       IBD01380
       SLW     PANEL+60,1                                               IBD01390
       XCL                                                              IBD01400
       ORA     3BLKS                                                    IBD01410
       SLW     PANEL+61,1                                               IBD01420
       TXI     XRNORM,1,-3                                              IBD01430
XRFIN  AXT     6,2                                                      IBD01440
       LXA     XRNORM-2,1                                               IBD01450
       CAL     PANEL                                                    IBD01460
       ZET     NINSWT                                                   IBD01470
       SLW     PANEL+63,1                                               IBD01480
       TXI     *+1,1,-1                                                 IBD01490
       TIX     *-3,2,1                                                  IBD01500
       CLS     TWENTY                                                   IBD01510
       STO     TWENTY                                                   IBD01520
       TPL     COMFIN                                                   IBD01530
       ADD     3BLKS                                                    IBD01540
       STA     3BLKS                                                    IBD01550
       AXT     4,1            EDIR INDEX REGISTERS                      IBD01560
       CAL     ZROSVN         IN COMPLEMENTED FORM                      IBD01570
       ERA     SVPNL0+4,1                                               IBD01580
       ADD     ONEONE                                                   IBD01590
       ANA     ZROSVN                                                   IBD01600
       SLW     SVPNL0+4,1                                               IBD01610
       TIX     *-5,1,1                                                  IBD01620
       AXT     9,1                                                      IBD01630
       SXA     XRNORM-2,1                                               IBD01640
       TRA     EDITXR-3                                                 IBD01650
COMFIN AXT     4,1                                                      IBD01660
       PXA     0,0                                                      IBD01670
       ZET     TRIG+4,1                                                 IBD01680
       ADD     ONE                                                      IBD01690
       ALS     1                                                        IBD01700
       TIX     *-3,1,1                                                  IBD01710
       AXT     4,1                                                      IBD01720
       ADD     ONE                                                      IBD01730
       SLT     5,1                                                      IBD01740
       SUB     ONE                                                      IBD01750
       ALS     1                                                        IBD01760
       TIX     *-4,1,1                                                  IBD01770
       AXT     6,1                                                      IBD01780
       ADD     ONE                                                      IBD01790
       SWT     7,1                                                      IBD01800
       SUB     ONE                                                      IBD01810
       ALS     1                                                        IBD01820
       TIX     *-4,1,1                                                  IBD01830
       ORS     TRIGS                                                    IBD01840
SETIND LDQ     ON                                                       IBD01850
       ARS     1                                                        IBD01860
       LBT                                                              IBD01870
       LDQ     OFF                                                      IBD01880
       STQ     PANEL+119,1                                              IBD01890
       TXI     *+1,1,1                                                  IBD01900
       TXL     SETIND,1,6                                               IBD01910
       TXH     *+2,1,7                                                  IBD01920
       TXI     *+1,1,2                                                  IBD01930
       TXL     SETIND,1,12                                              IBD01940
       TXH     *+2,1,13                                                 IBD01950
       TXI     *+1,1,1                                                  IBD01960
       TXL     SETIND,1,17                                              IBD01970
       AXT     2,1                                                      IBD01980
       CAL     HQP                                                      IBD01990
       ALS     33                                                       IBD02000
       ALS     1                                                        IBD02010
       LDQ     ON                                                       IBD02020
       PBT                                                              IBD02030
       LDQ     OFF                                                      IBD02040
       STQ     PANEL+102,1                                              IBD02050
       TIX     *-5,1,1                                                  IBD02060
       CLA*    UCBSCR       GET UCB1 FOR SCRATCH TAPE                   IBD02070
       PDX     ,2                                                       IBD02080
       PAI                                                              IBD02090
       LNT     020000        TEST FOR 7909 DATA CHNL                    IBD02100
       TXI     NTHYSC,2,16   OFF                                        IBD02110
       STL     HYPSWT        ON                                         IBD02120
       ARS     23                                                       IBD02130
       ANA     ONE           DETERMINE INTERFACE                        IBD02140
       ORS     SMS           AND SET IN SET MODE COMM                   IBD02150
       RIS     UNMSK         PLACE UNIT NUMBER                          IBD02160
       OSI     HORDH         INTO HYPER ORDER                           IBD02170
       STI     HORDT                                                    IBD02180
       CLA     HBSR                                                     IBD02190
       STD     SVE1-2                                                   IBD02200
       CLA     HERR          MODIFY ERROR TEST                          IBD02210
       STO     MSSEL+1                                                  IBD02220
NTHYSC SXA     729SRS,2                                                 IBD02230
       SXA     729SWS,2                                                 IBD02240
       CLA     $DPUCB              DID A REEL SWITCH                 $6$IBD02250
       STD     *+2                 OCCUR WITHIN THIS JOB                IBD02260
       LAC     UCBSCR,1                                                 IBD02270
       TXI     *+1,1,**                                                 IBD02280
       TXL     NORLSW,1,0          NO, CONTINUE                         IBD02290
       ARS     18                                                       IBD02300
       STA     UCBOUA                                                   IBD02310
       TSX     FIXOU,4                                                  IBD02320
       LDI     OUTSLW              YES                                  IBD02330
       STI     SAVSEL              SAVE ORIGINAL SELECT                 IBD02340
       SIR     20                  AND CREATE BINARY SELECT             IBD02350
       STI     OUTSLW              FOR SYSOU1                           IBD02360
       TSX     TPIOEX,4            WRITE OUT UPPER AREA                 IBD02370
       PZE     CPYSPL              ONTO SYSOU1                          IBD02380
BCKOUA AXT     2,2                 BACKSPACE SYSOU1                     IBD02390
       TSX     NDATA,4,5           TWO RECORDS                          IBD02400
       TIX     *-1,2,1                                                  IBD02410
       CLS     XIOXSL                                                   IBD02420
       STO     XIOXSL              SECOND TIME                          IBD02430
       TMI     FIXUP               YES                                  IBD02440
       CLA     729SRS                                                   IBD02450
       STD     OUTSLW              SET UP BINARY READ SELECT            IBD02460
       CLA     CTLOUR              CHANGE CTLW TO CLTR                  IBD02470
       STO     SMSBIN+2            IN CASE HYPER OU1                    IBD02480
       TSX     TPIOEX,4            READ IN RECORD ONE                   IBD02490
       PZE     CPYSPL                                                   IBD02500
       NZT     XIOXIN              WAIT FOR RECORD ONE TO COME IN       IBD02510
       TRA     *-1                                                      IBD02520
       TSX     TPSPAC,4            NOW WRITE IT OUT ON                  IBD02530
       CLA     TWO                 SYSPP2 AND FIX UP                    IBD02540
       STO     POSCNT              POSITION COUNTER                     IBD02550
       TSX     TPIOEX,4            READ BACK UPPER AREA                 IBD02560
       PZE     CPYSPL              INTO ORIGINAL PLACE                  IBD02570
       TRA     BCKOUA              AND REPOSITION SYSOU1                IBD02580
FIXUP  CLA     SAVSEL              RESTORE ORIGINAL SELECT              IBD02590
       STO     OUTSLW              AND GET PROPER                       IBD02600
       LAC     UCBOUA,1            UNIT CONTROL BLOCK POINTER           IBD02610
       TRA     NORLSW+1                                                 IBD02620
NORLSW LAC     UCBSCR,1                                                 IBD02630
       CLA     2,1           UPDATE SCRATCH RECORD                      IBD02640
       ADD     ONE           COUNT FOR SPILL RECORD                     IBD02650
       STO     2,1                                                      IBD02660
       CLA     SYSOU1                                                $6$IBD02670
       STA     UCBOUA                                                   IBD02680
       TSX     FIXOU,4                                                  IBD02690
       LXD     IR4,4                                                    IBD02700
       TXL     RENTRY,4,-ENDDMP   IS CALL SEQ. IN DUMP AREA             IBD02710
       TXH     *+3,4,1-ENDDMP  YES,IS HALF OF IT OUT OF DUMP AREA       IBD02720
       LDQ     ENDDMP          YES,GET IT                               IBD02730
MIDCON STQ     SWT5          AND SAVE IT THUS SETTING SWITCH            IBD02740
       TSX     TPSPAC,4,0      AND WRITE OUT BUFFER                     IBD02750
       STL     SWSONE                       SET SWITCH                  IBD02760
       TSX     TPSPAC,4,2    AND READ IN 1ST RECORD                     IBD02770
       STL     SWSTWO                       SET SWITCH                  IBD02780
       LXD     IR4,4                                                    IBD02790
       TXI     *+1,4,-ENDDMP                                            IBD02800
RENTRY CAL     0,4           GET 1ST HALF OFF CALL SEQ                  IBD02810
       ERA     TSXTAB         TEST FOR SNAP                             IBD02820
       LDQ     SWT5          YES,RESTORE IT                             IBD02830
       NZT     SWT5           CALL SEQ PREVIOUSLY SAVED                 IBD02840
       LDQ     1,4            NO,GET CALL SEQ.                          IBD02850
       TZE     SCANER         THIS IS A SNAP DUMP                       IBD02860
       STZ     SNAP           NOT A SNAP RESET SWITCH                   IBD02870
       ERA     TEMP           IS IT POST MORT. CALL SEQ.                IBD02880
       TZE     SCANER         IS AC  ZERO-YES                           IBD02890
       LDQ     PSUEDO                                                   IBD02900
       SWT     KEYSWT                                                   IBD02910
       TRA     SCANER         NO KEYS DUMP TAKE FULL CORE               IBD02920
 TIPE2 TSX     PROUT,4                      THIS IS A                $6$IBD02930
       PZE     1                            POST MORTUM DUMP            IBD02940
       PZE     ENKMSG,,7+512*4              WITH A HALT                 IBD02950
       HTR     *+1                          TO ENTER LIMITS             IBD02960
       ENK                                  INTO THE KEYS               IBD02970
       TRA     SCANER                                                   IBD02980
SAVSEL PZE     0                                                        IBD02990
 FIXOU CLA*    UCBOUA              GET UCB FOR OUTPUT                   IBD03000
       PAI                                                              IBD03010
       ARS     18             GET UNIT ADDRESS                          IBD03020
       STA     OUTSLW         AND SET BCD SELACT                        IBD03030
       STZ     HYPOUT                                                   IBD03040
       LFT     020000                                                   IBD03050
       STL     HYPOUT         SET HYPER SWITCH                          IBD03060
       ARS     5                                                        IBD03070
       ANA     ONE                                                      IBD03080
       ORA     SIX                 SET BINARY SMS                       IBD03090
       STA     SMSBIN                                                   IBD03100
       ORA     TWENTY                                                   IBD03110
       STA     SMSOU          SET BCD SMS                               IBD03120
       RIS     UNMSK                                                    IBD03130
       OSI     HORDH                                                    IBD03140
       STI     HORDW               FROM SELECT BLANK MASK               IBD03150
       TRA     1,4                 RETURN                               IBD03160
CPYSPL IORT    ENDDMP,,ENDDMP                                           IBD03170
SMSBIN SMS     6                                                        IBD03180
       LIPT    *+1                                                      IBD03190
       CTLW    HORDW                                                    IBD03200
       CPYD    ENDDMP,,ENDDMP                                           IBD03210
       TCH     SYSTWT                                                   IBD03220
CTLOUR CTLR    HORDW                                                    IBD03230
ENKMSG BCI     7,      ENTER KEYS AND PRESS START                       IBD03240
SYSMSG BCI     8,      SYSTEMS CORE DUMP TAKEN AT THIS POINT            IBD03250
ERRMSG BCI     5,      SPILL TAPE READ ERROR                            IBD03260
* SCAN AND PICKOFF THE LIMITS FOR THE DUMP                              IBD03270
SCANER XCA                                                              IBD03280
       TNZ     *+2                                                      IBD03290
       CLA     PSUEDO                                                   IBD03300
       XCA                                                              IBD03310
       ZAC                                                              IBD03320
       LGL     3                                                        IBD03330
       STO     FMTDMP        STORE DUMP FORMAT                          IBD03340
       ZAC                                                              IBD03350
       LGL     15                                                       IBD03360
       STO     LOWPRM                       STORE STARTING LOCATION     IBD03370
       ZAC                                  OF THE DUMP                 IBD03380
       LGL     3                                                        IBD03390
       STO     OTUNIT                       STORE OUTPUT UNIT           IBD03400
       ZAC                                                              IBD03410
       LGL     15                                                       IBD03420
       STO     UPPRM                        STORE ENDING LOCATION       IBD03430
       CLA     FMTDMP        FORMAT GIVEN?                              IBD03440
       TNZ     *+2           IF YES -TRA                                IBD03450
       CLA     FORM          NO GET ASSEMBLY DEFINED FORMAT             IBD03460
       LGL     18            SHIFT IT + MAKE IT                         IBD03470
       ADD     OCT20         A BCD VALUE                                IBD03480
       STD     CORTP         + STORE IT                                 IBD03490
CONT   STL     TAP729        SET                                        IBD03500
       STL     PRNTSW        SWITCHES                                   IBD03510
       CLA     OTUNIT        WHAT OUTPUT UNIT                           IBD03520
       CAS     TWO           IS DESIRED-                                IBD03530
       STZ     PRNTSW        ITS TAPE                                   IBD03540
       TRA     WRTPNL        ITS BOTH                                   IBD03550
       TZE     *-2           ITS TAPE                                   IBD03560
       STZ     TAP729        ITS PRINTER                                IBD03570
       BSS     -7*ONLIN                                                 IBD03580
WRTPNL ZET     SNAP          SNAP DUMP +                                IBD03590
       TRA     UPDAT                                                    IBD03600
       TSX     PROUT,4             NO,--PRINT MESSAGE                $6$IBD03610
       PZE     1                                                        IBD03620
       PZE     SYSMSG,,8+512*4                                          IBD03630
LDXR2  AXT     6,2           THEN WRITE PANEL                           IBD03640
       AXT     120,1                                                    IBD03650
       AXT     20,4                                                     IBD03660
       CLA     PANEL+120,1                                              IBD03670
       STO     OUTBUF+20,4                                              IBD03680
       TXI     *+1,1,-1                                                 IBD03690
       TIX     *-3,4,1                                                  IBD03700
       TSX     PRINT,4                                                  IBD03710
       STZ     LATCH                                                    IBD03720
       TIX     LDXR2+2,2,1                                              IBD03730
       STL     LATCH                                                    IBD03740
CONT2  LDQ     UPPRM         ARE PARAMETERS IN                          IBD03750
       CLA     LOWPRM        PROPER ORDER                               IBD03760
       TLQ     RVRSE         YES-DONNOT TRANSFER                        IBD03770
RNDOFF ARS     3             ROUND                                      IBD03780
       ALS     3             OFF                                        IBD03790
       STA     LOWPRM        AND STORE LOWER PARAMETER                  IBD03800
       TRA     ENTRYB                                                   IBD03810
RVRSE  XCA                   NO-REVERSE THEM                            IBD03820
       STQ     UPPRM         STORE UPPER PARAMETER                      IBD03830
       TRA     RNDOFF        AND GO ROUND OFF LOWER PARAMETER           IBD03840
ENTRYB LXA     LOWPRM,1                     IS THE STARTING POINT       IBD03850
       TXL     LOSTRT,1,ENDDMP-1       IN DESTROYED AREA                IBD03860
       TXH     LSTMID,1,2*ENDDMP-1  NO,IS IT INLAST 3RD                 IBD03870
       NZT     SWSTWO                       NO,MID 3RD IN OK            IBD03880
       TRA     LSTMID                       YES                         IBD03890
       TSX     TPSPAC,4,1    NO-READ IT IN                              IBD03900
       STZ     SWSTWO                       AND TURN OFF SWITCH         IBD03910
LSTMID STL     ENDFLG                       SET EOJ SWITCH              IBD03920
       CLA     LOWPRM                       PLUG STARTING LOCATION      IBD03930
       STO     RELLOW                       INTO PRINT BUFFER           IBD03940
       CLA     UPPRM                        PLUG ENDING LOCATION        IBD03950
       STO     RELHI                        INTO PRINT BUFFER           IBD03960
       TRA     C1                           GO DUMP                     IBD03970
LOSTRT NZT     SWSONE        IS MID 3RD WRITTEN OUT ?                   IBD03980
       TSX     TPSPAC,4,0    NO-WRITE IT OUT                            IBD03990
       STL     SWSONE                       + SET SWITCH                IBD04000
       NZT     SWSTWO        IS LOW 3RD READ IN ?                       IBD04010
       TSX     TPSPAC,4,2    NO-READ IT IN                              IBD04020
       STL     SWSTWO                       + SET SWITCH                IBD04030
       LXA     LOWPRM,1                     BUMP UP STARTING            IBD04040
       TXI     *+1,1,ENDDMP                 LOCATION RELATIVE TO BUFFER IBD04050
       SXA     RELLOW,1      AND STORE                                  IBD04060
       LXA     UPPRM,1                                                  IBD04070
       TXH     NOTSET,1,ENDDMP-1       BE BUMPED UP                     IBD04080
       TXI     *+1,1,ENDDMP                 YES,BUMP IT                 IBD04090
       SXA     RELHI,1       AND STORE                                  IBD04100
       STL     ENDFLG                       SET EOJ SWITCH              IBD04110
       TRA     C1                           GO DUMP                     IBD04120
NOTSET AXT     2*ENDDMP-1,1  NO , LOAD END LIMIT                        IBD04130
       SXA     RELHI,1       OF MID 3RD OF CORE AND STORE               IBD04140
       TRA     C1                           GO DUMP                     IBD04150
UPDAT  NZT     SWSONE                                                   IBD04160
       TSX     TPSPAC,4,                                                IBD04170
       STL     SWSONE                                                   IBD04180
       NZT     SWSTWO                                                   IBD04190
       TSX     TPSPAC,4,2                                               IBD04200
       STL     SWSTWO                                                   IBD04210
       CAL*    NEWLIB                                                   IBD04220
       PDX     0,2                                                      IBD04230
       PAI                                                              IBD04240
       LNT     020000        TEST FOR 7909 DATA CHANNEL                 IBD04250
       TXI     ALBLT,2,16    OFF, MUST BE 729 SYSTAP                    IBD04260
       LFT     001000        TEST FOR NEED OR DISK                      IBD04270
       TRA     LDXR2         YES, RETURN                                IBD04280
       ARS     23            NO, BUILD HYPER FUNCTIONP                  IBD04290
       ANA     ONE                                                      IBD04300
       ORS     UCBSMS        SET SMS COMMAND                            IBD04310
       RIS     UNMSK         SET DRIVE NUMBER                           IBD04320
       OSI     HORDH         IN HYPER CONTROL ORDER                     IBD04330
       STI     UCBORD                                                   IBD04340
       CLA     TRABK                                                    IBD04350
       STD     HYPTRA                                                   IBD04360
       CLA     HBSR                                                     IBD04370
       STD     BKSPAC+1                                                 IBD04380
ALBLT  SXA     UCBRDS,2                                                 IBD04390
UCBCMP LAC     NEWLIB,2                                                 IBD04400
       ZET     1,2                                                      IBD04410
       TRA     *-1                                                      IBD04420
       CLA     ENDDMP+2,2                                               IBD04430
       SLW     HLDUCB                                                   IBD04440
       CAL     2,2                                                      IBD04450
       CAS     HLDUCB                                                   IBD04460
TRABK  TRA     BKSPAC                                                   IBD04470
       TRA     LDXR2                                                    IBD04480
       CAL     SELADD                                                   IBD04490
       SLW     1,2                                                      IBD04500
       TSX     .ACTV,4                                               $6$IBD04510
       PZE     NEWLIB                                                   IBD04520
       TRA     UCBCMP                                                   IBD04530
SELPLS SXA     UCBXR4,4                                                 IBD04540
       PAC     0,4                                                      IBD04550
       TMI     SELMIN                                                   IBD04560
       CLA     COMADD                                                   IBD04570
       STA*    .RCHX                                                 $6$IBD04580
HYPTRA NOP     *+2                                                      IBD04590
UCBRDS RDS     **                                                       IBD04600
       XEC*    .RCHX                                                 $6$IBD04610
UCBXR4 AXT     **,4                                                     IBD04620
       TRA     1,4                                                      IBD04630
SELMIN STZ     1,4                                                      IBD04640
       TRA     UCBXR4                                                   IBD04650
BKSPAC TSX     .NDSEL,4                                              $6$IBD04660
       PZE     NEWLIB,,5     BACKSPACE RECORDS                          IBD04670
       NOP                                                              IBD04680
       TRA     UCBCMP                                                   IBD04690
NEWCON PZE     ENDDMP                                                   IBD04700
SELADD PZE     ,,SELPLS                                                 IBD04710
UCBORD PZE                                                              IBD04720
COMADD PZE     *+1                                                      IBD04730
       IORT    TEMP,,1                                                  IBD04740
       LIPT    *+1                                                      IBD04750
UCBSMS SMS     6                                                        IBD04760
       CTLR    UCBORD                                                   IBD04770
       CPYD    TEMP,,1                                                  IBD04780
       TCH     SYSTWT                                                   IBD04790
HLDUCB PZE                                                              IBD04800
TSXTAB TSX     SYSDMP,4,0                   FULL CORE ASSBLY FORMAT     IBD04810
PSUEDO PZE     -1                                                       IBD04820
SNAP   MON                                                              IBD04830
FORM   PZE     FORMAT                                                   IBD04840
OTUNIT PZE                                                              IBD04850
OCT20  OCT     000020000000                                             IBD04860
ENDBUF PZE     ALTBUF+100                                               IBD04870
FMTDMP PZE                                                              IBD04880
RELLOW PZE                                                              IBD04890
RELHI  PZE                                                              IBD04900
LNTHLW PZE                                                              IBD04910
SWSONE PZE                                                              IBD04920
       PZE     TAPBUF+100                                               IBD04930
SWSTWO PZE                                                              IBD04940
C1     CLA     FIRST                                                    IBD04950
       STA     LNTHLW                                                   IBD04960
       LXA     RELLOW,1                                                 IBD04970
       ZET     NFORM                                                    IBD04980
       TRA     REG                                                      IBD04990
       LXD     CORTP,2                                                  IBD05000
       TXI     *+1,2,-18                                                IBD05010
       STL     NTBCD                                                    IBD05020
       CLA     LIST+7                                                   IBD05030
       TXH     *+3,2,0                                                  IBD05040
       STZ     NTBCD                                                    IBD05050
       ADD     LIST+7                                                   IBD05060
       STO     EIGHT                                                    IBD05070
C1P    CLA     LOWPRM                                                   IBD05080
       STO     FIRST                                                    IBD05090
       STA     TOFROM                                                   IBD05100
       CLA*    RELLOW                                                   IBD05110
       STO     TEMP                                                     IBD05120
       STZ     NFORM                                                    IBD05130
       SXA     LNTHLW,1                                                 IBD05140
REG    SXA     RELLOW,1                                                 IBD05150
       CAL     TEMP                                                     IBD05160
       ERA*    RELLOW                                                   IBD05170
       TNZ     UNEQ                                                     IBD05180
       CLA     RELHI                                                    IBD05190
       CAS     RELLOW                                                   IBD05200
       TXI     REG,1,1                                                  IBD05210
       STL     ENDJB                                                    IBD05220
UNEQ   LXA     LOWPRM,2                                                 IBD05230
       TXH     *+2,2,ENDDMP-1                                           IBD05240
       TXI     *+1,1,-ENDDMP                                            IBD05250
       PXA     0,1                                                      IBD05260
       SUB     FIRST                                                    IBD05270
       LRS     35                                                       IBD05280
       DVP     EIGHT                                                    IBD05290
       MPY     EIGHT                                                    IBD05300
       XCA                                                              IBD05310
       STL     NFORM                                                    IBD05320
       TNZ     *+6           TRANSFER IF EQUAL WDS.                     IBD05330
       ZET     ENDJB         OTHERWISE TEST ENDJB                       IBD05340
       ZET     ENDFLG        IF ON TEST ENDFLG                          IBD05350
       STZ     NFORM         IF OFF CARRY ON                            IBD05360
       STZ     ENDJB                                                    IBD05370
       ADD     EIGHT                                                    IBD05380
       ADD     FIRST                                                    IBD05390
       STA     LOWPRM                                                   IBD05400
       SUB     FIRST                                                    IBD05410
       ADD     LNTHLW                                                   IBD05420
       STA     RELLOW                                                   IBD05430
       STA     GET                                                      IBD05440
       LXA     LOWPRM,2                                                 IBD05450
       TXI     *+1,2,-1                                                 IBD05460
       SUB     RELHI                                                    IBD05470
       ZET     ENDJB                                                    IBD05480
       CLA     ONE                                                      IBD05490
       TMI     NOTEND                                                   IBD05500
       TZE     NOTEND                                                   IBD05510
       SUB     ONE                                                      IBD05520
       STA     ZROBUF                                                   IBD05530
       ZET     NTBCD                                                    IBD05540
       ALS     1                                                        IBD05550
       STA     CLEAR                                                    IBD05560
       STZ     ENDJB                                                    IBD05570
       ZET     ENDFLG                                                   IBD05580
       TRA     WRAPUP                                                   IBD05590
       CLA     NEWCON                                                   IBD05600
       ZET     NFORM                                                    IBD05610
       TRA     RVRSE-2       GO STORE NEW LOWPRM                        IBD05620
       STL     UNDONE                                                   IBD05630
       TRA     NOTEND                                                   IBD05640
WRAPUP STL     ENDJB                                                    IBD05650
       ZET     NFORM                                                    IBD05660
       LXA     UPPRM,2                                                  IBD05670
NOTEND SXD     TOFROM,2                                                 IBD05680
       LXA     EIGHT,2                                                  IBD05690
       CLA     TEMP                                                     IBD05700
       NZT     NFORM                                                    IBD05710
       CLA*    GET                                                      IBD05720
       STO     SET8+8,2                                                 IBD05730
       TIX     *-2,2,1                                                  IBD05740
EDIT8  TSX     CLRBUF,4       CLEAR BUFFER AND INSERT ADDRESSES IN      IBD05750
       LDQ     TOFROM         OUTBUF AND EQUAL WORDS LINE.              IBD05760
       LGL     3                                                        IBD05770
       TSX     OCTED,4        CHANGE TO TWO WORDS OF OCTAL BCD          IBD05780
       ORA     SIXTY          BLANK TO AC 30-35                         IBD05790
       SLW     ALSME+3                                                  IBD05800
       LGR     6                                                        IBD05810
       STQ     ALSME+1                                                  IBD05820
       NZT     NFORM                                                    IBD05830
       STQ     OUTBUF                                                   IBD05840
       ZET     NTBCD          IS FORMAT BCD-                            IBD05850
       TRA     NOTHL                                                    IBD05860
HOLL   AXT     6,4                                                      IBD05870
       CAL     ALSME+6,4                                                IBD05880
       SLW     OUTBUF+10,4                                              IBD05890
       TIX     *-2,4,1                                                  IBD05900
       AXT     16,2                                                     IBD05910
HOLL1  CAL     SET8+8,2                                                 IBD05920
       SLW     SUBJ                                                     IBD05930
       TRA     SCAN                SCAN FOR RECORD MARKS AND ILLEGAL    IBD05940
SCNRTN NZT     NFORM             CHARACTERS                             IBD05950
       TRA     *+3                                                      IBD05960
       STQ     OUTBUF+11                                                IBD05970
       TRA     LLNE                PRINT EQUAL WORDS LINE               IBD05980
       STQ     SET8+8,2                                                 IBD05990
       TIX     HOLL1,2,1                                                IBD06000
       NZT     ENDJB                                                    IBD06010
       TRA     *+6                                                      IBD06020
       CLA     BLANK                                                    IBD06030
CLEAR  AXT     **,1                                                     IBD06040
       TXL     *+3,1,0                                                  IBD06050
       STO     SET8+8,1                                                 IBD06060
       TIX     *-1,1,1                                                  IBD06070
       AXT     16,2                                                     IBD06080
       AXT     20,4                                                     IBD06090
       CAL     SIXTY                                                    IBD06100
       AXT     30,1                                                     IBD06110
INSLSH SXA     *+2,1                                                    IBD06120
       LDQ     SET8+8,2                                                 IBD06130
       LGL     **                                                       IBD06140
       SLW     OUTBUF+21,4                                              IBD06150
       LGL     36,1                                                     IBD06160
       TNX     LSWD,2,1                                                 IBD06170
       TXI     *+1,4,-1                                                 IBD06180
       TXH     *+4,1,0                                                  IBD06190
       SLW     OUTBUF+21,4                                              IBD06200
       AXT     36,1                                                     IBD06210
       TXI     *+1,4,-1                                                 IBD06220
       ALS     6                                                        IBD06230
       ORA     SIXTY                                                    IBD06240
       TXI     INSLSH,1,-6                                              IBD06250
LSWD   LDQ     BLANK                                                    IBD06260
       LGL     12                                                       IBD06270
       SLW     OUTBUF+19                                                IBD06280
       TRA     LLNE                                                     IBD06290
NOTHL  STL     SQEDT                                                   HIBD06300
       STZ     TWOLIN                                                   IBD06310
       STZ     SQEZY                                                    IBD06320
       STZ     NTBLK                                                    IBD06330
       LXD     CORTP,1                                                  IBD06340
       TXH     NOTHL1,1,19                                              IBD06350
       STL     TWOLIN                                                   IBD06360
       TXL     SECND,1,18                                               IBD06370
       STZ     SQEDT                                                    IBD06380
NOTHL1 TXL     SECND,1,20                                               IBD06390
       STL     SQEZY                                                    IBD06400
       TXL     SECND,1,21                                               IBD06410
       STL     NTBLK                                                    IBD06420
SECND  AXT     8,1                 INITIALIZE COUNTS                    IBD06430
       AXT     16,2                                                     IBD06440
LDMQ   LDQ     SET8+8,1                                                 IBD06450
       STQ     SUBJ                                                     IBD06460
       SXA     RETURN,1            SAVE INDEX REGISTER 1 AND RESTORE    IBD06470
       STZ     SWT1              FLAGS IN MNEMONIC SEARCH ROUTINE       IBD06480
       STZ     SWT2                                                     IBD06490
       STZ     SWT3                                                     IBD06500
       STZ     SWT4                                                     IBD06510
       STZ     PLUS                                                     IBD06520
       ZET     SQEDT          IF NON-ZERO, OCTAL LINE REQUIRED          IBD06530
       TRA     NOOP                                                     IBD06540
       TSX     OCTED,4        CHANGE MQ WORD TO OCTAL BCD               IBD06550
       STQ     TEMP                                                     IBD06560
       STQ     ADDR                                                     IBD06570
       CLA     LOCN                                                     IBD06580
       STA     ADSFT                                                    IBD06590
       ARS     18                                                       IBD06600
       STA     BINLK                                                    IBD06610
       PXA     0,0                                                      IBD06620
       CAL     MSK10                                                    IBD06630
       ANS     ADDR                                                     IBD06640
       CLA     OCT                                                      IBD06650
       ARS     30                                                       IBD06660
       TZE     SEEK                                                     IBD06670
       SUB     FIVE                                                     IBD06680
       TZE     SEEK                                                     IBD06690
       ADD     ONE                                                      IBD06700
       TNZ     XRINST                                                   IBD06710
 SEEK  CAL     SUBJ                                                     IBD06720
       LGR     24                                                       IBD06730
       SLW     INSWD                                                    IBD06740
       AXT     9,1                                                      IBD06750
       CAL     TABLE+9,1                                                IBD06760
       LGR     24                                                       IBD06770
       ERA     INSWD                                                    IBD06780
       TZE     FOUND                                                    IBD06790
       TIX     *-4,1,1                                                  IBD06800
       LDI     FSTMID                                                   IBD06810
       CAL     TABLE+71                                                 IBD06820
       LGR     24                                                       IBD06830
       SUB     INSWD                                                    IBD06840
       TPL     BINLK-1                                                  IBD06850
       LDI     2NDMID                                                   IBD06860
       CAL     TABLE+134                                                IBD06870
       LGR     24                                                       IBD06880
       SUB     INSWD                                                    IBD06890
       TMI     BINLK                                                    IBD06900
       STI     *+1                                                      IBD06910
BINLK  CAL     TABLE+166                                                IBD06920
       LGR     24                                                       IBD06930
       LAS     INSWD                                                    IBD06940
       TRA     GTR                                                      IBD06950
       TRA     FOUND               BINARY SEARCH OF MNEMONIC TABLE      IBD06960
       CLA     BINLK                                                    IBD06970
       SUB     ADSFT                                                    IBD06980
       TRA     SHIFT                                                    IBD06990
 GTR   CLA     BINLK                                                    IBD07000
       ADD     ADSFT                                                    IBD07010
 SHIFT STO     BINLK                                                    IBD07020
       CLA     ADSFT                                                    IBD07030
       TZE     NOTFND                                                   IBD07040
       ARS     1                                                        IBD07050
       STO     ADSFT                                                    IBD07060
       TRA     BINLK                                                    IBD07070
 FOUND LGL     24                                                       IBD07080
       LDQ     BLANK                                                    IBD07090
       STQ     WORD2                                                    IBD07100
       LGL     12                                                       IBD07110
       SLW     WORD1                                                    IBD07120
       LGR     15                                                       IBD07130
       LBT                         LOOK FOR SPECIAL CASE FLAG           IBD07140
       TRA     ISMNEM                                                   IBD07150
       ARS     1                                                        IBD07160
       COM                                                              IBD07170
       LBT                                                              IBD07180
       TRA     ISMNEM                                                   IBD07190
       PXA     0,0                 PRESENT.                             IBD07200
       LGL     3                      BLANK OUT SPECIAL CASE FLAG AND   IBD07210
       PAC     0,1                    TRANSFER TO APPROPRIATE ROUTINE   IBD07220
       CAL     SIXTY                                                    IBD07230
       STQ     SAVE1                                                    IBD07240
       LDQ     WORD1                                                    IBD07250
       RQL     24                                                       IBD07260
       LGR     6                                                        IBD07270
       RQL     18                                                       IBD07280
       STQ     WORD1                                                    IBD07290
       LDQ     SAVE1                                                    IBD07300
       NZT     SQEZY                                                    IBD07310
       TRA*    SPCL,1                                                   IBD07320
       TXH     NTBLKL,1,-2                                              IBD07330
       TXH     *-2,1,-5                                                 IBD07340
NTSNSE ZET     SQEZY                                                    IBD07350
       TRA     NTBLKL                                                   IBD07360
 NOOP  CAL     SUBJ                NO MNEMONIC FOUND, OR OCTAL EDIT     IBD07370
       XCA                                                              IBD07380
       TSX     OCTED,4                                                  IBD07390
       SSM                    SET AC NEGATIVE TO INDICATE OCTAL         IBD07400
       ZET     SQEDT                                                    IBD07410
       TRA     RETURN              IF OCTAL REQUIRED, THEN EDIT COMPLETEIBD07420
       TRA     IFBOTH                 ROUTINE, OTHERWISE TEST AC SIGN.  IBD07430
XRINST NZT     SQEZY                                                    IBD07440
       TRA     NOOP                                                     IBD07450
       PAX     0,1                                                      IBD07460
       LDQ     XRWD+3,1                                                 IBD07470
       TPL     *+2                                                      IBD07480
       RQL     18                                                       IBD07490
       LGL     18                                                       IBD07500
       LDQ     BLANK                                                    IBD07510
       LGL     18                                                       IBD07520
       TRA     NTBLKL-1                                                 IBD07530
ISMNEM NZT     SQEZY                                                    IBD07540
       TRA     NORM                                                     IBD07550
       PXA     0,0                                                      IBD07560
       LDQ     OCT                                                      IBD07570
       RQL     24                                                       IBD07580
       LGL     6                                                        IBD07590
       LDQ     BLANK                                                    IBD07600
       SUB     SIX                                                      IBD07610
       TMI     NTBLKL                                                   IBD07620
       CAL     MSK5          INSERT * IN WORD 1                         IBD07630
       ANS     WORD1                                                    IBD07640
       CAL     ASTER                                                    IBD07650
       ORS     WORD1                                                    IBD07660
       TRA     NTBLKL                                                   IBD07670
TYPE0  STL     SWT1                                                     IBD07680
 NORM  PXA     0,0                                                      IBD07690
       CAL     OCT           TYPE 4 MAY HAVE NON ZERO LOW ORDER         IBD07700
       ANA     MSK3                                                     IBD07710
       TNZ     NOOP                   DIGIT SHOULD BE ZERO              IBD07720
       CAL     OCT                                                      IBD07730
       ANA     MSK8                                                     IBD07740
       TZE     NOFLG                                                    IBD07750
       ZET     SWT1                                                     IBD07760
       TRA     NOOP                                                     IBD07770
       ARS     6                                                        IBD07780
       SUB     SIX                                                      IBD07790
       TNZ     NOOP                                                     IBD07800
       CAL     MSK5          INSERT * IN WORD1                          IBD07810
       ANS     WORD1                                                    IBD07820
       CAL     ASTER                                                    IBD07830
       ORS     WORD1                                                    IBD07840
NOFLG  PXA     0,0                                                      IBD07850
       LDQ     TEMP                                                     IBD07860
       LGL     6                                                        IBD07870
       LDQ     BLANK                                                    IBD07880
       TZE     NODRES                                                   IBD07890
       LGR     6             INSERT  ,T IF NON ZERO                     IBD07900
       CAL     COMMA                                                    IBD07910
       LGR     6                                                        IBD07920
       CAL     MSK7                                                     IBD07930
       ANS     WORD2                                                    IBD07940
       LGL     12                                                       IBD07950
       ORS     WORD2                                                    IBD07960
       LGR     12                                                       IBD07970
NODRES ZET     SWT4           NO ADDRESS FOR TYPES 2 AND 3              IBD07980
       TRA     RET                                                      IBD07990
*      INSERT ADDRESS WITH LEADING ZEROS SUPPRESSED                     IBD08000
       CAL     ADDR                                                     IBD08010
       LGR     24                                                       IBD08020
       TZE     PLS22                                                    IBD08030
       LDI     WORD1                                                    IBD08040
       RIS     MSK3                                                     IBD08050
       OAI                                                              IBD08060
       STI     WORD1                                                    IBD08070
       TRA     SHSTO                                                    IBD08080
PLS22  PXA     0,0                                                      IBD08090
       AXT     4,4                                                      IBD08100
       LGL     6                                                        IBD08110
       TNZ     ROTAT                                                    IBD08120
       CAL     BLNK1                                                    IBD08130
       LGR     6                                                        IBD08140
       RQL     6                                                        IBD08150
       TIX     *-5,4,1                                                  IBD08160
       TRA     SHSTO                                                    IBD08170
ROTAT  LGR     6                                                        IBD08180
       RQL     6                                                        IBD08190
       TIX     *-1,4,1                                                  IBD08200
       RQL     12                                                       IBD08210
SHSTO  STQ     WORD2                                                    IBD08220
 RET   CAL     WORD1               PLACE EDITED WORDS IN AC AND MQ READYIBD08230
       LDQ     WORD2                  FOR STORING IN PRNBUF             IBD08240
IFBOTH LXD     CORTP,1                                                  IBD08250
       TXL     RETURN,1,19                                              IBD08260
       TPL     RETURN                                                   IBD08270
       TRA     *+3                                                      IBD08280
NOTFND NZT     SQEZY                                                    IBD08290
       TRA     NOOP                                                     IBD08300
       CAL     BLANK                                                    IBD08310
       SLW     WORD1                                                    IBD08320
NTBLKL ZET     NTBLK          SCAN FOR ILLEGAL CHARACTERS, RECORD       IBD08330
       TRA     SCAN              MARKS                                  IBD08340
       LDQ     BLANK                  MARKS                             IBD08350
       TRA     RETURN-1                                                 IBD08360
TYPE1  ARS     6                                                        IBD08370
       LDQ     OCT                                                      IBD08380
       RQL     24                                                       IBD08390
       LGL     6                                                        IBD08400
       LDQ     BLANK                                                    IBD08410
       ZET     SQEZY                                                    IBD08420
       TRA     RET                                                      IBD08430
       TZE     PL3                                                      IBD08440
       STO     SAVE                                                     IBD08450
       STQ     SAVE1                                                    IBD08460
       LDQ     WORD1                                                    IBD08470
       RQL     30                                                       IBD08480
       LGR     6                                                        IBD08490
       RQL     12                                                       IBD08500
       STQ     WORD1                                                    IBD08510
       CLA     SAVE                                                     IBD08520
       LDQ     SAVE1                                                    IBD08530
       ALS     6                                                        IBD08540
PL3    STQ     SAVE                                                     IBD08550
       ARS     6                                                        IBD08560
       LDQ     OCT                                                      IBD08570
       RQL     30                                                       IBD08580
       LGL     6                                                        IBD08590
       LDQ     SAVE                                                     IBD08600
       TZE     PL5                                                      IBD08610
       STO     SAVE                                                     IBD08620
       STQ     SAVE1                                                    IBD08630
       LDQ     WORD1                                                    IBD08640
       LGR     6                                                        IBD08650
       RQL     6                                                        IBD08660
       STQ     WORD1                                                    IBD08670
       CLA     SAVE                                                     IBD08680
       LDQ     SAVE1                                                    IBD08690
       CAL     TEMP                                                     IBD08700
       SLW     WORD2                                                    IBD08710
       TRA     RET                                                      IBD08720
PL5    LDQ     TEMP                                                     IBD08730
       PXA     0,0                                                      IBD08740
       AXT     6,1                                                      IBD08750
       LGL     6                                                        IBD08760
       TNZ     ADJST                                                    IBD08770
       CAL     BLNK1                                                    IBD08780
       LGR     6                                                        IBD08790
       RQL     6                                                        IBD08800
       TIX     *-5,1,1                                                  IBD08810
       TRA     STMQ                                                     IBD08820
ADJST  LGR     6                                                        IBD08830
       RQL     6                                                        IBD08840
       TIX     *-1,1,1                                                  IBD08850
STMQ   STQ     WORD2                                                    IBD08860
       TRA     RET                                                      IBD08870
TYPE2  AXT     8,1                                                      IBD08880
       LDI     MSEWD+8,1                                                IBD08890
       CAL     ADDR                                                     IBD08900
       ERA     LIST+8,1                                                 IBD08910
       TZE     FND                                                      IBD08920
       TIX     *-4,1,1                                                  IBD08930
       CAL     ADDR                                                     IBD08940
       LGR     6                                                        IBD08950
       RQL     18                                                       IBD08960
       SUB     LIST+10                                                  IBD08970
       LDI     MSEWD+10                                                 IBD08980
       TZE     FND-1                                                    IBD08990
       SUB     LIST+1                                                   IBD09000
       LDI     MSEWD+8                                                  IBD09010
       TZE     FND                                                      IBD09020
       LDI     MSEWD+9                                                  IBD09030
       STL     SWT2                                                     IBD09040
       TRA     TRYCHN                                                   IBD09050
TYPE3  CLA     ADDR                                                     IBD09060
       LDI     PSEWD+12                                                 IBD09070
       TZE     FND                                                      IBD09080
       AXT     12,1                                                     IBD09090
       CAL     ADDR                                                     IBD09100
       LDI     PSEWD+12,1                                               IBD09110
       ERA     LIST+12,1                                                IBD09120
       TZE     FND                                                      IBD09130
       TIX     *-4,1,1                                                  IBD09140
       CAL     ADDR                                                     IBD09150
       LGR     6                                                        IBD09160
       RQL     18                                                       IBD09170
       SUB     LIST+10                                                  IBD09180
       TNZ     *+7                                                      IBD09190
       CAL     ADDR                                                     IBD09200
       ANA     LIST+6                                                   IBD09210
       LDI     PSEWD+13                                                 IBD09220
       TNZ     FND-1                                                    IBD09230
       LDI     PSEWD+14                                                 IBD09240
       TRA     FND                                                      IBD09250
       SUB     LIST+1                                                   IBD09260
       LDI     PSEWD+16                                                 IBD09270
       TNZ     TRYCHN                                                   IBD09280
       LDI     PSEWD+15                                                 IBD09290
       STQ     WORD2                                                    IBD09300
FND    STI     WORD1                                                    IBD09310
       ZET     SQEZY                                                    IBD09320
       TRA     NTBLKL                                                   IBD09330
       ZAC                                                              IBD09340
       STL     SWT4                                                     IBD09350
       TRA     NOFLG                                                    IBD09360
TRYCHN CAL     SUBJ                                                     IBD09370
       LGR     9                                                        IBD09380
       ANA     SVNTY7                                                   IBD09390
       LAS     LIST+7                                                   IBD09400
       TRA     NTSNSE                                                   IBD09410
       NOP                                                              IBD09420
       TZE     NTSNSE                                                   IBD09430
       ZAC                                                              IBD09440
       LGL     9                                                        IBD09450
       TZE     CHNOP                                                    IBD09460
       ZET     SWT2                                                     IBD09470
       TRA     NTSNSE                                                   IBD09480
       SUB     LIST+12                                                  IBD09490
       LDI     PSEWD+17                                                 IBD09500
       TZE     CHNOP                                                    IBD09510
       LDI     PSEWD+18                                                 IBD09520
       SUB     LIST+1                                                   IBD09530
       TNZ     NTSNSE                                                   IBD09540
CHNOP  CAL     SUBJ                                                     IBD09550
       LDQ     BLANK                                                    IBD09560
       ARS     9                                                        IBD09570
       ANA     SVNTY7                                                   IBD09580
       ADD     TWENTY                                                   IBD09590
       LGR     6                                                        IBD09600
       PIA                                                              IBD09610
       ARS     18                                                       IBD09620
       LGL     18                                                       IBD09630
       PAI                                                              IBD09640
       TRA     FND                                                      IBD09650
TYPE7  CAL     SUBJ                                                     IBD09660
       ARS     9                                                        IBD09670
       ANA     SVNTY7                                                   IBD09680
       LAS     LIST+7                                                   IBD09690
       TRA     NOOP                                                     IBD09700
       TRA     *+2                                                      IBD09710
       TZE     NOOP                                                     IBD09720
       ADD     TWENTY                                                   IBD09730
       LDI     WORD1                                                    IBD09740
       RIS     MSK6                                                     IBD09750
       ALS     12                                                       IBD09760
       OAI                                                              IBD09770
       STI     WORD1                                                    IBD09780
       CAL     MSK9                                                     IBD09790
       ANS     ADDR                                                     IBD09800
       TRA     NOFLG                                                    IBD09810
OCTED  AXT     6,1            CREATES TWO OCTAL BCD WORDS IN            IBD09820
       ALS     3                 COMBINED AC-MQ FROM MQ WORD            IBD09830
       LGL     3                                                        IBD09840
       TIX     *-2,1,1                                                  IBD09850
       SLW     OCT                                                      IBD09860
       AXT     6,1                                                      IBD09870
       ALS     3                                                        IBD09880
       LGL     3                                                        IBD09890
       TIX     *-2,1,1                                                  IBD09900
       XCL                                                              IBD09910
       CAL     OCT                                                      IBD09920
       TRA     1,4                                                      IBD09930
SQEZY  MON                                                              IBD09940
SQEDT  PZE                                                              IBD09950
SWT1   PZE                                                              IBD09960
SWT2   PZE                                                              IBD09970
SWT3   PZE                                                              IBD09980
SWT4   PZE                                                              IBD09990
PLUS   PZE                                                              IBD10000
SWT5   PZE                                                              IBD10010
TAP729 PZE                                                              IBD10020
PRNTSW PZE                                                              IBD10030
NTBLK  PZE                                                              IBD10040
MASK1  OCT     777777777717                                             IBD10050
XRWD   BCI     3,TXLTXITNXTIX   TXH                                     IBD10060
 OCT   PZE                                                              IBD10070
TEMP   PZE     ,,1                                                      IBD10080
 ADDR  PZE                                                              IBD10090
 WORD1 PZE                                                              IBD10100
 WORD2 PZE                                                              IBD10110
 INSWD PZE                                                              IBD10120
 SUBJ  PZE                                                              IBD10130
ADSFT  PZE     16                                                       IBD10140
MSK8   OCT     7700                                                     IBD10150
ASTER  OCT     5400                                                     IBD10160
MSK9   OCT     777777                                                   IBD10170
MSK6   OCT     770000                                                   IBD10180
MSK10  OCT     007777777777                                             IBD10190
BLNK1  BCI     1,00000                                                  IBD10200
SAVE1  PZE                                                              IBD10210
MASK11 OCT     17                                                       IBD10220
 MSK1  OCT     777777007777                                             IBD10230
 THRTN OCT     13                                                       IBD10240
FFTEEN OCT     15                                                       IBD10250
MSK3   OCT     000000000077                                             IBD10260
MSK5   OCT     777777770077                                             IBD10270
MSK4   OCT     007700000000                                             IBD10280
MSK7   OCT     777777770000                                             IBD10290
FSTMID CAL     TABLE+40                                                 IBD10300
2NDMID CAL     TABLE+103                                                IBD10310
 SPCL  PZE     TYPE0                                                    IBD10320
       PZE     TYPE1                                                    IBD10330
       PZE     TYPE2                                                    IBD10340
       PZE     TYPE3                                                    IBD10350
 SIXTY OCT     60                                                       IBD10360
       PZE                                                              IBD10370
LOCN   PZE     16,,TABLE+166                                            IBD10380
       PZE     TYPE7                                                    IBD10390
ONE    OCT     1,2,3,4,5,6,7,10,101,102,104,106,350                     IBD10400
PSEWD  BCI     9,LBT   CHS   SSP   ENK   IOT   COM   ETM   RND   FRN    IBD10410
       BCI     9,DCT   RCT   LMTM  CLM   SLN   SLF   SWT   BTT   RIC    IBD10420
       BCI     1,RDC                                                    IBD10430
MSEWD  BCI     9,PBT   EFTM  SSM   LFTM  ESTM  ECTM  LTM   LSNM  EMTM   IBD10440
       BCI     2,ETT   SLT                                              IBD10450
       EJECT                                                            IBD10460
RCDMRK OCT     72                                                       IBD10470
 SCAN  AXT     6,1                                                      IBD10480
       LDQ     SUBJ                                                     IBD10490
       ZAC                                                              IBD10500
       LGL     6                                                        IBD10510
       CAS     RCDMRK                                                   IBD10520
       TRA     *+2                                                      IBD10530
       CLA     THRTN                                                    IBD10540
       STO     TEMP                                                     IBD10550
       ANA     MASK11                                                   IBD10560
       SUB     FFTEEN                                                   IBD10570
       TMI     *+4                                                      IBD10580
       CLA     ASTER                                                    IBD10590
       ARS     6                                                        IBD10600
       STO     TEMP                                                     IBD10610
       CLA     TEMP                                                     IBD10620
       LGR     6                                                        IBD10630
       RQL     6                                                        IBD10640
       TIX     SCAN+2,1,1                                               IBD10650
       NZT     NTBCD                                                    IBD10660
       TRA     SCNRTN                                                   IBD10670
       CAL     WORD1                                                    IBD10680
RETURN AXT     **,1                RESTORE XR1                          IBD10690
       SLW     PRNBUF+16,2         STORE EDIT ROUTINE OUTPUT IN PRNBUF  IBD10700
       STQ     PRNBUF+17,2                                              IBD10710
       ZET     SQEDT                                                    IBD10720
       TRA     DECXR2                                                   IBD10730
       NZT     SQEZY                                                    IBD10740
       TMI     DECXR2                                                   IBD10750
       STZ     SET8+8,1            RESET SIGN IN BUFFER IF NOT REQUIRED IBD10760
DECXR2 TXI     *+1,2,-2          IN OUTBUF                              IBD10770
       NZT     NFORM                                                    IBD10780
       TIX     LDMQ,1,1            RETURN TO EDIT NEXT WORD             IBD10790
       NZT     ENDJB          WHEN PRNBUF FULL TEST ENDJB. IF           IBD10800
       TRA     ZROBUF+3           NON-ZERO BLANK REQUIRED               IBD10810
       LXA     CLEAR,1                NUMBER OF WORDS                   IBD10820
       TXL     ZROBUF+3,1,0                                             IBD10830
       CAL     BLANK                                                    IBD10840
       SLW     PRNBUF+16,1                                              IBD10850
       TIX     *-1,1,1                                                  IBD10860
ZROBUF AXT     **,1                                                     IBD10870
       STZ     SET8+8,1                                                 IBD10880
       TIX     *-1,1,1                                                  IBD10890
       AXT     8,2                                                      IBD10900
       SXA     AXTXR,2                                                  IBD10910
       CLA     2BLKS          ROUTINE TO INSERT TWO BLANKS BETWEEN      IBD10920
       AXT     16,2              EACH PAIR OF OCTAL BCD WORDS AND       IBD10930
       AXT     18,1              CREATE A 120 CHARACTER PRINT LINE      IBD10940
       AXT     12,4                                                     IBD10950
 STXR  SXA     LGL1,4                                                   IBD10960
       LDQ     PRNBUF+16,2                                              IBD10970
       SXA     AXTXR2,2                                                 IBD10980
AXTXR  AXT     **,2                                                     IBD10990
       LDI     SET8+8,2                                                 IBD11000
       LFT     400000                                                   IBD11010
       SUB     TWENTY                                                   IBD11020
       TXI     *+1,2,-1                                                 IBD11030
       SXA     AXTXR,2                                                  IBD11040
AXTXR2 AXT     **,2                                                     IBD11050
       LGL     36,4                                                     IBD11060
       SLW     PRNBUF+14,1                                              IBD11070
 LGL1  LGL     **                                                       IBD11080
       LDQ     PRNBUF+17,2                                              IBD11090
       LGL     36,4                                                     IBD11100
       SLW     PRNBUF+15,1                                              IBD11110
       XEC     LGL1                                                     IBD11120
       TXI     *+1,4,12                                                 IBD11130
       TXL     *+4,4,36                                                 IBD11140
       SLW     PRNBUF+16,1                                              IBD11150
       AXT     12,4                                                     IBD11160
       TXI     *+1,1,-1                                                 IBD11170
       TXI     *+1,1,-2                                                 IBD11180
       ALS     12                                                       IBD11190
       ORA     2BLKS                                                    IBD11200
       TIX     STXR,2,2                                                 IBD11210
       SLW     PRNBUF+14                                                IBD11220
       ZET     JSWT                                                     IBD11230
       TRA     JRTRN                                                    IBD11240
       NZT     NOTNM                                                    IBD11250
       TSX     CLRBUF,4       CLEAR OUTBUF                              IBD11260
       ZET     NFORM                                                    IBD11270
       TRA     NOTNML                                                   IBD11280
       AXT     20,4                                                     IBD11290
       CAL     ALSME+26,4                                               IBD11300
       SLW     OUTBUF+21,4                                              IBD11310
       TIX     *-2,4,1                                                  IBD11320
       TRA     LLNE                                                     IBD11330
NOTNML ZET     NOTNM                                                    IBD11340
       TRA     MOVMES                                                   IBD11350
       AXT     3,4            MOVE WORDS FROM PRNBUF TO OUTBUF          IBD11360
       CAL     ALSME+9,4                                                IBD11370
       SLW     OUTBUF+13,4                                              IBD11380
       TIX     *-2,4,1                                                  IBD11390
       TRA     MOVMES+4                                                 IBD11400
MOVMES AXT     9,4                                                      IBD11410
       CAL     ALSME+9,4                                                IBD11420
       SLW     OUTBUF+13,4                                              IBD11430
       TIX     *-2,4,1                                                  IBD11440
       LDQ     BLANK                                                    IBD11450
       ARS     24                                                       IBD11460
       LGL     24                                                       IBD11470
       SLW     OUTBUF+12                                                IBD11480
LLNE   TSX     PRINT,4                                                  IBD11490
       ZET     TWOLIN         IF ZERO THE CONTENTS OF THE BUFFER        IBD11500
       TRA     FIN               ARE TO BE EDITED A SECOND              IBD11510
       STL     TWOLIN            TIME IN A DIFFERENT FORMAT             IBD11520
       STZ     SQEDT                                                    IBD11530
       STZ     NOTNM                                                    IBD11540
       TRA     SECND                                                    IBD11550
FIN    STL     NOTNM                                                    IBD11560
       LXA     RELLOW,1                                                 IBD11570
       CLA     UNDONE                                                   IBD11580
       STZ     UNDONE                                                   IBD11590
       TNZ     ENTRYB                                                   IBD11600
       NZT     ENDJB                                                    IBD11610
       TRA     C1P            RETURN TO EDIT NEXT LINE                  IBD11620
       TRA     SNKOFF                                                   IBD11630
NTBCD  MON                                                              IBD11640
NFORM  PZE                                                              IBD11650
NOTNM  MON                                                              IBD11660
TWOLIN MON                                                              IBD11670
CLRBUF AXT     21,1           BLANK BUFFER FOR PRINT LINE               IBD11680
       CLA     BLANK                                                    IBD11690
       STO     OUTBUF+21,1                                              IBD11700
       TIX     *-1,1,1                                                  IBD11710
       TRA     1,4                                                      IBD11720
UNDONE PZE                                                              IBD11730
LOWPRM PZE                                                              IBD11740
UPPRM  PZE     0                                                        IBD11750
 EIGHT DEC     8                                                        IBD11760
FIRST  PZE                                                              IBD11770
 2BLKS OCT     6060                                                     IBD11780
 ENDJB PZE                                                              IBD11790
TOFROM PZE                                                              IBD11800
 GET   OCT     000000200000                                             IBD11810
TWENTY OCT     20                                                       IBD11820
SVNTY7 OCT     77                                                       IBD11830
       EJECT                                                            IBD11840
PRNOUT ZAC                                                              IBD11850
       LDQ     OUTBUF                                                   IBD11860
       LGL     6                                                        IBD11870
       LDQ     PRNCON                                                   IBD11880
       CAS     ONECON                                                   IBD11890
       LGL     8                                                        IBD11900
       TRA     *+2                                                      IBD11910
       XCA                                                              IBD11920
       STQ     G1OUT-3                                                  IBD11930
       LDQ     OUTBUF                                                   IBD11940
       LGL     6                                                        IBD11950
       CLA     BLANK                                                    IBD11960
       LGR     6                                                        IBD11970
       STQ     OUTBUF                                                   IBD11980
       TSX     PROUT,4                                               $6$IBD11990
       PZE     3                                                        IBD12000
       PZE     0,,**                                                    IBD12010
       PZE     OUTBUF,,12+512*9                                         IBD12020
       PZE     OUTBUF+12,,8                                             IBD12030
G1OUT  AXT     **,1                                                     IBD12040
G2OUT  AXT     **,2                                                     IBD12050
G4OUT  AXT     **,4                                                     IBD12060
       TRA     1,4                                                      IBD12070
PRNCON OCT     001000000000                                             IBD12080
 PRINT SXA     G1OUT,1                                                  IBD12090
       SXA     G2OUT,2                                                  IBD12100
       SXA     G4OUT,4                                                  IBD12110
LNCT2  AXT     58,2                                                     IBD12120
       TXI     *+1,2,DBLSPC+1                                           IBD12130
       NZT     TWOLIN                                                   IBD12140
       TRA     SET                IF NOT, IT IS FIRST LINE OF TWO       IBD12150
       ZET     LATCH                                                    IBD12160
       TRA     SET+1                                                    IBD12170
       STL     LATCH                                                    IBD12180
       TXI     BUFTST,2,-DBLSPC                                         IBD12190
 SET   STZ     LATCH              FIRST LINE OF TWO                     IBD12200
       CAL     SIXTY+DBLSPC                                             IBD12210
       LDQ     OUTBUF                                                   IBD12220
       RQL     6                                                        IBD12230
       TXL     *+4,2,57                                                 IBD12240
       ZAC                                                              IBD12250
       ADD     ONE                                                      IBD12260
       AXT     1,2                                                      IBD12270
       LGL     30                                                       IBD12280
       SLW     OUTBUF                                                   IBD12290
BUFTST SXA     LNCT2,2                                                  IBD12300
PRNTST ZET     TAP729                                                   IBD12310
       TRA     TAPOUT                                                   IBD12320
       TRA     PRNOUT                                                   IBD12330
TAPOUT AXT     20,2                                                     IBD12340
BUFCNT AXT     100,1                                                    IBD12350
       CAL     OUTBUF+20,2                                              IBD12360
STLSWD SLW     TAPBUF+100,1                                             IBD12370
       TXI     *+1,1,-1                                                 IBD12380
       TIX     *-3,2,1                                                  IBD12390
       SXA     BUFCNT,1                                                 IBD12400
       ADD     TEN                                                      IBD12410
       TXL     WRTP,1,0                                                 IBD12420
       TXI     *+1,1,1                                                  IBD12430
       XEC     STLSWD                                                   IBD12440
       ZET     ENDJB                                                    IBD12450
       NZT     TWOLIN                                                   IBD12460
       TRA     CHKPRN                                                   IBD12470
       SUB     TEN                                                      IBD12480
       XEC     STLSWD                                                   IBD12490
 WRTP  LAC     BUFCNT,2                                                 IBD12500
       TXI     *+1,2,100                                                IBD12510
       PXD     0,2                                                      IBD12520
       AXT     100,2                                                    IBD12530
       SXA     BUFCNT,2                                                 IBD12540
FLPBUF AXT     6,2                                                      IBD12550
       TIX     *+2,2,6                                                  IBD12560
       TXI     *+1,2,6                                                  IBD12570
       SXA     FLPBUF,2                                                 IBD12580
       STD     TPOUT+12,2                                               IBD12590
       STD     TPOUT+16,2                                               IBD12600
       CLA     ENDBUF+12,2                                              IBD12610
       STA     STLSWD                                                   IBD12620
       CLA     TPADD+12,2                                               IBD12630
       STA     SELECT+1                                                 IBD12640
WTDO   NZT     XIOXIN                                                   IBD12650
       TRA     *-1                                                      IBD12660
       LDI     XIOXIN                                                   IBD12670
TSTEND ZET     HYPOUT                                                   IBD12680
       TRA     *+4                                                      IBD12690
       LFT     200000                                                   IBD12700
       TRA     ENDTAP                                                   IBD12710
       TRA     SELECT                                                   IBD12720
       RFT     000004                                                   IBD12730
       TRA     ENDTAP                                                   IBD12740
SELECT TSX     TPIOEX,4                                                 IBD12750
       PZE     **                                                       IBD12760
CHKPRN ZET     PRNTSW                                                   IBD12770
       TRA     PRNOUT                                                   IBD12780
       TRA     G1OUT                                                    IBD12790
TPOUT  IORT    TAPBUF,,100                                              IBD12800
SMSOU  SMS     **                                                       IBD12810
       LIPT    *+1                                                      IBD12820
       CTLW    HORDW                                                    IBD12830
       CPYD    TAPBUF,,100                                              IBD12840
       TCH     SYSTWT                                                   IBD12850
       IORT    ALTBUF,,100                                              IBD12860
       SMS*    SMSOU                                                    IBD12870
       LIPT    *+1                                                      IBD12880
       CTLW    HORDW                                                    IBD12890
       CPYD    ALTBUF,,100                                              IBD12900
       TCH     SYSTWT                                                   IBD12910
       EJECT                                                            IBD12920
WRTTRL SXA     WTRLRT,4                                                 IBD12950
       LAC     UCBOUA,4                                                 IBD12960
       CAL     2,4                                                      IBD12970
       SLW     RCCT                                                     IBD12980
       TSX     NDATA,4,7                                                IBD12990
       TSX     TPIOEX,4                                                 IBD13000
       PZE     LBLWRT                                                   IBD13010
       TSX     NDATA,4,7                                                IBD13020
       AXT     3,2                                                      IBD13030
       TSX     NDATA,4,5                                                IBD13040
       TIX     *-1,2,1                                                  IBD13050
       LAC     UCBOUA,4                                                 IBD13060
       CAL     RCCT                                                     IBD13070
       SLW     2,4                                                      IBD13080
WTRLRT AXT     **,4                                                     IBD13090
       TRA     1,4                                                      IBD13100
NDATA  SXA     WEFS,4                                                   IBD13110
       CLA     0,4                                                      IBD13120
       ANA     MSKX                                                     IBD13130
       STD     WEFS-2                                                   IBD13140
       NZT     HYPOUT                                                   IBD13150
       TRA     TPWT                                                     IBD13160
       LXD     HBSR,4                                                   IBD13170
       SUB     FIVDC                                                    IBD13180
       TZE     *+2                                                      IBD13190
       TXI     *+1,4,-1                                                 IBD13200
       SXD     WEFS-2,4                                                 IBD13210
TPWT   LAC     UCBOUA,4                                                 IBD13220
       ZET     1,4                                                      IBD13230
       TRA     *-1                                                      IBD13240
       TSX     .NDSEL,4                                              $6$IBD13250
       PZE     UCBOUA,,**                                               IBD13260
       NOP                                                              IBD13270
WEFS   AXT     **,4                                                     IBD13280
       TRA     1,4                                                      IBD13290
MSKX   OCT     000077000000                                             IBD13300
LBLWRT IORT    LABEL,,20                                                IBD13310
       SMS*    SMSOU                                                    IBD13320
       LIPT    *+1                                                      IBD13330
       CTLW    HORDW                                                    IBD13340
       CPYD    LABEL,,20                                                IBD13350
       TCH     SYSTWT                                                   IBD13360
FIVDC  PZE     ,,5                                                      IBD13370
HYPOUT PZE                                                              IBD13380
HORDW  PZE                                                              IBD13390
HERR   LFT     000010                                                   IBD13400
 RCCT  PZE                                                              IBD13410
       EJECT                                                            IBD13420
ENDTAP CLA     L1EOR                                                    IBD13430
       STO     LABEL                                                    IBD13440
       TSX     WRTTRL,4                                                 IBD13450
       TSX     PROUT,4                                               $6$IBD13460
       PZE     1                                                        IBD13470
       PZE     MSSG11,,4+512*4                                          IBD13480
       TSX     .PAUSE,4                                              $6$IBD13490
       LDI*    UCBOUA                                                   IBD13500
       RIR     400000                                                   IBD13510
       STI*    UCBOUA                                                   IBD13520
       TRA     SELECT                                                   IBD13530
MSSG11 BCI     4,      OUTPUT END OF REEL                               IBD13540
       EJECT                                                            IBD13550
TPSPAC SXA     SVXR4,4                                                  IBD13560
       SXA     SVXR2,2                                                  IBD13570
       SXA     SVXR1,1                                                  IBD13580
       LXA     POSCNT,1                                                 IBD13590
       CLA     0,4                                                      IBD13600
       PDX     ,4                                                       IBD13610
       TXL     WRITUP,4,3840                                            IBD13620
       TXL     READUP,4,3841                                            IBD13630
       CLA     POSCNT       READ LEWER AREA-CHECK POSITION OF           IBD13640
       CAS     TWO          SCRATCH TAPE                                IBD13650
       TRA     *+3          BACKSPACE TWO RECORDS                       IBD13660
       TRA     BSPCE        BACKSPACE ONE RECORD                        IBD13670
       TRA     BSPCE+2      LEAVE SCRATCH TAPE AS IS                    IBD13680
       TSX     NDATAX,2                                                 IBD13690
       TXI     *+1,1,-1     DECREMENT POSITION COUNTER                  IBD13700
BSPCE  TSX     NDATAX,2                                                 IBD13710
       TXI     *+1,1,-1     DECREMENT POSITION COUNTER                  IBD13720
       STZ     WRITSW       RESET WRITE SWITCH                          IBD13730
       TRA     UCBSET       OCTIVATE UNIT                               IBD13740
WRITUP STL     WRITSW       SET WRITE SWITCH                            IBD13750
       TRA     READUP+1                                                 IBD13760
READUP STZ     WRITSW       RESET WRITE SWITCH                          IBD13770
       CLA     POSCNT       CHECK POSITION                              IBD13780
       CAS     TWO          OF SCRATCH TAPE                             IBD13790
       TRA     *+3          BACKSPACE ONE RECORD                        IBD13800
       TRA     UCBSET       LEAVE TAPE AS IS                            IBD13810
       TRA     UCBSET                                                   IBD13820
       TSX     NDATAX,2                                                 IBD13830
       TXI     UCBSET,1,-1  DECREMENT POSITION COUNTER                  IBD13840
UCBSET SXA     POSCNT,1                                                 IBD13850
       CLA     PFX20        SET CTL FOR                                 IBD13860
       ZET     WRITSW       READ OR WRITE                               IBD13870
       CLA     PFX24                                                    IBD13880
       STD     SMS+1                                                    IBD13890
       STT     SMS+1                                                    IBD13900
       LAC     UCBSCR,1                                                 IBD13910
       ZET     1,1                                                      IBD13920
       TRA     *-1                                                      IBD13930
       CLA     XIOXST                                                   IBD13940
       ZET     WRITSW                                                   IBD13950
       SSM                                                              IBD13960
       STO     1,1                                                      IBD13970
       STZ     XIOXSC                                                   IBD13980
 GOACT TSX     .ACTV,4                                               $6$IBD13990
       PZE     UCBSCR                                                   IBD14000
       NZT     XIOXSC                                                   IBD14010
       TRA     *-1                                                      IBD14020
       CLA     POSCNT       INCREMENT                                   IBD14030
       ADD     ONE          POSITION                                    IBD14040
       STO     POSCNT       COUNTER                                     IBD14050
SVXR4  AXT     **,4                                                     IBD14060
SVXR2  AXT     **,2                                                     IBD14070
SVXR1  AXT     **,1                                                     IBD14080
       TRA     1,4                                                      IBD14090
SCRSEL SXA     XSVE4,4                                                  IBD14100
       TMI     MSSEL        MINUS SELECT PASS                           IBD14110
       CLA     XIOXST                                                   IBD14120
       STA*    .RCHX               PAST I/O SEQUENCE                 $6$IBD14130
       LXA     WRITSW,4                                                 IBD14140
       ZET     HYPSWT                                                   IBD14150
       TRA     729SRS+1                                                 IBD14160
       TXH     729SWS,4,0                                               IBD14170
729SRS RDS     **           READ SELECT                                 IBD14180
       XEC*    .RCHX               STORE I/O COMMAND ADDRESS         $6$IBD14190
XSVE4  AXT     **,4                                                     IBD14200
       TRA     1,4                                                      IBD14210
729SWS WRS     **           WRITE SELECT                                IBD14220
       TRA     XSVE4-1                                                  IBD14230
MSSEL  STO     SVEAC                                                    IBD14240
       LFT     100000                                                   IBD14250
       TRA     CHKWRT                                                   IBD14260
       LFT     000100              INTERFACE CHECK                      IBD14270
       TRA     1,4                 RETRY SELECT LUS                     IBD14280
LDCOMP LAC     SVEAC,4       XR4 = -(LUCB)                              IBD14290
       STZ     1,4           CLEAR UCB 2                                IBD14300
       STI     XIOXSC        SET POSTING WORD AND                       IBD14310
       CLA     XSVE4                                                    IBD14320
       STT     XIOXSC        RESET BUSY SWITCH                          IBD14330
       TRA     XSVE4                                                    IBD14340
CHKWRT ZET     WRITSW        SPILL TAPE ERROR FOUND                     IBD14350
       TRA     3,4           RETURN TO IOEX IF WRITE ERROR              IBD14360
       TSX     PROUT,4             OTHERWISE PRINT MESSAGE TO NOTIFY $6$IBD14370
       PZE     1             OPERATOR OF SPILL TAPE READ ERROR          IBD14380
       PZE     ERRMSG,,5+512*4                                          IBD14390
       TRA     LDCOMP        AND KEEP SYSTEM MOVING                     IBD14400
SVEAC  PZE                                                              IBD14410
NDATAX SXA     SVE1,1                                                   IBD14420
       LAC     UCBSCR,1                                                 IBD14430
       ZET     1,1                                                      IBD14440
       TRA     *-1                                                      IBD14450
       TSX     .NDSEL,4                                              $6$IBD14460
       PZE     UCBSCR,,5                                                IBD14470
       NOP                                                              IBD14480
SVE1   AXT     **,1                                                     IBD14490
       TRA     1,2                                                      IBD14500
TPADD  PZE     TPOUT                                                    IBD14510
HORDH  OCT     120600120100     SELECT BLANK MASK                       IBD14520
UNMSK  OCT     777760777777                                             IBD14530
HORDT                          SELECT ORDER                             IBD14540
WRITSW PZE                                                              IBD14550
HBSR   PZE     ,,34                                                     IBD14560
       PZE     TPOUT+6                                                  IBD14570
HYPSWT PZE                                                              IBD14580
PFX20  OCT     200000200000                                             IBD14590
PFX24  OCT     240000000000                                             IBD14600
XIOXST PZE     SCRCOM,,SCRSEL  SELECT WORD                              IBD14610
XIOXSC                         POSTING WORD                             IBD14620
POSCNT PZE     2                                                        IBD14630
SCRCOM IORT    ENDDMP,,ENDDMP                                           IBD14640
       LIPT    *+1                                                      IBD14650
SMS    SMS     6                                                        IBD14660
       CTL     HORDT                                                    IBD14670
       CPYD    ENDDMP,,ENDDMP                                           IBD14680
       TCH     SYSTWT                                                   IBD14690
LABEL  BCI ,1EOF  END OF OUTPUT TAPE                                    IBD14700
       BCI ,                                                            IBD14710
TABLE  VFD     O12/0,H18/HTR,O18/600020,H18/TRA,O18/600021,H18/TTR,     IBD14720
       ETC     O18/600022,H24/TRCA,O12/24,H24/TRCC,O12/26,H24/TRCE,     IBD14730
       ETC     O12/27,H24/TRCG,O12/30,H24/TEFA,O12/31,H24/TEFC,O12/32,  IBD14740
       ETC     H24/TEFE,O12/33,H24/TEFG,O12/40,H18/TLQ,O18/600041,      IBD14750
       ETC     H18/IIA,O18/100042,H18/TIO,O6/60                      $6$IBD14760
       VFD     O12/0043,H18/OAI,O18/100044,                          $6$IBD14765
       ETC     H18/PAI,O18/100046,H18/TIF,O18/600051,H18/IIR,O18/600054,IBD14770
       ETC     H18/RFT,O18/110055,H18/SIR,O18/110056,H18/RNT,O18/110057,IBD14780
       ETC     H18/RIR,O18/110060,H24/TCOA,O12/61,H24/TCOB,O12/62,      IBD14790
       ETC     H24/TCOC,O12/63,H24/TCOD                              $6$IBD14800
       VFD     O12/64,H24/TCOE,O12/65,H24/TCOF,                      $6$IBD14805
       ETC     O12/66,H24/TCOG,O12/67,H24/TCOH,O12/74,H24/TSX8,O12/100, IBD14810
       ETC     H18/TZE,O18/600114,H18/CVR,O18/110120,H18/TPL,O18/600131,IBD14820
       ETC     H18/XCA,O18/100140,H18/TOV,O18/600161,H18/TQO,O18/600162,IBD14830
       ETC     H18/TQP,O18/600200,H18/MPY,O6/60                      $6$IBD14840
       VFD     O12/0204,H18/VLM,O18/110220,                          $6$IBD14845
       ETC     H18/DVH,O18/600221,H18/DVP,O18/600224,H18/VDH,O18/110225,IBD14850
       ETC     H18/VDP,O18/110240,H18/FDH,O18/600241,H18/FDP,O18/600260,IBD14860
       ETC     H18/FMP,O18/600261,H24/DFMP,O12/0300,H18/FAD,O18/600301, IBD14870
       ETC     H24/DFAD,O12/0302,H18/FSB,O6/60                       $6$IBD14880
       VFD     O12/0303,H24/DFSB,O12/0304,                           $6$IBD14885
       ETC     H18/FAM,O18/600305,H24/DFAM,O12/0306,H18/FSM,O18/600307, IBD14890
       ETC     H24/DFSM,O12/0320,H18/ANS,O18/600322,H18/ERA,O18/600340, IBD14900
       ETC     H18/CAS,O18/600361,H18/ACL,O18/600400,H18/ADD,O18/600401,IBD14910
       ETC     H18/ADM,O18/600402,H18/SUB,O18/600420,H18/HPR,O6/11   $6$IBD14920
       VFD     O12/0440,H18/IIS,O18/600441,H18/LDI,O18/600442,       $6$IBD14925
       ETC     H18/OSI,O18/600443,H18/DLD,O18/600444,                $6$IBD14930
       ETC     H18/OFT,O18/600445,H18/RIS,O18/600446,H18/ONT,O18/600500,IBD14940
       ETC     H18/CLA,O18/600502,H18/CLS,O18/600520,H18/ZET,O18/600522,IBD14950
       ETC     H18/XEC,O18/600534,H18/LXA,O6/10                      $6$IBD14960
       VFD     O12/0535,H18/LAC,O18/100540,                          $6$IBD14965
       ETC     H24/RCHA,O12/0541,H24/RCHC,O12/0542,H24/RCHE,O12/0543,   IBD14970
       ETC     H24/RCHG,O12/0544,H24/LCHA,O12/0545,H24/LCHC,O12/0546,   IBD14980
       ETC     H24/LCHE,O12/0547,H24/LCHG,O12/0560,H18/LDQ,O18/600564,  IBD14990
       ETC     H18/ENB,O18/600600,H18/STZ,O6/60                      $6$IBD15000
       VFD     O12/0601,H18/STO,O18/600602,                          $6$IBD15005
       ETC     H18/SLW,O18/600604,H18/STI,O18/600621,H18/STA,O18/600622,IBD15010
       ETC     H18/STD,O18/600625,H18/STT,O18/600630,H18/STP,O18/600634,IBD15020
       ETC     H18/SXA,O18/100636,H18/SCA,O18/100640,H24/SCHA,O12/641,  IBD15030
       ETC     H24/SCHC,O12/642,H24/SCHE                             $6$IBD15040
       VFD     O12/643,H24/SCHG,O12/734,                             $6$IBD15045
       ETC     H18/PAX,O18/100737,H18/PAC,O18/100754,H18/PXA,O18/100756,IBD15050
       ETC     H18/PCA,O18/100760,H24/PSE=,O12/761,H18/NOP,O18/100762,  IBD15060
       ETC     H18/RDS,O18/170763,H24/LLS8,O12/764,H18/BSR,O6/17,       IBD15070
       ETC     O12/765,H24/LRS8,O12/766,H18/WRS,O6/17                $6$IBD15080
       VFD     O12/767,H24/ALS8,                                     $6$IBD15085
       ETC     O12/770,H18/WEF,O6/17,O12/771,H24/ARS8,O12/772,H18/REW,  IBD15090
       ETC     O6/17,O12/774,H24/AXT8,O12/776,H18/SDN,O6/17,O12/4021,   IBD15100
       ETC     H24/ESNT,O12/4022,H24/TRCB,O12/4024,H24/TRCD,O12/4026,   IBD15110
       ETC     H24/TRCF,O12/4027,H24/TRCH                            $6$IBD15120
       VFD     O12/4030,H24/TEFB,O12/4031,H24/TEFD,                  $6$IBD15130
       ETC     O12/4032,H24/TEFF,O12/4033,H24/TEFH,O12/4042,H18/RIA,    IBD15140
       ETC     O18/104046,H18/PIA,O18/104051,H18/IIL,O18/104054,H18/LFT,IBD15150
       ETC     O18/114055,H18/SIL,O18/114056,H18/LNT,O18/114057,H18/RIL,IBD15160
       ETC     O18/114060,H24/TCNA,O12/4061,H24/TCNB                 $6$IBD15170
       VFD     O12/4062,H24/TCNC,                                    $6$IBD15175
       ETC     O12/4063,H24/TCND,O12/4064,H24/TCNE,O12/4065,H24/TCNF,   IBD15180
       ETC     O12/4066,H24/TCNG,O12/4067,H24/TCNH,O12/4100,H18/TNZ,    IBD15190
       ETC     O18/604114,H18/CAQ,O18/114120,H18/TMI,O18/604130,H18/XCL,IBD15200
       ETC     O18/104140,H18/TNO,O18/604154,H18/CRQ,O6/11           $6$IBD15210
       VFD     O12/4200,H18/MPR,                                     $6$IBD15215
       ETC     O18/604240,H24/DFDH,O12/4241,H24/DFDP,O12/4260,H18/UFM,  IBD15220
       ETC     O18/604261,H24/DUFM,O12/4300,H18/UFA,O18/604301,H24/DUFA,IBD15230
       ETC     O12/4303,H24/DUFS,O12/4304,H18/UAM,O18/604305,H24/DUAM,  IBD15240
       ETC     O12/4306,H18/USM,O18/604307,H24/DUSM                  $6$IBD15250
       VFD     O12/4320,H18/ANA,                                     $6$IBD15255
       ETC     O18/604340,H18/LAS,O18/604400,H18/SBM,O18/604500,H18/CAL,IBD15260
       ETC     O18/604501,H18/ORA,O18/604520,H18/NZT,O18/604534,        IBD15270
       ETC     H24/LXD8,O12/4535,H24/LDC8,O12/4540,H24/RCHB,O12/4541,   IBD15280
       ETC     H24/RCHD,O12/4542,H24/RCHF                            $6$IBD15290
       VFD     O12/4543,H24/RCHH,O12/4544,                           $6$IBD15295
       ETC     H24/LCHB,O12/4545,H24/LCHD,O12/4546,H24/LCHF,O12/4547,   IBD15300
       ETC     H24/LCHH,O12/4600,H18/STQ,O18/604602,H18/ORS,O18/604603, IBD15310
       ETC     H18/DST,O18/604620,H18/SLQ,O18/604625,H18/STL,O18/604634,IBD15320
       ETC     H24/SXD8,O12/4636,H18/SCD,O6/10                       $6$IBD15330
       VFD     O12/4640,H24/SCHB,O12/4641,                           $6$IBD15335
       ETC     H24/SCHD,O12/4642,H24/SCHF,O12/4643,H24/SCHH,O12/4734,   IBD15340
       ETC     H24/PDX8,O12/4737,H24/PDC8,O12/4754,H24/PXD8,O12/4756,   IBD15350
       ETC     H18/PCD,O18/104760,H18/MSE,O6/12,O12/4763,               IBD15360
       ETC     H24/LGL8,O12/4764,H18/BSF,O6/17                       $6$IBD15370
       VFD     O12/4765,H24/LGR8,O12/4772,                           $6$IBD15375
       ETC     H18/RUN,O6/17,O12/4773,H24/RQL8,O12/4774,H18/AXC,O6/10,  IBD15380
       ETC     O12/5000,H24/STR9                                        IBD15390
3BLKS  OCT     606060                                                   IBD15400
2NDSWT PZE                                                              IBD15410
ZROSVN OCT     077777077777                                             IBD15420
ONEONE OCT     000001000001                                             IBD15430
       OCT     ,,,,,,,                                                  IBD15440
SET8   OCT     ,,,,,,,                                                  IBD15450
JSWT   PZE                                                              IBD15460
NINSWT PZE                                                              IBD15470
 PANEL BCI     9,       AC            MQ        SENSE IND        KEYS   IBD15480
       BCI     9,        XR1      XR2      XR3     XR4       XR5      X IBD15490
       BCI     2,R6      XR7                                            IBD15500
       BCI ,                                                            IBD15510
       BCI ,                                                            IBD15520
       BCI     9,                                                       IBD15530
       BCI     1,     -                                                 IBD15540
       BCI ,                                                            IBD15550
       BCI     9,            INDICATORS                          SENSE  IBD15560
       BCI     9,LIGHTS                           SENSE SWITCHES        IBD15570
       BCI     2,                                                       IBD15580
       BCI     9, Q-BIT P-BIT  TRAP   DCT   IOT   OFL           1     2 IBD15590
       BCI     9,     3     4                 1     2     3     4     5 IBD15600
       BCI     2,     6                                                 IBD15610
       BCI ,                                                            IBD15620
       BCI ,                                                            IBD15630
ON     BCI     1,    ON                                                 IBD15640
OFF    BCI     1,   OFF                                                 IBD15650
BLANK0 BCI     1, 00000                                                 IBD15660
TPIOEX SXA     XTPXR4,4          SAVE IR4                               IBD15670
       CAL     1,4               GET FIRST CALL WORD                    IBD15680
       LAC     UCBOUA,4      XR4=-L(UCB)                                IBD15690
       STA     XIOXSL            STORE IN SELECT WORD                   IBD15700
       CLA     XIOXSL            GET SELECT WORD                        IBD15710
       ZET     1,4               IS UNIT FREE                           IBD15720
       TRA     *-1               NO                                     IBD15730
       STO     1,4               STORE INTO UCB2                        IBD15740
       STZ     XIOXIN            RESET POSTING WORD                     IBD15750
       TSX     .ACTV,4             GO ACTIVATE                       $6$IBD15760
XIOXND PZE     UCBOUA                                                   IBD15770
XTPXR4 AXT     **,4              RESTORE XR4                            IBD15780
       TRA     2,4               RETURN                                 IBD15790
XIOXSL MZE     0,,XTPSEL     SELECT WORD TO UCB2                        IBD15800
XIOXIN PZE     ,1,           POSTING WORD                               IBD15810
* SELECT ROUTINE FOR TAPES                                              IBD15820
XTPSEL SXA     XXSAV4,4          SAVE XR4                               IBD15830
       TMI     TPSELM            SEL(-) FOR POSTING                     IBD15840
       CLA     XIOXSL                                                   IBD15850
       STA*    .RCHX                                                 $6$IBD15860
       NZT     HYPOUT                                                   IBD15870
OUTSLW WRS     **                                                       IBD15880
       XEC*    .RCHX               INITIATE I/O                      $6$IBD15890
XXSAV4 AXT     **,4              RESTORE XR4                            IBD15900
       TRA     1,4               RETURN                                 IBD15910
TPSELM NZT     HYPOUT                                                   IBD15920
       LNT     100000                                                   IBD15930
       LFT     000010                                                   IBD15940
       TRA     3,4                                                      IBD15950
       LFT     000100              INTERFACE CHECK                      IBD15960
       TRA     1,4                 RETRY SELECT PLUS                    IBD15970
       PAC     0,4                                                      IBD15980
       STZ     1,4               SET UCB2=0                             IBD15990
       STI     XIOXIN                                                   IBD16000
       CLA     XXSAV4                                                   IBD16010
       STT     XIOXIN                                                   IBD16020
       TRA     XXSAV4            GO EXIT                                IBD16030
SNKOFF TCOA    *                                                        IBD16040
       TCOB    *                                                        IBD16050
       TCOC    *                                                        IBD16060
       TCOD    *                                                        IBD16070
       TCOE    *                                                        IBD16080
       ZET     TAP729                                                   IBD16090
       TSX     WRTTRL,4      WRITE TRAILER IF TAPE OUTPUT               IBD16100
       ZET     SWSTWO                                                   IBD16110
       TSX     TPSPAC,4,1    READ UPPER AREA BACK IF NECESSAERY         IBD16120
       CLA     SKIOEX                                                   IBD16130
       STO     GOACT-2                                                  IBD16140
       TSX     TPSPAC,4,2    POSITION TAPE TO FIRST SPILL RECORD        IBD16150
       CAL     NXTJB                                                    IBD16160
       SLW     SYSGET                                                   IBD16170
       CAL     L(1)D                                                    IBD16180
       ORS     SYSJOB                                                   IBD16190
       NZT     SNAP                                                     IBD16200
       TRA     TSTSW4              TEST SENSE SW. 4                  (9)IBD16210
RESTOR CLA     TRIGS                                                 (9)IBD16220
       DVP     *                                                        IBD16230
       RCHA    **                                                       IBD16240
       ALS     21                                                       IBD16250
       STL     TMIND                                                    IBD16260
       PBT                                                              IBD16270
       STZ     TMIND                                                    IBD16280
       ALS     1                                                        IBD16290
       PBT                                                              IBD16300
       DCT                                                              IBD16310
       ALS     1                                                        IBD16320
       PBT                                                              IBD16330
       IOT                                                              IBD16340
       ALS     1                                                        IBD16350
       STZ     0                                                        IBD16360
       ENB     0                                                        IBD16370
       PBT                                                              IBD16380
       STL     0                                                        IBD16390
       ARS     31                                                       IBD16400
       AXT     0,1                                                      IBD16410
       SLN     4,1                                                      IBD16420
       LBT                                                              IBD16430
       SLT     4,1                                                      IBD16440
       NOP                                                              IBD16450
       TXI     *+1,1,1                                                  IBD16460
       ARS     1                                                        IBD16470
       TXL     *-6,1,3                                                  IBD16480
       LDC     SVPNL1,4                                                 IBD16490
       ZET     NINSWT                                                   IBD16500
       TRA     *+6                                                      IBD16510
       LDC     SVPNL1,3                                                 IBD16520
       LAC     SVPNL1,4                                                 IBD16530
       LDC     SVPNL2,5                                                 IBD16540
       LAC     SVPNL2,6                                                 IBD16550
       LDC     SVPNL3,7                                                 IBD16560
       LDI     HSI                                                      IBD16570
       CLA     HORDT                                                    IBD16580
       STO     HYPORD                                                   IBD16590
       CLA     729SRS                                                   IBD16600
       STA     RDBK                                                     IBD16610
       STA     REPOS                                                    IBD16620
       ARS     9                                                        IBD16630
       ANA     CHNLI                                                    IBD16640
       LBT                                                              IBD16650
       ORA     CHNLII                                                   IBD16660
       STP     LDCHNL                                                   IBD16670
       AXT     22528,2                                                  IBD16680
       PAX     0,1                                                      IBD16690
       TNX     *+2,1,2                                                  IBD16700
       TXI     *-1,2,64                                                 IBD16710
       SXD     LDCHNL,2                                                 IBD16720
       ALS     6                                                        IBD16730
       PAX     0,1                                                      IBD16740
       TXI     *+1,1,3008                                               IBD16750
       SXD     WAIT,1                                                   IBD16760
       ALS     3                                                        IBD16770
       ADD     TNOFRD                                                   IBD16780
       NZT     HYPSWT                                                   IBD16790
       ADD     TWO                                                      IBD16800
       STA     TNOFRD                                                   IBD16810
       CLA     NOP                                                      IBD16820
       NZT     HYPSWT                                                   IBD16830
       TRA     INHIB                                                    IBD16840
       STD     RDBK           NOP SELECTS FOR                           IBD16850
       STD     REPOS         7340 SPILL TAPE                            IBD16860
       CAL     SMS                                                      IBD16870
       ACL     LIST+7        INHIBIT UNUSUAL END                        IBD16880
       SLW     CHNLII        SIGNALS FOR SNEAK-OFF                      IBD16890
       LDQ     LDCHNL                                                   IBD16900
       SLQ     INHIB                                                    IBD16910
INHIB  NOP     CHNLII                                                   IBD16920
       AXT     19,1                                                     IBD16930
       CLA     NOP+19,1                                                 IBD16940
       STO     SYSEND+1,1          RESPECT SYSEND                       IBD16950
       TIX     *-2,1,1                                                  IBD16960
       CAL     HQP                                                      IBD16970
       LDQ     HAC                                                      IBD16980
       LLS     35                                                       IBD16990
       LDQ     HMQ                                                      IBD17000
       ZET     0                                                        IBD17010
       TOV     *+1           RESTORE OFL INDICATOR                      IBD17020
       LDC     SVPNL0,1                                                 IBD17030
       LAC     SVPNL0,2      RESTORE XR1 AND XRA2                       IBD17040
       TXI     TSTSNP,4,-1                                           (9)IBD17050
       SXA     SYSEND-2,4                                               IBD17060
       STQ     SYSEND-18                                                IBD17070
       LAC     UCBOUA,4      HOLD OUTPATE RECORD COUNT                  IBD17080
       LDQ     2,4                                                      IBD17090
       TRA     SYSEND-11           READ BACK RECORD ONE                 IBD17100
CHNLI  FOR     15                                                       IBD17110
CHNLII FOR     **                                                       IBD17120
NOP    NOP     *                                                        IBD17130
HYPBCK OCT     030412010000                                             IBD17140
HYPORD PZE                                                              IBD17150
CMNDS  IORT    0,,ENDDMP     LAR FOR 7909 CNNL                          IBD17160
       CTLR    SYSEND-16                                                IBD17170
       CPYD    0,,ENDDMP                                                IBD17180
       CTL     SYSEND-17                                                IBD17190
RDBK   RDS     **                                                       IBD17200
LDCHNL PZE     SYSEND-15                                                IBD17210
WAIT   PZE     SYSEND-9                                                 IBD17220
TNOFRD PSE     232                                                      IBD17230
REPOS  BSR     *-*           REPOSITION 729 SPILL TAPE                  IBD17240
       ZET     SYSEND                                                   IBD17250
       ETM                                                              IBD17260
       STQ     2,4                                                      IBD17270
       LDQ     SYSEND-18                                                IBD17280
       AXT     **,4                                                     IBD17290
       TTR     1,4                                                      IBD17300
TMIND  PZE                                                              IBD17310
       EJECT                                                            IBD17320
ONECON DEC     1                                                        IBD17330
L1EOF  BCI     1,1EOF                                                   IBD17340
L1EOR  BCI     1,1EOR                                                   IBD17350
LBLCMD IORT    OUTBUF,,20                                               IBD17360
       SMS*    SMSOU                                                    IBD17370
       LIPT    *+1                                                      IBD17380
       CTLR    HORDW                                                    IBD17390
       CPYD    OUTBUF,,20                                               IBD17400
       TCH     SYSTWT                                                   IBD17410
COMMA  OCT     73                                                       IBD17420
TEN    DEC     10                                                       IBD17430
ENDFLG PZE                                                              IBD17440
 LATCH MON                                                              IBD17450
TRIGS  PON                                                              IBD17460
CORTP  PZE     0                                                        IBD17470
SKIOEX TRA     SVXR4                                                    IBD17480
NXTJB  BCI     1,IBSXEC                                                 IBD17490
L(1)D  PZE     ,,1                                                      IBD17500
UCBOUA PZE                                                              IBD17510
PRNBUF EQU     J                                                        IBD17520
ALTBUF EQU     TAPBUF+100                                               IBD17530
SAVE   EQU     OUTBUF+8                                                 IBD17540
HOLD   EQU     OUTBUF+7                                                 IBD17550
RDIN   EQU     OUTBUF+1                                                 IBD17560
 LIST  EQU     ONE                                                      IBD17570
TWO    EQU     ONE+1                                                    IBD17580
 THREE EQU     ONE+2                                                    IBD17590
FIVE   EQU     ONE+4                                                    IBD17600
SIX    EQU     ONE+5                                                    IBD17610
TRLR   EQU     LBLWRT                                                   IBD17620
UCBSCR EQU     SYSPP2                                                $6$IBD17630
N      EQU     TRIG+4                                                   IBD17640
ENDDMP EQU     N/8*8+8                                                  IBD17650
NEWLIB EQU     SYSLB1                                                $6$IBD17660
       ENDQ    D                                                     $6$IBD17670
TSTSW4 SWT     KEYSWT              SENSE SW. 4 DOWN                  (9)IBD17671
       TRA     SYSRET              NO-RETURN TO IBSYS                (9)IBD17672
       TRA     RESTOR              YES-NON/SNAP                      (9)IBD17673
TSTSNP ZET     SNAP                SNAP DUMP                         (9)IBD17674
       TRA     CHNLI-5             YES-RETURN                        (9)IBD17675
       TXI     *+1,4,1             NO-SENSE SW4 IS DOWN              (9)IBD17676
       SXA     SYSEND-2,4                                            (9)IBD17677
       STQ     SYSEND-18                                             (9)IBD17678
       LDQ     TTRSYS                                                (9)IBD17679
       STQ     SYSEND-1                                              (9)IBD17680
       TRA     CHNLI-3                                               (9)IBD17681
TTRSYS TTR     SYSDMP                                                (9)IBD17682
       END     *                                                        IBD17690
