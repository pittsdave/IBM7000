$JOB           ASSEMBLE SORT
$EXECUTE       IBSFAP
$ID            SORT
*      FAP
* 7090/94 SORT VER 7 MOD 6 SORT MONITOR AND LOADER                   (6)1SM00000
*   SORT MONITOR AND LOADER                                             1SM00010
       ABS                                                              1SM00020
       SST                                                              1SM00030
       TITLE                                                            1SM00040
       COUNT   1300                                                     1SM00050
       TTL     CALLING SEQUENCES TO LOADER AND MESSAGE PRINTER          1SM00060
       ORG     SYSORG                                                   1SM00070
       BCI     1,SORT                                                   1SM00080
       SPACE                                                            1SM00090
       ORG     SYSTRA                                                   1SM00100
       TRA     SORT                                                     1SM00110
       SPACE                                                            1SM00120
       ORG     SYSORG                                                   1SM00130
SORT   BSS     0                                                        1SM00140
       CAL     SYSTCH        SAVE THE                                   1SM00150
       SLW     ONCE           DISK POSITION                             1SM00160
       LAC     SYSPOS,4      SAVE THE LOCATION OF                       1SM00170
       CLA     SYSLB1-1,4     THE UCB FOR THE                           1SM00180
       STA     SYSLIB         DEVICE WHICH HOLDS THE SYSTEM.            1SM00190
DELETE BSS     0                                                     (2)1SM00200
       LDI     SYSJOB        SHOULD EDIT PHASE BE                       1SM00210
       LNT     1              LOADED...                                 1SM00220
       TRA     GO            YES. LOAD EDIT PHASE.                      1SM00230
       CAL     IBSXEC        NO. RETURN TO                              1SM00240
       SLW     SYSGET         THE BASIC                                 1SM00250
       TRA     SYSRET         MONITOR.                                  1SM00260
REPEAT BSS     0                                                     (2)1SM00265
GO     BSS     0                                                     (2)1SM00270
       STZ     LD008         RESET MAP SWITCH.                       (2)1SM00285
       SPACE   2                                                        1SM00290
*                                                                       1SM00300
*    PREPARE EDIT PHASE MODIFICATIONS FOR LOADING                       1SM00310
*                                                                       1SM00320
       NOP                   IF EDIT PHASE MODS ARE GOING TO BE USED,   1SM00330
*                             CHANGE NOP TO  SWT 3.                     1SM00340
       TRA     EP3           NO. LOAD EDIT PHASE.                       1SM00350
       TSX     (PROUT,4      YES. PRINT EDIT PHASE MOD                  1SM00360
       MZE     2                MESSAGE (*OD01)                         1SM00370
       PZE     LD614,,10           BEFORE STOPPING                      1SM00380
       PZE     LD614B,,2+512*4                                          1SM00390
       TSX     (PAUSE,4      WAIT FOR ENTRY KEYS OPTION                 1SM00400
       ENK                   DETERMINE FROM                             1SM00410
       XCL                    ENTRY KEYS, WHICH                         1SM00420
       ANA     LD007+1        MODS ARE TO                               1SM00430
       SXD     EP3.1,0        BE LOADED.                                1SM00440
       TZE     EP3           LOAD EDIT PHASE, IF NO MODS.               1SM00450
       AXT     5,1           SET TO SELECT MODS.                        1SM00460
       AXT     5,2           SET TO INSERT MOD NAMES IN PROGRAM LIST    1SM00470
       AXT     0,4           RESET TO COUNT NUMBER OF MODS.             1SM00480
EP1    LBT                   IS THIS MOD USED...                        1SM00490
       TRA     EP2           NO. LOOK AT NEXT ONE.                      1SM00500
       LDQ     EPMODS,1      PLACE NAME OF DESIRED                      1SM00510
       STQ     PLEPMD+5,2    MOD IN PROGRAM LIST.                       1SM00520
       TXI     *+1,2,-1                                                 1SM00530
       TXI     *+1,4,1       KEEP COUNT OF MODS NEEDED                  1SM00540
EP2    ARS     1             GET NEXT MOD BIT.                          1SM00550
       TIX     EP1,1,1       SET IR1 FOR NEXT MOD NAME.                 1SM00560
       SXD     EP3.1,4       SAVE NUMBER OF MODS TO BE LOADED.          1SM00570
       SPACE   2                                                        1SM00580
*                                                                       1SM00590
*    EDIT PHASE LOADING                                                 1SM00600
*                                                                       1SM00610
EP3    AXT     PLEPMD-PLEP-2,1 IF NO MODS                               1SM00620
EP3.1  TXI     *+1,1,**        ARE INDICATED                            1SM00630
       SXD     PLEP+1,1          REFRESH COUNTS IN                      1SM00640
       TXI     *+1,1,1             CALLING SEQUENCE AND PROGRAM         1SM00650
       SXD     LOADEP+1,1             LIST WITH INITIAL VALUES          1SM00660
       STL     LD008         SET PRINT SUPPRESSION SWITCH               1SM00670
       LAC     SYSCOR,4      RELOCATE ALL COMMON REFERENCES             1SM00680
       TXI     *+1,4,32767    DOWNWARD IF SYSEND IS LESS THAN           1SM00690
       SXA     LD145,4        77777 OCTAL, LEAVING 206 CELLS FOR SPOUT. 1SM00700
       TSX     ZEROES,4      CLEAR LOAD AREA.                           1SM00710
       LAC     SYSCK2,4                                                 1SM00720
       TXL     LOADEP,4,0                                               1SM00730
       LDI     0,4           IF SYSCK2 IS A                             1SM00740
       LNT     20000          HYPERTAPE, THEN                           1SM00750
       TRA     LOADEP         HYOPEN MUST BE                            1SM00760
       CAL     HYPOPE         LOADED WITH EDIT PHASE IN                 1SM00770
       SLW     EPOPEN         CASE OF RESTART.                          1SM00780
LOADEP TSX     LD001,4       LOAD                                       1SM00790
       PZE     PLEP,,**         EDIT                                    1SM00800
       BCI     1,EP001             PHASE                                1SM00810
( 3.4) TRA     PH1           PROCEED TO LOAD PHASE ONE                  1SM00820
( 4.4) TRA     SYSRET        RETURN TO BASIC MONITOR                    1SM00830
( 5.4) NOP                   CONTENTS OF REFPR                          1SM00840
( 6.4) TRA     PHM           LOAD MERGE PHASE ONLY.                     1SM00850
( 7.4) PZE     LD086+1,,LD087A-2       MAP PROUT C/S.                   1SM00860
( 8.4) PZE     XSADD,,XSADD-PLXS-2     MODS ADDR (PH1),,FIXED CT        1SM00870
( 9.4) PZE     PH1CT,,PLXS+1           ADDR OF PH1 CT,,ADDR OF PLXS CT  1SM00880
(10.4) TRA     DELETE        DELETE SORT RETURN.                     (2)1SM00890
(11.4) PZE     PLMRMD,,PLMRMD-PLMR-2   MODS ADDR (PH2),,FIXED CT        1SM00900
(12.4) PZE     PH2CT,,PLMR+1           ADDR OF PH3 CT,,ADDR OF PLFM CT  1SM00910
(13.4) PZE     PLFMMD,,PLFMMD-PLFM-2   MODS ADDR (PH3),,FIXED CT        1SM00920
(14.4) PZE     PH3CT,,PLFM+1           ADDR OF PH3 CT,,ADDR OF PLFM CT  1SM00930
       SPACE   2                                                        1SM00940
*                                                                       1SM00950
* INTERNAL SORT LOADING                                                 1SM00960
*                                                                       1SM00970
PH1    STI     LD145         SAVE COMMON RELOCATION CONSTANT.           1SM00980
       SXA     LD008,1       SET MAP PRINTING SWITCH.                   1SM00990
       LXA     LD145,1       GET COMMON RELOCATION CONSTANT             1SM01000
       TSX     ZEROES,4      CLEAR LOAD AREA.                           1SM01010
       TSX     LD001,4           LOAD                                   1SM01020
PH1CT  PZE     PLXS,,XSADD-PLXS-1 PHASE                                 1SM01030
       PZE     **            INITIALIZED WITH PHASE ONE TCP BY CALC.    1SM01040
       TRA     PH3           NUMBER OF STRINGS LESS THAN MERGE ORDER    1SM01050
       TRA     PH2           GO TO MERGE PHASE                          1SM01060
       TRA     PH4           INTERRUPT-GO TO POST PROCESSOR             1SM01070
       SPACE   2                                                        1SM01080
*                                                                       1SM01090
* MERGE PHASE LOADING                                                   1SM01100
*                                                                       1SM01110
PH2    BSS     0                                                        1SM01120
       LXA     LD145,1       GET COMMON RELOCATION CONSTANT             1SM01130
       TSX     ZEROES,4      CLEAR LOAD AREA.                           1SM01140
       TSX     LD001,4            LOAD                                  1SM01150
PH2CT  PZE     PLMR,,PLMRMD-PLMR-1 PHASE                                1SM01160
       PZE     **            INITIALIZED WITH PHASE TWO TCP BY CALC.    1SM01170
       TRA     PH3           GO TO FINAL MERGE                          1SM01180
       TRA     PH4           INTERRUPT-GO TO POST PROCESSOR             1SM01190
       SPACE   2                                                        1SM01200
*                                                                       1SM01210
* FINAL MERGE PHASE LOADING                                             1SM01220
*                                                                       1SM01230
PHM    STI     LD145         SAVE COMMON RELOCATION CONSTANT.           1SM01240
       SXA     LD008,1       SET MAP PRINTING SWITCH.                   1SM01250
PH3    BSS     0                                                        1SM01260
       LXA     LD145,1       GET COMMON RELOCATION CONSTANT             1SM01270
       TSX     ZEROES,4      CLEAR LOAD AREA.                           1SM01280
       TSX     LD001,4            LOAD                                  1SM01290
PH3CT  PZE     PLFM,,PLFMMD-PLFM-1 PHASE                                1SM01300
       PZE     **            INITIALIZED WITH PHASE THREE TCP BY CALC.  1SM01310
       STQ     LASTDL        MQ MINUS IF PREVIOUS SORT DELETED.      (2)1SM01320
       TRA     REPEAT        RELOAD EDIT PHASE.                      (2)1SM01330
       TRA     PH4           LOAD FOR DELETE.                        (2)1SM01335
       SPACE   2                                                        1SM01340
*                                                                       1SM01350
* POST PROCESSOR LOADING FOR DELETING SORT.                          (2)1SM01360
*                                                                       1SM01370
PH4    BSS     0                                                        1SM01380
       LDC     SYSUBC,1                                              (6)1SM01382
       TXI     *+1,1,1        DELAY UNTIL                            (6)1SM01384
       ZET*    (CHXAC         CHANNEL ACTIVITY                       (6)1SM01386
       TRA     *-1            HAS CEASED                             (6)1SM01387
       TXH     *-3,1,0                                               (6)1SM01388
       CAL     POST1         PUT BCD NAME OF POST PROCESSOR IN          1SM01390
       SLW     PH3CT+1        CALLING SEQUENCE TO LOADER.               1SM01400
       TRA     PH3           LOAD POST-PROCESSOR.                       1SM01410
 POST1 BCI     1,POST1                                                  1SM01420
       SPACE   2                                                        1SM01430
*                                                                       1SM01440
*  CLEAR LOADING AREA                                                   1SM01450
*                                                                       1SM01460
ZEROES AXT     BUFFER-LAST,2 ZERO OUT                                   1SM01470
       STZ     BUFFER,2       LOADING                                   1SM01480
       TIX     *-1,2,1        AREA                                      1SM01490
       TRA     1,4           RETURN                                     1SM01500
       TTL     PROGRAM LISTS (FOR LD001)                                1SM01510
       SPACE   5                                                        1SM01520
*                                                                       1SM01530
* EDIT PHASE PROGRAM LIST                                               1SM01540
*                                                                       1SM01550
PLEP   PZE     LAST                                                     1SM01560
       PZE     SYSLIB,,**                                               1SM01570
       BCI     1,HYSTAR                                                 1SM01580
EPOPEN BCI     1,IOPEN                                                  1SM01590
       BCI     1,LABEL                                                  1SM01600
       BCI     1,EP001                                                  1SM01610
       BCI     1,CALC                                                   1SM01620
       BCI     1,RB01                                                   1SM01630
       BCI     1,SK001                                                  1SM01640
       BCI     1,RELEAS                                                 1SM01650
       BCI     1,BTD                                                    1SM01660
PLEPMD BSS     5             RESERVE FOR FIVE EDIT PHASE MODS           1SM01670
       BCI     1,EPM05                                                  1SM01680
       BCI     1,EPM04                                                  1SM01690
       BCI     1,EPM03                                                  1SM01700
       BCI     1,EPM02                                                  1SM01710
       BCI     1,EPM01                                                  1SM01720
EPMODS PZE                                                              1SM01730
       SPACE   2                                                        1SM01740
*                                                                       1SM01750
* INTERNAL SORT PROGRAM LIST                                            1SM01760
*                                                                       1SM01770
PLXS   PZE     LAST                                                     1SM01780
       PZE     SYSLIB,,XSADD-PLXS-2                                     1SM01790
XSADD  BSS     38                                                       1SM01800
       SPACE   2                                                        1SM01810
*                                                                       1SM01820
* MERGE PHASE PROGRAM LIST                                              1SM01830
*                                                                       1SM01840
PLMR   PZE     LAST                                                     1SM01850
       PZE     SYSLIB,,PLMRMD-PLMR-2                                    1SM01860
PLMRMD BSS     23                                                       1SM01870
       SPACE   2                                                        1SM01880
*                                                                       1SM01890
* FINAL MERGE PHASE PROGRAM LIST                                        1SM01900
*                                                                       1SM01910
PLFM   PZE     LAST                                                     1SM01920
       PZE     SYSLIB,,PLFMMD-PLFM-2                                    1SM01930
PLFMMD BSS     34                                                       1SM01940
       TTL     SORT SUBROUTINE BINARY LOADER (LD001)                    1SM01950
*                                                                       1SM01960
*      CALLING SEQUENCE TO SSB LOADER ( LD001 )                         1SM01970
*                                                                       1SM01980
*          TSX   LD001,4                                                1SM01990
*          PZE   ORIGIN,,N                                              1SM02000
*          BCI   1, RETURN                                              1SM02010
*                                                                       1SM02020
*      ORIGIN  CONTAINS THE ADDRESS AT WHICH LOADING IS TO BEGIN.       1SM02030
*                                                                       1SM02040
*      N  INDICATES HOW MANY CELLS IMMEDIATELY FOLLOW  PGLIST . THESE   1SM02050
*          CELLS CONTAIN THE NAMES OF THE PROGRAMS TO BE LOADED AND THE 1SM02060
*          I/O UNITS ON WHICH THE PROGRAMS CAN BE FOUND.                1SM02070
*                                                                       1SM02080
*      RETURN  IS THE NAME OF THE PROGRAM TO GET CONTROL WHEN THE       1SM02090
*          LOADING IS COMPLETED.                                        1SM02100
*                                                                       1SM02110
LD001  SXA     LD090,4       SAVE INDEX REGISTER 4                      1SM02120
       LDI*    SYSLIB                                                   1SM02130
       TSX     CELLS,4                                                  1SM02140
       STL     IOCELL                                                   1SM02150
       CLA     HYCELL        SAVE INFORMATION                           1SM02160
       STO     SYSHY          CONCERNING THE                            1SM02170
       CLA     IOCELL         SYSTEM TAPE.                              1SM02180
       STO     SYSIO                                                    1SM02190
       TSX     SKIPF,4                                                  1SM02200
       AXT     17,1          ZERO-OUT                                   1SM02210
       STZ     LP017,1          INFORMATION                             1SM02220
       TIX     *-1,1,1             TABLE                                1SM02230
       AXT     100,1         INITIALIZE                                 1SM02240
       SXA     LD004,1          CAPACITY COUNT                          1SM02250
       STZ     LD500+101,1         AND ZERO                             1SM02260
       TIX     *-1,1,1                OUT LOAD LIST                     1SM02270
       LXA     LD090,4       RESTORE INDEX REGISTER 4.                  1SM02280
       CAL     2,4           GET NAME OF TCP PROGRAM                    1SM02290
       SLW     LD500         PLACE THIS NAME IN TCP CELL                1SM02300
       CLA     1,4           GET CONTROL WORD                           1SM02310
       STA     LD010         SAVE ADDRESS OF FIRST PROGRAM LIST ENTRY   1SM02320
       PDX     ,1            GET N, NUMBER OF CELLS AFTER PROGRAM LIST  1SM02330
       SXA     LP007,1       SAVE IN INFORMATION TABLE                  1SM02340
       ADD     LD003         GET ADDRESS OF                             1SM02350
       ADD     LD003            FIRST PROGRAM NAME                      1SM02360
       STA     LP006               IN PROGRAM LIST                      1SM02370
       CLA*    1,4           GET LOAD ADDRESS                           1SM02380
       STA     LP002         SAVE IN INFORMATION CELL - (INCREMENT)     1SM02390
LD009  CLA     LP007         CURRENT VALUE OF N                         1SM02400
       SUB     LD003         SUBTRACT ONE (1)                           1SM02410
       STA     LP007         SAVE NEW VALUE OF N                        1SM02420
       CLA     LP013         GET M                                      1SM02430
       ADD     LD010         ADD ADDRESS OF PROGRAM LIST ENTRY          1SM02440
       ADD     LD003         ADD ONE (1)                                1SM02450
       STA     LD010         STORE IN PROGRAM ENTRY CELL.               1SM02460
       SXA     RESTOR,4                                                 1SM02470
       AXC     DECR,4                                                   1SM02480
LD010  CLA     **            GET PROGRAM LIST ENTRY                     1SM02490
       STA     *+1                                                      1SM02500
       LDI*    **                                                       1SM02510
CELLS  STZ     IOCELL        INTITIALIZE IOCELL.                        1SM02520
       STZ     HYCELL        INITIALIZE HYCELL.                         1SM02530
       LNT     020000        RETURN IF                                  1SM02540
       TRA     2,4            CARDS OR 729.                             1SM02550
       LFT     000700        TURN ON                                    1SM02560
       TRA     1,4            IOCELL IF DISK OR DRUM.                   1SM02570
       STL     HYCELL        SET HYCELL IF HYPER.                       1SM02580
       LDQ     FACE          SET MODE FOR                               1SM02590
       STQ     SET            INTERFACE 0.                              1SM02600
       STQ     SETB                                                     1SM02610
       LNT     000040        IF INTERFACE IS                            1SM02620
       TRA     RINDL          NOT 0 THEN                                1SM02630
       XCA                                                              1SM02640
       SUB     LD003          SET MODE FOR                              1SM02650
       STO     SET            INTERFACE 1.                              1SM02660
       STO     SETB                                                     1SM02670
       XCA                                                              1SM02680
RINDL  RIL     777740                                                   1SM02690
       OSI     BORDER         CORRECT                                   1SM02700
       RIR     000677                                                   1SM02710
       STI     ORDER          UNIT.                                     1SM02720
DECR   TRA     2,4                                                      1SM02730
       STL     IOCELL         UNIT IS DRUM OR DISK.                     1SM02740
       STD     LP001         SAVE NUMBER OF ENTRIES IN LIST.            1SM02750
RESTOR AXT     **,4                                                     1SM02760
       STT     LP012         SAVE TAG IF FORMAT IS UNBLOCKED.           1SM02770
       STA     LD011         PLACE ADDRESS IN ADM INSTRUCTION           1SM02780
       ARS     18            GET M                                      1SM02790
       STA     LP013         SAVE IN INFORMATION TABLE - PERMANENT      1SM02800
       ADD     LD010         ADD PROGRAM LIST ENTRY                     1SM02810
       ADD     LD003         ADD ONE (1)                                1SM02820
       STA     LD013         STORE IN ERA INSTRUCTION                   1SM02830
       ZAC                                                              1SM02840
       EJECT                                                            1SM02850
*                                                                       1SM02860
* PREPARE UNIT WHERE PROGRAM(S) ARE LOCATED                             1SM02870
*                                                                       1SM02880
LD011  ADM     **            GET MAGNITUDE OF SYSLIB CELL               1SM02890
LD011A STA     *+1           PREPARE TO GET                             1SM02900
       CLA     **               I/O                                     1SM02910
       STD     LP016            UNIT                                    1SM02920
       ARS     18                  ADDRESS                              1SM02930
       ORA     LD003+1       MAKE I/O ADDRESS BINARY                    1SM02940
       STA     LP016                                                    1SM02950
       ANA     *+1           SAVE BITS 27,28,29.                        1SM02960
       PAX     448,2         (OCTAL 700 IN ADDRESS)                     1SM02970
       STZ     LP015         RESET CARD READER INDICATOR.               1SM02980
       TXL     READ,2,128    NOT CARDS IF OCTAL 200 OR LESS.            1SM02990
       NZT     IOCELL        TEST FOR 7909 CHAN., AND THUS NOT CARDS.   1SM03000
       STL     LP015         CHANNEL IS 7607-MUST BE CARD READER.       1SM03010
READ   TSX     LD100,4       READ IN A PROGRAM                          1SM03020
       ZET     LD135         HAS ACTIVITY                               1SM03030
       TRA     *-1              CEASED                                  1SM03040
       ZET     LD114         WAS EOF ENCOUNTERED                        1SM03050
       TRA     LD015         YES                                        1SM03060
       AXT     0,4           NO                                         1SM03070
 LD012 CAL     BUFFER,4      GET 9L                                     1SM03080
       TZE     LD014         BLANK CARD                                 1SM03090
       ZET     LP011         IS PROGRAM CARD TEST NEEDED                1SM03100
       TRA     *+3           NO                                         1SM03110
       PBT                   YES                                        1SM03120
       TRA     LD014                                                    1SM03130
       ZET     LP014         CARD READ TEST                             1SM03140
       TRA     LD022         NOT EDITING PROGRAM CARD                   1SM03150
       LXA     LP013,1       PLACE M IN REGISTER                        1SM03160
 SUBTR BSS     0                                                        1SM03170
       CAL     SUBNAM        COMPARE                                    1SM03180
       ZET     LP012         TEST FOR UNBLOCKED INPUT                   1SM03190
       CAL     BUFFER+4      GET PROGRAM NAME                           1SM03200
       ZET     LP015         TEST FOR CARD READER                       1SM03210
       CAL     BUFFER+4      GET PROGRAM NAME                           1SM03220
       SLW     SUBNAM        IF UNBLOCKED SAVE NAME IN SUBNAM           1SM03230
LD013  ERA     **,1             NAMES                                   1SM03240
       TZE     LD020         THIS IS THE PROGRAM DESIRED                1SM03250
       TIX     SUBTR,1,1                                                1SM03260
       TRA     READ                                                     1SM03270
*                                                                       1SM03280
LD014  BSS     0                                                        1SM03290
       ZET     LP015         TEST FOR CARDS OR NON-CARD UNIT.           1SM03300
       TRA     LD014A        CARDS                                      1SM03310
       ZET     LP012         TEST FOR BLOCKED OR UNBLOCKED              1SM03320
       TRA     LD014A        UNBLOCKED                                  1SM03330
       LXA     LP000,4       GET BUFFER COUNT CELL                      1SM03340
       TXI     *+1,4,-24     INCREASE COUNTER, NEGATIVELY               1SM03350
       SXA     LP000,4       SAVE BUFFER COUNT CELL                     1SM03360
       TRA     LD012         READ ANOTHER CARD                          1SM03370
       SPACE   2                                                        1SM03380
*                                                                       1SM03390
*  RESET COUNTS AND GO READ ANOTHER CARD                                1SM03400
*                                                                       1SM03410
LD014A BSS     0                                                        1SM03420
       STZ     LP000         RESET BUFFER COUNT                         1SM03430
       TRA     READ          GO READ ANOTHER CARD                       1SM03440
LD015  BSS     0                                                        1SM03450
       LDQ     LP016         PLACE TAPE NUMBER IN MQ                    1SM03460
       TSX     (CVPRT,4      PRINT MESSAGE                              1SM03470
       MZE     LD604,,5+512*4   ABOUT MISSING PROGRAM(S)  (*LD01)       1SM03480
       SPACE   2                                                        1SM03490
*                                                                       1SM03500
*  CHECK FOR MISSING PROGRAMS                                           1SM03510
*                                                                       1SM03520
LD017  LXA     LP013,2       GET M                                      1SM03530
       PXA     ,2            SET UP                                     1SM03540
       ADD     LP006            COMPARISON                              1SM03550
       STA     *+2                 LOOP                                 1SM03560
LD018  AXT     100,1         COMPARE                                    1SM03570
       CAL     **,2             NAMES OF LOADED                         1SM03580
       ERA     LD500+101,1         PROGRAMS                             1SM03590
       TZE     LD019                  AGAINST                           1SM03600
       TIX     LD018+1,1,2               PROGRAM LIST                   1SM03610
       XEC     LD018+1       PLACE NAME                                 1SM03620
       SLW     LD620            IN MESSAGE                              1SM03630
       TSX     (PROUT,4      PRINT                                      1SM03640
       MZE     2                   NAME OF                              1SM03650
       MZE     LD620,,1            MISSING                              1SM03660
       PZE     LD602,,4+512*4         PROGRAM(S)                        1SM03670
LD019  TIX     LD018,2,1     GET NEXT NAME                              1SM03680
       TSX     (PROUT,4      PRINT MESSAGE                              1SM03690
       MZE     2                 ABOUT CONTINUING                       1SM03700
       PZE     LD613,,4             WITHOUT PROGRAM(S)                  1SM03710
       PZE     LD613B,,4+512*4                                          1SM03720
       TSX     (PAUSE,4      WAIT                                       1SM03730
       SWT     3             TEST FOR DELETE DECISION                   1SM03740
       TRA     LD084         DELETE SORT                                1SM03750
       TRA     LD075         LOADING TO CONTINUE WITHOUT PROGRAMS       1SM03760
       SPACE   2                                                        1SM03770
*                                                                       1SM03780
*  PREPARE PROGRAM FOR LOADING                                          1SM03790
*                                                                       1SM03800
LD020  LXA     LD004,2       PLACE CAPACITY CELL IN XR2                 1SM03810
       STL     LP011         BYPASS PROGRAM CARD TEST                   1SM03820
       STL     LP014         SET UP CARD READ TEST                      1SM03830
       AXT     100,1         HAS DESIRED                                1SM03840
       CAL     SUBNAM           PROGRAM BEEN                            1SM03850
       ERA     LD500+101,1         LOADED YET                           1SM03860
       TZE     READ           YES                                       1SM03870
       TIX     *-3,1,2       NO, CONTINUE                               1SM03880
       CLA     BUFFER,4      GET 9L                                     1SM03890
       PDX     ,1            PUT WORD COUNT IN REGISTER                 1SM03900
       ZET     LP015         TEST FOR CARDS OR NON-CARD UNIT.           1SM03910
       TXI     *+2,1,-2                                                 1SM03920
       TXI     *+1,1,-322    IF NON-CARD, ALSO STRIP COLUMN BINARY 5    1SM03930
       CLA     BUFFER+2,4    GET 8L                                     1SM03940
       STA     LP004         SAVE PROGRAM BREAK                         1SM03950
       STD     LD500+102,2   SAVE LENGTH OF TRANSFER VECTOR             1SM03960
       CAL     *                                                        1SM03970
       STP     LD500+102,2                                              1SM03980
LD021  CAL     BUFFER+4,4    GET 7L, 6L, ETC.                           1SM03990
       TZE     LD021A        NO ENTRY NAMES                             1SM04000
       SLW     LD500+101,2   PLACE NAME IN LOAD LIST                    1SM04010
       CLA     BUFFER+5,4    GET 7R, 6R, ETC.                           1SM04020
       ADD     LP002         ADD CURRENT INCREMENT                      1SM04030
       STA     LD500+102,2   PLACE LOAD ADDRESS IN LOAD LIST            1SM04040
       TXI     *+1,2,-2      DROP CAPACITY CELL BY 2                    1SM04050
       TXI     *+1,4,-2      DECREASE BUFFER COUNT REGISTER BY TWO      1SM04060
       TIX     LD021,1,2     GET NEXT ENTRY NAME                        1SM04070
LD021A SXA     LD004,2       SAVE CURRENT VALUE OF CAPACITY CELL        1SM04080
       TRA     LD014         READ ANOTHER RECORD                        1SM04090
*                                                                       1SM04100
LD022  LXA     LP000,4       RESET XR4                                  1SM04110
       CAL     BUFFER,4      GET 9L                                     1SM04120
       TZE     LD014         BLANK CARD REJECTED                        1SM04130
LD023  PDX     ,1            PUT WORD COUNT IN REGISTER                 1SM04140
       NZT     LP015         TEST FOR CARDS OR OTHER UNIT.              1SM04150
       TXI     *+1,1,-320    STRIP COLUMNAR BINARY 5 FROM 9L            1SM04160
       SXA     LP008,1       STORE IN WORD COUNT CELL                   1SM04170
       PBT                   IS THIS A FORTRAN TRANSFER CARD            1SM04180
       TRA     LD025         NO-COMPUTE CHECKSUM                        1SM04190
       TXL     LD035,1,0     THIS IS A FORTRAN TRANSFER CARD            1SM04200
       SPACE   2                                                        1SM04210
*                                                                       1SM04220
*  CHECKSUM ROUTINES                                                    1SM04230
*                                                                       1SM04240
LD025  SXA     LD032,4       SAVE XR4.                                  1SM04250
       ARS     15            PREFIX TO DECREMENT.                       1SM04260
       PDX     ,1             THEN TO XR1.                              1SM04270
       TXL     LD029,1,2     COMPUTE CHECKSUM OF RELOCATABLE CARD       1SM04280
       TXL     LD040,1,3     IGNORE CKSUM                               1SM04290
       TRA     LD029                                                    1SM04300
*                                                                       1SM04310
LD027  CAL     BUFFER,4      GET 9L                                     1SM04320
       ACL     BUFFER+2,4    ADD 8L THROUGH 12R                         1SM04330
       TXI     *+1,4,-1      COMPUTE                                    1SM04340
       TIX     *-2,2,1          CHECKSUM                                1SM04350
LD032  AXT     **,4          RE-INITIALIZE XR4                          1SM04360
       LAS     BUFFER+1,4    COMPARE SUM WITH 9R                        1SM04370
       NZT     BUFFER+1,4    DOES 9R EQUAL ZERO                         1SM04380
       TRA     LD040         YES - RETURN TO CALLER                     1SM04390
LD028  CAL     SUBNAM        PICK UP CURRENT NAME                       1SM04400
       SLW     LD600B           AND PLACE IN MESSAGE                    1SM04410
       TSX     (PROUT,4      PRINT MESSAGE  (*LD02)                     1SM04420
       MZE     1                STATING THAT                            1SM04430
       PZE     LD600,,5            CKSUM IS IN ERROR.                   1SM04440
       TSX     (PAWSX,4      PAUSE AND START                            1SM04450
       TRA     LD040         RETURN                                     1SM04460
*                                                                       1SM04470
LD029  LXA     LP008,2       WORD COUNT TO REGISTER                     1SM04480
       ZAC                                                              1SM04490
       LDQ     BUFFER,4      9L                                         1SM04500
       LGL     2             GET PREFIX                                 1SM04510
       TZE     LD027         GO COMPUTE CHECKSUM                        1SM04520
       TXI     LD027,2,2     INCLUDE 8L + 8R OF RELOCATABLE CARD        1SM04530
       SPACE   2                                                        1SM04540
*                                                                       1SM04550
*  CHECK TO SEE IF THERE ARE ANYMORE ROUTINES TO BE LOADED AND          1SM04560
*  RE-INITIALIZE FOR NEXT SUBPROGRAM LOAD                               1SM04570
*                                                                       1SM04580
LD035  STZ     LP011         INITIALIZE PROGRAM CARD TEST CELL.         1SM04590
       STZ     LP014         INITIALIZE CARD READ TEST CELL             1SM04600
       STZ     LP000         REFRESH BUFFER COUNT                       1SM04610
       STZ     LP012          RESET UNBLOCK MODE                        1SM04620
       CLA     LP002         GET CURRENT INCREMENT                      1SM04630
       ADD     LP004         ADD LENGTH OF PROGRAM                      1SM04640
       STA     LP002         NEW VALUE OF INCREMENT                     1SM04650
       LXD     LP001,1       M                                          1SM04660
       TXI     *+1,1,-1      M-1                                        1SM04670
       SXD     LP001,1       SAVE (M-1)                                 1SM04680
       PXA     ,1                                                       1SM04690
       TNZ     READ          READ ANOTHER RECORD                        1SM04700
       CLA     LP007         N                                          1SM04710
       SUB     LP013         N-M                                        1SM04720
       STA     LP007         SAVE DIFFERENCE                            1SM04730
       TZE     LD075         NO MORE PROGRAMS TO LOAD                   1SM04740
       TRA     LD009         GET NEXT SET OF PROGRAMS TO LOAD           1SM04750
       SPACE   2                                                        1SM04760
*                                                                       1SM04770
*  LOADING INSTRUCTIONS INTO CORE                                       1SM04780
*                                                                       1SM04790
LD040  LGL     10                                                       1SM04800
       ZAC                      BINARY 5 FROM 9L                        1SM04810
       LGL     6             WORD COUNT TO AC                           1SM04820
       TZE     LD035         RELOCATABLE TRANSFER CARD - END OF PROGRAM 1SM04830
       PAX     ,1            WORD COUNT TO INDEX REGISTER 1             1SM04840
       SXA     LP008,1       STORE IN WORD COUNT CELL                   1SM04850
       LXA     LP000,4       INITIALIZE REGISTER 4 WITH BUFFER COUNT    1SM04860
LD040A BSS     0                                                        1SM04870
       CLA     BUFFER+4,4    GET INSTRUCTION                            1SM04880
       ARS     18            GET DECREMENT                              1SM04890
       STL     LP005         PUT RELOCATION INDICATOR ON(NON-ZERO)      1SM04900
LD040B BSS     0                                                        1SM04910
       STA     LP009         HOLD DECREMENT/ADDRESS TEMPORARILY         1SM04920
       TSX     LD050,2       CHECK RELOCATION BITS                      1SM04930
       TMI     *+2           1 - CHECK FOR 10 OR 11                     1SM04940
       TRA     LD060         0 - DO NOT RELOCATE                        1SM04950
       TSX     LD050,2       CHECK RELOCATION BITS                      1SM04960
       TMI     *+2           11-CHECK IF COMMON OR ORDINARY RELOCATION  1SM04970
       TRA     LD042         10 - CHECK IF ORDINARY OR COMMON RELOCATION1SM04980
       CLA     LP009         GET DECREMENT/ADDRESS                      1SM04990
       CAS     LP004         IS ADDRESS/DECREMENT ABOVE PROGRAM BREAK   1SM05000
       TRA     LD041         YES - ORDINARY RELOCATION                  1SM05010
       TRA     LD041         YES - ORDINARY RELOCATION                  1SM05020
       SUB     LD145         SUBTRACT RELCOM CONSTANT                   1SM05030
       TRA     LD045         PUT RELOCATED DECREMENT/ADDRESS BACK       1SM05040
*                                                                       1SM05050
LD041  ADD     LP002         ADD INCREMENT                              1SM05060
       TRA     LD045         PUT RELOCATED DECREMENT/ADDRESS BACK       1SM05070
*                                                                       1SM05080
LD042  CLA     LP009         GET DECREMENT/ADDRESS                      1SM05090
       CAS     LP004         IS ADDRESS/DECREMENT ABOVE PROGRAM BREAK   1SM05100
       TRA     LD043         YES - COMMON RELOCATION                    1SM05110
       TRA     LD043         YES - COMMON RELOCATION                    1SM05120
       ADD     LP002         NO-ADD CURRENT INCREMENT                   1SM05130
       TRA     LD045         PUT RELOCATED DECREMENT/ADDRESS BACK       1SM05140
*                                                                       1SM05150
LD043  CLA     LP009         GET DECREMENT/ADDRESS                      1SM05160
       SUB     LD145         SUBTRACT RELCOM CONSTANT                   1SM05170
LD045  NZT     LP005         IS RELOCATION INDICATOR ON (NON-ZERO)      1SM05180
       TRA     LD046         OFF - RELOCATING ADDRESS                   1SM05190
       STZ     LP005         TURN INDICATOR OFF (ZERO)                  1SM05200
       ALS     18            RELOCATING DECREMENT                       1SM05210
       STD     BUFFER+4,4    PUT RELOCATED DECREMENT BACK               1SM05220
       TRA     LD061         GET ADDRESS TO BE RELOCATED                1SM05230
*                                                                       1SM05240
LD045A BSS     0                                                        1SM05250
       TXI     *+1,4,-1      DECREASE BUFFER COUNT REGISTER BY ONE      1SM05260
       TIX     LD040A,1,1    GET NEXT INSTRUCTION IF ANY LEFT           1SM05270
       TRA     LD055         LOAD RELOCATED CARD                        1SM05280
LD046  STA     BUFFER+4,4    PUT RELOCATED ADDRESS BACK                 1SM05290
       TRA     *-4           MORE RELOCATION                            1SM05300
LD050  SXA     LD051,4       SAVE CURRENT VALUE OF XR4                  1SM05310
       LXA     LP000,4       SET BUFFER COUNT IN XR4                    1SM05320
       CLA     BUFFER+2,4    8L                                         1SM05330
       LDQ     BUFFER+3,4    8R                                         1SM05340
       LGL     1             SHIFT ONE                                  1SM05350
       SLW     BUFFER+2,4    SAVE AC RESIDUE                            1SM05360
       STQ     BUFFER+3,4    SAVE MQ RESIDUE                            1SM05370
LD051  AXT     **,4          RESTORE CURRENT VALUE TO XR4               1SM05380
       TRA     1,2           RETURN TO CALLER                           1SM05390
*                                                                       1SM05400
LD055  LXA     LP008,1       WORD COUNT                                 1SM05410
       LXA     LP000,4       GET BUFFER COUNT CELL                      1SM05420
       CLA     BUFFER,4      GET 9L                                     1SM05430
       ADD     LP002         ADD CURRENT INCREMENT                      1SM05440
       ADD     LP008         ADD WORD COUNT                             1SM05450
       STA     *+2           STORE IN STO INSTRUCTION                   1SM05460
       CLA     BUFFER+4,4    GET INSTRUCTION                            1SM05470
       STO     ,1            LOAD IT.                                   1SM05480
       TXI     *+1,4,-1      DECREASE BUFFER COUNT REGISTER BY ONE      1SM05490
       TIX     *-3,1,1       ANYMORE                                    1SM05500
       TRA     LD014         READ ANOTHER RECORD                        1SM05510
*                                                                       1SM05520
LD060  NZT     LP005         IS INDICATOR ON (NON-ZERO)                 1SM05530
       TRA     LD045A        SET UP ADDRESS TO BE RELOCATED             1SM05540
       STZ     LP005         TURN INDICATOR OFF (ZERO)                  1SM05550
LD061  BSS     0                                                        1SM05560
       CLA     BUFFER+4,4    GET ADDRESS                                1SM05570
       TRA     LD040B                                                   1SM05580
       SPACE   2                                                        1SM05590
*                                                                       1SM05600
*  INITIALIZE ALL TRANSFER VECTORS                                      1SM05610
*                                                                       1SM05620
LD075  ZET     LD008A        IS FIRST PASS SWITCH ON                    1SM05630
       TRA     LD082         YES, SKIP TRANSFER VECTORS FOR NOW         1SM05640
       ZAC                   CALCULATE                                  1SM05650
       AXT     100,2            NUMBER OF                               1SM05660
       ADM     LD500+102,2         ENTRIES                              1SM05670
       TIX     *-1,2,2                IN                                1SM05680
       ARS     18                        TRANSFER                       1SM05690
       STA     LP010                        VECTORS                     1SM05700
       AXT     100,2         PLACE 100 INTO                             1SM05710
       AXT     100,4            REGISTERS 2 AND 4                       1SM05720
LD076  CLA     LD500+102,4   GET SECOND CELL OF LOAD LIST SET           1SM05730
       TZE     LD082         NO INFORMATION IN CELL                     1SM05740
       PDX     ,1            LENGTH OF TRANSFER VECTOR TO REGISTER      1SM05750
       TXL     LD081,1,0     NO ENTRIES IN TRANSFER VECTOR              1SM05760
       STA     LD077         STORE IN CAL INSTRUCTION                   1SM05770
       STA     LD078         STORE IN STP INSTRUCTION                   1SM05780
       STA     LD079         STORE IN STO INSTRUCTION                   1SM05790
LD077  CAL     ,1            GET BCD NAME IN TRANSFER LIST              1SM05800
       ERA     LD500+101,2   COMPARE WITH NAME IN LOAD LIST             1SM05810
       TZE     LD078A        THIS IS IT                                 1SM05820
       CAL     LD500+101,2    GET NAME IN LOAD LIST                     1SM05830
       ANA     MASKA          MAKE OUT LAST CHARACTER                   1SM05840
       SLW     SAVEA                                                    1SM05850
       CAL     MASKB          GET A LOW ORDER BLANK                     1SM05860
       ORS     SAVEA          PREPARE NAME WITH BLANK IN LAST CHARACTER 1SM05870
       CAL*    LD077          NAME IN TRANSFER LIST                     1SM05880
       ERA     SAVEA          COMPARE NOW FOR MODIFICATION              1SM05890
       TZE     LD078A         THIS IS IT--MODIFICATION FOUND            1SM05900
       TIX     LD077,2,2      NOT FOUND TRY NEXT NAME                   1SM05910
       CAL     LD004A        GET STR WORD                               1SM05920
LD078  SLW     **,1          STORE STR IN TRANSFER VECTOR               1SM05930
       AXT     100,2         RE-INITIALIZE INDEX REGISTER TWO WITH 100  1SM05940
       TRA     LD080         GO TO TIX INSTRUCTION                      1SM05950
*                                                                       1SM05960
LD078A BSS     0                                                        1SM05970
       CLA     LD500+102,2   GET LOAD ADDRESS OF PROGRAM DESIRED        1SM05980
       STA     LD005         ADDRESS INTO TTR INSTRUCTION               1SM05990
       CLA     LD005         ENTRY CHANGED                              1SM06000
LD079  STO     ,1               TO TTR                                  1SM06010
       CLA     LP010         DROP                                       1SM06020
       SUB     LD003            NUMBER                                  1SM06030
       TZE     LD082               OF                                   1SM06040
       STA     LP010                 ENTRIES                            1SM06050
       AXT     100,2                    BY                              1SM06060
LD080  TIX     LD077,1,1                   ONE                          1SM06070
LD081  BSS     0                                                        1SM06080
       TIX     LD076,4,2                                                1SM06090
       SPACE   2                                                        1SM06100
*                                                                       1SM06110
*  LOCATE TRANSFER CONTROL POINT (TCP) PROGRAM                          1SM06120
*                                                                       1SM06130
LD082  BSS     0                                                        1SM06140
       AXT     100,2                                                    1SM06150
       CAL     LD500         GET TCP PROGRAM NAME                       1SM06160
       ERA     LD500+101,2   COMPARE WITH NAMES IN LOAD LIST            1SM06170
       TZE     LD085         TCP PROGRAM FOUND                          1SM06180
       TIX     *-3,2,2       TCP PROGRAM NOT YET FOUND                  1SM06190
       CAL     LD500         PLACE NAME OF                              1SM06200
       SLW     LD605B           MAIN PROGRAM IN MESSAGE                 1SM06210
       TSX     (PROUT,4      PRINT MESSAGE                              1SM06220
       PZE     2                STATING THAT                            1SM06230
       PZE     LD605,,6            CONTROL PROGRAM IS MISSING           1SM06240
       PZE     LD606,,5+512*4                                           1SM06250
       TSX     (PAUSE,4                                                 1SM06260
LD084  CAL     LD080                                                    1SM06270
       STD     SYSJOB                                                   1SM06280
       TSX     (PROUT,4                                                 1SM06290
       MZE     1                                                        1SM06300
       PZE     LD621,,2+512*4                                           1SM06310
       TRA     DELETE        DELETE SORT.                            (2)1SM06320
LD085  CLA     LD500+102,2   GET TCP PROGRAM LOAD ADDRESS               1SM06330
       STA     LD005         PLACE IN TTR INSTRUCTION                   1SM06340
       NZT     LD008         TEST FOR MAP PRINTING                      1SM06350
       TSX     MAP,4         PRINT MAP                                  1SM06360
       TRA     LD088                                                    1SM06370
       EJECT                                                            1SM06380
*                                                                       1SM06390
* ROUTINE FOR PRINTING MAP ON LINE                                      1SM06400
*                                                                       1SM06410
       DUP     1,12          BUFFER FOR READ-AHEAD CONTROL CARD.     (2)1SM06411
       BCI     1,        LAST CELL+1 OF THIS BUFFER IS MAP ROUTINE.  (2)1SM06412
MAP    SXA     MAP1,1        SAVE REGISTERS                             1SM06420
       SXA     MAP2,2                                                   1SM06430
       SXA     MAP4,4                                                   1SM06440
LD086  TSX     (PROUT,4      PRINT TITLE LINE OF                        1SM06450
       PZE     1              MAP.                                      1SM06460
       PZE     LD617,,6+512*4                                           1SM06470
       AXT     100,1                                                    1SM06480
LD087  CLA     LD500+102,1   GET SECOND CELL OF LOAD LIST SET           1SM06490
       TPL     LD087A                                                   1SM06500
       STA     LD092                                                    1SM06510
       ARS     18            GET NUMBER OF TRANSFER VECTORS             1SM06520
       ADD     LD092         SUBTRACT TRANSFER VECTOR COUNT.            1SM06530
       LGR     15            CONVERT OCTAL                              1SM06540
       TSX     (BCD5X,4         ADDRESS TO BCD                          1SM06550
       SLW     LD619+4       PLACE LOAD ADDRESS IN MESSAGE              1SM06560
       CAL     LD500+101,1   GET NAME OF PROGRAM                        1SM06570
       SLW     LD619+1          AND PLACE IN MESSAGE                    1SM06580
       TSX     (PROUT,4      PRINT                                      1SM06590
       PZE     1                NAME AND                                1SM06600
       PZE     LD619,,6            ADDRESS OF                           1SM06610
LD087A TIX     LD087,1,2              PROGRAM(S)                        1SM06620
       TSX     (PROUT,4      EJECT                                      1SM06630
       PZE     1                THE                                     1SM06640
       PZE     ,,512*4                                                  1SM06650
MAP1   AXT     **,1          RESTORE REGISTERS                          1SM06660
MAP2   AXT     **,2                                                     1SM06670
MAP4   AXT     **,4                                                     1SM06680
       TRA     1,4                                                      1SM06690
       EJECT                                                            1SM06700
*                                                                       1SM06710
*  FINAL CLEAN UP BEFORE GIVING PHASE CONTROL                           1SM06720
*                                                                       1SM06730
LD088  ZET     SYSIO         IS SYSTEM ON DISK OR DRUM...               1SM06740
       TRA     RESET          DISK OR DRUM.                             1SM06750
       ZET     SYSHY         TRANSFER IF SYSTEM                         1SM06760
       TRA     BACK           TAPE IS HYPER.                            1SM06770
SPACE  TSX     (NDSLX,4      BACKSPACE FILE.                            1SM06780
       PZE     SYSLIB,,6        ONCE                                    1SM06790
       NZT     LD114         WAS EOF ENCOUNTERED                        1SM06800
       TRA     RESET         NO.                                        1SM06810
       STZ     LD114         YES. BACKSPACE TO                          1SM06820
       TRA     SPACE          BEGINNING OF FILE.                        1SM06830
BACK   TSX     (NDSLX,4      BACKSPACE ONE                              1SM06840
       PZE     SYSLIB,,35     FILE.                                     1SM06850
       NZT     LD114         WAS THE EOF ENCOUNTERED...                 1SM06860
       TRA     RESET         NO.                                        1SM06870
       STZ     LD114         YES. BACKSPACE TO                          1SM06880
       TRA     BACK           BEGINNING OF FILE.                        1SM06890
RESET  STZ     LD114         RESET EOF INDICATOR.                       1SM06900
LD090  AXT     **,4          RESTORE INDEX REGISTER FOUR                1SM06910
       TOV     *+1           TURN OFF OVERFLOW LIGHT                    1SM06920
       AXT     0,2                                                      1SM06930
       LXA     (5.4),1       ZERO                                       1SM06940
       TIX     *+1,1,BUFFER     OUT                                     1SM06950
       STZ     BUFFER,2            BUFFER                               1SM06960
       TXI     *+1,2,-1               AREA                              1SM06970
       TIX     *-2,1,1                                                  1SM06980
       LXA     LP002,2                                                  1SM06990
       TXI     *+1,2,2                                                  1SM07000
       AXT     MAP,1         LOCATION OF MAP ROUTINE FOR EDIT PHASE     1SM07010
       LDQ     LASTDL        MINUS IF PREVIOUS SORT RUN DELETED.     (2)1SM07015
       TRA     LD005         TRANSFER TO TCP PROGRAM                    1SM07020
*                                                                       1SM07030
LASTDL PZE                   MQ SAVED HERE AT END FOR RELOAD.        (2)1SM07035
LD092  PZE                   HOLDS VECTOR COUNT, TEMPORARILY            1SM07040
LD093  BCI     1,000                                                    1SM07050
       TTL     READ ROUTINE                                             1SM07060
LD100  SXA     LD101,1       SAVE                                       1SM07070
       SXA     LD102,2           INDEX                                  1SM07080
       SXA     LD103,4             REGISTER                             1SM07090
       ZET     IOCELL        TEST FOR DISK OR DRUM.                     1SM07100
       TRA     LNTAPE        DISK OR DRUM.                              1SM07110
       CAL*    LD011         FIND LOCATION OF THE PROGRAM UNITS         1SM07120
       PAC     ,4               ADDRESS OF                              1SM07130
       CAL     LD120               SELECT ROUTINE                       1SM07140
       SLW     1,4                    IN UCW BLOCK                      1SM07150
       CAL     LD011         UNIT TO BE ACTIVATED                       1SM07160
       STA     *+2                                                      1SM07170
       TSX     (ACTVX,4      ACTIVATE                                   1SM07180
       MZE     **                                                       1SM07190
       TRA     LD101                                                    1SM07200
LNTAPE AXT     LD101,4                                                  1SM07210
       SXA     SYSTRA,4                                                 1SM07220
       TSX     SYSLDR,4      READ A DISK PROGRAM.                       1SM07230
LD101  AXT     **,1          RESTORE                                    1SM07240
LD102  AXT     **,2              INDEX                                  1SM07250
LD103  AXT     **,4                REGISTERS                            1SM07260
       TRA     1,4           RETURN TO CALLER                           1SM07270
       TTL     SELECT (+) AND SELECT (-) ROUTINES                       1SM07280
LD105  SXA     LD106,4       SAVE REGISTER FOUR                         1SM07290
       PAC     ,4                                                       1SM07300
       TMI     LD110         (SELECT MINUS ROUTINE)                     1SM07310
       CLA     LD125         GET I/O COMMAND                            1SM07320
       ZET     LP012                                                    1SM07330
       TRA     UNB                                                      1SM07340
       CLA     LD130         BLOCKED DATA.                              1SM07350
       ZET     HYCELL        SET UP (RCHXI FOR                          1SM07360
       CLA     HYSMS         HYPER.                                     1SM07370
       TRA     *+3                                                      1SM07380
UNB    ZET     HYCELL                                                   1SM07390
       CLA     HYSMSB                                                   1SM07400
       STA*    (RCHXI                                                   1SM07410
       CLA     LP016         GET PHYSICAL UNIT ADDRESS                  1SM07420
       STA     *+2           AND PLACE IN RDS INSTRUCTION.              1SM07430
       NZT     HYCELL        DONT RDS IF HYPER.                         1SM07440
RDS    RDS     **                                                       1SM07450
       XEC*    (RCHXI        EXECUTE APPROPRIATE RCHX                   1SM07460
       STL     LD135         INDICATE CHANNEL BUSY.                     1SM07470
LD106  AXT     **,4          RESET REGISTER FOUR                        1SM07480
       TRA     1,4           RETURN TO CALLER                           1SM07490
*                                                                       1SM07500
LD110  ZET     HYCELL        TRANSFER IF                                1SM07510
       TRA     HYIND          HYPER.                                    1SM07520
       LNT     400000        TEST FOR                                   1SM07530
       TRA     LD111            NOISE RECORD                            1SM07540
       LFT     100000        TEST FOR                                   1SM07550
       TRA     LD112            REDUNDANCY                              1SM07560
       LFT     200000        TEST FOR END OF FILE                       1SM07570
       STL     LD114         SET END OF FILE SWITCH                     1SM07580
STORE  STZ     1,4           RESET UCW2                                 1SM07590
       STZ     LD135         INDICATE CHANNEL NOT BUSY.                 1SM07600
       TRA     LD106         RETURN                                     1SM07610
HYIND  LNT     005010        WAS THERE NOT                              1SM07620
       TRA     NONRED         A REDUNDANCY...                           1SM07630
       RFT     003740        WAS THERE A                                1SM07640
       TRA     LD112          REDUNDANCY...                             1SM07650
NONRED RFT     000010        WAS THERE AN                               1SM07660
       STL     LD114          END OF FILE...                            1SM07670
       TRA     STORE         CONTINUE.                                  1SM07680
*                                                                       1SM07690
LD111  XEC     LD106                                                    1SM07700
       TRA     2,4                                                      1SM07710
*                                                                       1SM07720
LD112  XEC     LD106                                                    1SM07730
       TRA     3,4                                                      1SM07740
       TTL     MONITOR MESSAGES                                         1SM07750
LD600  BCI     3,CKSM ERROR LOADING                                     1SM07760
LD600B BCI     2,       *LD02                                           1SM07770
LD602  BCI     4, MISSING FROM ABOVE UNIT.                              1SM07780
LD604  BCI     5,HAS PROGRAM(S) MISSING  *LD01                          1SM07790
LD605  BCI     4,CONTROL PROGRAM MISSING,                               1SM07800
LD605B BCI     2,       *LD03                                           1SM07810
LD606  BCI     5,PRESS START TO DELETE SORT.                            1SM07820
LD613  BCI     4,TO DELETE SORT--SS3 UP                                 1SM07830
LD613B BCI     4,TO GO ON--------SS3 DN                                 1SM07840
LD614  BCI ,SET ENTRY KEYS (31-35) FOR EDIT PHASE MODIFICATIONS  *OD01  1SM07850
LD614B BCI     2,PUT SS3 UP                                             1SM07860
LD617  BCI     6,     PROGRAM         LOAD ADDRESS                      1SM07870
LD619  BCI     6,      000000            000000                         1SM07880
LD620  PZE                   HOLDS NAME OF MISSING PROGRAM              1SM07890
LD621  BCI     2,SORT DELETED                                           1SM07900
       TTL     STORAGE ALLOCATION                                       1SM07910
LD003  OCT     1,20                                                     1SM07920
LD004          100           CAPACITY COUNT                             1SM07930
LD004A FVE                                                              1SM07940
LD005  TTR     **                                                       1SM07950
LD007  OCT     316,37        RELOCATION INCREMENT/ENTRY KEYS MASK       1SM07960
LD008                        MAP PRINTING SWITCH.                       1SM07970
LD008A PZE                   FIRST PASS SWITCH                          1SM07980
LD114  PZE                   EOF SWITCH                                 1SM07990
LD120  PZE     0,,LD105                                                 1SM08000
LD125  PZE     LD150                                                    1SM08010
LD130  PZE     LD155                                                    1SM08020
LD135                        CHANNEL BUSY SWITCH.                       1SM08030
LD145  PZE                   HOLDS COMMON RELOCATION CONSTANT           1SM08040
HYPOPE BCI     1,HYOPEN                                                 1SM08050
IBSXEC BCI     1,IBSXEC                                                 1SM08060
IOCELL                       THIS CELL NON-ZERO INDICATES DISK OR DRUM. 1SM08070
HYCELL                       THIS CELL NON-ZERO INDICATES HYPER.        1SM08080
SYSIO                        NON-ZERO MEANS SYSTEM ON DISK OR DRUM.     1SM08090
SYSHY                        NON-ZERO MEANS SYSTEM ON HYPER.            1SM08100
ONCE   PZE                                                              1SM08110
LSELS  PZE     0,,SELS       LOCATION OF SKIP SELECT ROUTINE            1SM08120
CLASS  OCT     220           CLASS AND BINARY MASK                      1SM08130
 MASKA OCT     777777777700   MASK FOR ALL EXCEPT LAST CHARACTER        1SM08140
 MASKB OCT     60             BLANK FOR LAST CHARACTER                  1SM08150
 SAVEA PZE                    CELL FOR NEW FORMAT NAME                  1SM08160
LCHAS  PZE     CHAS          LOCATION OF SKIP COMMAND                   1SM08170
CHAS   IOCTN   0,,-1         SKIP FILE COMMAN                           1SM08180
LD150  IOCT    BUFFER,,24                                               1SM08190
SET    SMS     **                                                       1SM08200
       CTLR    ORDER                                                    1SM08210
LD155  CPYP    *+1,,1                                                   1SM08220
                                                                        1SM08230
       TCH     *-2                                                      1SM08240
SETB   SMS     **                                                       1SM08250
       CTLR    ORDER                                                    1SM08260
       CPYP    BUFFER,,-1                                               1SM08270
       TCH     SYSTWT                                                   1SM08280
FACE   SMS     70            SELECT INTERFACE 0.                        1SM08290
BORDER OCT     120600120112  HYPER SELECT.                              1SM08300
HYSMS  PZE     SET                                                      1SM08310
HYSMSB PZE     SETB                                                     1SM08320
ORDER  OCT     120600120112                                             1SM08330
SYSLIB         **            LOCATION OF UCW OF SYSTEM TAPE.            1SM08340
HSKF   BOOL    45                                                       1SM08350
BUFFER BOOL    45002                                                    1SM08360
SUBNAM EQU     BUFFER-2                                                 1SM08370
LD500  PZE                   TCP CELL                                   1SM08380
       BSS     100                                                      1SM08390
*                                                                      *1SM08400
*                          INFORMATION  TABLE                          *1SM08410
*                                                                      *1SM08420
LP000  PZE       BUFFER POINTER                                         1SM08430
LP001  PZE       (D) NUMBER OF ENTRIES IN PROGRAM LIST                  1SM08440
LP002  PZE       INITIAL LOAD ADDRESS (INCREMENTED AFTER EACH LOAD)     1SM08450
LP004  PZE       LENGTH OF PROGRAM                                      1SM08460
LP005  PZE       RELOCATION INDICATOR   0-OFF  NZ-ON                    1SM08470
LP006  PZE       ADDRESS OF FIRST PROGRAM NAME IN PROGRAM LIST          1SM08480
LP007  PZE       N - NUMBER OF CELLS AFTER PROGRAM LIST NAME            1SM08490
LP008  PZE       WORD COUNT (FROM 9L OF CARD)                           1SM08500
LP009  PZE       HOLDS ADDRESS/DECREMENT TO BE RELOCATED                1SM08510
LP010  PZE       TOTAL NUMBER OF TRANSFER VECTORS                       1SM08520
LP011  PZE       PROGRAM CARD TEST  0-NEEDED  NZ-NOT NEEDED             1SM08530
LP012  PZE       BLOCKING SWITH O-BLOCKED   NZ-UNBLOCKED                1SM08540
LP013  PZE       M - NUMBER OF PROGRAMS TO BE LOADED.                   1SM08550
LP014  PZE       CARD READ TEST     0-NEEDED  NZ-NOT NEEDED             1SM08560
LP015  PZE       TAPE OR CARD     O-TAPE     NZ-CARD READER             1SM08570
LP016  PZE       UNIT ADDRESS                                           1SM08580
*                (D) BCD UNIT ADDRESS                                   1SM08590
LP017  PZE                                                              1SM08600
       TTL     SKIP FILE MARK                                           1SM08610
*     SKIP ONE FILE MARK ON SYSLIB1 TO POSITION FOR READ OF NEXT FILE   1SM08620
*                                                                       1SM08630
 SKIPF SXA     SIR4,4         SAVE IR4                                  1SM08640
       ZET     IOCELL        TEST FOR DISK OR DRUM.                     1SM08650
       TRA     ENTAPE        DISK OR DRUM.                              1SM08660
       ZET     HYCELL                                                   1SM08670
       TRA     HYSKP                                                    1SM08680
       CAL     SYSLIB        PLACE ADDRESS                              1SM08690
       PAC     0,2            OF SELECT ROUTINE                         1SM08700
       CAL     LSELS          IN UCB                                    1SM08710
       SLW     1,2            WORD 2                                    1SM08720
       TSX     (ACTVX,4       ACTIVATE SYSLB1                           1SM08730
       MZE     SYSLIB         FOR SKIP.                                 1SM08740
       TRA     *+3                                                      1SM08750
HYSKP  TSX     (NDATA,4                                                 1SM08760
       PZE     SYSLIB,,HSKF                                             1SM08770
       ZET     LD135         HAS ACTIVITY CEASED                        1SM08780
       TRA     *-1                                                      1SM08790
       TRA     SIR4                                                     1SM08800
ENTAPE CAL     ONCE                                                     1SM08810
       SLW     SYSTCH                                                   1SM08820
 SIR4  AXT     **,4           RESTORE IR4                               1SM08830
       TRA     1,4            AND GO BACK TO MAIN ROUTINE               1SM08840
*                                                                       1SM08850
*     SELECT (+) ROUTINE FOR SKIPPING FILE MARK                         1SM08860
*                                                                       1SM08870
SELS   SXA     SRES,2        SAVE INDEX REGISTER 2.                     1SM08880
       PAC     0,2           SAVE THE LOCATION OF THE UCB.              1SM08890
       TMI     SELSM         SELECT MINUS.                              1SM08900
       CAL     LCHAS         SET UP                                     1SM08910
       STA*    (RCHXI         NON-HYPER.                                1SM08920
       CAL     0,2            PICK UP UNIT SELECT                       1SM08930
       ARS     18            SHIFT TO ADDRESS                           1SM08940
       ORA     CLASS          MAKE IT BINARY                            1SM08950
       STA     *+1           SET UP                                     1SM08960
 SSEL  RDS     **             SELECT UNIT                               1SM08970
       XEC*    (RCHXI         AND LOAD CHANNEL                          1SM08980
       STL     LD135         INDICATE CHANNEL BUSY.                     1SM08990
SRES   AXT     **,2          RESTORE INDEX REGISTER 2.                  1SM09000
       TRA     1,4            GO BACK TO XTRAP                          1SM09010
*                                                                       1SM09020
*     SELECT (-) ROUTINE FOR SKIPPING FILE MARK                         1SM09030
*                                                                       1SM09040
 SELSM LNT     400000         TEST FOR                                  1SM09050
       TRA     TWOFR         NOISE RECORD.                              1SM09060
       LFT     100000         TEST FOR                                  1SM09070
       TRA     THREFR        REDUNDANT RECORD.                          1SM09080
       LFT     200000         TEST FOR                                  1SM09090
       TRA     SKPOK          END OF FILE                               1SM09100
       TRA     SRES          KEEP TRYING                                1SM09110
SKPOK  STZ     1,2           RESET UCW2.                                1SM09120
       STZ     LD135         INDICATE CHANNEL NOT BUSY.                 1SM09130
       TRA     SRES          RETURN.                                    1SM09140
TWOFR  XEC     SRES                                                     1SM09150
       TRA     2,4                                                      1SM09160
THREFR XEC     SRES                                                     1SM09170
       TRA     3,4                                                      1SM09180
*                                                                       1SM09190
LAST   BSS     0                                                        1SM09200
*                                                                       1SM09210
       END     SORT                                                     1SM09220
* 7090/7094 SORT VER 7 MOD 9 RESTART SUBPROGRAM                      (9)ARS00000
*      FAP
       TITLE                                                            ARS00010
       COUNT   200                                                      ARS00020
       SPACE                                                            ARS00030
       ENTRY   HYSTAR                                                   ARS00040
       ENTRY   RESTAR                                                   ARS00050
       SST                                                              ARS00060
       SPACE                                                            ARS00070
HYSTAR BSS     0                                                        ARS00080
RESTAR BSS     0                                                        ARS00090
       TSX     MSGSUP,4,MUST PRINT SORT RESTART.                        ARS00100
       PZE     1                                                        ARS00110
       PZE     RSMES,,2+512*4                                           ARS00120
       LXA     GENPR-3,4     NONZERO IF CHECKPOINT HAS BEEN TAKEN.      ARS00130
       TXH     RSTART,4,0                                               ARS00140
FAILED TSX     MSGSUP,4,MUST PRINT RESTART FAILURE MESSAGE              ARS00150
       PZE     1                                                        ARS00160
       PZE     FLMES,,9+512*4                                           ARS00170
       LXD     GENPR-3,4     TAKE DELETE RETURN TO SORT MONITOR.        ARS00180
       TRA     4,4                                                      ARS00190
RSTART CLA     RWCS1         OPEN                                       ARS00200
       STO     RAWPR          CKPT                                      ARS00210
       STZ     RAWPR-1        FILE.                                     ARS00220
       CALL    IOPEN                                                    ARS00230
       LDI*    SYSCK2                                                   ARS00240
       LFT     20000         IS IT HYPER                                ARS00250
       STL     HYPER         YES                                        ARS00260
       LAC     SYSCK2,2                                                 ARS00270
       CAL     SELADD                                                   ARS00280
       SLW     1,2           SET UCW2                                   ARS00290
       CLA     0,2           GET A POINTER FOR                          ARS00300
       ARS     27             THE CHANNEL                               ARS00310
       ANA     =O17                                                     ARS00320
       PAC     ,1             ACTIVITY                                  ARS00330
       TXI     *+1,1,1        CELL.                                     ARS00340
       TSX     (ACTVX,4      ACTIVATE                                   ARS00350
       MZE     SYSCK2         UNIT.                                     ARS00360
LOOP   NZT     DELAY                                                    ARS00370
       TRA     IN                                                       ARS00380
       CAL     SELADD        DURING DELAY LOOP                          ARS00390
       SLW     1,2            UPDATE UCW 2.                             ARS00400
       TRA     LOOP                                                     ARS00410
IN     STZ     1,2           ZERO UCW2.                                 ARS00420
       CAL     =O1000000                                             (9)ARS00422
       ALS     0,1                                                   (9)ARS00424
       COM                                                           (9)ARS00426
       ANS     (TRAPS                                                (9)ARS00428
       CALL    SNDAT                                                    ARS00430
       PZE     SYSCK2,,3                                                ARS00440
       TRA     POSIT                                                    ARS00450
SELEC  SXA     SAVIT,4                                                  ARS00460
       SXA     SAVIT+1,1                                                ARS00470
       PAC     ,2                                                       ARS00480
       TMI     SMINUS        GO TO SELECT MINUS.                        ARS00490
       NZT     HYPER         IS IT HYPER.                               ARS00500
       TRA     TP729         NO.                                        ARS00510
       CAL     ONE           YES.                                       ARS00520
       LDI*    SYSCK2                                                   ARS00530
       LFT     40                                                       ARS00540
       ORS     SMS           INTERFACE 1.                               ARS00550
       CLA*    SYSCK2        INTERFACE 0.                               ARS00560
       ANA     =O17000000    UPDATE HSEL                                ARS00570
       PDX     ,4             BY GETTING                                ARS00580
       TXI     *+1,4,8576     UNIT ADDRESS                              ARS00590
       SXD     HSEL,4         OF CKPT TAPE.                             ARS00600
       CLA     SMSADR                                                   ARS00610
       STA*    (RCHXI        PREPARE TO READ.                           ARS00620
       TRA     HYPRED                                                   ARS00630
TP729  CLA     IOAD2                                                    ARS00640
       STA*    (RCHXI                                                   ARS00650
       CLA*    SYSCK2        GET ADDRESS OF I/O                         ARS00660
       ARS     18             UNIT AND MAKE                             ARS00670
       ORA     MASK           IT BINARY.                                ARS00680
       STA     *+1           SET TO                                     ARS00690
       RDS     **             READ.                                     ARS00700
HYPRED XEC*    (RCHXI                                                   ARS00710
SAVIT  AXT     **,4                                                     ARS00720
       AXT     **,1                                                     ARS00730
       TRA     1,4           RETURN.                                    ARS00740
SMINUS STI     SAVIND        SAVE INDICATORS.                           ARS00750
       LDI*    SYSCK2                                                   ARS00760
       LNT     20000         IS IT HYPER.                               ARS00770
       TRA     RDNTST        NO.                                        ARS00780
       STL     HYPER         YES.                                       ARS00790
       LDI     SAVIND        RESTORE INDICATORS.                        ARS00800
       TRA     LFT                                                      ARS00810
RDNTST LDI     SAVIND        RESTORE INDICATORS.                        ARS00820
       LNT     400000        IS IT NOISE.                            (4)ARS00830
       TXI     SAVIT+1,4,-1  YES                                     (4)ARS00840
       LFT     100000        NO, REDUNDANT                           (4)ARS00850
       TRA     FAILED        YES                                     (4)ARS00860
       TRA     UPDATE        NO.                                        ARS00870
LFT    LFT     000010        IS IT PERMANENT REDUNDANCY.                ARS00880
       TRA     FAILED        YES.                                       ARS00890
UPDATE AXT     **,1          NO                                         ARS00900
       TXI     *+1,1,4096                                               ARS00910
       SXA     UPDATE,1                                                 ARS00920
       SXA     IOCOM2,1                                                 ARS00930
       SXA     CPYD,1                                                   ARS00940
       TXH     SAVIT,1,0                                                ARS00950
       STZ     DELAY                                                    ARS00960
       STZ     1,2           RELEASE UNIT                               ARS00970
       TRA     SAVIT                                                    ARS00980
POSIT  LXA     GENPR,1       GET PHASE THAT CHECKPOINT WAS TAKEN IN.    ARS00990
       TXL     *+2,1,2       TRANSFER IF OUTPUT SIDE TO BE POSITIONED.  ARS01000
       STL     PH3           SET PHASE 3 INDICATOR TO POSITION INPUT.   ARS01010
       LXA     SAMPR-1,2                                                ARS01020
POS2   TSX     GTUCA,4                                                  ARS01030
       ZET     PH3           TEST FOR PHASE 3.                          ARS01040
       TRA     INPUT         WE ARE POSITIONING INPUT.                  ARS01050
       LDI     0,1           IF HYPERTAPE, INTERROGATE UCW4 FOR BOT.    ARS01060
       LNT     20000         HYPERTAPE IF ON.                           ARS01070
       TRA     POS           729.  USE CONTENTS OF UCW3 FOR POSITIONING.ARS01080
       CLA     3,1           CHECK HYPERTAPE UCW4.  CLOSE ROUTINE HAS   ARS01090
       TZE     SAVPOS         MADE IT ZERO IF TAPE WAS REWOUND.         ARS01100
INPUT  BSS     0                                                        ARS01110
POS    CAL     2,1           SAVE UCW3 FOR POSITIONING.                 ARS01120
SAVPOS SLW     UCW3+9,2                                                 ARS01130
       TXH     POS2,2,0                                                 ARS01140
       TSX     REWIND,4                                                 ARS01150
       LXA     SAMPR-1,2                                                ARS01160
POS3   TSX     GTUCA,4       WAIT FOR REWINDS ON ALL UNITS.             ARS01170
       ZET     1,1                                                      ARS01180
       TRA     *-1                                                      ARS01190
       TXH     POS3,2,0                                                 ARS01200
       LXA     SAMPR-1,2                                                ARS01210
POS4   CAL     UCW3+10,2                                                ARS01220
       STO     RAWPR-1                                                  ARS01230
       PXD     ,2                                                       ARS01240
       NZT     PH3                                                      ARS01250
       SSM                                                              ARS01260
       STO     RAWPR                                                    ARS01270
       CALL    SKIP                                                     ARS01280
       TIX     POS4,2,1                                                 ARS01290
       CLS     =0                                                       ARS01300
       STO     RAWPR                                                    ARS01310
       ZET     PH3           OPEN OUTPUT TAPE IF PH3.                   ARS01320
       CALL    IOPEN                                                    ARS01330
RETURN STL     DELAY                                                    ARS01340
       TRA*    GENPR-3       GO TO CHECKPOINT ROUTINE EXIT.             ARS01350
GTUCA  TXI     *+1,2,-1                                                 ARS01360
       CLA*    CHAPR-2       CHAPR-2 AND -3 HAVE TAGS OF 2.             ARS01370
       ZET     PH3           IF PHASE 3, WE ARE POSITIONING             ARS01380
       CLA*    CHAPR-3        INPUT TAPES.                              ARS01390
       PAC     ,1                                                       ARS01400
       TRA     1,4                                                      ARS01410
*  SUBROUTINE TO REWIND ALL TAPES -   RETURNS TO 1,4                    ARS01420
*                                                                       ARS01430
REWIND SXA     REW04,4                                                  ARS01440
       CAL     CHAPR-3                                                  ARS01450
       TSX     REW05,4                                                  ARS01460
       CAL     CHAPR-2                                                  ARS01470
       TSX     REW05,4                                                  ARS01480
REW04  AXT     **,4                                                     ARS01490
       TRA     1,4                                                      ARS01500
REW05  SXA     REW09,4                                                  ARS01510
       STA     REW07                                                    ARS01520
       PDX     ,2                                                       ARS01530
REW06  TXL     REW09,2,0                                                ARS01540
       TXI     *+1,2,-1                                                 ARS01550
       CAL*    REW07         TEST THE (UCB)                             ARS01560
       PAC     ,4                                                       ARS01570
       ZET     1,4                                                      ARS01580
       TRA     *-1                                                      ARS01590
       LDI     0,4                                                      ARS01600
       AXT     30,4                                                     ARS01610
       LNT     20000                                                    ARS01620
       AXT     3,4                                                      ARS01630
       SXD     REW07,4                                                  ARS01640
       TSX     (NDATA,4                                                 ARS01650
REW07  PZE     **,2,**                                                  ARS01660
       TRA     REW06                                                    ARS01670
REW09  AXT     **,4                                                     ARS01680
       TRA     1,4                                                      ARS01690
RSMES  BCI     2,SORT RESTART                                           ARS01700
FLMES  BCI     9,RESTART FAILED - CHKPNT MISSING OR UNREADABLE  *RS01   ARS01710
PH3    PZE                                                              ARS01720
ONE    DEC     1                                                        ARS01730
RWCS1  PZE     2,,-1                                                    ARS01740
IOAD2  PZE     IOCOM2                                                   ARS01750
IOCOM2 IORT    0,,4096                                                  ARS01760
SELADD PZE     0,,SELEC                                                 ARS01770
DELAY  PZE     *                                                        ARS01780
MASK   OCT     20                                                       ARS01790
SMS    SMS     70                                                       ARS01800
       CTLR    HSEL                                                     ARS01810
CPYD   CPYD    0,,4096                                                  ARS01820
       TCH     SYSTWT                                                   ARS01830
HSEL   OCT     120600120112                                             ARS01840
SMSADR PZE     SMS                                                      ARS01850
HYPER  PZE                                                              ARS01860
SAVIND                                                                  ARS01870
UCW3   BSS     10                                                       ARS01880
MUST   BOOL    2                                                        ARS01890
       EXTERN  MSGSUP                                                   ARS01900
       COMMON  17                                                       ARS01910
LABPR  COMMON  5                                                        ARS01920
CHAPR  COMMON  6                                                        ARS01930
       COMMON  76                                                       ARS01940
SAMPR  COMMON  7                                                        ARS01950
       COMMON  50                                                       ARS01960
GENPR  COMMON  10                                                       ARS01970
RAWPR  COMMON  30                                                       ARS01980
       END                                                              ARS01990
* 7090/7094 SORT VER 7 MOD 9 OPEN + CLOSE HOUSEKEEPING (729 ONLY)    (9)ASO00000
*      FAP
       COUNT   1100                                                     ASO00010
       SPACE                                                            ASO00020
       ENTRY   IOPEN                                                    ASO00030
       ENTRY   SCL                                                      ASO00040
       ENTRY   ADBCD1                                                   ASO00050
       ENTRY   SKIP                                                     ASO00060
       ENTRY   SAVEW                                                    ASO00070
       ENTRY   RESTW                                                    ASO00080
       ENTRY   SNDAT                                                    ASO00090
       ENTRY   MSGSUP                                                   ASO00100
       SST                                                              ASO00110
       SPACE                                                            ASO00120
       TITLE                                                            ASO00130
*  FILE OPEN AND CLOSE ROUTINES.  CALLING SEQ. IS CALL IOPEN (OR SCL)   ASO00140
*                                 REMAINDER OF CS IS IN RWCS.           ASO00150
       SPACE                                                            ASO00160
IOPEN  BSS     0                                                        ASO00170
       SXA     CLP1,1        SAVE                                       ASO00180
       SXA     CLP2,2         INDEX                                     ASO00190
       SXA     CLP4,4         REGISTERS.                                ASO00200
       TSX     OPEN,4        GO TO MAIN OPEN ROUTINE.                   ASO00210
       TRA     CLP1          EXIT FROM OPEN ROUTINE)                    ASO00220
 SCL   BSS     0                                                        ASO00230
       SXA     CLP1,1        SAVE                                       ASO00240
       SXA     CLP2,2         INDEX                                     ASO00250
       SXA     CLP4,4         REGISTERS.                                ASO00260
       TSX     CLOSE,4       GO TO MAIN CLOSE ROUTINE.                  ASO00270
CLP1   AXT     ,1            EXIT FROM OPEN OR CLOSE.                   ASO00280
CLP2   AXT     ,2                                                       ASO00290
CLP4   AXT     ,4                                                       ASO00300
       STL     GENPR-5                                                  ASO00310
       TRA     1,4           RETURN.                                    ASO00320
 CLOSE SXA     CL1,1         SAVE                                       ASO00330
       SXA     CL2,2          INDEX                                     ASO00340
       SXA     CL3,4          REGISTERS.                                ASO00350
       CLA     RWCS1         GET FILE NO. FROM CALLING SEQUENCE,        ASO00360
       PDX     ,2             AND SIGN ALSO TELLS IF INPUT OR OUTPUT.   ASO00370
       TXL     CL9,2,0       TRANSFER IF FILE NO. ZERO.                 ASO00380
       TXH     CL18,2,-2     TRANSFER IF FILE IS UNRT.                  ASO00390
       TXI     *+1,2,-1                                                 ASO00400
       TPL     CL4           FILE IS EITHER INTERMEDIATE MERGE TAPE OR  ASO00410
*                            EXTERNAL MERGE INPUT TAPE.  IS IT INPUT.   ASO00420
       CLA*    PR16          NO, OUTPUT FILE.  GET L(UCB),              ASO00430
       TSX     OP400,4        AND PREPARE TO WRITE EOF.                 ASO00440
       TSX     (NDATA,4      CALL NON-DATA SELECT TO                    ASO00450
       PZE     CL13,,WEF      WRITE EOF.                                ASO00460
       TRA     *+1           END-OF-TAPE RETURN.                        ASO00470
       TSX     (NDSLX,4      NOW REWIND THE TAPE                        ASO00480
       PZE     CL13,,REW                                                ASO00490
 CL1   AXT     ,1            RELOAD                                     ASO00500
 CL2   AXT     ,2             INDEX                                     ASO00510
 CL3   AXT     ,4             REGISTERS AND                             ASO00520
       STL     GENPR-5                                                  ASO00530
       TRA     1,4            EXIT FROM CLOSE ROUTINE.                  ASO00540
*  FILE IS INTERMEDIATE INPUT OR ELSE EXTERNAL MERGE INPUT.  IF MERGE   ASO00550
*   INPUT, WE MUST READ TRAILER LABEL AND REWIND.  IF INTERMEDIATE      ASO00560
*   INPUT, SIMPLY REWIND.                                               ASO00570
CL4    LDI     OPENCL        IS THIS INPUT                              ASO00580
       CAL     K1             FILE ALREADY CLOSED.                      ASO00590
       ALS     15,2                                                     ASO00600
       TIF     CL1           TRANSFER TO EXIT IF IT IS.                 ASO00610
       IIA                   SET IT CLOSED.                             ASO00620
       STI     OPENCL                                                   ASO00630
       CLA*    PR15          GET L(UCB) AND                             ASO00640
       TSX     OP400,4        SAVE.  ENSURE ACTIVITY COMPLETE.          ASO00650
       TPL     CL8           TRANSFER IF FILE IS INTERNAL MERGE INPUT.  ASO00660
       PDX     ,1            SAVE                                       ASO00670
       SXA     OPN76,1       L(FDB).                                    ASO00680
       LAC     OPN76,4                                                  ASO00690
       CLA     -3,4                                                     ASO00700
       PAX     ,2                                                       ASO00710
       STZ     LABCTL        RESET LABEL CONTROL INDICATOR.             ASO00720
       STZ     LASTR         RESET LAST-REEL INDICATOR.                 ASO00730
       TXH     CL005,2,1     SKIP IF NO LABELS.                         ASO00740
       CLA     (LTPOS        SAVE THE RECORD COUNT                      ASO00750
       STO     GEN07         FOR LABEL.                                 ASO00760
       CLA     -15,4         WORD 16 OF FILE DATA BLOCK IS              ASO00770
       TPL     CL045          MINUS IF REELS UNDER LABEL CONTROL,       ASO00780
       STL     LABCTL         INWHICH CASE SET LABEL CONTROL INDICATOR. ASO00790
 CL045 TSX     LABRW,4       READ TRAILER LABEL.                        ASO00800
       OCT     340000000000  NO EOF AFTER.  CHECK LABEL LENGTH.         ASO00810
       ZET     NOLAB                                                    ASO00820
       TRA     SETNOL        LABEL UNREADABLE.  INDICATE THIS.          ASO00830
       AXT     CTLMI,1       CHECK LABEL JUST READ.                     ASO00840
       CAL     OPN76                                                    ASO00850
       NZT     LAB20         WAS LABEL 14 WDS.                          ASO00860
       SSM                   NO. ASSUME THAT IT WAS 20.                 ASO00870
       CALL    LABEL                                                    ASO00880
       PZE     CL13                                                     ASO00890
       TSX     OP220,2                                                  ASO00900
       PZE     CL045,,1      ERROR RETRN TO CL045,,1 BSR.               ASO00910
       STI     EOFEOR        SAVE EOR OR EOF INDICATION.                ASO00920
 CL005 NZT     RELSW         TEST FOR REW OR RUN                        ASO00930
       TRA     CLR05         RUN                                        ASO00940
       TSX     (NDSLX,4      REWIND ONLY                                ASO00950
       PZE     CL13,,REW                                                ASO00960
       TRA     *+3                                                      ASO00970
 CLR05 TSX     (NDSLX,4      REWIND AND UNLOAD                          ASO00980
       PZE     CL13,,RUN                                                ASO00990
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             ASO01000
       TRA     TESTEF        YES.  TEST FOR LAST REEL.                  ASO01010
       LAC     OPN76,4       -L(FDB).                                   ASO01020
       CAL     -15,4         CHECK FOR MORE REELS.                      ASO01030
       CAS     -21,4                                                    ASO01040
       TRA     CL006         MORE REELS.                                ASO01050
       NOP                   SHOULDN'T NEED THIS, BUT LET'S BE SAFE.    ASO01060
CL055  LXA     CLP4,4        LAST REEL.  SET INDICATION                 ASO01070
       STL     2,4            IN CALLING PROGRAM.                       ASO01080
       TRA     CL1           EXIT.                                      ASO01090
CL006  LAC     OPN76,4                                                  ASO01100
       CAL     -14,4                                                    ASO01110
       TSX     (DECVA,4                                                 ASO01120
       STQ     CL300+5                                                  ASO01130
       LDQ*    CL13                                                     ASO01140
       TSX     MSGSUP,4,3                                               ASO01150
       PZE     CL300,,7+512*DBLSP                                       ASO01160
       ZET     RELSW         IF TAPE WAS NOT UNLOADED,                  ASO01170
       TSX     (PAUSE,4       WAIT FOR OPERATOR ACTION.                 ASO01180
       TRA     CL1           EXIT.                                      ASO01190
SETNOL STZ     EOFEOR        SET LABEL UNREADABLE.                      ASO01200
       TRA     CL005         IGNORE LABEL CHECKING.                     ASO01210
TESTEF CAL     EOFEOR        GET WORD FROM LABEL.                       ASO01220
       LAS     =H1EOF        COMPARE FOR LAST REEL.                     ASO01230
       TRA     *+2                                                      ASO01240
       TRA     CL055         LAST REEL.  GO SET INDICATOR.              ASO01250
       SUB     =H1EOR                                                   ASO01260
       TZE     CL006         SHOULD BE ZERO.  OTHERWISE, LABEL          ASO01270
       LDQ*    CL13           WAS UNREADABLE.  PRINT MESSAGE            ASO01280
       TSX     MSGSUP,4,3     FOR OPERATIOR ACTION AS TO WHETHER        ASO01290
       PZE     CL330,,6       HE WANTS TO CALL THIS THE LAST            ASO01300
       TSX     MSGSUP,4,2     REEL OR NOT.                              ASO01310
       PZE     1                                                        ASO01320
       PZE     CL340,,9+512*DBLSP                                       ASO01330
       TSX     C178.3,4      GO GET OPTION AND PRINT IT OUT.            ASO01340
       ZET     LASTR         WAS LAST-REEL INDICATOR SET IN             ASO01350
       TRA     CL055          THE PREVIOUS SUBROUTINE.                  ASO01360
       TRA     CL006         NO.  GO PRINT NEXT REEL LOAD MESSAGE.      ASO01370
       SPACE                                                            ASO01380
 CL8   TSX     (NDATA,4      FILE IS INTERNAL MERGE INPUT.              ASO01390
       PZE     CL13,,REW     REWIND IT.  CL13 CONTAINS L(UCB).          ASO01400
       TRA     CL1           GO TO EXIT.                                ASO01410
*  FILE IS EITHER ORIGINAL INPUT OR FINAL OUTPUT.  TEST FOR WHICH.      ASO01420
 CL9   TPL     CL14          IF FILE IS INPUT TO SORT PROGRAM.          ASO01430
       CAL*    PR16          FILE IS FINAL OUTPUT.  GET L(UCB).         ASO01440
       TSX     OP400,4                                                  ASO01450
       LAC     PR29,4        -L(FDB) FOR OUTPUT.                        ASO01460
       CAL     -15,4         UPDATE NO. OF OUTPUT                       ASO01470
       ADD     K1             REELS BY 1.                               ASO01480
       STA     -15,4                                                    ASO01490
       STA     CLCNT                                                    ASO01500
       CAL     -7,4          ADD                                        ASO01510
       SLW     CL260+4                                                  ASO01520
       TSX     ADBCD1,4       1 TO REEL SEQUENCE                        ASO01530
       LAC     PR29,4         NO. FOR                                   ASO01540
       STQ     -7,4          NEXT OUTPUT REEL.                          ASO01550
       LDQ*    OPN73                                                    ASO01560
       TSX     MSGSUP,4,3                                               ASO01570
       PZE     CL260,,6+512*DBLSP                                       ASO01580
       CLA     RWCS2         GET SIGN TO FLAG WHETHER CLOSING FINAL     ASO01590
       TPL     MORE           OUTPUT REEL OR NOT.  INITIALIZE GATE.     ASO01600
       CLS     CL11          SET GATE.                                  ASO01610
       STO     CL11                                                     ASO01620
 MORE  LAC     OPN73,4       GET -L(UCB) TO GET                         ASO01630
       CLA     2,4            BLOCK COUNT, GET -L(FDB)                  ASO01640
       LAC     PR29,4         TO PUT BLOCK COUNT                        ASO01650
       STA     -20,4          INTO WORD 21 OF FDB FOR LABEL ROUTINE.    ASO01660
       TSX     (NDSLX,4      WRITE EOF ON FINAL                         ASO01670
       PZE     CL13,,WEF      OUTPUT TAPE.                              ASO01680
       TXH     0,0,0         EOT RETURN.                                ASO01690
       LAC     PR29,4        GET 4TH WORD OF FDB.  CONTAINS             ASO01700
       CAL     -3,4           LABEL CODE.                               ASO01710
       PAX     ,2                                                       ASO01720
       TXH     CL10,2,1      TRANSFER IF NO LABELS.                     ASO01730
       AXT     PTLOR,1                                                  ASO01740
       CLA     CL11                                                     ASO01750
       TPL     *+2           IF FINAL OUTPUT REEL,                      ASO01760
       AXT     PTLFR,1        SET CALLING SEQUENCE                      ASO01770
       CLA     PR29           FOR PREPARATION ROUTINE.                  ASO01780
       LXA     LAB03,4       IF INPUT LABEL WAS 20                      ASO01790
       TXH     *+3,4,19       WDS, SSM.                                 ASO01800
       STL     LABST                                                    ASO01810
       TRA     *+2                                                      ASO01820
       SSM                                                              ASO01830
       CALL    LABEL         PREPARE LABEL.                             ASO01840
       PZE     CL13                                                     ASO01850
       STL     GENPR-4                                                  ASO01860
       TSX     LABRW,4       WRITE TRAILER LABEL.                       ASO01870
       IOSP    LAB03,,0                                                 ASO01880
       STZ     LABST          RESET SW.                                 ASO01890
 CL10  BSS     0                                                        ASO01900
 GATE1 TRA     *+1           GATE.  NEXT DONE ONLY ONCE.                ASO01910
       LXD     CHA02,4        NUMBER OF UNITS ASSIGNED FOR OUTPUT       ASO01920
       TXH     CL105,4,1      TEST FOR HIGHER THAN 1-WAY MERGE          ASO01930
       CLS     GATE2                                                    ASO01940
       STO     GATE2                                                    ASO01950
 CL105 BSS     0                                                        ASO01960
       SXD     CL113,4                                                  ASO01970
       TXI     *+1,4,-2                                                 ASO01980
       SXA     ORDPA,4        SAVE AS A PARAMETER.                      ASO01990
       STL     GATE1                                                    ASO02000
       CAL     PR16          COMPUTE BASE LOCATION OF                   ASO02010
       STA     LDQEN          OUTPUT TAPE TABLE.                        ASO02020
       ADD     K1                                                       ASO02030
       STA     CALEN                                                    ASO02040
 ORDPA AXT     **,4          MERGE ORDER MINUS 2.                       ASO02050
 CHGOR TXI     *+1,4,1       DECREMENT IS CLEARED IN CASE OF ISC,       ASO02060
       SXD     GOOUT,4        CAUSING 1 LESS TAPE TO BE ROTATED.        ASO02070
       AXT     1,4                                                      ASO02080
 CALEN CAL     **,4                                                     ASO02090
 LDQEN LDQ     **,4                                                     ASO02100
       STQ*    CALEN                                                    ASO02110
 GOOUT TXH     SLWEN,4,**                                               ASO02120
       TXI     LDQEN,4,1                                                ASO02130
 SLWEN SLW*    CALEN         TABLE IS ROTATED.                          ASO02140
 GATE2 TXL     ISCCK,0,0     GO TEST FOR INTER-SYSTEM                   ASO02150
 NOISC NZT     RELSW         TEST FOR REW OR RUN                        ASO02160
       TRA     NOISR         RUN                                        ASO02170
       TSX     (NDSLX,4      REWIND ONLY                                ASO02180
       PZE     OPN73,,REW                                               ASO02190
       TRA     *+3                                                      ASO02200
 NOISR TSX     (NDSLX,4      REWIND AND UNLOAD                          ASO02210
       PZE     OPN73,,RUN                                               ASO02220
 CL11  TXH     CL1,0,0       A GATE.  TXL IF LAST OUTPUT REEL.          ASO02230
       TSX     SAVEW,4                                                  ASO02240
       CLS     K0            NOT LAST.  GO OPEN NEW INPUT FILE.         ASO02250
       STO     RWCS1                                                    ASO02260
 CLCNT AXT     **,2          GET COUNT OF REELS DONE.                   ASO02270
       TXI     *+1,2,1                                                  ASO02280
 CL113 TXL     CL115,2,**                                               ASO02290
CL114  AXT     0,2           PRINT MESSAGE TO                           ASO02300
       CLA*    PR16           MAKE                                      ASO02310
       PAC     ,2             NEXT                                      ASO02320
       LDQ     0,2            UNIT                                      ASO02330
       TSX     MSGSUP,4,3     READY.                                    ASO02340
       PZE     CL270,,7+512*DBLSP                                       ASO02350
       TSX     MSGSUP,4,2                                               ASO02360
       PZE     1                                                        ASO02370
       PZE     CL271,,7+512*4                                           ASO02380
       TSX     (PAUSE,4                                                 ASO02390
 CL115 TSX     OPEN,4                                                   ASO02400
       TSX     RESTW,4                                                  ASO02410
       TRA     CL1            AND EXIT.                                 ASO02420
 ISCCK BSS     0                                                        ASO02430
       NZT     CHAPR-4       IS THE OUTPUT TO BE COMMUNICATED           ASO02440
       TRA     NOISC          TO ANOTHER SYSTEM WHICH FOLLOWS.          ASO02450
       TSX     (NDSLX,4      YES.  REWIND ONLY, AND                     ASO02460
       PZE     OPN73,,REW     SET PARAMETER FOR ROTATION OF             ASO02470
       SXD     CHGOR,0        1 LESS TAPE IN TABLE.                     ASO02480
       TRA     CL11                                                     ASO02510
 CL13  PZE                   UCB ADDRESS KEPT HERE.                     ASO02520
*  FILE TO BE CLOSED IS EXTERNAL SORT INPUT.                            ASO02530
 CL14  CAL*    PR14          GET L(UCB) AND SAVE.                       ASO02540
       TSX     OP400,4                                                  ASO02550
       ALS     1                                                        ASO02560
       PBT                   IS THIS UNIT TO BE USED FOR MERGE.         ASO02570
       TRA     *+3           NO.                                        ASO02580
       ARS     1                                                        ASO02590
       STA     MRGSW         SAVE L(UCB) FOR FUTURE MERGE UNIT.         ASO02600
       NZT     OPENCL        IS THIS FILE ALREADY CLOSED.               ASO02610
       TRA     CL1           YES.  EXIT.                                ASO02620
       STZ     OPENCL        SET THIS FILE CLOSED.                      ASO02630
       LAC     PR20,4        PREPARE TO READ TRAILER LABEL, IF ONE.     ASO02640
       CLA     -3,4          GET LABEL INDICATOR.                       ASO02650
       PAX     ,1                                                       ASO02660
       NZT     OVFLS                                                    ASO02670
       TRA     CL15                                                     ASO02680
       TXH     CL15,1,1      TRANSFER IF NO LABEL.                      ASO02690
       CLA     (LTPOS        SAVE THE RECORD COUNT                      ASO02700
       STO     GEN07         FOR LABEL.                                 ASO02710
       CLA     -15,4         IF WORD 16 OF FILE DATA BLOCK IS           ASO02720
       TPL     *+2            MINUS, SET INDICATION THAT REELS          ASO02730
       STL     LABCTL         ARE UNDER LABEL CONTROL.                  ASO02740
       STL     GENPR-4                                                  ASO02750
 CL145 TSX     LABRW,4       READ TRAILER LABEL.                        ASO02760
       OCT     340000000000  NO EOF AFTER.  CHECK LABEL LENGTH.         ASO02770
       AXT     CTLSI,1                                                  ASO02780
       ZET     NOLAB                                                    ASO02790
       TRA     C178.0        IF LABEL WAS NOT READABLE, GIVE OPTION.    ASO02800
       CLA     PR20          GET L(FDB).                                ASO02810
       NZT     LAB20         WAS LABEL 14 WDS.                          ASO02820
       SSM                   NO. ASSUME THAT IT WAS 20.                 ASO02830
       CALL    LABEL         CHECK TRAILER LABEL.                       ASO02840
       PZE     CL13          INDIRECT ADDRESS OF L(UCB).                ASO02850
       TSX     OP220,2       TO BACKSPACE ROUTINE IF TROUBLE.           ASO02860
       PZE     CL145,,1      RETURN ADDRESS,,BACKSPACE 1 RECORD.        ASO02870
       STI     EOFEOR        SAVE 1ST WORD OF LABEL.                    ASO02880
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             ASO02890
       TRA     C178.4        YES.  GO SAVE INDICATION OF WHICH REEL.    ASO02900
 CL15  NZT     RELSW         TEST FOR REW AND RUN                       ASO02910
       TRA     CL15R         RUN                                        ASO02920
       TSX     (NDATA,4      REWIND SORT                                ASO02930
       PZE     CL13,,REW       INPUT FILE                               ASO02940
       TRA     *+3                                                      ASO02950
 CL15R TSX     (NDATA,4      REWIND AND UNLOAD                          ASO02960
       PZE     CL13,,RUN      INPUT FILE.                               ASO02970
       NZT     OVFLS                                                    ASO02980
       TRA     CL17                                                     ASO02990
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             ASO03000
       TRA     C178.6        YES.  CHECK FOR LAST REEL.                 ASO03010
       LAC     PR20,4        CHECK FOR MORE REELS.                      ASO03020
       CLA     -15,4         GET NO. OF INPUT REELS.                    ASO03030
       LAS     -21,4         COMPARE WITH NO. PROCESSED SO FAR.         ASO03040
       TRA     CL175         NOT THE LAST.                              ASO03050
*  NO MORE INPUT REELS FOR SORT.  PRINT MESSAGE AND EXIT FROM CLOSE.    ASO03060
 CL17  LDQ*    CL13                                                     ASO03070
       LXA     CLP4,4        GIVE FINAL REEL INDICATION TO              ASO03080
       STL     2,4            MAIN PROGRAM.                             ASO03090
       TSX     MSGSUP,4,5    IF HIST OPTION WAS SPECIFIED,PRINT UNIT XX ASO03100
       PZE     CL25,,4+512*DBLSP WAS FINAL REEL OF INPUT.               ASO03110
       NZT     MRGSW         IS AN INPUT UNIT TO BE USED FOR MERGE.     ASO03120
       TRA     CL1           NO.  EXIT.                                 ASO03130
       LDQ*    MRGSW         PRINT ''UNIT XX TO BE USED FOR MERGING.    ASO03140
       TSX     MSGSUP,4,3    LOAD THIS UNIT WITH A SCRATCH TAPE.        ASO03150
       PZE     CL320,,5+512*SNGLS                                       ASO03160
       TSX     MSGSUP,4,2                                               ASO03170
       PZE     1                                                        ASO03180
       PZE     CL310,,6+512*DBLSP                                       ASO03190
       ZET     RELSW         WAS THIS REEL UNLOADED.  EXIT IF SO.       ASO03200
       TSX     (PAUSE,4      GIVE OPERATOR CHANCE TO CHANGE REELS.      ASO03210
       TRA     CL1           EXIT FROM CLOSE ROUTINE.                   ASO03220
 MRGSW PZE                   NZ=INPUT UNIT TO BE SED UN MERGE.          ASO03230
 CL175 LDQ*    CL13                                                     ASO03240
       TSX     MSGSUP,4,3    PRINT --UNIT XX...EOF SORT INPUT REEL.     ASO03250
       PZE     CL23,,6+512*SNGLS LOAD NEXT REEL ON''                    ASO03260
       LAC     PR14,4        SWITCH REELS IF MORE THAN 1 DRIVE.         ASO03270
       CLA     -1,4                                                     ASO03280
       TZE     CL176         NO SWITCH - ONLY 1 DRIVE.                  ASO03290
       LDQ     0,4                                                      ASO03300
       STQ     -1,4                                                     ASO03310
       STO     0,4                                                      ASO03320
       CAL     CNT19         SWITCH RELEASE BITS IN CASE             (7)ASO03321
       LGR     1              INPUT IS ON                            (7)ASO03322
       STA     CNT19          INTERSYSTEM RESERVE UNITS              (7)ASO03323
       ZAC                    THIS WILL KEEP                         (7)ASO03324
       LGL     1              RELEASE BITS                           (7)ASO03325
       ALS     1              ASSOCIATED WITH                        (7)ASO03326
       ORS     CNT19          THE PROPER UNITS                       (7)ASO03327
       CLA     0,4                                                   (7)ASO03328
       LDQ     -1,4                                                  (7)ASO03329
       TSX     OP400,4       CHANGE L(UCW).                             ASO03330
 CL176 LDQ*    CL13                                                     ASO03340
       TSX     MSGSUP,4,3                                               ASO03350
       PZE     CL24,,2+512*DBLSP                                        ASO03360
       TRA     CL1                                                      ASO03370
C178.0 NZT     LABCTL        ARE REELS UNDER LABEL CONTROL.             ASO03380
       TRA     CL15          NO.  IGNORE FAILURE TO READ LABEL.         ASO03390
C178.2 LDQ*    UCWIT         PRINT-TRAILER LABEL UNREADABLE.  IF MORE   ASO03400
       TSX     MSGSUP,4,3     INPUT REELS, PUT SW3 DOWN.  IF NO MORE    ASO03410
       PZE     CL330,,6       REELS, PUT SS3 UP--PRESS START.           ASO03420
       TSX     MSGSUP,4,2                                               ASO03430
       PZE     1                                                        ASO03440
       PZE     CL340,,9+512*DBLSP                                       ASO03450
       TSX     C178.3,4                                                 ASO03460
       TRA     CL15          GO REWIND.                                 ASO03470
C178.3 SXA     SAVE4,4                                                  ASO03480
       TSX     (PAUSE,4                                                 ASO03490
       SWT     3                                                        ASO03500
       TRA     SETL          OPERATOR SAYS NO MORE REELS.               ASO03510
       TSX     MSGSUP,4,2    PRINT MESSAGE THAT                         ASO03520
       PZE     1              SWITCH 3 IS SET.                          ASO03530
       PZE     CL350,,3+512*DBLSP                                       ASO03540
       TRA     SAVE4                                                    ASO03550
SETL   TSX     MSGSUP,4,2    PRINT MESSAGE THAT SWITCH                  ASO03560
       PZE     1              3 IS UP.                                  ASO03570
       PZE     CL360,,3+512*DBLSP                                       ASO03580
       STL     LASTR         INDICATE NO MORE REELS OF INPUT.           ASO03590
SAVE4  AXT     **,4                                                     ASO03600
       TRA     1,4                                                      ASO03610
C178.4 CAL     EOFEOR        GET 1ST WORD FROM TRAILER LABEL.           ASO03620
       LAS     =H1EOF                                                   ASO03630
       TRA     *+2                                                      ASO03640
       TRA     SETLST        LABEL SAYS THIS IS LAST REEL.              ASO03650
       SUB     =H1EOR                                                   ASO03660
       TZE     CL15          IF LABEL IS UNREADABLE,                    ASO03670
       TRA     C178.2         GO GET CHOICE FROM OPERATOR.              ASO03680
C178.6 ZET     LASTR         IS THIS THE LAST REEL.                     ASO03690
       TRA     CL17          YES.                                       ASO03700
       TRA     CL175         NO.  PRINT NEXT LOAD MESSAGE.              ASO03710
SETLST STL     LASTR         SET LAST REEL INDICATOR.                   ASO03720
       TRA     CL15          GO REWIND.                                 ASO03730
LABCTL PZE                   SET NON-ZERO IF UNDER LABEL CONTROL.       ASO03740
LASTR  PZE                   SET NON-ZERO IF THIS IS LAST REEL.         ASO03750
EOFEOR PZE                   HOLDS 1ST WORD OF LABEL.                   ASO03760
*  UNIT TO BE CLOSED IS UNREADABLE RECORD AND CHECKPOINT TAPE.          ASO03770
       SPACE   1                                                        ASO03780
CL18   LXA     SYSCK2,4      IS THERE A SYSCK2.                         ASO03790
       TXL     CL1,4,0       EXIT IF NOT ATTACHED.                      ASO03800
       TSX     (NDSLX,4      REWIND AND                                 ASO03810
       PZE     UNRT,,REW                                                ASO03820
       TRA     CL1           EXIT.                                      ASO03830
 CL23  BCI     6, EOF INPUT REEL.  LOAD NEXT REEL ON                    ASO03840
 CL24  BCI     2, .     *IN01                                           ASO03850
CL25   BCI     4, WAS FINAL REEL OF INPUT                               ASO03860
 CL260 BCI     6, CLOSING OUTPUT REEL NO.       *OU01                   ASO03870
 CL270 BCI     7, MAKE READY FOR NEXT OUTPUT REEL.    *OU02             ASO03880
 CL271 BCI     7, WHEN BLANK REEL IS LOADED, PRESS START.               ASO03890
 CL300 BCI     7, LOAD NEXT REEL OF MERGE FILE  XXXXX *MR02             ASO03900
 CL310 BCI     6, LOAD THIS UNIT WITH A SCRATCH TAPE.                   ASO03910
 CL320 BCI     5, TO BE USED FOR MERGING  *MR01                         ASO03920
 CL330 BCI     6, TRAILER LABEL UNREADABLE.    *IN02                    ASO03930
 CL340 BCI     9, IF LAST REEL,SET SS3 UP. IF NOT.SET SS3 DOWN.--START. ASO03940
 CL350 BCI     3, (SS3 IS SET DOWN)                                     ASO03950
 CL360 BCI     3, (SS3 IS SET UP)                                       ASO03960
 SDNL  EQU     1                                                        ASO03970
 SDNH  EQU     2                                                        ASO03980
 REW   EQU     3                                                        ASO03990
 RUN   EQU     4                                                        ASO04000
 BSR   EQU     5                                                        ASO04010
 BSF   EQU     6                                                        ASO04020
 WEF   EQU     7                                                        ASO04030
 DBLSP EQU     4                                                        ASO04040
       EJECT                                                            ASO04050
*  SORT FILE OPENING ROUTINE.                                           ASO04060
OPEN   SXA     OPN13,1       SAVE                                       ASO04070
       SXA     OPN15,2       INDEX                                      ASO04080
       SXA     OPN17,4       REGISTERS.                                 ASO04090
       CLA     RWCS1         GET CALLING SEQUENCE WORD NO. 1.           ASO04100
       PDX     ,2            LOGICAL FILE NO.                           ASO04110
       TXL     OPN23,2,0     TRANSFER IF EXTERNAL INPUT OR OUTPUT FILE. ASO04120
       TXH     OPN57,2,-2    TRANSFER IF UNRT.  OTHERWISE, OPEN         ASO04130
*                             MERGE FILE.                               ASO04140
       EJECT                                                            ASO04150
*  FILE IS A MERGE FILE.                                                ASO04160
       TXI     *+1,2,-1                                                 ASO04170
       TMI     OPN21         MERGE FILE.  IS THIS OUTPUT.               ASO04180
       LDI     OPENCL        NO, INPUT. IS THIS FILE                    ASO04190
       CAL     K1             ALREADY OPENED.                           ASO04200
       ALS     15,2          TRANSFER TO EXIT IF                        ASO04210
       TIO     OPN13          IT IS.                                    ASO04220
       OAI                   SET THIS FILE OPENED.                      ASO04230
       STI     OPENCL                                                   ASO04240
       CLA*    PR15          GET L(UCB) AND SAVE.                       ASO04250
       TSX     OP400,4       IF FILE IS EXTERNAL MERGE INPUT,           ASO04260
       TMI     OPN18          TRANSFER TO OPEN IT.                      ASO04270
*                                                                       ASO04280
*  FILE IS INTERNAL INTERMEDIATE INPUT.                                 ASO04290
 OP120 TSX     (NDSLX,4      FILE IS INTERNAL.  SET DENSITY HIGH.       ASO04300
       PZE     OPN73,,SDNH                                              ASO04310
       TSX     (NDSLX,4                                                 ASO04320
       PZE     OPN73,,REW                                               ASO04330
       STL     GENPR-4                                                  ASO04340
       TSX     LABRW,4       READ HEADER LABEL, INTERNAL FILE.          ASO04350
       PZE                                                              ASO04360
       ZET     NOLAB                                                    ASO04370
       TRA     OP125                                                    ASO04380
       AXT     CHLMI,1       PREPARE CS FOR LABEL CHECK.                ASO04390
       CALL    LABEL         GO TO CHECK LABEL.                         ASO04400
       PZE     OPN73                                                    ASO04410
       TSX     OP220,2       RETURN HERE MEANS READ LABEL AGAIN, I.E.,  ASO04420
       PZE     OP120,,2       BACKSPACE AND GO TO OP120.                ASO04430
 OP125 CLA     K1            INITIALIZE SEQUENCE                        ASO04440
       LDI     RWCS2                                                    ASO04450
       ONT     =O777777777777                                           ASO04460
       STA*    OPN73          COUNT.                                    ASO04470
       TRA     OP215         GO SET MODE BINARY.                        ASO04480
 OPN13 AXT     **,1          RELOAD                                     ASO04490
 OPN15 AXT     **,2           INDEX                                     ASO04500
 OPN17 AXT     **,4           REGISTERS                                 ASO04510
       STL     GENPR-5                                                  ASO04520
       TRA     1,4            AND EXIT.                                 ASO04530
       SPACE   2                                                        ASO04540
*  ROUTINE TO SET DENSITY HIGH OR LOW.                                  ASO04550
       SPACE   1                                                        ASO04560
 OP175 AXT     SDNL,1                                                   ASO04570
       NZT     -4,4                                                     ASO04580
       AXT     SDNH,1                                                   ASO04590
       SXD     *+2,1                                                    ASO04600
       TSX     (NDSLX,4                                                 ASO04610
       PZE     OPN73,,**                                                ASO04620
       TRA     1,2                                                      ASO04630
       SPACE   1                                                        ASO04640
*  FILE IS EXTERNAL MERGE INPUT.                                        ASO04650
 OPN18 BSS     0                                                        ASO04660
       PDX     ,2                                                       ASO04670
       SXA     OPN76,2                                                  ASO04680
       PDC     ,1            PUT CORRECT-MODE ADDRESS IN                ASO04690
       TSX     SETMD,4        UCW4.                                     ASO04700
       TSX     (NDSLX,4                                                 ASO04710
       PZE     OPN73,,REW                                               ASO04720
       LAC     OPN76,4       SET LABEL DENSITY.                         ASO04730
       TSX     OP175,2                                                  ASO04740
       LAC     OPN76,4                                                  ASO04750
       CLA     -3,4                                                     ASO04760
       PAX     ,2                                                       ASO04770
       CAL     -21,4         UPDATE NO. OF INPUT                        ASO04780
       ADD     K1             REELS PROCESSED ON                        ASO04790
       STO     -21,4          THIS FILE.                                ASO04800
       TXH     OP186,2,1     SKIP NEXT IF NO LABELS.                    ASO04810
       SXA     LABTYP,2                                                 ASO04820
       TXH     *+2,2,0                                                  ASO04830
       STL     LABTYP                                                   ASO04840
 OP185 TSX     LABRW,4       READ HEADER W/EOF AFTER.                   ASO04850
       OCT     040000000000  ENABLE FOR LABEL LENGTH CHECK.             ASO04860
       ZET     NOLAB                                                    ASO04870
       TRA     OP186                                                    ASO04880
       AXT     CHLEI,1       CHECK HEADER LABEL.                        ASO04890
       CAL     OPN76                                                    ASO04900
       NZT     LAB20         WAS LABEL 14 WDS.                          ASO04910
       SSM                   NO.  ASSUME THAT IT WAS 20.                ASO04920
       CALL    LABEL                                                    ASO04930
       PZE     OPN73                                                    ASO04940
       TSX     OP220,2                                                  ASO04950
       PZE     OP185,,2                                                 ASO04960
       LAC     OPN76,2       UPDATE REEL                                ASO04970
       CAL     -7,2           SEQUENCE NO.                              ASO04980
       TZE     OP186             (ONLY IF NONZERO)                      ASO04990
       TSX     ADBCD1,4       BY 1.                                     ASO05000
       STQ     -7,2          PUT BACK INTO FILE BLOCK.                  ASO05010
 OP186 LAC     OPN76,4                                                  ASO05020
       TXI     *+1,4,-3                                                 ASO05030
       TSX     OP175,2       SET FILE DENSITY.                          ASO05040
       LAC     OPN76,4                                                  ASO05050
       CAL     -17,4         TEST FOR CHECKPOINT FILE.                  ASO05060
       CAS     K1                                                       ASO05070
       TRA     NCKPT         NONE.                                      ASO05080
       TRA     OP189         NONSTANDARD.                               ASO05090
 OP188 TXL     BYPAS,0,0     STANDARD.  BYPASS ON 1ST REEL.             ASO05100
 OP189 TSX     SAVEW,4       SKIP CHECKPOINT-FILE.                      ASO05110
       CAL     =O1000000                                                ASO05120
       STO     RWCS2                                                    ASO05130
       TSX     SKIP,4                                                   ASO05140
 NCKPT TRA     OPN13                                                    ASO05150
 BYPAS CLS     OP188                                                    ASO05160
       STO     OP188                                                    ASO05170
       TRA     OPN13                                                    ASO05180
 OPN21 CLA*    PR16          THIS IS INTERMEDIATE OUTPUT FILE.  GET     ASO05190
       TSX     OP400,4        L(UCW) IN ORDER TO SET THE                ASO05200
       TSX     (NDATA,4       DENSITY AND THE MODE, REWIND, AND         ASO05210
       PZE     OPN73,,REW     WRITE THE HEADER LABEL.  REWIND HERE.     ASO05220
       TSX     (NDSLX,4      SET DENSITY HIGH.                          ASO05230
       PZE     OPN73,,SDNH                                              ASO05240
       AXT     PHLMO,1       PREPARE HEADER LABEL                       ASO05250
       CALL    LABEL          FOR INTERMEDIATE FILE.                    ASO05260
       PZE     OPN73                                                    ASO05270
       STL     GENPR-4                                                  ASO05280
       TSX     LABRW,4       WRITE THE LABEL.                           ASO05290
       MZE                                                              ASO05300
 OP215 AXC     *,1           PUT BINARY MODE UNIT ADDRESS               ASO05310
       TSX     SETMD,4        IN UCW4.                                  ASO05320
       TRA     OPN13         EXIT.                                      ASO05330
       SPACE   1                                                        ASO05340
*  ROUTINE TO PUT CORRECT-MODE TAPE ADDRESS INTO UCW4.                  ASO05350
 SETMD LAC     OPN73,2                                                  ASO05360
       CAL     0,2                                                      ASO05370
       ZET     0,1           TEST FILE BLOCK MODE INDICATOR.            ASO05380
       ORA     =O20000000                                               ASO05390
       ARS     18                                                       ASO05400
       ANA     =O17777                                                  ASO05410
       STA     3,2                                                      ASO05420
       TRA     1,4                                                      ASO05430
       SPACE   3                                                        ASO05440
*  ROUTINE TO BACKSPACE FOR REREADING LABEL.  ENTER                     ASO05450
*   WITH TSX   OP220,2.  L(L(UCB)) IS IN -1,2 AND RETURN IS INDIRECT    ASO05460
*   ADDRESS GIVEN IN 1,2.  NO. OF RECORDS TO BACKSPACE IN DECR(1,2).    ASO05470
       SPACE                                                            ASO05480
 OP220 CAL     -1,2          INITIALIZE CALLING SEQUENCE WITH           ASO05490
       STA     OP222          L(L(UCB)).                                ASO05500
       CLA     1,2           GET NO. OF RECORDS TO BACKSPACE            ASO05510
       PDX     ,1             AND PLACE IN IR1.                         ASO05520
       TXL     OP223,1,0                                                ASO05530
 OP221 TSX     (NDSLX,4      GO TO BACKSPACE RECORD.                    ASO05540
 OP222 PZE     **,,BSR                                                  ASO05550
       TIX     OP221,1,1     DO AS MANY AS REQUESTED.                   ASO05560
 OP223 TRA*    1,2           RETURN.                                    ASO05570
       EJECT                                                            ASO05580
*  FILE IS EITHER SORT INPUT OR FINAL OUTPUT.                           ASO05590
 OPN23 TPL     OPN43         EXTERNAL FILE.  IS IT INPUT.               ASO05600
OPN24  TRA     *+1                                                      ASO05610
*                            NO, OUTPUT.  SET UP FINAL OUTPUT REFERENCE ASO05620
       CAL     CHA01          CELL.  IF CHA04 INDICATES THAT            ASO05630
       LDQ     CHA02                                                    ASO05640
       TZE     OPN25          OUTPUT IS ON SYMBOLIC CHANNEL, DO         ASO05650
       NZT     CHA04          NOT CHANGE CHA02.  USE MERGE CHANNEL      ASO05660
       XCL                                                              ASO05670
       SLW     CHA01          FOR OUTPUT, INSTEAD.                      ASO05680
       STQ     CHA02                                                    ASO05690
OPN25  STL     OPN24                                                    ASO05700
       CLA*    CHA02         GET TAPE IN NO. 1 POSITION.                ASO05710
       SPACE   1                                                        ASO05720
*  EXTERNAL OUTPUT FILE HAS BEEN FOUND.  CONTINUE OPENING WITH REWIND.  ASO05730
       SPACE   1                                                        ASO05740
       TSX     OP400,4       INITIALIZE L(UCB) FOR NDATA.               ASO05750
       TSX     (NDATA,4      GO TO REWIND OUTPUT TAPE.                  ASO05760
       PZE     OPN73,,REW                                               ASO05770
       LAC     PR29,4        SET LABEL                                  ASO05780
       TSX     OP175,2        DENSITY.                                  ASO05790
       LAC     PR29,4                                                   ASO05800
       NZT     -10,4         IS DICTIONARY SPECIFIED FOR OUTPUT.        ASO05810
       STZ     OP800         NO.  SET NO-DICTIONARY SWITCH.             ASO05820
       CLA     -3,4                                                     ASO05830
       PAX     ,2                                                       ASO05840
       TXH     OP295,2,1     SKIP LABELING.                             ASO05850
       TXH     *+2,2,0       IF STD. LABES, SET SWITCH                  ASO05860
       STL     LABST          TO NON-ZERO.                              ASO05870
       AXT     PHLFO,1                                                  ASO05880
 OP270 CAL     PR29                                                     ASO05890
       LXA     LAB03,4       IF INPUT LABEL WAS 20                      ASO05900
       TXH     *+2,4,19       WDS.  SSM.                                ASO05910
       TRA     *+2                                                      ASO05920
       SSM                                                              ASO05930
       CALL    LABEL         PREPARE HEADER LABEL FOR FINAL OUTPUT.     ASO05940
       PZE     OPN73                                                    ASO05950
       CAL     *                                                        ASO05960
       ZET     OP800         ARE THERE DICTIONARIES.                    ASO05970
       ALS     3             YES.  SET NO EOF AFTER LABEL.              ASO05980
       STP     OP294                                                    ASO05990
       STL     GENPR-4                                                  ASO06000
       TSX     LABRW,4       WRITE HEADER LABEL.                        ASO06010
OP294  PZE     LABPR-3       POINT TO WORD CONTAINING LENGTH.           ASO06020
       STZ     LABST          RESET SW.                                 ASO06030
 OP295 NZT     OP800         ARE THERE DICTIONARIES.                    ASO06040
       TRA     OP300          NO.  SKIP DICTIONARY RETRIEVE.            ASO06050
       STZ     OP800         RESET DICTIONARY INDICATION FOR FUTURE REELASO06060
       TSX     (NDSLX,4      REWIND CKPT TAPE.                          ASO06070
       PZE     SYSCK2,,REW                                              ASO06080
       AXT     -1,4          POSITION CKPT TAPE AFTER 2ND FILE.         ASO06090
       SXD     RWCS1,4       SET CALLING SEQ. TO SKIP 2                 ASO06100
       CLA     =O2000000                                                ASO06110
       SLW     RWCS2                                                    ASO06120
       TSX     SKIP,4        SKIP THE TWO FILES.                        ASO06130
       STL     GENPR-4                                                  ASO06140
       TSX     DCTNY,4       RETRIEVE DICTIONARY RECORDS.               ASO06150
       PZE     UNRT,,OPN73                                              ASO06160
 OP300 LAC     PR29,1        PUT CORRECT-MODE UNIT ADDRESS              ASO06170
       TSX     SETMD,4        INTO UCW4.                                ASO06180
       LAC     PR29,4                                                   ASO06190
 OP320 TXI     *+1,4,-3                                                 ASO06200
       TSX     OP175,2       SET FILE DENSITY.                          ASO06210
       TRA     OPN13         EXIT.                                      ASO06220
       SPACE   1                                                        ASO06230
*                                                                       ASO06240
*  ROUTINE TO WAIT FOR COMPLETION OF ACTIVITY.                          ASO06250
 OP400 SXA     OP405,4                                                  ASO06260
       STA     UCWIT         SAVE L(UCW).                               ASO06270
       PAI                                                              ASO06280
       RIS     =O677777777777                                           ASO06290
       STI     RELSW         SAVE RELEASE INDICATOR.                    ASO06300
       PAC     ,4                                                       ASO06310
       ZET     1,4           TEST UCW2 FOR ZERO.                        ASO06320
       TRA     *-1           UNIT IS BUSY.                              ASO06330
 OP405 AXT     **,4                                                     ASO06340
       STL     GENPR-5                                                  ASO06350
       TRA     1,4                                                      ASO06360
 RELSW PZE                   RELEASE SWITCH IN PREFIX                   ASO06370
       SPACE   2                                                        ASO06380
*  CALLING SEQUENCE SAYS TO OPEN AN INPUT FILE.                         ASO06390
 OPN43 CAL*    PR14          GET L(UCB) FOR INPUT FILE.                 ASO06400
       TSX     OP400,4       SET UP FOR REWIND.                         ASO06410
       ZET     OPENCL        IS THIS FILE ALREADY OPENED.               ASO06420
       TRA     OPN13         YES-EXIT.                                  ASO06430
       STL     OPENCL        SET THIS FILE OPENED.                      ASO06440
       TSX     (NDATA,4      GO TO NON-DATA SELECT ROUTINE              ASO06450
       PZE     OPN73,,3       TO REWIND THIS TAPE.                      ASO06460
 OP435 LAC     PR20,4                                                   ASO06470
       CAL     -3,4          GET LABEL INDICATOR FROM FILE BLOCK        ASO06480
       PAX     ,2             TO ASK WHETHER LABELS OR NOT.             ASO06490
       TXH     OPN45,2,1     TRANSFER AROUND FOLLOWING IF NO LABEL.     ASO06500
       SXA     LABTYP,2                                                 ASO06510
       TXH     *+2,2,0                                                  ASO06520
       STL     LABTYP                                                   ASO06530
       PXD     ,0                                                       ASO06540
       ZET     OVEPR         IF THIS IS OVERFLOW SORT, THIS             ASO06550
       TRA     OP441          CANNOT BE THE 1ST REEL.                   ASO06560
       ZET     -10,4         TEST FOR DICTIONARIES.                     ASO06570
 OP440 CAL     OP320         GET PREFIX OF 1.                           ASO06580
 OP441 STP     OP445                                                    ASO06590
       TSX     OP175,2       SET LABEL DENSITY.                         ASO06600
       STL     GENPR-4                                                  ASO06610
       TSX     LABRW,4       READ HEADER LABEL.                         ASO06620
 OP445 OCT     040000000000  ENABLE LABEL LENGTH CHECK.                 ASO06630
       ZET     NOLAB                                                    ASO06640
       TRA     OP447                                                    ASO06650
       AXT     CHLSI,1                                                  ASO06660
       CLA     PR20          GET FDB ADDRESS FOR LABEL CHECK.           ASO06670
       NZT     LAB20         WAS LABEL 14 WDS.                          ASO06680
       SSM                   NO.  ASSUME THAT IT WAS 20.                ASO06690
       CALL    LABEL         CHECK LABEL JUST READ.                     ASO06700
       PZE     OPN73                                                    ASO06710
       TSX     OP220,2       RETURN HERE IF TROUBLE.                    ASO06720
       PZE     OP435,,2      BACKSPACE AND GO TO OP435.                 ASO06730
 OP447 AXT     K0,4          LABELS FINISHED.  SET NO DICTIONARY        ASO06740
       SXA     OP440,4        HEREAFTER.                                ASO06750
 OPN45 LAC     PR20,1                                                   ASO06760
       TSX     SETMD,4                                                  ASO06770
       LAC     PR20,4                                                   ASO06780
       CAL     -7,4          GET REEL SEQUENCE NO.                      ASO06790
       TZE     OP453         IF ZERO, MUST REMAIN SO.                   ASO06800
       TSX     ADBCD1,4      ADD 1.                                     ASO06810
       LAC     PR20,4        PUT NEW SEQUENCE NUMBER                    ASO06820
       STQ     -7,4           INTO FILE DATA BLOCK.                     ASO06830
OP453  CAL     -21,4         UPDATE NO.                                 ASO06840
       ADD     K1             OF REELS PROCESSED                        ASO06850
       STO     -21,4          BY 1.                                     ASO06860
       PAX     ,2            KEEP THIS REEL NO. IN XR2.                 ASO06870
       CLA     -17,4         CKPT INDICATOR TO AC.                      ASO06880
       PAX     ,1            CKPT INDICATOR TO IR1.                     ASO06890
       TXI     *+1,1,-2      -2, STANDARD. -1, NONSTANDARD. 0, NONE.    ASO06900
       ZET     OVEPR         SKIP IF NOT OVERFLOW SORT.                 ASO06910
       TRA     OP455         OVERFLOW SORT.                             ASO06920
       TXH     OP485,2,1     TRANSFER IF NOT 1ST REEL.                  ASO06930
       ZET     -10,4         1ST REEL.  TEST FOR DICTIONARY.            ASO06940
       TRA     OP560         YES.  GO SAVE DICTIONARY.                  ASO06950
 OP455 TXL     OP480,1,-2    TRANSFER IF NOT NON-STANDARD CKPT.         ASO06960
 OP456 LAC     PR20,4                                                   ASO06970
       TXI     *+1,4,-3                                                 ASO06980
       TSX     OP175,2       SET FILE DENSITY.                          ASO06990
       CAL     =O1000000                                                ASO07000
       STO     RWCS2                                                    ASO07010
       STZ     RWCS1                                                    ASO07020
       TSX     SKIP,4        SKIP CKPT FILE.                            ASO07030
 OP480 LAC     PR20,4                                                   ASO07040
       TXI     *+1,4,-3                                                 ASO07050
       TSX     OP175,2       SET FILE DENSITY.                          ASO07060
       LXA     OVEPR,4       GET OVERFLOW SWITCH (CONTAINS SKIP NO.).   ASO07070
       PXA     ,4                                                       ASO07080
       STO     RWCS2                                                    ASO07090
       TSX     SKIP,4        SKIP N RECORDS FOR OVERFLOW.               ASO07100
       STZ     OVEPR                                                    ASO07110
       TRA     OPN13                                                    ASO07120
 OP485 TXL     OP480,1,0     TRANSFER IF NO CKPT.                       ASO07130
       TRA     OP456         SKIP CKPT FILE.                            ASO07140
       SPACE                                                            ASO07150
ADBCD1 LGR     6             SUBROUTINE TO                              ASO07160
       AXT     5,1            ADD BCD 1                                 ASO07170
       ADD     K1             TO REEL SEQUENCE                          ASO07180
AD101  PAI                    NUMBER IN                                 ASO07190
       RNT     12             ACCUMULATOR,                              ASO07200
       TRA     *+2            LEAVING THE                               ASO07210
       ADD     =54            NEW NUMBER                                ASO07220
       LGR     6              IN THE MQ.                                ASO07230
       TIX     AD101,1,1                                                ASO07240
       TRA     1,4           END OF SUBROUTINE TO ADD BCD 1.            ASO07250
       SPACE   1                                                        ASO07260
*  COME HERE TO SAVE DICTIONARY RECORDS FROM INPUT TAPE.  SAVED         ASO07270
*   ON UNREADABLE RECORD TAPE.                                          ASO07280
       SPACE   1                                                        ASO07290
 OP560 ZET     CHAPR-5       IS THERE AN UNREADABLE RECORD TAPE.        ASO07300
       TRA     OP565          NO.  SKIP, PRINT MESSAGE + GO ON.         ASO07310
       STL     OP800         SET DICTIONARY SWITCH YES.                 ASO07320
       STL     GENPR-4                                                  ASO07330
       TSX     DCTNY,4       SAVE DICTIONARY RECORDS ON                 ASO07340
       PZE     OPN73,,UNRT   UNRT.                                      ASO07350
       TRA     OP480         RETURN TO FINISH OPENING INPUT FILE.       ASO07360
       SPACE   1                                                        ASO07370
*  NO CKPT TAPE.  DELETE DICTIONARIES BY SKIPPING 1 FILE,               ASO07380
*   PRINT MESSAGE TO THIS EFFECT, AND CONTINUE OPENING INPUT FILE.      ASO07390
       SPACE   1                                                        ASO07400
 OP565 STZ     RWCS1                                                    ASO07410
       CAL     =O1000000                                                ASO07420
       STO     RWCS2                                                    ASO07430
       TSX     SKIP,4                                                   ASO07440
       LDQ*    OPN73                                                    ASO07450
       TSX     MSGSUP,4,3    PRINT DICTIONARY DELETION MESSAGE.         ASO07460
       PZE     OPM01,,4+512*DBLSP                                       ASO07470
       TRA     OP480         COMPLETE OPENING THE INPUT FILE.           ASO07480
 OPM01 BCI     4, ,DICT'ARY FILE DELETED.                               ASO07490
       EJECT                                                            ASO07500
*  THIS IS UNRT TO BE OPENED.  TEST IF THERE, THEN REWIND.              ASO07510
       SPACE   1                                                        ASO07520
OPN57  LXA     SYSCK2,4      IS THERE A SYSCK2.                         ASO07530
       TXL     OPN13,4,0     EXIT IF NOT ATTACHED.                      ASO07540
       STZ     RESSW                                                    ASO07550
       TMI     *+2           TRANSFER IF NORMAL OPEN.                   ASO07560
       STL     RESSW         SET OPEN-FOR-RESTART SWITCH.               ASO07570
       CLA     UNRT                                                     ASO07580
       TSX     OP400,4                                                  ASO07590
       TSX     (NDATA,4      REWIND SYSCK2.                             ASO07600
       PZE     SYSCK2,,REW                                              ASO07610
       ZET     RESSW         IS THIS OPEN FOR RESTART.                  ASO07620
       TRA     REOPN         YES.                                       ASO07630
       ZET     OPTPR-2        IS NOCKPT OPTION SPECIFIED             (9)ASO07635
       TRA     OPN13          YES - EXIT                             (9)ASO07636
       AXT     PHLUR,1                                                  ASO07640
       CALL    LABEL         GO TO PREPARE LABEL.                       ASO07650
       PZE     UNRT                                                     ASO07660
       STL     GENPR-4                                                  ASO07670
       TSX     LABRW,4       WRITE HEADER ON UNRT.                      ASO07680
       IOCP    0,,0                                                     ASO07690
       AXT     TRACY,4       WRITE A DUMMY CHECKPOINT FILE.             ASO07720
       PXD     ,4                                                       ASO07730
       LAC     OPN73,4                                                  ASO07740
       SSM                                                              ASO07750
       STO     1,4                                                      ASO07760
       TSX     (ACTVX,4                                                 ASO07770
       PZE     OPN73                                                    ASO07780
       NZT     RENEE                                                    ASO07790
       TRA     *-1                                                      ASO07800
       ZET     EOTI                                                     ASO07810
       TRA     OP580-1                                                  ASO07820
 OP573 TSX     (NDSLX,4      WRITE EOF.                                 ASO07830
       PZE     UNRT,,WEF                                                ASO07840
       TRA     OP580         EOT.                                       ASO07850
       TSX     (NDSLX,4      WRITE DUMMY DICTIONARY                     ASO07860
       PZE     UNRT,,WEF      FILE.                                     ASO07870
       TRA     OP580         EOT RETURN.                                ASO07880
       LAC     PR20,4        IS THERE A DICTIONARY ON THE               ASO07890
       ZET     -10,4          INPUT TAPE.                               ASO07900
       TRA     OP575         YES.  MERELY BACKSPACE FILE, POSITIONING   ASO07910
       TSX     (NDSLX,4       UNRT IN DICTIONARY FILE.                  ASO07920
       PZE     UNRT,,REW     NO.  REWIND UNRT.                          ASO07930
       TRA     OPN13         EXIT.                                      ASO07940
 OP575 TSX     (NDSLX,4      BACKSPACE FILE.                            ASO07950
       PZE     UNRT,,BSF                                                ASO07960
       TRA     OPN13         EXIT.                                      ASO07970
       STZ     EOTI                                                     ASO07980
 OP580 LDQ*    OPN73                                                    ASO07990
       TSX     MSGSUP,4,3                                               ASO08000
       PZE     OPM02,,5+512*DBLSP                                       ASO08010
       TSX     (NDSLX,4                                                 ASO08020
       PZE     UNRT,,RUN                                                ASO08030
       CLA     RWCS1                                                    ASO08040
       TRA     OPN57                                                    ASO08050
 REOPN STL     GENPR-4       FOOTPRINTS.                                ASO08060
       TSX     LABRW,4       READ UNRT HEADER LABEL.                    ASO08070
       PZE                                                              ASO08080
       ZET     NOLAB                                                    ASO08090
       TRA     OPN13         EXIT IF NO LABEL TO BE CHECKED.            ASO08100
       AXT     CHLUR,1       SET UP TO CHECK LABEL.                     ASO08110
       STL     GENPR-4                                                  ASO08120
       CALL    LABEL         CHECK LABEL.                               ASO08130
       PZE     UNRT                                                     ASO08140
       TSX     OP220,2       RETURN HERE IF UNACCEPTABLE.               ASO08150
       PZE     REOPN,,2                                                 ASO08160
       TRA     OPN13         RETURN HERE IF ACCEPTED.                   ASO08170
 RESSW PZE                   OPEN-FOR-RESTART SWITCH.                   ASO08180
 TRACY SXA     MARGE,4                                                  ASO08190
       SXA     JOYCE,1                                                  ASO08200
       PAC     ,2                                                       ASO08210
       TMI     DMCPM                                                    ASO08220
       CLA     0,2                                                      ASO08230
 POINT PDX     IORT,4                                                   ASO08240
       SXA     WRS,4                                                    ASO08250
       CLA     POINT                                                    ASO08260
       STA*    (RCHXI                                                   ASO08270
 WRS   WRS     **                                                       ASO08280
       XEC*    (RCHXI                                                   ASO08290
       STZ     RENEE                                                    ASO08300
 PEGGY AXT     **,4                                                     ASO08310
 JOYCE AXT     **,1                                                     ASO08320
IORT   IORT    0,,4096                                                  ASO08330
       TRA     1,4                                                      ASO08340
 DMCPM LFT     200000        TEST FOR EOT                               ASO08350
       TRA     ENDTP         EOT                                        ASO08360
 COUNT AXT     **,4                                                     ASO08370
       TXI     *+1,4,1                                                  ASO08380
       TXL     AGAIN,4,9                                                ASO08390
 DONE  SXA     COUNT,0                                                  ASO08400
       STZ     1,2                                                      ASO08410
       STL     RENEE                                                    ASO08420
       TRA     PEGGY                                                    ASO08430
 AGAIN SXA     COUNT,4                                                  ASO08440
       TRA     PEGGY                                                    ASO08450
 ENDTP STL     EOTI                                                     ASO08460
       TRA     DONE                                                     ASO08470
 RENEE PZE                   COMPLETION SWITCH.                         ASO08480
 EOTI  PZE                   END OF TAPE INDICATOR.                     ASO08490
 MARGE EQU     PEGGY                                                    ASO08500
 OPM02 BCI     5, (UNRT) EOT. CHANGE TAPE *CK01                         ASO08510
 OPN76 PZE     **,,**        CALLING SEQUENCE WORD FOR LABEL ROUTINE.   ASO08520
       EJECT                                                            ASO08530
*  DICTIONARY SAVE AND RETRIEVE.                                        ASO08540
       SPACE   1                                                        ASO08550
 DCTNY SXA     DSVE4,4                                                  ASO08560
       SXA     DSVE2,2                                                  ASO08570
       SXA     DSVE1,1                                                  ASO08580
       CLA     1,4           SAVE L(UCB) FOR                            ASO08590
 SLUCW PAC     ,4             INPUT AND                                 ASO08600
 DCTCT PDC     ,2             OUTPUT.                                   ASO08610
       CLA     0,4                                                      ASO08620
       STA     INDCT                                                    ASO08630
       CLA     0,2                                                      ASO08640
       STA     OUDCT                                                    ASO08650
       SXA     DCTCT,0       CLEAR COUNT.                               ASO08660
       STL     DICTS         SET DICTIONARY SWITCH.                     ASO08670
       LXA     OPN73,4       SAVE L(UCW) FOR CURRENT                    ASO08680
       SXA     SLUCW,4        SORT TAPE.                                ASO08690
 DBGIO LXA     INDCT,4       SET UP FOR READ.                           ASO08700
       SXA     OPN73,4                                                  ASO08710
       STL     GENPR-4                                                  ASO08720
       TSX     LABRW,4       READ DICTIONARY RECORD.                    ASO08730
       TXI     DEOFR,0,0     EOF RETURN AND CALLING SEQUENCE.           ASO08740
       LXA     DCTCT,4       UPDATE COUNT OF DICTIONARY RECORDS         ASO08750
       TXI     *+1,4,1        READ.                                     ASO08760
       SXA     DCTCT,4                                                  ASO08770
       LXA     OUDCT,4       SET UP FOR WRITE.                          ASO08780
       SXA     OPN73,4                                                  ASO08790
       STL     GENPR-4                                                  ASO08800
       TSX     LABRW,4       WRITE DICTIONARY RECORD.                   ASO08810
       TXL     DEOTR,0,0     EOT RETURN AND CALLING SEQUENCE.           ASO08820
       TRA     DBGIO         RETURN FOR MORE.                           ASO08830
       SPACE   1                                                        ASO08840
*  END OF FILE READING DICTIONARY RECORDS.  POLISH OFF WITH EOF AND     ASO08850
*   MESSAGE.                                                            ASO08860
 DEOFR TSX     (NDSLX,4                                                 ASO08870
       PZE     OUDCT,,WEF                                               ASO08880
       TRA     DEOTR         EOT RETURN.                                ASO08890
       TSX     (NDSLX,4                                                 ASO08900
       PZE     UNRT,,REW                                                ASO08910
       CLA     DCTCT         CONVERT COUNT OF DICTIONARY RECORDS        ASO08920
       TSX     (DECVA,4       TRANSFERRED AND INSERT                    ASO08930
       STQ     DMS01          IN MESSAGE.                               ASO08940
       TSX     MSGSUP,4,4    IF HIST OPTION, PRINT MESS. --XXXXX DICT.  ASO08950
       PZE     1              RECORDS TRANSFERRED FROM UNIT XX          ASO08960
       PZE     DMS01,,7       TO UNIT XX AND EOF WRITTEN.''             ASO08970
       LDQ*    INDCT                                                    ASO08980
       TSX     MSGSUP,4,5                                               ASO08990
       PZE     DMS02,,1                                                 ASO09000
       LDQ*    OUDCT                                                    ASO09010
       TSX     MSGSUP,4,5                                               ASO09020
       PZE     DMS03,,3+512*DBLSP                                       ASO09030
NOPRT  BSS     0                                                        ASO09040
       STZ     DICTS         CLEAR DICTIONARY ACTIVITY SWITCH.          ASO09050
       LXA     SLUCW,4        RESTORE L(UCW) FOR                        ASO09060
       SXA     OPN73,4        CURRENT SORT TAPE,                        ASO09070
 DSVE4 AXT     **,4           EXIT.                                     ASO09080
 DSVE2 AXT     **,2                                                     ASO09090
 DSVE1 AXT     **,1                                                     ASO09100
       STL     GENPR-5                                                  ASO09110
       TRA     2,4                                                      ASO09120
       SPACE   1                                                        ASO09130
*  END OF TAPE ON DICTIONARY WRITE.  PRINT MESSAGE AND RESTART.         ASO09140
       SPACE   1                                                        ASO09150
 DEOTR LDQ*    OUDCT         PRINT ''UNIT XX, EOT WRITING DICT-         ASO09160
       TSX     MSGSUP,4,3     IONARIES.  CHANGE TAPE, PRESS             ASO09170
       PZE     DMS04,,6       START FOR RESTART.''                      ASO09180
       TSX     MSGSUP,4,2                                               ASO09190
K1     PZE     1                                                        ASO09200
       PZE     DMS05,,7+512*DBLSP                                       ASO09210
       TSX     (NDSLX,4                                                 ASO09220
(NDLSX EQU     (NDSLX                                                   ASO09230
       PZE     OUDCT,,RUN                                               ASO09240
       TSX     (PAUSE,4                                                 ASO09250
       STL     GENPR-4                                                  ASO09260
       CALL    RESTAR        GO TO RESTART.                             ASO09270
 INDCT PZE                   L(UCB) FOR DICTIONARY INPUT UNIT.          ASO09280
 OUDCT PZE                   L(UCB) FOR DICTIONARY OUTPUT UNIT.         ASO09290
 DICTS PZE                   DICTIONARY SWITCH.                         ASO09300
 DMS01 BCI     7,       DICTIONARY RECORDS TRANSFERRED FROM             ASO09310
 DMS02 BCI     1, TO                                                    ASO09320
 DMS03 BCI     3, AND EOF WRITTEN.                                      ASO09330
 DMS04 BCI     6, ,EOT WRITING DICTIONARIES.  *CK02                     ASO09340
 DMS05 BCI     7, CHANGE TAPE, PRESS START FOR RESTART.                 ASO09350
       EJECT                                                            ASO09360
*  LABEL READ-WRITE ROUTINE.                                            ASO09370
*  UTILIZES TRAPS VIA IOEX.                                             ASO09380
*  CALLING SEQUENCE IS   TSX  LABRW,4                                   ASO09390
*                        P                                              ASO09400
*  P CONSISTS OF 3 BITS.  BIT S ON MEANS                                ASO09410
*  LABEL WRITE, OFF MEANS READ.  BIT 1 ON                               ASO09420
*  MEANS TRAILER LABEL, OFF MEANS HEADER.                               ASO09430
*  BIT 2 ON MEANS NO EOF AFTER THE LABEL,                               ASO09440
*  OFF MEANS EOF EXPECTED (READ) OR TO BE                               ASO09450
*  WRITTEN (WRITE) AFTER LABEL.  BIT 3 ON                               ASO09460
*  MEANS COMPUTE LENGTH OF LABEL JUST READ,                             ASO09470
*  OFF MEANS DONT BOTHER.                                               ASO09480
       SPACE   2                                                        ASO09490
 LABRW SXA     LB970,4                                                  ASO09500
       SXA     LB975,2                                                  ASO09510
       SXA     LB980,1                                                  ASO09520
       STZ     LAB20         RESET 14 / 20 WD. SW.                      ASO09530
       STZ     NOLAB         RESET NO-LABEL SWITCH.                     ASO09540
       CAL     1,4           SET UP SWITCHES FROM CALLING               ASO09550
       AXT     4,4                                                      ASO09560
 SETSW STL     RDWRT+4,4      SEQUENCE.                                 ASO09570
       PBT                                                              ASO09580
       STZ     RDWRT+4,4                                                ASO09590
       ALS     1                                                        ASO09600
       TIX     SETSW,4,1                                                ASO09610
 LB010 TSX     LBACT,4       SET UCW2 AND ACTIVATE.                     ASO09620
       NZT     EFETS         IS THIS EOF OR EOT.                        ASO09630
       TRA     LB040         NO.                                        ASO09640
       ZET     DICTS         YES.  IS THIS DICTIONARY ACTION.           ASO09650
       TRA     LB150         YES.  TAKE EOF/EOT RETURN (1,4).           ASO09660
       NZT     RDWRT         NO.  IS THIS READ OR WRITE.                ASO09670
       TRA     LB030         READ.                                      ASO09680
       ZET     HDRTR         WRITE.  IS THIS HEADER LABEL.              ASO09690
       TRA     LB040         NO.  IGNORE EOT AND GO ON TO WRITE EOF.    ASO09700
       TRA     LB670         EOT ON HEADER LABEL.  PRINT MESSAGE.       ASO09710
*  END OF FILE ON LABEL READ.                                           ASO09720
 LB030 CLA     LBM06         HEADER LABEL.                              ASO09730
       ZET     HDRTR                                                    ASO09740
       CLA     LBM07         TRAILER LABEL.                             ASO09750
       STO     LBM05+2                                                  ASO09760
       LDQ*    CL13                                                     ASO09770
       TSX     MSGSUP,4,3                                               ASO09780
       PZE     LBM05,,4+512*DBLSP                                       ASO09790
       STL     NOLAB         SET NO-LBL SWITCH TO SKIP CHECKING.        ASO09800
       TRA     LB970         EXIT.                                      ASO09810
*                                                                       ASO09820
 LB040 ZET     EOFAF         SHOULD THERE BE AN EOF FOLLOWING LABEL.    ASO09830
       TRA     LB970         NO.  EXIT.                                 ASO09840
       ZET     RDWRT         READ OR WRITE.                             ASO09850
       TRA     LB300         WRITE EOF.                                 ASO09860
       STL     EOFRQ         READ.  REQUEST TO READ EOF.                ASO09870
       TSX     LBACT,4       LOAD UCW2 AND ACTIVATE.                    ASO09880
       STZ     EOFRQ         RESET EOF REQUEST SWITCH.                  ASO09890
       ZET     EFETS         DID WE GET AN EOF.                         ASO09900
       TRA     LB970         YES.  EXIT.                                ASO09910
       CLA     LBM06         NO.  PRINT ''UNIT XX...NO EOF FOLLOWING    ASO09920
       ZET     HDRTR          (HEADER)(TRAILR) LABEL.''                 ASO09930
       CLA     LBM07                                                    ASO09940
       STO     LBM08+4                                                  ASO09950
       LDQ*    CL13                                                     ASO09960
       TSX     MSGSUP,4,3                                               ASO09970
       PZE     LBM08,,6+512*DBLSP                                       ASO09980
       TSX     (NDSLX,4      BACKSPACE 1 RECORD.                        ASO09990
       PZE     CL13,,BSR                                                ASO10000
       TRA     LB970         EXIT.                                      ASO10010
       SPACE   1                                                        ASO10020
*  EOF OR EOT ON DICTIONARY READ/WRITE.  TAKE RETURN 1,4.               ASO10030
       SPACE   1                                                        ASO10040
 LB150 XEC     LB970                                                    ASO10050
       TXI     LB975,4,1     RETURN 1,4.                                ASO10060
       SPACE   1                                                        ASO10070
*                                                                       ASO10080
       SPACE   1                                                        ASO10090
 LB300 TSX     (NDSLX,4      WRITE END OF FILE.                         ASO10100
       PZE     CL13,,WEF                                                ASO10110
       ZET     HDRTR         EOT.  PRINT MESSAGE IF HEADER.             ASO10120
       TRA     LB970         NORMAL RETURN.  EXIT.                      ASO10130
*  ROUTINE TO PRINT HEADER LABEL EOT MESSAGE AND UNLOAD TAPE.           ASO10140
LB670  LDQ*    CL13          PRINT 'UNIT XX  EOT WRITING                ASO10150
       TSX     MSGSUP,4,3     HEADER LABEL - CHANGE TAPE                ASO10160
       PZE     LBM01,,8+512*DBLSP                                       ASO10170
       TSX     (NDATA,4      UNLOAD THE TAPE.                           ASO10180
       PZE     CL13,,RUN                                                ASO10190
       TSX     (PAUSE,4      OPERATOR ACTION PAUSE.                     ASO10200
       TRA     LB010         RETURN FOR RETRY ON NEW TAPE.              ASO10210
*  ROUTINE TO LOAD UCW2 AND ACTIVATE.                                   ASO10220
 LBACT SXA     LB765,4                                                  ASO10230
       ZET     RDWRT         IS THIS A READ.                            ASO10240
       TRA     LB755         NO.  WRITE.                                ASO10250
       ZET     EOFRQ         READ.  IS EOF READ REQUESTED.              ASO10260
       TRA     LB780         YES.  SKIP FILLING WITH BLANKS.            ASO10270
 LB750 AXT     20,4          FILL LABEL INPUT AREA WITH BLANKS.         ASO10280
       CAL     LBRDA                                                    ASO10290
       ADM     LB750                                                    ASO10300
       STA     LB753                                                    ASO10310
       CLA     BLANK                                                    ASO10320
 LB753 STO     **,4                                                     ASO10330
       TIX     *-1,4,1                                                  ASO10340
       TRA     LB780         GO TO READ.                                ASO10350
 LB755 CLS     LCSEL         WRITE.                                     ASO10360
 LB756 LAC     CL13,2                                                   ASO10370
       ZET     1,2                                                      ASO10380
       TRA     *-1                                                      ASO10390
       STO     1,2                                                      ASO10400
       TSX     (ACTVX,4                                                 ASO10410
       MZE     CL13                                                     ASO10420
       ZET     1,2                                                      ASO10430
       TRA     *-1                                                      ASO10440
 LB765 AXT     **,4                                                     ASO10450
       TRA     1,4                                                      ASO10460
 LB780 CLA     LCSEL                                                    ASO10470
       TRA     LB756                                                    ASO10480
 LB970 AXT     **,4                                                     ASO10490
 LB975 AXT     **,2                                                     ASO10500
 LB980 AXT     **,1                                                     ASO10510
       STL     GENPR-5                                                  ASO10520
       TRA     2,4                                                      ASO10530
 LBM01 BCI     8, EOT WRITING HEADER LABEL - CHANGE TAPE.  *MR03        ASO10540
 LBM05 BCI     4,   EOF.  NO        LABEL                               ASO10550
 LBM06 BCI     1,HEADER                                                 ASO10560
 LBM07 BCI     1,TRAILR                                                 ASO10570
 LBM08 BCI     6,  NO EOF MARK FOLLOWING        LABEL                   ASO10580
 LBM09 BCI     1,(LBL)                                                  ASO10590
 LBM10 BCI     1,(DICT)                                                 ASO10600
 BLANK BCI     1,                                                       ASO10610
       EJECT                                                            ASO10620
*  SELECT ROUTINES.                                                     ASO10630
       SPACE   2                                                        ASO10640
 SELCT SXA     LVSEL,4                                                  ASO10650
       SXA     LVSEL+1,2                                                ASO10660
       SXA     LVSEL+2,1                                                ASO10670
       PAC     ,2                                                       ASO10680
       LDQ     1,2                                                      ASO10690
       TMI     LSELM                                                    ASO10700
       CLA     LBRDA                                                 (4)ASO10702
       STA     LIRTN-1                                               (4)ASO10705
       CLA     LIRTN                                                    ASO10710
       AXT     31872,4       RDS.                                       ASO10720
       TQP     *+2                                                      ASO10730
       AXT     32128,4       WRS.                                       ASO10740
       SXD     RDOWR,4                                                  ASO10750
       NZT     EOFRQ                                                    ASO10760
       SUB     K1                                                       ASO10770
       STA*    (RCHXI                                                   ASO10780
       NZT     LABST         IS STD LABEL TO BE WRITTEN.  PH 3.         ASO10790
       TRA     LB982         NO.                                        ASO10800
       ZET     LAB02         YES.  IS THERE A LABEL CARD.               ASO10810
       TRA     LB982          YES.                                      ASO10820
       LXA     LABTYP,4       NO.  IF THE INPUT LABEL WAS STD,          ASO10830
       TXH     LB982,4,1       GO TO GET THE COUNT FROM LAB03.          ASO10840
       CLA     =O16000000     SINCE THERE WAS NO LABEL CARD AND THERE ISASO10850
       STD     LIRTN-1        EITHER NO LABEL OR A NON STD LABEL ON THE ASO10860
       TRA     LB985          INPUT, THIS LABEL WILL BE 14 WORDS.       ASO10870
 LB982 LXA     LB970,4       IF THE ADDRESS PART OF THE CALLING SE-     ASO10880
       CLA     1,4            UENCE WORD (1,4) FOR THIS I/O ROUTINE IS  ASO10890
       PAC     ,4             NONZERO AND THIS IS NOT DICTIONARY ACTION ASO10900
       TXL     LB985,4,0      (I.E., DICTS IS ZERO), THEN IT CONTAINS   ASO10910
       CLA     0,4            THE LOCATION OF A WORD WHOSE ADDRESS      ASO10920
       PAX     ,4             SPECIFIES THE LENGTH OF THE LABEL WE ARE  ASO10930
       TXL     LB985,4,0      CURRENTLY PROCESSING.  THEREFORE, WE      ASO10940
       ZET     DICTS         SHOULD USE THAT LENGTH IN THE WORD COUNT(4)ASO10950
       LXA     =14,4         SET LENGTH OF DICT RECORD TO 14         (4)ASO10955
       SXD     LIRTN-1,4      PART OF THE I/O COMMAND AT LIRTN-1.       ASO10960
LB985  CLA     0,2           GET UCW1 FOR UNIT ADDRESS.                 ASO10970
       PDX     ,4                                                       ASO10980
       SXA     RDOWR,4                                                  ASO10990
 RDOWR PZE                   SELECT THE UNIT.                           ASO11000
       XEC*    (RCHXI                                                   ASO11010
       STZ     EFETS                                                    ASO11020
 LVSEL AXT     ,4                                                       ASO11030
       AXT     ,2                                                       ASO11040
       AXT     ,1                                                       ASO11050
       CLA     =O24000000    RESTORE LABEL LENGTH TO 20 WORDS.          ASO11060
       STD     LIRTN-1                                                  ASO11070
       STL     GENPR-5                                                  ASO11080
       TRA     1,4                                                      ASO11090
       SPACE   1                                                        ASO11100
*  SELECT MINUS ENTRY, LABEL READ-WRITE.                                ASO11110
       SPACE   1                                                        ASO11120
LSELM  LNT     400000        NOISE                                   (4)ASO11130
       TRA     LBSM3         YES,TAKE 2,4 RETURN.                    (4)ASO11140
       LFT     300000        NO                                      (4)ASO11150
       TRA     LBSM1         EOF/EOT/PERM. REDUNDANCY                (4)ASO11160
       NZT     LBNCI         IS NON-STD. LENGTH LABEL EXPECTED.         ASO11170
       TRA     LBSM0         NO.                                        ASO11180
       LXA     (COMMM,4      YES. COMPUTE THE LENGTH.                   ASO11190
       PXA     ,4                                                       ASO11200
       SUB     LBRDA                                                    ASO11210
       TZE     LBSM0                                                    ASO11220
       NZT     LAB03                                                    ASO11230
       STA     LAB03                                                    ASO11240
       SUB     =14                                                      ASO11250
       TNZ     LBSM0         IF LABEL WAS 14 WDS                        ASO11260
       STL     LAB20          SET SWITCH.                               ASO11270
 LBSM0 STZ     1,2                                                      ASO11280
       TRA     LVSEL         EXIT.                                      ASO11290
 LBSM1 LFT     200000                                                   ASO11300
       TRA     LBSM2         EOF/EOT                                    ASO11310
       AXT     LBM10,4                                                  ASO11320
       NZT     DICTS                                                    ASO11330
       AXT     LBM09,4                                                  ASO11340
       SXA     REDCS,4                                                  ASO11350
       TSX     MSGSUP,4,2                                               ASO11360
       PZE     1                                                        ASO11370
 REDCS PZE     **,,1+512*DBLSP                                          ASO11380
       TRA     LBSM0         ACCEPT AS IS.                              ASO11390
 LBSM2 STL     EFETS                                                    ASO11400
       TRA     LBSM0                                                    ASO11410
 LBSM3 LXA     LVSEL,4                                                  ASO11420
       TXI     LVSEL+1,4,-1  TAKE RETURN 2,4.                           ASO11430
       SPACE   3                                                        ASO11440
*                                                                       ASO11450
*                                                                       ASO11460
       IORT    **,,20        THIS MUST COME JUST BEFORE LIRTN.       (4)ASO11470
 LIRTN IORTN   *,,-1                                                    ASO11480
 NOLAB PZE                   NO-LABEL SWITCH.                           ASO11490
 EOFRQ PZE                   EOF-REQUEST SWITCH.                        ASO11500
 LCSEL PZE     ,,SELCT                                                  ASO11510
 EFETS PZE                   END OF FILE, END OF TAPE SWITCH.           ASO11520
*  THE 4 FOLLOWING CELLS ARE THE LABRW CALLING SEQUENCE CELLS.          ASO11530
 RDWRT PZE                   READ = ZERO, WRITE = NZ.                   ASO11540
 HDRTR PZE                   HEADER = ZERO, TRAILER = NZ.               ASO11550
 EOFAF PZE                   EOF AFTER = ZERO, NONE = NZ.               ASO11560
 LBNCI PZE                   NZ= COMPUTE LABEL LENGTH. 2= DONT.         ASO11570
*                                                                       ASO11580
 LAB20 PZE                   NZ= LABEL READ WAS 14 WDS.  ZERO= 20 WDS.  ASO11590
 LABST PZE                  NZ= STD LABEL TO BE WRITTEN IN PH 3.        ASO11600
       EJECT                                                            ASO11610
* SKIP N RECORDS - SKIP N FILES                                         ASO11620
*                                                                       ASO11630
SKIP   NZT     RWCS2         TEST FOR ZERO ENTRY.                       ASO11640
       TRA     1,4           NOTHING TO DO.  RETURN.                    ASO11650
       SXA     SKP52,2                                                  ASO11660
       SXA     SKP54,4                                                  ASO11670
       CLA     RWCS1                                                    ASO11680
       PDX     ,2            SAVE FILE NUMBER.                          ASO11690
       TXH     SKP32,2,-2    TRANSFER IF CHECKPOINT TAPE.               ASO11700
       TMI     SKP20         TRANSFER IF FILE IS OUTPUT.                ASO11710
       TXH     SKP10,2,0     TRANSFER IF FILE NUMBER IS NONZERO.        ASO11720
       CLA*    AIUCW         PICK                                       ASO11730
       TRA     SKP40          UP                                        ASO11740
 SKP10 TXI     *+1,2,-1       LOCATION                                  ASO11750
       CLA*    MIUCW          OF                                        ASO11760
       TRA     SKP40          UCW                                       ASO11770
SKP20  TXL     *+2,2,0        OF                                        ASO11780
 SKP30 TXI     *+1,2,-1                                                 ASO11790
       CLA*    MOUCW                                                    ASO11800
       TRA     SKP40                                                    ASO11810
 SKP32 CLA     SYSCK2                                                   ASO11820
 SKP40 STA     SKP60         SAVE FOR ACTIVATE AND RDS.                 ASO11830
       PAC     ,2            INITIALIZE UCW2 WITH                       ASO11840
       ZET     1,2                                                      ASO11850
       TRA     *-1                                                      ASO11860
       CLA     SELLC          THE LOCATION OF THE                       ASO11870
       SLW     1,2            SELECT ROUTINE.                           ASO11880
       CAL     2,2                                                      ASO11890
       ANA     =O77777000000                                            ASO11900
       ADM     RAWPR-1                                                  ASO11910
       STA     GOAL                                                     ASO11920
       STD     GOAL                                                     ASO11930
       TSX     (ACTIV,4      ACTIVATE                                   ASO11940
       MZE     SKP60          UNIT.                                     ASO11950
       ZET     1,2           WAIT FOR COMPLETION                        ASO11960
       TRA     *-1            OF ACTIVITY.                              ASO11970
 SKP52 AXT     **,2                                                     ASO11980
 SKP54 AXT     **,4                                                     ASO11990
       TRA     1,4                                                      ASO12000
       SPACE   2                                                        ASO12010
SKPSL  PAC     ,2                                                       ASO12020
       TMI     SKPSM                                                    ASO12030
       STZ*    (RCTXI        SUPPRESS REDUNDANCY CHECKING.              ASO12040
       CLA     LIRTN         INITIALIZE                                 ASO12050
       STA*    (RCHXI         RCH.                                      ASO12060
SKP60  LXD     **,2          PUT TAPE ADDRESS IN                        ASO12070
       SXA     *+1,2          AND EXECUTE                               ASO12080
       RDS     **             THE RDS.                                  ASO12090
       XEC*    (RCHXI                                                   ASO12100
       TRA     1,4                                                      ASO12110
       SPACE   2                                                        ASO12120
 SKPSM LFT     200000        TRANSFER IF EOF                            ASO12130
       TRA     SKP90          WAS REACHED.                              ASO12140
       CAL     (COMMM                                                   ASO12150
       SUB     LIRTN                                                    ASO12160
       ANA     =O77777                                                  ASO12170
       LDQ     K2                                                       ASO12180
       TLQ     SKP90                                                    ASO12190
       CAL     2,2                                                      ASO12200
       SUB     K1                                                       ASO12210
       STO     2,2                                                      ASO12220
SKP90  CAL     2,2                                                      ASO12230
       ANA     =O77777777777                                            ASO12240
       SUB     GOAL                                                     ASO12250
       TMI     *+2                                                      ASO12260
       STZ     1,2                                                      ASO12270
       TRA     1,4                                                      ASO12280
GOAL   PZE                                                              ASO12290
 SELLC         **,,SKPSL                                                ASO12300
       SPACE   2                                                        ASO12310
*  ROUTINE TO SAVE CALLING SEQUENCE + RESTORE IT.                       ASO12320
       SPACE   1                                                        ASO12330
 SAVEW CLA     RAWPR                                                    ASO12340
       STO     SAVE1                                                    ASO12350
       CLA     RAWPR-1                                                  ASO12360
       STO     SAVE2                                                    ASO12370
       TRA     1,4                                                      ASO12380
 RESTW CLA     SAVE1                                                    ASO12390
       STO     RAWPR                                                    ASO12400
       CLA     SAVE2                                                    ASO12410
       STO     RAWPR-1                                                  ASO12420
       TRA     1,4                                                      ASO12430
 SAVE1 PZE                                                              ASO12440
 SAVE2 PZE                                                              ASO12450
       SPACE   2                                                        ASO12460
*  SNDAT IN HYOPEN DOES NON-DATA I/O OPERATIONS FOR 729 OR HYPER.       ASO12470
*   THIS ENTRY IS MADE TO MAKE THE CALLING NAME COMPATABLE TO ALL       ASO12480
*   COMBINATIONS OF 729 AND HYPER THAT ARE USED.                        ASO12490
       SPACE   1                                                        ASO12500
 SNDAT TTR     (NDSLX                                                   ASO12510
       EJECT                                                            ASO12520
*  7090 SORT  MESSAGE  SUPERVISOR                                       ASO12530
* WHEN THE DECREMENT OF THE TSX MSGSUP,4,** IS-                         ASO12540
*      1       USE CONVERT AND PRINT                                    ASO12550
*      2       MUST BE PRINTED ONLINE                                   ASO12560
*      3       CONVERT AND MUST BE PRINTED ONLINE                       ASO12570
*      4       TEST HIST                                                ASO12580
*      5       TEST HIST AND CONVERT                                    ASO12590
*      8       TEST MAP                                                 ASO12600
*      9       TEST MAP AND CONVERT                                     ASO12610
*      16      TEST TAPES                                               ASO12620
*      17      TEST TAPES AND CONVERT                                   ASO12630
*      32      TEST CARDS                                               ASO12640
*      33      TEST CARDS AND CONVERT                                   ASO12650
*      ALSO  WHEN                                                       ASO12660
*      NOF     IS (Z) PRINT OFF LINE                                    ASO12670
*      MAP     IS (NZ) PRINT ONLINE                                     ASO12680
*      HIST    IS (NZ) PRINT ONLINE                                     ASO12690
*      TAPES   IS (NZ) PRINT ONLINE                                     ASO12700
*      CARDS   IS (NZ) PRINT ONLINE                                     ASO12710
MSGSUP ENB     K0            DISABLE ALL TRAPS                          ASO12720
       SXA     SAVXR4,4                                                 ASO12730
DETERM LDI     0,4           DETERMINE TYPE OF MESSAGE REQUESTED        ASO12740
       LFT     000002        MUST BE PRINTED ONLINE +                   ASO12750
       TRA     MUST          YES                                        ASO12760
       AXT     *,4           LOAD XR IN CASE OF ERROR                   ASO12770
       LFT     000004        TEST HIST                                  ASO12780
       AXT     HIST,4        YES                                        ASO12790
       LFT     000010        TEST MAP +                                 ASO12800
       AXT     MAP,4         YES                                        ASO12810
       LFT     000020        TEST TAPES +                               ASO12820
       AXT     TAPES,4       YES                                        ASO12830
       LFT     000040        TEST CARDS +                               ASO12840
       AXT     CARDS,4       YES                                        ASO12850
       SXA     TEST,4                                                   ASO12860
SAVXR4 AXT     **,4                                                     ASO12870
TEST   ZET     **            PRINT ONLINE +                             ASO12880
       TRA     MUST          YES                                        ASO12890
       ZET     NOF           NO-PRINT OFFLINE +                         ASO12900
       TRA     GOBACK        NO                                         ASO12910
       CAL     MON           YES-GO PRINT                               ASO12920
       TRA     ALTER         OFFLINE ONLY                               ASO12930
MUST   CAL     *             SET UP FOR BOTH                            ASO12940
       NZT     NOF           PRINT OFFLINE ALSO +                       ASO12950
ALTER  STP     1,4           ALTER CALLING SEQUENCE                     ASO12960
       LFT     000001        CONVERSION NECESSARY +                     ASO12970
       TRA     (CVPRT        YES                                        ASO12980
       TRA     (PROUT        NO                                         ASO12990
GOBACK CLS     MON           CONSTANT TO AC                             ASO13000
       LNT     000001        ONLY ONE CALL SEQ ENTRY +                  ASO13010
       ADM     1,4           NO CALCULATE                               ASO13020
       STA     BACK          RETURN                                     ASO13030
       NZT     (TRPSW                                                   ASO13040
       ENB*    (TRAPX        RE-ENABLE TRAPS                            ASO13050
BACK   TRA     **,4                                                     ASO13060
MON    MON     2                                                        ASO13070
       SPACE   2                                                        ASO13080
       EJECT                                                            ASO13090
 K0    PZE     0                                                        ASO13100
 K2    PZE     2                                                        ASO13110
 K3    PZE     3                                                        ASO13120
OPENCL PZE                   INPUT FILE STATUS INDICATOR.               ASO13130
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     ASO13140
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  ASO13150
 LABPR COMMON  5              LABEL CARD PARAMETERS                     ASO13160
 CHAPR COMMON  6              CHANNEL PARAMETERS                        ASO13170
 FILPR COMMON  14             FILE CARD PARAMETERS                      ASO13180
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              ASO13190
 RECPR COMMON  10             RECORD CARD PARAMETERS                    ASO13200
 DELPR COMMON  2              DELETE CARD PARAMETERS                    ASO13210
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            ASO13220
 CALPR COMMON  50             CALCULATED PARAMETERS                     ASO13230
 GENPR COMMON  10             GENERAL PARAMETERS                        ASO13240
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  ASO13250
 CNTPR COMMON  20             COUNT PARAMETERS                          ASO13260
 ERAPR COMMON  30             ERASABLE SORAGE PARAMETERS                ASO13270
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           ASO13280
MAP    EQU     OPTPR-6                                                  ASO13290
NOF    EQU     OPTPR-7                                                  ASO13300
HIST   EQU     OPTPR-8                                                  ASO13310
TAPES  EQU     OPTPR-9                                                  ASO13320
CARDS  EQU     OPTPR-10                                                 ASO13330
 RWCS1 EQU     RAWPR                                                    ASO13340
 AIUCW EQU     CHAPR                                                    ASO13350
 MOUCW EQU     CHAPR-2                                                  ASO13360
 MIUCW EQU     CHAPR-3                                                  ASO13370
 RWCS2 EQU     RAWPR-1                                                  ASO13380
 CHA01 EQU     CHAPR-1       L(OUTPUT CHANNEL TABLE), IF SPECIFIED      ASO13390
 CHA02 EQU     CHAPR-2       L(MERGE OUTPUT CHANNEL TABLE)              ASO13400
 CHA03 EQU     CHAPR-3       L(MERGE INPUT CHANNEL TABLE)               ASO13410
 CHA04 EQU     CHAPR-4       NON-ZERO IF SYMBOLIC OUTPUT CHANNEL SPECIF-ASO13420
*                             IED.                                      ASO13430
 PR14  EQU     CHAPR                                                    ASO13440
 PR15  EQU     CHAPR-3                                                  ASO13450
 PR16  EQU     CHAPR-2                                                  ASO13460
 PR19  EQU     CHAPR-1                                                  ASO13470
 PR20  EQU     FILPR                                                    ASO13480
 PR29  EQU     FILPR-1       ADDR. OF OUTPUT FILE DATA BLOCK.           ASO13490
CNT19  EQU     CNTPR-19                                              (7)ASO13491
 UCWIT EQU     CL13                                                     ASO13500
 UNRT  EQU     SYSCK2                                                   ASO13510
 CTLSI EQU     4             CODE TO CHECK TRAILER LABEL, SORT INPUT.   ASO13520
 OPN73 EQU     CL13                                                     ASO13530
 OP800 EQU     GENPR-8       DICTIONARY INDICATION SWITCH.              ASO13540
 CHLUR EQU     0             CODE TO CHECK HEADER LABEL, UNRT.          ASO13550
 CHLMI EQU     2             CODE TO CHECK HEADER LABEL, MERGE INPUT.   ASO13560
 CHLSI EQU     3             CODE TO CHECK HEADER LABEL, SORT INPUT.    ASO13570
 CTLMI EQU     4             CODE TO CHECK TRAILER LABEL, MERGE INPUT.  ASO13580
 PTLOR EQU     6             CODE TO PREPARE TRAILER LABEL, OUTPUT REEL.ASO13590
 PTLFR EQU     7             CODE TO PREPARE TRAILER LABEL, FINAL REEL. ASO13600
 CHLEI EQU     3             CODE TO CHECK HEADER LABEL, EXTERNAL INPUT.ASO13610
 PHLFO EQU     5             CODE TO PREPARE HEADER LABEL, FINAL OUTPUT.ASO13620
 PHLUR EQU     8             CODE TO PREPARE HEADER LABEL, UNRT.        ASO13630
 PHLMO EQU     1             CODE TO PREPARE HEADER LABEL, MERGE OUTPUT.ASO13640
 SNGLS EQU     0                                                        ASO13650
 LBRDA EQU     LABPR                                                    ASO13660
 LAB02 EQU     LABPR-2                                                  ASO13670
 LAB03 EQU     LABPR-3                                                  ASO13680
 GEN07 EQU     GENPR-7       CONTAINS RECORD COUNT OF INPUT TAPE.       ASO13690
LABTYP EQU     GENPR-6      NZ= STD.  1= NON STD.  ZERO = NO LABEL      ASO13700
OVFLS  EQU     RAWPR-25      NZ NORMALLY.  SET =0 IF CLOSE FOR OVERFLOW ASO13710
MORDER EQU     SAMPR-1                                                  ASO13720
       DETAIL                                                           ASO13730
       END                                                              ASO13740
* 7090/94 SORT VER 7 MOD 4 LABEL PREPARER + CHECKER                  (4)BLB00000
*      FAP
       COUNT   250                                                      BLB00010
*   CALLING SEQUENCE                                                    BLB00020
*      AXT     **,1    WHERE ** =                                       BLB00030
*                   1 FOR PREPARE INTERMEDIATE HEADER LABEL.            BLB00040
*                   2     CHECK INTERMEDIATE HEADER LABEL.              BLB00050
*                   3     CHECK STANDARD HEADER LABEL                   BLB00060
*                   4     CHECK STANDARD TRAILER LABEL.                 BLB00070
*                   5     PREPARE STANDARD HEADER LABEL.                BLB00080
*                   6     PREPARE STANDARD EOR TRAILER LABEL.           BLB00090
*                   7     PREPARE STANDARD EOF TRAILER LABEL.           BLB00100
*                   8     PREPARE UNREADABLE RECORD TAPE STANDARD HEADERBLB00110
*                   9     MOVE VERY FIRST INPUT LABEL TO HOLD AREA.     BLB00120
*                   0     CHECK UNREADABLE RECORD TAPE AT RESTART.      BLB00130
*      CLA     LOCATION OF FILE DATA BLOCK                              BLB00140
*      TSX     LABEL,4                                                  BLB00150
*              LOCATION OF LOCATION OF UCB                              BLB00160
*      RETURN 2,4 IS NORMAL IF PREPARING LABELS, BUT IT IS              BLB00170
*                 FOR RETRY IF CHECKING LABELS.                         BLB00180
*      RETURN 4,4 IS NORMAL IF CHECKING LABELS.                         BLB00190
*        WHEN CHECKING TRAILER LABEL, ON RETURN THE SENSE INDICATORS    BLB00200
*           CONTAIN THE FIRST WORD OF THE LABEL (1EOR OR 1EOF).         BLB00210
       SPACE                                                            BLB00220
       ENTRY   LABEL                                                    BLB00230
       TITLE                                                            BLB00240
       SST                                                              BLB00250
       SPACE                                                            BLB00260
 LABEL SXA     LBT10,2                                                  BLB00270
       SXA     LBT20,4                                                  BLB00280
       PAI                                                              BLB00290
       STZ     120CHR        TURN OFF 120 CHARACTER SWITCH              BLB00300
       TPL     *+2           TRANSFER IF 84 CHAR. LABEL                 BLB00310
       STL     120CHR        SET 120 CHARACTER SWITCH                   BLB00320
       LAC     LBCST,2                                                  BLB00330
       CLA*    1,4                                                      BLB00340
       STO     TPUNT         SAVE LOCATION OF UCW.                      BLB00350
       LXA     GENPR,4       GET PHASE INDICATOR                        BLB00360
       TXL     LBL05,4,0                                                BLB00370
       TXL     *+2,4,2                                                  BLB00380
       TRA     LBL02         FINAL MERGE                                BLB00390
       TXH     LBL05,4,1                                                BLB00400
       TXH     LBL05,1,4                                                BLB00410
       TXL     LBL05,1,2                                                BLB00420
       ZET     MODPR-9       INTERNAL SORT                              BLB00430
       CALL    XSM10                                                    BLB00440
       TRA     LBL05         CONTINUE                                   BLB00450
       TRA     LBT10         DONE                                       BLB00460
       TRA     LBT30         REREAD                                     BLB00470
LBL02  TXL     LBL05,1,2                                                BLB00480
       ZET     MODPR-24                                                 BLB00490
       CALL    FMM10                                                    BLB00500
       TRA     LBL05         CONTINUE                                   BLB00510
       TRA     LBT10         DONE IF READING                            BLB00520
       TRA     LBT30         REREAD, DONE IF WRITING                    BLB00530
 LBL05 TRA     *+10,1                                                   BLB00540
       TRA     MVFLB                                                    BLB00550
       TRA     URTLB                                                    BLB00560
       TRA     PSTLB                                                    BLB00570
       TRA     PSTLB+2                                                  BLB00580
       TRA     PSHLB                                                    BLB00590
       TRA     CSTLB                                                    BLB00600
       TRA     CSHLB                                                    BLB00610
       TRA     CIHLB                                                    BLB00620
       TRA     PIHLB                                                    BLB00630
       TRA     CUNRT                                                    BLB00640
LBT30  STZ     TPUNT                                                    BLB00650
 LBT10 AXT     **,2                                                     BLB00660
 LBT20 AXT     **,4                                                     BLB00670
       NZT     TPUNT                                                    BLB00680
       TRA     2,4                                                      BLB00690
       TRA     4,4           GO TO NORMAL RETURN.                       BLB00700
*                                                                       BLB00710
* MOVE VERY FIRST LABEL FOR HOLDING                                     BLB00720
*                                                                       BLB00730
MVFLB  LAC     LBRED,1       MOVE THE                                   BLB00740
       AXT     20,4          INPUT LABEL                                BLB00750
       CLA     0,2           TO AN                                      BLB00760
       STO     0,1           AREA WHERE                                 BLB00770
       TXI     *+1,1,-1      IT WILL                                    BLB00780
       TXI     *+1,2,-1      REMAIN THRU-OUT                            BLB00790
       TIX     *-4,4,1       THE PROGRAM                                BLB00800
       TRA     LBT10                                                    BLB00810
*                                                                       BLB00820
* PREPARE UNREADABLE RECORD TAPE HEADER LABEL.                          BLB00830
*                                                                       BLB00840
 URTLB BSS     0                                                        BLB00850
       TSX     INITL,4                                                  BLB00860
       CAL     BLANK                                                    BLB00870
       LDQ     STDAT                                                    BLB00880
       LGL     12                AND                                    BLB00890
       SLW     1,2           CREATION                                   BLB00900
       LGL     6                                                        BLB00910
       STQ     2,2           DATE                                       BLB00920
       CLA     H709          AND CREATING                               BLB00930
       STO     8,2           SYSTEM                                     BLB00940
       CLA     NAME          AND                                        BLB00950
       STO     3,2           TWO WORD                                   BLB00960
       CLA     NAME+1        NAME READING                               BLB00970
       STO     17,2          SORT SYSCK2                                BLB00980
       TRA     LBT30             RETURN                                 BLB00990
*                                                                       BLB01000
* CHECK UNREADABLE RECORD TAPE HEADER LABEL AT RESTART.                 BLB01010
*                                                                       BLB01020
CUNRT  CLA     3,2            IS THE                                    BLB01030
       SUB     NAME           CORRECT                                   BLB01040
       TNZ     CUN20         GIVEN                                      BLB01050
       CAL     17,2          CORRECT  NAME GIVEN +                      BLB01060
       ERA     NAME+1        TRANSFER OUT IF YES                        BLB01070
       TZE     LBT10                                                    BLB01080
CUN20  TSX     PRTLBL-1,4                                               BLB01090
       BCI     1,*LB01                                                  BLB01100
*                                                                       BLB01110
* PREPARE STANDARD TRAILER LABEL OUTPUT FROM FINAL MERGE.               BLB01120
*                                                                       BLB01130
 PSTLB BSS     0                                                        BLB01140
       CLA     EOF           PUT IN                                     BLB01150
       TRA     *+2            LABEL                                     BLB01160
       CLA     EOR            IDENTIFIER,                               BLB01170
       TSX     INITL+1,4                                                BLB01180
       CLA     -20,1          NUMBER OF BLOCKS                          BLB01190
       TSX     (DECVA,4       IN FILE,                                  BLB01200
       ZET     120CHR            120 CHARACTER LABEL +                  BLB01210
       TRA     TRL120        YES-TRANSFER                               BLB01220
       STQ     1,2                                                      BLB01230
       LDQ     TPUNT          AND ADDRESS                               BLB01240
       RQL     21             OF UCB.                                   BLB01250
       TSX     (BCD5X,4                                                 BLB01260
       SLW     2,2                                                      BLB01270
       TRA     LBT30         RETURN                                     BLB01280
TRL120 LGL     2             KNOCK OUT LEADING BLANK -                  BLB01290
       RQL     34             IT MUST BE ZERO FOR 120 CHAR. LABEL.      BLB01300
       STQ     11,2          STORE NUMBER OF BLOCKS IN LABEL.           BLB01310
       TRA     LBT30         RETURN                                     BLB01320
120CHR PZE     0                                                        BLB01330
*                                                                       BLB01340
* PREPARE STANDARD HEADER LABEL OUTPUT FROM FINAL MERGE.                BLB01350
*                                                                       BLB01360
PSHLB  LAC     OFBLC,1       PREPARE ONLY STANDARD                      BLB01370
       NZT     -3,1          FORMAT LABELS                              BLB01380
       TRA     PSH10                                                    BLB01390
       LAC     LBCAD,2       MOVE                                       BLB01400
       NZT     LBCAD         THE                                        BLB01410
       LAC     LBRED,2       ORIGINAL INPUT                             BLB01420
       LAC     LBCST,1       LABEL OR INPUT CARD                        BLB01430
       STZ     TPUNT         TO THE                                     BLB01440
       TRA     MVFLB+1       WRITE AREA                                 BLB01450
PSH10  TSX     INITL,4                                                  BLB01460
       ZET     120CHR                                                   BLB01470
       TRA     CONT1                                                    BLB01480
       CLA     -11,1         GATHER INFORMATION INTO THE LABEL AREA     BLB01490
       STO     7,2            INCLUDING                                 BLB01500
       CLA     -12,1          THREE NAME WORDS,                         BLB01510
       STO     8,2                                                      BLB01520
       CLA     -13,1                                                    BLB01530
       STO     9,2                                                      BLB01540
       CLA     -6,1           FILE SERIAL NUMBER,                       BLB01550
       STO     2,2                                                      BLB01560
       CLA     -7,1           REEL SEQUENCE NUMBER, AND                 BLB01570
       STO     3,2                                                      BLB01580
       CLA     -18,1          DAYS TO RETAIN.                           BLB01590
       STO     5,2                                                      BLB01600
       LDI     120CHR         SET BITS FOR                              BLB01610
       NZT     -1,1                                                     BLB01620
       SIL     100            DENSITY,                                  BLB01630
       ZET     0,1                                                      BLB01640
       SIL     1              MODE,                                     BLB01650
       ZET     -8,1                                                     BLB01660
       SIR     10000          BLOCK CHECK SUM, AND                      BLB01670
       ZET     -9,1                                                     BLB01680
       SIR     100            BLOCK SEQUENCE INDICATOR.                 BLB01690
       SIL     600000                                                   BLB01700
       STI     6,2                                                      BLB01710
       CLA     STDAT         SET DATE OF SORT.                          BLB01720
       STO     4,2                                                      BLB01730
       TRA     LBT30                                                    BLB01740
* PREPARE 120  CHARACTER  HEADER  LABEL                                 BLB01750
CONT1  CAL     -18,1         RETENTION                                  BLB01760
       ANA     =O777700777777                                           BLB01770
       LDQ     STDAT             PERIOD                                 BLB01780
       LGL     12                CREATION                               BLB01790
       SLW     1,2               DATE                                   BLB01800
       LGL     24                                                       BLB01810
       LDQ     -11,1                                                    BLB01820
       LGL     18                NAME                                   BLB01830
       SLW     2,2               INTO                                   BLB01840
       LGL     18                PROPER                                 BLB01850
       LDQ     -12,1             LABEL                                  BLB01860
       LGL     18                AREAS                                  BLB01870
       SLW     3,2               ALONG                                  BLB01880
       LGL     6                 WITH                                   BLB01890
       LDQ     -6,1              FILE                                   BLB01900
       RQL     6                 SERIAL                                 BLB01910
       LGL     30                NUMBER                                 BLB01920
       SLW     4,2                                                      BLB01930
       CAL     -7,1              REEL SEQUENCE NUMBER                   BLB01940
       LDQ     BLANK             AND PADDING                            BLB01950
       LGL     6             AND                                        BLB01960
       SLW     6,2               STORE IT                               BLB01970
       LDQ     BITONE            SET BITS FOR                           BLB01980
       NZT     -1,1              DENSITY                                BLB01990
       LDQ     BITTWO                                                   BLB02000
       LGL     6                                                        BLB02010
       ZET     -8,1              BLOCK CHECKSUM                         BLB02020
       LDQ     BITONE                                                   BLB02030
       LGL     6                                                        BLB02040
       ZET     -9,1              BLOCK SEQUENCE INDICATOR               BLB02050
       LDQ     BITONE                                                   BLB02060
       LGL     6                                                        BLB02070
       LDQ     BITONE                                                   BLB02080
       NZT     0,1               MODE                                   BLB02090
       LDQ     BITTWO                                                   BLB02100
       LGL     6                                                        BLB02110
       SLW     7,2                                                      BLB02120
       LXD     LABPR-1,4                                                BLB02130
       LDQ     BITSIX            729                                    BLB02140
       TXL     *+2,4,0       OR                                         BLB02150
       LDQ     BITEGT            7340                                   BLB02160
       LGL     6                                                        BLB02170
       LDQ     BITSIX                                                   BLB02180
       LGL     6                 PLACE                                  BLB02190
       LDQ     H709              CREATING                               BLB02200
       LGL     24                SYSTEM                                 BLB02210
       SLW     8,2               IN                                     BLB02220
       LDQ     RECPR-1           GET RECORD LENGTH IF VARIABLE          BLB02230
       NZT     RECPR-5       VARIABLE +                                 BLB02240
       LDQ     RECPR-2       NO-GET FIXED RECORD LENGTH                 BLB02250
       MPY     SIX               GET NUMBER OF CHARACTERS IN LENGTH     BLB02260
       XCA                                                              BLB02270
       PAI                                                              BLB02280
       TSX     (DECVA,4          CONVERT                                BLB02290
       STQ     9,2               AND STORE                              BLB02300
       NZT     RECPR-5                                                  BLB02310
       TRA     CONT8                                                    BLB02320
       LDQ     -5,1          GET BLOCKSIZE IF VARIABLE.                 BLB02330
       MPY     SIX                                                      BLB02340
       PIA                                                              BLB02350
       TLQ     CONT8+1                                                  BLB02360
       XCA                                                              BLB02370
       TRA     CONT8+1                                                  BLB02380
CONT8  CLA     -23,1         GET BLOCKSIZE IF FIXED.                    BLB02390
       TSX     (DECVA,4          YES-CONVERT                            BLB02400
       XCL                                                              BLB02410
       LDQ     BITONE            IF CHECKPOINT                          BLB02420
       ZET     -17,1             CHECKPOINT +                           BLB02430
       LDQ     SIX            NO-LOAD LEADING ZERO                      BLB02440
       LGL     6                                                        BLB02450
       SLW     10,2                                                     BLB02460
       TRA     LBT30             RETURN                                 BLB02470
BITONE OCT     010000000000                                             BLB02480
BITTWO OCT     020000000000                                             BLB02490
BITSIX OCT     060000000000                                             BLB02500
BITEGT OCT     100000000000                                             BLB02510
SIX    DEC     6                                                        BLB02520
H709   BCI     2,7090  0 SORT                                           BLB02530
*                                                                       BLB02540
* CHECK STANDARD TRAILER LABEL INPUT TO SORT.                           BLB02550
*                                                                       BLB02560
 CSTLB TSX     CKFSI,4                                                  BLB02570
       LDI     0,2           SAVE EOR OR EOF.                           BLB02580
       LNT     012546        VALID TRAILER +                            BLB02590
       TRA     NOTRL         NO                                         BLB02600
       CLA     GENPR-7       CHANGE NUMBER OF BLOCKS                    BLB02610
       TSX     (DECVA,4       READ TO BCD AND COMPARE                   BLB02620
       XCA                    NUMBER OF BLOCKS                          BLB02630
       NZT     120CHR        COMPARE BLOCK COUNT.                       BLB02640
       TXI     *+1,2,10      84 CHARACTER LABEL.                        BLB02650
       ERA     11,2                                                     BLB02660
       ALS     3             SPILL LEFTMOST 2 BITS OUT OF AC.           BLB02670
       TZE     LBT10         EXIT IF THEY AGREE                         BLB02680
CST20  LDQ*    TPUNT                                                    BLB02690
       TSX     MSGSUP,4,3                                               BLB02700
               LB02,,3                                                  BLB02710
       LAC     LBCST,2       -LOCATION OF LABEL AREA                 (4)BLB02715
       LDI     0,2           RESTORE  INDICATORS                     (4)BLB02717
       TRA     LBT10                                                    BLB02720
LB02   BCI     3,*LB02 ,BLK CNT ERR                                     BLB02730
*                                                                       BLB02740
NOTRL  TSX     PRTLBL,4                                                 BLB02750
       BCI     1,*LB08                                                  BLB02760
*                                                                       BLB02770
* CHECK FOR STANDARD LABEL ON INPUT.                                    BLB02780
*                                                                       BLB02790
 CKFSI PIA                                                              BLB02800
       PAC     ,1            PREPARE TO CHECK LABELS ONLY               BLB02810
       NZT     -3,1           IF THEY HAVE STANDARD FORMAT              BLB02820
       TRA     1,4                                                      BLB02830
       ZET     FIRST          TEST TO SEE IF LABEL ALREADY MOVED        BLB02840
       TRA     LBT10          RETURN                                    BLB02850
       STL     FIRST                                                    BLB02860
       NZT     LABPR-2        TEST FOR LABEL CARD GIVEN                 BLB02870
       TRA     MVFLB          LABEL CARD GIVEN                          BLB02880
       TRA     LBT10          LABEL CARD NOT GIVEN RETURN               BLB02890
 FIRST PZE                    SWITCH FOR LABEL MOVED ONE                BLB02900
*                                                                       BLB02910
* CHECK STANDARD HEADER LABEL INPUT TO SORT.                            BLB02920
*                                                                       BLB02930
 CSHLB TSX     CKFSI,4                                                  BLB02940
       CLA     0,2                                                      BLB02950
       SUB     HDR                                                      BLB02960
       TZE     *+3                                                      BLB02970
       TSX     PRTLBL,4      NOT A HEADER                               BLB02980
       BCI     1,*LB07       LABEL                                      BLB02990
       CLA     -11,1         IF A FILE NAME WAS                         BLB03000
       TZE     CSH10          GIVEN IN THE                              BLB03010
       ZET     120CHR            120 CHARACTER LABEL +                  BLB03020
       TRA     CHD120            YES                                    BLB03030
       SUB     7,2            INPUT FILE CARD CHECK                     BLB03040
       TNZ     CSH05          EACH WORD                                 BLB03050
       CLA     -12,1          OF THE NAME IN THE                        BLB03060
       SUB     8,2            CARD AGAINST THE                          BLB03070
       TNZ     CSH05          CORRESPONDING WORD                        BLB03080
       CLA     -13,1          FROM THE LABEL.                           BLB03090
       SUB     9,2           PRINT THE INVALID MESSAGE IF               BLB03100
       TZE     CSH10          THE NAMES DO NOT MATCH.                   BLB03110
CSH05  TSX     PRTLBL,4                                                 BLB03120
       BCI     1,*LB03                                                  BLB03130
CHD120 CAL     2,2           CHECK FILE                                 BLB03140
       LDQ     3,2           NAME IN LABEL                              BLB03150
       LGL     18            AGAINST THE ONE IN                         BLB03160
       ERA     -11,1         THE FILE DATA BLOCK                        BLB03170
       TNZ     CSH05         TRANSFER IF THEY DISAGREE                  BLB03180
CSH10  NZT     -6,1          FILE SERIAL NUMBER GIVEN +                 BLB03190
       TRA     CSH15         NO-TRANSFER                                BLB03200
       CAL     2,2           YES-CHECK IT                               BLB03210
       ZET     120CHR        AGAINST THE                                BLB03220
       TSX     FS120,4       ONE IN THE                                 BLB03230
       ERA     -6,1          LABEL                                      BLB03240
       TZE     CSH15         TRANSFER IF THEY AGREE                     BLB03250
       TSX     PRTLBL,4                                                 BLB03260
       BCI     1,*LB04                                                  BLB03270
 CSH15 CLA     -7,1          IF A REEL SEQUENCE NUMBER WAS GIVEN        BLB03280
       TZE     CSH20          IN THE INPUT FILE CARD, CHECK IT          BLB03290
       SUB     3,2           CHECK REEL                                 BLB03300
       NZT     120CHR        SEQUENCE NUMBER                            BLB03310
       TRA     *+5           IN THE                                     BLB03320
       LDQ     BLANK         LABEL                                      BLB03330
       CLA     -7,1          AGAINST THE ONE IN THE                     BLB03340
       LGL     6             FILE DATA BLOCK                            BLB03350
       ERA     6,2                                                      BLB03360
       TZE     CSH20         TRANSFER IF THEY AGREE                     BLB03370
       TSX     PRTLBL,4                                                 BLB03380
       BCI     1,*LB05                                                  BLB03390
CSH20  STZ     0,1           INITIALIZE                                 BLB03400
       STZ     -1,1          FILE                                       BLB03410
       STZ     -8,1          DATA                                       BLB03420
       STZ     -9,1          BLOCK                                      BLB03430
       ZET     120CHR                                                   BLB03440
       TRA     120CSH                                                   BLB03450
       LDI     6,2               USING THE INFO FROM THE LABEL          BLB03460
       LFT     1              MODE,                                     BLB03470
       STL     0,1                                                      BLB03480
       LNT     100            DENSITY,                                  BLB03490
       STL     -1,1                                                     BLB03500
       RFT     10000          BLOCK CHECK SUM INDICATOR, AND            BLB03510
       STL     -8,1                                                     BLB03520
       RFT     100            BLOCK SEQUENCE INDICATOR.                 BLB03530
       STL     -9,1                                                     BLB03540
ENTCSH CLA     -8,1          SET CELL (NZ) IF EITHER                    BLB03550
       ADD     -9,1           CHECKSUMS AND/OR BLOCK SEQUENCE,          BLB03560
       STO     -19,1          WAS INDICATED.                            BLB03570
       CLA     0,1                                                      BLB03580
       STO     GENPR-1                                                  BLB03590
       TRA     LBT10         GO TO NORMAL RETURN.                       BLB03600
120CSH CAL     7,2           USING THE LABEL                            BLB03610
       LDQ     8,2               SET FILE DATA                          BLB03620
       LGL     12                BLOCK CELLS                            BLB03630
       PAI                       FOR                                    BLB03640
       LNT     20000         DENSITY                                    BLB03650
       STL     -1,1                                                     BLB03660
       LFT     001700        CHECKSUM INDICATOR                         BLB03670
       STL     -8,1              YES                                    BLB03680
       LFT     000017            BLOCK SEQUENCE INDICATOR               BLB03690
       STL     -9,1              YES                                    BLB03700
       RNT     20000         MODE                                       BLB03710
       STL     -0,1                                                     BLB03720
       TRA     ENTCSH                                                   BLB03730
FS120  CAL     BLANK         INSERT A LEADING                           BLB03740
       LDQ     4,2           BLANK INTO THE                             BLB03750
       RQL     6             FILE SERIAL NUMBER                         BLB03760
       LGL     30            BEFORE COMPARING                           BLB03770
       TRA     1,4                                                      BLB03780
*                                                                       BLB03790
* CHECK INTERMEDIATE HEADER LABEL.                                      BLB03800
*                                                                       BLB03810
CIHLB  LAC     INTNM,1           CHECK                                  BLB03820
       CAL     3,2           CHECK NAME                                 BLB03830
       ERA     NAME          ON LABEL                                   BLB03840
       TNZ     CIH20         TRANSFER ON ERROR                          BLB03850
       AXT     3,4                                                      BLB03860
120LOP CAL     17,2                                                     BLB03870
       ERA     1,1                                                      BLB03880
       TNZ     CIH20                                                    BLB03890
       TXI     *+1,1,-1                                                 BLB03900
       TXI     *+1,2,-1                                                 BLB03910
       TIX     120LOP,4,1                                               BLB03920
       TRA     LBT10                                                    BLB03930
CIH20  TSX     PRTLBL-1,4                                               BLB03940
       BCI     1,*LB06                                                  BLB03950
       STL     120CHR                                                   BLB03960
PRTLBL CLA     1,4                                                      BLB03970
       STO     LBERR                                                    BLB03980
       AXT     10,4                                                     BLB03990
       NZT     120CHR                                                   BLB04000
       AXT     4,4                                                      BLB04010
       SXD     LBLOC+1,4                                                BLB04020
       LDQ*    TPUNT                                                    BLB04030
       TSX     MSGSUP,4,3                                               BLB04040
               LBERR,,5+4*512                                           BLB04050
       LXA     LBCST,4                                                  BLB04060
       SXA     LBLOC,4                                                  BLB04070
       TXI     *+1,4,10                                                 BLB04080
       SXA     LBLOC+1,4                                                BLB04090
       TSX     MSGSUP,4,2                                               BLB04100
               3                                                        BLB04110
LBLOC          **,,10+4*512                                             BLB04120
               **,,10                                                   BLB04130
               SS4MSG,,10+4*512                                         BLB04140
CSH07  TSX     (PAUSE,4                                                 BLB04150
       SWT     4                                                        BLB04160
       TRA     LBT25                                                    BLB04170
       TRA     LBT10                                                    BLB04180
LBERR  BCI     5,      ,LABEL ERROR.LABEL IS                            BLB04190
SS4MSG BCI     6,PUT SS4 DOWN TO IGNORE LABEL.PUT SS4                   BLB04200
       BCI     4,UP TO RETRY,PRESS START                                BLB04210
*                                                                       BLB04220
* PREPARE INTERMEDIATE HEADER LABEL.                                    BLB04230
*                                                                       BLB04240
PIHLB  TSX     INITL,4                                                  BLB04250
       LAC     INTNM,1                                                  BLB04260
       ZAC                       ZERO OUT RETENTION PERIOD              BLB04270
       LDQ     STDAT             PUT IN CREATION                        BLB04280
       LGL     12                DATE                                   BLB04290
       SLW     1,2                                                      BLB04300
       LGL     6                                                        BLB04310
       STQ     2,2                                                      BLB04320
       CLA     NAME          MOVE                                       BLB04330
       STO     3,2           INTERMEDIATE                               BLB04340
       CLA     H709          NAME                                       BLB04350
       STO     8,2           AND                                        BLB04360
       CLA     1,1           CREATING                                   BLB04370
       STO     17,2          SYSTEM                                     BLB04380
       CLA     2,1           INTO                                       BLB04390
       STO     18,2          LABEL                                      BLB04400
       CLA     3,1               *                                      BLB04410
       STO     19,2              *                                      BLB04420
       TRA     LBT30             *                                      BLB04430
INITL  CLA     HDR           SET LABEL                                  BLB04440
       STO     0,2           IDENT                                      BLB04450
       AXT     19,1                                                     BLB04460
       CLA     BLANK                                                    BLB04470
       STO     1,2           INITIALIZE LABEL AREA                      BLB04480
       TXI     *+1,2,-1      WITH                                       BLB04490
       TIX     *-2,1,1       BLANKS                                     BLB04500
       LAC     LBCST,2                                                  BLB04510
       PIA                                                              BLB04520
       PAC     ,1                                                       BLB04530
       TRA     1,4                                                      BLB04540
       EJECT                                                            BLB04550
       COMMON  17                                                       BLB04560
 LABPR COMMON  5             LABEL CARD PARAMETERS                      BLB04570
       COMMON  6                                                        BLB04580
 FILPR COMMON  14            FILE CARD PARAMETERS                       BLB04590
 MODPR COMMON  50                                                       BLB04600
RECPR  COMMON  10                                                       BLB04610
       COMMON  9                                                        BLB04620
 CALPR COMMON  50            CALCULATED PARAMETERS                      BLB04630
 GENPR COMMON  10            GENERAL PARAMETERS                         BLB04640
       SPACE                                                            BLB04650
 LBCST EQU     LABPR-0                                                  BLB04660
 LBRED EQU     LABPR-1                                                  BLB04670
 LBCAD EQU     LABPR-2                                                  BLB04680
 INTNM EQU     LABPR-4                                                  BLB04690
 IFBLC EQU     FILPR-0       (INPUT FILE BLOCK LOCATION)                BLB04700
 OFBLC EQU     FILPR-1       (OUTPUT FILE BLOCK LOCATION)               BLB04710
 STDAT EQU     CALPR-0       (DATE OF THIS SORT)                        BLB04720
LBT25  EQU     LBT30                                                    BLB04730
       SPACE                                                            BLB04740
 TPUNT                       (TAPE UNIT'S UCW LOCATION IN ADDRESS)      BLB04750
       EXTERN  MSGSUP                                                   BLB04760
 HDR   BCI     1,1HDR                                                   BLB04770
 EOR   BCI     1,1EOR                                                   BLB04780
BLANK  BCI     1,                                                       BLB04790
 EOF   BCI     1,1EOF                                                   BLB04800
NAME   BCI     2,SORT  SYSCK2                                           BLB04810
       SPACE                                                            BLB04820
       END                                                              BLB04830
*  7090/94 SORT, VER 7, MOD 0.  BINARY TO DECIMAL CONVERSION            CBT00000
*      FAP
       COUNT   1000                                                     CBT00010
       ENTRY   BTD                                                      CBT00020
* BINARY TO DECIMAL CONVERSION, UP TO 11 DECIMAL DIGITS.                CBT00030
*   NUMBER TO BE CONVERTED IS LOADED IN MQ.                             CBT00040
*   THE DECIMAL NUMBER WILL BE STORED IN AC AND MQ                      CBT00050
*   SENSE LIGHT 2 IS USED                                               CBT00060
*   CALLING SEQUENCE IS   TSX   BTD,4                                   CBT00070
*                         RETURN                                        CBT00080
*                                                                       CBT00090
       TITLE                                                            CBT00100
BTD    SXA     BT4,4                                                    CBT00110
       SXA     BT2,2                                                    CBT00120
       SXA     BT1,1                                                    CBT00130
       STZ     CELL                                                     CBT00140
       STZ     CELL+1                                                   CBT00150
       XCA                                                              CBT00160
       TZE     BTDD                                                     CBT00170
       XCA                                                              CBT00180
       SLN     2                                                        CBT00190
       AXT     2,4                                                      CBT00200
       AXT     6,2                                                      CBT00210
       AXT     5,1                                                      CBT00220
BTDB   PXD     ,                                                        CBT00230
       DVP     DECI+5,1                                                 CBT00240
       XCA                                                              CBT00250
       TZE     BTDA                                                     CBT00260
       SLT     2                                                        CBT00270
       NOP                                                              CBT00280
BTDC   ALS     30,2                                                     CBT00290
       ORS     CELL+2,4                                                 CBT00300
       TXI     *+1,2,6                                                  CBT00310
       TIX     BTDB,1,1                                                 CBT00320
*                                                                       CBT00330
       CLA     BTDB+1                                                   CBT00340
       ADD     SIX                                                      CBT00350
       STO     BTDB+1                                                   CBT00360
       AXT     0,2                                                      CBT00370
       AXT     6,1                                                      CBT00380
       TIX     BTDB,4,1                                                 CBT00390
*                                                                       CBT00400
       CLS     SIX                                                      CBT00410
       ALS     1                                                        CBT00420
       ADD     BTDB+1                                                   CBT00430
       STO     BTDB+1                                                   CBT00440
       CLA     CELL                                                     CBT00450
       LDQ     CELL+1                                                   CBT00460
BT4    AXT     ,4                                                       CBT00470
 BT2   AXT     **,2                                                     CBT00480
 BT1   AXT     **,1                                                     CBT00490
       TRA     1,4                                                      CBT00500
*                                                                       CBT00510
BTDD   LDQ     BLANK                                                    CBT00520
       LGL     6                                                        CBT00530
       CLA     BLANK                                                    CBT00540
       TRA     BT4                                                      CBT00550
*                                                                       CBT00560
BTDA   SLT     2                                                        CBT00570
       TRA     BTDC                                                     CBT00580
       SLN     2                                                        CBT00590
       ACL     BLANK                                                    CBT00600
       TRA     BTDC                                                     CBT00610
       SPACE                                                            CBT00620
CELL   BSS     2                                                        CBT00630
DECI   DEC     10000000000,1000000000,100000000,10000000,1000000        CBT00640
       DEC     100000,10000,1000,100,10,1                               CBT00650
SIX    DEC     6                                                        CBT00660
BLANK  BCI     1,                                                       CBT00670
       DETAIL                                                           CBT00680
       END                                                              CBT00690
* 7090/7094 SORT VER 7 MOD 10 CALCULATIONS SUBPROGRAM               (10)CCA00000
*      FAP
       COUNT   1000                                                     CCA00010
       ENTRY   CALC                                                     CCA00020
       SST                                                              CCA00030
*                                                                       CCA00040
       PMC                                                              CCA00050
 PLIST MACRO   ZA,ZB,ZC,QRA,QRB,QRC,QRD,QRE,QRF,QRG                     CCA00060
       LXA     OSREL,1        COMMON RELOCATION                         CCA00070
QRA    SXA     QRC,4                                                    CCA00080
       AXT     ZA,4           ZA = NUMBER OF MODIFICATIONS              CCA00090
QRB    CAL     ZB,1           ZB = BASE OF MODIFICATION SWITCHES        CCA00100
       SXA     QRD,4                                                    CCA00110
       TZE     QRD                                                      CCA00120
       ANA     =O700777000000                                           CCA00130
       TNZ     QRD                                                      CCA00140
       CAL     ZC,4           ZC = PROGRAM NAME BASE                    CCA00150
QRC    AXT     **,4                                                     CCA00160
       SLW     0,4            SAVE IN PROGRAM LIST                      CCA00170
       CAL     ZB,1                                                     CCA00180
       ARS     27                                                       CCA00190
       ANA     =O77                                                     CCA00200
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA00210
       TXI     *+1,4,-1                                                 CCA00220
       TXI     *+1,2,1                                                  CCA00230
       SXA     QRC,4                                                    CCA00240
QRD    AXT     **,4                                                     CCA00250
       TXI     *+1,1,1                                                  CCA00260
       TIX     QRB,4,1                                                  CCA00270
       XEC     QRC                                                      CCA00280
       SXA     QRF,4                                                    CCA00290
       AXT     ZA,4                                                     CCA00300
       LXA     OSREL,1                                                  CCA00310
QRE    CAL     ZB,1                                                     CCA00320
       SXA     QRG,4                                                    CCA00330
       TZE     QRG                                                      CCA00340
       ANA     =O700777000000                                           CCA00350
       TZE     QRG                                                      CCA00360
       ARS     18                                                       CCA00370
       ADD     =O1000000                                                CCA00380
       LDQ     ZC,4                                                     CCA00390
QRF    AXT     **,4                                                     CCA00400
       SLW     0,4                                                      CCA00410
       TXI     *+1,4,-1                                                 CCA00420
       STQ     0,4                                                      CCA00430
       CAL     ZB,1                                                     CCA00440
       ARS     27                                                       CCA00450
       ANA     =O77                                                     CCA00460
       ORS     0,4                                                      CCA00470
       TXI     *+1,4,-1                                                 CCA00480
       TXI     *+1,2,2                                                  CCA00490
       SXA     QRF,4                                                    CCA00500
QRG    AXT     **,4                                                     CCA00510
       CLA     =O77777                                                  CCA00520
       ANS     ZB,1                                                     CCA00530
       TXI     *+1,1,1                                                  CCA00540
       TIX     QRE,4,1                                                  CCA00550
 PLIST END                                                              CCA00560
       EJECT                                                            CCA00570
       TITLE                                                            CCA00580
 CALC  BSS     0                                                        CCA00590
       SXA     OSREL,1        COMMON RELOCATION                         CCA00600
       SXA     EP002,2        CALLING RETURN TO MONITOR                 CCA00610
       SXA     PROVO,4        TO EP001                                  CCA00620
       STO     HYPSW                                                    CCA00630
*                                                                       CCA00640
*  CALCULATION OF DATE TO BE USED IN LABELS                             CCA00650
*                                                                       CCA00660
 CALCU LDQ     SYSDAT        SYSTEM DATE                                CCA00670
       PXA     0,0                                                      CCA00680
       LGL     12             EXTRACT MONTH                             CCA00690
       STA     MONTH                                                    CCA00700
       PXA     0,0                                                      CCA00710
       LGL     12             EXTRACT DAY                               CCA00720
       STA     DAY                                                      CCA00730
       PXA     0,0                                                      CCA00740
       LGL     12             EXTRACT YEAR                              CCA00750
       STA     YEAR                                                     CCA00760
       LDQ     YEAR                                                     CCA00770
       CALL    CNVRT         CONVERT YEAR TO BINARY.                    CCA00780
       TRA     *+1                                                      CCA00790
       XCA                                                              CCA00800
       DVP     =4             TEST FOR LEAP YEAR                        CCA00810
       TNZ     *+3                                                      CCA00820
       CLA     =1                                                       CCA00830
       STO     LEPYR          SET LEAP YEAR SWITCH                      CCA00840
       LDQ     MONTH                                                    CCA00850
       CALL    CNVRT         CONVERT MONTH TO BINARY.                   CCA00860
       TRA     *+1                                                      CCA00870
       PAX     0,2                                                      CCA00880
       TXH     *+2,2,2        TEST FOR JANUARY OR FEBRUARY              CCA00890
       STZ     LEPYR                                                    CCA00900
       LDQ     DAY                                                      CCA00910
       CALL    CNVRT         CONVERT DAY TO BINARY                      CCA00920
       TRA     *+1                                                      CCA00930
       ADD     CNDAT,2        ADD NUMBER OF DAYS TO END OF LAST MONTH   CCA00940
       ADD     LEPYR          ADD LEAP YEAR COUNT IF GIVEN              CCA00950
       XCA                                                              CCA00960
       PXA     0,0                                                      CCA00970
       DVP     =100                                                     CCA00980
       XCA                                                              CCA00990
       ALS     12                                                       CCA01000
       ORS     DATE                                                     CCA01010
       PXA     0,0                                                      CCA01020
       DVP     =10                                                      CCA01030
       ORS     DATE                                                     CCA01040
       XCA                                                              CCA01050
       ALS     6                                                        CCA01060
       ORS     DATE                                                     CCA01070
       CLA     YEAR                                                     CCA01080
       LDQ     =O600000000000                                           CCA01090
       LGL     6                                                        CCA01100
       ALS     18                                                       CCA01110
       ORS     DATE                                                     CCA01120
       CAL     DATE                                                     CCA01130
       LXA     OSREL,1                                                  CCA01140
       SLW     CAL00,1        SAVE DATE IN COMMON                       CCA01150
       TRA     PADCL                                                    CCA01160
 MONTH                                                                  CCA01170
 DAY                                                                    CCA01180
 YEAR                                                                   CCA01190
 LEPYR                                                                  CCA01200
 DATE                                                                   CCA01210
       DEC     334,304,273,243,212,181,151,120,90,59,31,0               CCA01220
 CNDAT BSS     0                                                        CCA01230
       SPACE   2                                                        CCA01240
*                                                                       CCA01250
*      CALCULATE TOTAL WORDS IN ALL CONTROL FIELDS                      CCA01260
*                                                                       CCA01270
PADCL  LXA     OSREL,1                                                  CCA01280
       CAL     CAL12,1                                                  CCA01290
       SLW     CAL32,1                                                  CCA01300
       CAL     =O631463                                                 CCA01310
       SLW     RAW09,1                                                  CCA01320
       STL     RAW25,1                                                  CCA01330
       SPACE                                                            CCA01340
*                                                                       CCA01350
*      BUILD PROGRAM LIST FOR PHASE 1.                                  CCA01360
*                                                                       CCA01370
       STZ     XSLEN          RESET XS LENGTH                           CCA01380
       STZ     MRLEN          RESET MR LENGTH                           CCA01390
       STZ     FMLEN          RESET FM LENGTH                           CCA01400
       NZT     SAM04,1                                                  CCA01410
       TRA     FMMOD         TRANSFER IF MERGE ONLY.                    CCA01420
       LXA     EP002,4       FIND ADDRESS OF PROGRAM LIST               CCA01430
       CAL     8,4           CONTAINS XSADD                             CCA01440
       LDQ     9,4                                                      CCA01450
       PDX     0,2           PRESENT PROGRAM COUNT                      CCA01460
       PAC     0,4                                                      CCA01470
       XCL                                                              CCA01480
       ADD     =1             CALCULATE LOCATION OF TCP PROGRAM         CCA01490
       STA     PHONE                                                    CCA01500
       ZET     OPT02,1                                                  CCA01510
       TRA     NORES1                                                   CCA01520
       CAL     =HHYSTAR                                                 CCA01530
       SLW     0,4                                                      CCA01540
       TXI     *+1,2,1                                                  CCA01550
       TXI     *+1,4,-1                                                 CCA01560
NORES1 CAL     =HBTD                                                    CCA01570
       SLW     0,4                                                      CCA01580
       CAL     =HDEBLK                                                  CCA01590
       SLW     1,4                                                      CCA01600
       CAL     =HXTRACT                                                 CCA01610
       SLW     2,4                                                      CCA01620
       TXI     *+1,2,3                                                  CCA01630
       TXI     *+1,4,-3                                                 CCA01640
       ZET     OPT02,1       TEST NOCKPT OPTION.                        CCA01650
       TRA     RH21                                                     CCA01660
       CAL     =HCKPT                                                   CCA01670
       SLW     0,4                                                      CCA01680
       TXI     *+1,2,1                                                  CCA01690
       TXI     *+1,4,-1                                                 CCA01700
 RH21  NZT     DEL00,1       TEST DELETE OPTION                         CCA01710
       TRA     RH23                                                     CCA01720
       CAL     =HDELETE                                                 CCA01730
       SLW     0,4                                                      CCA01740
       TXI     *+1,2,1                                                  CCA01750
       TXI     *+1,4,-1                                                 CCA01760
       NZT     REC05,1                                                  CCA01770
       ZET     OPT04,1                                                  CCA01780
       TRA     RH23                                                     CCA01790
       CAL     =HWTFIX                                                  CCA01800
       SLW     0,4                                                      CCA01810
       TXI     *+1,2,1                                                  CCA01820
       TXI     *+1,4,-1                                                 CCA01830
 RH23  ZET     REC05,1                                                  CCA01840
       TRA     RH24          TRANSFER IF VARIABLE.                      CCA01850
       CAL     =HFXS                                                    CCA01860
 PHONE SLW     **                                                       CCA01870
       SLW     0,4                                                      CCA01880
       CAL     =HREAD                                                   CCA01890
       ZET     OPT04,1                                                  CCA01900
       CAL     =HBUFRD                                                  CCA01910
       SLW     1,4                                                      CCA01920
       CAL     =HWRITE                                                  CCA01930
       SLW     2,4                                                      CCA01940
       TXI     *+1,2,3                                                  CCA01950
       TXI     RH25,4,-3                                                CCA01960
 RH24  CAL     =HVXS                                                    CCA01970
       SLW*    PHONE                                                    CCA01980
       SLW     0,4                                                      CCA01990
       CAL     =HGET         729 PROGRAM.                               CCA02000
       ZET     HYPSW                                                    CCA02010
       CAL     =HHYGET       GET HYPER GET PROGRAM.                     CCA02020
       SLW     1,4                                                      CCA02030
       CAL     =HPUT          PUT ROUTINE TO LOAD LIST                  CCA02040
       SLW     2,4                                                      CCA02050
       TXI     *+1,2,3                                                  CCA02060
       TXI     RH25,4,-3                                                CCA02070
RH25   CAL     =HIOPEN       729 PROGRAM.                               CCA02080
       ZET     HYPSW                                                    CCA02090
       CAL     =HHYOPEN      HYPER PROGRAM                              CCA02100
       SLW     0,4                                                      CCA02110
       CAL     =HLABEL                                                  CCA02120
       SLW     1,4                                                      CCA02130
       TXI     *+1,2,2                                                  CCA02140
       TXI     *+1,4,-2                                                 CCA02150
       SXA     RHSXA,4       SAVE LOCATION OF NAMES IN LIST.            CCA02160
       AXT     10,4                                                     CCA02170
 RH26  CAL     MOD00,1                                                  CCA02180
       SXA     RHAXT,4                                                  CCA02190
       TZE     RHAXT          TEST IF MODIFICATION GIVEN                CCA02200
       ANA     =O700777000000                                           CCA02210
       TNZ     RHAXT          TEST FOR MOD OTHER THAN LIBRARY TAPE      CCA02220
       CAL     MODTAB,4                                                 CCA02230
RHSXA  AXT     **,4                                                     CCA02240
       SLW     0,4            SAVE IN LOAD LIST                         CCA02250
       CAL     MOD00,1                                                  CCA02260
       ARS     27                                                       CCA02270
       ANA     =O77                                                     CCA02280
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA02290
       TXI     *+1,4,-1                                                 CCA02300
       TXI     *+1,2,1                                                  CCA02310
       SXA     RHSXA,4                                                  CCA02320
 RHAXT AXT     **,4                                                     CCA02330
       TXI     *+1,1,1                                                  CCA02340
       TIX     RH26,4,1       TEST FOR MORE MODS                        CCA02350
       LXA     EP002,4        LOCATION OF RETURN TO SORT MONITOR        CCA02360
       CAL     9,4                                                      CCA02370
       ARS     18                                                       CCA02380
       STA     *+1            LOCATION OF COUNT FOR NUMBER OF MODS      CCA02390
       SXD     **,2                                                     CCA02400
       XEC     RHSXA                                                    CCA02410
       SXA     RHSAV,4                                                  CCA02420
       AXT     10,4                                                     CCA02430
       LXA     OSREL,1        COMMON RELOCATION                         CCA02440
 RH28  CAL     MOD00,1                                                  CCA02450
       SXA     RHAXV,4                                                  CCA02460
       TZE     RHAXV          TEST FOR MODIFICATION GIVEN               CCA02470
       ANA     =O700777000000                                           CCA02480
       TZE     RHAXV          TEST FOR MOD ON OTHER THAN LIBRARY TAPE   CCA02490
       ARS     18                                                       CCA02500
       ADD     =O1000000                                                CCA02510
       LDQ     MODTAB,4                                                 CCA02520
 RHSAV AXT     **,4                                                     CCA02530
       SLW     0,4                                                      CCA02540
       TXI     *+1,4,-1                                                 CCA02550
       STQ     0,4                                                      CCA02560
       CAL     MOD00,1                                                  CCA02570
       ARS     27                                                       CCA02580
       ANA     =O77                                                     CCA02590
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA02600
       TXI     *+1,4,-1                                                 CCA02610
       TXI     *+1,2,2                                                  CCA02620
       SXA     RHSAV,4                                                  CCA02630
 RHAXV AXT     **,4                                                     CCA02640
       CLA     =O77777                                                  CCA02650
       ANS     MOD00,1                                                  CCA02660
       TXI     *+1,1,1                                                  CCA02670
       TIX     RH28,4,1                                                 CCA02680
       XEC     RHSAV          LOCATION OF NEXT LOAD ADDRESS             CCA02690
       PLIST   10,MODPR-25,MODDXS,QSA,QSB,QSC,QSD,QSE,QSF,QSG           CCA02700
       LXA     EP002,4                                                  CCA02710
       CAL     9,4                                                      CCA02720
       STA     *+2                                                      CCA02730
       TXI     *+1,2,1                                                  CCA02740
       SXD     **,2                                                     CCA02750
       SPACE                                                            CCA02760
*                                                                       CCA02770
*  BUILD PROGRAM LIST FOR PHASE 2                                       CCA02780
*                                                                       CCA02790
       LXA     EP002,4                                                  CCA02800
       CAL     11,4           PHASE 2 PROGRAM LIST                      CCA02810
       LDQ     12,4                                                     CCA02820
       PDX     0,2            PRESENT PROGRAM COUNT                     CCA02830
       PAC     0,4            LOCATION OF NEXT AVAILABLE LOAD LOCATION  CCA02840
       XCL                                                              CCA02850
       ADD     =1             CALCULATE PHASE TWO TCP PROGRAM           CCA02860
       STA     PHTWO                                                    CCA02870
       LXA     OSREL,1        COMMON RELOCATION                         CCA02880
       ZET     OPT02,1                                                  CCA02890
       TRA     NORES2                                                   CCA02900
       CAL     =HHYSTAR                                                 CCA02910
       SLW     0,4                                                      CCA02920
       TXI     *+1,2,1                                                  CCA02930
       TXI     *+1,4,-1                                                 CCA02940
NORES2 CAL     =HXTRACT                                                 CCA02950
       SLW     0,4                                                      CCA02960
       CAL     =HBTD                                                    CCA02970
       SLW     1,4                                                      CCA02980
       CAL     =HDEBLK                                                  CCA02990
       SLW     2,4                                                      CCA03000
       TXI     *+1,2,3                                                  CCA03010
       TXI     *+1,4,-3                                                 CCA03020
       CAL     =HMERGE       729 PROGRAM.                               CCA03030
       ZET     HYPSW                                                    CCA03040
       CAL     =HHYMERG      GET HYPER MERGE PROGRAM.                   CCA03050
       SLW     0,4                                                      CCA03060
 PHTWO SLW     **                                                       CCA03070
       TXI     *+1,2,1                                                  CCA03080
       TXI     VMEND,4,-1                                               CCA03090
 VMEND BSS     0                                                        CCA03100
       ZET     OPT02,1       TEST NO CKPT OPTION                        CCA03110
       TRA     MPMCT                                                    CCA03120
       CAL     =HCKPT                                                   CCA03130
       SLW     0,4                                                      CCA03140
       TXI     *+1,2,1                                                  CCA03150
       TXI     *+1,4,-1                                                 CCA03160
MPMCT  CAL     =HIOPEN       729 PROGRAM.                               CCA03170
       ZET     HYPSW                                                    CCA03180
       CAL     =HHYOPEN      HYPER PROGRAM                              CCA03190
       SLW     0,4                                                      CCA03200
       CAL     =HLABEL                                                  CCA03210
       SLW     1,4                                                      CCA03220
       CAL     =HMRGIO       729 PROGRAM.                               CCA03230
       ZET     HYPSW                                                    CCA03240
       CAL     =HMRGHYO      HYPER PROGRAM                              CCA03250
       SLW     2,4                                                      CCA03260
       TXI     *+1,2,3                                                  CCA03270
       TXI     *+1,4,-3                                                 CCA03280
       SXA     MPMXA,4                                                  CCA03290
       AXT     5,4            NUMBER OF MERGE PHASE MODS                CCA03300
 MPMST CAL     MOD10,1        MODIFICATION                              CCA03310
       SXA     MPMAT,4                                                  CCA03320
       TZE     MPMAT          TEST FOR MODIFICATION GIVEN               CCA03330
       ANA     =O700777000000                                           CCA03340
       TNZ     MPMAT          TEST FOR MOD ON OTHER THAN LIBRARY TAPE   CCA03350
       CAL     MODMPM,4                                                 CCA03360
 MPMXA AXT     **,4                                                     CCA03370
       SLW     0,4            SAVE IN PROGRAM LIST                      CCA03380
       CAL     MOD10,1                                                  CCA03390
       ARS     27                                                       CCA03400
       ANA     =O77                                                     CCA03410
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA03420
       TXI     *+1,4,-1                                                 CCA03430
       TXI     *+1,2,1        UP NUMBER OF MODS TO LOAD                 CCA03440
       SXA     MPMXA,4                                                  CCA03450
 MPMAT AXT     **,4                                                     CCA03460
       TXI     *+1,1,1                                                  CCA03470
       TIX     MPMST,4,1                                                CCA03480
       LXA     EP002,4                                                  CCA03490
       CAL     12,4                                                     CCA03500
       ARS     18                                                       CCA03510
       STA     *+1            LOCATION OF COUNT FOR PROBRAM LIST        CCA03520
       SXD     **,2                                                     CCA03530
       XEC     MPMXA                                                    CCA03540
       SXA     MPSAV,4                                                  CCA03550
       AXT     5,4                                                      CCA03560
       LXA     OSREL,1        COMMON RELOCATION                         CCA03570
 MPMUN CAL     MOD10,1                                                  CCA03580
       SXA     MPMAX,4                                                  CCA03590
       TZE     MPMAX          TEST FOR MODIFICATION GIVEN               CCA03600
       ANA     =O700777000000                                           CCA03610
       TZE     MPMAX          TEST FOR MOD ON OTHER THAN LIBRARY TAPE   CCA03620
       ARS     18                                                       CCA03630
       ADD     =O1000000                                                CCA03640
       LDQ     MODMPM,4                                                 CCA03650
 MPSAV AXT     **,4                                                     CCA03660
       SLW     0,4            SAVE IN PROGRAM LIST                      CCA03670
       TXI     *+1,4,-1       ADVANCE TO NEXT LOC IN PROGRAM LIST       CCA03680
       STQ     0,4            SAVE MOD NAME IN PROGRAM LIST             CCA03690
       CAL     MOD10,1                                                  CCA03700
       ARS     27                                                       CCA03710
       ANA     =O77                                                     CCA03720
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA03730
       TXI     *+1,4,-1       ADVANCE TO NEXT PROGRAM LIST LOCATION     CCA03740
       TXI     *+1,2,2                                                  CCA03750
       SXA     MPSAV,4                                                  CCA03760
 MPMAX AXT     **,4                                                     CCA03770
       CLA     =O77777                                                  CCA03780
       ANS     MOD10,1                                                  CCA03790
       TXI     *+1,1,1                                                  CCA03800
       TIX     MPMUN,4,1                                                CCA03810
       XEC     MPSAV                                                    CCA03820
       PLIST   5,MODPR-35,MODDMP,QTA,QTB,QTC,QTD,QTE,QTF,QTG            CCA03830
       LXA     EP002,4                                                  CCA03840
       CAL     12,4                                                     CCA03850
       STA     *+2                                                      CCA03860
       TXI     *+1,2,1                                                  CCA03870
       SXD     **,2                                                     CCA03880
       SPACE                                                            CCA03890
*                                                                       CCA03900
*  BUILD PROGRAM LIST FOR PHASE 3                                       CCA03910
*                                                                       CCA03920
 FMMOD LXA     EP002,4                                                  CCA03930
       LXA     OSREL,1        COMMON RELOCATION                         CCA03940
       CAL     13,4                                                     CCA03950
       LDQ     14,4                                                     CCA03960
       PDX     0,2                                                      CCA03970
       PAC     0,4                                                      CCA03980
       XCL                                                              CCA03990
       ADD     =1             CALCULATE LOCATION PHASE THREE TCP PROGRAMCCA04000
       STA     PHTRE                                                    CCA04010
       ZET     OPT02,1                                                  CCA04020
       TRA     NORES3                                                   CCA04030
       CAL     =HHYSTAR                                                 CCA04040
       SLW     0,4                                                      CCA04050
       TXI     *+1,2,1                                                  CCA04060
       TXI     *+1,4,-1                                                 CCA04070
NORES3 CAL     =HXTRACT                                                 CCA04080
       SLW     0,4                                                      CCA04090
       CAL     =HBTD                                                    CCA04100
       SLW     1,4                                                      CCA04110
       CAL     =HDEBLK                                                  CCA04120
       SLW     2,4                                                      CCA04130
       CAL     =HPOSTP                                                  CCA04140
       SLW     3,4                                                      CCA04150
       CAL     =HRELEAS                                                 CCA04160
       SLW     4,4                                                      CCA04170
       TXI     *+1,2,5                                                  CCA04180
       TXI     *+1,4,-5                                                 CCA04190
       CAL     =HFIMRG       729 PROGRAM.                               CCA04200
       ZET     HYPSW                                                    CCA04210
       CAL     =HHYFIMR      GET HYPER FINAL MERGE PROGRAM.             CCA04220
 PHTRE SLW     **                                                       CCA04230
       SLW     0,4                                                      CCA04240
       TXI     *+1,2,1                                                  CCA04250
       TXI     VFEND,4,-1                                               CCA04260
 VFEND BSS     0                                                        CCA04270
       ZET     OPT02,1       TEST NO CKPT OPTION                        CCA04280
       TRA     FMM0A                                                    CCA04290
       CAL     =HCKPT                                                   CCA04300
       SLW     0,4                                                      CCA04310
       TXI     *+1,2,1                                                  CCA04320
       TXI     *+1,4,-1                                                 CCA04330
 FMM0A NZT     DEL00,1       TEST DELETE OPTION                         CCA04340
       TRA     FMMCT                                                    CCA04350
       CAL     =HDELETE                                                 CCA04360
       SLW     0,4                                                      CCA04370
       TXI     *+1,2,1                                                  CCA04380
       TXI     *+1,4,-1                                                 CCA04390
FMMCT  CAL     =HIOPEN       729 PROGRAM.                               CCA04400
       ZET     HYPSW                                                    CCA04410
       CAL     =HHYOPEN      HYPER PROGRAM                              CCA04420
       SLW     0,4                                                      CCA04430
       CAL     =HLABEL                                                  CCA04440
       SLW     1,4                                                      CCA04450
       CAL     =HMRGIO       729 PROGRAM.                               CCA04460
       ZET     HYPSW                                                    CCA04470
       CAL     =HMRGHYO      HYPER PROGRAM                              CCA04480
       SLW     2,4                                                      CCA04490
       TXI     *+1,2,3                                                  CCA04500
       TXI     *+1,4,-3                                                 CCA04510
       SXA     FMMXA,4                                                  CCA04520
       AXT     10,4           NO. OF MODS                               CCA04530
 FMMST CAL     MOD15,1        GET A MODIFICATION CELL                   CCA04540
       SXA     FMMAT,4                                                  CCA04550
       TZE     FMMAT         TEST FOR THIS MODIFICATION GIVEN           CCA04560
       ANA     =O700777000000                                           CCA04570
       TNZ     FMMAT          TEST FOR PROGRAM ON LIBRARY TAPE          CCA04580
       CAL     MODFMM,4       GET NAME OF PROGRAM FOR PROGRAM LIST      CCA04590
 FMMXA AXT     **,4           POINTER TO PROGRAM LIST                   CCA04600
       SLW     0,4            SAVE NAME IN PROGRAM LIST                 CCA04610
       CAL     MOD15,1                                                  CCA04620
       ARS     27                                                       CCA04630
       ANA     =O77                                                     CCA04640
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA04650
       TXI     *+1,4,-1                                                 CCA04660
       TXI     *+1,2,1        UPDATE LENGTH OF PROGRAM LIST             CCA04670
       SXA     FMMXA,4                                                  CCA04680
 FMMAT AXT     **,4           COUNT OF NO. MODS TO CHECK                CCA04690
       TXI     *+1,1,1        POINTER FOR LOCATION OF NEXT MOD          CCA04700
       TIX     FMMST,4,1                                                CCA04710
       LXA     EP002,4                                                  CCA04720
       CAL     14,4           ADDRESS OF PROGRAM LIST COUNTS            CCA04730
       ARS     18                                                       CCA04740
       STA     *+1            LOCATION OF NUMBER OF PROGRAMS            CCA04750
       SXD     **,2           NUMBER OF PROGRAMS                        CCA04760
       XEC     FMMXA                                                    CCA04770
       SXA     FMSAV,4       LOCATION OF PROGRAM LISTS.                 CCA04780
       AXT     10,4                                                     CCA04790
       LXA     OSREL,1                                                  CCA04800
 FMMUN CAL     MOD15,1        GET A MODIFICATION CELL                   CCA04810
       SXA     FMMAV,4                                                  CCA04820
       TZE     FMMAV          TEST FOR PROGRAM                          CCA04830
       ANA     =O700777000000                                           CCA04840
       TZE     FMMAV          TEST FOR PROGRAM NOT ON LIBRARY TAPE      CCA04850
       ARS     18                                                       CCA04860
       ADD     =O1000000      NUMBER OF MODS THIS UNIT                  CCA04870
       LDQ     MODFMM,4       GET NAME FOR PROGRAM IN LOAD LIST         CCA04880
 FMSAV AXT     **,4                                                     CCA04890
       SLW     0,4            SAVE LOCATION OF PROGRAM IN LOAD LIST     CCA04900
       TXI     *+1,4,-1                                                 CCA04910
       STQ     0,4            SAVE LOCATION OF PROGRAM IN LOAD LIST     CCA04920
       CAL     MOD15,1                                                  CCA04930
       ARS     27                                                       CCA04940
       ANA     =O77                                                     CCA04950
       ORS     0,4            SAVE EXTRA CHARACTER IN NAME              CCA04960
       TXI     *+1,4,-1                                                 CCA04970
       TXI     *+1,2,2                                                  CCA04980
       SXA     FMSAV,4                                                  CCA04990
 FMMAV AXT     **,4                                                     CCA05000
       CLA     =O77777                                                  CCA05010
       ANS     MOD15,1        REMOVE ALL BUT LENGTH FROM PROGRAM MOD    CCA05020
       TXI     *+1,1,1                                                  CCA05030
       TIX     FMMUN,4,1                                                CCA05040
       XEC     FMSAV                                                    CCA05050
       PLIST   10,MODPR-40,MODDFM,QUA,QUB,QUC,QUD,QUE,QUF,QUG           CCA05060
       LXA     EP002,4        CALLING RETURN TO SORT MONITOR            CCA05070
       CAL     14,4           LOCATION  OF PROGRAM COUNTS               CCA05080
       STA     *+2                                                      CCA05090
       TXI     *+1,2,1                                                  CCA05100
       SXD     **,2                                                     CCA05110
       SPACE   2                                                        CCA05120
*                                                                       CCA05130
*  CALCULATE LENGTH OF ALL MODIFICATIONS                                CCA05140
*                                                                       CCA05150
       AXT     10,2           NUMBER OF XS MODIFICATIONS                CCA05160
       LXA     OSREL,1        COMMON RELOCATION                         CCA05170
       CLA     XSLEN                                                    CCA05180
       ADD     MOD00,1        SUM LENGTH OF XS MODIFICATIONS            CCA05190
       ADD     MOD25,1        SUM CE MODS                               CCA05200
       TXI     *+1,1,1                                                  CCA05210
       TIX     *-3,2,1                                                  CCA05220
       STO     XSLEN          SAVE LENGTH OF ALL MODIFICATIONS          CCA05230
       AXT     5,2            NUMBER OF MERGE PHASE MODES               CCA05240
       CLA     MRLEN                                                    CCA05250
       ADD     MOD00,1        SUM LENGTH OF MERGE MODS                  CCA05260
       ADD     MOD25,1        SUM CE MODS                               CCA05270
       TXI     *+1,1,1        CHANGE POINTER OF NEXT MODIFICATION       CCA05280
       TIX     *-3,2,1                                                  CCA05290
       STO     MRLEN                                                    CCA05300
       AXT     10,2           NUMBER OF FINAL MEGE MODS                 CCA05310
       CAL     FMLEN                                                    CCA05320
       ADD     MOD00,1        SUM SIZE OF FINAL MERGE MODS              CCA05330
       ADD     MOD25,1        SUM CE MODS                               CCA05340
       TXI     *+1,1,1                                                  CCA05350
       TIX     *-3,2,1                                                  CCA05360
       STO     FMLEN                                                    CCA05370
       SPACE                                                            CCA05380
*                                                                       CCA05390
*      CALCULATE EFFECTIVE RECORD LENGTHS                               CCA05400
*                                                                       CCA05410
       LXA     OSREL,1                                                  CCA05420
       ZET     REC05,1      FIXED OR VARIABLE                           CCA05430
       TRA     RF51                                                     CCA05440
       PXD     0,0           CALCULATE ADDED WORDS BECAUSE OF OPTIONS   CCA05450
       ZET     OPT03,1       TEST FOR EQUALS OPTION                     CCA05460
       ADD     =1            ADD ONE FOR SEQUENCE WORD                  CCA05470
       ZET     OPT01,1       TEST FOR CHECKSUMS OPTION                  CCA05480
       ADD     =1            ADD ONE WORD FOR CHECKSUM                  CCA05490
       STO     RF40                                                     CCA05500
       CLA     REC00,1       INPUT, PHASE 1                             CCA05510
       CAS     REC01,1            PHASE 2                               CCA05520
       TRA     *+3                                                      CCA05530
       TRA     *+2                                                      CCA05540
       CLA     REC01,1                                                  CCA05550
       ADD     RF40                                                     CCA05560
       STO     CAL08,1       EFFECTIVE RECORD LENGTH, PHASE 1           CCA05570
       CLA     REC01,1                                                  CCA05580
       ADD     RF40                                                     CCA05590
       STO     CAL09,1       EFFECTIVE RECORD LENGTH, PHASE 2           CCA05600
       CLA     =2002         CALCULATE MAXIMUM BLOCKING FOR 2000        CCA05610
       LRS     35             TAPE RECORD IN PHASE 2                    CCA05620
       DVP     CAL09,1                                                  CCA05630
       STQ     MAXB2                                                    CCA05640
       CLA     REC01,1        PHASE 2                                   CCA05650
       CAS     REC02,1       PHASE 3                                    CCA05660
       TRA     *+3                                                      CCA05670
       TRA     *+2                                                      CCA05680
       CLA     REC02,1                                                  CCA05690
       ADD     RF40                                                     CCA05700
       STO     CAL10,1       EFFECTIVE RECORD LENGTH, PHASE 3           CCA05710
       SPACE                                                            CCA05720
*                                                                       CCA05730
*      DESIGN  PADDING RECORD                                           CCA05740
*                                                                       CCA05750
       LXA     OSREL,1       RELOCATION                                 CCA05760
       ZET     REC05,1        TEST FOR FIXED OR VARIABLE                CCA05770
       TRA     RF51                                                     CCA05780
       CAL     SAM03,1       GET NO OF CONTROL FIELDS IN DECREMENT      CCA05790
       STA     CFADD         ADDRESS OF CF DATA BLOCK                   CCA05800
       ARS     18                                                       CCA05810
       STA     NCF           NO OF CONTROL FIELDS                       CCA05820
       CAL     GEN01,1                                                  CCA05830
       SLW     BDIND         BINARY/BCD INDICATOR, 0 IS BCD             CCA05840
       CAL     SAM00,1                                                  CCA05850
       SLW     CVTIND        CONVERT INDICATOR, 0 IS NO CONVERT         CCA05860
       CLA     CAL08,1       GET LARGEST RECORD LENGTH                  CCA05870
       CAS     CAL09,1                                                  CCA05880
       TRA     *+3           PRP40 GREATER                              CCA05890
       TRA     *+2           EQUAL                                      CCA05900
       CLA     CAL09,1                                                  CCA05910
       CAS     CAL10,1                                                  CCA05920
       TRA     *+3                                                      CCA05930
       TRA     *+2                                                      CCA05940
       CLA     CAL10,1                                                  CCA05950
       STO     RL            LARGEST RECORD LENGTH                      CCA05960
       CLA     REF00,1       LAST CELL USED BY REFERENCED PARAMETERS    CCA05970
       SUB     RL            RESERVE ROOM FOR HIGH PADDING RECORD       CCA05980
       STO     PADHI                                                    CCA05990
       SUB     CAL12,1       WORDS IN ALL C F                           CCA06000
       STO     REF00,1                                                  CCA06010
       LXA     RL,2                                                     CCA06020
       SXD     PADHI,2                                                  CCA06030
       LAC     PADHI,4       CLEAR HIGH PADDING RECORD                  CCA06040
       STZ     0,4                                                      CCA06050
       TNX     *+2,2,1                                                  CCA06060
       TXI     *-2,4,-1                                                 CCA06070
       CLA     FIL01,1                                                  CCA06080
       SUB     =2                                                       CCA06090
       STA     *+2                                                      CCA06100
       STZ     PADLO         PADDING INDICATOR SET FOR HIGH             CCA06110
       CLA     **                                                       CCA06120
       LBT                                                              CCA06130
       NOP                                                              CCA06140
       CLA     REF00,1                                                  CCA06150
       SUB     RL            RESERVE ROOM FOR LOW PADDING RECORD        CCA06160
       STO     PADLO                                                    CCA06170
       SUB     CAL12,1       WORDS IN ALL C F                           CCA06180
       STO     REF00,1                                                  CCA06190
       LXA     RL,2                                                     CCA06200
       SXD     PADLO,2                                                  CCA06210
       LAC     PADLO,4       CLEAR LOW PADDING RECORD                   CCA06220
       STZ     0,4                                                      CCA06230
       TNX     *+2,2,1                                                  CCA06240
       TXI     *-2,4,-1                                                 CCA06250
       CLA     PADHI                                                    CCA06260
       STO     CAL20,1                                                  CCA06270
       CLA     PADLO                                                    CCA06280
       STO     CAL19,1                                                  CCA06290
       LXA     NCF,1         START MAIN LOOP.                           CCA06300
       TXL     RF27,1,0                                                 CCA06310
 RF26  LAC     CFADD,2                                                  CCA06320
       CAL     0,2                                                      CCA06330
       ARS     18                                                       CCA06340
       STA     NWDS          NO OF WORDS CF COVERS                      CCA06350
       CAL     0,2                                                      CCA06360
       ADD     PADLO         LOW PADDING                                CCA06370
       STA     RF22                                                     CCA06380
       SUB     PADLO                                                    CCA06390
       ADD     PADHI         HIGH PADDING                               CCA06400
       STA     RF23                                                     CCA06410
       CAL     -1,2          GET STARTING BIT                           CCA06420
       STA     *+2                                                      CCA06430
       CAL     =O777777777777                                           CCA06440
       ARS     **            MASK GENERATION FOR LEFT MASK              CCA06450
       SLW     LMASK                                                    CCA06460
       CAL     -6,2                                                     CCA06470
       ANA     =O77777                                                  CCA06480
       ADM     -7,2          GENERATE LAST BIT                          CCA06490
       LXA     NWDS,4                                                   CCA06500
       TXH     *+3,4,1       TEST FOR MORE THAN ONE WORD IN CONTROL FLD CCA06510
       ANA     =O77777                                                  CCA06520
       ADM     -1,2          STARTING BIT                               CCA06530
       LDQ     =0                                                       CCA06540
       STA     SLGRS         SAVE IN SHIFT INSTRUCTION                  CCA06550
       ANA     =O77777                                                  CCA06560
       SUB     =36           GENERATE LAST BIT                          CCA06570
       STA     LB                                                       CCA06580
       CAL     =O777777777777                                           CCA06590
 SLGRS LGR     **                                                       CCA06600
       TXH     SMASK,4,1     TEST FOR ONLY ONE WORD IN CONTROL FIELD    CCA06610
       XCL                                                              CCA06620
       ANS     LMASK         MASK OUT PART OF WORD                      CCA06630
       CAL     LMASK                                                    CCA06640
       SLW     RMASK         MAKE BOTH MASKS IDENTICAL                  CCA06650
       TRA     *+2                                                      CCA06660
 SMASK STQ     RMASK         SAVE NEW RIGHT MASK                        CCA06670
       SPACE                                                            CCA06680
*                                                                       CCA06690
*      SET UP INDEX FOR TYPE OF SORT                                    CCA06700
*                                                                       CCA06710
       AXT     0,4                                                      CCA06720
       CLA     0,2            ASCENDING/DESCENDING                      CCA06730
       ARS     15            TAG TO LOW ORDER POSITION OF AC            CCA06740
       TXI     *+1,4,1       SET FOR DESCENDING                         CCA06750
       LBT                   TEST FOR ASCENDING OR DESCENDING           CCA06760
       TXI     *+1,4,-1      RESET FOR ASCENDING                        CCA06770
       ANA     =O6                                                      CCA06780
       TZE     *+2           TEST FOR SIGNED ALGEBRAIC OR BCD           CCA06790
       TXI     *+1,4,2                                                  CCA06800
       ZET     BDIND         BCD/BINARY                                 CCA06810
       TXI     *+1,4,4                                                  CCA06820
       ZET     CVTIND        NO CONVERT/CONVERT                         CCA06830
       TXI     *+1,4,8                                                  CCA06840
       ZET     PADLO         LOW/HIGH PADDING                           CCA06850
       TXI     *+1,4,16                                                 CCA06860
 RF25  SXA     XTYPE,4                                                  CCA06870
       CAL     PADWD+31,4                                               CCA06880
       LXA     NWDS,2        NO OF WORDS IN CF                          CCA06890
       LDI     SWITCH+31,4    GET SWITCH WORD                           CCA06900
       LNT     1                                                        CCA06910
       TRA     RF9           SWITCH Y OFF                               CCA06920
       CAL     LMASK                                                    CCA06930
       ARS     1                                                        CCA06940
       ANA     PADWD+31,4                                               CCA06950
 RF9   ANA     LMASK         LEFT MASK                                  CCA06960
       LXA     XTYPE,4                                                  CCA06970
       TXL     RF21,4,15     TEST FOR LOW PADDING                       CCA06980
       ORS*    RF22          LOW                                        CCA06990
       TRA     *+2                                                      CCA07000
 RF21  ORS*    RF23          HIGH                                       CCA07010
       TIX     RF24,2,1      IF MORE THAN ONE WORD                      CCA07020
 RF32  TXL     *+2,4,15                                                 CCA07030
       TXI     RF25,4,-16                                               CCA07040
       TNX     RF27,1,1      CHECK FOR MORE CF                          CCA07050
       LXA     CFADD,2                                                  CCA07060
       TXI     *+1,2,-9                                                 CCA07070
       SXA     CFADD,2                                                  CCA07080
       TRA     RF26                                                     CCA07090
 RF24  CAL     PADWD+31,4                                               CCA07100
       TXL     RF33,2,1      IF LAST WORD                               CCA07110
       TXL     RF28,4,15                                                CCA07120
       ORS*    RF22                                                     CCA07130
       TRA     *+2                                                      CCA07140
 RF28  ORS*    RF23                                                     CCA07150
       TIX     *-5,2,1        GET REMAINDER OF FIELD                    CCA07160
 RF33  CAL     RMASK         GET RIGHT MASK                             CCA07170
       ANA     PADWD+31,4                                               CCA07180
       TXL     RF29,4,15                                                CCA07190
       ORS*    RF22                                                     CCA07200
       TRA     *+2                                                      CCA07210
 RF29  ORS*    RF23                                                     CCA07220
       CAL     LB                                                       CCA07230
       STA     RF30                                                     CCA07240
       CAL     SWITCH+31,4    GET X SWITCH                              CCA07250
       ANA     =O77                                                     CCA07260
 RF30  ALS     **                                                       CCA07270
       TXL     RF31,4,15                                                CCA07280
       ORS*    RF22                                                     CCA07290
       TRA     *+2                                                      CCA07300
 RF31  ORS*    RF23                                                     CCA07310
       TRA     RF32                                                     CCA07320
 RF27  TRA     RF49                                                     CCA07330
       SPACE   5                                                        CCA07340
*                                                                       CCA07350
*  PADDING CHARACTERS                                                   CCA07360
*                                                                       CCA07370
 PADWD OCT     777777777777  LOW DESCENDING ALGEBRAIC BINARY CONVERT    CCA07380
       OCT     777777777777      ASCENDING                              CCA07390
       OCT     111111111111    DESCENDING LOGICAL                       CCA07400
       OCT     606060606060    ASCENDING                                CCA07410
       BCI     1,999999        DESCENDING ALGEBRAIC BCD                 CCA07420
       BCI     1,999999        ASCENDING                                CCA07430
       BCI     1,999999        DESCENDING LOGICAL                       CCA07440
       BCI     1,              ASCENDING                                CCA07450
       OCT     777777777777    DESCENDING ALGEBRAIC BINARY NO CONVERT   CCA07460
       OCT     777777777777    ASCENDING                                CCA07470
       OCT     777777777777    DESCENDING LOGICAL                       CCA07480
       OCT     0               ASCENDING                                CCA07490
       BCI     1,999999        DESCENDING ALGEBRAIC BCD                 CCA07500
       BCI     1,999999        ASCENDING                                CCA07510
       BCI     1,((((((        DESCENDING LOGICAL                       CCA07520
       OCT     0               ASCENDING                                CCA07530
       OCT     777777777777  HIGH DESCENDING ALGEBRAIC BINARY CONVERT   CCA07540
       OCT     777777777777    ASCENDING                                CCA07550
       OCT     606060606060    DESCENDING LOGICAL                       CCA07560
       OCT     111111111111    ASCENDING                                CCA07570
       BCI     1,999999        DESCENDING ALGEBRAIC BCD                 CCA07580
       BCI     1,999999        ASCENDING                                CCA07590
       BCI     1,              DESCENDING LOGICAL                       CCA07600
       BCI     1,999999        ASCENDING                                CCA07610
       OCT     777777777777    DESCENDING ALGEBRAIC BINARY NO CONVERT   CCA07620
       OCT     777777777777    ASCENDING                                CCA07630
       OCT     0               DESCENDING LOGICAL                       CCA07640
       OCT     777777777777    ASCENDING                                CCA07650
       BCI     1,999999      DESCENDING ALGEBRAIC BCD                   CCA07660
       BCI     1,999999        ASCENDING                                CCA07670
       OCT     0               DESCENDING LOGICAL                       CCA07680
       BCI     1,((((((        ASCENDING                                CCA07690
*                                                                       CCA07700
*  PADDING SWITCHES                                                     CCA07710
*                                                                       CCA07720
SWITCH PZE     0,,1                                                     CCA07730
       PZE     0,,0                                                     CCA07740
       PZE     0,,0                                                     CCA07750
       PZE     0,,0                                                     CCA07760
       PZE     16,,0                                                    CCA07770
       PZE     32,,0                                                    CCA07780
       PZE     0,,0                                                     CCA07790
       PZE     0,,0                                                     CCA07800
       PZE     0,,1                                                     CCA07810
       PZE     0,,0                                                     CCA07820
       PZE     0,,0                                                     CCA07830
       PZE     0,,0                                                     CCA07840
       PZE     16,,0                                                    CCA07850
       PZE     32,,0                                                    CCA07860
       PZE     0,,0                                                     CCA07870
       PZE     0,,0                                                     CCA07880
       PZE     0,,0                                                     CCA07890
       PZE     0,,1                                                     CCA07900
       PZE     0,,0                                                     CCA07910
       PZE     0,,0                                                     CCA07920
       PZE     32,,0                                                    CCA07930
       PZE     16,,0                                                    CCA07940
       PZE     0,,0                                                     CCA07950
       PZE     0,,0                                                     CCA07960
       PZE     0,,0                                                     CCA07970
       PZE     0,,1                                                     CCA07980
       PZE     0,,0                                                     CCA07990
       PZE     0,,0                                                     CCA08000
       PZE     32,,0                                                    CCA08010
       PZE     16,,0                                                    CCA08020
       PZE     0,,0                                                     CCA08030
       PZE     0,,0                                                     CCA08040
 BDIND                                                                  CCA08050
 CFADD                                                                  CCA08060
CVTIND                                                                  CCA08070
 LB                                                                     CCA08080
 LMASK                                                                  CCA08090
 NCF                                                                    CCA08100
 NWDS                                                                   CCA08110
 PADHI                                                                  CCA08120
 PADLO                                                                  CCA08130
 RF22  PZE     **,2                                                     CCA08140
 RF23  PZE     **,2                                                     CCA08150
 RF40                                                                   CCA08160
 RL                                                                     CCA08170
 RMASK                                                                  CCA08180
 XTYPE                                                                  CCA08190
 EP002 PZE                                                              CCA08200
 OSREL PZE                    COMMON RELOCATION                         CCA08210
 HYPSW                       NZ = HYPER PROGRAMS TO BE LOADED           CCA08220
       SPACE                                                            CCA08230
 RF49  LXA     OSREL,1        COMMON RELOCATION                         CCA08240
       DCT                   TURN OFF DCT LIGHT                         CCA08250
       NOP                                                              CCA08260
       CLA     FIL00,1        LOCATION OF INPUT FILE BLOCK              CCA08270
       SUB     =5             LOCATE INPUT BLOCKING                     CCA08280
       STA     *+1                                                      CCA08290
       LDQ     **             BLOCKING                                  CCA08300
       PXA     0,0                                                      CCA08310
       DVP     REC00,1        NUMBER OF RECORDS PER BLOCK               CCA08320
       STQ     CAL01,1        SAVE BLOCKING FOR INPUT                   CCA08330
       CLA     FIL01,1        OUTPUT BLOCK ADDRESS                      CCA08340
       SUB     =5             OUTPUT FILE BLOCK LENGTH                  CCA08350
       STA     *+1                                                      CCA08360
       LDQ     **                                                       CCA08370
       STQ     CAL28,1                                                  CCA08380
       PXA     0,0                                                      CCA08390
       DVP     REC02,1        RECORD OUTPUT LENGTH                      CCA08400
       STQ     CAL02,1                                                  CCA08410
       SPACE                                                            CCA08420
*                                                                       CCA08430
*      CALCULATE MEMORY AVAILABLE EACH PHASE                            CCA08440
*                                                                       CCA08450
 RF51  DCT                                                              CCA08460
       NOP                                                              CCA08470
       LXA     EP002,4       FIND ADDRESS OF PROGRAM LIST               CCA08480
       CLS     8,4                                                      CCA08490
       ARS     18                                                       CCA08500
       ADD     8,4                                                      CCA08510
       STO     RP10                                                     CCA08520
       CLA*    9,4                                                      CCA08530
       PDX     0,1           COUNT OF PROGRAMS                          CCA08540
       TXI     *+1,1,-1                                                 CCA08550
       PXA     0,1                                                      CCA08560
       ADD     RP10                                                     CCA08570
       STA     RP11                                                     CCA08580
       STZ     RKT16                                                    CCA08590
       AXT     RKKJ3-RKPL1,4  LENGTH OF PROGRAM LIST                    CCA08600
RP11   CAL     **,1          PHASE 1                                    CCA08610
       ERA     RKKJ3,4                                                  CCA08620
       TNZ     *+4                                                      CCA08630
       ADD     RKKJ3+1,4                                                CCA08640
       ADD     RKT16                                                    CCA08650
       STO     RKT16                                                    CCA08660
       TIX     *-6,4,2                                                  CCA08670
       TIX     *-8,1,1                                                  CCA08680
       LXA     OSREL,2                                                  CCA08690
       CLA     REF00,2                                                  CCA08700
       SUB     RKT16                                                    CCA08710
       SUB     PERM                                                     CCA08720
       SUB     RKKP1                                                    CCA08730
       STO     CAL23,2                                                  CCA08740
       TZE     RR3                                                      CCA08750
       TMI     RR3                                                      CCA08760
       LXA     EP002,4                                                  CCA08770
       CLS     11,4                                                     CCA08780
       ARS     18                                                       CCA08790
       ADD     11,4                                                     CCA08800
       STO     RP10                                                     CCA08810
       CLA*    12,4                                                     CCA08820
       PDX     0,1                                                      CCA08830
       TXI     *+1,1,-1                                                 CCA08840
       PXA     0,1                                                      CCA08850
       ADD     RP10                                                     CCA08860
       STA     RP20                                                     CCA08870
       STZ     RKT16                                                    CCA08880
       AXT     RKKJ3-RKPL1,4  LENGTH OF PROGRAM LIST                    CCA08890
RP20   CAL     **,1                                                     CCA08900
       ERA     RKKJ3,4                                                  CCA08910
       TNZ     *+4                                                      CCA08920
       ADD     RKKJ3+1,4                                                CCA08930
       ADD     RKT16                                                    CCA08940
       STO     RKT16                                                    CCA08950
       TIX     *-6,4,2                                                  CCA08960
       TIX     *-8,1,1                                                  CCA08970
       LXA     OSREL,2                                                  CCA08980
       CLA     REF00,2                                                  CCA08990
       SUB     RKT16                                                    CCA09000
       SUB     PERM                                                     CCA09010
       SUB     RKKP2                                                    CCA09020
       STO     CAL24,2       MEMORY AVAILABLE, PHASE 2                  CCA09030
       TZE     RR3                                                      CCA09040
       TMI     RR3                                                      CCA09050
       LXA     EP002,4                                                  CCA09060
       CLS     13,4                                                     CCA09070
       ARS     18                                                       CCA09080
       ADD     13,4                                                     CCA09090
       STO     RP10                                                     CCA09100
       CLA*    14,4                                                     CCA09110
       PDX     0,1                                                      CCA09120
       TXI     *+1,1,-1                                                 CCA09130
       PXA     0,1                                                      CCA09140
       ADD     RP10                                                     CCA09150
       STA     RP21                                                     CCA09160
       STZ     RKT16                                                    CCA09170
       AXT     RKKJ3-RKPL1,4  LENGTH OF PROGRAM LIST                    CCA09180
RP21   CAL     **,1                                                     CCA09190
       ERA     RKKJ3,4                                                  CCA09200
       TNZ     *+4                                                      CCA09210
       ADD     RKKJ3+1,4                                                CCA09220
       ADD     RKT16                                                    CCA09230
       STO     RKT16                                                    CCA09240
       TIX     *-6,4,2                                                  CCA09250
       TIX     *-8,1,1                                                  CCA09260
       LXA     OSREL,2                                                  CCA09270
       CLA     REF00,2                                                  CCA09280
       SUB     RKT16                                                    CCA09290
       SUB     PERM                                                     CCA09300
       SUB     RKKP3                                                    CCA09310
       STO     CAL25,2       MEMORY AVAILABLE, PHASE 3                  CCA09320
       TZE     RR3                                                      CCA09330
       TMI     RR3                                                      CCA09340
       TRA     RF50                                                     CCA09350
XSLEN                                                                   CCA09360
MRLEN                                                                   CCA09370
FMLEN                                                                   CCA09380
RKKP1  SYN     XSLEN                                                    CCA09390
 RKKP2 SYN     MRLEN                                                    CCA09400
RKKP3  SYN     FMLEN                                                    CCA09410
RKT16                                                                   CCA09420
RP10                                                                    CCA09430
       SPACE   2                                                        CCA09440
*                                                                       CCA09450
*  PROGRAM LIST OF LENGTHS                                              CCA09460
*                                                                       CCA09470
PERM   PZE     SYSORG+1012                                           (2)CCA09480
RKPL1  BCI     1,HYSTAR                                                 CCA09490
       OCT     320                                                      CCA09500
       BCI     1,IOPEN                                                  CCA09510
       OCT     2400                                                     CCA09520
       BCI     1,HYOPEN                                                 CCA09530
       OCT     3010                                                  (9)CCA09540
       BCI     1,LABEL                                                  CCA09550
       OCT     650                                                      CCA09560
       BCI     1,BTD                                                    CCA09570
       OCT     100                                                      CCA09580
       BCI     1,RELEAS                                                 CCA09590
       OCT     140                                                   (9)CCA09600
       BCI     1,VXS                                                    CCA09610
       OCT     1610                                                  (9)CCA09620
       BCI     1,MRGIO                                                  CCA09630
       OCT     1550                                                  (9)CCA09640
       BCI     1,MRGHYO                                                 CCA09650
       OCT     2130                                                  (9)CCA09660
       BCI     1,BUFRD                                                  CCA09670
       OCT     1000                                                     CCA09680
       BCI     1,XTRACT                                                 CCA09690
       OCT     500                                                      CCA09700
       BCI     1,FXS                                                    CCA09710
       OCT     1650                                                  (9)CCA09720
       BCI     1,GET                                                    CCA09730
       OCT     1530                                                  (9)CCA09740
       BCI     1,HYGET                                                  CCA09750
       OCT     1700                                                     CCA09760
       BCI     1,PUT                                                    CCA09770
       OCT     650                                                      CCA09780
       BCI     1,READ                                                   CCA09790
       OCT     1400                                                     CCA09800
       BCI     1,WRITE                                                  CCA09810
       OCT     660                                                   (9)CCA09820
       BCI     1,WTFIX                                                  CCA09830
       OCT     70                                                       CCA09840
       BCI     1,DEBLK                                                  CCA09850
       OCT     510                                                   (9)CCA09860
       BCI     1,FIMRG                                                  CCA09870
       OCT     3160                                                  (9)CCA09880
       BCI     1,HYFIMR                                                 CCA09890
       OCT     3570                                                  (9)CCA09900
       BCI     1,MERGE                                                  CCA09910
       OCT     3600                                                     CCA09920
       BCI     1,HYMERG                                                 CCA09930
       OCT     4250                                                  (9)CCA09940
       BCI     1,POSTP                                                  CCA09950
       OCT     550                                                   (9)CCA09960
       BCI     1,CKPT                                                   CCA09970
       OCT     170                                                   (9)CCA09980
       BCI     1,DELETE                                                 CCA09990
       OCT     120                                                      CCA10000
RKKJ3  BSS     0                                                        CCA10010
       SPACE                                                            CCA10020
*                                                                       CCA10030
*              CALCULATE M, THE NO OF RECORDS/INTERNAL SORT FOR         CCA10040
*              RATIOS OF 1 TO 10. FIRST CALCULATE MAXIMUM               CCA10050
*              VALUE.                                                   CCA10060
*                                                                       CCA10070
RF50   LXA     OSREL,2                                                  CCA10080
       ZET     REC05,2        TEST FOR FIXED OR VARIABLE LENGTH RECORD  CCA10090
       TRA     RVAAA                                                    CCA10100
       NZT     SAM04,2       BYPASS IF MERGE ONLY                       CCA10110
       TRA     RR15                                                     CCA10120
       CLA     CAL23,2       MEMORY AVAILABLE, PHASE 1                  CCA10130
       SUB     CAL08,2       - ERL                                      CCA10140
       SUB     CAL12,2                                                  CCA10150
       SUB     CAL12,2                                                  CCA10160
       SUB     CAL12,2                                                  CCA10170
       SUB     =20                                                      CCA10180
       STO     RKT1          NUMERATOR                                  CCA10190
       LDQ     OPT04,2       BUFFER OPTION                              CCA10200
       MPY     CAL08,2       * ERL                                      CCA10210
       XCA                                                              CCA10220
       ALS     1             * 2                                        CCA10230
       ADD     =3                                                       CCA10240
       STO     RKT2                                                     CCA10250
       CLA     CAL08,2       ERL                                        CCA10260
       ADD     CAL12,2       + XCF                                      CCA10270
       ALS     1             * 2                                        CCA10280
       ADD     RKT2                                                     CCA10290
       STO     RKT2                                                     CCA10300
       CLA     CAL12,2                                                  CCA10310
       ADD     CAL08,2                                                  CCA10320
       ADD     =2                                                       CCA10330
       STO     RKT3                                                     CCA10340
*              LOOP FOR R                                               CCA10350
       AXT     9,4                                                      CCA10360
       AXT     2,1                                                      CCA10370
RK10   SXA     RKX1,1        R                                          CCA10380
       LDQ     RKX1                                                     CCA10390
       MPY     RKT3                                                     CCA10400
       XCA                                                              CCA10410
       ADD     RKT2          DENOMINATOR                                CCA10420
       STO     RKTD                                                     CCA10430
       CLA     RKT1                                                     CCA10440
       LRS     35                                                       CCA10450
       DVP     RKTD                                                     CCA10460
       STL     GEN04,2                                                  CCA10470
       DCT                                                              CCA10480
       TRA     RR2                                                      CCA10490
       TRA     RR1                                                      CCA10500
RR2    BSS     0                                                        CCA10510
RR3    TSX     MGSUP,4,2                                                CCA10520
               2                                                        CCA10530
               AM132,,7                                                 CCA10540
               AM131,,4+512*4                                           CCA10550
       TSX     (PAUSE,4                                                 CCA10560
       TRA     EP007                                                    CCA10570
RR1    PXD     0,0           REDUCE TO A MULTIPLE OF INPUT              CCA10580
       DVP     CAL01,2       BLOCKING                                   CCA10590
       STL     GEN04,2                                                  CCA10600
       DCT                                                              CCA10610
       TRA     RR2                                                      CCA10620
*              REVISE M/IB SO AS TO AVOID PRIMES                        CCA10630
       XCA                   M/IB                                       CCA10640
       CAS     =4                                                       CCA10650
       TRA     *+3                                                      CCA10660
       NOP                                                              CCA10670
       TRA     RK32                                                     CCA10680
       CAS     =6                                                       CCA10690
       TRA     *+4           IF GREATER THAN 6                          CCA10700
       TRA     RK32                                                     CCA10710
       CLA     =4                                                       CCA10720
       TRA     RK32                                                     CCA10730
       LRS     35            SET TO A MULTIPLE OF 6                     CCA10740
       DVP     =6                                                       CCA10750
       MPY     =6                                                       CCA10760
       XCA                                                              CCA10770
RK32   XCA                                                              CCA10780
       MPY     CAL01,2                                                  CCA10790
       STQ     RKM+10,4                                                 CCA10800
       SPACE                                                            CCA10810
*                                                                       CCA10820
*              CALCULATE EXPECTED STRING LENGTHS                        CCA10830
*                                                                       CCA10840
       MPY     RKX1          R*M                                        CCA10850
       MPY     RKSLT+10,4    * FUNCTION                                 CCA10860
       STQ     RKSL+10,4     SCALE = 25                                 CCA10870
       TXI     *+1,1,1                                                  CCA10880
       TIX     RK10,4,1                                                 CCA10890
       LDQ     CAL01,2       GET INPUT BLOCKING                         CCA10900
       MPY     REC00,2       * INPUT RECORD LENGTH                      CCA10910
       XCA                   WORDS/INPUT BLOCK                          CCA10920
       CAS     =100                                                     CCA10930
       TRA     *+3                                                      CCA10940
       NOP                                                              CCA10950
       TRA     RL1           FOR LESS OR EQUAL TO 100                   CCA10960
       CAS     =300                                                     CCA10970
       TRA     *+3                                                      CCA10980
       NOP                                                              CCA10990
       TRA     RL2           FOR 100 TO 300                             CCA11000
       AXT     9,1          FOR GREATER THAN 300                        CCA11010
       AXT     4,4                                                      CCA11020
       AXT     8,2          CHECK R = 2-6                               CCA11030
RL6    CLA     RKSL+10,1                                                CCA11040
       TNZ     RL3                                                      CCA11050
       LXA     OSREL,2                                                  CCA11060
       STL     GEN04,2                                                  CCA11070
       TRA     RR2                                                      CCA11080
RL3    CAS     RKSL+10,2                                                CCA11090
       TRA     RL4                                                      CCA11100
       TRA     RL4                                                      CCA11110
       CLA     RKSL+10,2                                                CCA11120
       SXA     *+1,2                                                    CCA11130
       AXT     **,1                                                     CCA11140
RL4    TXI     *+1,2,-1                                                 CCA11150
       TIX     RL3,4,1                                                  CCA11160
       PXA     0,1           R = 11 - C(IR1)                            CCA11170
       SSM                                                              CCA11180
       ADD     =11                                                      CCA11190
       STO     RATIO                                                    CCA11200
       TRA     RL5                                                      CCA11210
RL1    AXT     6,1           TRY R = 5 - 10                             CCA11220
       AXT     5,4                                                      CCA11230
       AXT     5,2                                                      CCA11240
       TRA     RL6                                                      CCA11250
RL2    AXT     6,1           TRY R = 5 - 8                              CCA11260
       AXT     3,4                                                      CCA11270
       AXT     5,2                                                      CCA11280
       TRA     RL6                                                      CCA11290
RL5    LXA     OSREL,2                                                  CCA11300
       LAC     RATIO,1       GET M FOR CHOSEN R                         CCA11310
       TXI     *+1,1,1                                                  CCA11320
       CLA     RKM,1                                                    CCA11330
       STO     RKMXS                                                    CCA11340
       SPACE                                                            CCA11350
*                                                                       CCA11360
*              CALCULATE MB2 AND MB3 AND GET SMALLER MERGE ORDER        CCA11370
*                                                                       CCA11380
       CLA     SAM01,2        MERGE ORDER                               CCA11390
       ALS     1             * 2                                        CCA11400
       ADD     =3                                                       CCA11410
       STO     RKT4          (2O+1)                                     CCA11420
       XCA                                                              CCA11430
       MPY     CAL09,2        *ERL2                                     CCA11440
       XCA                                                              CCA11450
       ADD     =2                                                       CCA11460
       STO     RKT5          DENOMINATOR                                CCA11470
       CLA     CAL12,2       SUM OF CF                                  CCA11480
       ADD     =4                                                       CCA11490
       XCA                                                              CCA11500
       MPY     RKT4                                                     CCA11510
       XCA                                                              CCA11520
       ADD     =4                                                       CCA11530
       CHS                                                              CCA11540
       ADD     CAL24,2       ADD MEMORY AVAILABLE, PHASE 2              CCA11550
       LRS     35                                                       CCA11560
       DVP     RKT5                                                     CCA11570
       STL     GEN04,2                                                  CCA11580
       DCT                                                              CCA11590
       TRA     RR2                                                      CCA11600
       STQ     RKMB2                                                    CCA11610
       SPACE                                                            CCA11620
*                                                                       CCA11630
* CALCULATE MB3                                                         CCA11640
*                                                                       CCA11650
       CLA     SAM01,2       MERGE ORDER.                               CCA11660
       ALS     1             * 2                                        CCA11670
       ADD     =2                                                       CCA11680
       STO     RKT6                                                     CCA11690
       XCA                                                              CCA11700
       MPY     CAL10,2       * ERL3                                     CCA11710
       STQ     RKT7          DENOMINATOR                                CCA11720
       CLA     CAL12,2       SUM OF CF                                  CCA11730
       ADD     =4                                                       CCA11740
       XCA                                                              CCA11750
       MPY     RKT6                                                     CCA11760
       STQ     RKT8                                                     CCA11770
       ADD     CAL28,2      OUTPUT BLOCKSIZE FOR WRITE BUFFERS          CCA11780
       ALS     1                                                        CCA11790
       ADD     RKT8                                                     CCA11800
       CHS                                                              CCA11810
       ADD     CAL25,2       ADD MEMORY, PHASE 3                        CCA11820
       LRS     35                                                       CCA11830
       DVP     RKT7                                                     CCA11840
       STL     GEN04,2                                                  CCA11850
       DCT                                                              CCA11860
       TRA     RR2                                                      CCA11870
       STQ     RKMB3                                                    CCA11880
       NZT     RKMB3                                                (10)CCA11882
       TRA     RR2                                                  (10)CCA11884
       CLA     RKMB2         GET SMALLER BLOCKING                       CCA11890
       CAS     RKMB3                                                    CCA11900
       CLA     RKMB3                                                    CCA11910
       NOP                                                              CCA11920
       CAS     MAXB2          COMPARE WITH 2000 WORD TAPE RECORD        CCA11930
       CLA     MAXB2                                                    CCA11940
       NOP                                                              CCA11950
       STO     RKTMB         REDUCE TO MB = M/INTEGER                   CCA11960
       STZ     RKT10                                                    CCA11970
RK30   CLA     =1                                                       CCA11980
       ADD     RKT10                                                    CCA11990
       STO     RKT10                                                    CCA12000
       CLA     RKMXS                                                    CCA12010
       LRS     35                                                       CCA12020
       DVP     RKT10                                                    CCA12030
       STL     GEN04,2                                                  CCA12040
       DCT                                                              CCA12050
       TRA     RR2                                                      CCA12060
       TNZ     RK30                                                     CCA12070
       XCA                                                              CCA12080
       CAS     RKTMB                                                    CCA12090
       TRA     RK30                                                     CCA12100
       NOP                                                              CCA12110
       STO     RKMB                                                     CCA12120
       LXA     OSREL,2       STORE CALCULATED ITEMS.                    CCA12130
       CLA     RKMXS                                                    CCA12140
       STO     CAL06,2       M                                          CCA12150
       CLA     RATIO                                                    CCA12160
       STO     CAL07,2                                                  CCA12170
       CAL     CAL12,2                                                  CCA12180
       ADD     CAL08,2                                                  CCA12190
       ADD     =2                                                       CCA12200
       STO     RKT20                                                    CCA12210
       SUB     =2                                                       CCA12220
       LRS     34                                                       CCA12230
       MPY     CAL06,2                                                  CCA12240
       XCL                                                              CCA12250
       ADD     CAL06,2                                                  CCA12260
       ADD     CAL06,2                                                  CCA12270
       ADD     CAL06,2                                                  CCA12280
       ADD     CAL12,2                                                  CCA12290
       ADD     =10                                                      CCA12300
       STO     RKT22                                                    CCA12310
       ZAC                                                              CCA12320
       NZT     OPT04,2                                                  CCA12330
       TRA     RK24                                                     CCA12340
       LDQ     CAL08,2                                                  CCA12350
       MPY     CAL06,2                                                  CCA12360
       MPY     =2                                                       CCA12370
       XCA                                                              CCA12380
 RK24  ADD     RKT22                                                    CCA12390
       SSM                                                              CCA12400
       ADD     CAL23,2                                                  CCA12410
       XCL                                                              CCA12420
       DVP     RKT20                                                    CCA12430
       STL     GEN04,2                                                  CCA12440
       DCT                                                              CCA12450
       TRA     RR2                                                      CCA12460
       ZET     DEL00,2                                                  CCA12470
       TRA     RK40                                                     CCA12480
       ZET     OPT05,2                                                  CCA12490
       TRA     RK40                                                     CCA12500
       ZAC                                                              CCA12510
       DVP     CAL06,2       M                                          CCA12520
       STQ     CAL07,2       R                                          CCA12530
       ZAC                                                              CCA12540
       MPY     CAL06,2       M                                          CCA12550
RK40   STQ     CAL05,2       L                                          CCA12560
*                            GET PHASE 2 AND PHASE 3 PARAMETERS         CCA12570
       CLA     RKMB                                                     CCA12580
       STO     CAL14,2                                                  CCA12590
       CLA     CAL09,2       ERL2                                       CCA12600
       CAS     CAL10,2       ERL3                                       CCA12610
       TRA     *+3                                                      CCA12620
       TRA     *+2                                                      CCA12630
       CLA     CAL10,2       LARGER                                     CCA12640
       XCA                   *MB                                        CCA12650
       MPY     RKMB                                                     CCA12660
       STQ     CAL13,2                                                  CCA12670
       STQ     CAL17,2                                                  CCA12680
       CLA     SAM02,2                                                  CCA12690
       TZE     RK60                                                     CCA12695
       PAX     ,4                                                       CCA12700
RK50   CLA     FIL02,2                                                  CCA12710
       PAC     ,1                                                       CCA12720
       CLA     -5,1                                                     CCA12730
       CAS     RKT9                                                     CCA12740
       STO     RKT9                                                     CCA12750
       NOP                                                              CCA12760
       TXI     *+1,1,1                                                  CCA12770
       TIX     RK50,4,1                                                 CCA12780
       LXA     OSREL,2                                                  CCA12790
       CLA     CAL13,2                                                  CCA12800
       SUB     RKT9                                                     CCA12810
       TPL     *+3                                                      CCA12820
       STL     GEN04,2                                                  CCA12830
       TRA     RR2                                                      CCA12840
       SPACE                                                            CCA12850
*                                                                       CCA12860
* CALCULATE NUMBER OF MERGE AREAS                                       CCA12870
*                                                                       CCA12880
RK60   CLA     SAM01,2       MERGE ORDER                                CCA12890
       ALS     1             *2                                         CCA12900
       ADD     =2                                                       CCA12910
       STO     CAL16,2      FOR PHASE 3                                 CCA12920
       ADD     =1                                                       CCA12930
       STO     CAL15,2       FOR PHASE 2                                CCA12940
*                                                                       CCA12950
* PRINT CALCULATIONS                                                    CCA12960
*                                                                       CCA12970
       LXA     OSREL,1        COMMON RELOCATION                         CCA12980
       NZT     SAM04,1        TEST FOR A SORT                           CCA12990
       TRA     RRX15                                                    CCA13000
       LDQ     CAL14,2        MERGE BLOCK (RECORD/TAPE RECORD)          CCA13010
       CALL    BTD                                                      CCA13020
       STQ     AM135+7                                                  CCA13030
       TSX     MGSUP,4,4                                                CCA13040
       PZE     1                                                        CCA13050
       PZE     AM135,,8+512*4                                           CCA13060
       TRA     RRX15                                                    CCA13070
 MAXB2 PZE                                                              CCA13080
RKT1                                                                    CCA13090
RKT2                                                                    CCA13100
RKT3                                                                    CCA13110
RKT4                                                                    CCA13120
RKT5                                                                    CCA13130
RKT6                                                                    CCA13140
RKT7                                                                    CCA13150
RKT8                                                                    CCA13160
RKT9                                                                    CCA13170
RKT10                                                                   CCA13180
RKT20                                                                   CCA13190
 RKT22                                                                  CCA13200
RKMB                                                                    CCA13210
 RKM   BSS     0                                                        CCA13220
       DUP     1,10                                                     CCA13230
       PZE                                                              CCA13240
 RKSL  BSS     0                                                        CCA13250
       DUP     1,10                                                     CCA13260
       PZE                                                              CCA13270
RKSLT  DEC     1.0B25,1.2B25,1.4B25,1.5B25,1.6B25,1.67B25,1.70B25       CCA13280
       DEC     1.73B25,1.76B25,1.80B25                                  CCA13290
RKTD                                                                    CCA13300
RKX1                                                                    CCA13310
RKMXS                                                                   CCA13320
RKMB2                                                                   CCA13330
RKMB3                                                                   CCA13340
RKTMB                                                                   CCA13350
RATIO                                                                   CCA13360
       SPACE                                                            CCA13370
*                                                                       CCA13380
*                            CALCULATE MEMORY ALLOCATION FOR MERGE ONLY CCA13390
*                                                                       CCA13400
RR15   LXA     OSREL,1       COMMON RELOCATION                          CCA13410
       CLA     SAM02,1       NO OF FILES TO BE MERGED                   CCA13420
       PAX     0,4                                                      CCA13430
RR16   CLA     FIL02,1       LOCATION OF MERGE FILE BLOCK               CCA13440
       PAC     0,2                                                      CCA13450
       CLA     -5,2          FIND BLOCKSIZE                             CCA13460
       CAS     RR20                                                     CCA13470
       STO     RR20                                                     CCA13480
       NOP                                                              CCA13490
       TXI     *+1,1,1                                                  CCA13500
       TIX     RR16,4,1                                                 CCA13510
*                            COMPARE WITH LARGEST BUFFER SIZE           CCA13520
       LXA     OSREL,1                                                  CCA13530
       CLA     SAM01,1       MERGE ORDER.                               CCA13540
       ALS     1             2*MERGE ORDER                              CCA13550
       ADD     =2                                                       CCA13560
       STO     RKT6M                                                    CCA13570
       XCA                                                              CCA13580
       MPY     CAL10,1       *ERL                                       CCA13590
       STQ     RKT7M         DENOMINATOR                                CCA13600
       CLA     CAL12,1       SUM OF CF                                  CCA13610
       ADD     =4                                                       CCA13620
       XCA                                                              CCA13630
       MPY     RKT6M                                                    CCA13640
       STQ     RKT8M                                                    CCA13650
       ADD     CAL28,1      OUTPUT BLOCKSIZE FOR WRITE BUFFERS          CCA13660
       ALS     1                                                        CCA13670
       ADD     RKT8M                                                    CCA13680
       CHS                                                              CCA13690
       ADD     CAL25,1       ADD MEMORY, PHASE 3                        CCA13700
       LRS     35                                                       CCA13710
       DVP     RKT7M                                                    CCA13720
       STL     GEN04,1                                                  CCA13730
       DCT                                                              CCA13740
       TRA     RR2                                                      CCA13750
       STQ     RKMBM                                                    CCA13760
       TRA     RK22M                                                    CCA13770
RKMBM                                                                   CCA13780
RR20                                                                    CCA13790
RKT6M                                                                   CCA13800
RKT7M                                                                   CCA13810
RKT8M                                                                   CCA13820
RK22M  LDQ     RKMBM                                                    CCA13830
       MPY     CAL10,1       *ERL                                       CCA13840
       XCA                                                              CCA13850
       CAS     RR20          COMPARE WITH INPUT BLOCKSIZE               CCA13860
       TRA     *+3           OK                                         CCA13870
       TRA     *+2                                                      CCA13880
       TRA     RR3                                                      CCA13890
       STO     CAL13,1       WORDS/BUFFER                               CCA13900
       STO     CAL17,1                                                  CCA13910
       CLA     RKMBM         RECORDS/BUFFER                             CCA13920
       STO     CAL14,1                                                  CCA13930
       SPACE                                                            CCA13940
*                                                                       CCA13950
* CALCULATE NUMBER OF MERGE AREAS                                       CCA13960
*                                                                       CCA13970
       CLA     SAM01,1      MERGE ORDER                                 CCA13980
       ADD     SAM01,1                                                  CCA13990
       ADD     =2                                                       CCA14000
       STO     CAL16,1                                                  CCA14010
RRX15  LXA     OSREL,1       GET I/O PARAMETERS                         CCA14020
       CLA     SAM02,1       NO OF FILES TO BE MERGED                   CCA14030
       PAX     0,4                                                      CCA14040
       TXL     PROVO,4,0                                                CCA14050
RRX16  CLA     FIL02,1       LOCATION OF MERGE FILE BLOCK               CCA14060
       PAC     0,2                                                      CCA14070
       SXA     RRX20,1                                                  CCA14080
       LXA     OSREL,1                                                  CCA14090
       CLA     CAL13,1       BUFFER SIZE                                CCA14100
       LRS     35                                                       CCA14110
       DVP     -5,2          /INPUT BLOCKSIZE                           CCA14120
       STL     GEN04,1                                                  CCA14130
       DCT                                                              CCA14140
       TRA     RR2                                                      CCA14150
RRX20  AXT     **,1                                                     CCA14160
       STQ     -20,2         GROUP FACTOR                               CCA14170
       TXI     *+1,1,1                                                  CCA14180
       TIX     RRX16,4,1                                                CCA14190
       TRA     PROVO                                                    CCA14200
RVAAA  BSS     0                                                        CCA14210
       EJECT                                                            CCA14220
*                                                                       CCA14230
*  VARIABLE LENGTH CALCULATIONS                                         CCA14240
*                                                                       CCA14250
*                                                                       CCA14260
*              PHASE 1 MEMORY ALLOCATION                                CCA14270
*              PROGRAMS                                                 CCA14280
*              READ BUFFER = MAX(2000, 2.5*INPUT BLOCKSIZE,             CCA14290
*                   MIN(5000, 2.5*INTERNAL SORT))                       CCA14300
*              READ BUFFER TABLE = 1 WORD/100 WORDS OF BUFFER           CCA14310
*              LOCATE TABLE = BUFFER/LENGTH OF SHORTEST LOGICAL RECORD  CCA14320
*              L TABLE NO 1 = NO OF BINS + 3                            CCA14330
*              L TABLE NO 2 = NO OF BINS + 3                            CCA14340
*              SORT TABLE = INTERNAL SORT/BIN LENGTH                    CCA14350
*              BLOCK LIST FOR PUT = INTERNAL SORT/MERGE BLOCKSIZE       CCA14360
*              LAST RECORD AREA = LENGTH OF CF, INCLUDING EQUALS WORD   CCA14370
*              8 CELLS EXTRA                                            CCA14380
*              RECORD STORAGE AREA                                      CCA14390
*              COMMON                                                   CCA14400
*              RATIO R = (RECORD STORAGE AREA/INTERNAL SORT) - 1        CCA14410
*                                                                       CCA14420
*              PHASE 2 MEMORY ALLOCATION                                CCA14430
*              PROGRAMS                                                 CCA14440
*              2*(MERGE ORDER) + 3      READ BUFFER AREAS               CCA14450
*              2 WRITE TABLES                                           CCA14460
*              (MERGE ORDER + 1)  PACKED CONTROL FIELDS                 CCA14470
*              12 EXTRA WORDS                                           CCA14480
*                                                                       CCA14490
*              PHASE 3 MEMORY ALLOCATION                                CCA14500
*              2*(MERGE ORDER) + 2    READ BUFFERS                      CCA14510
*              2 OUTPUT BUFFERS                                         CCA14520
*              2 WRITE TABLES                                           CCA14530
*              (MERGE ORDER + 1) PACKED CONTROL FIELDS                  CCA14540
*              2*(MERGE ORDER) + 2    AREA WORDS                        CCA14550
*              2*(MERGE ORDER) + 2    ADDRESS WORDS                     CCA14560
*              (16*MERGE ORDER)  TABLES                                 CCA14570
*              21 EXTRA WORDS                                           CCA14580
*                                                                       CCA14590
       DCT                                                              CCA14600
       NOP                                                              CCA14610
       LXA     OSREL,1                                                  CCA14620
       CLA     CAL12,1      GET SUM OF CF, INCLUDING EQUALS WORD        CCA14630
       ADD     OPT03,1                                                  CCA14640
       STO     CAL32,1                                                  CCA14650
       NZT     SAM04,1                                                  CCA14660
       TRA     RVB3         BYPASS IF MERGE ONLY                        CCA14670
       ADD     OPT01,1      AND CHECKSUM WORD, IF ANY                   CCA14680
       ADD     =2           LENGTH WORD AND FINALE WORD                 CCA14690
       STO     RVT20                                                    CCA14700
       CLA     SAM03,1                                                  CCA14710
       PDX     0,2          NO OF CONTROL FIELDS                        CCA14720
       PAC     0,4          LOCATION OF CONTROL FIELD TABLE             CCA14730
       STZ     RVT21                                                    CCA14740
RVB1   CLA     0,4                                                      CCA14750
       ANA     =O77777      LAST WORD OF CF                             CCA14760
       CAS     RVT21                                                    CCA14770
       STO     RVT21                                                    CCA14780
       TRA     *+2                                                      CCA14790
       NOP                                                              CCA14800
       TXI     *+1,4,9                                                  CCA14810
       TIX     RVB1,2,1                                                 CCA14820
       CLA     RVT21                                                    CCA14830
       ADD     RVT20                                                    CCA14840
       STO     RVBL1                                                    CCA14850
       CLA     REC00,1      ALSO GET BIN LENGTH FOR L MIN, L MAJ, AND   CCA14860
       ADD     RVT20             L MAX                                  CCA14870
       STO     RVBLMN                                                   CCA14880
       CLA     REC01,1                                                  CCA14890
       ADD     RVT20                                                    CCA14900
       STO     RVBLMJ                                                   CCA14910
       CLA     REC02,1                                                  CCA14920
       ADD     RVT20                                                    CCA14930
       STO     RVBLMX                                                   CCA14940
       CLA     RVBLMJ                                                   CCA14950
       CAS     =20                                                      CCA14960
       TRA     RVB2                                                     CCA14970
       NOP                                                              CCA14980
RVB5   STO     CAL03,1                                                  CCA14990
       STO     RVBINL        SAVE BIN LENGTH                            CCA15000
       TRA     RVB3                                                     CCA15010
RVB2   SUB     =1                                                       CCA15020
       STO     RVT22                                                    CCA15030
       AXT     2,2                                                      CCA15040
RVB6   SXA     RVT23,2                                                  CCA15050
       LRS     35                                                       CCA15060
       DVP     RVT23                                                    CCA15070
       XCA                                                              CCA15080
       ADD     =1                                                       CCA15090
       CAS     RVBL1                                                    CCA15100
       TRA     *+3                                                      CCA15110
       TRA     *+2                                                      CCA15120
       TRA     RVB4                                                     CCA15130
       CAS     =20                                                      CCA15140
       TRA     *+3                                                      CCA15150
       NOP                                                              CCA15160
       TRA     RVB5                                                     CCA15170
       LXA     RVT23,2                                                  CCA15180
       TXI     *+1,2,1                                                  CCA15190
       CLA     RVT22                                                    CCA15200
       TRA     RVB6                                                     CCA15210
RVB4   LXA     RVT23,2                                                  CCA15220
       TXI     *+1,2,-1                                                 CCA15230
       SXA     RVT23,2                                                  CCA15240
       CLA     RVT22                                                    CCA15250
       LRS     35                                                       CCA15260
       DVP     RVT23                                                    CCA15270
       XCA                                                              CCA15280
       ADD     =1                                                       CCA15290
       TRA     RVB5                                                     CCA15300
*              CALCULATE MAXIMUM MERGE BLOCKSIZE, PH 2                  CCA15310
*              MBMAX = (MEM2 - (O + 3)(CF) - 12)                        CCA15320
*              /(2O + 1 + 2/LMIN)                                       CCA15330
RVB3   BSS     0                                                        CCA15340
       CLA     =2                                                       CCA15350
       LRS     35                                                       CCA15360
       DVP     REC00,1      2/L MIN                                     CCA15370
       STL     GEN04,1                                                  CCA15380
       DCT                                                              CCA15390
       TRA     RR2                                                      CCA15400
       STO     RVT1                                                     CCA15410
       XCA                                                              CCA15420
       ZET     RVT1                                                     CCA15430
       ADD     =1                                                       CCA15440
       STO     RVT2                                                     CCA15450
       NZT     SAM04,1      BYPASS IF MERGE ONLY                        CCA15460
       TRA     RVB3A                                                    CCA15470
       ADD     =3                                                       CCA15480
       ADD     SAM01,1      + MERGE ORDER                               CCA15490
       ADD     SAM01,1                                                  CCA15500
       STO     RVT1                                                     CCA15510
       CLA     SAM01,1                                                  CCA15520
       ADD     =1                                                       CCA15530
       STO     RVX                                                      CCA15540
       XCA                                                              CCA15550
       MPY     CAL32,1                                                  CCA15560
       ADD     =12                                                      CCA15570
       CHS                                                              CCA15580
       ADD     CAL24,1      AVAILABLE MEMORY, PH 2                      CCA15590
       LRS     35                                                       CCA15600
       DVP     RVT1                                                     CCA15610
       STL     GEN04,1                                                  CCA15620
       DCT                                                              CCA15630
       TRA     RR2                                                      CCA15640
       STQ     RVMB2                                                    CCA15650
       TRA     RVB3B                                                    CCA15660
*              CALCULATE MAXIMUM MERGE BLOCKSIZE, PH 3                  CCA15670
*              MBMAX = (MEM3 - OB(2/LMIN + 2) - 21 - CF - O(21 + CF)    CCA15680
*              )/(2O + 2)                                               CCA15690
*              WHERE MEM3 = MEMORY AVAILABLE, PHASE 3                   CCA15700
*              OB = OUTPUT BLOCKSIZE, IN WORDS                          CCA15710
*              LMIN = MINIMUM RECORD LENGTH                             CCA15720
*              CF = LENGTH OF PACKED CONTROL FIELD, INCLUDING EQUALS    CCA15730
*              WORD                                                     CCA15740
*              O = MERGE ORDER                                          CCA15750
RVB3A  CLA     =2000        SET MB2 = 2000                              CCA15760
       STO     RVMB2                                                    CCA15770
       CLA     SAM01,1                                                  CCA15780
       ADD     =1                                                       CCA15790
       STO     RVX                                                      CCA15800
RVB3B  CLA     FIL01,1      OUTPUT BLOCKSIZE                            CCA15810
       SUB     =5                                                       CCA15820
       STA     *+1                                                      CCA15830
       CLA     **                                                       CCA15840
       CAS     REC01,1       TAKE MX OUTPUT RECORD SIZE                 CCA15850
       TRA     *+3            IF IT EXCEEDS BLOCKSIZE GIVEN             CCA15860
       TRA     *+2            ON OUTPUT FILE CARD.                      CCA15870
       CLA     REC01,1                                                  CCA15880
       ALS     1                                                        CCA15890
       XCA                                                              CCA15900
       STQ     RVB                                                      CCA15910
       ADD     =21                                                      CCA15920
       STO     RVT3                                                     CCA15930
       CLA     =21                                                      CCA15940
       ADD     CAL32,1                                                  CCA15950
       XCA                                                              CCA15960
       MPY     SAM01,1                                                  CCA15970
       XCA                                                              CCA15980
       ADD     RVT3                                                     CCA15990
       ADD     CAL32,1                                                  CCA16000
       ADD     RVB                                                      CCA16010
       CHS                                                              CCA16020
       ADD     CAL25,1      AVAILABLE MEMORY, PH 3                      CCA16030
       LRS     36                                                       CCA16040
       DVP     RVX                                                      CCA16050
       STL     GEN04,1                                                  CCA16060
       DCT                                                              CCA16070
       TRA     RR2                                                      CCA16080
       XCA                                                              CCA16090
       CAS     =2000                                                    CCA16100
       CLA     =2000                                                    CCA16110
       TRA     *+1                                                      CCA16120
       STO     RVMB3                                                    CCA16130
       STZ     RVTEX        SCAN EXTERNAL FILES FOR LARGEST BLOCK       CCA16140
       CAL     SAM02,1      NO OF FILES TO BE MERGED                    CCA16150
       PAX     0,2                                                      CCA16160
       TXL     RVB3D,2,0                                                CCA16170
RVB3C  CAL     FIL02,1                                                  CCA16180
       SUB     =5           GE T BLOCKSIZE                              CCA16190
       STA     *+1                                                      CCA16200
       CLA     **                                                       CCA16210
       CAS     RVTEX                                                    CCA16220
       STO     RVTEX                                                    CCA16230
       TRA     *+1                                                      CCA16240
       TXI     *+1,1,1                                                  CCA16250
       TIX     RVB3C,2,1                                                CCA16260
       LXA     OSREL,1                                                  CCA16270
       CLA     RVMB3        COMPARE WITH LARGEST AVAILABLE BLOCKSIZE    CCA16280
       SUB     RVTEX                                                    CCA16290
       TPL     RVB3D                                                    CCA16300
       STL     GEN04,1                                                  CCA16310
       TRA     RR2                                                      CCA16320
RVB3D  CLA     RVMB3                                                    CCA16330
       CAS     REC01,1                                                  CCA16340
       TRA     *+4                                                      CCA16350
       TRA     *+3                                                      CCA16360
       STL     GEN04,1                                                  CCA16370
       TRA     RR2                                                      CCA16380
       STO     CAL17,1       BLOCKSIZE, PHASE 3.                        CCA16390
       NZT     SAM04,1                                                  CCA16400
       TRA     RVA30                                                    CCA16410
       LDQ     REC01,1      L MAX                                       CCA16420
       MPY     =2.5B34      * 2.5                                       CCA16430
       XCA                                                              CCA16440
       CAS     =5000B34                                                 CCA16450
       CLA     =5000B34                                                 CCA16460
       NOP                                                              CCA16470
       STO     RVT4                                                     CCA16480
       CLA     FIL00,1      ADDRESS OF INPUT FILE BLOCK                 CCA16490
       SUB     =5                                                       CCA16500
       STA     *+1                                                      CCA16510
RVA1   LDQ     **           INPUT BLOCKSIZE                             CCA16520
       MPY     =2.5B34                                                  CCA16530
       XCA                                                              CCA16540
       CAS     RVT4                                                     CCA16550
       TRA     *+3                                                      CCA16560
       NOP                                                              CCA16570
       CLA     RVT4                                                     CCA16580
       CAS     =2000B34                                                 CCA16590
       TRA     *+3                                                      CCA16600
       NOP                                                              CCA16610
       CLA     =2000B34                                                 CCA16620
       ARS     1                                                        CCA16630
       STO     RVT5                                                     CCA16640
*              CALCULATE R MAX                                          CCA16650
       CLA     RVBINL                                                   CCA16660
       ADD     =1                                                       CCA16670
       ALS     1                                                        CCA16680
       STO     RVT8A                                                    CCA16690
       PXD     0,0                                                      CCA16700
       LDQ     =1B30                                                    CCA16710
       DVP     REC00,1      1/L MIN                                     CCA16720
       STL     GEN04,1                                                  CCA16730
       DCT                                                              CCA16740
       TRA     RR2                                                      CCA16750
       XCA                  SCALE IS 30                                 CCA16760
       ADD     =1.01B30                                                 CCA16770
       STO     RVT5A                                                    CCA16780
       XCA                                                              CCA16790
       MPY     RVT5                                                     CCA16800
       LLS     30                                                       CCA16810
       ADD     =14                                                      CCA16820
       ADD     CAL12,1      SUM OF CF                                   CCA16830
       STO     RVT6                                                     CCA16840
       CLA     SAM01,1      MERGE ORDER                                 CCA16850
       ALS     1            TIMES 2                                     CCA16860
       CAS     =20                                                      CCA16870
       TRA     *+3                                                      CCA16880
       NOP                                                              CCA16890
       CLA     =20                                                      CCA16900
       STO     RVT7A                                                    CCA16910
       ADD     RVT6                                                     CCA16920
       CHS                                                              CCA16930
       ADD     CAL23,1      AVAILABLE MEMORY, PH 1                      CCA16940
       XCA                                                              CCA16950
       MPY     RVBINL       SCALE IS 35                                 CCA16960
       STQ     RVT8                                                     CCA16970
       DVP     REC01,1      L MAX                                       CCA16980
       STL     GEN04,1                                                  CCA16990
       DCT                                                              CCA17000
       TRA     RR2                                                      CCA17010
       XCA                                                              CCA17020
       SUB     =3                                                       CCA17030
       SUB     RVBINL                                                   CCA17040
       LRS     35                                                       CCA17050
       STL     GEN04,1                                                  CCA17060
       DVP     RVT8A                                                    CCA17070
       DCT                                                              CCA17080
       TRA     RR2                                                      CCA17090
       XCA                                                              CCA17100
       STO     RVT7                                                     CCA17110
       CAS     =10          REDUCE TO 10. IF NECESSARY                  CCA17120
       CLA     =10                                                      CCA17130
       NOP                                                              CCA17140
       STO     RVRMAX                                                   CCA17150
*              ADJUST R ACCORDING TO INPUT BLOCKSIZE                    CCA17160
       CLA*    RVA1                                                     CCA17170
       CAS     =100                                                     CCA17180
       TRA     *+3                                                      CCA17190
       NOP                                                              CCA17200
       TRA     RVA2                                                     CCA17210
       CAS     =300                                                     CCA17220
       TRA     *+3                                                      CCA17230
       NOP                                                              CCA17240
       TRA     RVA3                                                     CCA17250
       CLA     =4           GREATER THAN 300, USE R = 4                 CCA17260
RVA6   CAS     RVRMAX                                                   CCA17270
       CLA     RVRMAX                                                   CCA17280
       NOP                                                              CCA17290
       STO     RVR                                                      CCA17300
       TRA     RVA5                                                     CCA17310
RVA3   CLA     =5           100-300, USE R=5                            CCA17320
       TRA     RVA6                                                     CCA17330
RVA2   CLA     =6           LESS THAN 200, USE R = 6                    CCA17340
       TRA     RVA6                                                     CCA17350
RVA5   CLA     RVR          BASED ON THIS VALUE OF R, CALCULATE M       CCA17360
       ALS     1                                                        CCA17370
       ADD     =3                                                       CCA17380
       STO     RVT9         2*R + 3                                     CCA17390
       SUB     =2                                                       CCA17400
       XCA                                                              CCA17410
       MPY     RVBINL                                                   CCA17420
       XCA                                                              CCA17430
       ADD     RVT9                                                     CCA17440
       STO     RVT9                                                     CCA17450
       CLA     RVT8                                                     CCA17460
       LRS     35                                                       CCA17470
       DVP     RVT9                                                     CCA17480
       STL     GEN04,1                                                  CCA17490
       DCT                                                              CCA17500
       TRA     RR2                                                      CCA17510
       STQ     RVM1         INITIAL GUESS                               CCA17520
       MPY     =2.5B34      RECALCULATE BY FULL EQUATION                CCA17530
       XCA                                                              CCA17540
       CAS     =5000B34                                                 CCA17550
       CLA     =5000B34                                                 CCA17560
       NOP                                                              CCA17570
       STO     RVT4A                                                    CCA17580
       LDQ*    RVA1                                                     CCA17590
       MPY     =2.5B34                                                  CCA17600
       XCA                                                              CCA17610
       CAS     RVT4A                                                    CCA17620
       TRA     *+3                                                      CCA17630
       NOP                                                              CCA17640
       CLA     RVT4A                                                    CCA17650
       CAS     =2000B34                                                 CCA17660
       TRA     *+3                                                      CCA17670
       NOP                                                              CCA17680
       CLA     =2000B34                                                 CCA17690
       ARS     1                                                        CCA17700
       STO     CAL31,1      LENGTH OF BUFFER                            CCA17710
       XCA                                                              CCA17720
       MPY     RVT5A                                                    CCA17730
       LLS     30                                                       CCA17740
       ADD     =14                                                      CCA17750
       ADD     CAL12,1                                                  CCA17760
       STO     RVT6A                                                    CCA17770
       ADD     RVT7A                                                    CCA17780
       CHS                                                              CCA17790
       ADD     CAL23,1                                                  CCA17800
       XCA                                                              CCA17810
       MPY     RVBINL                                                   CCA17820
       DVP     RVT9                                                     CCA17830
       STL     GEN04,1                                                  CCA17840
       DCT                                                              CCA17850
       TRA     RR2                                                      CCA17860
       STQ     RVM                                                      CCA17870
*              RECALCULATE MB                                           CCA17880
       XCA                   GET OPTIMUM PHASE 1 MERGE BLOCKING.        CCA17890
       CAS     RVMB2                                                    CCA17900
       CLA     RVMB2                                                    CCA17910
       TRA     *+1                                                      CCA17920
       CAS     RVMB3                                                    CCA17930
       CLA     RVMB3                                                    CCA17940
       TRA     *+1                                                      CCA17950
       STO     RVMB          SET PHASE 1 AND 2 MB TO SMALLEST OF ALL.   CCA17960
       CLA     RVM                                                      CCA17970
       LRS     35                                                       CCA17980
       DVP     RVMB                                                     CCA17990
       STL     GEN04,1                                                  CCA18000
       DCT                                                              CCA18010
       TRA     RR2                                                      CCA18020
       STO     RVT10                                                    CCA18030
       XCA                                                              CCA18040
       ZET     RVT10                                                    CCA18050
       ADD     =1                                                       CCA18060
       STO     RVT11                                                    CCA18070
       CLA     RVM                                                      CCA18080
       LRS     35                                                       CCA18090
       DVP     RVT11        MB IS M/K                                   CCA18100
       STL     GEN04,1                                                  CCA18110
       DCT                                                              CCA18120
       TRA     RR2                                                      CCA18130
       XCA                                                              CCA18140
       CAS     REC01,1      COMPARE TO L MAX                            CCA18150
       TRA     RVA8                                                     CCA18160
       TRA     RVA8                                                     CCA18170
       CLA     REC01,1      LESS THAN L MAX, USE L MAX                  CCA18180
RVA8   STO     CAL13,1                                                  CCA18190
       CLA     RVM          GET NUMBER OF BLOCKS TO WRITE               CCA18200
       LRS     35                                                       CCA18210
       DVP     CAL13,1                                                  CCA18220
       STQ     CAL33,1                                                  CCA18230
       CLA     CAL31,1      GET LENGTH OF BUFFER TABLE, PH 1            CCA18240
       LRS     35                                                       CCA18250
       DVP     =100                                                     CCA18260
       XCA                                                              CCA18270
       ADD     =1                                                       CCA18280
       STO     CAL35,1                                                  CCA18290
       CLA     CAL31,1      GET LENGTH OF LOCATE TABLE, PH 1            CCA18300
       LRS     35                                                       CCA18310
       DVP     REC00,1      L MIN                                       CCA18320
       XCA                                                              CCA18330
       ADD     =3                                                       CCA18340
       STO     CAL36,1                                                  CCA18350
       CLA     =500         GET MINIMUM WORDS/PUT, PH 1                 CCA18360
       CAS     RVM                                                      CCA18370
       CLA     RVM                                                      CCA18380
       NOP                                                              CCA18390
       STO     CAL34,1                                                  CCA18400
       CLA     RVM          GET LENGTH OF SORT TABLE                    CCA18410
       LRS     35                                                       CCA18420
       DVP     REC00,1      L MIN                                       CCA18430
       XCA                                                              CCA18440
       ADD     =1                                                       CCA18450
       STO     CAL06,1                                                  CCA18460
       CLA     CAL03,1      BIN LENGTH                                  CCA18470
       ADD     =2                                                       CCA18480
       STO     RVT12                                                    CCA18490
       CLA     CAL23,1      GET RECORD STORAGE AREA FROM MEM1           CCA18500
       SUB     CAL31,1      - LENGTH OF BUFFER                          CCA18510
       SUB     CAL35,1      - LENGTH OF BUFFER TABLE                    CCA18520
       SUB     CAL36,1      - LENGTH OF LOCATE TABLE                    CCA18530
       SUB     CAL33,1      - PUT BLOCK                                 CCA18540
       SUB     CAL32,1      - LAST RECORD CONTROL FIELD AREA            CCA18550
       SUB     =14          - 14 NEEDED CELLS                           CCA18560
       SUB     CAL06,1      - SORT TABLE                                CCA18570
       LRS     35                                                       CCA18580
       DVP     RVT12                                                    CCA18590
       LRS     1                                                        CCA18600
       LLS     1                                                        CCA18610
       STQ     CAL05,1      LENGTH OF L TABLE                           CCA18620
       MPY     CAL03,1                                                  CCA18630
       STQ     CAL04,1      RECORD STORAGE AREA                         CCA18640
       CLA     RVR          STORE RATIO                                 CCA18650
       STO     CAL07,1                                                  CCA18660
       CLA     FIL00,1      MAXIMUM INPUT BLOCKSIZE                     CCA18670
       SUB     =5                                                       CCA18680
       STA     *+1                                                      CCA18690
       CLA     **                                                       CCA18700
       STO     CAL26,1                                                  CCA18710
RVA30  BSS     0                                                        CCA18720
       CLA     CAL13,1      GET MAXIMUM MERGE BLOCKING, IN RECORDS      CCA18730
       LRS     35                                                       CCA18740
       DVP     REC00,1                                                  CCA18750
       XCA                                                              CCA18760
       ADD     =1                                                       CCA18770
       STO     CAL14,1                                                  CCA18780
       CLA     FIL01,1      GET MAX NO OF RECORDS/OUTPUT BLOCK, PH 3    CCA18790
       PAC     ,4            -(LOCATION OF OUTPUT FILE BLOCK).          CCA18800
       CLA     REC01,1       MAXIMUM VARIABLE RECORD SIZE.              CCA18810
       LDQ     -5,4          OUTPUT BLOCKSIZE REQUESTED.                CCA18820
       TLQ     *+2           SELECT LARGER OF THE TWO FOR               CCA18830
       XCA                    BUFFER SIZE TO BE USED FOR OUTPUT.        CCA18840
       STO     CAL28,1                                                  CCA18850
       LRS     35                                                       CCA18860
       DVP     REC00,1                                                  CCA18870
       STQ     CAL02,1                                                  CCA18880
       CLA     SAM01,1      GET NO OF MERGE AREAS, PH 2                 CCA18890
       ALS     1                                                        CCA18900
       ADD     =2                                                       CCA18910
       STO     CAL16,1                                                  CCA18920
       ADD     =1                                                       CCA18930
       STO     CAL15,1                                                  CCA18940
       TRA     PROVO                                                    CCA18950
RVT1                                                                    CCA18960
RVMB2                       MAXIMUM MERGE BLOCKSIZE, PH 2, IN WORDS     CCA18970
RVMB3                       MAXIMUM MERGE BLOCKSIZE, PH 3, IN WORDS     CCA18980
RVT2                                                                    CCA18990
RVT3                                                                    CCA19000
RVMBT                       ACTUAL BLOCKSIZE                            CCA19010
RVM                                                                     CCA19020
RVT4                        MIN OF (2.5 $ LMAX, 5000)                   CCA19030
RVT5                        MAX OF (RVT4, 2.5 * INPUT BLOCKSIZE, 2000)  CCA19040
RVT6                                                                    CCA19050
RVBINL                      BIN LENGTH, IN WORDS                        CCA19060
RVRMAX                      MAXIMUM RATIO                               CCA19070
RVT7                                                                    CCA19080
RVR                         ACTUAL RATIO                                CCA19090
RVT8                        BIN LENGTH*(MEM1 - TABLES - BUFFER)         CCA19100
RVT9                                                                    CCA19110
RVT4A                                                                   CCA19120
RVT5A                                                                   CCA19130
RVT6A                                                                   CCA19140
RVT7A                                                                   CCA19150
RVT8A                                                                   CCA19160
RVM1                                                                    CCA19170
RVMB                                                                    CCA19180
RVT10                                                                   CCA19190
RVT11                                                                   CCA19200
RVT12                                                                   CCA19210
RVT20                       CF + EQUALS + CKSUM + FINALE                CCA19220
RVT21                       RECORD LENGTH, CONTAINING ALL CF            CCA19230
RVB                                                                     CCA19240
RVBL1                       MINIMUM BIN LENGTH                          CCA19250
RVBLMN                      BIN LENGTH FOR L MIN                        CCA19260
RVBLMJ                      BIN LENGTH FOR L MAJ                        CCA19270
RVBLMX                      BIN LENGTH FOR L MAX                        CCA19280
RVT22                                                                   CCA19290
RVT23                                                                   CCA19300
RVTEX                                                                   CCA19310
RVX                                                                     CCA19320
       SPACE                                                            CCA19330
*                                                                       CCA19340
*  RETURNS TO EP001                                                     CCA19350
*                                                                       CCA19360
 PROVO AXT     **,4           NORMAL RETURN                             CCA19370
       TRA     2,4                                                      CCA19380
*                                                                       CCA19390
*  DELETE THIS JOB                                                      CCA19400
*                                                                       CCA19410
 EP007 LXA     PROVO,4        DELETE RETURN                             CCA19420
       TRA     1,4                                                      CCA19430
       SPACE                                                            CCA19440
*  TABLE OF ALLOWABLE PROGRAMS FOR INSERTION INTO PROGRAM LIST          CCA19450
*                                                                       CCA19460
       BCI     1,XSM010                                                 CCA19470
       BCI     1,XSM020                                                 CCA19480
       BCI     1,XSM030                                                 CCA19490
       BCI     1,XSM040                                                 CCA19500
       BCI     1,XSM050                                                 CCA19510
       BCI     1,XSM060                                                 CCA19520
       BCI     1,XSM070                                                 CCA19530
       BCI     1,XSM080                                                 CCA19540
       BCI     1,XSM090                                                 CCA19550
       BCI     1,XSM100                                                 CCA19560
MODTAB BSS     0                                                        CCA19570
       BCI     1,MPM010                                                 CCA19580
       BCI     1,MPM020                                                 CCA19590
       BCI     1,MPM030                                                 CCA19600
       BCI     1,MPM040                                                 CCA19610
       BCI     1,MPM050                                                 CCA19620
MODMPM BSS     0                                                        CCA19630
       BCI     1,FMM010                                                 CCA19640
       BCI     1,FMM020                                                 CCA19650
       BCI     1,FMM030                                                 CCA19660
       BCI     1,FMM040                                                 CCA19670
       BCI     1,FMM050                                                 CCA19680
       BCI     1,FMM060                                                 CCA19690
       BCI     1,FMM070                                                 CCA19700
       BCI     1,FMM080                                                 CCA19710
       BCI     1,FMM090                                                 CCA19720
       BCI     1,FMM100                                                 CCA19730
MODFMM BSS     0                                                        CCA19740
       BCI     1,DXS01                                                  CCA19750
       BCI     1,DXS02                                                  CCA19760
       BCI     1,DXS03                                                  CCA19770
       BCI     1,DXS04                                                  CCA19780
       BCI     1,DXS05                                                  CCA19790
       BCI     1,DXS06                                                  CCA19800
       BCI     1,DXS07                                                  CCA19810
       BCI     1,DXS08                                                  CCA19820
       BCI     1,DXS09                                                  CCA19830
       BCI     1,DXS10                                                  CCA19840
MODDXS BCI     1,DMP01                                                  CCA19850
       BCI     1,DMP02                                                  CCA19860
       BCI     1,DMP03                                                  CCA19870
       BCI     1,DMP04                                                  CCA19880
       BCI     1,DMP05                                                  CCA19890
MODDMP BCI     1,DFM01                                                  CCA19900
       BCI     1,DFM02                                                  CCA19910
       BCI     1,DFM03                                                  CCA19920
       BCI     1,DFM04                                                  CCA19930
       BCI     1,DFM05                                                  CCA19940
       BCI     1,DFM06                                                  CCA19950
       BCI     1,DFM07                                                  CCA19960
       BCI     1,DFM08                                                  CCA19970
       BCI     1,DFM09                                                  CCA19980
       BCI     1,DFM10                                                  CCA19990
MODDFM BSS     0                                                        CCA20000
       SPACE                                                            CCA20010
 AM131 BCI     4,TO DELETE SORT, START.                                 CCA20020
 AM132 BCI     7,CORE TOO SMALL. SORTING IMPOSSIBLE. *SA02              CCA20030
 AM135 BCI     8,MERGE BLOCKING (RECORD/TAPE BLOCK)                     CCA20040
       SPACE   2                                                        CCA20050
 OPTPR COMMON  15             OPTION CARD PARAMETERS                    CCA20060
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  CCA20070
 LABPR COMMON  5              LABEL CARD PARAMETERS                     CCA20080
 CHAPR COMMON  6              CHANNEL CARD PARAMETERS                   CCA20090
 FILPR COMMON  14             FILE CARD PARAMETERS                      CCA20100
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              CCA20110
 RECPR COMMON  10             RECORD CARD PARAMETERS                    CCA20120
 DELPR COMMON  2              DELETE CARD PARAMETERS                    CCA20130
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            CCA20140
 CALPR COMMON  50             CALCULATED PARAMETERS                     CCA20150
 GENPR COMMON  10             GENERAL PARAMETERS                        CCA20160
 RAWPR COMMON  30             READ AND WRITE PARAMETERS                 CCA20170
 CNTPR COMMON  20             COUNT PARAMETERS                          CCA20180
 ERAPR COMMON  30             ERASABLE STORAGE PARAMETERS               CCA20190
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           CCA20200
CAL00  EQU     CALPR                                                    CCA20210
CAL01  EQU     CALPR-1                                                  CCA20220
CAL02  EQU     CALPR-2                                                  CCA20230
CAL03  EQU     CALPR-3                                                  CCA20240
CAL04  EQU     CALPR-4                                                  CCA20250
CAL05  EQU     CALPR-5                                                  CCA20260
CAL06  EQU     CALPR-6                                                  CCA20270
CAL07  EQU     CALPR-7                                                  CCA20280
CAL08  EQU     CALPR-8                                                  CCA20290
CAL09  EQU     CALPR-9                                                  CCA20300
CAL10  EQU     CALPR-10                                                 CCA20310
CAL11  EQU     CALPR-11                                                 CCA20320
CAL12  EQU     CALPR-12                                                 CCA20330
CAL13  EQU     CALPR-13                                                 CCA20340
CAL14  EQU     CALPR-14                                                 CCA20350
CAL15  EQU     CALPR-15                                                 CCA20360
CAL16  EQU     CALPR-16                                                 CCA20370
CAL17  EQU     CALPR-17                                                 CCA20380
CAL18  EQU     CALPR-18                                                 CCA20390
CAL19  EQU     CALPR-19                                                 CCA20400
CAL20  EQU     CALPR-20                                                 CCA20410
CAL23  EQU     CALPR-23                                                 CCA20420
CAL24  EQU     CALPR-24                                                 CCA20430
CAL25  EQU     CALPR-25                                                 CCA20440
CAL26  EQU     CALPR-26                                                 CCA20450
CAL28  EQU     CALPR-28                                                 CCA20460
CAL31  EQU     CALPR-31                                                 CCA20470
CAL32  EQU     CALPR-32                                                 CCA20480
CAL33  EQU     CALPR-33                                                 CCA20490
CAL34  EQU     CALPR-34                                                 CCA20500
CAL35  EQU     CALPR-35                                                 CCA20510
CAL36  EQU     CALPR-36                                                 CCA20520
DEL00  EQU     DELPR                                                    CCA20530
FIL00  EQU     FILPR                                                    CCA20540
FIL01  EQU     FILPR-1                                                  CCA20550
FIL02  EQU     FILPR-2                                                  CCA20560
GEN01  EQU     GENPR-1                                                  CCA20570
GEN04  EQU     GENPR-4                                                  CCA20580
MOD00  EQU     MODPR                                                    CCA20590
MOD10  EQU     MODPR-10                                                 CCA20600
MOD15  EQU     MODPR-15                                                 CCA20610
MOD25  EQU     MODPR-25                                                 CCA20620
OPT01  EQU     OPTPR-1                                                  CCA20630
OPT02  EQU     OPTPR-2                                                  CCA20640
OPT03  EQU     OPTPR-3                                                  CCA20650
OPT04  EQU     OPTPR-4                                                  CCA20660
OPT05  EQU     OPTPR-5                                                  CCA20670
OPT06  EQU     OPTPR-6                                                  CCA20680
RAW09  EQU     RAWPR-9                                                  CCA20690
RAW25  EQU     RAWPR-25                                                 CCA20700
REC00  EQU     RECPR                                                    CCA20710
REC01  EQU     RECPR-1                                                  CCA20720
REC02  EQU     RECPR-2                                                  CCA20730
REC05  EQU     RECPR-5                                                  CCA20740
REF00  EQU     REFPR                                                    CCA20750
SAM00  EQU     SAMPR                                                    CCA20760
SAM01  EQU     SAMPR-1                                                  CCA20770
SAM02  EQU     SAMPR-2                                                  CCA20780
SAM03  EQU     SAMPR-3                                                  CCA20790
SAM04  EQU     SAMPR-4                                                  CCA20800
       EXTERN  MGSUP                                                    CCA20810
       SPACE   2                                                        CCA20820
       DETAIL                                                           CCA20830
       END                                                              CCA20840
* 7090/7094 SORT VER 7 MOD 10 EDIT PHASE SUBPROGRAM                 (10)CEP00000
*      FAP
       COUNT   6000                                                     CEP00010
       ENTRY   EP001                                                    CEP00020
       ENTRY   CNVRT                                                    CEP00030
       ENTRY   ASSIGN                                                   CEP00040
       ENTRY   MGSUP                                                    CEP00050
       SST                                                              CEP00060
       TITLE                                                            CEP00070
 EP001 SXA     EP002,4        SAVE POINTER FOR RETURN TO SORT MONITOR   CEP00080
       SXA     CARDS,2                                                  CEP00090
       SXA     PB009,1                                                  CEP00100
       SXA     BUFBAS,1      SAVE BASE OF READ-AHEAD BUFFER.         (2)CEP00105
       STQ     LASTDL        MQ MINUS IF PREVIOUS SORT DELETED.      (2)CEP00106
       TRA     START                                                    CEP00110
*                                                                       CEP00120
*  NORMAL SORT RETURN TO SORT MONITOR                                   CEP00130
*                                                                       CEP00140
 EP002 AXT     **,4           RESTORE RETURN POINTER                    CEP00150
       AXT     1,1                                                      CEP00160
       ZET     OSMAP                                                    CEP00170
       AXT     0,1                                                      CEP00180
       TRA     3,4            RETURN TO SORT MONITOR                    CEP00190
*                                                                       CEP00200
*  RESTART RETURN TO SORT MONITOR                                       CEP00210
*                                                                       CEP00220
EP003  AXC     DELTB,2       COMMUNICATE A SAFE READ BUFFER LOCATION    CEP00230
       PXA     ,2             FOR CHECKPOINT TAPE LABEL TO THE          CEP00240
       STO     LAB00          LABEL READING AND CHECKING ROUTINES       CEP00250
       STL     GEN03          VIA LABPR.                                CEP00260
       AXC     JBDEL-4,4     PUT MONITOR RETURN FOR JOB DELETE          CEP00270
       SXD     GEN03,4        INTO COMMON FOR RESTART PROGRAM.          CEP00280
       CALL    RESTAR        ENTER RESTART PROGRAM.                     CEP00290
*                                                                       CEP00300
*IBSYS RETURN TO SORT MONITOR                                           CEP00310
*                                                                       CEP00320
 EP004 TSX     MSGSUP,4,2    PRINT $IBSYS CARD.                         CEP00330
       PZE     1                                                        CEP00340
       PZE     TEMP,,12                                                 CEP00350
       XEC     EP002          RESTORE RETURN POINTER.                   CEP00360
       TRA     4,4                                                      CEP00370
*                                                                       CEP00380
*  MERGE ONLY RETURN TO SORT MONITOR                                    CEP00390
*                                                                       CEP00400
 EP006 XEC     EP002          RESTORE RETURN REGISTER                   CEP00410
       AXT     1,1                                                      CEP00420
       ZET     OSMAP                                                    CEP00430
       AXT     0,1                                                      CEP00440
       TRA     6,4            FOR A MERGE ONLY                          CEP00450
*                                                                       CEP00460
*  DELETE JOB RETURN TO SORT MONITOR                                    CEP00470
*                                                                       CEP00480
EP007  BSS     0                                                        CEP00490
       CAL     =O1000000                                                CEP00500
       ORS     SYSJOB                                                   CEP00510
       TSX     MSGSUP,4,MUST PRINT SORT DELETED.                        CEP00520
       PZE     1                                                        CEP00530
       PZE     AM173,,2+2048                                            CEP00540
       XEC     EP002         RESTORE RETURN POINTER                     CEP00550
       XEC     EP002                                                    CEP00560
       LDI     ENDACT         WAS READ-AHEAD CARD $JOB, $IBSYS,      (6)CEP00562
       LFT     040000         $STOP, OR $EXECUTE NOTSORT.            (6)CEP00564
       TRA     4,4            YES, SYSGET IS SET.                    (6)CEP00568
       TRA     10,4           RETURN WHEN JOB IS DELETED                CEP00570
       EJECT                                                            CEP00580
*                                                                       CEP00590
*  READING OF SORT CONTROL CARDS                                        CEP00600
*                                                                       CEP00610
 START AXT     RA100-STACT,1 INITIALIZE TABLE AREAS                     CEP00620
       STZ     RA100,1                                                  CEP00630
       TIX     *-1,1,1                                                  CEP00640
       STZ     REMIN                                                    CEP00650
       STZ     CRDCT          RESET CARD COUNT SWITCH                   CEP00660
       LAC     SYSIN1,4                                                 CEP00670
       LDI     0,4                                                      CEP00680
       LFT     020000        HYPERTAPE +                                CEP00690
       TSX     HYPRT,2       YES-BUILD ROUTINE                          CEP00700
       STZ     HYPSWS                                                   CEP00710
RB1    TRA     *+1           ONE-TIME.  GET FIRST CARD FROM READ-AHEA(2)CEP00720
       AXT     12,4           BUFFER.                                (2)CEP00721
BUFBAS CAL     **,4          MOVE READ-AHEAD CARD.  IF THIS IS FIRST (2)CEP00722
       SLW     TEMP+12,4     TIME SORT IS EXECUTED, BUFFER HAS       (2)CEP00723
       TIX     BUFBAS,4,1     ALL BLANKS.                            (2)CEP00724
       STL     RCORT         SET FOR TAPE INITIALLY.                 (2)CEP00725
       AXT     BYPASS,4      SET TO BYPASS AFTER FIRST TIME.         (2)CEP00726
       SXA     RB1,4                                                 (2)CEP00727
       TRA     CTUDT         SKIP ACTUAL READ THIS TIME.             (2)CEP00728
BYPASS BSS     0                                                     (2)CEP00729
       TSX     READ,4                                                (2)CEP0072A
       ZET     DELAY          DELAY WHILE CARD IS READ                  CEP00730
       TRA     *-1                                                      CEP00740
       NZT     EOFSW          TEST FOR END OF FILE                      CEP00750
       TRA     CTUDT                                                    CEP00760
       ZET     RCORT                                                    CEP00770
       TRA     RB1           TRANSFER IF TAPE.                          CEP00780
       ZET     RDAHED CARD READER EOF.  IS THIS READ-AHEAD AFTER END.(2)CEP00781
       TRA     SETEOF        YES.  SET INDICATOR.                    (2)CEP00782
       TSX     MSGSUP,4,2                                               CEP00790
               4                                                        CEP00800
               AMS89,,6+512*4 MESSAGE-NO END CARD FOUND BEFORE EOF.     CEP00810
               AM114,,6        DELETE                                   CEP00820
               AM117,,9        CONTINUE.                                CEP00830
               AM121,,7+512*4  END CARD ASSUMED.                        CEP00840
       TSX     (PAUSE,4       WAIT                                      CEP00850
       SWT     3             TEST FOR CONTINUE OR DELETE.               CEP00860
       TRA     EP007          DELETE THIS JOB                           CEP00870
       STL     NOEND         SET NO END CARD SWITCH.                    CEP00880
       TSX     CNTNUE,2                                                 CEP00890
       TRA     SETEOF        SET EOF ON READ-AHEAD ALSO.             (2)CEP00891
       TRA     CEDIT          IGNORE CONDITION. ASSUME END CARD.        CEP00900
RDAHED PZE      NONZERO AFTER END CARD FOUND.  SIGNALS READ-AHEAD.   (2)CEP00901
LASTDL PZE                   MINUS IF PREVIOUS SORT DELETED.         (2)CEP00902
ENDACT PZE      CONTENTS RESULT FROM READ-AHEAD.  LATER PUT INTO GEN0(2)CEP00903
SETEOF CAL     =O220000000000 SET INDICATOR THAT READ-AHEAD HIT      (2)CEP00904
       ORS     ENDACT         EOF ON CARD READER.                    (2)CEP00905
       TRA     CEDIT         GO TO EDIT CARDS.                       (2)CEP00906
 CTUDT CLA     CRDCT          UPDATE NUMBER OF CARDS READ               CEP00910
       ADD     =1                                                       CEP00920
       STO     CRDCT          SAVE NUMBER OF CARDS READ                 CEP00930
       ZET     RCORT         CARD/TAPE                                  CEP00940
       TRA     RB20                                                     CEP00950
       CALL    RB01           CARD IMAGE TO BCD                         CEP00960
       PZE     INPUT,,TEMP                                              CEP00970
       TRA     *+2                                                      CEP00980
       TRA     RB20                                                     CEP00990
       STL     BUF01                                                    CEP01000
*                                                                       CEP01010
* MOVE CARD TO BUFFER IN MONITOR, THEN                               (2)CEP01019
*  TEST FOR RECOGNIZED BASIC MONITOR CONTROL CARDS                      CEP01020
*                                                                       CEP01030
RB20   AXT     12,4                                                  (2)CEP01040
       CAL     TEMP+12,4     MOVE CARD TO BUFFER IN SORT MONITOR.    (2)CEP01041
       SLW*    BUFBAS                                                (2)CEP01042
       TIX     *-2,4,1                                               (2)CEP01043
       CAL     TEMP          1ST WORD OF CARD.                       (2)CEP01044
       ERA     =H$IBSYS       TEST FOR SYSTEM RETURN CARD               CEP01050
       TNZ     TESTID        NOT $IBSYS.  TEST FOR $ID CARD.         (2)CEP01060
       NZT     RDAHED        IF NOT READ-AHEAD, GO BACK TO           (2)CEP01061
       TRA     EP004          BASIC MONITOR IMMEDIATELY,             (2)CEP01062
       CAL     =O340000000000 ELSE SET FLAGS FOR POST PROCESSOR      (2)CEP01063
       ORS     ENDACT         TO PRINT '$IBSYS' AND GO TO SYSRET AT E(2)CEP01064
       TRA     CEDIT         GO TO EDIT CARDS.                       (2)CEP01065
TESTID BSS     0                                                     (2)CEP01069
       CAL     TEMP                                                     CEP01070
       ERA     =H$ID          TEST FOR $ID CARD                         CEP01080
       TNZ     RC30                                                     CEP01090
       ZET     RDAHED        HAS $ID CARD BEEN HIT ON READ-AHEAD.    (2)CEP01091
       TRA     SETRLD        YES.  SET FLAG TO RELOAD SORT.          (2)CEP01092
       LDQ     LASTDL        WAS A PREVIOUS SORT DELETED.            (2)CEP01093
       TQP     PRINID        TRANSFER IF NO.                         (2)CEP01094
       ZET     SYSACC        PREVIOUS RUN WAS DELETED.  TAKE ACCOUNTI(2)CEP01095
       TRA     NOPRNT         ROUTINE ACTION AND GET OUT.            (2)CEP01096
       TSX     MSGSUP,4,2    PRINT $ID CARD.                         (2)CEP01097
       PZE     2                                                     (2)CEP01098
       PZE                                                           (2)CEP01099
       PZE     TEMP,,12                                              (2)CEP0109A
NOPRNT TSX     SYSIDR,4      TO TO ACCOUNTING ROUTINE.               (2)CEP0109B
       PZE     TEMP,,12                                              (2)CEP0109C
       TRA     EP007         DELETE SORT NOW.                        (2)CEP0109D
SETRLD CAL     =O400000000000 SET TO RELOAD SORT AT END              (2)CEP0109E
       ORS     ENDACT          OF RUN.                               (2)CEP0109F
       TRA     CEDIT         GO TO EDIT CARDS.                       (2)CEP0109G
PRINID BSS     0                                                     (2)CEP0109H
       CAL     SYSACC                                                   CEP01100
       TNZ     SYSID                                                    CEP01110
       TSX     MSGSUP,4,2    PRINT THE $ID CARD.                        CEP01120
       PZE     2                                                        CEP01130
       PZE     0,,0                                                     CEP01140
       PZE     TEMP,,12                                                 CEP01150
SYSID  TSX     SYSIDR,4      GO TO ACCOUNTING ROUTINE                   CEP01160
       PZE     TEMP,,12                                                 CEP01170
       TRA     RB1            GO READ ANOTHER CARD                      CEP01180
 RC30  CAL     TEMP                                                     CEP01190
       ERA     =H$JOB        TEST FOR END OF JOB CARD.                  CEP01200
       TNZ     RC40                                                     CEP01210
       CAL     =HIBSBSR                                                 CEP01220
       SLW     SYSGET                                                   CEP01230
       ZET     RDAHED HAS THIS $JOB CARD BEEN HIT DURING READ-AHEAD. (2)CEP01231
       TRA     SETRPT     YES.  SET INDICATORS FOR END-OF-RUN ACTION.(2)CEP01232
       TSX     SYSRPT,4      STANDARD ACTION WHEN $JOB CARD          (2)CEP01233
       CAL     =HIBSYST       ENCOUNTERED - DICTATED BY IBSYS.       (2)CEP01234
       SLW     SYSGET        .                                       (2)CEP01235
       TSX     SYSIDR,4      .                                       (2)CEP01236
       PZE     TEMP,,12      .                                       (2)CEP01240
 RC40  CAL     TEMP                                                     CEP01250
       ERA     =H$STOP       TEST FOR STOP CARD.                        CEP01260
       TNZ     RC50                                                     CEP01270
       CAL     =H$STOP                                                  CEP01280
       SLW     SYSGET                                                   CEP01290
       NZT     RDAHED        IS THIS $STOP CARD A READ-AHEAD CARD.   (2)CEP01291
       TRA     EP004         NO.  PRINT THE CARD AND GET OUT.        (2)CEP01300
       CAL     =O240000000000 SET FLAG FOR TRA SYSRET AT END.        (2)CEP01301
       ORS     ENDACT                                                (2)CEP01302
       TRA     CEDIT         GO EDIT THE CARDS.                      (2)CEP01303
 RC50  CAL     TEMP                                                     CEP01310
       ERA     =H$EXECU                                                 CEP01320
       TNZ     TESTDL                                                (2)CEP01330
       CAL     TEMP+2                                                   CEP01340
       LDQ     TEMP+3                                                   CEP01350
       LGL     18                                                       CEP01360
       LAS     =HSORT                                                   CEP01370
       TRA     *+2                                                      CEP01380
       TRA     SORTCD        THIS IS $EXECUTE SORT.                  (2)CEP01390
       SLW     SYSGET                                                   CEP01400
       NZT     RDAHED                                                (4)CEP01401
       TRA     EP004         NO.  PRINT THIS CARD AND GET OUT.       (2)CEP01402
       CAL     =O240000000000                                        (2)CEP01403
       ORS     ENDACT        SET FLAG TO TRA  SYSRET AT              (2)CEP01404
       TRA     CEDIT          END.  GO EDIT CARDS.                   (2)CEP01410
SETRPT CAL     =O40000000000 SET FLAG THAT $JOB CARD ACTION          (2)CEP01411
       ORS     ENDACT        IS REQUIRED AT COMPLETION OF SORT.      (2)CEP01412
       TRA     CEDIT         GO EDIT THE CARDS.                      (2)CEP01413
TESTDL CLA     LASTDL        WAS A PREVIOUS SORT DELETED.            (2)CEP01414
       TMI     EP007         TRANSFER IF YES.                        (2)CEP01415
       NZT     RDAHED        IS THIS CARD READ-AHEAD.                (2)CEP01416
       TRA     PAUSEQ        NO.  TEST FOR $PAUSE CARD.              (2)CEP01417
RLDSRT CAL     =O400000000000 ASSUME SORT CONTROL CARD AND SET       (2)CEP01418
       ORS     ENDACT        FLAG FOR RELOADING SORT AT END OF RUN.  (2)CEP01419
       TRA     CEDIT         GO EDIT CARDS.                          (2)CEP0141A
PAUSEQ CAL     TEMP                                                  (2)CEP0141B
       ERA     =H$PAUSE                                              (2)CEP0141C
       TNZ     IDEND         TRANSFER IF NO $PAUSE CARD.             (2)CEP0141D
       TSX     MSGSUP,4,2    PAUSE CARD.  PRINT IT OUT AND PAUSE.    (2)CEP0141E
       PZE     1                                                     (2)CEP0141F
       PZE     TEMP,,12      .                                       (2)CEP0141G
       TSX     (PAUSE,4      .                                       (2)CEP0141H
       TRA     RB1           READ ANOTHER CARD.                      (2)CEP0141I
SORTCD ZET     RDAHED        IS THIS READ-AHEAD.                     (2)CEP0141J
       TRA     RLDSRT        YES.  SET FLAG FOR RELOAD AT END.       (2)CEP0141K
       TSX     MSGSUP,4,2    PRINT                                   (2)CEP0141L
       PZE     1              '$EXECUTE   SORT'.                     (2)CEP0141M
       PZE     TEMP,,12+512*4                                        (6)CEP0141N
       CLA     LASTDL        WAS PREVIOUS SORT DELETED.              (2)CEP0141O
       TMI     EP007         TRANSFER IF YES, I.E., DELETE THIS SORT.(2)CEP0141P
       TRA     RB1           IGNORE AND GET NEXT CARD.               (2)CEP0141Q
       SPACE                                                            CEP01420
*                                                                       CEP01430
*  HANDLING OF CONTINUATION CONTROL CARDS                               CEP01440
*                                                                       CEP01450
 IDEND BSS     0                                                        CEP01460
       CAL     TEMP                                                     CEP01470
       ANA     =O77                                                     CEP01480
       ERA     =O67          LOOK FOR X                                 CEP01490
       STL     RCONT                                                    CEP01500
       TNZ     RB2            NEW STATEMENT                             CEP01510
       STZ     RCONT         CONTINUATION                               CEP01520
 REMVX LDI     TEMP           REMOVE X                                  CEP01530
       RIR     77                                                       CEP01540
       SIR     60                                                       CEP01550
       STI     TEMP                                                     CEP01560
       ZET     RCONT                                                    CEP01570
       TRA     RB2                                                      CEP01580
       NZT     REMIN          TEST FOR REMARK CONTINUATION              CEP01590
       TRA     RMCON                                                    CEP01600
       TSX     MSGSUP,4,2    PRINT REMARK CONTINUATION.                 CEP01610
       PZE     1                                                        CEP01620
       PZE     TEMP,,12                                                 CEP01630
       TRA     RB1                                                      CEP01640
       SPACE                                                            CEP01650
*                                                                       CEP01660
*  UPDATE CARD COUNTS AND DETERMINE CARD TYPE                           CEP01670
*                                                                       CEP01680
 RMCON BSS     0                                                        CEP01690
       LXA     CARCT,1       COUNT CARD                                 CEP01700
       TXI     *+1,1,1                                                  CEP01710
       SXA     CARCT,1                                                  CEP01720
       LAC     STIND,1       STATEMENT NO                               CEP01730
       CLA     STADD-1,1     COUNTER ADDRESS                            CEP01740
       STA     *+1                                                      CEP01750
       ADD     **            ADD COUNT                                  CEP01760
       STA     *+2                                                      CEP01770
       STA     *+3                                                      CEP01780
       CLA     **            COUNTER                                    CEP01790
       ADD     =O1000000     ADD ONE                                    CEP01800
       STO     **                                                       CEP01810
       TRA     MOVE          GO TO STORE CARD                           CEP01820
 RB2   STZ     WORD          GET 3 NONBLANKS                            CEP01830
       AXT     11,1                                                     CEP01840
       AXT     0,2                                                      CEP01850
 RA1   LDQ     TEMP+12,1                                                CEP01860
       AXT     6,4                                                      CEP01870
 RA3   ZAC                                                              CEP01880
       LGL     6                                                        CEP01890
       ERA     =O60          LOOK FOR BLANK                             CEP01900
       TNZ     RA2                                                      CEP01910
 RA30  TIX     RA3,4,1                                                  CEP01920
       TIX     RA1,1,1                                                  CEP01930
       TRA     RA6                                                      CEP01940
 RA2   ERA     =O60          RESTORE CHARACTER                          CEP01950
       ALS     12,2                                                     CEP01960
       ORS     WORD                                                     CEP01970
       TXI     *+1,2,6                                                  CEP01980
       TXH     RA6,2,12                                                 CEP01990
       TRA     RA30                                                     CEP02000
 RA6   CAL     WORD                                                     CEP02010
       TZE     RB1           IF BLANK, READ A NEW CARD                  CEP02020
       ERA     =H000REM      CHECK FOR REMARK                           CEP02030
       TNZ     RMEND          TEST FOR A REMARK CARD GIVEN              CEP02040
       TSX     MSGSUP,4,2    PRINT REMARK CARD.                         CEP02050
       PZE     1                                                        CEP02060
       PZE     TEMP,,12                                                 CEP02070
       STL     REMIN         SET REMARKS INDICATOR                      CEP02080
       TRA     RB1                                                      CEP02090
 RMEND BSS     0                                                        CEP02100
       CAL     WORD                                                     CEP02110
       ERA     =H000END      CHECK FOR END CARD                         CEP02120
       TNZ     NOTEND        TRANSFER IF NOT END CARD.               (2)CEP02130
       STL     RDAHED        SET SWITCH TO READ ONE CARD AHEAD.      (2)CEP02131
       TRA     RB1           GO READ 1 MORE CARD (READ-AHEAD).       (2)CEP02132
NOTEND BSS     0                                                     (2)CEP02133
       AXT     RA101-LIST,1  CHECK LIST OF CARD TYPES                   CEP02140
       AXT     1,2                                                      CEP02150
       CAL     WORD                                                     CEP02160
       LAS     RA101,1                                                  CEP02170
       TRA     *+2                                                      CEP02180
       TRA     RB10                                                     CEP02190
       TXI     *+1,2,1                                                  CEP02200
       TIX     *-4,1,1                                                  CEP02210
       TSX     MSGSUP,4,2                                               CEP02220
               5                                                        CEP02230
               TEMP,,12      PRINT   CARD.                              CEP02240
               AMS95,,5+512*4  NOT A SORT CONTROL CARD.                 CEP02250
               AM114,,6         DELETE.                                 CEP02260
               AM117,,9        CONTINUE.                                CEP02270
               AM122,,5         CARD WILL BE IGNORED.                   CEP02280
       TSX     (PAUSE,4       WAIT                                      CEP02290
       SWT     3             TEST FOR CONTINUE OR DELETE.               CEP02300
       TRA     EP007         DELETE SORT.                               CEP02310
       TSX     CNTNUE,2                                                 CEP02320
       TRA     RB1            TO READ NEXT CARD                         CEP02330
 RB10  SXA     STIND,2       STATEMENT NO                               CEP02340
       LAC     STIND,2                                                  CEP02350
       CLA*    STADD-1,2                                                CEP02360
       SUB     MXTAB-1,2     SUBTRACT MAXIMUM COUNT FROM COUNT       (7)CEP02370
       TMI     *+2            BEFORE CURRENT CONTROL CARD            (7)CEP02380
       TRA     ERRMX         ERROR, ALREADY HAVE MAX NO THIS CTL CD  (7)CEP02390
       CLA*    STADD-1,2                                             (7)CEP02400
       ADD     =O1                                                   (7)CEP02410
       STO*    STADD-1,2                                             (7)CEP02420
       CLA     STADD-1,2                                                CEP02430
       STA     *+1                                                      CEP02440
       ADD     **                                                       CEP02450
       STA     RC1                                                      CEP02460
       STA     RC2                                                      CEP02470
       STA     RC3                                                      CEP02480
 RC1   CLA     **                                                       CEP02490
       ADD     =O1000000     ADD TO STATEMENT COUNT                     CEP02500
 RC2   STO     **                                                       CEP02510
       LAC     WDCT,2                                                   CEP02520
       PXA     ,2                                                       CEP02530
       ADM     CARDS                                                    CEP02540
 RC3   STA     **                                                       CEP02550
       STZ     REMIN         RESET REMARKS INDICATOR                    CEP02560
       LXA     CARCT,1       ADD TO CARD COUNT                          CEP02570
       TXI     *+1,1,1                                                  CEP02580
       SXA     CARCT,1                                                  CEP02590
       LXA     STACT,1       ADD TO STATEMENT COUNT                     CEP02600
       TXI     *+1,1,1                                                  CEP02610
       SXA     STACT,1                                                  CEP02620
 MOVE  AXT     11,1          MOVE WORDS TO CARD STORAGE                 CEP02630
       LXA     WDCT,2                                                   CEP02640
       CAL     TEMP+12,1                                                CEP02650
CARDS  SLW     **,2                                                     CEP02660
       TXI     *+1,2,-1                                                 CEP02670
       TIX     *-3,1,1                                                  CEP02680
       SXA     WDCT,2                                                   CEP02690
       TRA     RB1                                                      CEP02700
       SPACE   2                                                        CEP02710
 REMIN PZE                   REMARKS INDICATOR                          CEP02720
 RCORT                                                                  CEP02730
 STIND PZE                   STATEMENT NO                               CEP02740
 WDCT  PZE                   2-S COMP OF WORD COUNT                     CEP02750
 WORD  BSS     1                                                        CEP02760
 RCONT PZE                    CONTINUATION SWITCH                       CEP02770
 CRDCT PZE                    COUNT OF CONTROL CARDS READ               CEP02780
NOEND  PZE                   NONZERO IF NO END CARD FOUND.              CEP02790
       SPACE   2                                                        CEP02800
 LIST  BCI     1,000RES       LIST OF CARD NAMES                        CEP02810
       BCI     1,000OPT                                                 CEP02820
       BCI     1,000OVE                                                 CEP02830
       BCI     1,000LAB                                                 CEP02840
       BCI     1,000CHA                                                 CEP02850
       BCI     1,000FIL                                                 CEP02860
       BCI     1,000MOD                                                 CEP02870
       BCI     1,000REC                                                 CEP02880
       BCI     1,000DEL                                                 CEP02890
       BCI     1,000SOR                                                 CEP02900
       BCI     1,000MER                                                 CEP02910
 RA101 BSS     0                                                        CEP02920
       SPACE   2                                                        CEP02930
 STADD PZE     RESCT                                                    CEP02940
       PZE     OPTCT                                                    CEP02950
       PZE     OVECT                                                    CEP02960
       PZE     LABCT                                                    CEP02970
       PZE     CHACT                                                    CEP02980
       PZE     FILCT                                                    CEP02990
       PZE     MODCT                                                    CEP03000
       PZE     RECCT                                                    CEP03010
       PZE     DELCT                                                    CEP03020
       PZE     SORCT                                                    CEP03030
       PZE     MERCT                                                    CEP03040
       PZE     PBAAA                                                    CEP03050
       SPACE   2                                                        CEP03060
MXTAB  BSS     0                                                        CEP03070
 RESMX PZE     OPTCT-RESTB    MAXIMUM NO. OF RESTART STATEMENTS         CEP03080
 OPTMX PZE     OVECT-OPTTB    MAXIMUM NO OF OPTION STATEMENTS           CEP03090
 OVEMX PZE     LABCT-OVETB    OVERFLOW                                  CEP03100
 LABMX PZE     CHACT-LABTB    LABEL                                     CEP03110
 CHAMX PZE     FILCT-CHATB    CHANNEL                                   CEP03120
 FILMX PZE     MODCT-FILTB    FILE                                      CEP03130
 MODMX PZE     RECCT-MODTB    MODIFICATION                              CEP03140
 RECMX PZE     DELCT-RECTB    RECORD                                    CEP03150
 DELMX PZE     SORCT-DELTB    DELETE                                    CEP03160
 SORMX PZE     MERCT-SORTB    SORT                                      CEP03170
 MERMX PZE     RA100-MERTB    MERGE                                     CEP03180
       SPACE   2                                                        CEP03190
 READ  SXA     RDAX1,1        SAVE INDEX REGISTERS                      CEP03200
       SXA     RDAX2,2                                                  CEP03210
       SXA     RDAX4,4                                                  CEP03220
       STZ     EOFSW         INITIALIZE END OF FILE SWITCH           (3)CEP03225
       ZET     FTTRU          TEST FOR FIRST CONTROL CARD READ          CEP03230
       TRA     PRSEL          TO PRE SELECT                             CEP03240
       CLA*    SYSIN1         FIRST UNIT CONTROL WORD                   CEP03250
       ANA     =O777000000    MASK OUT CONTROL CARD UNIT                CEP03260
       ERA     =O321000000                                              CEP03270
       LDQ     COM2          INPUT COMMAND FOR CARD READER              CEP03280
       STZ     RCORT                                                 (2)CEP03285
       TZE     *+3                                                      CEP03290
       STL     RCORT          SET INPUT FROM TAPE                       CEP03300
       LDQ     COM1           INPUT COMMAND FOR TAPE UNIT               CEP03310
       STQ     COMM           SAVE IN COMMAND TO BE EXECUTED            CEP03320
       STL     FTTRU          SET FIRST CARD READ SWITCH                CEP03330
PRSEL  LAC     SYSIN1,4      ADDRESS OF UCB                             CEP03340
       CAL     CLSEL          LOCATION OF SELECT ROUTINE                CEP03350
       SLW     1,4                                                      CEP03360
       TSX     (ACTVX,4       TO ACTIVATE ROUTINE                       CEP03370
       MZE     SYSIN1                                                   CEP03380
 RDAX1 AXT     **,1           RESTORE REGISTERS                         CEP03390
 RDAX2 AXT     **,2                                                     CEP03400
 RDAX4 AXT     **,4                                                     CEP03410
       TRA     1,4                                                      CEP03420
 FTTRU PZE                    FIRST TIME THROUGH SWITCH                 CEP03430
 COMM  PZE                    ACTUAL READING COMMAND                    CEP03440
 COM1  IORT    TEMP,,14       COMMAND FOR TAPE                          CEP03450
 COM2  IOCT    INPUT,,24      COMMAND FOR CARD READER                   CEP03460
 INPUT BSS     24                                                       CEP03470
 CLSEL PZE     ,,CRSEL                                                  CEP03480
*   BUILD HYPERTAPE SELECT ROUTINES                                     CEP03490
HYPRT  SXA     HYPSAV,2                                                 CEP03500
       STL     HYPSWS                                                   CEP03510
       AXT     23,2                                                     CEP03520
       LNT     000040                                                   CEP03530
       AXT     22,2          BUILD                                      CEP03540
       SXA     HYPSMS,2      SMS                                        CEP03550
       PIA                                                              CEP03560
       ANA     17MSK         BUILD                                      CEP03570
       PDX     ,2                                                       CEP03580
       TXI     *+1,2,8576    HYPERTAPE ORDER                            CEP03590
       SXD     HYORD,2                                                  CEP03600
HYPSAV AXT     **,2                                                     CEP03610
       TRA     2,2                                                      CEP03620
*                                                                       CEP03630
HYPSMS SMS     **                                                       CEP03640
       LIPT    *+1                                                      CEP03650
       CTLR    HYORD                                                    CEP03660
       CPYD    TEMP,,14                                                 CEP03670
       TCH     SYSTWT                                                   CEP03680
HYORD  OCT     120600120100                                             CEP03690
HYPSWS                                                                  CEP03700
 17MSK PZE     ,,15                                                     CEP03710
       SPACE                                                            CEP03720
*                                                                       CEP03730
* SELECT (+) AND SELECT (-) ROUTINES                                    CEP03740
*                                                                       CEP03750
 CRSEL SXA     CRAX4,4        SAVE INDEX REGISTER                       CEP03760
       PAC     ,4             -(ADDRESS OF UCW)                         CEP03770
       TMI     MISEL          TEST FOR (-) SELECT                       CEP03780
       CAL     0,4            FIRST WORD OF UCB                         CEP03790
       PDX     ,4             UNIT TO BE SELECTED                       CEP03800
       SXA     RDS,4          SAVE IN RDS INSTRUCTION                   CEP03810
       AXT     COMM,4        COMMAND LOCATION                           CEP03820
       ZET     HYPSWS                                                   CEP03830
       AXT     HYPSMS,4                                                 CEP03840
       PXA     ,4                                                       CEP03850
       STA*    (RCHXI         SAVE IN RCHX COMMAND TO BE EXECUTED       CEP03860
       NZT     HYPSWS                                                   CEP03870
 RDS   RDS     **                                                       CEP03880
       XEC*    (RCHXI         RESET AND LOAD CHANNEL                    CEP03890
       STL     DELAY                                                    CEP03900
 CRAX4 AXT     **,4           RESTORE REGISTER                          CEP03910
       TRA     1,4                                                      CEP03920
MISEL  ZET     HYPSWS        HYPERTAPE +                                CEP03930
       TRA     HMISEL        YES-GO TO HYPER MINUS SELECT               CEP03940
       LNT     400000        NO-TEST FOR NOISE RECORD                   CEP03950
       TRA     CRNOS          APPARENT NOISE RECORD                     CEP03960
       LFT     200000         TEST FOR END OF FILE                      CEP03970
       TRA     CREOF          EOF                                       CEP03980
       LFT     100000          TEST FOR REDUNDANCY                      CEP03990
       TRA     CRRED          REDUNCANCY                                CEP04000
HNORM  STZ     1,4           FREE UCB                                   CEP04010
       STZ     DELAY          RESET PSUEDO TCOX SWITCH                  CEP04020
       TRA     CRAX4                                                    CEP04030
 CRNOS XEC     CRAX4          RESTORE XR4                               CEP04040
       TRA     2,4            TO NOISE RECORD RETURN                    CEP04050
HMISEL LNT     001000        UNUSUAL END +                              CEP04060
       TRA     HNORM         NO-RETURN                                  CEP04070
       RFT     777767        YES-ANY ERROR +                            CEP04080
       TRA     *+4           YES                                        CEP04090
       RFT     000010        NO-EOF +                                   CEP04100
CREOF  STL     EOFSW         SET EOF SWITCH                             CEP04110
       TRA     HNORM         NO-RETURN                                  CEP04120
CRRED  STL     BUF02         SET READ ERROR SWITCH                   (3)CEP04125
       XEC     CRAX4                                                    CEP04130
       TRA     3,4           ERROR RETURN                               CEP04140
 DELAY PZE                                                              CEP04170
 EOFSW PZE                    END OF FILE SWITCH                        CEP04180
       SPACE   5                                                        CEP04190
ERRMX  STL     BUF03                                                    CEP04200
       TRA     RB1            IGNORE THIS CONDITION                     CEP04210
       SPACE   2                                                        CEP04220
 STACT BSS     1             NO OF STATEMENTS                           CEP04230
 CARCT BSS     1             NO OF CARDS                                CEP04240
 RESCT BSS     1              RESTART                                   CEP04250
 RESTB BSS     1                                                        CEP04260
 OPTCT BSS     1             OPTION                                     CEP04270
 OPTTB BSS     1                                                        CEP04280
 OVECT BSS     1             OVERFLOW                                   CEP04290
 OVETB BSS     1                                                        CEP04300
 LABCT BSS     1             LABEL                                      CEP04310
 LABTB BSS     1                                                        CEP04320
 CHACT BSS     1             CHANNEL                                    CEP04330
 CHATB BSS     1                                                        CEP04340
 FILCT BSS     1             FILE                                       CEP04350
 FILTB BSS     9                                                        CEP04360
 MODCT BSS     1             MODIFICATION                               CEP04370
 MODTB BSS     60                                                       CEP04380
 RECCT BSS     1             RECORD                                     CEP04390
 RECTB BSS     1                                                        CEP04400
 DELCT BSS     1             DELETE                                     CEP04410
 DELTB BSS     100                                                      CEP04420
 SORCT BSS     1             NO OF SORT STATEMENTS                      CEP04430
 SORTB BSS     1             TABLE OF SORT CARD LOCS                    CEP04440
 MERCT BSS     1             MERGE                                      CEP04450
 MERTB BSS     1                                                        CEP04460
 RA100 BSS     0                                                        CEP04470
 TEMP  BSS     14                                                       CEP04480
       EJECT                                                            CEP04490
*                                                                       CEP04500
* CARD EDITING OF RESTART CARD                                          CEP04510
*                                                                       CEP04520
 CEDIT NZT     RESCT          TEST FOR A RESTART CARD                   CEP04530
       TRA     OPEDT          TO EDITING OF OPTION CARD                 CEP04540
       TRA     EP003                                                    CEP04550
       SPACE                                                            CEP04560
*                                                                       CEP04570
* CARD EDITING OF OPTION CARD                                           CEP04580
*                                                                       CEP04590
 OPEDT NZT     OPTCT          TEST FOR AN OPTION CARD                   CEP04600
       TRA     OPWRP          TO WRAP UP OF OPTION STATEMENT            CEP04610
       CLA     OPTTB          ADDRESS OF OPTION STATEMENT               CEP04620
       STA     *+7            SAVE IN SCAN CALLING SEQUENCE             CEP04630
       AXT     0,4                                                      CEP04640
       PDX     ,2             NUMBER OF CARDS                           CEP04650
       TXI     *+1,4,11       CHANGE TO NUMBER OF WORDS                 CEP04660
       TIX     *-1,2,1                                                  CEP04670
       SXD     *+2,4          SAVE IN SCAN CALLING SEQUENCE             CEP04680
       CALL    SK001          SCAN OPTION STATEMENT                     CEP04690
       PZE     **,,**                                                   CEP04700
       AXT     10,1           OPTION CARD INDICATOR                     CEP04710
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP04720
       SPACE                                                            CEP04730
*                                                                       CEP04740
* WRAP UP OF OPTION CARD                                                CEP04750
*                                                                       CEP04760
OPWRP  LAC     OSREL,1       ZERO OUT 5000 CELLS UP THRU LOCATION       CEP04770
       TXI     *+1,1,OPTPR+1  WHICH WILL CONTAIN UPPERMOST COMMON       CEP04780
       SXA     *+2,1          PARAMETER (OPTPR).                        CEP04790
       AXT     5000,1                                                   CEP04800
       STZ     **,1                                                     CEP04810
       TIX     *-1,1,1                                                  CEP04820
       LXA     OSREL,1                                                  CEP04830
       PXA     ,1                                                       CEP04840
       STA     OPT00,1       INCLUDES SYSEND AND RELCOM.                CEP04850
       CLA     OSCKS          PLACE IN COMMON CKSMS OPTION              CEP04860
       STO     OPT01,1                                                  CEP04870
       CLA     OSNOC          PLACE IN COMMON NOCKPT OPTION             CEP04880
       STO     OPT02,1                                                  CEP04890
       CLA     OSEQU          PLACE IN COMMON EQUALS OPTION             CEP04900
       STO     OPT03,1                                                  CEP04910
       CLA     OSBUF          PLACE IN COMMON BUFFER OPTION             CEP04920
       STO     OPT04,1                                                  CEP04930
       CLA     OSVAR          PLACE IN COMMON VARIABLE OPTION           CEP04940
       STO     OPT05,1                                                  CEP04950
       CLA     OSMAP          PLACE IN COMMON MAP SWITCH                CEP04960
       STA     OPT06,1                                                  CEP04970
       CLA     OSNOF          NO OFF LINE MESSAGE SWITCH                CEP04980
       TNZ     OPWRP1                                                   CEP04990
       LXA     SYSOU1,4                                                 CEP05000
       TXH     *+2,4,0                                                  CEP05010
       CLA     =1                                                       CEP05020
OPWRP1 STO     OPT07,1                                                  CEP05030
       STO     OSNOF                                                    CEP05040
       CLA     OSHIS          HISTORY SWITCH                            CEP05050
       STO     OPT08,1                                                  CEP05060
       CLA     OSTAP          TAPE SWITCH                               CEP05070
       STO     OPT09,1                                                  CEP05080
       CLA     OSCAR          CARDS SWITCH                              CEP05090
       STO     OPT10,1                                                  CEP05100
       CLA     OSUNR                                                 (2)CEP05102
       STO     OPT11,1       UNREADABLE BLOCK-PAUSE OPTION.          (2)CEP05103
       AXT     REF00,4        LAST FIXED COMMON LOCATION                CEP05110
       SXD     *+1,1                                                    CEP05120
       TIX     *+1,4,**       DECREASE BY AMOUNT COMMON IS RELOCATED    CEP05130
       TXI     *+1,4,-1                                                 CEP05140
       PXA     ,4             SAVE FOR BUILDING OF VARIABLE LENGTH      CEP05150
       STA     REF00,1        PORTION OF COMMON                         CEP05160
       LXA     EP002,4                                                  CEP05170
       CLA     7,4                                                      CEP05180
       STA     PB007                                                    CEP05190
       ARS     18                                                       CEP05200
       STA     PB007+1                                                  CEP05210
       ADD     =4                                                       CEP05220
       STA     PB007+2                                                  CEP05230
       ZET     OSNOF                                                    CEP05240
       TRA     PB006         TRANSFER IF NO OFF LINE DESIRED.           CEP05250
       NZT     OSMAP                                                    CEP05260
       TRA     PB005         ONLY OFF LINE                              CEP05270
       CAL     *             BOTH ON AND OFF LINE.                      CEP05280
       TRA     PB007                                                    CEP05290
 PB005 CAL     COM2                                                     CEP05300
       TRA     PB007                                                    CEP05310
 PB006 CLA     *                                                        CEP05320
       NZT     OSMAP                                                    CEP05330
       TRA     PB010                                                    CEP05340
 PB007 STP     **                                                       CEP05350
       STP     **                                                       CEP05360
       STP     **                                                       CEP05370
       STL     OSMAP                                                    CEP05380
 PB009 TSX     **,4                                                     CEP05390
 PB010 TSX     PRINT,4                                                  CEP05400
       SPACE                                                            CEP05410
*                                                                       CEP05420
* CARD EDIT OF OVERFLOW CARD                                            CEP05430
*                                                                       CEP05440
       NZT     OVECT          TEST FOR OVERFLOW STATEMENT.              CEP05450
       TRA     LAEDT          TO LABEL EDITING                          CEP05460
       CLA     OVETB          ADDRESS OF OVERFLOW STATEMENT             CEP05470
       STA     *+7            SAVE IN SCAN CALLING SEQUENCE             CEP05480
       AXT     0,4                                                      CEP05490
       PDX     ,2             NUMBER OF CARDS                           CEP05500
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP05510
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP05520
       SXD     *+2,4          SAVE IN SCAN CALLING SEQUENCE             CEP05530
       CALL    SK001          SCAN OVERFLOW STATEMENT                   CEP05540
       PZE     **,,**                                                   CEP05550
       AXT     9,1            OVERFLOW CARD INDICATOR                   CEP05560
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP05570
       SPACE                                                            CEP05580
*                                                                       CEP05590
* WRAP UP OF OVERFLOW CARD                                              CEP05600
*                                                                       CEP05610
       SXA     OVWR1,1        SAVE REGISTER.                            CEP05620
       LXA     OSREL,1        AMOUNT COMMON RELOCATED                   CEP05630
       CLA     OSBLO          PLACE IN COMMON NUMBER OF                 CEP05640
       STO     OVE00,1        BLOCKS FOR OVERFLOW                       CEP05650
 OVWR1 AXT     **,1                                                     CEP05660
       SPACE                                                            CEP05670
*                                                                       CEP05680
* CARD EDIT OF LABEL CARD                                               CEP05690
*                                                                       CEP05700
 LAEDT NZT     LABCT          TEST FOR LABEL CARD                       CEP05710
       TRA     LABWR          TO LABEL WRAP-UP                          CEP05720
       CLA     LABTB          ADDRESS OF LABEL STATEMENT                CEP05730
       STA     *+7            SAVE IN SCAN CALLING SEQUENCE             CEP05740
       AXT     0,4                                                      CEP05750
       PDX     ,2             NUMBER OF CARDS                           CEP05760
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP05770
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP05780
       SXD     *+2,4          SAVE IN SCAN CALLING SEQUENCE             CEP05790
       CALL    SK001          SCAN LABEL STATEMENT                      CEP05800
       PZE     **,,**                                                   CEP05810
       AXT     8,1            LABEL CARD INDICATOR                      CEP05820
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM.                 CEP05830
       SPACE                                                            CEP05840
*                                                                       CEP05850
*  WRAP UP OF LABEL CARD                                                CEP05860
*                                                                       CEP05870
 LABWR LXA     OSREL,1        COMMON RELOCATION                         CEP05880
       CLA     REF00,1        LAST USED CELL                            CEP05890
       SUB     =20                                                      CEP05900
       STA     LAB00,1        ADDRESS OF AREA USED FOR LABEL            CEP05910
       SUB     =20             CONSTRUCTION                             CEP05920
       STA     LAB01,1        ADDRESS OF AREA FOR READING LABELS        CEP05930
       STA     LBMOV          MOVE FOUR WORD WABEL TO COMMON            CEP05940
       SUB     =4                                                       CEP05950
       STA     LAB04,1        PUT ADDRESS OF LABEL IN COMMON            CEP05960
       STA     REF00,1                                                  CEP05970
       AXT     4,2                                                      CEP05980
       CAL     AMS01+4,2      MOVE--LOGICAL FILE XXXX PASS XXXX         CEP05990
 LBMOV SLW     **,2           LABEL TO COMMON                           CEP06000
       TIX     *-2,2,1                                                  CEP06010
       SPACE                                                            CEP06020
*                                                                       CEP06030
* CARD EDIT OF CHANNEL CARD                                             CEP06040
*                                                                       CEP06050
       ZET     CHACT          TEST FOR A CHANNEL CARD.                  CEP06060
       TRA     *+4                                                      CEP06070
       STL     BUF04                                                    CEP06080
       STL     DEERR          SET ERROR SWITCH                          CEP06090
       TRA     FIEDT                                                    CEP06100
       CLA     CHATB          ADDRESS OF CHANNEL STATEMENT              CEP06110
       STA     *+7            SAVE IN SCAN CALLING SEQUENCE             CEP06120
       AXT     0,4                                                      CEP06130
       PDX     ,2             NUMBER OF CARDS                           CEP06140
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP06150
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP06160
       SXD     *+2,4          SAVE IN SCAN CALLING SEQUENCE             CEP06170
       CALL    SK001          SCAN CHANNEL STATEMENT                    CEP06180
       PZE     **,,**                                                   CEP06190
       AXT     7,1            CHANNEL CARD INDICATOR                    CEP06200
       TSX     DEFER,4                                                  CEP06210
       SPACE                                                            CEP06220
*                                                                       CEP06230
* WRAP UP OF CHANNEL CARD                                               CEP06240
*                                                                       CEP06250
       ZET     CSINP          TEST FOR INPUT GIVEN.                     CEP06260
       TRA     *+3                                                      CEP06270
       STL     BUF05                                                    CEP06280
       STL     DEERR          SET ERROR SWITCH                          CEP06290
       NZT     CSMER          TEST FOR MERGE CHANNEL GIVEN.             CEP06300
       TRA     CHOU            NO MERGE CHANNEL                         CEP06310
       LXA     OSREL,1        COMMON RELOCATION                         CEP06320
       CLA     REF00,1        LAST USED COMMON LOCATION                 CEP06330
       SUB     =1                                                       CEP06340
       ORA     =O200000       PUT 2 TAG IN LIST CONTROL                 CEP06350
       STO     CHA02,1        SAVE REFERENCE FOR MERGE ASSIGNMENT       CEP06360
       SUB     =10                                                      CEP06370
       STO     CHA03,1        SAVE REFERENCE FOR MERGE ASSIGNMENT       CEP06380
       SUB     =9                                                       CEP06390
       STA     REF00,1        LAST USED COMMON LOCATION                 CEP06400
       LXA     CHANM-1,4      CHANNEL NUMBER A-H                        CEP06410
       CAL     TAPES,4         GET THE UNIT CHANNEL FROM TABLE          CEP06420
       ORA     MARC1           EDIT RELEASE BIT IF THERE IS ANY ONE     CEP06430
       XCL                     MOVE TO MQ                               CEP06440
       CLA     CHA03,1        ADDRESS OF ASSIGNMENT BLOCK               CEP06450
       ADD     =1                                                       CEP06460
       STA     *+2                                                      CEP06470
       AXT     10,2                                                     CEP06480
       STQ     **,2           UNIT DESIGNATION FOR SECOND MERGE AREA    CEP06490
       TIX     *-1,2,1                                                  CEP06500
       LXA     CHANM-2,4      CHANNEL NUMBER A-H                        CEP06510
       CAL     TAPES,4         GET THE UNIT CHANNEL FROM THE TABLE      CEP06520
       ORA     MARC1           EDIT RELEASE BIT IF THERE IS ANY         CEP06530
       XCL                     MOVE TO MQ                               CEP06540
       CLA     CHA02,1        ADDRESS OF 2ND ASSIGNMENT BLOCK           CEP06550
       ADD     =1                                                       CEP06560
       STA     *+2                                                      CEP06570
       AXT     10,2                                                     CEP06580
       STQ     **,2           UNIT DESIGNATION FOR FIRST MERGE AREA     CEP06590
       TIX     *-1,2,1                                                  CEP06600
 CHOU  BSS     0                                                        CEP06610
       NZT     CSOUT          TEST FOR OUTPUT CHANNEL                   CEP06620
       TRA     FIEDT          TO FILE EDITING                           CEP06630
       LXA     CHANO,4        OUTPUT CHANNEL NUMBER                     CEP06640
       TXH     CHAJQ,4,8                                                CEP06650
       PXA     ,4                                                       CEP06660
       CAS     CHANM-1        TEST FOR OUTPUT EQUAL WITH MERGE          CEP06670
       TRA     *+2                                                      CEP06680
       TRA     CHAMO          EQUAL                                     CEP06690
       CAS     CHANM-2        TEST FOR OUTPUT EQUAL WITH MERGE          CEP06700
       TRA     *+2                                                      CEP06710
       TRA     CHAMT          EQUAL                                     CEP06720
       LXA     OSREL,1         COMMON RELOCATION                        CEP06730
       CLA     REF00,1        LAST USED COMMON LOCATION                 CEP06740
       STA     CHSTQ                                                    CEP06750
       SUB     =1             BEGINNING LOCATION OF OUTPUT TABLE        CEP06760
       STA     CHA01,1        SAVE ADDRESS OF OUTPUT TABLE              CEP06770
       SUB     =9                                                       CEP06780
       STA     REF00,1                                                  CEP06790
       CAL     TAPES,4         GET THE UNIT CHANNEL FROM TABLE          CEP06800
       ORA     OUTSB           EDIT RELEASE BIT IF THERE IS ANY ONE     CEP06810
       XCL                     MOVE TO MQ                               CEP06820
       AXT     10,2                                                     CEP06830
 CHSTQ STQ     **,2           BUILD OUTPUT TABLE IN VARIABLE COMMON     CEP06840
       TIX     *-1,2,1                                                  CEP06850
       TRA     FIEDT          TO FILE EDITING                           CEP06860
 CHAMO CLA     CHA03,1                                                  CEP06870
       STO     CHA01,1        OUTPUT EQUAL TO MERGE CHANNEL             CEP06880
       STL     CHAOM          SET OUTPUT EQUAL TO MERGE SWITCH          CEP06890
       TRA     CHBBB                                                    CEP06900
 CHAMT CLA     CHA02,1                                                  CEP06910
       STO     CHA01,1        OUTPUT EQUAL TO MERGE CHANNEL             CEP06920
       STL     CHAOM          SET OUTPUT EQUAL TO MERGE SWITCH          CEP06930
 CHBBB CLA     CHA01,1         IF OUTPUT CHANNEL HAS  R BIT             CEP06940
       ADD     =1                                                       CEP06950
       STA     *+3                                                      CEP06960
       AXT     4,2                                                      CEP06970
       CAL     OUTSB                                                    CEP06980
       ORS     **,2                                                     CEP06990
       TIX     *-1,2,1                                                  CEP07000
       TRA     FIEDT                                                    CEP07010
 CHAOM PZE                                                              CEP07020
 CHAJQ LXA     OSREL,1        COMMON RELOCATION                         CEP07030
       CLA     REF00,1        LAST USED COMMON LOCATION                 CEP07040
       SUB     =1                                                       CEP07050
       ADD     =O1000000                                                CEP07060
       STO     CHA01,1        SAVE REFERENCE FOR OUTPUT ASSIGNMENT      CEP07070
       STA     REF00,1                                                  CEP07080
       LDQ     TAPES,4        UNIT CHANNEL                              CEP07090
       STQ*    CHA01,1        SAVE IN VARIABLE COMMON                   CEP07100
       CLA     OUTNU                                                    CEP07110
       ORS*    CHA01,1        CHAIN NUMBER FOR CONTINUATION             CEP07120
       STL     SWIJQ          SET J TO Q OUTPUT MODE                    CEP07130
       STL     CHA04,1        SET INTERSYSTEM OUTPUT MODE               CEP07140
       NZT     PARAM2                                                (2)CEP07150
       TRA     FIEDT                                                 (2)CEP07151
       CAL     *                                                     (2)CEP07152
       STP     CHA04,1                                               (2)CEP07153
       CLA     REF00,1       UPDATE REFPR.                           (2)CEP07154
       SBM     =1                                                    (2)CEP07155
       STA     REF00,1                                               (2)CEP07156
       LXA     CHANO2,4                                              (2)CEP07157
       LDQ     TAPES,4                                               (2)CEP07158
       CAL     CHA01,1                                               (2)CEP07159
       SBM     =1                                                    (2)CEP0715A
       STA     A                                                     (2)CEP0715B
A      STQ     **                                                    (2)CEP0715C
       CLA     OUTNU2                                                (2)CEP0715D
       ORS*    A                                                     (2)CEP0715E
       TRA     FIEDT                                                 (2)CEP0715F
 SWIJQ PZE                                                              CEP07160
       SPACE                                                            CEP07170
*                                                                       CEP07180
*  TAPE ASSIGNMENT REFERENCES                                           CEP07190
*                                                                       CEP07200
       BCI     1,00Q0Q0                                                 CEP07210
       BCI     1,00P0P0                                                 CEP07220
       BCI     1,00O0O0                                                 CEP07230
       BCI     1,00N0N0                                                 CEP07240
       BCI     1,00M0M0                                                 CEP07250
       BCI     1,00L0L0                                                 CEP07260
       BCI     1,00K0K0                                                 CEP07270
       BCI     1,00J0J0                                                 CEP07280
       BCI     1,00H000                                                 CEP07290
       BCI     1,00G000                                                 CEP07300
       BCI     1,00F000                                                 CEP07310
       BCI     1,00E000                                                 CEP07320
       BCI     1,00D000                                                 CEP07330
       BCI     1,00C000                                                 CEP07340
       BCI     1,00B000                                                 CEP07350
       BCI     1,00A000                                                 CEP07360
 TAPES BSS     0                                                        CEP07370
       SPACE                                                            CEP07380
*                                                                       CEP07390
* CARD EDIT OF FILE CARDS                                               CEP07400
*                                                                       CEP07410
 FIEDT ZET     FILCT          TEST FOR FILE CARD                        CEP07420
       TRA     *+4                                                      CEP07430
       STL     BUF06                                                    CEP07440
       STL     DEERR          SET ERROR SWITCH                          CEP07450
       TRA     MOEDT          TO MODIFICATION EDIT                      CEP07460
       LXA     FILCT,4        NUMBER OF FILE STATEMENTS                 CEP07470
       SXA     FLCNT,4                                                  CEP07480
 FILAX AXT     0,2                                                      CEP07490
       LXA     FLCNT,4        NO. OF STATEMENTS LEFT                    CEP07500
       TXL     FILND,4,0      TEST FOR MORE FILE CARDS                  CEP07510
       CLA     FILTB,2        ADDRESS OF FILE STATEMENT                 CEP07520
       STA     FILSC          SAVE IN SCAN CALLING SEQUENCE             CEP07530
       TXI     *+1,2,-1                                                 CEP07540
       TXI     *+1,4,-1       REDUCE STATEMENT COUNT                    CEP07550
       SXA     FILAX,2        SAVE TAG OF NEXT STATEMENT                CEP07560
       SXA     FLCNT,4        SAVE NO. STATEMENTS LEFT                  CEP07570
       AXT     0,4                                                      CEP07580
       PDX     ,2             NUMBER OF CARDS                           CEP07590
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP07600
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP07610
       SXD     FILSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP07620
       CALL    SK001          SCAN FILE STATEMENT                       CEP07630
 FILSC PZE     **,,**                                                   CEP07640
       AXT     25,1                                                     CEP07650
       STZ     FAR25,1        CLEAR FILE IMAGE AREA                     CEP07660
       TIX     *-1,1,1                                                  CEP07670
       STZ     FSINP          INITIALIZE INPUT SWITCH                   CEP07680
       STZ     FSOUT          INITIALIZE OUTPUT SWITCH                  CEP07690
       STZ     DICSW                                                    CEP07700
       AXT     6,1            FILE CARD INDICATOR                       CEP07710
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP07720
       SPACE                                                            CEP07730
*                                                                       CEP07740
* WRAP UP OF FILE CARD                                                  CEP07750
*                                                                       CEP07760
       CLA     =2                                                       CEP07770
       NZT     FSLAB          TEST FOR LABEL GIVEN                      CEP07780
       STO     FAR03                                                    CEP07790
       NZT     FSCKP          TEST FOR CHECKPOINT GIVEN                 CEP07800
       STO     FAR17                                                    CEP07810
       ZET     FSBLO          TEST FOR BLOCKSIZE GIVEN                  CEP07820
       TRA     FILOU                                                    CEP07830
       STL     BUF07                                                    CEP07840
       STL     DEERR          SET ERROR SWITCH                          CEP07850
 FILOU BSS     0                                                        CEP07860
       ZET     FAR00          TEST BINARY OR BCD THIS FILE              CEP07870
       TRA     FILDI          BINARY                                    CEP07880
       ZET     FAR08          TEST CHECKSUM GIVEN                       CEP07890
       TRA     FILER                                                    CEP07900
       NZT     FAR09          TEST FOR SEQUENCE NUMBER GIVEN            CEP07910
       TRA     FILDI                                                    CEP07920
FILER  STL     BUF08                                                    CEP07930
       STL     DEERR          SET ERROR SWITCH                          CEP07940
 FILDI BSS     0                                                        CEP07950
       NZT     FSDIC                                                    CEP07960
       TRA     FILDN+2                                                  CEP07970
       NZT     DICGI          TEST FOR DENSITY GIVEN ON DICTIONARY      CEP07980
       TRA     FILDN+2        NONE GIVEN                                CEP07990
       NZT     FSLAB          TEST FOR LABEL GIVEN                      CEP08000
       TRA     FILDN                                                    CEP08010
       ZET     FAR04          TEST FOR HIGH DENSITY LABEL               CEP08020
       TRA     FILDS                                                    CEP08030
       NZT     DICSW          TEST FOR HIGH DENSITY DICTIONARY          CEP08040
       TRA     FILDN                                                    CEP08050
DICWR  STL     BUF09                                                    CEP08060
       STL     DEERR          SET ERROR SWITCH                          CEP08070
       TRA     FILDN                                                    CEP08080
 FILDS BSS     0                                                        CEP08090
       NZT     DICSW          TEST FOR LOW DENSITY ON DICTIONARY        CEP08100
       TRA     DICWR                                                    CEP08110
 FILDN BSS     0                                                        CEP08120
       CLA     DICSW                                                    CEP08130
       STO     FAR04                                                    CEP08140
       ZET     FSOUT                                                    CEP08150
       TRA     OUTPT                                                    CEP08160
       ZET     FSINP          TEST FOR INPUT FILE                       CEP08170
       TRA     INPT                                                     CEP08180
       STL     BUF10                                                    CEP08190
       STL     DEERR          SET ERROR SWITCH                          CEP08200
       TRA     FILAX                                                    CEP08210
 OUTPT LXA     OSREL,1        COMMON RELOCATION AMOUNT                  CEP08220
       CAL     =H 0001        REEL SEQUENCE NUMBER                      CEP08230
       NZT     FAR07          TEST FOR SEQUENCE NUMBER GIVEN            CEP08240
       SLW     FAR07                                                    CEP08250
       CAL     =H                                                       CEP08260
       NZT     FAR06                                                    CEP08270
       SLW     FAR06                                                    CEP08280
       CAL     =H   000                                                 CEP08290
       NZT     FAR18                                                    CEP08300
       SLW     FAR18                                                    CEP08310
       NZT     FIL01,1        TEST FOR OUTPUT GIVEN                     CEP08320
       TRA     *+4                                                      CEP08330
       STL     BUF11                                                    CEP08340
       STL     DEERR          SET ERROR SWITCH                          CEP08350
       TRA     FILAX                                                    CEP08360
       CLA     REF00,1        LAST CELL USED IN VARIABLE COMMON         CEP08370
       SUB     =1                                                       CEP08380
       STA     FIL01,1        SAVE ADDRESS OF OUTPUT FILE               CEP08390
       STA     FILMV+1                                                  CEP08400
       SUB     =24                                                      CEP08410
       STA     REF00,1                                                  CEP08420
 FILMI AXT     0,2                                                      CEP08430
       AXT     0,1                                                      CEP08440
       AXT     25,4                                                     CEP08450
 FILMV LDQ     FAR00,1                                                  CEP08460
       STQ     **,2                                                     CEP08470
       TXI     *+1,2,1        NEXT FILE AREA POSITION                   CEP08480
       TXI     *+1,1,-1                                                 CEP08490
       TIX     FILMV,4,1                                                CEP08500
       TRA     FILAX                                                    CEP08510
 INPT  LXA     OSREL,1        COMMON RELOCATION AMOUNT                  CEP08520
       STL     FIL00,1        SET INPUT FILE SWITCH                     CEP08530
       ZET     FAR00          TEST FOR BINARY OR BCD                    CEP08540
       TRA     MODONE         BINARY                                    CEP08550
       ZET     MODSW          TEST FOR MODE GIVEN ONCE                  CEP08560
       TRA     *+3                                                      CEP08570
       STZ     GEN01,1        SET MODE FOR BCD                          CEP08580
       STL     MODSW          SET MODE GIVEN ONCE                       CEP08590
       NZT     GEN01,1        TEST FOR BCD MODE                         CEP08600
       TRA     MODOK         BCD                                        CEP08610
MESONE ZET     MOPRT          TEST FOR MESSAGE PRINTED ONCE             CEP08620
       TRA     MODOK                                                    CEP08630
       STL     MOPRT          SET MESSAGE PRINTED ONCE                  CEP08640
       STL     BUF12                                                    CEP08650
       TRA     MODOK                                                    CEP08660
MODONE ZET     MODSW         TEST FOR MODE GIVEN ONCE                   CEP08670
       TRA     *+3                                                      CEP08680
       STL     GEN01,1        SET MODE FOR BINARY                       CEP08690
       STL     MODSW          SET MODE GIVEN ONCE SWITCH                CEP08700
       NZT     GEN01,1        TEST FOR BINARY MODE                      CEP08710
       TRA     MESONE        BCD                                        CEP08720
 MODOK CLA     =1                                                       CEP08730
       NZT     FAR15          TEST FOR NUMBER OF INPUT REELS GIVEN      CEP08740
       STO     FAR15          SET TO 1 IF NOT GIVEN                     CEP08750
       CLA     FILCO          UPDATE NUMBER OF FILES TO BE MERGED       CEP08760
       ADD     =1             OR USED AS INPUT                          CEP08770
       STO     FILCO                                                    CEP08780
       PAX     0,2                                                      CEP08790
       CLA     REF00,1        LAST VARIABLE COMMON POSITION             CEP08800
       SUB     =1                                                       CEP08810
       STA     FILIN,2                                                  CEP08820
       STA     FILMV+1                                                  CEP08830
       SUB     =24                                                      CEP08840
       STA     REF00,1                                                  CEP08850
       CLA     FSINP          INPUT FILE NUMBER                         CEP08860
       ALS     18                                                       CEP08870
       STD     FILIN,2                                                  CEP08880
       TRA     FILMI                                                    CEP08890
*                                                                       CEP08900
 FILCO PZE                                                              CEP08910
       DUP     1,10                                                     CEP08920
       PZE                                                              CEP08930
 FILIN BSS     0                                                        CEP08940
 MODSW PZE                                                              CEP08950
 MOPRT PZE                                                              CEP08960
 FLCNT PZE                    NO. OF FILE STATEMENTS LEFT               CEP08970
*                                                                       CEP08980
 FILND LXA     OSREL,1                                                  CEP08990
       ZET     FIL00,1        TEST FOR INPUT FILE                       CEP09000
       TRA     *+3                                                      CEP09010
       STL     BUF10                                                    CEP09020
       STL     DEERR          SET ERROR SWITCH                          CEP09030
       ZET     FIL01,1        TEST FOR OUTPUT FILE GIVEN                CEP09040
       TRA     *+3                                                      CEP09050
       STL     BUF10                                                    CEP09060
       STL     DEERR          SET ERROR SWITCH                          CEP09070
       TRA     MOEDT          TO MODIFICATION EDIT                      CEP09080
       SPACE                                                            CEP09090
*                                                                       CEP09100
* CARD EDIT OF MODIFICATION CARD                                        CEP09110
*                                                                       CEP09120
 MOEDT NZT     MODCT          TEST FOR MODIFICATION CARDS               CEP09130
       TRA     REEDT                                                    CEP09140
       LXA     MODCT,4        NO. OF MODIFICATION STATEMENTS            CEP09150
       SXA     MDCNT,4                                                  CEP09160
 MODAX AXT     0,2                                                      CEP09170
       LXA     MDCNT,4        NO. OF STATEMENTS LEFT                    CEP09180
       TXL     REEDT,4,0      TEST FOR MORE MODIFICATION CARDS          CEP09190
       CLA     MODTB,2        ADDRESS OF MODIFICATION STATEMENT         CEP09200
       STA     MODSC          SAVE IN SCAN CALLING SEQUENCE             CEP09210
       TXI     *+1,2,-1                                                 CEP09220
       TXI     *+1,4,-1       REDUCE STATEMENT COUNT                    CEP09230
       SXA     MODAX,2        SAVE TAG OF NEXT STATEMENT                CEP09240
       SXA     MDCNT,4        SAVE NO. OF STATEMENTS LEFT               CEP09250
       AXT     0,4                                                      CEP09260
       PDX     ,2             NUMBER OF CARDS                           CEP09270
       TXI     *+1,4,11       CHANGE NO. OF CARDS TO                    CEP09280
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP09290
       SXD     MODSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP09300
       CALL    SK001          SCAN MODIFICATION STATEMENT               CEP09310
 MODSC PZE     **,,**                                                   CEP09320
       AXT     5,1            MODIFICATION CARD INDICATOR               CEP09330
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP09340
       SPACE                                                            CEP09350
*                                                                       CEP09360
* WRAP UP OF MODIFICATION CARD                                          CEP09370
*                                                                       CEP09380
       LXA     PROBS,2        MODIFICATION NUMBER                       CEP09390
       SXD     *+2,2                                                    CEP09400
       AXT     MOD00,2        BASE ADDRESS                              CEP09410
       TIX     *+1,2,**                                                 CEP09420
       TXI     *+1,2,1                                                  CEP09430
       LXA     OSREL,1        COMMON RELOCATION AMOUNT                  CEP09440
       SXA     *+2,2                                                    CEP09450
       CLA     MSCEL                                                    CEP09460
 MODAD STA     **,1                                                     CEP09470
       CLA     LOCSW                                                    CEP09480
       STZ     LOCSW                                                    CEP09490
       STD*    MODAD                                                    CEP09500
       CAL     *                                                        CEP09510
       ZET     MSFOR                                                    CEP09520
       STP*    MODAD                                                    CEP09530
       STZ     MSFOR                                                    CEP09540
       CAL     PRMNO          EXTRA MODIFICATION NUMBER                 CEP09550
       ARS     3                                                        CEP09560
       ORS*    MODAD          PLACE IN MODIFICATION WORD                CEP09570
       TRA     MODAX                                                    CEP09580
 MDCNT PZE                    NO. OF MOD STATEMENTS LEFT                CEP09590
       SPACE                                                            CEP09600
*                                                                       CEP09610
* CARD EDIT OF RECORD CARD                                              CEP09620
*                                                                       CEP09630
 REEDT ZET     RECCT          TEST FOR RECORD STATEMENTS                CEP09640
       TRA     *+4                                                      CEP09650
       STL     BUF13                                                    CEP09660
       STL     DEERR          SET ERROR SWITCH                          CEP09670
       TRA     DEEDT          TO DELETE EDITING                         CEP09680
       LXA     RECCT,4        NO. OF RECORD STATEMENTS                  CEP09690
       SXA     RCCNT,4                                                  CEP09700
 RECAX AXT     0,2            INITIALIZE RECORD POINTER                 CEP09710
       LXA     RCCNT,4        NO. OF RECORD STATEMENTS LEFT TO PROCESS  CEP09720
       TXL     DEEDT,4,0      TEST FOR MORE RECORD STATEMENTS           CEP09730
       CAL     RECTB,2        ADDRESS OF RECORD STATEMENTS              CEP09740
       STA     RECSC          SAVE IN SCAN CALLING SEQUENCE             CEP09750
       TXI     *+1,2,-1       SET POINTER FOR NEXT RECORD CARD          CEP09760
       TXI     *+1,4,-1       REDUCE STATEMENT COUNT                    CEP09770
       SXA     RECAX,2        SAVE POINTER FOR NEXT STATEMENT           CEP09780
       SXA     RCCNT,4        SAVE NO. STATEMENTS LEFT                  CEP09790
       AXT     0,4            INITIALIZE NUMBER OF WORDS                CEP09800
       PDX     ,2             NUMBER OF CARDS                           CEP09810
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP09820
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP09830
       SXD     RECSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP09840
       CALL    SK001          SCAN RECORD STATEMENT                     CEP09850
 RECSC PZE     **,,**                                                   CEP09860
       AXT     5,1            CLEAR LENGTH TABLE                        CEP09870
       STZ     LENTA,1        FOR THIS RECORD TYPE                      CEP09880
       TIX     *-1,1,1                                                  CEP09890
       AXT     200,4                                                    CEP09900
       STZ     FIEUS,4        SET ALL SIGNED-UNSIGNED SWITCHES UNSIGNED CEP09910
       TIX     *-1,4,1                                                  CEP09920
       STZ     FIEBC          SET BIN-CHAR SWITCH FOR CHARACTERS        CEP09930
       STZ     TYPFV          SET TYPE SWITCH FOR FIXED                 CEP09940
       AXT     4,1                                                      CEP09950
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP09960
       SPACE                                                            CEP09970
*                                                                       CEP09980
* WRAP UP OF RECORD CARD                                                CEP09990
*                                                                       CEP10000
       ZET     RSLEN          TEST FOR LENGTH GIVEN.                    CEP10010
       TRA     *+4                                                      CEP10020
       STL     BUF14                                                    CEP10030
       STL     DEERR          SET ERROR SWITCH                          CEP10040
       TRA     RECLT                                                    CEP10050
       LXA     LENNO,4        NUMBER OF LENGTH PARAMETERS               CEP10060
       ZET     TYPFV          FIXED OR VARIABLE                         CEP10070
       TRA     RECLT                                                    CEP10080
       TXH     *+4,4,3        TEST FOR MORE THAN 3 LENGTHS              CEP10090
       TXH     *+6,4,2       TEST FOR 3 PARAMETERS.                     CEP10100
       TXH     RECTO,4,1      TEST FOR 2 PARAMETERS                     CEP10110
       TXH     RECON,4,0      TEST FOR 1 PARAMETER                      CEP10120
       STL     BUF14                                                    CEP10130
       STL     DEERR          SET ERROR SWITCH                          CEP10140
       TRA     RECLT                                                    CEP10150
       CAL     LENTA-1        FIRST PARAMETER                           CEP10160
       TNZ     *+4           TEST FOR VALID RECORD LENGTH.              CEP10170
RECMS  STL     BUF14                                                    CEP10180
       STL     DEERR          SET ERROR SWITCH                          CEP10190
       TRA     RECLT                                                    CEP10200
       ZET     LENTA-2        TEST FOR SECOND NUNBER                    CEP10210
       TRA     *+3                                                      CEP10220
       SLW     LENTA-2        SET SECOND LENGTH EQUAL TO FIRST LENGTH   CEP10230
       TRA     *+2                                                      CEP10240
       CAL     LENTA-2        GET SECOND RECORD LENGTH                  CEP10250
       NZT     LENTA-3        TEST FOR THIRD RECORD LENGTH              CEP10260
       STO     LENTA-3        SET THIRD LENGTH EQUAL TO SECOND          CEP10270
       TRA     RECLT                                                    CEP10280
 RECTO NZT     LENTA-1        TEST FOR VALID RECORD LENGTH              CEP10290
       TRA     RECMS          TO ERROR MESSAGE                          CEP10300
       CLA     LENTA-1        FIRST RECORD LENGTH                       CEP10310
       NZT     LENTA-2        TEST FOR SECOND NUMBER                    CEP10320
       STO     LENTA-2        SET SECOND LENGTH EQUAL TO FIRST LENGTH   CEP10330
       CLA     LENTA-2        SECOND RECORD LENGTH                      CEP10340
       STO     LENTA-3        SET THIRD NUMBER EQUAL TO SECOND LENGTH   CEP10350
       TRA     RECLT                                                    CEP10360
 RECON NZT     LENTA-1        TEST FOR VALID RECORD LENGTH              CEP10370
       TRA     RECMS          TO ERROR MESSAGE                          CEP10380
       CLA     LENTA-1        FIRST RECORD LENGTH                       CEP10390
       STO     LENTA-2        SET SECOND RECORD LENGTH EQUAL TO FIRST   CEP10400
       STO     LENTA-3        SET THIRD RECORD LENGTH EQUAL TO SECOND   CEP10410
 RECLT LXA     FIENO,4        NUMBER OF CONTROL FIELDS                  CEP10420
       CLA     LENTA-1        LENGTH OF RECORD                          CEP10430
       ADD     =1             FOR EQUALS WORD                           CEP10440
       STO     FILSW-1,4      SAVE IN CASE OF EQUALS                    CEP10450
       AXT     1,2                                                      CEP10460
       CAL     LENTA-1        FIRST LENGTH                              CEP10470
       ZET     TYPFV                                                    CEP10480
       TRA     RECSH          TRANSFER IF VARIABLE.                     CEP10490
       LAS     LENTA-2        TEST FOR HIGHEST - FIRST AND SECOND       CEP10500
       TRA     RECHT          FIRST HIGHER THAN SECOND                  CEP10510
       TRA     RECHT          SECOND EQUALS FIRST                       CEP10520
       CAL     LENTA-2        SECOND HIGHER                             CEP10530
       LAS     LENTA-3        TEST FOR HIGHEST SECOND AND THIRD         CEP10540
       TRA     RECSH          SECOND HIGHEST                            CEP10550
       TRA     RECSH          SECOND EQUALS THIRD                       CEP10560
       CAL     LENTA-3        THIRD HIGHEST                             CEP10570
       SLW     RECSV                                                    CEP10580
       TRA     RECLS                                                    CEP10590
 RECHT LAS     LENTA-3        TEST HIGHEST - FIRST OR THIRD             CEP10600
       TRA     RECSH          FIRST HIGHER THAN THIRD                   CEP10610
       TRA     RECSH          FIRST EQUALS THIRD                        CEP10620
       CAL     LENTA-3        THIRD HIGHER THAN FIRST                   CEP10630
 RECSH SLW     RECSV          SAVE FOR RECORD LENGTH TEST               CEP10640
 RECLS CLA     RECSV          RECORD LENGTH                             CEP10650
       ADD     =1                                                       CEP10660
       SUB     FILNW,2        NUMBER OF WORDS CONTROL FIELD EXTENDS OVERCEP10670
       SUB     FILSW,2        FIELD STARTING WORD                       CEP10680
       TMI     *+4                                                      CEP10690
       TXI     *+1,2,1        END OF RECORD                             CEP10700
       TIX     RECLS,4,1                                                CEP10710
       TRA     *+3                                                      CEP10720
       STL     BUF15                                                    CEP10730
       STL     DEERR          SET ERROR SWITCH                          CEP10740
       LXA     OSREL,1        COMMON RELOCATION                         CEP10750
       CLA     LENTA-1                                                  CEP10760
       STO     REC00,1        SAVE FIXED LENGTH FOR INPUT TO PHASE 1    CEP10770
       CLA     LENTA-2                                                  CEP10780
       STO     REC01,1        SAVE FIXED LENGTH OUTPUT FROM PHASE 1     CEP10790
       CLA     LENTA-3                                                  CEP10800
       STO     REC02,1        SAVE FIXED LENGTH FOR FINAL OUTPUT        CEP10810
       CLA     TYPFV          FIXED OR VARIABLE SWITCH                  CEP10820
       STO     REC05,1        SAVE IN COMMON                            CEP10830
       TRA     DEEDT          TO DELETE EDITING                         CEP10840
 RECSV PZE                                                              CEP10850
 RCCNT PZE                                                              CEP10860
       SPACE                                                            CEP10870
*                                                                       CEP10880
* CARD EDIT OF DELETE STATEMENT                                         CEP10890
*                                                                       CEP10900
 DEEDT NZT     DELCT          TEST FOR DELETE STATEMENTS                CEP10910
       TRA     SOEDT          TO SORT EDITING                           CEP10920
       LXA     DELCT,4        NO. OF DELETE STATEMENTS                  CEP10930
       SXA     DLCNT,4                                                  CEP10940
 DELAX AXT     0,2                                                      CEP10950
       LXA     DLCNT,4        NO. OF DELETE STATEMENTS LEFT TO PROCESS  CEP10960
       TXL     SOEDT,4,0      TEST FOR MORE DELETE CARDS                CEP10970
       CLA     DELTB,2        ADDRESS OF DELETE STATEMENT               CEP10980
       STA     DELSC          SAVE IN SCAN CALLING SEQUENCE             CEP10990
       TXI     *+1,2,-1       CHANGE STATEMENT POINTER                  CEP11000
       TXI     *+1,4,-1       REDUCE STATEMENT COUNT                    CEP11010
       SXA     DELAX,2        SAVE TAG OF NEXT STATEMENT                CEP11020
       SXA     DLCNT,4        SAVE NO. STATEMENTS LEFT                  CEP11030
       AXT     0,4                                                      CEP11040
       PDX     ,2             NUMBER OF CARDS                           CEP11050
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS TO                 CEP11060
       TIX     *-1,2,1        NUMBER OF WORDS                           CEP11070
       SXD     DELSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP11080
       CALL    SK001          SCAN DELETE STATEMENT                     CEP11090
 DELSC PZE     **,,**                                                   CEP11100
       AXT     3,1                                                      CEP11110
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP11120
       SPACE                                                            CEP11130
*                                                                       CEP11140
* WRAP UP OF DELETE CARD                                                CEP11150
*                                                                       CEP11160
       ZET     DSFIE          TEST FOR DELETE FIELD.                    CEP11170
       TRA     *+4                                                      CEP11180
       STL     BUF16                                                    CEP11190
       STL     DEERR          SET ERROR SWITCH                          CEP11200
       TRA     DELAX                                                    CEP11210
       LXA     DSFIE,4        FIELD NUMBER                              CEP11220
       ZET     FILSW,4        TEST FOR FIELD BEYOND SPECIFIED CONTROL   CEP11230
       TRA     *+4           FIELD AREAS.                               CEP11240
       STL     BUF17                                                    CEP11250
       STL     DEERR          SET ERROR SWITCH                          CEP11260
       TRA     DELAX                                                    CEP11270
       CLA     FIELN,4        LENGTH OF CONTRL FIELD                    CEP11280
       CAS     IDELE          TEST FOR EQUAL DELETE AND RECORD          CEP11290
       TRA     *+2            CONTROL FIELD LENGTH                      CEP11300
       TRA     *+4                                                      CEP11310
       STL     BUF18                                                    CEP11320
       STL     DEERR          SET ERROR SWITCH                          CEP11330
       TRA     DELAX                                                    CEP11340
       NZT     DSIDE          TEST FOR LEGAL IDENTIFICATION             CEP11350
       TRA     DELAX                                                    CEP11360
       LXA     OSREL,1        RELOCATION AMOUNT                         CEP11370
       CLA     REF00,1                                                  CEP11380
       ZET     DEL00,1        REST IF THIS IS FIRST DELETE STATEMENT    CEP11390
       TRA     *+3            FIRST STATEMENT ALREADY PROCESSED         CEP11400
       SUB     =1                                                       CEP11410
       STA     DEL00,1        ADDRESS OF FIRST DELETE CONTROL FIELD     CEP11420
       PAC     0,2                                                      CEP11430
       SUB     =3             CALCULATE NEW LAST                        CEP11440
       SUB     FILNW,4        CELL USED IN VARIABLE                     CEP11450
       STA     REF00,1        COMMON                                    CEP11460
       CLA     FILNW,4        NUMBER OF WORDS IN CONTROL FIELD          CEP11470
       ALS     18                                                       CEP11480
       STO     0,2            MOVE TO VARIABLE COMMON                   CEP11490
       CLA     FILSW,4        STARTING WORD                             CEP11500
       STA     0,2            MOVE TO VARIABLE COMMON                   CEP11510
       TXI     *+1,2,1        NEXT COMMON POSITION                      CEP11520
       CAL     FILLM,4        LEFT MASK                                 CEP11530
       SLW     0,2            MOVE TO VARIABLE COMMON                   CEP11540
       TXI     *+1,2,1        NEXT COMMON POSITION                      CEP11550
       CAL     FILRM,4        RIGHT MASK                                CEP11560
       SLW     0,2            MOVE TO VARIABLE COMMON                   CEP11570
       TXI     *+1,2,1        NEXT COMMON POSITION                      CEP11580
       CLA     FILSB,4        FIELD STARTING BIT                        CEP11590
       STA     DELSF                                                    CEP11600
       AXT     1,4                                                      CEP11610
       LXA     IDELE,1        NUMBER OF IDENTIFICATION BITS             CEP11620
       STZ     DEWRS          INITIALIZE REMAINDER WORD AREA            CEP11630
 DELIN LDQ     =0                                                       CEP11640
       ZAC                                                              CEP11650
       CAL     IDETA,4        WORD OF IDENTIFICATION                    CEP11660
 DELSF LGR     **             SHIFT TO STARTING BIT LOCATION            CEP11670
       ORA     DEWRS          PART OF PREVIOUS SHIFTED WORD             CEP11680
       STQ     DEWRS          SAVE PARTIAL WORD THIS SHIFT              CEP11690
       SLW     0,2            MOVE TO VARIABLE COMMON                   CEP11700
       TXI     *+1,2,1        NEXT COMMON POSITION                      CEP11710
       TXI     *+1,4,1                                                  CEP11720
       TIX     DELIN,1,36     TEST FOR MORE IDENTIFICATION BITS         CEP11730
       ZET     DEWRS          TEST FOR A WORD REMAINDER                 CEP11740
       STQ     0,2                                                      CEP11750
       LXA     OSREL,1        COMMON RELOCATION                         CEP11760
       CLA     DEL00,1        INCREASE COUNT OF NUMBER OF DELETES       CEP11770
       ADD     =O1000000      ONE IN DECREMENT                          CEP11780
       STO     DEL00,1                                                  CEP11790
       TRA     DELAX                                                    CEP11800
 DEWRS PZE                                                              CEP11810
 DLCNT PZE                                                              CEP11820
       SPACE                                                            CEP11830
*                                                                       CEP11840
* CARD EDIT OF SORT STATEMENT                                           CEP11850
*                                                                       CEP11860
 SOEDT NZT     SORCT          TEST FOR SORT CARD                        CEP11870
       TRA     MEEDT          TO MERGE CARD EDIT                        CEP11880
       ZET     CSMER                                                    CEP11890
       TRA     *+3                                                      CEP11900
       STL     BUF19                                                    CEP11910
       STL     DEERR                                                    CEP11920
       LXA     OSREL,1        COMMON RELOCATION                         CEP11930
       STL     SAM04,1        SET SORT SWITCH                           CEP11940
       CLA     SORTB          ADDRESS OF SORT STATEMENT                 CEP11950
       STA     SORSC          SAVE IN SCAN CALLING SEQUENCE             CEP11960
       AXT     0,4                                                      CEP11970
       PDX     ,2             NUMBER OF CARDS                           CEP11980
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS                    CEP11990
       TIX     *-1,2,1        TO NUMBER OF WORDS                        CEP12000
       SXD     SORSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP12010
       CALL    SK001          SCAN SORT STATEMENT                       CEP12020
 SORSC PZE     **,,**                                                   CEP12030
       AXT     2,1            SORT STATEMENT INDICATOR                  CEP12040
       TSX     DEFER,4        TO DEFINER ANALYSIS PROGRAM               CEP12050
       SPACE                                                            CEP12060
*                                                                       CEP12070
* CARD EDIT OF MERGE STATEMENT                                          CEP12080
*                                                                       CEP12090
 MEEDT NZT     MERCT          TEST FOR MERGE CARD                       CEP12100
       TRA     SMWRP          TO SORT-MERGE WRAP UP                     CEP12110
       LXA     OSREL,1        COMMON RELOCATION                         CEP12120
       STL     SAM05,1        SET MERGE SWITCH                          CEP12130
       STZ     OPT01,1        CKSUMS AND EQUAL OPTION NOT ALLOWED  IF   CEP12140
       STZ     OPT03,1         THERE IS AN EXTERNAL MERGE FILE          CEP12150
       CLA     MERTB          ADDRESS OF MERGE STATEMENT                CEP12160
       STA     MERSC          SAVE IN SCAN CALLING SEQUENCE             CEP12170
       AXT     0,4                                                      CEP12180
       PDX     ,2             NUMBER OF CARDS                           CEP12190
       TXI     *+1,4,11       CHANGE NUMBER OF CARDS                    CEP12200
       TIX     *-1,2,1        TO NUMBER OF WORDS                        CEP12210
       SXD     MERSC,4        SAVE IN SCAN CALLING SEQUENCE             CEP12220
       CALL    SK001          SCAN MERGE STATEMENT                      CEP12230
 MERSC PZE     **,,**                                                   CEP12240
       AXT     1,1            MERGE STATEMENT INDICATOR                 CEP12250
       TSX     DEFER,4        DEFINER ANALYSIS PROGRAM                  CEP12260
       SPACE                                                            CEP12270
*                                                                       CEP12280
* WRAP UP OF SORT-MERGE CARDS                                           CEP12290
*                                                                       CEP12300
 SMWRP LXA     OSREL,1        COMMON RELOCATION                         CEP12310
       STZ     FIL00,1        TEST INPUT TO SORT SWITCH                 CEP12320
       ZET     SAM04,1        TEST FOR A SORT CARD GIVEN                CEP12330
       TRA     SMZET                                                    CEP12340
       ZET     SAM05,1        TEST FOR A MERGE CARD GIVEN               CEP12350
       TRA     SMZET                                                    CEP12360
       STL     BUF20                                                    CEP12370
       STL     DEERR          SET ERROR SWITCH                          CEP12380
       TRA     STOP                                                     CEP12390
 SMZET ZET     SSORD          TEST FOR SORT MERGE ORDER ON SORT CARD    CEP12400
       TRA     SMORS                                                    CEP12410
       ZET     MSORD          TEST FOR MERGE ORDER ON MERGE CARD        CEP12420
       TRA     SMORM                                                    CEP12430
       STL     BUF21                                                    CEP12440
       STL     DEERR          SET ERROR SWITCH                          CEP12450
 SMORS CLA     SSORD          SORT MERGE ORDER                          CEP12460
       TRA     *+2                                                      CEP12470
 SMORM CLA     MSORD          MERGE MERGE ORDER                         CEP12480
       STO     SAM01,1        STORE MERGE ORDER                         CEP12490
       ZET     SSSEQ          TEST FOR SEQUENCE-SORT CARD               CEP12500
       TRA     SMSES                                                    CEP12510
       ZET     MSSEQ          TEST FOR SEQUENCE-MERGE CARD              CEP12520
       TRA     SMSEM                                                    CEP12530
       STZ     SAM00,1        NONE GIVEN-SET FOR SCIENTIFIC SEQUENCE    CEP12540
       TRA     SMFIR                                                    CEP12550
 SMSES CLA     SESCS          SEQUENCE ON SORT CARD                     CEP12560
       TRA     *+2                                                      CEP12570
 SMSEM CLA     SEMCS          SEQUENCE ON MERGE CARD                    CEP12580
       STO     SAM00,1        SAVE SEQUENCE IN COMMON TABLE             CEP12590
       SPACE   5                                                        CEP12600
*                                                                       CEP12610
*  MOVE LOCATION OF MERGE FILES TO COMMON                               CEP12620
*                                                                       CEP12630
 SMFIR NZT     SSFIL          TEST FOR SORT INPUT FILE                  CEP12640
       TRA     SMMTE                                                    CEP12650
       LXA     FILCO,2        NUMBER OF INPUT FILES                     CEP12660
 SMNUM CLA     FILIN,2        FIRST INPUT FILE                          CEP12670
       ARS     18             FILE NUMBER                               CEP12680
       CAS     SSFIL          COMPARE FOR SORT FILE NUMBER              CEP12690
       TRA     *+2                                                      CEP12700
       TRA     SMINS          EQUAL                                     CEP12710
       TIX     SMNUM,2,1                                                CEP12720
       STL     DEERR          SET ERROR SWITCH                          CEP12730
       STL     BUF22                                                    CEP12740
       LXA     OSREL,1        COMMON RELOCATION                         CEP12750
       ZET     SAM05,1        TEST IF THIS IS A MERGE                   CEP12760
       TRA     SMLXA                                                    CEP12770
       TRA     SMFLD                                                    CEP12780
 SMINS LXA     OSREL,1        COMMON RELOCATION                         CEP12790
       CLA     FILIN,2        ADDRESS OF INPUT CHANNEL                  CEP12800
       STO     FIL00,1                                                  CEP12810
       STZ     FILIN,2        REMOVE FROM LIST                          CEP12820
 SMLXA LXA     FILCO,2        NUMBER OF INPUT FILES                     CEP12830
       AXT     1,1                                                      CEP12840
 SMBEG AXT     8,4                                                      CEP12850
       CLA     FILIN,1        FILE NUMBER                               CEP12860
       ARS     18                                                       CEP12870
       TZE     SMMOV          TEST FOR A NUMBER IN THIS CELL            CEP12880
       CAS     FILTA,4        TEST FOR EQUAL FILE NUMBERS ON            CEP12890
       TRA     *+2            MERGE AND FILE CARDS                      CEP12900
       TRA     SMTMV          EQUAL                                     CEP12910
       TIX     *-3,4,1                                                  CEP12920
       STL     BUF22                                                    CEP12930
       TRA     SMMOV                                                    CEP12940
 SMTMV SXA     SMRES,2                                                  CEP12950
 SMAXT AXT     0,2                                                      CEP12960
       TXI     *+1,2,1        COUNT NUMBER OF FILES MOVED               CEP12970
       SXA     SMAXT,2                                                  CEP12980
 SMRES AXT     **,2                                                     CEP12990
       CLA     FILIN,1        MOVE LEGAL FILE NUMBER TO BUFFER          CEP13000
       STO     SMTAB,1        WHICH WILL LATER BE MOVED TO COMMON       CEP13010
       STZ     FILIN,1        REMOVE FROM INPUT TABLE                   CEP13020
 SMMOV TXI     *+1,1,1                                                  CEP13030
       TIX     SMBEG,2,1                                                CEP13040
       LXA     OSREL,1        COMMON RELOCATION                         CEP13050
       CLA     SMAXT          NUMBER OF FILES TO BE SORTED AND MERGED.  CEP13060
       STA     SAM02,1        SAVE IN COMMON NUMBER OF FILES TO MERGE   CEP13070
       AXT     8,1                                                      CEP13080
 SMTFL AXT     8,4                                                      CEP13090
       AXT     1,2                                                      CEP13100
       ZET     SMTAB,2        TABLE OF FILES TO BE MERGED               CEP13110
       TRA     *+4                                                      CEP13120
       CLA     SMTAB-1,2      NEXT WORD IN TABLE                        CEP13130
       STZ     SMTAB-1,2      CLEAR THIS POSTION IN TABLE               CEP13140
       STO     SMTAB,2        MOVE TO NEXT HIGHER POSITION IN TABLE     CEP13150
       TXI     *+1,2,1                                                  CEP13160
       TIX     *-6,4,1                                                  CEP13170
       TIX     SMTFL,1,1                                                CEP13180
       LXA     OSREL,1        COMMON RELOCATION                         CEP13190
       AXT     8,4                                                      CEP13200
       CLA     SMTAB,4        MOVE FROM MERGE TABLE TO COMMON           CEP13210
       STO     FIL09,1        MOVE FROM MERGE TABLE TO COMMON           CEP13220
       TXI     *+1,1,-1                                                 CEP13230
       TIX     *-3,4,1                                                  CEP13240
       LXA     OSREL,1        COMMON RELOCATION                         CEP13250
       ZET     SAM04,1        TEST FOR SORT                             CEP13260
       TRA     SMNZT          SORT                                      CEP13270
       CAL     SAM02,1        NUMBER OF FILES TO BE MERGED              CEP13280
       LAS     SAM01,1        MERGE ORDER                               CEP13290
       TRA     SMNZT          NUMBER OF FILES HIGHER THAN MERGE ORDER   CEP13300
       TRA     SMNZT          EQUAL                                     CEP13310
       SLW     SAM01,1        LESS THAN MERGE ORDER-SET EQUAL           CEP13320
 SMNZT NZT     SAM04,1       TEST FOR MERGE                             CEP13330
       TRA     SMMER          MERGE ONLY                                CEP13340
       CAL     SAM01,1        MERGE ORDER                               CEP13350
       LAS     =1             TEST FOR EQUAL TO 1 OR LESS               CEP13360
       TRA     SMMER                                                    CEP13370
       TRA     *+1                                                      CEP13380
       STL     BUF21                                                    CEP13390
       STL     DEERR                                                    CEP13400
 SMMER NZT     SAM04,1        TEST FOR SORT                             CEP13410
       TRA     BLLXA                                                    CEP13420
       NZT     SAM05,1        TEST FOR MERGE                            CEP13430
       TRA     BLLXA                                                    CEP13440
       CAL     SAM02,1        NUMBER OF FILES TO BE MERGED              CEP13450
       ADD     =1             ONE FOR FILE TO MERGE FROM SORT           CEP13460
       LAS     SAM01,1        MERGE ORDER                               CEP13470
       TRA     *+3            NUMBER FILES TO MERGE HIGHER MERGE ORDER  CEP13480
       TRA     BLLXA                                                    CEP13490
       TRA     BLLXA                                                    CEP13500
       STL     BUF23                                                    CEP13510
       STL     DEERR          SET ERROR SWITCH                          CEP13520
       SPACE   5                                                        CEP13530
*                                                                       CEP13540
* TEST FOR RECORD LENGTH A FACTOR OF FILE BLOCKING                      CEP13550
*                                                                       CEP13560
 BLLXA LXA     OSREL,1        COMMON RELOCATION                         CEP13570
       NZT     FIL00,1        TEST FOR SORT INPUT FILE                  CEP13580
       TRA     BLKME+2                                                  CEP13590
       CLA     FIL00,1        ADDRESS OF FILE INPUT BLOCK               CEP13600
       AXT     5,2            LOCATION OF BLOCKSIZE IN FILE BLOCK       CEP13610
       STA     *+1                                                      CEP13620
 BLLOC CLA     **,2           BLOCKSIZE                                 CEP13630
       TXI     *+1,2,14       LOCATE CHECKSUM-BLOCKSEQEUNCE OPTION      CEP13640
       NZT*    BLLOC          TEST FOR EITHER OPTION                    CEP13650
       TRA     BLNOT                                                    CEP13660
       ADD     =1             EFFECTIVE BLOCK LENGTH                    CEP13670
       TXI     *+1,2,3        LOCATE LOCATION FOR EFFECTIVE BLOCK LENGTHCEP13680
       STO*    BLLOC          SAVE NEW LENGTH IN FAREA+23               CEP13690
       SUB     =1                                                       CEP13700
       TRA     BLDVD                                                    CEP13710
 BLNOT TXI     *+1,2,3                                                  CEP13720
       STO*    BLLOC          EFFECTIVE LENGTH = ACTUAL LENGTH          CEP13730
 BLDVD XCL                                                              CEP13740
       ZAC                                                              CEP13750
       DVP     REC00,1        DIVIDE BY RECORD LENGTH                   CEP13760
       TZE     BLAXT         TEST FOR RECORD LENGTH FACTOR OF BLOCKING  CEP13770
       ZET     TYPFV          TEST FOR FIXED OR VARIABLE                CEP13780
       TRA     BLKME+2        VARIABLE                                  CEP13790
       TXI     *+1,2,-8                                                 CEP13800
BLSTL  STL     BUF24                                                    CEP13810
       STL     DEERR          SET ERROR SWITCH                          CEP13820
       TRA     BLKME+2                                                  CEP13830
 BLAXT AXT     23,2                                                     CEP13840
       STQ*    BLLOC          SAVE BLOCKING IN FILE DATE BLOCK          CEP13850
       TRA     *+3                                                      CEP13860
 BLKME AXT     23,2           SET POINTER FOR BLOCKING                  CEP13870
       STQ*    BMLOC          SAVE BLOCKING IN FILE DATA BLOCK          CEP13880
       CLA     FIL02,1        MERGE INPUT BLOCK ADDRESS                 CEP13890
       TZE     BLKOT          TEST FOR MERGE INPUT BLOCK                CEP13900
       AXT     5,2            LOCATION POINTER FOR BLOCKSIZE            CEP13910
       STA     BMLOC                                                    CEP13920
 BMLOC CLA     **,2           BLOCKSIZE                                 CEP13930
       TXI     *+1,2,14       LOCATE CHECKSUM-BLOCKSEQUENCE OTION       CEP13940
       NZT*    BMLOC          TEST FOR EITHER OPTION                    CEP13950
       TRA     BMNOT          NO OPTION GIVEN                           CEP13960
       ADD     =1             ADD FOR EFFECTIVE BLOCK LENGTH            CEP13970
       TXI     *+1,2,3        POINTER FOR STORING EFFECTIVE BLOCK LENGTHCEP13980
       STO*    BMLOC          STORE IN FAREA +23                        CEP13990
       SUB     =1                                                       CEP14000
       TRA     BMERG                                                    CEP14010
 BMNOT TXI     *+1,2,3                                                  CEP14020
       STO*    BMLOC          ACTUAL LENGTH = EFFECTIVE LENGTH          CEP14030
 BMERG XCL                                                              CEP14040
       ZAC                                                              CEP14050
       LXA     OSREL,4        COMMON RELOCATION                         CEP14060
       DVP     REC00,4        DIVIDE BY RECORD LENGTH                   CEP14070
       TXI     *+1,1,1        CHANGE NEXT MERGE FILE POINTER            CEP14080
       TZE     BLKME          TEST FOR LENGTH FACTOR OF BLOCKING        CEP14090
       ZET     TYPFV          TEST FOR FIXED OR VARIABLE                CEP14100
       TRA     BLKME+2        VARIABLE                                  CEP14110
       TRA     BLSTL                                                    CEP14120
 BLKOT LXA     OSREL,1        COMMON RELOCATION                         CEP14130
       NZT     FIL01,1                                                  CEP14140
       TRA     CITY+2                                                   CEP14150
       CLA     FIL01,1        ADDRESS OF OUTPUT FILE BLOCK              CEP14160
       AXT     5,2            POINTER FOR BLOCKSIZE                     CEP14170
       STA     BOLOC                                                    CEP14180
 BOLOC CLA     **,2           BLOCKSIZE                                 CEP14190
       TXI     *+1,2,14       LOCATE CHECKSUM BLOCKSEQUENCE             CEP14200
       NZT*    BOLOC          TEST FOR EITHER OPTION                    CEP14210
       TRA     SALT           NO OPTION GIVEN                           CEP14220
       ADD     =1             ADD FOR EFFECTIVE BLOCK LENGTH            CEP14230
       TXI     *+1,2,3        LOCATE AREA IN FILE BLOCK                 CEP14240
       STO*    BOLOC          SAVE EFFECTIVE LENGTH IN FILE BLOCK       CEP14250
       SUB     =1                                                       CEP14260
       TRA     LAKE                                                     CEP14270
 SALT  TXI     *+1,2,3        LOCATE EFFECTIVE LENGTH AREA IN FILE BLOCKCEP14280
       STO*    BOLOC          ACTUAL LENGTH = EFFECTIVE LENGTH          CEP14290
 LAKE  XCL                                                              CEP14300
       ZAC                                                              CEP14310
       DVP     REC02,1        BLOCKSIZE/RECORD LENGTH FROM PHASE 3      CEP14320
       TZE     CITY           IS FACTOR OF BLOCK LENGTH                 CEP14330
       ZET     TYPFV          TEST FOR FIXED OR VARIABLE                CEP14340
       TRA     CITY+2         VARIABLE                                  CEP14350
       STL     BUF24                                                    CEP14360
       STL     DEERR          SET ERROR SWITCH                          CEP14370
       TRA     *+3                                                      CEP14380
 CITY  AXT     23,2           SET POINTER FOR BLOCKING                  CEP14390
       STQ*    BOLOC          SAVE BLOCKING IN OUTPUT FILE DATA BLOCK   CEP14400
       LXA     OSREL,1        COMMON RELOCATION                         CEP14410
       CLA     SAM01,1        MERGE ORDER                               CEP14420
       CAS     SAM02,1        NUMBER OF FILES TO BE MERGES              CEP14430
       TRA     SMFLD                                                    CEP14440
       TRA     SMFLD                                                    CEP14450
       STL     BUF25                                                    CEP14460
       STL     DEERR          SET ERROR SWITCH                          CEP14470
 SMFLD ZET     SSFIE          TEST FOR FIELDS ON SORT CARD              CEP14480
       TRA     SMFIS                                                    CEP14490
       ZET     MSFIE          TEST FOR FIELDS ON MERGE CARDS            CEP14500
       TRA     SMONL                                                    CEP14510
       STL     DEERR          SET ERROR SWITCH                          CEP14520
       STL     BUF26                                                    CEP14530
       TRA     STOP                                                     CEP14540
       DUP     1,9                                                      CEP14550
       PZE                    SORT MERGE TABLE                          CEP14560
 SMTAB BSS     0                                                        CEP14570
       SPACE   5                                                        CEP14580
*                                                                       CEP14590
*  GENERATE CONTROL FIELD EXTRACTION PARAMETERS                         CEP14600
*                                                                       CEP14610
 SMFIS LXA     FIESX,2        NUMBER OF FIELDS                          CEP14620
       TXI     *+1,2,-1                                                 CEP14630
       PXD     ,2                                                       CEP14640
       LXA     OSREL,1        COMMON RELOCATION                         CEP14650
       STD     SAM03,1        SAVE NUMBER OF CONTROL FIELDS TO SORT ON  CEP14660
       CLA     REF00,1        LAST COMMON LOCATION                      CEP14670
       SUB     =1                                                       CEP14680
       STA     SAM03,1        SAVE ADDRESS OF FIELD DESCRIPTIONS        CEP14690
       PAC     ,1             POINTER TO STORE PARAMETERS               CEP14700
 SMFIW AXT     1,4                                                      CEP14710
       CLA     REFST,4        FIELD NUMBER                              CEP14720
       LDI     RESAD,4        ASCENDING-DESCENDING SWITCH               CEP14730
       TXI     *+1,4,1                                                  CEP14740
       SXA     SMFIW,4        SAVE POINTER FOR NEXT GO ROUND            CEP14750
       PAX     ,4             FIELD NUMBER                              CEP14760
       ZET     FIELN,4        TEST FOR A FIELD FOR THIS NUMBER          CEP14770
       TRA     SMWOD                                                    CEP14780
       STL     DEERR          SET ERROR SWITCH                          CEP14790
       STL     BUF26                                                    CEP14800
       TRA     SMPXA                                                    CEP14810
 SMPXA PXA     ,1             COMPLEMENT INDEX REGISTER                 CEP14820
       PAC     ,1             FOR LAST LOCATION USED                    CEP14830
       PXA     ,1             BY COMMON STORAGE                         CEP14840
       LXA     OSREL,1        COMMON RELOCATION                         CEP14850
       STA     REF00,1                                                  CEP14860
       CLA     FLDTT                                                    CEP14870
       NZT     TYPFV          TEST FOR FIXED/VARIABLE                   CEP14880
       NZT     OPT03,1        FIXED, TEST FOR EQUALS OPTION             CEP14890
       TRA     *+2            VARIABLE OR NO EQUALS                     CEP14900
       ADD     =1                                                       CEP14910
       STO     CAL12,1                                                  CEP14920
       ZET     DEERR          TEST FOR ERRORS                           CEP14930
       TSX     HALT,4                                                   CEP14940
       TRA     PROVO         TO TAPE ASSIGNMENTS.                       CEP14950
 SMMTE ZET     MSFIL          TEST FOR FILES TO BE MERGED               CEP14960
       TRA     SMLXA                                                    CEP14970
       STL     BUF22                                                    CEP14980
       STL     DEERR                                                    CEP14990
       TRA     STOP                                                     CEP15000
 SMONL CLA     SMNA1          CHANGE ANALYSIS OF SORT FIELD DEFINER     CEP15010
       STA     SMFIW+1        TO ANALYSIS OF MERGE                      CEP15020
       CLA     SMNA2          FIELD DEFINERS                            CEP15030
       STA     SMFIW+2                                                  CEP15040
       LXA     FIEMX,2        NUMBER OF FIELDS                          CEP15050
       TRA     SMFIS+1                                                  CEP15060
 SMNA1 PZE     REFMT                                                    CEP15070
 SMNA2 PZE     REMTB                                                    CEP15080
       SPACE   5                                                        CEP15090
*                                                                       CEP15100
* SET UP CONTROL FIELDS                                                 CEP15110
*                                                                       CEP15120
 SMWOD CLA     FILSW,4                                                  CEP15130
       ADD     FILNW,4        NUMBER OF WORDS IN CONTROL FIELD          CEP15140
       SUB     =1             LAST WORD IN CONTROL FIELD                CEP15150
       SXA     SMXRA,1                                                  CEP15160
       LXA     OSREL,1        COMMON RELOCATION                         CEP15170
       NZT     TYPFV          TEST FOR FIXED OR VARIABLE                CEP15180
       TRA     *+3            FIXED-DO NOT ADD LENGTH FOR EQUAL-CKSUMS  CEP15190
       ADD     OPT01,1        INCREASE RL BY 1 IF CHECKSUM REQUESTED    CEP15200
       ADD     OPT03,1        ADD EXTRA WORD FOR EQUALS                 CEP15210
       LGR     15             MOVE TO MQ                                CEP15220
       CAL     FILNW,4        NO. OF WORDS IN CF                        CEP15230
       ALS     3                                                        CEP15240
       LGL     15             LAST WORD,,NO. WORDS IN CF                CEP15250
       OFT     =O777777777777 TEST FOR ASCENDING OR DESCENDING          CEP15260
       ORA     =O100000       SET DESCENDING INDICATOR                  CEP15270
       NZT     GEN01,1        TEST FOR BINARY OR BCD                    CEP15280
       TRA     SMBCD          BCD                                       CEP15290
       ZET     FIEUS,4        TEST FOR SIGNED OR UNSIGNED               CEP15300
       ORA     =O200000       SET SIGNED BINARY                         CEP15310
       TRA     SMXRA                                                    CEP15320
 SMBCD ZET     FIEUS,4        TEST FOR SIGNED OR UNSIGNED               CEP15330
       ORA     =O400000       SET SIGNED BCD                            CEP15340
 SMXRA AXT     **,1                                                     CEP15350
       STO     0,1            SAVE WORD IN COMMON                  NO.1 CEP15360
       TXI     *+1,1,1                                                  CEP15370
       CAL     =HP,0000       RQL                                       CEP15380
       ORA     FILSB,4        STARTING BIT                              CEP15390
       SLW     0,1            RQL STARTING BIT                     NO.2 CEP15400
       TXI     *+1,1,1                                                  CEP15410
       SXA     SVXRB,2                                                  CEP15420
       CLA     FILNW,4        NUMBER OF WORDS IN CF                     CEP15430
       PAX     ,2                                                       CEP15440
       TXL     SMLWD,2,1      TEST FOR LAST WORD                        CEP15450
       CAL     =36                                                      CEP15460
       SUB     FILSB,4        STARTING BIT                              CEP15470
       LAS     EZERO          COMPARE EZERO TO 36-SB                    CEP15480
       TRA     SMHIG                                                    CEP15490
       TRA     SMHIG                                                    CEP15500
       ORA     =HPT0000                                                 CEP15510
       SLW     0,1            LGL                                  NO.3 CEP15520
       TXI     *+1,1,1                                                  CEP15530
       STZ     0,1                                                 NO.4 CEP15540
       TXI     *+1,1,1                                                  CEP15550
       ANA     =O777          36-SB                                     CEP15560
       SSM                                                              CEP15570
       ADD     EZERO          CALCULATE NO. BITS LEFT IN AC (NEW EZERO) CEP15580
       STO     EZERO                                                    CEP15590
 SMLAS TXI     *+1,2,-1                                                 CEP15600
       TXL     SMLST,2,1      TEST FOR LAST WORD IN CF                  CEP15610
       LDQ     =HPT0000                                                 CEP15620
       CLS     EZERO                                                    CEP15630
       STA     0,1            SAVE SHIFT BITS                           CEP15640
       SLQ     0,1            LGL  EZERO                           NO.5 CEP15650
       TXI     *+1,1,1                                                  CEP15660
       ADD     =36            36-EZERO                                  CEP15670
       STA     0,1                                                      CEP15680
       SLQ     0,1            LGL 36-EZERO                         NO.6 CEP15690
       TXI     SMLAT,1,1                                                CEP15700
 SMLST STQ     0,1            LGL 0                                NO.5 CEP15710
       TXI     *+1,1,1                                                  CEP15720
       STQ     0,1            LGL 0                                NO.6 CEP15730
       TXI     *+1,1,1                                                  CEP15740
 SMLAT CAL     =36                                                      CEP15750
       LDQ     =HPT0000       LGL                                       CEP15760
       SUB     FILLB,4        LAST BIT                                  CEP15770
       LAS     EZERO          COMPARE EZERO TO                          CEP15780
       TRA     FILSH                                                    CEP15790
       TRA     FILSH                                                    CEP15800
       STA     0,1                                                      CEP15810
       SLQ     0,1            LGL L+1                              NO.7 CEP15820
       TXI     *+1,1,1                                                  CEP15830
       STZ     0,1            NO FINAL SHIFT                       NO.8 CEP15840
       TXI     *+1,1,1                                                  CEP15850
       SSM                                                              CEP15860
       ADD     EZERO          EZERO = EZERO-(L+1)                       CEP15870
       STO     EZERO                                                    CEP15880
       TRA     SMRQL                                                    CEP15890
 FILSH SUB     EZERO                                                    CEP15900
       STA     -1,1                                                     CEP15910
       SLQ     -1,1           LGL L+1-EZERO                        NO.8 CEP15920
       CLA     EZERO                                                    CEP15930
       STA     0,1                                                      CEP15940
       SLQ     0,1            LGL EZERO                            NO.7 CEP15950
       TXI     *+1,1,2                                                  CEP15960
       CAL     =36                                                      CEP15970
       SUB     FILLB,4        L+1                                       CEP15980
       SSM                                                              CEP15990
       ADD     =36                                                      CEP16000
       ADD     EZERO                                                    CEP16010
       STO     EZERO          EZERO = EZERO+36 -(L+1)                   CEP16020
 SMRQL CLA     =30                                                      CEP16030
       SUB     FILLB,4        L-5                                       CEP16040
       ORA     =HP,0000       RQL - FOR SIGNED BCD.  INVALID FOR BINARY CEP16050
       SLW     0,1                                                 NO.9 CEP16060
       TXI     *+1,1,1                                                  CEP16070
 SVXRB AXT     **,2                                                     CEP16080
       CLA     FLDTT          SUM LENGTH OF ALL CONTROL FIELDS          CEP16090
       ADD     FIELN,4                                                  CEP16100
       STO     FLDTT                                                    CEP16110
       STZ     FIELN,4                                                  CEP16120
       TIX     SMFIW,2,1      TEST FOR MORE FILEDS TO PROCESS           CEP16130
       LDQ     FLDTT                                                    CEP16140
       ZAC                                                              CEP16150
       DVP     =36                                                      CEP16160
       TZE     *+4                                                      CEP16170
       XCL                                                              CEP16180
       ADD     =1                                                       CEP16190
       TRA     *+2                                                      CEP16200
       XCL                                                              CEP16210
       SLW     FLDTT                                                    CEP16220
       CLA     EZERO          TEST FOR LAST WORD TO BE STORED           CEP16230
       CAS     =36                                                      CEP16240
       TXI     SMPXA,1,1                                                CEP16250
       TXI     SMPXA,1,1                                                CEP16260
       STA     0,1                                                      CEP16270
       LDQ     =H7X0000                                                 CEP16280
       SLQ     0,1                                                      CEP16290
       TXI     SMPXA,1,1                                                CEP16300
 SMLWD CLA     =36                                                      CEP16310
       SUB     FILLB,4        LAST BIT+1  (L+1)                         CEP16320
       LDQ     =HPT0000                                                 CEP16330
       SUB     FILSB,4        LESS STARTING BIT  (L-SB+1)               CEP16340
       TXI     *+1,1,4                                       NO.3,4,5,6 CEP16350
       CAS     EZERO          SEE IF ENOUGH BITS IN AC TO ACCOMODATE    CEP16360
       TRA     SMBIG                                                    CEP16370
       TRA     SMBIG          GREATER THAN WHATS LEFT                   CEP16380
       LDQ     =HPT0000       LGL                                       CEP16390
       STA     0,1                                                      CEP16400
       SLQ     0,1            LGL L-SB+1                           NO.7 CEP16410
       TXI     *+1,1,1                                                  CEP16420
       STZ     0,1                                                 NO.8 CEP16430
       TXI     *+1,1,1                                                  CEP16440
       SSM                                                              CEP16450
       ADD     EZERO          NEW EZERO = EZERO -(L-SB+1)               CEP16460
       STO     EZERO          SAVE NEW EZERO                            CEP16470
       TRA     SMRQL                                                    CEP16480
 SMBIG SUB     EZERO          L-SB+1-EZERO                              CEP16490
       STA     -1,1                                                     CEP16500
       SLQ     -1,1           LGL L-SB+1-EZERO                     NO.8 CEP16510
       CLA     EZERO                                                    CEP16520
       STA     0,1                                                      CEP16530
       SLQ     0,1            LGL EZERO                            NO.7 CEP16540
       TXI     *+1,1,2                                                  CEP16550
       CAL     1,1                                                      CEP16560
       ANA     =O77                                                     CEP16570
       SSM                                                              CEP16580
       ADD     =36            EZERO= 36- (L-SB+1-EZERO)                 CEP16590
       STA     EZERO                                                    CEP16600
       TRA     SMRQL                                                    CEP16610
 SMHIG LDQ     =HPT0000       LGL                                       CEP16620
       CLA     EZERO                                                    CEP16630
       STA     0,1                                                      CEP16640
       SLQ     0,1            LGL  EZERO                           NO.3 CEP16650
       TXI     *+1,1,1                                                  CEP16660
       CLA     =36                                                      CEP16670
       SUB     FILSB,4                                                  CEP16680
       SUB     EZERO          LGL (36-SB)-EZERO                         CEP16690
       STA     0,1                                                      CEP16700
       SLQ     0,1                                                 NO.4 CEP16710
       TXI     *+1,1,1                                                  CEP16720
       CLA     EZERO          CALCULATE NEW EZERO                       CEP16730
       ADD     FILSB,4                                                  CEP16740
       STA     EZERO          EZERO = EZERO + SB                        CEP16750
       TRA     SMLAS                                                    CEP16760
 EZERO DEC     36                                                       CEP16770
 FLDTT PZE                    TOTAL LENGTH OF ALL FIELDS TO BE SORTED   CEP16780
       EJECT                                                            CEP16790
*                                                                       CEP16800
*  PROCEDURE WHEN ERRORS FOUND IN CONTROL CARDS                         CEP16810
*                                                                       CEP16820
HALT   BSS     0                                                        CEP16830
STOP   BSS     0                                                        CEP16840
       STZ     DEERR                                                    CEP16850
       AXT     60,2                                                     CEP16860
       AXT     1,1                                                      CEP16870
       ZET     BUF+60,2      FIND WHICH ERROR(S)                        CEP16880
       TRA     NZERO         WHERE ENCOUNTERED                          CEP16890
BUMP1  TXI     *+1,1,1       INCREASE                                   CEP16900
       TIX     *-3,2,1       COUNTERS                                   CEP16910
       AXT     60,4                                                     CEP16920
       AXT     60,2                                                     CEP16930
       AXT     -1,1                                                     CEP16940
LOOPC  NZT     BUF+60,2      FIND WHICH ERROR                           CEP16950
       TIX     *-1,2,1       INDICATOR IS SET                           CEP16960
       CLA     BUF+60,2      GET IT                                     CEP16970
       STZ     BUF+60,2      ZERO OUT WHERE IT WAS                      CEP16980
       ZET     BUF+60,4      FIND FIRST ZERO                            CEP16990
       TIX     *-1,4,1       CELL IN BUFFER                             CEP17000
       STO     BUF+60,4      STORE INDICATOR THERE                      CEP17010
       TXI     *+1,4,-1      BUMP                                       CEP17020
       TXI     *+1,1,1       COUNTERS                                   CEP17030
       TIX     LOOPC,2,1     AND CONTINUE                               CEP17040
       AXT     2,4                                                      CEP17050
       AXT     5,2                                                      CEP17060
       TXL     ALTER,1,12    TWELVE WORDS OR LESS                       CEP17070
       TXI     *+1,4,1       NO-BUMP COUNTER                            CEP17080
       TXI     *+1,2,-1                                                 CEP17090
       TIX     *-3,1,12      DECREASE WORD COUNT                        CEP17100
ALTER  SXA     MZE1,4        STORE NUMBER OF ENTRIES                    CEP17110
       PXD     ,1            GET WORD COUNT                             CEP17120
       STD     MZE1+7,2      AND STORE IT                               CEP17130
       CLA     TRA           GET TRANSFER TO END ENTRY LIST             CEP17140
       STO     MZE1+8,2      AND STORE IT                               CEP17150
       TSX     (PROUT,4      PRINT                                      CEP17160
MZE1   MZE     **            ERROR                                      CEP17170
               AMS78,,8+512*4   CODES                                   CEP17180
               BUF,,12       FOUND                                      CEP17190
               BUF+12,,12    TO                                         CEP17200
               BUF+24,,12    BE                                         CEP17210
               BUF+36,,12    SET                                        CEP17220
               BUF+48,,12                                               CEP17230
TRA    TRA     *+1                                                      CEP17240
       TRA     JBDEL                                                    CEP17250
NZERO  PXA     ,1            GET CODE NUMBER                            CEP17260
       TSX     (DECVA,4      CONVERT IT                                 CEP17270
       XCL                                                              CEP17280
       ORA     CCKONT        OR IN CONSTANT                             CEP17290
       SLW     BUF+60,2      AND STORE IT                               CEP17300
       TRA     BUMP1         RETURN                                     CEP17310
CCKONT BCI     1, *E000                                                 CEP17320
BUF    BSS     0                                                        CEP17330
BUF01  PZE                                                              CEP17340
BUF02  PZE                                                              CEP17350
BUF03  PZE                                                              CEP17360
BUF04  PZE                                                              CEP17370
BUF05  PZE                                                              CEP17380
BUF06  PZE                                                              CEP17390
BUF07  PZE                                                              CEP17400
BUF08  PZE                                                              CEP17410
BUF09  PZE                                                              CEP17420
BUF10  PZE                                                              CEP17430
BUF11  PZE                                                              CEP17440
BUF12  PZE                                                              CEP17450
BUF13  PZE                                                              CEP17460
BUF14  PZE                                                              CEP17470
BUF15  PZE                                                              CEP17480
BUF16  PZE                                                              CEP17490
BUF17  PZE                                                              CEP17500
BUF18  PZE                                                              CEP17510
BUF19  PZE                                                              CEP17520
BUF20  PZE                                                              CEP17530
BUF21  PZE                                                              CEP17540
BUF22  PZE                                                              CEP17550
BUF23  PZE                                                              CEP17560
BUF24  PZE                                                              CEP17570
BUF25  PZE                                                              CEP17580
BUF26  PZE                                                              CEP17590
BUF27  PZE                                                              CEP17600
BUF28  PZE                                                              CEP17610
BUF29  PZE                                                              CEP17620
BUF30  PZE                                                              CEP17630
BUF31  PZE                                                              CEP17640
BUF32  PZE                                                              CEP17650
BUF33  PZE                                                              CEP17660
BUF34  PZE                                                              CEP17670
BUF35  PZE                                                              CEP17680
BUF36  PZE                                                              CEP17690
BUF37  PZE                                                              CEP17700
BUF38  PZE                                                              CEP17710
BUF39  PZE                                                              CEP17720
BUF40  PZE                                                              CEP17730
BUF41  PZE                                                              CEP17740
BUF42  PZE                                                              CEP17750
BUF43  PZE                                                              CEP17760
BUF44  PZE                                                              CEP17770
BUF45  PZE                                                              CEP17780
BUF46  PZE                                                              CEP17790
BUF47  PZE                                                              CEP17800
BUF48  PZE                                                              CEP17810
BUF49  PZE                                                              CEP17820
BUF50  PZE                                                              CEP17830
BUF51  PZE                                                              CEP17840
BUF52  PZE                                                              CEP17850
BUF53  PZE                                                              CEP17860
BUF54  PZE                                                              CEP17870
BUF55  PZE                                                              CEP17880
BUF56  PZE                                                              CEP17890
BUF57  PZE                                                              CEP17900
BUF58  PZE                                                              CEP17910
BUF59  PZE                                                              CEP17920
K0     PZE     0                                                        CEP17930
       SPACE   5                                                        CEP17940
*                                                                       CEP17950
*  GIVE CONTROL TO CALCULATION SUB-PROGRAM                              CEP17960
*                                                                       CEP17970
 CALCU LXA     OSREL,1        COMMON RELOCATION                         CEP17980
       LXA     EP002,2        TRANSFER POINT FOR SMON                   CEP17990
       CAL     HYPSW         NZ IF HYPERS HAVE BEEN ASSIGNED.           CEP18000
       CALL    CALC           GO TO CALCULATION ROUTINE                 CEP18010
       TRA     JBDEL         DELETE THE SORT.                        (2)CEP18020
       LXA     OSREL,1                                                  CEP18030
       NZT     SAM04,1                                                  CEP18040
       TRA     MERPR         PRINT MERGE TAPE ASSIGNMENTS.              CEP18050
       TRA     ASPRI         PRINT SORT TAPE ASSIGNMENTS.               CEP18060
       EJECT                                                            CEP18070
*                                                                       CEP18080
* OPTION CARDS PRINT ON LINE ROUTINE                                    CEP18090
*                                                                       CEP18100
PRINT  SXA     PB004,4                                                  CEP18110
       ZET     PBSWH           SET SWITCH TO ALLOW PRINT ONCE ONLY      CEP18120
       TRA     1,4                                                      CEP18130
       STL     PBSWH                                                    CEP18140
       AXT     MXTAB-STADD,4   GET THE NO. OF DIFFERENT TYPE OF STATEMTSCEP18150
 PBAGN ZET*    MXTAB,4         ZERO CHECK                               CEP18160
       TRA     PBHRE           NON ZERO                                 CEP18170
       TIX     *-2,4,1                                                  CEP18180
       ZET     NOEND         IF THERE WAS NO END CARD,                  CEP18190
       TRA     DNTPRT         DO NOT PRINT IT.                          CEP18200
       TSX     MSGSUP,4,32                                              CEP18210
       PZE     1                                                        CEP18220
       PZE     PEND,,1                                               (4)CEP18230
DNTPRT BSS     0                                                        CEP18240
       TSX     MSGSUP,4,32                                              CEP18250
       PZE     1                                                        CEP18260
       PZE     **,,512*4       SPACE TWO  LINES                         CEP18270
 PB004 AXT     **,4                                                     CEP18280
       TRA     1,4             EXIT OF THIS ROUTINE                     CEP18290
 PBHRE SXA     PBTYP,4                                                  CEP18300
       CLA*    MXTAB,4                                                  CEP18310
       STA     PBSTA           STORE THE NO. OF STATEMENT               CEP18320
       CLA     MXTAB,4                                                  CEP18330
 PBSEC ADD     =O1            POINTER OF THE LOCATION OF STATN.         CEP18340
       STA     PBTEM                                                    CEP18350
       CLA*    PBTEM                                                    CEP18360
       STO     PBPIN           STORE THE NO. OF CARDS AND LOCATION      CEP18370
       LXD     PBPIN,2         NO. OF CARDS IN XR2                      CEP18380
       LXA     PBPIN,1         LOCATION OF FIRST STATMNT IN XR1         CEP18390
 PBBAK SXA     PBLOC,1                                                  CEP18400
       TSX     MSGSUP,4,32                                              CEP18410
       PZE     1                                                        CEP18420
PBLOC  PZE     **,,11                                                   CEP18430
       TXI     *+1,1,11        STEP UP LOCATION COUNTER                 CEP18440
       TIX     PBBAK,2,1       IS THIS THE LAST CARD                    CEP18450
       TSX     MSGSUP,4,32                                              CEP18460
       PZE     1               BETWEEN                                  CEP18470
       PZE     0,,0            EACH STATEMENT                           CEP18480
       LXA     PBSTA,4         YES                                      CEP18490
       TIX     PBNEX,4,1       LAST STATEMENT                           CEP18500
       LXA     PBTYP,4         YES                                      CEP18510
       TXI     PBAGN,4,-1      LOOK FOR NEXT TYPE OF STATEMENT          CEP18520
 PBNEX SXA     PBSTA,4         SAVE NO OF STATEMENTS COUNTER            CEP18530
       CLA     PBTEM           FIND OUT THE LOCATION NEXT STATEMENT     CEP18540
       TRA     PBSEC                                                    CEP18550
PEND   BCI     1,END                                                 (4)CEP18555
 PBSTA PZE                                                              CEP18560
 PBPIN PZE                                                              CEP18570
 PBTYP PZE                                                              CEP18580
 PBTEM PZE                                                              CEP18590
 PBSWH PZE                                                              CEP18600
 PBAAA PZE                                                              CEP18610
       EJECT                                                            CEP18620
*                                                                       CEP18630
*  TEST FOR CHECKPOINT ATTACHED                                         CEP18640
*                                                                       CEP18650
 PROVO LXA     OSREL,1                                                  CEP18660
       LXA     SYSCK2,4      TRANSFER IF NO                             CEP18670
       TXL     STATE,4,0      SYSCK2 ATTACHED.                          CEP18680
       LDI*    SYSCK2                                                   CEP18690
       LFT     20000                                                    CEP18700
       STL     HYPSW                                                    CEP18710
       TRA     ASSGN                                                    CEP18720
 STATE NZT     OPT07,1                                                  CEP18730
       TRA     HERE                                                     CEP18740
       TSX     MSGSUP,4,2                                               CEP18750
               1                                                        CEP18760
               AM102,,4+512*4                                           CEP18770
       STL     CHA05,1                                                  CEP18780
HERE   CLA     =1                                                       CEP18790
       STA     OPT02,1                                                  CEP18800
       TRA     ASSGN                                                    CEP18810
       SPACE   5                                                        CEP18820
*                                                                       CEP18830
*  ASSIGNMENT OF TAPE UNITS FOR SORT                                    CEP18840
*                                                                       CEP18850
 ASSGN LXA     OSREL,1        COMMON RELOCATION                         CEP18860
       ZET     SAM04,1                                                  CEP18870
       TRA     SRTMRG                                                (5)CEP18880
       TRA     ASMGG         MERGE ASSIGNMENTS, OUTPUT PUNCHED.         CEP18900
SRTMRG AXT     0,2                                                   (5)CEP18920
       CLA*    CHA00,1        FIRST UNIT TO BE REQUESTED                CEP18930
       TZE     ASUTS           TEST FOR UNIT GIVEN                      CEP18940
       ANA     =O77000000     MASK OUT UNIT                             CEP18950
       PDX     ,2                                                       CEP18960
       TXH     ASINE,2,24     TEST FOR INTER-SYSTEM COMMUNICATION       CEP18970
 ASRET CLA     FIL00,1        SORT INPUT FILE BLOCK                     CEP18980
       TZE     ASINP           TEST FOR INPUT FILE TO SORT GIVEN        CEP18990
       SUB     =15                                                      CEP19000
       STA     *+1                                                      CEP19010
       LXA     **,4           NUMBER OF INPUT REELS                     CEP19020
       CLA     CHA00,1                                                  CEP19030
       STO     ASCS2          SAVE IN CALLING SEQUENCE                  CEP19040
       TXL     ASCS1,4,1      TRANSFER IF ONLY ONE REEL OF INPUT.       CEP19050
       PDX     ,4             NUMBER OF UNITS REQUESTED IN CONTROL CARDSCEP19060
       TXH     ASCS1,4,1      TEST FOR MORE THAN ONE UNIT REQUESTED     CEP19070
       ADD     =O1000000                                                CEP19080
       STO     CHA00,1                                                  CEP19090
       STO     ASCS2                                                    CEP19100
       PAX     ,2                                                       CEP19110
       TXI     *+1,2,-1       CHANGE ADDRESS TO STORE NEXT REQUEST      CEP19120
       SXA     *+3,2                                                    CEP19130
       AXT     0,2                                                      CEP19140
       CAL*    CHA00,1        WORD TO BE ASSIGNED.                      CEP19150
       SLW     **             SAVE IN SECOND POSTION                    CEP19160
 ASCS1 TSX     ASSIGN,4       ASSIGN INPUT TO SORT.                     CEP19170
 ASCS2 PZE     **,,**                                                   CEP19180
       TRA     ASNEN                                                    CEP19190
       TRA     *+1                                                      CEP19200
       TRA     ASNCH          TO ASSIGNMENT OF MERGE TAPES              CEP19210
 ASUTS NZT     INUTW           IF IMPTA IS ZERO CHECK SYSUT SWITCH      CEP19220
       TRA     ASERR           HAS BEEN SET'''OTHERWISE IT IS AN ERROR  CEP19230
       CLA     CHA00,1         GET THE LOCATION OF THE TABLE            CEP19240
       STA     ASUAD                                                    CEP19250
       STA     ASUAE                                                    CEP19260
       STA     ASUAG                                                    CEP19270
       AXT     4,2             LOOK                                     CEP19280
 ASUNX CLA     INUTE,2               UP THE TABLE                       CEP19290
       TZE     ASUNA                     TO SEE                         CEP19300
       CLA*    INUTE,2               WHERE ARE THEY                     CEP19310
       ANA     =O77777                                                  CEP19320
       TZE     ASUNA                                                    CEP19330
       STA     *+1              STORE THE ADDRESS OF THE UCW            CEP19340
       CLA     **                 GET THE FIRST WORD OF UCW             CEP19350
       ANA     =O17000000000   CHECK  THIS UNIT BEEN DETTACHED          CEP19360
       NZT     ASUCH           CONTROL FOR SAME CHANNEL                 CEP19370
       STO     ASUCH                                                    CEP19380
       ERA     ASUCH                                                    CEP19390
       TNZ     ASUER            DIFFERENT CHANNELS GIVEN IN SYSUTX      CEP19400
 ASUNA TIX     ASUNX,2,1         IF SAME CHANNEL    LOOK THE NEXT ONE   CEP19410
       NZT     ASURR           IS THERE ANY ERROR FOUND                 CEP19420
       TRA     *+2             NO ERROR SO FAR                          CEP19430
       TRA     ASNCH           ERROR, GO TO ASSIGN MERGE TAPE           CEP19440
       AXT     0,2                                                      CEP19450
       AXT     4,4                                                      CEP19460
 ASURP CLA     INUTE,4                                                  CEP19470
       TZE     ASUNN                                                    CEP19480
       CLA*    INUTE,4         CHECK SYSUT TAPES BEEN                   CEP19490
       ANA     =O77777               DETACHED OR NOT                    CEP19500
       TZE     ASUNN             IF THAT TAPE BEEN DETACHED             CEP19510
 ASUAD STA     **,2            PUT THE ADDRESS INTO LIST                CEP19520
       STA     ASUAF                                                    CEP19530
       CAL     INUTE,4         EDIT THE RELEASE BIT                     CEP19540
 ASUAG STP     **,2            INTO THE LIST                            CEP19550
       LDI*    ASUAF                                                    CEP19560
       LFT     20000                                                    CEP19570
       STL     HYPSW                                                    CEP19580
 ASUAF CLA     **              GET THE IST WORD OF UCB                  CEP19590
       ANA     =O17000000000   GET THE CHANNEL DESIGNATOR               CEP19600
       ARS     9                                                        CEP19610
 ASUAE ORS     **,2            EDIT INTO THE LIST                       CEP19620
       TXI     *+1,2,1           COUNT ONE                              CEP19630
 ASUNN TIX     ASURP,4,1                                                CEP19640
       PXD     ,2             GET THE NUMBER OF ENTRIES INTO            CEP19650
       STD     CHA00,1             TABLE                                CEP19660
       TRA     ASNCH                                                    CEP19670
ASUER  STL     BUF05                                                    CEP19680
       STL     DEERR                                                    CEP19690
       STL     ASURR                                                    CEP19700
       CLA     *+2                                                      CEP19710
       STO     ASUER                                                    CEP19720
       TRA     ASUNA                                                    CEP19730
 ASURR PZE                     ERROR INDICATOR                          CEP19740
 ASUCH PZE                     TEMPORARY STORAGE FOR CHANNEL            CEP19750
       SPACE   2                                                        CEP19760
*                                                                       CEP19770
*  ASSIGNMENT OF INTERSYSTEM COMMUNICATION UNITS                        CEP19780
*                                                                       CEP19790
 ASINE CLA     CHA00,1                                                  CEP19800
       STO     ASCS4                                                    CEP19810
       TSX     ASSIGN,4       ASSIGN INTERSYSTEM UNITS.                 CEP19820
 ASCS4 PZE     **,,**                                                   CEP19830
       TRA     *+2                                                      CEP19840
       TRA     ASINT          NO INTERSYSTEM COMMUNICATION FOUND        CEP19850
       EJECT                                                            CEP19860
*                                                                       CEP19870
*  ASSIGNMENT OF MERGE TAPES                                            CEP19880
*                                                                       CEP19890
 ASNCH CLA     CHA02,1         SET UP                                   CEP19900
       STA     ASNLC             CALLING SEQUENCE                       CEP19910
       CLA     SAM01,1             FOR ASSIGN ROUTINE                   CEP19920
       ALS     18                                                       CEP19930
       STD     CHA02,1       PLACE THE ORDER OF MERGE                   CEP19940
       STD     ASNLC           IN DEC. OF CHAPR-2                       CEP19950
       PDX     ,4                                                       CEP19960
       TXI     *+1,4,-1                                                 CEP19970
       SXD     ASNAA,4                                                  CEP19980
       CLA     ASNLC                                                    CEP19990
       STO     ASOAC-1                                                  CEP20000
       TSX     ASSIGN,4                                                 CEP20010
 ASNLC PZE     **,,**        LOCATION OF LIST,,LENGTH OF LIST           CEP20020
       TRA     ASOAB           NOT ENOUGH UNIT THIS CHANNEL             CEP20030
       TRA     *+1             NO INTER SYSTEM COMMUNICATION FOUND      CEP20040
 ASOAA CLA     CHA03,1         SET UP                                   CEP20050
       STA     ASULL             CALLING SEQUENCE                       CEP20060
       CLA     SAM01,1             FOR ASSIGN ROUTINE                   CEP20070
       ALS     18                                                       CEP20080
       STD     CHA03,1         PLACE THE ORDER OF MERGE IN THE DEC      CEP20090
       STD     ASULL           OF CHAPR-3                               CEP20100
       CLA     ASULL                                                    CEP20110
       STO     ASOAF-1                                                  CEP20120
       TSX     ASSIGN,4                                                 CEP20130
 ASULL PZE     **,,**          LOCATION OF LIST,,LENGTH OF LIST         CEP20140
       TRA     ASOBB                                                    CEP20150
       TRA     LAAA            NO INTER SYSTEM COMMUNICATION            CEP20160
       TRA     LAAA            NORMAL RETURN TO ASSIGN OF OUTPUT UNIT   CEP20170
 ASOAB ZET     MARSW           CHECK SYSUT TAPES SPECIFIED              CEP20180
       TRA     ASNMA           IF YES, GO TO ASSIGN MORE UNIT           CEP20190
       TRA     ASOAC                                                    CEP20200
       PZE                                                              CEP20210
 ASOAC TSX     ASMND,4         IF NOT, GO TO ASSIGN MORE FROM INPUT     CEP20220
       TRA     ASOAA                                                    CEP20230
       TRA     ASOAA           TO ASSIGN OTHER MERGE CHANNEL            CEP20240
 ASNMA STA     ASNCT           SAVE THE NO. OF UNIT REQUIRED            CEP20250
       SSP                     SET SIGN PLUS                            CEP20260
       CLA     CHA02,1                                                  CEP20270
       STA     ASNUP                                                    CEP20280
       TRA     ASNMG           SAVE THE NO. OF UNIT REQUIRED            CEP20290
 ASOBB ZET     MARSW                                                    CEP20300
       TRA     ASNMB                                                    CEP20310
       TRA     ASOAF                                                    CEP20320
       PZE                                                              CEP20330
 ASOAF TSX     ASMND,4         IF NOT, GO TO ASSIGN MORE FROM INPUT     CEP20340
       TRA     LAAA                                                     CEP20350
       TRA     LAAA                                                     CEP20360
 ASNMB STA     ASNCT           SAVE THE NO. OF UNIT NEEDED              CEP20370
       SSP                     SET SIGN PLUS                            CEP20380
       CLA     CHA03,1                                                  CEP20390
       STA     ASNUP                                                    CEP20400
       CLA     ASNUU                                                    CEP20410
       STO     ASNNN                                                    CEP20420
       CLA     ASOBB+2                                                  CEP20430
       STO     ASNGG                                                    CEP20440
       STO     ASNUJ-1                                                  CEP20450
       CLA     ASOAF+1                                                  CEP20460
       STO     ASNAA+1         SET THE EXIT LINE TO  LAAA               CEP20470
       TRA     ASNMG                                                    CEP20480
 ASNMG AXT     1,2                                                      CEP20490
       AXT     4,4                                                      CEP20500
       CLA     INUTE,4                                                  CEP20510
       ANA     =O77777                                                  CEP20520
       TZE     ASNME           SAME CHANNEL                             CEP20530
 ASNMC TIX     *-3,4,1                                                  CEP20540
       TXH     ASNMD,2,1                                                CEP20550
 ASNGG TRA     ASOAC                                                    CEP20560
 ASNME CLA     INUTD,4                                                  CEP20570
       STA     ASNTB,2                                                  CEP20580
       TXI     ASNMC,2,1                                                CEP20590
 ASNMD CLA     SAM01,1         PUT THE LOCATION OF UT TAPES INTO LIST   CEP20600
       SUB     ASNCT                                                    CEP20610
       STA     *+1                                                      CEP20620
       AXT     **,4            NO. OF UNIT ALREADY ASSIGNED             CEP20630
       TXI     *+1,2,-1        ADJUST THE NUMBER OF SYSUT UNITS FOUND   CEP20640
 ASNMF CLA*    ASNTB,2                                                  CEP20650
       STA     *+1                                                      CEP20660
       CLA     **                                                       CEP20670
       ANA     =O17000000000                                            CEP20680
       ARS     27                                                       CEP20690
 ASNNN ERA     CHANM-2                                                  CEP20700
       TZE     ASNUJ           SAME CHANNEL                             CEP20710
 ASULS TIX     ASNMF,2,1                                                CEP20720
       CLA     ASNCT           FIND OUT HOW MANY UNIT BEEN ASSIGNED     CEP20730
       TRA     ASOAC           GO TO ASSIGN MORE TAPES FROM INPUT       CEP20740
 ASNUJ CLA*    ASNTB,2                                                  CEP20750
 ASNUP STA     **,4                                                     CEP20760
       CLA     ASNCT           UPDATE                                   CEP20770
       SUB     =1              THE                                      CEP20780
       STO     ASNCT           COUNTER                                  CEP20790
       TXI     *+1,4,1                                                  CEP20800
 ASNAA TXL     ASULS,4,**                                               CEP20810
       TRA     ASOAA                                                    CEP20820
 ASNUU ERA     CHANM-1                                                  CEP20830
 ASNCT PZE                                                              CEP20840
       PZE                     SYSUT                                    CEP20850
       PZE                       ENTRIES                                CEP20860
       PZE                         STORED                               CEP20870
       PZE                           IN THIS TABLE                      CEP20880
 ASNTB BSS     1                                                        CEP20890
       EJECT                                                            CEP20900
*                                                                       CEP20910
*  ASSIGNMENT OF OUTPUT CHANNEL                                         CEP20920
*                                                                       CEP20930
 LAAA  NZT     CHA01,1         TEST FOR OUTPUT CHANNEL                  CEP20940
       TRA     ASURD                                                    CEP20950
       ZET     SWIJQ          TEST FOR SYMBOLIC OUTPUT                  CEP20960
       TRA     ASURD                                                    CEP20970
       ZET     CHAOM          TEST FOR OUTPUT EQUAL TO MERGE CHANNEL    CEP20980
       TRA     LABBA                                                    CEP20990
       CLA     =O2200000      NUMBER OF UNITS TO BE ASSIGNED FOR OUTPUT CEP21000
       ORS     CHA01,1                                                  CEP21010
       CLA     CHA01,1                                                  CEP21020
       STO     LABB                                                     CEP21030
       STL     LBAD                                                     CEP21040
       TSX     ASSIGN,4       ASSIGN OUTPUT UNITS.                      CEP21050
 LABB  PZE     **,**           LOCATION OF LIST AND ITS LENGTH          CEP21060
       TRA     LBAA            NOT ENOUGH UNIT THIS CHANNEL             CEP21070
       TRA     ASURD           NO INTRASYSTEM COMMUNICATION FOUND       CEP21080
       TRA     ASURD           NORMAL RETURN                            CEP21090
 LABBA CAL     SAM01,1         PUT THE ORDER OF MERGE                   CEP21100
       ALS     18              INTO THE DECREMENT                       CEP21110
       STD     CHA01,1         OF CHAPR-1                               CEP21120
       TRA     ASURD                                                    CEP21130
 LBAA  PAX     ,4             NUMBER OF UNITS STILL NEEDED.             CEP21140
       TXH     LBAC,4,1       NO UNITS HAVE BEEN ASSIGNED.              CEP21150
       CAL     =O1000000      IF ONE UNIT HAS BEEN ASSIGNED,            CEP21160
       STD     CHA01,1         RESET NUMBER TO ONE.                     CEP21170
       TRA     ASURD                                                    CEP21180
 LBAC  CAL*    CHA01,1        NO UNITS HAVE BEEN ASSIGNED.              CEP21190
       ANA     =O77000000      OUTPUT CHANNEL                           CEP21200
       SLW     LBAB                                                     CEP21210
       CAL*    CHA00,1         INPUT CHANNEL                            CEP21220
       ANA     =O77000000                                               CEP21230
       ERA     LBAB            CHECK FOR SAME CHANNEL                   CEP21240
       TZE     LBCK            SAME CHANNEL                             CEP21250
LBHI   STL     BUF27                                                    CEP21260
       LXA     OSREL,1                                                  CEP21270
       STZ     CHA01,1                                                  CEP21280
       TRA     ASURD                                                    CEP21290
  LBCK CAL     CHA00,1         INPUT AND OUTPUT HAS SAME CHANNEL        CEP21300
       STA     *+3                                                      CEP21310
       STA     *+5                                                      CEP21320
       PDX     ,2             NUMBER OF ENTRIES                         CEP21330
       CAL     **                                                       CEP21340
       ANA     =O200000000000  CHECK FOR RESERVE BIT                    CEP21350
       TZE     LBCS            TO ASSIGN UNIT                           CEP21360
       CAL     **                                                       CEP21370
       ANA     =O100000000000                                           CEP21380
       TZE     LBCS                                                     CEP21390
       TRA     LBHI                                                     CEP21400
  LBCS CAL     LABB            RESTORE THE CALLING SEQUENCE             CEP21410
       SXA     ASCNT,4                                                  CEP21420
       STO     *+2                                                      CEP21430
       TRA     *+2                                                      CEP21440
       PZE     **,**                                                    CEP21450
       TSX     ASMND,4                                                  CEP21460
       TRA     ASURD                                                    CEP21470
  LBAB PZE                                                              CEP21480
  LBAD PZE                                                              CEP21490
       SPACE   2                                                        CEP21500
*                                                                       CEP21510
*  SWITCH CHANNELS SO OUTPUT IS ON A DIFFERENT CHANNEL THAN INPUT       CEP21520
*                                                                       CEP21530
 ASURD LXA     OSREL,1        COMMON RELOCATION                         CEP21540
       NZT     SAM04,1        TEST FOR SORT ONLY                        CEP21550
       TRA     CHAMR          MERGE ONLY                                CEP21560
       AXT     0,2                                                      CEP21570
       CAL*    CHA00,1        INPUT UNIT                                CEP21580
       STA     *+1                                                      CEP21590
       CAL     **             INPUT UNIT                                CEP21600
       ANA     =O17000000000  MASK OUT CHANNEL                          CEP21610
       SLW     ASCHA                                                    CEP21620
       CAL*    CHA02,1        OUTPUT FOR INTERNAL SORT                  CEP21630
       STA     *+1                                                      CEP21640
       CAL     **             OUTPUT FOR INTERNAL SORT                  CEP21650
       ANA     =O17000000000  MASK OUT CHANNEL                          CEP21660
       ERA     ASCHA                                                    CEP21670
       TNZ     *+5            TEST FOR OUTPUT AND INPUT THE SAME        CEP21680
       CAL     CHA02,1        SWITCH SO OUTPUT IS                       CEP21690
       LDQ     CHA03,1        ON THE OPPOSITE CHANNEL                   CEP21700
       SLW     CHA03,1                                                  CEP21710
       STQ     CHA02,1                                                  CEP21720
       ZET     DEERR                                                    CEP21730
       TSX     HALT,4                                                   CEP21740
       TRA     CALCU                                                    CEP21750
       EJECT                                                            CEP21760
*                                                                       CEP21770
*  PRINT TAPES USED FOR INPUT AND MERGE                                 CEP21780
*                                                                       CEP21790
ASPRI  LXA     OSREL,1                                                  CEP21800
       CLA     OSTAP                                                    CEP21810
       STO     OPT09,1                                                  CEP21820
       TSX     MSGSUP,4,16                                              CEP21830
       PZE     1                                                        CEP21840
               AM144,,6+512*4                                           CEP21850
       CLA     CHA00,1        ADDRESS OF INPUT UNITS                    CEP21860
       PDX     ,2             NUMBER OF INPUT UNITS                     CEP21870
       STA     *+2                                                      CEP21880
       AXT     0,1                                                      CEP21890
 ASPRT LDQ*    **,1           FIRST UNIT CONTROL WORD                   CEP21900
       CLA*    ASPRT                                                    CEP21910
       TMI     ASMIN                                                    CEP21920
       TSX     MSGSUP,4,17   PRINT ASSIGNED INPUT UNITS                 CEP21930
       PZE     AMS75,,2                                                 CEP21940
       TRA     ASEND                                                    CEP21950
 ASMIN BSS     0                                                        CEP21960
       TSX     MSGSUP,4,17   PRINT UNIT NOT READY                       CEP21970
       PZE     AMS75,,7                                                 CEP21980
       CAL     =O377777777777                                           CEP21990
       ANS*    ASPRT                                                    CEP22000
 ASEND BSS     0                                                        CEP22010
       TXI     *+1,1,1                                                  CEP22020
       TIX     ASPRT,2,1                                                CEP22030
       LXA     OSREL,1        COMMON RELOCATION                         CEP22040
       CLA     CHA02,1        ADDRESS OF MERGE TAPES                    CEP22050
       STA     *+4                                                      CEP22060
       CLA     SAM01,1        MERGE ORDER                               CEP22070
       PAX     ,2                                                       CEP22080
       AXT     0,1                                                      CEP22090
 ASMPR LDQ*    **,1           FIRST UNIT CONTROL WORD                   CEP22100
       CLA*    ASMPR                                                    CEP22110
       TMI     ASMN1                                                    CEP22120
       TSX     MSGSUP,4,17   PRINT ASSIGNED MERGE UNITS                 CEP22130
       PZE     AMS76,,2                                                 CEP22140
       TRA     ASND1                                                    CEP22150
 ASMN1 BSS     0                                                        CEP22160
       TSX     MSGSUP,4,17                                              CEP22170
       PZE     AMS76,,7                                                 CEP22180
       CAL     =O377777777777                                           CEP22190
       ANS*    ASMPR                                                    CEP22200
 ASND1 BSS     0                                                        CEP22210
       TXI     *+1,1,1                                                  CEP22220
       TIX     ASMPR,2,1                                                CEP22230
       LXA     OSREL,1        COMMON RELOCATION                         CEP22240
       CLA     CHA03,1                                                  CEP22250
       STA     *+4                                                      CEP22260
       CLA     SAM01,1                                                  CEP22270
       PAX     ,2             MERGE ORDER                               CEP22280
       AXT     0,1                                                      CEP22290
 ASPRM LDQ*    **,1           UCW1                                      CEP22300
       CLA*    ASPRM                                                    CEP22310
       TMI     ASMN2                                                    CEP22320
       TSX     MSGSUP,4,17   PRINT ASSIGNED MERGE UNITS                 CEP22330
       PZE     AMS76,,2                                                 CEP22340
       TRA     ASND2                                                    CEP22350
 ASMN2 BSS     0                                                        CEP22360
       TSX     MSGSUP,4,17                                              CEP22370
       PZE     AMS76,,7                                                 CEP22380
       CAL     =O377777777777                                           CEP22390
       ANS*    ASPRM                                                    CEP22400
 ASND2 BSS     0                                                        CEP22410
       TXI     *+1,1,1                                                  CEP22420
       TIX     ASPRM,2,1                                                CEP22430
       NZT     LBAD                                                     CEP22440
       TRA     ASND4                                                    CEP22450
       LXA     OSREL,1                                                  CEP22460
       CLA     CHA01,1                                                  CEP22470
       STA     ASOPR                                                    CEP22480
       PDX     ,2                                                       CEP22490
       AXT     0,1                                                      CEP22500
 ASOPR LDQ*    **,1                                                     CEP22510
       CLA*    ASOPR                                                    CEP22520
       TMI     ASMN3                                                    CEP22530
       TSX     MSGSUP,4,17    PRINT ASSIGNED OUTPUT UNITS.              CEP22540
       PZE     AMS77,,3                                                 CEP22550
       TRA     ASND3                                                    CEP22560
 ASMN3 TSX     MSGSUP,4,17                                              CEP22570
       PZE     AMS77,,7                                                 CEP22580
       CAL     =O377777777777                                           CEP22590
       ANS*    ASOPR                                                    CEP22600
 ASND3 TXI     *+1,1,1                                                  CEP22610
       TIX     ASOPR,2,1                                                CEP22620
 ASND4 LXA     SYSCK2,1       TEST FOR CHECKPOINT TAPE.                 CEP22630
       TXL     END,1,0                                                  CEP22640
       LDQ*    SYSCK2                                                   CEP22650
       TSX     MSGSUP,4,17   PRINT CHECKPOINT TAPE.                     CEP22660
               AM113,,3                                                 CEP22670
       TRA     END                                                      CEP22680
       SPACE   2                                                        CEP22690
*                                                                       CEP22700
*  ASSIGNMENT OF MERGE TAPES ONLY                                       CEP22710
*                                                                       CEP22720
 ASMGG ZET     INUTW         ARE UTILITY TAPES GIVEN FOR INPUT.         CEP22730
       TRA     ASMRU          UTILITY GIVEN AS INPUT                    CEP22740
       ZET     INPOJ          TEST FOR INTER-SYSTEM                     CEP22750
       TRA     ASMRI          INTER-SYSTEM                              CEP22760
       ZET     INUNO          TEST FOR NUMBERS                          CEP22770
       TRA     ASMRN          NUMBERS                                   CEP22780
       CAL     CHA00,1                                                  CEP22790
       LDQ*    CHA00,1        CHANNEL DESIGNATION IN DECREMENT          CEP22800
       ORA     =O200000       TAG OF 2                                  CEP22810
       SLW     CHA00,1                                                  CEP22820
       STA     *+3                                                      CEP22830
       AXT     0,2                                                      CEP22840
       AXT     10,4                                                     CEP22850
       STQ     **,2           SAVE IN INPUT TABLE                       CEP22860
       TXI     *+1,2,1                                                  CEP22870
       TIX     *-2,4,1                                                  CEP22880
       CAL     SAM01,1        MERGE ORDER                               CEP22890
       ALS     18                                                       CEP22900
       STD     CHA00,1                                                  CEP22910
       CAL     CHA00,1        CALLING SEQUENCE FOR ASSIGN               CEP22920
       SLW     *+2                                                      CEP22930
       TSX     ASSIGN,4       ASSIGN TAPES FOR INPUT TO MERGE.          CEP22940
       PZE                                                              CEP22950
       TRA     ASNEN          NOT ENOUGH INPUT TAPES                    CEP22960
       TRA     *+1                                                      CEP22970
       TRA     ASMRO          TO ASSIGNMENT OF MERGE OUTPUT TAPES       CEP22980
       EJECT                                                            CEP22990
*                                                                       CEP23000
*  MERGE INPUT ON UTILITY TAPES                                         CEP23010
*                                                                       CEP23020
 ASMRU AXT     4,2                                                      CEP23030
       AXT     0,4                                                      CEP23040
       CLA     CHA00,1        ADDRESS OF INPUT UNITS                    CEP23050
       STA     ASMRS                                                    CEP23060
       STA     ASMR                                                  (5)CEP23061
 ASMRV CLA     INUTE,2        TEST FOR THIS UTILITY TAPE                CEP23070
       TZE     ASMRT          NOT REQUESTED                             CEP23080
       CLA*    INUTE,2                                                  CEP23090
       ANA     =O77777        LOCATION OF ATTACHED UNIT                 CEP23100
       TZE     ASMRR          TEST FOR UNIT ATTACHED                    CEP23110
       STA     *+1                                                      CEP23120
       CLA     **                                                       CEP23130
       ANA     =O17000000000  CHANNEL                                   CEP23140
       NZT     ASUCH          TEST IF FIRST UNIT ALREADY FOUND          CEP23150
       STO     ASUCH          SAVE FIRST UNIT GIVEN                     CEP23160
       ERA     ASUCH          TEST FOR ON THE SAME CHANNEL              CEP23170
       TNZ     ASMRE                                                    CEP23180
       CLA*    INUTE,2                                                  CEP23190
 ASMRS STA     **,4                                                     CEP23200
       STA     *+1                                                   (5)CEP23201
       CLA     **             GET FIRST WORD OF UCB                  (5)CEP23203
       ANA     =O17000000000  CHANNEL DESIGNATION                    (5)CEP23205
       ARS     9                                                     (5)CEP23207
ASMR   ORS     **,4           EDIT INTO LIST                         (5)CEP23209
       TXI     *+1,4,1                                                  CEP23210
 ASMRT TIX     ASMRV,2,1                                                CEP23220
       PXD     ,4             NUMBER OF UTILITY UNITS                   CEP23230
       STD     CHA00,1        SAVE IN COMMON CELL                       CEP23240
       PXA     ,4                                                       CEP23250
       CAS     SAM01,1        COMPARE WITH MERGE ORDER                  CEP23260
       TRA     *+2                                                      CEP23270
       TRA     ASMRO          EQUAL                                     CEP23280
       STL     BUF28                                                    CEP23290
       STL     DEERR                                                    CEP23300
*                                                                       CEP23310
*  UTILITY TAPE REQUEST BUT NOT ASSIGNED                                CEP23320
*                                                                       CEP23330
ASMRR  STL     BUF29                                                    CEP23340
       STL     DEERR                                                    CEP23350
*                                                                       CEP23360
*  ASSIGNMENT OF INTERSYSTEM FOR MERGE                                  CEP23370
*                                                                       CEP23380
 ASMRI CLA     INPCT          NUMBER OF INTERSYSTEM TAPES               CEP23390
       ANA     =O77777                                                  CEP23400
       CAS     SAM01,1        COMPARE WITH MERGE ORDER                  CEP23410
       TRA     *+2                                                      CEP23420
       TRA     ASMRJ          EQUAL WITH MERGE ORDER                    CEP23430
       STL     BUF28                                                    CEP23440
       STL     DEERR                                                    CEP23450
       TRA     ASMRO                                                    CEP23460
 ASMRJ ALS     18                                                       CEP23470
       STD     CHA00,1        SAVE NUMBER OF UNITS IN DECREMENT         CEP23480
       CAL     CHA00,1        CALLING SEQUENCE TO ASSIGN                CEP23490
       SLW     *+2                                                      CEP23500
       TSX     ASSIGN,4                                                 CEP23510
       PZE                                                              CEP23520
       TRA     ASMRO          TO ASSIGNMENT OF OUTPUT TAPES             CEP23530
       TRA     ASINT          NO INTER-SYSTEM COMMUNICATION FOUND       CEP23540
       TRA     ASMRO          TO ASSIGNMENT OF OUTPUT TAPES             CEP23550
                                                                        CEP23560
                                                                        CEP23570
       SPACE   2                                                        CEP23580
*                                                                       CEP23590
*  ASSIGNMENT OF CHANNEL UNITS WITH NUMBER DESIGNATIONS                 CEP23600
*                                                                       CEP23610
 ASMRN CLA     INPCT          NUMBER OF UNITS FROM CHAIN                CEP23620
       ANA     =O77777                                                  CEP23630
       CAS     SAM01,1        COMPARE WITH MERGE ORDER                  CEP23640
       TRA     *+2                                                      CEP23650
       TRA     ASMRK          EQUAL                                     CEP23660
       STL     BUF28                                                    CEP23670
       STL     DEERR                                                    CEP23680
       TRA     ASMRO                                                    CEP23690
 ASMRK ALS     18                                                       CEP23700
       STD     CHA00,1        SAVE NO. OF UNITS IN DECREMENT            CEP23710
       CAL     CHA00,1        CALLING SEQUENCE TO ASSIGN                CEP23720
       ORA     =O200000                                                 CEP23730
       SLW     CHA00,1                                                  CEP23740
       SLW     *+2                                                      CEP23750
       TSX     ASSIGN,4                                                 CEP23760
       PZE                                                              CEP23770
       TRA     ASNEN          NOT ENOUGH UNITS GIVEN FOR INPUT          CEP23780
       TRA     *+1                                                      CEP23790
       TRA     ASMRO          TO ASSIGNMENT OF OUTPUT TAPES             CEP23800
       SPACE                                                            CEP23810
*                                                                       CEP23820
*  ASSIGNMENT OF OUTPUT TAPES FOR MERGE ONLY                            CEP23830
*                                                                       CEP23840
 ASMRO LXA     OSREL,1        COMMON RELOCATION                         CEP23850
       ZET     CSOUT          HAS OUTPUT BEEN SPECIFIED              (5)CEP23851
       TRA     ASMOK          YES.                                   (5)CEP23852
       TRA     ASNCH                                                 (5)CEP23856
ASMOK  ZET     CHA04,1        TEST FOR INTERSYSTEM RESERVE.          (5)CEP23860
       TRA     ASMRL          INTERSYSTEM MODE                          CEP23870
       CLA     SAM01,1        MERGE ORDER                               CEP23880
       PAX     ,4                                                       CEP23890
       TXL     *+2,4,2                                                  CEP23900
       AXT     2,4                                                      CEP23910
       PXD     ,4                                                       CEP23920
       STD     CHA01,1        LOCATION OF OUTPUT TABLE                  CEP23930
       CAL     CHA01,1        CALLING SEQUENCE TO ASSIGN                CEP23940
       SLW     *+2                                                      CEP23950
       TSX     ASSIGN,4                                                 CEP23960
       PZE                                                              CEP23970
       TRA     *+3                                                      CEP23980
       TRA     *+1                                                      CEP23990
       TRA     ASMRE          WRAP UP OF FINAL ASSIGNMENT               CEP24000
       SPACE   5                                                        CEP24010
*                                                                       CEP24020
*  NOT ENOUGH UNITS AVAILABLE (MERGE ORDER EXPECTED)                    CEP24030
*     1.  CHECK FOR A LESSER NUMBER                                     CEP24040
*     2.  ACCEPT IF 1 OR MORE UNITS AVAILABLE                           CEP24050
       STA     ASNNO          NUMBER OF UNITS NOT ASSIGNED              CEP24060
       CLA     SAM01,1        MERGE ORDER                               CEP24070
       SUB     ASNNO          FIND NUMBER OF UNITS ASSIGNED             CEP24080
       PAX     ,2                                                       CEP24090
       TXH     ASMRB,2,0       TEST FOR AT LEAST 1 UNIT                 CEP24100
       STL     BUF27                                                    CEP24110
       STL     DEERR                                                    CEP24120
       TRA     ASMRF                                                    CEP24130
 ASMRB PXD     ,2                                                       CEP24140
       STD     CHA01,1        SAVE NUMBER OF ASSIGNED UNITS             CEP24150
 ASMRE CAL     CHA01,1        SWITCH UNITS TO PROPER                    CEP24160
       ORA     =O200000                                                 CEP24170
       SLW     CHA02,1                                                  CEP24180
       SLW     CHA01,1                                                  CEP24190
       CAL     CHA00,1                                                  CEP24200
       ORA     =O200000                                                 CEP24210
       SLW     CHA03,1                                                  CEP24220
       AXT     0,2                                                      CEP24230
       CAL*    CHA00,1                                                  CEP24240
       ANA     =O177000000                                              CEP24250
       SLW     ASMRG                                                    CEP24260
       CAL*    CHA01,1                                                  CEP24270
       ANA     =O177000000                                              CEP24280
       ERA     ASMRG                                                    CEP24290
       TNZ     ASMRF                                                    CEP24300
       STL     BUF43                                                    CEP24310
       TRA     STOP                                                     CEP24320
 ASMRG                                                                  CEP24330
 ASMRF ZET     DEERR                                                    CEP24340
       TSX     HALT,4                                                   CEP24350
       TRA     CALCU         GO TO CALCULATIONS.                        CEP24360
       SPACE                                                            CEP24370
*                                                                       CEP24380
*  ASSIGNMENT OF OUTPUT WHEN INTERSYSTEM REQUESTED                      CEP24390
*                                                                       CEP24400
 ASMRL LXA     OSREL,1        COMMON RELOCATION                         CEP24410
       CLA     REF00,1        LAST USED COMMON CELL                     CEP24420
       SUB     =1                                                       CEP24430
       STA     CHA02,1        LOCATION OF OUTPUT TABLE                  CEP24440
       SUB     =9                                                       CEP24450
       STA     REF00,1        SAVE NEW LAST USED COMMON LOCATION        CEP24460
       CLA     SAM01,1        MERGE ORDER                               CEP24470
       ALS     18                                                       CEP24480
       STD     CHA02,1                                                  CEP24490
       CLA     CHA00,1                                                  CEP24500
       STA     *+1                                                      CEP24510
       CLA*    **             FIRST WORD OF UCB UNIT 1                  CEP24520
       ANA     =O17000000000                                            CEP24530
       SLW     ASMEC          INPUT CHANNEL DESIGNATION                 CEP24540
       CAL     SYSUAV         SYSTEM AVAILABILITY                       CEP24550
       PDX     ,2             NUMBER OF ATTACHED CHANNELS               CEP24560
       PXA     ,2                                                       CEP24570
       ADD     SYSUAV         FIND BASE OF AVAILABILITY TABLE.          CEP24580
       STA     ASMEA                                                    CEP24590
       STA     ASMEZ                                                    CEP24600
 ASMEZ NZT     **,2           TEST FOR AVAILABLE UNITS ON THIS CHANNEL. CEP24610
       TRA     ASMEX                                                    CEP24620
 ASMEA CAL*    **,2                                                     CEP24630
       ANA     =O17000000000  CHANNEL DESIGNATION                       CEP24640
       SLW     ASMEB           SAVE FOR LATER COMPARE                   CEP24650
       ERA     ASMEC                                                    CEP24660
       TNZ     ASMEF          CHANNEL OTHER THAN INPUT FOUND            CEP24670
 ASMEX TIX     ASMEZ,2,1                                                CEP24680
       STL     BUF27                                                    CEP24690
       STL     DEERR                                                    CEP24700
       TRA     ASMRF                                                    CEP24710
 ASMEC PZE                    INPUT CHANNEL DESIGNATION                 CEP24720
 ASMEB PZE                                                              CEP24730
       SPACE                                                            CEP24740
*                                                                       CEP24750
*  CHANNEL FOUND FOR OUTPUT                                             CEP24760
*                                                                       CEP24770
 ASMEF CLA     ASMEB                                                    CEP24780
       ARS     9                                                        CEP24790
       ADD     =O20000000     MAKE INTO A CHANNEL NUMBER                CEP24800
       XCL                                                              CEP24810
       AXT     10,4                                                     CEP24820
       AXT     0,2                                                      CEP24830
       CAL     CHA02,1                                                  CEP24840
       STA     *+1            LOCATION OF OUTPUT TABLE                  CEP24850
       STQ     **,2           SAVE IN TABLE FOR ASSIGNING OUTPUT CHANNELCEP24860
       TXI     *+1,2,1                                                  CEP24870
       TIX     *-2,4,1                                                  CEP24880
       SLW     *+2            CALLING SEQUENCE FOR ASSIGN               CEP24890
       TSX     ASSIGN,4       ASSIGN OUTPUT UNITS                       CEP24900
       PZE                                                              CEP24910
       TRA     ASMEN          NOT ENOUGH UNITS AVAILABLE                CEP24920
       TRA     *+1                                                      CEP24930
 ASMED CAL     CHA00,1                                                  CEP24940
       STA     CHA03,1                                              (10)CEP24950
       TRA     ASMRF                                                    CEP24960
       SPACE   5                                                        CEP24970
*                                                                       CEP24980
*  NOT ENOUGH UNITS AVAILABLE FOR OUTPUT                                CEP24990
*     1.  MERGE ORDER UNITS REQUIRED                                    CEP25000
*     2.  1 OR MORE UNITS WILL BE ACCEPTED                              CEP25010
*                                                                       CEP25020
 ASMEN STA     ASNNO          NUMBER OF UNITS NOT ASIGNED               CEP25030
       CLA     SAM01,1        MERGE ORDER                               CEP25040
       SUB     ASNNO                                                    CEP25050
       PAX     ,4                                                       CEP25060
       TXL     ASMEX,4,0      TEST FOR AT LEAST ONE UNIT.               CEP25070
       PXD     ,4                                                       CEP25080
       STD     CHA02,1        SAVE NUMBER ASSIGNED                      CEP25090
       TRA     ASMED                                                    CEP25100
       SPACE   2                                                        CEP25110
CNTNUE TSX     MSGSUP,4,2                                               CEP25120
               1                                                        CEP25130
               AM171,,5                                                 CEP25140
       TRA     1,2                                                      CEP25150
       SPACE   2                                                        CEP25160
*                                                                       CEP25170
*  RETURN CONTROL TO SORT MONITOR                                       CEP25180
*                                                                       CEP25190
 END   BSS     0                                                        CEP25200
       NZT     OSTAP          TEST FOR STOP AFTER PRINTING TAPES        CEP25210
       TRA     REWAA                                                    CEP25220
       TSX     MSGSUP,4,2                                               CEP25230
       PZE     2                                                        CEP25240
       PZE     ,,512*4                                                  CEP25250
       PZE     AM145,,12+512*4                                          CEP25260
       TSX     (PAUSE,4                                                 CEP25270
 RWIND TSX     REWIND,4       REWIND ALL TAPES                          CEP25280
       LXA     OSREL,1                                                  CEP25290
       SXD     *+2,1                                                    CEP25300
       LAC     SYSCOR,1      -SYSEND                                    CEP25310
       TXI     *+1,1,**      RELCOM-SYSEND                              CEP25320
       TXI     *+1,1,-1      RELCOM+77777-SYSEND IS RELOCATION AMOUNT   CEP25330
       PXA     ,1             FOR COMMON PARAMETERS FOR FUTURE LOADS.   CEP25340
       PAI                   COMMUNICATE TO LOADER THRU INDICATORS.     CEP25350
       LXA     OSREL,1        COMMON RELOCATION                         CEP25360
       STL     RAW02,1        SET READ COMPLETION SWITCH                CEP25370
       STL     RAW04,1        SET WRITE COMPLETION SWITCH               CEP25380
       XEC     EP002          RETURN REGISTER                           CEP25390
       CLA     REF00,1        LAST USED COMMON CELL                     CEP25400
       STA     5,4            STORE LAST USED LOCATION IN SORT MONITOR  CEP25410
       CAL     ENDACT        MOVE POST PROCESSOR-DIRECTING BITS (SET (2)CEP25411
       SLW     GEN04,1        AS RESULT OF READ-AHEAD) TO COMMON     (5)CEP25412
       ZET     SAM04,1                                                  CEP25420
       TRA     EP002                                                    CEP25430
       TRA     EP006                                                    CEP25440
 REWAA LXA     OSREL,1                                                  CEP25450
       NZT     SAM04,1         CHECK FOR MERGE OR SORT                  CEP25460
       TRA     REWBB           MERGE ONLY                               CEP25470
       CLA     CHA00,1                                                  CEP25480
       STO     *+2                                                      CEP25490
       TSX     JBAA,4          SET UP CALLING SEQUENCE FOR              CEP25500
       PZE                     RESET THE MINUS SIGN OF THE UNIT         CEP25510
 REWBB CLA     CHA02,1                                                  CEP25520
       STO     *+2                                                      CEP25530
       TSX     JBAA,4                                                   CEP25540
       PZE                                                              CEP25550
       CLA     CHA03,1                                                  CEP25560
       STO     *+2                                                      CEP25570
       TSX     JBAA,4                                                   CEP25580
       PZE                                                              CEP25590
       TRA     RWIND           GO TO REWIND ALL TAPES                   CEP25600
  JBAA SXA     JBZZ,4          SAVE THE XR4                             CEP25610
       CLA     1,4             GET THE LOCATION OF THE LIST             CEP25620
       PDX     ,2             SAVE LENGTH OF LIST                       CEP25630
       STA     JBAB            INITIALIZE                               CEP25640
       STA     JBAD                                                     CEP25650
       AXT     0,1                                                      CEP25660
  JBAB CLA     **,1            GET THE FIRST ONE FROM THE LIST          CEP25670
       SSP                                                              CEP25680
  JBAD STO     **,1                                                     CEP25690
       TXI     *+1,1,1        STEP UP THE COUNTER.                      CEP25700
       TIX     JBAB,2,1        LAST ONE IN THE LIST                     CEP25710
       LXA     OSREL,1         RESTORE THE RELOCATABLE COMMON VALUE     CEP25720
  JBZZ AXT     **,4            RESTORE THE XR4                          CEP25730
       TRA     2,4             EXIT OF THIS ROUTINE                     CEP25740
       EJECT                                                            CEP25750
*                                                                       CEP25760
*  SUBROUTINE TO REWIND ALL TAPES - RETURNS TO 1,4                      CEP25770
*                                                                       CEP25780
REWIND SXA     REW02,1                                                  CEP25790
       SXA     REW03,2                                                  CEP25800
       SXA     REW04,4                                                  CEP25810
       LXA     OSREL,1                                                  CEP25820
REW01  BSS     0                                                        CEP25890
       CAL     CHA02,1                                                  CEP25900
       TSX     REW05,4                                                  CEP25910
       CAL     CHA00,1                                                  CEP25920
       ZET     SAM04,1       SKIP IF STRAIGHT MERGE.                    CEP25930
       TSX     REW05,4                                                  CEP25940
       CAL*    CHA02,1                                                  CEP25950
       STA     *+1                                                      CEP25960
       LDI     **                                                       CEP25970
       LNT     20000                                                    CEP25980
       TRA     REW02                                                    CEP25990
       CAL*    CHA03,1                                                  CEP26000
       STA     *+1                                                      CEP26010
       LDI     **                                                       CEP26020
       LFT     20000                                                    CEP26030
       STL     RAW20,1        IF BOTH MERGE CHANNELS ARE 7909.          CEP26040
REW02  AXT     **,1                                                     CEP26050
REW03  AXT     **,2                                                     CEP26060
REW04  AXT     **,4                                                     CEP26070
       TRA     1,4                                                      CEP26080
REW05  SXA     REW09,4                                                  CEP26090
       STA     REW08         STORE L(UCB) INTO HYPER REWIND ROUTINE.    CEP26100
       STA     REW07                                                    CEP26110
       PDX     ,2                                                       CEP26120
REW06  TXL     REW09,2,0                                                CEP26130
       TXI     *+1,2,-1                                                 CEP26140
       CAL*    REW07         TEST THE UCB                               CEP26150
       STA     *+1            TO SEE IF THIS UNIT                       CEP26160
       LDI     **             IS ON A 7909 CHANNEL.                     CEP26170
       LNT     20000         IF NOT,                                    CEP26180
       TRA     REW10         TRANSFER.                                  CEP26190
       PAC     ,4                                                       CEP26200
       ZET     1,4                                                      CEP26210
       TRA     *-1                                                      CEP26220
       TSX     (NDATA,4      IF IT IS, ISSUE THIS                       CEP26230
 REW08 PZE     **,2,30        HYPERTAPE REWIND.                         CEP26240
       TRA     REW06                                                    CEP26250
REW10  TSX     (NDATA,4                                                 CEP26260
 REW07 PZE     **,2,3                                                   CEP26270
       TRA     REW06                                                    CEP26280
REW09  AXT     **,4                                                     CEP26290
       TRA     1,4                                                      CEP26300
       EJECT                                                            CEP26310
*                                                                       CEP26320
*  SWITCH TAPES FOR MERGE ONLY                                          CEP26330
*                                                                       CEP26340
 CHAMR LXA     OSREL,1        COMMON RELOCATION                         CEP26350
       AXT     0,2                                                      CEP26360
       CAL*    CHA00,1        INPUT CHANNEL                             CEP26370
       STA     *+1                                                   (5)CEP26371
       CAL     **             GET UCB                                (5)CEP26372
       ANA     =O17000000000     MASK OUT CHANNEL.                   (5)CEP26380
       SLW     ASCHA          SAVE INPUT CHANNEL                        CEP26390
       CAL*    CHA03,1        INPUT FOR MERGE                           CEP26400
       STA     *+1                                                   (5)CEP26401
       CAL     **                                                    (5)CEP26402
       ANA     =O17000000000                                         (5)CEP26410
       ERA     ASCHA          COMPARE                                   CEP26420
       TZE     ASMED                                                 (8)CEP26430
       CAL     CHA03,1        NOT EQUAL SO SWITCH                       CEP26440
       LDQ     CHA02,1                                                  CEP26450
       STQ     CHA03,1                                                  CEP26460
       SLW     CHA02,1                                                  CEP26470
       CAL*    CHA03,1        NEW INPUT CHANNEL                         CEP26480
       STA     *+1                                                   (5)CEP26481
       CAL     **             GET UCB                                (5)CEP26482
       ANA     =O17000000000  MASK OUT CHANNEL.                      (5)CEP26490
       ERA     ASCHA          SEE IF NEW CHANNEL INPUT                  CEP26500
       TZE     ASMED                                                 (8)CEP26510
       STL     BUF30                                                    CEP26520
       TRA     STOP                                                     CEP26530
       EJECT                                                            CEP26540
*                                                                       CEP26550
*  PRINT ASSIGNED TAPES FOR MERGE ONLY                                  CEP26560
*                                                                       CEP26570
MERPR  LXA     OSREL,1                                                  CEP26580
       CLA     OSTAP                                                    CEP26590
       STO     OPT09,1                                                  CEP26600
       TSX     MSGSUP,4,16                                              CEP26610
       PZE     1                                                        CEP26620
               AM144,,6+512*4                                           CEP26630
       CLA     CHA03,1        MERGE INPUT ADDRESS                       CEP26640
       STA     MERIT                                                    CEP26650
       CLA     SAM01,1        MERGE ORDER                               CEP26660
       PAX     ,2                                                       CEP26670
       AXT     FIL02,4        LOCATION OF FILE INPUT BLOCKS             CEP26680
       SXD     METIX,1        COMMON RELOCATION                         CEP26690
 METIX TIX     *+1,4,**       REDUCE LOCATION BY RELOCATION AMOUNT      CEP26700
       SXA     MRFIL,4                                                  CEP26710
       AXT     0,1                                                      CEP26720
 MERIT LDQ*    **,1           UCW1                                      CEP26730
       CLA*    MERIT                                                    CEP26740
       TMI     MERIN                                                    CEP26750
       TSX     MSGSUP,4,17   PRINT MERGE INPUT UNITS.                   CEP26760
       PZE     AMS75,,2                                                 CEP26770
       TRA     MERND                                                    CEP26780
 MERIN BSS     0                                                        CEP26790
       TSX     MSGSUP,4,17                                              CEP26800
       PZE     AMS75,,7                                                 CEP26810
       CAL     =O377777777777                                           CEP26820
       ANS*    MERIT                                                    CEP26830
 MERND BSS     0                                                        CEP26840
 MRFIL LDQ     **,1           FILE NUMBER (D)                           CEP26850
       ZAC                                                              CEP26860
       LRS     18                                                       CEP26870
       CALL    BTD            CONVERT TO DECIMAL                        CEP26880
       STQ     AM153+3                                                  CEP26890
       TSX     MSGSUP,4,16   MOUNT FILE XXXX ON THIS UNIT.              CEP26900
       PZE     1                                                        CEP26910
       PZE     AM153,,7                                                 CEP26920
       TXI     *+1,1,1                                                  CEP26930
       TIX     MERIT,2,1      TEST FOR MORE TO PRINT                    CEP26940
       LXA     OSREL,1        COMMON RELOCATION                         CEP26950
       CLA     CHA02,1        ADDRESS OF MERGE TAPES                    CEP26960
       STA     MERMT                                                    CEP26970
       PDX     ,2                                                       CEP26980
       AXT     0,1                                                      CEP26990
 MERMT LDQ*    **,1           UCW1                                      CEP27000
       CLA*    MERMT                                                    CEP27010
       TMI     MERMN                                                    CEP27020
       TSX     MSGSUP,4,17   PRINT MERGE TAPES.                         CEP27030
       PZE     AMS77,,3                                                 CEP27040
       TRA     MEREN                                                    CEP27050
 MERMN BSS     0                                                        CEP27060
       TSX     MSGSUP,4,3                                               CEP27070
       PZE     AMS77,,7                                                 CEP27080
       CAL     =O377777777777                                           CEP27090
       ANS*    MERMT                                                    CEP27100
 MEREN BSS     0                                                        CEP27110
       TXI     *+1,1,1                                                  CEP27120
       TIX     MERMT,2,1                                                CEP27130
       LXA     SYSCK2,1      TEST FOR CHECKPOINT TAPE.                  CEP27140
       TXL     END,1,0                                                  CEP27150
       LDQ*    SYSCK2                                                   CEP27160
       TSX     MSGSUP,4,17   PRINT CHECKPOINT TAPE.                     CEP27170
       PZE     AM113,,3                                                 CEP27180
       TRA     END                                                      CEP27190
       SPACE   5                                                        CEP27200
*                                                                       CEP27210
*  PROCEDURE WHEN NO INTERSYSTEM COMMUNICATION GIVEN                    CEP27220
*                                                                       CEP27230
 ASINT TSX     MSGSUP,4,2                                               CEP27240
               3                                                        CEP27250
               AM127,,7+512*4                                           CEP27260
               AM114,,6                                                 CEP27270
               AM128,,10                                                CEP27280
       TSX     (PAUSE,4                                                 CEP27290
       SWT     3                                                        CEP27300
       TRA     JBDEL                                                    CEP27310
       STL     OSTAP                                                    CEP27320
       LXA     OSREL,1        COMMON RELOCATION                         CEP27330
       AXT     0,2                                                      CEP27340
       CAL     CHA00,1                                                  CEP27350
       ADD     =1                                                       CEP27360
       STA     ASINU                                                    CEP27370
       PDX     ,4                                                       CEP27380
       CAL*    CHA02,1                                                  CEP27390
 ASINU SLW     **,4                                                     CEP27400
       TIX     *-1,4,1                                                  CEP27410
       NZT     SAM04,1                                                  CEP27420
       TRA     ASMRI          IF MERGE ONLY                             CEP27430
       TRA     ASRET          IF SORT                                   CEP27440
       SPACE   5                                                        CEP27450
*                                                                       CEP27460
*  PROCEDURE WHEN NOT ENOUGH UNITS GIVEN FOR INPUT                      CEP27470
*                                                                       CEP27480
ASNEN  STL     BUF31                                                    CEP27490
       TRA     STOP                                                     CEP27500
 ASNNO PZE                    NUMBER OF UNITS NEEDED                    CEP27510
 ASCHA PZE                    ASSIGNED CHANNEL                          CEP27520
 ASAMT PZE                    ADDRESS OF MERGE TABLE                    CEP27530
 ASCNT PZE                    NUMBER OF UNITS NOT AVAILABLE             CEP27540
 ASADT PZE                    NUMBER OF INPUT UNITS ASSIGNED            CEP27550
       SPACE   5                                                        CEP27560
*                                                                       CEP27570
*  PROCEDURE WHEN NOT ENOUGH UNITS GIVEN FOR MERGE                      CEP27580
*                                                                       CEP27590
ASMND  STA     ASCNT           SAVE NUMBER OF UNITS NOT AVAILABLE       CEP27600
       SXA     ASMAX,4        SAVE ENTRY REGISTER.                      CEP27610
       SXA     ASAX1,1                                                  CEP27620
       STZ     ASADT          RESET NUMBER OF UNITS ASSIGNED            CEP27630
       ZET     MARSW           CHECK SYSUT SPECIFIED                    CEP27640
       TRA     ASMNF                                                    CEP27650
       NZT     INPOJ           CHECK FOR J-Q SPECIFIED                  CEP27660
       TRA     ASMNF           IF NOT, ASSIGN INPUT TAPE                CEP27670
       NZT     INRSW           IF IT IS J-Q, CHECK IT IS RELEASED       CEP27680
       TRA     ASNAV         OTHERWISE DO NOT ASSIGN TAPE               CEP27690
ASMNF  CLA*    -1,4            CALLING SEQUENCE OF WORD ASSIGNED        CEP27700
       STA     *+1                                                      CEP27710
       CLA     **             FIRST WORD OF (UCW)                       CEP27720
       ANA     =O17000000000                                            CEP27730
       STO     ASCHA          CHANNEL ASSIGNED                          CEP27740
       CLA     CHA00,1        CHANNEL OF INPUT                          CEP27750
       TZE     ASNAV          TEST FOR INPUT GIVEN                      CEP27760
       STA     *+1                                                      CEP27770
       CLA     **             ASSIGNED UNIT IF GIVEN                    CEP27780
       TZE     ASNAV          TEST FOR INPUT ASSIGNED                   CEP27790
       STA     *+1                                                      CEP27800
       CAL     **             FIRST WORD OF (UCW)                       CEP27810
       ANA     =O17000000000                                            CEP27820
       ERA     ASCHA                                                    CEP27830
       TNZ     ASNAV          TEST FOR INPUT CHANNEL EQUAL THIS CHANNEL CEP27840
       CLA     CHA00,1                                                  CEP27850
       PDX     ,2             NUMBER OF UNITS ASSIGNED FOR INPUT        CEP27860
       STD     ASHRE           SAVE THE NUMBER OF UNITS IN DECREMENT    CEP27870
       SXA     ASADT,2                                                  CEP27880
       AXT     0,2             INITIALIZE XR2                           CEP27890
       STA     ASMOV                                                    CEP27900
       CLS     -1,4                                                     CEP27910
       STA     ASAMT                                                    CEP27920
       ARS     18                                                       CEP27930
       ADD     ASAMT          LOCATION OF MERGE TABLE                   CEP27940
       ADD     ASCNT          NUMBER OF UNITS NOT AVIALABLE             CEP27950
       LXA     ASCNT,1        NUMBER OF UNITS NEEDED                    CEP27960
       STA     *+3            LOCATION TO STORE THOSE ASSIGNED AS INPUT CEP27970
       AXT     0,4                                                      CEP27980
 ASMOV CAL     **,2           MOVE WORDS TO MERGE LIST                  CEP27990
       SLW     **,4                                                     CEP28000
       ORA     =O200000000000                                           CEP28010
       SLW*    ASMOV                                                    CEP28020
       TXI     *+1,4,1                                                  CEP28030
       TNX     ASNAV,1,1      TEST FOR MORE UNITS TO MOVE               CEP28040
       TXI     *+1,2,1         COUNT ONE                                CEP28050
 ASHRE TXL     ASMOV,2,**      TEST FOR MORE INPUT UNIT TO MOVE         CEP28060
 ASNAV CLA     ASCNT          NUMBER NOT AVAILABLE                      CEP28070
       SUB     ASADT          NUMBER GAINED FROM INPUT TABLE            CEP28080
 ASMAX AXT     **,4           RESTORE RETURN INDICATOR                  CEP28090
 ASAX1 AXT     **,1                                                     CEP28100
       TZE     2,4            TEST FOR ENOUGH ASSIGNED                  CEP28110
       TMI     2,4            TEST FOR ENOUGH ASSIGNED                  CEP28120
       STL     BUF32                                                    CEP28130
       TRA     STOP                                                     CEP28140
*                                                                       CEP28150
*  ERRORS WHEN SORT CAN NOT PROCEED                                     CEP28160
*                                                                       CEP28170
ASERR  STL     BUF05                                                    CEP28180
       TRA     STOP                                                     CEP28190
ASINP  STL     BUF10                                                    CEP28200
       TRA     STOP                                                     CEP28210
       SPACE   5                                                        CEP28220
*                                                                       CEP28230
* ACTION WHEN SYSTEM DELETED BECAUSE OF ERROR                           CEP28240
*                                                                       CEP28250
 JBDEL LXA     OSREL,1       COMMON RELOCATION                          CEP28260
       CAL     CHA00,1       INPUT UNITS                                CEP28270
       TZE     ININ+1                                                   CEP28280
       SLW     ININ                                                     CEP28290
       STA     INCOM                                                    CEP28300
       CAL     =O577777777777                                           CEP28310
       AXT     0,2                                                      CEP28320
       AXT     10,4                                                     CEP28330
 INCOM ANS     **,2           CLEAR BIT FOR NON-RELEASE OF INTERSYSTEM  CEP28340
       TXI     *+1,2,1                                                  CEP28350
       TIX     *-2,4,1                                                  CEP28360
       CAL     =O77000000    SET DECR TO TELL RELEAS THAT IT         (7)CEP28361
       ORS     CNT19          IS RELEASING INPUT UNITS               (7)CEP28362
       CALL    RELEAS        RELEASE INPUT UNITS                        CEP28370
 ININ  PZE     **,,**                                                   CEP28380
       CAL     CHA01,1       OUTPUT UNITS                               CEP28390
       TZE     INOUT+1       TEST FOR OUTPUT UNITS                      CEP28400
       ADD     =O12000000                                               CEP28410
       SLW     INOUT                                                    CEP28420
       STA     OUCOM                                                    CEP28430
       CAL     =O577777777777                                           CEP28440
       AXT     0,2                                                      CEP28450
       AXT     10,4                                                     CEP28460
 OUCOM ANS     **,2          CLEAR BIT FOR NON-RELEASE OF INTERSYSTEM   CEP28470
       TXI     *+1,2,1                                                  CEP28480
       TIX     *-2,4,1                                                  CEP28490
       CALL    RELEAS        RELEASE OUTPUT UNITS                       CEP28500
 INOUT PZE     **,,**                                                   CEP28510
       CAL     CHA02,1       MERGE UNITS                                CEP28520
       TZE     *+5                                                      CEP28530
       ADD     =O12000000                                               CEP28540
       SLW     *+2                                                      CEP28550
       CALL    RELEAS        RELEASE MERGE UNITS                        CEP28560
       PZE     **,,**                                                   CEP28570
       CAL     CHA03,1       MERGE UNITS                                CEP28580
       TZE     *+5                                                      CEP28590
       ADD     =O12000000                                               CEP28600
       SLW     *+2                                                      CEP28610
       CALL    RELEAS                                                   CEP28620
       PZE     **,,**                                                   CEP28630
       TRA     EP007                                                    CEP28640
       EJECT                                                            CEP28650
*                                                                       CEP28660
* SUBROUTINE FOR FINDING DEFINER ANALYSIS PROGRAM                       CEP28670
*                                                                       CEP28680
* THIS SUBROUTINES IS CALLED BY                                         CEP28690
*                                                                       CEP28700
*      TSX     DEFER,4                                                  CEP28710
*                                                                       CEP28720
* THE AC CONTAINS                                                       CEP28730
*      ADD     ADDRESS OF FIRST DEFINER                                 CEP28740
*      DEC     NUMBER OF DEFINERS                                       CEP28750
*                                                                       CEP28760
*  XR1 CONTAINS CARD NUMBER                                             CEP28770
*                                                                       CEP28780
*              10             OPTION                                    CEP28790
*              9              OVERFLOW                                  CEP28800
*              8              LABEL                                     CEP28810
*              7              CHANNEL                                   CEP28820
*              6              FILE                                      CEP28830
*              5              MODIFICATION                              CEP28840
*              4              RECORD                                    CEP28850
*              3              DELETE                                    CEP28860
*              2              SORT                                      CEP28870
*              1              MERGE                                     CEP28880
*                                                                       CEP28890
 DEFER SXA     DEFE1,1        SAVE REGISTERS                            CEP28900
       SXA     DEFE2,2                                                  CEP28910
       SXA     DEFE3,4                                                  CEP28920
       SLW     DEFE4          SAVE LOCATION OF FIRST DEFINER AND NO.    CEP28930
       XEC     AXT01,1        NO. LEGAL DEFINERS THIS CARD              CEP28940
       SXD     DEFE5,4        SAVE FOR LATER TEST FOR TOO MANY DEFINERS CEP28950
       CLA     AXT02,1        SWITCH BASE                               CEP28960
       STA     TWOSM+1                                                  CEP28970
       STA     *+1                                                      CEP28980
       STZ     **,4           SET ALL SWITCHES EQUAL ZERO               CEP28990
       TIX     *-1,4,1                                                  CEP29000
       LXD     DEFE4,2        NUMBER OF DEFINERS IN CARD                CEP29010
       TXH     DEFE5,2,0      ANY DEFINERS                              CEP29020
       STL     BUF33                                                    CEP29030
 DEFE0 STL     DEERR          SET ERROR SWITCH                          CEP29040
 DEFE1 AXT     **,1           RESTORE REGISTERS                         CEP29050
 DEFE2 AXT     **,2                                                     CEP29060
 DEFE3 AXT     **,4                                                     CEP29070
       TRA     1,4                                                      CEP29080
 DEFE5 TXL     DEFE6,2,**     TEST NO. OF DEFINERS IN CARD GREATER      CEP29090
       STL     BUF34                                                    CEP29100
       TRA     DEFE0                                                    CEP29110
 DEFE6 CLA     AXT03,1        DEFINER BASE THIS CARD                    CEP29120
       STA     DEFE8                                                    CEP29130
       CLA     AXT04,1        TRANSFER BASE THIS CARD                   CEP29140
       STA     DEFE9                                                    CEP29150
       XEC     AXT01,1        NO. LEGAL DEFINERS IN XR4                 CEP29160
 DEFE7 TXL     DEFE1,2,0      ANY DEFINERS LEFT                         CEP29170
       LAC     DEFE4,1        -(ADDRESS OF DEFINERS)                    CEP29180
       CAL     0,1            CARD DEFINER                              CEP29190
       STA     DECNT          NUMBER OF PARAMETERS                      CEP29200
       ANA     =O777777000000 MASK FOR DEFINER                          CEP29210
       SLW     DECPR                                                    CEP29220
 DEFE8 CAL     **,4           LEGAL DEFINER FROM LIST                   CEP29230
       ERA     DECPR          COMPARE FOR TWO EQUAL DEFINERS            CEP29240
       TZE     TWOSM          TRANSFER TO DEFINER SUBROUTINE            CEP29250
       TIX     *-3,4,1        TRY ANOTHER LEGAL DEFINER                 CEP29260
       STL     BUF35                                                    CEP29270
 DECAR STL     DEERR          SET ERROR SWITCH                          CEP29280
 DECNT AXT     **,4           ADVANCE ADDRESS TO NEXT DEFINER           CEP29290
       TXI     *+1,4,1                                                  CEP29300
       SXD     *+2,4                                                    CEP29310
       LXA     DEFE4,4                                                  CEP29320
       TXI     *+1,4,**                                                 CEP29330
       SXA     DEFE4,4                                                  CEP29340
       LXD     DEFE4,2        DECREASE NO. OF DEFINERS                  CEP29350
       TXI     *+1,2,-1                                                 CEP29360
       SXD     DEFE4,2                                                  CEP29370
       XEC     DEFE1          CARD NO. IN XR1                           CEP29380
       XEC     AXT01,1        NO. LEGAL DEFINERS IN XR4                 CEP29390
       TRA     DEFE7                                                    CEP29400
 DEFE4 PZE                                                              CEP29410
       SPACE                                                            CEP29420
*                                                                       CEP29430
* TEST FOR DEFINER GIVEN TWICE                                          CEP29440
*                                                                       CEP29450
 TWOSM SXA     DEFXX,4                                                  CEP29460
       NZT     **,4           TEST FOR TWO DEFINERS THE SAME            CEP29470
 DEFE9 TRA*    **,4                                                     CEP29480
       STL     BUF36                                                    CEP29490
       TRA     DECAR                                                    CEP29500
 DEFXX PZE                                                              CEP29510
*                                                                       CEP29520
*                                                                       CEP29530
* ROUTINE WHEN NO PARAMETER GIVEN                                       CEP29540
*                                                                       CEP29550
NOPAR  STL     BUF37                                                    CEP29560
       TRA     DECAR                                                    CEP29570
       SPACE                                                            CEP29580
*                                                                       CEP29590
* MESSAGE WHEN ILLEGAL CHARACTER ENCOUNTERED IN CONVERSION ROUTINE      CEP29600
*                                                                       CEP29610
CVTER  STL     BUF38                                                    CEP29620
       TRA     DECAR                                                    CEP29630
       SPACE                                                            CEP29640
*                                                                       CEP29650
* ANALYSIS OF CKSM DEFINER-OPTION CARD                                  CEP29660
*                                                                       CEP29670
 CKSOP CLA     =1                                                       CEP29680
       STO     OSCKS          SET CKSUMS SWITCH                         CEP29690
       TRA     DECNT                                                    CEP29700
       SPACE                                                            CEP29710
*                                                                       CEP29720
* ANALYSIS OF NOCKPT DEFINER-OPTION CARD                                CEP29730
*                                                                       CEP29740
 NOCOP CLA     =1                                                       CEP29750
       STO     OSNOC          SET NOCKPT SWITCH                         CEP29760
       TRA     DECNT                                                    CEP29770
       SPACE                                                            CEP29780
*                                                                       CEP29790
* ANALYSIS OF EQUALS DEFINER-OPTION CARD                                CEP29800
*                                                                       CEP29810
 EQUOP CLA     =1                                                       CEP29820
       STO     OSEQU          SET EQUALS SWITCH                         CEP29830
       TRA     DECNT                                                    CEP29840
       SPACE                                                            CEP29850
*                                                                       CEP29860
* ANALYSIS OF VARIABLE DEFINER-OPTION CARD                              CEP29870
*                                                                       CEP29880
 VAROP CLA     =1                                                       CEP29890
       STO     OSVAR          SET VARIABLE SWITCH                       CEP29900
       TRA     DECNT                                                    CEP29910
       SPACE                                                            CEP29920
*                                                                       CEP29930
* ANALYSIS OF BUFFER DEFINER-OPTION CARD                                CEP29940
*                                                                       CEP29950
 BUFOP CLA     =1                                                       CEP29960
       STO     OSBUF          SET BUFFER SWITCH                         CEP29970
       TRA     DECNT                                                    CEP29980
       SPACE                                                            CEP29990
*                                                                       CEP30000
* ANALYSIS OF RELCOM DEFINER-OPTION CARD                                CEP30010
*                                                                       CEP30020
 RELOP LXA     DECNT,2        NO. OF PARAMETERS                         CEP30030
       TXL     NOPAR,2,0      TEST FOR NO. PARAMETERS                   CEP30040
       LDQ     1,1            PARAMETER                                 CEP30050
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP30060
       TRA     CVTER          ERROR RETURN                              CEP30070
       STA     OSREL          SAVE NO. CELLS COMMON RELOCATED           CEP30080
       PAX     0,2                                                      CEP30090
       TXL     DECNT,2,10000  TEST FOR USE OF TOO MUCH CORE             CEP30100
       STL     BUF39                                                    CEP30110
       TRA     DECAR                                                    CEP30120
       SPACE                                                            CEP30130
*                                                                       CEP30140
* ANALYSIS OF CARDS DEFINER-OPTION CARD                                 CEP30150
*                                                                       CEP30160
 CAROP CLA     =1                                                       CEP30170
       STO     OSCAR          SET PRINT CONTROL CARDS SWITCH            CEP30180
       TRA     DECNT                                                    CEP30190
       SPACE                                                            CEP30200
*                                                                       CEP30210
* ANALYSIS OF MAPS DEFINER-OPTION CARD                                  CEP30220
*                                                                       CEP30230
 MAPOP CLA     =1                                                       CEP30240
       STO     OSMAP          SET PRINT OF MAP SWITCH                   CEP30250
       TRA     DECNT                                                    CEP30260
       SPACE                                                            CEP30270
*                                                                       CEP30280
*ANALYSIS OF TAPES DEFINER-OPTION CARD                                  CEP30290
*                                                                       CEP30300
 TAPOP CLA     =1                                                       CEP30310
       STO     OSTAP          SET PRINT OF TAPES USED SWITCH            CEP30320
       TRA     DECNT                                                    CEP30330
       SPACE                                                            CEP30340
*                                                                       CEP30350
* ANALYSIS OF NO OFF-LINE PRINTING DEFINER-OPTION CARD                  CEP30360
*                                                                       CEP30370
 NOFOP CLA     =1                                                       CEP30380
       STO     OSNOF                                                    CEP30390
       TRA     DECNT                                                    CEP30400
       SPACE                                                            CEP30410
*                                                                       CEP30420
* ANALYSIS OF HISTORY DEFINER-OPTION CARD                               CEP30430
*                                                                       CEP30440
 HISOP CLA     =1                                                       CEP30450
       STO     OSHIS                                                    CEP30460
       TRA     DECNT                                                    CEP30470
*                                                                    (2)CEP30472
* ANALYSIS OF UNREADABLE BLOCK-PAUSE DEFINER OPTION                  (2)CEP30473
*                                                                    (2)CEP30474
UNROP  CLA     =1                                                    (2)CEP30475
       STO     OSUNR                                                 (2)CEP30476
       TRA     DECNT                                                 (2)CEP30477
       SPACE                                                            CEP30480
*                                                                       CEP30490
* ANALYSIS OF BLOCK DEFINER-OVERFLOW CARD                               CEP30500
*                                                                       CEP30510
 BLOOV LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP30520
       TXL     NOPAR,2,0      TEST FOR PARAMETER GIVEN                  CEP30530
       LDQ     1,1            PARAMETER                                 CEP30540
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP30550
       TRA     CVTER          ERROR RETURN                              CEP30560
       STA     OSBLO          NO. OF BLOCKS                             CEP30570
       TRA     DECNT                                                    CEP30580
       SPACE                                                            CEP30590
*                                                                       CEP30600
* ANALYSIS OF IDENTIFICATION DEFINER-LABEL CARD                         CEP30610
*                                                                       CEP30620
 IDELA LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP30630
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP30640
       LDQ     1,1                                                      CEP30650
       ZAC                                                              CEP30660
       LGL     6                                                        CEP30670
       PAX     ,4                                                       CEP30680
       STQ     IDEMQ                                                    CEP30690
       TXH     *+2,4,24       TEST FOR H ONLY                           CEP30700
       TXH     *+3,4,23                                                 CEP30710
       STL     BUF40                                                    CEP30720
       STL     DEERR          SET ERROR SWITCH                          CEP30730
       LDQ     IDEMQ                                                    CEP30740
       ZAC                                                              CEP30750
       LGR     6                                                        CEP30760
       XCA                                                              CEP30770
       PAX     ,4                                                       CEP30780
       TXH     *+2,4,120      TEST FOR LABEL OVER 20 WORDS              CEP30790
       TXH     *+3,4,17      TEST FOR LABEL UNDER THREE WORDS.          CEP30800
       STL     BUF41                                                    CEP30810
       TRA     DECAR                                                    CEP30820
       LXA     OSREL,2        COMMON RELOCATION                         CEP30830
       CLA     REF00,2        LAST USED COMMON LOCATION                 CEP30840
       SUB     =20                                                      CEP30850
       STA     REF00,2        LAST LOCATION NOT USED                    CEP30860
       STA     LAB02,2        ADDRESS OF LABEL CARD IN COMMON           CEP30870
       STA     LABMV                                                    CEP30880
       LXA     DECNT,4                                                  CEP30890
       TXI     *+1,4,-1       NUMBER OF WORDS IN LABEL                  CEP30900
       PXA     ,4                                                       CEP30910
       STA     LAB03,2        SAVE LENGTH OF LABEL                      CEP30920
       AXT     0,2                                                      CEP30930
       LDQ     2,1            LOAD A WORD OF LABEL                      CEP30940
 LABMV STQ     **,2           STORE WORD OF LABEL IN COMMON             CEP30950
       TXI     *+1,1,-1                                                 CEP30960
       TXI     *+1,2,-1                                                 CEP30970
       TIX     *-4,4,1        TEST FOR MORE WORDS TO MOVE               CEP30980
       STL     LSIDE                                                    CEP30990
       TRA     DECNT                                                    CEP31000
 IDEMQ PZE                                                              CEP31010
       SPACE                                                            CEP31020
*                                                                       CEP31030
* ANALYSIS OF INPUT-CHANNEL CARD                                        CEP31040
*                                                                       CEP31050
 INPCH LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP31060
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP31070
       SXA     INPCT,2        SAVE NUMBER OF PARAMETERS                 CEP31080
 INPST CAL     1,1            PARAMETER                                 CEP31090
       STZ     INRSW          INITIALIZE RELEASE SWITCH                 CEP31100
       STZ     INUSW                                                 (7)CEP31101
 INPLG LGR     6              EXTRACT A CHARACTER                       CEP31110
       SLW     INSAV          SAVE PARTIAL WORD                         CEP31120
       ZAC                                                              CEP31130
       LGL     6                                                        CEP31140
       PAX     ,4                                                       CEP31150
       ANA     =O77          IS THE U FOR THE UNLOAD                 (7)CEP31151
       ERA     =O64           OPTION GIVEN                           (7)CEP31152
       TZE     INPUU         YES                                     (7)CEP31153
       PXA     ,4                                                    (7)CEP31154
       TXH     INPER,4,41     TEST FOR HIGHER THAN RELEASE              CEP31160
       TXH     INPRL,4,40     TEST FOR RELEASE                          CEP31170
       TXH     INPCO,4,32     TEST FOR J TO Q                           CEP31180
       TXH     INPER,4,24     TEST FOR HIGHER THAN H                    CEP31190
       TXH     INPNR,4,16     TEST FOR CHANNELS A TO H                  CEP31200
       TXL     INPNO,4,9      TEST FOR NUMBERS ONLY                     CEP31210
INPER  STL     BUF05                                                    CEP31220
       TRA     DECAR                                                    CEP31230
INPNO  ZET     INPNM         TEST FOR A NUMBER ALREADY GIVEN.        (2)CEP31240
       TRA     INPER                                                    CEP31250
       STL     INUNO                                                    CEP31260
       STL     INPNM                                                 (2)CEP31265
       SXA     INPNU,4        SAVE NUMBER FOR BUILDING CHAIN NUMBER     CEP31270
       CAL     INSAV          RESTORE REMAINDER PORTION                 CEP31280
       ANA     =O7777          IS THIS PARAMETER BELONGS TO SYSUT       CEP31290
       ERA     =O6463                                                   CEP31300
       TZE     INUTA           IF YES GO TO EDITING SYSUTX ROUTINE      CEP31310
       CAL     INSAV         IF NO RESTORE THE REMAINDER PORTION        CEP31320
       TRA     INPLG           OF THIS PARAMETER                        CEP31330
 INPCO TXI     *+1,4,-24                                                CEP31340
       ZET     INPOA          TEST IF OTHER CHANNEL MODE GIVEN          CEP31350
       TRA     INPMS                                                    CEP31360
       STL     INPOJ          SET J TO Q MODE                           CEP31370
 INPZT ZET     INPCN           TEST FOR FIRST TIME SWITCH               CEP31380
       TRA     INPMS-4         IF NOT, GO TO TEST EQUAL CHANNEL         CEP31390
       SXA     INPCN,4         IF YES, GO TO TABLE EDITING              CEP31400
       TRA     INUHK+2                                                  CEP31410
       PXA     ,4                                                       CEP31420
       LAS     INPCN          TEST FOR EQUAL CHANNELS                   CEP31430
       TRA     *+2                                                      CEP31440
       TRA     INUHK                                                    CEP31450
INPMS  STL     BUF05                                                    CEP31460
       TRA     DECAR                                                    CEP31470
 INUHK NZT     INUNO                                                    CEP31480
       TRA     INPER                                                    CEP31490
       CAL     TAPES,4        INPUT TAPE CHANNEL DESIGNATION            CEP31500
       ORA     INPNU          COMBINE WITH CHAIN NUMBER                 CEP31510
       LDQ     =O000000000000                                        (7)CEP31511
       ZET     INPOJ         IS J TO Q MODE GIVEN                    (7)CEP31512
       TRA     *+4           YES                                     (7)CEP31513
       NZT     INUSW         IS THE UNLOAD OPTION GIVEN              (7)CEP31514
       ORA     INRSW         NO                                      (7)CEP31520
       TRA     INPXT                                                 (7)CEP31521
       NZT     INUSW         IS THE UNLOAD OPTION GIVEN              (7)CEP31522
       ORA     =O100000000000  NO, SET FOR REWIND ONLY               (7)CEP31523
       NZT     INRSW         IS RELEASE INDICATED                    (7)CEP31524
       TRA     INPXT         NO                                      (7)CEP31525
       LDQ     =O400000000000  SET RELEASE INDICATOR FOR THIS UNIT   (7)CEP31526
ININT  RQL     1                                                     (7)CEP31527
 INPXT AXT     1,4                                                      CEP31530
       SLW     INPTA,4        SAVE CHANNEL AND CHAIN NUMBER             CEP31540
       XCL                                                           (7)CEP31541
       ORS     CNT19                                                 (7)CEP31542
       TXI     *+1,4,1        CHANGE POINTER FOR NEXT TABLE NUMBER      CEP31550
       SXA     INPXT,4                                                  CEP31560
       SXA     ININT,4                                               (7)CEP31561
INUTB  STZ     INPNM         REINITIALIZE SWITCH                     (2)CEP31570
       CAL     =O60                                                  (2)CEP31571
       SLW     INPNU                                                 (2)CEP31572
       TXI     *+1,1,-1       CHANGE PARAMETER POINTER                  CEP31580
       TIX     INPST,2,1      TEST FOR MORE PARAMETERS                  CEP31590
       ZET     INPOJ          DONT SORT IF INTERSYSTEM                  CEP31600
       TRA     INPCT           COMMUNICATION                            CEP31610
       AXT     10,1           SORT FOR HIGHEST CHAIN NUMBER             CEP31620
 INPPP PXA     ,1                                                       CEP31630
       PAX     ,2                                                       CEP31640
       TXI     *+1,2,-1                                                 CEP31650
 INPCL CAL     INPTA,1        LOWEST WORD IN INPUT TABLE                CEP31660
       LAS     INPTA,2        COMPARE WITH HIGHER NUMBER IN TABLE       CEP31670
       TRA     INPHI          HIGHER - CHANGE POSITION                  CEP31680
       TRA     *+1            EQUAL AOK                                 CEP31690
 INPTI TIX     INPCL,2,1                                                CEP31700
       TXI     *+1,1,-1                                                 CEP31710
       TXH     INPPP,1,1                                                CEP31720
 INPCT AXT     **,2                                                     CEP31730
       LXA     OSREL,1        COMMON RELOCATION                         CEP31740
       PXD     ,2                                                       CEP31750
       ADD     REF00,1        LAST USED COMMON LOCATION                 CEP31760
       SUB     =1                                                       CEP31770
       STO     CHA00,1        SAVE IN COMMON AREA                       CEP31780
       STA     INSLW                                                    CEP31790
       SUB     =9                                                       CEP31800
       STA     REF00,1        SAVE LAST LOCATION USED                   CEP31810
       AXT     0,1                                                      CEP31820
       AXT     1,4                                                      CEP31830
       CAL     INPTA,4        MOVE TABLE TO COMMON                      CEP31840
 INSLW SLW     **,1                                                     CEP31850
       TXI     *+1,1,1        CHANGE COMMON POINTER                     CEP31860
       TXI     *+1,4,1                                                  CEP31870
       TIX     *-4,2,1        TEST FOR MORE UNITS TO MOVE               CEP31880
       STL     CSINP          SET INPUT SWITCH                          CEP31890
       TRA     DECNT                                                    CEP31900
 INPHI LDQ     INPTA,2        GET SECOND WORD IN CHANNEL TABLE          CEP31910
       STQ     INPTA,1        CHANGE POSITIONS IN TABLE                 CEP31920
       SLW     INPTA,2                                                  CEP31930
       TRA     INPTI                                                    CEP31940
 INPNR STL     INPOA          SET A TO H MODE                           CEP31950
       TXI     *+1,4,-16                                                CEP31960
       ZET     INPOJ          TEST FOR OPPOSITE MODE                    CEP31970
       TRA     INPMS          TO PRINT ERROR MESSAGE                    CEP31980
       TRA     INPZT                                                    CEP31990
 INSAV PZE                    PARTIAL REMAINDER STORAGE                 CEP32000
INPNU  OCT     60            CHAIN NUMBER                            (2)CEP32010
INPNM  PZE     0                                                     (2)CEP32011
 INPOA PZE                    A TO H MODE SWITCH                        CEP32020
 INPOJ PZE                    J TO Q MODE SWITCH                        CEP32030
 INPCN PZE                    CHANNEL INDICATOR                         CEP32040
       DUP     1,10                                                     CEP32050
       PZE                                                              CEP32060
 INPTA PZE                    CHANNEL TABLE                             CEP32070
 INRSW PZE                    RELEASE SWITCH                            CEP32080
INUSW  PZE                                                           (7)CEP32081
INPUU  STL     INUSW         SET UNLOAD MODE                         (7)CEP32085
       CAL     INSAV                                                 (7)CEP32086
       TRA     INPLG                                                 (7)CEP32087
 INPRL CAL     =O100000000000  SET RELEASE MODE FOR INTER SYSTEM        CEP32090
       SLW     INRSW          COMMUNICATION                             CEP32100
       CAL     INSAV          RESTORE REMAINDER PORTION                 CEP32110
       TRA     INPLG                                                    CEP32120
 INUTA TXH     INPER,4,4     GREATER THAN 4 IT IS ILLEGAL               CEP32130
       ZET     INUTE,4         CHECK THIS SYSUTX HAS BEEN SPECEFIED     CEP32140
       TRA     INPER           IF ALREADY SPECIFIED GO TO ERROR ROUTINE CEP32150
       CAL     INUTD,4         FIND THE ADDRESS OF SYSUT TAPES          CEP32160
       NZT     INUSW                                                 (7)CEP32169
       ORA     INRSW           COMBINE WITH THE RELEASE BIT             CEP32170
       SLW     INUTE,4         EDITED INTO TABLE                        CEP32180
       CLA     =O6463             IS ANY CHANNEL SPECIFIED              CEP32190
       NZT     INPCN              CHECK THIS IS THE FIRST TIME          CEP32200
       STO     INPCN              YES, THEN SET THE FIRST TIME SWITCH   CEP32210
       LDQ     INPCN              COMPARE THE TWO CHANNELS              CEP32220
       TLQ     INPER           IF NOT , GO TO ERROR PRINT ROUTINE       CEP32230
       STL     INUTW           SYSUTX SPECIFIED                         CEP32240
       TRA     INUTB           GO TO LOOK SECOND PARAMETER              CEP32250
       PZE     SYSUT4            LOCATION                               CEP32260
       PZE     SYSUT3             OF                                    CEP32270
       PZE     SYSUT2                THE                                CEP32280
       PZE     SYSUT1                  SYSUT TAPES                      CEP32290
 INUTD BSS     0                                                        CEP32300
       PZE                      TABLE FOR                               CEP32310
       PZE                         SYSUT TAPES                          CEP32320
       PZE                           SPECIFIED                          CEP32330
       PZE                          IN THE INPUT FIELD OF CHANNEL CARD  CEP32340
 INUTE BSS     0                                                        CEP32350
 INUNO PZE                                                              CEP32360
 INUTW PZE                                                              CEP32370
       SPACE                                                            CEP32380
*                                                                       CEP32390
* ANALYSIS OF MERGE DEFINER-CHANNEL CARD                                CEP32400
*                                                                       CEP32410
 MERCH LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP32420
       TXH     *+2,2,3         TEST FOR MORE THAN THREE PARAMETERS      CEP32430
       TXH     MERST-1,2,1     TEST FOR LESS THAN TWO CHANNELS          CEP32440
       STL     BUF42                                                    CEP32450
       TRA     DECAR                                                    CEP32460
       SXA     *+1,2           SAVE THE NUMBER OF PARAMETER IN          CEP32470
 MERST AXT     **,4            INDEX REGISTER 4                         CEP32480
       CAL     1,1            CHANNEL PARAMETER                         CEP32490
       LGR     6              EXTRACT A CHARACTER                       CEP32500
       SLW     MARCE           SAVE THE REMAIN WORD                     CEP32510
       ZAC                                                              CEP32520
       LGL     6                                                        CEP32530
       PAX     ,2             CHANNEL NUMBER                            CEP32540
       TXH     *+2,2,51        HIGHER THAN  T  GO TO ERROR              CEP32550
       TXH     MARGO,2,16      BETWEEN A TO T                           CEP32560
MAERR  STL     BUF19                                                    CEP32570
       TRA     DECAR                                                    CEP32580
 MARGO TXH     MARUT,2,24      IF HIGHER THAN H THEN CHECK IS IT SYSUTX CEP32590
       TXI     *+1,2,-16                                                CEP32600
       PXA     ,2                                                       CEP32610
       STA     CHANM-2         SAVE CHANNEL NUMBER IN CHANM-2 FOR THE   CEP32620
       CAL     MARBB           SECOND MERGE CHANNEL AND MODIFIED THE    CEP32630
       STA     *-2             INSTRUCTION 2ND ONE SAVED IN CHANM-1     CEP32640
 MARAA TXI     *+1,1,-1        CHANGE POINTER FOR NEXT CHANNEL NUMBER   CEP32650
       TIX     MERST+1,4,1                                              CEP32660
       NZT     CHANM-1         CHECK IS THERE ANY CHANNEL LEFT OVER     CEP32670
       TRA     MAERR           IF YES-- THEN GO TO ERROR PRINT ROUTINE  CEP32680
       NZT     CHANM-2                                                  CEP32690
       TRA     MAERR                                                    CEP32700
 MARBB CAL     CHANM-1         FIRST CHANNEL                            CEP32710
       LAS     CHANM-2        COMPARE FOR EQUAL                         CEP32720
       TRA     *+2                                                      CEP32730
       TRA     MARGG         SAME CHANNEL SPECIFIED TWICE               CEP32740
       STL     CSMER          SET MERGE SWITCH                          CEP32750
       TRA     DECNT                                                    CEP32760
MARGG  STL     BUF19                                                    CEP32770
       TRA     DECAR                                                    CEP32780
 MARUT TXL     MARCA,2,50      SMALLER THAN T                           CEP32790
       ZET     MARSW           SYSUT  TAPE SPECIFIED                    CEP32800
       TRA     MAERR           IF SPECIFIED THEN THIS IS AN ERROR       CEP32810
       STL     MARSW           SET SWITCH                               CEP32820
       TRA     MARAA                                                    CEP32830
 MARCA TXL     *+2,2,41        SMALLER THAN S                           CEP32840
       TRA     MAERR           EQUAL TO S, THIS IS ERROR                CEP32850
       TXL     MAERR,2,40      SMALLER THAN R                           CEP32860
       CLA     =O100000000000                                           CEP32870
       STO     MARC1           SET RELEASE SWITCH                       CEP32880
       CAL     MARCE           RESTORE THE REMAIN WORD                  CEP32890
       TRA     MERST+2         CHECK THE SECOND CHARACTER               CEP32900
 MARSW PZE                                                              CEP32910
 MARCE PZE                                                              CEP32920
 MARC1 PZE                                                              CEP32930
       BSS     2              STORAGE FOR CHANNEL NUMBERS               CEP32940
 CHANM BSS     0                                                        CEP32950
       SPACE                                                            CEP32960
*                                                                       CEP32970
* ANALYSIS OF OUTPUT-CHANNEL CARD                                       CEP32980
*                                                                       CEP32990
OUTCH  LXA     DECNT,2       MORE THAN 2 PARAMETERS.                 (2)CEP33000
       TXL     X2,2,2        NO.                                     (2)CEP33001
       TRA     OUTER         YES- ERROR.                             (2)CEP33002
X2     TXL     USUAL,2,1     ARE THERE 2 PARAMETERS. NO.             (2)CEP33003
       STL     PARAM2        YES.                                    (2)CEP33004
       CAL     2,1           GET THE SECOND PARAMETER.               (2)CEP33005
X3     LGR     6                                                     (2)CEP33006
       SLW     OUSAV2                                                (2)CEP33007
       ZAC                                                           (2)CEP33008
       LGL     6             GET ONE CHARACTER.                      (2)CEP33009
       PAX     ,4            IS IT GREATER THAN Q.                   (2)CEP3300A
       TXH     X4,4,40       YES.                                    (2)CEP3300B
       TXH     X5,4,32       NO.IS IT GREATER THAN J, YES.           (2)CEP3300C
       TXH     OUTER,4,9     NO.IS IT GREATER THAN 9, YES.           (2)CEP3300D
       ZET     OUTNMB        NO. TEST FOR NUMBER GIVEN.              (2)CEP3300E
       TRA     OUTER                                                 (2)CEP3300F
       STL     OUTNMB                                                (2)CEP3300G
       SXA     OUTNU2,4       SAVE THE NUMBER.                       (2)CEP3300H
       CAL     OUSAV2        RESTORE THE PARAMETER REMAINDER.        (2)CEP3300I
       TRA     X3                                                    (2)CEP3300J
X4     TXH     OUTER,4,48    IS IT BLANK, NO.                        (2)CEP3300K
       TXL     OUTER,4,47                 NO.                        (2)CEP3300L
       TRA     USUAL                      YES.                       (2)CEP3300M
X5     TXI     *+1,4,-24     SAVE CHANNEL J-Q.                       (2)CEP3300N
       SXA     CHANO2,4                                              (2)CEP3300O
       TRA     USUAL                                                 (2)CEP3300P
PARAM2 PZE     0                                                     (2)CEP3300Q
OUSAV2 PZE     0                                                     (2)CEP3300R
OUTNU2 OCT     60                                                    (2)CEP3300S
OUTNMB PZE     0                                                     (2)CEP3300T
CHANO2 PZE     0                                                     (2)CEP3300U
USUAL  TXL     NOPAR,2,0     TEST FOR ZERO PARAMETER.                (2)CEP33010
       CAL     1,1            PARAMETER                                 CEP33020
 OUTLG LGR     6              EXTRACT A CHARACTER                       CEP33030
       SLW     OUSAV          SAVE PARAMETER REMAINDER                  CEP33040
       ZAC                                                              CEP33050
       LGL     6                                                        CEP33060
       PAX     ,4                                                       CEP33070
       TXH     OUTSA,4,40                                               CEP33080
       TXH     OUTCO,4,32                                               CEP33090
       TXH     OUTER,4,24                                               CEP33100
       TXH     OUTNR,4,16                                               CEP33110
       TXL     OUTNO,4,9                                                CEP33120
OUTER  STL     BUF43                                                    CEP33130
       TRA     DECAR                                                    CEP33140
 OUTCO TXI     *+1,4,-24                                                CEP33150
       SXA     CHANO,4        SAVE CHANNEL NO, J-Q                      CEP33160
       STL     CSOUT          SET OUTPUT SWITCH                         CEP33170
       TRA     DECNT                                                    CEP33180
 OUTNR TXI     *+1,4,-16                                                CEP33190
       SXA     CHANO,4        SAVE CHANNEL A-H                          CEP33200
       STL     CSOUT          SET OUTPUT SWITCH                         CEP33210
       TRA     DECNT                                                    CEP33220
OUTNO  ZET     OUTNM         TEST FOR NUMBER GIVEN                   (2)CEP33230
       TRA     OUTER          TO PRINT ERROR MESSAGE                    CEP33240
       STL     OUTNM                                                 (2)CEP33241
       SXA     OUTNU,4        SAVE NUMBER                               CEP33250
       CAL     OUSAV          RESTORE PARAMETER REMAINDER               CEP33260
       TRA     OUTLG                                                    CEP33270
 OUTSA TXH     OUTER,4,41                                               CEP33280
       CAL     =O100000000000                                           CEP33290
       SLW     OUTSB                                                    CEP33300
       CAL     OUSAV                                                    CEP33310
       TRA     OUTLG                                                    CEP33320
 CHANO PZE                    CHANNEL OUTPUT DESIGNATION                CEP33330
 OUSAV PZE                    REMAINDER AREA                            CEP33340
OUTNU  OCT     60            CHAIN NUMBER                            (2)CEP33350
OUTNM  PZE     0                                                     (2)CEP33351
 OUTSB PZE                                                              CEP33360
       SPACE                                                            CEP33370
*                                                                       CEP33380
* ANALYSIS OF REELS-FILE CARD                                           CEP33390
*                                                                       CEP33400
 REEFI LXA     DECNT,2                                                  CEP33410
       TXL     NOPAR,2,0      TEST FOR PARAMETER GIVEN                  CEP33420
       STL     FSREE          SIGNIFY REELS GIVEN                       CEP33430
       CLA     1,1            PARAMETER                                 CEP33440
       LGR     6              EXTRACT ONE CHARACTER                     CEP33450
       ZAC                                                              CEP33460
       LGL     6                                                        CEP33470
       PAX     ,2                                                       CEP33480
       TXH     *+2,2,35                                                 CEP33490
       TXH     REELA,2,34     TEST FOR L                                CEP33500
       LDQ     1,1                                                      CEP33510
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP33520
       TRA     CVTER          ERROR RETURN                              CEP33530
       STO     FAR15                                                    CEP33540
       TRA     DECNT                                                    CEP33550
 REELA CAL     =-2            SET INDICATOR THAT REEL COUNT IS UNDER    CEP33560
       SLW     FAR15          LABEL CONTROL                             CEP33570
       TRA     DECNT                                                    CEP33580
       SPACE                                                            CEP33590
*                                                                       CEP33600
* ANALYSIS OF MODE DEFINER-FILE CARD                                    CEP33610
*                                                                       CEP33620
 MODFI LXA     DECNT,2                                                  CEP33630
       TXL     NOPAR,2,0      TEST FOR PARAMETER GIVEN                  CEP33640
       STZ     FAR00          REMAINS ZERO IF DECIMAL MODE              CEP33650
       CAL     1,1            GET PARAMETER                             CEP33660
       LGR     6              EXTRACT CHARACTER                         CEP33670
       ZAC                                                              CEP33680
       LGL     6                                                        CEP33690
       PAX     ,2                                                       CEP33700
       TXH     *+4,2,20       TEST FOR B OR D                           CEP33710
       TXH     DECNT,2,19                                               CEP33720
       TXH     *+2,2,18                                                 CEP33730
       TXH     MODB,2,17                                                CEP33740
       STL     BUF44                                                    CEP33750
       TRA     DECAR                                                    CEP33760
 MODB  STL     FAR00          SET BINARY MODE IN FILE BLOCK             CEP33770
       TRA     DECNT                                                    CEP33780
       SPACE                                                            CEP33790
*                                                                       CEP33800
* ANALYSIS OF DENSITY DEFINER-FILE CARD                                 CEP33810
*                                                                       CEP33820
 DENFI LXA     DECNT,2                                                  CEP33830
       TXL     NOPAR,2,0      TEST FOR PARAMETER GIVEN                  CEP33840
       STZ     FAR01          REMAINS ZERO IF HIGH DENSITY              CEP33850
       CAL     1,1                                                      CEP33860
       LGR     6              EXTRACT CHARACTER                         CEP33870
       ZAC                                                              CEP33880
       LGL     6                                                        CEP33890
       PAX     ,2                                                       CEP33900
       TXH     *+4,2,35       TEST FOR L                                CEP33910
       TXH     DENL,2,34                                                CEP33920
       TXH     *+2,2,24       TEST FOR H                                CEP33930
       TXH     DECNT,2,23                                               CEP33940
       STL     BUF45                                                    CEP33950
       TRA     DECAR                                                    CEP33960
 DENL  STL     FAR01          SET DENSITY FOR LOW                       CEP33970
       STL     FSDEN          SET DENSITY SWITCH                        CEP33980
       TRA     DECNT                                                    CEP33990
       SPACE                                                            CEP34000
*                                                                       CEP34010
* ANALYSIS OF CKSMS DEFINER-FILE CARD                                   CEP34020
*                                                                       CEP34030
 CKSFI STL     FAR08         SET SWITCH IN FILE AREA                    CEP34040
       STL     FAR19          SET CKSUMS AND BLKSEQ SWITCH              CEP34050
       TRA     DECNT                                                    CEP34060
       SPACE                                                            CEP34070
*                                                                       CEP34080
* ANALYSIS OF BLKSEQ DEFINER-FILE CARD                                  CEP34090
*                                                                       CEP34100
 BLKFI STL     FAR09          SET SWITCH IN FILE AREA                   CEP34110
       STL     FAR19          SET CKSUMS AND BLKSEQ SWITCH              CEP34120
       TRA     DECNT                                                    CEP34130
       SPACE                                                            CEP34140
*                                                                       CEP34150
* ANALYSIS OF DICTIONARY-FILE CARD                                      CEP34160
*                                                                       CEP34170
 DICFI STL     FSDIC          SET DICTIONARY SWITCH                     CEP34180
       STL     FAR10          SET SWITCH IN FILE AREA                   CEP34190
       LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP34200
       TXL     DECNT,2,0      TEST FOR A PARAMETER GIVEN                CEP34210
       CAL     1,1            PARAMETER                                 CEP34220
       LGR     6              EXTRACT ONE CHARACTER                     CEP34230
       ZAC                                                              CEP34240
       LGL     6                                                        CEP34250
       PAX     ,2                                                       CEP34260
       TXH     DICER,2,35                                               CEP34270
       TXH     DICLO,2,34                                               CEP34280
       TXH     DICER,2,24                                               CEP34290
       TXH     DICHI,2,23     TEST FOR HIGH                             CEP34300
DICER  STL     BUF46                                                    CEP34310
       TRA     DECAR                                                    CEP34320
 DICLO BSS     0                                                        CEP34330
       STL     DICSW          SET LOW DENSITY                           CEP34340
       STL     DICGI          SET DENSITY GIVEN                         CEP34350
       TRA     DECNT                                                    CEP34360
 DICHI BSS     0                                                        CEP34370
       STZ     DICSW          SET HIGH DENSITY DICTIONARY               CEP34380
       STL     DICGI          SET DENSITY GIVEN                         CEP34390
       TRA     DECNT                                                    CEP34400
 DICSW PZE                    HIGH/LOW DICTIONARY SWITCH                CEP34410
 DICGI PZE                                                              CEP34420
       SPACE                                                            CEP34430
*                                                                       CEP34440
* ANALYSIS OF RETAIN DEFINER                                            CEP34450
*                                                                       CEP34460
 RETFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP34470
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP34480
       LDQ     1,1            PARAMETER                                 CEP34490
       LGL     18             REMOVE FIRST THREE BLANKS                 CEP34500
       ZAC                                                              CEP34510
       LGL     18                                                       CEP34520
       PAI                    PARAMETER TO BE TESTED FOR BLANKS         CEP34530
       AXT     3,4                                                      CEP34540
 RETBL ONT     RETON,4        TEST FOR THREE, TWO OR ONE                CEP34550
       TRA     *+4            BLANK AND RESET BLANKS                    CEP34560
       OFT     RETOF,4        TO ZERO                                   CEP34570
       TRA     *+2                                                      CEP34580
       XEC     RETIR,4        RESET BLANK TO ZERO                       CEP34590
       TIX     RETBL,4,1                                                CEP34600
       OSI     =O606060000000 FORMAT RETAIN PARAMETER                   CEP34610
       STI     FAR18          SAVE IN FILE AREA                         CEP34620
       TRA     DECNT                                                    CEP34630
       OCT     600000                                                   CEP34640
       OCT     6000                                                     CEP34650
       OCT     60                                                       CEP34660
 RETON BSS     0                                                        CEP34670
       OCT     170000                                                   CEP34680
       OCT     1700                                                     CEP34690
       OCT     17                                                       CEP34700
 RETOF BSS     0                                                        CEP34710
       RIR     770000                                                   CEP34720
       RIR     7700                                                     CEP34730
       RIR     77                                                       CEP34740
 RETIR BSS     0                                                        CEP34750
       SPACE                                                            CEP34760
*                                                                       CEP34770
* ANALYSIS OF OUTPUT DEFINER-FILE CARD                                  CEP34780
*                                                                       CEP34790
 OUTFI STL     FSOUT                                                    CEP34800
       TRA     DECNT                                                    CEP34810
       SPACE                                                            CEP34820
*                                                                       CEP34830
* ANALYSIS OF INPUT DEFINER-FILE CARD                                   CEP34840
*                                                                       CEP34850
 INPFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP34860
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP34870
       LDQ     1,1            PARAMETER                                 CEP34880
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP34890
       TRA     CVTER          ERROR RETURN                              CEP34900
       TNZ     *+3           TEST FOR AN INPUT NUMBER GIVEN.            CEP34910
       STL     BUF47                                                    CEP34920
       TRA     DECAR                                                    CEP34930
       STO     FSINP          SAVE IN FILE INPUT SWITCH                 CEP34940
       STO     FAR14          SAVE IN FILE IMAGE AREA                   CEP34950
       TRA     DECNT                                                    CEP34960
       SPACE                                                            CEP34970
*                                                                       CEP34980
* ANALYSIS OF BLOCKING DEFINER-FILE CARD                                CEP34990
*                                                                       CEP35000
 BLOFI LXA     DECNT,2                                                  CEP35010
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP35020
       LDQ     1,1            PARAMETER                                 CEP35030
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP35040
       TRA     CVTER          ERROR RETURN                              CEP35050
       PAX     ,4                                                       CEP35060
       TXH     BLEER,4,2000   TEST FOR BLOCK MORE THAN 2000 WORDS LONG  CEP35070
       STO     FAR05                                                    CEP35080
       STL     FSBLO                                                    CEP35090
       TRA     DECNT                                                    CEP35100
BLEER  STL     BUF48                                                    CEP35110
       TRA     DECAR                                                    CEP35120
*                                                                       CEP35130
* ANALYSIS OF PADDING DEFINER-FILE CARD                                 CEP35140
*                                                                       CEP35150
 PADFI LXA     DECNT,2        NO. OF PARAMETERS                         CEP35160
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP35170
       CAL     1,1            PARAMETER                                 CEP35180
       LGR     6              EXTRACT CHARACTER                         CEP35190
       ZAC                                                              CEP35200
       LGL     6                                                        CEP35210
       PAX     ,4                                                       CEP35220
       TXH     *+4,4,35                                                 CEP35230
       TXH     PADL,4,34                                                CEP35240
       TXH     *+2,4,24                                                 CEP35250
       TXH     PADH,4,23                                                CEP35260
       STL     BUF49                                                    CEP35270
       TRA     DECAR                                                    CEP35280
 PADL  CLA     =1                                                       CEP35290
       STO     FAR02          SAVE IN FILE BLOCK                        CEP35300
       TRA     DECNT                                                    CEP35310
 PADH  CLA     =2                                                       CEP35320
       STO     FAR02          SAVE IN FILE BLOCK                        CEP35330
       TRA     DECNT                                                    CEP35340
       SPACE                                                            CEP35350
*                                                                       CEP35360
* ANALYSIS OF SERIAL NUMBER DEFINER-FILE CARD                           CEP35370
*                                                                       CEP35380
 SERFI LXA     DECNT,2        NO. OF PARAMETERS                         CEP35390
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP35400
       LDI     1,1            SERIAL NUMBER                             CEP35410
       STI     FAR06          SAVE IN FILE DATA BLOCK                   CEP35420
       TRA     DECNT                                                    CEP35430
       SPACE                                                            CEP35440
*                                                                       CEP35450
* ANALYSIS OF LABEL DEFINER-FILE CARD                                   CEP35460
*                                                                       CEP35470
 LABFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP35480
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP35490
       STL     FSLAB          SET LABEL SWITCH                          CEP35500
       STZ     FAR04          REMAINS ZERO IF HIGH DENSITY LABEL        CEP35510
       STZ     FAR03          REMAINS ZERO IF STANDARD LABEL.           CEP35520
       CAL     1,1                                                      CEP35530
       LGR     12                                                       CEP35540
       ZAC                                                              CEP35550
       AXT     2,2                                                      CEP35560
 LABCH LGL     6              EXTRACT A CHARACTER                       CEP35570
       PAX     ,4                                                       CEP35580
       ZAC                                                              CEP35590
       TXH     LABFE,4,50                                               CEP35600
       TXH     LABTI,4,49     S                                         CEP35610
       TXH     LABFE,4,48                                               CEP35620
       TXH     LABTI,4,47     BLANK                                     CEP35630
       TXH     LABFE,4,37                                               CEP35640
       TXH     LABN,4,36      N                                         CEP35650
       TXH     LABFE,4,35                                               CEP35660
       TXH     LABL,4,34      L                                         CEP35670
       TXH     LABFE,4,24                                               CEP35680
       TXH     LABTI,4,23     H                                         CEP35690
LABFE  STL     BUF50                                                    CEP35700
       TRA     DECAR                                                    CEP35710
 LABTI TIX     LABCH,2,1                                                CEP35720
       TRA     DECNT                                                    CEP35730
 LABN  CLA     =1             NON-STANDARD LABEL                        CEP35740
       STO     FAR03                                                    CEP35750
       STL     FSLAB          SET LABEL SWITCH                          CEP35760
       ZAC                                                              CEP35770
       TRA     LABTI                                                    CEP35780
 LABL  STL     FAR04          LOW DENSITY LABEL                         CEP35790
       STL     FSLAB          SET LABEL SWITCH                          CEP35800
       TRA     LABTI                                                    CEP35810
       SPACE                                                            CEP35820
*                                                                       CEP35830
* ANALYSIS OF RLSEQ NUMBER-FILE CARD                                    CEP35840
*                                                                       CEP35850
 RLSFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP35860
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP35870
       CAL     1,1            PARAMETER                                 CEP35880
       LDQ     =O606060606060                                           CEP35890
       LGL     6              BXXXXB  REEL SEQUENCE NUMBER              CEP35900
       PAI                                                              CEP35910
       AXT     4,4            NUMBER OF CHARACTERS TO CHECK             CEP35920
 RLTES ONT     RLONT,4        TEST FOR BLANK                            CEP35930
       TRA     *+4                                                      CEP35940
       OFT     RLOFT,4        FINISH TEST FOR BLANK                     CEP35950
       TRA     *+2                                                      CEP35960
       XEC     RLSET,4        RESET TO ZERO IF BLANK                    CEP35970
       TIX     RLTES,4,1      TEST FOR MORE BLANKS TO CHECK             CEP35980
       STI     FAR07          SAVE IN FILE DATA BLOCK                   CEP35990
       TRA     DECNT                                                    CEP36000
       OCT     6000000000                                               CEP36010
       OCT     60000000                                                 CEP36020
       OCT     600000                                                   CEP36030
       OCT     6000                                                     CEP36040
 RLONT BSS     0                                                        CEP36050
       OCT     1700000000                                               CEP36060
       OCT     17000000                                                 CEP36070
       OCT     170000                                                   CEP36080
       OCT     1700                                                     CEP36090
 RLOFT BSS     0                                                        CEP36100
       RIL     7700                                                     CEP36110
       RIL     77                                                       CEP36120
       RIR     770000                                                   CEP36130
       RIR     7700                                                     CEP36140
 RLSET BSS     0                                                        CEP36150
       SPACE                                                            CEP36160
*                                                                       CEP36170
* ANALYSIS OF NAME DEFINER-FILE CARD                                    CEP36180
*                                                                       CEP36190
 NAMFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP36200
       TXL     NOPAR,2,1      TEST FOR A PARAMETER                      CEP36210
       LDQ     =O606060606060                                           CEP36220
       STQ     FAR11                                                    CEP36230
       STQ     FAR12                                                    CEP36240
       STQ     FAR13                                                    CEP36250
       TXH     NAMTH,2,4      NAME OVER 3-TAKE ONLY 3                   CEP36260
       TXH     NAMTH,2,3      NAME 3 WORDS LONG                         CEP36270
       TXH     NAMTW,2,2      NAME 2 WORDS LONG                         CEP36280
       TRA     NAMON,         NAME 1 WORD LONG                          CEP36290
 NAMTH LDQ     4,1                                                      CEP36300
       STQ     FAR13                                                    CEP36310
 NAMTW LDQ     3,1                                                      CEP36320
       STQ     FAR12                                                    CEP36330
 NAMON LDQ     2,1                                                      CEP36340
       STQ     FAR11                                                    CEP36350
       CAL     1,1            NUMBER OF CHARACTERS                      CEP36360
       ANA     =O77           MASK OUT NUMBER OF CHARACTERS             CEP36370
       TZE     DECNT                                                    CEP36380
       XCL                                                              CEP36390
       ZAC                                                              CEP36400
       DVP     =6             FIND NUMBER OF WORDS                      CEP36410
       TZE     DECNT          TEST FOR FULL WORDS                       CEP36420
       XCL                                                              CEP36430
       PAC     0,4            -(NUMBER OF COMPLETE WORDS)               CEP36440
       MPY     =6             NUMBER OF CHARACTERS X 6                  CEP36450
       XCL                                                              CEP36460
       STA     *+2                                                      CEP36470
       CAL     =O606060606060                                           CEP36480
       ARS     **                                                       CEP36490
       ORS     FAR11,4                                                  CEP36500
       TRA     DECNT                                                    CEP36510
       SPACE                                                            CEP36520
*                                                                       CEP36530
* ANALYSIS OF CKPT DEFINER-FILE CARD                                    CEP36540
*                                                                       CEP36550
 CKPFI LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP36560
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP36570
       STL     FSCKP          SET CHECKPOINT SWITCH                     CEP36580
       STZ     FAR17          REMAINS ZERO IF STANDARD CHECKPOINT       CEP36590
       CAL     1,1            PARAMETER                                 CEP36600
       LGR     6              EXTRACT CHARACTER                         CEP36610
       ZAC                                                              CEP36620
       LGL     6                                                        CEP36630
       PAX     ,4                                                       CEP36640
       TXH     *+4,4,50                                                 CEP36650
       TXH     DECNT,4,49                                               CEP36660
       TXH     *+2,4,37                                                 CEP36670
       TXH     CKPN,4,36                                                CEP36680
       STL     BUF51                                                    CEP36690
       TRA     DECAR                                                    CEP36700
 CKPN  CLA     =1             N                                         CEP36710
       STO     FAR17                                                    CEP36720
       TRA     DECNT                                                    CEP36730
*                                                                       CEP36740
* ANALYSIS OF PROGRAM-MODIFICATION CARD                                 CEP36750
*                                                                       CEP36760
 PROMO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP36770
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP36780
       STZ     PROBS                                                    CEP36790
       STZ     PROFT          INITIALIZE FIVE-TEN SWITCH                CEP36800
       STZ     PRXMF                                                    CEP36810
       LDQ     1,1            PARAMETER                                 CEP36820
       ZAC                                                              CEP36830
       LGL     18                                                       CEP36840
       AXT     12,2                                                     CEP36850
       SLW     PROCP                                                    CEP36860
       CLA     PROB1,2                                                  CEP36870
       ERA     PROCP                                                    CEP36880
       TZE*    PROB2,2                                                  CEP36890
       TIX     *-3,2,1                                                  CEP36900
       STL     BUF52                                                    CEP36910
       TRA     DECAR                                                    CEP36920
       PZE     PRMXS                                                    CEP36930
       PZE     PRMMP                                                    CEP36940
       PZE     PRMFM                                                    CEP36950
       PZE     PRDXS                                                    CEP36960
       PZE     PRDMP                                                    CEP36970
       PZE     PRDFM                                                    CEP36980
       PZE     PRXSM                                                    CEP36990
       PZE     PRMPM                                                    CEP37000
       PZE     PRFMM                                                    CEP37010
       PZE     PROXS                                                    CEP37020
       PZE     PROMP                                                    CEP37030
       PZE     PROFM                                                    CEP37040
 PROB2 BSS     0                                                        CEP37050
       OCT     246762                                                   CEP37060
       OCT     244447                                                   CEP37070
       OCT     242644                                                   CEP37080
       BCI     1,000 DX       DXS                                       CEP37090
       BCI     1,000 DM       DMR                                       CEP37100
       BCI     1,000 DF       DFM                                       CEP37110
       OCT     676244         XSM                                       CEP37120
       OCT     444744         MPM                                       CEP37130
       OCT     264444         FMM                                       CEP37140
       OCT     606762         XS                                        CEP37150
       OCT     604447         MP                                        CEP37160
       OCT     602644         FM                                        CEP37170
 PROB1 BSS     0                                                        CEP37180
 PRXSM STL     PRXMF          SET NUMBER MODE                           CEP37190
       TRA     PROXS                                                    CEP37200
 PRMPM STL     PRXMF          SET NUMBER MODE                           CEP37210
       TRA     PROMP                                                    CEP37220
 PRFMM STL     PRXMF          SET NUMBER MODE                           CEP37230
       TRA     PROFM                                                    CEP37240
 PROXS CLA     =0             XS BASE                                   CEP37250
       STO     PROBS                                                    CEP37260
       TRA     PROCT                                                    CEP37270
 PROMP CLA     =10            MP BASE                                   CEP37280
       STO     PROBS                                                    CEP37290
       STL     PROFT                                                    CEP37300
       TRA     PROCT                                                    CEP37310
 PROFM CLA     =15            FM BASE                                   CEP37320
       STO     PROBS                                                    CEP37330
 PROCT NZT     PRXMF          TEST FOR M ALREADY REMOVED                CEP37340
       LGL     6              STRIP OFF M                               CEP37350
       CAL     =O606060606060                                           CEP37360
       LGL     12                                                       CEP37370
       NZT     PRXMF                                                    CEP37380
       LDQ     =H 00000       BLANK IN MQ                               CEP37390
       STQ     PRMNO          SAVE PROGRAM NUMBER                       CEP37400
       XCL                                                              CEP37410
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP37420
       TRA     CVTER          ERROR RETURN                              CEP37430
       PAX     ,4                                                       CEP37440
       NZT     PROFT          TEST FOR FIVE OR TEN                      CEP37450
       TXL     *+4,4,10                                                 CEP37460
       TXL     *+3,4,5                                                  CEP37470
       STL     BUF52                                                    CEP37480
       TRA     DECAR                                                    CEP37490
       ADD     PROBS          BASE PLUS MODIFICATION NUMBER             CEP37500
       STO     PROBS                                                    CEP37510
       STL     MSPRO                                                    CEP37520
       TRA     DECNT                                                    CEP37530
 PRXMF PZE                    M ALREADY GIVEN SWITCH                    CEP37540
 PRMNO PZE                    EXTRA MODIFICATION NUMBER                 CEP37550
 PROCP PZE                                                              CEP37560
 PROBS PZE                                                              CEP37570
 PROFT PZE                                                              CEP37580
 PRMXS STL     PRXMF          SET NUMBER MODE                           CEP37590
 PRDXS CLA     =25                                                      CEP37600
       STO     PROBS                                                    CEP37610
       TRA     PROCT                                                    CEP37620
 PRMMP STL     PRXMF          SET NUMBER MODE                           CEP37630
 PRDMP CLA     =35                                                      CEP37640
       STO     PROBS                                                    CEP37650
       STL     PROFT          SET FIVE-TEN SWITCH                       CEP37660
       TRA     PROCT                                                    CEP37670
 PRMFM STL     PRXMF          SET NUMBER MODE                           CEP37680
 PRDFM CLA     =40                                                      CEP37690
       STO     PROBS                                                    CEP37700
       TRA     PROCT                                                    CEP37710
       SPACE                                                            CEP37720
*                                                                       CEP37730
* ANALYSIS OF CELLS DEFINER-MODIFICATION CARD                           CEP37740
*                                                                       CEP37750
 CELMO LXA     DECNT,2        NUMBER PARAMETERS                         CEP37760
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP37770
       LDQ     1,1                                                      CEP37780
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP37790
       TRA     CVTER          ERROR RETURN                              CEP37800
       STO     MSCEL          SET CELLS SWITCH                          CEP37810
       TRA     DECNT                                                    CEP37820
       SPACE                                                            CEP37830
*                                                                       CEP37840
* ANALYSIS OF LOCATION-MODIFICATION CARD                                CEP37850
*                                                                       CEP37860
 LOCMO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP37870
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP37880
       STZ     LOCSW          SET LOCATION SWITCH                       CEP37890
       AXT     SYSUNT-LOCSW,4                                           CEP37900
       CAL     SYSUNT,4       GET LOCATION NAME FROM TABLE              CEP37910
       ERA     1,1                                                      CEP37920
       TZE     LOCUT          TEST FOR MODIFICATION GIVEN               CEP37930
       TIX     *-3,4,1                                                  CEP37940
       STL     BUF53                                                    CEP37950
       TRA     DECAR          TO SET ERROR SWITCH                       CEP37960
 LOCUT CLA     SYSLTB,4                                                 CEP37970
       STO     LOCSW                                                    CEP37980
       TRA     DECNT                                                    CEP37990
 LOCSW PZE                    LOCATION OF MOD- 0 FOR LB1 NZ FOR IN1     CEP38000
       SPACE                                                            CEP38010
*                                                                       CEP38020
*  TABLE OF ALLOWABLE MODIFICATION LOCATIONS                            CEP38030
*                                                                       CEP38040
       BCI     1,SYSLB1                                                 CEP38050
       BCI     1,SYSLB2                                                 CEP38060
       BCI     1,SYSLB3                                                 CEP38070
       BCI     1,SYSLB4                                                 CEP38080
       BCI     1,SYSIN1                                                 CEP38090
       BCI     1,SYSIN2                                                 CEP38100
       BCI     1,SYSCRD                                                 CEP38110
       BCI     1,SYSOU1                                                 CEP38120
       BCI     1,SYSOU2                                                 CEP38130
       BCI     1,SYSPP1                                                 CEP38140
       BCI     1,SYSPP2                                                 CEP38150
       BCI     1,SYSCK1                                                 CEP38160
       BCI     1,SYSCK2                                                 CEP38170
       BCI     1,SYSUT1                                                 CEP38180
       BCI     1,SYSUT2                                                 CEP38190
       BCI     1,SYSUT3                                                 CEP38200
       BCI     1,SYSUT4                                                 CEP38210
SYSUNT BSS     0                                                        CEP38220
       SPACE                                                            CEP38230
*                                                                       CEP38240
*  TABLE OF MODIFICATION LOCATIONS                                      CEP38250
*                                                                       CEP38260
       PZE                                                              CEP38270
       PZE     ,,SYSLB2                                                 CEP38280
       PZE     ,,SYSLB3                                                 CEP38290
       PZE     ,,SYSLB4                                                 CEP38300
       PZE     ,,SYSIN1                                                 CEP38310
       PZE     ,,SYSIN2                                                 CEP38320
       PZE     ,,SYSCRD                                                 CEP38330
       PZE     ,,SYSOU1                                                 CEP38340
       PZE     ,,SYSOU2                                                 CEP38350
       PZE     ,,SYSPP1                                                 CEP38360
       PZE     ,,SYSPP2                                                 CEP38370
       PZE     ,,SYSCK1                                                 CEP38380
       PZE     ,,SYSCK2                                                 CEP38390
       PZE     ,,SYSUT1                                                 CEP38400
       PZE     ,,SYSUT2                                                 CEP38410
       PZE     ,,SYSUT3                                                 CEP38420
       PZE     ,,SYSUT4                                                 CEP38430
SYSLTB BSS     0                                                        CEP38440
       SPACE                                                            CEP38450
*                                                                       CEP38460
*                                                                       CEP38470
* ANALYSIS OF FORMAT DEFINER-MODIFICATION CARD                          CEP38480
*                                                                       CEP38490
 FORMO LXA     DECNT,2       NUMBER OF PARAMETERS                       CEP38500
       TXL     NOPAR,2,0     TEST FOR A PARAMETER                       CEP38510
       CAL     1,1                                                      CEP38520
       LGR     6                                                        CEP38530
       ZAC                                                              CEP38540
       LGL     6                                                        CEP38550
       PAX     ,4                                                       CEP38560
       TXH     FORER,4,52                                               CEP38570
       TXH     FORUN,4,51    TEST FOR UNBLOCKED                         CEP38580
       TXH     FORER,4,18                                               CEP38590
       TXH     DECNT,4,17    TEST FOR BLOCKED                           CEP38600
FORER  STL     BUF54                                                    CEP38610
       TRA     DECAR                                                    CEP38620
 FORUN STL     MSFOR         SET UNBLOCKED MODE                         CEP38630
       TRA     DECNT                                                    CEP38640
       SPACE                                                            CEP38650
*                                                                       CEP38660
* ANALYSIS OF TYPE DEFINER-RECORD CARD                                  CEP38670
*                                                                       CEP38680
 TYPRE LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP38690
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP38700
       STZ     TYPFV                                                    CEP38710
       CAL     1,1            PARAMETER                                 CEP38720
       LGR     6              EXTRACT CHARACTER                         CEP38730
       ZAC                                                              CEP38740
       LGL     6                                                        CEP38750
       PAX     ,4                                                       CEP38760
       TXH     TYPER,4,53     TEST FOR ILLEGAL CHARACTER                CEP38770
       TXH     TYPVA,4,52     V FOR VARIABLE                            CEP38780
       TXH     *+2,4,22       TEST FOR FIXED TYPE                       CEP38790
       TXH     DECNT,4,21     F                                         CEP38800
TYPER  STL     BUF55                                                    CEP38810
       TRA     DECAR                                                    CEP38820
 TYPVA BSS     0                                                        CEP38830
       STL     TYPFV          SET VARIABLE TYPE                         CEP38840
       TRA     DECNT                                                    CEP38850
 TYPFV PZE                                                              CEP38860
       SPACE                                                            CEP38870
*                                                                       CEP38880
* ANALYSIS OF LENGTH DEFINER-RECORD CARD                                CEP38890
*                                                                       CEP38900
 LENRE LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP38910
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP38920
       TXL     *+3,2,3       NO MORE THAN THREE LENGTHS ARE ALLOWED.    CEP38930
       STL     BUF14                                                    CEP38940
       TRA     DECAR          TO ERROR SWITCH                           CEP38950
       SXA     LENNO,2        SAVE NUMBER OF LENGTHS                    CEP38960
 LENST LDQ     1,1            PARAMETER                                 CEP38970
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP38980
       TRA     CVTER          ERROR RETURN                              CEP38990
       AXT     1,4                                                      CEP39000
       STO     LENTA,4                                                  CEP39010
       TXI     *+1,4,1                                                  CEP39020
       SXA     *-3,4                                                    CEP39030
       TXI     *+1,1,-1       ADVANCE TO NEXT LOCATION                  CEP39040
       TIX     LENST,2,1      RETURN IF MORE LENGTHS                    CEP39050
       STL     RSLEN          SET LENGTH SWITCH                         CEP39060
       TRA     DECNT                                                    CEP39070
       BSS     5              TABLE FOR RECORD LENGTHS                  CEP39080
 LENTA BSS     0                                                        CEP39090
 LENNO                                                                  CEP39100
       SPACE                                                            CEP39110
*                                                                       CEP39120
* ANALYSIS OF FIELD DEFINER-RECORD CARD                                 CEP39130
*                                                                       CEP39140
 FIERE LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP39150
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP39160
       TXL     *+3,2,200     TEST FOR MORE THAN 200 CONTROL FIELDS.     CEP39170
       STL     BUF56                                                    CEP39180
       TRA     DECAR                                                    CEP39190
       STZ     FIEBC          INITIALIZE AS CHARACTERS                  CEP39200
       SXA     FIENO,2        SAVE NUMBER OF CONTROL FIELDS             CEP39210
       AXT     1,4                                                      CEP39220
FIEST  ZAC                                                           (4)CEP39221
       PAI                                                           (4)CEP39222
       CLA     1,1           PARAMETER                               (4)CEP39223
       TMI     1WRD          MORE THAN 1-WORD. NO.                   (4)CEP39224
       ARS     30                                                   (10)CEP39225
       TNZ     1WRD           ONE WORD                              (10)CEP39226
       CAL     1,1            TWO WORD PARAMETER                    (10)CEP39227
       PAI                                                          (10)CEP39228
       RFT     777700         MORE THAN SEVEN CHARACTERS            (10)CEP39229
       TRA     FIERR          YES                                   (10)CEP3922A
       CAL     DEFE4          ADD ONE TO LOCATION OF FIRST          (10)CEP3922B
       ADD     =1                DEFINER FOR ADVANCE TO NEXT         (4)CEP39230
       SLW     DEFE4             DEFINER                             (4)CEP39231
       TXI     *+2,1,-1      NO.                                     (4)CEP39232
1WRD   STL     ILGLNO                                                (4)CEP39233
       CAL     1,1           PARAMETER                               (4)CEP39234
       LGR     6              GET A CHARACTER                           CEP39240
       SLW     FIESV          SAVE PARAMETER                            CEP39250
       ZAC                                                              CEP39260
       LGL     6                                                        CEP39270
       SXA     FIEXF,4                                                  CEP39280
       PAX     0,4            TEST FOR U, S, C, B OR NUMERIC            CEP39290
       TXH     FIERR,4,52     ILLEGAL CHARACTER                         CEP39300
       TXH     FIEUN,4,51     U                                         CEP39310
       TXH     FIERR,4,50     ILLEGAL CHARACTER                         CEP39320
       TXH     FIESN,4,49     S                                         CEP39330
       TXH     FIERR,4,19     ILLEGAL CHARACTER                         CEP39340
       TXH     FIECH,4,18     C                                         CEP39350
       TXH     FIEBI,4,17     B                                         CEP39360
       TXH     FIERR,4,9      ILLEGAL CHARACTER                         CEP39370
       NZT     ILGLNO        ARE THERE 7 NUMBERS IN A PARAMETER      (4)CEP39371
       TRA     FIERR         YES                                     (4)CEP39372
       LGR     6             NO                                      (4)CEP39380
       CAL     FIESV       RESTORE PARAMETER REMAINDER               (4)CEP39381
       OAI                   PLACE FIRST PART OF PARAMETER WITH      (4)CEP39382
       PIA                      REST OF PARAMETER(IF TWO WORDS)      (4)CEP39390
       LGL     6              RESTORE NUMERIC NUMBER TO PARAMETER       CEP39400
       XCL                                                              CEP39410
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP39420
       TRA     CVTER          ERROR RETURN                              CEP39430
       XCA                                                              CEP39440
 FIEXF AXT     **,4           RESTORE REGISTER                          CEP39450
       NZT     FIEBC          TEST FOR BITS OR CHARACTERS               CEP39460
       MPY     =6             CONVERT NO. CHARACTERS TO NO. BITS        CEP39470
       STQ     FIELN,4        SAVE FIELD LENGTH IN LENGTH TABLE         CEP39480
       SXA     FIAXT,1                                                  CEP39490
       ZAC                                                              CEP39500
       LXA     OSREL,1        COMMON RELOCATION                         CEP39510
       DVP     =6             TEST FOR BCE FIELD DIVISABLE BY 6         CEP39520
       TZE     FIAXT          TRANSFER WHEN DIVISABLE BY 6              CEP39530
       STL     NOTSX          SET FIELDS NOT MULTIPLE OF SIX            CEP39540
       ZET     GEN01,1        TEST FOR BINARY OR BCD MODE               CEP39550
       TRA     FIAXT          BINARY                                    CEP39560
       STL     BUF57                                                    CEP39570
       TRA     DECAR                                                    CEP39580
 FIAXT AXT     **,1                                                     CEP39590
       STZ     FIEBC          INITIALIZE CHARACTER BIT SWITCH           CEP39600
       TXI     *+1,1,-1                                                 CEP39610
       TXI     *+1,4,1                                                  CEP39620
       TIX     FIEST,2,1                                                CEP39630
       STL     RSFIE                                                    CEP39640
       TRA     FICAL                                                    CEP39650
FIERR  STL     BUF15                                                    CEP39660
       TRA     DECAR                                                    CEP39670
 FIEUN XEC     FIEXF          SET FIELD AS UNSIGNED                     CEP39680
       STL     ILGLNO                                                (4)CEP39681
       STZ     FIEUS,4                                                  CEP39690
       CAL     FIESV         RESTORE PARAMETER REMAINDER                CEP39700
       TRA     1WRD+2                                                (4)CEP39710
 FIESN XEC     FIEXF          SET FIELD AS SIGNED                       CEP39720
       STL     ILGLNO                                                (4)CEP39721
       STL     FIEUS,4                                                  CEP39730
       CAL     FIESV         RESTORE PARAMETER REMAINDER                CEP39740
       TRA     1WRD+2                                                (4)CEP39750
 FIECH STZ     FIEBC          SET FIELD AS CHARACTERS                   CEP39760
       STL     ILGLNO                                                (4)CEP39761
       XEC     FIEXF                                                    CEP39770
       CAL     FIESV         RESTORE PARAMETER REMAINDER                CEP39780
       TRA     1WRD+2                                                (4)CEP39790
 FIEBI STL     FIEBC          SET FIELD AS BINARY                       CEP39800
       STL     ILGLNO                                                (4)CEP39801
       XEC     FIEXF                                                    CEP39810
       CAL     FIESV         RESTORE PARAMETER REMAINDER                CEP39820
       TRA     1WRD+2                                                (4)CEP39830
 FIENO PZE                                                              CEP39840
 FIEBC PZE                                                              CEP39850
 FIESV PZE                                                              CEP39860
 NOTSX PZE                                                              CEP39870
ILGLNO PZE                   7 NUMBERS NOT PERMISSABLE IN PARAMETER  (4)CEP39871
       SPACE                                                            CEP39880
*                                                                       CEP39890
* CALCULATIONS FOR RECORD CONTROL FIELDS                                CEP39900
*                                                                       CEP39910
*                                                                       CEP39920
* GENERATES STARTING WORD                                               CEP39930
* GENERATES STARTING BIT                                                CEP39940
* GENERATES ENDING BIT                                                  CEP39950
* GENERATES NUMBER OF WORDS CONTROL FIELD EXTENDS OVER                  CEP39960
* GENERATES A LEFT MASK                                                 CEP39970
* GENERATES A RIGHT MASK                                                CEP39980
 FICAL STZ     FLDSM          INITIALIZE SUM OF ALL PREVIOUS CONTROL FLDCEP39990
       AXT     1,4            CONTROL FIELD REFERENCE                   CEP40000
       LXA     FIENO,2        NUMBER OF CONTROL FIELDS                  CEP40010
 FIBEG ZET     FLDSM          TEST FOR A SUM OF PREVIOUS FIELDS         CEP40020
       TRA     *+5                                                      CEP40030
       CLA     =1                                                       CEP40040
       STO     FILSW,4        STARTING WORD FIRST GO ROUND              CEP40050
       STZ     FILSB,4        STARTING BIT FIRST GO ROUND               CEP40060
       TRA     FISTA                                                    CEP40070
       ZAC                                                              CEP40080
       LDQ     FLDSM          SUM OF ALL PREVIOUS FIELDS                CEP40090
       DVP     =36            CALCULATE STARTING BIT                    CEP40100
       STO     FILSB,4        FIELD STARTING BIT                        CEP40110
       XCA                                                              CEP40120
       ADD     =1             CALCULATE STARTING WORD                   CEP40130
       STO     FILSW,4        FIELD STARTING WORD                       CEP40140
 FISTA CLA     FILSB,4        STARTING BIT                              CEP40150
       ADD     FIELN,4        FIELD LENGTH                              CEP40160
       SUB     =1             CALCULATE NUMBER OF WORDS                 CEP40170
       XCA                    CONTROL FIELD EXTENDS OVER                CEP40180
       ZAC                                                              CEP40190
       DVP     =36                                                      CEP40200
       XCA                                                              CEP40210
       ADD     =1             NUMBER OF WORDS CONTROL FIELD             CEP40220
       STO     FILNW,4        EXTENDS OVER                              CEP40230
       CLA     FLDSM          SUM THIS FIELD WITH ALL                   CEP40240
       ADD     FIELN,4        PREVIOUS CONTROL FIELDS                   CEP40250
       STO     FLDSM                                                    CEP40260
       SUB     =1             CALCULATE LAST BIT                        CEP40270
       XCA                                                              CEP40280
       ZAC                                                              CEP40290
       DVP     =36            36-(REMAINDER + 1)  =  LAST BIT           CEP40300
       ADD     =1                                                       CEP40310
       STO     FILPB                                                    CEP40320
       CLA     =36                                                      CEP40330
       SUB     FILPB                                                    CEP40340
       STO     FILLB,4        LAST BIT                                  CEP40350
       STA     *+2                                                      CEP40360
       CAL     =O777777777777 FULL MASK                                 CEP40370
       ALS     **             SHIFT MASK TO END BIT                     CEP40380
       SLW     FILRM,4        SAVE RIGHT MASK                           CEP40390
       CLA     FILSB,4        GENERATE LEFT MASK                        CEP40400
       STA     *+2            STARTING BIT                              CEP40410
       CAL     =O777777777777                                           CEP40420
       ARS     **             SHIFT TO STARTING BIT                     CEP40430
       SLW     FILLM,4        SAVE LEFT MASK                            CEP40440
       CLA     FILNW,4        TEST FOR CONTROL FIELD EXTENDING          CEP40450
       SUB     =1             OVER ONLY ONE WORD                        CEP40460
       TNZ     *+5                                                      CEP40470
       CAL     FILLM,4        ONLY ONE WORD                             CEP40480
       ANA     FILRM,4        COMBINE MASKS                             CEP40490
       SLW     FILLM,4        SAVE COMBINED MASK IN BOTH                CEP40500
       SLW     FILRM,4        LEFT AND RIGHT MASK POSITION              CEP40510
       TXI     *+1,4,1        INCREASE CONTROL FIELD POINTER            CEP40520
       TIX     FIBEG,2,1      TEST FOR ANOTHER GO ROUND                 CEP40530
       TRA     DECNT                                                    CEP40540
 FIELN BES     200            FIELD LENGTH                              CEP40550
 FIEUS BES     200            SIGN OF CONTROL FIELD                     CEP40560
 FILSW BES     200            STARTING WORD OF FIELD                    CEP40570
 FILSB BES     200            STARTING BIT OF FIELD                     CEP40580
 FILLB BES     200            LAST BIT OF FIELD                         CEP40590
 FILNW BES     200            NUMBER OF WORDS IN CONTROL FIELD          CEP40600
 FILLM BES     200            LEFT MASK                                 CEP40610
 FILRM BES     200            RIGHT MASK                                CEP40620
 FLDSM PZE                                                              CEP40630
 FILPB PZE                                                              CEP40640
       SPACE                                                            CEP40650
*                                                                       CEP40660
* ANALYSIS OF FIELD-DELETE CARD                                         CEP40670
*                                                                       CEP40680
 FIEDE LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP40690
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP40700
       LDQ     1,1            PARAMETER                                 CEP40710
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP40720
       TRA     CVTER          ERROR RETURN                              CEP40730
       STO     DSFIE          SET DELETE FIELD SWITCH                   CEP40740
       TRA     DECNT                                                    CEP40750
       SPACE                                                            CEP40760
*                                                                       CEP40770
* ANALYSIS OF IDENTIFICATION DEFINER-DELETE CARD                        CEP40780
*                                                                       CEP40790
 IDEDE LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP40800
       TXL     NOPAR,2,0      TEST FOR A PARAMETER GIVEN                CEP40810
       LDQ     1,1            TYPE OF CHARACTER AND COUNT               CEP40820
       ZAC                                                              CEP40830
       LGL     6              EXTRACT CHARACTER                         CEP40840
       PAX     ,4                                                       CEP40850
       ZAC                                                              CEP40860
       LGR     6              SHIFT COUNT IN RIGHT POSITION             CEP40870
       XCA                                                              CEP40880
       PAX     ,2                                                       CEP40890
       TXH     *+6,4,38       TEST FOR HIGHER THAN O                    CEP40900
       TXH     IDEOC,4,37     TEST FOR O                                CEP40910
       TXH     *+4,4,24       TEST FOR HIGHER THAN H                    CEP40920
       TXH     IDECH,4,23     TEST FOR H                                CEP40930
       TXH     *+2,4,18       TEST FOR HIGHER THAN B                    CEP40940
       TXH     IDEBI,4,17     TEST FOR B                                CEP40950
       STL     BUF18                                                    CEP40960
       TRA     DECAR                                                    CEP40970
 IDELE PZE                                                              CEP40980
 IDECH PXA     0,2            NUMBER OF CHARACTERS                      CEP40990
       XCL                                                              CEP41000
       MPY     =6             CHANGE NUMBER OF CHARACTERS TO BITS       CEP41010
       STQ     IDELE                                                    CEP41020
       AXT     1,4            TABLE POINTER                             CEP41030
       LDQ     2,1            PARAMETER                                 CEP41040
       STQ     IDETA,4        SAVE IN IDENTIFICATION TABLE              CEP41050
       TXI     *+1,4,1                                                  CEP41060
       TXI     *+1,1,-1       CHANGE PARAMETER POINTER                  CEP41070
       TIX     *-4,2,6        TEST FOR ANOTHER PARAMETER                CEP41080
 IDEXX STL     DSIDE                                                    CEP41090
       TRA     DECNT                                                    CEP41100
       BSS     50                                                       CEP41110
 IDETA BSS     0                                                        CEP41120
 IDEOC PXA     0,2            NUMBER OF CHARACTERS                      CEP41130
       XCL                                                              CEP41140
       MPY     =3             CHANGE NUMBER OF CHARACTERS TO BITS       CEP41150
       STQ     IDELE                                                    CEP41160
       AXT     1,4            INITIALIZE TABLE POINTER                  CEP41170
       SXA     IDETP,4                                                  CEP41180
       AXT     50,4                                                     CEP41190
       STZ     IDETA,4        CLEAR IDENTIFICATION TABLE                CEP41200
       TIX     *-1,4,1                                                  CEP41210
       LDI     =O7            OCTAL MASK                                CEP41220
       SXA     IDETO,2        SAVE NUMBER OF PARAMETERS LEFT            CEP41230
 IDEAX AXT     0,4            OCTAL SHIFT COUNTER                       CEP41240
 IDEFT LDQ     2,1            PARAMETER                                 CEP41250
       SXA     IDEON,1        SAVE PARAMETER POINTER                    CEP41260
       AXT     6,1                                                      CEP41270
 IDESD ZAC                                                              CEP41280
       LGL     6              EXTRACT ONE OCTAL CHARACTER               CEP41290
       TIO     IDETP          TEST FOR OCTAL 1 TO 7                     CEP41300
       STL     BUF18                                                    CEP41310
       TRA     DECAR                                                    CEP41320
 IDETP AXT     **,2           TABLE POINTER                             CEP41330
       ALS     33,4           SHIFT TO PROPER OCTAL POSITION            CEP41340
       ORS     IDETA,2        PLACE IN IDENTIFICATION WORD              CEP41350
       TXI     *+1,4,3        INCREASE SHIFT COUNTER                    CEP41360
 IDETO AXT     **,2                                                     CEP41370
       TNX     IDEXX,2,1      TEST FOR A CHARACTER LEFT                 CEP41380
       SXA     IDETO,2                                                  CEP41390
       TIX     IDESD,1,1      TEST FOR DEPLETION OF THIS WORD           CEP41400
       TXL     IDEON,4,33     TEST FOR FULL IDENTIFICATION WORD         CEP41410
       XEC     IDETP          CHANGE IDENTIFICATION TABLE POINTER       CEP41420
       TXI     *+1,2,1                                                  CEP41430
       SXA     IDETP,2                                                  CEP41440
       XEC     IDEAX          RESTORE OCTAL SHIFT COUNTER               CEP41450
 IDEON AXT     **,1                                                     CEP41460
       TXI     IDEFT,1,-1     CHANGE POINTER TO NEXT WORD               CEP41470
 IDEBI SXA     IDELE,2        SAVE NUMBER OF BITS                       CEP41480
       AXT     1,4            INITIALIZE TABLE POINTER                  CEP41490
       SXA     IDEBP,4                                                  CEP41500
       AXT     50,4                                                     CEP41510
       STZ     IDETA,4        CLEAR IDENTIFICATION TABLE                CEP41520
       TIX     *-1,4,1                                                  CEP41530
       LDI     =O1            BINARY BIT MASK                           CEP41540
       SXA     IDEBO,2        SAVE NUMBER OF BITS REMAINING             CEP41550
 IDEBX AXT     0,4            BINARY SHIFT COUNTER                      CEP41560
 IDEBT LDQ     2,1            PARAMETER                                 CEP41570
       SXA     IDEBN,1        SAVE PARAMETER POINTER                    CEP41580
       AXT     6,1                                                      CEP41590
 IDESB ZAC                                                              CEP41600
       LGL     6              EXTRACT ONE BINARY BIT                    CEP41610
       TIO     IDEBP          TEST FOR BINARY 1 OR 0                    CEP41620
       STL     BUF18                                                    CEP41630
       TRA     DECAR                                                    CEP41640
 IDEBP AXT     **,2           TABLE POINTER                             CEP41650
       ALS     35,4           SHIFT TO PROPER BINARY POSITION           CEP41660
       ORS     IDETA,2        PLACE IN IDENTIFICATION WORD              CEP41670
       TXI     *+1,4,1        NEXT POSITION IN WORD                     CEP41680
 IDEBO AXT     **,2           NUMBER OF BITS LEFT                       CEP41690
       TNX     IDEXX,2,1      TEST FOR A BIT LEFT                       CEP41700
       SXA     IDEBO,2                                                  CEP41710
       TIX     IDESB,1,1      TEST FOR DEPLETION OF THIS WORD           CEP41720
       TXL     IDEBN,4,35     TEST FOR FULL IDENTIFICATION WORD         CEP41730
       XEC     IDEBP          CHANGE IDENTIFICATION TABLE POINTER       CEP41740
       TXI     *+1,2,1                                                  CEP41750
       SXA     IDEBP,2                                                  CEP41760
       XEC     IDEBX          RESTORE BINARY SHIFT COUNTER              CEP41770
 IDEBN AXT     **,1                                                     CEP41780
       TXI     IDEBT,1,-1                                               CEP41790
       SPACE                                                            CEP41800
*                                                                       CEP41810
* ANALYSIS OF ORDER DEFINER-SORT CARD                                   CEP41820
*                                                                       CEP41830
 ORDSO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP41840
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP41850
       LDQ     1,1            PARAMETER                                 CEP41860
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP41870
       TRA     CVTER          ERROR RETURN                              CEP41880
       PAX     ,4                                                       CEP41890
       TXL     *+3,4,8       TEST FOR EIGHT WAY MERGE OR LESS.          CEP41900
       STL     BUF21                                                    CEP41910
       TRA     DECAR                                                    CEP41920
       STO     SSORD          SAVE MERGE ORDER AND SET SWITCH           CEP41930
       TRA     DECNT                                                    CEP41940
       SPACE                                                            CEP41950
*                                                                       CEP41960
* ANALYSIS OF SEQUENCE DEFINER-SORT CARD                                CEP41970
*                                                                       CEP41980
 SEQSO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP41990
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP42000
       STZ     SESCS          REMAINS ZERO IF SCIENTIFIC SEQUENCE       CEP42010
       STL     SSSEQ          SET SEQUENCE SWITCH                       CEP42020
       CAL     1,1            PARAMETER                                 CEP42030
       LGR     6              EXTRACT CHARACTER                         CEP42040
       ZAC                                                              CEP42050
       LGL     6                                                        CEP42060
       PAX     ,4                                                       CEP42070
       TXH     *+4,4,50       TEST FOR HIGHER THAN S                    CEP42080
       TXH     DECNT,4,49     TEST FOR SCIENTIFIC SEQUENCE              CEP42090
       TXH     *+2,4,19       TEST FOR HIGHER THAN C                    CEP42100
       TXH     SEQSC,4,18     TEST FOR COMMERCIAL SEQUENCE              CEP42110
       STL     BUF58                                                    CEP42120
       TRA     DECAR                                                    CEP42130
 SEQSC STL     SESCS          SET COMMERCIAL SEQUENCE                   CEP42140
       STL     SSSEQ          SET SEQUENCE SWITCH                       CEP42150
       NZT     NOTSX          TEST FOR FIELDS NOT SIX CHARACTERS        CEP42160
       TRA     DECNT                                                    CEP42170
NOSIX  STL     BUF59                                                    CEP42180
       TRA     DECAR                                                    CEP42190
 SESCS PZE                    COMMERCIAL-SCIENTIFIC SWITCH              CEP42200
       SPACE                                                            CEP42210
*                                                                       CEP42220
* ANALYSIS OF FILE DEFINER-SORT CARD                                    CEP42230
*                                                                       CEP42240
 FILSO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP42250
       TXL     FILQA,2,0      TEST FOR A PARAMETER                      CEP42260
       LDQ     1,1            PARAMETER                                 CEP42270
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP42280
       TRA     CVTER          ERROR RETURN                              CEP42290
       STO     SSFIL          SAVE FILE NO. AND SET SWITCH              CEP42300
       TRA     DECNT                                                    CEP42310
 FILQA LXA     FILCO,2                                                  CEP42320
       TXH     NOPAR,2,1                                                CEP42330
       CAL     FILIN,2                                                  CEP42340
       PDX     ,2                                                       CEP42350
       SXA     SSFIL,2                                                  CEP42360
       TRA     DECNT                                                    CEP42370
       SPACE                                                            CEP42380
*                                                                       CEP42390
* ANALYSIS OF FIELD DEFINER-SORT CARD                                   CEP42400
*                                                                       CEP42410
 FIESO LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP42420
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP42430
 FIESS STZ     FIEAD          CLEAR ASCENDING-DESCENDING SWITCH         CEP42440
       CAL     1,1            PARAMETER                                 CEP42450
 FIESG LGR     6              EXTRACT ONE CHARACTER                     CEP42460
       SLW     FIEMS          SAVE REMAINDER OF PARAMETER               CEP42470
       ZAC                                                              CEP42480
       LGL     6                                                        CEP42490
       PAX     ,4                                                       CEP42500
       TXH     *+5,4,20       TEST FOR HIGHER THAN D                    CEP42510
       TXH     FIESD,4,19     TEST FOR D                                CEP42520
       TXH     *+3,4,17       TEST FOR HIGHER THAN A                    CEP42530
       TXH     FIESA,4,16     TEST FOR A                                CEP42540
       TXL     FIESR,4,9      TEST FOR NUMBER ONLY                      CEP42550
       STL     BUF26                                                    CEP42560
       TRA     DECAR                                                    CEP42570
 FIESR LGR     6              RESTORE NUMERICAL CHARACHTER              CEP42580
       CAL     FIEMS          TO PARAMETER                              CEP42590
       LGL     6                                                        CEP42600
       XCL                                                              CEP42610
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP42620
       TRA     CVTER          ERROR RETURN                              CEP42630
 FIESX AXT     1,4            FIELD DEFINER POINTER                     CEP42640
       STO     REFST,4        SAVE FIELD NUMBER                         CEP42650
       CLA     FIEAD                                                    CEP42660
       STO     RESAD,4        SAVE ASCENDING OR DESCENDING SWITCH       CEP42670
       TXI     *+1,4,1        NEXT CONTROL WORD POINTER                 CEP42680
       SXA     FIESX,4        SAVE POINTER FOR NEXT GO ROUND            CEP42690
       TXI     *+1,1,-1       NEXT CONTROL WORD POINTER                 CEP42700
       TIX     FIESS,2,1      TEST FOR MORE FIELDS                      CEP42710
       STL     SSFIE          SET SORT FIELD SWITCH                     CEP42720
       TRA     DECNT                                                    CEP42730
 FIESD STL     FIEAD          SET SWITCH FOR DESCENDING                 CEP42740
       CAL     FIEMS          RESTORE WORD REMAINDER                    CEP42750
       TRA     FIESG                                                    CEP42760
 FIESA STZ     FIEAD          SET SWITCH FOR ASCENDING                  CEP42770
       CAL     FIEMS          RESTORE WORD REMAINDER                    CEP42780
       TRA     FIESG                                                    CEP42790
 FIEAD PZE                    ASCENDING-DESCENDING SWITCH               CEP42800
 FIEMS PZE                    WORD REMAINDER STORAGE                    CEP42810
       BSS     200                                                      CEP42820
 REFST BSS     0              FIELD STORAGE TABLE                       CEP42830
       BSS     200                                                      CEP42840
 RESAD BSS     0              ASCENDING-DESCENDING TABLE                CEP42850
       SPACE                                                            CEP42860
*                                                                       CEP42870
* ANALYSIS OF ORDER DEFINER-MERGE CARD                                  CEP42880
*                                                                       CEP42890
 ORDME LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP42900
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP42910
       LDQ     1,1            PARAMETER                                 CEP42920
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP42930
       TRA     CVTER          ERROR RETURN                              CEP42940
       PAX     ,4                                                       CEP42950
       TXL     *+3,4,8       TEST FOR EIGHT WAY MERGE OR LESS.          CEP42960
       STL     BUF21                                                    CEP42970
       TRA     DECAR                                                    CEP42980
       STO     MSORD          SAVE MERGE ORDER AND SET SWITCH           CEP42990
       TRA     DECNT                                                    CEP43000
       SPACE                                                            CEP43010
*                                                                       CEP43020
* ANALYSIS OF SEQUENCE DEFINER-MERGE CARD                               CEP43030
*                                                                       CEP43040
 SEQME LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP43050
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP43060
       CAL     1,1            PARAMETER                                 CEP43070
       LGR     6              EXTRACT CHARACTER                         CEP43080
       ZAC                                                              CEP43090
       LGL     6                                                        CEP43100
       PAX     ,4                                                       CEP43110
       TXH     *+4,4,50       TEST FOR HIGHER THAN S                    CEP43120
       TXH     SEQMS,4,49     TEST FOR SCIENTIFIC SEQUENCE              CEP43130
       TXH     *+2,4,19       TEST FOR HIGHER THAN C                    CEP43140
       TXH     SEQMC,4,18     TEST FOR COMMERCIAL SEQUENCE              CEP43150
       STL     BUF58                                                    CEP43160
       TRA     DECAR                                                    CEP43170
 SEQMS STZ     SEMCS          SET SCIENTIFIC SEQUENCE                   CEP43180
       STL     MSSEQ          SET SEQUENCE SWITCH                       CEP43190
       TRA     DECNT                                                    CEP43200
 SEQMC STL     SEMCS          SET COMMERCIAL SEQUENCE                   CEP43210
       STL     MSSEQ          SET SEQUENCE SWITCH                       CEP43220
       ZET     NOTSX          TEST FOR FIELDS NOT SIX CHARACTERS        CEP43230
       TRA     NOSIX                                                    CEP43240
       TRA     DECNT                                                    CEP43250
 SEMCS PZE                                                              CEP43260
       SPACE                                                            CEP43270
*                                                                       CEP43280
* ANALYSIS OF FILE DEFINER-MERGE CARD                                   CEP43290
*                                                                       CEP43300
 FILME LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP43310
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP43320
       TXH     FILMS,2,8      TEST FOR TOO MANY FILES                   CEP43330
 FILST LDQ     1,1            PARAMETER                                 CEP43340
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP43350
       TRA     CVTER          ERROR RETURN                              CEP43360
 FILXR AXT     1,4                                                      CEP43370
       STO     FILTA,4        SAVE IN FILE TABLE                        CEP43380
       TXI     *+1,4,1        FILE TABLE POINTER                        CEP43390
       SXA     FILXR,4        SAVE FOR NEXT TIME AROUND                 CEP43400
       TXI     *+1,1,-1       CHANGE POINTER FOR NEXT PARAMETER.        CEP43410
       TIX     FILST,2,1      TEST FOR MORE PARAMETERS                  CEP43420
       XEC     FILXR          NUMBER OF FILES TO BE MERGED              CEP43430
       SXA     MSFIL,4        SET FILE SWITCH                           CEP43440
       TRA     DECNT                                                    CEP43450
       BSS     8                                                        CEP43460
 FILTA BSS     0              FILE TABLE                                CEP43470
FILMS  STL     BUF22                                                    CEP43480
       STL     DEERR          SET ERROR SWITCH                          CEP43490
       AXT     8,2            ANALYZE MAXIMUM NUMBER OF FILES           CEP43500
       TRA     FILST                                                    CEP43510
       SPACE                                                            CEP43520
*                                                                       CEP43530
* ANALYSIS OF FIELD DEFINER-MERGE CARD                                  CEP43540
*                                                                       CEP43550
 FIEME LXA     DECNT,2        NUMBER OF PARAMETERS                      CEP43560
       TXL     NOPAR,2,0      TEST FOR A PARAMETER                      CEP43570
 FIEMB STZ     FIEAD          CLEAR ASCENDING-DESCENDING SWITCH         CEP43580
       CAL     1,1            PARAMETER                                 CEP43590
 FIEMG LGR     6              EXTRACT ONE CHARACTER                     CEP43600
       SLW     FIEMS          SAVE REMAINDER OF PARAMETER               CEP43610
       ZAC                                                              CEP43620
       LGL     6                                                        CEP43630
       PAX     ,4                                                       CEP43640
       TXH     *+5,4,20       TEST FOR HIGHER THAN D                    CEP43650
       TXH     FIEMD,4,19     TEST FOR D                                CEP43660
       TXH     *+3,4,17       TEST FOR HIGHER THAN A                    CEP43670
       TXH     FIEMA,4,16     TEST FOR A                                CEP43680
       TXL     FIEMR,4,9      TEST FOR NUMBER ONLY                      CEP43690
       STL     BUF26                                                    CEP43700
       TRA     DECAR                                                    CEP43710
 FIEMR LGR     6              RESTORE NUMBERICAL CHARACTER              CEP43720
       CAL     FIEMS          TO PARAMETER                              CEP43730
       LGL     6                                                        CEP43740
       XCL                                                              CEP43750
       TSX     CNVRT,4        CONVERT TO BINARY                         CEP43760
       TRA     CVTER          ERROR RETURN                              CEP43770
 FIEMX AXT     1,4            FIELD DEFINER POINTER                     CEP43780
       STO     REFMT,4        SAVE FIELD NUMBER                         CEP43790
       CLA     FIEAD                                                    CEP43800
       STO     REMTB,4        SAVE ASCENDING OR DESCENING SWITCH        CEP43810
       TXI     *+1,4,1        NEXT POINTER OF FIELD                     CEP43820
       SXA     FIEMX,4        SAVE POINTER FOR NEXT GO ROUND            CEP43830
       TXI     *+1,1,-1       NEXT FIELD PARAMETER                      CEP43840
       TIX     FIEMB,2,1                                                CEP43850
       STL     MSFIE          SET MERGE FIELD SWITCH                    CEP43860
       TRA     DECNT                                                    CEP43870
 FIEMD STL     FIEAD          SET SWITCH FOR DESCENDING                 CEP43880
       CAL     FIEMS          RESTORE WORD REMAINDER                    CEP43890
       TRA     FIEMG                                                    CEP43900
 FIEMA STZ     FIEAD          SET SWITCH FOR ASCENDING                  CEP43910
       CAL     FIEMS          RESTORE WORD REMAINDER                    CEP43920
       TRA     FIEMG                                                    CEP43930
       BSS     200            FIELD NUMBER TABLE                        CEP43940
 REFMT BSS     0                                                        CEP43950
       BSS     200            ASCENDING OR DESCENDING TABLE             CEP43960
 REMTB BSS     0                                                        CEP43970
       SPACE                                                            CEP43980
 OSCKS                        OPTION CARD SWITCHES                      CEP43990
 OSNOC                                                                  CEP44000
 OSEQU                                                                  CEP44010
 OSBUF                                                                  CEP44020
 OSREL                                                                  CEP44030
 OSVAR                                                                  CEP44040
 OSCAR                                                                  CEP44050
 OSMAP                                                                  CEP44060
 OSTAP                                                                  CEP44070
 OSNOF                                                                  CEP44080
 OSHIS                                                                  CEP44090
OSUNR                                                                (2)CEP44092
 SWI01 BSS     0              OVERFLOW CARD SWITCHES                    CEP44100
 OSBLO                                                                  CEP44110
 SWI02 BSS     0              LABEL CARD SWITCHES                       CEP44120
 LSIDE                                                                  CEP44130
 SWI03 BSS     0              CHANNEL CARD SWITCHES                     CEP44140
 CSINP                                                                  CEP44150
 CSMER                                                                  CEP44160
 CSOUT                                                                  CEP44170
 SWI04 BSS     0              FILE CARD SWITCHES                        CEP44180
 FSREE                                                                  CEP44190
 FSMOD                                                                  CEP44200
 FSDEN                                                                  CEP44210
 FSBLO                                                                  CEP44220
 FSPAD                                                                  CEP44230
 FSSER                                                                  CEP44240
 FSLAB                                                                  CEP44250
 FSREL                                                                  CEP44260
 FSNAM                                                                  CEP44270
 FSCKP                                                                  CEP44280
 FSRET                                                                  CEP44290
 FSCKS                                                                  CEP44300
 FSBLK                                                                  CEP44310
 FSDIC                                                                  CEP44320
 FSINP                                                                  CEP44330
 FSOUT                                                                  CEP44340
 SWI05 BSS     0                                                        CEP44350
 MSPRO                        MODIFICATION CARD SWITCHES                CEP44360
 MSCEL                                                                  CEP44370
 MSLOC                                                                  CEP44380
 MSFOR                                                                  CEP44390
 SWI06 BSS     0                                                        CEP44400
 RSTYP                        RECORD CARD SWITCHES                      CEP44410
 RSLEN                                                                  CEP44420
 RSFIE                                                                  CEP44430
 SWI07 BSS     0                                                        CEP44440
 DSFIE                                                                  CEP44450
 DSIDE                                                                  CEP44460
 SWI08 BSS     0                                                        CEP44470
 SSFIL                        SORT CARD SWITCHES                        CEP44480
 SSSEQ                                                                  CEP44490
 SSFIE                                                                  CEP44500
 SSORD                                                                  CEP44510
 SWI09 BSS     0                                                        CEP44520
 MSFIL                        MERGE CARD SWITCHES                       CEP44530
 MSSEQ                                                                  CEP44540
 MSFIE                                                                  CEP44550
 MSORD                                                                  CEP44560
 SWI10 BSS     0                                                        CEP44570
       SPACE                                                            CEP44580
 OPCKS BCI     1,CKS000       OPTION CARD DEFINERS                      CEP44590
 OPNOC BCI     1,NOC000                                                 CEP44600
 OPEQU BCI     1,EQU000                                                 CEP44610
 OPBUF BCI     1,BUF000                                                 CEP44620
 OPREL BCI     1,REL000                                                 CEP44630
 OPVAR BCI     1,VAR000                                                 CEP44640
 OPCAR BCI     1,CAR000                                                 CEP44650
 OPMAP BCI     1,MAP000                                                 CEP44660
 OPTAP BCI     1,TAP000                                                 CEP44670
 OPNOF BCI     1,NOF000                                                 CEP44680
 OPHIS BCI     1,HIS000                                                 CEP44690
OPUNR  BCI     1,UNR000                                              (2)CEP44692
 DEF01 BSS     0                                                        CEP44700
 OVBLO BCI     1,BLO000       OVERFLOW CARD DEFINERS                    CEP44710
 DEF02 BSS     0                                                        CEP44720
 LAIDE BCI     1,IDE000       LABEL CARD DEFINERS                       CEP44730
 DEF03 BSS     0                                                        CEP44740
 CHINP BCI     1,INP000       CHANNEL CARD DEFINERS                     CEP44750
 CHMER BCI     1,MER000                                                 CEP44760
 CHOUT BCI     1,OUT000                                                 CEP44770
 DEF04 BSS     0                                                        CEP44780
 FIREE BCI     1,REE000       FILE CARD DEFINERS                        CEP44790
 FIMOD BCI     1,MOD000                                                 CEP44800
 FIDEN BCI     1,DEN000                                                 CEP44810
 FIBLO BCI     1,BLO000                                                 CEP44820
 FIPAD BCI     1,PAD000                                                 CEP44830
 FISER BCI     1,SER000                                                 CEP44840
 FILAB BCI     1,LAB000                                                 CEP44850
 FIRLS BCI     1,RLS000                                                 CEP44860
 FINAM BCI     1,NAM000                                                 CEP44870
 FICKP BCI     1,CKP000                                                 CEP44880
 FIRET BCI     1,RET000                                                 CEP44890
 FICKS BCI     1,CKS000                                                 CEP44900
 FIBLK BCI     1,BLK000                                                 CEP44910
 FIDIC BCI     1,DIC000                                                 CEP44920
 FIINP BCI     1,INP000                                                 CEP44930
 FIOUT BCI     1,OUT000                                                 CEP44940
 DEF05 BSS     0                                                        CEP44950
 MOPRO BCI     1,PRO000       MODIFICATION CARD DEFINERS                CEP44960
 MOCEL BCI     1,CEL000                                                 CEP44970
 MOLOC BCI     1,LOC000                                                 CEP44980
 MOFOR BCI     1,FOR000                                                 CEP44990
 DEF06 BSS     0                                                        CEP45000
 RETYP BCI     1,TYP000       RECORD CARD DEFINERS                      CEP45010
 RELEN BCI     1,LEN000                                                 CEP45020
 REFIE BCI     1,FIE000                                                 CEP45030
 DEF07 BSS     0                                                        CEP45040
 DEFIE BCI     1,FIE000                                                 CEP45050
 DEIDE BCI     1,IDE000                                                 CEP45060
 DEF08 BSS     0                                                        CEP45070
 SOFIL BCI     1,FIL000       SORT CARD DEFINERS                        CEP45080
 SOSEQ BCI     1,SEQ000                                                 CEP45090
 SOFIE BCI     1,FIE000                                                 CEP45100
 SOORD BCI     1,ORD000                                                 CEP45110
 DEF09 BSS     0                                                        CEP45120
 MEFIL BCI     1,FIL000       MERGE CARD DEFINERS                       CEP45130
 MESEQ BCI     1,SEQ000                                                 CEP45140
 MEFIE BCI     1,FIE000                                                 CEP45150
 MEORD BCI     1,ORD000                                                 CEP45160
 DEF10 BSS     0                                                        CEP45170
       SPACE                                                            CEP45180
*                                                                       CEP45190
* NUMBER OF LEGAL DEFINERS                                              CEP45200
*                                                                       CEP45210
       AXT     DEF01-OPCKS,4                                            CEP45220
       AXT     DEF02-OVBLO,4                                            CEP45230
       AXT     DEF03-LAIDE,4                                            CEP45240
       AXT     DEF04-CHINP,4                                            CEP45250
       AXT     DEF05-FIREE,4                                            CEP45260
       AXT     DEF06-MOPRO,4                                            CEP45270
       AXT     DEF07-RETYP,4                                            CEP45280
       AXT     DEF08-DEFIE,4                                            CEP45290
       AXT     DEF09-SOFIL,4                                            CEP45300
       AXT     DEF10-MEFIL,4                                            CEP45310
 AXT01 BSS     0                                                        CEP45320
       SPACE   5                                                        CEP45330
               TRA01                                                    CEP45340
               TRA02                                                    CEP45350
               TRA03                                                    CEP45360
               TRA04                                                    CEP45370
               TRA05                                                    CEP45380
               TRA06                                                    CEP45390
               TRA07                                                    CEP45400
               TRA08                                                    CEP45410
               TRA09                                                    CEP45420
               TRA10                                                    CEP45430
 AXT04 BSS     0                                                        CEP45440
       SPACE   5                                                        CEP45450
               SWI01                                                    CEP45460
               SWI02                                                    CEP45470
               SWI03                                                    CEP45480
               SWI04                                                    CEP45490
               SWI05                                                    CEP45500
               SWI06                                                    CEP45510
               SWI07                                                    CEP45520
               SWI08                                                    CEP45530
               SWI09                                                    CEP45540
               SWI10                                                    CEP45550
 AXT02 BSS     0                                                        CEP45560
       SPACE   5                                                        CEP45570
               DEF01                                                    CEP45580
               DEF02                                                    CEP45590
               DEF03                                                    CEP45600
               DEF04                                                    CEP45610
               DEF05                                                    CEP45620
               DEF06                                                    CEP45630
               DEF07                                                    CEP45640
               DEF08                                                    CEP45650
               DEF09                                                    CEP45660
               DEF10                                                    CEP45670
 AXT03 BSS     0                                                        CEP45680
       SPACE   5                                                        CEP45690
       PZE     CKSOP          OPTION CARD TRANSFERS                     CEP45700
       PZE     NOCOP                                                    CEP45710
       PZE     EQUOP                                                    CEP45720
       PZE     BUFOP                                                    CEP45730
       PZE     RELOP                                                    CEP45740
       PZE     VAROP                                                    CEP45750
       PZE     CAROP                                                    CEP45760
       PZE     MAPOP                                                    CEP45770
       PZE     TAPOP                                                    CEP45780
       PZE     NOFOP                                                    CEP45790
       PZE     HISOP                                                    CEP45800
       PZE     UNROP                                                 (2)CEP45802
 TRA01 BSS     0                                                        CEP45810
       PZE     BLOOV          OVERFLOW CARD TRANSFERS                   CEP45820
 TRA02 BSS     0                                                        CEP45830
       PZE     IDELA          LABEL CARD TRANSFERS                      CEP45840
 TRA03 BSS     0                                                        CEP45850
       PZE     INPCH          CHANNEL CARD TRANSFERS                    CEP45860
       PZE     MERCH                                                    CEP45870
       PZE     OUTCH                                                    CEP45880
 TRA04 BSS     0                                                        CEP45890
       PZE     REEFI          FILE CARD TRANSFERS                       CEP45900
       PZE     MODFI                                                    CEP45910
       PZE     DENFI                                                    CEP45920
       PZE     BLOFI                                                    CEP45930
       PZE     PADFI                                                    CEP45940
       PZE     SERFI                                                    CEP45950
       PZE     LABFI                                                    CEP45960
       PZE     RLSFI                                                    CEP45970
       PZE     NAMFI                                                    CEP45980
       PZE     CKPFI                                                    CEP45990
       PZE     RETFI                                                    CEP46000
       PZE     CKSFI                                                    CEP46010
       PZE     BLKFI                                                    CEP46020
       PZE     DICFI                                                    CEP46030
       PZE     INPFI                                                    CEP46040
       PZE     OUTFI                                                    CEP46050
 TRA05 BSS     0                                                        CEP46060
       PZE     PROMO          MODIFICATION CARD TRANSFERS               CEP46070
       PZE     CELMO                                                    CEP46080
       PZE     LOCMO                                                    CEP46090
       PZE     FORMO                                                    CEP46100
 TRA06 BSS     0                                                        CEP46110
       PZE     TYPRE          RECORD CARD TRANSFERS                     CEP46120
       PZE     LENRE                                                    CEP46130
       PZE     FIERE                                                    CEP46140
 TRA07 BSS     0                                                        CEP46150
       PZE     FIEDE                                                    CEP46160
       PZE     IDEDE                                                    CEP46170
 TRA08 BSS     0                                                        CEP46180
       PZE     FILSO          SORT CARD TRANSFERS                       CEP46190
       PZE     SEQSO                                                    CEP46200
       PZE     FIESO                                                    CEP46210
       PZE     ORDSO                                                    CEP46220
 TRA09 BSS     0                                                        CEP46230
       PZE     FILME                                                    CEP46240
       PZE     SEQME                                                    CEP46250
       PZE     FIEME                                                    CEP46260
       PZE     ORDME                                                    CEP46270
 TRA10 BSS     0                                                        CEP46280
       EJECT                                                            CEP46290
*                                                                       CEP46300
* CONVERT ROUTINE                                                       CEP46310
*                                                                       CEP46320
* CONVERTS SIX BCD NUMERICAL CHARACTERS TO A BINARY NUMBER              CEP46330
* WILL ELIMINATE BLANKS APPEARING BEFORE THE ACTUAL NUMBER              CEP46340
* THE NUMBER TO BE CONVERTED MUST BE RIGHT JUSTIFIED IN THE MQ          CEP46350
* THE CONVERTED NUMBER WILL APPEAR IN THE AC                            CEP46360
* AN ERROR RETURN IS PROVIDED FOR THE CASE WHEN A NON-NUMERIC CHARACTER CEP46370
* IS ENCOUNTERED                                                        CEP46380
*                                                                       CEP46390
* THE CALLING SEQUENCE HAS THE FOLLOWING FORMAT                         CEP46400
*      TSX     CNVRT,4                                                  CEP46410
*      XXX                    ERROR RETURN                              CEP46420
*      XXX                    NORMAL RETURN                             CEP46430
*                                                                       CEP46440
 CNVRT SXA     CNVX1,1        SAVE REGISTERS                            CEP46450
       SXA     CNVX2,2                                                  CEP46460
       SXA     CNVX4,4                                                  CEP46470
       AXT     6,1            NUMBER OF CHARACTERS TO CONVERT           CEP46480
       STZ     CNADD          INITIALIZE SUM WORD                       CEP46490
 CNVST PXA     0,0                                                      CEP46500
       LGL     6              SHIFT CHARACTER INTO AC                   CEP46510
       PAX     0,2                                                      CEP46520
       STQ     CNVMQ                                                    CEP46530
       TXH     *+3,2,48       TEST FOR BLANKS                           CEP46540
       TXH     CNTIX,2,47                                               CEP46550
       TXL     *+5,2,9        TEST FOR NUMBERS ONLY                     CEP46560
       XEC     CNVX1          RESTORE REGISTERS BEFORE ERROR RETURN     CEP46570
       XEC     CNVX2                                                    CEP46580
       XEC     CNVX4                                                    CEP46590
       TRA     1,4            ERROR RETURN                              CEP46600
       XCA                                                              CEP46610
       MPY     CNPWR,1        DECIMAL POWER                             CEP46620
       XCA                                                              CEP46630
       ADD     CNADD          PREVIOUS SUM                              CEP46640
       STO     CNADD          SAVE FOR NEXT GO ROUND                    CEP46650
       LDQ     CNVMQ          RESTORE FOR NEXT GO ROUND                 CEP46660
 CNTIX TIX     CNVST,1,1      TEST FOR ANOTHER GO ROUND                 CEP46670
 CNVX1 AXT     **,1           RESTORE REGISTERS                         CEP46680
 CNVX2 AXT     **,2                                                     CEP46690
 CNVX4 AXT     **,4                                                     CEP46700
       TRA     2,4            NORMAL RETURN                             CEP46710
       DEC     100000                                                   CEP46720
       DEC     10000                                                    CEP46730
       DEC     1000                                                     CEP46740
       DEC     100                                                      CEP46750
       DEC     10                                                       CEP46760
       DEC     1                                                        CEP46770
 CNPWR BSS     0                                                        CEP46780
 CNADD PZE                    SUM OF CHARACTERS                         CEP46790
 CNVMQ PZE                    MQ STORAGE                                CEP46800
       EJECT                                                            CEP46810
*                                                                       CEP46820
* MESSAGES FOR CARD ANALYSIS                                            CEP46830
*                                                                       CEP46840
 AMS01 BCI     4,LOGICAL FILE 00  PASS 01                               CEP46850
 AMS75 BCI     7,  INPUT TAPE          NOT IN READY STATUS.             CEP46860
 AMS76 BCI     7,  MERGE TAPE          NOT IN READY STATUS.             CEP46870
 AMS77 BCI     7,  OUTPUT TAPE         NOT IN READY STATUS.             CEP46880
 AMS78 BCI     8,FOLLOWING ERRORS FOUND IN CONTROL CARDS. *EP01         CEP46890
 AMS89 BCI     6,NO END CARD FOUND BEFORE EOF. *EP02                    CEP46900
 AMS95 BCI     5,NOT A SORT CONTROL CARD. *EP03                         CEP46910
 AM102 BCI     4,NO SYSCK2 ATTACHED.*EP04                               CEP46920
 AM113 BCI     3,  CHECKPOINT TAPE                                      CEP46930
 AM114 BCI     6,TO DELETE SORT, PUT SS3 UP, START.                     CEP46940
 AM117 BCI     9,TO CONTINUE AND IGNORE ERROR, PUT SS3 DOWN, START.     CEP46950
 AM121 BCI     7,END CARD WILL BE ASSUMED AT THIS POINT.                CEP46960
 AM122 BCI     5,THE CARD WILL BE IGNORED.                              CEP46970
 AM127 BCI     7,INTERSYSTEM INPUT UNIT NOT FOUND. *EP05                CEP46980
 AM128 BCI ,TO HAVE SORT ASSIGN AN INPUT UNIT, PUT SS3 DOWN, START.     CEP46990
 AM144 BCI     6,PREPARE UNITS AS FOLLOWS--     *EP06                   CEP47000
 AM145 BCI     8,PRESS START WHEN ALL UNITS ARE PROPERLY PREPARED       CEP47010
       BCI     4, AND IN READY STATUS.                                  CEP47020
 AM153 BCI     7,        MOUNT FILE        ON THIS UNIT.                CEP47030
 AM171 BCI     5,ERROR IGNORED, SORT CONTINUES.                         CEP47040
AM173  BCI     2,SORT DELETED                                           CEP47050
       DETAIL                                                           CEP47060
 FAREA BSS     25                                                       CEP47070
 DECPR PZE                                                              CEP47080
 DEERR PZE                                                              CEP47090
       SPACE   2                                                        CEP47100
 OPTPR COMMON  15             OPTION CARD PARAMETERS                    CEP47110
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  CEP47120
 LABPR COMMON  5              LABEL CARD PARAMETERS                     CEP47130
 CHAPR COMMON  6              CHANNEL CARD PARAMETERS                   CEP47140
 FILPR COMMON  14             FILE CARD PARAMETERS                      CEP47150
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              CEP47160
 RECPR COMMON  10             RECORD CARD PARAMETERS                    CEP47170
 DELPR COMMON  2              DELETE CARD PARAMETERS                    CEP47180
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            CEP47190
 CALPR COMMON  50             CALCULATED PARAMETERS                     CEP47200
 GENPR COMMON  10             GENERAL PARAMETERS                        CEP47210
 RAWPR COMMON  30             READ AND WRITE PARAMETERS                 CEP47220
 CNTPR COMMON  20             COUNT PARAMETERS                          CEP47230
 ERAPR COMMON  30             ERASABLE STORAGE PARAMETERS               CEP47240
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           CEP47250
CAL12  EQU     CALPR-12                                                 CEP47260
CHA00  EQU     CHAPR                                                    CEP47270
CHA01  EQU     CHAPR-1                                                  CEP47280
CHA02  EQU     CHAPR-2                                                  CEP47290
CHA03  EQU     CHAPR-3                                                  CEP47300
CHA04  EQU     CHAPR-4                                                  CEP47310
CHA05  EQU     CHAPR-5                                                  CEP47320
DEL00  EQU     DELPR                                                    CEP47330
FIL00  EQU     FILPR                                                    CEP47340
FIL01  EQU     FILPR-1                                                  CEP47350
FIL02  EQU     FILPR-2                                                  CEP47360
FIL09  EQU     FILPR-9                                                  CEP47370
GEN01  EQU     GENPR-1                                                  CEP47380
GEN03  EQU     GENPR-3                                                  CEP47390
GEN04  EQU     GENPR-4                                                  CEP47400
LAB00  EQU     LABPR                                                    CEP47410
LAB01  EQU     LABPR-1                                                  CEP47420
LAB02  EQU     LABPR-2                                                  CEP47430
LAB03  EQU     LABPR-3                                                  CEP47440
LAB04  EQU     LABPR-4                                                  CEP47450
MOD00  EQU     MODPR                                                    CEP47460
OPT00  EQU     OPTPR                                                    CEP47470
OPT01  EQU     OPTPR-1                                                  CEP47480
OPT02  EQU     OPTPR-2                                                  CEP47490
OPT03  EQU     OPTPR-3                                                  CEP47500
OPT04  EQU     OPTPR-4                                                  CEP47510
OPT05  EQU     OPTPR-5                                                  CEP47520
OPT06  EQU     OPTPR-6                                                  CEP47530
OPT07  EQU     OPTPR-7                                                  CEP47540
OPT08  EQU     OPTPR-8                                                  CEP47550
OPT09  EQU     OPTPR-9                                                  CEP47560
OPT10  EQU     OPTPR-10                                                 CEP47570
OPT11  EQU     OPTPR-11                                              (2)CEP47572
OVE00  EQU     OVEPR                                                    CEP47580
RAW02  EQU     RAWPR-2                                                  CEP47590
RAW04  EQU     RAWPR-4                                                  CEP47600
RAW20  EQU     RAWPR-20                                                 CEP47610
REC00  EQU     RECPR                                                    CEP47620
REC01  EQU     RECPR-1                                                  CEP47630
REC02  EQU     RECPR-2                                                  CEP47640
REC05  EQU     RECPR-5                                                  CEP47650
REF00  EQU     REFPR                                                    CEP47660
SAM00  EQU     SAMPR                                                    CEP47670
SAM01  EQU     SAMPR-1                                                  CEP47680
SAM02  EQU     SAMPR-2                                                  CEP47690
SAM03  EQU     SAMPR-3                                                  CEP47700
SAM04  EQU     SAMPR-4                                                  CEP47710
SAM05  EQU     SAMPR-5                                                  CEP47720
FAR00  EQU     FAREA                                                    CEP47730
FAR01  EQU     FAREA+1                                                  CEP47740
FAR02  EQU     FAREA+2                                                  CEP47750
FAR03  EQU     FAREA+3                                                  CEP47760
FAR04  EQU     FAREA+4                                                  CEP47770
FAR05  EQU     FAREA+5                                                  CEP47780
FAR06  EQU     FAREA+6                                                  CEP47790
FAR07  EQU     FAREA+7                                                  CEP47800
FAR08  EQU     FAREA+8                                                  CEP47810
FAR09  EQU     FAREA+9                                                  CEP47820
FAR10  EQU     FAREA+10                                                 CEP47830
FAR11  EQU     FAREA+11                                                 CEP47840
FAR12  EQU     FAREA+12                                                 CEP47850
FAR13  EQU     FAREA+13                                                 CEP47860
FAR14  EQU     FAREA+14                                                 CEP47870
FAR15  EQU     FAREA+15                                                 CEP47880
FAR16  EQU     FAREA+16                                                 CEP47890
FAR17  EQU     FAREA+17                                                 CEP47900
FAR18  EQU     FAREA+18                                                 CEP47910
FAR19  EQU     FAREA+19                                                 CEP47920
FAR25  EQU     FAREA+25                                                 CEP47930
MUST   BOOL    2                                                        CEP47940
CNT19  EQU     CNTPR-19                                              (7)CEP47941
 HYPSW                                                                  CEP47950
       EJECT                                                            CEP47960
       EJECT                                                            CEP47970
       DETAIL                                                           CEP47980
* CALLING SEQUENCE                                                      CEP47990
*      TSX     ASSIGN,4                                                 CEP48000
*      PZE     LOCATION OF LIST,,ITS LENGTH                             CEP48010
*         RETURN IF MORE UNITS ARE NEEDED                               CEP48020
*         RETURN IF CAN'T FIND INTERSYSTEM UNIT                         CEP48030
*         NORMAL RETURN                                                 CEP48040
       SPACE                                                            CEP48050
ASSIGN SXA     ASN40,1       SAVE                                       CEP48060
       SXA     ASN42,2        INDEX                                     CEP48070
       SXA     ASN44,4        REGISTERS.                                CEP48080
 ASN01 TRA     *+1           ONE-TIME SWITCH.                           CEP48090
       CAL     *                                                     (2)CEP48091
       STP     SYSJOB        INDICATE WE HAVE TAMPERED WITH UNITS.   (2)CEP48092
       LAC     SYSPOS,2                                                 CEP48100
       CAL*    SYSLB1-1,2    MAKE CERTAIN THAT                          CEP48110
       PAI                                                              CEP48120
       ANA     =O17000000000                                            CEP48130
       ARS     9              SYSTEM TAPE HAS                           CEP48140
       PDC     ,1             COMPLETED                                 CEP48150
       TXI     *+1,1,1        BACKSPACE FILE                            CEP48160
       AXT     5,4           LOAD 729 BSR                               CEP48170
       LFT     020000        HYPERTAPE +                                CEP48180
       AXT     34,4          YES-LOAD HYPER BSR                         CEP48190
       SXD     *+2,4         STORE IN CALL SEQ                          CEP48200
       TSX     (NDSLX,4       BEFORE WE GO ON                           CEP48210
       PZE     SYSLB1-1,2,**                                            CEP48220
       STL*    (TCOXI         CHANNELS.                                 CEP48230
       XEC*    (TCOXI                                                   CEP48240
       XEC     RDCX,1                                                   CEP48250
       LXA     ASN44,4                                                  CEP48260
       STL     ASN01         SET ONE-TIME SWITCH TO JUMP AROUND.        CEP48270
       CLA     SYSUAV        DETERMINE AND                              CEP48280
       STA     ASN10          SAVE LOCATION                             CEP48290
       STA     ASN30          OF LOCATOR TABLE.                         CEP48300
       CLA     1,4           FROM THE CALLING SEQUENCE                  CEP48310
       STA     ASN05          GET THE LOCATION OF LIST                  CEP48320
       PDX     ,2             AND ITS LENGTH.                           CEP48330
       TXL     ASN38,2,0     TRANSFER OUT IF LIST HAS ZERO LENGTH.      CEP48340
       TXI     *+1,2,-1      SAVE  LENGTH-1                             CEP48350
       SXD     ASN03,2        FOR LEAVING SUBROUTINE.                   CEP48360
       AXT     0,2           SET TO CHECK THROUGH LIST.                 CEP48370
 ASN03 TXH     ASN38,2,**    LEAVE ROUTINE WHEN COMPLETED.              CEP48380
       AXT     0,4           RESET LINK DETERMINATION SWITCH.           CEP48390
 ASN05 CAL     **,2          BRING IN ENTRY FROM LIST.                  CEP48400
       TZE     ASN35         TRANSFER IF IT IS ZERO,                    CEP48410
       ANA     =O77000017     BUT, IF IT IS NOT ZERO, SAVE              CEP48420
       PDX     ,1             CHANNEL DESIGNATION AND                   CEP48430
       PAX     ,4             NUMBER OF DESIRED LINK IN CHAIN.          CEP48440
       TXH     ASN75,1,24    TRANSFER IF CHANNEL J-Q.                   CEP48450
       TXI     *+1,1,-17     IF CHANNEL A-H IS DESIGNATED,              CEP48460
       PXA     ,1             MAKE A=0, B=-1,...,                       CEP48470
       PAC     ,1             G=-6, H=-7 IN IR1.                        CEP48480
       CLA     =O77777       PICK UP THE LOCATION OF THE UCW            CEP48490
 ASN10 ANA     **,1           OF THE FIRST AVAILABLE UNIT.              CEP48500
       TZE     ASN60         TRANSFER IF NO MORE UNITS ON CHANNEL.      CEP48510
       TXH     ASN65,4,1     TRANSFER IF A LINK ABOVE 1 IS SPECIFIED.   CEP48520
       AXT     0,4           RESET LINK DETERMINATION SWITCH.           CEP48530
 ASN15 STA     *+1           PICK UP THE FIRST                          CEP48540
 ASN20 LDI     **             UNIT CONTROL WORD.                        CEP48550
       LFT     20000                                                    CEP48560
       TRA     ASN100        TRANSFER IF 7909 CHANNEL.                  CEP48570
       PIA                   DETERMINE AND                              CEP48580
       ARS     18             SAVE THE                                  CEP48590
       STA     ASN25          UNIT NUMBER.                              CEP48600
       STL*    (TCOXI        WAIT FOR THE                               CEP48610
       XEC*    (TCOXI         UNIT TO FINISH.                           CEP48620
       STZ     ASNX5         RESET SWITCH.                              CEP48630
 ASN25 BSR     **            CHECK TO SEE IF                            CEP48640
       CRQ     0,,30          THE UNIT IS READY,                        CEP48650
       CLA     ASNX1          AND SET                                   CEP48660
       STA*    (TCOXI         SWITCH                                    CEP48670
       XEC*    (TCOXI         ASNX5                                     CEP48680
       STL     ASNX5          IF IT IS READY.                           CEP48690
 ASN27 LDQ     RDCX,1        THEN CANCEL                                CEP48700
       STQ     *+1            THE BACKSPACE                             CEP48710
       RDCA                   AND RESET THE                             CEP48720
       CRQ     0,,30          DATA CHANNEL.                             CEP48730
       ZET     ASNX5         TRANSFER IF UNIT                           CEP48740
       TRA     ASN29          IS READY.                                 CEP48750
       CAL     =O400000000000  MAKE LIST PREFIX MINUS TO                CEP48760
       ORS*    ASN05           INDICATE UNIT NOT READY                  CEP48770
       STL     OSTAP                                                    CEP48780
 ASN29 RIL     400000        INDICATE UNIT NOW ASSIGNED.                CEP48790
       TXH     ASN50,4,0     TRANSFER IF A LINK WAS SPECIFIED.          CEP48800
 ASN30 CLA     **,1          PICK UP THE LOCATOR AND PUT ITS            CEP48810
       STA*    ASN05          ADDRESS INTO THE LIST ADDRESS.            CEP48820
       PIA                   PUT THE NEW UCW1 INTO THE                  CEP48830
       SLW*    ASN20          UNIT CONTROL BLOCK.                       CEP48840
       STA*    ASN10         REFORM AVAILABILITY CHAIN.                 CEP48850
 ASN35 TXI     ASN03,2,1     RETURN TO PROCESS NEXT LIST ENTRY.         CEP48860
 ASN38 ZAC                   SET FOR NORMAL RETURN.                     CEP48870
 ASN40 AXT     **,1          RESTORE                                    CEP48880
 ASN42 AXT     **,2           INDEX                                     CEP48890
 ASN44 AXT     **,4           REGISTERS.                                CEP48900
       TZE     *+2           RETURN TO MAIN PROGRAM, GOING              CEP48910
       TRA     2,4            TO ERROR RETURN IF NECESSARY,             CEP48920
       TRA     4,4            TO NORMAL RETURN OTHERWISE.               CEP48930
*                                                                       CEP48940
 ASN50 CLA     **            PUT LOCATION OF THE UCB FOR THE ASSIGNED   CEP48950
       STA*    ASN05          UNIT INTO THE LIST ADDRESS.               CEP48960
       PIA                   PUT THE NEW UCW1 INTO THE                  CEP48970
       SLW*    ASN20          UNIT CONTROL BLOCK.                       CEP48980
       STA*    ASN50         REFORM AVAILABILITY CHAIN.                 CEP48990
       TRA     ASN35         RETURN FOR NEXT LIST ENTRY.                CEP49000
*                                                                       CEP49010
 ASN60 LXA     ASN44,4       IF ALL UNITS IN THE                        CEP49020
       PXD     ,2             AVAILIBILITY CHAIN HAVE                   CEP49030
       SSM                    BEEN ASSIGNED, THEN,                      CEP49040
       ADD     1,4            FROM THE NUMBER THAT                      CEP49050
       ARS     18             HAVE BEEN ASSIGNED, DETERMINE AND         CEP49060
       TRA     ASN40          KEEP COUNT OF HOW MANY ARE NEEDED.        CEP49070
*                                                                       CEP49080
 ASN65 STA     ASN70         SAVE LOCATION OF FIRST LINK'S UCW.         CEP49090
       TXI     *+1,4,-1      UPDATE IR4.                                CEP49100
 ASN70 CLA     **            PICK UP THE LOCATION OF THE UCW            CEP49110
       ANA     =O77777        OF THE NEXT AVAILABLE UNIT.               CEP49120
       TZE     ASN60         TRANSFER IF NO MORE UNITS ON CHANNEL.      CEP49130
       LDQ     ASN70         KEEP THE LOCATION OF                       CEP49140
       STQ     ASN50          THE PRESENT UCW.                          CEP49150
       STA     ASN70         KEEP LOCATION OF NEXT LINK.                CEP49160
       TIX     ASN70,4,1     LOOP AGAIN IF NOT YET TO PROPER LINK.      CEP49170
       TRA     ASN15         RETURN TO ASSIGNMENT SECTION.              CEP49180
*                                                                       CEP49190
 ASN75 LXD     SYSUCW,4      FROM THE LENGTH AND                        CEP49200
       PXA     ,4             LOCATION OF THE UCBS                      CEP49210
       ADD     SYSUCW         FIND THEIR BASE FOR USE                   CEP49220
       STA     ASN80          IN TIXING THROUGH THEM.                   CEP49230
       CAL*    ASN05         PICK UP LIST ENTRY AND KEEP                CEP49240
       STA     ASN88          ADDRESS FOR COMPARISON.                   CEP49250
       CLA     =O40000077777 PUT UCW1 INTO                              CEP49260
 ASN80 LDI     **,4           INDICATORS AND COMPARE                    CEP49270
       IIS     ASN88          BITS 3 AND 24-35 AGAINST THE              CEP49280
       TIF     ASN85          INFORMATION FROM LIST.                    CEP49290
       TIX     ASN80,4,4     IF UNEQUAL, CHECK NEXT UCW1.               CEP49300
       XEC     ASN40         IF ALL HAVE BEEN CHECKED                   CEP49310
       XEC     ASN42          UNSUCCESSFULLY, RESTORE INDEX             CEP49320
       XEC     ASN44          REGISTERS AND USE                         CEP49330
       TRA     3,4            AN ERROR RETURN.                          CEP49340
 ASN85 PXA     ,4            WHEN CORRECT UNIT IS FOUND,                CEP49350
       SUB     ASN80          PUT THE LOCATION OF THE UCW               CEP49360
       STA*    ASN05          INTO THE ADDRESS PORTION                  CEP49370
       CAL*    ASN80                                                    CEP49380
       STO*    ASN80                                                    CEP49390
       TRA     ASN35          OF THE LIST ENTRY.                        CEP49400
 ASN88 OCT     40000000000   (ADDRESS INITIALIZED FROM LIST.)           CEP49410
*                                                                       CEP49420
ASN100 LFT     700                                                      CEP49430
       TRA     ASN110        TRANSFER IF NON-HYPER.                     CEP49440
*  READYTEST FOR HYPER.                                                 CEP49450
       STL     HYPSW                                                    CEP49460
       TRA     ASN29                                                    CEP49470
*                                                                       CEP49480
ASN110 CLA     ASN20                                                    CEP49490
       STA     ASN50                                                    CEP49500
       PIA                   IF NOT HYPER, TRY NEXT CHAIN UNIT.         CEP49510
       AXT     1,4                                                      CEP49520
       ANA     =O77777                                                  CEP49530
       TZE     ASN60                                                    CEP49540
       TRA     ASN15                                                    CEP49550
*                                                                       CEP49560
       DETAIL                                                           CEP49570
 ASNX1 PZE     ASN27                                                    CEP49580
 ASNX5                       (UNIT READY SWITCH)                        CEP49590
 RDCX  RDCA                                                             CEP49600
       RDCB                                                             CEP49610
       RDCC                                                             CEP49620
       RDCD                                                             CEP49630
       RDCE                                                             CEP49640
       RDCF                                                             CEP49650
       RDCG                                                             CEP49660
       RDCH                                                             CEP49670
       EJECT                                                            CEP49680
MGSUP  ENB     K0            DISABLE ALL TRAPS                          CEP49690
       SXA     SAVXR4,4                                                 CEP49700
       SXA     SAVXR1,1                                                 CEP49710
       LXA     OSREL,1                                                  CEP49720
DETERM LDI     0,4           DETERMINE TYPE OF MESSAGE REQUESTED        CEP49730
       LFT     000002        MUST BE PRINTED ONLINE +                   CEP49740
       TRA     MUSTP         YES                                        CEP49750
       AXT     *,4           LOAD XR IN CASE OF ERROR                   CEP49760
       LFT     000004        TEST HIST                                  CEP49770
       AXT     HIST,4        YES                                        CEP49780
       LFT     000010        TEST MAP +                                 CEP49790
       AXT     MAP,4         YES                                        CEP49800
       LFT     000020        TEST TAPES +                               CEP49810
       AXT     TAPE,4        YES                                        CEP49820
       LFT     000040        TEST CARDS +                               CEP49830
       AXT     CARD,4        YES                                        CEP49840
       SXA     TEST,4                                                   CEP49850
SAVXR4 AXT     **,4                                                     CEP49860
TEST   ZET     **,1          PRINT ONLINE +                             CEP49870
       TRA     MUSTP         YES                                        CEP49880
       ZET     NOF,1         NO-PRINT OFFLINE +                         CEP49890
       TRA     GOBACK        NO                                         CEP49900
       CAL     MON           YES-GO PRINT                               CEP49910
       TRA     ALTERX                                                   CEP49920
MUSTP  ZET     NOF,1         PRINT OFFLINE ALSO +                       CEP49930
       TRA     ALTERX+1                                                 CEP49940
       CAL     *             YES                                        CEP49950
ALTERX STP     1,4           ALTER CALLING SEQUENCE                     CEP49960
SAVXR1 AXT     **,1                                                     CEP49970
       LFT     000001        CONVERSION NECESSARY +                     CEP49980
       TRA     (CVPRT        YES                                        CEP49990
       TRA     (PROUT        NO                                         CEP50000
GOBACK CLS     MON           CONSTANT TO AC                             CEP50010
       LNT     000001        ONLY ONE CALL SEQ ENTRY +                  CEP50020
       ADM     1,4           NO CALCULATE                               CEP50030
       XEC     SAVXR1                                                   CEP50040
       STA     *+2           RETURN                                     CEP50050
       ENB*    (TRAPX        RE-ENABLE TRAPS                            CEP50060
       TRA     **,4                                                     CEP50070
MON    MON     2                                                        CEP50080
MAP    EQU     OPTPR-6                                                  CEP50090
NOF    EQU     OPTPR-7                                                  CEP50100
HIST   EQU     OPTPR-8                                                  CEP50110
TAPE   EQU     OPTPR-9                                                  CEP50120
CARD   EQU     OPTPR-10                                                 CEP50130
MSGSUP EQU     MGSUP                                                    CEP50140
       END                                                              CEP50150
*  7090/94 SORT, VER 7, MOD 0.  CARD IMAGE TO BCD CONVERSION            CRB00000
*      FAP
       COUNT   300                                                      CRB00010
       ENTRY   RB01                                                     CRB00020
*                                                                       CRB00030
*  CONVERT 24 WORD CARD IMAGE TO BCD INFORMATION                        CRB00040
*                                                                       CRB00050
*      TSX     RB01,4                                                   CRB00060
*      PZE     LOCATION OF CARD IMAGE,,LOCATION OF BCD                  CRB00070
*              ERROR RETURN                                             CRB00080
*              NORMAL RETURN                                            CRB00090
*                                                                       CRB00100
 RB01  TXL     RB01+7,0,0                                               CRB00110
       PZE                                                              CRB00120
       AXT 0,4                                                          CRB00130
       AXT 0,2                                                          CRB00140
       AXT 0,1                                                          CRB00150
       LDI RB01+1                                                       CRB00160
       TRA 3,4                                                          CRB00170
       STI RB01+1                                                       CRB00180
       SXA RB01+4,1                                                     CRB00190
       SXA RB01+3,2                                                     CRB00200
       SXA RB01+2,4                                                     CRB00210
       CLA     1,4                   =                                  CRB00220
       ADD     TEN                   =                                  CRB00230
       STA     MOD5                  =                                  CRB00240
       ADD     EIGHT                 =                                  CRB00250
       STA     MOD4                  =                                  CRB00260
       ADD     SIX                   =                                  CRB00270
       STA     MOD6                  =                                  CRB00280
       ARS     18                    =                                  CRB00290
       ADD     SIX                   =                                  CRB00300
       STA     STGE                  =                                  CRB00310
       ADD     SIX                   SET BCD STORAGE (12 WORDS)         CRB00320
       STA     *+2                   TO ZERO.                           CRB00330
       AXT     12,2                  =                                  CRB00340
       STZ     **,2                  =                                  CRB00350
       TIX     *-1,2,1               =                                  CRB00360
       STZ     LORR                  SET INDICATOR FOR FIRST HALF       CRB00370
*                                    OF CARD IMAGE.                     CRB00380
*                                                                       CRB00390
  PROC AXT     10,2                  BEGIN PROCESSING OF CARD IMAGE.    CRB00400
       LDI*    MOD5                  CHECK FOR DOUBLE PUNCHES IN        CRB00410
       AXT     8,2                   ROWS 9 TO 5 OF CARD IMAGE.         CRB00420
       CAL*    MOD5                  =                                  CRB00430
       TIF     *+2                   =                                  CRB00440
       TRA     B4                    IF ERROR, EXIT FROM SUBROUTINE.    CRB00450
       OAI                           =                                  CRB00460
       TIX     *-4,2,2               =                                  CRB00470
       AXT     8,2                   TEST FOR 8-4 PUNCH.                CRB00480
       CAL*    MOD4                  =                                  CRB00490
       TIF     *+2                   =                                  CRB00500
       TSX     AIT,1                 =                                  CRB00510
       OAI                           TEST FOR 8-3 PUNCH.                CRB00520
       AXT     6,2                   =                                  CRB00530
       CAL*    MOD4                  =                                  CRB00540
       TIF     *+2                   =                                  CRB00550
       TSX     AIT,1                 =                                  CRB00560
       OAI                           TEST FOR ILLEGAL 3-4 PUNCH.        CRB00570
       AXT     0,2                   =                                  CRB00580
       ANA*    MOD5                  =                                  CRB00590
       TNZ     B4                    IF ERROR, EXIT FROM SUBROUTINE.    CRB00600
       AXT     4,2                   TEST FOR DOUBLE NUMERICAL          CRB00610
       CAL*    MOD4                  PUNCH IN REMAINING ROWS.           CRB00620
       TIF     *+7                   =                                  CRB00630
*                                                                       CRB00640
    B4 NZT     LORR                  ERROR. DETERMINE WHICH HALF        CRB00650
       TRA     *+4                   OF CARD IMAGE CONTAINS ERROR.      CRB00660
       AXT     7,2                   IF 2ND HALF, RESTORE ZERO          CRB00670
       CAL     .T+2                  ROW OF 1ST HALF BEFORE             CRB00680
       SLW*    MOD6                  EXIT FROM SUBROUTINE.              CRB00690
       TRA EXIT+1                                                       CRB00700
*                                                                       CRB00710
       OAI                           =                                  CRB00720
       TIX     *-9,2,2               =                                  CRB00730
       STI     .T                    =                                  CRB00740
       CAL*    MOD6                  TEST FOR ILLEGAL DOUBLE ZONE.      CRB00750
       OAI                           =                                  CRB00760
       SLW     DZN                   =                                  CRB00770
       AXT     4,2                   =                                  CRB00780
       ANA*    MOD6                  =                                  CRB00790
       TNZ     B4                    IF ERROR, EXIT FROM SUBROUTINE.    CRB00800
       CAL*    MOD6                  FORM INDICATOR FOR LEGAL           CRB00810
       OAI                           DOUBLE ZONE.                       CRB00820
       ORA     DZN                   =                                  CRB00830
       AXT     6,2                   =                                  CRB00840
       OSI*    MOD6                  =                                  CRB00850
       ANA*    MOD6                  =                                  CRB00860
       SLW     DZN                   =                                  CRB00870
       ANA     .T                    TEST FOR TRIPLE PUNCHES.           CRB00880
       TNZ     B4                    IF ERROR, EXIT FROM SUBROUTINE.    CRB00890
       PIA                           =                                  CRB00900
       COM                           =                                  CRB00910
       SLW     .T+1                  =                                  CRB00920
       LDI*    MOD6                  INDICATE NUMERICAL ZERO, AFTER     CRB00930
       STI     .T+2                  SAVING ZERO ROW OF 1ST HALF.       CRB00940
       RIS     .T                    =                                  CRB00950
       STI     .T                    =                                  CRB00960
       LDI*    MOD6                  INDICATE ZONE ZERO.                CRB00970
       RIS     .T                    =                                  CRB00980
       PIA                           =                                  CRB00990
       ORA     .T+1                  =                                  CRB01000
       SLW*    MOD6                  =                                  CRB01010
       AXT     6,2                   CARD IMAGE IS NOW READY FOR        CRB01020
*                                    CONVERSION TO BCD.                 CRB01030
*                                                                       CRB01040
       AXT     48,1                  INITIALIZE ROW COUNT.              CRB01050
       SXA     ROW,1                 =                                  CRB01060
       CAL*    MOD6                  PROCESS ZONE ROWS.                 CRB01070
       TSX     SBRT,4                =                                  CRB01080
       CLA     ROW                   =                                  CRB01090
       TNX     *+4,2,2               =                                  CRB01100
       SUB     SXTN                  =                                  CRB01110
       STO     ROW                   =                                  CRB01120
       TRA     *-6                   =                                  CRB01130
       SUB     SIX                   =                                  CRB01140
       STO     ROW                   =                                  CRB01150
       CAL     DZN                   =                                  CRB01160
       TSX     SBRT,4                =                                  CRB01170
       AXT     18,2                  PROCESS DIGIT ROWS                 CRB01180
       CLA     ROW                   =                                  CRB01190
       SUB     ONE                   =                                  CRB01200
       STO     ROW                   =                                  CRB01210
       CAL*    MOD4                  =                                  CRB01220
       TSX     SBRT,4                =                                  CRB01230
       TIX     *-5,2,2               =                                  CRB01240
       ZET     LORR                  IF 2ND HALF OF CARD IMAGE          CRB01250
*                                    HAS BEEN CONVERTED,                CRB01260
       TRA     EXIT                  RETURN TO MAIN PROGRAM.            CRB01270
       SXA     LORR,2                IF NOT, SET INDICATOR AND          CRB01280
       CLA     STGE                  INITIALIZATION FOR SECOND HALF     CRB01290
       ADD     SIX                   OF CARD IMAGE AND RETURN           CRB01300
       STO     STGE                  TO CONVERSION PROCEDURE.           CRB01310
       AXT     3,2                   =                                  CRB01320
       CLA     MOD4+3,2              =                                  CRB01330
       ADD     ONE                   =                                  CRB01340
       STO     MOD4+3,2              =                                  CRB01350
       TIX     *-3,2,1               =                                  CRB01360
       TRA     PROC                  =                                  CRB01370
*                                                                       CRB01380
   AIT AXT     8,2                   ROUTINE FOR TESTING 8-3            CRB01390
       STI     .T                    AND 8-4 PUNCHES.                   CRB01400
       STI     .T+1                  =                                  CRB01410
       ANS     .T+1                  =                                  CRB01420
       LDI*    MOD5                  =                                  CRB01430
       ONT     .T+1                  =                                  CRB01440
       TRA     B4                    =                                  CRB01450
       PAI                           =                                  CRB01460
       OSI     .T                    =                                  CRB01470
       TRA     2,1                   =                                  CRB01480
*                                                                       CRB01490
  SBRT AXT     6,1                   CONVERSION SUBROUTINE              CRB01500
       TZE     1,4                   =                                  CRB01510
       XCL                           =                                  CRB01520
  CVRT PXD     ,0                    =                                  CRB01530
       LGL     1                     SPREAD INTO BCD FIELDS.            CRB01540
       ALS     5                     =                                  CRB01550
       LGL     1                     =                                  CRB01560
       ALS     5                     =                                  CRB01570
       LGL     1                     =                                  CRB01580
       ALS     5                     =                                  CRB01590
       LGL     1                     =                                  CRB01600
       ALS     5                     =                                  CRB01610
       LGL     1                     =                                  CRB01620
       ALS     5                     =                                  CRB01630
       LGL     1                     =                                  CRB01640
       STQ     .T                    SAVE UNDONE PORTION.               CRB01650
       SLW     .T+1                  COMBINE WITH PREVIOUS RESULTS.     CRB01660
       LDQ     ROW                   =                                  CRB01670
       VLM     .T+1,0,6              =                                  CRB01680
       LLS     6                     =                                  CRB01690
       ACL*    STGE                  =                                  CRB01700
       SLW*    STGE                  =                                  CRB01710
       LDQ     .T                    RESTORE UNDONE PORTION             CRB01720
       TIX     CVRT,1,1              AND CONTINUE.                      CRB01730
       TOV     *+1                   =                                  CRB01740
       TRA     1,4                   =                                  CRB01750
 EXIT  TRA RB01+2                                                       CRB01760
       SXD RB01,4                                                       CRB01770
       LXA RB01+2,4                                                     CRB01780
       TXI RB01+3,4,1                                                   CRB01790
*                                                                       CRB01800
*                  CONSTANTS                                            CRB01810
*                                                                       CRB01820
   ONE PZE     1                     =                                  CRB01830
   SIX PZE     6                     =                                  CRB01840
 EIGHT PZE     8                     =                                  CRB01850
   TEN PZE     10                    =                                  CRB01860
  SXTN PZE     16                    =                                  CRB01870
  EGTN PZE     18                    =                                  CRB01880
*                                                                       CRB01890
*                INDICATOR LOCATIONS                                    CRB01900
*                                                                       CRB01910
   DZN PZE                           INDICATOR FOR DOUBLE ZONE          CRB01920
  LORR PZE                           INDICATOR FOR 1ST OR 2ND HALF      CRB01930
   ROW PZE                           ROW INDICATOR                      CRB01940
  STGE PZE     **,1                  OUTPT+6,1 OR OUTPT+12,1            CRB01950
  MOD4 PZE     **,2                  INPUT+18,2 OR INPUT+19,2           CRB01960
  MOD5 PZE     **,2                  INPUT+10,2 OR INPUT+11,2           CRB01970
  MOD6 PZE     **,2                  INPUT+24,2 OR INPUT+25,2           CRB01980
 .T    PZE                           =                                  CRB01990
       PZE                           =                                  CRB02000
       PZE                           =                                  CRB02010
       END                                                              CRB02020
* 7090/94 SORT VER 7 MOD 8 RELEASE UNITS TO AVAILABILITY CHAIN       (8)CRE00000
*      FAP
       COUNT   60                                                       CRE00010
* CALLING SEQUENCE                                                      CRE00020
*      TSX     RELEAS,4                                                 CRE00030
*      PZE     LOCATION OF LIST,,ITS LENGTH                             CRE00040
*         RETURN                                                        CRE00050
       SPACE                                                            CRE00060
       ENTRY   RELEAS                                                   CRE00070
       SST                                                              CRE00080
       SPACE                                                            CRE00090
RELEAS SXA     REL08,1       SAVE INDEX                                 CRE00100
       SXA     REL10,2        REGISTERS.                                CRE00110
       SXA     REL12,4                                                  CRE00120
       CLA     SYSUAV        DETERMINE AND SAVE LOCATION                CRE00130
       STA     REL30          OF LOCATOR TABLE.                         CRE00140
       CLA     1,4           SAVE THE LOCATION                          CRE00150
       STA     REL22          OF LIST.                                  CRE00160
       PDX     ,2            ALSO GET LENGTH OF LIST.                   CRE00170
       TXH     REL16,2,0     GO TO RELEASE IF NONZERO LENGTH.           CRE00180
 REL08 AXT     **,1          RESTORE INDEX                              CRE00190
 REL10 AXT     **,2           REGISTERS.                                CRE00200
 REL12 AXT     **,4                                                     CRE00210
       CLA     =O777777                                              (7)CRE00215
       ANS     CNT19                                                 (7)CRE00216
       TRA     2,4           RETURN TO MAIN PROGRAM.                    CRE00220
 REL16 TXI     *+1,2,-1      SAVE LENGTH-1 FOR                          CRE00230
       SXD     REL20,2        LEAVING SUBROUTINE.                       CRE00240
       AXT     0,2           SET TO CHECK THROUGH LIST.                 CRE00250
 REL20 TXH     REL08,2,**    LEAVE SUBROUTINE WHEN COMPLETED.           CRE00260
 REL22 CLA     **,2          PICK UP THE ADDRESS OF UCW1.               CRE00270
       ANA     ADRMSK        IF THE ADDRESS GIVEN IN THE                CRE00280
       TNZ     *+2            LIST ENTRY IS ZERO, GO TO                 CRE00290
       TXI     REL20,2,1      PROCESS NEXT LIST ENTRY.                  CRE00300
       LAS     =O4100        IF THE ADDR GIVEN IN THE LIST ENTRY     (8)CRE00301
       TXI     REL20,2,1      IS THIS HIGH IT IS THE SYMBOL OF       (8)CRE00302
       TXI     REL20,2,1      AN UNASSIGNED INTERSYSTEM UNIT         (8)CRE00303
       LAS     =10           IF THE ADDRESS IN THE LIST ENTRY IS     (8)CRE00304
       TRA     *+3            LOW DO NOT TAKE THIS BRANCH            (8)CRE00305
       TXI     REL20,2,1      THIS IS A CHAIN NUMBER FOR WHICH A     (8)CRE00306
       TXI     REL20,2,1      UNIT HAS NOT YET BEEN ASSIGNED         (8)CRE00307
       STA     REL90         SAVE ADDRESS OF UCW1.                      CRE00310
       AXT     4,4           NUMBER OF UTX ENTRIES                      CRE00320
 REL24 CLA     SYSUT4+1,4    ADDRESS OF UTX UCW1                        CRE00330
       ANA     =O77777       ADDRESS OF SYSUTX ENTRY                    CRE00340
       ERA     REL90                                                    CRE00350
       TNZ     *+2           TEST IF UNIT TO BE RELEASED IS A UTX TAPE  CRE00360
       TXI     REL20,2,1      UTX TAPE FOUND-PROCESS NEXT LIST ENTRY    CRE00370
       TIX     REL24,4,1                                                CRE00380
       LDI*    REL90         PICK UP UCW1.                              CRE00390
       LNT     40000         TRANSFER IF NOT                            CRE00400
       TRA     REL27          INTERSYSTEM COMMUNICATION.                CRE00410
       CLA     CNT19         ARE INPUT UNITS BEING RELEASED NOW      (7)CRE00411
       LGR     18                                                    (7)CRE00412
       TNZ     *+4           YES                                     (7)CRE00413
       XEC     REL22                                                    CRE00420
       ALS     2             IF IT IS INTERSYSTEM COMMUNICATION         CRE00430
       TRA     *+6           NO                                      (7)CRE00431
       CAL     REL25                                                 (7)CRE00433
       SUB     =O01                                                  (7)CRE00434
       STA     REL25                                                 (7)CRE00435
REL25  LGL     18                                                    (7)CRE00436
       XCL                                                           (7)CRE00437
       PBT                    AND IS NOT TO BE RELEASED,                CRE00440
       TXI     REL20,2,1      GO PROCESS NEXT LIST ENTRY.               CRE00450
 REL27 RIL     40000         TURN OFF INTERSYSTEM COMMUNICATION FLAG.   CRE00460
       PIA                                                              CRE00470
       ANA     CHMSK         DETERMINE                                  CRE00480
       ARS     9              THE CHANNEL                               CRE00490
       SUB     ONEDEC         MAKING A=0,                               CRE00500
       PDC     ,1             B=-1,...,H=-7.                            CRE00510
       STZ     REL92         RESET SWITCH.                              CRE00520
 REL30 CLA     **,1          GET THE LOCATOR WORD OF THE                CRE00530
 REL32 ANA     =O77777        CHANNEL INVOLVED. TRANSFER                CRE00540
       TZE     REL40          IF THERE IS NO LINK IN CHAIN.             CRE00550
       STA     REL35         SAVE LOCATION OF LINK.                     CRE00560
       SUB     REL90         IF UNIT TO BE RELEASED IS ALREADY          CRE00570
       TNZ     *+2            RELEASED AND IN AVAILABILITY CHAIN,       CRE00580
       TXI     REL20,2,1      GO PROCESS NEXT LIST ENTRY.               CRE00590
       STL     REL92         OTHERWISE, CONTINUE THROUGH THE            CRE00600
 REL35 CLA     **             CHAIN UNTIL THE END OF THE                CRE00610
       TRA     REL32          CHAIN IS REACHED.                         CRE00620
 REL40 CLA     REL90         PUT THE LOCATION                           CRE00630
       ZET     REL92          OF UCW1 INTO                              CRE00640
       TRA     *+3            THE ADDRESS OF                            CRE00650
       STA*    REL30          THE LAST LINK                             CRE00660
       TRA     *+2            IN THE AVAILABILITY                       CRE00670
       STA*    REL35          CHAIN.                                    CRE00680
       SIL     400000        SET BIT S FOR AVAILABLE,                   CRE00690
       RIR     77777          AND MAKE ADDRESS ZERO.                    CRE00700
       STI*    REL90         STORE NEW UCW1.                            CRE00710
       TXI     REL20,2,1     GO PROCESS NEXT LIST ENTRY.                CRE00720
 REL90                       HOLDS LOC OF UCW1 OF UNIT TO BE RELEASED.  CRE00730
 REL92                       INTERNAL SWITCH.                           CRE00740
OPTPR  COMMON  15                                                    (7)CRE00741
OVEPR  COMMON  2                                                     (7)CRE00742
LABPR  COMMON  5                                                     (7)CRE00743
CHAPR  COMMON  6                                                     (7)CRE00744
FILPR  COMMON  14                                                    (7)CRE00745
MODPR  COMMON  50                                                    (7)CRE00746
RECPR  COMMON  10                                                    (7)CRE00747
DELPR  COMMON  2                                                     (7)CRE00748
SAMPR  COMMON  7                                                     (7)CRE00749
CALPR  COMMON  50                                                    (7)CRE00750
GENPR  COMMON  10                                                    (7)CRE00751
RAWPR  COMMON  30                                                    (7)CRE00752
CNTPR  COMMON  20                                                    (7)CRE00753
ERAPR  COMMON  30                                                    (7)CRE00754
REFPR  COMMON  1                                                     (7)CRE00755
CNT19  EQU     CNTPR-19                                              (7)CRE00756
ONEDEC         ,,1                                                      CRE00760
 CHMSK OCT     17000000000                                              CRE00770
ADRMSK OCT     000000077777                                          (8)CRE00780
       SPACE                                                            CRE00790
       END                                                              CRE00800
* 7090/94 SORT VER 7 MOD 6 CONTROL CARD SCANNER                      (6)CSK00000
*      FAP
       COUNT   2000                                                     CSK00010
       TITLE                                                            CSK00020
       ENTRY   SK001                                                    CSK00030
*                                                                       CSK00040
*      CALLING SEQUENCE FOR SCANNER                                     CSK00050
*                                                                       CSK00060
*          TSX   SK001,4                                                CSK00070
*          PZE   ADDR,, WDCT                                            CSK00080
*                                                                       CSK00090
*      ADDR -- BEGINNING ADDRESS OF CARD READ BUFFER                    CSK00100
*      WDCT -- NUMBER OF WORDS IN CARD READ BUFFER,                     CSK00110
*              FOR A PARTICULAR CARD                                    CSK00120
*                                                                       CSK00130
SK001  SXA     SK016,1       SAVE                                       CSK00140
       SXA     SK016+1,2        INDEX                                   CSK00150
       SXA     SK016+2,4           REGISTERS                            CSK00160
       AXT     22,1          INITIALIZE                                 CSK00170
       STZ     SK105+22,1       ALL                                     CSK00180
       TIX     *-1,1,1             INDICATORS                           CSK00190
       AXT     11,1          INITIALIZE                                 CSK00200
       STZ     SK104+11,1       OTHER                                   CSK00210
       TIX     *-1,1,1             INDICATORS AND COUNTERS              CSK00220
       AXT     100,1         INITIALIZE                                 CSK00230
       SXA     SK101+2,1        COUNT TO 100                            CSK00240
       CLA     SK100         BLANK OUT                                  CSK00250
       STO     SK200+100,1      DEFINER                                 CSK00260
       TIX     *-1,1,1             AREA                                 CSK00270
       CLA     1,4           SAVE ADDRESS AND WORD                      CSK00280
       STO     SK105            COUNT OF CONTROL CARDS                  CSK00290
       LXD     SK105,4       NUMBER OF WORDS TO REGISTER                CSK00300
       PXA     ,4            WORD COUNT TO AC                           CSK00310
       ADD     SK105         ADD ADDRESS OF CONTROL CARDS               CSK00320
       SUB     SK101         SUBTRACT ONE (1)                           CSK00330
       STA     *+4           PLACE SUM IN LDQ ADDRESS                   CSK00340
SK002  TXL     SK014,4,0     NO MORE WORDS LEFT                         CSK00350
       TXI     *+1,4,-1      DROP NUMBER OF WORDS BY ONE                CSK00360
       AXT     6,2           SET UP CHARACTERS REGISTER                 CSK00370
       LDQ     **,4          GET CONTROL CARD INFORMATION (BCD)         CSK00380
SK003  PXA     0,0           CLEAR AC                                   CSK00390
       TXL     SK002,2,0     NO MORE CHARACTERS, GET ANOTHER WORD       CSK00400
       TXI     *+1,2,-1      DROP NUMBER OF CHARACTERS BY ONE           CSK00410
       LGL     6             GET A CHARACTER                            CSK00420
       ZET     SK105+7       IS NON - TEST INDICATOR ON                 CSK00430
       TRA     SK012         YES                                        CSK00440
       ZET     SK105+1       IS BLANK INDICATOR ON                      CSK00450
       TRA     SK004         YES                                        CSK00460
       PAI                   SAVE CHARACTER IN INDICATORS               CSK00470
       ERA     SK100+1       IS CHARACTER A BLANK                       CSK00480
       TZE     SK003         YES, GET ANOTHER CHARACTER                 CSK00490
       PIA                   REPLACE CHARACTER IN THE AC                CSK00500
SK004  AXT     4,1           TEST CHARACTER FOR                         CSK00510
       ERA     SK102+4,1        RIGHT PARENTHESIS                       CSK00520
       TZE*    SK103+4,1        SLASH                                   CSK00530
       PIA                      COMMA                                   CSK00540
       TIX     *-3,1,1          LEFT PARENTHESIS                        CSK00550
       PIA                   REPLACE CHARACTER IN THE AC                CSK00560
       NZT     SK105+2       IS FIRST COMMA INDICATOR ON                CSK00570
       TRA     SK003         NO, GET ANOTHER CHARACTER                  CSK00580
       ZET     SK104+10      IS LIMIT INDICATOR ON                      CSK00590
       TRA     SK003         YES, DISREGARD CHARACTER(S)                CSK00600
       ZET     SK105+8       IS SLASH INDICATOR ON                      CSK00610
       TRA     SK006         YES                                        CSK00620
       LXA     SK105+13,1    PLACE NO. OF CHARACTERS SAVED IN XR        CSK00630
       TXH     SK005,1,2     3 CHARACTERS ALREADY SAVED                 CSK00640
       TXI     *+1,1,1       ADD ONE TO THE NUMBER OF CHARACTERS        CSK00650
       SXA     SK105+13,1    SAVE NUMBER OF CHARACTERS SAVED            CSK00660
SK004A PAI                   SAVE CURRENT CHARACTER(S)                  CSK00670
       CLA     SK104         GET CHARACTERS ALREADY SAVED               CSK00680
       ALS     6             SHIFT SAVED CHARACTER ONE PLACE            CSK00690
       OAI                   PLACE CURRENT CHARACTER                    CSK00700
       STI     SK104            INTO REST OF SAVED CHARACTERS           CSK00710
       ZET     SK199         WAS SIX-CHAR INDICATOR SET                 CSK00720
       STZ     SK199         YES  RESET                                 CSK00730
       CLA     SK104+8       GET SK104 CHARACTER COUNT                  CSK00740
       ADD     SK101         ADD ONE (1)                                CSK00750
       STA     SK104+8       SAVE NEW TOTAL                             CSK00760
       ERA     SK101+4       COMPARE WITH SIX (6)                       CSK00770
       TNZ     SK003         GET ANOTHER CHARACTER                      CSK00780
       NZT     SK104+9       IS SECOND CELL OCCUPIED                    CSK00790
       TRA     *+3           NO                                         CSK00800
       STL     SK104+10      YES, SET LIMIT INDICATOR                   CSK00810
       TRA     SK003         GET ANOTHER CHARACTER                      CSK00820
       CLA     SK104         GET SAVED CHARACTERS                       CSK00830
       STO     SK104+9       SAVE FIRST PART OF TWO WORDS               CSK00840
       CAL     SK100         GET ALL BLANKS                             CSK00850
       SLW     SK104         RESET CHARACTER HOLDER                     CSK00860
       STZ     SK104+8       INITIALIZE CHARACTER COUNT                 CSK00870
       STL     SK199         RESET SIX-CHAR INDICATOR                   CSK00880
       TRA     SK003         GET ANOTHER CHARACTER                      CSK00890
SK005  ZET     SK105+9       IS 3 - CHARACTER INDICATOR ON              CSK00900
       TRA     SK003         YES                                        CSK00910
       STL     SK105+9       SET 3 CHARACTER INDICATOR                  CSK00920
       STZ     SK104+8       INITIALIZE SK104 COUNT                     CSK00930
       CLA     SK104         GET CHARACTER(S)                           CSK00940
       ALS     18            MAKE THEM LEFT JUSTIFIED                   CSK00950
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK00960
       SLW     SK200+100,1   SET UP THREE CHARACTER DEFINER             CSK00970
       CAL     SK100         GET ALL BLANKS                             CSK00980
       SLW     SK104         RESET CHARACTER HOLDER                     CSK00990
       NZT     SK105+3       IS GROUP INDICATOR ON                      CSK01000
       TRA     *+5           NO                                         CSK01010
       CLA     SK105+10      GET NUMBER OF DEFINERS UNDER  GRO          CSK01020
       ADD     SK101         ADD ONE (1)                                CSK01030
       STA     SK105+10      SAVE TOTAL                                 CSK01040
       TRA     *+4                                                      CSK01050
       CLA     SK105+11      GET NUMBER OF DEFINERS                     CSK01060
       ADD     SK101         ADD ONE (1)                                CSK01070
       STA     SK105+11      SAVE TOTAL                                 CSK01080
       CAL     SK200+100,1   GET DEFINER                                CSK01090
       PAI                   SAVE CHARACTER IN INDICATORS               CSK01100
       ERA     SK102+4       IS THE DEFINER  NAM                        CSK01110
       TZE     *+4           YES                                        CSK01120
       PIA                   REPLACE CHARACTER IN THE AC                CSK01130
       ERA     SK102+5       IS THE DEFINER  IDE                        CSK01140
       TNZ     *+2           NO                                         CSK01150
       STL     SK105+6       YES, SET NAM/IDE INDICATOR                 CSK01160
       TXI     *+1,1,-1      DROP COUNT BY ONE                          CSK01170
       SXA     SK101+2,1     SAVE COUNT CELL                            CSK01180
       ZET     SK105+16      IS LAST NAME INDICATOR ON                  CSK01190
       TRA     SK014+9       YES, RETURN                                CSK01200
       TRA     SK003         GET ANOTHER CHARACTER                      CSK01210
SK006  NZT     SK105+6       IS NAM/IDE INDICATOR ON                    CSK01220
       TRA     SK004A        NO, SAVE CHARACTER(S)                      CSK01230
       AXT     3,1           IS                                         CSK01240
       PAI                    THE                                       CSK01250
       ERA     SK102+9,1      CHARACTER                                 CSK01260
       TZE     *+4            O  OR                                     CSK01270
       PIA                    B  OR                                     CSK01280
       TIX     *-3,1,1        H                                         CSK01290
       TRA     SK007         SAVE CHARACTER                             CSK01300
       STL     SK105+1       SET BLANK INDICATOR                        CSK01310
       STZ     SK105+6       RESET NAM/IDE INDICATOR                    CSK01320
       STQ     SK104+6       SAVE CONTENTS OF MQ                        CSK01330
       LDQ     SK105+20      HOLDS THE HUNDREDS POSITION.               CSK01340
       MPY     =100                                                     CSK01350
       STQ     SK105+21                                                 CSK01360
       LDQ     SK104+1       GET FIRST CHARACTER OF NAM/IDE             CSK01370
       MPY     SK101+1       MULTIPLY BY TEN (10)                       CSK01380
       XCA                                                              CSK01390
       ADD     SK105+21                                                 CSK01400
       ADD     SK104+2       ADD SECOND CHARACTER                       CSK01410
       STA     SK105+14      STORE IN COUNT CELL                        CSK01420
       PIA                   PLACE O, B, OR H                           CSK01430
       ALS     30               LEFT JUSTIFIED IN                       CSK01440
       ORA     SK105+14            SAME CELL AS COUNT                   CSK01450
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK01460
       SLW     SK200+100,1   PLACE O, B, OR H IN BUFFER WITH COUNT      CSK01470
       STL     SK105+7       SET NON - TEST INDICATOR                   CSK01480
       TXI     *+1,1,-1      DECREMENT COUNT BY ONE                     CSK01490
       SXA     SK101+2,1     SAVE COUNT                                 CSK01500
       LDQ     SK104+6       REPLACE CONTENTS OF MQ                     CSK01510
       TRA     SK003         GET ANOTHER CHARACTER                      CSK01520
SK007  NZT     SK105+15      GET NUMBER OF CHARACTERS IN NUMBER         CSK01530
       TRA     SK007M                                                   CSK01540
       PAI                   SAVE CHARACTER, TEMPORARILY                CSK01550
       NZT     SK105+19      SECOND CHARACTER INDICATOR.                CSK01560
       TRA     SK007D                                                   CSK01570
       CLA     SK104+1                                                  CSK01580
       STO     SK105+20                                                 CSK01590
       CLA     SK104+2                                                  CSK01600
       STO     SK104+1                                                  CSK01610
       STI     SK104+2                                                  CSK01620
       STZ     SK105+19                                                 CSK01630
       TRA     SK003                                                    CSK01640
SK007D CLA     SK104+2       INTERCHANGE                                CSK01650
       STA     SK104+1          FIRST AND SECOND                        CSK01660
       STI     SK104+2             CHARACTERS                           CSK01670
       STL     SK105+19                                                 CSK01680
       TRA     SK003                                                    CSK01690
SK007M STA     SK104+2       FIRST CHARACTER                            CSK01700
       STL     SK105+15      SET INDICATOR                              CSK01710
       TRA     SK003         GET ANOTHER CHARACTER                      CSK01720
SK008  NZT     SK105+5       IS MINOR PARENTHESIS INDICATOR ON          CSK01730
       TRA     SK008A        NO                                         CSK01740
       NZT     SK104+9       ARE THERE TWO WORDS IN CHARACTER HOLDER    CSK01750
       TRA     *+3           NO                                         CSK01760
       STL     SK105+17      YES, SET LAST PARAMETER INDICATOR          CSK01770
       TRA     SK010B        STORE CHARACTER(S)                         CSK01780
       STL     SK105+17      SET LAST PARAMETER INDICATOR               CSK01790
       CAL     SK104         GET FIRST CELL OF CHARACTER HOLDER         CSK01800
       ERA     SK100         IS IT BLANK                                CSK01810
       TNZ     SK010A+8      STORE CHARACTER(S)                         CSK01820
       TRA     SK010A+5      STORE VACUOUS ZERO                         CSK01830
       STZ     SK105+5       RESET MINOR PARENTHESIS INDICATOR          CSK01840
       CLA     SK105+12      GET NUMBER OF PARAMETERS                   CSK01850
       PAI                                                              CSK01860
       ADD     SK101+2       ADD BUFFER COUNT                           CSK01870
       ADD     SK101         ADD ONE (1)                                CSK01880
       ADD     2WRDCT        ADD NUMBER OF 2-WORD PARAMETERS.        (4)CSK01881
       PAX     ,1            PLACE IN REGISTER                          CSK01890
       PIA                                                              CSK01900
       ORS     SK200+100,1   PLACE IN BUFFER                            CSK01910
       STZ     SK105+8       RESET SLASH INDICATOR                      CSK01920
       STZ     SK105+12      RESET PARAMETER COUNT                      CSK01930
       STZ     SK105+17      RESET LAST PARAMETER INDICATOR             CSK01940
       STZ     SK104+9       RESET SECOND CELL OF CHARACTER HOLDER      CSK01950
       STZ     2WRDCT        RESET NUMBER OF 2-WORD PARAMETERS       (4)CSK01952
       TRA     SK003         GET ANOTHER CHARACTER                      CSK01960
SK008A STZ     SK105+4       RESET MAJOR PAREN INDICATOR                CSK01970
       STZ     SK105+3       RESET GROUP INDICATOR                      CSK01980
       CLA     SK105+10      GET NUMBER OF DEFINERS UNDER GROUP         CSK01990
       LXA     SK104+4,1     GET XR 4 VALUE FOR GRO                     CSK02000
       STA     SK200+100,1   PLACE COUNT IN GRO                         CSK02010
       STZ     SK105+10      RESET GRO DEFINER COUNT                    CSK02020
       TRA     SK003         GET ANOTHER CHARACTER                      CSK02030
SK009  STL     SK105+8       SET SLASH INDICATOR                        CSK02040
       ZET     SK105+9       IS 3 CHARACTER INDICATOR ON                CSK02050
       TRA     SK003         YES                                        CSK02060
       TRA     SK005+2       SAVE DEFINER                               CSK02070
SK010  ZET     SK105+5       IS MINOR PARENTHESIS INDICATOR ON          CSK02080
       TRA     *+6           YES                                        CSK02090
       ZET     SK105+2       NO, IS FIRST COMMA INDICATOR ON            CSK02100
       TRA     *+3           YES                                        CSK02110
       STL     SK105+2       SET FIRST COMMA INDICATOR                  CSK02120
       TRA     SK003         GET ANOTHER CHARACTER                      CSK02130
       STZ     SK105+9       TURN OFF THREE CHARACTER INDICATOR         CSK02140
       STZ     SK105+1       TURN OFF BLANK INDICATOR                   CSK02150
       STZ     SK105+15      RESET NUMBER OF NAM/IDE CHARACTERS         CSK02160
       STZ     SK105+13      INITIALIZE SK104 CHARACTER COUNT           CSK02170
       STZ     SK104+10      RESET LIMIT INDICATOR                      CSK02180
       ZET     SK105+8       IS SLASH INDICATOR ON                      CSK02190
       TRA     SK010A        YES                                        CSK02200
       NZT     SK104+8       ANY CHARACTERS SAVED FOR DEFINER           CSK02210
       TRA     SK003         NO                                         CSK02220
       STZ     SK104+8       RESET CHARACTER COUNT                      CSK02230
       TRA     SK005+4       STORE 3 CHARACTERS FOR DEFINER             CSK02240
SK010A ZET     SK104+9       TWO WORDS IN THIS PARAMETER                CSK02250
       TRA     SK010B        YES                                        CSK02260
       CAL     SK104         GET CHARACTER HOLDER                       CSK02270
       ERA     SK100         IS IT BLANK                                CSK02280
       TNZ     *+4           NO                                         CSK02290
       CLA     SK100         GET ALL BLANKS                             CSK02300
       ALS     6             PLACE ZERO IN RIGHTMOST PART               CSK02310
       TRA     *+2           STORE IT                                   CSK02320
       CLA     SK104         GET CHARACTERS                             CSK02330
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK02340
       STO     SK200+100,1   STORE CHARACTER(S)                         CSK02350
       CLA     SK105+12      GET PARAMETER COUNT                        CSK02360
       ADD     SK101         ADD ONE (1)                                CSK02370
       STA     SK105+12      SAVE SUM                                   CSK02380
       ZET     SK105+5       IS MINOR PARENTHESIS INDICATOR ON          CSK02390
       TRA     PAREN         YES.                                    (6)CSK02400
       STZ     SK105+8       TURN OFF SLASH INDICATOR                   CSK02410
       TXI     *+1,1,1       ADD ONE TO BUFFER COUNT                    CSK02420
       CLA     SK105+12      GET PARAMETER COUNT                        CSK02430
       ORS     SK200+100,1   PLACE PARAMETER COUNT IN DEFINER           CSK02440
       TXI     *+1,1,-1                                                 CSK02450
       STZ     SK105+12      INITIALIZE PARAMETER COUNT                 CSK02460
       STZ     2WRDCT                                                (6)CSK02461
PAREN  TXI     *+1,1,-1      DECREMENT COUNT BY ONE.                 (6)CSK02470
       SXA     SK101+2,1     SAVE COUNT                                 CSK02480
       CAL     SK100         GET ALL BLANKS                             CSK02490
       SLW     SK104         RESET CHARACTER HOLDER                     CSK02500
       STZ     SK104+8       RESET CHARACTER COUNT                      CSK02510
       ZET     SK105+17      IS LAST PARAMETER INDICATOR ON             CSK02520
       TRA     SK008+11      YES                                        CSK02530
       ZET     SK105+16      IS LAST WORD INDICATOR ON                  CSK02540
       TRA     SK015+5       YES                                        CSK02550
       TRA     SK003         NO, GET ANOTHER CHARACTER                  CSK02560
SK010B CAL     SK104         GET CHARACTER HOLDER                       CSK02570
       ERA     SK100         IS IT BLANK                                CSK02580
       TNZ     *+5           NO                                         CSK02590
       CLA     SK104+9       INTERCHANGE TWO                            CSK02600
       STO     SK104            CHARACTER HOLDERS                       CSK02610
       STZ     SK104+9       RESET SECOND CELL OF CHARACTER HOLDER      CSK02620
       TRA     SK010A+8      CONTINUE AS IF ONLY ONE WORD               CSK02630
       STQ     SK104+6       SAVE CONTENTS OF MQ                        CSK02640
       CLS     SK104+8       GET NEGATIVE OF CHARACTER COUNT            CSK02650
       ADD     SK101+4       ADD SIX (6)                                CSK02660
       XCA                                                              CSK02670
       MPY     SK101+4       MULTIPLY BY SIX (6)                        CSK02680
       XCA                                                              CSK02690
       STA     *+3           STORE PRODUCT IN RQL INSTRUCTION           CSK02700
       STA     *+4           STORE PRODUCT IN LGR INSTRUCTION           CSK02710
       LDQ     SK104         GET SECOND PART OF WORD                    CSK02720
       RQL     **                                                       CSK02730
       CLA     SK104+9       GET FIRST PART OF TWO WORDS                CSK02740
       LGR     **                                                       CSK02750
       SSP                   INDICATE 2-WORD PARAMETER.              (4)CSK02751
       LXA     SK101+2,1     GET BUFFER DEFINER COUNT CELL              CSK02760
       STO     SK200+100,1    STORE FIRST PART OF TWO WORDS          (4)CSK02770
       TXI     *+1,1,-1                                                 CSK02780
       STQ     SK200+100,1   STORE SECOND PART OF TWO WORDS             CSK02790
       TXI     *+1,1,-1           DECREMENT COUNT BY ONE             (4)CSK02830
       CLA     2WRDCT        COUNT OF 2-WORD PARAMETERS              (4)CSK02831
       ADD     SK101                                                 (4)CSK02832
       STA     2WRDCT                                                (4)CSK02833
       CLA     SK105+12      GET PARAMETER COUNT                     (4)CSK02834
       ADD     SK101         ADD ONE                                 (4)CSK02835
       STA     SK105+12      SAVE SUM                                (4)CSK02836
       SXA     SK101+2,1     SAVE BUFFER DEFINER COUNT CELL             CSK02840
       CAL     SK100         GET ALL BLANKS                             CSK02850
       SLW     SK104         RESET CHARACTER HOLDER                     CSK02860
       STZ     SK104+8       INITIALIZE CHARACTER COUNT                 CSK02870
       STZ     SK104+9       INITIALIZE SECOND WORD HOLDER              CSK02880
       LDQ     SK104+6       RESTORE CONTENTS OF MQ                     CSK02910
       TRA     SK010B-5                                                 CSK02920
SK011  NZT     SK105+8       IS SLASH INDICATOR ON                      CSK02930
       TRA     *+3           NO                                         CSK02940
       STL     SK105+5       SET MINOR PARENTHESIS INDICATOR            CSK02950
       TRA     SK003         GET ANOTHER CHARACTER                      CSK02960
       STL     SK105+4       SET MAJOR PARENTHESIS INDICATOR            CSK02970
       CLA     SK102+9       GET GRO DEFINER                            CSK02980
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK02990
       SLW     SK200+100,1   PLACE GRO IN BUFFER                        CSK03000
       SXA     SK104+4,1     SAVE XR4 VALUE FOR GRO DEFINER             CSK03010
       TXI     *+1,1,-1      DECREMENT COUNT BY ONE                     CSK03020
       SXA     SK101+2,1     SAVE COUNT                                 CSK03030
       STL     SK105+3       SET GROUP INDICATOR                        CSK03040
       CLA     SK105+11      GET NUMBER OF DEFINERS                     CSK03050
       ADD     SK101         ADD ONE (1)                                CSK03060
       STA     SK105+11      SAVE SUM                                   CSK03070
       TRA     SK003         GET ANOTHER CHARACTER                      CSK03080
SK012  AXT     6,1                                                      CSK03090
       ALS     36,1                                                     CSK03100
       ORS     SK104+3       PLACE CHARACTER IN CELL                    CSK03110
       CLA     SK105+14      GET NAM/IDE INDICATOR CHARACTER COUNT      CSK03120
       SUB     SK101         SUBTRACT ONE (1)                           CSK03130
       STA     SK105+14      STORE COUNT OF CHARACTERS                  CSK03140
       TZE     *+4           COUNTER DEPLETED                           CSK03150
       TXI     *+1,1,6       HAVE SIX CHARACTERS                        CSK03160
       SXA     SK012,1          BEEN READ                               CSK03170
       TXL     SK003,1,36          IN YET                               CSK03180
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK03190
       CLA     SK104+3       GET NAM/IDE TEMPORARY CELL                 CSK03200
       STO     SK200+100,1   STORE IN BUFFER                            CSK03210
       TXI     *+1,1,-1      DECREMENT COUNT BY ONE                     CSK03220
       SXA     SK101+2,1     SAVE COUNT                                 CSK03230
       CLA     SK104+7       GET COUNT OF NAM/IDE WORDS                 CSK03240
       ADD     SK101         ADD ONE (1)                                CSK03250
       STA     SK104+7       SAVE COUNT                                 CSK03260
       AXT     6,1           RESTORE ORIGINAL VALUE                     CSK03270
       SXA     SK012,1          OF INDEX REGISTER USED FOR SHIFTING     CSK03280
       STZ     SK104+3       RESET NAM/IDE TEMPORARY CELL               CSK03290
       ZET     SK105+14      IS COUNTER DEPLETED YET                    CSK03300
       TRA     SK003         NO, MORE BCD CHARACTERS TO BE READ         CSK03310
       STZ     SK105+7       RESET NON-TEST INDICATOR                   CSK03320
       LXA     SK101+2,1     GET DEFINER BUFFER COUNT CELL              CSK03330
       PXA     ,1            PLACE IN AC                                CSK03340
       ADD     SK104+7       ADD NAM/IDE WORD COUNT                     CSK03350
       ADD     SK101         ADD                                        CSK03360
       ADD     SK101            TWO                                     CSK03370
       PAX     ,1            PLACE NEW VALUE IN REGISTER                CSK03380
       CLA     SK104+7       GET NAM/IDE COUNT                          CSK03390
       ADD     SK101         ADD ONE (1)                                CSK03400
       ORS     SK200+100,1   PLACE COUNT IN NAM/IDE INDICATOR           CSK03410
       STZ     SK104+1       RESET HOLDERS OF                           CSK03420
       STZ     SK104+2          NAM/IDE COUNT                           CSK03430
       STZ     SK104+7       RESET NAM/IDE WORD COUNT                   CSK03440
       STZ     SK105+1       RESET BLANK INDICATOR                      CSK03450
       STZ     SK105+8       RESET SLASH INDICATOR                      CSK03460
       STZ     SK105+14      RESET NAM/IDE CHARACTER COUNT              CSK03470
       ZET     SK105+18      IS LAST NAM/IDE CHARACTER INDICATOR ON     CSK03480
       TRA     SK016-5       YES                                        CSK03490
       TRA     SK003         GET ANOTHER CHARACTER                      CSK03500
       PZE     SK200         DEFINER AREA ADDRESS                       CSK03510
SK014  CAL     SK104         GET CHARACTER HOLDER                       CSK03520
       ERA     SK100         IS IT BLANK                                CSK03530
       TZE     SK015                                                    CSK03540
       STL     SK105+16      YES, SET LAST WORD INDICATOR               CSK03550
       ZET     SK105+9       IS 3 CHAR INDICATOR ON                     CSK03560
       TRA     SK010A        PLACE THEM IN BUFFER                       CSK03570
       TRA     SK005+2                                                  CSK03580
SK015  NZT     SK199         WAS SIX-CHAR INDICATOR SET                 CSK03590
       TRA     *+4                                                      CSK03600
       STL     SK105+16      SET LAST WORD INDICATOR                    CSK03610
       STZ     SK199                                                    CSK03620
       TRA     SK010A                                                   CSK03630
       NZT     SK104+3       ANY NAM/IDE CHARACTERS LEFT                CSK03640
       TRA     *+3           NO                                         CSK03650
       STL     SK105+18      SET LAST NAM/IDE CHARACTER INDICATOR       CSK03660
       TRA     SK012+3       PLACE NAM/IDE CHARACTER(S) IN BUFFER       CSK03670
       CLA     SK014-1       GET OCTAL ADDRESS OF SK200                 CSK03680
       LGR     18                                                       CSK03690
       ADD     SK105+11      ADD NUMBER OF DEFINERS                     CSK03700
       ADD     SK105+10      ADD NUMBER OF DEFINERS UNDER GRO DEFINER   CSK03710
       LGL     18                                                       CSK03720
SK016  AXT     ,1            RESTORE                                    CSK03730
       AXT     ,2               INDEX                                   CSK03740
       AXT     ,4                  REGISTERS                            CSK03750
       TOV     *+1           TURN OFF OVERFLOW LIGHT                    CSK03760
       TRA     2,4           RETURN TO CALLER                           CSK03770
2WRDCT PZE                                                           (4)CSK03771
SK199  PZE                   SIX-CHAR INDICATOR                         CSK03780
SK100  OCT     606060606060     BBBBBB                                  CSK03790
       OCT     60               00000B                                  CSK03800
SK101  DEC     1,10,100,2,6                                             CSK03810
SK102  OCT     34,61,73,74   RIGHT PAREN, SLASH, COMMA, LEFT PAREN      CSK03820
       OCT     452144000000  NAM DEFINER                                CSK03830
       OCT     312425000000  IDE DEFINER                                CSK03840
       OCT     22,30,46      B, H, O                                    CSK03850
       OCT     275146000000  GRO DEFINER                                CSK03860
SK103  PZE     SK008         ***  RIGHT PARENTHESIS ROUTINE  ***        CSK03870
       PZE     SK009         ***  SLASH ROUTINE  ***                    CSK03880
       PZE     SK010         ***  COMMA ROUTINE  ***                    CSK03890
       PZE     SK011         ***  LEFT PARENTHESIS ROUTINE  ***         CSK03900
SK104  BSS     11            ADDITIONAL COUNTERS AND TEMPORARY CELLS    CSK03910
SK105  BSS     22            INDICATORS AND COUNTERS                    CSK03920
SK200  BSS     100           BUFFER DEFINER AREA                        CSK03930
       END                                                              CSK03940
* 7090/94 SORT VER 7 MOD 8 VARIABLE INTERNAL SORT PHASE 1            (8)CVX00000
*      FAP
       COUNT   1150                                                     CVX00010
       ENTRY   VXS                                                      CVX00020
       SST                                                              CVX00030
       TITLE                                                            CVX00040
*                                                                       CVX00050
*       INTERNAL SORT PHASE - PROGRAM SYMBOL DEFINITIONS                CVX00060
*                                                                       CVX00070
*  1.  G.  SIZE OF CORE AVAILABLE AS RECORD STORAGE AREA (RSA).         CVX00080
*          IT EXTENDS FROM LAST RECORD HOLDING AREA TO COMMON.          CVX00090
*                                                                       CVX00100
*  2.  L.  NUMBER OF RECORDS CURRENTLY IN THE CONTINUOUS MERGE OF THE   CVX00110
*          INTERNAL SORT PHASE.  THE L TABLES RESIDE IN THE LOWER PARTS CVX00120
*          OF THE LARGE TABLES WHICH ALSO HOLD THE AVAILABILITY TABLES  CVX00130
*          IN THEIR UPPER PARTS.  AFTER SORTING BEGINS, ONE L TABLE,    CVX00140
*          CALLED THE FROM.TABLE, IS MERGED WITH THE SORT TABLE TO FORM CVX00150
*          THE OTHER L TABLE, THE TO.TABLE.  THE NAMES OF THESE TABLES  CVX00160
*          ARE CYCLED AFTER THE MERGE SO THE PUT LIST OF TAGS POINTING  CVX00170
*          TO RECORDS TO BE WRITTEN OUT ARE TAKEN FROM THE NEW          CVX00180
*          FROM.TABLE AND THE WRITE TABLE IS BUILT IN THE OTHER LARGE   CVX00190
*          TABLE FOLLOWING THE AVAILABILITY TABLE.  THEN GET USES THE   CVX00200
*          AVAILABILITY TABLE IN THE LARGE TABLE THAT THE NEW           CVX00210
*          FROM.TABLE IS IN FOR MOVING NEW RECORDS FROM THE BUFFER      CVX00220
*          INTO G AND FOR BUILDING THE SORT TABLE.                      CVX00230
*                                                                       CVX00240
*  3.  M.  NUMBER OF RECORDS IN THE LAST WRITE.  THE NUMBER WILL VARY   CVX00250
*          BUT THE NUMBER OF WORDS PER MERGE BLOCK AND THE NUMBER OF    CVX00260
*          BLOCKS PER PUT WILL TEND TOWARD CONSTANTS ESTABLISHED BY     CVX00270
*          CALCULATIONS.                                                CVX00280
*                                                                       CVX00290
*  4.  RATIO.  USED TO ESTABLISH THE TIME TO WRITE.  NO WRITING IS DONE CVX00300
*          UNTIL THE NUMBER OF BINS REMAINING AVAILABLE BECOMES LESS    CVX00310
*          THAN OR EQUAL TO 1/R OF THE TOTAL NUMBER OF BINS.            CVX00320
*                                                                       CVX00330
*  5.  MERGE BLOCKING.  THE MAXIMUM NUMBER OF WORDS THAT WILL BE        CVX00340
*          WRITTEN OUT IN ONE MERGE BLOCK.                              CVX00350
*                                                                       CVX00360
*  6.  XSBSZ.  THE LIMITING POWER FOR A BINARY SEARCH.  ITS VALUE FOR   CVX00370
*          A GIVEN SEARCH IS 2*P+4, WHERE P IS THE 2'S POWER OF THE     CVX00380
*          NUMBER OF RECORDS IN RSA.                                    CVX00390
*                                                                       CVX00400
*  7.  MORDER.  ORDER OF MERGE.  NUMBER OF FILES PRODUCED BY INTERNAL   CVX00410
*          SORT PHASE.  WHILE THIS PHASE CAN PRODUCE AS MANY AS 16      CVX00420
*          FILES, THE MERGE PHASES CAN HANDLE A MAXIMUM OF 10 FILES.    CVX00430
*                                                                       CVX00440
*  8.  THE STARTING LOCATIONS OF THE FROM.TABLE AND THE TO.TABLE ARE    CVX00450
*          IN XST AND XST2 RESPECTIVELY.                                CVX00460
*                                                                       CVX00470
*  9.  THE BASE LOCATIONS OF THE FROM.TABLE AND THE TO.TABLE ARE IN     CVX00480
*          XSTL AND XST2L RESPECTIVELY.                                 CVX00490
*                                                                       CVX00500
*  10.  SORT TABLE.  THE LOCATION AND LENGTH OF THIS TABLE ARE IN THE   CVX00510
*          ADDRESS AND DECREMENT OF ERA09.                              CVX00520
*                                                                       CVX00530
*  11.  G.  IN MERGE, REFERS TO FROM.TABLE.                             CVX00540
*                                                                       CVX00550
*  12.  S.  IN MERGE, REFERS TO SORT TABLE.                             CVX00560
*                                                                       CVX00570
*  13.  MERGE TAPES (FILES) ARE CYCLED AS STRINGS ARE COMPLETED.        CVX00580
*                                                                       CVX00590
*  14.  RSA IS DIVIDED INTO EQUAL SEGMENTS CALLED BINS.                 CVX00600
*                                                                       CVX00610
*  15.  BLOCK TABLE FOR PUT.  INTERNAL SORT SETS UP A CALLING           CVX00620
*          SEQUENCE FOR PUT WHICH CONSISTS OF ONE OR MORE WORDS,        CVX00630
*          ONE FOR EACH MERGE BLOCK TO BE WRITTEN AT THIS TIME.         CVX00640
*          EACH WORD HAS IN ITS DECREMENT THE NUMBER OF RECORDS         CVX00650
*          NEEDED TO FORM A MERGE BLOCK AND IN ITS ADDRESS              CVX00660
*          THE POSITION IN THE NEW FROM.TABLE OF THE FIRST TAG POINTING CVX00670
*          TO THESE RECORDS.  ERA10 TELLS WHERE THE BLOCK TABLE IS AND  CVX00680
*          HOW LONG IT IS.  CALCULATIONS PLACES THE MAXIMUM NUMBER OF   CVX00690
*          MERGE BLOCKS PER PUT IN CAL33, THE MINIMUM NUMBER OF WORDS   CVX00700
*          PER BLOCK IN CAL34, AND THE MAXIMUM NUMBER OF WORDS PER      CVX00710
*          BLOCK IN CAL13.                                              CVX00720
 VXS   SXA     XRC,4         SAVE XR4 FOR FINAL RETURN TO SORT MONITOR  CVX00730
       TXI     *+1,4,-1      ADJUST FOR DELETE RETURN (RESTART TO SORT  CVX00740
       SXD     GEN03,4        MONITOR) AND PLACE IN COMMON.             CVX00750
       SXA     END,2                                                    CVX00760
       AXT     1,1                                                      CVX00770
       SXA     GENPR,1                                                  CVX00780
*                                                                       CVX00790
*          INITIALIZATION                                               CVX00800
*                                                                       CVX00810
*  INITIALIZE CONTROL OF WRITING VIA MERGE BLOCK PARAMETER              CVX00820
*                                                                       CVX00830
       LXA     CAL33,1       MAXIMUM NUMBER OF MERGE BLOCKS PER PUT     CVX00840
       TXI     *+1,1,-1                                                 CVX00850
       SXD     XS047A,1                                                 CVX00860
*                                                                       CVX00870
*  INITIALIZE MINIMUM WRITE CONTROL FOR PUT SUBPROGRAM                  CVX00880
*                                                                       CVX00890
       LXA     CAL34,1       MINIMUM NUMBER OF WORDS PER PUT            CVX00900
       TXI     *+1,1,-1                                                 CVX00910
       SXD     XSS14,1                                                  CVX00920
*                                                                       CVX00930
*  INITIALIZE MAXIMUM WRITE CONTROL FOR PUT SUBPROGRAM                  CVX00940
*                                                                       CVX00950
       LXA     CAL13,1       NUMBER OF WORDS PER MERGE BLOCK            CVX00960
       SXD     XSY16,1                                                  CVX00970
       TXI     *+1,1,-1      MERGE BLOCKING - 1                         CVX00980
       SXD     XSY17,1                                                  CVX00990
*                                                                       CVX01000
*  SET CONTROL FOR FILLING CORE STORAGE                                 CVX01010
*                                                                       CVX01020
       ZAC                                                              CVX01030
       LDQ     CAL05         TOTAL NUMBER OF BINS IN SORT               CVX01040
       DVP     CAL07         RATIO                                      CVX01050
       XCA                                                              CVX01060
       ALS     18                                                       CVX01070
       STD     XSY10         STORE IN LIMITS TEST                       CVX01080
*                                                                       CVX01090
*  INITIALIZE MERGE ORDER                                               CVX01100
*                                                                       CVX01110
       LXA     SAM01,4       MERGE ORDER                                CVX01120
       SXA     MORT,4        CURRENT MERGE ORDER                        CVX01130
       SXD     XSY60,4                                                  CVX01140
*                                                                       CVX01150
*   INITIALIZE MERGE ORDER MINUS 1                                      CVX01160
*                                                                       CVX01170
       TXI     *+1,4,-1                                                 CVX01180
       SXD     MORT1,4       MERGE ORDER MINUS 1                        CVX01190
       SXD     XSY61,4                                                  CVX01200
*                                                                       CVX01210
*  INITIALIZE  L/2 AND L/2+3                                            CVX01220
*                                                                       CVX01230
       CLA     CAL05         L                                          CVX01240
       ARS     1             L/2                                        CVX01250
       STA     XSBSZ         SAVE FOR FURTHER INITIALIZATION            CVX01260
       PAX     ,1                                                       CVX01270
       SXD     ERA03,1       SIZE OF FIRST AVAILABILITY TABLE           CVX01280
       SXD     ERA04,1       SIZE OF SECOND AVAILABILITY TABLE          CVX01290
       ADD     THREE         L/2+3                                      CVX01300
       STA     XSG           SAVE FOR FURTHER INITIALIZATION            CVX01310
*                                                                       CVX01320
*  INITIALIZE LENGTHS OF BUFFER AND BUFFER, LOCATE, AND SORT TABLES     CVX01330
*                                                                       CVX01340
       LXA     CAL31,1       LENGTH OF BUFFER                           CVX01350
       SXD     ERA00,1                                                  CVX01360
       LXA     CAL35,1                                                  CVX01370
       SXD     ERA01,1                                                  CVX01380
       LXA     CAL36,1                                                  CVX01390
       SXD     ERA02,1                                                  CVX01400
*                                                                       CVX01410
*  INITIALIZE LENGTH OF LAST RECORD HOLDING AREA                        CVX01420
*                                                                       CVX01430
       CLA     CAL12         TOTAL WORDS ALL CFS EXCEPT EQUALS          CVX01440
       ADD     OPT03         EQUALS OPTION   0=NO,1=YES                 CVX01450
       STA     ERA12         EFFECTIVE LENGTH ALL CF                    CVX01460
*                                                                       CVX01470
*  INITIALIZE  BUFFER AREA                                              CVX01480
*                                                                       CVX01490
       CLA     END           LAST CELL USED FOR PROGRAM                 CVX01500
       ADD     THREE         LEAVE BLANK CELLS                          CVX01510
       STA     ERA00         BUFFER ADDRESS                             CVX01520
       LXD     ERA00,1       BUFFER LENGTH                              CVX01530
       PXA     ,1                                                       CVX01540
       ADD     ERA00                                                    CVX01550
       ADD     ONE           LEAVE BLANK CELL                           CVX01560
*                                                                       CVX01570
*  INITIALIZE BUFFER TABLE AND LOCATE TABLE                             CVX01580
*                                                                       CVX01590
       STA     ERA01         ADDRESS OF BUFFER TABLE                    CVX01600
       LXD     ERA01,1       LENGTH OF BUFFER TABLE                     CVX01610
       PXA     ,1                                                       CVX01620
       ADD     ERA01                                                    CVX01630
       ADD     ONE           LEAVE BLANK CELL                           CVX01640
       STA     ERA02         ADDRESS OF LOCATE TABLE                    CVX01650
       LXD     ERA02,1                                                  CVX01660
       PXA     ,1                                                       CVX01670
       ADD     ERA02                                                    CVX01680
       ADD     ONE           LEAVE BLANK CELL                           CVX01690
*                                                                       CVX01700
*  INITIALIZE GET,PUT,L, AND SORT TAG TABLES                            CVX01710
*                                                                       CVX01720
       STA     ERA03         LOCATION OF FIRST AVAILABILITY TABLE       CVX01730
       ADD     XSBSZ         L/2                                        CVX01740
       STA     XST           INITIAL LOC OF FIRST L TAG TABLE           CVX01750
       STA     XSY21                                                    CVX01760
       ADD     XSG           L/2+3                                      CVX01770
       STA     ERA04         LOCATION OF SECOND AVAILABILITY TABLE      CVX01780
       STA     XSTL          BASE LOCATION OF FIRST L TABLE             CVX01790
       STA     XSLCAL                                                   CVX01800
       STA     XSMOV                                                    CVX01810
       ADD     XSBSZ         L/2                                        CVX01820
       STA     XST2          INITIAL LOCATION OF SECOND L TABLE         CVX01830
       ADD     XSG           L/2+3                                      CVX01840
       STA     XST2L         BASE LOCATION OF SECOND L TABLE            CVX01850
       STA     XSY22                                                    CVX01860
       STA     XSMOV+2                                                  CVX01870
       STA     XSMRG+2                                                  CVX01880
       ADD     THREE         LEAVE THREE BLANK CELLS                    CVX01890
       STA     ERA09         FIRST LOCATION OF SORT TABLE               CVX01900
       ADD     CAL06         LENGTH OF SORT TABLE                       CVX01910
       STA     XSCYCL        BASE ADDRESS OF SORT TABLE                 CVX01920
       ADD     ONE           LEAVE BLANK CELL                           CVX01930
*                                                                       CVX01940
*  INITIALIZE AREA FOR SETTING UP BLOCK LIST FOR PUT                    CVX01950
*                                                                       CVX01960
       STA     BLKTAB        FIRST CELL OF BLOCK LIST                   CVX01970
       CLA     CAL33         MAXIMUM NUMBER OF BLOCKS PER PUT           CVX01980
       STA     XSG                                                      CVX01990
*                                                                       CVX02000
*  INITIALIZE LAST RECORD HOLDING AREA AND ZERO IT OUT                  CVX02010
*                                                                       CVX02020
       CLA     BLKTAB                                                   CVX02030
       STA     ERA10                                                    CVX02040
       ADD     XSG                                                      CVX02050
       ADD     ONE           LEAVE BLANK CELL                           CVX02060
       ADD     CAL12                                                    CVX02070
       STA     XSP1          BASE ADDR OF LRHA WITHOUT SEQUENCE WORD    CVX02080
       ADD     OPT03         ADD ONE IN CASE OF EQUALS OPTION           CVX02090
       STA     XSP3         BASE ADDRESS OF LRHA WITH SEQUENCE WORD     CVX02100
       STA     XSY01                                                    CVX02110
       STA     XS050+1                                                  CVX02120
       STA     *+2                                                      CVX02130
       LXA     ERA12,1                                                  CVX02140
       STZ     **,1          ZERO OUT CF AREA OF                        CVX02150
       TIX     *-1,1,1         LAST RECORD HOLDING AREA                 CVX02160
*                                                                       CVX02170
*  INITIALIZE NECESSARY READ/WRITE PARAMETERS IN COMMON                 CVX02180
*                                                                       CVX02190
       AXT     1,1           START STRING COUNT FOR                     CVX02200
       SXA     COUNT,1        MERGE PHASE AT ONE                        CVX02210
       SXD     RAW08,1        IN SEQUENCE LEVEL INDICATOR               CVX02220
*                                                                       CVX02230
*  INITIALIZE  G AREA                                                   CVX02240
*                                                                       CVX02250
       ADD     ONE                                                      CVX02260
       STA     XSG           FIRST LOCATION OF RECORD STORAGE AREA      CVX02270
*                                                                       CVX02280
*  PREPARE EACH AVAILABILITY TABLE WITH L/2 BIN LOCATIONS               CVX02290
*                                                                       CVX02300
       CAL     XSG                                                      CVX02310
       AXT     2,2                                                      CVX02320
       LXA     XSBSZ,1       L/2 INTO XR1                               CVX02330
 XSY21 STA     **,1          XST, FILL FIRST AVAILABILITY TABLE         CVX02340
       ADD     CAL03          WITH BIN LOCATIONS.                       CVX02350
       TIX     *-2,1,1                                                  CVX02360
       TNX     XSY24,2,1                                                CVX02370
       LXA     XST2,4        REINITIALIZE AND FILL                      CVX02380
       SXA     XSY21,4        SECOND AVAILABILITY TABLE WITH LOCATIONS. CVX02390
       LXA     XSBSZ,1       REINITIALIZE XR1 WITH L/2                  CVX02400
       TRA     XSY21                                                    CVX02410
*                                                                       CVX02420
*  INITIALIZE COMPARE LOOPS IN CASE OF EQUALS OPTION                    CVX02430
*                                                                       CVX02440
 XSY24 NZT     OPT03         TEST FOR EQUALS                            CVX02450
       TRA     OPCKPT        NO                                         CVX02460
       AXT     XSCPB,1       BINARY SEARCH COMPARE LOOP                 CVX02470
       SXA     XSCPE+1,1                                                CVX02480
       AXT     XS024+1,1     TWO-WAY MERGE  COMPARE LOOP                CVX02490
       SXA     XSMEQ+1,1                                                CVX02500
       AXT     KYLWR1,1      INTERNAL SORT UNIT COMPARE LOOP            CVX02510
       SXA     XSEQ+1,1                                                 CVX02520
*                                                                       CVX02530
*  OPEN CHECKPOINT AND UNREADABLE RECORDS FILES                         CVX02540
*                                                                       CVX02550
OPCKPT BSS     0                                                        CVX02560
       ZET     CHA05                                                    CVX02570
       TRA     XSOPIT                                                   CVX02580
       CLA     =O477777000000                                           CVX02590
       STO     RAW00                                                    CVX02600
       CALL    IOPEN                                                    CVX02610
*                                                                       CVX02620
*   OPEN INTERNAL SORT INPUT FILE                                       CVX02630
*                                                                       CVX02640
XSOPIT BSS     0                                                        CVX02650
       CLA     LAB04         HAS ADDRESS WHERE LABEL IS STORED          CVX02660
       ADD     TWO           THIRD WORD OF LABEL                        CVX02670
       STO     ERA20                                                    CVX02680
       STZ     RAW00                                                    CVX02690
       STZ     RAW03         INITIALIZE EOF INDICATOR                   CVX02700
       CALL    IOPEN                                                    CVX02710
*                                                                       CVX02720
*   OPEN INTERNAL SORT OUTPUT FILES                                     CVX02730
*                                                                       CVX02740
       CAL     *             STORE MINUS IN SIGN POSITION OF            CVX02750
       STP     RAW00          CALLING SEQUENCE WORD                     CVX02760
       LXA     SAM01,2       MERGE ORDER                                CVX02770
       AXT     1,1           STORE FILE NO. IN DECREMENT OF             CVX02780
       SXD     RAW00,1        CALLING SEQUENCE WORD                     CVX02790
       PXD     ,1                                                       CVX02800
       STD*    ERA20                                                    CVX02810
       CALL    IOPEN                                                    CVX02820
       TXI     *+1,1,1       GET NEXT FILE NO. AND                      CVX02830
       TIX     *-5,2,1        REPEAT FOR ALL FILES                      CVX02840
*                                                                       CVX02850
*  INITIAL GET                                                          CVX02860
*                                                                       CVX02870
XSGET1 CALL    GET                                                      CVX02880
*                                                                       CVX02890
       ZET     ERA18                                                    CVX02900
       TRA     XSY19+1                                                  CVX02910
       ZET     MOD25         CE MOD                                     CVX02920
       CALL    DXS01                                                    CVX02930
*                                                                       CVX02940
*  END OF FILE TEST                                                     CVX02950
*                                                                       CVX02960
       ZET     RAW03         TEST EOF INDICATOR                         CVX02970
       TRA     WEOF                                                     CVX02980
*                                                                       CVX02990
       LXD     ERA09,4       ANY RECORDS THIS GET                       CVX03000
       TXH     XSXTR,4,0     YES                                        CVX03010
       ENB     =0                                                       CVX03020
       CLA     ERA03         SWITCH AVAILABILITY TABLE POINTERS         CVX03030
       LDQ     ERA04                                                    CVX03040
       STQ     ERA03                                                    CVX03050
       STO     ERA04                                                    CVX03060
       LXA     XSMOV,4       SYNCHRONIZE MERGE TABLE ADDRESSES          CVX03070
       LXA     XSMOV+2,2       WITH GET AND PUT ADDRESSES               CVX03080
       SXA     XSMOV+2,4                                                CVX03090
       SXA     XSY22,4                                                  CVX03100
       SXA     XSMRG+2,4                                                CVX03110
       SXA     XSMOV,2                                                  CVX03120
       SXA     XSLCAL,2                                                 CVX03130
       ENB*    (TRAPX                                                   CVX03140
       SXD     ERA10,0       ZERO OUT DECR OF PUT CALL SEQ WORD         CVX03150
       SXD     XSY14,0       SET PUT RECORD COUNT TO ZERO               CVX03160
       STZ     MRT3                                                     CVX03170
       CALL    PUT                                                      CVX03180
       TSX     TAPEND,4                                                 CVX03190
       TRA     XSGET1                                                   CVX03200
 XSXTR CALL    XTRACT                                                   CVX03210
*                                                                       CVX03220
       LXD     ERA09,4                                                  CVX03230
       SXA     ERA07,4       COUNT FOR FIRST L TABLE                    CVX03240
       SXA     ERA08,4                                                  CVX03250
       SXA     XSY10+1,4                                                CVX03260
*                                                                       CVX03270
       TSX     SORT,4                                                   CVX03280
*                                                                       CVX03290
       LXD     ERA09,4                                                  CVX03300
       SXD     XSY07,4                                                  CVX03310
       PXA     ,4                                                       CVX03320
       ADM     ERA09                                                    CVX03330
       STA     XSY06                                                    CVX03340
       LXA     XSMOV+2,2                                                CVX03350
       SXA     XSY06+1,2                                                CVX03360
 XSY07 TIX     *+1,2,**                                                 CVX03370
       SXA     XS009,2       XST, INITIAL STARTING ADDR OF FIRST L TABLECVX03380
       SXA     XSEG,2                                                   CVX03390
       SXD     XSEG1,2                                                  CVX03400
 XSY06 CLA     **,4          MOVE FIRST SORT TAGS                       CVX03410
       STO     **,4            TO FIRST L TABLE                         CVX03420
       TIX     *-2,4,1                                                  CVX03430
       ENB     =0                                                       CVX03440
       CLA     ERA03                                                    CVX03450
       LDQ     ERA04                                                    CVX03460
       STQ     ERA03                                                    CVX03470
       STO     ERA04                                                    CVX03480
       LXA     XSMOV,4       SYNCHRONIZE MERGE TABLE ADDRESSES          CVX03490
       LXA     XSMOV+2,2       WITH GET AND PUT ADDRESSES               CVX03500
       SXA     XSMOV+2,4                                                CVX03510
       SXA     XSY22,4                                                  CVX03520
       SXA     XSMRG+2,4                                                CVX03530
       SXA     XSMOV,2                                                  CVX03540
       SXA     XSLCAL,2                                                 CVX03550
       ENB*    (TRAPX                                                   CVX03560
       SXD     ERA10,0       ZERO OUT DECR OF PUT CALL SEQ WORD         CVX03570
       SXD     XSY14,0       SET PUT RECORD COUNT TO ZERO               CVX03580
       STZ     MRT3                                                     CVX03590
       CALL    PUT                                                      CVX03600
       TSX     TAPEND,4      RETURN IF EOT.                             CVX03610
*                                                                       CVX03620
*  ALTERNATE GET-(NORMAL GET ROUTINE)                                   CVX03630
*                                                                       CVX03640
 XSGET CALL    GET                                                      CVX03650
*                                                                       CVX03660
       ZET     ERA18                                                    CVX03670
       TRA     XSY19+1                                                  CVX03680
       ZET     MOD25         CE MOD                                     CVX03720
       CALL    DXS01                                                    CVX03730
*                                                                       CVX03740
 XSY09 TIX     XSY11,,1024   CHANGED TO  TRA XSY11  WHEN G IS FILLED    CVX03750
       LXD     ERA03,2       ADD NUMBER OF BINS                         CVX03760
       SXD     *+2,2          REMAINING IN THE                          CVX03770
       LXD     ERA04,2        AVAILABILITY TABLES                       CVX03780
       TXI     *+1,2,**                                                 CVX03790
 XSY10 TXL     XSY13,2,**    TRANSFER IF IT IS NOW TIME TO WRITE.       CVX03800
       AXT     0,2                                                      CVX03810
       LXD     ERA09,4       KEEP COUNT OF RECORDS IN RSA IN CASE OF    CVX03820
       SXD     *+1,4           EOF BEFORE RSA IS FILLED                 CVX03830
       TXI     *+1,2,**                                                 CVX03840
       SXA     XSY10+1,2                                                CVX03850
       TRA     XSY11                                                    CVX03860
 XSY13 ZAC                                                              CVX03870
       STP     XSY09                                                    CVX03880
       STL     FILLSW        INDICATE G IS FILLED                       CVX03890
*                                                                       CVX03900
*   END OF FILE TEST                                                    CVX03910
*                                                                       CVX03920
 XSY11 ZET     RAW03         TEST EOF INDICATOR                         CVX03930
       TRA     MTY           GO TO EOF ROUTINE                          CVX03940
*                                                                       CVX03950
*   SET UP CALLING SEQUENCE FOR EXTRACT ROUTINE                         CVX03960
*                                                                       CVX03970
       LXD     ERA09,4       ANY RECORDS THIS GET                       CVX03980
       TXL     XSY41+1,4,0   NO                                         CVX03990
       CALL    XTRACT        YES,GO TO XTRACT                           CVX04000
*                                                                       CVX04010
*   BEGINNING OF PROCESS AREA                                           CVX04020
*                                                                       CVX04030
       ZET     MOD26         CE MOD                                     CVX04040
       CALL    DXS02                                                    CVX04050
       ZET     MOD27         CE MOD                                     CVX04060
       CALL    DXS03                                                    CVX04070
       ZET     MOD28         CE MOD                                     CVX04080
       CALL    DXS04                                                    CVX04090
*                                                                       CVX04100
 XSY41 LXD     ERA09,4       NUMBER OF RECORDS THIS GET                 CVX04110
       SXD     XSY14+1,4                                                CVX04120
       SXD     XS029B,4                                                 CVX04130
       TXH     XSY43,4,0                                                CVX04140
       LXA     XSMOV,4       NO RECORDS THIS GET,SET SORT BASE ONE      CVX04150
       TXI     *+1,4,-1       POSITION BEFORE FROM.TABLE BASE ADDRESS   CVX04160
       SXA     XSCYCL,4        AND STORE IN BASE ADDRESS OF SORT TABLE  CVX04170
       TRA     XS009A                                                   CVX04180
 XSY43 PXA     ,4                                                       CVX04190
       ADD     ERA09         GET BASE ADDRESS                           CVX04200
       STO     XSCYCL          OF SORT TABLE                            CVX04210
       TSX     SORT,4                                                   CVX04220
       ZET     MOD29         CE MOD                                     CVX04230
       CALL    DXS05                                                    CVX04240
*                                                                       CVX04250
*  SET UP ADDRESSES TO MERGE THE SORT LIST WITH G LIST                  CVX04260
*                                                                       CVX04270
XS009A AXT     XSS05+1,4                                                CVX04280
       SXA     XSS03-2,4                                                CVX04290
       SXA     XSS03-1,4                                                CVX04300
 XS009 AXT     **,4          XST                                        CVX04310
       TXI     *+1,4,-1                                                 CVX04320
       SXA     XSCPB,4       ALTER COMPARE BASE                         CVX04330
       LDQ     XSLCAL        CAL* XST+L,4                               CVX04340
       STQ     XS024+1                                                  CVX04350
       CLA     XSCYCL        SORT BASE                                  CVX04360
       STA     XS024+2                                                  CVX04370
       STA     XSMRG                                                    CVX04380
       AXT     XS024,4                                                  CVX04390
       SXA     XS025,4                                                  CVX04400
       AXT     XS023,4                                                  CVX04410
       SXA     XS026,4                                                  CVX04420
       AXT     XS028,4                                                  CVX04430
       SXA     XS030,4                                                  CVX04440
*                                                                       CVX04450
*  INITIALIZE M                                                         CVX04460
*                                                                       CVX04470
       LXA     ERA06,1       NUMBER FOR LAST WRITE                      CVX04480
       SXD     XS033,1                                                  CVX04490
       SXD     XSOTX,1                                                  CVX04500
       TXI     *+1,1,1       M+1                                        CVX04510
       SXA     XSY52,1                                                  CVX04520
*                                                                       CVX04530
*  INITIALIZE -M                                                        CVX04540
*                                                                       CVX04550
       LAC     ERA06,1                                                  CVX04560
       SXD     XS100+1,1                                                CVX04570
*                                                                       CVX04580
*  INITIALIZE  L AND L+1                                                CVX04590
*                                                                       CVX04600
       LXA     ERA07,1                                                  CVX04610
       SXA     ERA08,1                                                  CVX04620
       TXI     *+1,1,1                                                  CVX04630
       SXA     XSY50,1       L+1 FOR LAST WRITE FROM.TABLE              CVX04640
 XSY14 TIX     *+1,1,**       LAST PUT OR WRITE                         CVX04650
       TXI     *+1,1,**       LAST GET OR READ                          CVX04660
       SXA     XSY56,1       L+1 FOR NEXT WRITE TO.TABLE                CVX04670
       TXI     *+1,1,-1       L COUNT FOR NEXT WRITE MERGE TABLE        CVX04680
       SXA     ERA07,1                                                  CVX04690
       SXD     MDON,1                                                   CVX04700
*                                                                       CVX04710
*  END OF RESTORING TWO-WAY MERGE PASSES                                CVX04720
*                                                                       CVX04730
       CLA*    ERA09         GET FIRST SORT TAG FOR BIN SRCH            CVX04740
       STA     XSP2                                                     CVX04750
*                                                                       CVX04760
*  SET UPPER AND LOWER BOUNDS ON ONE OR TWO PART BINARY SEARCH          CVX04770
*                                                                       CVX04780
 XSEG  AXT     **,4          XST, XST+D, XST+L+D                        CVX04790
       SXD     *+2,4                                                    CVX04800
       LXA     XSMOV,2                                                  CVX04810
       TIX     *+1,2,**      XSEG IN DECR                               CVX04820
       SXD     XS028,2                                                  CVX04830
       SXD     XS023,2                                                  CVX04840
       SXD     XS029A,2                                                 CVX04850
*                                                                       CVX04860
       LXD     ERA09,1       TEST FOR ANY RECORDS THIS GET              CVX04870
       TXH     XSEG1,1,0     YES, FIND BINARY SEARCH POSITION           CVX04880
       LAC     XSY50,4       SET BIN SRCH POSITION ONE BEYOND L TABLE   CVX04890
       TRA     XSMTG         BINARY SEARCH RETURN FOR MERGE POSITION    CVX04900
*                                                                       CVX04910
 XSEG1 TNX     XS020,4,**    XST/XST+L                                  CVX04920
       PXD     ,4            SET TO DO TWO PART BINARY SEARCH           CVX04930
       COM                                                              CVX04940
       STD     XS100                                                    CVX04950
       STD     XSS01                                                    CVX04960
       AXC     1,4                                                      CVX04970
       TRA     XS022                                                    CVX04980
 XS020 LAC     XSY52,4                                                  CVX04990
       LAC     XSY50,2                                                  CVX05000
       SXD     XSS01,2       SET UPPER BOUND                            CVX05010
 XS022 SXD     XSS01+1,4     SET LOWER BOUND                            CVX05020
*                                                                       CVX05030
*  INITIALIZE LIMITING POWER FOR BINARY SEARCH (2*P)+4                  CVX05040
*                                                                       CVX05050
       AXT     1,1                                                      CVX05060
       CLA     TWO                                                      CVX05070
 SHIFT ALS     1                                                        CVX05080
       CAS     ERA08                                                    CVX05090
       TRA     CALC                                                     CVX05100
       TXI     CALC,1,1                                                 CVX05110
       TXI     SHIFT,1,1     2*P LESS OR EQUAL TO L, LESS THAN 2*(P+1)  CVX05120
 CALC  PXA     ,1            P INTO AC                                  CVX05130
       ALS     1             2*P                                        CVX05140
       ADD     FOUR          (2*P)+4                                    CVX05150
       STO     XSBSZ                                                    CVX05160
*                                                                       CVX05170
*  BINARY SEARCH                                                        CVX05180
*                                                                       CVX05190
       AXT     0,4                                                      CVX05200
       LXA     XSBSZ,2                                                  CVX05210
       XEC     XSS05,2                                                  CVX05220
 XSS01 TXL     XSS02,4,**    -(XSEG-XST+1),-L-1                         CVX05230
       TXH     XSS04,4,**    -1, -M-1, -(XSEG-XST+1)-M                  CVX05240
       LXA     CAL12,1       XR1 USED TO INDEX CF WORDS                 CVX05250
 XSCPB CAL*    **,4          XST-1                                      CVX05260
       LAS*    XSP2                                                     CVX05270
 XSS02 TXI     XSS03,2,-2    G GT S, P GT L                             CVX05280
       TRA     *+2                                                      CVX05290
 XSS04 TXI     XSS05,2,-2    G LT S, P LT L                             CVX05300
 XSCPE TIX     XSCPB,1,1                                                CVX05310
       TXI     *+1,1,-1      RESET XR1                                  CVX05320
       TXI     XSS03,2,-2                                               CVX05330
*                                                                       CVX05340
       TXI     XSS01,4,-16384                                           CVX05350
       TXI     XSS01,4,8192                                             CVX05360
       TXI     XSS01,4,-8192                                            CVX05370
       TXI     XSS01,4,4096                                             CVX05380
       TXI     XSS01,4,-4096                                            CVX05390
       TXI     XSS01,4,2048                                             CVX05400
       TXI     XSS01,4,-2048                                            CVX05410
       TXI     XSS01,4,1024                                             CVX05420
       TXI     XSS01,4,-1024                                            CVX05430
       TXI     XSS01,4,512                                              CVX05440
       TXI     XSS01,4,-512                                             CVX05450
       TXI     XSS01,4,256                                              CVX05460
       TXI     XSS01,4,-256                                             CVX05470
       TXI     XSS01,4,128                                              CVX05480
       TXI     XSS01,4,-128                                             CVX05490
       TXI     XSS01,4,64                                               CVX05500
       TXI     XSS01,4,-64                                              CVX05510
       TXI     XSS01,4,32                                               CVX05520
       TXI     XSS01,4,-32                                              CVX05530
       TXI     XSS01,4,16                                               CVX05540
       TXI     XSS01,4,-16                                              CVX05550
       TXI     XSS01,4,8                                                CVX05560
       TXI     XSS01,4,-8                                               CVX05570
       TXI     XSS01,4,4                                                CVX05580
       TXI     XSS01,4,-4                                               CVX05590
       TXI     XSS01,4,2                                                CVX05600
       TXI     XSS01,4,-2                                               CVX05610
       TXI     XSS01,4,1                                                CVX05620
       TXI     XSS01,4,-1                                               CVX05630
       TRA     *+4                                                      CVX05640
       TXI     **,4,-1       *+3, S GT G, BR TEST FOR 2-PART BIN SRCH   CVX05650
 XSS03 XEC     *,2                                                      CVX05660
 XSS05 XEC     *,2                                                      CVX05670
*                                                                       CVX05680
*  TWO PART BINARY SEARCH TEST                                          CVX05690
*                                                                       CVX05700
       LXD     XSS01+1,2                                                CVX05710
       TXL     XSMTG,2,-2    ONE PART BIN SRCH                          CVX05720
 XS100 TXH     XSMTG,4,**    -(XSEG-XST+1)                              CVX05730
       TXI     XS020+1,4,**  -M, DO 2ND PART BINARY SEARCH              CVX05740
*                                                                       CVX05750
*  BINARY SEARCH RETURN FOR MERGE POSITION                              CVX05760
*                                                                       CVX05770
 XSMTG PXA     ,4            IN-LIST POSITION                           CVX05780
       COM                                                              CVX05790
       PAX     ,2                                                       CVX05800
       SXD     *+2,2                                                    CVX05810
       LXA     ERA08,1       LENGTH OF FROM.TABLE                       CVX05820
       TIX     *+2,1,**                                                 CVX05830
       AXT     0,1           INDICATE FIRST S IN SEQUENCE WITH LAST G   CVX05840
       SXA     XSTXR,1        LENGTH FROM.TABLE, IN-LIST POSITION       CVX05850
       LXA     ERA07,1                                                  CVX05860
       TXL     XS029,2,0     DO NOT MOVE ANY TAGS, G GT FIRST S         CVX05870
       ADD     XS009                                                    CVX05880
       STA     XS028+1                                                  CVX05890
       LXA     ERA08,4                                                  CVX05900
XS028  TXL     XS031,4,**     (XST+L-XSEG)                              CVX05910
       LDQ     **,2          XST+D, MORE COMP FREE LIST TO ALTER POS    CVX05920
 XSY22 STQ     **,1          XST2L                                      CVX05930
       TIX     *+1,1,1                                                  CVX05940
       TIX     *+1,4,1                                                  CVX05950
 XS030 TIX     XS028,2,1                                                CVX05960
 XS029 LXD     ERA09,2       M FOR THIS GET                             CVX05970
       TXL     MDUN,2,0      EXIT FOR ZERO GET                          CVX05980
       LXA     XS030,4                                                  CVX05990
       TXH     XS034,4,XS028  HOP OVER XSEG (EMPTY G TAGS)              CVX06000
       LXA     XSTXR,4        (XSTL/XST2L)-(IN-LIST POSITION)           CVX06010
XS029A TXH     XS032,4,**     (XSTL-XSEG),ASSURE HOP OVER ON EQUALS     CVX06020
XS034  CLA     XS025         YES                                        CVX06030
       STA     XS026                                                    CVX06040
       PXA     ,1            MAKE XR4 EQUAL TO XR1                      CVX06050
       PAX     ,4                                                       CVX06060
       SXA     XSLXR,1                                                  CVX06070
XS029B TIX     XSMRG,4,**    GET, DECR OF FROM.TABLE FOR NO MORE HOP    CVX06080
       TRA     XSFXM                                                    CVX06090
 XS032 SXA     XSLXR,1                                                  CVX06100
       TRA     XSMRG         EG TAGS STILL TO HOP OVER                  CVX06110
XSLCAL CAL*    **,4          XSTL                                       CVX06120
*                                                                       CVX06130
*  SET HOP OVER FROM.TABLE TAGS                                         CVX06140
*                                                                       CVX06150
 XS031 CLA     XS030                                                    CVX06160
       ADD     ONE                                                      CVX06170
       STA     XS030                                                    CVX06180
 XS033 TIX     XS028+1,2,**  M IN DECREMENT                             CVX06190
       TRA     XS029                                                    CVX06200
*                                                                       CVX06210
*   TWO-WAY MERGE                                                       CVX06220
*                                                                       CVX06230
 XS023 TXL     XSFXCP,4,**   (XST+L-XSEG), HOP OVER GATE                CVX06240
 XS024 LXA     CAL12,1       TOTAL WORDS ALL CFS INTO XR1               CVX06250
       CAL*    **,4          XST+L/XST+2L                               CVX06260
       LAS*    **,2          XST+2L+M                                   CVX06270
       TRA     XSMRG         G GT S                                     CVX06280
       TRA     *+2                                                      CVX06290
 XS027 TRA     XSMOV                                                    CVX06300
XSMEQ  TIX     XS024+1,1,1                                              CVX06310
       TXI     *+1,1,-1      RESET XR1                                  CVX06320
       TRA     XS027                                                    CVX06330
 XSMOV LDQ     **,4          XSTL/XST2L                                 CVX06340
       LXA     XSLXR,1       XR1 HAS TAG FOR ALTERNATE L TABLE          CVX06350
       STQ     **,1          XST2L/XSTL                                 CVX06360
       TNX     MDUN,1,1                                                 CVX06370
       SXA     XSLXR,1       SAVE POSITION IN ALTERNATE L TABLE         CVX06380
 XS026 TIX     XS023,4,1     TEST IF STILL IN BOUNDS                    CVX06390
       TRA     XSFXM         NO, HOP OVER XSEG                          CVX06400
 XSMRG LDQ     **,2          XSCYCL, MOVE LOW SORT TAG TO TO.TABLE      CVX06410
       LXA     XSLXR,1       RESTORE XR1 TO BUILD ALTERNATE L TABLE     CVX06420
       STQ     **,1          XST2L/XSTL                                 CVX06430
       TNX     MDUN,1,1                                                 CVX06440
       SXA     XSLXR,1       SAVE POSITION IN ALTERNATE L TABLE         CVX06450
 XS025 TIX     XS024,2,1     NEXT COMPARE                               CVX06460
       CAL     *+2           SET NO MORE COMPARES IN ONE FOR ONE MERGE  CVX06470
       SLW     XS024+1                                                  CVX06480
       TRA     XSMOV                                                    CVX06490
XSFXCP CLA     XS024+1                                                  CVX06500
       LDI     XS024+1                                                  CVX06510
       LNT     002000                                                   CVX06520
       CLA     *+2                                                      CVX06530
       STA     XS026                                                    CVX06540
 XSOTX TIX     XS024,4,**    M                                          CVX06550
XSFXM  AXT     XSMRG,1       IF AT END OF L OR AT HOP OVER, NULLIFY     CVX06560
       SXA     XS025,1        BOUNDS TEST.                              CVX06570
       TRA     XSMRG                                                    CVX06580
*                                                                       CVX06590
*                                                                       CVX06600
MDUN   LXA     XSMOV,4        SET FOR NEXT GO-ROUND                     CVX06610
       LXA     XSMOV+2,2     SWAP POSITIONS OF TAG TABLES               CVX06620
       SXA     XSMOV+2,4                                                CVX06630
       SXA     XSY22,4                                                  CVX06640
       SXA     XSMRG+2,4                                                CVX06650
       SXA     XSMOV,2                                                  CVX06660
       SXA     XSLCAL,2                                                 CVX06670
       SXA     XS044,2       XSTL/XST2L FOR THIS WRITE                  CVX06680
 MDON  TIX     *+1,2,        L   NEXT TABLE BASE ADDRESSES              CVX06690
       SXA     XS009,2                                                  CVX06700
       SXD     XSEG1,2                                                  CVX06710
       SXD     XS043,2                                                  CVX06720
*                                                                       CVX06730
*  TEST IF G AREA IS FILLED. IF NOT CONTINUE FILLING                    CVX06740
*                                                                       CVX06750
XSFILD TIX     XSOUTP,,1024  CHANGED TO  TRA XSOUTP  WHEN G IS FILLED   CVX06760
       LXA     XS009,2       SET XSEG FOR NEXT MERGE TO                 CVX06770
       SXA     XSEG,2          STARTING ADDR OF NEXT MERGE TAG TABLE    CVX06780
       ZET     FILLSW                                                   CVX06790
       TRA     XS041                                                    CVX06800
       ENB     =0                                                       CVX06810
       CLA     ERA03                                                    CVX06820
       LDQ     ERA04                                                    CVX06830
       STQ     ERA03                                                    CVX06840
       STO     ERA04                                                    CVX06850
       ENB*    (TRAPX                                                   CVX06860
       TRA     XSGET                                                    CVX06870
 XS041 ZAC                                                              CVX06880
       STP     XSFILD         CLOSE FILL GATE                           CVX06890
*                                                                       CVX06900
*                                                                       CVX06910
XSOUTP BSS     0                                                        CVX06920
       CAL     XSP1          LAST RECORD OF PREVIOUS WRITE              CVX06930
       STA     XSP2          LAST RECORD OF PREVIOUS WRITE              CVX06940
       LXA     XS009,4                                                  CVX06950
       TXI     *+1,4,-1                                                 CVX06960
       SXA     XSCPB,4       MODIFY CMP BASE TO THIS BASE               CVX06970
       AXT     XSS11,4                                                  CVX06980
       SXA     XSS03-1,4                                                CVX06990
       SXA     XSS03-2,4                                                CVX07000
       LXA     ERA07,1       FIND XSBSZ FOR PRESENT WRITE TABLE         CVX07010
       SXA     ERA08,1        TO USE IN BINARY SEARCH                   CVX07020
       AXC     1,4                                                      CVX07030
       LAC     XSY56,2        L+1 FOR BINARY SEARCH FOR WRITE POSITION  CVX07040
       SXD     XSS11,2                                                  CVX07050
       TRA     XS020+2        TO BINARY SEARCH                          CVX07060
*                                                                       CVX07070
 XSS11 BSS     0             BINARY SEARCH RETURN                       CVX07080
       TXL     XSENDG,4,**   NEW SEQUENCE INDICATED BY BIN SRCH RETURN  CVX07090
       PXA     ,4                                                       CVX07100
       PAC     ,4                                                       CVX07110
       SXD     XS042,4                                                  CVX07120
 XS043 TXI     *+1,4,**      XST/XST2                                   CVX07130
       TXI     *+1,4,-1                                                 CVX07140
       SXA     XSEG,4                                                   CVX07150
       LXA     XSY56,4       L+1 FOR WRITE MERGE TAG TABLE              CVX07160
 XS042 TIX     *+1,4,**                                                 CVX07170
       SXD     ERA13,4                                                  CVX07180
*                                                                       CVX07190
* DETERMINE PUT BLOCKS                                                  CVX07200
*                                                                       CVX07210
       CLA     BLKTAB        INITIALIZE WITH LOCATION OF FIRST          CVX07220
       STA     XSY59          CELL IN BLOCK TABLE.                      CVX07230
       STA     XS047                                                    CVX07240
       AXT     0,1           RESET COUNT OF MERGE BLOCKS TO ZERO.       CVX07250
       LXD     ERA13,4       INITIALIZE WITH NUMBER OF CELLS BINARY     CVX07260
       SXA     XSY15,4        POSITION FOR WRITING IS ABOVE BASE OF L.  CVX07270
 XSY63 PXA     ,4                                                       CVX07280
       SSM                                                              CVX07290
       ADM     XS044                                                    CVX07300
 XSY59 STA     **            TELL WHERE IN L PUT LIST BEGINS.           CVX07310
       AXT     0,2           SET WORDS/MERGE BLOCK COUNT TO ZERO.       CVX07320
 XS044 CLA     **,4          PICK UP NEXT COMMAND                       CVX07330
       STD     *+1            AND                                       CVX07340
 XS045 TXI     *+1,2,**       ADD IN RECORD LENGTH FROM IT.             CVX07350
 XSY16 TXH     XSY18,2,**    TRANSFER IF MERGE BLOCKING IS EXCEEDED.    CVX07360
 XSY17 TXH     XS046A,2,**   TRANSFER IF MERGE BLOCKING IS EQUALLED.    CVX07370
       TIX     XS044,4,1     GO DO NEXT COMMAND, IF ANY REMAIN.         CVX07380
       AXT     0,4           SIGNIFY BOTTOM OF L.                       CVX07390
 XSS14 TXH     XS046,2,**    TRANSFER IF MB IS LONG ENOUGH.             CVX07400
       TXH     XSDUN,1,0     TRANSFER IF OTHER BLOCKS ARE TO BE WRITTEN.CVX07410
       ZET     SEQBR         IF ENTIRE L TABLE IS TOO SHORT,            CVX07420
       TRA     XSGET          GO TO GET MORE RECORDS.                   CVX07430
       TRA     XSENDG        OTHERWISE, TRY FROM TOP OF TABLE.          CVX07440
 XSY18 CLA     XS045                                                    CVX07450
       STD     *+1           IF MERGE BLOCKING IS EXCEEDED,             CVX07460
       TIX     XS046,2,**     SUBTRACT LAST RECORD LENGTH.              CVX07470
XS046A TIX     *+1,4,1       KNOCK DOWN POINTER.                        CVX07480
 XS046 TXI     *+1,1,1       KEEP NUMBER OF MERGE BLOCKS                CVX07490
       SXD     ERA10,1        IN CELL FOR PUT.                          CVX07500
       PXA     ,2            UPDATE TOTAL NUMBER OF WORDS               CVX07510
       ADD     ERA17          TO BE WRITTEN DURING THE                  CVX07520
       STO     ERA17          NEXT PUT.                                 CVX07530
 XS047 SXD     **,2                                                     CVX07540
       SXD     ERA13,4       REPOSITION POINTER IN L FOR NEXT MB.       CVX07550
       TXL     XSDUN,4,0     TRANSFER IF AT BOTTOM OF L TABLE           CVX07560
XS047A TXH     XSDUN,1,**    TRANSFER IF TOTAL FOR PUT IS REACHED.      CVX07570
       CAL     XS047                                                    CVX07580
       ADD     ONE                                                      CVX07590
       STA     XS047                                                    CVX07600
       STA     XSY59                                                    CVX07610
       TRA     XSY63                                                    CVX07620
*                                                                       CVX07630
 XSDUN CLA     XSY59                                                    CVX07640
       ADD     ONE                                                      CVX07650
       STO     XSDN2                                                    CVX07660
       PXA     ,4                                                       CVX07670
       SSM                                                              CVX07680
       ADM     XS044                                                    CVX07690
 XSDN2 STO     **                                                       CVX07700
*                                                                       CVX07710
* CYCLE INPUT/OUTPUT AREAS                                              CVX07720
*                                                                       CVX07730
 XSOUT ENB     =0                                                       CVX07740
       CLA     ERA03                                                    CVX07750
       LDQ     ERA04                                                    CVX07760
       STQ     ERA03                                                    CVX07770
       STO     ERA04                                                    CVX07780
       LXD     ERA13,4                                                  CVX07790
       SXD     *+2,4                                                    CVX07800
 XSY15 AXT     **,2                                                     CVX07810
       TIX     *+1,2,**                                                 CVX07820
       SXA     ERA06,2       UPDATE M (RECORDS WRITTEN THIS PUT)        CVX07830
       SXD     XSY14,2        FOR CALCULATION OF NEXT L.                CVX07840
       TXI     *+1,4,1                                                  CVX07850
       XEC     XS044         SAVE ADDRESS OF LAST RECORD                CVX07860
       STA     ERA05          BEING WRITTEN DURING THIS PUT.            CVX07870
       ENB*    (TRAPX                                                   CVX07880
       TRA     TAPESW                                                   CVX07890
*                                                                       CVX07900
*        END OF TAPE ROUTINE                                            CVX07910
*                                                                       CVX07920
TAPEND SXA     WRTOUT,4                                                 CVX07930
       ZET     MOD32         C E  MOD.                                  CVX07940
       CALL    DXS08                                                    CVX07950
       LXA     MORT,4                                                   CVX07960
       TXI     *+1,4,-1                                                 CVX07970
       SXD     XSY62,4                                                  CVX07980
       LXA     PREVTP,2                                                 CVX07990
 XSY62 TXH     XSTOP,2,**    MORDER-1,  IS THIS FILE AT TOP OF TABLE    CVX08000
       CAL     FILE,2        GET FILE WITH ETT                          CVX08010
       LDQ     FILE-1,2      GET NEXT HIGHEST FILE AND                  CVX08020
       STQ     FILE,2        STORE IN PLACE OF ETT TAPE                 CVX08030
       TXI     *+1,2,1       PREPARE TO ROTATE OTHER                    CVX08040
 XSY61 TXL     *-3,2,**      MORDER-1 IN DECREMENT                      CVX08050
       SLW     FILE,2        PUT ETT FILE ABOVE NEW TABLE               CVX08060
 XSTOP LXA     MORT,4                                                   CVX08070
       TXL     XSMOZ,4,1     DOES NEW MORDER=0.                         CVX08080
       TIX     *+1,4,1                                                  CVX08090
       SXA     MORT,4        SAVE NEW MERGE ORDER.                      CVX08100
       CAL     MRT3                                                     CVX08110
       ERA     PREVTP        WERE WE WRITING ON THE TAPE HAVING EOT.    CVX08120
       TNZ     WRTOUT        NO.                                        CVX08130
       CAL     COUNT         YES.                                       CVX08140
       ADM     ONE                                                      CVX08150
       STO     COUNT                                                    CVX08160
       LXA     TAPESW,1                                                 CVX08170
       TXI     *+1,4,-1                                                 CVX08180
       SXD     *+1,4                                                    CVX08190
       TXH     LOORD,1,**                                               CVX08200
       TXI     *+1,1,1                                                  CVX08210
HYORD  SXA     TAPESW,1                                                 CVX08220
       SXA     MRT3,1                                                   CVX08230
       CLA     FILE,1                                                   CVX08240
       STD     RAW00                                                    CVX08250
       TRA     WRTOUT                                                   CVX08260
LOORD  AXT     1,1                                                      CVX08270
       TRA     HYORD                                                    CVX08280
WRTOUT AXT     **,4                                                     CVX08290
       TRA     -1,4                                                     CVX08300
 XSMOZ ZET     RAW03         EOF CELL. WAS THERE EOF BEFORE EOT         CVX08310
       TRA     WRTOUT        FORGET EOT,WE CAN MAKE IT.                 CVX08320
       TSX     MSGSUP,4,2                                               CVX08330
       PZE     3                                                        CVX08340
       PZE     MESG1,,5+512*4                                           CVX08350
       PZE     MESG2,,4                                                 CVX08360
       PZE     MESG3,,4+512*4                                           CVX08370
       TSX     (PAUSE,4                                                 CVX08380
       SWT     3                                                        CVX08390
       TRA     XSY19         DELETE THE SORT.                           CVX08400
       TSX     MSGSUP,4,2    PRINT-                                     CVX08410
       PZE     1              (IGNORED)                                 CVX08420
       PZE     MESG4,,2+512*4                                           CVX08430
       TRA     WRTOUT                                                   CVX08440
 XSY19 STL     ERA18         SET DELETE JOB SWITCH                      CVX08450
       XEC     XRC           RETURN POINTER                             CVX08460
       TRA     5,4           GO TO POST PROCESSOR                       CVX08470
MESG1  BCI     5,EOT ON ALL MERGE TAPES  *WR01                          CVX08480
MESG2  BCI     4,TO DELETE SORT---SS3 UP                                CVX08490
MESG3  BCI     4,TO IGNORE EOT----SS3 DN                                CVX08500
MESG4  BCI     2,(IGNORED)                                              CVX08510
*                                                                       CVX08520
TAPESW AXT     1,1                                                      CVX08530
       SXA     MRT3,1        UPDATE XS CURRENT MERGE TAPE               CVX08540
       CLA     FILE,1                                                   CVX08550
       PDX     ,1                                                       CVX08560
       SXD     RAW00,1                                                  CVX08570
*                                                                       CVX08580
 XSY12 CLA     ERA05         ADDRESS OF LAST RECORD WRITTEN             CVX08590
       ADD     OPT03         EQUALS OPTION                              CVX08600
       STA     XS050           ON INDEXED MERGE TAPE                    CVX08610
*                                                                       CVX08620
       ZET     MOD30         CE MOD                                     CVX08630
       CALL    DXS06                                                    CVX08640
       NZT     MOD03         USER MOD                                   CVX08650
       TRA     *+3                                                      CVX08660
       STL     GEN04                                                    CVX08670
       CALL    XSM04         CALL MODIFICATION PROGRAM                  CVX08680
*                                                                       CVX08690
*                                                                       CVX08700
       STL     GEN04                                                    CVX08710
       CALL    PUT                                                      CVX08720
       TSX     TAPEND,4      RETURN HERE IF EOT.                        CVX08730
       CAL     MRT3                                                     CVX08740
       STA     PREVTP                                                   CVX08750
*                                                                       CVX08760
*   SAVE LAST RECORD THIS TAPE FOR NEXT GO ROUND                        CVX08770
*                                                                       CVX08780
       LXA     ERA12,4                                                  CVX08790
 XS050 CLA     0,4                                                      CVX08800
       STO     0,4                                                      CVX08810
       TIX     *-2,4,1                                                  CVX08820
       STZ     SEQBR         REINITIALIZE SEQUENCE BREAK INDICATOR      CVX08830
       CLA     ERA07         HAS OUTPUT MERGE TAG TABLE BEEN            CVX08840
       SUB     ERA06          DEPLETED BY LAST WRITE                    CVX08850
       TNZ     XSGET         NO, GO TO NORMAL GET ROUTINE               CVX08860
       CLA     MDON          YES, REINITIALIZE G FOR REFILLING          CVX08870
       STP     XSY09                                                    CVX08880
       STP     XSFILD                                                   CVX08890
       STZ     FILLSW                                                   CVX08900
       STZ     ERA06         RESET LAST WRITE PARAMETER                 CVX08910
       TRA     XSGET1                                                   CVX08920
       TRA     MTY1           FOR USE IN EOF ROUTINE                    CVX08930
*                                                                       CVX08940
XSENDG BSS     0             COUNT NO. SEQUENCES THIS PHASE             CVX08950
       ZET     MOD31         CE MOD                                     CVX08960
       CALL    DXS07                                                    CVX08970
       STL     SEQBR                                                    CVX08980
       LXA     COUNT,4       UPDATE SEQUENCE LEVEL INDICATOR            CVX08990
       TXI     *+1,4,1                                                  CVX09000
       SXA     COUNT,4                                                  CVX09010
       SXD     RAW08,4       KEEP STRING COUNT FOR MERGE PHASE          CVX09020
       LXA     ERA12,4                                                  CVX09030
 XSY01 STZ     **,4          ZERO OUT CF AREA OF LAST RECORD            CVX09040
       TIX     *-1,4,1         WRITTEN ON INDEXED MERGE TAPE            CVX09050
*                                                                       CVX09060
*   NOW SWITCH MERGE TAPES                                              CVX09070
*                                                                       CVX09080
       LXA     TAPESW,1      CURRENT INDEXED MERGE TAPE                 CVX09090
       LXA     MORT,2        CURRENT MERGE ORDER                        CVX09100
       TXI     *+1,2,-1                                                 CVX09110
       SXD     *+1,2                                                    CVX09120
       TXH     XSY02,1,**    MORT-1                                     CVX09130
       TXI     *+1,1,1                                                  CVX09140
       SXA     TAPESW,1      NEXT HIGHEST TAPE NOW MERGE TAPE           CVX09150
       TRA     XSOUTP                                                   CVX09160
 XSY02 AXT     1,1           LOW ORDER TAPE AGAIN MERGE TAPE            CVX09170
       TRA     *-3                                                      CVX09180
*                                                                       CVX09190
*   END OF FILE ACTION AT END OF LAST REEL                              CVX09200
*                                                                       CVX09210
 MTY   ZAC                                                              CVX09220
       SXD     XS047A,0                                                 CVX09230
       STP     XSFILD                                                   CVX09240
       STD     ERA09         INDICATE NO MORE INCOMING RECORDS          CVX09250
       STD     XSY14+1        ZERO OUT GET PARAMETER IN L CALCULATION   CVX09260
       AXT     2,1                                                      CVX09270
       SXD     XSS14,1                                                  CVX09280
       TRA     XSY41                                                    CVX09290
 MTY1  NZT     ERA06                                                    CVX09300
       STZ     ERA07                                                    CVX09310
       LXA     ERA06,1                                                  CVX09320
       LXA     ERA07,2                                                  CVX09330
       SXD     *+1,2                                                    CVX09340
       TNX     WEOF,1,**                                                CVX09350
       ZET     MOD33         CE MOD                                     CVX09360
       CALL    DXS09                                                    CVX09370
       TRA     XSY41                                                    CVX09380
       SPACE   5                                                        CVX09390
*      TSX     SORT,4         SHELL M/4+1 MODIFIED METHOD               CVX09400
*                                                                       CVX09410
SORT   SXA     X1,1                                                     CVX09420
       SXA     X2,2                                                     CVX09430
       SXA     X4,4                                                     CVX09440
       CLA     ERA09         PICK UP LOCATION AND LENGTH OF SORT TABLE  CVX09450
       PDX     ,4                                                       CVX09460
       TXL     SORTEX,4,1    TRANSFER IF LESS THAN TWO TAGS IN SORT TAB CVX09470
       SXA     XSM1,4        SAVE M (LENGTH OF TABLE)                   CVX09480
       TXI     *+1,4,-1       AND                                       CVX09490
       SXA     XSN,4          M-1.                                      CVX09500
       PAX     ,4                                                       CVX09510
       SXD     TXIA2,4       SAVE LOCATION OF SORT TABLE.               CVX09520
       STA     KYUPR1                                                   CVX09530
       STA     KYUPR2                                                   CVX09540
       STA     KYUPR3                                                   CVX09550
       AXT     INITEP,2      SET TO REPEAT AFTER NEXT PASS.             CVX09560
       SXA     J(GT)K,2                                                 CVX09570
INITEP CLA     XSM1          CALCULATE NEW.M FROM THE FORMULA           CVX09580
       ARS     3              2(N/8)+1 WHERE N=M ON THE FIRST PASS      CVX09590
       ALS     1              AND N=LAST NEW.M ON OTHER PASSES.         CVX09600
       ADD     ONE                                                      CVX09610
       STA     XSM1          SAVE NEW.M                                 CVX09620
       PAX     ,4                                                       CVX09630
       TXH     *+3,4,1       TRANSFER IF NEW.M GT 1.                    CVX09640
       AXT     SORTEX,2      IF NEW.M = 1, SET TO EXIT AFTER NEXT PASS. CVX09650
       SXA     J(GT)K,2                                                 CVX09660
       SXD     XSM,4         SAVE NEW.M                                 CVX09670
TXIA2  TXI     *+1,4,**      ADD LOCATION OF TABLE + NEW.M              CVX09680
       SXA     KYLWR1,4      SAVE LOCATION OF THE (NEW.M)TH TAG,        CVX09690
       SXA     KYLWR2,4       THE FIRST ONE WHICH WILL BE COMPARED      CVX09700
       SXA     KYLWR3,4       WITH THE FIRST TAG IN THE TABLE.          CVX09710
       PAC     ,4                                                       CVX09720
       SXD     TXIMM,4       SAVE -(NEW.M)                              CVX09730
       SXD     TESTMM,4                                                 CVX09740
XSN    AXT     **,4          CALCULATE M-1-(NEW.M)                      CVX09750
TXIMM  TXI     *+1,4,**       AND                                       CVX09760
       SXD     J(GT)K,4       SAVE IT.                                  CVX09770
       AXT     0,2           SET TO START AT TOP OF TABLE.              CVX09780
SORLUP PXA     ,2                                                       CVX09790
       PAC     ,4                                                       CVX09800
SIFTYS LXA     CAL12,1       GET LENGTH OF EXTRACTED CONTROL FIELDS.    CVX09810
KYLWR1 CAL*    **,4          COMPARE (X+NEW.M)TH TAG                    CVX09820
KYUPR1 LAS*    **,4           WITH (X)TH TAG.                           CVX09830
XS061  TRA     NELSRT        (X+NEW.M)TH GT (X)TH, MAKING ORDER OK.     CVX09840
       TRA     XSEQ          (X+NEW.M)TH = (X)TH                        CVX09850
KYUPR2 LDQ     **,4          EXCHANGE TAGS WHICH WERE OUT OF ORDER.     CVX09860
KYLWR3 CAL     **,4                                                     CVX09870
KYLWR2 STQ     **,4                                                     CVX09880
KYUPR3 SLW     **,4                                                     CVX09890
       TXL     NELSRT,4,0    TRANSFER IF AT TOP OF TABLE (SIFTING DONE).CVX09900
TESTMM TXH     NELSRT,4,**   TRANSFER IF CLOSE TO TOP OF TABLE (DITTO). CVX09910
XSM    TXI     SIFTYS,4,**   GO SIFT.                                   CVX09920
XSEQ   TIX     KYLWR1,1,1    COMPARE NEXT CONTROL WORDS.                CVX09930
       TXI     *+1,1,-1      TRANSFER IS TO KYLWR1 IF EQUALS OPTION.    CVX09940
NELSRT TXI     *+1,2,1                                                  CVX09950
J(GT)K TXH     **,2,**       GO TO INITEP AFTER A PASS, SORTEX AFTER    CVX09960
       TRA     SORLUP         LAST PASS, AND SORLUP AFTER A SIFT.       CVX09970
XSM1                         CURRENT VALUE OF NEW.M                     CVX09980
SORTEX BSS     0                                                        CVX09990
X1     AXT     ,1                                                       CVX10000
X2     AXT     ,2                                                       CVX10010
X4     AXT     ,4                                                       CVX10020
       STL     GEN05                                                    CVX10030
       TRA     1,4                                                      CVX10040
*                                                                       CVX10050
*      CHECK WHAT PHASE TO GO NEXT                                      CVX10060
*                                                                       CVX10070
WEOF   LXA     COUNT,1       SAVE COUNT OF STRINGS FOR MERGE PHASE.     CVX10080
       STZ     RAW21         IS MERGE PHASE NEEDED.                     CVX10090
XSY60  TXH     SET,1,**      YES-(MERGE ORDER).                         CVX10100
       CLA     SAM01         NO-(MERGE ORDER).                          CVX10110
       SUB     COUNT         (NO. OF STRINGS PRODUCED BY INTERNAL SORT).CVX10120
       SUB     SAM02         (NO. OF EXTERNAL FILES TO BE MERGED).      CVX10130
       TPL     *+2           IS MERGE PHASE NEEDED.                     CVX10140
       TRA     SET           YES.                                       CVX10150
       LAC     CHA01,4       NO -(ADDR. OF OUTPUT CHANNEL).             CVX10160
       SXD     *+2,4                                                    CVX10170
       LXA     CHA02,4       (ADDR. OF INPUT CHANNEL FOR MERGE PHASE).  CVX10180
       TXI     *+1,4,**      IS ADDITIONAL PASS NEEDED.                 CVX10190
       TXL     SET,4,0       YES.                                       CVX10200
       ZET     RAW20         IS IT HYPER.                               CVX10210
       STL     FLIP          YES.                                       CVX10220
       TRA     CLOZOU        NO.                                        CVX10230
SET    STL     PHASE2        SET SWITCH TO GO TO PHASE2.                CVX10240
       ZET     RAW20         ARE ALL MERGE CHANNELS HYPER.              CVX10250
       STL     RAW21         YES-DO NOT REWIND OUTPUT FROM XS.          CVX10260
*                                                                       CVX10270
*      CLOSE INTERNAL SORT OUTPUT FILES                                 CVX10280
*                                                                       CVX10290
CLOZOU CAL     *             STORE MINUS IN SIGN POSITION OF            CVX10300
       STP     RAW00          CALLING SEQUENCE WORD                     CVX10310
       LXA     SAM01,1       STORE FILE NUMBER IN DECREMENT OF          CVX10320
       SXD     RAW00,1        CALLING SEQUENCE WORD                     CVX10330
       PXD     ,1                                                       CVX10340
       STD*    ERA20                                                    CVX10350
       CALL    SCL                                                      CVX10360
       TIX     *-4,1,1       REPEAT FOR ALL FILES.                      CVX10370
*                                                                       CVX10380
*  WRITE CHECKPOINT OF INTERNAL SORT PHASE                              CVX10390
*                                                                       CVX10400
       ZET     OPT02         CHECKPOINT OPTION                          CVX10410
       TRA     XSDONE        NO,CALL IN NEXT PHASE                      CVX10420
       STL     GEN04                                                    CVX10430
       CALL    CKPT                                                     CVX10440
*                                                                       CVX10450
*    PREPARE TO CALL NEXT PHASE                                         CVX10460
*                                                                       CVX10470
XSDONE LDQ     CNTPR                                                    CVX10480
       CALL    BTD                                                      CVX10490
       STO     MESCT                                                    CVX10500
       STQ     MESCT+1                                                  CVX10510
       TSX     MSGSUP,4,4                                               CVX10520
       PZE     2                                                        CVX10530
       MZE     MESG,,5                                                  CVX10540
       PZE     MESCT,,5+512*4                                           CVX10550
       CLA     CHA02         SWITCH INPUT AND OUTPUT                    CVX10560
       LDQ     CHA03          CHANNELS FOR NEXT PHASE                   CVX10570
       STQ     CHA02                                                    CVX10580
       STO     CHA03                                                    CVX10590
       ZET     MOD34         CE MOD                                     CVX10600
       CALL    DXS10                                                    CVX10610
       ZET     PHASE2        IS MERGE PHASE NEEDED.                     CVX10620
       TRA     XRC           YES.                                       CVX10630
       XEC     XRC           NO.                                        CVX10640
       TRA     3,4           EXIT TO FINAL MERGE PHASE.                 CVX10650
XRC    AXT     **,4                                                     CVX10660
       TRA     4,4           EXIT TO MERGE PHASE.                       CVX10670
MESG   BCI     5,INTERNAL SORT PHASE COMPLETED.                         CVX10680
MESCT  BCI     5,             RECORDS SORTED.                           CVX10690
*                                                                       CVX10700
*PARAMETERS CALCULATED BY AND USED DURING INTERNAL SORT PHASE           CVX10710
*                                                                       CVX10720
 XST   PZE     0              STARTING ADDR FIRST MERGE (L) TAG TABLE   CVX10730
 XSTL  PZE     0              BASE ADDR OF FIRST MERGE (L) TAG TABLE    CVX10740
 XST2  PZE     0              STARTING ADDR SECOND MERGE (L) TAG TABLE  CVX10750
 XST2L PZE     0              BASE ADDR OF SECOND MERGE (L) TAG TABLE   CVX10760
 XSG   PZE     0             FIRST LOCATION IN G,HAS BIN OF FIRST RECORDCVX10770
 XSY50 PZE     0             L+1 FOR FROM.TABLE                         CVX10780
 XSY52 PZE     0             M+1                                        CVX10790
 XSY56 PZE     0             L+1 FOR TO.TABLE                           CVX10800
 MORT  PZE     0             CURRENT MERGE ORDER                        CVX10810
 MORT1 PZE     0             CURRENT MERGE ORDER MINUS 1                CVX10820
 XSBSZ PZE     0             LIMITING POWER FOR BINARY SEARCH           CVX10830
*                                                                       CVX10840
XSCYCL PZE     0              BASE ADDRESS OF SORT TABLE                CVX10850
       PZE     0,0,16                                                   CVX10860
       PZE     0,0,15                                                   CVX10870
       PZE     0,0,14                                                   CVX10880
       PZE     0,0,13                                                   CVX10890
       PZE     0,0,12                                                   CVX10900
       PZE     0,0,11                                                   CVX10910
       PZE     0,0,10                                                   CVX10920
       PZE     0,0,9                                                    CVX10930
       PZE     0,0,8                                                    CVX10940
       PZE     0,0,7                                                    CVX10950
       PZE     0,0,6                                                    CVX10960
       PZE     0,0,5                                                    CVX10970
       PZE     0,0,4                                                    CVX10980
       PZE     0,0,3                                                    CVX10990
       PZE     0,0,2                                                    CVX11000
       PZE     0,0,1                                                    CVX11010
 FILE  BES     0                                                        CVX11020
 XSP1  PZE     0                                                        CVX11030
 XSP2  PZE     **,1                                                     CVX11040
 XSP3  PZE     0                                                        CVX11050
 ONE   PZE     1                                                        CVX11060
 TWO   PZE     2                                                        CVX11070
 THREE PZE     3                                                        CVX11080
 FOUR  PZE     4                                                        CVX11090
 XSLXR PZE                                                              CVX11100
 XSTXR PZE     0                                                        CVX11110
FILLSW PZE     0                                                        CVX11120
 SEQBR PZE     0                                                        CVX11130
 MRT3  PZE     0                                                        CVX11140
PREVTP PZE     0                                                        CVX11150
PHASE2 PZE                                                              CVX11160
BLKTAB PZE     0                                                        CVX11170
 END   PZE     0                                                        CVX11180
 OPTPR COMMON  15            OPTION CARD PARAMETERS                     CVX11190
 OVEPR COMMON  2             OVERFLOW CARD PARAMETERS                   CVX11200
 LABPR COMMON  5             LABEL CARD PARAMETERS                      CVX11210
 CHAPR COMMON  6             CHANNEL CARD PARAMETERS                    CVX11220
 FILPR COMMON  14            FILE CARD PARAMETERS                       CVX11230
 MODPR COMMON  50            MODIFICATION CARD PARAMETERS               CVX11240
 RECPR COMMON  10            RECORD CARD PARAMETERS                     CVX11250
 DELPR COMMON  2             DELETE CARD PARAMETERS                     CVX11260
 SAMPR COMMON  7             SORT AND MERGE CARD PARAMETERS             CVX11270
 CALPR COMMON  50            CALCULATED PARAMETERS                      CVX11280
 GENPR COMMON  10            GENERAL PARAMETERS                         CVX11290
 RAWPR COMMON  30            READ AND WRITE PARAMETERS                  CVX11300
 CNTPR COMMON  20            COUNT PARAMETERS                           CVX11310
 ERAPR COMMON  30            ERASABLE STORAGE PARAMETERS                CVX11320
 REFPR COMMON  1             REFERENCED PARAMETERS                      CVX11330
 OPT02 EQU     OPTPR-2       CHECKPOINT OPTION                          CVX11340
 OPT03 EQU     OPTPR-3       EQUALS OPTION                              CVX11350
OPT08  EQU     OPTPR-8       HISTORY OPTION.                            CVX11360
 LAB04 EQU     LABPR-4       LOCATION OF LABEL                          CVX11370
 CHA01 EQU     CHAPR-1       UCW OF OUTPUT UNIT                         CVX11380
 CHA02 EQU     CHAPR-2       UCW TABLE, OUTPUT FROM INTERNAL SORT PHASE CVX11390
 CHA03 EQU     CHAPR-3       UCW TABLE, OTHER MERGE CHANNEL             CVX11400
 CHA05 EQU     CHAPR-5       CHECKPOINT ATTACHMENT                      CVX11410
 MOD02 EQU     MODPR-2                                                  CVX11420
 MOD03 EQU     MODPR-3                                                  CVX11430
 MOD05 EQU     MODPR-5                                                  CVX11440
 MOD09 EQU     MODPR-9                                                  CVX11450
 MOD25 EQU     MODPR-25                                                 CVX11460
 MOD26 EQU     MODPR-26                                                 CVX11470
 MOD27 EQU     MODPR-27                                                 CVX11480
 MOD28 EQU     MODPR-28                                                 CVX11490
 MOD29 EQU     MODPR-29                                                 CVX11500
 MOD30 EQU     MODPR-30                                                 CVX11510
 MOD31 EQU     MODPR-31                                                 CVX11520
 MOD32 EQU     MODPR-32                                                 CVX11530
 MOD33 EQU     MODPR-33                                                 CVX11540
 MOD34 EQU     MODPR-34                                                 CVX11550
 SAM01 EQU     SAMPR-1       MERGE ORDER                                CVX11560
 SAM02 EQU     SAMPR-2       NUMBER OF EXTERNAL FILES TO BE MERGED      CVX11570
 CAL03 EQU     CALPR-3       BIN LENGTH                                 CVX11580
 CAL05 EQU     CALPR-5       TOTAL NUMBER OF BINS                       CVX11590
 CAL06 EQU     CALPR-6       MAXIMUM LENGTH OF SORT TABLE               CVX11600
 CAL07 EQU     CALPR-7       RATIO                                      CVX11610
 CAL12 EQU     CALPR-12      TOTAL WORDS ALL CFS EXCEPT EQUALS          CVX11620
 CAL13 EQU     CALPR-13      NUMBER OF WORDS PER MERGE BLOCK            CVX11630
 CAL31 EQU     CALPR-31      LENGTH OF BUFFER                           CVX11640
 CAL33 EQU     CALPR-33      MAXIMUM NUMBER OF MERGE BLOCKS PER PUT     CVX11650
 CAL34 EQU     CALPR-34      MINIMUM NUMBER OF WORDS PER PUT            CVX11660
 CAL35 EQU     CALPR-35      LENGTH OF BUFFER TABLE                     CVX11670
 CAL36 EQU     CALPR-36      LENGTH OF LOCATE TABLE                     CVX11680
GEN03  EQU     GENPR-3                                                  CVX11690
 GEN04 EQU     GENPR-4                                                  CVX11700
 GEN05 EQU     GENPR-5                                                  CVX11710
 RAW00 EQU     RAWPR         CALLING SEQUENCE WORD                      CVX11720
 RAW01 EQU     RAWPR-1       CALLING SEQUENCE WORD                      CVX11730
 RAW03 EQU     RAWPR-3       END OF FILE INDICATOR                      CVX11740
 RAW04 EQU     RAWPR-4       READ COMPLETION SWITCH                     CVX11750
 RAW08 EQU     RAWPR-8       SEQUENCE LEVEL INDICATOR                   CVX11760
 RAW20 EQU     RAWPR-20                                                 CVX11770
RAW21  EQU     RAWPR-21      Z=REWIND,NZ=DO NOT REWIND.                 CVX11780
 FLIP  EQU     RAWPR-23      HYPER AND STRAIGHT FROM PHASE 1 IN DICATIONCVX11790
 COUNT EQU     CNTPR-15      STRING COUNT                               CVX11800
 ERA00 EQU     ERAPR         LOCATION AND LENGTH OF BUFFER              CVX11810
 ERA01 EQU     ERAPR-1       LOCATION AND LENGTH OF BUFFER TABLE        CVX11820
 ERA02 EQU     ERAPR-2       LOCATION AND LENGTH OF LOCATE TABLE        CVX11830
 ERA03 EQU     ERAPR-3       LOCATION AND LENGTH OF CURRENT AVAILIBILITYCVX11840
 ERA04 EQU     ERAPR-4       LOCATION AND LENGTH OF OTHER AVAILIBILITY  CVX11850
 ERA05 EQU     ERAPR-5       ADDRESS OF LAST RECORD WRITTEN             CVX11860
 ERA06 EQU     ERAPR-6       M FOR LAST WRITE                           CVX11870
 ERA07 EQU     ERAPR-7       COUNT FOR FIRST L TABLE                    CVX11880
 ERA08 EQU     ERAPR-8                                                  CVX11890
 ERA09 EQU     ERAPR-9       LOCATION AND LENGTH OF SORT TABLE          CVX11900
 ERA10 EQU     ERAPR-10      LOCATION AND LENGTH OF BLOCK TABLE         CVX11910
 ERA12 EQU     ERAPR-12      LENGTH OF ALL CF INCLUDING EQUALS          CVX11920
 ERA13 EQU     ERAPR-13                                                 CVX11930
 ERA17 EQU     ERAPR-17                                                 CVX11940
 ERA18 EQU     ERAPR-18      DELETE JOB SWITCH                          CVX11950
 ERA19 EQU     ERAPR-19      INTERRUPT SWITCH                           CVX11960
 ERA20 EQU     ERAPR-20      FILE NUMBER                                CVX11970
       DETAIL                                                           CVX11980
       EXTERN  MSGSUP                                                   CVX11990
       END                                                              CVX12000
* 7090/94 SORT VER 7 MOD 5 BUFFER/READ, SCATTER/BUFFER WRITE(729)    (5)DBS00000
*      FAP
       COUNT   1200                                                     DBS00010
       SPACE                                                            DBS00020
       ENTRY   MRGIO                                                    DBS00030
       ENTRY   IOBB                                                     DBS00040
       SST                                                              DBS00050
       SPACE                                                            DBS00060
*  CONTROL ROUTINE FOR BUFFER-READ, SCATTER WRITE.                      DBS00070
       TITLE                                                            DBS00080
MRGIO  BSS     0                                                        DBS00090
       SXA     BCLEV,1       SAVE                                       DBS00100
       SXA     BCLEV+1,2      REGISTERS.                                DBS00110
       SXA     BCLEV+2,4                                                DBS00120
       LDQ     RWCS1         1ST CALLING SEQUENCE WORD.                 DBS00130
       TQP     BREAD         TRANSFER IF READ.                          DBS00140
       AXT     WRCS2,2       TELL WRITE ROUTINE (THRU COMMON).          DBS00150
       SXA     LCSTW,2        WHERE CALLING SEQ. TABLE IS.              DBS00160
       LXD     RWCS1,2       GET FILE NO.                               DBS00170
       TXL     *+3,2,0       IF FINAL OUTPUT.                           DBS00180
       STZ     XOUTS         RESET FINAL OUTPUT SWITCH.                 DBS00190
       TXI     *+2,2,-1                                                 DBS00200
       STL     XOUTS         SET FINAL OUTPUT SWITCH.                   DBS00210
       CAL*    SPR16         GET L(UCB) FOR OUTPUT.                     DBS00220
       STA     LUCBC         SAVE.                                      DBS00230
       CAL*    SPR20         SET MODE FROM FDB.                         DBS00240
       ZET     XOUTS         SKIP IF NOT FIANL OUTPUT.                  DBS00250
       CAL*    SPR29         FINAL OUTPUT.  GET ITS MODE.               DBS00260
       SLW     WRTMD         PUT MODE IN COMMON CELL FOR WRITE.         DBS00270
       LDQ     LWRSL         L(SEL) TO DECREMENT OF MQ.                 DBS00280
       AXC     BC020,4                                                  DBS00290
LDUCW  BSS     0                                                        DBS00300
 LUCBC CAL     **            GET UCW1.                                  DBS00310
       ARS     9             ISOLATE CHAN. NO.                          DBS00320
       ANA     17DEC                                                    DBS00330
       PDC     ,1            -CHAN. NO. TO IR 1.                        DBS00340
       TXI     *+1,1,1       ADJUST TO MAKE 0 FOR CHANNEL A, -1 FOR B...DBS00350
       ZET*    (CHXAC        WAIT FOR COMPLETION OF CHANNEL ACTIVITY.   DBS00360
17DEC  TXI     *-1,0,15                                                 DBS00370
       ENB     K0            DISABLE TRAPS.                             DBS00380
       LAC     LUCBC,2                                                  DBS00390
       STQ     1,2                                                      DBS00400
       LDQ     RWCS2                                                    DBS00410
 BC020 TRA     1,4                                                      DBS00420
       STQ     WRCS2,1       SAVE CALLING SEQUENCE FOR WRITE.           DBS00430
 BCACT TSX     (ACTIV,4      ACTIVATE THE UNIT.                         DBS00440
       PZE     LUCBC                                                    DBS00450
 BCLEV AXT     ,1            LEAVE I/O CONTROL.                         DBS00460
       AXT     ,2                                                       DBS00470
       AXT     ,4                                                       DBS00480
       TRA     1,4           EXIT.                                      DBS00490
*  BUFFER WRITE REQUEST ENTRY.                                          DBS00500
IOBB   STL     BUFWR         SET BUFFER WRITE SWITCH.                   DBS00510
       TRA     MRGIO                                                    DBS00520
*                                                                       DBS00530
WAIT   ZET     SWCHR         CHECK FOR END OF REEL.                     DBS00540
       TSX     SWCHR,4       TAKE CARE OF END OF REEL.                  DBS00550
       NZT     RDCSW         WAIT FOR READ COMPLETION AFTER PRIORITY    DBS00560
       TRA     WAIT          REQUEST ON ENTRY TO I/O.                   DBS00570
       TRA     TESTP-1        READ COMPLETE. TEST PRIORITY SWITCH.   (5)DBS00580
 RECOV AXT     **,1         EXIT TO MAIN PROGRAM                        DBS00590
       AXT     **,2         AFTER A                                     DBS00600
       AXT     **,4         BAD                                         DBS00610
       TRA     1,4          READ RECOVER                                DBS00620
       SPACE                                                            DBS00630
*  ENTER HERE IF BUFFER READ IS REQUESTED.                              DBS00640
       SPACE                                                            DBS00650
 BREAD BSS     0                                                        DBS00660
       TRA     *+1            GATE. INITIALIZE ONCE.                    DBS00670
       AXT     RDCS2,2       PUT LOCATION OF CALLING SEQUENCE           DBS00680
       SXA     LCSTR,2        TABLE IN COMMON FOR READ ROUTINE.         DBS00690
       CLA     BCLEV         SET TAG FOR INDIRECT REFERENCES            DBS00700
       STT     LCSTR          BY CHANNEL TO CALLING SEQUENCE            DBS00710
       STT     LCSTW          TABLES.                                   DBS00720
       STL     BREAD         SET BYPASS.                                DBS00730
 RED1  LDC     RWCS1,4       -LOGICAL FILE NO.                          DBS00740
       NZT     EOFIN,4       IS EOF TO BE SET FOR THIS FILE NOW.        DBS00750
       TRA     BRED1         NO.                                        DBS00760
       STZ     EOFIN,4       YES.  CLEAR THE SWITCH INDICATING THIS.    DBS00770
       CLS     K1            SET END OF FILE INDICATION                 DBS00780
       STO     EOFI           AND EXIT WITHOUT                          DBS00790
       TRA     BCLEV          READING.                                  DBS00800
 BRED1 LXD     RWCS1,2        LOGICAL FILE NO.                          DBS00810
       SXA     LGLFN,2       SAVE.                                      DBS00820
       TXI     *+1,2,-1                                                 DBS00830
       CAL     PHASE                                                    DBS00840
       SUB     K2                                                       DBS00850
       TZE     PHSE2         TRANSFER IF PHASE 2.                       DBS00860
       CLA*    SPR15         PHASE 3.  IF TABLE ENTRY NEG., EXTERNAL INPDBS00870
       STZ     XINSW         SET SWITCH FOR INTERNAL INPUT.             DBS00880
       TPL     SVUCW         IF INTERNAL INPUT.                         DBS00890
       PDX     ,4            EXTERNAL INPUT.  SAVE L(FDB) FOR SELECT    DBS00900
       SXA     LFDBR,4        ROUTINES.                                 DBS00910
       PDC     ,4            GET MODE FOR THIS FILE.                    DBS00920
       LDQ     0,4                                                      DBS00930
       STL     XINSW         SET SWITCH INDICATIONG EXTERNAL INPUT.     DBS00940
       TRA     SVUCW                                                    DBS00950
 PHSE2 STZ     XINSW         SET SWITCH FOR INTERNAL INPUT.             DBS00960
       CLA*    SPR15         FIND L(UCB).                               DBS00970
 SVUCW STA     LUCBC         SAVE L(UCB).                               DBS00980
       STQ     REDMD         SAVE MODE THIS INPUT FILE.                 DBS00990
       LAC     LFDBR,4       -L(FILE DATA BLOCK)                        DBS01000
       LDQ     -20,4         GROUPING FACTOR FOR THIS FILE (EXTERNAL).  DBS01010
       STQ     CRGPF         SAVE GROUPING FACTOR (NO. BLOCKS PER READ) DBS01020
       LDQ     RDSEL         L(SEL) TO DECR. OF MQ.                     DBS01030
       TSX     LDUCW,4       GO TO INITIALIZE UCW2.                     DBS01040
       STQ     RDCS2,1       SAVE CALLING SEQUENCE FOR READ.            DBS01050
       TRA     BCACT         GO TO ACTIVATE AND EXIT.                   DBS01060
       SPACE                                                            DBS01070
*  END OF BUFFER READ, SCATTER WRITE CONTROL ROUTINE.                   DBS01080
*  BUFFER READ SELECT ROUTINES.                                         DBS01090
*   ENTERED FROM                                                        DBS01100
*   ACTIV TO INITIATE AN I/O OPERATION, OR FROM                         DBS01110
*   IOEX AT TRAP TIME.                                                  DBS01120
       SPACE                                                            DBS01130
 SELCT SXA     BRP37,1       SAVE.                                      DBS01140
       SXA     BRP37+1,2                                                DBS01150
       SXA     BRP37+2,4                                                DBS01160
       STA     UCWAD                                                    DBS01170
       PAC     ,2                                                       DBS01180
       TMI     BSELM                                                    DBS01190
*  ENTRY TO SELECT (+).                                                 DBS01200
       SPACE   2                                                        DBS01210
       CLA     3,2                                                      DBS01220
       STA     BFRDS          INITIALIZE SELECT ADDRESS.                DBS01230
       NZT     SELPR         IS THIS TAPE CHECK ENTRY.                  DBS01240
       ZET     LONG          IS THIS LONG BLOCK REREAD REQUEST.         DBS01250
       TRA     BRP20         YES.  OVERLAY READ.                        DBS01260
       NZT     ACCPT          WAS LAST READ ACCEPTED.                   DBS01270
       TRA     BRP20         NO.  READ, OVERLAYING LAST.                DBS01280
       NZT     RDCSW          WAS LAST READ COMPLETED.                  DBS01290
       TRA     BRP41          NO.  UPDATE FOR NEXT BLOCK.               DBS01300
       SPACE                                                            DBS01310
*  ENTER HERE WHEN LAST READ COMPLETED AND ACCEPTED.  IF FILE IS        DBS01320
*   EXTERNAL INPUT, WE MUST SET UP FOR SEVERAL READS FOR THIS REQUEST.  DBS01330
       SPACE                                                            DBS01340
       CAL*    LCSTR          GET ADDRESS OF BUFFER AREA FOR NEW        DBS01350
       NZT     XINSW           BLOCK.  TEST FOR EXTERNAL INPUT.         DBS01360
       SUB     K2             INTERNAL INPUT.  ADJUST BUFFER ADDRESS.   DBS01370
       STA     RIORT          INITIALIZE ADDRESS OF IORT.               DBS01380
       LXA     CRGPF,4       PUT CURRENT READ GROUPING FACTOR           DBS01390
       SXD     SMTFF,4        INTO TEST IN SELECT MINUS.                DBS01400
 BRP20 CAL     MMRBL         GET MAXIMUM MERGE BLOCK LENGTH.            DBS01410
       ADD     K3            ADJUST FOR WORD COUNT OF IORT FOR INTERNAL DBS01420
*                             INPUT.                                    DBS01430
       NZT     XINSW          IS THIS EXTERNAL INPUT.                   DBS01440
       TRA     BRP21          NO.  KEEP MERGE BLOCK SIZE FOR COUNT.     DBS01450
       LAC     LFDBR,4        YES.  COMPUTE WORD COUNT.                 DBS01460
       CAL     -5,4          BLOCKSIZE FROM FILE DATA BLOCK,            DBS01470
       ADD     K1              AUGMENT BY 1 FOR LENGTH CHECK.           DBS01480
 BRP21 PAX     IORTN,4                                                  DBS01490
 BRP25 SXD     RIORT,4       INITIALIZE IORT DECREMENT WITH WORD COUNT. DBS01500
 BRP33 CLA     BRP25          INITIALIZE ADDRESS OF RESET + LOAD        DBS01510
       STA*    RCHXI           CHANNEL WITH LOCATION OF COMMAND.        DBS01520
 BFRDS RDS     **             SELECT UNIT.                              DBS01530
       XEC*    RCHXI           RESET AND LOAD CHANNEL.                  DBS01540
       STZ     ACCPT          RESET ACCEPTANCE SWITCH,                  DBS01550
       STZ     RDCSW           SET READ IN PROGRESS,                    DBS01560
       STL     SELPR          SET SELECT PLUS SWITCH,                   DBS01570
 BRP37 AXT     ,1             AND EXIT.                                 DBS01580
       AXT     ,2                                                       DBS01590
BRP39  AXT     **,4                                                     DBS01600
       ZET     REXSW         IF WE HAVE SERVICED AN END OF REEL,        DBS01610
       TRA     REXIT         EXIT THRU THAT ROUTINE.                    DBS01620
       TRA     1,4                                                      DBS01630
       SPACE                                                            DBS01640
*  LAST READ DID NOT COMPLETE A GROUP.  UPDATE FOR                      DBS01650
*   NEXT BLOCK.  IORT ADDRESS MUST BE INCREASED                         DBS01660
*   BY BLOCK LENGTH, AND DECREASED BY 1 IF THERE                        DBS01670
*   IS A BLOCK SEQUENCE AND CHECKSUM WORD.                              DBS01680
       SPACE                                                            DBS01690
 BRP41 LXA     HWLNG,4                                                  DBS01700
       PXA     ,4            WORD COUNT TO ADDRESS,                     DBS01710
       ADM     RIORT           ADD TO ADDRESS OF IORT,                  DBS01720
       LAC     LFDBR,4        SUBTRACT 1 IF SEQUENCE WORD               DBS01730
       ZET     -19,4          EXPECTED.                                 DBS01740
       SUB     K1                                                       DBS01750
       STA     RIORT          UPDATE ADDRESS OF IORT.                   DBS01760
       TRA     BRP33         GO TO SELECT AND EXIT.                     DBS01770
       SPACE                                                            DBS01780
*  END OF BUFFER READ SELECT PLUS ROUTINE.                              DBS01790
       EJECT                                                            DBS01800
*  SELECT MINUS ROUTINE FOR BUFFER READ.                                DBS01810
       SPACE                                                            DBS01820
BSELM  LNT     400000        NOISE                                   (4)DBS01830
       TRA     2,4           YES                                     (4)DBS01840
       LFT     300000        NO, EOF OR REDUNDANCY                   (4)DBS01850
       TRA     BDIFF         YES                                     (4)DBS01860
       SPACE                                                            DBS01870
*  COME HERE IF WE HAVE TRAPPED ON BUFFER READ OF EXTERNAL INPUT FILE.  DBS01880
*   FIRST ASK IF STORE CHANNEL RESULTS AGREE WITH EXPECTED BLOCK LENGTH.DBS01890
       SPACE                                                            DBS01900
 BMXIN CAL     (COMMM                                                   DBS01910
       ORA     BSELM         MAKE LARGER THAN RIORT.                    DBS01920
       SBM     RIORT         OBTAIN NO. OF WORDS READ.                  DBS01930
       STA     HWLNG                                                    DBS01940
       ANA     =O77777                                                  DBS01950
       NZT     XINSW         IS THIS EXTERNAL INPUT.                    DBS01960
       TRA     CKINTL        NO.  CHECK INTERNAL INPUT.                 DBS01970
       LAC     LFDBR,4       -L(FILE DATA BLOCK).                       DBS01980
TESTV  ZET     REC05         IS VARIABLE - RECORD SWITCH SET.           DBS01990
       TRA     CHKVL         YES.  CHECK VARIABLE RECORD BLOCK.         DBS02000
       CAS     -22,4         COMPARE WITH LENGTH IN FILE BLOCK.         DBS02010
       TRA     BLONG         BLOCK APPEARS LONG.                        DBS02020
       TRA     CLNTH         LENGTH O.K.                                DBS02030
       SBM     -22,4         BLOCK APPEARS SHORT.  FIND HOW             DBS02040
       LAS     K1             MUCH.  COMPARE WITH 1.                    DBS02050
       TRA     CKVBL         MORE THAN 1 WORD SHORT.                    DBS02060
 OFSZC AXT     **,4          1 WORD SHORT.  HAVE WE ALREADY RE-READ     DBS02070
       TXI     *+1,4,1        THIS BLOCK FOR SIZE ENOUGH TIMES.         DBS02080
       SXA     OFSZC,4                                                  DBS02090
       TXH     CKVBL,4,LIMIT                                            DBS02100
       TSX     (NDATA,4                                                 DBS02110
       PZE     UCWAD,,BSR                                               DBS02120
       TRA     NSOAP         GO FOR RE-READ OF SHORT BLOCK.             DBS02130
 CKVBL NZT     VBLOP         IS VARIABLE BLOCK OPTION SPECIFIED.        DBS02140
       TRA     SBDMP         NO.  DUMP THE BLOCK.                       DBS02150
       CLA     HWLNG         PUT BLOCK LENGTH LESS SEQUENCE WORD,       DBS02160
       ZET     -19,4          IF ONE, IN MQ.                            DBS02170
       SUB     K1                                                       DBS02180
       XCA                                                              DBS02190
       PXD     ,0                                                       DBS02200
       DVP     RCLP3         ASK IF BLOCK CONTAINS AN INTEGRAL          DBS02210
       STQ     HOLDQ                                                    DBS02220
       TNZ     SBDMP          NO. OF RECORDS.  TRANSFER IF NOT.         DBS02230
       ZET     -19,4         IS THERE A BLOCK SEQUENCE WORD.            DBS02240
       TSX     CKSQW,4       YES.  CHECK IT.                            DBS02250
       TRA     CLNTH                                                    DBS02260
 SBDMP LXA     HWLNG,4       DUMP THE SHORT BLOCK.                      DBS02270
       CLA     RIORT                                                    DBS02280
       STA     DMPCS                                                    DBS02290
       SXD     DMPCS,4       LENGTH TO CALLING SEQ. DECREMENT.          DBS02300
       CLA     HWLNG                                                    DBS02310
       TSX     (DECVA,4                                                 DBS02320
       STQ     TMS01+5                                                  DBS02330
       LAC     UCWAD,2                                                  DBS02340
       CLA     2,2                                                      DBS02350
       TSX     (DECVD,4      FILE NO. FOR MESSAGE.                      DBS02360
       STQ     TMS01+1                                                  DBS02370
       CLA     2,2                                                      DBS02380
       TSX     (DECVA,4                                                 DBS02390
       STQ     TMS01+3       REC. NO.                                   DBS02400
       LDQ     0,2                                                      DBS02410
       TSX     MSGSUP,4,3                                               DBS02420
       PZE     TMS01,,8+512*4                                           DBS02430
       SXA     OFSZC,0       RESET COUNT OF OFFSIZE READS OF THIS BLOCK.DBS02440
       STZ     LONG          RESET LONG BLOCK INDICATOR.                DBS02450
       TSX     SETTT,4                                                  DBS02480
       TRA     NSOAP                                                    DBS02490
       CALL    DEBLK                                                    DBS02500
       PZE     DMPCS,,1                                                 DBS02510
       NZT     XINSW                                                    DBS02520
       TRA     UPINF                                                    DBS02530
DMPCS  TIX     **,,**                                                   DBS02540
       TSX     UNSET,4                                                  DBS02550
       PZE     NSOAP                                                    DBS02560
       TRA     RECOV                                                    DBS02570
CHKVL  BSS     0                                                        DBS02580
CV05   CAS     -22,4         COMPARE LENGTH AGAINST THAT SPECIFIED      DBS02590
       TRA     BLONG          IN FILE DATA BLOCK.                       DBS02600
       TRA     *+1           BLOCK LENGTH O.K.                          DBS02610
       ZET     -19,4         IS THERE A BLOCK SEQUENCE WORD.            DBS02620
       TSX     CKSQW,4       YES,CHECK IT.                              DBS02630
       CAL     HWLNG         GET NO. OF DATA WORDS                      DBS02640
       LAC     LFDBR,4        IN BLOCK AND GIVE TO                      DBS02650
       ZET     -19,4          MERGE ROUTN.                              DBS02660
       SBM     K1                                                       DBS02670
       LAC     RIORT,4                                                  DBS02680
       SSM                                                              DBS02690
       STO     -1,4                                                     DBS02700
       TRA     CMPLT                                                    DBS02710
TMS01  BCI     8, FILE XXXXXX, REC XXXXXX OFSZ XXXXXX WRDS *RD04        DBS02720
 NOPRI PZE                                                              DBS02730
*  ENTER HERE IF LONG BLOCK ENCOUNTERED ON EXTERNAL MERGE INPUT.        DBS02740
       SPACE   1                                                        DBS02750
 BLONG BSS     0                                                        DBS02760
       LXA     OFSZC,4       GET OFFSIZE OCCURRENCES COUNT.            1DBS02770
       TXI     *+1,4,1       ADD 1.                                    1DBS02780
       SXA     OFSZC,4                                                 1DBS02790
       STL     LONG          SET LONG BLOCK INDICATOR.                 1DBS02800
       TXH     SBDMP,4,LIMIT TRANSFER IF TOO MANY SUCCESSIVE TIMES.    1DBS02810
       TSX     (NDSLX,4      BACKSPACE FOR RE-READ.                    1DBS02820
       PZE     UCWAD,,BSR                                              1DBS02830
       TRA     NSOAP                                                    DBS02840
*  ENTER HERE IF EXTERNAL INPUT BLOCK IS CORRECT LENGTH.                DBS02850
       SPACE                                                            DBS02860
 CLNTH LAC     LFDBR,4                                                  DBS02870
       SXA     OFSZC,0                                                  DBS02880
       STZ     LONG                                                     DBS02890
       ZET     -19,4         IS THERE A TRAILER WORD.                   DBS02900
       TSX     CKSQW,4       YES.  CHECK IT.                            DBS02910
       CAL     HWLNG                                                    DBS02920
       LAC     LFDBR,4                                                  DBS02930
       ZET     -19,4                                                    DBS02940
       SBM     K1                                                       DBS02950
       ADM     LNGTH                                                    DBS02960
       SLW     LNGTH                                                    DBS02970
       SPACE                                                            DBS02980
*  UPDATE COUNT OF LOGICAL RECORDS READ AND ACCEPTED.                   DBS02990
       SPACE                                                            DBS03000
 UPDCT CAL     HWLNG                                                    DBS03010
       LAC     LFDBR,4                                                  DBS03020
       ZET     -19,4                                                    DBS03030
       SBM     K1                                                       DBS03040
       LRS     35                                                       DBS03050
       DVP     RCLP3                                                    DBS03060
       XCL                                                              DBS03070
       ADM     CNTPR-16      UPDATE NO. OF LOGICAL RECORDS READ         DBS03080
       STO     CNTPR-16       AND ACCEPTED FROM EXTERNAL MERGE FILE.    DBS03090
       LAC     LGLFN,4                                                  DBS03100
       NZT     EOFIN,4                                                  DBS03110
       TRA     BLKCT                                                    DBS03120
       LXA     PHASE,4                                                  DBS03130
       TXH     RSTBC,4,2                                                DBS03140
       EJECT                                                            DBS03150
*  ENTER HERE WHEN EXTERNAL READ IS CHECKED OUT.                        DBS03160
       SPACE                                                            DBS03170
 BLKCT AXT     1,4           UPDATE COUNT OF BLOCKS THIS GROUP.         DBS03180
       TXI     *+1,4,1                                                  DBS03190
       SPACE                                                            DBS03200
*  TEST HERE TO SEE IF MORE BLOCKS MUST BE READ TO COMPLETE A GROUP.    DBS03210
       SPACE                                                            DBS03220
 SMTFF TXL     GOFMR,4,**    CURRENT GROUPING FACTOR IN DECREMENT.      DBS03230
 RSTBC AXT     1,4           THIS WAS LAST BLOCK.  READ COMPLETE.       DBS03240
       SXA     BLKCT,4       RESTORE BLOCK COUNT TO 1.                  DBS03250
       SPACE                                                            DBS03260
*  GIVE WORD COUNT WITH MINUS SIGN TO FINAL MERGE PROGRAM.              DBS03270
       SPACE                                                            DBS03280
       LXA     PHASE,4                                                  DBS03290
       TXL     CMPLT,4,2                                                DBS03300
       CLA     LNGTH         SET THE SIGN MINUS TO INDICATE             DBS03310
       SSM                    IT IS A WORD COUNT AND NOT                DBS03320
       XCA                    A RECORD COUNT.                           DBS03330
       STZ     LNGTH                                                    DBS03340
       LXA     BRP37,1       GET CHANNEL INDEX AND                      DBS03350
       CAL*    LCSTR          FIND LOCATION OF READ BUFFER.             DBS03360
       PAC     ,4            INITIALIZE WORD JUST BEFORE                DBS03370
       STQ     -1,4           BUFFER WITH LENGTH OF DATA BLOCK.         DBS03380
 CMPLT LAC     UCWAD,2                                                  DBS03390
       STZ     1,2           RELEASE UNIT.                              DBS03400
       STL     RDCSW         SET READ COMPLETE.                         DBS03410
 MRBLK STL     ACCPT         ACCEPT LAST READ.                          DBS03420
RESFZC SXA     OFSZC,0       RESET OFFSIZE COUNT.                       DBS03430
 NSOAP STZ     SELPR         RESET SELECT PLUS SWITCH.                  DBS03440
       TRA     BRP37         EXIT.                                      DBS03450
 GOFMR SXA     BLKCT,4       SAVE UPDATED BLOCK COUNT.                  DBS03460
       TRA     MRBLK         TO TO ACCEPT AND EXIT.                     DBS03470
RECVRY SXA     RECOV,1      SAVE                                        DBS03480
       SXA     RECOV+1,2    MAIN PROGRAM LINK                           DBS03490
       SXA     RECOV+2,4                                                DBS03500
       STZ     RAWPR-11     CLEAR BAD READ RECOVER LINK.                DBS03510
       ZET     PRIOR                                                 (5)DBS03511
 TESTP TRA*    **           GO TO DUMP,MESSAGE ETC..                    DBS03520
       TRA     BCLEV                                                 (5)DBS03521
       EJECT                                                            DBS03530
*  ENTER HERE IF INTERNAL INPUT.                                        DBS03540
CKINTL LXD     RIORT,4                                                  DBS03550
       SXA     EXPCTD,4                                                 DBS03560
       CAS     EXPCTD                                                   DBS03570
       TRA     LARGE                                                    DBS03580
       TRA     SIZEOK                                                   DBS03590
       ZET     REC05                                                    DBS03600
       TRA     SIZEOK                                                   DBS03610
       SUB     K3                                                       DBS03620
       LRS     35                                                       DBS03630
       DVP     CALPR-9                                                  DBS03640
       TZE     SIZEOK                                                   DBS03650
LARGE  LXA     OFSZC,4                                                  DBS03660
       TXI     *+1,4,1                                                  DBS03670
       SXA     OFSZC,4                                                  DBS03680
       TXH     SBDMP,4,LIMIT                                            DBS03690
       TSX     (NDATA,4                                                 DBS03700
       PZE     UCWAD,,BSR                                               DBS03710
       TRA     NSOAP                                                    DBS03720
SIZEOK CAL     RIORT                                                    DBS03730
       ADD     K1                                                       DBS03740
       PAC     ,4                                                       DBS03750
       ADM     0,4                                                      DBS03760
       ADD     K1                                                       DBS03770
       NZT     REC05                                                    DBS03780
       TRA     *+3                                                      DBS03790
       CAL     (COMMM                                                   DBS03800
       SUB     K1                                                       DBS03810
       STA     PULW                                                     DBS03820
       CAL*    RIORT                                                    DBS03830
       TRA     CLKCK                                                    DBS03840
UPINF  BSS     0                                                        DBS03850
       TSX     UPCTR,4       INCREASE BLOCK SEQUENCE NUMBER             DBS03860
       TSX     UNSET,4                                                  DBS03870
       PZE     RESFZC                                                   DBS03880
       TRA     RECOV                                                    DBS03890
*                                                                       DBS03900
*     CHECK FIRST AND LAST CLOCK WORDS FOR CORRECT POSITION             DBS03910
*                                                                       DBS03920
 PUFW  CAL     **            FETCH FIRST WORD                           DBS03930
CLKCK  STA     FSEQ          SAVE FIRST SEQUENCE NUMBER.                DBS03940
       ANA     LHMSK         MASK CLOCK PORTION                         DBS03950
       SLW     FCLK          SAVE CLOCK PORTION                         DBS03960
 PULW  CAL     **            FETCH LAST WORD                            DBS03970
       STD     LSEQ          SAVE LAST SEQUENCE NUMBER                  DBS03980
       ANA     RHMSK         MASK CLOCK PORTION                         DBS03990
       ORA     FCLK          PLACE FIRST AND LAST CLOCK WORDS IN ALL    DBS04000
       LXA     BRP39,4                                                  DBS04010
       LAS     =O631463631463 COMPAPE WITH KNOWN CLOCK WORD             DBS04020
       TRA     *+2           GO TO ERROR EXIT                           DBS04030
       TRA     OKAGN                                                    DBS04040
       TRA     3,4           ERROR RETURN TO IOEX                       DBS04050
*                                                                       DBS04060
*     CHECK FOR EQUAL FIRST AND LAST BLOCK SEQUENCE WORDS               DBS04070
*                                                                       DBS04080
*                                                                       DBS04090
*     CHECK TO SEE IF THIS BLOCK IS IN CORRECT POSITION                 DBS04100
*                                                                       DBS04110
 OKAGN CAL     0,2           PICK UP PREVIOUS SEQUENCE WORD FROM UCB    DBS04120
       STA     PSEQ          SAVE SEQUENCE NUMBER ONLY                  DBS04130
       CLA     PSEQ          PICKUP PREVIOUS SEQUENCE WORD              DBS04140
       SUB     FSEQ          REDUCE BY CURRENT SEQUENCE WORD+1          DBS04150
       TNZ     3,4                                                      DBS04160
       TRA     POSOK         HEAD AND TAIL SEQUENCE NUMBERS AGREE.      DBS04170
*                                                                       DBS04180
*     DETERMINE IF BLOCK SEQUENCE NUMBER AND RECORD COUNT AGREE         DBS04190
*                                                                       DBS04200
 POSOK CAL     2,2           PICK UP RECORD COUNT                       DBS04210
       SUB     FSEQ          REDUCE BY SEQUENCE NUMBER                  DBS04220
       ANA     =O77777       MASK ADDRESS                               DBS04230
       TZE     END           RETURN FOR REMAINDER OF CLEANUP.           DBS04240
       CAL     2,2           PICK UP RECORD COUNT                       DBS04250
       TSX     (DECVA,4       CONVERT TO BCD                            DBS04260
       STQ     SRMSG+5                                                  DBS04270
       CLA     FSEQ          PICK UP SEQUENCE NUMBER                    DBS04280
       STA     2,2           PLACE IN RECORD COUNT                      DBS04290
       TSX     (DECVA,4      CONVERT TO BCD FOR                         DBS04300
       STQ     SRMSG+7       SEQUENCE MESSAGE                           DBS04310
       LDQ     0,2           CONVERT AND PRINT                          DBS04320
       TSX     MSGSUP,4,3    PRINT SEQUENCE ERROR MESSAGE.              DBS04330
       PZE     SRMSG,,9+512*4                                           DBS04340
END    TSX     UPCTR,4       INCREASE BLOCK SEQUENCE NUMBER             DBS04350
       XEC     BRP37         IF THIS IS FIXED LENGTH                    DBS04360
       CAL*    LCSTR          RECORD SORT, THE WORD BEFORE              DBS04370
       PAC     ,4             DATA HAS A BLOCK LENGTH                   DBS04380
       CAL     *              (WORD COUNT), AND SHOULD                  DBS04390
       NZT     REC05          BE SET MINUS.                             DBS04400
       STP     -1,4                                                     DBS04410
       TRA     CMPLT         GO BACK TO READ NEXT BLOCK                 DBS04420
       SPACE   2                                                        DBS04430
*                                                                       DBS04440
*     SUBROUTINE TO UPDATE THE PREVIOUS BLOCK SEQUENCE NUMBER           DBS04450
*                                                                       DBS04460
 UPCTR SXA     UPIR2,2       SAVE IR2                                   DBS04470
       LAC     UCWAD,2       -L(UCB) TO IR2                             DBS04480
       CAL     0,2           PICK UP SEQUENCE NUMBER                    DBS04490
       ADD     K1            INCREASE BY ONE                            DBS04500
       STA     0,2           REPLACE IN UCB                             DBS04510
 UPIR2 AXT     **,2          RESTORE IR2                                DBS04520
       TRA     1,4                                                      DBS04530
       SPACE                                                            DBS04540
       SPACE                                                            DBS04550
*  ENTRY ON END OF FILE OR PERMANENT REDUNDANCY CHECK.                  DBS04560
       SPACE                                                            DBS04570
 BDIFF LFT     200000        IS THIS EOF.                               DBS04580
       TRA     TSTXI         YES.                                       DBS04590
RDMP   CAL     (COMMM        NO.  BLOCK UNREADABLE.                     DBS04600
       ORA     BDIFF         MAKE LARGER THAN RIORT.                    DBS04610
       SBM     RIORT                                                    DBS04620
       STA     HWLNG                                                    DBS04630
       ANA     =O77777                                                  DBS04640
       TSX     (DECVA,4                                                 DBS04650
       STQ     TMS12                                                    DBS04660
       TSX     SETTT,4                                                  DBS04670
       TRA     NSOAP                                                    DBS04680
       CLA     RIORT                                                    DBS04690
       STA     DMPCS                                                    DBS04700
       LXA     HWLNG,4                                                  DBS04710
       SXD     DMPCS,4                                                  DBS04720
       CLA     TMS11                                                    DBS04730
       LXA     PHASE,4                                                  DBS04740
       TXL     *+2,4,2                                                  DBS04750
       STO     TMS10+3                                                  DBS04760
       LAC     UCWAD,2                                                  DBS04770
       CLA     2,2                                                      DBS04780
       TSX     (DECVA,4                                                 DBS04790
       STQ     TMS01+3                                                  DBS04800
       CLA     2,2                                                      DBS04810
       TSX     (DECVD,4                                                 DBS04820
       STQ     TMS01+1                                                  DBS04830
       LDQ     0,2                                                      DBS04840
       TSX     MSGSUP,4,3                                               DBS04850
       PZE     TMS01,,4                                                 DBS04860
       TSX     MSGSUP,4,2                                               DBS04870
       PZE     2                                                        DBS04880
       PZE     TMS10,,4                                                 DBS04890
       PZE     TMS12,,2+512*4                                           DBS04900
       CALL    DEBLK         DUMP UNREADABLE BLOCK.                     DBS04930
       PZE     DMPCS,,1                                                 DBS04940
PRONLY NZT     XINSW                                                    DBS04950
       TRA     UPINF                                                    DBS04960
       TSX     UNSET,4                                                  DBS04970
       PZE     NSOAP                                                    DBS04980
       TRA     WAIT                                                     DBS04990
       PZE     NSOAP                                                    DBS05000
       TRA     RECOV                                                    DBS05010
       SPACE   1                                                        DBS05020
*  END OF FILE ENTRY                                                    DBS05030
       SPACE   1                                                        DBS05040
 TSTXI NZT     XINSW         IS THIS EXTERNAL INPUT.                    DBS05050
       TRA     SETEF         NO.  SET EOF AND EXIT.                     DBS05060
       CAL     RENTRY        PUT ENTRY FOR END OF REEL ACTION           DBS05070
       SLW     SWCHR         INTO REEL SWITCH.                          DBS05080
       LAC     UCWAD,2       RELEASE                                    DBS05090
       STZ     1,2           UNIT.                                      DBS05100
       TRA     NSOAP         RETURN TO IOEX.                            DBS05110
RENTRY TTR     ENDRL                                                    DBS05120
ENDRL  SXA     RLXR1,1       SAVE REGISTERS                             DBS05130
       SXA     RLXR2,2       FROM MAIN                                  DBS05140
       SXA     RLXR4,4       PROGRAM.                                   DBS05150
       STZ     SWCHR         RESET END OF REEL SWITCH.                  DBS05160
       CALL    SAVEW         SAVE RAWPR AND RAWPR-1.                    DBS05170
       LXA     LGLFN,4       PUT LOGICAL FILE NO INTO                   DBS05180
       PXD     ,4            CALLING SEQUENCE WORD                      DBS05190
       STO     RWCS1         RAWPR FOR CLOSING.                         DBS05200
       CALL    SCL           CLOSE SORT OR MERGE EXTERNAL INPUT REEL.   DBS05210
       TRA     *+2                                                      DBS05220
SWICH  PZE                   NON-ZERO IF THIS IS LAST REEL.             DBS05230
       ZET     SWICH         TEST TO SEE IF MORE REELS.                 DBS05240
       TRA     LASTR         TRANSFER IF THIS WAS LAST REEL.            DBS05250
       LXA     LGLFN,4       PUT LOGICAL FILE NO. INTO                  DBS05260
       PXD     ,4            CALLING SEQUENCE FOR OPENING.              DBS05270
       STO     RWCS1                                                    DBS05280
       CALL    IOPEN         OPEN NEW INPUT REEL.                       DBS05290
       STL     NOPRI         SET SWITCH TO OBTAIN                       DBS05300
       AXT     SELCT,4       REACTIVATION OF UNIT.  PUT                 DBS05310
       SXD     REMEM,4       L (SELECT) INTO CELL FOR UCW2.             DBS05320
       TSX     UNSET,4       REACTIVATE THE UNIT.                       DBS05330
       PZE                                                              DBS05340
REXIT  STZ     REXSW         RETURN TO                                  DBS05350
RLXR1  AXT     **,1          MAIN                                       DBS05360
RLXR2  AXT     **,2          PROGRAM.                                   DBS05370
RLXR4  AXT     **,4                                                     DBS05380
       TRA     1,4                                                      DBS05390
LASTR  CALL    RESTW         RESTORE RAWPR AND RAWPR-1.                 DBS05400
       STZ     SWICH                                                    DBS05410
       STL     REXSW         SET SWITCH FOR EXIT FROM REEL-SWITCHING    DBS05420
       TRA     SETEF         ROUTINE.  GO TO SET UP FOR EOF.            DBS05430
       SPACE                                                            DBS05440
*  NO MORE REELS, INPUT.  SET END OF FILE INDICATOR.                    DBS05450
       SPACE                                                            DBS05460
 SETEF BSS     0                                                        DBS05470
       CAL     PHASE                                                    DBS05480
       LAS     K2                                                       DBS05490
       NZT     XINSW                                                    DBS05500
       TRA     STEOF                                                    DBS05510
       LXA     BLKCT,4       NO. OF BLOCKS IN THIS GROUP + 1.           DBS05520
       TXL     STEOF,4,1     SET EOF IF NO DATA HAS BEEN READ.          DBS05530
       LAC     LGLFN,4       SET SWITCH TO CAUSE EOF FLAG TO BE SET     DBS05540
       STL     EOFIN,4        ON NEXT ENTRY FOR READ FOR THIS FILE.     DBS05550
       TRA     RSTBC                                                    DBS05560
 STEOF STL     EOFI                                                     DBS05570
       TRA     CMPLT         ACCEPT AND RELEASE.                        DBS05580
       EJECT                                                            DBS05590
       SPACE   1                                                        DBS05600
*  ROUTINE TO CHECK BLOCK SEQUENCE AND CHECKSUM WORDS IN EXTERNAL INPUT.DBS05610
       SPACE   1                                                        DBS05620
 CKSQW BSS     0                                                        DBS05630
       SXA     SAVE4,4                                                  DBS05640
       LAC     UCWAD,2       -L(UCB).                                   DBS05650
       CAL     (COMMM                                                   DBS05660
       SUB     K1                                                       DBS05670
       STA     SUMUP                                                    DBS05680
       STA     BBASE                                                    DBS05690
       LAC     LFDBR,4                                                  DBS05700
       NZT     -8,4          IS THERE A BLOCK CHECKSUM.                 DBS05710
       TRA     SUMOK         NO.  SKIP CKSUM CALC.                      DBS05720
       LXA     HWLNG,4       LENGTH OF BLOCK JUST READ.                 DBS05730
       TXI     *+1,4,-1                                                 DBS05740
       PXD     ,0                                                       DBS05750
 SUMUP ACL     **,4                                                     DBS05760
       TIX     *-1,4,1                                                  DBS05770
       LGR     18                                                       DBS05780
       STZ     TEMP                                                     DBS05790
       SLQ     TEMP                                                     DBS05800
       ALS     18                                                       DBS05810
       ACL     TEMP                                                     DBS05820
       LBT                                                              DBS05830
       TRA     *+2                                                      DBS05840
       ACL     =O1000000                                                DBS05850
       ERA*    BBASE                                                    DBS05860
       ANA     =O777777000000                                           DBS05870
       TZE     SUMOK                                                    DBS05880
       CLA     2,2           RECORD NO.                                 DBS05890
       TSX     (DECVA,4                                                 DBS05900
       STQ     TMS13+2                                                  DBS05910
       LDQ     0,2           PRINT ''UNIT XX RECORD NO. XXXX            DBS05920
       TSX     MSGSUP,4,3                                               DBS05930
       PZE     TMS13,,3+SNGL                                            DBS05940
       TSX     MSGSUP,4,2                                               DBS05950
       PZE     1                                                        DBS05960
       PZE     TMS14,,3+DBL                                             DBS05970
 SUMOK LAC     LFDBR,4                                                  DBS05980
       NZT     -9,4          IS THERE A BLOCK SEQ. NO.                  DBS05990
       TRA     SEQOK         NO.  SKIP CHECKING.                        DBS06000
       CAL     2,2                                                      DBS06010
       ERA*    BBASE                                                    DBS06020
       PAX     ,4                                                       DBS06030
       TXL     SEQOK,4,0     TRANSFER IF SEQ. NO. SAME AS REC. NO.      DBS06040
       CLA*    BBASE                                                    DBS06050
       TSX     (DECVA,4      BLOCK SEQ. NO.                             DBS06060
       STQ     SRMSG+7                                                  DBS06070
       CLA     2,2                                                      DBS06080
       TSX     (DECVA,4                                                 DBS06090
       STQ     SRMSG+5                                                  DBS06100
       LDQ     RD07                                                     DBS06110
       STQ     SRMSG+8                                                  DBS06120
       LDQ     0,2                                                      DBS06130
       TSX     MSGSUP,4,3                                               DBS06140
       PZE     SRMSG,,9+512*4                                           DBS06150
       CLA*    BBASE                                                    DBS06160
       STA     2,2           CHANGE RECORD COUNT.                       DBS06170
 SEQOK BSS     0                                                        DBS06180
 SAVE4 AXT     **,4                                                     DBS06190
       TRA     1,4                                                      DBS06200
 BBASE PZE                   LOC. OF WORD FOLLOWING DATA BLOCK.         DBS06210
 SETPR LAC     UCWAD,2                                                  DBS06220
       CLA     1,2                                                      DBS06230
       STD     REMEM                                                    DBS06240
       STZ     1,2                                                      DBS06250
       STL     PRIOR                                                    DBS06260
       CLA     1,4                                                      DBS06270
       STA     *+2                                                      DBS06280
       STL     TESTP        ESTABLISH CONTROL VECTOR FOR TRA*           DBS06290
 REMEM TXH     **,,**                                                   DBS06300
       TRA     2,4                                                      DBS06310
 REACT BSS     0                                                        DBS06320
       SXA     REAC4,4                                                  DBS06330
       CAL*    1,4                                                      DBS06340
 NEWUN PAC     ,4                                                       DBS06350
       STA     NEWUN                                                    DBS06360
       CLA     REMEM                                                    DBS06370
       STD     1,4                                                      DBS06380
       STZ     RDCSW                                                    DBS06390
       TSX     (ACTVX,4                                                 DBS06400
       PZE     NEWUN                                                    DBS06410
 REAC4 AXT     **,4                                                     DBS06420
       TRA     2,4                                                      DBS06430
 SETTT SXA     GOFOR,4                                                  DBS06440
       TSX     SETPR,4                                                  DBS06450
       PZE     DUMP1                                                    DBS06460
       STL     NOPRI                                                    DBS06470
       CAL     TRPTR        ESTABLISH BAD READ RECOVER LINK             DBS06480
       SLW     RAWPR-11     FOR MAIN PROGRAM.                           DBS06490
 GOFOR AXT     **,4                                                     DBS06500
       TRA     1,4                                                      DBS06510
 TRPTR TTR     RECVRY       CONTROL VECTOR FOR MAIN PROGRAM.            DBS06520
 DUMP1 STZ     PRIOR                                                    DBS06530
       CALL    SAVEW                                                    DBS06540
       LXA     GOFOR,4                                                  DBS06550
       TRA     2,4                                                      DBS06560
 UNSET SXA     COMFR,4                                                  DBS06570
       NZT     NOPRI                                                    DBS06580
       TRA*    1,4                                                      DBS06590
       STZ     NOPRI                                                    DBS06600
       CALL    RESTW                                                    DBS06610
       CLA*    CHAPR         IF THIS IS PHASE 1,                        DBS06620
       LXA     PHASE,4        PLACE NEW UNIT CONTROL                    DBS06630
       TXH     *+2,4,1        WORD ADDRESS INTO                         DBS06640
       STA     UCWAD          UCWAD.                                    DBS06650
       TSX     REACT,4                                                  DBS06660
       PZE     UCWAD                                                    DBS06670
 COMFR AXT     **,4                                                     DBS06680
       TRA     2,4                                                      DBS06690
 PRIOR PZE                                                              DBS06700
       DUP     1,11                                                     DBS06710
 EOFIN PZE                   TABLE OF SWITCHES TO INDICATE EOF FLAG     DBS06720
*                             MUST BE SET ON NEXT ENTRY TO IO TO        DBS06730
*                             READ A PARTICULAR LOGICAL FILE.           DBS06740
TMS10  BCI     4,UNRDBL BLK DUMPED  *RD05                               DBS06750
TMS11  BCI     1, *RD06                                                 DBS06760
TMS12  BCI     2,       WORDS                                           DBS06770
 TMS13 BCI     3,RECORD NO.                                             DBS06780
TMS14  BCI     3,CKSUM ERROR  *RD08                                     DBS06790
SRMSG  BCI     9,BLKSEQ ERROR-UCW3 CHGD FROM   XXXXXX  TO  XXXXXX *RD09 DBS06800
RD07   BCI     1, *RD07                                                 DBS06810
*  TABLES, SWITCHES, AND CONSTANTS.                                     DBS06820
       SPACE                                                            DBS06830
 WRCS2 BSS     8             TABLE FOR WRITE CALL. SEQ. WORDS NO. 2.    DBS06840
 RDCS2 BSS     8             TABLE FOR READ CALL. SEQ. WORDS NO. 2.     DBS06850
 UCWAD PZE                   UNIT CONTROL BLOCK ADDRESS SAVED HERE.     DBS06860
 LBRTT PZE                   PERM. REDUND., LONG BLOCK SWITCH.          DBS06870
 LNGTH PZE                   NO. OF WRDS OF MERGE INPUT, THIS READ.     DBS06880
*  READ REQUEST.                                                        DBS06890
 HOLDQ PZE                   SAVE MQ HERE.                              DBS06900
LONG   BSS     0                                                        DBS06910
 DRLNG PZE                   DUMMY-READ-LONG-BLOCK SWITCH.              DBS06920
 IORTN IORTN   0,,-1                                                    DBS06930
 HWLNG PZE                   BLOCK LENGTH SAVED HERE.                   DBS06940
 SELPR PZE                    SELECT(+) READ SWITCH.                    DBS06950
 ACCPT SIX                   LAST-READ-ACCEPTANCE SWITCH.               DBS06960
 RIORT IORT    **,,**         READ IORT.                                DBS06970
 K0    PZE                   CONSTANT ZERO.                             DBS06980
 K3    PZE     3             CONSTANT 3.                                DBS06990
K4     PZE     4              CONSTANT4.                                DBS07000
 RDSEL PZE     ,,SELCT                                                  DBS07010
LWRSL  MZE     ,,WRSEL                                                  DBS07020
 LGTPO PZE                   LAST WORD +1 OF READ AREA                  DBS07030
 DIFER PZE                   DIFFERENCE FROM EXPECTED LENGTH            DBS07040
 ACDIF PZE                   EXPECTED LENGTH                            DBS07050
 FSEQ  PZE     **            FIRST SEQUENCE WORD IN ADDRESS             DBS07060
 FCLK  PZE     **            LEFT HALF CONTAINS FIRST CLOCK WORD        DBS07070
 LSEQ  PZE     **            LAST SEQUENCE WORD IN DECREMENT            DBS07080
 PSEQ  PZE     **            PREVIOUS SEQUENCE WORD + 1                 DBS07090
 LHMSK OCT     777777000000  LEFT HALF MASK                             DBS07100
 RHMSK OCT     777777        RIGHT HALF MASK                            DBS07110
 LCMD  PZE     IOCMD         LOCATION OF IO COMMAND                     DBS07120
 IOCMD IOSTN   0,,-1          SKIP COMMAND                              DBS07130
 DIOCM IOCT    **,,**                                                   DBS07140
REXSW  PZE                   NON-ZERO MEANS EXIT TO MAIN PROGRAM.       DBS07150
 PMBSW PZE                   POSSIBLE MISSING BLOCK SWITCH 0=OFF        DBS07160
       EXTERN  MSGSUP                                                   DBS07170
NOSOAP EQU     NSOAP                                                    DBS07180
       EJECT                                                            DBS07190
*  DEFINITIONS.                                                         DBS07200
       SPACE                                                            DBS07210
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     DBS07220
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  DBS07230
 LABPR COMMON  5              LABEL CARD PARAMETERS                     DBS07240
 CHAPR COMMON  6              CHANNEL CARD PARAMETERS                   DBS07250
 FILPR COMMON  14             FILE CARD PARAMETERS                      DBS07260
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              DBS07270
 RECPR COMMON  10             RECORD CARD PARAMETERS                    DBS07280
 DELPR COMMON  2              DELETE CARD PARAMETERS                    DBS07290
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            DBS07300
 CALPR COMMON  50             CALCULATED PARAMETERS                     DBS07310
 GENPR COMMON  10             GENERAL PARAMETERS                        DBS07320
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  DBS07330
 CNTPR COMMON  20             COUNT PARAMETERS                          DBS07340
 ERAPR COMMON  30             ERASABLE SORAGE PARAMETERS                DBS07350
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           DBS07360
 BIT31 BOOL    20                                                       DBS07370
 BIT33 BOOL    4                                                        DBS07380
 BLKNG EQU     CALPR-1                                                  DBS07390
 BSR   EQU     5                                                        DBS07400
 COMMM EQU     (COMMM         CELL WHERE SCHX RESULTS ARE PUT.          DBS07410
 CRGPF EQU     RAWPR-6       GROUPING FACTOR FOR CURRENT READ.          DBS07420
 CTPAD EQU     CNTPR-6                                                  DBS07430
 DBLSP EQU     4                                                        DBS07440
 DBL   EQU     512*DBLSP                                                DBS07450
 EOFI  EQU     RAWPR-3                                                  DBS07460
 GRPFR EQU     CALPR-17      SORT INPUT GROUPING FACTOR IN DECREMENT.   DBS07470
 LCSTR EQU     RAWPR-14       LOC. OF CALL. SEQ. TABLE, READ.           DBS07480
 LFDBR EQU     RAWPR-10       LOCATION OF FILE DATA BLOCK, READ.        DBS07490
 LGLFN EQU     RAWPR-7       LOG. FILE NO. OF CURRENT READ IN ADDRESS.  DBS07500
 LIMIT EQU     5             MAX. NO. OF REREADS FOR OFFSIZE.           DBS07510
 MMRBL EQU     CALPR-13       MAXIMUM MERGE BLOCKING.                   DBS07520
 PADNG EQU     CALPR-20      ADDRESS OF PADDING RECORD.                 DBS07530
 RCLP3 EQU     RECPR-1       INPUT RECORD LENGTH (LOG. REC. ), PHASE 3. DBS07540
 RDCSW EQU     RAWPR-2        READ COMPLETION SWITCH.                   DBS07550
 RECLN EQU     RECPR                                                    DBS07560
REC05  EQU     RECPR-5       TYPE OF RECORD (FIXED, VARIABLE, OR 'TYPE')DBS07570
 REDMD EQU     RAWPR-16                                                 DBS07580
 RESTR EQU     1                                                        DBS07590
 RWCS1 EQU     RAWPR         READ-WRITE CALLING SEQUENCE WORD NO. 1.    DBS07600
 RWCS2 EQU     RAWPR-1       READ-WRITE CALLING SEQUENCE WORD NO. 2.    DBS07610
 SNGLS EQU     0                                                        DBS07620
 SNGL  EQU     512*SNGLS                                                DBS07630
 SPR14 EQU     CHAPR                                                    DBS07640
 SPR15 EQU     CHAPR-3                                                  DBS07650
 SPR16 EQU     CHAPR-2                                                  DBS07660
 SPR20 EQU     FILPR                                                    DBS07670
SWCHR  EQU     RAWPR-11                                                 DBS07680
 TRAPX EQU     (TRAPX                                                   DBS07690
 VBLOP EQU     OPTPR-5                                                  DBS07700
 WRTMD EQU     RAWPR-17                                                 DBS07710
 XINSW EQU     RAWPR-13       EXTERNAL INPUT SWITCH.                    DBS07720
 XOUTS EQU     RAWPR-12      EXTERNAL OUTPUT SWITCH.                    DBS07730
DOUBLE EQU     2048          DOUBLE-SPACE CODE.                         DBS07740
       DETAIL                                                           DBS07750
*  WRITE SELECT ENTRY.                                                  DBS07760
*  ASSUMPTIONS - ON NORMAL ENTRY (SCATTER WRITE) THE ADDRESS OF         DBS07770
*   RAWPR-1 HAS LOCATION OF WRITE TAG LIST, DECREMENT HAS LENGTH        DBS07780
*   OF THIS LIST.  BUFFER WRITE ENTRY (IOBB) IS ONLY DONE               DBS07790
*   IN PHASE 3 (FINAL MERGE).  ON BUFFER WRITE ENTRY THE                DBS07800
*   ADDRESS OF RAWPR-1 HAS LOCATION OF BEGINNING OF THE BUFFER,         DBS07810
*   AND THE DECREMENT HAS THE NO. OF WORDS OF DATA TO BE WRITTEN.       DBS07820
 WRSEL BSS     0                                                        DBS07830
       SXA     WRSV1,1                                                  DBS07840
       SXA     WRSV2,2                                                  DBS07850
       SXA     WRSV2+1,4                                                DBS07860
       TMI     WRTMN                                                    DBS07870
       PAC     ,2            -L(UCB) TO IR2.                            DBS07880
       CAL     3,2           UCW4.                                      DBS07890
       STA     WSLCT         INITIALIZE SELECT ADDRESS.                 DBS07900
       ZET     SELPW         IF TO BE A REWRITE,                        DBS07910
       TRA     REWRT          WE SKIP FOLLOWING INIT.                   DBS07920
       CAL     2,2           UCW3                                       DBS07930
       PAX     ,4             RECORD COUNT.                             DBS07940
       TXI     *+1,4,1       NEXT RECORD COUNT.                         DBS07950
       SXA     FSTCL,4       INITIALIZE 1ST AND                         DBS07960
       SXD     LSTCL,4        FINAL WORDS WITH SEQUENCE COUNT.          DBS07970
       LXA     PHASE,4                                                  DBS07980
       TXL     WRTP1,4,1     TRANSFER IF PHASE 1.                       DBS07990
       TXL     WRTP2,4,2     TRANSFER IF PHASE 2.                       DBS08000
       SXD     HIOCP,0       PHASE 3.  ZERO THE DECREMENTS OF           DBS08010
       SXD     TIORT,0        HIOCP AND TIORT, THEN TEST                DBS08020
       LAC     SPR29,4        FOR BLOCK SEQUENCE + CHECKSUM WORD.       DBS08030
       NZT     -19,4         TRANSFER AROUND NEXT IF NONE.              DBS08040
       TRA     NOSEQ                                                    DBS08050
       STZ     TLWRD                                                    DBS08060
       AXT     TLWRD,4       PUT ADDRESS OF COMPUTED BLOCK              DBS08070
       SXA     TIORT,4        SEQUENCE AND CKSUM WORD IN                DBS08080
       AXT     1,4            TIORT ADDRESS, 1 IN DECREMENT,            DBS08090
       SXD     TIORT,4        TO CAUSE THIS WORD TO BE WRITTEN OUT.     DBS08100
       LAC     SPR29,4       ARE WE TO                                  DBS08110
       NZT     -8,4           COMPUTE CKSUM.                            DBS08120
       TRA     NOCKS         NO.                                        DBS08130
       CAL*    LCSTW         GET CALLING SEQUENCE WORD NO. 2.           DBS08140
       STD     CMPBS                                                    DBS08150
       PAX     ,4            COMPUTE BASE ADDRESS OF LIST OF TAGS.      DBS08160
 CMPBS TXI     *+1,4,**                                                 DBS08170
       ZET     BUFWR                                                    DBS08180
       TRA     BCKSM                                                    DBS08190
       SXA     GETTG,4       INITIALIZE TAG LIST BASE ADDRESS.          DBS08200
       PDX     ,4            NO. OF TAGS TO IR4.                        DBS08210
       STZ     TEMP                                                     DBS08220
 GETTG CAL     **,4          GET TAG,                                   DBS08230
       PDX     ,2             PUT LOGICAL RECORD LENGTH INTO XR2        DBS08240
       SXA     *-1,2                                                    DBS08250
       ADM     *-2           COMPUTE BASE OF RECORD AREA,               DBS08260
       STA     ADDUP          INITIALIZE FOR SUMMING.                   DBS08270
       CAL     TEMP                                                     DBS08280
 ADDUP ACL     **,2          DO ONE LOGICAL RECORD                      DBS08290
       TIX     *-1,2,1        AT A TIME.                                DBS08300
       SLW     TEMP                                                     DBS08310
       TIX     GETTG,4,1     GO FOR NEXT LOGICAL RECORD.                DBS08320
 XCL   XCL                   ALL DONE.                                  DBS08330
       STZ     TEMP           NOW FOLD.                                 DBS08340
       SLQ     TEMP                                                     DBS08350
       XCL                                                              DBS08360
       ALS     18                                                       DBS08370
       ACL     TEMP                                                     DBS08380
       LBT                                                              DBS08390
       TRA     *+3                                                      DBS08400
       ACL     1DEC                                                     DBS08410
       ERA     K1                                                       DBS08420
       SLW     TLWRD         FOLDED CHECKSUM IN LEFT HALF.              DBS08430
 NOCKS LAC     SPR29,4                                                  DBS08440
       NZT     -9,4          TEST FOR BLOCK SEQUENCING.                 DBS08450
       TRA     NOSEQ                                                    DBS08460
       CAL     FSTCL                                                    DBS08470
       STA     TLWRD         BLOCK SEQUENCE NO.                         DBS08480
 NOSEQ CAL*    LCSTW         GET CALLING SEQ. WORD NO. 2.               DBS08490
       ZET     BUFWR         IS THIS BUFFER WRITE.                      DBS08500
       TRA     SETBF         YES.                                       DBS08510
       STA     WCTRL                                                    DBS08520
       STD     WCTRL                                                    DBS08530
 WRT29 SUB     K1                                                       DBS08540
       STA*    (RCHXI        INITIALIZE RESET AND LOAD CHANNEL.         DBS08550
       STA     GTHIO+1                                                  DBS08560
       ARS     18                                                       DBS08570
       ADM     WCTRL         COMPUTE TAG LIST BASE ADDRESS.             DBS08580
       STA     GTTIO+1                                                  DBS08590
       CLA*    GTHIO+1       GET HEAD TAG AND                           DBS08600
       STO     SVWTG          SAVE.                                     DBS08610
       CLA*    GTTIO+1       SAVE BASE TAG.                             DBS08620
       STO     SVWTG+1                                                  DBS08630
 GTHIO CLA     HIOCP         HEAD IOCP TO BEGINNING OF                  DBS08640
       STO     **             WRITE LIST.                               DBS08650
 GTTIO CLA     TIORT         TAIL IORT TO TAIL OF WRITE                 DBS08660
       STO     **             LIST.                                     DBS08670
 WSLCT WRS     **            SELECT OUTPUT UNIT.                        DBS08680
       XEC*    (RCHXI        RESET AND LOAD CHANNEL.                    DBS08690
       STZ     WRCSW         SET WRITE IN PROGRESS.                     DBS08700
       STL     SELPW         FLAG SELECT MINUS LAST.                    DBS08710
 WRSV1 AXT     **,1                                                     DBS08720
 WRSV2 AXT     **,2                                                     DBS08730
       AXT     **,4                                                     DBS08740
       STL     GENPR-5                                                  DBS08750
       TRA     1,4           RETURN TO IOEX.                            DBS08760
*  BUFFER WRITE ENTRY.                                                  DBS08770
BWRSEL STL     BUFWR         SET FOR BUFFER WRITE.                      DBS08780
       TRA     WRSEL                                                    DBS08790
*                                                                       DBS08800
 BUFWR PZE                   BUFFER WRITE SWITCH.                       DBS08810
 BCKSM SXA     BACL,4        BASE OF BLOCK TO ACL.                      DBS08820
       PDX     ,4            LENGTH OF BLOCK TO IR4.                    DBS08830
       PXD     ,0            CLEAR AC FOR CHECKSUMMING.                 DBS08840
 BACL  ACL     **,4          TAKE CHECKSUM.                             DBS08850
       TIX     *-1,4,1                                                  DBS08860
       TRA     XCL           GO FOLD IT.                                DBS08870
 SETBF STA     BIOCP                                                    DBS08880
       STD     BIOCP                                                    DBS08890
       CAL     TIORT                                                    DBS08900
       SLW     BIOCP+1                                                  DBS08910
       CAL     SETBF                                                    DBS08920
       STA*    (RCHXI                                                   DBS08930
       TRA     WSLCT                                                    DBS08940
 BIOCP IOCP    **,,**                                                   DBS08950
       PZE                                                              DBS08960
*  WRITE, PHASE 2.                                                      DBS08970
       SPACE                                                            DBS08980
 WRTP2 CLA     RAWPR-8       INITIALIZE SEQUENCE BREAK AND              DBS08990
       STO     SQBRK          BLOCK LENGTH WORD.                        DBS09000
       TSX     P1P2C,4       SET UP HEAD AND TAIL COMMANDS,             DBS09010
       TRA     NOSEQ          GO FINISH INITIALIZATION.                 DBS09020
       SPACE                                                            DBS09030
*  WRITE, PHASE 1.                                                      DBS09040
 WRTP1 BSS     0                                                        DBS09050
       ZET     WRCSW         IS THIS A NEW WRITE GROUP.                 DBS09060
       TRA     NEWRT         YES.  GO INITIALIZE FOR IT.                DBS09070
       STZ     SQBRK         SET NO-SEQUENCE-BREAK FLAG (SIGN BIT).     DBS09080
       CLA     GTTIO+1       GET LAST BASE LOCATION, PUT INTO           DBS09090
       STA     WCTRL          ADDRESS OF WRITE CONTROL WORD.            DBS09100
 CMPAR CAL     CALPR-14      COMPARE MAXIMUM MERGE BLOCKING             DBS09110
       CAS     RMAIN          AGAINST NO. OF RECORDS REMAINING          DBS09120
       CAL     RMAIN          TO WRITE.  TAKE THE LESSER AND            DBS09130
 WCTRL TXH     **,,**         PLACE IN DECREMENT OF WRITE CONTROL WORD. DBS09140
       PAX     ,4                                                       DBS09150
       SXD     WCTRL,4                                                  DBS09160
       SUB     RMAIN         UPDATE NO. OF RECORDS REMAINING.           DBS09170
       STA     RMAIN                                                    DBS09180
       PXA     ,4            COMPUTE ADDRESS PORTION OF SEQUENCE        DBS09190
       LRS     35             BREAK AND BLOCKING WORD.                  DBS09200
       MPY     P2REC                                                    DBS09210
       XCA                                                              DBS09220
       STA     SQBRK                                                    DBS09230
       CAL     RAWPR-8       GET SEQUENCE BREAK LEVEL                   DBS09240
       STD     SQBRK                                                    DBS09250
       TSX     P1P2C,4                                                  DBS09260
       CAL     WCTRL                                                    DBS09270
       TRA     WRT29                                                    DBS09280
 NEWRT CAL     RAWPR-8       NEW WRITE.  SET SEQUENCE BREAK FLAG        DBS09290
       STP     SQBRK          AS GIVEN BY MAIN ROUTINE.                 DBS09300
       CAL*    LCSTW         INITIALIZE WRITE CONTROL WORD WITH         DBS09310
       STA     WCTRL          ADDRESS OF TAG LIST FOR NEW               DBS09320
       PDX     ,4             WRITE.  PUT COUNT INTO COUNT              DBS09330
       SXA     RMAIN,4        OF REMAINING RECORDS.                     DBS09340
       PXA     ,4                                                       DBS09350
       ADM     COUNT                                                    DBS09360
       STO     COUNT                                                    DBS09370
       TRA     CMPAR                                                    DBS09380
       SPACE                                                            DBS09390
*  SET UP FOR A REWRITE.                                                DBS09400
       SPACE                                                            DBS09410
 REWRT CLA     GTHIO+1       RE-INITIALIZE RESET AND LOAD               DBS09420
       ZET     BUFWR                                                    DBS09430
       CLA     SETBF                                                    DBS09440
       STA*    (RCHXI         CHANNEL AND GO TO SELECT.                 DBS09450
       TRA     WSLCT                                                    DBS09460
       SPACE                                                            DBS09470
*  ROUTINE TO SET UP HEAD AND TAIL COMMANDS FOR PHASE 1 AND PHASE 2.    DBS09480
       SPACE                                                            DBS09490
 P1P2C BSS     0                                                        DBS09500
       SXA     CBACK,4                                                  DBS09510
       AXT     2,4                                                      DBS09520
       SXD     HIOCP,4                                                  DBS09530
       AXT     LSTCL,4                                                  DBS09540
       SXA     TIORT,4                                                  DBS09550
       AXT     1,4                                                      DBS09560
       SXD     TIORT,4                                                  DBS09570
 CBACK AXT     **,4                                                     DBS09580
       TRA     1,4                                                      DBS09590
       EJECT                                                            DBS09600
*  WRITE SELECT MINUS.                                                  DBS09610
WRTMN  STZ     SELPW         RESET SELPW SWITCH.                        DBS09620
       LFT     200000        WAS THIS END OF TAPE.                      DBS09630
       STL     EOTI          YES.  SET END OF TAPE INDICATOR.           DBS09640
       ZET     BUFWR                                                    DBS09650
       TRA     DONE                                                     DBS09660
RSTAG  LDQ     SVWTG         RESTORE DISPLACED TAG TO LIST.             DBS09670
       STQ*    GTHIO+1                                                  DBS09680
       LDQ     SVWTG+1                                                  DBS09690
       STQ*    GTTIO+1                                                  DBS09700
       ZET     RMAIN         ARE THERE MORE RECORDS TO WRITE.           DBS09710
       TRA     WRSV1          YES.  DO NOT RELEASE UNIT, AND EXIT.      DBS09720
       CLS     CALPR-6       TEST FOR OVERFLOW.                         DBS09730
       ALS     1             -2M                                        DBS09740
       SUB     CALPR-5       -L-2M                                      DBS09750
       ADD     CALPR-11      CAPACITY-L-2M                              DBS09760
       CAS     COUNT                                                    DBS09770
       TRA     *+3                                                      DBS09780
       TRA     *+1           CAPACITY IS REACHED                        DBS09790
       STZ     OVFLS          OR EXCEEDED.                              DBS09800
 DONE  STL     WRCSW         SET WRITE COMPLETE.                        DBS09810
       STZ     BUFWR         RESET BUFFER WRITE SWITCH.                 DBS09820
       STZ     1,2           RELEASE UNIT.                              DBS09830
       TRA     WRSV1         GO TO EXIT.                                DBS09840
       SPACE   2                                                        DBS09850
*  CONSTANTS AND SWITCHES.                                              DBS09860
       SPACE                                                            DBS09870
 HIOCP IOCP    FSTCL,,**     HEAD IOCP.                                 DBS09880
 TIORT IORT    **,,**        TAIL IORT.                                 DBS09890
 TLWRD PZE                   CELL TO HOLD TERMINAL WORD FOR WRITE-OUT.  DBS09900
 SELPW PZE                   WRITE SEL(+) SWITCH.                       DBS09910
 FSTCL OCT     631463000000  FIRST CLOCKWORD.                           DBS09920
 SQBRK PZE                   SEQUENCE BRK + BLOCKSIZE WRD BUILT HERE.   DBS09930
 LSTCL OCT     631463        LAST CLOCKWORD.                            DBS09940
 SVWTG BSS     2             TAGS SAVED HERE WHILE OVERLAID.            DBS09950
 TEMP  PZE                   TEMPORARY STORAGE.                         DBS09960
 1DEC  PZE     ,,1                                                      DBS09970
 RMAIN PZE                   NO. OF LOG. RECORDS LEFT TO WRITE OUT.     DBS09980
K1     PZE     1             CONSTANT 1.                                DBS09990
  K2   PZE     2,,                                                      DBS10000
EXPCTD PZE                                                              DBS10010
 COUNT PZE                   COUNT OF RECORDS WRITTEN.                  DBS10020
       EJECT                                                            DBS10030
*  DEFINITION CARDS FOR WRITE SELECT ROUTINE.                           DBS10040
EOTI   EQU     RAWPR-5                                                  DBS10050
LCSTW  EQU     RAWPR-15                                                 DBS10060
 OVFLS EQU     RAWPR-9                                                  DBS10070
 P2REC EQU     CALPR-9       FIXED RECORD LENGTH OF PHASE 2.            DBS10080
 P3REC EQU     RECPR-2       FIXED RECORD LENGTH FROM PHASE 3.          DBS10090
PHASE  EQU     GENPR                                                    DBS10100
RCHXI  EQU     (RCHXI                                                   DBS10110
SPR29  EQU     FILPR-1                                                  DBS10120
WRCSW  EQU     RAWPR-4                                                  DBS10130
       END                                                              DBS10140
* 7090/94 SORT VER 7 MOD 6 BUFFER/READ FIXED LENGTH INPUT PHASE 1    (6)DBU00000
*      FAP
       ENTRY   BUFRD                                                    DBU00010
       SST                                                              DBU00020
BUFRD  SXA     WON,1         SAVE THE                                   DBU00030
       SXA     TOO,2          CONTENTS OF                               DBU00040
       SXA     FOR,4          THE INDEX REGISTERS.                      DBU00050
SWCHA  TRA     *+1           THIS IS A ONE-TIME SWITCH.                 DBU00060
       LAC     FIL00,2       IS THERE A                                 DBU00070
       ZET     -19,2          TRAILERWORD...                            DBU00080
       STL     TRLPRS                                                   DBU00090
       LXA     ERA00,2                                                  DBU00100
       SXA     BEGIN,2                                                  DBU00110
       SXA     TOP,2                                                    DBU00120
       SXA     MOVER,2                                                  DBU00130
       SXA     BOT,2                                                    DBU00140
       CLA     ERA00                                                    DBU00150
       STD     *+1                                                      DBU00160
       TXI     *+1,2,**                                                 DBU00170
       SXA     POSTE,2                                                  DBU00180
       LAC     FIL00,4                                                  DBU00190
       CLA     -22,4                                                    DBU00200
       STO     LENTH                                                    DBU00210
       ALS     18                                                       DBU00220
       STD     SHTST                                                    DBU00230
       CLA*    CHA00         GET THE                                    DBU00240
       STA     LOC            ADDRESS OF                                DBU00250
       LDI*    LOC            THE UNIT FROM                             DBU00260
       LNT     20000          THE UNIT CONTROL BLOCK AND                DBU00270
       TRA     SWCH           TRANSFER IF NON-HYPER.                    DBU00280
       STL     HYPER         SET CELL, IF                               DBU00290
       CLA     RDABL          HYPER, AND                                DBU00300
       STO     RDTBL          CHANGE IORT TO                            DBU00310
       CAL     =16            CPYD AND SET                              DBU00320
       NZT*    FIL00          MODE FOR                                  DBU00330
       ORS     MODE           BINARY OR BCD AND                         DBU00340
       CAL     =1             SELECT THE                                DBU00350
       LFT     40             PROPER                                    DBU00360
       ORS     MODE           INTERFACE.                                DBU00370
SWCH   CLA     SWCHY         SET                                        DBU00380
       STA     SWCHA          SWCHA.                                    DBU00390
       CLA     ERA21                                                    DBU00400
       STO     SAVE                                                     DBU00410
       STZ     ERA24                                                    DBU00420
       TRA     NTW           GO AND READ.                               DBU00430
GO     CLA     SAVE                                                     DBU00440
       STO     ERA23                                                    DBU00450
       STO     BIN                                                      DBU00460
       STO     RECMOV                                                   DBU00470
       CLA     ERA21                                                    DBU00480
       STO     SAVE                                                     DBU00490
       STZ     ERA24                                                    DBU00500
IN     LXD     RECMOV,1                                                 DBU00510
       CLA     BOT                                                      DBU00520
       SUB     MOVER                                                    DBU00530
       CAS     REC00                                                    DBU00540
       TRA     MREC                                                     DBU00550
       TRA     MREC                                                     DBU00560
       ENB     =0                                                       DBU00570
       CLA     TOP                                                      DBU00580
       SUB     BEGIN                                                    DBU00590
       CAS     REC00                                                    DBU00600
       TRA     ROTAT                                                    DBU00610
       TRA     ROTAT                                                    DBU00620
       ENB*    (TRAPX                                                   DBU00630
       TRA     CHECK                                                    DBU00640
ROTAT  CLA     TOP           MOVE THE POINTERS                          DBU00650
       STO     BOT            TOWARD THE                                DBU00660
       CLA     BEGIN          TOP OF                                    DBU00670
       STO     TOP            THE                                       DBU00680
       STO     MOVER          BUFFER.                                   DBU00690
       STZ     SWA                                                      DBU00700
       ENB*    (TRAPX                                                   DBU00710
MREC   TXL     WON,1,0                                                  DBU00720
       ZET     MOD05                                                    DBU00730
       CALL    XSM06                                                    DBU00740
       TRA     DEL           NOTHING WAS INSERTED, TEST FOR DELETE.     DBU00750
       TRA     NODEL         DO NOT MAKE A DELETION.                    DBU00760
       TRA     INSERT        MOD PROGRAM INSERTED A RECORD.             DBU00770
BACK   CLA     MOVER         DELETE THIS RECORD.                        DBU00780
       ADD     REC00                                                    DBU00790
       STA     MOVER                                                    DBU00800
       TRA     ALL                                                      DBU00810
DEL    NZT     DEL00         IS A DELETE REQUESTED...                   DBU00820
       TRA     NODEL         NO.                                        DBU00830
       LXA     MOVER,4                                                  DBU00840
       SXA     PLACE,4                                                  DBU00850
       SXD     PLACE,4                                                  DBU00860
       CLA     *-1                                                      DBU00870
       STA     ERA11          BE DELETED AND                            DBU00880
       AXT     1,4            SET UP                                    DBU00890
       SXD     ERA11,4        ERA11 FOR                                 DBU00900
       CALL    DELETE         DELETE.                                   DBU00910
       LXD     PLACE,4       WAS A DELETION MADE...                     DBU00920
       TXH     NODEL,4,0     NO.                                        DBU00930
       TRA     BACK                                                     DBU00940
NODEL  LXA     REC00,4       FIND THE                                   DBU00950
       CLA     MOVER                                                    DBU00960
       ADD     REC00          DETERMINE HOW                             DBU00970
       STA     BUFLOC         MANY WORDS                                DBU00980
       CAL*    BIN            TO MOVE AND                               DBU00990
       ADD     REC00          WHERE TO                                  DBU01000
       STA     BINLOC         MOVE THEM TO.                             DBU01010
       STA     EEK                                                      DBU01020
       ZET     OPT03                                                    DBU01030
       ADD     =1                                                       DBU01040
       STA     SUMS                                                     DBU01050
       STA     SUM                                                      DBU01060
       CLA     BIN                                                      DBU01070
       ADD     =1                                                       DBU01080
       STO     BIN                                                      DBU01090
       ENB     =0                                                       DBU01100
BUFLOC CLA     **,4          MOVE THE                                   DBU01110
BINLOC STO     **,4           RECORD TO                                 DBU01120
       TIX     BUFLOC,4,1     THE BINS.                                 DBU01130
       CLA     BUFLOC                                                   DBU01140
       STA     MOVER                                                    DBU01150
       ENB*    (TRAPX                                                   DBU01160
INSERT NZT     OPT03                                                    DBU01170
       TRA     NOEEK                                                    DBU01180
       CLA     EQ                                                       DBU01190
       ADD     =1                                                       DBU01200
       STO     EQ                                                       DBU01210
EEK    STO     **                                                       DBU01220
NOEEK  NZT     OPT01                                                    DBU01230
       TRA     DECR                                                     DBU01240
       LXA     REC00,2                                                  DBU01250
       ZET     OPT03                                                    DBU01260
       TXI     *+1,2,1                                                  DBU01270
       ZAC                                                              DBU01280
SUM    ACL     **,2                                                     DBU01290
       TIX     *-1,2,1                                                  DBU01300
SUMS   SLW     **                                                       DBU01310
DECR   TXI     *+1,1,-1                                                 DBU01320
       SXD     RECMOV,1                                                 DBU01330
ALL    CLA     CNT14                                                    DBU01340
       ADD     =1                                                       DBU01350
       STO     CNT14                                                    DBU01360
CHECK  NZT     CLN                                                      DBU01370
       TRA     TAGS                                                     DBU01380
OLD    NZT     RDSWCH        IS THE PREVIOUS READ DONE...               DBU01390
       TRA     IN            NO.                                        DBU01400
       NZT     DPSW                                                     DBU01410
       TRA     FILE                                                     DBU01420
       CALL    DEBLK                                                    DBU01430
DPSW   PZE     **,,**                                                   DBU01440
       STZ     *-1                                                      DBU01450
       TSX     UNITSM,4                                                 DBU01460
       TSX     MSGSUP,4,2                                               DBU01470
               1                                                        DBU01480
               DPMSG,,4+DBLSP                                           DBU01490
FILE   ZET     NDF                                                      DBU01500
       TRA     END                                                      DBU01510
       NZT     CLN           SHOULD THE BUFFER BE CLEANED...            DBU01520
       TRA     OUT           YES.                                       DBU01530
       CLA     LENTH                                                    DBU01540
       ADD     BOT                                                      DBU01550
       SUB     POSTE                                                    DBU01560
       TPL     SEABEE                                                   DBU01570
       STZ     SWA           YES                                        DBU01580
NTW    CLA*    CHA00         FIND THE LOCATION OF THE UCB AND           DBU01590
       STA     LOC            SAVE IT IN LOC AND IN                     DBU01600
       PAC     ,2             INDEX REGISTER 2.                         DBU01610
       CLA     3,2           SET THE                                    DBU01620
       STA     READS          READ SELECT INSTRUCTION.                  DBU01630
       ENB     =0            DISABLE TRAPS                              DBU01640
       CLA     ,2                                                       DBU01650
       ARS     9                                                        DBU01660
       ANA     =O17000000                                               DBU01670
       PDC     ,1                                                       DBU01680
       TXI     *+1,1,1                                                  DBU01690
       ZET*    (CHXAC                                                   DBU01700
       TRA     *-1                                                      DBU01710
       CAL     SEL           PUT ADDRESS OF SELECT ROUTINE IN           DBU01720
       SLW     1,2            DECREMENT OF UCW2.                        DBU01730
       STZ     RDSWCH        INDICATE READ IS TAKING PLACE.             DBU01740
       TSX     (ACTIV,4      CALL (ACTIV.                               DBU01750
       PZE     LOC           THIS INFORMATION IS FOR (ACTIV.            DBU01760
SWCHB  TRA     *+1           IF NOT FIRST TIME THROUGH, TRANSFER TO IN. DBU01770
       CLA     SWCHX         SET                                        DBU01780
       STA     SWCHB          SWCHB.                                    DBU01790
WON    AXT     **,1          RESTORE THE                                DBU01800
TOO    AXT     **,2           INDEX REGISTERS AND                       DBU01810
FOR    AXT     **,4          RETURN TO                                  DBU01820
       TRA     1,4            THE MAIN PROGRAM.                         DBU01830
END    STZ     NDF           RESET THE INTERNAL END OF FILE SWITCH.     DBU01840
       STZ     RAW00         INDICATE THAT THE FILE IS INPUT.           DBU01850
       CALL    SCL           CLOSE THE OLD INPUT FILE.                  DBU01860
       TRA     *+2                                                      DBU01870
                             THIS CELL NON-ZERO MEANS LAST READ.        DBU01880
       NZT     OPT02         IS THE NON-CHECKPOINT OPTION TAKEN...      DBU01890
       CALL    CKPT          NO.                                        DBU01900
       NZT     *-3           ARE THERE MORE REELS...                    DBU01910
       TRA     *+3           YES.                                       DBU01920
       STZ     CLN           NO.                                        DBU01930
       TRA     IN                                                       DBU01940
       STZ     RAW00         YES. INDICATE THAT THE FILE IS INPUT.      DBU01950
       CALL    IOPEN         OPEN THE NEW INPUT FILE.                   DBU01960
       STL     CLN           RESET THE CLEANUP SWITCH.                  DBU01970
       TRA     IN                                                       DBU01980
TAGS   CLA     ERA24                                                    DBU01990
       ALS     18                                                       DBU02000
       ADD     ERA23                                                    DBU02010
       STA     RECMOV                                                   DBU02020
       SUB     RECMOV         THE BEGINNINGS AND                        DBU02030
       STD     ERA23                                                    DBU02040
       SXA     ERA24,1                                                  DBU02050
       TRA     OLD                                                      DBU02060
OUT    CLA     BOT                                                      DBU02070
       SUB     MOVER                                                    DBU02080
       CAS     REC00                                                    DBU02090
       TRA     IN                                                       DBU02100
       TRA     IN                                                       DBU02110
       CLA     TOP                                                      DBU02120
       SUB     BEGIN                                                    DBU02130
       CAS     REC00                                                    DBU02140
       TRA     IN                                                       DBU02150
       TRA     IN                                                       DBU02160
       STL     RAW03                                                    DBU02170
       TRA     WON                                                      DBU02180
SEABEE CLA     LENTH                                                    DBU02190
       ADD     TOP                                                      DBU02200
       SUB     MOVER                                                    DBU02210
       TPL     IN                                                       DBU02220
       STL     SWA           YES.                                       DBU02230
       TRA     NTW                                                      DBU02240
BEG    SXA     SWON,1        SAVE THE                                   DBU02250
       SXA     STOO,2         CONTENTS OF                               DBU02260
       SXA     SFOR,4         THE INDEX REGISTERS                       DBU02270
       SXA     WWON,1                                                   DBU02280
       SXA     TTOO,2                                                   DBU02290
       SXA     FFOR,4                                                   DBU02300
       LDQ     (COMMM                                                   DBU02310
       ZET     HYPER                                                    DBU02320
       RQL     18                                                       DBU02330
       STQ     COM                                                      DBU02340
       TMI     SELMIN        GO TO SELECT MINUS.                        DBU02350
       ZET     NPR           WAS THERE A NON-PERMANENT REDUNDANCY...    DBU02360
       TRA     NONP          YES.                                       DBU02370
       STL     NPR           NO. RESET THE SWITCH.                      DBU02380
       LAC     LENTH,1       FIND THE NUMBER OF WORDS PER BLOCK.        DBU02390
       LXA     BOT,4                                                    DBU02400
       ZET     SWA                                                      DBU02410
       LXA     TOP,4                                                    DBU02420
       SXD     RSTAR,4                                                  DBU02430
       SXD     RSTART,4                                                 DBU02440
       SXD     FINDLT,4                                                 DBU02450
LOCRD  SXA     RDTBL,4                                                  DBU02460
       SXA     *+2,4                                                    DBU02470
       CLA     CHK           INSERT THE                                 DBU02480
       STO     **,1           CHECKWORD.                                DBU02490
       LXA     LENTH,2       FIND THE                                   DBU02500
       TXI     *+1,2,1        BLOCKLENGTH AND                           DBU02510
       SXD     RDTBL,2        INSERT IT IN THE I/O COMMAND.             DBU02520
       LXA     SWON,1        RESET INDEX REGISTER 1 FOR (RCHXI.         DBU02530
NONP   NZT     HYPER         PROCEDE IF                                 DBU02540
       TRA     READY          NOT HYPER.                                DBU02550
       CLA*    LOC           OTHERWISE                                  DBU02560
       ANA     =O17000000     SET                                       DBU02570
       PDX     ,4             SELECT ORDER FOR                          DBU02580
       TXI     *+1,4,8576     THE CORRECT                               DBU02590
       SXD     SELECT,4       UNIT AND                                  DBU02600
       CLA     LOCTL         PREPARE TO                                 DBU02610
       TRA     *+2            READ.                                     DBU02620
READY  CLA     LOCRD         SET THE                                    DBU02630
       STA*    (RCHXI         RCHX COMMAND.                             DBU02640
       NZT     HYPER                                                    DBU02650
READS  RDS     **            BEGIN TO                                   DBU02660
       XEC*    (RCHXI         READ.                                     DBU02670
SWON   AXT     **,1          RESTORE THE                                DBU02680
STOO   AXT     **,2           CONTENTS OF                               DBU02690
SFOR   AXT     **,4           THE INDEX REGISTERS.                      DBU02700
       TRA     1,4           RETURN TO THE MAIN PROGRAM OR IOEX.        DBU02710
SELMIN STZ     NPR           RESET SWITCH.                              DBU02720
       PAC     ,1            PUT THE LOCATION OF THE UCB IN IR1.        DBU02730
       ZET     HYPER         IF HYPER USE                               DBU02740
       TRA     RHTEST         OTHER END OF FILE TEST.                   DBU02750
       LFT     200000        WAS THERE AN END OF FILE...                DBU02760
       TRA     EOFILE        YES.                                       DBU02770
       LDC     (COMMM,4                                              (6)DBU02771
       CAL     (COMMM                                                (6)DBU02772
       ORA     FOUR                                                  (6)DBU02773
       SBM     -1,4                                                  (6)DBU02774
       PAX     0,4                                                   (6)DBU02775
       TXH     *+2,4,2                                               (6)DBU02776
       RIL     400000                                                (6)DBU02777
       LNT     400000                                                (4)DBU02780
       TRA     NOISE                                                 (4)DBU02790
       LFT     100000                                                (4)DBU02800
       TRA     REDCY                                                 (4)DBU02810
SHRT   LXA     COM,4                                                    DBU02820
SHTST  TIX     *+1,4,**                                                 DBU02830
RSTAR  TXH     REDCY,4,**                                               DBU02840
       TXI     *+1,4,1                                                  DBU02850
RSTART TXH     NORML,4,**                                               DBU02860
       NZT     OPT05                                                    DBU02870
       TRA     REDCY                                                    DBU02880
       LXA     COM,4                                                    DBU02890
FINDLT TIX     *+1,4,**                                                 DBU02900
       ZET     TRLPRS                                                   DBU02910
       TXI     *+1,4,-1                                                 DBU02920
       PXA     ,4                                                       DBU02930
       XCA                                                              DBU02940
       ZAC                                                              DBU02950
       DVP     RECPR                                                    DBU02960
       TNZ     REDCY                                                    DBU02970
       TRA     TWORDS                                                   DBU02980
REDCY  CLA     LOCRD                                                    DBU02990
       STA     DPSW                                                     DBU03000
       AXT     1,2           TELL DEBLK TO INTERPRET ONLY 1 WORD        DBU03010
       SXD     DPSW,2         AT LOCATION POINTED TO BY DPSW ADDRESS.   DBU03020
       STL     RDSWCH                                                   DBU03030
       STZ     1,1                                                      DBU03040
       LAC     RDTBL,1       COMPUTE LENGTH OF BLOCK ACTUALLY READ AND  DBU03050
       SXD     *+2,1          PLACE IT IN WORD WHICH DEBLK WILL INTERP- DBU03060
       LXA     COM,2          RET FOR DUMPING THE BAD BLOCK.            DBU03070
       TXI     *+1,2,**      (DECR. HAS -LOC. OF BAD BLOCK)             DBU03080
       SXD     RDTBL,2       INITIALIZE WITH LENGTH OF BAD BLOCK.       DBU03090
       TRA     SWON          LEAVE SEL(-). CTRL ROUTINE WILL CALL DEBLK.DBU03100
NORML  ZET     HYPER         IF HYPER, USE                              DBU03110
       TRA     LHTEST         OTHER REDUNDANCY TEST.                    DBU03120
       LFT     100000        WAS THERE A PERMANENT REDUNDANCY...        DBU03130
       TRA     REDCY         YES.                                       DBU03140
TWORDS PXD     0,0                                                      DBU03150
       ZET     TRLPRS                                                   DBU03160
       TSX     WORDS,4                                                  DBU03170
       ADD     COM                                                      DBU03180
       ZET     SWA                                                      DBU03190
       TRA     BPT                                                      DBU03200
       STA     BOT                                                      DBU03210
ROOM   CLA     LENTH                                                    DBU03220
       ADD     BOT                                                      DBU03230
       SUB     POSTE                                                    DBU03240
       TPL     BEESEA                                                   DBU03250
       STZ     SWA           YES. TURN OFF                              DBU03260
       STZ     DPSW                                                     DBU03270
       TRA     SWON           SWA AND EXIT.                             DBU03280
BEESEA CLA     LENTH                                                    DBU03290
       ADD     TOP                                                      DBU03300
       SUB     MOVER                                                    DBU03310
       TPL     SEADEE                                                   DBU03320
LCTN   STL     SWA           YES. TURN ON                               DBU03330
       STZ     DPSW                                                     DBU03340
       TRA     SWON           SWA AND EXIT.                             DBU03350
SEADEE CLA     MOVER                                                    DBU03360
       SUB     BOT                                                      DBU03370
       TPL     EEBEE                                                    DBU03380
       STL     RDSWCH        NO. INDICATE COMPLETION OF READ.           DBU03390
       STZ     1,1           RELEASE UNIT.                              DBU03400
       TRA     LCTN          TURN ON SWA AND EXIT.                      DBU03410
EEBEE  CLA     TOP                                                      DBU03420
       STO     BOT                                                      DBU03430
       CLA     BEGIN                                                    DBU03440
       STO     TOP                                                      DBU03450
       STO     MOVER                                                    DBU03460
       TRA     ROOM          TRY TO READ AGAIN.                         DBU03470
RHTEST RFT     000010        TEST FOR                                   DBU03480
       TRA     EOFILE         END OF                                    DBU03490
       TRA     SHRT           FILE.                                     DBU03500
LHTEST LFT     000010        TEST FOR                                   DBU03510
       TRA     REDCY          A                                         DBU03520
       TRA     TWORDS                                                   DBU03530
EOFILE STL     NDF           INDICATE END OF FILE.                      DBU03540
       STZ     DPSW                                                     DBU03550
       STZ     1,1           RELEASE UNIT.                              DBU03560
       STL     RDSWCH        INDICATE COMPLETION OF READ.               DBU03570
       TRA     SWON          EXIT.                                      DBU03580
NOISE  STZ     DPSW                                                     DBU03590
WWON   AXT     **,1                                                     DBU03600
TTOO   AXT     **,2                                                     DBU03610
FFOR   AXT     **,4                                                     DBU03620
       TRA     2,4                                                      DBU03630
BPT    STA     TOP                                                      DBU03640
       TRA     ROOM                                                     DBU03650
WORDS  SXA     SAVE4,4                                                  DBU03660
       LAC     RDTBL,4                                                  DBU03670
       SXD     *+2,4                                                    DBU03680
       LXA     COM,2                                                    DBU03690
       TXI     *+1,2,**                                                 DBU03700
       SXA     HWLNG,2                                                  DBU03710
       CAL     COM                                                      DBU03720
       SUB     =1                                                       DBU03730
       STA     SUMUP                                                    DBU03740
       STA     BBASE                                                    DBU03750
       LAC     FIL00,4                                                  DBU03760
       NZT     -8,4                                                     DBU03770
       TRA     SUMOK                                                    DBU03780
       LXA     HWLNG,4                                                  DBU03790
       TXI     *+1,4,-1                                                 DBU03800
       PXD     ,0                                                       DBU03810
SUMUP  ACL     **,4                                                     DBU03820
       TIX     *-1,4,1                                                  DBU03830
       LGR     18                                                       DBU03840
       STZ     TEMP                                                     DBU03850
       SLQ     TEMP                                                     DBU03860
       ALS     18                                                       DBU03870
       ACL     TEMP                                                     DBU03880
       LBT                                                              DBU03890
       TRA     *+2                                                      DBU03900
       ACL     =O1000000                                                DBU03910
       ERA*    BBASE                                                    DBU03920
       ANA     =O777777000000                                           DBU03930
       TZE     SUMOK                                                    DBU03940
       TSX     UNITSM,4                                                 DBU03950
       TSX     MSGSUP,4,2                                               DBU03960
               1                                                        DBU03970
               CKMSG,,4+DBLSP                                           DBU03980
SUMOK  LAC     FIL00,4                                                  DBU03990
       NZT     -9,4                                                     DBU04000
       TRA     SEQOK                                                    DBU04010
       CAL*    CHA00                                                    DBU04020
       PAC     ,2                                                       DBU04030
       CAL     2,2                                                      DBU04040
       ERA*    BBASE                                                    DBU04050
       PAX     ,4                                                       DBU04060
       TXL     SEQOK,4,0                                                DBU04070
       CLA*    BBASE                                                    DBU04080
       TSX     (DECVA,4                                                 DBU04090
       STQ     SEQMSG+4                                                 DBU04100
       TSX     MSGSUP,4,2                                               DBU04110
               1                                                        DBU04120
               SEQMSG,,6+DBLSP                                          DBU04130
       CLA*    BBASE                                                    DBU04140
       STA     2,2                                                      DBU04150
SEQOK  CLS     =1                                                       DBU04160
SAVE4  AXT     **,4                                                     DBU04170
       TRA     1,4                                                      DBU04180
UNITSM SXA     RESTOR,4                                                 DBU04190
       CAL*    CHA00                                                    DBU04200
       PAC     ,2                                                       DBU04210
       CAL     2,2                                                      DBU04220
       TSX     (DECVA,4                                                 DBU04230
       STQ     UNTMSG+4                                                 DBU04240
       CAL     2,2                                                      DBU04250
       TSX     (DECVD,4                                                 DBU04260
       STQ     UNTMSG+1                                                 DBU04270
       LDQ     ,2                                                       DBU04280
       TSX     MSGSUP,4,3                                               DBU04290
               UNTMSG,,5                                                DBU04300
RESTOR AXT     **,4                                                     DBU04310
       TRA     1,4                                                      DBU04320
OPTPR  COMMON  15                                                       DBU04330
OVEPR  COMMON  2                                                        DBU04340
LABPR  COMMON  5                                                        DBU04350
CHAPR  COMMON  6                                                        DBU04360
FILPR  COMMON  14                                                       DBU04370
MODPR  COMMON  50                                                       DBU04380
RECPR  COMMON  10                                                       DBU04390
DELPR  COMMON  2                                                        DBU04400
SAMPR  COMMON  7                                                        DBU04410
CALPR  COMMON  50                                                       DBU04420
GENPR  COMMON  10                                                       DBU04430
RAWPR  COMMON  30                                                       DBU04440
CNTPR  COMMON  20                                                       DBU04450
ERAPR  COMMON  30                                                       DBU04460
REFPR  COMMON  1                                                        DBU04470
NDF    EQU     RAWPR-24      ZERO IF NO EOF, NONZERO IF END OF FILE.    DBU04480
RDSWCH EQU     RAWPR-2                                                  DBU04490
CHA00  EQU     CHAPR                                                    DBU04500
CNT03  EQU     CNTPR-3                                                  DBU04510
CNT14  EQU     CNTPR-14                                                 DBU04520
DEL00  EQU     DELPR                                                    DBU04530
ERA00  EQU     ERAPR                                                    DBU04540
ERA11  EQU     ERAPR-11                                                 DBU04550
ERA21  EQU     ERAPR-21                                                 DBU04560
ERA23  EQU     ERAPR-23                                                 DBU04570
ERA24  EQU     ERAPR-24                                                 DBU04580
FIL00  EQU     FILPR                                                    DBU04590
OPT01  EQU     OPTPR-1                                                  DBU04600
OPT02  EQU     OPTPR-2                                                  DBU04610
OPT03  EQU     OPTPR-3                                                  DBU04620
OPT05  EQU     OPTPR-5                                                  DBU04630
RAW00  EQU     RAWPR                                                    DBU04640
RAW03  EQU     RAWPR-3                                                  DBU04650
RAW10  EQU     RAWPR-10                                                 DBU04660
REC00  EQU     RECPR                                                    DBU04670
DBLSP  EQU     512*4                                                    DBU04680
MOD05  EQU     MODPR-5                                                  DBU04690
MOVER  EQU     ERAPR-4                                                  DBU04700
BIN    EQU     ERAPR-5                                                  DBU04710
       EXTERN  MSGSUP                                                   DBU04720
COM                                                                     DBU04730
CLN    OCT     -1                                                       DBU04740
CHK    OCT     171717171717                                             DBU04750
FOUR   FOR                                                           (6)DBU04755
LOCTL          MODE                                                     DBU04760
MODE   SMS     70                                                       DBU04770
       LIPT    *+1                                                      DBU04780
       CTLR    SELECT                                                   DBU04790
RDTBL  IORT    **,,**                                                   DBU04800
       TCH     SYSTWT                                                   DBU04810
RDABL  CPYD    **,,**                                                   DBU04820
SELECT OCT     120600120112                                             DBU04830
SEL            ,,BEG                                                    DBU04840
SWCHX          IN                                                       DBU04850
SWCHY          GO                                                       DBU04860
DPMSG  BCI     4,UNRDBL BLK DUMPED *RD01                                DBU04870
CKMSG  BCI     4,INPUT CHKSM ERROR *RD02                                DBU04880
SEQMSG BCI     6,INPUT BLOCK SEQ ERROR - XXXXXX *RD03                   DBU04890
UNTMSG BCI     5, FILE XXXXXX,    RECORD XXXXXX                         DBU04900
BBASE                                                                   DBU04910
BEGIN                        LOCATION OF FIRST CELL OF BUFFER.          DBU04920
POSTE                        LOCATION OF FIRST CELL AFTER BUFFER.       DBU04930
TOP                          LOCATION OF LAST RECORD IN TOP OF BUFFER.  DBU04940
BOT                          LOCATION OF LAST RECORD IN BOTTOM.         DBU04950
EQ                                                                      DBU04960
HWLNG                                                                   DBU04970
HYPER                                                                   DBU04980
LOC                                                                     DBU04990
LENTH                                                                   DBU05000
NPR                                                                     DBU05010
PLACE                                                                   DBU05020
RECMOV                                                                  DBU05030
SAVE                                                                    DBU05040
SWA                                                                     DBU05050
TEMP   PZE                                                              DBU05060
TRLPRS                                                                  DBU05070
       END                                                              DBU05080
*  7090/94 SORT, VER 7, MOD 0.  EXTRACT CONTROL FIELDS                  DEX00000
*      FAP
       COUNT   500                                                      DEX00010
       PCC     ON                                                       DEX00020
       ENTRY   XTRACT                                                   DEX00030
       ENTRY   MERXTR                                                   DEX00040
       ENTRY   MREXNM                                                   DEX00050
       ENTRY   MREXIV                                                   DEX00060
       SST                                                              DEX00070
XTRACT SXA     EXIT,1       ENTRY FROM PHASE 1                          DEX00080
       LXD     ERAPR-9,1    CALLING SEQ WORD                            DEX00090
       PXA     0,1                                                      DEX00100
       ADM     ERAPR-9                                                  DEX00110
       STA     E1                                                       DEX00120
       STD     NOREC                                                    DEX00130
       STZ     E90                                                      DEX00140
       TRA     E88                                                      DEX00150
MERXTR SXA     EXIT,1       ENTRY FROM PH 2 OR 3                        DEX00160
       LXD     ERAPR-9,1                                                DEX00170
       NZT     OPTPR-3       TEST FOR EQUALS OPTION                     DEX00180
       TRA     *+3           NOT GIVEN                                  DEX00190
       ZET     RECPR-5       TEST FOR FIXED OR VARIABLE                 DEX00200
       TXI     *+1,1,-1      CHANGE LOCATION FOR EXTRACTED C F          DEX00210
       SXA     E22,1                                                    DEX00220
       AXT     1,1                                                      DEX00230
       SXD     NOREC,1                                                  DEX00240
       STL     E90                                                      DEX00250
E88    SXA     EXIT+1,2                                                 DEX00260
       SXA     EXIT+2,4                                                 DEX00270
E5     CAL     SAMPR-3                                                  DEX00280
       PAC     0,4          ADDRESS OF CF INFO BLOCK                    DEX00290
       STD     NCF                                                      DEX00300
       CAL     CALPR-12                                                 DEX00310
       STA     NWDS                                                     DEX00320
       NZT     E90                                                      DEX00330
       TRA     E4                                                       DEX00340
E55    CAL     ERAPR-9                                                  DEX00350
       TRA     E93                                                      DEX00360
E4     PAI                                                              DEX00370
       LXD     NOREC,1                                                  DEX00380
E1     CAL     **,1         GET A TABLE ENTRY                           DEX00390
       STA     E22                                                      DEX00400
E93    ANA     =O77777                                                  DEX00410
       STA     E30                                                      DEX00420
       ADD     0,4          LAST WORD + 1 OF CF, CODE, NO OF WORDS IN CFDEX00430
       STA     E2                                                       DEX00440
       PDX     0,1                                                      DEX00450
       ALS     3                                                        DEX00460
       ANA     =O7000000                                                DEX00470
       PDX     0,2          CODE                                        DEX00480
       STZ     E80          NOT BCD ALG                                 DEX00490
       TXL     *+2,2,3                                                  DEX00500
       STL     E80          BCD ALG                                     DEX00510
       PIA                                                              DEX00520
       TRA     LOGAS-1,2                                                DEX00530
E2     LDQ     **,1         TO GET WORD OF CF                           DEX00540
       TRA     BCDDE                                                    DEX00550
       TRA     BCDAS                                                    DEX00560
       TRA     ALGDE        BINARY                                      DEX00570
       TRA     ALGAS                                                    DEX00580
       TRA     LOGDE                                                    DEX00590
       TRA     LOGAS                                                    DEX00600
LOGAS  XEC     E2           GET FIRST WORD                              DEX00610
       XEC     -1,4         RQL SB                                      DEX00620
       ZET     SAMPR                                                    DEX00630
       CRQ     TABLE,,6                                                 DEX00640
       LXA     NWDS,2                                                   DEX00650
       TNX     LAST,1,1     IF ONLY ONE WORD                            DEX00660
       XEC     -2,4         LGL E0                                      DEX00670
       NZT     -3,4                                                     DEX00680
       TRA     E20                                                      DEX00690
       XEC     E22          SLW                                         DEX00700
       TXI     *+1,2,-1                                                 DEX00710
       XEC     -3,4         LGL 36 - SB - E0                            DEX00720
E20    XEC     E2           GET A WORD                                  DEX00730
       TXH     *+3,1,1                                                  DEX00740
       ZET     E80                                                      DEX00750
       LDQ     LASTWD                                                   DEX00760
       ZET     SAMPR                                                    DEX00770
       CRQ     TABLE,,6                                                 DEX00780
       TNX     LAST,1,1     IF LAST WORD                                DEX00790
       XEC     -4,4         LGL E0                                      DEX00800
E22    SLW     **,2                                                     DEX00810
       XEC     -5,4         LGL 36-E0                                   DEX00820
       TXI     E20,2,-1                                                 DEX00830
LAST   XEC     -6,4         LGL E0                                      DEX00840
       NZT     -7,4                                                     DEX00850
       TRA     E21                                                      DEX00860
       XEC     E22                                                      DEX00870
       TXI     *+1,2,-1                                                 DEX00880
       XEC     -7,4                                                     DEX00890
E21    LXD     NCF,1        CHECK FOR MORE CF                           DEX00900
       TNX     OUT,1,1                                                  DEX00910
       SXD     NCF,1                                                    DEX00920
       SXA     NWDS,2                                                   DEX00930
       NZT     E90                                                      DEX00940
       TXI     E4,4,9                                                   DEX00950
       PAI                                                              DEX00960
       TXI     E55,4,9                                                  DEX00970
OUT    NZT     -9,4         LGL E0                                      DEX00980
       TRA     E23A                                                     DEX00990
       XEC     -9,4                                                     DEX01000
       XEC     E22                                                      DEX01010
E23A   ZET     RECPR-5      TEST FOR FIXED/VARIABLE                     DEX01020
       NZT     E90          VARIABLE, TEST PHASE                        DEX01030
       TRA     E24           FIXED, OR VARIABLE PHASE 1                 DEX01040
       NZT     OPTPR-3      PHASE 2 OR 3, TEST FOR EQUALS               DEX01050
       TRA     E23          NO EQUALS                                   DEX01060
       CLA*    ERAPR-9      GET SEQ WORD                                DEX01070
       ZET     ERAPR-19                                                 DEX01080
       COM                                                              DEX01090
       AXT     0,2                                                      DEX01100
       XEC     E22                                                      DEX01110
E23    LXD     NOREC,1      TEST FOR MORE RECORDS                       DEX01120
       TNX     EXIT,1,1                                                 DEX01130
       SXD     NOREC,1                                                  DEX01140
       TRA     E5                                                       DEX01150
EXIT   AXT     **,1                                                     DEX01160
       AXT     **,2                                                     DEX01170
       AXT     **,4                                                     DEX01180
       TRA     1,4                                                      DEX01190
E24    NZT     RECPR-5       TEST FOR FIXED/VARIABLE                    DEX01200
       NZT     OPTPR-3       FIXED, CHECK FOR EQUALS                    DEX01210
       TRA     E23           VARIABLE OR NO EQUALS                      DEX01220
       CLA     E30                                                      DEX01230
       ADD     RECPR                                                    DEX01240
       STA     *+1                                                      DEX01250
       CAL     **            MOVE EQUALS WORD                           DEX01260
       ZET     ERAPR-19                                                 DEX01270
       COM                                                              DEX01280
       AXT     1,2                                                      DEX01290
       XEC     E22                                                      DEX01300
       TRA     E23                                                      DEX01310
LOGDE  XEC     E2                                                       DEX01320
       XEC     -1,4                                                     DEX01330
       ZET     SAMPR                                                    DEX01340
       CRQ     TABLE,,6                                                 DEX01350
       LXA     NWDS,2                                                   DEX01360
       XCL                                                              DEX01370
       COM                                                              DEX01380
       XCL                                                              DEX01390
       TNX     LAST,1,1                                                 DEX01400
       XEC     -2,4                                                     DEX01410
       NZT     -3,4                                                     DEX01420
       TRA     E20D                                                     DEX01430
       XEC     E22                                                      DEX01440
       TXI     *+1,2,-1                                                 DEX01450
       XEC     -3,4                                                     DEX01460
E20D   XEC     E2           GET A WORD                                  DEX01470
       TXH     *+3,1,1                                                  DEX01480
       ZET     E80                                                      DEX01490
       LDQ     LASTWD                                                   DEX01500
       ZET     SAMPR                                                    DEX01510
       CRQ     TABLE,,6                                                 DEX01520
       XCL                                                              DEX01530
       COM                                                              DEX01540
       XCL                                                              DEX01550
       TNX     LAST,1,1                                                 DEX01560
       XEC     -4,4                                                     DEX01570
       XEC     E22                                                      DEX01580
       XEC     -5,4                                                     DEX01590
       TXI     E20D,2,-1                                                DEX01600
ALGAS  XEC     E2                                                       DEX01610
       XEC     -1,4                                                     DEX01620
       TQP     PLUS                                                     DEX01630
       TRA     LOGDE+2                                                  DEX01640
PLUS   SSM                                                              DEX01650
       LRS     0                                                        DEX01660
       TRA     LOGAS+2                                                  DEX01670
ALGDE  XEC     E2                                                       DEX01680
       XEC     -1,4                                                     DEX01690
       TQP     PLUS1                                                    DEX01700
       TRA     LOGAS+2                                                  DEX01710
PLUS1  SSM                                                              DEX01720
       LRS     0                                                        DEX01730
       TRA     LOGDE+2                                                  DEX01740
BCDAS  STZ     E900                                                     DEX01750
       STL     E80                                                      DEX01760
       SXA     E60,1        GET LAST WORD OF CF                         DEX01770
       AXT     1,1                                                      DEX01780
       XEC     E2                                                       DEX01790
       XEC     -8,4         RQL LB-5                                    DEX01800
       XCL                                                              DEX01810
       PAI                                                              DEX01820
       STZ     E61                                                      DEX01830
       LFT     400000                                                   DEX01840
       STL     E61          MINUS                                       DEX01850
       LNT     120000       PLUS, TEST FOR BCD ZERO                     DEX01860
       TRA     *+2                                                      DEX01870
       RIL     770000       GET TRUE ZERO                               DEX01880
       RIL     600000       RESET SIGN                                  DEX01890
       CLA     -8,4                                                     DEX01900
       PAX     0,1                                                      DEX01910
       PIA                                                              DEX01920
       XCL                                                              DEX01930
       RQL     36,1         ROTATE WORD TO ORIGINAL POSITION            DEX01940
       STQ     LASTWD                                                   DEX01950
E60    AXT     **,1                                                     DEX01960
       TXL     E660,1,1     IF 1 WORD                                   DEX01970
       XEC     E2           GET FIRST WRD                               DEX01980
E660   XEC     -1,4                                                     DEX01990
E66    SSM                                                              DEX02000
       ZET     E61                                                      DEX02010
       LRS     0                                                        DEX02020
       ZET     E900                                                     DEX02030
       TRA     ALGDE+2                                                  DEX02040
       TRA     ALGAS+2                                                  DEX02050
BCDDE  STL     E900                                                     DEX02060
       TRA     BCDAS+1                                                  DEX02070
MREXNM SXA     BB,1                                                     DEX02080
B      SXA     BB+1,2                                                   DEX02090
       SXA     BB+2,4                                                   DEX02100
       AXT     6,2                                                      DEX02110
       STZ     ERAPR-29                                                 DEX02120
       LDQ     NORMAL,2                                                 DEX02130
       STQ     LOGAS,2                                                  DEX02140
       TIX     *-2,2,1                                                  DEX02150
BB     AXT     **,1                                                     DEX02160
       AXT     **,2                                                     DEX02170
       AXT     **,4                                                     DEX02180
       TRA     1,4                                                      DEX02190
MREXIV XEC     B-1                                                      DEX02200
       XEC     B                                                        DEX02210
       XEC     B+1                                                      DEX02220
       XEC     B+2                                                      DEX02230
       STL     ERAPR-29                                                 DEX02240
       LDQ     INVERS,2                                                 DEX02250
       STQ     LOGAS,2                                                  DEX02260
       TIX     *-2,2,1                                                  DEX02270
       TRA     BB                                                       DEX02280
E30                                                                     DEX02290
E900                        INDICATOR 0=BCDAS, 1=BCDDE                  DEX02300
E90                         PHASE INDICATOR, 0=PH 1, NONZERO=PH2 OR 3   DEX02310
NCF                         NO OF CF                                    DEX02320
NWDS                        TOTAL WORDS IN ALL CF                       DEX02330
NOREC                       NO OF RECORDS                               DEX02340
SAVAC                       SAVE AC                                     DEX02350
E80                         INDICATOR 0=NOT BCD ALG, NONZERO=BCD ALG    DEX02360
LASTWD                      LAST WORD OF BCD FIELD                      DEX02370
E61                         INDICATOR, NONZERO FOR NEGATIVE BCD FIELD   DEX02380
       TRA     BCDDE                                                    DEX02390
       TRA     BCDAS                                                    DEX02400
       TRA     ALGDE                                                    DEX02410
       TRA     ALGAS                                                    DEX02420
       TRA     LOGDE                                                    DEX02430
       TRA     LOGAS                                                    DEX02440
NORMAL BES     0                                                        DEX02450
       TRA     BCDAS                                                    DEX02460
       TRA     BCDDE                                                    DEX02470
       TRA     ALGAS                                                    DEX02480
       TRA     ALGDE                                                    DEX02490
       TRA     LOGAS                                                    DEX02500
       TRA     LOGDE                                                    DEX02510
INVERS BES     0                                                        DEX02520
TABLE  FVE     A,,F*2                                                   DEX02530
       FVE     A,,F*3                                                   DEX02540
       FVE     A,,F*4                                                   DEX02550
       FVE     A,,F*5                                                   DEX02560
       FVE     A,,F*6                                                   DEX02570
       FVE     A,,F*7                                                   DEX02580
       SIX     A,,0                                                     DEX02590
       SIX     A,,F                                                     DEX02600
       SIX     A,,F*2                                                   DEX02610
       SIX     A,,F*3                                                   DEX02620
       SIX     A,,F*4                                                   DEX02630
       ONE     A,,F*3                                                   DEX02640
       ONE     A,,F*4                                                   DEX02650
       SIX     A,,F*5                                                   DEX02660
       SIX     A,,F*6                                                   DEX02670
       SIX     A,,F*7                                                   DEX02680
       PZE     A,,F*4                                                   DEX02690
       ONE     A,,F*6                                                   DEX02700
       ONE     A,,F*7                                                   DEX02710
       TWO     A,,0                                                     DEX02720
       TWO     A,,F                                                     DEX02730
       TWO     A,,F*2                                                   DEX02740
       TWO     A,,F*3                                                   DEX02750
       TWO     A,,F*4                                                   DEX02760
       TWO     A,,F*5                                                   DEX02770
       TWO     A,,F*6                                                   DEX02780
       ONE     A,,F*5                                                   DEX02790
       PZE     A,,F                                                     DEX02800
       PZE     A,,F*2                                                   DEX02810
       SVN     A,,0                                                     DEX02820
       SVN     A,,F                                                     DEX02830
       PZE     A,,F*3                                                   DEX02840
       PZE     A,,F*7                                                   DEX02850
       THREE   A,,0                                                     DEX02860
       THREE   A,,F                                                     DEX02870
       THREE   A,,F*2                                                   DEX02880
       THREE   A,,F*3                                                   DEX02890
       THREE   A,,F*4                                                   DEX02900
       THREE   A,,F*5                                                   DEX02910
       THREE   A,,F*6                                                   DEX02920
       THREE   A,,F*7                                                   DEX02930
       FOR     A,,0                                                     DEX02940
       TWO     A,,F*7                                                   DEX02950
       PZE     A,,F*5                                                   DEX02960
       PZE     A,,F*6                                                   DEX02970
       SVN     A,,F*3                                                   DEX02980
       SVN     A,,F*4                                                   DEX02990
       SVN     A,,F*5                                                   DEX03000
       PZE     A,,0                                                     DEX03010
       ONE     A,,0                                                     DEX03020
       FOR     A,,F*2                                                   DEX03030
       FOR     A,,F*3                                                   DEX03040
       FOR     A,,F*4                                                   DEX03050
       FOR     A,,F*5                                                   DEX03060
       FOR     A,,F*6                                                   DEX03070
       FOR     A,,F*7                                                   DEX03080
       FVE     A,,0                                                     DEX03090
       FVE     A,,F                                                     DEX03100
       FOR     A,,F                                                     DEX03110
       ONE     A,,F                                                     DEX03120
       ONE     A,,F*2                                                   DEX03130
       SVN     A,,F*6                                                   DEX03140
       SVN     A,,F*7                                                   DEX03150
       SVN     A,,F*2                                                   DEX03160
*                           END OF CONVERT TABLE                        DEX03170
A      SYN     TABLE                                                    DEX03180
F      SYN     4096                                                     DEX03190
OPTPR  COMMON  15             OPTION CARD PARAMETERS                    DEX03200
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS                   DEX03210
LABPR  COMMON  5             LABEL CARD PARAMETERS                      DEX03220
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS                    DEX03230
FILPR  COMMON  14            FILE CARD PARAMETERS                       DEX03240
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              DEX03250
RECPR  COMMON  10            RECORD CARD PARAMETERS                     DEX03260
DELPR  COMMON  2             DELETE CARD PARAMETERS                     DEX03270
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS             DEX03280
CALPR  COMMON  50            CALCULATED PARAMETERS                      DEX03290
GENPR  COMMON  10            GENERAL PARAMETERS                         DEX03300
RAWPR  COMMON  30             READ AND WRITE PARAMETERS                 DEX03310
CNTPR  COMMON  20            COUNT PARAMETERS                           DEX03320
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS                DEX03330
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER            DEX03340
       END                                                              DEX03350
* 7090/94 SORT VER 7 MOD 5 FIXED INTERNAL SORT PHASE 1               (5)DFX00000
*      FAP
       COUNT   1200                                                     DFX00010
       ENTRY   FXS                                                      DFX00020
       ENTRY   SWCHTP                                                (5)DFX00021
       ENTRY   TAPEND                                                (5)DFX00022
       SST                                                              DFX00030
       TITLE                                                            DFX00040
FXS    SXA     XRC,4                                                    DFX00050
       TXI     *+1,4,-1      ADJUST FOR DELETE RETURN (RESTART TO SORT  DFX00060
       SXD     GEN03,4        MONITOR) AND PLACE IN COMMON.             DFX00070
       SXA     END,2                                                    DFX00080
       AXT     1,1                                                      DFX00090
       SXA     GENPR,1                                                  DFX00100
*                                                                       DFX00110
* INITIALIZE RECORD LENGTH AND EFFECTIVE RECORD LENGTH                  DFX00120
*                                                                       DFX00130
       LXA     RECPR,1       LENGTH OF INPUT RECORD TO SORT.            DFX00140
       SXD     IOSP,1        (IOSP ADDR,1,RL).                          DFX00150
*                                                                       DFX00160
* INITIALIZE ALL M AND -M                                               DFX00170
*                                                                       DFX00180
       LXA     CAL06,1       SIZE FOR PARTIAL SORT LIST (M).            DFX00190
       SXA     M1TUR,1                                                  DFX00200
       SXA     M2TUR,1                                                  DFX00210
*                                                                       DFX00220
* INITIALIZE MERGE ORDER AND MERGE ORDER-1                              DFX00230
*                                                                       DFX00240
       LXA     SAM01,4       MERGE ORDER.                               DFX00250
       SXA     MRGORD,4                                                 DFX00260
       SXD     MORDEC,4                                                 DFX00270
       TXI     *+1,4,-1                                                 DFX00280
       SXD     MRDMN1,4                                                 DFX00290
*                                                                       DFX00300
* INITIALIZE BUFFER AREAS AND/OR L TABLES                               DFX00310
*                                                                       DFX00320
END    AXT     **,1                                                     DFX00330
       PXA     0,1                                                      DFX00340
       ADD     FOUR                                                     DFX00350
       NZT     OPT04         NONZERO = BUFFER OPTION.                   DFX00360
       TRA     NOBUFR                                                   DFX00370
       STA     ERAPR         ADDRESS OF BUFFER.                         DFX00380
       LDQ     CAL06         M                                          DFX00390
       MPY     RECPR         RL                                         DFX00400
       XCA                                                              DFX00410
       ADD     TWO                                                      DFX00420
       ALS     19                                                       DFX00430
       STD     ERAPR         LENGTH OF BUFFER.                          DFX00440
       ARS     18                                                       DFX00450
       ADD     ERAPR                                                    DFX00460
       ADD     TWO                                                      DFX00470
*                                                                       DFX00480
* INITIALIZE L TABLES                                                   DFX00490
*                                                                       DFX00500
NOBUFR STA     ERA01         LOCATION OF L1.                            DFX00510
       ADD     CAL05         L                                          DFX00520
       STA     FILL                                                     DFX00530
       ADD     TWO           LEAVE TWO BLANKS BETWEEN L1 AND L2 TABLE.  DFX00540
       STA     ERA02         LOCATION OF L2.                            DFX00550
       ADD     CAL05         L                                          DFX00560
       ADD     TWO           LEAVE TWO BLANKS BETWEEN L2 AND S TABLE.   DFX00570
*                                                                       DFX00580
* INITIALIZE M1,M2, AND M3 TABLE                                        DFX00590
*                                                                       DFX00600
       STA     M1TOR         LOCATION OF M1 TABLE.                      DFX00610
       ADD     CAL06                                                    DFX00620
       STA     FILLM1                                                   DFX00630
       ADD     TWO                                                      DFX00640
       STA     M2TOR         LOCATION OF M2 TABLE.                      DFX00650
       ADD     CAL06                                                    DFX00660
       STA     FILLM2                                                   DFX00670
       ADD     TWO                                                      DFX00680
       STA     M3TOW         LOCATION OF M3 TABLE.                      DFX00690
       ADD     CAL06                                                    DFX00700
       ADD     TWO                                                      DFX00710
*                                                                       DFX00720
* INITIALIZE LAST RECORD AND MAX. CONTROL FIELD HOLDING AREA            DFX00730
*                                                                       DFX00740
       ADD     CAL12         LENGTH OF ALL CONTROL FIELDS.              DFX00750
       STA     SAVREC+1      BASE ADDRESS OF                            DFX00760
       STA     SAVRCD+1       LRHA WITH SEQ.WORD.                       DFX00770
       STA     *+2                                                      DFX00780
       LXA     CAL12,1                                                  DFX00790
       STZ     **,1          ZERO OUT CONTROL FIELD AREA OF             DFX00800
       TIX     *-1,1,1        THE LAST RECORD HOLDING AREA.             DFX00810
       ADD     ONE                                                      DFX00820
       STA     STARTG                                                   DFX00830
*                                                                       DFX00840
* FILL UP FIRST L TABLE WITH (IOSP BIN ADDR.,1,RL)                      DFX00850
*                                                                       DFX00860
       CLA     CAL08         ERL                                        DFX00870
       ADD     CAL12         LENGTH OF ALL CF.                          DFX00880
       STA     BINLTH                                                   DFX00890
       CAL     STARTG        START OF G AREA.                           DFX00900
       ADD     CAL12         CONTROL FIELD FOR FIRST RECORD.            DFX00910
       STA     IOSP          IOSP  BIN ADDR.,1,RL.                      DFX00920
       LXA     CAL05,1       L.                                         DFX00930
       AXT     0,2                                                      DFX00940
       CAL*    CHAPR                                                    DFX00950
       STA     *+1                                                      DFX00960
       LDI     **                                                       DFX00970
       CAL     IOSP                                                     DFX00980
       LFT     20000                                                    DFX00990
       ANA     =O577777777777                                           DFX01000
FILL   SLW     **,1          (BASE OF FIRST L TABLE).                   DFX01010
       ADD     BINLTH        ERL+WORDS IN CF.                           DFX01020
       TIX     *-2,1,1                                                  DFX01030
*                                                                       DFX01040
* FILL UP M1 AND M2 TABLE WITH (IOSP  BIN ADDR.,1,RL)                   DFX01050
*                                                                       DFX01060
       LXA     CAL06,1       M                                          DFX01070
FILLM1 SLW     **,1          (BASE OF M1).                              DFX01080
       ADD     BINLTH                                                   DFX01090
       TIX     *-2,1,1                                                  DFX01100
       LXA     CAL06,1       M.                                         DFX01110
FILLM2 SLW     **,1          (BASE OF M2).                              DFX01120
       ADD     BINLTH                                                   DFX01130
       TIX     *-2,1,1                                                  DFX01140
*                                                                       DFX01150
* INITIALIZE COMPARE LOOPS IN CASE OF EQUALS OPTION                     DFX01160
*                                                                       DFX01170
       NZT     OPT03         IS THERE EQUALS OPTION.                    DFX01180
       TRA     CKPTST        NO                                         DFX01190
       AXT     COMPAR,1      YES-BINARY SEARCH COMPARE LOOP.            DFX01200
       SXA     LEQS+2,1                                                 DFX01210
       AXT     COMPER+1,1    TWO WAY MERGE COMPARE LOOP.                DFX01220
       SXA     GEQS,1        INTERNAL SORT UNIT COMPARE LOOP.           DFX01230
       AXT     KYLWR1,1                                                 DFX01240
       SXA     XSEQ+1,1                                                 DFX01250
*                                                                       DFX01260
* OPEN CHECKPOINT AND UNREADABLE RECORDS FILES                          DFX01270
*                                                                       DFX01280
CKPTST ZET     CHA05         IS CHECKPOINT TAPE ATTACHED.               DFX01290
       TRA     OPINPT        NO                                         DFX01300
       CLA     CKPTAP        YES-SET UP CALLING SEQ.WORD.               DFX01310
       STO     RAWPR         CKPTAP  MZE 0,,-1                          DFX01320
       CALL    IOPEN                                                    DFX01330
*                                                                       DFX01340
* OPEN INTERNAL SORT INPUT FILES                                        DFX01350
*                                                                       DFX01360
OPINPT CLA     LAB04                                                    DFX01370
       ADD     TWO                                                      DFX01380
       STO     ERA20         GET THE THIRD WORD OF THE LABEL.           DFX01390
       STZ     RAWPR         SET UP CALLING SEQ. WORD.                  DFX01400
       STZ     RAW03         INITIALIZE EOF INDICATOR.                  DFX01410
       CALL    IOPEN                                                    DFX01420
       AXT     1,4                                                      DFX01430
       SXA     COUNT,4                                                  DFX01440
*                                                                       DFX01450
* OPEN INTERNAL SORT OUTPUT FILES                                       DFX01460
*                                                                       DFX01470
       CAL     *             STORE MINUS SIGN IN                        DFX01480
       STP     RAWPR          CALLING SEQ.WORD.                         DFX01490
       LXA     SAM01,2       MERGE ORDER                                DFX01500
       AXT     1,1           STORE FILE NUMBER IN DECREMENT             DFX01510
       SXD     RAW08,1        PART OF THE CALLING SEQUENCE WORD.        DFX01520
       SXD     RAWPR,1        AND INITIALIZE RAW08 BY 1.                DFX01530
       PXD     0,1                                                      DFX01540
       STD*    ERA20                                                    DFX01550
       CALL    IOPEN                                                    DFX01560
       TXI     *+1,1,1       GET NEXT FILE NUMBER AND                   DFX01570
       TIX     *-5,2,1        REPEAT IT FOR ALL FILES.                  DFX01580
*                                                                       DFX01590
       LXA     ERA01,1       L1                                         DFX01600
       SXA     ERA21,1        AS                                        DFX01610
       LXA     CAL05,1        READ                                      DFX01620
       SXD     ERA21,1        TABLE.                                    DFX01630
*                                                                       DFX01640
       ZET     OPT04                                                    DFX01650
       TRA     *+3                                                      DFX01660
       CALL    READ                                                     DFX01670
       TRA     *+2                                                      DFX01680
       CALL    BUFRD                                                    DFX01690
*                                                                       DFX01700
       CLA     ERA21         L1 TO S.                                   DFX01710
       STO     ERA23                                                    DFX01720
M1TOR  AXT     **,1          (LOC.OF M1).                               DFX01730
       SXA     ERA21,1       M1 TO R.                                   DFX01740
M1TUR  AXT     **,1          (LENGTH OF M1).                            DFX01750
       SXD     ERA21,1                                                  DFX01760
M3TOW  AXT     **,1          (LOC.OF M3).                               DFX01770
       SXA     ERA22,1       M3 TO W.                                   DFX01780
*                                                                       DFX01790
GOTORD ZET     OPT04                                                    DFX01800
       TRA     *+3                                                      DFX01810
       CALL    READ                                                     DFX01820
       TRA     *+2                                                      DFX01830
       CALL    BUFRD                                                    DFX01840
*                                                                       DFX01850
       CLA     ERA23                                                    DFX01860
       STO     ERA09                                                    DFX01870
       ZET     MOD25         C.E.MODIFICATION.                          DFX01880
       CALL    DXS01                                                    DFX01890
       CAL     RAW03         IS IT EOF.                                 DFX01900
       TZE     NOTEOF        NO.                                        DFX01910
       CAL     TRA           YES.REPLACE NOP AT                         DFX01920
       STD     MRGDUN         MRGDUN BY (TRA).                          DFX01930
       CAL     NOP           REPLACE TRA AT                             DFX01940
       STD     NOPEOF                                                   DFX01950
       STD     TSTEOF         TSTEOF AND                                DFX01960
       STD     TSTENF         TSTENF BY (NOP).                          DFX01970
NOTEOF LXD     ERA23,4       NO-ANY RECORDS THIS READ.                  DFX01980
       TXH     EXTRCT,4,0    YES-GO TO EXTRCT.                          DFX01990
FSTRID TRA     FRSTIM        NO-IF WHOLE L1 TABLE IS DELETED THEN       DFX02000
       CAL     NOP            (TRA FRSTIM) IS EFFECTIVE OTHERWISE IT    DFX02010
       STD     NOSTAG         WILL BE NOP FOR THE REST OF THE TIME.     DFX02020
       TRA     L1LOC         GO AND INITIALIZE TO MOVE L1 TO L2.        DFX02030
EXTRCT CALL    XTRACT        EXTRACT.                                   DFX02040
       TSX     SORT,4        SORT.                                      DFX02050
FRSTIM NOP     NOWON         NOP FIRST TIME,THEN ON IT IS (TRA NOWON).  DFX02060
       CLA     ERA24         MAKE THE NO.OF DEAD TAGS IN L1             DFX02070
       STO     ERA03          SAME AS THAT IN S.                        DFX02080
       CLA     ERA23         MAKE THE LOC.AND LENGTH OF LIVE TAGS IN    DFX02090
       STO     ERA01         L1 SAME AS THAT IN S.                      DFX02100
       STA     L1LOC                                                    DFX02110
       CAL     CAL06         IS THE SIZE OF W TABLE GREATER             DFX02120
       LAS     ERA03          THAN DEAD TAGS IN L1 TABLE.               DFX02130
TRA    TRA     SBTRCT        YES.                                       DFX02140
       TRA     NOWRTE        NO.                                        DFX02150
       TRA     NOWRTE        NO.                                        DFX02160
SBTRCT SBM     CAL14         (NO.OF TAGS IN 1 MERGE BLOCK).             DFX02170
       LAS     ERA03         IS THE SIZE OF THE REMAINING W             DFX02180
       TRA     SBTRCT         GREATER THAN DEAD TAGS IN L1.  YES.       DFX02190
       TRA     *+1           NO.                                        DFX02200
       ALS     18            NO.                                        DFX02210
       PDC     ,4                                                       DFX02220
       SXD     UPDED,4                                                  DFX02230
       STD     ERA26         GET THE LENGTH OF DEAD TAGS TO BE          DFX02240
       ARS     18             MOVED TO W TABLE.                         DFX02250
       SBM     CAL06         GET THE REMAING SPACE IN W FOR             DFX02260
       PAX     0,4            LIVE TAGS TO BE WRITTEN OUT.              DFX02270
       SXD     ERA27,4                                                  DFX02280
       SXD     WINDEC,4                                                 DFX02290
       LXA     ERA03,4       UPDATE THE NO. OF                          DFX02300
UPDED  TXI     *+1,4,**       DEAD TAGS REMAINING                       DFX02310
       SXA     ERA03,4        IN L TABLE.                               DFX02320
       LXA     ERA01,4       GET THE LOC.OF THE LIVE TAGS               DFX02330
       SXA     ERA27,4        IN L1 TO BE MOVED TO W TABLE.             DFX02340
WINDEC TXI     *+1,4,**                                                 DFX02350
       TXI     *+1,4,-1                                                 DFX02360
       SXA     *+1,4                                                    DFX02370
       CAL     **                                                       DFX02380
       STA     SAVRCD                                                   DFX02390
       TRA     UPDTAP                                                   DFX02400
NOWRTE AXT     0,4           INDICATE                                   DFX02410
       SXD     ERA27,4        ZERO WRITE.                               DFX02420
       LXA     CAL06,4       INDICATE TO MOVE                           DFX02430
       SXD     ERA26,4        M DEAD TAGS TO W.                         DFX02440
       CAL     ERA03         UPDATE THE NO. OF                          DFX02450
       SBM     CAL06          DEAD TAGS REMAINING                       DFX02460
       STA     ERA03          IN L TABLE.                               DFX02470
       CAL*    ERA01                                                    DFX02480
       STA     SAVRCD                                                   DFX02490
TOWRTE LXD     ERA01,4       GET THE LOC.OF THE DEAD TAGS               DFX02500
       PXA     0,4            IN L1 TO BE MOVED                         DFX02510
       ADM     ERA01          TO THE W TABLE.                           DFX02520
       ADM     ERA03                                                    DFX02530
       STA     ERA26                                                    DFX02540
*                                                                       DFX02550
       CALL    WRITE         WRITE.                                     DFX02560
*                                                                       DFX02580
* SAVE LAST RECORD THIS TAPE FOR NEXT GO ROUND                          DFX02590
*                                                                       DFX02600
       LXA     CAL12,4                                                  DFX02610
SAVRCD CLA     **,4          (EFF.ADDR.OF LAST RECORD WRITTEN OUT).     DFX02620
       STO     **,4          (BASE ADDR.OF LRHA WITH SEQ.WORD).         DFX02630
       TIX     *-2,4,1                                                  DFX02640
*                                                                       DFX02650
       CAL     NOP           REPLACE TRA AT                             DFX02660
       STD     NOOP           NOOP AND FSTRID                           DFX02670
       STD     FSTRID         BY (NOP).                                 DFX02680
       CAL     TRA           REPLACE NOP AT                             DFX02690
       STD     FRSTIM         FRSTIM BY (TRA).                          DFX02700
       CLA     ERA21         R TO S.                                    DFX02710
       STA     ERA23                                                    DFX02720
M2TOR  AXT     **,1          (LOC.OF M2)                                DFX02730
       SXA     ERA21,1       M2 TO R.                                   DFX02740
M2TUR  AXT     **,1          (LENGTH OF M2).                            DFX02750
       SXD     ERA21,1                                                  DFX02760
       TRA     GOTORD        GO READ.                                   DFX02770
*                                                                       DFX02780
* INITIALIZATION TO MERGE S AND L1 TABLE.                               DFX02790
*                                                                       DFX02800
NOWON  AXT     TST1O2,4      INITIALIZE                                 DFX02810
       SXA     GOUPL-1,4      THE RETURN                                DFX02820
       SXA     GOUPL-2,4      FROM BINARY SEARCH.                       DFX02830
L1LOC  AXT     **,1          (LOC.OF L1).                               DFX02840
       SXD     LOCDEC,1                                                 DFX02850
       TXI     *+1,1,-1      INITIALIZE THE                             DFX02860
       SXA     COMPAR,1       (LOC.OF L1-1)                             DFX02870
       LXD     ERA01,1        AND                                       DFX02880
       PXA     0,1            THE BASE                                  DFX02890
       ADM     ERA01          OF                                        DFX02900
       STA     L1BASE         L1                                        DFX02910
       STA     COMPER+1       TABLE.                                    DFX02920
       STA     MOVLTG                                                   DFX02930
       SBM     ERA27         INITIALIZE THE                             DFX02940
       ALS     18             (BASE OF L1-WRITE LOC.).                  DFX02950
       STD     TSTHOP                                                   DFX02960
       STD     CHKHOP                                                   DFX02970
       STD     BZLMWL                                                   DFX02980
       CAL     L1BASE        GET THE BASE                               DFX02990
       ADM     ERA03          OF THE DEAD                               DFX03000
       STA     MOVTL2         TAGS IN L1.                               DFX03010
       LXD     ERA23,1       INITIALIZE                                 DFX03020
       SXD     SINDEC,1       THE LENGTH                                DFX03030
       SXD     RDDCR,1        AND                                       DFX03040
       PXA     0,1            THE BASE                                  DFX03050
       ADM     ERA23          OF S.                                     DFX03060
       STA     SBASE                                                    DFX03070
       STA     COMPER+2                                                 DFX03080
       STA     MOVSTG                                                   DFX03090
       ALS     18                                                       DFX03100
       STD     SRTBAS                                                   DFX03110
       LXD     ERA27,1       INITIALIZE                                 DFX03120
       SXD     WRTIND,1       THE                                       DFX03130
       SXD     WTINDC,1       LAST                                      DFX03140
       SXD     WRINDC,1       WRITE.                                    DFX03150
       LDC     ERA27,1                                                  DFX03160
       SXD     WRDCR,1                                                  DFX03170
       SXD     TST1O2+3,1                                               DFX03180
       LXD     ERA01,1       INITIALIZE                                 DFX03190
       SXA     LTHL1,1        L1                                        DFX03200
       SXD     TSTFOR,1       AND                                       DFX03210
       TXI     *+1,1,1        L1+1.                                     DFX03220
       SXA     LPLUS1,1                                                 DFX03230
WRDCR  TXI     *+1,1,**      -(LAST WRITE).                             DFX03240
RDDCR  TXI     *+1,1,**      (LAST READ).                               DFX03250
       TXI     *+1,1,-1                                                 DFX03260
       PXA     0,1                                                      DFX03270
       SXA     LTHL2,1       INITIALIZE                                 DFX03280
       ADM     ERA02          L2                                        DFX03290
       STA     MOVLTG+2       BASE                                      DFX03300
       STA     MOVSTG+2       OF L2.                                    DFX03310
       STA     L2BASE                                                   DFX03320
       STA     TSTHOP+2      INITIALIZE                                 DFX03330
       AXT     CHKHOP,1       CHKHOP,                                   DFX03340
       SXA     L1FINI,1       TSTHOP                                    DFX03350
       AXT     TSTHOP,1       AND                                       DFX03360
       SXA     CHNGAD,1       COMPER.                                   DFX03370
NOSTAG TRA     SRTAGS        IN CASE OF ZERO READ (TRA SRTAGS) IS       DFX03380
       CAL     TRA            NOP,OTHERWISE IT IS (TRA SRTAGS).         DFX03390
       STD     NOSTAG                                                   DFX03400
       LXA     LTHL2,1       PREPARE                                    DFX03410
       LXD     ERA01,2        TO MOVE                                   DFX03420
       PXA     0,2            L1 TO L2.                                 DFX03430
       TRA     NOSRTG                                                   DFX03440
SRTAGS AXT     COMPER,1                                                 DFX03450
       SXA     SFINIS,1                                                 DFX03460
       CLA*    ERA23         GET FIRST SORT TAG FOR                     DFX03470
       STA     FRSRTG         COMPARING IN BINARY SEARCH.               DFX03480
*                                                                       DFX03490
* SET UPPER AND LOWER BOUNDS ON ONE OR TWO PART BINARY SEARCH           DFX03500
*                                                                       DFX03510
       LXA     ERA27,1       IS WRITE AT THE TOP OF L1.                 DFX03520
LOCDEC TNX     WRTPL1,1,**   YES.(L1 LOC.).                             DFX03530
       SXD     UPRLMT,1      NO.(WRITE LOC.-L1 LOC.).                   DFX03540
WRINDC TXI     *+1,1,**      (LENGTH OF LAST WRITE.                     DFX03550
       TXI     *+1,1,1       IS WRITE AT THE BOTTOM OF L1.              DFX03560
TSTFOR TIX     WRBTL1,1,**   (L1). YES.                                 DFX03570
       AXC     2,4           NO-THIS IS TWO WAY MERGE.                  DFX03580
       SXD     TST1O2+1,4                                               DFX03590
       TXI     *+1,4,1                                                  DFX03600
SAMAS2 CAL     UPRLMT        (WRITE LOC.-L1 LOC.).                      DFX03610
       COM                   -(WRITE LOC.-L1 LOC.+1).                   DFX03620
       STD     TSTLMT                                                   DFX03630
       STD     TST1O2+2                                                 DFX03640
       CAL     TRA                                                      DFX03650
       STD     NOPTRA                                                   DFX03660
       TRA     CALMTP                                                   DFX03670
WRTPL1 CAL     NOP           THIS IS ONE WAY MERGE.                     DFX03680
       STD     NOPTRA                                                   DFX03690
       AXC     1,4                                                      DFX03700
       SXD     TST1O2+1,4                                               DFX03710
       SXD     TST1O2+2,4                                               DFX03720
       LDC     ERA27,4                                                  DFX03730
       TXI     CALMTP,4,-1                                              DFX03740
WRBTL1 AXC     1,4           THIS IS ONE WAY MERGE.                     DFX03750
       SXD     TST1O2+1,4                                               DFX03760
       TRA     SAMAS2                                                   DFX03770
       EJECT                                                            DFX03780
*                                                                       DFX03790
* INITIALIZE LIMITING POWER FOR BINARY SEARCH-(2P+4)                    DFX03800
*                                                                       DFX03810
CALMTP AXT     1,1                                                      DFX03820
       CLA     TWO                                                      DFX03830
SHIFT  ALS     1                                                        DFX03840
       CAS     LTHL1         L1                                         DFX03850
       TRA     CALC                                                     DFX03860
       TXI     CALC,1,1                                                 DFX03870
       TXI     SHIFT,1,1                                                DFX03880
CALC   PXA     0,1           P                                          DFX03890
       ALS     1             2P                                         DFX03900
       ADD     FOUR          2P+4                                       DFX03910
       STO     LMTPWR                                                   DFX03920
*                                                                       DFX03930
NOPTRA NOP     SECRND+2      NOP OR TRA DEPENDING FROM WHERE IT COMES.  DFX03940
SECRND LAC     LPLUS1,2                                                 DFX03950
       SXD     TSTLMT,2      UPPER BOUND.                               DFX03960
       SXD     TSTLMT+1,4    LOWER BOUND.                               DFX03970
*                                                                       DFX03980
* BINARY SEARCH                                                         DFX03990
*                                                                       DFX04000
       AXT     0,4                                                      DFX04010
       LXA     LMTPWR,2                                                 DFX04020
       XEC     GODWNL,2                                                 DFX04030
TSTLMT TXL     LGTS,4,**     -(WRITE LOC.-L1 LOC.+1),-(L1+1).           DFX04040
       TXH     LLTS,4,**     -1,-(WRITE LOC.-L1 LOC.+1)-LAST WRITE,     DFX04050
       LXA     CAL12,1        -(LAST WRITE+1).                          DFX04060
COMPAR CAL*    **,4          (L1 LOC.-1).COMPARE L1 TAG WITH FIRST S TAGDFX04070
       LAS*    FRSRTG        (FIRST TAG IN S).                          DFX04080
LGTS   TXI     GOUPL,2,-2    G GREATER THAN FIRST S.                    DFX04090
       TRA     *+2           G EQUAL TO FIRST S.                        DFX04100
LLTS   TXI     GODWNL,2,-2   G LESS THAN FIRST S.                       DFX04110
       TIX     COMPAR,1,1    IN CASE OF EQUALS OPTION                   DFX04120
LEQS   TXI     *+1,1,-1       *+1 IS CHANGED TO COMPAR.                 DFX04130
       TXI     GOUPL,2,-2                                               DFX04140
*                                                                       DFX04150
       TXI     TSTLMT,4,-16384                                          DFX04160
       TXI     TSTLMT,4,8192                                            DFX04170
       TXI     TSTLMT,4,-8192                                           DFX04180
       TXI     TSTLMT,4,4096                                            DFX04190
       TXI     TSTLMT,4,-4096                                           DFX04200
       TXI     TSTLMT,4,2048                                            DFX04210
       TXI     TSTLMT,4,-2048                                           DFX04220
       TXI     TSTLMT,4,1024                                            DFX04230
       TXI     TSTLMT,4,-1024                                           DFX04240
       TXI     TSTLMT,4,512                                             DFX04250
       TXI     TSTLMT,4,-512                                            DFX04260
       TXI     TSTLMT,4,256                                             DFX04270
       TXI     TSTLMT,4,-256                                            DFX04280
       TXI     TSTLMT,4,128                                             DFX04290
       TXI     TSTLMT,4,-128                                            DFX04300
       TXI     TSTLMT,4,64                                              DFX04310
       TXI     TSTLMT,4,-64                                             DFX04320
       TXI     TSTLMT,4,32                                              DFX04330
       TXI     TSTLMT,4,-32                                             DFX04340
       TXI     TSTLMT,4,16                                              DFX04350
       TXI     TSTLMT,4,-16                                             DFX04360
       TXI     TSTLMT,4,8                                               DFX04370
       TXI     TSTLMT,4,-8                                              DFX04380
       TXI     TSTLMT,4,4                                               DFX04390
       TXI     TSTLMT,4,-4                                              DFX04400
       TXI     TSTLMT,4,2                                               DFX04410
       TXI     TSTLMT,4,-2                                              DFX04420
       TXI     TSTLMT,4,1                                               DFX04430
       TXI     TSTLMT,4,-1                                              DFX04440
       TRA     TST1O2        (TST1O2),(BNRTWT).                         DFX04450
       TXI     TST1O2,4,-1   (TST1O2),(BNRTWT).                         DFX04460
GOUPL  XEC     *,2                                                      DFX04470
GODWNL XEC     *,2                                                      DFX04480
*                                                                       DFX04490
* TWO PART BINARY SEARCH TEST                                           DFX04500
*                                                                       DFX04510
TST1O2 LXD     TSTLMT+1,2    IS SECOND PART BINARY SEARCH REMAINING.    DFX04520
       TXL     XSMTG,2,**    -2,-1.                   NO.               DFX04530
       TXH     XSMTG,4,**    -(WRITE LOC.-L1 LOC.+1). NO.               DFX04540
       TXI     SECRND,4,**   -(LAST WRITE).           YES.              DFX04550
       EJECT                                                            DFX04560
*                                                                       DFX04570
* BINARY SEARCH RETURN FOR MERGE                                        DFX04580
*                                                                       DFX04590
XSMTG  PXA     0,4           INLIST POSITION.                           DFX04600
       TRA     *+1                                                      DFX04610
       COM                   REDUCE IT BY 1.                            DFX04620
       PAX     0,2                                                      DFX04630
       SXD     *+2,2                                                    DFX04640
       LXD     ERA01,1                                                  DFX04650
       TIX     *+2,1,**      IS LAST G LESS THAN OR EQUAL TO FIRST S.   DFX04660
       AXT     0,1           YES                                        DFX04670
       SXA     MRGPOS,1      NO                                         DFX04680
       LDQ     COMPAR-1                                                 DFX04690
       STQ     COMPER                                                   DFX04700
       LXA     LTHL2,1       (L2).IS FIRST G GREATER THAN OR EQUAL TO   DFX04710
       TXL     FSTGGS,2,0     FIRST S. YES.                             DFX04720
NOSRTG ADM     ERA01         NO-GET THE ADDRESS OF                      DFX04730
       STA     TSTHOP+1       THIS INLIST POSITION.                     DFX04740
       LXD     ERA01,4       IS IT TIME TO HOPOVR.                      DFX04750
TSTHOP TXL     HOPOVR,4,**   (BASE OF L1-WRITE LOC.).      YES.         DFX04760
       LDQ     **,2          (ADDRESS OF INLIST POSITION). NO.          DFX04770
       STQ     **,1          (BASE OF L2). MOVE L1 TAG TO L2.           DFX04780
       TIX     *+1,1,1                                                  DFX04790
       TIX     *+1,4,1                                                  DFX04800
CHNGAD TIX     **,2,1        (TSTHOP),(TSTHOP+1).                       DFX04810
FSTGGS LXD     ERA23,2       IS S ZERO.                                 DFX04820
       TXL     MRGDUN,2,0    YES.                                       DFX04830
       LXA     CHNGAD,4      NO-DID IT EVER GO TO HOPOVR.               DFX04840
       TXH     JSTOVW,4,TSTHOP    YES.                                  DFX04850
       LXA     MRGPOS,4      NO-IS INLIST POS.AT THE WRITE LOC.         DFX04860
BZLMWL TXH     OVRWRT,4,**   (BASE OF L1-WRITE LOC.).   NO.             DFX04870
JSTOVW CLA     SFINIS        YES-IT COMES HERE IF THE INLIST POS.IS AT  DFX04880
       STA     L1FINI         THE WRITE LOC.IN CASE OF WRITE BEING AT   DFX04890
       PXA     0,1            THE BOTTOM OF L1 AND IF THE INLIST POS.IS DFX04900
       PAX     0,4            IN THE SECOND PART OF THE TWO PART SEARCH.DFX04910
       SXA     POSL2,1                                                  DFX04920
SINDEC TIX     MOVSTG,4,**   (S). IS L1 EXHAUSTED. NO.                  DFX04930
       TRA     L1FNSH        YES.                                       DFX04940
OVRWRT SXA     POSL2,1                                                  DFX04950
       TRA     MOVSTG                                                   DFX04960
HOPOVR CLA     CHNGAD        INDICATE IT HAD                            DFX04970
       ADD     ONE            BEEN TO HOPOVR.                           DFX04980
       STA     CHNGAD                                                   DFX04990
WRTIND TIX     TSTHOP+1,2,** (LAST WRITE).                              DFX05000
       TRA     FSTGGS                                                   DFX05010
*                                                                       DFX05020
* TWO WAY MERGE                                                         DFX05030
*                                                                       DFX05040
CHKHOP TXL     HOPP,4,**     (BASE OF L1-WRITE LOC.).                   DFX05050
COMPER LXA     CAL12,1       COMPARE L1 TAG WITH S TAG.                 DFX05060
       CAL*    **,4          (BASE OF L1).                              DFX05070
       LAS*    **,2          (BASE OF S).                               DFX05080
       TRA     MOVSTG        G GREATER THAN S.                          DFX05090
       TRA     *+2           G EQUAL TO S.                              DFX05100
TMVLTG TRA     MOVLTG        G LESS THAN S.                             DFX05110
       TIX     COMPER+1,1,1  IN CASE OF EQUALS OPTION                   DFX05120
GEQS   TXI     *+1,1,-1       *+1 IS CHANGED TO COMPER+1.               DFX05130
MOVLTG LDQ     **,4          (BASE OF L1).                              DFX05140
       LXA     POSL2,1                                                  DFX05150
       STQ     **,1          (BASE OF L2). MOVE L1 TAG TO L2.           DFX05160
       TNX     MRGDON,1,1                                               DFX05170
       SXA     POSL2,1                                                  DFX05180
L1FINI TIX     **,4,1        (CHKHOP),(COMPER),(MOVLTG).                DFX05190
       TRA     L1FNSH                                                   DFX05200
MOVSTG LDQ     **,2          (BASE OF S).                               DFX05210
       LXA     POSL2,1                                                  DFX05220
       STQ     **,1          (BASE OF L2). MOVE S TAG TO L2.            DFX05230
       TNX     MRGDON,1,1                                               DFX05240
       SXA     POSL2,1                                                  DFX05250
SFINIS TIX     **,2,1        (COMPER),(MOVSTG).                         DFX05260
       CAL     TMVLTG                                                   DFX05270
       SLW     COMPER                                                   DFX05280
       LXA     L1FINI,1                                                 DFX05290
       TXH     MOVLTG,1,CHKHOP                                          DFX05300
       TRA     CHKHOP                                                   DFX05310
*                                                                       DFX05320
HOPP   AXT     COMPER,1                                                 DFX05330
       SXA     L1FINI,1                                                 DFX05340
WTINDC TIX     COMPER,4,**   (LAST WRITE).                              DFX05350
L1FNSH AXT     MOVSTG,1                                                 DFX05360
       SXA     SFINIS,1                                                 DFX05370
       TRA     MOVSTG                                                   DFX05380
*                                                                       DFX05390
MRGDUN NOP     MOVDON        IN CASE OF EOF THIS IS (TRA MOVDON).       DFX05400
MRGDON LXA     ERA03,2       INITIALIZE TO MOVE DEAD TAGS               DFX05410
       LXA     ERA24,4        FROM L1 TO L2.                            DFX05420
       SXD     *+1,2                                                    DFX05430
       TXI     *+1,4,**      (DEAD TAGS IN L1).                         DFX05440
       SXA     ERA03,4       NEW NO.OF DEAD TAGS IN FUTURE L1.          DFX05450
       PXA     0,4                                                      DFX05460
       ADM     L2BASE                                                   DFX05470
       STA     MOVTL2+1                                                 DFX05480
       TXL     MVSTL2,2,0    ANY DEAD TAGS IN L1. NO-GO TO MVSTL2.      DFX05490
MOVTL2 CLA     **,2          (BASE OF DEAD TAGS IN L1 OR IN S).         DFX05500
       STO     **,4          (BASE OF TOTAL DEAD TAGS,TO BE,IN L2).     DFX05510
       TNX     MOVDON,4,1                                               DFX05520
       TIX     MOVTL2,2,1                                               DFX05530
MVSTL2 LXA     ERA24,2       IS THERE ANY DEAD TAG IN S.                DFX05540
       TXL     MOVDON,2,0    NO.                                        DFX05550
       LXA     ERA24,1       YES.                                       DFX05560
SRTBAS TXI     *+1,1,**      (BASE OF S).                               DFX05570
       SXA     MOVTL2,1      PREPARE TO MOVE THEM TO L2.                DFX05580
       TRA     MOVTL2                                                   DFX05590
*                                                                       DFX05600
* CYCLE R,W,S,L1 AND L2 TABLES.                                         DFX05610
*                                                                       DFX05620
MOVDON ENB     =0            DISABLE TRAP.                              DFX05630
       LXA     ERA21,1       R.                                         DFX05640
       LXA     ERA22,2       W.                                         DFX05650
       LXA     ERA23,4       S.                                         DFX05660
       SXA     ERA21,2       W TO R.                                    DFX05670
       SXA     ERA22,4       S TO W.                                    DFX05680
       SXA     ERA23,1       R TO S.                                    DFX05690
       LXA     ERA01,1       L1.                                        DFX05700
       LXA     ERA02,2       L2.                                        DFX05710
       SXA     ERA01,2       L2 TO L1.                                  DFX05720
       SXA     L1LOC,2                                                  DFX05730
       SXA     ERA02,1       L1 TO L2.                                  DFX05740
       LXA     LTHL2,1       GET NEW                                    DFX05750
       SXD     ERA01,1        LENGTH OF L1.                             DFX05760
       TXI     *+1,1,1                                                  DFX05770
       SXD     L1DECR,1                                                 DFX05780
       SXA     LPLUS1,1                                                 DFX05790
       ENB*    (TRAPX        ENABLE TRAP.                               DFX05800
*                                                                       DFX05810
TSTEOF TRA     NOEOF         IN CASE OF EOF THIS IS (NOP).              DFX05820
       AXT     0,4           INDICATE ZERO DEAD TAGS                    DFX05830
       SXD     ERA26,4        TO BE MOVED TO W TABLE.                   DFX05840
       LXD     ERA01,4                                                  DFX05850
       PXA     ,4                                                       DFX05860
       SUB     CAL06                                                    DFX05870
       TMI     L1LESW                                                   DFX05880
       ALS     18                                                       DFX05890
       STD     ERA01                                                    DFX05900
       CAL     CAL06                                                    DFX05910
       STA     SPCIWR                                                   DFX05920
       ADM     ERA01                                                    DFX05930
       STA     NEWRLC                                                   DFX05940
       TRA     INTLZE                                                   DFX05950
L1LESW SXA     SPCIWR,4                                                 DFX05960
       ZAC                                                              DFX05970
       STD     ERA01                                                    DFX05980
       TRA     INTLZE                                                   DFX05990
*                                                                       DFX06000
NOEOF  CAL     CAL06         IS THE SIZE OF W TABLE                     DFX06010
       LAS     ERA03          GREATER THAN DEAD TAGS IN L1.             DFX06020
       TRA     *+3           YES.                                       DFX06030
       TRA     NOWRIT        NO.                                        DFX06040
       TRA     NOWRIT        NO.                                        DFX06050
SUBTRC SBM     CAL14         (NO.OF TAGS IN 1 MERGE BLOCK).             DFX06060
       LAS     ERA03         IS THE SIZE OF THE REMAINING TAGS          DFX06070
       TRA     SUBTRC         IN W GREATER THAN DEAD TAGS IN L1. YES.   DFX06080
       TRA     *+1           NO.                                        DFX06090
       ALS     18                                                       DFX06100
       PDC     ,4                                                       DFX06110
       SXD     UPDEAD,4                                                 DFX06120
       STD     ERA26         GET THE LENGTH OF DEAD TAGS                DFX06130
       ARS     18             TO BE MOVED TO W TABLE.                   DFX06140
       SBM     CAL06         GET THE REMAINING SPACE IN                 DFX06150
       PAX     0,4            W FOR LIVE TAGS TO BE WRITTEN OUT         DFX06160
       SXA     SPCIWR,4       AND SAVE IT IN SPCIWR.                    DFX06170
       LXA     ERA03,4       UPDATE DEAD TAGS REMAINING IN L TABLE.     DFX06180
UPDEAD TXI     *+1,4,**      (NO. OF DEAD TAGS TO BE MOVED TO W TABLE). DFX06190
       SXA     ERA03,4                                                  DFX06200
       LXD     ERA01,4                                                  DFX06210
       PXA     0,4           GET THE LOC.OF THE DEAD                    DFX06220
       ADM     ERA01          TAGS IN L1                                DFX06230
       ADM     ERA03          TO BE MOVED                               DFX06240
       STA     ERA26          TO THE W TABLE.                           DFX06250
*                                                                       DFX06260
INTLZE CAL     SAVREC+1      IF IT HAS BEEN TO FRSTIM SECTION,          DFX06270
CALTRA CAL     SAVRCD+1       THEN (CAL SAVRCD+1) IS EFFECTIVE BUT      DFX06280
       LXD     TRA,4          NOW ON IT WILL BE (TRA STA) WHICH         DFX06290
       SXD     CALTRA,4       MEANS (CAL SAVREC+1) IS EFFECTIVE         DFX06300
       STP     CALTRA         FOR THE REST OF THE TIME.                 DFX06310
       AXT     STA,4                                                    DFX06320
       SXA     CALTRA,4      INITIALIZE                                 DFX06330
STA    STA     FRSRTG         BINARY                                    DFX06340
       LXA     ERA01,4        SEARCH                                    DFX06350
       TXI     *+1,4,-1       PORTION                                   DFX06360
       SXA     COMPAR,4       SO AS                                     DFX06370
       AXT     BNRTWT,4       TO GET                                    DFX06380
       SXA     GOUPL-1,4      THE BINARY                                DFX06390
       SXA     GOUPL-2,4      SEARCH                                    DFX06400
       LAC     LPLUS1,4       POSITION                                  DFX06410
       SXD     BNRTWT,4       FOR WRITING                               DFX06420
       CAL     NOP            OUT THE                                   DFX06430
       STD     NOPTRA         MERGE BLOCK.                              DFX06440
       AXC     1,4                                                      DFX06450
       TRA     CALMTP                                                   DFX06460
*                                                                       DFX06470
NOWRIT CAL     ERA03         UPDATE DEAD TAGS                           DFX06480
       SBM     CAL06          REMAINING IN                              DFX06490
       STA     ERA03          L TABLE.                                  DFX06500
       LXD     ERA01,4                                                  DFX06510
       PXA     ,4            GET THE LOC. AND                           DFX06520
       ADM     ERA03          LENGTH OF THE                             DFX06530
       ADM     ERA01          DEAD TAGS IN L1                           DFX06540
       STA     ERA26          TO BE MOVED                               DFX06550
       LXA     CAL06,4        TO W TABLE.                               DFX06560
       SXD     ERA26,4                                                  DFX06570
       AXT     0,4           INDICATE                                   DFX06580
       SXD     ERA27,4        ZERO WRITE.                               DFX06590
       STL     SAMSEQ                                                (5)DFX06600
       CAL     ERA01         INITIALIZE LOCATION OF WRITE.           (4)DFX06601
       STA     ERA27                                                 (4)DFX06602
       CALL    WRITE         WRITE.                                     DFX06610
       TRA     GOTORD        READ.                                      DFX06630
       EJECT                                                            DFX06640
*                                                                       DFX06650
* RETURN FROM BINARY SEARCH FOR WRITE                                   DFX06660
*                                                                       DFX06670
BNRTWT TXL     NEWSEQ,4,**   -(L+1).IS INLIST POS.AT L+1. YES.          DFX06680
       PXA     0,4           NO                                         DFX06690
       COM                                                              DFX06700
       PAX     ,2            GET THE LOCATION                           DFX06710
       ADM     ERA01          OF LIVE TAGS TO BE MOVED                  DFX06720
       STA     ERA27          TO W,ASSUMING THAT THERE                  DFX06730
L1DECR TXI     *+1,4,**       ARE ENOUGH LIVE TAGS IN L1      (L1+1).   DFX06740
       SXD     TSTSPA,4       FOLLOWING THE BINARY SEARCH POSITION.     DFX06750
       LXA     SPCIWR,4      ARE THERE ENOUGH LIVE TAGS IN L1 TO FILL   DFX06760
TSTSPA TXH     NEWSEQ,4,**    UP THE AVIL.SPACE IN W.  NO.              DFX06770
NOPEOF TRA     ALTIME        YES. IN CASE OF EOF THIS IS NOP.           DFX06780
       TXH     NEWSEQ,2,0                                               DFX06790
ALTIME SXD     ERA27,4       GET THE LENGTH OF LIVE TAGS.               DFX06800
       STL     SAMSEQ        INDICATE THAT ITS THE SAME SEQUENCE.       DFX06810
UPDTAP AXT     1,1           NO-UPDATE INTERNAL SORT                    DFX06820
       SXA     MTAPNO,1       CURRENT MERGE TAPE.                       DFX06830
       CLA     FILE,1        GET THE CORRECT                            DFX06840
       STD     RAWPR          FILE NO.FOR WRITE.                        DFX06850
       NZT     SWTCHD                                                (5)DFX06851
       TRA     *+3                                                   (5)DFX06852
       STZ     SWTCHD                                                (5)DFX06853
       TRA     WRTOUT                                                (5)DFX06854
       LXA     ERA27,4       INITIALIZE                                 DFX06860
       SXD     *+2,4          THE EFFECTIVE                             DFX06870
       LXD     ERA27,4        ADDRESS OF                                DFX06880
       TXI     *+1,4,**       THE LAST RECORD                           DFX06890
       TXI     *+1,4,-1                                                 DFX06900
       SXA     *+1,4          WRITTEN OUT.                              DFX06910
       CAL     **                                                       DFX06920
       STA     SAVREC                                                   DFX06930
       ZET     MOD30         C.E.MODIFICATION.                          DFX06940
       CALL    DXS06                                                    DFX06950
       NZT     MOD03         USER MODIFICATION.                         DFX06960
       TRA     *+3                                                      DFX06970
       STL     GEN04                                                    DFX06980
       CALL    XSM04                                                    DFX06990
       STL     GEN04                                                    DFX07000
NOOP   TRA     TOWRTE        NOP AFTER IT COMES FROM FRSTIM SECTION.    DFX07010
       CALL    WRITE         WRITE.                                     DFX07020
       CAL     MTAPNO        NORMAL RETURN.                             DFX07040
       STA     PREVTP                                                   DFX07050
       TRA     TSTENF                                                   DFX07060
       LXA     ERA15,4                                                  DFX07070
       PXD     ,4                                                       DFX07080
       ADD     ERA27                                                    DFX07090
       STO     ERA27                                                    DFX07100
*                                                                       DFX07110
TSTENF TRA     SAVREC-1      IN CASE OF EOF THIS IS (NOP).              DFX07120
       LXD     ERA01,4       IS L1 CLEARED OUT.                         DFX07130
       TXL     RIDEOF,4,0    YES.                                       DFX07140
       PXA     ,4            NO.ARE THERE ENOUGH TAGS IN L1             DFX07150
       SUB     CAL06          TO FILL UP W TABLE.                       DFX07160
       TMI     L1LSW         NO.                                        DFX07170
       ALS     18            YES.                                       DFX07180
       STD     ERA01                                                    DFX07190
       CAL     NEWRLC                                                   DFX07200
       STA     ERA27                                                    DFX07210
       LXA     CAL06,4                                                  DFX07220
       SXD     ERA27,4                                                  DFX07230
       CAL     CAL06                                                    DFX07240
       ADM     NEWRLC                                                   DFX07250
       STA     NEWRLC                                                   DFX07260
       TRA     CYCLE                                                    DFX07270
L1LSW  SXD     ERA27,4                                                  DFX07280
       SXD     ERA01,0                                                  DFX07290
       CAL     NEWRLC                                                   DFX07300
       STA     ERA27                                                    DFX07310
*                                                                       DFX07320
* CYCLE R,W AND S TABLES                                                DFX07330
*                                                                       DFX07340
CYCLE  ENB     =0            DISABLE TRAP.                              DFX07350
       LXA     ERA21,1       R.                                         DFX07360
       LXA     ERA22,2       W.                                         DFX07370
       LXA     ERA23,4       S.                                         DFX07380
       SXA     ERA21,2       W TO R.                                    DFX07390
       SXA     ERA22,4       S TO W.                                    DFX07400
       SXA     ERA23,1       R TO S.                                    DFX07410
       ENB*    (TRAPX        ENABLE TRAP.                               DFX07420
       TRA     UPDTAP                                                   DFX07430
*                                                                       DFX07440
* SAVE LAST RECORD THIS TAPE FOR NEXT GO ROUND                          DFX07450
*                                                                       DFX07460
       LXA     CAL12,4                                                  DFX07470
SAVREC CLA     **,4          (EFFECTIVE ADDR.OF LAST RECORD WRITTEN OUT)DFX07480
       STO     **,4          (BASE ADDR.OF LRHA WITH SEQ.WORD).         DFX07490
       TIX     *-2,4,1                                                  DFX07500
*                                                                       DFX07510
       TRA     GOTORD        READ.                                      DFX07520
*                                                                       DFX07530
NEWSEQ LXA     ERA01,4       GET THE LOC.AND                            DFX07540
       SXA     ERA27,4        LENGTH OF THE                             DFX07550
       LXA     SPCIWR,4       LIVE TAGS TO BE                           DFX07560
       SXD     ERA27,4        MOVED TO W TABLE.                         DFX07570
       ZET     MOD31         C.E.MODIFICATION.                          DFX07580
       CALL    DXSO7                                                    DFX07590
SWCHTP SXA     WRTOUT,4                                              (5)DFX07591
       SXA     WRTOUT+1,2                                            (5)DFX07592
       SXA     WRTOUT+2,1                                            (5)DFX07593
       LXA     COUNT,4       UPDATE                                     DFX07600
       TXI     *+1,4,1        SEQUENCE                                  DFX07610
       SXA     COUNT,4        LEVEL INDICATOR.                          DFX07620
       SXD     RAW08,4       KEEP STRING COUNT FOR MERGE TAPE.          DFX07630
       STZ     SAMSEQ        INDICATE THE SEQUENCE BREAK.               DFX07640
       EJECT                                                            DFX07650
*                                                                       DFX07660
* NOW SWITCH MERGE TAPES                                                DFX07670
*                                                                       DFX07680
       LXA     UPDTAP,1      CURRENT MERGE TAPE.                        DFX07690
       LXA     MRGORD,2      NEW MERGE ORDER.                           DFX07700
       TXI     *+1,2,-1                                                 DFX07710
       SXD     *+1,2         ANY MORE MERGE TAPE.                       DFX07720
       TXH     LOWORD,1,**   (NEW MERGE ORDER-1). NO.                   DFX07730
       TXI     *+1,1,1       YES-USE THIS NEW HIGHEST                   DFX07740
HIGORD SXA     UPDTAP,1       TAPE AS MERGE TAPE.                       DFX07750
       TRA     UPDTAP                                                   DFX07760
LOWORD AXT     1,1           LOW ORDER TAPE AGAIN A MERGE TAPE.         DFX07770
       TRA     HIGORD                                                   DFX07780
*                                                                       DFX07790
* END OF TAPE ROUTINE                                                   DFX07800
*                                                                       DFX07810
TAPEND SXA     WRTOUT,4                                                 DFX07820
       SXA     WRTOUT+1,2                                            (5)DFX07821
       SXA     WRTOUT+2,1                                            (5)DFX07822
       ZET     MOD32         C E MOD                                    DFX07830
       CALL    DXS08                                                    DFX07840
       LXA     MRGORD,4                                                 DFX07850
       TXI     *+1,4,-1                                                 DFX07860
       SXD     *+2,4         IS MRGORD REDUCED TO 1,OR                  DFX07870
       LXA     PREVTP,2      IS THIS MERGE TAPE AT THE TOP IN THE TABLE.DFX07880
       TXH     TPATOP,2,**   (NEW MERGE ORDER-1). YES.                  DFX07890
       CAL     FILE,2        NO-GET THE FILE WITH EOT.                  DFX07900
       LDQ     FILE-1,2      GET THE NEXT HIGHEST FILE AND              DFX07910
       STQ     FILE,2         STORE IT IN PLACE OF EOT TAPE.            DFX07920
       TXI     *+1,2,1       PREPARE TO ROTATE OTHER.                   DFX07930
MRDMN1 TXL     *-3,2,**      (MERGE ORDER-1).                           DFX07940
       SLW     FILE,2        PUT EOT FILE AT THE TOP IN THE NEW TABLE.  DFX07950
TPATOP LXA     MRGORD,4      IS MRGORD REDUCED TO 1.                    DFX07960
       TXL     MORD1,4,1     YES.                                       DFX07970
       TIX     *+1,4,1       NO.                                        DFX07980
       SXA     MRGORD,4      SAVE NEW MERGE ORDER.                      DFX07990
       LXA     COUNT,1                                               (4)DFX08020
       TXI     *+1,1,1                                               (4)DFX08030
       SXA     COUNT,1                                               (4)DFX08040
       SXD     RAW08,1                                               (4)DFX08041
       LXA     UPDTAP,1                                                 DFX08050
       TXI     *+1,4,-1                                                 DFX08060
       SXD     *+1,4                                                    DFX08070
       TXH     LOORD,1,**                                               DFX08080
       TXI     *+1,1,1                                                  DFX08090
HYORD  SXA     UPDTAP,1                                                 DFX08100
       SXA     MTAPNO,1                                                 DFX08110
       CLA     FILE,1                                                   DFX08120
       STD     RAWPR                                                    DFX08130
       TRA     WRTOUT                                                   DFX08140
LOORD  AXT     1,1                                                      DFX08150
       TRA     HYORD                                                    DFX08160
WRTOUT AXT     **,4                                                     DFX08170
       AXT     **,2                                                  (5)DFX08175
       AXT     **,1                                                  (5)DFX08177
       TRA     1,4                                                   (5)DFX08180
MORD1  ZET     RAW03         IF EOF HAS BEEN HIT,                       DFX08190
       TRA     WRTOUT        FORGET EOT,WE CAN MAKE IT.                 DFX08200
       TSX     MSGSUP,4,2                                               DFX08210
       PZE     3                                                        DFX08220
       PZE     MESG1,,5+512*4                                           DFX08230
       PZE     MESG2,,4                                                 DFX08240
       PZE     MESG3,,4+512*4                                           DFX08250
       TSX     (PAUSE,4       PRESS START.                              DFX08260
       SWT     3                                                        DFX08270
       TRA     STDLSW                                                   DFX08280
       TSX     MSGSUP,4,2    PRINT-                                     DFX08290
       PZE     1              (IGNORED)                                 DFX08300
       PZE     MESG4,,2+512*4                                           DFX08310
       TRA     WRTOUT                                                   DFX08320
STDLSW STL     ERA18                                                    DFX08330
       XEC     XRC                                                      DFX08340
       TRA     5,4           GO TO POST PROCESSOR.                      DFX08350
MESG1  BCI     5,EOT ON ALL MERGE TAPES  *WR01                          DFX08360
MESG2  BCI     4,TO DELETE SORT---SS3 UP                                DFX08370
MESG3  BCI     4,TO IGNORE EOT----SS3 DN                                DFX08380
MESG4  BCI     2,(IGNORED)                                              DFX08390
       EJECT                                                            DFX08400
*                                                                       DFX08410
*      TSX     SORT,4        SHELL M/4+1 MODIFIED METHOD                DFX08420
*                                                                       DFX08430
SORT   SXA     X1,1                                                     DFX08440
       SXA     X2,2                                                     DFX08450
       SXA     X4,4                                                     DFX08460
       CLA     ERA09         PICK UP LOCATION AND LENGTH OF SORT TABLE. DFX08470
       PDX     0,4                                                      DFX08480
       TXL     SORTEX,4,1    TRANSFER IF LESS THAN TWO TAGS IN SORT TAB DFX08490
       SXA     XSM1,4        SAVE M (LENGTH OF TABLE)                   DFX08500
       TXI     *+1,4,-1       AND                                       DFX08510
       SXA     XSN,4          M-1.                                      DFX08520
       PAX     0,4                                                      DFX08530
       SXD     TXIA2,4       SAVE LOCATION OF SORT TABLE.               DFX08540
       STA     KYUPR1                                                   DFX08550
       STA     KYUPR2                                                   DFX08560
       STA     KYUPR3                                                   DFX08570
       AXT     INITEP,2      SET TO REPEAT AFTER NEXT PASS.             DFX08580
       SXA     J(GT)K,2                                                 DFX08590
INITEP CLA     XSM1          CALCULATE NEW.M FROM THE FORMULA           DFX08600
       ARS     3              2(N/B)+1 WHERE N=M ON THE FIRST PASS      DFX08610
       ALS     1              AND N=LAST NEW.M ON OTHER PASSES.         DFX08620
       ADD     ONE                                                      DFX08630
       STA     XSM1          SAVE NEW.M.                                DFX08640
       PAX     0,4                                                      DFX08650
       TXH     *+3,4,1       TRANSFER IF NEW.M GT 1.                    DFX08660
       AXT     SORTEX,2      IF NEW.M=1, SET TO EXIT AFTER NEXT PASS.   DFX08670
       SXA     J(GT)K,2                                                 DFX08680
       SXD     XSM,4         SAVE NEW.M.                                DFX08690
TXIA2  TXI     *+1,4,**      ADD LOCATION OF TABLE + NEW.M.             DFX08700
       SXA     KYLWR1,4      SAVE LOCATION OF THE (NEW.M)TH TAG,        DFX08710
       SXA     KYLWR2,4       THE FIRST ONE WHICH WILL BE COMPARED      DFX08720
       SXA     KYLWR3,4       WITH THE FIRST TAG IN THE TABLE.          DFX08730
       PAC     0,4                                                      DFX08740
       SXD     TXIMM,4       SAVE -(NEW.M).                             DFX08750
       SXD     TESTMM,4                                                 DFX08760
XSN    AXT     **,4          CALCULATE M-1-(NEW.M)                      DFX08770
TXIMM  TXI     *+1,4,**       AND                                       DFX08780
       SXD     J(GT)K,4       SAVE IT.                                  DFX08790
       AXT     0,2           SET TO START AT TOP OF TABLE.              DFX08800
SORLUP PXA     0,2                                                      DFX08810
       PAC     0,4                                                      DFX08820
SIFTYS LXA     CAL12,1       GET LENGTH OF EXTRACTED CONTROL FIELDS.    DFX08830
KYLWR1 CAL*    **,4          COMPARE (X+NEW.M)TH TAG                    DFX08840
KYUPR1 LAS*    **,4           WITH (X)TH TAG.                           DFX08850
       TRA     NELSRT        (X+NEW.M)TH GT (X)TH,MAKING ORDER          DFX08860
       TRA     XSEQ          (X+NEW.M)TH = (X)TH.                       DFX08870
KYUPR2 LDQ     **,4          EXCHANGE TAGS WHICH WERE OUT OF ORDER.     DFX08880
KYLWR3 CAL     **,4                                                     DFX08890
KYLWR2 STQ     **,4                                                     DFX08900
KYUPR3 SLW     **,4                                                     DFX08910
       TXL     NELSRT,4,0    TRANSFER IF AT TOP OF TABLE (SIFTING DONE).DFX08920
TESTMM TXH     NELSRT,4,**   TRANSFER IF CLOSE TO TOP OF TABLE (DITTO). DFX08930
XSM    TXI     SIFTYS,4,**   GO SIFT.                                   DFX08940
XSEQ   TIX     KYLWR1,1,1    COMPARE NEXT CONTROL WORDS.                DFX08950
       TXI     *+1,1,-1      TRANSFER IS TO KYLWR1 IF EQUALS OPTION.    DFX08960
NELSRT TXI     *+1,2,1                                                  DFX08970
J(GT)K TXH     **,2,**       GO TO INITEP AFTER A PASS,SORTEX AFTER     DFX08980
       TRA     SORLUP         LAST PASS,AND SORLUP AFTER A SIFT.        DFX08990
XSM1                         CURRENT VALUE OF NEW.M.                    DFX09000
SORTEX BSS     0                                                        DFX09010
X1     AXT     **,1                                                     DFX09020
X2     AXT     **,2                                                     DFX09030
X4     AXT     **,4                                                     DFX09040
       STL     GEN05                                                    DFX09050
       TRA     1,4                                                      DFX09060
       EJECT                                                            DFX09070
*                                                                       DFX09080
*      CHECK WHAT PHASE TO GO NEXT                                      DFX09090
*                                                                       DFX09100
RIDEOF LXA     COUNT,1       SAVE COUNT OF STRINGS FOR MERGE PHASE.     DFX09110
       STZ     RAW21         IS MERGE PHASE NEEDED.                     DFX09120
MORDEC TXH     SET,1,**      YES-(MERGE ORDER).                         DFX09130
       CLA     SAM01         NO-(MERGE ORDER).                          DFX09140
       SUB     COUNT         (NO. OF STRINGS PRODUCED BY INTERNAL SORT).DFX09150
       SUB     SAM02         (NO. OF EXTERNAL FILES TO BE MERGED).      DFX09160
       TPL     *+2           IS MERGE PHASE NEEDED.                     DFX09170
       TRA     SET           YES.                                       DFX09180
       LAC     CHA01,4       NO -(ADDR. OF OUTPUT CHANNEL).             DFX09190
       SXD     *+2,4                                                    DFX09200
       LXA     CHA02,4       (ADDR. OF INPUT CHANNEL FOR MERGE PHASE).  DFX09210
       TXI     *+1,4,**      IS ADDITIONAL PASS NEEDED.                 DFX09220
       TXL     SET,4,0       YES.                                       DFX09230
       ZET     RAW20         ARE ALL MERGE CHANNELS HYPER.              DFX09240
       STL     FLIP          YES.                                       DFX09250
       TRA     CLOZOU        NO.                                        DFX09260
SET    STL     PHASE2        SET SWITCH TO GO TO PHASE 2.               DFX09270
       ZET     RAW20         ARE ALL MERGE CHANNELS HYPER.              DFX09280
       STL     RAW21         DO NOT REWIND OUTPUT FROM PHASE 1.         DFX09290
*                                                                       DFX09300
* CLOSE INTERNAL SORT OUTPUT FILES                                      DFX09310
*                                                                       DFX09320
CLOZOU CAL     *             STORE MINUS SIGN                           DFX09330
       STP     RAWPR          AND FILE NO.IN THE DECREMENT              DFX09340
       LXA     SAM01,1        OF CALLING SEQ.WORD.                      DFX09350
       SXD     RAWPR,1                                                  DFX09360
       PXD     ,1                                                       DFX09370
       STD*    ERA20                                                    DFX09380
       CALL    SCL                                                      DFX09390
       TIX     *-4,1,1       REPEAT FOR ALL FILES.                      DFX09400
*                                                                       DFX09410
* WRITE CHECKPOINT OF INTERANAL SORT PHASE                              DFX09420
*                                                                       DFX09430
       ZET     OPT02         IS THERE CHECKPOINT OPTION                 DFX09440
       TRA     NXPHAS        NO,CALL IN NEXT PHASE.                     DFX09450
       STL     GEN04         YES.                                       DFX09460
       CALL    CKPT                                                     DFX09470
*                                                                       DFX09480
* PREPARE TO CALL NEXT PHASE                                            DFX09490
*                                                                       DFX09500
NXPHAS LDQ     CNTPR                                                    DFX09510
       CALL    BTD                                                      DFX09520
       STO     MESCT                                                    DFX09530
       STQ     MESCT+1                                                  DFX09540
       TSX     MSGSUP,4,4    PRINT MESSAGE SAYING-                      DFX09550
       PZE     2              INTERNAL SORT PHASE COMPLETED.            DFX09560
       MZE     MESG,,5                                                  DFX09570
       PZE     MESCT,,5+512*4                                           DFX09580
       CLA     CHA02         SWITCH INPUT                               DFX09590
       LDQ     CHA03          AND OUTPUT                                DFX09600
       STQ     CHA02          CHANNELS FOR                              DFX09610
       STO     CHA03          NEXT PHASE.                               DFX09620
       ZET     MOD34         C.E.MODIFICATION.                          DFX09630
       CALL    DXS10                                                    DFX09640
       ZET     PHASE2        IS MERGE PHASE NEEDED.                     DFX09650
       TRA     XRC           YES.                                       DFX09660
       XEC     XRC           NO.                                        DFX09670
       TRA     3,4           EXIT TO FINAL MERGE PHASE.                 DFX09680
XRC    AXT     **,4                                                     DFX09690
       TRA     4,4           EXIT TO MERGE PHASE.                       DFX09700
MESG   BCI     5,INTERNAL SORT PHASE COMPLETED.                         DFX09710
MESCT  BCI     5,             RECORDS SORTED.                           DFX09720
       EJECT                                                            DFX09730
*                                                                       DFX09740
* PARAMETERS CALCULATED BY AND USED DURING INTERNAL SORT PHASE.         DFX09750
*                                                                       DFX09760
       PZE     0,0,16                                                   DFX09770
       PZE     0,0,15                                                   DFX09780
       PZE     0,0,14                                                   DFX09790
       PZE     0,0,13                                                   DFX09800
       PZE     0,0,12                                                   DFX09810
       PZE     0,0,11                                                   DFX09820
       PZE     0,0,10                                                   DFX09830
       PZE     0,0,9                                                    DFX09840
       PZE     0,0,8                                                    DFX09850
       PZE     0,0,7                                                    DFX09860
       PZE     0,0,6                                                    DFX09870
       PZE     0,0,5                                                    DFX09880
       PZE     0,0,4                                                    DFX09890
       PZE     0,0,3                                                    DFX09900
       PZE     0,0,2                                                    DFX09910
       PZE     0,0,1                                                    DFX09920
FILE   BES     0                                                        DFX09930
L1BASE PZE                   BASE OF LIVE TAGS IN L1.                   DFX09940
L2BASE PZE     0             BASE OF LIVE TAGS IN L2.                   DFX09950
SBASE  PZE                   BASE OF LIVE TAGS IN S.                    DFX09960
ONE    PZE     1                                                        DFX09970
TWO    PZE     2                                                        DFX09980
FOUR   PZE     4                                                        DFX09990
LPLUS1 PZE                   L1+1                                       DFX10000
UPRLMT PZE                   IN DECREMENT IS (WRITE LOC.- L1 LOC.).     DFX10010
LTHL1  PZE                   LENGTH OF LIVE TAGS IN L1.                 DFX10020
LTHL2  PZE                   LENGTH OF LIVE TAGS IN L2.                 DFX10030
SPCIWR PZE                   SPACE FOR LIVE TAGS IN W.                  DFX10040
STARTG PZE                   START OF G.                                DFX10050
IOSP   IOSP    **,1,**       BIN ADDRESS,1,RECORD LENGTH.               DFX10060
BINLTH PZE                   BIN LENGTH.                                DFX10070
FRSRTG PZE     **,1          FIRST TAG IN SORT TABLE.                   DFX10080
LMTPWR PZE                   LIMITING POWER =(2P+4).                    DFX10090
MRGPOS PZE                   MERGE POSITION IN L1.                      DFX10100
POSL2  PZE                   POSITION OR POINTER IN L2.                 DFX10110
MRGORD PZE                   MERGE ORDER.                               DFX10120
PREVTP PZE     0                                                        DFX10140
MTAPNO PZE                   CURRENT MERGE TAPE NO.                     DFX10150
NEWRLC PZE                   NEW WRITE LOCATION IN L1.                  DFX10160
NOP    NOP                                                              DFX10170
PHASE2 PZE                                                              DFX10180
CKPTAP MZE     0,,-1                                                    DFX10190
OPTPR  COMMON  15             OPTION CARD PARAMETERS.                   DFX10200
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS.                  DFX10210
LABPR  COMMON  5             LABEL CARD PARAMETERS.                     DFX10220
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   DFX10230
FILPR  COMMON  14            FILE CARD PARAMETERS.                      DFX10240
MODPR  COMMON  50            MODIFICATION CARD PARAMETERS.              DFX10250
RECPR  COMMON  10            RECORD CARD PARAMETERS.                    DFX10260
DELPR  COMMON  2             DELETE CARD PARAMETERS.                    DFX10270
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            DFX10280
CALPR  COMMON  50            CALCULATED PARAMETERS.                     DFX10290
GENPR  COMMON  10            GENERAL PARAMETERS.                        DFX10300
RAWPR  COMMON  30             READ AND WRITE PARAMETERS.                DFX10310
CNTPR  COMMON  20            COUNT PARAMETERS.                          DFX10320
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS.               DFX10330
REFPR  COMMON  1             REFERENCED PARAMETERS.                     DFX10340
OPT02  EQU     OPTPR-2       CHECKPOINT OPTION.                         DFX10350
OPT03  EQU     OPTPR-3       EQUALS OPTION.                             DFX10360
OPT04  EQU     OPTPR-4       BUFFER OPTION.                             DFX10370
OPT08  EQU     OPTPR-8       HISTORY OPTION.                            DFX10380
LAB04  EQU     LABPR-4       LOCATION OF LABEL.                         DFX10390
CHA01  EQU     CHAPR-1       UCB OF OUTPUT UNIT.                        DFX10400
CHA02  EQU     CHAPR-2       UCB TABLE,OUTPUT FROM INTERNAL SORT PHASE. DFX10410
CHA03  EQU     CHAPR-3       UCB TABLE,OTHER MERGE CHANNEL.             DFX10420
CHA05  EQU     CHAPR-5       CHECKPOINT ATTACHMENT.                     DFX10430
MOD03  EQU     MODPR-3                                                  DFX10440
MOD05  EQU     MODPR-5                                                  DFX10450
MOD09  EQU     MODPR-9                                                  DFX10460
MOD25  EQU     MODPR-25                                                 DFX10470
MOD30  EQU     MODPR-30                                                 DFX10480
MOD31  EQU     MODPR-31                                                 DFX10490
MOD32  EQU     MODPR-32                                                 DFX10500
MOD34  EQU     MODPR-34                                                 DFX10510
SAM01  EQU     SAMPR-1       MERGE ORDER.                               DFX10520
SAM02  EQU     SAMPR-2       NUMBER OF EXTERNAL FILES TO BE MERGED.     DFX10530
CAL05  EQU     CALPR-5       LENGTH OF L TABES.                         DFX10540
CAL06  EQU     CALPR-6       LENGTH OF M TABLES.                        DFX10550
CAL08  EQU     CALPR-8       EFFECTIVE RECORD LENGTH.                   DFX10560
CAL12  EQU     CALPR-12      TOTAL WORDS ALL CFS EXCEPT EQUALS.         DFX10570
CAL14  EQU     CALPR-14      NO.OF TAGS IN 1 MERGE BLOCK.               DFX10580
GEN03  EQU     GENPR-3                                                  DFX10590
GEN04  EQU     GENPR-4                                                  DFX10600
GEN05  EQU     GENPR-5                                                  DFX10610
RAW03  EQU     RAWPR-3       END OF FILE INDICATOR.                     DFX10620
SWTCHD EQU     RAWPR-5                                               (5)DFX10621
RAW08  EQU     RAWPR-8       SEQUENCE LEVEL INDICATOR.                  DFX10630
RAW20  EQU     RAWPR-20                                                 DFX10640
RAW21  EQU     RAWPR-21    Z=REWIND,NZ=DO NOT REWIND                    DFX10650
FLIP   EQU     RAWPR-23      HYPER AND STRAIGHT FROM PHASE 1 INDICATION.DFX10660
SAMSEQ EQU     RAWPR-28                                              (5)DFX10661
COUNT  EQU     CNTPR-15      STRING COUNT.                              DFX10670
ERA01  EQU     ERAPR-1       LOCATION AND LENGTH OF LIVE TAGS IN L1.    DFX10680
ERA02  EQU     ERAPR-2       LOCATION OF L2.                            DFX10690
ERA03  EQU     ERAPR-3       LENGTH OF DEAD TAGS IN CURRENT L TABLE.    DFX10700
ERA09  EQU     ERAPR-9       LOCATION AND LENGTH OF SORT TABLE.         DFX10710
ERA15  EQU     ERAPR-15                                                 DFX10720
ERA18  EQU     ERAPR-18      DELETE JOB SWITCH.                         DFX10730
ERA19  EQU     ERAPR-19      INTERRUPT SWITCH.                          DFX10740
ERA20  EQU     ERAPR-20      FILE NUMBER.                               DFX10750
ERA21  EQU     ERAPR-21      LOCATION AND LENGTH OF LIVE TAGS IN READ.  DFX10760
ERA22  EQU     ERAPR-22      LOCATION AND LENGTH OF LIVE TAGS IN WRITE. DFX10770
ERA23  EQU     ERAPR-23      LOCATION AND LENGTH OF LIVE TAGS IN SORT.  DFX10780
ERA24  EQU     ERAPR-24      LENGTH OF DEAD TAGS IN SORT TABLE.         DFX10790
ERA26  EQU     ERAPR-26      LOC. AND LENGTH OF DEAD TAGS TO BE MOVED.  DFX10800
ERA27  EQU     ERAPR-27      LOC. AND LENGTH OF LIVE TAGS TO BE MOVED.  DFX10810
       EXTERN  MSGSUP                                                   DFX10820
       END                                                              DFX10830
* 7090/94 SORT VER 7 MOD 8 VARIABLE LENGTH INPUT PHASE 1, 729 TAPES  (8)DGE00000
*      FAP
       COUNT   900                                                      DGE00010
       ENTRY   GET                                                      DGE00020
       SST                                                              DGE00030
*  GET HANDLES THE READING OF UNSORTED VARIABLE LENGTH RECORDS IN       DGE00040
*  PHASE 1.BLOCKS OF RECORDS ARE READ INTO THE BUFFER AND THE LOCATION  DGE00050
*  AND WORD LENGTH OF EACH RECORD IS PUT INTO THE LOCATE TABLE.ERAPR-3  DGE00060
*  POINTS TO THE LIST OF AVAILABLE BINS TO BE USED FOR EACH CALL TO GET.DGE00070
*  RECORDS ARE MOVED INTO BINS UNTIL THE LIST IS EXHAUSTED OR UNTIL     DGE00080
*  THE SORT TABLE IS FILLED.EACH ENTRY IN THE SORT TABLE TELLS THE      DGE00090
*  LOCATION OF THE FIRST BIN OF A RECORD AND THE NUMBER OF WORDS WHICH  DGE00100
*  WILL BE WRITTEN FROM PHASE 1 FOR THAT RECORD.EQUALS AND/OR CHECKSUM, DGE00110
*  IF OPTIONED,ARE ADDED WHEN THE RECORD IS MOVED INTO THE BINS.THE     DGE00120
*  LOCATION AND LENGTH OF THE SORT TABLE IS GIVEN IN ERAPR-9.           DGE00130
       TITLE                                                            DGE00140
       SPACE   2                                                        DGE00150
GET    SXA     EXTRGS,1      SAVE ALL                                   DGE00160
       SXA     EXTRGS+1,2    THE REGS.                                  DGE00170
       SXA     EXTRGS+2,4                                               DGE00180
       NZT     DUMPSW        IS DUMP SWITCH SET.                        DGE00190
       TRA     *+4           NO-PROCESS AS USUAL.                       DGE00200
       CALL    DEBLK         YES-GO AND DUMP                            DGE00210
       PZE     TPTOBF,,1     THAT BLOCK.                                DGE00220
       STZ     DUMPSW        RESET DUMPSW.                              DGE00230
       LXA     MXBKP1,1      SET BACK THE DECR. PORTION                 DGE00240
       SXD     TPTOBF,1      OF TPTOBF TO MXBKP1.                       DGE00250
       CAL     ERAPR-3       GET THE LOC AND LENGTH OF                  DGE00260
       LGR     18            AVAILABLE TABLE                            DGE00270
       STA     ATLT          TO BE REFERED TO.                          DGE00280
       ADM     ONE           INITIALIZE THISAV SO THAT IN CASE          DGE00290
       PAC     ,1            NO BIN IS USED, THE DECR. PART OF          DGE00300
       SXA     THISAV,1      ERAPR-3 REMAINS AS IT IS.                  DGE00310
       CAL     SRTBLT        INITIALIZE SRTBBP                          DGE00320
       SLW     SRTBBP        WITH SRTBLT.                               DGE00330
       CAL     SWTCHR        IS SWITCH R SET.                           DGE00340
       TNZ     CLOSE         YES-GO AND CLOSE THIS FILE AND OPEN NEW.   DGE00350
       CAL     SWTCHF        NO-IS SWITCH F SET.                        DGE00360
       TNZ     ENTRY1        YES-GO TO ENTRY1.                          DGE00370
       CAL     GETSWT        NO-IS IT FIRST TIME THROUGH.               DGE00380
       TNZ     TSTSWA        NO-GO AND TEST SWITCH A.                   DGE00390
       STL     GETSWT                                                   DGE00400
       LXA     ERAPR,1       YES INITIALISE.                            DGE00410
       SXA     BUFRLC,1      TAKE                                       DGE00420
       SXA     BUFBOT,1      THE                                        DGE00430
       LXD     ERAPR,1       DATA                                       DGE00440
       SXA     BUFRLT,1      FROM                                       DGE00450
       LXA     ERAPR-1,1     THE                                        DGE00460
       SXA     BFTBLC,1      EDIT                                       DGE00470
       LXD     ERAPR-1,1     PHASE                                      DGE00480
       SXA     BFTBLT,1      AND                                        DGE00490
       SXA     BFTBEP,1      STORE                                      DGE00500
       SXA     BFTBBP,1      THEM                                       DGE00510
       LXA     ERAPR-2,1     IN                                         DGE00520
       SXA     LCTBLC,1      APPROPIATE                                 DGE00530
       LXD     ERAPR-2,1     CELLS.                                     DGE00540
       SXA     LCTBLT,1      ALSO                                       DGE00550
       SXA     LCTBEP,1      INITIALIZE                                 DGE00560
       SXA     LCTBBP,1      SRTBBP,                                    DGE00570
       LXA     ERAPR-9,1     BFTBEP,                                    DGE00580
       SXA     SRTBLC,1      LCTBEP,                                    DGE00590
       LXA     CALPR-6,1     LCTBBP,                                    DGE00600
       SXA     SRTBLT,1      BUFREP                                     DGE00610
       SXA     SRTBBP,1      AND BFTBBP.                                DGE00620
       LXA     CALPR-12,1    GET THE LENGTH OF                          DGE00630
       SXA     XCFLTH,1      THE EXTRECTED CONTROL FIELD.               DGE00640
       CAL     *-1                                                      DGE00650
       STT     ERAPR-21                                                 DGE00660
       CAL     CALPR-26      GET THE                                    DGE00670
       SLW     MAXBLK        MAX. BLOCK LENGTH.                         DGE00680
       ADD     ONE           INCREASE BY 1 TO TAKE CARE OF WORD 1717''''DGE00690
       LAC     FILPR,2       IF THERE IS                                DGE00700
       ZET     -19,2         ANY CHECKSUM OR BLOCK SEQUENCE OPTION,     DGE00710
       ADD     ONE           INCREASE THE LIMIT BY ONE.                 DGE00720
       SLW     MXBKP1                                                   DGE00730
       SUB     ONE                                                      DGE00740
       SLW     MAXBP1                                                   DGE00750
       CAL     D2000         INCREASE 2000 WORDS LONG BLOCK BY 1        DGE00760
       ADD     ONE           TO TAKE CARE OF 171717171717.              DGE00770
       LAC     FILPR,2       IF THERE IS                                DGE00780
       ZET     -19,2         ANY CHECKSUM OR BLOCK SEQUENCE OPTION,     DGE00790
       ADD     ONE           INCREASE THE LIMIT BY ONE.                 DGE00800
       SLW     T000P                                                    DGE00810
       SUB     ONE                                                      DGE00820
       SLW     T000M                                                    DGE00830
       CAL     BUFRLC        GET THE                                    DGE00840
       ADD     BUFRLT        BASE OF                                    DGE00850
       SLW     BUFRND        BUFFER.                                    DGE00860
       SLW     BUFTOP                                                   DGE00870
       CAL     BFTBLC        GET THE                                    DGE00880
       ADD     BFTBLT        BASE OF                                    DGE00890
       SLW     BFTBND        BUFFER TABLE.                              DGE00900
       STA     BFTB1                                                    DGE00910
       STA     BFTB2                                                    DGE00920
       STA     BFTB3                                                    DGE00930
       STA     BFTB4                                                    DGE00940
       STA     BFTB5                                                    DGE00950
       STA     BFTB6                                                    DGE00960
       STA     BFTB7                                                    DGE00970
       CAL     LCTBLC        GET THE                                    DGE00980
       ADD     LCTBLT        BASE OF                                    DGE00990
       SLW     LCTBND        LOCATION TABLE.                            DGE01000
       STA     LCTB1                                                    DGE01010
       STA     LCTB2                                                    DGE01020
       STA     LCTB3                                                    DGE01030
       STA     LCTB4                                                    DGE01040
       STA     LCTB5                                                    DGE01050
       STA     LCTB8                                                    DGE01060
       STA     LCTB9                                                    DGE01070
       STA     LOCMOR                                                   DGE01080
       STA     MOVRCD                                                   DGE01090
       CAL     SRTBLC        GET THE                                    DGE01100
       ADD     SRTBLT        BASE OF                                    DGE01110
       SLW     SRTBND        SORT TABLE.                                DGE01120
       STA     SRTB1                                                    DGE01130
       STA     SRTB2                                                    DGE01140
       CAL     CALPR-3       GET                                        DGE01150
       SLW     BINLTH        BIN LENGTH                                 DGE01160
       SUB     ONE           MINUS                                      DGE01170
       SLW     BNMINS        ONE.                                       DGE01180
       LGL     18            PUT BIN LENGTH-1 IN THE                    DGE01190
       STD     COMPAR        DECR. PORTION OF COMPAR INSTRUCTION.       DGE01200
       CAL     OPTPR-1       GET THE TOTAL OF THE WORDS                 DGE01210
       ADD     OPTPR-3       REQUIRED FOR XCFLTH                        DGE01220
       ADD     XCFLTH        AND CHECKSUM OR EQUALS                     DGE01230
       SLW     XFCKEQ        OPTION IF GIVEN.                           DGE01240
       LXA     RECPR-1,2                                                DGE01250
       SXD     MXRCD,2                                                  DGE01260
       LXA     RECPR,2                                                  DGE01270
       TXI     *+1,2,-1                                                 DGE01280
       SXD     MNRCD,2                                                  DGE01290
       LXA     MXBKP1,1                                                 DGE01300
       SXD     TPTOBF,1                                                 DGE01310
       CAL     BUFRLC        INITIALIZE FOR                             DGE01320
       STA     TPTOBF        THE FIRST READ.                            DGE01330
       CLA*    CHAPR         GET THE LOCATION OF UCB                    DGE01340
       STA     LOCUCB        AND PUT IT IN LOCUCB.                      DGE01350
       PAC     ,2                                                       DGE01360
       CAL     SELLOC                                                   DGE01370
       ZET     1,2           IS THE UCW2 ZERO.                          DGE01380
       TRA     *-1           NO-WAIT.                                   DGE01390
       ENB     =0            YES-PUT THE LOC. OF SELECT IN              DGE01400
       SLW     1,2           THE DECR. PART OF UCW2.                    DGE01410
       TSX     (ACTIV,4      GO AND READ.                               DGE01420
       PZE     LOCUCB                                                   DGE01430
TSTSWA CAL     SWTCHA        IS READ COMPLETE.                          DGE01440
       TZE     ENTRY1        NO-GO AND TEST FOR THE ENTRY1 IN BUFTAB.   DGE01450
       LXA     BFTBBP,1      YES-IS BUFFER TABLE                        DGE01460
BFTB6  CLA     **,1          FULL.                                      DGE01470
       TNZ     ENTRY1        YES-GO TO ENTRY1.                          DGE01480
RDAGAN CLA     BUFBOT        NO.                                        DGE01490
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         DGE01500
       TZE     ENTRY1        IF ZERO-GO TO ENTRY1,                      DGE01510
       TMI     TPMNBT        IF MINUS-GO TO TPMNBT,                     DGE01520
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   DGE01530
       SBM     BUFBOT        CAN WE READ AGAIN                          DGE01540
       ADD     ONE           INTO THE                                   DGE01550
       CAS     MXBKP1        BUFFER.                                    DGE01560
       TRA     *+3           YES-READ                                   DGE01570
       TRA     *+2           YES-AGAIN.                                 DGE01580
       TRA     BIGRID        NO-TEST FOR READING FROM THE BEGINNING.    DGE01590
SAME1  CAL     BUFBOT        YES-MODIFY THE IORT INSTRUCTION            DGE01600
       STA     TPTOBF        TO READ AGAIN INTO THE BUFFER.             DGE01610
       TRA     RIDMEN        GO AND READ.                               DGE01620
TPMNBT CAL     BUFTOP                                                   DGE01630
       SBM     BUFBOT        CAN WE READ AGAIN                          DGE01640
       ADD     ONE           INTO THE BUFFER.                           DGE01650
       CAS     MXBKP1                                                   DGE01660
       TRA     SAME1         YES-READ                                   DGE01670
       TRA     SAME1         YES-AGAIN.                                 DGE01680
       TRA     ENTRY1        NO-GO TO ENTRY1.                           DGE01690
BIGRID CAL     BUFTOP        CAN WE READ                                DGE01700
       SBM     BUFRLC        FROM THE                                   DGE01710
       ADD     ONE           BEGINNING OF                               DGE01720
       CAS     MXBKP1        THE BUFFER.                                DGE01730
       TRA     *+3           YES-READ FROM                              DGE01740
       TRA     *+2           THE BEGINNING.                             DGE01750
       TRA     ENTRY1        NO-GO TO ENTRY1.                           DGE01760
       CAL     BUFRLC        INITIALIZE                                 DGE01770
       STA     TPTOBF        FOR                                        DGE01780
RIDMEN CLA*    CHAPR         THE                                        DGE01790
       STA     LOCUCB        READ.                                      DGE01800
       PAC     ,2                                                       DGE01810
       CAL     SELLOC                                                   DGE01820
       ZET     1,2                                                      DGE01830
       TRA     *-1                                                      DGE01840
       ENB     =0                                                       DGE01850
       SLW     1,2                                                      DGE01860
       TSX     (ACTIV,4                                                 DGE01870
       PZE     LOCUCB                                                   DGE01880
ENTRY1 LXA     BFTBEP,1      BFTBEP HAS BFTBLT FIRST TIME THROUGH.      DGE01890
BFTB1  ZET     **,1          IS THERE ANY ENTRY IN THE BUFFER TABLE.    DGE01900
       TRA     LOCATE        YES-GO AND LOCATE RECORDS.                 DGE01910
       ZET     SWTCHF        NO-IS IT EOF.                              DGE01920
       TRA     NTRY2         YES-GO TO NTRY2.                           DGE01930
       NZT     DUMPSW        NO-IS DUMP SWITCH SET.                     DGE01940
       ZET     SWTCHR        NO-IS SWITCH R SET.                        DGE01950
       TRA     GETEXT        YES-GO TO GETEXT.                          DGE01960
       TRA     ENTRY2        NO-GO TO ENTRY2.                           DGE01970
LOCATE LXA     LCTBBP,2      PUT THE LOCATION                           DGE01980
BFTB2  CAL     **,1          OF THE NEXT                                DGE01990
       LGR     18            TAPE RECORD                                DGE02000
       STA     NEXTRC        IN NEXTRC                                  DGE02010
       LGL     18            AND THE LOCATION OF THIS                   DGE02020
       STA     SERCH         TAPE RECORD IN SERCH.                      DGE02030
BFTB3  STZ     **,1          ZERO OUT BUFTAB ENTRY ALREADY BEEN LOCATED.DGE02040
       TIX     *+2,1,1       IS IT THE END OF BUFFER TABLE.             DGE02050
       LXA     BFTBLT,1      YES-REINITIALIZE REG1 WITH BFTBLT.         DGE02060
       SXA     BFTBEP,1      NO-SAVE THE NEXT ENTRY POINT TO BE TESTED. DGE02070
LOCMOR STA     **,2          STORE THE LOC. OF CONTROL WORD IN LOCTAB.  DGE02080
       CAL*    SERCH         GET THE LENGTH                             DGE02090
       SLW     WDCONT        OF THE LOGICAL RECORD.                     DGE02100
       ZET*    FILPR         IS IT BINARY.                              DGE02110
       TRA     BINARY        YES-BINARY.                                DGE02120
       TSX     DECBIN,4      NO-BCD-GO AND CONVERT                      DGE02130
       TRA     DELOPT        IT TO BINARY.                              DGE02140
BINARY CAL*    SERCH         INCREASE THE LENGTH                        DGE02150
       PDX     ,4            OF LOGICAL                                 DGE02160
       PXA     ,4            RECORD BY 1                                DGE02170
       ADD     ONE           TO TAKE CARE OF                            DGE02180
       SLW     WDCONT        THE CONTROL WORD.                          DGE02190
DELOPT LGL     18            STORE THE COUNT WORD IN                    DGE02200
LCTB1  STD     **,2          THE DECR. PART OF LOCATE TABLE.            DGE02210
*                                                                       DGE02220
       PDX     ,4            IS THIS RECORD OUT OF RANGE.               DGE02230
MXRCD  TXH     ERROR,4,**    (MAX RCD LENGTH).                          DGE02240
MNRCD  TXL     ERROR,4,**    (MIN.RCD LENGTH-1).   YES.                 DGE02250
       TRA     USUAL         NO.                                        DGE02260
ERROR  CAL     SERCH         PRINT THE MESSAGE SAYING-                  DGE02270
       LGL     18            INVALID RECORD FORMAT *VR01                DGE02280
       XCL                   RECORD AT LOC. XXXXXX                      DGE02290
       TSX     (BCD5R,4      PAUSE                                      DGE02300
       STO     MESAG5+3      PRESS START TO DELETE SORT.                DGE02310
       TSX     MSGSUP,4,2                                               DGE02320
       PZE     3                                                        DGE02330
       PZE     MESAG6,,5                                                DGE02340
       PZE     MESAG5,,4                                                DGE02350
       PZE     MESAG7,,5                                                DGE02360
       TSX     (PAUSE,4                                                 DGE02370
       LXD     GENPR-3,4                                                DGE02380
       TRA     4,4                                                      DGE02390
*                                                                       DGE02400
USUAL  CAL     CNTPR-14      KEEP COUNT OF THE                          DGE02410
       ADD     =1            NO. OF LOGICAL RECORDS.                    DGE02420
       SLW     CNTPR-14                                                 DGE02430
       NZT     DELPR         DELETE OPTION.                             DGE02440
       TRA     NODELT        NO.                                        DGE02450
       PXA     ,2                                                       DGE02460
       SSM                                                              DGE02470
       ADD     LCTBND                                                   DGE02480
       STO     ERAPR-11                                                 DGE02490
       AXT     1,4                                                      DGE02500
       SXD     ERAPR-11,4                                               DGE02510
       CALL    DELETE        YES.                                       DGE02520
LCTB2  CAL     **,2                                                     DGE02530
       PDX     ,1                                                       DGE02540
       TXL     OVRLAY,1,0                                               DGE02550
NODELT TIX     *+2,2,1       IS IT THE END OF LOCATE TABLE.             DGE02560
       LXA     LCTBLT,2      YES-REINITIALIZE REG2 WITH LCTBLT.         DGE02570
OVRLAY SXA     LCTBBP,2      NO-GET THE LOCATION OF SUPPOSEDLY NXT RCD. DGE02580
LCTB9  STZ     **,2                                                     DGE02590
       CAL     WDCONT        IS IT                                      DGE02600
       ADD     SERCH         SAME AS THE                                DGE02610
       STA     SERCH         THE NEXT                                   DGE02620
       CAS     NEXTRC        TAPE RECORD.                               DGE02630
       TRA     ENTRY1        YES-WE ARE THROUGH WITH                    DGE02640
       TRA     ENTRY1        YES-LOCATING THE LOGICAL RECORDS.          DGE02650
       TRA     LOCMOR                                                   DGE02660
NTRY2  LXA     LCTBEP,1      IS THERE ANY ENTRY IN                      DGE02670
LCTB3  ZET     **,1          THE LOCATE TABLE.                          DGE02680
       TRA     LCTB5         YES- GO TO LCTB5.                          DGE02690
       CAL     SRTBLT        NO-IS THERE ANY ENTRY                      DGE02700
       SBM     SRTBBP        IN THE SORT TABLE.                         DGE02710
       TNZ     GETEXT        YES-GO TO GETEXT WITHOUT SETTING EOF FOR XSDGE02720
       STL     RAWPR-3       NO-SET EOF INDICATOR FOR XS AND            DGE02730
       TRA     GETEXT        GO TO GETEXT.                              DGE02740
ENTRY2 LXA     LCTBEP,1      IS THERE ANY ENTRY IN                      DGE02750
LCTB4  ZET     **,1          THE LOCATE TABLE.                          DGE02760
       TRA     LCTB5         YES- GO AND TEST FOR TME AVAILABLE FINS.   DGE02770
       NZT     SWTCHA        IS READ COMPLETE.                          DGE02780
       TRA     ENTRY1        NO.                                        DGE02790
       LXA     BFTBEP,1      YES.                                       DGE02800
       XEC     BFTB1         ANY ENTRY IN THE BUFFER TABLE.             DGE02810
       TRA     ENTRY1        YES.                                       DGE02820
       CAL     BUFRND        NO. UPDATE BUFTOP                          DGE02830
       SLW     BUFTOP         AND BUFBOT.                               DGE02840
       CAL     BUFRLC                                                   DGE02850
       SLW     BUFBOT                                                   DGE02860
       ZET     DUMPSW        IS DUMP SWITCH SET.                        DGE02870
       TRA     GETEXT        YES.                                       DGE02880
       ZET     SWTCHF        NO.  IS IT EOF                             DGE02890
       TRA     NTRY2          YES.                                      DGE02900
       ZET     SWTCHR         NO.  IS SWTCHR SET.                       DGE02910
       TRA     GETEXT          YES.                                     DGE02920
       TRA     TPMNBT        NO. READ FROM THE TOP OF BUFFER.           DGE02930
LCTB5  CAL     **,1          STORE ADDRESS OF LOCATION PRIOR         (8)DGE02940
       SUB     =1             TO FIRST WORD OF LOGICAL RECORD        (8)DGE02941
       STA     ERAPR-26       FROM CONTROL WORD IN LOCATE TABLE      (8)DGE02942
       LGR     18            STORE LENGTH OF LOGICAL RECORD          (8)DGE02950
       STA     RCDLTH         FROM CONTROL WORD IN LOCATE TABLE      (8)DGE02960
       ZET     NOTCMP        DID IT COME FROM READ INCOMPLETE.          DGE02970
       TRA     SMALUP        YES-GO TO SMALUP.                          DGE02980
       CAL     ERAPR-3       NO.                                        DGE02990
       SUB     ONE           GET THE BASE OF AVAILABLE BINS TABLE       DGE03000
       SLW     ATND          ON THE TOP OF L TABLE.                     DGE03010
       STA     AVAL1                                                    DGE03020
       STA     AVAL2                                                    DGE03030
       STA     ERAPR-21                                                 DGE03040
       LAC     ATLT,2        FIND OUT                                   DGE03050
       SXA     NWATLT,2      THE TOTAL                                  DGE03060
       LDQ     ATLT          NUMBER                                     DGE03070
TSTBIN MPY     BNMINS        OF BINS                                    DGE03080
       XCA                   AVAILABLE.                                 DGE03090
       SUB     XFCKEQ        ARE THERE                                  DGE03100
       STO     AVLCEL        ENOUGH BINS                                DGE03110
       CAL     RCDLTH        TO CONTAIN THE                             DGE03120
       CAS     AVLCEL        LAST LOGICAL RECORD.                       DGE03130
       TRA     GETEXT        NO-GO TO GETEXT.                           DGE03140
       TRA     TSTMOD        YES-GO TO                                  DGE03150
       TRA     TSTMOD        YES-TSTMOD.                                DGE03160
SMALUP CAL     THISAV        GET NEW LENGTH OF                          DGE03170
       ADD     ONE           THE REMAINING                              DGE03180
       STA     NWATLT        AVAILABLE CELLS.                           DGE03190
       PAC     ,2                                                       DGE03200
       PXA     ,2                                                       DGE03210
       XCA                                                              DGE03220
       TRA     TSTBIN                                                   DGE03230
TSTMOD ZET     MOD05                                                    DGE03240
       CALL    XSM06         MODIFICATION EXIT.                         DGE03250
       TRA     MOVRCD        NORMAL RETURN.                             DGE03260
NOBIN  TRA     GETEXT        CANNOT REPLACE OR INSERT RECORD.           DGE03270
       TRA     FRMMOD        RECORD INSERTED.                           DGE03280
       TRA     ZROLCT        RECORD REPLACED.                           DGE03290
       STL     MODELT        RECORD DELETED.                            DGE03300
       TRA     ZROLCT                                                   DGE03310
MOVRCD CAL     **,1          REG1 HAS THE SAME VALUE AS ENTRY2.         DGE03320
       ADD     RCDLTH        DETERMINE THE                              DGE03330
       STA     RCDEND        BASE OF A                                  DGE03340
       STA     FILBIN        LOGICAL RECORD                             DGE03350
       STA     RCDND1        AND INITIALISE                             DGE03360
       LXA     RCDLTH,2      REG2 WITH RCDLTH.                          DGE03370
       SUB     ONE           PUT THE LAST LOCATION OF THE AREA VACATED  DGE03380
       STA     TMPBTP                                                   DGE03390
       CAL     BNMINS        INITIALISE REG 4 WITH                      DGE03400
       SUB     XCFLTH        BINLTH-FINALE WORD-XCFLTH                  DGE03410
       PAX     ,4            FOR FILLING UP THE FIRST BIN.              DGE03420
       LXA     NWATLT,1                                                 DGE03430
FINRCD CAL*    ERAPR-21      DETERMINE                                  DGE03440
       SXA     THISAV,1      THE BASE                                   DGE03450
       ADD     BINLTH        OF THE                                     DGE03460
       SUB     ONE           BIN (BINEND).                              DGE03470
       STA     BINEND                                                   DGE03480
       STA     BIN1                                                     DGE03490
       STA     BIN2                                                     DGE03500
       STA     BIN3                                                     DGE03510
       ZET     FRSTIM        IS IT FIRST TIME THRU FOR PARTICULAR RCD.  DGE03520
       TRA     FILBIN        NO-GO AND FILL UP THE NEXT BIN.            DGE03530
       NZT     OPTPR-3       YES-IS THERE ANY EQUALS OPTION.            DGE03540
       TRA     TSTCKS        NO-GO TO TSTCKS.                           DGE03550
       CAL     EQLSWD        YES-CALCULATE EQUALS WORD.                 DGE03560
       ADD     =1                                                       DGE03570
       SLW     EQLSWD                                                   DGE03580
BIN1   SLW     **,4          STORE EQUALS WORD INTO THE BIN.            DGE03590
       TIX     *+1,4,1                                                  DGE03600
TSTCKS NZT     OPTPR-1       IS THERE  CHECKSUM OPTION.                 DGE03610
       TRA     FILBIN        NO-GO TO FILBIN.                           DGE03620
       ZAC                   YES-CALCULATE CHECKSUM.                    DGE03630
RCDND1 ACL     **,2                                                     DGE03640
       TIX     *-1,2,1                                                  DGE03650
       ZET     OPTPR-3       IS THERE EQUALS OPTION.                    DGE03660
       ACL     EQLSWD        YES-ADD EQLSWD ALSO.                       DGE03670
       LXA     RCDLTH,2                                                 DGE03680
BIN2   SLW     **,4          STORE CHECKSUM INTO THE BIN.               DGE03690
       TIX     *+1,4,1                                                  DGE03700
FILBIN CAL     **,2          MOVE THE CONTROL WORD AND THE WORDS OF A   DGE03710
BIN3   SLW     **,4          LOGICAL RECORD INTO THE BINS.              DGE03720
       TIX     TIX,2,1       IS THE LOGICAL RECORD EXHAUSTED.           DGE03730
       STZ*    BINEND        YES-PUT ZEROES IN THE FINALE WORD.         DGE03740
       CAL     TMPBTP                                                   DGE03750
       STA     BUFTOP        IN BUFTOP-POINTER IS ON THE BLANK SIDE.    DGE03760
       TRA     ZROLCT        GO AND CHECK FOR READ COMPLETION.          DGE03770
TIX    TIX     FILBIN,4,1    NO-IS BIN EXHAUSTED.NO-GO FILL UP THE BIN. DGE03780
COMPAR TXH     *+3,2,**      YES-CAN THE REMAINING LOGICAL RECORD FIT   DGE03790
       SXD     FINALE,2      IN THE NEXT BIN.YES-PUT IT IN FINALE WORD. DGE03800
       TRA     *+3                                                      DGE03810
       LXA     BNMINS,1      NO-PUT BINLTH IN THE                       DGE03820
       SXD     FINALE,1      DECREMENT PORTION OF FINALE.               DGE03830
       LXA     THISAV,1      PUT THE ADDRESS OF THE                     DGE03840
       TXI     *+1,1,1       NEXT AVAILABLE BIN INTO THE                DGE03850
AVAL1  CAL     **,1          ADDRESS PORTION OF FINALE WORD.            DGE03860
       STA     FINALE                                                   DGE03870
       CAL     FINALE        PUT FINALE WORD IN THE                     DGE03880
       SLW*    BINEND        LAST WORD OF A BIN.                        DGE03890
       LXA     BNMINS,4      REINITIALIZE REG.4 WITH BNMINS.            DGE03900
       STL     FRSTIM                                                   DGE03910
       TRA     FINRCD        GO AND FINISH THIS LOGICAL RECORD.         DGE03920
ZROLCT LXA     LCTBEP,1      ZERO OUT THE CELLS IN                      DGE03930
LCTB8  STZ     **,1          LOCTAB WHICH HAVE BEEN MOVED INTO THE BINS.DGE03940
       TIX     *+2,1,1       POINT TO THE NEXT                          DGE03950
       LXA     LCTBLT,1      LOCATION IN LOCATE TABLE.                  DGE03960
       SXA     LCTBEP,1                                                 DGE03970
       NZT     MODELT                                                   DGE03980
       TRA     FRMMOD                                                   DGE03990
       STZ     MODELT                                                   DGE04000
       TRA     FROMOD                                                   DGE04010
FRMMOD STZ     FRSTIM                                                   DGE04020
       LXA     SRTBBP,2      SRTBBP HAS                                 DGE04030
       CAL     RCDLTH        SRTBLT INITIALLY.                          DGE04040
       ADD     XFCKEQ        PUT THE LENGTH OF                          DGE04050
       SBM     XCFLTH        CKSM+EQUAL+CONTROL WORD+LOGICAL RECORD     DGE04060
       LGL     18            IN THE DECR. PART                          DGE04070
       ORA     =O600000100000   AND THE LOCATION OF                     DGE04080
SRTB1  SLW     **,2          THE FIRST BIN INTO                         DGE04090
       LXA     NWATLT,1      THE ADDRESS PORTION OF                     DGE04100
AVAL2  CAL     **,1          THE INSTRUCTION IN THE SORT TABLE.         DGE04110
       ADM     XCFLTH                                                   DGE04120
SRTB2  STA     **,2          IN SHORT-UPDATE THE SORT TABLE.            DGE04130
       TIX     *+4,2,1       IS SORT TABLE FULL.                        DGE04140
       TXI     *+1,2,-1      YES-REDUCE IT TO ZERO AND                  DGE04150
       SXA     SRTBBP,2      SAVE IT.                                   DGE04160
       TRA     GETEXT        GO TO GETEXT.                              DGE04170
       SXA     SRTBBP,2      NO-SAVE REG2.                              DGE04180
FROMOD ZET     SWTCHF        IS IT EOF.                                 DGE04190
       TRA     SETNCM        YES-GO TO SETNCM.                          DGE04200
       CAL     SWTCHA        NO-IS READ                                 DGE04210
       TZE     SETNCM        COMPLETE.                                  DGE04220
       NZT     DUMPSW        YES-IS DUMP SWITCH SET.                    DGE04230
       ZET     SWTCHR        NO-IS SWITCH R SET.                        DGE04240
       TRA     GETEXT        YES-GO TO GETEXT.                          DGE04250
       STL     NOTCMP        NO-SET NOTCMP SWITCH AND                   DGE04260
       TRA     RDAGAN        THEN GO TO RDAGAN.                         DGE04270
SETNCM STL     NOTCMP        NO-SET NOTCMP SWITCH AND                   DGE04280
       TRA     ENTRY2        GO TO ENTRY2.                              DGE04290
GETEXT LXA     THISAV,1      REDUCE THISAV BY 1 AS THIS                 DGE04300
       TXI     *+1,1,1       BIN HAS ALREADY                            DGE04310
       SXA     FINALT,1      BEEN USED UP.                              DGE04320
       LAC     FINALT,1                                                 DGE04330
       SXD     ERAPR-3,1                                                DGE04340
       CAL     SRTBLT        GIVE THE LENGTH                            DGE04350
       SUB     SRTBBP        OF SORT TABLE.                             DGE04360
       LGL     18                                                       DGE04370
       STD     ERAPR-9       NOTE THAT IT HAS THE SAME LOCATION.        DGE04380
EXTRGS AXT     **,1                                                     DGE04390
       AXT     **,2                                                     DGE04400
       AXT     **,4                                                     DGE04410
       STL     GENPR-5                                                  DGE04420
       STZ     NOTCMP                                                   DGE04430
       TRA     1,4           GO BACK TO XS.                             DGE04440
       EJECT                                                            DGE04450
************************************************************************DGE04460
*  CONVERSION OF CONTROL WORD FROM BCD TO BINARY.                       DGE04470
************************************************************************DGE04480
       SPACE   2                                                        DGE04490
DECBIN SXA     DECSV4,4                                                 DGE04500
       LDQ     WDCONT                                                   DGE04510
       AXT     30,4                                                     DGE04520
       ZAC                                                              DGE04530
       STZ     DEC1          ZERO OUT SUM HOLDER.                       DGE04540
DECBLP LGL     6             GET NEXT DIGIT.                            DGE04550
       ACL     DEC1          ADD SUM HOLDER.                            DGE04560
       TNX     DECONT,4,6    TO EXIT IF FINISHED.                       DGE04570
       STQ     DEC2                                                     DGE04580
       XCL                                                              DGE04590
       MPY     =10                                                      DGE04600
       STQ     DEC1          SAVE PARTIAL PRODUCT.                      DGE04610
       LDQ     DEC2                                                     DGE04620
       TRA     DECBLP                                                   DGE04630
DECONT XCL                                                              DGE04640
       ZAC                                                              DGE04650
       DVP     =6            IS THE CONTROL WORD MULTIPLE OF 6.         DGE04660
       TNZ     NOTMLT        NO-GO TO NOTMLT.                           DGE04670
       STQ     WDCONT        YES.                                       DGE04680
       XCL                                                              DGE04690
DECSV4 AXT     **,4                                                     DGE04700
       TRA     1,4                                                      DGE04710
NOTMLT TRA     ERROR         GO AND PRINT THE MESSAGE AND DELETE SORT.  DGE04720
       EJECT                                                            DGE04730
************************************************************************DGE04740
*                  SELECT    ROUTINE                                    DGE04750
************************************************************************DGE04760
       SPACE   2                                                        DGE04770
SELECT SXA     SAVIOX,1      SAVE                                       DGE04780
       SXA     SAVIOX+1,2    ALL THE                                    DGE04790
       SXA     SAVIOX+2,4    REGS.                                      DGE04800
       STA     LOCUCB        SAVE AC (LOC. OF UCB).                     DGE04810
       PAX     ,2            GET THE LOCATION OF SECOND WORD            DGE04820
       TXI     *+1,2,1       OF A UCB AND STORE                         DGE04830
       SXA     UCW2,2        IT IN UCW2.                                DGE04840
       TMI     RSELM         IF AC IS MINUS-GO TO RSELM.                DGE04850
       SPACE   5                                                        DGE04860
*                                                                       DGE04870
*      SELECT (+) ROUTINE                                               DGE04880
*                                                                       DGE04890
       STZ     SWTCHA                                                   DGE04900
       CLA*    CHAPR         NO-THIS IS SELECT(+) ROUTINE.              DGE04910
       STA     *+1           GET THE TAPE                               DGE04920
       CLA     **            UNIT ADDRESS.                              DGE04930
       ANA     =O017777000000                                           DGE04940
       PDX     ,4                                                       DGE04950
       ZET*    FILPR         IS INPUT IN BCD.                           DGE04960
       TXI     *+1,4,16      NO-BINARY.                                 DGE04970
       SXA     BFREAD,4      YES-BCD.PUT UNIT ADDRESS IN BFREAD.        DGE04980
       CAL     REDNCY        WAS THERE ANY REDUNDANCY IN THE LAST RCD.  DGE04990
       TNZ     REREAD        YES-GO TO REREAD.                          DGE05000
       CAL     SWTCHL        NO-IS SWITCH L SET.                        DGE05010
       TNZ     R2000         YES-GO TO R2000.                           DGE05020
       AXT     MAXBP1,2      NO-MODIFY ADDD                             DGE05030
       SXA     ADDD,2        BY MAXBP1.                                 DGE05040
       CAL     TPTOBF        PUT THE RCKWRD                             DGE05050
ADDD   ADD     **            VIZ.171717171717 INTO THE                  DGE05060
       SLW     CKWORD        LAST CELL OF THE BUFFER                    DGE05070
       CAL     RCKWRD        WHERE THE LONGEST                          DGE05080
       SLW*    CKWORD        RECORD IS TO BE READ.                      DGE05090
       CAL     SWIORT        MODIFY                                     DGE05100
       STA*    (RCHXI        IORT INSTRUCTION.                          DGE05110
       TRA     BFREAD                                                   DGE05120
R2000  AXT     T000M,2       MODIFY ADDD                                DGE05130
       SXA     ADDD,2        BY T000M.                                  DGE05140
       TRA     ADDD-1                                                   DGE05150
BFREAD RDS     **            READ                                       DGE05160
       XEC*    (RCHXI        TAPE.                                      DGE05170
       STL     REDNCY        SET SWITCH CALLED REDNCY.                  DGE05180
       TRA     SAVIOX                                                   DGE05190
REREAD CAL     SWIORT                                                   DGE05200
       STA*    (RCHXI                                                   DGE05210
       TRA     BFREAD                                                   DGE05220
       SPACE   10                                                       DGE05230
*                                                                       DGE05240
*     SELECT (-) ROUTINE                                                DGE05250
*                                                                       DGE05260
RSELM  STZ     REDNCY        RESET SWITCH CALLED REDNCY.                DGE05270
       LNT     400000        NOISE                                   (4)DGE05280
       TRA     2,4           YES                                     (4)DGE05290
       LFT     300000        EOT OR REDUNDANCY                       (4)DGE05300
       TRA     TSTEOF        YES, GO TEST                            (4)DGE05310
       CAL     SWTCHL        NO-IS SWITCH L SET.                        DGE05320
       TNZ     NOCHNG        YES-GO TO NOCHNG.                          DGE05330
       CAL     TPTOBF        NO-CHECK THE WORD FOLLOWING THE            DGE05340
       ADD     MAXBP1        MAX. EXPECTED LENGTH TO SEE                DGE05350
       STA     CKLTRC        IF BLOCK IS LONGER THAN THE                DGE05360
       CAL*    CKLTRC        PARAMETER GIVEN BY THE USER.               DGE05370
       LAS     RCKWRD        IS IT LONGER THAN EXPECTED.                DGE05380
       TRA     LONGER        YES-GO TO LONGER.                          DGE05390
       TRA     OK            NO-GO TO OK.                               DGE05400
       TRA     LONGER        YES-GO TO LONGER.                          DGE05410
NOCHNG CAL     TPTOBF        CHECK THE WORD FOLLOWING THE               DGE05420
       ADD     T000M         2000 WORDS LONG RECORD TO SEE IF           DGE05430
       STA     CKLTRC        BLOCK IS LONGER THAN 2000 WORDS.           DGE05440
       CAL*    CKLTRC        IS IT LONGER                               DGE05450
       LAS     RCKWRD        THAN 2000 WORDS.                           DGE05460
       TRA     VRYLNG        YES-GO TO VRYLNG.                          DGE05470
       TRA     BITLNG        NO-GO TO BITLNG.                           DGE05480
       TRA     VRYLNG        YES-GO TO VRYLNG.                          DGE05490
VRYLNG STL     DUMPSW        SET DUMP SWITCH.                           DGE05500
       STZ     SWTCHL        RESET SWITCH L.                            DGE05510
       CAL     (COMMM        CHANGE THE COUNT IN THE                    DGE05520
       SBM     TPTOBF        DECR. PART OF THE IORT                     DGE05530
       LGL     18            INSTRUCTION TO THE ACTUAL                  DGE05540
       STD     TPTOBF        LENGTH OF THE TAPE BLOCK.                  DGE05550
       TSX     PRINTR,4      GO AND PRINT THE MESSAGE.                  DGE05560
       TRA     RELESE        GO TO RELESE.                              DGE05570
BITLNG CAL     (COMMM                                                   DGE05580
       SBM     TPTOBF                                                   DGE05590
       TSX     (DECVA,4                                                 DGE05600
       STQ     LGACMS+3      PRINT OUT THE MESSAGE SAYING-              DGE05610
       TSX     UNITSM,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          DGE05620
       TSX     (PROUT,4      LONG BLK ACCEPTED,XXXXXX,*RD11.            DGE05630
       PZE     1                                                        DGE05640
       PZE     LGACMS,,5                                                DGE05650
OK     CAL     TPTOBF                                                   DGE05660
       LXA     BFTBBP,1      BFTBBP HAS BFTBLT INITIALLY.               DGE05670
BFTB4  STA     **,1          PUT THE BEGINNING OF THE LAST              DGE05680
       CAL     (COMMM        RECORD READ INTO THE ADDRESS PART          DGE05690
       LAC     FILPR,4       AND BEGINNING OF NEXT RECORD OR THE        DGE05700
       ZET     -19,4         LOC. OF THE CHECKSUM AND/OR BLOCK SEQ. OF  DGE05710
       SUB     ONE           THE LAST RECORD READ                       DGE05720
       LGL     18            IN THE DECR. PART OF THE                   DGE05730
BFTB5  STD     **,1          CELL IN THE BUFFER TABLE.                  DGE05740
       LGR     18                                                       DGE05750
       STA     BUFBOT                                                   DGE05760
       CAL     (COMMM                                                   DGE05770
       SBM     TPTOBF                                                   DGE05780
       STA     HWLNG                                                    DGE05790
       TIX     *+2,1,1       IS IT THE END OF THE BUFFER TABLE.         DGE05800
       LXA     BFTBLT,1      YES-REINITIALIZE WITH BFTBLT.              DGE05810
       SXA     BFTBBP,1      NO-SAVE THE REMAINING LENGTH OF THE BUFTAB.DGE05820
       TSX     CKSQW,4       GO AND CHECK FOR CHECKSUM AND BLOCK SEQ.   DGE05830
       CAL     SWTCHL        IS SWITCH L SET.                           DGE05840
       TZE     READAG        NO-GO TO READAG.                           DGE05850
       STZ     SWTCHL        YES-RESET SWITCH L AND                     DGE05860
       CAL     MXBKP1        CHANGE THE WORD COUNT                      DGE05870
       LGL     18            FROM 2000 TO MXBKP1                        DGE05880
       STD     TPTOBF        IN THE IORT COMMAND.                       DGE05890
READAG LXA     BFTBBP,1      IS BUFFER TABLE                            DGE05900
BFTB7  CLA     **,1          FULL.                                      DGE05910
       TNZ     RELESE        YES-GO TO RELESE.                          DGE05920
       CLA     BUFBOT        NO.                                        DGE05930
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         DGE05940
       TZE     RELESE        IF ZERO-GO TO RELESE,                      DGE05950
       TMI     TPMIBT        IF MINUS-GO TO TPMIBT,                     DGE05960
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   DGE05970
       SBM     BUFBOT        CAN WE READ AGAIN                          DGE05980
       ADD     ONE           INTO THE BUFFER.                           DGE05990
       CAS     MXBKP1                                                   DGE06000
       TRA     *+3           YES-READ AGAIN                             DGE06010
       TRA     *+2           YES-INTO THE BUFFER.                       DGE06020
       TRA     RIDBIG        NO-GO TO RIDBIG.                           DGE06030
SAME2  CAL     BUFBOT        MODIFY TPTOBF TO                           DGE06040
       STA     TPTOBF        READ AGAIN INTO THE BUFFER.                DGE06050
       STZ     SWTCHA        RESET SWITCH A.                            DGE06060
       TRA     SAVIOX        GO TO SAVIOX.                              DGE06070
TPMIBT CAL     BUFTOP                                                   DGE06080
       SBM     BUFBOT        CAN WE READ AGAIN                          DGE06090
       ADD     ONE           INTO THE BUFFER.                           DGE06100
       CAS     MXBKP1                                                   DGE06110
       TRA     SAME2         YES-READ                                   DGE06120
       TRA     SAME2         YES-AGAIN.                                 DGE06130
       TRA     RELESE                                                   DGE06140
RIDBIG CAL     BUFTOP        CAN WE                                     DGE06150
       SBM     BUFRLC        READ FROM                                  DGE06160
       ADD     ONE           THE BEGINNING                              DGE06170
       CAS     MXBKP1        OF THE BUFFER.                             DGE06180
       TRA     *+3           YES                                        DGE06190
       TRA     *+2           YES.                                       DGE06200
       TRA     RELESE        NO-GO TO RELESE.                           DGE06210
SAME3  CAL     BUFRLC        MODIFY TPTOBF TO READ                      DGE06220
       TRA     SAME2+1       FROM THE BEGINNING OF THE BUFFER.          DGE06230
RELESE STZ*    UCW2          ZERO OUT SECOND WORD IN UCB.               DGE06240
       STL     SWTCHA        SET SWITCH A.                              DGE06250
SAVIOX AXT     **,1          RESTORE ALL                                DGE06260
       AXT     **,2          THE REGS. AND                              DGE06270
       AXT     **,4          GO BACK                                    DGE06280
       STL     GENPR-4       TO IOEX.                                   DGE06290
       TRA     1,4                                                      DGE06300
LONGER TSX     (NDATA,4      TO BACK SPACE ONE BLOCK                    DGE06310
       PZE     LOCUCB,,5     GO TO (NDATA.                              DGE06320
       STL     SWTCHL        SET SWITCH L.                              DGE06330
       CAL     T000P         CHANGE THE WORD COUNT                      DGE06340
       LGL     18            IN TPTOBF TO 2000.                         DGE06350
       STD     TPTOBF                                                   DGE06360
       CLA     BUFBOT                                                   DGE06370
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         DGE06380
       TZE     RELESE        IF ZERO-GO TO RELESE,                      DGE06390
       TMI     TPMYBT        IF MINUS-GO TO TPMYBT,                     DGE06400
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   DGE06410
       SBM     BUFBOT        CAN WE READ 2000                           DGE06420
       ADD     ONE           WORDS AGAIN                                DGE06430
       CAS     T000P         INTO THE BUFFER.                           DGE06440
       TRA     *+3           YES-GO AND                                 DGE06450
       TRA     *+2           YES-READ.                                  DGE06460
       TRA     REDBEG        NO-GO TO REDBEG.                           DGE06470
       CAL     BUFBOT        MODIFY TPTOBF                              DGE06480
       STA     TPTOBF        TO READ AGAIN INTO THE BUFFER.             DGE06490
       STZ     SWTCHA        RESET SWITCH A.                            DGE06500
       TRA     SAVIOX        GO TO SAVIOX.                              DGE06510
REDBEG CAL     BUFTOP        CAN WE                                     DGE06520
       SBM     BUFRLC        READ 2000 WORDS                            DGE06530
       ADD     ONE           FROM THE BEGINNING                         DGE06540
       CAS     T000P         OF THE BUFFER.                             DGE06550
       TRA     SAME3         YES.                                       DGE06560
       TRA     SAME3         YES.                                       DGE06570
       TRA     RELESE        NO-GO TO RELESE.                           DGE06580
TPMYBT CAL     BUFTOP                                                   DGE06590
       SBM     BUFBOT        CAN WE READ                                DGE06600
       ADD     ONE           2000 WORDS AGAIN                           DGE06610
       CAS     T000P         INTO THE BUFFER.                           DGE06620
       TRA     SAME2         YES-READ                                   DGE06630
       TRA     SAME2         YES-AGAIN.                                 DGE06640
       TRA     RELESE        NO-GO TO RELESE.                           DGE06650
TSTEOF LFT     200000        IS IT EOF.                                 DGE06660
       TRA     SETR          YES-GO AND SET SWITCH R.                   DGE06670
       STL     DUMPSW        -NO-(PARMANENT REDNCY) SET DUMP SWITCH.    DGE06680
       STL     SWTCHA        SET SWITCH A.                              DGE06690
       STZ*    UCW2          ZERO OUT UCW2.                             DGE06700
       CAL     (COMMM        CHANGE THE                                 DGE06710
       SBM     TPTOBF        COUNT IN THE DECREMENT                     DGE06720
       LGL     18            PORTION OF IORT INSTRUCTION                DGE06730
       STD     TPTOBF        TO ACTUAL LENGTH OF TAPE BLOCK.            DGE06740
       TSX     PRINTR,4      GO AND PRINT THE MESSAGE.                  DGE06750
       TRA     SAVIOX                                                   DGE06760
SETR   STL     SWTCHR        SET SWITCH R.                              DGE06770
       TRA     RELESE                                                   DGE06780
*                                                                       DGE06790
PRINTR SXA     RESTRE,4      ROUTINE TO PRINT THE MESSAGE SAYING-       DGE06800
       TSX     (DECVD,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          DGE06810
       STQ     DPMSG+3       UNRDBL RECORD DUMPED,XXXXXX,*RD01.         DGE06820
       TSX     UNITSM,4                                                 DGE06830
       TSX     (PROUT,4                                                 DGE06840
       PZE     1                                                        DGE06850
       PZE     DPMSG,,5                                                 DGE06860
RESTRE AXT     **,4                                                     DGE06870
       TRA     1,4                                                      DGE06880
*                                                                       DGE06890
UNITSM SXA     RESTOR,4      ROUTINE TO PRINT-                          DGE06900
       SXA     RESTOR+1,2    UNIT XX,FILE XXXXXX,RECORD XXXXXX.         DGE06910
       LAC     LOCUCB,2                                                 DGE06920
       CAL     2,2                                                      DGE06930
       TSX     (DECVD,4                                                 DGE06940
       STQ     UNTMSG+1                                                 DGE06950
       CAL     2,2                                                      DGE06960
       TSX     (DECVA,4                                                 DGE06970
       STQ     UNTMSG+4                                                 DGE06980
       LDQ     0,2                                                      DGE06990
       TSX     MSGSUP,4,3                                               DGE07000
       PZE     UNTMSG,,5                                                DGE07010
RESTOR AXT     **,4                                                     DGE07020
       AXT     **,2                                                     DGE07030
       TRA     1,4                                                      DGE07040
       EJECT                                                            DGE07050
************************************************************************DGE07060
*    CHECK SUM AND BLOCK SEQUENCE ROUTINE                               DGE07070
************************************************************************DGE07080
       SPACE   2                                                        DGE07090
CKSQW  SXA     SAVE4,4                                                  DGE07100
       CAL     (COMMM        GET THE                                    DGE07110
       SUB     ONE           LAST WORD                                  DGE07120
       STA     SUMUP         IN A BLOCK.                                DGE07130
       STA     BBASE                                                    DGE07140
       LAC     FILPR,2       IS THERE A                                 DGE07150
       NZT     -8,2          CHECKSUM OPTION.                           DGE07160
       TRA     SUMOK         NO-GO TO SUMOK.                            DGE07170
       LXA     HWLNG,4       YES-CALCULATE                              DGE07180
       TXI     *+1,4,-1      THE CHECKSUM.                              DGE07190
       ZAC     ,0                                                       DGE07200
SUMUP  ACL     **,4                                                     DGE07210
       TIX     *-1,4,1                                                  DGE07220
       LGR     18                                                       DGE07230
       STZ     TEMP                                                     DGE07240
       SLQ     TEMP                                                     DGE07250
       ALS     18                                                       DGE07260
       ACL     TEMP                                                     DGE07270
       LBT                                                              DGE07280
       TRA     *+2           IS THE CALCULATED                          DGE07290
       ACL     =O1000000     CHECKSUM                                   DGE07300
       ERA*    BBASE         SAME AS THAT                               DGE07310
       ANA     =O777777000000 IN THE INPUT.                             DGE07320
       TZE     SUMOK         YES-GO TO SUMOK.                           DGE07330
       TSX     UNITSM,4      NO-PRINT OUT THE MASSAGE SAYING-           DGE07340
       TSX     (PROUT,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          DGE07350
       PZE     1             INPUT CHKSM ERROR *RD02                    DGE07360
       PZE     MESAG8,,4                                                DGE07370
SUMOK  LAC     FILPR,4       IS THERE A                                 DGE07380
       NZT     -9,4          BLOCK SEQUENCE OPTION.                     DGE07390
       TRA     SEQOK         NO-GO TO SEQOK.                            DGE07400
       LAC     LOCUCB,2                                                 DGE07410
       CAL     2,2           YES-IS IT O.K.                             DGE07420
       ERA*    BBASE                                                    DGE07430
       PAX     ,4                                                       DGE07440
       TXL     SEQOK,4,0     YES-GO TO SEQOK.                           DGE07450
       CLA*    BBASE         NO-PRINT OUT THE                           DGE07460
       TSX     (DECVA,4      MESSAGE SAYING-                            DGE07470
       STQ     MESAG9+4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          DGE07480
       TSX     UNITSM,4      INPUT BLOCK SEQ ERROR XXXXXX *RD03.        DGE07490
       TSX     (PROUT,4                                                 DGE07500
       PZE     1                                                        DGE07510
       PZE     MESAG9,,6                                                DGE07520
       CLA*    BBASE                                                    DGE07530
       STA     2,2                                                      DGE07540
SEQOK  BSS     0                                                        DGE07550
SAVE4  AXT     **,4                                                     DGE07560
       TRA     1,4                                                      DGE07570
       EJECT                                                            DGE07580
*                                                                       DGE07590
* CLOSE PRESENT FILE AND OPEN NEW FILE (IF ANY).                        DGE07600
*                                                                       DGE07610
CLOSE  CALL    SAVEW         SAVE CALLING SEQUENCE WORDS.               DGE07620
       STZ     RAWPR                                                    DGE07630
       STZ     SWTCHR                                                   DGE07640
       CALL    SCL           CLOSE OLD INPUT FILE.                      DGE07650
       TRA     *+2                                                      DGE07660
LSTRIL PZE                   NONZERO MEANS LAST REEL.                   DGE07670
       ZET     LSTRIL        ARE THERE MORE REELS.                      DGE07680
       TRA     SETF          NO-GO TO SETF.                             DGE07690
       NZT     OPTPR-2       TEST FOR NOCKPT OPTION.                    DGE07700
       CALL    CKPT          TAKE CHECKPOINT.                           DGE07710
       STZ     RAWPR         YES.                                       DGE07720
       CALL    IOPEN         OPEN NEW INPUT FILE.                       DGE07730
       CALL    RESTW         RESTORE CALLING SEQUENCE WORDS.            DGE07740
       TRA     RDAGAN                                                   DGE07750
SETF   STL     SWTCHF                                                   DGE07760
       STZ*    UCW2                                                     DGE07770
       TRA     ENTRY1                                                   DGE07780
       SPACE   10                                                       DGE07790
************************************************************************DGE07800
*   CONSTANTS AND SWITCHES.                                             DGE07810
************************************************************************DGE07820
       SPACE   2                                                        DGE07830
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    DGE07840
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS.                  DGE07850
LABPR  COMMON  5             LABEL CARD PARAMETERS.                     DGE07860
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   DGE07870
FILPR  COMMON  14            FILE CARD PARAMETERS.                      DGE07880
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              DGE07890
RECPR  COMMON  10            RECORD CARD PARAMETERS.                    DGE07900
DELPR  COMMON  2             DELETE CARD PARAMETERS.                    DGE07910
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            DGE07920
CALPR  COMMON  50            CALCULATED PARAMETERS.                     DGE07930
GENPR  COMMON  10            GENERAL PARAMETERS.                        DGE07940
RAWPR  COMMON  30            READ AND WRITE PARAMETERS.                 DGE07950
CNTPR  COMMON  20            COUNT PARAMETERS.                          DGE07960
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS.               DGE07970
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER.           DGE07980
       EXTERN  MSGSUP                                                   DGE07990
GETSWT DEC     0                                                        DGE08000
SWTCHA EQU     RAWPR-2                                                  DGE08010
SWTCHR DEC     0                                                        DGE08020
SWTCHF EQU     RAWPR-24                                                 DGE08030
MOD05  EQU     MODPR-5                                                  DGE08040
SWTCHL DEC     0                                                        DGE08050
SELLOC PZE     0,0,SELECT                                               DGE08060
TPTOBF IORT    **,,**                                                   DGE08070
FINALE IOSP    **,,**                                                   DGE08080
ONE    DEC     1                                                        DGE08090
TMPBTP DEC     0                                                        DGE08100
XCFLTH DEC     0                                                        DGE08110
XFCKEQ DEC     0                                                        DGE08120
NEXTRC DEC     0                                                        DGE08130
SERCH  DEC     0                                                        DGE08140
WDCONT DEC     0                                                        DGE08150
DEC1   DEC     0                                                        DGE08160
DEC2   DEC     0                                                        DGE08170
BUFTOP EQU     ERAPR-23                                                 DGE08180
BUFBOT DEC     0                                                        DGE08190
BFTBLT DEC     0                                                        DGE08200
SRTBLT DEC     0                                                        DGE08210
LCTBLT DEC     0                                                        DGE08220
BUFRLT DEC     0                                                        DGE08230
BFTBLC DEC     0                                                        DGE08240
SRTBLC DEC     0                                                        DGE08250
LCTBLC DEC     0                                                        DGE08260
BUFRLC DEC     0                                                        DGE08270
BUFRND DEC     0                                                        DGE08280
BFTBND DEC     0                                                        DGE08290
LCTBND DEC     0                                                        DGE08300
SRTBND DEC     0                                                        DGE08310
BFTBEP DEC     0                                                        DGE08320
LCTBEP DEC     0                                                        DGE08330
LCTBBP DEC     0                                                        DGE08340
ATLT   DEC     0                                                        DGE08350
ATND   DEC     0                                                        DGE08360
BINLTH DEC     0                                                        DGE08370
BNMINS DEC     0                                                        DGE08380
MAXBLK DEC     0                                                        DGE08390
MXBKP1 DEC     0                                                        DGE08400
NOTCMP DEC     0                                                        DGE08410
RCDLTH EQU     ERAPR-25                                                 DGE08420
NWATLT DEC     0                                                        DGE08430
EQLSWD EQU     ERAPR-24                                                 DGE08440
THISAV EQU     ERAPR-22                                                 DGE08450
MODELT DEC     0                                                        DGE08460
FINALT DEC     0                                                        DGE08470
LOCUCB DEC     0                                                        DGE08480
LABSW  DEC     0                                                        DGE08490
REDNCY DEC     0                                                        DGE08500
CKWORD DEC     0                                                        DGE08510
RCKWRD OCT     171717171717                                             DGE08520
SWIORT PZE     TPTOBF                                                   DGE08530
D2000  DEC     2000                                                     DGE08540
CKLTRC DEC     0                                                        DGE08550
HWLNG  DEC     0                                                        DGE08560
UCW2   DEC     0                                                        DGE08570
BBASE  DEC     0                                                        DGE08580
LLUCB  DEC     0                                                        DGE08590
TEMP   DEC     0                                                        DGE08600
SRTBBP DEC     0                                                        DGE08610
BFTBBP DEC     0                                                        DGE08620
AVLCEL DEC     0                                                        DGE08630
RCDEND DEC     0                                                        DGE08640
BINEND DEC     0                                                        DGE08650
DUMPSW DEC     0                                                        DGE08660
RCMSG  DEC     0                                                        DGE08670
FRSTIM DEC     0                                                        DGE08680
MAXBP1 DEC     0                                                        DGE08690
T000P  DEC     0                                                        DGE08700
T000M  DEC     0                                                        DGE08710
DPMSG  BCI     5,UNRDBL BLK DUMPED        *RD01                         DGE08720
UNTMSG BCI     5, FILE XXXXXX,  RECORD   XXXXXX                         DGE08730
MESAG5 BCI     4,RECORD AT LOC.                                         DGE08740
MESAG6 BCI     5,INVALID RECORD FORMAT *VR01                            DGE08750
MESAG7 BCI     5,PRESS START TO DELETE SORT                             DGE08760
MESAG8 BCI     4,INPUT CHKSM ERROR *RD02                                DGE08770
MESAG9 BCI     6,INPUT BLOCK SEQ ERROR          *RD03                   DGE08780
LGACMS BCI     5,LONG BLK ACCEPTED        *RD11                         DGE08790
       DETAIL                                                           DGE08800
       END                                                              DGE08810
*  7090/94 SORT, VER 7, MOD 0.  SCATTER WRITE VARIABLE LENGTH PHASE 1   DPU00000
*      FAP
       COUNT   250                                                      DPU00010
       ENTRY   PUT                                                      DPU00020
       SST                                                              DPU00030
       SPACE                                                            DPU00040
*                                                                       DPU00050
*    PUT HANDLES THE WRITING OF SORTED VARIABLE LENGTH RECORDS FROM     DPU00060
*  PHASE 1.  IN ERAPR-10, XS PUTS THE LOCATION AND LENGTH OF A TABLE    DPU00070
*  REFERRED TO HERE AS THE BLOCK TABLE.  EACH ENTRY IN THIS TABLE TELLS DPU00080
*  HOW MANY RECORDS ARE TO BE WRITTEN IN A MERGE BLOCK AND WHERE THE    DPU00090
*  TAGS OF THOSE RECORDS BEGIN IN THE L TABLE.  EACH ENTRY IN THE       DPU00100
*  BLOCK TABLE IS FOR ONE MERGE BLOCK, AND THERE MAY BE ONE OR SEVERAL  DPU00110
*  PER CALL TO PUT.  PUT BUILDS A WRITE TABLE IN THE OTHER L TABLE      DPU00120
*  IMMEDIATELY FOLLOWING THE CURRENT AVAILABILITY TABLE.  WHEN SELECT   DPU00130
*  MINUS FINDS THAT THE LAST MERGE BLOCK FOR THE CURRENT PUT HAS BEEN   DPU00140
*  WRITTEN, THE BINS JUST WRITTEN FROM ARE ADDED TO THE                 DPU00150
*  AVAILABILITY TABLE.                                                  DPU00160
*                                                                       DPU00170
       SPACE                                                            DPU00180
PUT    SXA     PUT900,1                                                 DPU00190
       SXA     PUT901,2                                                 DPU00200
       SXA     PUT902,4                                                 DPU00210
PUT010 TRA     *+1           ONE-TIME SWITCH.                           DPU00220
       CLA     SAMPR-1       COMPUTE OVERFLOW.                          DPU00230
       NZT     SAMPR-2                                                  DPU00240
       SUB     =1                                                       DPU00250
       SUB     SAMPR-2                                                  DPU00260
       XCA                                                              DPU00270
       ZET     RAW20                                                    DPU00280
       TRA     *+3                                                      DPU00290
       MPY     =3450000                                                 DPU00300
       TRA     *+2                                                      DPU00310
       MPY     =5000000                                                 DPU00320
       STQ     CAPAC                                                    DPU00330
       CAL     BINLTH                                                   DPU00340
       SBM     XCFWDS                                                   DPU00350
       SBM     =1                                                       DPU00360
       STA     PUT300                                                   DPU00370
       STL     PUT010                                                   DPU00380
       LXA     XCFWDS,1                                                 DPU00390
       SXD     PUT230,1                                                 DPU00400
       LAC     KEEPER,1                                                 DPU00410
       SXA     KEEPER,1                                                 DPU00420
       LXD     BLKTAB,4      GET NUMBER OF MERGE BLOCKS TO BE WRITTEN.  DPU00430
       TXL     PUT950,4,0                                               DPU00440
       PXA     ,4                                                       DPU00450
       ADM     LGTHER,1      GET BASE OF LENGTH TABLE.                  DPU00460
       STA     PUT101                                                   DPU00470
       PXA     ,4                                                       DPU00480
       ADM     KEEPER,1      GET BASE OF KEEP TABLE.                    DPU00490
       STA     PUT220                                                   DPU00500
       PXA     ,4                                                       DPU00510
       ADD     BLKTAB                                                   DPU00520
       STA     PUT100        SAVE BASE OF BLOCK TABLE.                  DPU00530
       ADD     =1                                                       DPU00540
       STA     PUT102                                                   DPU00550
       LXD     PUTAVT,1                                                 DPU00560
       PXA     ,1                                                       DPU00570
       ADD     PUTAVT                                                   DPU00580
       STA     PUT210        SAVE LOCATION OF WRITE TABLE.              DPU00590
       TRA     PUT100                                                   DPU00600
PUT095 LXA     PUT210,1                                                 DPU00610
       TXI     *+1,1,1                                                  DPU00620
       SXA     PUT210,1                                                 DPU00630
PUT100 CLA     **,4          GET BLOCK TABLE ENTRY.                     DPU00640
PUT101 STD     **,4          PUT NUMBER OF WORDS IN LENGTH TABLE.       DPU00650
       PAC     ,2            SAVE-(LOCATION OF PUT LIST FOR THIS BLOCK).DPU00660
       SXD     PUT105,2                                                 DPU00670
PUT102 CAL     **,4          GET LOCATION OF NEXT PUT LIST.             DPU00680
       PAX     ,2                                                       DPU00690
       SXA     PUT200,2      SAVE AS BASE OF CURRENT LIST.              DPU00700
       SXA     PUT240,2                                                 DPU00710
PUT105 TXI     *+1,2,**      COMPUTE LENGTH OF CURRENT LIST.            DPU00720
       SXD     PUT190,2                                                 DPU00730
       SXD     PUT265,2                                                 DPU00740
       STA     PUT200        GET BASE OF PUT LIST.                      DPU00750
       STA     PUT240                                                   DPU00760
       LXA     COUNT,1                                                  DPU00770
PUT190 TXI     *+1,1,**                                                 DPU00780
       SXA     COUNT,1                                                  DPU00790
       CAL     PUT190        PUT NUMBER OF RECORDS IN BLOCK             DPU00800
       STD*    PUT220         INTO KEEP TABLE.                          DPU00810
       ZET     RAW20                                                    DPU00820
       AXT     1,2                                                      DPU00830
PUT200 CAL     **,2          GET PUT LIST ENTRY.                        DPU00840
PUT210 SLW     **            MOVE IT TO WRITE TABLE.                    DPU00850
       CLA     PUT210        PUT LOCATION OF WRITE TABLE GROUP          DPU00860
PUT220 STA     **,4           IN KEEP TABLE.                            DPU00870
PUT224 LAC     BINLTH,1                                                 DPU00880
PUT230 TXI     *+1,1,**                                                 DPU00890
       TXI     *+1,1,1                                                  DPU00900
PUT240 LDI*    **,2          PICK UP FINALE WORD.                       DPU00910
       RFT     77777                                                    DPU00920
       TRA     PUT300        IT IS NONZERO.                             DPU00930
PUT246 ZET     RAW20                                                    DPU00940
       TRA     PUT260                                                   DPU00950
       TIX     PUT250,2,1    IF ZERO, CHECK FOR MORE PUT LIST ENTRIES.  DPU00960
PUT248 TIX     PUT095,4,1    IF NONE, CHECK FOR MORE BLOCK TABLE ENTRIESDPU00970
       TRA     PUT500        WRITE TABLE BUILDING COMPLETED.            DPU00980
PUT250 LXA     PUT210,1                                                 DPU00990
       TXI     *+1,1,1                                                  DPU01000
       SXA     PUT210,1                                                 DPU01010
       XEC     PUT200        GET PUT LIST ENTRY.                        DPU01020
       XEC     PUT210        MOVE IT TO WRITE TABLE.                    DPU01030
       TRA     PUT224                                                   DPU01040
PUT260 TXI     *+1,2,1                                                  DPU01050
PUT265 TXH     PUT248,2,**                                              DPU01060
       TRA     PUT250                                                   DPU01070
PUT300 AXT     **,1          PUT WORD COUNT OF BIN ONE INTO COMMAND.    DPU01080
       PXD     ,1                                                       DPU01090
       STD*    PUT210                                                   DPU01100
PUT310 LXA     PUT210,1                                                 DPU01110
       TXI     *+1,1,1                                                  DPU01120
       SXA     PUT210,1                                                 DPU01130
       STI*    PUT210        PUT FINALE WORD IN WRITE TABLE             DPU01140
       PIA                                                              DPU01150
       STA     PUT350                                                   DPU01160
       LAC     BINLTH,1                                                 DPU01170
       TXI     *+1,1,1                                                  DPU01180
PUT350 LDI     **,1          PICK UP NEXT FINALE WORD.                  DPU01190
       RFT     77777                                                    DPU01200
       TRA     PUT310        IT IS NONZERO.                             DPU01210
       TRA     PUT246        IT IS ZERO.                                DPU01220
PUT500 AXT     0,4           SAVE WRITE TABLE BASE.                     DPU01230
       CLA     PUT210                                                   DPU01240
       ADD     =1                                                       DPU01250
       STA*    PUT220                                                   DPU01260
       ZAC                                                              DPU01270
       STD*    PUT220                                                   DPU01280
       ZET     OVFRSK                                                   DPU01290
       TRA     PUT600                                                   DPU01300
*                                                                       DPU01310
* CHECK FOR OVERFLOW                                                    DPU01320
*                                                                       DPU01330
       ZAC                                                              DPU01340
       LDQ     BLKTAB                                                   DPU01350
       LGR     18                                                       DPU01360
       MPY     =70                                                      DPU01370
       XCA                                                              DPU01380
       ADD     ERAPR-17                                                 DPU01390
       STZ     ERAPR-17                                                 DPU01400
       ADD     OVFLCT                                                   DPU01410
       STO     OVFLCT                                                   DPU01420
       CLA     CAPAC         CHECK FOR OVERFLOW.                        DPU01430
       CAS     OVFLCT                                                   DPU01440
       TRA     PUT600                                                   DPU01450
       TRA     *+1                                                      DPU01460
       NZT     SWTCHA                                                   DPU01470
       TRA     *-1                                                      DPU01480
       STZ     RAWPR-25                                                 DPU01490
       STL     OVFRSK                                                   DPU01500
       CLA*    CHAPR                                                    DPU01510
       PAC     ,4                                                       DPU01520
       CLA     2,4                                                      DPU01530
       TSX     (DECVA,4                                                 DPU01540
       STQ     VOVMSB+3                                                 DPU01550
       TSX     MSGSUP,4,2    PRINT OVERFLOW MESSAGE ON-LINE.            DPU01560
               4                                                        DPU01570
               VOVMSA,,4                                                DPU01580
               VOVMSB,,4+512*4                                          DPU01590
               VOVMSC,,4                                                DPU01600
               VOVMSD,,4+512*4                                          DPU01610
       TSX     (PAUSE,4                                                 DPU01620
       STL     RAW24                                                    DPU01630
       AXT     VOVMSF,4                                                 DPU01640
       SWT     3                                                        DPU01650
       TXI     *+3,4,VOVMSE-VOVMSF   CHANGE TO VOVMSE.                  DPU01660
       STZ     RAW24                                                    DPU01670
       STL     RAWPR-25                                                 DPU01680
       SXA     *+3,4                                                    DPU01690
       TSX     MSGSUP,4,2                                               DPU01700
               1                                                        DPU01710
               **,,3+512*4                                              DPU01720
*                                                                       DPU01730
PUT600 LXD     RAWPR,2       GET OUTPUT FILE NUMBER.                    DPU01740
       TXI     *+1,2,-1                                                 DPU01750
       CAL*    CHAPR-2       GET L(UCB) FOR OUTPUT.                     DPU01760
       STA     LUCBC                                                    DPU01770
       PAC     ,2                                                       DPU01780
       LDI     0,2                                                      DPU01790
       LFT     20000                                                    DPU01800
       STL     HYPER                                                    DPU01810
       CLS     SELLOC                                                   DPU01820
       ZET     PUTCSW        WAIT HERE UNTIL ALL THE WRITING OF THE     DPU01830
       TRA     *-1            PREVIOUS PUT HAS BEEN COMPLETED.          DPU01840
       ZET     INTEOT                                                   DPU01850
       TRA     PUT900                                                   DPU01860
       ENB     =0                                                       DPU01870
       STO     1,2                                                      DPU01880
       CLA     CNTPR                                                    DPU01890
       ADD     COUNT         UPDATE COUNT OF RECORDS SORTED.            DPU01900
       STO     CNTPR                                                    DPU01910
       STZ     COUNT                                                    DPU01920
       NZT     HYPER                                                    DPU01930
       TRA     PUT700                                                   DPU01940
       LNT     40                                                       DPU01950
       TRA     PUT680                                                   DPU01960
       CAL     =1                                                       DPU01970
       ORS     HYPSMS                                                   DPU01980
PUT680 RIS     =O777760777777                                           DPU01990
       PIA                                                              DPU02000
       PDX     ,2                                                       DPU02010
       TXI     *+1,2,8576                                               DPU02020
       SXD     HYPORD,2                                                 DPU02030
PUT700 CLA     PUTAVT                                                   DPU02040
       STO     PUTTAB                                                   DPU02050
       LXD     RAWPR-8,2     SET SEQUENCE BREAK FLAG AS                 DPU02060
       SXD     SEQBRK,2       GIVEN BY MAIN ROUTINE.                    DPU02070
       TSX     (ACTIV,4      ACTIVATE THE UNIT.                         DPU02080
               LUCBC                                                    DPU02090
PUT900 AXT     **,1                                                     DPU02100
PUT901 AXT     **,2                                                     DPU02110
PUT902 AXT     **,4                                                     DPU02120
       STL     GENPR-5                                                  DPU02130
       NZT     INTEOT                                                   DPU02140
       TRA     2,4                                                      DPU02150
       STL     EOTIND                                                   DPU02160
       STZ     INTEOT                                                   DPU02170
       TRA     1,4                                                      DPU02180
       SPACE                                                            DPU02190
PUT950 ZET     PUTCSW        WHEN NO RECORDS ARE TO BE WRITTEN,         DPU02200
       TRA     *-1            WAIT FOR THE PREVIOUS WRITES TO BE        DPU02210
       TRA     PUT900         COMPLETED BEFORE RETURNING.               DPU02220
       SPACE                                                            DPU02230
*                                                                       DPU02240
*  WRITE SELECT PLUS                                                    DPU02250
*                                                                       DPU02260
WRTSEL SXA     WRSAV1,1                                                 DPU02270
       SXA     WRSAV2,2                                                 DPU02280
       SXA     WRSAV4,4                                                 DPU02290
       PAC     ,2            PUT -(LOCATION OF UCB) IN IR2              DPU02300
       TMI     SELMIN                                                   DPU02310
       CAL     3,2            AND PICK UP UCW4.                         DPU02320
       NZT     HYPER                                                    DPU02330
       STA     WRSLCT        INITIALIZE WRITE SELECT ADDRESS.           DPU02340
       ZET     PUTCSW        NEW PUT LIST OR WRITE IN PROGRESS.         DPU02350
       TRA     WRT120        WRITE IN PROGRESS.                         DPU02360
       LXA     KEEPER,4                                                 DPU02370
       CLA     KEEPER,4                                                 DPU02380
       STA     WRT140                                                   DPU02390
       CLA     LGTHER,4                                                 DPU02400
       STA     WRT145                                                   DPU02410
WRT120 NZT     SELPSW                                                   DPU02420
       TRA     WRT130                                                   DPU02430
       ZET     HYPER                                                    DPU02440
       TRA     WRT210        TRANSFER IF THIS IS TO                     DPU02450
       TRA     REWRIT         BE A REWRITE.                             DPU02460
WRT130 CAL     2,2           PICK UP RECORD COUNT                       DPU02470
       PAX     ,4             FROM UCW3,                                DPU02480
       TXI     *+1,4,1        INCREASE IT BY ONE,                       DPU02490
       SXA     FSTCLK,4       INITIALIZE SEQUENCE COUNT.                DPU02500
       LXD     SEQBRK,2                                                 DPU02510
WRT140 CLA     **            PICK UP KEEP TABLE ENTRY.                  DPU02520
       PDX     ,2                                                       DPU02530
       SXA     SEQBRK,2      KEEP NUMBER OF RECORDS PER MERGE BLOCK.    DPU02540
       STA     HDTCH         SAVE ADDRESS OF WRITE TABLE GROUP.         DPU02550
       STA     HDHYPT                                                   DPU02560
       STA     SELM15                                                   DPU02570
WRT145 CLA     **                                                       DPU02580
       STD     LSTCLK                                                   DPU02590
       LXA     WRT145,2                                                 DPU02600
       TXI     *+1,2,1                                                  DPU02610
       SXA     WRT145,2                                                 DPU02620
       LXA     WRT140,2                                                 DPU02630
       TXI     *+1,2,1                                                  DPU02640
       SXA     WRT140,2                                                 DPU02650
       CLA*    WRT140                                                   DPU02660
       STA     *+1                                                      DPU02670
WRT150 CLA     **            SAVE COMMAND FOLLOWING WRITE TABLE GROUP.  DPU02680
       STO     SAVE                                                     DPU02690
       ZET     HYPER                                                    DPU02700
       TRA     WRT200        TRANSFER IF HYPER                          DPU02710
       CLA     TLIORT                                                   DPU02720
       STO*    WRT150                                                   DPU02730
       CLA     WRTPOS                                                   DPU02740
       STA*    (RCHXI                                                   DPU02750
WRSLCT WRS     **                                                       DPU02760
       XEC*    (RCHXI                                                   DPU02770
WRT180 STL     PUTCSW        SET PUT COMPLETE SWITCH.                   DPU02780
       STL     SELPSW        SET 'SELECT PLUS LAST' SWITCH.             DPU02790
WRSAV1 AXT     **,1                                                     DPU02800
WRSAV2 AXT     **,2                                                     DPU02810
WRSAV4 AXT     **,4                                                     DPU02820
       STL     GENPR-5                                                  DPU02830
       TRA     1,4                                                      DPU02840
       SPACE                                                            DPU02850
WRT200 CLA     TLHYPT                                                   DPU02860
       STO*    WRT150                                                   DPU02870
WRT210 CLA     FSTHYP                                                   DPU02880
       STA*    (RCHXI                                                   DPU02890
       XEC*    (RCHXI                                                   DPU02900
       TRA     WRT180                                                   DPU02910
*                                                                       DPU02920
REWRIT CLA     WRTPOS        RESTORE RCHX AS BEFORE                     DPU02930
       STA*    (RCHXI         AND GO WRITE AGAIN.                       DPU02940
       TRA     WRSLCT                                                   DPU02950
       SPACE                                                            DPU02960
*                                                                       DPU02970
*  WRITE SELECT MINUS                                                   DPU02980
*                                                                       DPU02990
SELMIN STZ     SELPSW        SET SWITCH FOR 'SELECT MINUS LAST.'        DPU03000
       NZT     HYPER                                                    DPU03010
       TRA     SELM14                                                   DPU03020
       LDQ     2,2                                                      DPU03030
       STQ     3,2                                                      DPU03040
       LNT     10            DATA CHECK.                                DPU03050
       TRA     SELM14        NO.                                        DPU03060
       TSX     (NDATA,4                                                 DPU03070
               LUCBC,,34     HBSR                                       DPU03080
       TSX     (NDATA,4                                                 DPU03090
               LUCBC,,36     HSKR                                       DPU03100
       STL     SELPSW                                                   DPU03110
       TRA     WRSAV1                                                   DPU03120
SELM14 STZ     TAG                                                      DPU03130
       AXT     0,4                                                      DPU03140
SELM15 CAL     **,4                                                     DPU03150
       PBT                                                              DPU03160
       TRA     SELM20                                                   DPU03170
       STT     TAG                                                      DPU03180
       NZT     TAG                                                      DPU03190
       TXI     SELM15,4,-1                                              DPU03200
       SBM     XCFWDS        ADJUST THE LOCATION OF BIN IN THESE TAGS.  DPU03210
       STA*    SELM15                                                   DPU03220
       TXI     SELM15,4,-1                                              DPU03230
SELM20 CLA*    WRT140                                                   DPU03240
       ANA     =O77777000000                                            DPU03250
       TZE     SELM50        NO MORE ENTRIES IN BLOCK TABLE.            DPU03260
       CLA     SAVE                                                     DPU03270
       STO*    WRT150                                                   DPU03280
       TRA     WRSAV1                                                   DPU03290
SELM50 STZ     PUTCSW                                                   DPU03300
       STZ     1,2           RELEASE UNIT.                              DPU03310
       NZT     HYPER                                                    DPU03320
       TRA     SELM70                                                   DPU03330
       RFT     4             CHECK FOR END WARNING AREA.                DPU03340
       TRA     SELM75        YES.                                       DPU03350
       TRA     SELM80        NO.                                        DPU03360
SELM70 LFT     200000        CHECK FOR END OF TAPE.                     DPU03370
SELM75 STL     INTEOT        YES.                                       DPU03380
SELM80 LAC     PUTTAB,4                                                 DPU03390
       SXD     SEL100,4                                                 DPU03400
       LXA     WRT150,4                                                 DPU03410
SEL100 TXI     *+1,4,**                                                 DPU03420
       CLA     PUTTAB                                                   DPU03430
       CAS     PUTAVT                                                   DPU03440
       TRA     *+2                                                      DPU03450
       TRA     SEL110                                                   DPU03460
SEL105 SXD     ERAPR-3,4                                                DPU03470
       TRA     *+2                                                      DPU03480
SEL110 SXD     PUTAVT,4                                                 DPU03490
       TRA     WRSAV1        GO TO EXIT.                                DPU03500
       SPACE                                                            DPU03510
* CONSTANTS AND SWITCHES                                                DPU03520
       SPACE                                                            DPU03530
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     DPU03540
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS                   DPU03550
LABPR  COMMON  5             LABEL CARD PARAMETERS                      DPU03560
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS                    DPU03570
FILPR  COMMON  14            FILE CARD PARAMETERS                       DPU03580
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              DPU03590
RECPR  COMMON  10            RECORD CARD PARAMETERS                     DPU03600
DELPR  COMMON  2             DELETE CARD PARAMETERS                     DPU03610
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS             DPU03620
CALPR  COMMON  50            CALCULATED PARAMETERS                      DPU03630
GENPR  COMMON  10            GENERAL PARAMETERS                         DPU03640
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  DPU03650
CNTPR  COMMON  20            COUNT PARAMETERS                           DPU03660
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS                DPU03670
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER            DPU03680
       SPACE                                                            DPU03690
       TITLE                                                            DPU03700
VOVMSA BCI     4,CAPACITY REACHED   *OV01                               DPU03710
VOVMSB BCI     4,  OVERFLOW,BLOCKS/XXXXXX                               DPU03720
VOVMSC BCI     4,TO STOP INPUT - - SS3 UP                               DPU03730
VOVMSD BCI     4,TO KEEP READING - SS3 DN                               DPU03740
VOVMSE BCI     3,(INPUT STOPPED)                                        DPU03750
VOVMSF BCI     3,(INPUT CONTINUES)                                      DPU03760
       DETAIL                                                           DPU03770
       SPACE                                                            DPU03780
SELLOC         ,,WRTSEL      LOCATION OF SELECT ROUTINE FOR UCW2        DPU03790
HDIOCP IOCP    FSTCLK,,2                                                DPU03800
HDTCH  TCH     **                                                       DPU03810
TLIORT IORT    LSTCLK,,1                                                DPU03820
FSTCLK OCT     631463000000                                             DPU03830
SEQBRK                                                                  DPU03840
LSTCLK OCT     631463                                                   DPU03850
SELPSW                                                                  DPU03860
PUTTAB                                                                  DPU03870
LUCBC                                                                   DPU03880
WRTPOS         HDIOCP        ADDRESS FOR RCHX                           DPU03890
PUTCSW                                                                  DPU03900
HYCPYD CPYD    LSTCLK,,1                                                DPU03910
       TCH     SYSTWT                                                   DPU03920
TLHYPT TCH     HYCPYD                                                   DPU03930
HYPSMS SMS     14                                                       DPU03940
       CTLW    HYPORD                                                   DPU03950
HYPBEG CPYP    FSTCLK,,2                                                DPU03960
HDHYPT TCH     **                                                       DPU03970
HYPORD OCT     120600120112                                             DPU03980
FSTHYP         HYPSMS                                                   DPU03990
HYPER                                                                   DPU04000
               KEEPA                                                    DPU04010
KEEPER         1                                                        DPU04020
               KEEPB                                                    DPU04030
KEEPA  BSS     10                                                       DPU04040
KEEPB  BSS     10                                                       DPU04050
               LGTHA                                                    DPU04060
LGTHER                                                                  DPU04070
               LGTHB                                                    DPU04080
LGTHA  BSS     10                                                       DPU04090
LGTHB  BSS     10                                                       DPU04100
COUNT                                                                   DPU04110
SAVE                                                                    DPU04120
TAG                                                                     DPU04130
OVFRSK                                                                  DPU04140
OVFLCT         20000                                                    DPU04150
INTEOT                                                                  DPU04160
BINLTH EQU     CALPR-3       BIN LENGTH                                 DPU04170
CAPAC  EQU     CALPR-11      CAPACITY IN WORDS.                         DPU04180
XCFWDS EQU     CALPR-12      NR OF WORDS OCCUPIED BY EXTRACTED CFS      DPU04190
EOTIND EQU     RAWPR-5       END OF TAPE INDICATOR                      DPU04200
PUTAVT EQU     ERAPR-4       LOCATION OF WT BLOCK,,NR OF AVAILABLE BINS DPU04210
BLKTAB EQU     ERAPR-10      LOCATION OF BLOCK TABLE,,LENGTH            DPU04220
SWTCHA EQU     RAWPR-2                                                  DPU04230
RAW20  EQU     RAWPR-20      NONZERO = ALL HYPERS ON MERGE              DPU04240
RAW24  EQU     RAWPR-24                                                 DPU04250
       EXTERN  MSGSUP                                                   DPU04260
       SPACE                                                            DPU04270
       END                                                              DPU04280
* 7090/94 SORT VER 7 MOD 6 SCATTER READ FIXED LENGTH INPUT           (6)DRE00000
*      FAP
       COUNT   300                                                      DRE00010
       ENTRY   READ                                                     DRE00020
       SST                                                              DRE00030
 READ  SXA     WON,1         SAVE THE                                   DRE00040
       SXA     TOO,2          CONTENTS OF                               DRE00050
       SXA     FOR,4          THE INDEX REGISTERS.                      DRE00060
 DPW   TRA     *+1           THIS IS A ONE-TIME SWITCH.                 DRE00070
       CLA*    CHAPR                                                    DRE00080
       STA     *+1                                                      DRE00090
       LDI     **                                                       DRE00100
       LFT     20000                                                    DRE00110
       STL     HYPER                                                    DRE00120
       CAL     =1                                                       DRE00130
       LFT     40                                                       DRE00140
       ORS     HYPSMS                                                   DRE00150
       CAL     =16                                                      DRE00160
       NZT*    FILPR                                                    DRE00170
       ORS     HYPSMS                                                   DRE00180
       LAC     FIL00,2       IS THERE A                                 DRE00190
       NZT     -19,2          TRAILERWORD...                            DRE00200
       TRA     NTW           NO.                                        DRE00210
       CAL     TICH          YES. ADJUST THE                            DRE00220
       SUB     =1             TCH INSTRUCTION TO                        DRE00230
       SLW     TICH           TRANSFER TO THE IOSP.                     DRE00240
       CAL     ENDTCH                                                   DRE00250
       SUB     =1                                                       DRE00260
       SLW     ENDTCH                                                   DRE00270
       STL     TRPRES                                                   DRE00280
 NTW   STL     DPW           CHANGE TRAILERWORD SWITCH.                 DRE00290
       NZT     RDSW          WAIT FOR PREVIOUS READ TO FINISH.          DRE00300
       TRA     *-1            COMPLETED.                                DRE00310
       NZT     DPSW          IS A DUMP REQUESTED...                     DRE00320
       TRA     DPS           NO. DONT TAKE A DUMP.                      DRE00330
       CAL*    CHA00                                                    DRE00420
       PAC     ,2                                                       DRE00430
       CAL     2,2                                                      DRE00440
       TSX     (DECVA,4                                                 DRE00450
       STQ     UTMSG+4                                                  DRE00460
       CAL     2,2                                                      DRE00470
       TSX     (DECVD,4                                                 DRE00480
       STQ     UTMSG+1                                                  DRE00490
       LDQ     0,2                                                      DRE00500
       TSX     MSGSUP,4,3     PRINT UNITS MESSAGE.                      DRE00510
               UTMSG,,5                                                 DRE00520
       TSX     MSGSUP,4,2     PRINT DUMPED MESSAGE.                     DRE00530
               1                                                        DRE00540
               DPMSG,,4+512*4                                           DRE00550
       CALL    DEBLK                                                 (2)DRE00555
DPSW   PZE     **,,**                                                (2)DRE00556
       STZ     *-1                                                   (2)DRE00557
       NZT     DUMPER                                                (2)DRE00558
       TRA     *+3                                                   (2)DRE00559
       CALL    DEBLK                                                 (2)DRE0055A
       PZE     DUMPER,,1                                             (2)DRE0055B
       STZ     DUMPER                                                (2)DRE0055C
       LXA     REC00,2                                                  DRE00560
       PXD     ,2                                                       DRE00570
       STD*    NLAST                                                    DRE00580
DPS    CLA     ALT           MOVE INFORMATION CONCERNING                DRE00590
       STO     BLT            THE LIVE AND                              DRE00600
       CLA     ADT            DEAD TAGS TO                              DRE00610
       STO     BDT            ANOTHER AREA.                             DRE00620
       NZT     OVR           IS THIS THE LAST TIME THROUGH...           DRE00630
       TRA     RZET                                                     DRE00640
       STL     RAW03         SET EXTERNAL EOF INDICATION.               DRE00650
       TRA     JUMP                                                     DRE00660
RZET   NZT     NDF           WAS EOF REACHED...                         DRE00670
       TRA     RCLA          NO.                                        DRE00680
       CAL     ERA21         YES.                                       DRE00690
       STA     ALT                                                      DRE00700
       CALL    SAVEW         SAVE CALLING SEQUENCE WORDS.               DRE00710
       STZ     RAWPR                                                    DRE00720
       CALL    SCL           CLOSE OLD INPUT FILE.                      DRE00730
       TRA     *+2                                                      DRE00740
       PZE                   NONZERO MEANS LAST REEL.                   DRE00750
       NZT     *-1           ARE THERE MORE REELS...                    DRE00760
       TRA     *+3           YES.                                       DRE00770
       STL     OVR           NO. NEXT TIME IS LAST TIME THROUGH.        DRE00780
       TRA     JUMP                                                     DRE00790
       NZT     OPTPR-2       TEST FOR NOCHECKPOINT OPTION.              DRE00800
       CALL    CKPT          TAKE CHECKPOINT.                           DRE00810
       STZ     RAWPR                                                    DRE00820
       CALL    IOPEN         OPEN NEW INPUT FILE.                       DRE00830
       STZ     OVR           RESET THE LAST TIME THROUGH SWITCH.        DRE00840
       STZ     NDF           RESET THE INTERNAL EOF SWITCH.             DRE00850
       CALL    RESTW         RESTORE CALLING SEQUENCE WORDS.            DRE00860
       ENB     =0            NO. DISABLE TRAPS.                         DRE00870
RCLA   CLA*    CHA00         FIND THE LOCATION OF THE UCB AND           DRE00880
       STA     LOC            SAVE IT IN LOC AND IN                     DRE00890
       PAC     ,2             INDEX REGISTER 2.                         DRE00900
       CLA     3,2           SET THE                                    DRE00910
       STA     READS          RDS INSTRUCTION.                          DRE00920
       ENB     =0            NO. DISABLE TRAPS                          DRE00940
       CAL     BEG           PUT ADDRESS OF SELECT ROUTINE IN           DRE00950
       SLW     1,2            DECREMENT OF UCW2.                        DRE00960
       NZT     HYPER                                                    DRE00970
       TRA     RLXD                                                     DRE00980
       CLA     0,2                                                      DRE00990
       ANA     =O17000000                                               DRE01000
       PDX     ,4                                                       DRE01010
       TXI     *+1,4,8576                                               DRE01020
       SXD     HYPORD,4                                                 DRE01030
RLXD   LXD     ERA21,4       INITIALIZE                                 DRE01040
       PXA     ,4             LEFT.                                     DRE01050
       SXA     BINS,4                                                   DRE01060
       SUB     CAL01         SAVE NUMBER OF IOSPS TO BE USED BY FUTURE  DRE01070
       STA     LEFT           SELECTS OF THIS READ AFTER THE FIRST.     DRE01080
       CLA     ERA21         FIND THE                                   DRE01090
       STA     SAVE                                                     DRE01100
       STA     RDTBL          FIRST IOSP AND                            DRE01110
       LXA     CAL01,4        THE RECORD LENGTH FOR                     DRE01120
       SXD     RDTBL,4        SELECT PLUS.                              DRE01130
       STZ     RDSW          INDICATE READ IS TAKING PLACE.             DRE01140
       TSX     (ACTIV,4      CALL (ACTIV.                               DRE01150
       PZE     LOC           THIS INFORMATION IS FOR (ACTIV.            DRE01160
       ZET     FST           IS THIS THE FIRST TIME...                  DRE01170
       TRA     STORE         YES. OMIT OLD READ CHECKS.                 DRE01180
 JUMP  NZT     DEL00         NO. IS A DELETE REQUESTED...               DRE01190
       TRA     NODEL         NO.                                        DRE01200
       CAL     BLT                                                      DRE01210
       PDX     ,4                                                       DRE01220
       TXL     NODEL,4,0                                                DRE01230
       SLW     ERA11                                                    DRE01240
       CALL    DELETE        YES. DELETE.                               DRE01250
       LXA     CNT12,4       WERE ANY DELETIONS MADE...                 DRE01260
       TXL     NODEL,4,0     NO.                                        DRE01270
       SXD     DELCT,4       YES.                                       DRE01280
       CAL     BLT                                                      DRE01290
       SUB     DELCT                                                    DRE01300
       SLW     BLT                                                      DRE01310
       PXA     ,4                                                       DRE01320
       ADD     BDT                                                      DRE01330
       SLW     BDT                                                      DRE01340
       CALL    WTFIX         YES. FIX WRITE TABLE.                      DRE01350
NODEL  CAL     BLT           NO. MOVE LIVE AND                          DRE01360
       SLW     ERA23          DEAD TAG INFORMATION TO                   DRE01370
       CAL     BDT            OUTPUT AREA FOR                           DRE01380
       SLW     ERA24          SORT ROUTINE.                             DRE01390
       ZET     OVR           IS THIS THE LAST TIME THROUGH...           DRE01400
       TRA     DEAD          YES.                                       DRE01410
EQS    NZT     OPT03         IS EQUALS OPTION REQUESTED...              DRE01420
       TRA     CKS           NO.                                        DRE01430
       LXD     ERA23,2                                                  DRE01440
       TXL     CKS,2,0                                                  DRE01450
       PXA     ,2                                                       DRE01460
       ADM     ERA23                                                    DRE01470
       STA     A             SAVE READ LIST BASE.                       DRE01480
       LAC     RECPR,1       GET -(RECORD LENGTH).                      DRE01490
       CLA     B             GET LAST SEQUENCE NUMBER.                  DRE01500
       ADD     =1            UPDATE FOR NEXT RECORD.                    DRE01510
A      STO*    **,2                                                     DRE01520
       TIX     *-2,2,1       DO ENTIRE LIST.                            DRE01530
       STO     B             SAVE SEQUENCE NUMBER FOR NEXT TIME.        DRE01540
CKS    NZT     OPT01         ARE CHECKSUMS REQUESTED.                   DRE01550
       TRA     STORE         NO.                                        DRE01560
       LXD     ERA23,4                                                  DRE01570
       TXL     STORE,4,0                                                DRE01580
       PXA     ,4                                                       DRE01590
       ADM     ERA23                                                    DRE01600
       STA     C             SAVE READ LIST BASE.                       DRE01610
       CAL     RECPR         GET RECORD LENGTH.                         DRE01620
       ZET     OPT03         IF EQUALS OPTION IS SPECIFIED,             DRE01630
       ADM     =1             INCLUDE SEQUENCE WORD IN RECORD LENGTH.   DRE01640
       STA     D                                                        DRE01650
C      CAL     **,4          GET ENTRY FROM READ LIST.                  DRE01660
       ADD     D             COMPUTE BASE OF RECORD.                    DRE01670
       STA     E                                                        DRE01680
D      AXT     **,2                                                     DRE01690
       ZAC                                                              DRE01700
E      ACL     **,2          CALCULATE CHECKSUM.                        DRE01710
       TIX     E,2,1                                                    DRE01720
       AXT     0,2                                                      DRE01730
       SLW*    E             SAVE CHECKSUM.                             DRE01740
       TIX     C,4,1                                                    DRE01750
 STORE STZ     FST           NO. SET SWITCH.                            DRE01760
WON    AXT     **,1          REPLACE THE                                DRE01770
TOO    AXT     **,2           CONTENTS OF                               DRE01780
FOR    AXT     **,4           THE INDEX REGISTERS                       DRE01790
       TRA     1,4           RETURN TO MAIN PROGRAM.                    DRE01800
DEAD   SXD     ALT,0         MAKE THE ENTIRE                            DRE01810
       CLA     CAL06          READ TABLE                                DRE01820
       STA     ADT           DEAD.                                      DRE01830
       TRA     EQS           CONTINUE WITH READ PROGRAM.                DRE01840
*                                                                       DRE01850
* CHECKWORD CHECKER                                                     DRE01860
*                                                                       DRE01870
CHKCHK SXA     CHK50,1                                                  DRE01880
       SXA     CHK60,2                                                  DRE01890
       SXA     CHK65,4                                                  DRE01900
       AXT     0,4           PREPARE TO COUNT REMAINING CHECKWORDS.     DRE01910
       STZ     TAGCT         RESET SHORT BLOCK TAG COUNT.               DRE01920
       LXD     RDTBL,2                                                  DRE01930
       TXL     CHK50,2,0                                                DRE01940
       PXA     ,2                                                       DRE01950
       ADM     RDTBL                                                    DRE01960
       STA     CHK40         KEEP READ TABLE BASE.                      DRE01970
       LAC     REC00,1       PREPARE AND SAVE                           DRE01980
       TXI     *+1,1,1        -(RECORD LENGTH - 1).                     DRE01990
       CAL     CHKWD         COMPARE CHECKWORD WITH                     DRE02000
CHK40  LAS*    **,2           THE LAST WORD IN EACH                     DRE02010
       TIX     *-1,2,1        RECORD AND KEEP COUNT                     DRE02020
       TRA     CHK90          AT CHK90 IF AN                            DRE02030
CHK45  TIX     *-3,2,1        EQUALS OCCURS.                            DRE02040
CHK50  AXT     **,1          RESTORE IR1.                               DRE02050
       TXH     CHK70,4,0     TO SHORT BLOCK RETURN.                     DRE02060
       LXA     (COMMM,2                                                 DRE02070
       TXL     CHK59,2,0     TO NORMAL LENGTH RETURN.                   DRE02080
       ZET     SEL220                                                   DRE02090
       SXD     DUMPER,2                                                 DRE02100
       NZT     TRPRES        TRANSFER IF NO                             DRE02110
       TRA     CHK55          TRAILER WORDS.                            DRE02120
       LAS     TRLRWD                                                   DRE02130
       TRA     *+2                                                      DRE02140
       TRA     CHK67                                                    DRE02150
CHK55  PXD     ,2                                                       DRE02160
       TRA     CHK60                                                    DRE02170
 CHK59 ZAC                                                              DRE02180
CHK60  AXT     **,2                                                     DRE02190
CHK65  AXT     **,4                                                     DRE02200
       STL     GEN05                                                    DRE02210
       TRA     2,4                                                      DRE02220
CHK67  PXD     ,2            SET SIGN MINUS TO                          DRE02230
       SSM                    INDICATE CHECKWORD TRAILERWORD            DRE02240
       TRA     CHK60          REMAINS.                                  DRE02250
 CHK70 NZT     HTEOF         HAVE WE HIT EOF ON SHORT READ           (3)DRE02260
       NZT     TRPRES        NO,CHECK TRLWRD IF EXISTS               (3)DRE02265
       TRA     CHK75                                                    DRE02270
       LAS     TRLRWD                                                   DRE02280
       TRA     *+2                                                      DRE02290
       TXI     *+1,4,1                                                  DRE02300
CHK75  PXA     ,4                                                       DRE02310
       LXA     CHK60,2                                                  DRE02320
       LXA     CHK65,4                                                  DRE02330
       STL     GEN05                                                    DRE02340
       TRA     1,4                                                      DRE02350
CHK90  XEC     CHK40         IF TIX AT CHK40+1 FAILED,                  DRE02360
       TRA     CHK50          LEAVE COMPARE LOOP.                       DRE02370
       NZT     TAGCT         KEEP POSITION OF FIRST                     DRE02380
       SXA     TAGCT,2        REMAINING CHECKWORD.                      DRE02390
       TXI     CHK45,4,1     KEEP COUNT AND GO CHECK NEXT ONE.          DRE02400
       SPACE     5                                                      DRE02410
*                                                                       DRE02420
* SELECT ROUTINES                                                       DRE02430
*                                                                       DRE02440
* SELECT PLUS ROUTINE                                                   DRE02450
*                                                                       DRE02460
 SEL   SXA     SWON,1        SAVE THE                                   DRE02470
       SXA     STOO,2         CONTENTS OF                               DRE02480
       SXA     SFOR,4         THE INDEX REGISTERS.                      DRE02490
       TMI     SELMIN        GO TO SELECT MINUS.                        DRE02500
       ZET     NPR           WAS THERE A NON-PERMANENT REDUNDANCY...    DRE02510
       TRA     RED           YES.                                       DRE02520
       STL     NPR           NO. RESET SWITCH.                          DRE02530
       LXD     RDTBL,2       FIND IOSP TO BE                            DRE02540
       PXA     ,2             REPLACED BY                               DRE02550
       ADD     RDTBL          THE TRANSFER IN CHANNEL.                  DRE02560
       STA     LAST          SAVE PRESENT                               DRE02570
       STA     NLAST          IOSP AND                                  DRE02580
 RET   CLA*    NLAST          ITS                                       DRE02590
       STO     COMD           LOCATION.                                 DRE02600
       STA     DUMPER                                                   DRE02610
       CLA     TICH          INSERT THE                                 DRE02620
       ZET     HYPER                                                    DRE02630
       CLA     ENDTCH                                                   DRE02640
       STO*    NLAST          TRANSFER IN CHANNEL.                      DRE02650
       ZET     HYPER                                                    DRE02660
       TRA     HREAD                                                    DRE02670
 LNTH  LAC     REC00,1       FIND THE RECORD LENTH.                     DRE02680
       TXI     *+1,1,1       INSERT THE                                 DRE02690
       CLA     CHKWD         CHECKWORDS IN                              DRE02700
       LXD     RDTBL,2                                                  DRE02710
       TXL     *+3,2,0                                                  DRE02720
 LAST  STO*    **,2           THE                                       DRE02730
       TIX     *-1,2,1        BINS.                                     DRE02740
       ZET     TRPRES                                                   DRE02750
       STO     TRLRWD                                                   DRE02760
       LXA     SWON,1        RESET INDEX REGISTER 1 FOR (RCHXI.         DRE02770
       CLA     RDTBL         RESET THE                                  DRE02780
       STA*    (RCHXI         RCHX COMMAND.                             DRE02790
READS  RDS     **            BEGIN TO                                   DRE02800
       XEC*    (RCHXI         READ.                                     DRE02810
 SWON  AXT     **,1          RESTORE THE                                DRE02820
 STOO  AXT     **,2           CONTENTS OF                               DRE02830
SFOR   AXT     **,4          THE INDEX REGISTERS                        DRE02840
       TRA     1,4           RETURN TO THE MAIN PROGRAM OR IOEX.        DRE02850
*                                                                       DRE02860
HREAD  CLA     BEGTCH                                                   DRE02870
       STA*    (RCHXI                                                   DRE02880
       CLA     RDTBL                                                    DRE02890
       STA     HYPTCH                                                   DRE02900
       XEC*    (RCHXI                                                   DRE02910
       TRA     SWON                                                     DRE02920
*                                                                       DRE02930
 RED   ZET     HYPER                                                    DRE02940
       TRA     RET                                                      DRE02950
       TSX     CHKCHK,4      GO TO THE CHECKWORD CHECKER.               DRE02960
       TRA     *+2           THIS IS THE SHORT BLOCK RETURN.            DRE02970
       TRA     LNTH          THIS IS THE NORMAL OR LONG BLOCK RETURN.   DRE02980
       PAX     ,2            SET THE INDEX REGISTER FOR BACKSPACING.    DRE02990
       CLA     READS         FIND THE                                   DRE03000
       STA     *+1            UNIT ADDRESS AND                          DRE03010
       BSR     **             CAUSE THE UNIT TO                         DRE03020
       TIX     *-1,2,1        BACKSPACE.                                DRE03030
       LAC     TAGCT,4                                                  DRE03040
       SXD     DNCNT,4                                                  DRE03050
       LXD     RDTBL,4                                                  DRE03060
       TXL     *+3,4,0                                                  DRE03070
DNCNT  TXI     *+1,4,**                                                 DRE03080
       SXD     RDTBL,4                                                  DRE03090
       CAL     LEFT                                                     DRE03100
       ADD     TAGCT                                                    DRE03110
       SLW     LEFT                                                     DRE03120
       CLA     COMD          REPLACE THE                                DRE03130
       STO*    NLAST          OLD IOSP.                                 DRE03140
       CLA     NLAST         FIND THE IOSP TO                           DRE03150
       SUB     TAGCT          BE REPLACED BY                            DRE03160
       STA     NLAST          THE TRANSFER IN                           DRE03170
       STA     LAST           CHANNEL.                                  DRE03180
       STL     SEL220                                                   DRE03190
       TRA     RET           RETURN TO REPLACE IOSP.                    DRE03200
*                                                                       DRE03210
* SELECT MINUS ROUTINE (729 TAPES)                                      DRE03220
*                                                                       DRE03230
SELMIN STZ     NPR           SET SELECT-MINUS-LAST.                     DRE03240
       STZ     HTEOF         INITIALIZE BACKSPACE EOF SWITCH         (3)DRE03245
       PAC     ,2                                                       DRE03250
       ZET     HYPER                                                    DRE03260
       TRA     SEL500                                                   DRE03270
       LFT     100000                                                   DRE03280
       TRA     SEL030        TRANSFER IF PERMANENT REDUNDANCY.          DRE03290
       LFT     200000                                                   DRE03300
       TRA     SEL100        TRANSFER IF EOF.                           DRE03310
SEL002 ZAC                                                              DRE03320
       STL     GEN04                                                    DRE03330
       TSX     CHKCHK,4      GO CHECK CHECKWORDS.                       DRE03340
       TRA     SEL200        TRANSFER IF SHORTER.                       DRE03350
       TNZ     SEL240        TRANSFER IF LONGER.                        DRE03360
       LXD     RDTBL,4                                                  DRE03370
       SXA     RCDSRD,4                                                 DRE03380
       ZET     TRPRES                                                   DRE03390
       TSX     SEL040,4      TRANSFER IF TRAILER WORDS ARE EXPECTED.    DRE03400
       NZT     SEL220        TRANSFER IF THIS IS A                      DRE03410
       TRA     SEL007         REGULAR LENGTH BLOCK.                     DRE03420
       NZT     OPT05         TRANSFER IF THE VARIABLE                   DRE03430
       TRA     SEL300         BLOCK OPTION IS NOT TAKEN.                DRE03440
       STZ     SEL220                                                   DRE03450
SEL007 LXD     RDTBL,4                                                  DRE03460
       PXA     ,4                                                       DRE03470
       ADM     CNT14                                                    DRE03480
       STO     CNT14         UPDATE INPUT COUNT.                        DRE03490
       CLA     COMD          REPLACE THE                                DRE03500
       STO*    NLAST          OLD IOSP.                                 DRE03510
       CLA     LEFT                                                     DRE03520
       TZE     SEL010                                                   DRE03530
       SUB     CAL01                                                    DRE03540
       TMI     SEL010        TRANSFER IF GROUP COMPLETE.                DRE03550
       STA     LEFT                                                     DRE03560
       LXD     RDTBL,4                                                  DRE03570
       SXD     *+2,4                                                    DRE03580
       LXA     RDTBL,4       UPDATE LOCATION OF                         DRE03590
       TXI     *+1,4,**       NEXT READ TABLE.                          DRE03600
       SXA     RDTBL,4                                                  DRE03610
       LXA     CAL01,4       UPDATE NUMBER OF RECORDS                   DRE03620
       SXD     RDTBL,4        IN NEXT GROUP.                            DRE03630
       TRA     SEL020                                                   DRE03640
SEL010 CLS     SAVE          DETERMINE HOW MANY                         DRE03650
       ADD     NLAST          TAGS WERE USED BY                         DRE03660
       ALS     18             THIS READ AND                             DRE03670
       ADD     SAVE           WHERE THEY BEGAN,                         DRE03680
       SLW     ALT            AND SAVE IT.                              DRE03690
       CLA     LEFT          SAVE NUMBER OF UNUSED                      DRE03700
       STA     ADT            OR DEAD TAGS FOR THIS READ.               DRE03710
       STL     RDSW          INDICATE READ IS COMPLETE.                 DRE03720
       STZ     1,2           RELEASE UNIT.                              DRE03730
SEL020 TRA     SWON          GO TO RESTORE AND EXIT.                    DRE03740
*                                                                       DRE03750
SEL030 CLA     RDTBL                                                    DRE03760
       STO     DPSW                                                     DRE03770
       CLA     COMD                                                     DRE03780
       STO*    NLAST                                                    DRE03790
       NZT     SEL220                                                   DRE03800
       STZ     DUMPER                                                   DRE03810
       TRA     SEL260                                                   DRE03820
*                                                                       DRE03830
* BLOCK SEQUENCE AND CHECK SUM (TRAILER WORD) CHECKER                   DRE03840
*                                                                       DRE03850
SEL040 SXA     SAVE4,4                                                  DRE03860
       SXA     SAVE2,2                                                  DRE03870
       LAC     FIL00,4       GET LOCATION OF FILE DATA BLOCK.           DRE03880
       NZT     -9,4          IF THERE IS NO SEQUENCE NUMBER,            DRE03890
       TRA     SEL050         TRANSFER TO CHECK CHECKSUM.               DRE03900
       LAC     LOC,4         PICK UP UCW3 AND COMPARE                   DRE03910
       CAL     2,4            RECORD COUNT WITH                         DRE03920
       ERA     TRLRWD         SEQUENCE NUMBER.                          DRE03930
       ANA     =O77777       IF THEY AGREE,                             DRE03940
       TZE     SEL050         GO CHECK CHECKSUM.                        DRE03950
       LFT     200000                                                   DRE03960
       TRA     SEL050                                                   DRE03970
       TSX     SM090,4       PRINT 'UNIT XX, FILE XX, RECORD XX'.       DRE03980
       LAC     LOC,4                                                    DRE03990
       CLA     TRLRWD                                                   DRE04000
       STA     2,4           SET UCW3 TO AGREE WITH BLOCK SEQUENCE.     DRE04010
       TSX     (DECVA,4      PREPARE INSERTION FOR MESSAGE.             DRE04020
       STQ     SQMSG+4                                                  DRE04030
       TSX     MSGSUP,4,2                                               DRE04040
               1                     UCW3 SET TO XXXXXX TO AGREE.'      DRE04050
               SQMSG,,6+512*4                                           DRE04060
SEL050 LAC     FIL00,4       GET LOCATION OF FILE DATA BLOCK.           DRE04070
       NZT     -8,4          IF THERE IS NO CHECKSUM,                   DRE04080
       TRA     SAVE4          TRANSFER OUT.                             DRE04090
SEL055 TRA     *+1           GATE, SINCE NEXT 5 CELLS NEEDED ONLY ONCE. DRE04100
       LAC     REC00,4       PICK UP -(RECORD LENGTH).                  DRE04110
       TXL     SEL065,4,-15  TRANSFER IF RECORD LENGTH IS MORE THAN 14. DRE04120
       CLA     SEL085        RL IS LESS THAN 15. INSERT TRANSFER        DRE04130
       STO     SEL075,4       THAT TERMINATES ACL LIST AT CORRECT       DRE04140
SEL065 STL     SEL055         RECORD LENGTH.  SET GATE.                 DRE04150
       CAL     RCDSRD        GET NUMBER OF RECORDS                      DRE04160
       PAX     ,4                                                       DRE04170
       ADD     RDTBL          AND TABLE LOCATION.                       DRE04180
       STA     SEL072        BASE OF TABLE.                             DRE04190
       ZAC                   CLEAR TO BEGIN CHECKSUM.                   DRE04200
SEL068 LXA     REC00,1                                                  DRE04210
       XCL                   SAVE AC.                                   DRE04220
SEL072 CAL     **,4          GET NEXT COMMAND                           DRE04230
       PAC     ,2            GET LOCATION OF RECORD.                    DRE04240
       ADM     REC00         COMPUTE BASE OF RECORD.                    DRE04250
       STA     SEL080                                                   DRE04260
       XCL                                                              DRE04270
SEL075 DUP     1,14                                                     DRE04280
       VFD     O21/0361002,15/*-SEL075 (ACL)                            DRE04290
       TXI     *+1,1,-14     IR1 HAS RL FIRST TIME HERE.                DRE04300
       TXL     *+2,1,13      TRANSFER IF FINISHED.                      DRE04310
       TXI     SEL075,2,-14  GO BACK TO ADD AGAIN.                      DRE04320
       TXL     *+3,1,0                                                  DRE04330
SEL080 ACL     **,1                                                     DRE04340
       TIX     *-1,1,1                                                  DRE04350
SEL085 TRA     *+1                                                      DRE04360
       TIX     SEL068,4,1                                               DRE04370
       XCL                                                              DRE04380
       STZ     TEMPSM                                                   DRE04390
       SLQ     TEMPSM                                                   DRE04400
       XCL                   FOLD THE CHECKSUM.                         DRE04410
       ALS     18                                                       DRE04420
       ACL     TEMPSM                                                   DRE04430
       LBT                                                              DRE04440
       TRA     *+2                                                      DRE04450
       ACL     =O1000000                                                DRE04460
       ERA     TRLRWD        COMPARE AGAINST CHECKSUM                   DRE04470
       ANA     =O777777000000 IN TRAILER WORD.                          DRE04480
       TNZ     SEL088                                                   DRE04490
 SAVE4 AXT     **,4                                                     DRE04500
 SAVE2 AXT     **,2                                                     DRE04510
       TRA     1,4                                                      DRE04520
SEL088 TSX     SM090,4       PRINT 'UNIT XX, FILE XX, RECORD XX.'       DRE04530
       TSX     MSGSUP,4,2     PRINT 'INPUT CHKSM ERROR'                 DRE04540
               1                                                        DRE04550
               CKMSG,,4                                                 DRE04560
       TRA     SAVE4                                                    DRE04570
 SM090 SXA     SM098,4                                                  DRE04580
       LAC     LOC,2                                                    DRE04590
       CAL     2,2                                                      DRE04600
       TSX     (DECVA,4                                                 DRE04610
       STQ     UTMSG+4                                                  DRE04620
       CLA     2,2                                                      DRE04630
       TSX     (DECVD,4                                                 DRE04640
       STQ     UTMSG+1                                                  DRE04650
       LDQ     0,2                                                      DRE04660
       TSX     MSGSUP,4,3                                               DRE04670
               UTMSG,,5                                                 DRE04680
 SM098 AXT     **,4                                                     DRE04690
       TRA     1,4                                                      DRE04700
*                                                                       DRE04710
* END OF FILE AND READ ERROR CHECKING (729)                             DRE04720
*                                                                       DRE04730
SEL100 LXD     (COMMM,4      TRANSFER IF IORTN* HIT EOF.                DRE04740
       STL     HTEOF                                                 (5)DRE04742
       TXL     SEL002,4,HYPER                                           DRE04750
       LAC     RDTBL,4                                                  DRE04760
       SXD     *+2,4                                                    DRE04770
       LXD     (COMMM,4                                                 DRE04780
       TXI     *+1,4,**      TRANSFER IF DATA                           DRE04790
       TXI     *+1,4,-1                                                 DRE04800
       TXH     SEL150,4,1     WERE READ.                                DRE04810
       LAC     SAVE,4                                                   DRE04820
       SXD     *+2,4                                                    DRE04830
       LXD     (COMMM,4      DETERMINE THE                              DRE04840
       TXI     *+1,4,**       NUMBER OF TAGS PRIOR TO                   DRE04850
SEL115 TXI     *+1,4,-1       THE ONE THAT HIT EOF.                     DRE04860
       SXD     ALT,4                                                    DRE04870
       STL     NDF           SET INTERNAL EOF SWITCH.                   DRE04880
       CAL     SAVE          SAVE THE NUMBER OF LIVE TAGS AND WHERE     DRE04890
       STA     ALT            THEY BEGAN.                               DRE04900
       LDQ     COMD          REPLACE FINAL IOSP.                        DRE04910
       STQ*    NLAST                                                    DRE04920
SEL130 CAL     RDTBL         SAVE THE NUMBER OF                         DRE04930
       ARS     18             UNUSED OR DEAD                            DRE04940
       ADD     LEFT           TAGS FOR THIS READ.                       DRE04950
       STA     ADT                                                      DRE04960
       LAC     LOC,2                                                    DRE04970
       STZ     1,2           RELEASE UNIT.                              DRE04980
       STL     RDSW          INDICATE READ IS COMPLETE.                 DRE04990
       TRA     SWON                                                     DRE05000
SEL150 SXD     RDTBL,4                                                  DRE05010
       TRA     SEL002                                                   DRE05020
*                                                                       DRE05030
SEL200 PAX     0,1           SHORTER THAN EXPECTED                   (3)DRE05040
       ZET     HTEOF         BACKSPACING OVER EOF                    (3)DRE05043
       TRA     EOFBS         YES                                     (3)DRE05044
       ADM     2,2            NO, ADJUST BLOCK COUNT IN UCB          (6)DRE05045
       TXI     *+1,1,1       WANT TO BACKSPACE I MORE                (3)DRE05047
SELSTO STA     2,2            TO BE BEFORE FIRST RECORD READ         (6)DRE05050
       TSX     (NDATA,4      BACKSPACE                               (3)DRE05060
               LOC,,5                                                (3)DRE05070
       TIX     *-2,1,1                                               (3)DRE05080
       LAC     TAGCT,4       INITIALIZE READ TABLE SO                   DRE05090
       SXD     *+2,4          THE TCH WILL BE PLACED                    DRE05100
       LXD     RDTBL,4        OVER THE IOSP WHICH HAD THE               DRE05110
       TXI     *+1,4,**       FIRST UNCLOBBERED CHECKWORD.              DRE05120
       SXD     RDTBL,4                                                  DRE05130
       CLA     COMD          REPLACE THE IOSP AT THE BASE               DRE05140
       STO*    NLAST          OF THE PREVIOUS LIST.                     DRE05150
       CAL     LEFT                                                     DRE05160
       ADD     TAGCT                                                    DRE05170
       SLW     LEFT                                                     DRE05180
       STL     SEL220        SET AN INDICATION OF A SHORT READ.         DRE05190
       TRA     SWON          RETURN.                                    DRE05200
 EOFBS TSX     (NDATA,4      BACKSPACE OVER EOF                      (3)DRE05203
               LOC,,5                                                (3)DRE05205
       PXA     0,1           ADJUST UCB COUNT TO                     (3)DRE05207
       ADD     (LTPOS        LAST POSITION BEFORE EOF                (3)DRE05208
       TRA     SELSTO                                                (3)DRE05209
SEL220                       IF SET, THEN IT IS A SHORT READ.           DRE05210
 HTEOF PZE                   NON ZERO IF SHORT READ OVER EOF         (3)DRE05215
SEL240 LDQ     COMD          IF LONGER THAN EXPECTED,                   DRE05220
       STQ*    NLAST          REPLACE FINAL IOSP AND CHANGE             DRE05230
       TMI     SEL310                                                   DRE05240
       LAC     RDTBL,4       PREPARE TO DUMP FROM THE                   DRE05250
       SXD     *+2,4          PROPER NUMBER OF IOSPS.                   DRE05260
       LXA     NLAST,4                                                  DRE05270
       TXI     *+1,4,**                                                 DRE05280
       ZET     SEL220                                                   DRE05290
SEL250 TXI     *+1,4,1                                                  DRE05300
       SXD     DPSW,4                                                   DRE05310
       NZT     SEL220                                                   DRE05320
       STZ     DUMPER                                                   DRE05330
       CLA     RDTBL         PREPARE TO DUMP FROM THE BEGINNING OF THE  DRE05340
       STO     DPSW           READ TABLE.                               DRE05350
       TRA     SEL267                                                   DRE05360
SEL260 LXA     CAL01,4                                                  DRE05370
       PXD     RDTBL,4                                                  DRE05380
SEL267 STZ     SEL220                                                   DRE05390
       LXD     DPSW,4                                                (6)DRE05391
       TXH     SEL270,4,0     TRA IF DEC IS NOT ZERO                 (6)DRE05392
       LXD     DUMPER,4                                              (6)DRE05394
       TXH     SEL270,4,2     TRA IF NOT NOISE                       (6)DRE05395
       AXT     NOISE,4        SET TRA NOISE INSTRUCTION              (6)DRE05397
       SXA     SEL280,4                                              (6)DRE05398
SEL270 CAL     RDTBL                                                    DRE05400
       ANA     =O77777                                                  DRE05410
       SUB     SAVE                                                     DRE05420
       ALS     18                                                       DRE05430
       ADD     SAVE                                                     DRE05440
       SLW     ALT                                                      DRE05450
SEL280 TRA     SEL130                                                (6)DRE05460
*                                                                       DRE05470
SEL300 LDQ     COMD          IF SHORTER THAN IT SHOULD BE,              DRE05480
       STQ*    NLAST          REPLACE FINAL IOSP.                       DRE05490
SEL310 LAC     RDTBL,4       PREPARE TO DUMP FROM THE                   DRE05500
       SXD     *+2,4          PROPER NUMBER OF IOSPS.                   DRE05510
       LXA     NLAST,4                                                  DRE05520
       TXI     SEL250,4,**                                              DRE05530
NOISE  AXT     SEL130,4       RESTORE INSTRUCTION                    (6)DRE05531
       SXA     SEL280,4                                              (6)DRE05532
       STZ     DPSW                                                  (6)DRE05533
       LXA     CAL01,4        UPDATE RDTBL                           (6)DRE05534
       SXD     RDTBL,4                                               (6)DRE05535
       XEC     SWON                                                  (6)DRE05536
       XEC     STOO                                                  (6)DRE05537
       XEC     SFOR                                                  (6)DRE05538
       CLA     LEFT                                                  (6)DRE05539
       STA     ADT                                                   (6)DRE05540
       TRA     2,4            NOISE RECORD RETURN                    (6)DRE05544
*                                                                    (6)DRE05546
* SELECT MINUS ROUTINE (HYPERTAPE)                                      DRE05550
*                                                                       DRE05560
SEL500 LFT     10                                                       DRE05570
       TRA     SEL030                                                   DRE05580
       RNT     10                                                       DRE05590
       TRA     SEL550        TRANSFER IF NOT EOF.                       DRE05600
       LAC     SAVE,4                                                   DRE05610
       SXD     *+2,4                                                    DRE05620
       LXA     (COMMM,4                                                 DRE05630
       TXI     SEL115,4,**                                              DRE05640
*                                                                       DRE05650
SEL550 LXA     (COMMM,4                                                 DRE05660
       TXL     SEL560,4,HYCPYD  TRANSFER IF GOOD BLOCK WITH TRAILER     DRE05670
       TXH     SEL600,4,HYPORD  TRANSFER IF INTERRUPT WAS IN READ TABLE.DRE05680
       CAL     RDTBL         LONG BLOCK TO DUMP                         DRE05690
       STO     DPSW                                                     DRE05700
       TRA     SEL270                                                   DRE05710
*                                                                       DRE05720
SEL560 LXD     RDTBL,4                                                  DRE05730
       SXA     RCDSRD,4                                                 DRE05740
       TSX     SEL040,4      IF GOOD BLOCK WITH TRAILER, CHECK          DRE05750
       TRA     SEL007         TRAILER AND GO ACCEPT                     DRE05760
*                                                                       DRE05770
SEL600 SXD     *+2,4                                                    DRE05780
       LXA     NLAST,2                                                  DRE05790
       TXL     SEL750,2,**   TRANSFER IF INTERRUPT AT BASE OF READ.     DRE05800
       TXI     *+1,4,-1                                                 DRE05810
       SXA     *+1,4                                                    DRE05820
SEL610 CAL     **                                                       DRE05830
       ADD     REC00                                                    DRE05840
       SUB     =1                                                       DRE05850
       PAX     ,4                                                       DRE05860
       SXD     *+2,4                                                    DRE05870
       LXD     (COMMM,4                                                 DRE05880
       TXH     SEL700,4,**  TRANSFER IF BIN IS FILLED.                  DRE05890
       CAL*    SEL610                                                   DRE05900
SEL615 ADD     =1                                                       DRE05910
       PAX     ,2                                                       DRE05920
       SXD     *+1,2                                                    DRE05930
       TXH     SEL650,4,**   TRANSFER IF MORE THAN ONE WORD IN BIN.     DRE05940
       NZT     OPT05                                                    DRE05950
       TRA     SEL650                                                   DRE05960
       SUB     =1                                                       DRE05970
       NZT     TRPRES                                                   DRE05980
       TRA     SEL650                                                   DRE05990
       STA     *+1                                                      DRE06000
       CLA     **                                                       DRE06010
       STO     TRLRWD                                                   DRE06020
       LAC     RDTBL,2                                                  DRE06030
       SXD     *+2,2                                                    DRE06040
       LXA     (COMMM,4                                                 DRE06050
       TXI     *+1,4,**                                                 DRE06060
       TXI     *+1,4,-1                                                 DRE06070
       SXA     RCDSRD,4                                                 DRE06080
       SXA     *+2,4                                                    DRE06090
       TSX     SEL040,4      GO CHECK TRAILER WORD.                     DRE06100
       AXT     **,4                                                     DRE06110
SEL620 PXA     ,4                                                       DRE06120
       ADM     CNT14         UPDATE INPUT COUNT.                        DRE06130
       STO     CNT14                                                    DRE06140
       CLA     COMD          REPLACE THE OLD CPYP.                      DRE06150
       STO*    NLAST                                                    DRE06160
       PXA     ,4                                                       DRE06170
       SSM                                                              DRE06180
       ADD     LEFT                                                     DRE06190
       ADD     CAL01                                                    DRE06200
       TZE     SEL631                                                   DRE06210
       SUB     CAL01                                                    DRE06220
       TMI     SEL630                                                   DRE06230
       STA     LEFT                                                     DRE06240
       PXA     ,4                                                       DRE06250
       ADD     RDTBL         UPDATE LOCATION OF NEXT READ TABLE.        DRE06260
       STA     RDTBL                                                    DRE06270
       TRA     SWON                                                     DRE06280
*                                                                       DRE06290
SEL630 ADD     CAL01                                                    DRE06300
SEL631 SLW     ADT                                                      DRE06310
       CAL     BINS                                                     DRE06320
       SUB     ADT                                                      DRE06330
       ALS     18                                                       DRE06340
       ADD     SAVE                                                     DRE06350
       SLW     ALT                                                      DRE06360
       STL     RDSW          INDICATE READ IS COMPLETE.                 DRE06370
       LAC     LOC,2                                                    DRE06380
       STZ     1,2                                                      DRE06390
       TRA     SWON                                                     DRE06400
*                                                                       DRE06410
SEL650 TXI     *+1,2,-1                                                 DRE06420
       PXA     ,2                                                       DRE06430
       PAC     ,2                                                       DRE06440
       SXD     *+1,2                                                    DRE06450
       TXI     *+1,4,**                                                 DRE06460
       SXD     DUMPER,4                                                 DRE06470
       LAC     RDTBL,2                                                  DRE06480
       SXD     *+2,2                                                    DRE06490
       LXA     (COMMM,4                                                 DRE06500
       TXI     *+1,4,**                                                 DRE06510
       TXI     *+1,4,-1                                                 DRE06520
SEL660 SXD     DPSW,4                                                   DRE06530
       CLA     RDTBL                                                    DRE06540
       STA     DPSW                                                     DRE06550
       CLA     COMD                                                     DRE06560
       STO*    NLAST                                                    DRE06570
       TRA     SEL270                                                   DRE06580
SEL700 NZT     TRPRES                                                   DRE06590
       TRA     SEL710        TRANSFER IF NO TRAILER EXPECTED.           DRE06600
SEL702 LAC     RDTBL,2                                                  DRE06610
       SXD     *+2,2                                                    DRE06620
       LXA     (COMMM,4                                                 DRE06630
       TXI     SEL660,4,**                                              DRE06640
*                                                                       DRE06650
SEL710 ZET     OPT05                                                    DRE06660
       TRA     SEL720                                                   DRE06670
       STZ     DUMPER                                                   DRE06680
       TRA     SEL702        TRANSFER IF VARIABLE BLOCKING NOT OPTIONED.DRE06690
*                                                                       DRE06700
SEL720 LAC     RDTBL,2       ACCEPT BLOCK.                              DRE06710
       SXD     *+2,2                                                    DRE06720
       LXA     (COMMM,4                                                 DRE06730
       TXI     SEL620,4,**                                              DRE06740
*                                                                       DRE06750
SEL750 TXI     *+1,4,-1                                                 DRE06760
       SXA     *+1,4                                                    DRE06770
SEL752 CAL     **                                                       DRE06780
       ADD     REC00                                                    DRE06790
       SUB     =1                                                       DRE06800
       PAX     ,2                                                       DRE06810
       SXD     *+2,2                                                    DRE06820
       LXD     (COMMM,4                                                 DRE06830
       TXH     SEL770,4,**   TRANSFER IF BIN IS FILLED.                 DRE06840
       CAL*    SEL752                                                   DRE06850
       TRA     SEL615                                                   DRE06860
*                                                                       DRE06870
SEL770 ZET     TRPRES                                                   DRE06880
       TRA     SEL650                                                   DRE06890
       TRA     SEL720                                                   DRE06900
       SPACE                                                            DRE06910
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     DRE06920
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS                   DRE06930
LABPR  COMMON  5             LABEL CARD PARAMETERS                      DRE06940
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS                    DRE06950
FILPR  COMMON  14            FILE CARD PARAMETERS                       DRE06960
MODPR  COMMON  50            MODIFICATION CARD PARAMETERS               DRE06970
RECPR  COMMON  10            RECORD CARD PARAMETERS                     DRE06980
DELPR  COMMON  2             DELETE CARD PARAMETERS                     DRE06990
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS             DRE07000
CALPR  COMMON  50            CALCULATED PARAMETERS                      DRE07010
GENPR  COMMON  10            GENERAL PARAMETERS                         DRE07020
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  DRE07030
CNTPR  COMMON  20            COUNT PARAMETERS                           DRE07040
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS                DRE07050
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER            DRE07060
OPT01  EQU     OPTPR-1       CHECKSUM OPTION                            DRE07070
OPT03  EQU     OPTPR-3       EQUALS OPTION                              DRE07080
OPT05  EQU     OPTPR-5       VARIABLE BLOCK OPTION                      DRE07090
CHA00  EQU     CHAPR         INPUT UNIT                                 DRE07100
FIL00  EQU     FILPR         FILE BLOCK LOCATION                        DRE07110
REC00  EQU     RECPR         RECORD LENGTH                              DRE07120
DEL00  EQU     DELPR         DELETE SWITCH                              DRE07130
CAL01  EQU     CALPR-1       NUMBER OF RECORDS IN READ GROUP            DRE07140
CAL06  EQU     CALPR-6       LENGTH OF M TABLE)                         DRE07150
GEN04  EQU     GENPR-4                                                  DRE07160
GEN05  EQU     GENPR-5                                                  DRE07170
RDSW   EQU     RAWPR-2                                                  DRE07180
RAW03  EQU     RAWPR-3       EOF INDICATOR FOR XS.                      DRE07190
NDF    EQU     RAWPR-24      ZERO=NO EOF, NZ=EOF                        DRE07200
CNT12  EQU     CNTPR-12      DELETE COUNT                               DRE07210
CNT14  EQU     CNTPR-14      INPUT RECORD COUNT                         DRE07220
ERA11  EQU     ERAPR-11                                                 DRE07230
ERA21  EQU     ERAPR-21      LOCATION + LENGTH OF READ TABLE            DRE07240
ERA23  EQU     ERAPR-23      LOCATION + LENGTH OF SORT TABLE            DRE07250
ERA24  EQU     ERAPR-24      ADDRESS=LENGTH OF DEAD TAGS IN M TABLE     DRE07260
LEFT                         NUMBER OF TAGS LEFT IN M TABLE             DRE07270
TAGCT                        SHORT BLOCK TAG COUNT                      DRE07280
OVR                                                                     DRE07290
CHKWD  OCT     171717171717                                             DRE07300
RDTBL                        LOCATION AND LENGTH OF READ TABLE          DRE07310
RCDSRD                                                                  DRE07320
TEMPSM                                                                  DRE07330
NPR                          NON-ZERO=LAST TRAP WAS REDUNDANT           DRE07340
B                                                                       DRE07350
DELCT                                                                   DRE07360
DUMPER                                                                  DRE07370
 BEG           ,,SEL                                                    DRE07380
 FST           1                                                        DRE07390
 LOC           0                                                        DRE07400
 TICH  TCH     INSTR                                                    DRE07410
 SAVE                                                                   DRE07420
 BINS                                                                   DRE07430
 ALT           0                                                        DRE07440
 BLT           0                                                        DRE07450
 ADT           0                                                        DRE07460
 BDT           0                                                        DRE07470
 COMD                                                                   DRE07480
TRLRWD                                                                  DRE07490
TRPRES                                                                  DRE07500
 NLAST                                                                  DRE07510
       IOSP    TRLRWD,,1                                                DRE07520
INSTR  IORTN*  ZERO,,-1                                                 DRE07530
ZERO                                                                    DRE07540
HYPER                                                                   DRE07550
BEGTCH TCH     HYPSMS                                                   DRE07560
ENDTCH TCH     HYCPYD                                                   DRE07570
HYPSMS SMS     70                                                       DRE07580
       CTLR    HYPORD                                                   DRE07590
HYPTCH TCH     **                                                       DRE07600
       CPYP    TRLRWD,,1                                                DRE07610
HYCPYD CPYD    0,,0                                                     DRE07620
       TCH     SYSTWT                                                   DRE07630
HYPORD OCT     120600120112                                             DRE07640
       TITLE                                                            DRE07650
UTMSG  BCI     5, FILE XXXXXX,    RECORD XXXXXX                         DRE07660
DPMSG  BCI     4,UNRDBL BLK DUMPED  *RD01                               DRE07670
CKMSG  BCI     4,INPUT CHKSM ERROR  *RD02                               DRE07680
SQMSG  BCI     6,INPUT BLOCK SEQ ERROR -        *RD03                   DRE07690
       EXTERN  MSGSUP                                                   DRE07700
       TITLE                                                            DRE07710
       DETAIL                                                           DRE07720
       END                                                              DRE07730
* 7090/94 SORT VER 7 MOD 5 WRITE FIXED LENGTH RECORDS FROM PHASE 1   (5)DWR00000
*      FAP
       COUNT   400                                                      DWR00010
*                                                                       DWR00020
*     WRITE SUBPROGRAM WRITES RECORDS WHICH HAVE BEEN SORTED BY         DWR00030
*  FIXED INTERNAL SORT PHASE.  TAGS POINTING TO RECORDS TO BE           DWR00040
*  WRITTEN (LIVE TAGS) ARE LOCATED IN THE L TABLE BY CELL ERA27         DWR00050
*  AND ARE MOVED TO THE WRITE TABLE (M TABLE) LOCATED BY CELL           DWR00060
*  ERA22.  IF THERE ARE DEAD TAGS LOCATED BY CELL ERA26 (TAGS WHICH     DWR00070
*  POINT TO BINS NOT BEING USED BECAUSE OF THE DELETE OPTION OR         DWR00080
*  VARIABLE BLOCK OPTION), THEY ARE MOVED INTO THE WRITE M TABLE        DWR00090
*  FOLLOWING THE LIVE TAGS.  THE LIVE TAGS ARE WRITTEN ON THE           DWR00100
*  APPROPRIATE MERGE TAPE IN PROPER LENGTH BLOCKS.  IF MERGING          DWR00110
*  IS TO USE ALL HYPERTAPES, THE RECORDS ARE BLOCKED IN REVERSE         DWR00120
*  ORDER (FLIPPED) TO GIVE DESCENDING BLOCKS WITHIN ASCENDING           DWR00130
*  STRINGS.  ALL TAGS IN THE WRITE TABLE ARE USED FOR THE NEXT READ.    DWR00140
*                                                                       DWR00150
       ENTRY   WRITE                                                    DWR00160
       SST                                                              DWR00170
*                                                                       DWR00180
WRITE  SXA     WRT100,1                                                 DWR00190
       SXA     WRT101,2                                                 DWR00200
       SXA     WRT102,4                                                 DWR00210
WRT005 TRA     *+1           ONE-TIME SWITCH.                           DWR00220
       AXT     0,2                                                      DWR00230
       CAL*    CHA02                                                    DWR00240
       STA     WRT013                                                   DWR00250
       STA     *+1                                                      DWR00260
       LDI     **                                                       DWR00270
       LFT     20000                                                    DWR00280
       STL     HYPRSW                                                   DWR00290
       CAL*    CHA00                                                    DWR00300
       STA     *+1                                                      DWR00310
       LDI     **                                                       DWR00320
       LNT     20000                                                    DWR00330
       TRA     WRT010        INPUT ON 729.                              DWR00340
       CAL     =O400000000000 INPUT ON HYPER.                           DWR00350
       SLW     INCMD                                                    DWR00360
       SLW     OUTCMD                                                   DWR00370
       TRA     WRT015                                                   DWR00380
WRT010 CAL     =O600000000000                                           DWR00390
       SLW     INCMD                                                    DWR00400
WRT013 LDI     **                                                       DWR00410
       LFT     20000                                                    DWR00420
       CAL     =O400000000000                                           DWR00430
       SLW     OUTCMD                                                   DWR00440
WRT015 LXA     CAL09,4                                               (3)DWR00450
       SXD     OUTCMD,4                                                 DWR00460
       LXA     REC00,4                                                  DWR00470
       SXD     INCMD,4                                                  DWR00480
       CAL     INCMD                                                    DWR00490
       LAS     OUTCMD                                                   DWR00500
       TRA     WRT016                                                   DWR00510
       TRA     *+2                                                      DWR00520
       TRA     WRT016                                                   DWR00530
       CAL     WRT078                                                   DWR00540
       SLW     WRT077                                                   DWR00550
       CAL     WRT110                                                   DWR00560
       SLW     WRT085                                                   DWR00570
WRT016 CLA     SAMPR-1       COMPUTE OVERFLOW CAPACITY.                 DWR00580
       NZT     SAMPR-2                                                  DWR00590
       SUB     =1                                                       DWR00600
       SUB     SAMPR-2       NUMBER OF EXTERNAL FILES TO BE MERGED.     DWR00610
       XCA                                                              DWR00620
       ZET     RAW20                                                    DWR00630
       TRA     *+3                                                      DWR00640
       MPY     =3450000                                                 DWR00650
       TRA     *+2                                                      DWR00660
       MPY     =5000000                                                 DWR00670
       STQ     CAPAC                                                    DWR00680
WRT017 STL     WRT005                                                   DWR00690
       LXD     ERA26,1       GET NUMBER OF DEAD TAGS TO BE MOVED.       DWR00700
       TXL     WRT060,1,0    TRANSFER IF NONE.                          DWR00710
WRT018 LXA     CAL06,2       PICK UP LENGTH OF WRITE TABLE.             DWR00720
       SXD     WRT020,2                                                 DWR00730
       LXA     ERA22,4       PICK UP LOCATION OF WRITE TABLE.           DWR00740
WRT020 TXI     *+1,4,**      CALCULATE BASE OF WRITE TABLE.             DWR00750
       SXA     WRT050,4                                                 DWR00760
       SXD     WRT030,1                                                 DWR00770
       LXA     ERA26,2                                                  DWR00780
WRT030 TXI     *+1,2,**      GET BASE OF DEAD TAGS.                     DWR00790
       SXA     WRT045,2                                                 DWR00800
WRT045 CLA     **,1          MOVE THE DEAD TAGS.                        DWR00810
WRT050 STO     **,1                                                     DWR00820
       TIX     WRT045,1,1                                               DWR00830
WRT060 LXD     ERA27,1       GET NUMBER OF LIVE TAGS TO BE MOVED.       DWR00840
       TXL     WRT200,1,0    TRANSFER IF NONE.                          DWR00850
       SXD     WRT062,1                                                 DWR00860
       LXA     ERA22,2       GET LOCATION OF WRITE TABLE.               DWR00870
WRT062 TXI     *+1,2,**                                                 DWR00880
       SXA     WRT075,2      SAVE BASE OF WRITE AREA.                   DWR00890
       SXA     RECDCN,1                                                 DWR00900
       ZET     RAW20                                                    DWR00910
       TRA     WRTH10                                                   DWR00920
*                                                                       DWR00930
* BUILD WRITE TABLE FOR 729 WRITE                                       DWR00940
*                                                                       DWR00950
       SXD     WRT065,1                                                 DWR00960
       LXA     ERA27,2                                                  DWR00970
WRT065 TXI     *+1,2,**      GET BASE OF LIVE TAGS.                     DWR00980
       SXA     WRT070,2                                                 DWR00990
       LDQ     OUTCMD                                                   DWR01000
WRT070 CAL     **,1          MOVE THE WRITE TAGS.                       DWR01010
WRT075 SLW     **,1                                                     DWR01020
WRT077 SLQ*    *-1           INSERT NEW CMD AND LENGTH, IF NECESSARY.   DWR01030
WRT078 TIX     WRT070,1,1                                               DWR01040
       TRA     WRTH90                                                   DWR01050
*                                                                       DWR01060
* BUILD WRITE TABLE FOR 7340 WRITE                                      DWR01070
*                                                                       DWR01080
WRTH10 LXA     CAL14,2                                                  DWR01090
       SXD     WRTH75,2                                                 DWR01100
       SXD     *+1,1         NUMBER OF LIVE TAGS TO MOVE.               DWR01110
       TXL     WRTH20,2,**   TRANSFER IF MERGE BLOCKING NGT WRITE TAGS. DWR01120
       PXA     ,1                                                       DWR01130
       PAX     ,2                                                       DWR01140
       SXD     WRTH75,2                                                 DWR01150
       ADD     ERA27                                                    DWR01160
       STA     WRTH50                                                   DWR01170
       PXA     ,1                                                       DWR01180
       ADD     ERA22                                                    DWR01190
       STA     WRTH60                                                   DWR01200
       AXT     0,1                                                      DWR01210
       TRA     WRTH41                                                   DWR01220
WRTH20 CAL     ERA27                                                    DWR01230
       ADD     CAL14                                                    DWR01240
       STA     WRTH50                                                   DWR01250
       CAL     ERA22                                                    DWR01260
       ADD     CAL14                                                    DWR01270
       STA     WRTH60                                                   DWR01280
       LAC     CAL14,2                                                  DWR01290
       SXD     *+1,2                                                    DWR01300
       TXI     *+1,1,**      KNOCK TOTAL DOWN BY MERGE BLOCKING.        DWR01310
WRTH40 LXA     CAL14,2                                                  DWR01320
WRTH41 AXT     1,4           SET TO FLIP TAGS AS THEY ARE MOVED.        DWR01330
       LDQ     OUTCMD                                                   DWR01340
WRTH50 CAL     **,2                                                     DWR01350
WRTH60 SLW     **,4          MOVE TAG.                                  DWR01360
WRTH70 SLQ*    *-1           EXECUTED ONLY IF CMD OR WC CHANGES.        DWR01370
WRTH71 TXI     *+1,4,1                                                  DWR01380
WRTH72 TIX     WRTH50,2,1                                               DWR01390
WRTH75 TIX     WRTH80,1,**   IS THERE MORE THAN A MERGE BLOCK LEFT.     DWR01400
       TXL     WRTH90,1,0    TRANSFER IF FINISHED.                      DWR01410
       PXA     ,1                                                       DWR01420
       PAX     ,2                                                       DWR01430
       ADM     WRTH50                                                   DWR01440
       STA     WRTH50                                                   DWR01450
       PXA     ,1                                                       DWR01460
       ADM     WRTH60                                                   DWR01470
       STA     WRTH60                                                   DWR01480
       AXT     0,1                                                      DWR01490
       TRA     WRTH41                                                   DWR01500
WRTH80 CAL     WRTH50                                                   DWR01510
       ADD     CAL14                                                    DWR01520
       STA     WRTH50                                                   DWR01530
       CAL     WRTH60                                                   DWR01540
       ADD     CAL14                                                    DWR01550
       STA     WRTH60                                                   DWR01560
       TRA     WRTH40                                                   DWR01570
*                                                                       DWR01580
* CHECK FOR OVERFLOW                                                    DWR01590
*                                                                       DWR01600
WRTH90 ZET     OVFRSK                                                   DWR01610
       TRA     WRTH99                                                   DWR01620
       CAL     CAPAC                                                    DWR01630
       LAS     OVCNT                                                    DWR01640
       TRA     WRTH99                                                   DWR01650
       TRA     *+1                                                      DWR01660
       NZT     RAW02                                                    DWR01670
       TRA     *-1                                                      DWR01680
       STZ     RAW25                                                    DWR01690
       STL     OVFRSK                                                   DWR01700
       CLA*    CHAPR                                                    DWR01710
       PAC     ,4                                                       DWR01720
       CLA     2,4                                                      DWR01730
       TSX     (DECVA,4                                                 DWR01740
       STQ     VOVMSB+3                                                 DWR01750
       TSX     MSGSUP,4,2    PRINT ON-LINE.                             DWR01760
               4                                                        DWR01770
               VOVMSA,,4                                                DWR01780
               VOVMSB,,4+512*4                                          DWR01790
               VOVMSC,,4                                                DWR01800
               VOVMSD,,4+512*4                                          DWR01810
       TSX     (PAUSE,4                                                 DWR01820
       STL     RAW24                                                    DWR01830
       AXT     VOVMSF,4                                                 DWR01840
       SWT     3                                                        DWR01850
       TXI     *+3,4,VOVMSE-VOVMSF   CHANGE TO VOVMSE.                  DWR01860
       STZ     RAW24                                                    DWR01870
       STL     RAW25                                                    DWR01880
       SXA     *+3,4                                                    DWR01890
       TSX     MSGSUP,4,2                                               DWR01900
               1                                                        DWR01910
               **,,3+512*4                                              DWR01920
*                                                                       DWR01930
WRTH99 ZET     WRTCSW         WAIT UNTIL PREVIOUS WRITE IS           (5)DWR01931
       TRA     *-1                    COMPLETED.                     (5)DWR01932
TSTEOT ZET     INTEOT         DID PREVIOUS WRITE HIT AN EOT.         (5)DWR01933
       TRA     EOTPIA         GO TAKE CARE OF EOT.                   (5)DWR01934
       ZET     SWTCHD         NO.                                    (5)DWR01935
       CALL    SWCHTP         SWITCH TAPES BY MEANS OF NEW SEQUENCE. (5)DWR01936
USUAL  LXD     RAW00,2        GET OUTPUT FILE NUMBER                 (5)DWR01940
       STZ     CONZET                                                (5)DWR01942
       TXI     *+1,2,-1                                                 DWR01950
       CAL*    CHA02         GET L(UCB) FOR OUTPUT.                     DWR01960
       STA     LUCBC                                                    DWR01970
       PAC     ,2                                                       DWR01980
       LDI     0,2                                                      DWR01990
       CLS     SELLOC                                                   DWR02000
       STO     1,2                                                      DWR02060
       CLA     RECDCN                                                   DWR02070
       ADD     CNTPR         UPDATE COUNT OF RECORDS SORTED.            DWR02080
       STO     CNTPR                                                    DWR02090
       NZT     HYPRSW                                                   DWR02100
       TRA     WRT080                                                   DWR02110
       LNT     40                                                       DWR02120
       TRA     WRT079                                                   DWR02130
       CAL     =1                                                       DWR02140
       ORS     HYPSMS                                                   DWR02150
WRT079 RIS     =O777760777777                                           DWR02160
       PIA                                                              DWR02170
       PDX     ,2                                                       DWR02180
       TXI     *+1,2,8576                                               DWR02190
       SXD     HYPORD,2                                                 DWR02200
WRT080 LXA     ERA22,4       INITIALIZE THE BEGINNING                   DWR02210
       SXA     CMDLOC,4       OF WRITE TABLE GROUP.                     DWR02220
       LXA     RECDCN,2                                                 DWR02230
       SXA     RECDCT,2      SAVE NUMBER OF RECORDS TO WRITE.           DWR02240
       LXD     RAW08,2       SET SEQUENCE BREAK FLAG AS                 DWR02250
       SXD     SEQBRK,2       GIVEN BY MAIN ROUTINE.                    DWR02260
       TSX     (ACTIV,4                                                 DWR02270
               LUCBC                                                    DWR02280
WRT082 CAL     WRT210        CHANGED TO TRA  WRT085   FIRST TIME.       DWR02290
       SLW     *-1                                                      DWR02300
       TRA     WRT100                                                   DWR02310
WRT085 LXD     ERA21,2                                                  DWR02320
       PXA     ,2                                                       DWR02330
       ADD     ERA21                                                    DWR02340
       STA     WRT090                                                   DWR02350
       LDQ     INCMD         INSERT NEW COMMAND AND LENGTH              DWR02360
WRT090 SLQ     **,2           IN READ TABLE, IF NECESSARY.              DWR02370
       TIX     *-1,2,1                                                  DWR02380
WRT100 AXT     **,1                                                     DWR02390
WRT101 AXT     **,2                                                     DWR02400
WRT102 AXT     **,4                                                     DWR02410
       TRA     1,4                                                   (5)DWR02430
*                                                                       DWR02470
WRT110 TRA     WRT100                                                   DWR02480
*                                                                       DWR02490
EOTPIA STZ     INTEOT                                                (5)DWR02491
       ZET     RECDCT         MORE LEFT TO WRITE                     (5)DWR02492
       TRA     TSTSEQ         YES                                    (5)DWR02493
       ZET     CONZET         TEST IN CASE EOT HAS BEEN HIT CONSECU- (5)DWR02494
       TRA     ROTATE               TIVELY..  YES.                   (5)DWR02495
       NZT     SAMSEQ         IS NEW WRITE REQUEST SAME SEQUENCE AS  (5)DWR02496
       TRA     USUAL              PREVIOUS. NO-TAPES ALREADY SWITCHED(5)DWR02497
ROTATE CALL    TAPEND         YES-SWITCH TAPES USING TAPEND ROUTINE  (5)DWR02498
       TRA     USUAL                                                 (5)DWR02499
TSTSEQ ZET     CONZET                                                (5)DWR0249A
       TRA     CALLTP                                                (5)DWR0249B
       ZET     SAMSEQ         IS NEW WRITE SAME SEQUENCE AS PREVIOUS.(5)DWR0249C
       TRA     CALLTP         YES.                                   (5)DWR0249D
       STL     SWTCHD         INDICATE WE HAVE USED NEW-SEQ TAPE TO  (5)DWR0249E
GETFIL LXD     RAW00,2            FINISH.GET OUTPUT FILE NUMBER.     (5)DWR0249F
       TXI     *+1,2,-1                                              (5)DWR0249G
       CAL*    CHA02          GET L(UCB) FOR OUTPUT.                 (5)DWR0249H
       STA     LUCBC                                                 (5)DWR0249I
       PAC     0,2                                                   (5)DWR0249J
       LDI     0,2                                                   (5)DWR0249K
       CLS     SELLOC                                                (5)DWR0249L
       ENB     =0                                                    (5)DWR0249M
       STO     1,2                                                   (5)DWR0249N
       LXD     RAW08,4        SET SEQUENCE BREAK FLAG                (5)DWR0249O
       SXD     SEQBRK,4                                              (5)DWR0249P
       STL     CONZET         SET IN CASE WE HIT  EOT AGAIN.         (5)DWR0249Q
       TSX     (ACTIV,4                                              (5)DWR0249R
       PZE     LUCBC                                                 (5)DWR0249S
       ZET     WRTCSW         WAIT HERE UNTIL WE HAVE WRITTEN OUT    (5)DWR0249T
       TRA     *-1                 THOSE RECORDS WHICH REMAINED.     (5)DWR0249U
       TRA     TSTEOT         SEE IF WE HAVE AGAIN HIT AN EOT        (5)DWR0249V
CALLTP CALL    TAPEND                                                (5)DWR0249W
       TRA     GETFIL                                                (5)DWR0249X
WRT200 ZET     WRTCSW        WHEN NO RECORDS ARE TO BE WRITTEN,         DWR02500
       TRA     *-1            WAIT FOR THE PREVIOUS WRITES TO BE        DWR02510
       ZET     INTEOT             COMPLETED BEFORE RETURNING         (5)DWR02512
       TRA     EOTPIA         GO TAKE CARE OF EOT.                   (5)DWR02514
       TRA     WRT082                                                   DWR02520
*                                                                       DWR02530
WRT210 TRA     WRT085                                                (5)DWR02540
*                                                                       DWR02550
*  WRITE SELECT ROUTINES                                                DWR02560
*                                                                       DWR02570
* SELECT PLUS ROUTINE                                                   DWR02580
*                                                                       DWR02590
WRTSEL SXA     WRT600,1                                                 DWR02600
       SXA     WRT601,2                                                 DWR02610
       SXA     WRT602,4                                                 DWR02620
       PAC     ,2            PUT -(LOCATION OF UCB) IN IR2.             DWR02630
       TMI     SELMIN                                                   DWR02640
       LDI     LSTCLK                                                   DWR02650
       CAL     3,2           PICK UP UCW 4.                             DWR02660
       STA     WRT550        INITIALIZE WRITE SELECT ADDRESS.           DWR02670
       NZT     SELPSW                                                   DWR02680
       TRA     WRT480                                                   DWR02690
       ZET     HYPRSW        TRANSFER IF THIS IS TO BE                  DWR02700
       TRA     WRT720         A REWRITE.                                DWR02710
       TRA     REWRIT                                                   DWR02720
WRT480 CAL     2,2                                                      DWR02730
       PAX     ,4                                                       DWR02740
       TXI     *+1,4,1                                                  DWR02750
       SXA     FSTCLK,4      INITIALIZE SEQUENCE COUNT.                 DWR02760
       CLA     CMDLOC                                                   DWR02770
       STA     HDTCH         SAVE LOCATION OF WRITE TABLE GROUP.        DWR02780
       STA     HDHYPT                                                   DWR02790
       ZAC                                                              DWR02800
       LXA     CAL14,4       GET NUMBER OF RECORDS PER MERGE BLOCK.     DWR02810
       SXD     WRT490,4                                                 DWR02820
       LXA     RECDCT,2      GET NUMBER OF RECORDS REMAINING THIS WRITE.DWR02830
WRT490 TXH     WRT500,2,**   TRANSFER IF MORE THAN ONE BLOCK REMAINS.   DWR02840
       LDQ     RECDCT                                                   DWR02850
       MPY     CAL09                                                 (3)DWR02860
       XCA                                                              DWR02870
       STA     SEQBRK                                                   DWR02880
       ALS     18                                                       DWR02890
       STD     LSTCLK                                                   DWR02900
       ARS     18                                                       DWR02910
       ADD     OVCNT                                                    DWR02920
       STO     OVCNT                                                    DWR02930
       SXA     RECDCT,0      NO RECORDS REMAIN                          DWR02940
       PXA     ,2                                                       DWR02950
       TRA     WRT520                                                   DWR02960
WRT500 LDQ     CAL14                                                    DWR02970
       MPY     CAL09                                                 (3)DWR02980
       XCA                                                              DWR02990
       STA     SEQBRK                                                   DWR03000
       ALS     18                                                       DWR03010
       STD     LSTCLK                                                   DWR03020
       ARS     18                                                       DWR03030
       ADD     OVCNT                                                    DWR03040
       STO     OVCNT                                                    DWR03050
       PXA     ,2                                                       DWR03060
       SUB     CAL14         DETERMINE RECORDS REMAINING FOR            DWR03070
       STA     RECDCT         FUTURE WRITES.                            DWR03080
       PXA     ,4                                                       DWR03090
WRT520 ADD     CMDLOC                                                   DWR03100
       STA     CMDLOC                                                   DWR03110
       CLA*    CMDLOC                                                   DWR03120
       STO     SAVE          KEEP FIRST COMMAND OF NEXT LIST.           DWR03130
       ZET     HYPRSW                                                   DWR03140
       TRA     WRT700                                                   DWR03150
       CLA     TLIORT                                                   DWR03160
       STO*    CMDLOC                                                   DWR03170
       CLA     WRTPOS                                                   DWR03180
       STA*    (RCHXI                                                   DWR03190
WRT550 WRS     **            SELECT.                                    DWR03200
       XEC*    (RCHXI                                                   DWR03210
WRT570 STL     WRTCSW        SET WRITE-IN-PROGRESS.                     DWR03220
       STL     SELPSW        SET SELECT-PLUS-LAST.                      DWR03230
WRT600 AXT     **,1                                                     DWR03240
WRT601 AXT     **,2                                                     DWR03250
WRT602 AXT     **,4                                                     DWR03260
       STL     GEN05                                                    DWR03270
       TRA     1,4                                                      DWR03280
*                                                                       DWR03290
WRT700 CLA     TLHYPT                                                   DWR03300
       STO*    CMDLOC                                                   DWR03310
WRT720 CLA     FSTHYP                                                   DWR03320
       STA*    (RCHXI                                                   DWR03330
       XEC*    (RCHXI                                                   DWR03340
       TRA     WRT570                                                   DWR03350
REWRIT CLA     WRTPOS        RESTORE RCHX AS BEFORE                     DWR03360
       STA*    (RCHXI         AND GO WRITE AGAIN.                       DWR03370
       TRA     WRT550                                                   DWR03380
*                                                                       DWR03390
*  SELECT MINUS ROUTINE                                                 DWR03400
*                                                                       DWR03410
SELMIN STZ     SELPSW        SET SELECT-MINUS-LAST.                     DWR03420
       NZT     HYPRSW                                                   DWR03430
       TRA     SELM40                                                   DWR03440
       CLA     2,2           SAVE HYPER UCW3 IN UCW4.                   DWR03450
       STO     3,2                                                      DWR03460
       RFT     4             CHECK FOR END WARNING AREA.                DWR03470
       TRA     SELM42        YES.                                       DWR03480
       LNT     10            CHECK FOR DATA CHECK.                      DWR03490
       TRA     SELM44        NO.                                        DWR03500
       TSX     (NDATA,4                                                 DWR03510
               LUCBC,,34     HBSR                                       DWR03520
       TSX     (NDATA,4                                                 DWR03530
               LUCBC,,36     HSKR                                       DWR03540
       STL     SELPSW        SET TO REWRITE.                            DWR03550
       TRA     WRT600                                                   DWR03560
SELM40 LFT     200000        CHECK FOR EOT.                             DWR03570
SELM42 STL     INTEOT        YES.                                       DWR03580
SELM44 CLA     SAVE                                                     DWR03590
       STO*    CMDLOC                                                   DWR03600
       ZET     INTEOT                                                (5)DWR03602
       TRA     SELM50                                                (5)DWR03604
       ZET     RECDCT                                                   DWR03610
       TRA     WRT600        MORE TO WRITE.                             DWR03620
SELM50 STZ     WRTCSW        SET WRITE-COMPLETED.                       DWR03630
       STZ     1,2           RELEASE UNIT.                              DWR03640
       TRA     WRT600                                                   DWR03650
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     DWR03660
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS                   DWR03670
LABPR  COMMON  5             LABEL CARD PARAMETERS                      DWR03680
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS                    DWR03690
FILPR  COMMON  14            FILE CARD PARAMETERS                       DWR03700
MODPR  COMMON  50            MODIFICATION CARD PARAMETERS               DWR03710
RECPR  COMMON  10            RECORD CARD PARAMETERS                     DWR03720
DELPR  COMMON  2             DELETE CARD PARAMETERS                     DWR03730
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS             DWR03740
CALPR  COMMON  50            CALCULATED PARAMETERS                      DWR03750
GENPR  COMMON  10            GENERAL PARAMETERS                         DWR03760
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  DWR03770
CNTPR  COMMON  20            COUNT PARAMETERS                           DWR03780
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS                DWR03790
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER            DWR03800
CHA00  EQU     CHAPR         INPUT UNIT TO INTERNAL SORT PHASE.         DWR03810
CHA02  EQU     CHAPR-2       OUTPUT UNITS FROM INTERNAL SORT PHASE      DWR03820
REC00  EQU     RECPR         RECORD LENGTH                              DWR03830
REC01  EQU     RECPR-1       EFFECTIVE RECORD LENGTH                    DWR03840
CAL06  EQU     CALPR-6                                                  DWR03850
CAL08  EQU     CALPR-8       EFFECTIVE RECORD LENGTH                    DWR03860
CAL09  EQU     CALPR-9                                               (3)DWR03865
CAPAC  EQU     CALPR-11      CAPACITY IN WORDS.                         DWR03870
CAL14  EQU     CALPR-14      NUMBER OF RECORDS PER MERGE BLOCK          DWR03880
GEN05  EQU     GENPR-5                                                  DWR03890
RAW00  EQU     RAWPR         OUTPUT FILE NUMBER                         DWR03900
RAW02  EQU     RAWPR-2                                                  DWR03910
SWTCHD EQU     RAWPR-5                                               (5)DWR03920
RAW08  EQU     RAWPR-8       SEQUENCE BREAK (STRING COUNT)              DWR03930
RAW20  EQU     RAWPR-20      NONZERO = ALL HYPERS IN MERGE              DWR03940
RAW24  EQU     RAWPR-24                                                 DWR03950
RAW25  EQU     RAWPR-25                                                 DWR03960
SAMSEQ EQU     RAWPR-28                                              (5)DWR03961
ERA21  EQU     ERAPR-21      LOCATION AND LENGTH OF READ TABLE          DWR03970
ERA22  EQU     ERAPR-22      LOCATION AND LENGTH OF WRITE TABLE         DWR03980
ERA26  EQU     ERAPR-26      LOCATION AND LENGTH OF DEAD TAGS           DWR03990
ERA27  EQU     ERAPR-27      LOCATION AND LENGTH OF LIVE TAGS           DWR04000
       TITLE                                                            DWR04010
       EXTERN  MSGSUP                                                   DWR04020
VOVMSA BCI     4,CAPACITY REACHED   *OV01                               DWR04030
VOVMSB BCI     4,  OVERFLOW,BLOCKS/XXXXXX                               DWR04040
VOVMSC BCI     4,TO STOP INPUT - - SS3 UP                               DWR04050
VOVMSD BCI     4,TO KEEP READING - SS3 DN                               DWR04060
VOVMSE BCI     3,(INPUT STOPPED)                                        DWR04070
VOVMSF BCI     3,(INPUT CONTINUES)                                      DWR04080
SELLOC         ,,WRTSEL                                                 DWR04090
LUCBC                                                                   DWR04100
SELPSW                                                                  DWR04110
INTEOT                                                                  DWR04120
CONZET PZE                                                           (5)DWR04125
RECDCT                                                                  DWR04130
RECDCN                                                                  DWR04140
WRTPOS         HDIOCP                                                   DWR04150
CMDLOC                                                                  DWR04160
HDIOCP IOCP    FSTCLK,,2                                                DWR04170
HDTCH  TCH     **                                                       DWR04180
TLIORT IORT    LSTCLK,,1                                                DWR04190
LSTCLK OCT     631463                                                   DWR04200
FSTCLK OCT     631463000000                                             DWR04210
SEQBRK                                                                  DWR04220
WRCPYP CPYP    **,,**                                                   DWR04230
WRIOSP IOSP    **,,**                                                   DWR04240
INCMD                                                                   DWR04250
OUTCMD                                                                  DWR04260
WRTCSW                                                                  DWR04270
HYPRSW                                                                  DWR04280
FSTHYP         HYPSMS                                                   DWR04290
HYPSMS SMS     6                                                        DWR04300
       CTLW    HYPORD                                                   DWR04310
       CPYP    FSTCLK,,2                                                DWR04320
HDHYPT TCH     **                                                       DWR04330
HYPORD OCT     120600120112                                             DWR04340
TLHYPT TCH     HYCPYD                                                   DWR04350
HYCPYD CPYD    LSTCLK,,1                                                DWR04360
       TCH     SYSTWT                                                   DWR04370
OVCNT                                                                   DWR04380
OVFRSK                                                                  DWR04390
SAVE                                                                    DWR04400
       DETAIL                                                           DWR04410
       END                                                              DWR04420
*  7090/94 SORT, VER 7, MOD 0.  WRITE TABLE FIXER                       DWT00000
*      FAP
       COUNT   40                                                       DWT00010
* CALLING SEQUENCE                                                      DWT00020
*      TSX     WTFIX,4                                                  DWT00030
*         RETURN                                                        DWT00040
       SPACE                                                            DWT00050
       ENTRY   WTFIX                                                    DWT00060
       SPACE                                                            DWT00070
 WTFIX SXA     WTF20,1       SAVE INDEX                                 DWT00080
       SXA     WTF25,2        REGISTERS.                                DWT00090
       LXD     WBASE,1       COMPUTE BASE OF WRITE LIST                 DWT00100
       PXA     ,1             FOR USE IN                                DWT00110
       ADD     WBASE          TIXING THROUGH                            DWT00120
       STA     WTF08          SUCCESSIVE                                DWT00130
       STA     WTF10          COMMANDS.                                 DWT00140
       STA     WTF18                                                    DWT00150
 WTF05 LDI*    WTF08         PICK UP FIRST COMMAND.                     DWT00160
       LFT     77777         SEE IF DECREMENT IS ZERO.                  DWT00170
       TRA     WTF15         DECREMENT NOT ZERO.                        DWT00180
       PXA     ,1            IF DECREMENT IS ZERO                       DWT00190
       PAX     ,2             PREPARE TO PICK UP                        DWT00200
       TXI     *+1,2,-1       SUBSEQUENT COMMANDS.                      DWT00210
       TRA     WTF10                                                    DWT00220
 WTF08 LDI     **,1          PICK UP NEXT COMMAND.                      DWT00230
       LFT     77777         SEE IF DECREMENT IS ZERO.                  DWT00240
       TRA     WTF15         DECREMENT NOT ZERO.                        DWT00250
       TNX     WTF16,2,1                                                DWT00260
 WTF10 LDI     **,2          PICK UP COMMANDS FOLLOWING ONE WITH ZERO   DWT00270
       LFT     77777          DECREMENT AND CHECK THEIR DECREMENTS.     DWT00280
       TRA     WTF12         DECREMENT NOT ZERO.                        DWT00290
       TIX     WTF10,2,1     IF DECREMENT IS ZERO, CHECK NEXT ONE.      DWT00300
       TRA     WTF16                                                    DWT00310
 WTF12 LDQ*    WTF08         SWAP ONE WITH                              DWT00320
       STQ*    WTF10          ZERO DECREMENT                            DWT00330
       STI*    WTF08          AND ONE WITHOUT.                          DWT00340
       TIX     WTF08,1,1     RETURN TO CHECK NEXT COMMAND.              DWT00350
       TRA     WTF16                                                    DWT00360
 WTF15 TIX     WTF05,1,1     CHECK NEXT COMMAND.                        DWT00370
 WTF16 LXA     WTFCT,2       PICK UP LOCATION OF LAST                   DWT00380
       TXI     *+1,2,1        UNDELETED OR UNPADDED                     DWT00390
       CLA*    WTF18          RECORD IN WRITE TABLE AND                 DWT00400
       STA     ERAPR-6       SAVE FOR SORT PHASE.                       DWT00410
 WTF17 LXA     WTFCT,2       PUT THE RECORD                             DWT00420
       LXA     RECLH,1        LENGTH BACK INTO THE                      DWT00430
       PXD     ,1             WORD COUNT PORTION OF                     DWT00440
 WTF18 STD     **,2           THOSE COMMANDS IN WHICH                   DWT00450
       TIX     *-1,2,1        IT WAS ZEROED OUT.                        DWT00460
       STZ     WTFCT         RESET WRITE TABLE FIXER COUNT.             DWT00470
 WTF20 AXT     **,1          RESTORE INDEX                              DWT00480
 WTF25 AXT     **,2           REGISTERS.                                DWT00490
       STL     GENPR-5                                                  DWT00500
       TRA     1,4           RETURN TO MAIN PROGRAM.                    DWT00510
       SPACE                                                            DWT00520
       COMMON  92                                                       DWT00530
 RECPR COMMON  10             RECORD CARD PARAMETERS                    DWT00540
       COMMON  59                                                       DWT00550
 GENPR COMMON  10             GENERAL PARAMETERS                        DWT00560
 RAWPR COMMON  30            READ AND WRITE PARAMETERS                  DWT00570
 CNTPR COMMON  20             COUNT PARAMETERS                          DWT00580
 ERAPR COMMON  30             ERASABLE STORAGE PARAMETERS               DWT00590
       SPACE                                                            DWT00600
 RECLH EQU     RECPR-0       (RECORD LENGTH)                            DWT00610
 RWCS2 EQU     RAWPR-1       (BEGINNING OF WRITE LIST,, ITS LENGTH)     DWT00620
 WBASE EQU     ERAPR-11      (LOCATION AND LENGTH OF WRITE TABLE)       DWT00630
 WTFCT EQU     CNTPR-12      (WRITE TABLE FIXER COUNT)                  DWT00640
       SPACE                                                            DWT00650
       END                                                              DWT00660
*  7090/7094  SORT,DUMP UNREADABLE RECORDS,              VER  7   MOD(2)EDD00000
*      FAP
       COUNT   200                                                      EDD00010
       SPACE                                                            EDD00020
       ENTRY   DEBLK                                                    EDD00030
       SST                                                              EDD00040
       SPACE                                                            EDD00050
DEBLK  SXA     XR1,1         SAVE                                       EDD00060
       SXA     XR2,2            INDEX                                   EDD00070
       SXA     XR4,4               REGISTERS                            EDD00080
       NZT     CHAPR-5       US THERE A DUMP TAPE +                     EDD00090
       ZET     NDMPS         SUPPRESS PRINTING +                        EDD00100
DEB05  TRA     CHKOPT        NO. CANNOT DUMP.                        (2)EDD00110
       CLA     1,4           GET CALLING SEQUENCE                       EDD00120
       PDX     ,2            GET NUMBER OF TABLE ENTRIES                EDD00130
       SXA     ENTRYS,2         AND SAVE                                EDD00140
       TXL     DEB05,2,0                                                EDD00150
       ARS     18                                                       EDD00160
       ADD     1,4                                                      EDD00170
       STA     CC                                                       EDD00180
       NZT     OPTPR-7       USE SYSOU1 +                               EDD00190
       TRA     CC            YES-SKIP SYSCK2 SET UP                     EDD00200
       LAC     SYSCK2,1      MAKE                                       EDD00210
       CLA     0,1              CERTAIN                                 EDD00220
       PAI                                                              EDD00230
       STL     URTHYP        SET HYPER SWITCH ON                        EDD00240
       LNT     020000        HYPERTAPE +                                EDD00250
       STZ     URTHYP        NO-TURN HYPER SWITCH OFF                   EDD00260
       ARS     9                   SYSCK2                               EDD00270
       ANA     KONT          CHANNEL                                    EDD00280
       PDC     0,1                       IS                             EDD00290
       TXI     *+1,1,1                      NOT                         EDD00300
       ZET*    (CHXAC                          IN                       EDD00310
       TRA     *-1                                OPERATION             EDD00320
       CALL    SAVEW         SAVE CALLING SEQUENCE WORDS                EDD00330
       CLA     RWCS1                                                    EDD00340
       STO     RAWPR         SET UP TO                                  EDD00350
       CLA     =O3000000     SKIP FIRST FILES                           EDD00360
       ADD     CNTPR-13      SKIP N RECORDS                             EDD00370
       STO     RAWPR-1                                                  EDD00380
       CALL    SKIP                                                     EDD00390
       CALL    RESTW         RESTORE CALLING SEQUENCE WORDS             EDD00400
CC     CLA     **,2          GET AN ENTRY FROM TABLE                    EDD00410
       PDX     ,1            RECORD LENGTH TO REGISTER                  EDD00420
       TXL     LE05,1,0                                                 EDD00430
       SXA     RECLEN,1         AND SAVE                                EDD00440
       SXA     HOLD+1,1                                                 EDD00450
       ARS     18                                                       EDD00460
       ADD*    CC                                                       EDD00470
       STA     AAA                                                      EDD00480
       STA     LOAD                                                     EDD00490
       AXT     20,1          BLANK OUT                                  EDD00500
A      CLA     BLANKS           STORAGE                                 EDD00510
       STO     OUTPUT+20,1         PRINT OUT                            EDD00520
       TIX     *-1,1,1                AREA                              EDD00530
AA     CLA     RECLEN        GET RECORD LENGTH                          EDD00540
       ZET     MORE          IS MORE INDICATOR ON                       EDD00550
       CLA     MORE          YES                                        EDD00560
       SUB     FIVE          SUBTRACT FIVE                              EDD00570
       NZT     GENPR-1       BCD (0) OR BINARY (NZ)                     EDD00580
       SUB     FIVE          BCD, SUBTRACT ANOTHER FIVE                 EDD00590
       TZE     B             RECORD LENGTH EQUAL TO 10 (OR 5)           EDD00600
       TMI     B             RECORD LENGTH LESS THAN 10 (OR 5)          EDD00610
       STA     MORE          SET MORE INDICATOR                         EDD00620
       AXT     10,1          SET UP                                     EDD00630
       ZET     GENPR-1          REGISTERS                               EDD00640
       AXT     5,1                 FOR                                  EDD00650
       LXA     HOLD+1,2               10 (OR 5) WORD                    EDD00660
       TRA     BBB                       LOOP                           EDD00670
B      ZET     MORE          IS MORE INDICATOR ON                       EDD00680
       TRA     BB            YES                                        EDD00690
       LXA     RECLEN,1      SET UP REGISTER WITH RECORD LENGTH         EDD00700
       LXA     HOLD+1,2         WHICH IS LESS THAN 10 (OR5)             EDD00710
       TRA     BBB                                                      EDD00720
BB     LXA     MORE,1                                                   EDD00730
       LXA     HOLD+1,2                                                 EDD00740
       STZ     MORE          RESET MORE INDICATOR                       EDD00750
BBB    AXT     18,4                                                     EDD00760
       ZET     GENPR-1       BCD (0) OR BINARY (NZ)                     EDD00770
       TRA     BINARY                                                   EDD00780
AAA    LDQ     **,2          GET A WORD FROM THE RECORD                 EDD00790
       SXA     ILXR4,4       SCAN                                       EDD00800
       TSX     STAT,4                                                   EDD00810
       AXT     6,4           FOR                                        EDD00820
ILOOP  ZAC                   AND                                        EDD00830
       LGL     6             REPLACE                                    EDD00840
       CAS     RCDMRK        ILLEGAL                                    EDD00850
       TRA     *+2           BCD                                        EDD00860
       CLA     OCT13         CHARACTERS                                 EDD00870
       STO     ILTEMP        FOR                                        EDD00880
       ANA     OCT17         1401                                       EDD00890
       SUB     OCT15         PRINTING                                   EDD00900
       TMI     *+3                                                      EDD00910
       CLA     ASTER                                                    EDD00920
       STO     ILTEMP                                                   EDD00930
       CLA     ILTEMP                                                   EDD00940
       LGR     6                                                        EDD00950
       RQL     6                                                        EDD00960
       TIX     ILOOP,4,1                                                EDD00970
ILXR4  AXT     **,4                                                     EDD00980
       STQ     OUTPUT+19,4                                              EDD00990
       TXI     *+1,4,-2         OUTPUT                                  EDD01000
       TXI     *+1,2,-1            BUFFER                               EDD01010
       TIX     AAA,1,1       GET ANOTHER WORD FROM RECORD               EDD01020
CHAR   CLA     SPACER        GET CARRIAGE CONTROL CHARACTER             EDD01030
       NZT     CHAR1         DOUBLE SPACING REQUIRED +                  EDD01040
       STO     OUTPUT        YES-STORE CARRIAGE CONTROL CHARACTER       EDD01050
       SXA     HOLD+1,2                                                 EDD01060
       NZT     NDMPS         TEST NO-DUMP SWITCH.  SKIP IF NO DUMP.     EDD01070
       TSX     WRITE,4       WRITE OUT THE BUFFER                       EDD01080
       LAC     SYSCK2,1      GET LOCATION OF UCB            IS USED     EDD01090
       ZET     1,1           WAIT FOR                                   EDD01100
       TRA     *-1              WRITE COMPLETION                        EDD01110
       STL     CHAR1         SET CHARACTER INDICATOR                    EDD01120
       ZET     MORE          ANY WORDS LEFT TO WRITE                    EDD01130
       TRA     A-1           YES                                        EDD01140
       LXA     ENTRYS,2      GET NUMBER OF TABLE ENTRIES                EDD01150
       TXI     *+1,2,-1      DROP BY ONE                                EDD01160
       SXA     ENTRYS,2      SAVE COUNT                                 EDD01170
       TXH     CC,2,0        ANY ENTRIES LEFT                           EDD01180
       NZT     OPTPR-7                                                  EDD01190
       TRA     XR1                                                      EDD01200
       AXT     33,4          HYPER WEF                                  EDD01210
       NZT     URTHYP        HYPERTAPE +                                EDD01220
       AXT     7,4           NO-729 WEF                                 EDD01230
       SXD     *+2,4                                                    EDD01240
       TSX     (NDSLX,4      WRITE EOF                                  EDD01250
       PZE     SYSCK2,,**    ON CKPT TAPE                               EDD01260
       TSX     EOT,4         END OF TAPE                                EDD01270
       AXT     30,4          HYPER REWIND                               EDD01280
       NZT     URTHYP        HYPERTAPE +                                EDD01290
       AXT     3,4           NO-729 REWIND                              EDD01300
       SXD     *+2,4                                                    EDD01310
       TSX     (NDSLX,4      REWIND                                     EDD01320
       PZE     SYSCK2,,**    CKPT TAPE                                  EDD01330
XR1    AXT     **,1          NO,                                        EDD01340
XR2    AXT     **,2             RESTORE                                 EDD01350
XR4    AXT     **,4                REGISTERS                            EDD01360
       STZ     CHAR1         RESET CHARACTER INDICATOR                  EDD01370
       STZ     HOLD+1        RESET XR2 HOLDER                           EDD01380
       STL     GENPR-5                                                  EDD01390
CHKOPT NZT     OPTPR-11      UNRDBL OPTION SPECIFIED+                (2)EDD01400
       TRA     2,4           NO. RETURN TO CALLER.                   (2)EDD01401
       TSX     MSGSUP,4,2    YES. PRINT MESSAGE-                     (2)EDD01402
       PZE     1                                                     (2)EDD01403
       PZE     DELMSG,,5     PRESS START TO DELETE SORT.             (2)EDD01404
       TSX     (PAUSE,4                                              (2)EDD01405
       LXD     GENPR-3,4                                             (2)EDD01406
       TRA     4,4                                                   (2)EDD01407
DELMSG BCI     5,PRESS START TO DELETE SORT                          (2)EDD01408
BINARY SXA     HOLD,1        SAVE BINARY WORD COUNT                     EDD01410
       STZ     HALF          RESET HALF INDICATOR                       EDD01420
LOAD   LDQ     **,2                                                     EDD01430
       SXA     *+2,4                                                    EDD01440
       TSX     STAT,4                                                   EDD01450
       AXT     **,4                                                     EDD01460
       ZAC                   ROUTINE                                    EDD01470
C      AXT     6,1              TO CONVERT A                            EDD01480
       ALS     3                   BINARY WORD                          EDD01490
       LGL     3                      TO OCTAL                          EDD01500
       TIX     C+1,1,1                   FOR PRINTING                   EDD01510
       STO     OUTPUT+19,4   PLACE IN OUTPUT BUFFER                     EDD01520
       TXI     *+1,4,-1                                                 EDD01530
       ZET     HALF          IS HALF INDICATOR ON                       EDD01540
       TRA     *+3           YES                                        EDD01550
       STL     HALF          NO, SET IT                                 EDD01560
       TRA     C-1           CONVERT SECOND HALF OF WORD                EDD01570
       TXI     *+1,4,-2                                                 EDD01580
       TXI     *+1,2,-1                                                 EDD01590
       LXA     HOLD,1        HAVE FIVE WORDS BEEN                       EDD01600
       TXI     *+1,1,-1         CONVERTED TO OCTAL                      EDD01610
       TXL     CHAR,1,0      YES                                        EDD01620
       SXA     HOLD,1        NO, SAVE XR1                               EDD01630
       TRA     BINARY+1      GET ANOTHER BINARY WORD                    EDD01640
WRITE  SXA     SAVE,1        SAVE                                       EDD01650
       SXA     SAVE+1,2         THE                                     EDD01660
       SXA     SAVE+2,4            REGISTERS                            EDD01670
       CLA     CNTPR-13                                                 EDD01680
       ADD     ONE                                                      EDD01690
       STA     CNTPR-13                                                 EDD01700
       NZT     OPTPR-7       SYSOU1 AVAILABLE +                         EDD01710
       TRA     USESPT        YES-USE IT NOT SYSCK2                      EDD01720
       LAC     SYSCK2,4      PLACE ADDRESS OF SELECT ROUTINE            EDD01730
       ZET     URTHYP        HYPERTAPE +                                EDD01740
       TSX     HYPBLT,2      YES-GO BUILD HYPER COMMANDS                EDD01750
       CAL     SELADD              IN SECOND WORD                       EDD01760
       SLW     1,4                    OF UCW BLOCK                      EDD01770
       TSX     (ACTVX,4      ACTIVATE                                   EDD01780
       MZE     SYSCK2                                                   EDD01790
SAVE   AXT     **,1                                                     EDD01800
       AXT     **,2                                                     EDD01810
       AXT     **,4                                                     EDD01820
       TRA     1,4                                                      EDD01830
HYPBLT SXA     HBLT,2                                                   EDD01840
       LDI     0,4           GET FIRST UCW                              EDD01850
       AXT     23,2                                                     EDD01860
       LNT     000040        BUILD                                      EDD01870
       AXT     22,2          HYPERTAPE                                  EDD01880
       SXA     HIOADD,2      SMS                                        EDD01890
       PIA                                                              EDD01900
       ANA     KONT          BUILD                                      EDD01910
       PDX     ,2            HYPERTAPE                                  EDD01920
       TXI     *+1,2,8576    ORDER                                      EDD01930
       SXD     HYPORD,2                                                 EDD01940
HBLT   AXT     **,2                                                     EDD01950
       TRA     1,2                                                      EDD01960
USESPT ZET     CHAR1         DOUBLE SPACING REQUIRED +                  EDD01970
       TRA     SSONLY        NO                                         EDD01980
       TSX     (PROUT,4                                                 EDD01990
       MON     1                                                        EDD02000
       PZE     **,,4*512     DO A DOUBLE SPACE                          EDD02010
SSONLY TSX     (PROUT,4      PRINT BUFFER                               EDD02020
       MON     1             UNDER SINGLE SPACE                         EDD02030
       PZE     OUTPUT+1,,19  CONTROL                                    EDD02040
       XEC     SAVE+2                                                   EDD02050
       TRA     4,4                                                      EDD02060
HIOADD SMS     **                                                       EDD02070
       CTLW    HYPORD                                                   EDD02080
       CPYD    OUTPUT,,20                                               EDD02090
       TCH     SYSTWT                                                   EDD02100
HYPORD OCT     120600120100                                             EDD02110
SELEC  SXA     HOLDER,4      SAVE REGISTER 4                            EDD02120
       PAC     ,2                                                       EDD02130
       TMI     SMINUS        GO TO SELECT MINUS                         EDD02140
       AXT     HIOADD,4      GET ADDRESS OF HYPER COMMAND               EDD02150
       NZT     URTHYP        HYPERTAPE +                                EDD02160
       AXT     IOADD,4       GET ADDRESS OF  729  COMMAND               EDD02170
       PXA     ,4                                                       EDD02180
       STA*    (RCHXI           AND STORE IN IOEX TABLE                 EDD02190
       CLA*    SYSCK2                                                   EDD02200
       ARS     18               OF I/O UNIT                             EDD02210
       STA     *+2           PLACE IO ADDRESS IN 729 SELECT             EDD02220
       NZT     URTHYP        HYPERTAPE +                                EDD02230
       WRS     **            WRITE                                      EDD02240
       XEC*    (RCHXI        EXECUTE THE RCHX OF IOEX                   EDD02250
HOLDER AXT     **,4                                                     EDD02260
       TRA     1,4           RETURN                                     EDD02270
SMINUS ZET     URTHYP        HYPERTAPE +                                EDD02280
       TRA     HSMIN         YES                                        EDD02290
       LFT     200000        NO-EOT +                                   EDD02300
       TSX     EOT,4         END OF TAPE ENCOUNTERED                    EDD02310
       STZ     1,2                                                      EDD02320
       TRA     HOLDER                                                   EDD02330
HSMIN  LNT     001000        UNUSUAL END +                              EDD02340
       TRA     NORMRT        NO-NORMAL RETURN                           EDD02350
       RFT     777773        YES-ANY ERRORS +                           EDD02360
       TRA     ERRT          YES-ERROR RETURN                           EDD02370
       RFT     000004        NO-EOW ENCOUNTERED +                       EDD02380
       TSX     EOT,4         YES                                        EDD02390
NORMRT STZ     1,2           NO-NORMAL                                  EDD02400
       TRA     HOLDER        RETURN                                     EDD02410
ERRT   XEC     HOLDER                                                   EDD02420
       TRA     3,4           ERROR RETURN                               EDD02430
EOT    SXA     SAVE4,4                                                  EDD02440
       TSX     MSGSUP,4,2    PRINT END OF TAPE MESSAGE                  EDD02450
KONT   PZE     1,,15                                                    EDD02460
       PZE     DMES1,,9                                                 EDD02470
       TSX     (PAWSX,4                                                 EDD02480
       STL     NDMPS         SET NO DUMP SWITCH                         EDD02490
SAVE4  AXT     **,4                                                     EDD02500
       TRA     1,4                                                      EDD02510
LE05   TSX     MSGSUP,4,2                                               EDD02520
       PZE     1                                                        EDD02530
       PZE     *+2,,1+4*512                                             EDD02540
       TRA     XR1                                                      EDD02550
       BCI     1,*LE05                                                  EDD02560
FIVE   DEC     5                                                        EDD02570
ILTEMP                                                                  EDD02580
RCDMRK OCT     72                                                       EDD02590
ASTER  OCT     54                                                       EDD02600
OCT17  OCT     17                                                       EDD02610
OCT15  OCT     15                                                       EDD02620
OCT13  OCT     13                                                       EDD02630
SPACER BCI     1,-                                                      EDD02640
BLANKS BCI     1,                                                       EDD02650
SELADD MZE     0,,SELEC                                                 EDD02660
RWCS1  MZE     2,,-1                                                    EDD02670
IOADD  IORT    OUTPUT,,20                                               EDD02680
ENTRYS                                                                  EDD02690
HALF                                                                    EDD02700
MORE                                                                    EDD02710
CHAR1                                                                   EDD02720
HOLD                                                                    EDD02730
                                                                        EDD02740
RECLEN                                                                  EDD02750
URTHYP                                                                  EDD02760
OUTPUT BSS     20                                                       EDD02770
DMES1  BCI     9,EOT, SYSCK2-NO MORE UNRDBL RECORDS CAN BE SAVED *WR02  EDD02780
STAT   SXA     STXR4,4       KEEP                                       EDD02790
       LXA     GENPR,4       COUNT                                      EDD02800
       CAL     CNTPR-2,4     OF THE                                     EDD02810
       ADD     ONE           NUMBER OF WORDS                            EDD02820
       SLW     CNTPR-2,4     DUMPED IN                                  EDD02830
STXR4  AXT     **,4          EACH PHASE                                 EDD02840
       TRA     1,4                                                      EDD02850
ONE    DEC     1                                                        EDD02860
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    EDD02870
OVEPR  COMMON  2             OVERFLOW PARAMETERS.                       EDD02880
LABPR  COMMON  5             LABEL PARAMETERS.                          EDD02890
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   EDD02900
FILPR  COMMON  14            FILE CARD PARAMETERS.                      EDD02910
MODPR  COMMON  50            MODIFICATION PARAMETERS.                   EDD02920
RECPR  COMMON  10            RECORD PARAMETERS.                         EDD02930
DELPR  COMMON  2             DELETE PARAMETERS.                         EDD02940
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            EDD02950
CALPR  COMMON  50            CALCULATED PARAMETERS.                     EDD02960
GENPR  COMMON  10            GENERAL PARAMETERS.                        EDD02970
RAWPR  COMMON  30            READ AND WRITE PARAMETERS.                 EDD02980
CNTPR  COMMON  20            COUNTS.                                    EDD02990
ERAPR  COMMON  30            ERASABLE COMMON PARAMETERS.                EDD03000
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER.           EDD03010
NDMPS  EQU     GENPR-9       SWITCH TO SUPPRESS DUMPING                 EDD03020
       EXTERN  MSGSUP                                                   EDD03030
       END                                                              EDD03040
* 7090/94 SORT VER 7 MOD 8 FINAL MERGE FOR 729 ONLY                  (8)EVF00000
*      FAP
       COUNT   1900                                                     EVF00010
       ENTRY   FIMRG                                                    EVF00020
       SST                                                              EVF00030
       TITLE                                                            EVF00040
*  CARD EVF00010 IS THE COUNT CARD (COUNT GIVEN IS 1900).               EVF00050
       SPACE   3                                                        EVF00060
*  THIS ROUTINE WILL MERGE FIXED LENGTH RECORDS IF                      EVF00070
*   THE CELL RECPR-5 CONTAINS ZERO, VARIABLE LENGTH                     EVF00080
*   RECORDS OTHERWISE.  THE RECORDS MAY BE IN A FILE                    EVF00090
*   WHICH IS OUTPUT FROM A PREVIOUS PHASE OF 7090/94                    EVF00100
*   SORT, OR A FILE WHICH IS FIRST INTRODUCED FROM                      EVF00110
*   THE EXTERNAL WORLD AT THE BEGINNING OF THIS PHASE.                  EVF00120
       SPACE                                                            EVF00130
*  CONTROL IS RECEIVED FROM THE SORT MONITOR AT LOCA-                   EVF00140
*   TION FIMRG.  AT THIS TIME INDEX REGISTER 2 CONTAINS                 EVF00150
*   THE LOCATION OF THE FIRST AVAILABLE CELL IN MEMORY                  EVF00160
*   WHICH THIS PHASE MAY USE FOR GENERATED TABLES AND                   EVF00170
*   RECORD STORAGE.  CONTROL IS RELINQUISHED TO SORT                    EVF00180
*   MONITOR (RETURN TO 3,4) WHEN ALL INPUT FILES ARE                    EVF00190
*   AT END OF FILE AND ALL RECORDS HAVE BEEN MERGED,                    EVF00200
*   OR WHEN UNDER AN ERROR CONDITION THE OPERATOR                       EVF00210
*   EXERCISES THE OPTION TO DELETE THE JOB.                             EVF00220
       SPACE                                                            EVF00230
*  READING IS ACCOMPLISHED BY MRGIO, AN I/O ROUTINE                     EVF00240
*   LOADED CONCURRENTLY WITH THIS SUBPROGRAM, AND CALLED                EVF00250
*   BY THIS PROGRAM WHEN A NEW BLOCK OF INPUT DATA                      EVF00260
*   IS DESIRED.  EACH INPUT FILE IS ASSIGNED A LOGIC-                   EVF00270
*   AL FILE NUMBER WHICH CORRESPONDS TO THE POSITION                    EVF00280
*   OF AN ENTRY IN A TABLE IN UPPER MEMORY (COMMON).                    EVF00290
*   N FILES WILL THEN BE DESIGNATED BY THE LOGICAL                      EVF00300
*   FILE NUMBERS 1,2,...,N.  IN REQUESTING AN INPUT                     EVF00310
*   BLOCK FROM MRGIO, THE SUBROUTINE CALLED READ                        EVF00320
*   PUTS THE APPROPRIATE LOGICAL FILE NUMBER INTO                       EVF00330
*   THE DECREMENT PORTION OF RAWPR, MAKES THE SIGN                      EVF00340
*   BIT OF RAWPR PLUS, AND CALLS MRGIO.  MRGIO THEN                     EVF00350
*   SETS THE CELL RAWPR-2 ZERO TO INDICATE A READ                       EVF00360
*   IN PROGRESS.  RAWPR-2 IS SET NONZERO BY MRGIO                       EVF00370
*   WHEN THE READ HAS GONE TO COMPLETION AND ERROR                      EVF00380
*   CHECKING IS COMPLETE.                                               EVF00390
       SPACE                                                            EVF00400
*  WRITING IS DONE BY CALLING IOBB, WHICH IS A SEP-                     EVF00410
*   ARATE ENTRY TO THE SUBPROGRAM MRGIO.  ENTRY                         EVF00420
*   TO IOBB SIGNIFIES THAT WRITING IS TO BE ACCOMP-                     EVF00430
*   LISHED FROM AN OUTPUT BUFFER, RATHER THAN SCAT-                     EVF00440
*   TERED AS IN PHASES I AND II.                                        EVF00450
*   THE CELL RAWPR-4 IS USED TO INDICATE WHEN WRIT-                     EVF00460
*   ING IS IN PROGRESS (ZERO) OR IS COMPLETED (NON-                     EVF00470
*   ZERO), JUST AS RAWPR-2 IS USED IN READING.                          EVF00480
*   IN THE CASE OF OUTPUT, THE LOGICAL FILE NUMBER                      EVF00490
*   COMMUNICATED TO THE I/O ROUTINE IN THE DECREMENT                    EVF00500
*   OF RAWPR IS ALWAYS ZERO, SINCE THE MERGED OUTPUT                    EVF00510
*   IS BEING WRITTEN ONTO A SINGLE OUTPUT FILE.                         EVF00520
*   RAWPR IS SET NEGATIVE TO INDICATE A WRITE OPERATION.                EVF00530
       SPACE                                                            EVF00540
*  THE PRIORITY OF READING DIFFERENT FILES IS EST-                      EVF00550
*   ABLISHED BY COMPARING THE NUMBERS OF UNMERGED                       EVF00560
*   INPUT BLOCKS IN MEMORY FOR EACH FILE.  THE FILE                     EVF00570
*   WITH THE LOWEST COUNT IS GIVEN THE NEXT READ.                       EVF00580
*   IN THE CASE WHERE THE COUNTS FOR TWO FILES ARE                      EVF00590
*   EQUAL, THE FILE WITH THE LOWER LOGICAL NUMBER                       EVF00600
*   IS GIVEN PRIORITY.  IN THE CASE WHERE A FILE IS                     EVF00610
*   COMPLETELY DEPLETED IN MEMORY, IT IS SAID TO BE                     EVF00620
*   STARVED.  MERGING DOES NOT PROCEED UNTIL THE                        EVF00630
*   NUMBER OF STARVED FILES IS REDUCED TO ZERO.                         EVF00640
       SPACE                                                            EVF00650
*  EACH NEW BLOCK OF INPUT IS IMMEDIATELY PRECEDED                      EVF00660
*   IN MEMORY BY A SINGLE WORD, PLACED THERE BY THE                     EVF00670
*   I/O PROGRAM.  THE ADDRESS PART OF THIS WORD                         EVF00680
*   CONTAINS EITHER THE LENGTH OF THE NEW BLOCK OF                      EVF00690
*   DATA OR THE NUMBER OF LOGICAL RECORDS IN THE                        EVF00700
*   NEW BLOCK.  IT CONTAINS THE LENGTH OF THE BLOCK                     EVF00710
*   UNDER THE FOLLOWING CONDITIONS-                                     EVF00720
*         1. INPUT IS FROM AN EXTERNAL FILE.                            EVF00730
*         2. INPUT IS FROM A PREVIOUS PHASE                             EVF00740
*            OF SORT (INTERNAL FILE) AND                                EVF00750
*            CONSISTS OF FIXED LENGTH RECORDS.                          EVF00760
*   THIS WORD IS SET MINUS BY MRGIO UNDER THE ABOVE CON-                EVF00770
*   DITIONS.  IT HAS A RECORD COUNT AND A SIGN OF                       EVF00780
*   PLUS WHEN THE RECORDS ARE VARIABLE LENGTH AND                       EVF00790
*   BELONG TO AN INTERNAL FILE.                                         EVF00800
       SPACE                                                            EVF00810
*  IF THE EQUALS AND/OR CHECKSUMS OPTIONS ARE SPEC-                     EVF00820
*   IFIED (THIS IS ONLY ALLOWABLE ON A SORT WITH NO                     EVF00830
*   EXTERNAL INPUT TO MERGE), THE EXTRA WORDS ARE                       EVF00840
*   ATTACHED TO EACH LOGICAL RECORD IN PHASE I AND                      EVF00850
*   THEY ARE CHECKED IN EACH PHASE.  BEFORE THE                         EVF00860
*   FINAL WRITE-OUT IN THIS PHASE THESE WORDS ARE                       EVF00870
*   STRIPPED FROM THE RECORD.  THE POSITIONS OF                         EVF00880
*   THESE WORDS IN THE RECORD DIFFER IN THE TWO                         EVF00890
*   CASES OF FIXED AND VARIABLE LENGTH RECORDS.  IN                     EVF00900
*   THE FIXED LENGTH RECORD THE EQUALS WORD (RECORD                     EVF00910
*   SEQUENCE WORD) IMMEDIATELY FOLLOWS THE RECORD                       EVF00920
*   AND IS ADDED INTO THE CHECKSUM WORD WHICH OC-                       EVF00930
*   CUPIES THE NEXT CORE LOCATION FOLLOWING THE EQ-                     EVF00940
*   UALS WORD.  IN CASE ONLY ONE OF THESE OPTIONS                       EVF00950
*   IS SPECIFIED, ITS CORRESPONDING WORD IMMEDIATE-                     EVF00960
*   LY FOLLOWS THE RECORD PROPER.  IN THE VARIABLE                      EVF00970
*   LENGTH RECORD THE SEQUENCE OF OCCURENCE IS--                        EVF00980
*   EQUALS WORD, IF SPECIFIED--CHECKSUM, IF SPECIF-                     EVF00990
*   IED--RECORD PROPER.  IN THIS CASE, AS IN THE                        EVF01000
*   FIXED LENGTH RECORD, THE CHECKSUM INCLUDES THE                      EVF01010
*   EQUALS WORD IN ITS SUM.                                             EVF01020
       SPACE                                                            EVF01030
FIMRG  SXA     FMXR4,4                                                  EVF01040
*                                                                       EVF01050
       SPACE                                                            EVF01060
       TXI     *+1,4,-1 ADJUST FOR DELETE RETURN TO BE 4,4 FROM RESTA(2)EVF01065
       SXD     GEN03,4       PUT MONITOR RETURN INTO COMMON.            EVF01070
       SXA     FM777,2       SAVE 1ST USABLE LOCATION, GIVEN BY LOADER. EVF01080
       AXT     3,2           SET PHASE                                  EVF01090
       SXA     GEN00,2        TO 3.                                     EVF01100
*                                                                       EVF01110
*  INITIALIZATION                                                       EVF01120
       ZET     MOD43                                                    EVF01130
       CALL    DFMM04 ************CE DEBUG MOD*****                     EVF01140
       LDQ     =O76100000000 SET UP MODIFICATION SWITCHES.              EVF01150
       ZET     MOD18                                                    EVF01160
       SLQ     NOM04                                                    EVF01170
       AXT     30,4                                                     EVF01180
       CLA     ERA20                                                    EVF01190
       STZ     ERAPR+1,4     CLEAR OUT ERASABLE PARAMETERS.             EVF01200
TIX    TIX     *-1,4,1                                                  EVF01210
       STO     ERA20                                                    EVF01220
       CAL     FIL01         COMPUTE LOCATION OF WORD WHICH             EVF01230
       SUB     =5             CONTAINS BLOCKSIZE SPECIFIED IN           EVF01240
       STA     CMPAR          CONTROL CARD FOR OUTPUT FILE.             EVF01250
       AXT     VF042,1       SET UP COMMUNICATION WITH DELETE.          EVF01260
       SXA     ERA11,1                                                  EVF01270
       CAL     TIX                                                      EVF01280
       STT     MVSTO                                                    EVF01290
       CAL     CNT09         MOVE PHASE 1 DELETE COUNT OUT OF           EVF01300
       SLW     CNT08          THE WAY AND INTO A CELL WHERE POST        EVF01310
       STZ     CNT09          PROCESSOR WILL FIND IT.                   EVF01320
       CAL     CAL16                                                    EVF01330
       ADM     FM777         COMPUTE ARWD.                              EVF01340
       ORA     =O200000                                                 EVF01350
       LXA     ARWDR,1                                                  EVF01360
       STA*    ARWDR,1                                                  EVF01370
       TIX     *-1,1,1                                                  EVF01380
       STO     ERA04                                                    EVF01390
       ADM     CAL16         COMPUTE ADDR.                              EVF01400
       LXA     ADDRR,1                                                  EVF01410
       STA*    ADDRR,1                                                  EVF01420
       TIX     *-1,1,1                                                  EVF01430
       STO     ERA03                                                    EVF01440
       LXA     CAL16,1       PUT TAG OF 4                               EVF01450
       STA     INIT1          INTO ALL ADDR WORDS                       EVF01460
       CAL     TAG4                                                     EVF01470
INIT1  SLW     **,1                                                     EVF01480
       TIX     *-1,1,1                                                  EVF01490
       AXT     FLWD,1                                                   EVF01500
       SXA     ERA05,1                                                  EVF01510
       AXT     BASE1,1                                                  EVF01520
       SXA     ERA08,1                                                  EVF01530
       LXA     MORDER,1                                                 EVF01540
LER8   TXH     NOER8,1,0     ERROR IF ZERO (NO MERGE ORDER GIVEN).      EVF01550
       TSX     BUGPR2,4      PRINT ERROR MESSAGE.                       EVF01560
       PZE     LER8                                                     EVF01570
NOER8  ZET     NWDCF         NO. OF WORDS IN CONTROL FIELD MUST         EVF01580
       TRA     NOER13         NOT BE ZERO.                              EVF01590
       TSX     BUGPR2,4                                                 EVF01600
       PZE     NOER8                                                    EVF01610
NOER13 CAL     INIT1         INITIALIZE ADDRESSES OF CONTROL            EVF01620
       ADM     NWDCF          FIELD REFERENCE TABLE.                    EVF01630
       STA     K1+1,1                                                   EVF01640
       TIX     *-2,1,1                                                  EVF01650
       ADM     NWDCF                                                    EVF01660
       STO     FMSC          INIT. LOC. OF CF FOR SEQ. CHK.             EVF01670
       LXA     NWDCF,1                                                  EVF01680
       STZ*    FMSC          CLEAR THIS CONTROL FIELD AREA.             EVF01690
       TIX     *-1,1,1                                                  EVF01700
       LXA     CAL16,1       INIT. NO. OF AVAILABLE AREAS.              EVF01710
       SXA     NAVLA,1                                                  EVF01720
       ADM     CAL16                                                    EVF01730
       STA     INIT2                                                    EVF01740
       STA     BAAPL                                                    EVF01750
       PXD     ,0                                                       EVF01760
       ADD     =1            INITIALIZE LIST OF AVAILABLE AREAS.        EVF01770
INIT2  STA     **,1                                                     EVF01780
       TIX     *-2,1,1                                                  EVF01790
       CAL     INIT2                                                    EVF01800
       ADM     MORDER        COMPUTE BASE OF LIST OF NOS. OF            EVF01810
       STA     (1)            RESERVE BLOCKS IN MEMORY.                 EVF01820
       LXA     MORDER,1      CLEAR THIS                                 EVF01830
       STZ*    (1)            TABLE.                                    EVF01840
       TIX     *-1,1,1                                                  EVF01850
       ADM     MORDER        BASE OF LIST OF NOS. OF UNMERGED           EVF01860
       STA     NUMB           BLOCKS IN MEMORY.                         EVF01870
       STA     B1308                                                    EVF01880
       LXA     MORDER,1      CLEAR THIS TABLE.                          EVF01890
       STZ*    NUMB                                                     EVF01900
       TIX     *-1,1,1                                                  EVF01910
       ADM     =2                                                       EVF01920
       STA     WRBF1                                                    EVF01930
       STA     MVSTO                                                    EVF01940
       ADM     =4                                                       EVF01950
       ADM     OBFRL                                                    EVF01960
       STA     WRBF2                                                    EVF01970
       ADD     =4                                                       EVF01980
       ADM     OBFRL                                                    EVF01990
       LXA     CAL16,1                                                  EVF02000
REF7   STA     (ADDR),1      INITIALIZE LOCATIONS OF AREAS.             EVF02010
       ADM     CAL17         MAXIMUM MERGE BLOCK SIZE.                  EVF02020
       ADD     =4                                                       EVF02030
       TIX     REF7,1,1                                                 EVF02040
       AXT     1,1                                                      EVF02050
       ZET     OPT01         ARE RECORD CHECKSUMS PRESENT.              EVF02060
       SXA     PRECT,1       YES.  INITIALIZE FOR CHECKSUMS.            EVF02070
       LXA     PRECT,1                                                  EVF02080
       ZET     OPT03         ARE RECORD SEQUENCE WORDS PRESENT.         EVF02090
       TXI     *+1,1,1       YES.  INCREASE COUNT OF WORDS PRECEDING    EVF02100
       SXA     PRECT,1        RECORD CONTROL WORD.                      EVF02110
       NZT     REC05         IS THIS VARIABLE MERGE.                    EVF02120
       STZ     PRECT         NO.  MAKE PRE-COUNT ZERO.                  EVF02130
       LXA     MORDER,1                                                 EVF02140
       SXA     STRVD,1       SET ALL FILES STARVED.                     EVF02150
       SXA     INORD,1       INTERNAL MERGE ORDER.                      EVF02160
       SXA     EXORD,1       EXTERNAL MERGE ORDER.                      EVF02170
       TXI     *+1,1,-1                                                 EVF02180
       SXD     (1.4),1                                                  EVF02190
       SXD     (2.5),1                                                  EVF02200
       NZT     REC05         IS THIS VARIABLE RECORD MERGE.             EVF02210
       TRA     BYOND         NO.                                        EVF02220
*  INITIALIZE SWITCHES FOR VARIABLE MERGE.                              EVF02230
       AXT     VARLEN,2                                                 EVF02240
       SXA     TRA1,2                                                   EVF02250
       AXT     VARIN,2                                                  EVF02260
       SXA     TRA2,2                                                   EVF02270
       AXT     SW3+1,2                                                  EVF02280
       NZT     GEN01         TEST THE INPUT MODE.                       EVF02290
       TRA     INBCD         BCD INPUT.                                 EVF02300
       ZET*    FIL01         BINARY IN.  TEST THE OUTPUT.               EVF02310
       TRA     INSW2         BINARY OUT.                                EVF02320
       SXA     SW3,2         BCD OUT.  SET SWITCH 3 FOR CONVERT.        EVF02330
       STL     ALTER          SET CELL NONZERO FOR BIN. TO BCD CONV.    EVF02340
INBCD  ZET*    FIL01         TEST THE OUTPUT.                           EVF02350
       SXA     SW3,2         BINARY OUT.  SET SWITCH 3 FOR CONVERT.     EVF02360
       TRA     INSW2                                                    EVF02370
*                                                                       EVF02380
BYOND  AXT     FIXLEN,2                                                 EVF02390
       SXA     TRA1,2                                                   EVF02400
       AXT     FIXIN,2                                                  EVF02410
       SXA     TRA2,2                                                   EVF02420
INSW2  AXT     SW2+1,1       TRANSFER ADDRESS FOR SWITCH 2.             EVF02430
       NZT     DEL00         NON-ZERO IF DELETE OPTION SPECIFIED.       EVF02440
       ZET     OPT01         NON-ZERO IF CHECKSUMS SPECIFIED.           EVF02450
       SXA     SW2,1         SET SWITCH.                                EVF02460
       NZT     SAM04         IS THERE INPUT FROM PREVIOUS PHASE.        EVF02470
       TRA     FM03          NO.  STRAIGHT MERGE.                       EVF02480
       ZET     SAM05         YES.  IS THERE ALSO EXTERNAL MERGE INPUT.  EVF02490
       TRA     FM04          YES.  PRINT LOAD MESSAGES.                 EVF02500
       TRA     FINIT         NO EXTERNAL MERGE INPUT.                   EVF02510
FM03   BSS     0             STRAIGHT MERGE.  PUT MINUS SIGN            EVF02520
       LXA     MORDER,2       ON ALL TAPE TABLE ENTRIES AND PUT         EVF02530
EXIN1  TXI     *+1,2,-1       LOCATION OF FILE DATA BLOCK FOR EACH      EVF02540
       CLA     FIL02,2        FILE INTO DECREMENT OF ITS CORRES-        EVF02550
       ALS     18             PONDING TABLE ENTRY.                      EVF02560
       LDI     =O100000000000 IF REWIND BIT IS ON,                      EVF02570
       OFT*    CHA03          SAVE IT.                                  EVF02580
       ORA     =O100000000000                                           EVF02590
       SSM                                                              EVF02600
       XCA                                                              EVF02610
       SLQ*    CHA03                                                    EVF02620
       TXH     EXIN1,2,0                                                EVF02630
       CLS     =O77777000000                                            EVF02640
       STO     RAW00         OPEN CKPT-UNREADABLE                       EVF02650
       CALL    IOPEN         RECORD TAPE.                               EVF02660
       TRA     FINIT         GO FINISH INITIALIZATION.                  EVF02670
FM04   BSS     0             SORT AND MERGE.                            EVF02680
       CLA     CHA03         LOC. OF INPUT CHANNEL TAPE TABLE.          EVF02690
       STA     FM06                                                     EVF02700
       LXA     CNT15,2       NO. OF STRINGS OUTPUT LAST PHASE.          EVF02710
       LXA     SAM02,1       NO. OF EXTERNAL FILES.                     EVF02720
       SXD     SMIN2,1                                                  EVF02730
       AXT     1,1                                                      EVF02740
FM05   CAL     *             MINUS FLAGS TAPE TO BE EXTERNAL FILE.      EVF02750
       ORA*    CHA03         SAVE REWIND BIT IN POS 2.                  EVF02760
       STP*    CHA03         IR2 HAS VALUE EXPLAINED BELOW.             EVF02770
       CLA     FIL01,1       IR1 STARTS AT 1, ADDS 1 FOR                EVF02780
*                             EACH EXTERNAL TAPE LOADED.                EVF02790
       PDX     ,4            SAVE FILE NO. FOR MESSAGE.                 EVF02800
       ALS     18                                                       EVF02810
       STD*    CHA03         IR2 HAS (NO. OF STRINGS OUTPUT FROM        EVF02820
*                             LAST PHASE) + (LOGICAL POSITION           EVF02830
*                             OF THIS MERGE FILE RELATIVE TO            EVF02840
*                             THE OTHER EXTERNAL MERGE FILES, BE-       EVF02850
*                             GINNING WITH 1) - 1.                      EVF02860
       PXA     ,4            RETRIEVE FILE NO. FOR MESSAGE.             EVF02870
       TSX     (DECVA,4      CONVERT FILE NO.                           EVF02880
       STQ     LDMS01+3      INSERT INTO MESSAGE.                       EVF02890
FM06   LDQ*    **,2          GET UCW NO. 1.                             EVF02900
       TSX     MSGSUP,4,3    PRINT LOAD MESSAGE                         EVF02910
       PZE     LDMS01,,4+512*2                                          EVF02920
       TSX     (PAUSE,4      OPERATOR ACTION PAUSE.                     EVF02930
       TXI     *+1,1,1                                                  EVF02940
       TXI     *+1,2,1                                                  EVF02950
SMIN2  TXL     FM05,1,**     (NO. OF EXTERNAL FILES)                    EVF02960
*                            GO ON WHEN ALL EXTERNAL TAPES ARE LOADED.  EVF02970
FINIT  BSS     0                                                        EVF02980
       ZET     MOD15         TEST FOR MOD PROGRAM.                      EVF02990
       CALL    FMM01                                                    EVF03000
       AXT     0,1                                                      EVF03010
       LXA     MORDER,2                                                 EVF03020
INIT9  TXI     *+1,1,1                                                  EVF03030
       PXD     ,1                                                       EVF03040
       STO     RAW00                                                    EVF03050
       ZET     ERA20         PUT FILE NO. INTO                          EVF03060
       STD*    ERA20          LABEL.                                    EVF03070
       CALL    IOPEN         OPEN ALL INPUT TAPES.                      EVF03080
       TIX     INIT9,2,1                                                EVF03090
       CLS     =0                                                       EVF03100
       STO     RAW00                                                    EVF03110
       CALL    IOPEN         OPEN OUTPUT TAPE.                          EVF03120
       STL     RAW02         SET READ COMPLETE.                         EVF03130
       STZ     EOFI          SET NO EOF TO BEGIN WITH.                  EVF03140
       ZET     REC05         IS THIS FIXED LENGTH MERGE.                EVF03150
       TRA     NOPAD1        NO.  NO LOW PADDING.                       EVF03160
       ZET     SAM05         IS THERE EXTERNAL MERGE INPUT.             EVF03170
       TRA     NOPAD1        YES.  LOW PADDING NOT LEGITIMATE.          EVF03180
       LAC     FIL01,4       GET MINUS LOC. OF OUTPUT FILE BLOCK.       EVF03190
       LDI     -2,4          PADDING INDICATOR.                         EVF03200
       RNT     1             IS LOW PADDING SPECIFIED.                  EVF03210
       TRA     NOPAD1        NO.  LEAVE PADDING TO THE LAST.            EVF03220
       CAL     CNT01         RECORD COUNT FROM PHASE 2.                 EVF03230
       TNZ     *+2           PERHAPS PHASE 2 WAS SKIPPED, IN WHICH      EVF03240
       CAL     CNTPR          CASE GET RECORD COUNT, PHASE 1.           EVF03250
       LRS     35            DIVIDE BY OUTPUT BLOCKING.  REMAINDER      EVF03260
       DVP     CAL02          MUST BE PADDED.                           EVF03270
       TZE     NOPAD1        GET NO. OF PADDING RECORDS NEEDED.         EVF03280
       SUB     CAL02                                                    EVF03290
       STA     WRCT          INITIALIZE WRITE COUNT.                    EVF03300
       STA     CNT10         INITIALIZE COUNT FOR POST PROCESSOR.       EVF03310
       PAX     ,1            NO. OF PADDING RECORDS.                    EVF03320
       XCL                                                              EVF03330
       MPY     REC02                                                    EVF03340
       STQ     BLKSZ                                                    EVF03350
       CAL     CAL19         LOC. OF LOW PADDING RECORD.                EVF03360
       TSX     MVPAD,4                                                  EVF03370
NOPAD1 BSS     0                                                        EVF03380
FSTRD  STL     INITR         SET SWITCH FOR INITIAL READS.              EVF03390
       NZT     STRVD                                                    EVF03400
       TRA     SORT                                                     EVF03410
TSTR1  ZET SWCHR             TEST FOR END OF REEL.                      EVF03420
       TSX     SWCHR,4       GO SERVICE END OF REEL.                    EVF03430
       NZT     RAW02                                                    EVF03440
       TRA     TSTR1         READ STILL IN PROGRESS.                    EVF03450
       TSX     READ,4                                                   EVF03460
       TRA     FSTRD                                                    EVF03470
*  END OF INITIALIZATION.                                               EVF03480
       EJECT                                                            EVF03490
*  BEGINNING OF MAIN FLOW.                                              EVF03500
       SPACE                                                            EVF03510
B0202  ZET     STRVD         ARE THERE ANY STARVED FILES.               EVF03520
       TRA     B0604         YES.  MUST READ.                           EVF03530
*  NOW FIND NEXT RECORD TO BE MERGED.  IT BELONGS TO FILE WHOSE NO.     EVF03540
*   IS IN K1 (1ST CFWD).                                                EVF03550
       LXD     K1,2          FILE NO.                                   EVF03560
       ZET     CUTSW         IS THIS RECORD TO BE DROPPED.              EVF03570
       TRA     UPFIL         YES.  JUST UPDATE FLWD.                    EVF03580
       CAL     FLWD,2        COMPUTE LOCATION OF VERY                   EVF03590
       STA     LOC1           1ST WORD OF RECORD.                       EVF03600
       ADM     PRECT         FIND LOCATION OF 1ST WORD OF               EVF03610
       STA     LOC2           RECORD PROPER.                            EVF03620
TRA1   TRA     **            (GO TO FIXLEN OR VARLEN).                  EVF03630
INLEN1 STA     LEN1          INITIALIZE OUTPUT RECORD LENGTH.           EVF03640
TRA2   TRA     **            (GO TO FIXIN OR VARIN).                    EVF03650
INLEN2 STA     LEN2          INITIALIZE TOTAL RECORD LENGTH.            EVF03660
       ADM     LOC1          COMPUTE BASE OF RECORD IN                  EVF03670
       STA     BASE2          INPUT AREA.                               EVF03680
       CAL     LOC2          COMPUTE BASE OF PORTION TO                 EVF03690
       ADM     LEN1           BE MOVED.                                 EVF03700
       STA     BASE1                                                    EVF03710
       CAL     BLKSZ         FIND SIZE OF OUTPUT BLOCK, SHOULD          EVF03720
       ADM     LEN1           THIS RECORD GO.  COMPARE WITH             EVF03730
CMPAR  LAS     **             SIZE SPECIFIED IN FILE BLOCK.             EVF03740
       TRA     B1203         THIS RECORD IS LARGE.  MAYBE IT CANNOT GO. EVF03750
       TRA     *+1           TENTATIVELY ACCEPT                         EVF03760
ACCEPT STA     BLKSZ          THE RECORD.                               EVF03770
UPFIL  CAL     FLWD,2        UPDATE FLWD TO POINT AT NEXT               EVF03780
       ADM     LEN2           RECORD IN THE AREA.                       EVF03790
       STA     FLWD,2                                                   EVF03800
       ZET     CUTSW         IS THIS RECORD TO BE DROPPED.              EVF03810
       TRA     B1808         YES.                                       EVF03820
*  NEXT MODIFICATION SWITCH IS CONVENIENT FOR OMITTING RECORDS IN THE   EVF03830
*   OUTPUT.                                                             EVF03840
*  BYPASS TO SYMBOLIC LOCATION B1808, PRESERVING XR2 WILL               EVF03850
*   ACCOMPLISH THIS.                                                    EVF03860
*  IF A RECORD IS TO BE DROPPED, BE SURE TO REDUCE WORD COUNT IN CELL   EVF03870
*   CALLED BLKSZ.  THIS REFLECTS SIZE OF OUTPUT BLOCK BUILT SO FAR.     EVF03880
NOM04  TRA     SW2                                                      EVF03890
       CALL    FMM04                                                    EVF03900
       TRA     B1808                                                    EVF03910
       SPACE                                                            EVF03920
*  SUBROUTINE TO HANDLE DELETIONS + CHECKSUMS.                          EVF03930
*  NEXT INSTRUCTION IS TRA *+1 IF DELETE OR CHECKSUM OPTIONS SPECIFIED. EVF03940
SW2    TRA     SW3                                                      EVF03950
       NZT     MOD45                                                    EVF03960
       TRA     *+4                                                      EVF03970
       SXA     *+2,4         SAVE XR4.                                  EVF03980
       CALL    DFMM06 ************CE DEBUG MOD*****                     EVF03990
       AXT     **,4          RESTORE XR4.                               EVF04000
       STZ     OUT           RESET SWITCH.                              EVF04010
       ZET     DEL00         IS DELETE OPTION SPECIFIED.                EVF04020
       TRA     VF035         YES.  GO CALL DELETE, THEN RETURN.         EVF04030
VF029  ZET     OPT01         IS CHECKSUM SPECIFIED.                     EVF04040
       TRA     VF037         YES.  GO COMPUTE CHECKSUM AND RETURN.      EVF04050
VF030  NZT     OUT           IS RECORD TO BE DROPPED.                   EVF04060
       TRA     KEEP          NO.                                        EVF04070
       CAL     BLKSZ         YES.  REDUCE SIZE OF                       EVF04080
       SUB     LEN1           OUTPUT BLOCK BY LENGTH OF                 EVF04090
       STA     BLKSZ          THIS RECORD.                              EVF04100
KEEP   LXD     K1,2          RESTORE REGISTERS FOR EXIT.                EVF04110
       ZET     OUT           WAS THIS RECORD TO BE DROPPED.             EVF04120
       TRA     B1808         YES.                                       EVF04130
       TRA     SW3                                                      EVF04140
*  DELETE OPTION SPECIFIED.                                             EVF04150
VF035  LXA     LOC2,2        PUT LOCATION AND LENGTH OF RECORD          EVF04160
       SXA     VF042,2        INTO COMMUNICATION                        EVF04170
       LXA     LEN1,2         CELL FOR                                  EVF04180
       SXD     VF042,2        DELETE.                                   EVF04190
       CALL    DELETE                                                   EVF04200
       LXD     VF042,2       ZERO IF RECORD IS TO BE DELETED.           EVF04210
       TXH     VF029,2,0     TRANSFER IF RECORD KEPT.                   EVF04220
       STL     OUT           RECORD IS OUT.                             EVF04230
       TRA     VF030                                                    EVF04240
VF037  LAC     LOC2,4        MINUS LOC. OF RECORD.                      EVF04250
       LXA     LEN2,1        RECORD LENGTH.                             EVF04260
       ZET     OPT03         ADJUST FOR SEQUENCE AND                    EVF04270
       TXI     *+1,1,-1       CHECKSUM WORDS.                           EVF04280
       TXI     *+1,1,-1                                                 EVF04290
       PXA     ,1                                                       EVF04300
       ADM     LOC2          COMPUTE BASE OF RECORD FOR CHECKSUM        EVF04310
       STA     ADDCK                                                    EVF04320
       PXD     ,0            CLEAR AC.                                  EVF04330
ADDCK  ACL     **,1                                                     EVF04340
       TIX     ADDCK,1,1                                                EVF04350
       NZT     OPT03         IS RECORD SEQUENCE WORD PRESENT.           EVF04360
       TRA     VF041         NO.  GO COMPARE CHECKSUMS.                 EVF04370
       ZET     REC05         YES.  IS THIS FIXED RECORD MERGE.          EVF04380
       TRA     VF039         NO.                                        EVF04390
       AXT     0,1           YES.  ADD SEQUENCE WORD AT END OF          EVF04400
       XEC     ADDCK          RECORD.                                   EVF04410
       AXT     -1,1          COMPARE CHECKSUMS FOR                      EVF04420
TESTCK ERA*    ADDCK          FIXED RECORD.                             EVF04430
       TZE     VF030         TRANSFER IF CKSUM OK.                      EVF04440
       TRA     BADCK         BAD CHECKSUM, FIXED.                       EVF04450
VF039  ACL     -2,4          VARIABLE LENGTH RECORD.  ADD SEQUENCE NO.  EVF04460
VF040  ERA     -1,4          COMPARE CHECKSUMS, VARIABLE RECORD.        EVF04470
       TZE     VF030         TRANSFER IF O.K.                           EVF04480
       TRA     BADCK         BAD CHECKSUM, VARIABLE.                    EVF04490
VF041  ZET     REC05         IS THIS FIXED RECORD MERGE.                EVF04500
       TRA     VF040         NO.  GO COMPARE CHECKSUMS.                 EVF04510
       AXT     0,1           YES.                                       EVF04520
       TRA     TESTCK                                                   EVF04530
BADCK  STL     OUT           BAD CHECKSUM.  DROP THE RECORD.            EVF04540
       CAL     LOC1          SET UP CALLING SEQUENCE                    EVF04550
       STA     DCELL          FOR DUMPING.  LOCATION                    EVF04560
       LGR     15                                                       EVF04570
       TSX     (BCD5X,4                                                 EVF04580
       SLW     CKMES+4                                                  EVF04590
       LXA     LEN2,4         AND LENGTH OF RECORD.                     EVF04600
       SXD     DCELL,4                                                  EVF04610
NODMP  LXD     K1,2          FILE NUMBER.                               EVF04660
       TXI     *+1,2,-1      GET UNIT + PRINT MESSAGE.                  EVF04670
       CAL*    CHA03                                                    EVF04680
       STA     *+1                                                      EVF04690
       LDQ     **                                                       EVF04700
       TSX     MSGSUP,4,3                                               EVF04710
       PZE     CKMES,,8+512*4                                           EVF04720
       CALL    DEBLK                                                 (2)EVF04722
       PZE     DCELL,,1                                              (2)EVF04724
       TSX     (PAWSX,4                                                 EVF04730
       TRA     VF030                                                    EVF04740
CKMES  BCI     8,CKSUM ERROR, RECORD, LOC       *CS03                   EVF04750
VF042  PZE                   COMMUNICATION CELL FOR DELETE.             EVF04760
DCELL  PZE                   CELL TO HOLD DUMPING INFO.                 EVF04770
OUT    PZE                   SWITCH TO SHOW IF RECORD DROPPED.          EVF04780
FIXLEN CAL     REC02         ENTRY HERE IF FIXED LENGTH RECORDS.        EVF04790
       TRA     INLEN1        PROVIDE OUTPUT RECORD SIZE.                EVF04800
VARLEN NZT     GEN01         ENTER HERE IF VARIABLE LENGTH.             EVF04810
       TRA     BCDCV         BCD RECORDS.  GO CONVERT LENGTH.           EVF04820
       CAL*    LOC2          BINARY RECORD.  FIND OUTPUT                EVF04830
       PDX     ,4             LENGTH.                                   EVF04840
       TXI     *+1,4,1                                                  EVF04850
       PXA     ,4                                                       EVF04860
       TRA     INLEN1                                                   EVF04870
FIXIN  CAL     CAL10         ENTRY FOR FIXED INPUT RECORD               EVF04880
       TRA     INLEN2         LENGTH.                                   EVF04890
VARIN  ADM     PRECT         ENTRY FOR VARIABLE INPUT RECORD            EVF04900
       TRA     INLEN2         LENGTH.                                   EVF04910
       SPACE                                                            EVF04920
*  SUBROUTINE TO CONVERT BINARY RECORD CONTROL WORDS TO                 EVF04930
*   BCD OR VICE VERSA.                                                  EVF04940
*  NEXT INSTRUCTION IS TRA *+1 IF THIS CONVERSION IS NECESSARY.         EVF04950
SW3    TRA     B1201                                                    EVF04960
       CAL*    LOC2          GET 1ST WORD OF RECORD, SAVE               EVF04970
       ANA     =O77777000077  WORD COUNT AND RIGHTMOST                  EVF04980
       STA     CHARC          CHARACTER.                                EVF04990
       ZET     ALTER                                                    EVF05000
       TRA     BINTO         BINARY TO BCD.                             EVF05010
       CAL     LEN1          BCD TO BINARY                              EVF05020
       ALS     18                                                       EVF05030
       SUB     =O1000000                                                EVF05040
       ORA     =O500000200000                                           EVF05050
       TRA     REPLA                                                    EVF05060
BINTO  LDQ     LEN1          LENGTH OF OUTPUT RECORD.                   EVF05070
       MPY     =6            CHANGE TO CHARACTER COUNT, THEN            EVF05080
       XCL                    CONVERT BINARY TO                         EVF05090
       TSX     (DECVA,4       BCD.                                      EVF05100
       XCL                   ANSWER IN MQ.  MOVE TO AC,                 EVF05110
       ALS     6              SHIFT LEFT FOR REPLACING                  EVF05120
REPLA  ORA     CHARC          CHARACTER.                                EVF05130
       SLW*    LOC2          REPLACE 1ST WORD IN RECORD.                EVF05140
B1201  LXA     LEN1,4        MOVE RECORD TO OUTPUT BUFFER.              EVF05150
       CAL     MVSTO         KEEP TRACK OF WHERE RECORD                 EVF05160
       STA     INBUF          BEGINS IN OUTPUT BUFFER.                  EVF05170
       PXA     ,4                                                       EVF05180
       ADM     MVSTO                                                    EVF05190
       STA     MVSTO                                                    EVF05200
BASE1  CLA     **,4          BASE OF RECORD FOR OUTPUT (LOC2+LEN1).     EVF05210
       STO*    MVSTO                                                    EVF05220
       TIX     BASE1,4,1                                                EVF05230
       CAL     LOC1          UPDATE LOCATION OF LAST RECORD             EVF05240
       STA     LASTLC         MERGED.                                   EVF05250
       LDQ     K1            INTERCHANGE CONTROL FIELD POINTERS         EVF05260
       CLA     FMSC           TO MAKE THIS RECORD THE NEW SEQ-          EVF05270
       STA     K1             UENCE CHECK RECORD.                       EVF05280
       STQ     FMSC                                                     EVF05290
       LXA     WRCT,1        UPDATE COUNT OF RECORDS READIED            EVF05300
       TXI     *+1,1,1        FOR WRITING.                              EVF05310
       SXA     WRCT,1                                                   EVF05320
*                                                                       EVF05330
B1808  CAL     FLWD,2                                                   EVF05340
       PDX     ,4                                                       EVF05350
       STZ     CUTSW         RESET SWITCH FOR DROPPING RECORDS.         EVF05360
REF12  CAL     (ARWD),4      UPDATE RECORD COUNT IN AREA WORD.          EVF05370
       PAX     ,1                 **                                    EVF05380
LER4   TXH     NOER4,1,0     TRANSFER IF NO ERROR.                      EVF05390
       TSX     BUGPR2,4      IMPOSSIBLE SITUATION, LOGICALLY.  AREA WORDEVF05400
       PZE     LER4           ALREADY INDICATES AREA EMPTY.             EVF05410
NOER4  SUB     =1                                                       EVF05420
REF1   STA     (ARWD),4                                                 EVF05430
       PAX     ,1            IF RECORD COUNT HAS DROPPED TO             EVF05440
       TXH     B0508,1,0      ZERO, THE AREA IS NOW EXHAUSTED.          EVF05450
       PXA     ,4            AREA IS EXHAUSTED.  PUT ITS NO. IN AC.     EVF05460
       LXA     NAVLA,4                                                  EVF05470
       TXI     *+1,4,1                                                  EVF05480
       SXA     NAVLA,4                                                  EVF05490
       STA*    BAAPL                                                    EVF05500
B1308  CAL     **,2          (BASE OF NO. OF UNMERGED BLOCKS LIST).     EVF05510
LER2   TNZ     NOER2                                                    EVF05520
       TSX     BUGPR2,4      LOGICALLY IMPOSSIBLE SITUATION...WE HAVE   EVF05530
       PZE     LER2           JUST MERGED A BLOCK THAT WASN'T THERE.    EVF05540
NOER2  SUB     =1            REDUCE COUNT OF NO. OF BLOCKS IN MEMORY    EVF05550
       STO*    B1308          FOR THIS FILE.                            EVF05560
       TNZ     STLSM         IF NO MORE UNMERGED BLOCKS                 EVF05570
       CAL     STRVD          FOR THIS FILE, INCREASE                   EVF05580
       ADD     =1             STARVED COUNT BY 1.                       EVF05590
       STA     STRVD                                                    EVF05600
STLSM  BSS     0                                                        EVF05610
LER3   NZT     AJUSX                                                    EVF05620
       TRA     NOER3                                                    EVF05630
       TSX     BUGPR1,4      ERROR IF COME TO HERE.                     EVF05640
       PZE     LER3          MERGING WOULD HAVE OCCURRED WHILE          EVF05650
*                             NO RECORDS WERE AVAILABLE FROM 1 OR MORE  EVF05660
*                             FILES.  OUT OF SORT COULD OCCUR NOW.      EVF05670
NOER3  STL     AJUSX         SET AREA-JUST EXHAUSTED SWITCH.            EVF05680
B0508  ZET     SWCHR         CHECK FOR END OF REEL                      EVF05690
       TSX     SWCHR,4        ACTION.                                   EVF05700
       ZET     RAW02         IS READ IN PROGRESS.                       EVF05710
       TRA     B0511         NO.  READ COMPLETE.                        EVF05720
B0116  ZET     AJUSX         WAS AREA JUST EXHAUSTED.                   EVF05730
       TRA     B0219         YES.                                       EVF05740
B0516  LXD     K1,1          FILE NO., LAST RECORD MERGED.              EVF05750
       CAL     FLWD,1        PUT LOC. OF NEXT REC. INTO CALL. SEQ.      EVF05760
       STA     ERA09          WORD FOR EXTRACT ROUTINE.                 EVF05770
       LXA     K1,4          BASE OF CONTROL FIELD EXTRACTION AREA.     EVF05780
       SXD     ERA09,4       PUT IN CALLING SEQUENCE TO EXTRACT ROUTINE.EVF05790
       CALL    MERXTR        EXTRACT CONTROL FIELD FOR NEXT RECORD TO BEEVF05800
*                             INSERTED INTO CF REFERENCE TABLE.         EVF05810
       LXA     INORD,2                                                  EVF05820
       ZET     MOD44                                                    EVF05830
       CALL    DFMM05 ************CE DEBUG MOD*****                     EVF05840
       TRA*    MERGE+16,2    GO TO APPROPRIATE MERGE COMPARE.           EVF05850
*  AFTER GOING TO MERGE, RETURN HERE.                                   EVF05860
*  NEXT RECORD TO WRITE IS NOW FOUND BY                                 EVF05870
*  MEANS OF K1, WHICH POINTS AT THE EX-                                 EVF05880
*  TRACTED CF (FILE NO. IN DECR).                                       EVF05890
*  FIRST, WE WILL CHECK THE SEQUENCING.  THEN                           EVF05900
*  IF THAT IS OK, WE WILL GO BACK TO                                    EVF05910
*  PUT THE RECORD OUT FOR WRITING.                                      EVF05920
B1816  LXA     NWDCF,1       NO. OF WORDS IN EXTRACTED CONTROL FIELD.   EVF05930
SCCAL  CAL*    FMSC          GET OLD RECORD CONTROL FIELD               EVF05940
       LAS*    K1             AND COMPARE AGAINST NEW.                  EVF05950
       TRA     SEQER         ERROR.  OLD HIGHER THAN NEW.               EVF05960
       TRA     SCTIX         EQUAL SO FAR.  TRY NEXT CF.                EVF05970
       TRA     B0202         SEQUENCE CHECKS OK.                        EVF05980
SCTIX  TIX     SCCAL,1,1     TRY NEXT CF.                               EVF05990
       NZT     MOD16         ALL EQUAL.  DOES USER WANT TO SUMMAR-      EVF06000
       TRA     B0202          IZE.  NO, IF COME HERE.                   EVF06010
       NZT     REC05                                                    EVF06020
       TRA     CALMOD        FIXED.                                     EVF06030
       LXD     K1,2          VARIABLE.                                  EVF06040
       CAL     FLWD,2                                                   EVF06050
       ADM     PRECT                                                    EVF06060
       STA     *+1                                                      EVF06070
       CAL     **                                                       EVF06080
       NZT     GEN01                                                    EVF06090
       TRA     BCDFIL        BCD.                                       EVF06100
       PDX     ,4            BINARY.                                    EVF06110
       TXI     *+1,4,1                                                  EVF06120
       PXA     ,4                                                       EVF06130
       TRA     CALMOD                                                   EVF06140
BCDFIL XCA                   CONVERT BCD TO BINARY.                     EVF06150
       PXD     ,0                                                       EVF06160
       CAQ     DTBT1,0,5                                                EVF06170
       LRS     51                                                       EVF06180
       DVP     =6                                                       EVF06190
       XCL                                                              EVF06200
CALMOD LXD     K1,2          COMPUTE LOCATION OF FIRST               (8)EVF06210
       CAL     FLWD,2         WORD OF NEXT LOGICAL RECORD            (8)EVF06211
       STA     ERA19          FOR USER EXIT PROGRAM                  (8)EVF06212
       CALL    FMM02         RETURN TO 1,4                           (8)EVF06213
       STL     CUTSW          SAYS TO DROP THIS RECORD.                 EVF06220
       TRA     B0202         RETURN TO 2,4 RETAINS THE RECORD.          EVF06230
B1203  LXA     WRCT,4                                                   EVF06240
       TXH     OK,4,0                                                   EVF06250
       NZT     DROPSW                                                   EVF06260
       TRA     *+3                                                      EVF06270
       STL     CUTSW                                                    EVF06280
       TRA     UPFIL                                                    EVF06290
       LDQ     CAL28         IF RECORD TOO LARGE FOR BUFFER,            EVF06300
       TLQ     *+2            MQ IS LOW.                                EVF06310
       TRA     ACCEPT        RECORD FITS IN BUFFER.  ACCEPT IT.         EVF06320
       CAL     DELMS                                                    EVF06330
       ZET     CHA05         IF NO SYSCK2 ATTACHED, CHANGE DUMPED       EVF06340
       SLW     BIGMS1+8       MESSAGE TO DELETED MESSAGE.               EVF06350
       LXA     CAL28,4       MAKE RECORD DUMPED SAME SIZE               EVF06360
       SXD     DCELL,4        AS OUTPUT BUFFER - THAT SHOULD BE ENOUGH. EVF06370
       CAL     LOC1                                                     EVF06380
       STA     DCELL                                                    EVF06390
       LGR     15            GET LOCATION FOR                           EVF06400
       TSX     (BCD5X,4       MESSAGE.                                  EVF06410
       SLW     BIGMS1+2                                                 EVF06420
       CAL     LEN2          GET SIZE FOR MESSAGE.                      EVF06430
       TSX     (DECVA,4                                                 EVF06440
       STQ     SIZMS                                                    EVF06450
       ZET     CHAPR-5                                                  EVF06460
       TRA     *+3                                                      EVF06470
       CALL    DEBLK         DUMP THE RECORD IF SYSCK2                  EVF06480
       PZE     DCELL,,1       IS ATTACHED.                              EVF06490
       TSX     MSGSUP,4,2                                               EVF06500
       PZE     3                                                        EVF06510
       PZE     BIGMS1,,7                                                EVF06520
       PZE     SIZMS,,2                                                 EVF06530
       PZE     BIGMS2,,5                                                EVF06540
       TSX     (PAUSE,4                                                 EVF06550
       LXD     GENPR-3,4                                                EVF06560
       TRA     4,4                                                      EVF06570
OK     STL     WRTRQ         SET SWITCH REQUESTING A WRITE.             EVF06580
       TRA     B1005         GO TO READ-WRITE.                          EVF06590
*  AT LEAST ONE FILE IS STARVED.  WE MUST READ, IF POSSIBLE.            EVF06600
B0604  STL     MSTGT         SET MUST-GET SWITCH.                       EVF06610
B1005  BSS     0                                                        EVF06620
       NZT     NAVLA         IS THERE AN AREA AVAILABLE FOR READING.    EVF06630
       TRA     B0705         NO.                                        EVF06640
*  READ-WRITE PROVIDER ROUTINE.                                         EVF06650
PR1    ZET     RAW04         AT LEAST ONE AREA OPEN.                    EVF06660
       TRA     PR7           WRITE NOT IN PROGRESS.                     EVF06670
PR2    ZET     SWCHR         WRITE IN PROGRESS.  TEST FOR END OF REEL.  EVF06680
       TSX     SWCHR,4                                                  EVF06690
       NZT     RAW02         IS READ IN PROGRESS.                       EVF06700
       TRA     PR8           YES.  IS WRITE REQUESTED.                  EVF06710
PR3    TSX     READ,4        READ NOT IN PROGRESS.  CALL READ ROUTINE.  EVF06720
PR4    NZT     WRTRQ         IS WRITE REQUESTED.                        EVF06730
       TRA     B0116         NO.  GO ON.                                EVF06740
PR5    NZT     RAW04         YES.  IS WRITE IN PROGRESS.                EVF06750
       TRA     *-1           YES.  WAIT.                                EVF06760
PR6    TSX     WRITE,4       NO.  GO AHEAD + WRITE.                     EVF06770
       TRA     PR2           GO TRY TO READ.                            EVF06780
PR7    NZT     WRTRQ         IS WRITE REQUESTED.                        EVF06790
       TRA     PR2           NO.  TRY TO READ.                          EVF06800
       TRA     PR6           YES.  GO TO WRITE.                         EVF06810
PR8    ZET     WRTRQ         IS WRITE REQUESTED.                        EVF06820
       TRA     PR1           YES.  START OVER.                          EVF06830
       ZET     MSTGT         NO.  IS READ REQUESTED.                    EVF06840
       TRA     PR2           YES.  TRY TO READ.                         EVF06850
       TRA     B0116         NO.  GO ON.                                EVF06860
*                                                                       EVF06870
B0705  NZT     MSTGT         IS THIS READ REQUEST.                      EVF06880
       TRA     PR1           NO.                                        EVF06890
       ZET     RAW02         IS READ IN PROGRESS.                       EVF06900
LER14  NZT     SERVC         NO.  WAS LAST READ SERVICED.               EVF06910
       TRA     PR8           NO.  MAYBE END OF FILE.                    EVF06920
       TSX     BUGPR2,4      MUST READ, NO AREAS AVAILABLE.             EVF06930
       PZE     LER14                                                    EVF06940
       TRA     *-2                                                      EVF06950
B0511  ZET     NAVLA         ARE ANY AREAS AVAILABLE FOR READ.          EVF06960
       TSX     READ,4        YES.  GO READ.                             EVF06970
       TRA     B0116         GO GET ANOTHER RECORD.                     EVF06980
*  AREA HAS BEEN EXHAUSTED.  GET NEXT BLOCK FOR THIS FILE.              EVF06990
B0219  LXD     K1,1          FILE NO.                                   EVF07000
       CLA*    NUMB          TEST NO. OF UNMERGED BLOCKS FOR THIS FILE. EVF07010
       PAX     ,4                                                       EVF07020
B0619  TXL     B0222,4,0                                                EVF07030
       LDQ*    RSWRT+NRW,4   MOVE RESERVE FILE-WORDS FOR                EVF07040
       XCL                    THIS FILE INTO 1 LOWER                    EVF07050
       STQ*    RSWRT+NRW,4    POSITION EACH, AND PUT                    EVF07060
       TIX     *-3,4,1        NEXT RESERVE BLOCK INTO                   EVF07070
       SLW     FLWD,1         MERGE STATUS.                             EVF07080
       CAL*    (1)           REDUCE COUNT OF RESERVE                    EVF07090
       SUB     =1             BLOCKS IN MEMORY FOR                      EVF07100
LER6   LAS*    (1)           **(SHOULD NOT REDUCE                       EVF07110
       TRA     ER6           ** BEYOND ZERO)                            EVF07120
       TRA     ER6           **                                         EVF07130
       STA*    (1)            THIS FILE.                                EVF07140
       STZ     AJUSX         RESET AREA-JUST-EXHAUSTED SWITCH.          EVF07150
       TRA     B0516                                                    EVF07160
ER6    BSS     0             ERROR.                                     EVF07170
       TSX     BUGPR2,4      COUNT OF RESERVE BLOCKS WAS ZERO OR        EVF07180
       PZE     LER6           LITERAL (=1) WAS OFF.                     EVF07190
       PXD     ,0                                                       EVF07200
       TRA     LER6+3                                                   EVF07210
B0222  TNZ     B0622         TRANSFER IF THIS FILE HAS HIT EOF.         EVF07220
       TRA     B0202                                                    EVF07230
B0622  STZ     AJUSX         RESET AREA-JUST-EXHAUSTED SWITCH.          EVF07240
       LXA     INORD,4                                                  EVF07250
       TXI     *+1,4,-1                                                 EVF07260
       SXA     INORD,4       REDUCE MERGE ORDER BY 1.                   EVF07270
       TXL     FLUSH,4,0                                                EVF07280
       CAL     K1,4                                                     EVF07290
       LDQ     K1+1,4                                                   EVF07300
       XCL                                                              EVF07310
       STQ     K1+1,4                                                   EVF07320
       TIX     *-3,4,1                                                  EVF07330
       TRA     B0516                                                    EVF07340
       EJECT                                                            EVF07350
*  PREPARE FOR FINAL WRITE-OUT OF REMAINING RECORDS.                    EVF07360
FLUSH  LXA     WRCT,4                                                   EVF07370
       TXL     ISC,4,0                                               (3)EVF07380
       ZET     REC05         IS THIS FIXED MERGE.                       EVF07390
       TRA     NOPAD2        NO.  NO PADDING PROBLEMS.                  EVF07400
       LAC     FIL01,4       DOES OUTPUT PADDING INDICATOR              EVF07410
       NZT     -2,4           REQUEST PADDING.                          EVF07420
       TRA     NOPAD2        NO.                                        EVF07430
       LXA     WRCT,1        COUNT OF RECORDS IN OUTPUT                 EVF07440
       PXA     ,1             BUFFER SO FAR.                            EVF07450
       SUB     CAL02         IF BLOCK IS ALREADY FULL,                  EVF07460
       TZE     NOPAD2         NO PADDING NEEDED.                        EVF07470
       PAX     ,1                                                       EVF07480
       STA     CNT11         INITIALIZE COUNT FOR POST PROCESSOR.       EVF07490
       CAL     CAL20         LOC. OF HIGH PADDING RECORD.               EVF07500
       TSX     MVPAD,4                                                  EVF07510
       LXA     CAL02,4                                                  EVF07520
       SXA     WRCT,4                                                   EVF07530
       LXA     CAL28,4                                                  EVF07540
       SXA     BLKSZ,4                                                  EVF07550
NOPAD2 BSS     0                                                        EVF07560
       NZT     RAW04                                                    EVF07570
       TRA     *-1                                                      EVF07580
       TSX     WRITE,4                                                  EVF07590
ISC    NZT     CHAPR-4       INTERSYSTEM UNIT FOR OUTPUT             (3)EVF07591
       TRA     NOWRT         NO.                                     (3)EVF07592
       LAC     FILPR-1,1     YES. -L(FDB) FOR OUTPUT                 (3)EVF07593
       ZET     -15,1                                                 (3)EVF07594
       TRA     NOWRT                                                 (3)EVF07595
       CAL     CHAPR-4       IS SECOND I.S. PARAMETER GIVEN          (3)EVF07596
       PBT                                                           (3)EVF07597
       TRA     NOWRT         NO.                                     (3)EVF07598
       STL     ISCL          YES.                                    (3)EVF07599
       TRA     WREOT         MUST WRITE EOF ON SECOND I.S. UNIT.     (3)EVF0759A
NOWRT  CLS     =0            CLOSE ALL FILES.                           EVF07600
       STO     RAW00                                                    EVF07610
       STO     RAW01         FINAL OUTPUT REEL.                         EVF07620
       CALL    SCL                                                      EVF07630
       LXA     MORDER,1                                                 EVF07640
FINCL  PXD     ,1                                                       EVF07650
       STO     RAW00         ALL INPUT REELS.                           EVF07660
       CALL    SCL                                                      EVF07670
       TIX     FINCL,1,1                                                EVF07680
       CLS     =O77777000000                                            EVF07690
       STO     RAW00                                                    EVF07700
       CALL    SCL           CHECKPOINT-UNREADABLE RECORD TAPE.         EVF07710
       CALL    POSTP         CALL SORT POST PROCESSOR.                  EVF07720
FMXR4  AXT     **,4 RELOAD FOR RETURN.  MQ PRESERVED FOR MONITOR.    (2)EVF07730
       TRA     3,4           RETURN TO SORT MONITOR.                    EVF07740
       EJECT                                                            EVF07750
*  SUBROUTINE TO CONVERT BCD CHARACTER COUNT TO BINARY WORD COUNT.      EVF07760
*  ENTERED FROM VARLEN+1, RETURNS TO INLEN1.                            EVF07770
BCDCV  LDQ*    LOC2          GET RECORD LENGTH WORD.                    EVF07780
       ZET     MOD40                                                    EVF07790
       CALL    DFMM01 ************CE DEBUG MOD*****                     EVF07800
       PXD     ,0            CLEAR AC.                                  EVF07810
       CAQ     DTBT1,0,5     CONVERT BCD TO BINARY.                     EVF07820
       LRS     51            FROM AC (19) TO MQ (35).                   EVF07830
       DVP     =6            CHANGE CHARACTER COUNT TO WORD COUNT.      EVF07840
       XCL                   PUT BACK INTO AC.                          EVF07850
       TRA     INLEN1        RETURN TO MAIN FLOW.                       EVF07860
*  CONVERSION TABLE FOR ABOVE SUBROUTINE.                               EVF07870
DTBT1  DUP     1,10                                                     EVF07880
       VFD     20/**10000-DTBT1*10000,16/DTBT2                          EVF07890
DTBT2  DUP     1,10                                                     EVF07900
       VFD     20/**1000-DTBT2*1000,16/DTBT3                            EVF07910
DTBT3  DUP     1,10                                                     EVF07920
       VFD     20/**100-DTBT3*100,16/DTBT4                              EVF07930
DTBT4  DUP     1,10                                                     EVF07940
       VFD     20/**10-DTBT4*10,16/DTBT5                                EVF07950
DTBT5  DUP     1,10                                                     EVF07960
       VFD     20/**1-DTBT5*1                                           EVF07970
       EJECT                                                            EVF07980
*  ROUTINE TO PUT CONTROL FIELD WORDS (K1,...,K16) INTO SORTED ORDER.   EVF07990
SORT   BSS     0                                                        EVF08000
       LXA     INORD,2                                                  EVF08010
       TXL     FLUSH,2,0                                                EVF08020
       STZ     INITR                                                    EVF08030
SORT1  CAL     K1+1,2                                                   EVF08040
       PDX     ,1                                                       EVF08050
       ALS     18                                                       EVF08060
       STD     ERA09                                                    EVF08070
       CAL     FLWD,1                                                   EVF08080
       STA     ERA09                                                    EVF08090
       CALL    MERXTR                                                   EVF08100
       ZET     MOD41                                                    EVF08110
       CALL    DFMM02 ************CE DEBUG MOD*****                     EVF08120
       TIX     SORT1,2,1                                                EVF08130
SORTF  LXA     INORD,4       DO AS MANY AS                              EVF08140
       TXI     *+1,4,-1       ORDER OF MERGE.                           EVF08150
       TXL     SRTIX+1,4,0                                              EVF08160
       LXA     NWDCF,1                                                  EVF08170
SRCAL  CAL*    K1,4                                                     EVF08180
SRLAS  LAS*    K1+1,4                                                   EVF08190
       TRA     SRTIX                                                    EVF08200
       TRA     SEQTX                                                    EVF08210
       TRA     SINTR                                                    EVF08220
SEQTX  TIX     SRCAL,1,1                                                EVF08230
       CAL*    SRCAL                                                    EVF08240
       LAS*    SRLAS                                                    EVF08250
       TRA     SRTIX                                                    EVF08260
LER15  TRA     ER15                                                     EVF08270
SINTR  CAL*    SRCAL                                                    EVF08280
       LDQ*    SRLAS                                                    EVF08290
       SLW*    SRLAS                                                    EVF08300
       STQ*    SRCAL                                                    EVF08310
       TRA     SORTF                                                    EVF08320
SRTIX  TIX     SRCAL-1,4,1                                              EVF08330
       TRA     B0202                                                    EVF08340
ER15   TSX     BUGPR2,4      EQUALS COMPARE SHOULD                      EVF08350
       PZE     LER15          NEVER OCCUR.                              EVF08360
       TRA     ER15                                                     EVF08370
*  SUBROUTINE TO MOVE PADDING RECORDS TO OUTPUT BUFFER.                 EVF08380
MVPAD  ADD     REC02                                                    EVF08390
       STA     PADGT                                                    EVF08400
       CAL     MVSTO                                                    EVF08410
UP     ADD     REC02                                                    EVF08420
       STA     MVSTO                                                    EVF08430
       STA     PADPT                                                    EVF08440
       LXA     REC02,2                                                  EVF08450
PADGT  LDI     **,2                                                     EVF08460
PADPT  STI     **,2                                                     EVF08470
       TIX     PADGT,2,1                                                EVF08480
       TIX     UP,1,1                                                   EVF08490
       TRA     1,4                                                      EVF08500
*                                                                       EVF08510
       EJECT                                                            EVF08520
*  MERGE LOOPS.                                                         EVF08530
       SPACE                                                            EVF08540
MERGE          C(9)          ORDER IS 16.                               EVF08550
               C(9)                   15.                               EVF08560
               C(9)                   14.                               EVF08570
               C(9)                   13.                               EVF08580
               C(9)                   12.                               EVF08590
               C(9)                   11.                               EVF08600
               C(9)                   10.                               EVF08610
               C(9)                    9.                               EVF08620
               C(5)                    8.                               EVF08630
               C(5)                    7.                               EVF08640
               C(5)                    6.                               EVF08650
               C(5)                    5.                               EVF08660
               C(3)                    4.                               EVF08670
               C(3)                    3.                               EVF08680
               C(2)                    2.                               EVF08690
               ((1)                    1.                               EVF08700
C(2)   LXA     NWDCF,1                                                  EVF08710
GET2   CAL*    K1                                                       EVF08720
       LAS*    K2                                                       EVF08730
       TRA     ((2)                                                     EVF08740
       TRA     TIX2                                                     EVF08750
       TRA     ((1)                                                     EVF08760
TIX2   TIX     GET2,1,1                                                 EVF08770
       CAL     K1                                                       EVF08780
       LAS     K2                                                       EVF08790
       TRA     ((2)                                                     EVF08800
       TSX     ERC,4                                                    EVF08810
       TRA     ((1)                                                     EVF08820
C(3)   LXA     NWDCF,1                                                  EVF08830
GET3   CAL*    K1                                                       EVF08840
       LAS*    K3                                                       EVF08850
       TRA     B3H                                                      EVF08860
       TRA     TIX3                                                     EVF08870
       TRA     C(2)                                                     EVF08880
TIX3   TIX     GET3,1,1                                                 EVF08890
       CAL     K1                                                       EVF08900
       LAS     K3                                                       EVF08910
       TRA     B3H                                                      EVF08920
       TSX     ERC,4                                                    EVF08930
       TRA     C(2)                                                     EVF08940
C(4)   LXA     NWDCF,1                                                  EVF08950
GET4   CAL*    K1                                                       EVF08960
       LAS*    K4                                                       EVF08970
       TRA     ((4)                                                     EVF08980
       TRA     TIX4                                                     EVF08990
       TRA     ((3)                                                     EVF09000
TIX4   TIX     GET4,1,1                                                 EVF09010
       CAL     K1                                                       EVF09020
       LAS     K4                                                       EVF09030
       TRA     ((4)                                                     EVF09040
       TSX     ERC,4                                                    EVF09050
       TRA     ((3)                                                     EVF09060
C(5)   LXA     NWDCF,1                                                  EVF09070
GET5   CAL*    K1                                                       EVF09080
       LAS*    K5                                                       EVF09090
       TRA     B5H                                                      EVF09100
       TRA     TIX5                                                     EVF09110
       TRA     C(3)                                                     EVF09120
TIX5   TIX     GET5,1,1                                                 EVF09130
       CAL     K1                                                       EVF09140
       LAS     K5                                                       EVF09150
       TRA     B5H                                                      EVF09160
       TSX     ERC,4                                                    EVF09170
       TRA     C(3)                                                     EVF09180
C(6)   LXA     NWDCF,1                                                  EVF09190
GET6   CAL*    K1                                                       EVF09200
       LAS*    K6                                                       EVF09210
       TRA     ((6)                                                     EVF09220
       TRA     TIX6                                                     EVF09230
       TRA     ((5)                                                     EVF09240
TIX6   TIX     GET6,1,1                                                 EVF09250
       CAL     K1                                                       EVF09260
       LAS     K6                                                       EVF09270
       TRA     ((6)                                                     EVF09280
       TSX     ERC,4                                                    EVF09290
       TRA     ((5)                                                     EVF09300
C(7)   LXA     NWDCF,1                                                  EVF09310
GET7   CAL*    K1                                                       EVF09320
       LAS*    K7                                                       EVF09330
       TRA     B7H                                                      EVF09340
       TRA     TIX7                                                     EVF09350
       TRA     C(6)                                                     EVF09360
TIX7   TIX     GET7,1,1                                                 EVF09370
       CAL     K1                                                       EVF09380
       LAS     K7                                                       EVF09390
       TRA     B7H                                                      EVF09400
       TSX     ERC,4                                                    EVF09410
       TRA     C(6)                                                     EVF09420
C(8)   LXA     NWDCF,1                                                  EVF09430
GET8   CAL*    K1                                                       EVF09440
       LAS*    K8                                                       EVF09450
       TRA     ((8)                                                     EVF09460
       TRA     TIX8                                                     EVF09470
       TRA     ((7)                                                     EVF09480
TIX8   TIX     GET8,1,1                                                 EVF09490
       CAL     K1                                                       EVF09500
       LAS     K8                                                       EVF09510
       TRA     ((8)                                                     EVF09520
       TSX     ERC,4                                                    EVF09530
       TRA     ((7)                                                     EVF09540
C(9)   LXA     NWDCF,1                                                  EVF09550
GET9   CAL*    K1                                                       EVF09560
       LAS*    K9                                                       EVF09570
       TRA*    B9HI+9,2                                                 EVF09580
       TRA     TIX9                                                     EVF09590
       TRA     C(5)                                                     EVF09600
TIX9   TIX     GET9,1,1                                                 EVF09610
       CAL     K1                                                       EVF09620
       LAS     K9                                                       EVF09630
       TRA*    B9HI+9,2                                                 EVF09640
       TSX     ERC,4                                                    EVF09650
       TRA     C(5)                                                     EVF09660
C(10)  LXA     NWDCF,1                                                  EVF09670
GET10  CAL*    K1                                                       EVF09680
       LAS*    K10                                                      EVF09690
       TRA     ((10)                                                    EVF09700
       TRA     TIX10                                                    EVF09710
       TRA     ((9)                                                     EVF09720
TIX10  TIX     GET10,1,1                                                EVF09730
       CAL     K1                                                       EVF09740
       LAS     K10                                                      EVF09750
       TRA     ((10)                                                    EVF09760
       TSX     ERC,4                                                    EVF09770
       TRA     ((9)                                                     EVF09780
C(11)  LXA     NWDCF,1                                                  EVF09790
GET11  CAL*    K1                                                       EVF09800
       LAS*    K11                                                      EVF09810
       TRA     B11H                                                     EVF09820
       TRA     TIX11                                                    EVF09830
       TRA     C(10)                                                    EVF09840
TIX11  TIX     GET11,1,1                                                EVF09850
       CAL     K1                                                       EVF09860
       LAS     K11                                                      EVF09870
       TRA     B11H                                                     EVF09880
       TSX     ERC,4                                                    EVF09890
       TRA     C(10)                                                    EVF09900
C(12)  LXA     NWDCF,1                                                  EVF09910
GET12  CAL*    K1                                                       EVF09920
       LAS*    K12                                                      EVF09930
       TRA     ((12)                                                    EVF09940
       TRA     TIX12                                                    EVF09950
       TRA     ((11)                                                    EVF09960
TIX12  TIX     GET12,1,1                                                EVF09970
       CAL     K1                                                       EVF09980
       LAS     K12                                                      EVF09990
       TRA     ((12)                                                    EVF10000
       TSX     ERC,4                                                    EVF10010
       TRA     ((11)                                                    EVF10020
C(13)  LXA     NWDCF,1                                                  EVF10030
GET13  CAL*    K1                                                       EVF10040
       LAS*    K13                                                      EVF10050
       TRA*    B13HI+13,2                                               EVF10060
       TRA     TIX13                                                    EVF10070
       TRA     C(11)                                                    EVF10080
TIX13  TIX     GET13,1,1                                                EVF10090
       CAL     K1                                                       EVF10100
       LAS     K13                                                      EVF10110
       TRA*    B13HI+13,2                                               EVF10120
       TSX     ERC,4                                                    EVF10130
       TRA     C(11)                                                    EVF10140
C(14)  LXA     NWDCF,1                                                  EVF10150
GET14  CAL*    K1                                                       EVF10160
       LAS*    K14                                                      EVF10170
       TRA     ((14)                                                    EVF10180
       TRA     TIX14                                                    EVF10190
       TRA     ((13)                                                    EVF10200
TIX14  TIX     GET14,1,1                                                EVF10210
       CAL     K1                                                       EVF10220
       LAS     K14                                                      EVF10230
       TRA     ((14)                                                    EVF10240
       TSX     ERC,4                                                    EVF10250
       TRA     ((13)                                                    EVF10260
C(15)  LXA     NWDCF,1                                                  EVF10270
GET15  CAL*    K1                                                       EVF10280
       LAS*    K15                                                      EVF10290
       TRA*    B15HI+15,2                                               EVF10300
       TRA     TIX15                                                    EVF10310
       TRA     C(14)                                                    EVF10320
TIX15  TIX     GET15,1,1                                                EVF10330
       CAL     K1                                                       EVF10340
       LAS     K15                                                      EVF10350
       TRA*    B15HI+15,2                                               EVF10360
       TSX     ERC,4                                                    EVF10370
       TRA     C(14)                                                    EVF10380
C(16)  LXA     NWDCF,1                                                  EVF10390
GET16  CAL*    K1                                                       EVF10400
       LAS*    K16                                                      EVF10410
       TRA     ((16)                                                    EVF10420
       TRA     TIX16                                                    EVF10430
       TRA     ((15)                                                    EVF10440
TIX16  TIX     GET16,1,1                                                EVF10450
       CAL     K1                                                       EVF10460
       LAS     K16                                                      EVF10470
       TRA     ((16)                                                    EVF10480
       TSX     ERC,4                                                    EVF10490
       TRA     ((15)                                                    EVF10500
*  TRANSFERS FROM 3RD ENTRY COMPARE.                                    EVF10510
B3H    TXL     ((3),2,3      IF MERGE ORDER IS 3, WE ARE DONE.          EVF10520
       TRA     C(4)          GREATER THAN 3.  COMPARE 4TH ENTRY.        EVF10530
*  TRANSFERS FROM 5TH ENTRY COMPARE.                                    EVF10540
B5H    TXH     C(7),2,6      COMPARE 7TH ENTRY IF MERGE ORDER 7 OR MORE.EVF10550
       XEC     B5HI+5,2      MERGE ORDER LESS THAN 8.                   EVF10560
       TRA     C(6)          ORDER IS 6.  COMPARE 6TH ENTRY.            EVF10570
B5HI   TRA     ((5)          ORDER IS 5.  FINISHED.                     EVF10580
*  TRANSFERS FROM 7TH ENTRY COMPARE.                                    EVF10590
B7H    TXL     ((7),2,7      DONE IF ORDER IS 7.                        EVF10600
       TRA     C(8)          ORDER 8 OR MORE.  COMPARE 8TH ENTRY.       EVF10610
*  TRANSFERS FROM 9TH ENTRY COMPARE.                                    EVF10620
       TRA     C(13)         ORDER 16.  COMPARE 13TH ENTRY.             EVF10630
       TRA     C(13)         ORDER 15.  DITTO.                          EVF10640
       TRA     C(13)         ORDER 14.  DITTO.                          EVF10650
       TRA     C(13)         ORDER 13.  DITTO.                          EVF10660
       TRA     C(11)         ORDER 12.  COMPARE 11TH ENTRY.             EVF10670
       TRA     C(11)         ORDER 11.  DITTO.                          EVF10680
       TRA     C(10)         ORDER 10.  COMPARE 10TH ENTRY.             EVF10690
B9HI   TRA     ((9)          ORDER 9.  DONE.                            EVF10700
*  TRANSFERS FROM 11TH ENTRY COMPARE.                                   EVF10710
B11H   TXL     ((11),2,11    DONE IF ORDER 11.                          EVF10720
       TRA     C(12)         ORDER 12 OR MORE.  COMPARE 12TH ENTRY.     EVF10730
*  TRANSFERS FROM 13TH ENTRY COMPARE.                                   EVF10740
       TRA     C(15)         ORDER 16.  COMPARE 15TH ENTRY.             EVF10750
       TRA     C(15)         ORDER 15.  DITTO.                          EVF10760
       TRA     C(14)         ORDER 14.  COMPARE 14TH ENTRY.             EVF10770
B13HI  TRA     ((13)         ORDER 13.  DONE.                           EVF10780
*  TRANSFERS FROM 15TH ENTRY COMPARE.                                   EVF10790
       TRA     C(16)         ORDER 16.  COMPARE 16TH ENTRY.             EVF10800
B15HI  TRA     ((15)         ORDER 15.  DONE.                           EVF10810
*  ENTRY TO THIS TABLE LOADS XR2 WITH INSERTION LEVEL OF ITEM MERGED.   EVF10820
((16)  AXT     16,2                                                     EVF10830
       TRA     FMXCL                                                    EVF10840
((15)  AXT     15,2                                                     EVF10850
       TRA     FMXCL                                                    EVF10860
((14)  AXT     14,2                                                     EVF10870
       TRA     FMXCL                                                    EVF10880
((13)  AXT     13,2                                                     EVF10890
       TRA     FMXCL                                                    EVF10900
((12)  AXT     12,2                                                     EVF10910
       TRA     FMXCL                                                    EVF10920
((11)  AXT     11,2                                                     EVF10930
       TRA     FMXCL                                                    EVF10940
((10)  AXT     10,2                                                     EVF10950
       TRA     FMXCL                                                    EVF10960
((9)   AXT     9,2                                                      EVF10970
       TRA     FMXCL                                                    EVF10980
((8)   AXT     8,2                                                      EVF10990
       TRA     FMXCL                                                    EVF11000
((7)   AXT     7,2                                                      EVF11010
       TRA     FMXCL                                                    EVF11020
((6)   AXT     6,2                                                      EVF11030
       TRA     FMXCL                                                    EVF11040
((5)   AXT     5,2                                                      EVF11050
       TRA     FMXCL                                                    EVF11060
((4)   AXT     4,2                                                      EVF11070
       TRA     FMXCL                                                    EVF11080
((3)   AXT     3,2                                                      EVF11090
       TRA     FMXCL                                                    EVF11100
((2)   AXT     2,2                                                      EVF11110
       TRA     FMXCL                                                    EVF11120
((1)   TRA     B1816                                                    EVF11130
FMXCL  LDQ     K1            INSERTION DONE HERE.                       EVF11140
       CAL     K1+1,2                                                   EVF11150
       STQ     K1+1,2                                                   EVF11160
       XCL                                                              EVF11170
       TIX     *-3,2,1                                                  EVF11180
       TRA     B1816                                                    EVF11190
ERC    PXA     ,4            ERROR IN MERGING COMPARE LOOPS.            EVF11200
       PAC     ,4            ON EQUAL CONDITION, FILE NUMBERS           EVF11210
       SXA     *+2,4          HAVE COMPARED EQUAL.  SHOULD              EVF11220
       TSX     BUGPR2,4       NEVER HAPPEN.                             EVF11230
       PZE     **                                                       EVF11240
       TRA     *-2                                                      EVF11250
       EJECT                                                            EVF11260
*  READ ROUTINE--COMMUNICATES WITH I/O PROGRAMS.                        EVF11270
READ   SXA     (5),1                                                    EVF11280
       SXA     (6),2                                                    EVF11290
       SXA     (7),4                                                    EVF11300
EOFSW  BSS     0             (RETURN  1,4 IF ALL AT EOF)                EVF11310
       ZET     SWCHR         TEST FOR END OF REEL ACTION.               EVF11320
       TSX     SWCHR,4       GO TAKE CARE OF END OF REEL.               EVF11330
       NZT     RAW02         TEST FOR READ COMPLETE.                    EVF11340
       TRA     EOFSW         NOT COMPLETE                               EVF11350
R1     ZET     SERVC         WAS LAST READ SERVICED.                    EVF11360
       TRA     S             YES.                                       EVF11370
       ZET     MOD20                                                    EVF11380
       CALL    FMM06                                                    EVF11390
       STL     SERVC         SET LAST READ SERVICED.                    EVF11400
       ZET     EOFI          WAS THERE AN END OF FILE.                  EVF11410
       TRA     EF            YES.                                       EVF11420
       CLA     CFILE         MAKE CURRENT FILE THE PREVIOUS             EVF11430
       STO     PFILE          FILE.                                     EVF11440
       LXD     PFILE,2       PUT AREA NO. INTO XR2.                     EVF11450
       AXT     1,4           INDEX TO OBTAIN WORD JUST PRECEDING DATA.  EVF11460
REF4   CAL*    (ADDR),2      GET COUNT OF RECORDS READ AND              EVF11470
       PBT                   ON IF EXTERNAL OR FIXED LENGTH RECORDS.    EVF11480
       TRA     (8)           NO.                                        EVF11490
       SXA     EXTNL,2       SET SWITCH FOR EXTERNAL INPUT              EVF11500
       TRA     REF2           WITH AREA NO.                             EVF11510
(8)    ANA     =O77777                                                  EVF11520
       SLW     CNT9           SAVE.                                     EVF11530
       ADD     CNTR          UPDATE TOTAL NO. OF RECORDS READ           EVF11540
       STO     CNTR           AND SAVE IN CNTR.                         EVF11550
       CLA     CNT9                                                     EVF11560
REF2   STA     (ARWD),2      AREA WORD GETS RECORD                      EVF11570
       ALS     18             COUNT IN BOTH DECREMENT AND               EVF11580
REF3   STD     (ARWD),2       ADDRESS.  ADDRESS IS UPDATED AS           EVF11590
REF5   LDI     (ADDR),2       EACH RECORD IS MERGED.                    EVF11600
       RIR     400000        KNOCK OUT TAG.                             EVF11610
       SIR     100000        PUT IN TAG OF 1.                           EVF11620
       LXA     PFILE,1       FILE NO. TO XR1.                           EVF11630
(1)    CLA     **,1          GET COUNT OF RESERVE BLOCKS AND            EVF11640
       ADD     =1             UPDATE BY 1.                              EVF11650
       STA*    (1)                                                      EVF11660
       PAX     ,4            TEST TO SEE HOW MANY RESERVE WORDS WERE    EVF11670
LER16  TXH     ER16,4,NRW     LEFT.  TRANSFER IF NONE.                  EVF11680
       STI*    RSWRT+NRW,4   SET UP RESERVE FILE-WORD.                  EVF11690
       PXD     ,2            AREA NO. GOES TO DECREMENT                 EVF11700
       STD*    RSWRT+NRW,4   OF RESERVE FILE-WORD.                      EVF11710
       CLA*    NUMB          UPDATE COUNT OF BLOCKS FOR THIS FILE BY 1. EVF11720
       TNZ     UPDCT         IF THIS FILE WAS STARVED,                  EVF11730
       LXA     STRVD,4        REDUCE COUNT OF STARVED                   EVF11740
       TXI     *+1,4,-1       FILES BY 1.                               EVF11750
LER5   TXH     ER5,4,-2      TRANSFER IF ERROR.                         EVF11760
       SXA     STRVD,4                                                  EVF11770
UPDCT  ADD     =1                                                       EVF11780
       STA*    NUMB                                                     EVF11790
       ZET     INITR         WAS THIS AN INITIAL READ.                  EVF11800
       TRA     PRIME         YES.                                       EVF11810
S      AXT     1,1                                                      EVF11820
GRTR   SXA     F,1           SAVE FILE NO.                              EVF11830
       CLA*    NUMB          GET BLOCK COUNT FOR THIS FILE.             EVF11840
(1.4)  TXH     (2.5),1,**    (M.O.-1 IN DECR.)                          EVF11850
(1.6)  TXI     (2),1,1       INCREASE FILE NO. AND COMPARE AGAIN.       EVF11860
(2)    CAS*    NUMB          COMPARE AC AGAINST NO. OF UNMERGED BLOCKS  EVF11870
       TRA     GRTR           IN MEMORY FOR THIS FILE.                  EVF11880
       TRA     (2.5)                                                    EVF11890
(2.5)  TXL     (1.6),1,**    M.O.-1 IN DECR.                            EVF11900
       PAX     ,1                                                       EVF11910
LER1   TXH     ER1,1,NRW+1   TRANSFER IF ERROR.                         EVF11920
       TXH     (3),1,NRW     CANNOT READ - NO RESERVE AREAS.            EVF11930
F      AXT     **,1          FILE NO. FOR NEXT READ.                    EVF11940
       LXA     NAVLA,4       GET NO. OF AVAILABLE AREAS.                EVF11950
       TXH     AAVLB,4,0     TRANSFER IF AT LEAST ONE. **               EVF11960
       CAL     NAVCT         UPDATE NO. OF OCCURENCES OF THIS.**        EVF11970
       ADD     =1            **                                         EVF11980
       STA     NAVCT         **                                         EVF11990
       TXL     (3),4,0       TRANSFER IF NO AREAS AVAILABLE.            EVF12000
NAVCT  PZE                   **                                         EVF12010
AAVLB  BSS     0             **                                         EVF12020
       CLA*    BAAPL         GET AREA NO.                               EVF12030
       TXI     *+1,4,-1                                                 EVF12040
       SXA     NAVLA,4       SAVE NO. OF AVAILABLE AREAS LEFT.          EVF12050
       PAX     ,2            AREA NO. TO XR2.                           EVF12060
REF6   CLA     (ADDR),2      GET LOC. OF AREA.                          EVF12070
       SXD     CFILE,2       AREA NO. TO CURRENT FILE INDICATOR.        EVF12080
       STA     RAW01         LOC. TO CALLING SEQUENCE.                  EVF12090
       SXA     CFILE,1       SAVE CURRENT READ FILE NO.                 EVF12100
       PXD     ,1                                                       EVF12110
       STO     RAW00         FILE NO. TO CALLING SEQUENCE DECR.         EVF12120
       STZ     MSTGT         RESET READ DEMAND SWITCH.                  EVF12130
       CALL    MRGIO         CALL I/O FOR READ.                         EVF12140
       ZET     MOD42                                                    EVF12150
       CALL    DFMM03 ************CE DEBUG MOD*****                     EVF12160
       STZ     SERVC         INDICATE THIS READ NOT SERVICED.           EVF12170
       TRA     (3)           EXIT.                                      EVF12180
EF     LXA     CFILE,1       GET CURRENT READ FILE NO.                  EVF12190
       ZET     MOD47                                                    EVF12200
       CALL    DFMM08 ************CE DEBUG MOD*****                     EVF12210
       STZ     EOFI          RESET END OF FILE INDICATION.              EVF12220
       CAL     *             SET EOF INDICATION                         EVF12230
       STD*    NUMB           FOR THIS FILE.                            EVF12240
       CAL*    NUMB          IF THIS FILE WAS                           EVF12250
       PAX     ,4             STARVED,                                  EVF12260
       TXH     NSTVD,4,0      REDUCE STARVED COUNT                      EVF12270
       LXA     STRVD,4        BY 1.                                     EVF12280
       TXI     *+1,4,-1                                                 EVF12290
       SXA     STRVD,4                                                  EVF12300
NSTVD  BSS     0                                                        EVF12310
       LXA     EXORD,4       REDUCE NO. OF INPUT TAPES                  EVF12320
       TXI     *+1,4,-1       REMAINING.                                EVF12330
       SXA     EXORD,4                                                  EVF12340
       TXH     MORE,4,0      IF NO MORE TAPES,                          EVF12350
       CLA     RTURN          SET SWITCH TO RETURN                      EVF12360
       STO     EOFSW          IMMEDIATELY FROM ANY READ                 EVF12370
MORE   BSS     0              ENTRY.                                    EVF12380
       ZET     INITR                                                    EVF12390
       TRA     REDUCE                                                   EVF12400
(9)    TXH     S,4,0         TRANSFER IF MORE TAPES LEFT.               EVF12410
       TRA     (5)                                                      EVF12420
REDUCE LXA     INORD,2                                                  EVF12430
       TXI     *+1,2,-1                                                 EVF12440
LER11  TXH     ER11,2,-2     TRANSFER IF ERROR.                         EVF12450
       SXA     INORD,2                                                  EVF12460
       AXT     1,2                                                      EVF12470
       SXD     COMPAR,1      SAVE FILE NO. FOR COMPARE.                 EVF12480
VF120  CAL     K1+1,2        FIND K-TABLE ENTRY WITH                    EVF12490
       ANA     =O77777000000  FILE NO. SAME AS FILE THAT                EVF12500
       CAS     COMPAR         LAST HIT EOF.  WHEN IT                    EVF12510
       TXI     VF120,2,1      IS FOUND, REMOVE IT.                      EVF12520
       TRA     EQUAL                                                    EVF12530
       TXI     VF120,2,1                                                EVF12540
EQUAL  BSS     0             ENTRY IS FOUND.  MOVE                      EVF12550
LER12  TXL     VF140,2,15    TRANSFER IF NO ERROR.                      EVF12560
       TSX     BUGPR2,4                                                 EVF12570
       PZE     LER12                                                    EVF12580
VF140  CAL     K1,2          MOVE ALL OTHER ENTRIES DOWN.               EVF12590
       SLW     K1+1,2         BY 1.                                     EVF12600
       TXH     (9),2,14                                                 EVF12610
       TXI     VF140,2,1                                                EVF12620
COMPAR PZE                                                              EVF12630
(3)    LXA     EXTNL,2       WAS THIS INPUT EXTERNAL OR FIXED           EVF12640
*                             LENGTH RECORDS.                           EVF12650
       TXL     (5),2,0       EXIT IF NO.                                EVF12660
(4)    BSS     0             RECORDS IN EXTERNAL BLOCK OR FIXED         EVF12670
*                             LENGTH RECORD BLOCK MUST BE COUNTED.      EVF12680
       STZ     EXTNL         CLEAR SWITCH BEFORE WE FORGET.             EVF12690
       AXT     1,4                                                      EVF12700
REF8   CAL*    (ADDR),2      GET WORD JUST PRECEDING DATA.              EVF12710
       ANA     =O77777       WORD COUNT IS IN ADDRESS.                  EVF12720
       NZT     REC05         TRANSFER IF FIXED LENGTH                   EVF12730
       TRA     FIXED          RECORDS ARE BEING MERGED.                 EVF12740
       AXT     0,4           RECORD COUNT STARTS AT ZERO.               EVF12750
       PAX     ,1            BLOCK LENGTH.                              EVF12760
REF9   ADM     (ADDR),2      COMPUTE BASE LOC. OF BLOCK.                EVF12770
       STA     BINRY                                                    EVF12780
TSTMD  NZT     GEN01         IF RECORD IS BCD TRANSFER                  EVF12790
       TRA     CNVRT          OUT AND CONVERT LENGTH WORD.              EVF12800
BINRY  CAL     **,1          GET RECORD LENGTH WORD.                    EVF12810
       ADD     =O1000000                                                EVF12820
STCNT  TXI     *+1,4,1       INCREASE RECORD COUNT BY 1.                EVF12830
       ANA     =O77777000000                                            EVF12840
LER9   TNZ     NOER9                                                    EVF12850
       TSX     BUGPR2,4                                                 EVF12860
       PZE     LER9                                                     EVF12870
NOER9  STD     *+1                                                      EVF12880
       TIX     TSTMD,1,**                                               EVF12890
       SXD     TESTL,1                                                  EVF12900
       PDC     ,1                                                       EVF12910
TESTL  TXI     *+1,1,**                                                 EVF12920
LER7   TXL     NOER7,1,0     TRANSFER IF EVERYTHING OK.                 EVF12930
       TSX     BUGPR2,4      INPUT BLOCK HAS WRONG 1ST WORD, POSSIBLY.  EVF12940
       PZE     LER7          PRINT ERROR MESSAGE.  LENGTH DOESN,T CHECK.EVF12950
NOER7  PXA     ,4            IF VARIABLE RECORD MERGE, UPDATE NO.       EVF12960
       NZT     REC05         OF MERGE INPUT RECORDS                     EVF12970
       TRA     VF280          READ.                                     EVF12980
       ADD     CNT16                                                    EVF12990
       STO     CNT16                                                    EVF13000
VF280  PXA     ,4            FIXED INTERNAL INPUT ENTRY.                EVF13010
       STO     CNT9          SAVE RECORD COUNT.                         EVF13020
       ADD     CNTR                                                     EVF13030
       STO     CNTR                                                     EVF13040
       CLA     CNT9                                                     EVF13050
REF10  STA     (ARWD),2                                                 EVF13060
       ALS     18                                                       EVF13070
REF11  STD     (ARWD),2                                                 EVF13080
(5)    AXT     **,1          RELOAD FOR EXIT.                           EVF13090
(6)    AXT     **,2                                                     EVF13100
(7)    AXT     **,4                                                     EVF13110
RTURN  TRA     1,4                                                      EVF13120
*  ENTER HERE TO COMPUTE RECORD COUNT WHEN RECORDS ARE FIXED LENGTH.    EVF13130
FIXED  BSS     0                                                        EVF13140
LER17  TNZ     NOER17                                                   EVF13150
       TSX     BUGPR2,4      WORD COUNT FROM I/O PROGRAM                EVF13160
       PZE     LER17          SHOULD NOT BE ZERO WITHOUT                EVF13170
       TRA     *-2            EOF INDICATION.                           EVF13180
NOER17 LGR     36            COMPUTE NO. OF RECORDS IN                  EVF13190
       DVP     CAL10          INPUT BLOCK.                              EVF13200
       XCA                                                              EVF13210
       PAX     ,4            RECORD COUNT TO XR4.                       EVF13220
       LXA     PFILE,2                                                  EVF13230
       TXI     *+1,2,-1                                                 EVF13240
       CLA*    CHA03         GET TAPE TABLE ENTRY.                      EVF13250
       LXD     PFILE,2       RESTORE XR2 WITH AREA NO.                  EVF13260
       TMI     NOER7         TRANSFER IF EXTERNAL INPUT.                EVF13270
       TRA     VF280         INTERNAL INPUT, SO UPDATE ONLY FOR IT.     EVF13280
*  SETS UP FILE WORD ON INITIAL READ OF EACH FILE.                      EVF13290
PRIME  CAL*    RSWRT+NRW-1   PUT RESERVE BLOCK INTO                     EVF13300
       SLW     FLWD,1         MERGE STATUS.                             EVF13310
       CAL*    (1)           REDUCE NO. OF RESERVE                      EVF13320
       SUB     =1             BLOCKS FOR THIS FILE.                     EVF13330
LER10  LAS*    (1)           CHECK FOR ERROR.                           EVF13340
       TRA     ER10          **                                         EVF13350
       TRA     ER10          **                                         EVF13360
       STA*    (1)                                                      EVF13370
       TRA     S                                                        EVF13380
ER10   BSS     0             ERROR.  COUNT OF RESERVE BLOCKS WAS        EVF13390
       TSX     BUGPR2,4       ALREADY ZERO OR LITERAL (=1) IS ZERO.     EVF13400
       PZE     LER10                                                    EVF13410
       PXD     ,0                                                       EVF13420
       TRA     LER10+3                                                  EVF13430
EXTNL  PZE                   EXTERNAL INPUT SWITCH.                     EVF13440
INITR  PZE                   INITIAL READ SWITCH.                       EVF13450
CNVRT  LDQ*    BINRY                                                    EVF13460
       PXD     ,0                                                       EVF13470
       CAQ     DTBT1,0,5                                                EVF13480
       LRS     51                                                       EVF13490
       DVP     =6                                                       EVF13500
       XCL                                                              EVF13510
       ALS     18                                                       EVF13520
       TRA     STCNT                                                    EVF13530
ER1    BSS     0             LOGICAL ERROR.                             EVF13540
       TSX     BUGPR1,4      NO. OF BLOCKS IN MEMORY FOR THIS           EVF13550
       PZE     LER1           FILE IS GREATER THAN NO. OF AVAILABLE     EVF13560
       TRA     LER1+1         RESERVE WORDS PLUS 1.                     EVF13570
ER5    BSS     0             INCONSISTENCY.  STRVD CELL INDICATES NO    EVF13580
       TSX     BUGPR1,4       FILES STARVED, BUT THIS ONE HAS NO BLOCKS.EVF13590
       PZE     LER5                                                     EVF13600
       PXD     ,0                                                       EVF13610
       TRA     UPDCT                                                    EVF13620
ER11   BSS     0                                                        EVF13630
       TSX     BUGPR1,4                                                 EVF13640
       PZE     LER11                                                    EVF13650
       AXT     0,2                                                      EVF13660
       TRA     LER11+1                                                  EVF13670
ER16   TSX     BUGPR2,4      NO RESERVE AREAS WERE AVAILABLE            EVF13680
       PZE     LER16          FOR THIS FILE, BUT A BLOCK                EVF13690
       TRA     ER16           WAS READ.                                 EVF13700
SERVC  PZE     *             LAST-READ-SERVICED INDICATOR.              EVF13710
       EJECT                                                            EVF13720
*  WRITE SUBROUTINE.                                                    EVF13730
WRITE  SXA     WRSV1,1                                                  EVF13740
       SXA     WRSV2,2                                                  EVF13750
       SXA     WRSV4,4                                                  EVF13760
       NZT     RAW04         **TEST FOR WRITE IN PROGRESS.              EVF13770
       TRA     *-1           **WRITE IN PROGRESS.                       EVF13780
       ZET     RAW05         DID LAST WRITE HIT EOT.                    EVF13790
       TRA     WREOT         YES.                                       EVF13800
GOWRT  CAL     WRBF1                                                    EVF13810
       STA     RAW01                                                    EVF13820
       LXA     BLKSZ,4                                                  EVF13830
       SXD     RAW01,4                                                  EVF13840
       CLS     =0                                                       EVF13850
       STO     RAW00                                                    EVF13860
       ZET     MOD23                                                    EVF13870
       CALL    FMM09                                                    EVF13880
       ZET     MOD46                                                    EVF13890
       CALL    DFMM07 ************CE DEBUG MOD*****                     EVF13900
       CALL    IOBB                                                     EVF13910
       CAL     NWRTS         KEEP COUNT OF                              EVF13920
       ADD     =1             NO. OF WRITES                             EVF13930
       SLW     NWRTS          DONE.                                     EVF13940
       LXA     WRCT,4                                                   EVF13950
       PXA     ,4                                                       EVF13960
       ADD     WRTOT                                                    EVF13970
       STO     WRTOT                                                    EVF13980
       SXA     WRCT,0                                                   EVF13990
       STZ     BLKSZ                                                    EVF14000
       STZ     WRTRQ                                                    EVF14010
       CAL     WRBF2                                                    EVF14020
       STA     MVSTO         RESET MOVE ADDRESS FOR NEXT OUTPUT BLOCK.  EVF14030
       LDQ     WRBF1                                                    EVF14040
       SLW     WRBF1                                                    EVF14050
       STQ     WRBF2                                                    EVF14060
WRSV1  AXT     **,1                                                     EVF14070
WRSV2  AXT     **,2                                                     EVF14080
WRSV4  AXT     **,4                                                     EVF14090
       TRA     1,4                                                      EVF14100
*  END OF TAPE ACTION.                                                  EVF14110
WREOT  BSS     0                                                        EVF14120
       ZET     MOD48                                                    EVF14130
       CALL    DFMM09 ************CE DEBUG MOD*****                     EVF14140
       STZ     RAW05         CLEAR EOT INDICATOR.                       EVF14150
       CLS     =0            SET UP CALLING SEQ. FOR CLOSING.           EVF14160
       STO     RAW00                                                    EVF14170
       STZ     RAW01                                                    EVF14180
       CALL    SCL                                                      EVF14190
       ZET     ISCL          WAS ONLY EOF WRITTEN ON SECOND I.S. UNIT(3)EVF14191
       TRA     NOWRT         YES.                                    (3)EVF14192
       NZT     NOCKPT        NO.                                     (3)EVF14200
       CALL    CKPT                                                     EVF14210
       SWT     2                                                        EVF14220
       TRA     GOWRT                                                    EVF14230
       TSX     MSGSUP,4,2                                               EVF14240
       PZE     5                                                        EVF14250
       PZE     INTRM1,,4                                                EVF14260
       PZE     INTRM2,,8                                                EVF14270
       PZE     INTRM3,,4                                                EVF14280
       PZE     INTRM4,,7                                                EVF14290
       PZE     INTRM5,,3+DBLSP                                          EVF14300
       TSX     (PAUSE,4                                                 EVF14310
       SWT     2                                                        EVF14320
       TRA     GOWRT                                                    EVF14330
       TRA     NONE          HE WANTS, INDEED, TO INTERRUPT.            EVF14340
SEQER  BSS     0                                                        EVF14350
       ZET     MOD49                                                    EVF14360
       CALL    DFMM10 ************CE DEBUG MOD*****                     EVF14370
       LXD     K1,4                                                     EVF14380
       CAL     FLWD,4        LOCATION OF OUT-OF-SEQUENCE RECORD.        EVF14390
       LGR     15                                                       EVF14400
       TSX     (BCD5X,4                                                 EVF14410
       SLW     SQMS2+4                                                  EVF14420
       CAL     LASTLC        LOCATION OF LAST RECORD MERGED.            EVF14430
       LGR     15                                                       EVF14440
       TSX     (BCD5X,4                                                 EVF14450
       SLW     SQMS3+4                                                  EVF14460
       CAL     INBUF         LOCATION OF LAST RECORD IN OUTPUT BUFFER.  EVF14470
       LGR     15                                                       EVF14480
       TSX     (BCD5X,4                                                 EVF14490
       SLW     SQMS3.+3                                                 EVF14500
       TSX     MSGSUP,4,2                                               EVF14510
       PZE     4                                                        EVF14520
       PZE     SQMS1,,5                                                 EVF14530
       PZE     SQMS2,,5                                                 EVF14540
       PZE     SQMS3,,5                                                 EVF14550
       PZE     SQMS3.,,7                                                EVF14560
       LXD     K1,2                                                     EVF14570
       TXI     *+1,2,-1                                                 EVF14580
       CLA*    CHA03                                                    EVF14590
       STA     *+1                                                      EVF14600
       LDQ     **                                                       EVF14610
       TSX     MSGSUP,4,3                                               EVF14620
       PZE     SQMS4,,8+DBLSP                                           EVF14630
       TSX     PRINT1,4                                                 EVF14640
       PZE                                                              EVF14650
       TRA     B0202                                                    EVF14660
       EJECT                                                            EVF14670
*  ERROR MESSAGE AND OPTION PRINTING ROUTINES.                          EVF14680
BUGPR1 STL     CONSW                                                    EVF14690
BUGPR2 SXA     GOON4,4                                                  EVF14700
       CAL     1,4                                                      EVF14710
       LGR     15                                                       EVF14720
       TSX     (BCD5X,4                                                 EVF14730
       SLW     BUGMS+2                                                  EVF14740
       TSX     MSGSUP,4,2                                               EVF14750
       PZE     1                                                        EVF14760
       PZE     BUGMS,,4+DBLSP                                           EVF14770
       TRA     STOPS1                                                   EVF14780
PRINT1 STL     CONSW                                                    EVF14790
       TRA     STOPS                                                    EVF14800
PRINT2 STZ     CONSW                                                    EVF14810
STOPS  SXA     GOON4,4                                                  EVF14820
STOPS1 TSX     MSGSUP,4,2                                               EVF14830
       PZE     2                                                        EVF14840
       PZE     OPTMS,,6+DBLSP                                           EVF14850
       PZE     DLSMS,,6                                                 EVF14860
       LXA     GEN03,4       TEST FOR CHECKPOINT TAKEN.                 EVF14870
       TXL     NORES,4,0                                                EVF14880
       TSX     MSGSUP,4,2                                               EVF14890
       PZE     1                                                        EVF14900
       PZE     RESMS,,6                                                 EVF14910
NORES  NZT     CONSW                                                    EVF14920
       TRA     NOCON                                                    EVF14930
       TSX     MSGSUP,4,2                                               EVF14940
       PZE     1                                                        EVF14950
       PZE     CONMS,,6+DBLSP                                           EVF14960
NOCON  BSS     0                                                        EVF14970
PAUSE  TSX     (PAUSE,4                                                 EVF14980
       AXT     2,4                                                      EVF14990
       PXD     ,0                                                       EVF15000
SWT    SWT     5,4                                                      EVF15010
       TRA     OFF                                                      EVF15020
       TZE     SAVE                                                     EVF15030
       TSX     MSGSUP,4,2                                               EVF15040
       PZE     1                                                        EVF15050
       PZE     AMBMS,,8+DBLSP                                           EVF15060
       TRA     PAUSE                                                    EVF15070
SAVE   PXA     ,4            SAVE SWITCH THAT IS ON.                    EVF15080
OFF    TIX     SWT,4,1                                                  EVF15090
       CAS     =1                                                       EVF15100
       TRA     THRON         SW 3 IS ON.  CONTINUE OPTION.              EVF15110
       TRA     FORON         SW4 IS ON.  RESTART OPTION.                EVF15120
NONE   STL     ERA18         NO SWITCHES.  RETURN TO SORT MONITOR.      EVF15130
       XEC     FMXR4         RELOAD XR4.                                EVF15140
       TRA     5,4           RETURN TO 5,4 TO DELETE SORT.           (2)EVF15150
FORON  LXA     GEN03,4                                                  EVF15160
       TXH     RESTR,4,0                                                EVF15170
       PZE     INTRM6,,3+DBLSP                                          EVF15180
REJECT TSX     MSGSUP,4,2                                               EVF15190
       PZE     2                                                        EVF15200
       MZE     IMPMS,,4                                                 EVF15210
       PZE     AMBMS+3,,5+DBLSP                                         EVF15220
       TRA     PAUSE                                                    EVF15230
RESTR  CALL    RESTAR                                                   EVF15240
THRON  ZET     CONSW                                                    EVF15250
       TRA     GOON                                                     EVF15260
       TRA     REJECT                                                   EVF15270
GOON   TSX     MSGSUP,4,2                                               EVF15280
       PZE     1                                                        EVF15290
       PZE     CNTMS,,2+512*4                                           EVF15300
GOON4  AXT     **,4                                                     EVF15310
RETRN  TRA     2,4                                                      EVF15320
CONSW  PZE                   CONTINUE NOT POSSIBLE IF ZERO.             EVF15330
BUGMS  BCI     4,ERROR, LOC.        *LE10                               EVF15340
OPTMS  BCI     6,**OPTIONS**              SS3  SS4                      EVF15350
DLSMS  BCI     6,TO DELETE SORT-----------UP   UP                       EVF15360
RESMS  BCI     6,TO RETURN TO LAST CKPT---UP   DN                       EVF15370
CONMS  BCI     6,TO GO ON (IGNORE)--------DN   UP                       EVF15380
CNTMS  BCI     2,(IGNORED)                                              EVF15390
AMBMS  BCI     8,MORE THAN 1 SS ON--CLARIFY YOUR CHOICE AND START       EVF15400
IMPMS  BCI     4,IMPROPER CHOICE TAKEN---                               EVF15410
SQMS1  BCI     5,RECORD OUT OF SEQUENCE *SQ03                           EVF15420
SQMS2  BCI     5,THIS RECORD IS AT LOC.  XXXXXX                         EVF15430
SQMS3  BCI     5,LAST RECORD WAS AT LOC. XXXXXX                         EVF15440
SQMS3. BCI     7,AND NOW IS AT LOC.XXXXXX IN OUTPUT BUFFER.             EVF15450
SQMS4  BCI     8, IS THE UNIT WHERE OUT-OF-SORT RECORD ORIGINATED       EVF15460
LDMS01 BCI     4, MOUNT MERGE FILE XXXXXX                               EVF15470
INTRM1 BCI     4,SORT INTERRUPT REQUESTED                               EVF15480
INTRM2 BCI     8,      1. LABEL AND SAVE ALL TAPES FOR LATER            EVF15490
INTRM3 BCI     4,RESTART.  PRESS START.                                 EVF15500
INTRM4 BCI     7,      2. IF SORT IS TO CONTINUE, PUT SS2               EVF15510
INTRM5 BCI     3,UP--PRESS START.                                       EVF15520
INTRM6 BCI     3,SORT INTERRUPTED.                                      EVF15530
BIGMS1 BCI     7,RECORD, LOC XXXXXX, INVALID FORMAT *VR03               EVF15540
SIZMS  BCI     2,XXXXXX WORDS                                           EVF15550
DELMS  BCI     1,ELETED                                                 EVF15560
BIGMS2 BCI     5,PRESS START TO DELETE SORT.                            EVF15570
       EJECT                                                            EVF15580
*  CONTROL FIELD REFERENCES.                                            EVF15590
K16    PZE     ,1,K1+1-*     TABLE     LOCATION OF LAST CELL + 1 OF     EVF15600
K15    PZE     ,1,K1+1-*               EXTRACTED CONTROL FIELD IS IN    EVF15610
K14    PZE     ,1,K1+1-*               THE ADDRESS PART OF EACH WORD,   EVF15620
K13    PZE     ,1,K1+1-*     OF        FILE NO. IS IN DECREMENT.  THIS  EVF15630
K12    PZE     ,1,K1+1-*               TABLE IS KEPT IN SORTED ORDER    EVF15640
K11    PZE     ,1,K1+1-*               SUCH THAT THE BOTTOM ENTRY (K1)  EVF15650
K10    PZE     ,1,K1+1-*     CONTROL   REPRESENTS THE CURRENT RECORD    EVF15660
K9     PZE     ,1,K1+1-*               TO BE PUT OUT FROM THE MERGE.    EVF15670
K8     PZE     ,1,K1+1-*                                                EVF15680
K7     PZE     ,1,K1+1-*     FIELD                                      EVF15690
K6     PZE     ,1,K1+1-*                                                EVF15700
K5     PZE     ,1,K1+1-*                                                EVF15710
K4     PZE     ,1,K1+1-*     REFERENCE                                  EVF15720
K3     PZE     ,1,K1+1-*                                                EVF15730
K2     PZE     ,1,K1+1-*                                                EVF15740
K1     PZE     ,1,K1+1-*     WORDS.                                     EVF15750
       EJECT                                                            EVF15760
*  FILE WORD TABLES.                                                    EVF15770
       DUP     1,16                                                     EVF15780
       PZE     ,1                                                       EVF15790
FLWD   BES     0             LOC. OF NEXT RECORD IN THIS FILE IN ADDR,  EVF15800
*                             TAG OF 1, AREA NO. FOR THIS RECORD IN     EVF15810
*                             DECREMENT.  FLWD-1 REFERS TO LOGICAL FILE EVF15820
*                             NO. 1, FLWD-2 TO FILE 2, ETC.             EVF15830
       DUP     1,16                                                     EVF15840
       PZE     ,1                                                       EVF15850
RFWD2  BES     0             2ND LEVEL RESERVE FILE WORDS.              EVF15860
       DUP     1,16                                                     EVF15870
       PZE     ,1                                                       EVF15880
RFWD1  BES     0             1ST LEVEL RESERVE FILE WORDS.              EVF15890
RSWRT  BSS     0             RESERVE FILE-WORD TABLE.                   EVF15900
       PZE     RFWD2,1                                                  EVF15910
       PZE     RFWD1,1                                                  EVF15920
       EJECT                                                            EVF15930
*  INITIALIZATION TABLES.                                               EVF15940
AR1    PZE     REF12         REFERENCES TO ARWD.                        EVF15950
       PZE     REF1                                                     EVF15960
       PZE     REF2                                                     EVF15970
       PZE     REF3                                                     EVF15980
       PZE     REF10                                                    EVF15990
       PZE     REF11                                                    EVF16000
ARWDR  PZE     *-AR1         NO. OF REFERENCES TO ARWD.                 EVF16010
AD1    PZE     REF4          REFERENCES TO ADDR.                        EVF16020
       PZE     REF5                                                     EVF16030
       PZE     REF6                                                     EVF16040
       PZE     REF7                                                     EVF16050
       PZE     REF8                                                     EVF16060
       PZE     REF9                                                     EVF16070
ADDRR  PZE     *-AD1         NO. OF REFERENCES TO ADDR.                 EVF16080
       SPACE                                                            EVF16090
*  PROGRAM CONSTANTS.                                                   EVF16100
TAG4   PZE     ,4                                                       EVF16110
       SPACE                                                            EVF16120
       SPACE                                                            EVF16130
*  PROGRAM VARIABLES.                                                   EVF16140
CHARC  PZE                   HOLDS 6TH CHAR. OF 1ST WORD OF REC.        EVF16150
CNT9   PZE                   NO. OF RECORDS READ LAST TIME.             EVF16160
NAVLA  PZE                   NO. OF AVAILABLE READ AREAS.               EVF16170
NWRTS  PZE                   NO. OF WRITES DONE.                        EVF16180
STRVD  PZE                   COUNT OF STARVED FILES.                    EVF16190
       SPACE                                                            EVF16200
*  SWITCHES.                                                            EVF16210
AJUSX  PZE                   AREA-JUST-EXHAUSTED INDICATOR.             EVF16220
ALTER  PZE                   NON-ZERO IF INPUT BINARY, OUTPUT BCD.      EVF16230
DROPSW PZE                   NON-ZERO IF ALL LONG RECORDS TO BE DROPPED.EVF16240
ISCL   PZE                   NON-ZERO WHEN ONLY EOF WANTED ON I.S.   (3)EVF16241
       SPACE                                                            EVF16250
*  LOCATORS.                                                            EVF16260
BAAPL  PZE     ,4            BASE OF AVAILABLE-AREAS-POOL LIST.         EVF16270
FM777  PZE                   HOLDS LOC. OF 1ST USABLE CORE WORD.        EVF16280
NUMB   PZE     ,1            BASE OF LIST OF NOS. OF UNMERGED BLOCKS.   EVF16290
WRBF2  PZE                   LOC. OF ALTERNATE WRITE BUFFER.            EVF16300
       EJECT                                                            EVF16310
       DETAIL                                                           EVF16320
*  DEFINITIONS.                                                         EVF16330
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    EVF16340
OVEPR  COMMON  2             OVERFLOW PARAMETERS.                       EVF16350
LABPR  COMMON  5             LABEL PARAMETERS.                          EVF16360
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   EVF16370
FILPR  COMMON  14            FILE CARD PARAMETERS.                      EVF16380
MODPR  COMMON  50            MODIFICATION PARAMETERS.                   EVF16390
RECPR  COMMON  10            RECORD PARAMETERS.                         EVF16400
DELPR  COMMON  2             DELETE PARAMETERS.                         EVF16410
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            EVF16420
CALPR  COMMON  50            CALCULATED PARAMETERS.                     EVF16430
GENPR  COMMON  10            GENERAL PARAMETERS.                        EVF16440
RAWPR  COMMON  30            READ AND WRITE PARAMETERS.                 EVF16450
CNTPR  COMMON  20            COUNTS.                                    EVF16460
ERAPR  COMMON  30            ERASABLE COMMON PARAMETERS.                EVF16470
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER.           EVF16480
BLKSZ  EQU     ERAPR-2       CURRENT OUTPUT BLOCKSIZE, WORDS.           EVF16490
CAL02  EQU     CALPR-2                                                  EVF16500
CAL10  EQU     CALPR-10      EFFECTIVE RECORD LENGTH, PHASE 3.          EVF16510
CAL19  EQU     CALPR-19      LOC. OF LOW PADDING RECORD.                EVF16520
CAL20  EQU     CALPR-20      LOC. OF HIGH PADDING RECORD.               EVF16530
CAL28  EQU     CALPR-28                                                 EVF16540
CHA02  EQU     CHAPR-2       OUTPUT CHANNEL REFERENCE CELL.             EVF16550
CHA05  EQU     CHAPR-5       NON-ZERO MEANS NO SYSCK2 ATTACHED.         EVF16560
CNT01  EQU     CNTPR-1       NO. OF RECORDS OUTPUT FROM PHASE 2.        EVF16570
CNT05  EQU     CNTPR-5       COUNT OF RECORDS DUMPED.                   EVF16580
CNT08  EQU     CNTPR-8       PHASE 1 DELETE COUNT.                      EVF16590
CNT09  EQU     CNTPR-9       CURRENT PHASE DELETE COUNT.                EVF16600
CNT10  EQU     CNTPR-10      LOW PADDING COUNT KEPT HERE.               EVF16610
CNT11  EQU     CNTPR-11      HIGH PADDING COUNT.                        EVF16620
CNT16  EQU     CNTPR-16      COUNT OF EXTERNAL INPUT RECORDS TO PHASE 3.EVF16630
DEL00  EQU     DELPR         DELETE OPTION - NONZERO=YES.               EVF16640
ERA03  EQU     ERAPR-3       LOC. OF ADDR TABLE LAST WORD+1, TAG OF 2.  EVF16650
ERA04  EQU     ERAPR-4       LOC. OF ARWD TABLE LAST WORD + 1, TAG OF 2.EVF16660
ERA05  EQU     ERAPR-5       LOC. OF FLWD TABLE LAST + 1, TAG OF 1.     EVF16670
ERA08  EQU     ERAPR-8       LOC. OF BASE1 (BASE OF CURRENT RECORD      EVF16680
*                             BEING MERGED).                            EVF16690
ERA11  EQU     ERAPR-11      DELETION COMMUNICATION CELL.               EVF16700
ERA18  EQU     ERAPR-18      DELETE THIS JOB SWITCH.                    EVF16710
ERA19  EQU     ERAPR-19                                              (8)EVF16711
ERA20  EQU     ERAPR-20      ADDRESS OF FILE NO. IN LABEL.              EVF16720
FMSC   EQU     ERAPR-7       LOC. OF LAST CELL + 1 OF SEQUENCE CHECK    EVF16730
*                             CONTROL FIELD.                            EVF16740
GEN03  EQU     GENPR-3       ADDR - CKPT EXIT. DECR - MONITOR RETURN.   EVF16750
INBUF  EQU     ERAPR-20      LOC. OF RECORD IN OUTPUT BUFFER.           EVF16760
MOD49  EQU     MODPR-49      SWITCH FOR DFMM10                          EVF16770
MOD48  EQU     MODPR-48                 DFMM09                          EVF16780
MOD47  EQU     MODPR-47                 DFMM08                          EVF16790
MOD46  EQU     MODPR-46                 DFMM07                          EVF16800
MOD45  EQU     MODPR-45                 DFMM06                          EVF16810
MOD44  EQU     MODPR-44                 DFMM05                          EVF16820
MOD43  EQU     MODPR-43                 DFMM04                          EVF16830
MOD42  EQU     MODPR-42                 DFMM03                          EVF16840
MOD41  EQU     MODPR-41                 DFMM02                          EVF16850
MOD40  EQU     MODPR-40                 DFMM01                          EVF16860
MOD24  EQU     MODPR-24      SWITCH FOR FMM10                           EVF16870
MOD23  EQU     MODPR-23      SWITCH FOR FMM09                           EVF16880
MOD22  EQU     MODPR-22      SWITCH FOR FMM08                           EVF16890
MOD21  EQU     MODPR-21      SWITCH FOR FMM07                           EVF16900
MOD20  EQU     MODPR-20      SWITCH FOR FMM06                           EVF16910
MOD19  EQU     MODPR-19      SWITCH FOR FMM05                           EVF16920
MOD18  EQU     MODPR-18      SWITCH FOR FMM04                           EVF16930
MOD17  EQU     MODPR-17      SWITCH FOR FMM03                           EVF16940
MOD16  EQU     MODPR-16      SWITCH FOR FMM02                           EVF16950
MOD15  EQU     MODPR-15      SWITCH FOR FMM01                           EVF16960
RAW00  EQU     RAWPR                                                    EVF16970
RAW01  EQU     RAWPR-1                                                  EVF16980
RAW02  EQU     RAWPR-2                                                  EVF16990
RAW03  EQU     RAWPR-3                                                  EVF17000
RAW04  EQU     RAWPR-4                                                  EVF17010
RAW05  EQU     RAWPR-5                                                  EVF17020
REC01  EQU     RECPR-1       FIXED RECORD LENGTH TO PHASE 3.            EVF17030
REC02  EQU     RECPR-2       OUTPUT RECORD LENGTH.                      EVF17040
REC05  EQU     RECPR-5       NON-ZERO IF RECORDS ARE NOT FIXED LENGTH.  EVF17050
ERA09  EQU     ERAPR-9                                                  EVF17060
SAM02  EQU     SAMPR-2       NO. OF EXTERNAL MERGE FILES.               EVF17070
SAM04  EQU     SAMPR-4       NON-ZERO MEANS SORT.                       EVF17080
SAM05  EQU     SAMPR-5       NON-ZERO MEANS EXTERNAL MERGE.             EVF17090
WRBF1  EQU     ERAPR-6       LOC. OF CURRENT BUFFER FOR OUTPUT.         EVF17100
WRCT   EQU     ERAPR-1       COUNT OF RECORDS PLACED IN OUTPUT BUFFER.  EVF17110
FIL01  EQU     FILPR-1                                                  EVF17120
FIL02  EQU     FILPR-2       LOC. OF 1ST MERGE FILE BLOCK.              EVF17130
CNT15  EQU     CNTPR-15      NO. OF STRINGS OUTPUT BY LAST PHASE.       EVF17140
GEN00  EQU     GENPR         PHASE INDICATOR.                           EVF17150
CHA03  EQU     CHAPR-3       LOC. OF INPUT CHAN. TAPE TABLE, TAG OF 2.  EVF17160
OPT02  EQU     OPTPR-2       NOCKPT OPTION.                             EVF17170
EOFI   EQU     RAWPR-3       END OF FILE INDICATOR.                     EVF17180
NWDCF  EQU     CALPR-32      NO. OF WORDS IN EXTRACTED CONTROL FIELD.   EVF17190
MORDER EQU     SAMPR-1       ORDER OF MERGE.                            EVF17200
CAL16  EQU     CALPR-16      NO. OF INPUT AREAS.                        EVF17210
MXROP  EQU     CALPR-2       MAXIMUM NO. OF RECORDS, OUTPUT BLOCK.      EVF17220
CAL17  EQU     CALPR-17      MAXIMUM MERGE BLOCK SIZE.                  EVF17230
OBFRL  EQU     CALPR-28      OUTPUT BUFFER SIZE, WORDS.                 EVF17240
OPT01  EQU     OPTPR-1       CHECKSUMS INDICATOR.                       EVF17250
OPT03  EQU     OPTPR-3       EQUALS OPTION INDICATOR.                   EVF17260
GEN01  EQU     GENPR-1       BINARY/BCD INDICATOR.                      EVF17270
NOCKPT EQU     OPTPR-2       NO-CHECKPOINT OPTION INDICATOR.            EVF17280
WRTOT  EQU     CNTPR-2       TOTAL NO. OF RECORDS WRITTEN.              EVF17290
BASE2  EQU     ERAPR-10      BASE OF ENTIRE RECORD (LOC1+LEN2).         EVF17300
LEN1   EQU     ERAPR-12      LENGTH OF OUTPUT RECORD.                   EVF17310
LEN2   EQU     ERAPR-13      LENGTH OF ENTIRE LOGICAL RECORD.           EVF17320
LOC1   EQU     ERAPR-14      LOC. OF VERY 1ST WORD OF LOGICAL RECORD.   EVF17330
LOC2   EQU     ERAPR-15      LOC. OF 1ST WORD OF RECORD PROPER.         EVF17340
LASTLC EQU     ERAPR-16      LOC1 OF LAST RECORD MOVED TO BUFFER.       EVF17350
PRECT  EQU     ERAPR-17      COUNT OF WORDS PRECEDING RECORD PROPER.    EVF17360
MVSTO  EQU     ERAPR-21                                                 EVF17370
CUTSW  EQU     ERAPR-22      NON-ZERO IF THIS RECORD TO BE DROPPED.     EVF17380
CFILE  EQU     ERAPR-23      CURRENT FILE READING,,AREA NO.             EVF17390
PFILE  EQU     ERAPR-24      PREVIOUS FILE READ,,AREA NO.               EVF17400
CNTR   EQU     ERAPR-25      TOTAL NO. OF RECORDS READ SO FAR.          EVF17410
EXORD  EQU     ERAPR-26      EXTERNAL ORDER OF MERGE.                   EVF17420
INORD  EQU     ERAPR-27      INTERNAL ORDER OF MERGE.                   EVF17430
MSTGT  EQU     ERAPR-28      READ-DEMAND INDICATOR.                     EVF17440
SWCHR  EQU     RAWPR-11      REEL SWITCHING CELL.                       EVF17450
WRTRQ  EQU     ERAPR-29      WRITE-REQUEST INDICATOR.                   EVF17460
NRW    EQU     2             NO. OF RESERVE WORDS, EACH FILE.           EVF17470
VECTOR EQU     30            LENGTH OF TRANSFER VECTOR.                 EVF17480
DBLSP  EQU     2048                                                     EVF17490
(ADDR) EQU     0                                                        EVF17500
(ARWD) EQU     0                                                        EVF17510
       EXTERN  MSGSUP                                                   EVF17520
       END                                                              EVF17530
* 7090/7094 SORT VER 7 MOD 9 MERGE-FOR 729 TAPES ONLY                (9)EVM00000
*      FAP
       COUNT   1800                                                     EVM00010
       TITLE                                                            EVM00020
       ENTRY   MERGE                                                    EVM00030
       SST                                                              EVM00040
       PMC                                                              EVM00050
*                                                                       EVM00060
       PMC                                                              EVM00070
       PMC                                                              EVM00080
       EJECT                                                            EVM00090
MERGE  SXA     MRXR4,4                                                  EVM00100
       SXD     GEN03,4       PUT MONITOR RETURN INTO COMMON.            EVM00110
       SXA     MR777,2        GET THE ADDRESS FROM LOADER               EVM00120
       TRA     VMRHKP         TO PHASE 2 INITIALIZATION ROUTINES        EVM00130
       SPACE                                                            EVM00140
 PASS  SLF                    TURN OFF ALL SENSE LIGHTS                 EVM00150
       LXA     MORDER,1       ORDER OF MERGE TO IR1                     EVM00160
       SXA     MORD1,1                                                  EVM00170
       SXA     MORT,1                                                   EVM00180
       SXD     VMR153,1                                                 EVM00190
       SXD     WR15,1                                                   EVM00200
       AXT     1,2                                                      EVM00210
       CLA     ONE                                                      EVM00220
       STO     FLNO,2                                                   EVM00230
       ADD     ONE                                                      EVM00240
       TXI     *+1,2,1                                                  EVM00250
       TIX     *-3,1,1                                                  EVM00260
*      INITIALIZE NUMBER READ AREAS AVAILABLE COUNTER.                  EVM00270
       LXA     CNT6,4                                                   EVM00280
       SXA     AACNT,4                                                  EVM00290
       SXA     EFNAA,4                                                  EVM00300
*      INITIALIZE BLOCK SEQUENCE TABLES                                 EVM00310
       AXT     17,1                                                     EVM00320
       STZ     MROSBI+1,1                                               EVM00330
       TIX     *-1,1,1                                                  EVM00340
*      SET EOF INDICATOR TO ZERO.                                       EVM00350
       AXT     16,1                                                     EVM00360
       STZ     EOFIND,1                                                 EVM00370
       TIX     *-1,1,1                                                  EVM00380
*      INITIALIZE SWITCHES                                              EVM00390
       LDQ     TRA                                                      EVM00400
       SLQ     MRRSW1                                                   EVM00410
       SLQ     MRRSW2                                                   EVM00420
       SLQ     MR375S                                                   EVM00430
       SLQ     MRRSW4                                                   EVM00440
       SLQ     MRSBSW                                                   EVM00450
       SLQ     MR26                                                     EVM00460
       LDQ     NOP                                                      EVM00470
       SLQ     MRRSW3                                                   EVM00480
*      INITIALIZE SELECT TABLE                                          EVM00490
       AXT     16,1                                                     EVM00500
       PXA     ,1                                                       EVM00510
       STO     MRBKC,1                                                  EVM00520
       TIX     *-2,1,1                                                  EVM00530
*      OPEN ALL INPUT FILES                                             EVM00540
VMROPN SLN     4              TURN ON SENSE LITE 4.                     EVM00550
       STZ     RWCS                                                     EVM00560
MRA12  LXA     MORDER,2                                                 EVM00570
       AXT     1,1                                                      EVM00580
       STL     GENPR-4                                                  EVM00590
       SXD     RWCS,1                                                   EVM00600
       PXD     ,1                                                       EVM00610
       STD*    FLN                                                      EVM00620
       CALL    IOPEN                                                    EVM00630
       TXI     *+1,1,1                                                  EVM00640
       TIX     *-5,2,1                                                  EVM00650
*      OPEN ALL OUTPUT FILES                                            EVM00660
       SLT     4                                                        EVM00670
       TRA     PAT            I/P AND O/P FILES ARE OPENED.             EVM00680
       CAL     *                                                        EVM00690
       STP     RWCS                                                     EVM00700
       CLA*    PSN                                                      EVM00710
       ADD     ONE                                                      EVM00720
       STO*    PSN                                                      EVM00730
       TRA     MRA12                                                    EVM00740
*      INITIAL READS FROM EACH FILE                                     EVM00750
 PAT   LXA     MORDER,1       ORDER OF MERGE TO IR1.                    EVM00760
 MRST  SXA     MRA1,1                                                   EVM00770
       TSX     MRREAD,4                                                 EVM00780
       ZET     RAW11                                                    EVM00790
       TSX     RAW11,4                                                  EVM00800
       NZT     RDIND                                                    EVM00810
       TRA     *-3                                                      EVM00820
       NZT     RDIND1        TEST FOR END OF FILE                       EVM00830
       TRA     MRA2                                                     EVM00840
*      EOF ON INITIAL READ                                              EVM00850
       STZ     RDIND1         RESET CHANNEL END OF FILE INDICATOR       EVM00860
       CLA     AACNT          INCREASE COUNT OF                         EVM00870
       ADD     ONE              NUMBER READ AREAS                       EVM00880
       STO     AACNT              AVAILABLE                             EVM00890
       LXA     MRT2,1                                                   EVM00900
       CLA     *              SET EOF INDICATOR                         EVM00910
       STO     EOFIND,1         FOR THIS FILE.                          EVM00920
       STZ     FLWD,1         ZERO FILE WORD FOR THIS FILE.             EVM00930
       AXT     28672,4        SET SELECT CONTROL WORD                   EVM00940
       PXD     ,4               HIGH FOR THIS                           EVM00950
       STD     MRBKC,1            FILE.                                 EVM00960
*      TEST FOR ALL FILES AT EOF.                                       EVM00970
       LXA     MORDER,1                                                 EVM00980
       NZT     EOFIND,1                                                 EVM00990
       TRA     VMRSTA                                                   EVM01000
       TIX     *-2,1,1                                                  EVM01010
*      ALL FILES AT EOF - NO RECORDS FOR PHASE 2.                       EVM01020
       TSX     MSGSUP,4,2                                               EVM01030
       PZE     4                                                        EVM01040
       PZE     AMS24,,9+512*4                                           EVM01050
       PZE     VMSG03,,6                                                EVM01060
       PZE     VMSG04,,6                                                EVM01070
       PZE     VMSG05,,6+512*4                                          EVM01080
       TSX     (PAUSE,4                                                +EVM01090
       SWT     4                                                        EVM01100
       TRA     DELET                                                    EVM01110
       CALL    RESTAR                                                   EVM01120
       SPACE                                                            EVM01130
VMRSTA LXA     MORD1,1        REDUCE MERGE ORDER BY 1.                  EVM01140
       TXI     *+1,1,-1                                                 EVM01150
       SXA     MORD1,1                                                  EVM01160
       TRA     MRA1                                                     EVM01170
*                                                                       EVM01180
 MRA2  LXD     MRT2,2         AREA NO. OF COMPLETED READ TO IR2         EVM01190
       LXA     MRT2,1         FILE NO. OF COMPLETED READ TO IR1         EVM01200
       AXT     1,4                                                      EVM01210
       CAL*    ADDR,2         NO. WORDS IN BLOCK FIXED/NO. REC. VARIABLEEVM01220
       STD     MRIBSC,1       INITIALIZE SEQ. LEVEL NO. FOR THIS FILE   EVM01230
FXSW04 TRA     VMRA2A         TRANSFER IF VARIABLE                      EVM01240
*      PAX     0,4            REPLACES INST. AT FXSW04 WHEN FIXED.      EVM01250
       PXA     0,4            CONVERT                                   EVM01260
       LRS     35               WORD COUNT                              EVM01270
       DVP     NWTR               TO                                    EVM01280
       XCL                          RECORD COUNT                        EVM01290
VMRA2A STA     CNT9           SAVE NO. RECORDS THIS BLOCK.              EVM01300
       STA     ARWD,2         SET UP                                    EVM01310
       ALS     18               AREA                                    EVM01320
       STD     ARWD,2             WORD                                  EVM01330
       CLA     CNT9           UPDATE TOTAL NO.                          EVM01340
       ADD     CNTR             RECORDS READ                            EVM01350
       STO     CNTR               COUNTER                               EVM01360
       CLA     ADDR,2         SET UP FILE WORD                          EVM01370
       STA     FLWD,1                                                   EVM01380
       PXD     ,2                                                       EVM01390
       STD     FLWD,1                                                   EVM01400
 MRA1  AXT     **,1                                                     EVM01410
       TIX     MRST,1,1                                                 EVM01420
 MRC   SLN     1              TO INITIALIZE SEQ. CONTROL IND. FOR/OP    EVM01430
       LXA     MORD1,4                                                  EVM01440
       SXA     MORD2,4                                                  EVM01450
       SXA     MORD3,4                                                  EVM01460
       TSX     MRREAD,4       START M+1 READ                            EVM01470
       LDQ     TRA            SET SWITCH TO INDICATE INITIAL            EVM01480
       SLQ     MRRSW3           READ COMPLETED FROM EACH FILE           EVM01490
       SPACE                                                            EVM01500
*      EXTRACT CONTROL FIELDS FROM EACH FILE.                           EVM01510
       AXT     1,1                                                      EVM01520
       AXT     1,2                                                      EVM01530
VMR154 CLA     FLWD,1         LOCATION OF FIRST WORD OF RECORD          EVM01540
       TZE     TIM            TRANSFER IF FILE IS AT EOF.               EVM01550
       STA     RCWD             TO EXTRACT CALLING SEQUENCE WORD        EVM01560
       CLA     CFADR,1                                                  EVM01570
*              LOCATION OF LAST WORD+1 OF EXTRACTED CONTROL FIELD       EVM01580
       STA     CFWD,2         TO K TABLE ADDRESS                        EVM01590
       PAX     ,4                                                       EVM01600
       SXD     RCWD,4         TO DEC. OF EXTRACT CALLING SEQ. WORD      EVM01610
       PXD     ,1             FILE NUMBER                               EVM01620
       STD     CFWD,2           TO K TABLE DECREMENT                    EVM01630
       CALL    MERXTR         CALL EXTRACT ROUTINE                      EVM01640
       TXI     *+1,2,1                                                  EVM01650
 TIM   TXI     *+1,1,1                                                  EVM01660
VMR153 TXL     VMR154,1,**    ORDER OF MERGE (MORDER) IN DECREMENT.     EVM01670
       SPACE                                                            EVM01680
*      PRELIMARY SORT                                                   EVM01690
 MR155 TSX     SORTF,4        TO SORT K TABLE                           EVM01700
*      MOVE CONTROL FIELD TO AREA FOR NEXT SEQUENCE CHECK               EVM01710
MR100A LXA     NWDCF,1                                                  EVM01720
       CAL*    K1                                                       EVM01730
       SLW*    MRSC                                                     EVM01740
       TIX     *-2,1,1                                                  EVM01750
       SPACE                                                            EVM01760
FXSW01 TRA     MRDVWC         TRANSFER WHEN VARIABLE                    EVM01770
*      CLA     WRCT           REPLACES INST. AT FXSW01 WHEN FIXED       EVM01780
       ADD     ONE                                                      EVM01790
       TRA     MROPOT                                                   EVM01800
       SPACE                                                            EVM01810
*      DETERMINE WORD COUNT OF LOW (K1) RECORD (VARIABLE LENGTH ONLY)   EVM01820
MRDVWC AXC     **,4                                                     EVM01830
       LXD     K1,1                                                     EVM01840
       CAL     FLWD,1                                                   EVM01850
       STA     *+1                                                      EVM01860
       CAL     **,4           REC. WD. COUNT (BIN) OR CHAR. COUNT (BCD) EVM01870
 BCDSW PDX     ,1             INST. CHANGED,TO (TRA  BCDCV) WHEN BCD I/PEVM01880
       TXI     BUMP,1,1       INCREASE COUNT BY 1, WHEN BINARY I/P.     EVM01890
*      CONVERT BCD CHARACTER COUNT TO A BINARY WORD COUNT.              EVM01900
       ZET     MODPR-38                                                 EVM01910
       CALL    DMP04          CALL CE MOD.                              EVM01920
BCDCV  XCL                     CHARACTER COUNT IN MQ                    EVM01930
       PXD     ,0             CLEAR AC.                                 EVM01940
       CAQ     DTBT1,0,5      CONVERT BCD CHARACTER COUNT TO BINARY     EVM01950
       LRS     51             FROM AC (19) TO MQ (35).                  EVM01960
       DVP     SIX            CHANGE CHARACTER COUNT TO WORD COUNT.     EVM01970
       XCL                                                              EVM01980
       PAX     ,1             WORD COUNT OF BCD RECORD TO IR1.          EVM01990
 BUMP  TXI     *+1,1,**       INCREASE BY NO. OF OPTIONS (BOTH BIN./BCD)EVM02000
CM     NOP                                                              EVM02010
       PXA     ,1             SAVE TOTAL WORD COUNT                     EVM02020
       STO     NWTR             OF THIS RECORD.                         EVM02030
       ADD     MRNWRW         NO. WORDS ALREADY MERGED AND READY TO WR. EVM02040
MROPOT SUB     MAXOPB         MAX. O/P BLOCK SIZE,(WORDS/VAR.)(REC./FXD)EVM02050
       TMI     VMMK1          MAX. BLOCK SIZE WILL NOT BE EXCEEDED.     EVM02060
       TZE     VMMK1          MAX. BLOCK SIZE WILL NOT BE EXCEEDED.     EVM02070
       SPACE                                                            EVM02080
*      INCLUSION OF THIS RECORD WOULD EXCEED MAX. BLOCK LENGTH          EVM02090
VMFWR  NZT     WRIND          TEST FOR WRITE CHANNEL IN OPERATION.      EVM02100
       TRA     *+3            IN OPERATION.                             EVM02110
       TSX     MRWR,4         TO WRITE THE BLOCK.                       EVM02120
       TRA     VMMK1                                                    EVM02130
       NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       EVM02140
       TRA     VMFWR          IN OPERATION.                             EVM02150
       NZT     AACNT          NOT IN OPERATION-TEST FOR AVAILABLE AREA. EVM02160
       TRA     *+2            NO READ AREA AVAILABLE.                   EVM02170
       TSX     MRREAD,4       AREA AVAILABLE-READ A BLOCK.              EVM02180
       TSX     MRWR,4         TO WRITE THE BLOCK.                       EVM02190
       SPACE                                                            EVM02200
*      MOVE K1 RECORD TO WRITE TABLE                                    EVM02210
 VMMK1 LXD     K1,1           FILE NUMBER TO IR1.                       EVM02220
       CAL     FLWD,1                                                   EVM02230
       SPACE                                                            EVM02240
*      CHECKSUM OPTION SWITCH                                           EVM02250
MRCKSW TRA     VMR104                                                   EVM02260
*      TRA     FXCKS          REPLACES MRCKSW WHEN FIXED CHECKSUM       EVM02270
*      TRA     CKS            REPLACES MRCKSW WHEN VARIABLE CHECKSUM    EVM02280
       SPACE                                                            EVM02290
VMR104 LAC     WRCT,2                                                   EVM02300
       STA*    WRTB1          MOVE ADDRESS TO WRITE TABLE               EVM02310
       STA     LOC                                                      EVM02320
FXSW02 TRA     *+1            BECOMES TRA TO MR106 WHEN FIXED           EVM02330
       LXA     NWTR,4         MOVE NO. WORDS THIS RECORD                EVM02340
       PXD     ,4               TO                                      EVM02350
       STD*    WRTB1              WRITE TABLE.                          EVM02360
       SPACE                                                            EVM02370
 MR106 LXD     K1,1           FILE NO.                                  EVM02380
       CAL     FLWD,1                                                   EVM02390
       ADD     NWTR           RECORD LENGTH                             EVM02400
       SLW     FLWD,1         UPDATE FLWD WORD                          EVM02410
       PDX     ,2             AREA NO. TO IR2                           EVM02420
       CLA     ARWD,2                                                   EVM02430
       PAX     ,4                                                       EVM02440
       TXL     PHYL,4,0                                                 EVM02450
       TXI     *+1,4,-1                                                 EVM02460
 PHYL  PXA     ,4                                                       EVM02470
       STA     ARWD,2         UPDATE AREA WORD                          EVM02480
       TXH     MR26,4,0       TRANSFER IF AREA NOT EXHAUSTED            EVM02490
       CAL     *              AREA IS EXHAUSTED -                       EVM02500
       STP     ARWD,2           SET SIGN MINUS IN ARWD AND              EVM02510
       SLN     3                TURN ON SENSE LITE 3.                   EVM02520
*                                                                       EVM02530
 MR26  TRA     BETH                                                     EVM02540
       LDQ     TRA                                                      EVM02550
       SLQ     MR26                                                     EVM02560
       TRA     MR209                                                    EVM02570
 BETH  CLA     WRCT           UPDATE NUMBER OF RECORDS MERGED COUNT.    EVM02580
       ADD     ONE                                                      EVM02590
       STO     WRCT                                                     EVM02600
FXSW03 TRA     *+1            BECOMES TRA TO MR209 WHEN FIXED           EVM02610
       CLA     MRNWRW         UPDATE NO. WORDS MERGED COUNT             EVM02620
       ADD     NWTR                                                     EVM02630
       STO     MRNWRW                                                   EVM02640
*                                                                       EVM02650
 MR209 SLT     3              ON IF AREA EXHAUSTED                      EVM02660
       TRA     MR210A         NOT EXHAUSTED.                            EVM02670
       TRA     MR373          EXHAUSTED                                 EVM02680
*      TEST FOR POSSIBLE READ                                           EVM02690
MR210A NZT     RDIND                                                    EVM02700
       TRA     MR210                                                    EVM02710
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              EVM02720
       TRA     MR210                                                    EVM02730
       TSX     MRREAD,4       TO READ ROUTINE                           EVM02740
       TRA     MR210                                                    EVM02750
*      EXTRACT NEXT RECORD                                              EVM02760
MR210  LXD     K1,1           FILE NO. TO IR1                           EVM02770
       CLA     FLWD,1                                                   EVM02780
       STA     RCWD           ADDRESS OF RECORD                         EVM02790
       CLA     CFADR,1                                                  EVM02800
       PAX     ,1                                                       EVM02810
       SXD     RCWD,1         ADR. OF LAST WORD OF CF +1                EVM02820
       CALL    MERXTR         ENTER EXTRACT                             EVM02830
       EJECT                                                            EVM02840
MRGOMR LXA     MORD3,2        CURRENT INTERNAL MERGE ORDER TO IR2.      EVM02850
       TRA*    MRLOOP+16,2    GO TO PROPER MERGE COMPARE .              EVM02860
*      SEQUENCE CHECK THIS RECORD WITH PREVIOUS RECORD                  EVM02870
       ZET     MODPR-35        CE                                       EVM02880
       CALL    DMP01                                                    EVM02890
MR100  LXA     NWDCF,1                                                  EVM02900
MR100B CAL*    K1                                                       EVM02910
       LAS*    MRSC                                                     EVM02920
       TRA     MR100A         OK RECORD HIGH.                           EVM02930
       TRA     MR100C         EQUAL ON THIS WORD.                       EVM02940
       SLT     4              RECORD LOW TEST FOR NEW SEQUENCE.         EVM02950
       TRA     MRER2          GO TO OUT OF SEQUENCE ROUTINE.            EVM02960
       SLN     1              NEW SEQUENCE.                             EVM02970
       TRA     MR100A                                                   EVM02980
MR100C TIX     MR100B,1,1     TO COMPARE NEXT WORD.                     EVM02990
       NZT     MODPR-13       TEST FOR USER MOD.                        EVM03000
       TRA     FXSW01         NO MODIFICATION.                          EVM03010
SUMPOS NZT     WRCT           PREV. RECORD AVAIL. FOR SUMMARIZATION.    EVM03020
       TRA     FXSW01         NOT AVAIL. IT IS BEING WRITTEN            EVM03030
*      SUMMARIZATION POSSIBLE (RECORD IN WRTB1 IS NOT IN WRITE STATUS)  EVM03040
       LXD     K1,1                                                  (9)EVM03045
       CAL     FLWD,1                                                   EVM03050
       ZET     FXORVA                                                   EVM03060
       ACL     MRDVWC         VARIABLE.                                 EVM03070
       PAX     ,1                                                       EVM03080
       SXD     LOEQRC,1                                                 EVM03090
       NZT     FXORVA                                                   EVM03100
       TRA     BOT                                                      EVM03110
       CLA     SW                                                       EVM03120
       STO     CM                                                       EVM03130
       CLA     NWTR                                                     EVM03140
       STO     NWLR                                                     EVM03150
       TRA     MRDVWC                                                   EVM03160
BOR    SXA     NWTR,1                                                   EVM03170
       CLA     NOP                                                      EVM03180
       STO     CM                                                       EVM03190
BOT    LAC     WRCT,2                                                   EVM03200
       TXI     *+1,2,1                                                  EVM03210
       CLA*    WRTB1                                                    EVM03220
       ZET     FXORVA                                                   EVM03230
       ACL     MRDVWC         VARIABLE                                  EVM03240
       STA     LOEQRC                                                   EVM03250
       CAL     LOEQRC                                                   EVM03260
       STL     GENPR-4        SAVE LOCATION COUNTER FOR TRACING.        EVM03270
USRM4  CALL    MPM04          EXIT TO MODIFICATION PROGRAM.             EVM03280
       TRA     FXSW01         RETURN FROM MPM04 IF SUMM. NOT PERFORMED  EVM03290
       CLA     NRSUMM         RETURN FROM MPM04 IF SUMM. PERFORMED.     EVM03300
       ADD     ONE                                                      EVM03310
       STO     NRSUMM                                                   EVM03320
       LDQ     NOP                                                      EVM03330
       SLQ     MR26                                                     EVM03340
       TRA     MR106                                                    EVM03350
LOEQRC PZE     0                                                        EVM03360
NWLR   PZE                                                              EVM03370
SW     TRA     BOR                                                      EVM03380
       SPACE                                                            EVM03390
*      AREA IS EXHAUSTED                                                EVM03400
 MR373 LXD     K1,1           FILE NUMBER TO IR1.                       EVM03410
       SXA     MR374,1                                                  EVM03420
       CLA     MRBKC,1        REDUCE BLOCK COUNT                        EVM03430
       PDX     ,4               FOR THIS FILE                           EVM03440
       TXI     *+1,4,-1           IN READ                               EVM03450
       PXD     ,4                   CONTROL                             EVM03460
       STD     MRBKC,1                TABLE                             EVM03470
       NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       EVM03480
       TRA     *+4            IN OPERATION.                             EVM03490
       NZT     AACNT          TEST FOR READ AREA AVAILABLE.             EVM03500
       TRA     *+2            AREA NOT AVAIL.                           EVM03510
       TSX     MRREAD,4       READ A BLOCK.                             EVM03520
       LXA     MR374,1                                                  EVM03530
       CLA     RFWD1,1        TEST FOR RESERVE BLOCK FOR THIS FILE.     EVM03540
       TNZ     MR374A         BLOCK IN RESERVE FOR THIS FILE.           EVM03550
       CLA     EOFIND,1                                                 EVM03560
       TNZ     MREF3          EOF THIS FILE.                            EVM03570
MR374B NZT     WRIND          TEST FOR WRITE CHANNEL IN OPERATION.      EVM03580
       TRA     MR374C         IN OPERATION.                             EVM03590
       TSX     SMRTMA,4       MAKE ALL POSSIBLE AREAS AVAIL. FOR READ.  EVM03600
       NZT     AACNT          TEST FOR AVAILABLE READ AREA.             EVM03610
       TRA     MR374D         NO AREA AVAIL.                            EVM03620
       TSX     MRREAD,4       READ.                                     EVM03630
       TRA     MR374E                                                   EVM03640
MR374C NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       EVM03650
       TRA     MR374B         IN OPERATION.                             EVM03660
       NZT     AACNT          TEST FOR AVAIL. READ AREA.                EVM03670
       TRA     MR374B+2       NO AREA AVAIL.                            EVM03680
       TRA     MR374C-2       AREA AVAIL.                               EVM03690
MR374D LDQ     MRRSW2         READ ACCOMPLISHED ON                      EVM03700
       SLQ     *+1            LAST ENTRY TO                             EVM03710
       TRA     *+2            MRREAD ROUTINE.                           EVM03720
       TRA     MR375          NO.                                       EVM03730
       LDQ     NOP            YES-MAKE LAST BLOCK                       EVM03740
       SLQ     MRRSW4           READ AVAILABLE FOR                      EVM03750
       TRA     MR374C-2           MERGING.                              EVM03760
MR374E LXA     MR374,1                                                  EVM03770
       CLA     RFWD1,1                                                  EVM03780
       TZE     MR375                                                    EVM03790
MR374A TMI     ARS3                                                     EVM03800
 MR374 AXT     **,1                                                     EVM03810
       CLA     RFWD1,1                                                  EVM03820
       STO     FLWD,1                                                   EVM03830
       STZ     RFWD1,1                                                  EVM03840
       AXT     2,4                                                      EVM03850
MRTE   NZT*    RWD,4                                                    EVM03860
       TRA     MR210A                                                   EVM03870
       LDQ*    RWD,4                                                    EVM03880
       STZ*    RWD,4                                                    EVM03890
       STQ*    RWD+1,4                                                  EVM03900
       TXI     *+1,4,1                                                  EVM03910
       TXL     MRTE,4,3       TEST FOR ADDITIONAL RESERVE RECORDS.      EVM03920
       TRA     MR210A                                                   EVM03930
*                                                                       EVM03940
*     FILE EXHAUSTED                                                    EVM03950
 MR375 CLA     EOFIND,1                                                 EVM03960
       TNZ     MREF3          EOF THIS FILE                             EVM03970
       NZT     WRIND                                                    EVM03980
       TRA     MR375D         WRITE CHANNEL IS IN OPERATION.            EVM03990
       TSX     MRWR,4         TO WRITE                                  EVM04000
*                                                                       EVM04010
MR375S TRA     MR375B         SWITCH - NOP WHEN READ HAS BEEN STARTED.  EVM04020
       LDQ     TRA            RESET                                     EVM04030
       SLQ     MR375S           SWITCH.                                 EVM04040
       TRA     MR375A                                                   EVM04050
*                                                                       EVM04060
MR375B NZT     AACNT          TEST FOR READ AREA AVAILABLE.             EVM04070
       TRA     MR375C         NO READ AREA AVAILABLE                    EVM04080
       TSX     MRREAD,4       TO READ ROUTINE                           EVM04090
MR375A LXA     MR374,1                                                  EVM04100
       CLA     RFWD1,1                                                  EVM04110
       TZE     *+3            RECORDS NOT AVAIL. THIS FILE              EVM04120
       TMI     ARS3           SEQUENCE BREAK THIS FILE                  EVM04130
       TRA     MR374                                                    EVM04140
       CLA     EOFIND,1                                                 EVM04150
       TNZ     MREF3          EOF THIS FILE                             EVM04160
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              EVM04170
       TRA     MR375C         READ AREA NOT AVAILABLE                   EVM04180
       TRA     MR375A-1                                                 EVM04190
MR375D NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       EVM04200
       TRA     MR375+2        READ CHANNEL IN OPERATION                 EVM04210
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              EVM04220
       TRA     MR375S-1       NO READ AREA AVAILABLE                    EVM04230
       TSX     MRREAD,4       TO READ ROUTINE                           EVM04240
       LDQ     NOP            SET                                       EVM04250
       SLQ     MR375S           SWITCH                                  EVM04260
       TRA     MR375S-1                                                 EVM04270
*                                                                       EVM04280
MR375C TSX     SMRTMA,4       MAKE ALL POSSIBLE READ AREAS AVAIL.       EVM04290
*                                                                       EVM04300
MR376A NZT     AACNT          TEST FOR READ AREA AVAILABLE              EVM04310
       TRA     MR377          NO READ AREA AVAILABLE                    EVM04320
       TSX     MRREAD,4       TO READ ROUTINE                           EVM04330
       LXA     MR374,1                                                  EVM04340
       CLA     RFWD1,1                                                  EVM04350
       TZE     *+2                                                      EVM04360
       TRA     MR375A+3       RECORDS NOW AVAIL. THIS FILE              EVM04370
       CLA     EOFIND,1                                                 EVM04380
       TNZ     MREF3          EOF THIS FILE                             EVM04390
       TRA     MR376A                                                   EVM04400
*                                                                       EVM04410
MR377  LDQ     MRRSW2         READ ACCOMPLISHED ON                      EVM04420
       SLQ     *+1              LAST ENTRY TO                           EVM04430
       TRA     *+2                MRREAD ROUTINE.                       EVM04440
       TRA     MR377A         NO.                                       EVM04450
       LDQ     NOP            YES-SET SWITCH IN READ ROUTINE            EVM04460
       SLQ     MRRSW4           TO BYPASS ACTUAL READ                   EVM04470
*                             SIMULATE A READ TO MAKE LAST BLOCK        EVM04480
       TSX     MRREAD,4         READ AVAILABLE FOR MERGE                EVM04490
*                                                                       EVM04500
MR377A LXA     MR374,1                                                  EVM04510
       CLA     RFWD1,1                                                  EVM04520
       TZE     *+2                                                      EVM04530
       TRA     MR375A+3                                                 EVM04540
       CLA     EOFIND,1                                                 EVM04550
       TNZ     MREF3          EOF THIS FILE                             EVM04560
       TSX     MSGSUP,4,2                                               EVM04570
       PZE     4                                                        EVM04580
       PZE     AMS09,,5+512*4                                           EVM04590
       PZE     VMSG03,,6                                                EVM04600
       PZE     VMSG04,,6                                                EVM04610
       PZE     VMSG05,6+512*4                                           EVM04620
       TSX     (PAUSE,4                                                 EVM04630
       SWT     4                                                        EVM04640
       TRA     DELET                                                    EVM04650
       CALL    RESTAR                                                   EVM04660
ARS3   BSS     0              NEW BLOCK IS EITHER NEW SEQUENCE          EVM04670
       LXA     MR374,1                                                  EVM04680
       STZ     FLWD,1         OR EOF                                    EVM04690
       LXA     MORD3,4                                                  EVM04700
       TXL     MR378,4,1      TEST FOR ALL FILES AT NEW SEQUENCE        EVM04710
       TIX     *+1,4,1        REDUCE MORD3 BY ONE                       EVM04720
       SXA     MORD3,4                                                  EVM04730
       CAL     CFWD-1,4       MOVE DOWN CFWDS                           EVM04740
       LDQ     CFWD,4                                                   EVM04750
       XCL                                                              EVM04760
       STQ     CFWD,4                                                   EVM04770
       TIX     *-3,4,1                                                  EVM04780
       TRA     MR100                                                    EVM04790
       SPACE                                                            EVM04800
*      ALL FILES AT NEW SEQUENCE LEVEL                                  EVM04810
 MR378 LXA     MORDER,4                                                 EVM04820
       CLA     MRBKC,4                                                  EVM04830
       SSP                                                              EVM04840
       STO     MRBKC,4                                                  EVM04850
       TIX     *-3,4,1                                                  EVM04860
       CLA     WRCT                                                     EVM04870
       TZE     NSEQ             NO RECORDS REMAINING TO BE WRITTEN      EVM04880
       TSX     MRWR,4           TO WRITE REMAINING RECORDS THIS SEQ     EVM04890
 NSEQ  LXA     MORD2,4        NUMBER OF FILES LEFT TO BE MERGED         EVM04900
       SXA     MORD3,4          TO CURRENT MERGE ORDER.                 EVM04910
       SXD     MR253,4                                                  EVM04920
       SLN     4                                                        EVM04930
       LXA     MORDER,4                                                 EVM04940
 CHRIS LDQ     RFWD1,4        MOVE RFWD1 INTO FLWD.                     EVM04950
       STQ     FLWD,4                                                   EVM04960
       CAL     RFWD2,4        MOVE RFWD2 INTO RFWD1                     EVM04970
       SLW     RFWD1,4                                                  EVM04980
       CAL     RFWD3,4        MOVE RFWD3 INTO RFWD2                     EVM04990
       SLW     RFWD2,4                                                  EVM05000
       STZ     RFWD3,4        ZERO OUT RFWD3                            EVM05010
       TIX     CHRIS,4,1                                                EVM05020
*                                                                       EVM05030
*      EXTRACT CONTROL FIELDS                                           EVM05040
       AXT     1,1                                                      EVM05050
       AXT     1,2                                                      EVM05060
 MR254 CLA     FLWD,1         LOCATION OF FIRST WORD OF RECORD          EVM05070
       TNZ     MARY                                                     EVM05080
       TXI     *-2,1,1                                                  EVM05090
 MARY  STA     RCWD                                                     EVM05100
       CLA     CFADR,1                                                  EVM05110
       STA     CFWD,2                                                   EVM05120
       PAX     ,4                                                       EVM05130
       SXD     RCWD,4                                                   EVM05140
       PXD     ,1             FILE NUMBER                               EVM05150
       STD     CFWD,2           TO DECREMENT OF K TABLE                 EVM05160
       CALL    MERXTR         ENTER EXTRACT ROUTINE                     EVM05170
       TXI     *+1,2,1                                                  EVM05180
 MR253 TXL     MR254+2,2,**   MORD3 IN DECREMENT.                       EVM05190
*                                                                       EVM05200
*      PRELIMARY SORT                                                   EVM05210
       TSX     SORTF,4        SORT K TABLE                              EVM05220
       TRA     MR100                                                    EVM05230
       EJECT                                                            EVM05240
*************************                                               EVM05250
*  MERGE WRITE ROUTINE  *                                               EVM05260
*************************                                               EVM05270
       SPACE                                                            EVM05280
 MRWR  BSS     0                                                        EVM05290
       SXA     WRRET,4        SAVE IR4 FOR RETURN                       EVM05300
       SPACE                                                            EVM05310
*      UPDATE STATUS OF RECORD STORAGE AREAS BY CHANGING -(ARWD) WORDS  EVM05320
*      TO -1 AND -1 WORDS TO ZERO                                       EVM05330
       LXA     CNT6,1         NO. OF AREAS TO IR1                       EVM05340
       CLA     ARWD,1                                                   EVM05350
       TMI     WR1A                                                     EVM05360
 WR1   TIX     *-2,1,1                                                  EVM05370
       TRA     WRWAIT                                                   EVM05380
 WR1A  ALS     2              TEST FOR -1                               EVM05390
       PBT                                                              EVM05400
       TRA     WR2                                                      EVM05410
       STZ     ARWD,1         SET -1 TO ZERO                            EVM05420
       CLA     AACNT                                                    EVM05430
       ADD     ONE                                                      EVM05440
       STO     AACNT                                                    EVM05450
       TRA     WR1                                                      EVM05460
 WR2   CAL     WRK            SET -ARWD TO -1                           EVM05470
       STP     ARWD,1                                                   EVM05480
       TRA     WR1                                                      EVM05490
       SPACE                                                            EVM05500
WRWAIT NZT     WRIND          WAIT FOR COMPLETION OF                    EVM05510
       TRA     *-1              PREVIOUS WRITE.                         EVM05520
       SPACE                                                            EVM05530
 WR3   ZET     WRIND1         TEST FOR END OF TAPE                      EVM05540
       TRA     UP             END OF TAPE.                              EVM05550
*                                                                       EVM05560
       CLA     WRCT           NO. RECORDS IN OUPUT BLOCK.               EVM05570
FXSW07 TRA     WR6            TRANSFER IF VARIABLE.                     EVM05580
*      XCL                    REPLACES INST. AT FXSW07 WHEN FIXED       EVM05590
       MPY     NWTR           CONVERT RECORDS                           EVM05600
       XCL                      TO WORDS.                               EVM05610
 WR6   STA     CNT11          NO. WORDS IF FIXED/NO. RECORDS IF VAR     EVM05620
       SPACE                                                            EVM05630
       LXA     MRT3,1         SELECT FILE FOR WRITE                     EVM05640
       SLT     1              TEST WHETHER NEW SEQUENCE                 EVM05650
       TRA     WR5            OLD SEQUENCE                              EVM05660
*      NEW SEQUENCE                                                     EVM05670
       CLA     CNT5           UPDATE NO. OF SEQ. WRITTEN COUNT          EVM05680
       ADD     ONE                                                      EVM05690
       STO     CNT5                                                     EVM05700
       LXA     MROSBI,4       UPDATE OUTPUT                             EVM05710
       TXI     *+1,4,1          SEQUENCE                                EVM05720
       SXA     MROSBI,4           INDICATOR                             EVM05730
       SXD     CNT11,4        STORE SEQ. BREAK IND. IN DEC. OF CNT11    EVM05740
       TXI     *+1,1,1        INCREASE OUTPUT FILE NO. BY 1             EVM05750
WR15   TXH     WR4,1,**       CURRENT NO. OF OUTPUT FILES IN DECREMENT. EVM05760
       SXA     MRT3,1         SAVE PRESENT WRITE FILE                   EVM05770
       TRA     WR5                                                      EVM05780
       SPACE                                                            EVM05790
 WR4   AXT     1,1            REINITIALIZE WRITE FILE TO 1              EVM05800
       SXA     MRT3,1           AND SAVE IN MRT3                        EVM05810
*      INITIALIZE WRITE CALLING SEQUENCE WORDS                          EVM05820
 WR5   CLS     ONE                                                      EVM05830
       STO     RWCS                                                     EVM05840
       CLA     FLNO,1                                                   EVM05850
       PAX     0,1                                                      EVM05860
       SXD     RWCS,1                                                   EVM05870
       CLA     WRTB1                                                    EVM05880
       STA     RWCS1                                                    EVM05890
       LXA     WRCT,1                                                   EVM05900
       SXD     RWCS1,1                                                  EVM05910
       STL     GENPR-4                                                  EVM05920
       ZET     MODPR-36       CE                                        EVM05930
       CALL    DMP02                                                    EVM05940
       CALL    MRGIO                                                    EVM05950
*      UPDATE TOTAL RECORDS WRITTEN COUNT                               EVM05960
       CLA     CNTW                                                     EVM05970
       ADD     WRCT                                                     EVM05980
       STO     CNTW                                                     EVM05990
*      RESET NO. RECORDS WRITTEN THIS BLOCK COUNTER                     EVM06000
       STZ     WRCT                                                     EVM06010
*      RESET NO. WORDS READY TO WRITE COUNTER                           EVM06020
       STZ     MRNWRW                                                   EVM06030
*      INTERCHANGE WRITE TABLES                                         EVM06040
       LDQ     WRTB1                                                    EVM06050
       CAL     WRTB2                                                    EVM06060
       SLW     WRTB1                                                    EVM06070
       STQ     WRTB2                                                    EVM06080
       SPACE                                                            EVM06090
 WRRET AXT     **,4           RESTORE IR4                               EVM06100
       TRA     1,4              AND EXIT FROM WRITE                     EVM06110
*      MAKE AREAS THAT HAVE BEEN WRITTEN AVAILABLE FOR READING (BY      EVM06120
*        CHANGING -1(ARWD) WORDS TO ZERO).                              EVM06130
SMRTMA LXA     CNT6,1                                                   EVM06140
       CLA     ARWD,1                                                   EVM06150
       TMI     TMONE                                                    EVM06160
SMTNA  TIX     *-2,1,1                                                  EVM06170
       NZT     WRIND          WAIT FOR COMPLETION OF LAST WRITE         EVM06180
       TRA     *-1                                                      EVM06190
       TRA     1,4            RETURN.                                   EVM06200
TMONE  ALS     2                                                        EVM06210
       PBT                                                              EVM06220
       TRA     SMTNA                                                    EVM06230
       STZ     ARWD,1                                                   EVM06240
       CLA     AACNT                                                    EVM06250
       ADD     ONE                                                      EVM06260
       STO     AACNT                                                    EVM06270
       TRA     SMTNA                                                    EVM06280
       SPACE                                                            EVM06290
       EJECT                                                            EVM06300
************************                                               EEVM06310
*  MERGE READ ROUTINE  *                                                EVM06320
************************                                               EEVM06330
       SPACE                                                            EVM06340
MRREAD SXA     MRSWR,4                                                  EVM06350
       SPACE                                                            EVM06360
MRRSW1 TRA     *+2           SWITCH WILL BE NOP WHEN                    EVM06370
       TRA     1,4             ALL FILES ARE AT EOF                     EVM06380
       ZET     RAWPR-11        CHECK LAST READ IS GOOD READ             EVM06390
       TSX     RAWPR-11,4      IT IS BAD ONE                            EVM06400
       NZT     RDIND           IT IS GOOD READ                          EVM06410
       TRA     *-3                                                      EVM06420
MRRSW2 TRA     MRRSW3        SWITCH WILL BE NOP WHEN READ WAS NOT       EVM06430
       LDQ     TRA             ACCOMPLISHED ON LAST ENTRY               EVM06440
       SLQ     MRRSW2                                                   EVM06450
       TRA     MRRDSL                                                   EVM06460
       SPACE                                                            EVM06470
MRRSW3 NOP     MREOFT         SWITCH WILL BE SET TO TRA AFTER           EVM06480
       TRA     MRRDSL         INITIAL READ COMPLETED ON EACH FILE       EVM06490
       SPACE                                                            EVM06500
MREOFT ZET     RDIND1         TEST FOR END OF FILE ON LAST READ         EVM06510
       TRA     MREF2         TO SET END OF FILE INDICATOR               EVM06520
       CLA     MRT1                                                     EVM06530
       LDQ     MRT2                                                     EVM06540
       STO     MRT2                                                     EVM06550
       STQ     MRT1                                                     EVM06560
       SPACE                                                            EVM06570
       LXD     MRT1,2         AREA NO. OF LAST READ TO IR2              EVM06580
       LXA     MRT1,1         FILE NO. OF LAST READ TO IR1              EVM06590
       AXT     1,4                                                      EVM06600
       CAL*    ADDR,2         NO. WORDS IN BLOCK FIXED/NO. RECORDS VAR. EVM06610
FXSW05 TRA     MRRFV          TRANSFER IF VARIABLE.                     EVM06620
*      PAX     ,4             REPLACES INST. AT FXSW05 WHEN FIXED.      EVM06630
       PXA     ,4             CONVERT                                   EVM06640
       LRS     35               WORD COUNT                              EVM06650
       DVP     NWTR               TO                                    EVM06660
       XCL                          RECORD COUNT                        EVM06670
MRRFV  STA     CNT9           SAVE NO. RECORDS READ THIS BLOCK.         EVM06680
       STA     ARWD,2         SET UP                                    EVM06690
       ALS     18               AREA                                    EVM06700
       STD     ARWD,2             WORD                                  EVM06710
       CLA     CNTR           UPDATE TOTAL NO.                          EVM06720
       ADD     CNT9             RECORDS READ                            EVM06730
       STO     CNTR               COUNTER                               EVM06740
       SPACE                                                            EVM06750
*      SET UP RESERVE FILE WORD                                         EVM06760
       AXT     1,4                                                      EVM06770
       CAL*    ADDR,2         CHECK FOR SEQUENCE BREAK                  EVM06780
       ANA     MSK1                                                     EVM06790
       LAS     MRIBSC,1       COMPARE WITH PREV. SEQ. LEVEL THIS FILE.  EVM06800
       TRA     *+2                                                      EVM06810
       TRA     MRSTN1-1       SAME SEQUENCE                             EVM06820
       LDQ     NOP            SET SWITCH TO INDICATE SEQUENCE BREAK     EVM06830
       SLQ     MRSBSW                                                   EVM06840
       STD     MRIBSC,1       REINITIALIZE SEQ. BREAK NO. FOR THIS FILE.EVM06850
       CLA     MRBKC,1        SET SELECT CONTROL WORD                   EVM06860
       SSM                      TABLE MINUS FOR                         EVM06870
       STO     MRBKC,1            THIS FILE                             EVM06880
       CLA     ADDR,2         LOCATION OF FIRST RECORD THIS AREA TO AC  EVM06890
MRSTN1 ZET*    RWD,4          TEST FOR AVAILABLE RESERVE WORD THIS FILE EVM06900
       TXI     *-1,4,1                                                  EVM06910
       STA*    RWD,4          LOCATION OF 1ST. RECORD TO ADR. RES. WORD EVM06920
       PXD     ,2             AREA NUMBER TO DECREMENT.                 EVM06930
       STD*    RWD,4            OF RESERVE WORD                         EVM06940
MRSBSW TRA     MRRSW4         SWITCH NOP WHEN SEQUENCE BREAK            EVM06950
       LDQ     TRA            RESET                                     EVM06960
       SLQ     MRSBSW           SWITCH                                  EVM06970
       CLS*    RWD,4          SET SIGN OF RESERVE WORD MINUS TO         EVM06980
       STO*    RWD,4            INDICATE BLOCK IS A NEW SEQUENCE        EVM06990
       TRA     MRRSW4                                                   EVM07000
       SPACE                                                            EVM07010
MRRSW4 TRA     MRRDSL        WILL BE NOP WHEN ROUTINE                   EVM07020
       LDQ     TRA             HAS BEEN ENTERED                         EVM07030
       SLQ     MRRSW4             FOR A SIMULATED READ                  EVM07040
SISW2  LDQ     NOP            SET SW. TO BYPASS MOVING RESERVE TABLE.   EVM07050
       SLQ     MRRSW2           TO CURRENT TABLE ON NEXT READ ENTRY     EVM07060
       TRA     MRSWR          TO EXIT WITHOUT A READ                    EVM07070
       SPACE                                                            EVM07080
*      SELECT  FILE FOR NEXT READ                                       EVM07090
MRRDSL AXT     2,2                                                      EVM07100
       LXA     MORDER,1                                                 EVM07110
       TXI     *+1,1,-1                                                 EVM07120
       CLA     MRBKC-1                                                  EVM07130
       TPL     *+3                                                      EVM07140
       SSP                                                              EVM07150
       ADD     ONEHI                                                    EVM07160
MRRSLA LDQ     MRBKC,2                                                  EVM07170
       TQP     *+5                                                      EVM07180
       XCA                                                              EVM07190
       SSP                                                              EVM07200
       ADD     ONEHI                                                    EVM07210
       XCA                                                              EVM07220
       TLQ     *+4                                                      EVM07230
BERNIC TIX     *+2,1,1                                                  EVM07240
       TRA     MRRSLB        LOW FILE IN AC                             EVM07250
       TXI     MRRSLA,2,1                                               EVM07260
       XCA                                                              EVM07270
       TRA     BERNIC                                                   EVM07280
       SPACE                                                            EVM07290
*      SET UP  READ CALLING SEQUENCE WORDS                              EVM07300
MRRSLB PAX     ,1             NO. OF FILE TO BE READ                    EVM07310
       ZET     RFWD3,1        TEST FOR 3 BLOCKS IN RESERVE FOR THIS FILEEVM07320
       TRA     RNAA           THREE BLOCKS IN RESERVE - BYPASS READ.    EVM07330
       SPACE                                                            EVM07340
 VMRNN CLA     ONE            SETUP I/O                                 EVM07350
       STO     RWCS             CALLING SEQUENCE                        EVM07360
       SXD     RWCS,1             WORD 1.                               EVM07370
       SXA     MRT2,1         SAVE FILE NO. OF THIS READ                EVM07380
       SPACE                                                            EVM07390
 MRN48 AXT     1,1          SELECT AREA NO                              EVM07400
       NZT     ARWD,1                                                   EVM07410
       TRA     MRN49A                                                   EVM07420
       TXI     *+1,1,1                                                  EVM07430
MRN49  TXL     *-3,1,         NO. OF MERGE AREAS IN DECREMENT           EVM07440
       TRA     RNAA           NO AREAS CURRENTLY AVAIL. - BYPASS READ.  EVM07450
MRN49A CLA     ADDR,1                                                   EVM07460
       STA     RWCS1                                                    EVM07470
       SXD     MRT2,1         SAVE AREA NO. OF PRESENT READ             EVM07480
*      UPDATE BLOCK COUNT FOR THIS FILE IN CONTROL TABLE                EVM07490
       LXA     MRT2,1                                                   EVM07500
       CAL     ONED                                                     EVM07510
       ACL     MRBKC,1                                                  EVM07520
       SLW     MRBKC,1                                                  EVM07530
       STL     GENPR-4                                                  EVM07540
       CALL    MRGIO                                                    EVM07550
       ZET     MODPR-37       CE                                        EVM07560
       CALL    DMP03                                                    EVM07570
       SPACE                                                            EVM07580
       CLA     AACNT          REDUCE COUNT OF                           EVM07590
       SUB     ONE              NUMBER READ AREAS                       EVM07600
       STO     AACNT              AVAILABLE                             EVM07610
*                                                                       EVM07620
 MRSWR AXT     **,4           RESTORE IR4                               EVM07630
       TRA     1,4              AND EXIT FROM READ                      EVM07640
RNAA   CAL     MORD2          PRESENT INTERNAL ORDER OF MERGE.          EVM07650
       ALS     20             MULTIPLY BY 4 AND SHIFT TO DEC.           EVM07660
       STD     *+2                                                      EVM07670
       LXA     EFNAA,1        NO. AREAS AVAIL. FOR USE.                 EVM07680
       TXL     SISW2,1,**       DEC. = 4M = NO. OF USABLE AREAS.        EVM07690
       CLA     AACNT          REDUCE NO. AREAS CURRENTLY AVAIL. BY 1.   EVM07700
       TZE     SISW2                                                    EVM07710
       SUB     ONE                                                      EVM07720
       STO     AACNT                                                    EVM07730
       TXI     *+1,1,-1       REDUCE NO. AREAS AVAIL. FOR USE BY 1.     EVM07740
       SXA     EFNAA,1                                                  EVM07750
       TRA     SISW2                                                    EVM07760
*      END OF FILE ROUTINE                                              EVM07770
MREF2  STZ     RDIND1         RESET INDICATOR                           EVM07780
       CLA     AACNT          INCREASE COUNT OF                         EVM07790
       ADD     ONE              NUMBER READ AREAS                       EVM07800
       STO     AACNT              AVAILABLE                             EVM07810
*          SET EOF INDICATOR FOR THIS FILE                              EVM07820
       LXA     MRT2,1         FILE NO. OF LAST READ                     EVM07830
       CLA     *                                                        EVM07840
       STO     EOFIND,1       SET INDICATOR NON-ZERO                    EVM07850
*      SET SELECT CONTROL WORD HIGH FOR THIS FILE                       EVM07860
       AXT     28672,4                                                  EVM07870
       PXD     ,4                                                       EVM07880
       STD     MRBKC,1                                                  EVM07890
       LXA     MORDER,1       ORDER OF MERGE                            EVM07900
       NZT     EOFIND,1                                                 EVM07910
       TRA     MRRDSL         ALL FILES ARE NOT AT END OF FILE          EVM07920
       TIX     *-2,1,1                                                  EVM07930
*          ALL FILES ARE AT END OF FILE                                 EVM07940
       LDQ     NOP                                                      EVM07950
       SLQ     MRRSW1         SET SWITCH TO BYPASS READS                EVM07960
       LXA     MRSWR,4                                                  EVM07970
       TRA     1,4                                                      EVM07980
*                                                                       EVM07990
*      FILE AT EOF AND ALL RECORDS HAVE BEEN MERGED                     EVM08000
MREF3  LXA     MORD2,1                                                  EVM08010
       TXL     MREAM,1,1      TEST FOR END OF ALL FILES                 EVM08020
       TIX     *+1,1,1        REDUCE NO. FILES LEFT TO MERGE            EVM08030
       SXA     MORD2,1          BY ONE                                  EVM08040
       TRA     ARS3                                                     EVM08050
       SPACE                                                            EVM08060
*      END OF TAPE ACTION                                               EVM08070
 UP    STZ     WRIND1         RESET END OF TAPE INDICATOR.              EVM08080
       LXA     MORT,1         CURRENT NO. OF AVAIL. MERGE TAPES.        EVM08090
       TXL     MRER3,1,1      TRANSFER IF NO TAPE LEFT.                 EVM08100
       TXI     *+1,1,-1       REDUCE NO. OF AVAIL. MERGE TAPES          EVM08110
       SXA     MORT,1           AND SAVE AS CURRENT NO.                 EVM08120
       SXD     WR15,1                                                   EVM08130
       SXD     *+2,1                                                    EVM08140
       LXA     MRT3,1         FILE NO. OF PRESENT WRITE.                EVM08150
       TXH     ETP2,1,**      NO. OF REMAINING MERGE TAPES IN DEC.      EVM08160
       CAL     FLNO,1                                                   EVM08170
       LDQ     FLNO-1,1                                                 EVM08180
       STQ     FLNO,1                                                   EVM08190
       TXI     *+1,1,1                                                  EVM08200
 KAZOO TXL     *-3,1,**       MORT-1 IN DECREMENT.                      EVM08210
       SLW     FLNO,1                                                   EVM08220
       CLA     WRCT           NO. RECORDS IN OUPUT BLOCK.               EVM08230
FXSW06 TRA     MRSWOR         TRANSFER IF VARIABLE                      EVM08240
*      XCL                    REPLACES INST. AT FXSW06 WHEN FIXED       EVM08250
       MPY     NWTR           CONVERT RECORDS                           EVM08260
       XCL                      TO WORDS.                               EVM08270
MRSWOR STA     CNT11          NO. WORDS IF FIXED/NO. RECORDS IF VAR.    EVM08280
       CLA     CNT5           UPDATE NO. SEQ. WRITTEN COUNTS            EVM08290
       ADD     ONE                                                      EVM08300
       STO     CNT5                                                     EVM08310
       LXA     MROSBI,4       UPDATE OUTPUT                             EVM08320
       TXI     *+1,4,1          SEQUENCE                                EVM08330
       SXA     MROSBI,4           INDICATOR                             EVM08340
       SXD     CNT11,4        STORE SEQ. BREAK IND. IN DEC. OF CNT11    EVM08350
       LXA     MRT3,1                                                   EVM08360
       SLT     1                                                        EVM08370
       TRA     WR5                                                      EVM08380
       TRA     WR5                                                      EVM08390
 ETP2  SLN     1                                                        EVM08400
       TRA     WR3+2                                                    EVM08410
*                                                                       EVM08420
MREAM  ZET     WRCT           TEST FOR RECORDS TO BE WRITTEN            EVM08430
       TSX     MRWR,4         WRITE REMAINING RECORDS                   EVM08440
       STZ     WRIND1        REINITIALIZE EOT SWITCH                 (4)EVM08445
       TRA     MREND          TO END OF PASS ROUTINE                    EVM08450
       SPACE                                                            EVM08460
*      END OF MERGE PASS ROUTINE                                        EVM08470
       SPACE                                                            EVM08480
*      CLOSE INPUT FILES                                                EVM08490
MREND  ZET     RAW11                                                    EVM08500
       TSX     RAW11,4                                                  EVM08510
       NZT     RDIND                                                    EVM08520
       TRA     MREND                                                    EVM08530
       LXA     MORDER,2                                                 EVM08540
       STZ     RWCS                                                     EVM08550
       AXT     1,1                                                      EVM08560
       STL     GENPR-4                                                  EVM08570
       SXD     RWCS,1                                                   EVM08580
       CALL    SCL                                                      EVM08590
       TXI     *+1,1,1                                                  EVM08600
       TIX     *-3,2,1                                                  EVM08610
*      CLOSE OUTPUT FILES                                               EVM08620
       NZT     WRIND                                                    EVM08630
       TRA     *-1                                                      EVM08640
       LXA     MORDER,2                                                 EVM08650
       CLA     MZ                                                       EVM08660
       STO     RWCS                                                     EVM08670
       AXT     1,1                                                      EVM08680
       STL     GENPR-4                                                  EVM08690
       SXD     RWCS,1                                                   EVM08700
       CALL    SCL                                                      EVM08710
       TXI     *+1,1,1                                                  EVM08720
       TIX     *-3,2,1                                                  EVM08730
*                                                                       EVM08740
       CLA     PNBR           UPDATE PASS NUMBER                        EVM08750
       ADD     ONE                                                      EVM08760
       STO     PNBR                                                     EVM08770
       CAL     MRES1+2                                                  EVM08780
       ADD     ONE                                                      EVM08790
       SLW     MRES1+2                                                  EVM08800
*                                                                       EVM08810
       LDQ     CNTW           TABULATE AND PRINT RECORD COUNTS          EVM08820
       STL     GENPR-4                                                  EVM08830
       CALL    BTD                                                      EVM08840
       STO     MRES1+7                                                  EVM08850
       STQ     MRES1+8                                                  EVM08860
       STO     AMS14+2                                                  EVM08870
       STQ     AMS14+3                                                  EVM08880
       TSX     MSGSUP,4,4                                               EVM08890
       PZE     1                                                        EVM08900
       PZE     MRES1,,9                                                 EVM08910
       LDQ     MRD                                                      EVM08920
       STL     GENPR-4                                                  EVM08930
       CALL    BTD                                                      EVM08940
       STQ     MRES2+6                                                  EVM08950
       STO     AMS14+4                                                  EVM08960
       STQ     AMS14+5                                                  EVM08970
       NZT     MRD                                                      EVM08980
       TRA     *+4                                                      EVM08990
       TSX     MSGSUP,4,4                                               EVM09000
       PZE     1                                                        EVM09010
       PZE     MRES2,,7+512*4                                           EVM09020
*                                                                       EVM09030
       CLA     MRD            CHECK IF READ COUNTS ARE CORRECT          EVM09040
       ADD     CNTW                                                     EVM09050
       SUB     CNTR                                                     EVM09060
       TZE     MR705                                                    EVM09070
       ADD     NRSUMM                                                   EVM09080
       TZE     MR705                                                    EVM09090
       LDQ     CNTR                                                     EVM09100
       CALL    BTD                                                      EVM09110
       STO     AMS14                                                    EVM09120
       STQ     AMS14+1                                                  EVM09130
       TSX     MSGSUP,4,2                                               EVM09140
       PZE     3                                                        EVM09150
       PZE     AMS12,,11+512*4                                          EVM09160
       PZE     AMS13,,6                                                 EVM09170
       PZE     AMS14,,6+512*4                                           EVM09180
       TSX     VMSOMS,4                                                 EVM09190
       TSX     (PAUSE,4                                                 EVM09200
       TSX     VMROEP,4                                                 EVM09210
       TSX     VMWNOW,4                                                 EVM09220
       TRA     DELET                                                    EVM09230
       TRA     MR705                                                    EVM09240
MR705  NZT     NOCKPT                                                   EVM09250
       CALL    CKPT                                                     EVM09260
       SWT     2               TEST FOR INTERRUPT                       EVM09270
       TRA     MR706          NO                                        EVM09280
       TSX     MSGSUP,4,2    YES                                        EVM09290
       PZE     3                                                        EVM09300
       PZE     AMS15,,7+512*4                                           EVM09310
       PZE     AMS16,,12                                                EVM09320
       PZE     AMS17,,10+512*4                                          EVM09330
       TSX     (PAUSE,4                                                 EVM09340
       SWT     2                                                        EVM09350
       TRA     MR706                                                    EVM09360
       STL     ERAPR-18      SET DELETE SWITCH.                         EVM09370
       XEC     MRXR4                                                    EVM09380
       TRA     4,4                                                      EVM09390
MR706  CLA     CHIND         INTERCHANGE CHANNELS                       EVM09400
       LDQ     CHIND-1                                                  EVM09410
       STO     CHIND-1                                                  EVM09420
       STQ     CHIND                                                    EVM09430
*                                                                       EVM09440
       CLA     CNT5          GET COUNT OF STRINGS OUTPUT, AND           EVM09450
       STO     COMNT          SAVE FOR NEXT PHASE.                      EVM09460
       ZET     XTRMG          SEE IF ANY MERGE FILES                    EVM09470
       ADD     MRGS          ADD NO. OF EXTERNAL MERGE FILES.           EVM09480
       CAS     MORDER                                                   EVM09490
       TRA     VMR720         ANOTHER PASS REQUIRED                     EVM09500
       TRA     *+1                                                      EVM09510
       LAC     CHAPR-1,4     ADDRESS OF OUTPUT CHANNEL                  EVM09520
       SXD     *+2,4                                                    EVM09530
       LXA     CHAPR-3,4     ADDRESS OF INPUT CHANNEL                   EVM09540
       TXI     *+1,4,**                                                 EVM09550
       TXL     VMR720,4,0       TEST FOR ADDITIONAL PASS FOR OUTPUT     EVM09560
       TSX     MSGSUP,4,4                                               EVM09570
       PZE     1                                                        EVM09580
       PZE     MRES3,,5+512*4                                           EVM09590
       CLA     CNTW                                                     EVM09600
       STO     MRCT                                                     EVM09610
MRXR4  AXT     ,4                                                       EVM09620
       TRA     3,4                                                      EVM09630
*                                                                       EVM09640
VMR720 CLA     CNTW           STORE TOTAL NO. RECORDS WRITTEN COUNT     EVM09650
       STO     MRCT             IN PHASE 2 RECORD COUNT                 EVM09660
       SPACE                                                            EVM09670
*      INITIALIZE K TABLE                                               EVM09680
VMR721 LXA     MORDER,1                                                 EVM09690
       PXD     ,1                                                       EVM09700
       STD     CFWD,1                                                   EVM09710
       TIX     *-2,1,1                                                  EVM09720
*      ZERO NECESSARY AREAS                                             EVM09730
       AXT     RFWD3-CFADR,1                                            EVM09740
       STZ     RFWD3,1                                                  EVM09750
       TIX     *-1,1,1                                                  EVM09760
       AXT     WRCT-MORT,1                                              EVM09770
       STZ     WRCT+1,1                                                 EVM09780
       TIX     *-1,1,1                                                  EVM09790
       STZ     MRD                                                      EVM09800
       TRA     PASS                                                     EVM09810
       EJECT                                                            EVM09820
*  ROUTINE TO PUT CONTROL FIELD WORDS (K1,...,K16) INTO SORTED ORDER.   EVM09830
 SORTF SXA     SRTIX+1,4                                                EVM09840
       LXA     MORD3,4       DO AS MANY AS                              EVM09850
       TXI     *+1,4,-1       ORDER OF MERGE.                           EVM09860
       TXL     SRTIX+1,4,0                                              EVM09870
       LXA     NWDCF,1                                                  EVM09880
SRCAL  CAL*    K1,4                                                     EVM09890
SRLAS  LAS*    K1+1,4                                                   EVM09900
       TRA     SRTIX                                                    EVM09910
       TRA     SEQTX                                                    EVM09920
       TRA     SINTR                                                    EVM09930
SEQTX  TIX     SRCAL,1,1                                                EVM09940
       CAL*    SRCAL                                                    EVM09950
       LAS*    SRLAS                                                    EVM09960
       TRA     SRTIX                                                    EVM09970
       TRA     SRTIX                                                    EVM09980
SINTR  CAL*    SRCAL                                                    EVM09990
       LDQ*    SRLAS                                                    EVM10000
       SLW*    SRLAS                                                    EVM10010
       STQ*    SRCAL                                                    EVM10020
       TRA     SORTF+1                                                  EVM10030
SRTIX  TIX     SRCAL-1,4,1                                              EVM10040
       AXT     **,4                                                     EVM10050
       TRA     1,4                                                      EVM10060
       EJECT                                                            EVM10070
* TABLE FOR BCD CHARACTER COUNT CONVERSION                              EVM10080
DTBT1  DUP     1,10                                                     EVM10090
       VFD     20/**10000-DTBT1*10000,16/DTBT2                          EVM10100
DTBT2  DUP     1,10                                                     EVM10110
       VFD     20/**1000-DTBT2*1000,16/DTBT3                            EVM10120
DTBT3  DUP     1,10                                                     EVM10130
       VFD     20/**100-DTBT3*100,16/DTBT4                              EVM10140
DTBT4  DUP     1,10                                                     EVM10150
       VFD     20/**10-DTBT4*10,16/DTBT5                                EVM10160
DTBT5  DUP     1,10                                                     EVM10170
       VFD     20/**1-DTBT5*1                                           EVM10180
       EJECT                                                            EVM10190
*      VARIABLE LENGTH CHECKSUM ENTRY POINT                             EVM10200
 CKS   STA     CKSE           ADR. BECOMES CKSB WHEN NO EQUALS OPTION   EVM10210
       PAX     ,1             BECOMES TRA TO *+3 WHEN NO EQUALS OPTION  EVM10220
       TXI     *+1,1,1                                                  EVM10230
 CKSD  SXA     CKSB,1                                                   EVM10240
       ADD     NWTR                                                     EVM10250
       STA     CKSA                                                     EVM10260
       PXD     ,0             CLEAR AC                                  EVM10270
       LXA     NWTR,1         NO. WORDS THIS RECORD TO IR1.             EVM10280
       TXI     *+1,1,-1      ADR. BECOMES CKSA WHEN NO EQUALS OPTION    EVM10290
 CKSE  ACL     **                                                       EVM10300
       TXI     *+1,1,-1                                                 EVM10310
       SPACE                                                            EVM10320
 CKSA  ACL     **,1          COMPUTE CHECKSUM                           EVM10330
       TIX     *-1,1,1                                                  EVM10340
       ZET     MODPR-39       CE                                        EVM10350
       CALL    DMP05                                                    EVM10360
 CKSB  ERA     **             COMPARE WITH CHECKSUM WORD                EVM10370
       TNZ     CKSC          ERROR                                      EVM10380
       LXD     K1,1          CHECKSUM IS OK                             EVM10390
       CAL     FLWD,1                                                   EVM10400
       TRA     VMR104                                                   EVM10410
*                                                                       EVM10420
*      FIXED LENGTH CHECKSUM ENTRY POINT                                EVM10430
FXCKS  ADD     NWTR                                                     EVM10440
       SUB     ONE                                                      EVM10450
       STA     CKSA                                                     EVM10460
       STA     CKSB                                                     EVM10470
       LXA     NWTR,1                                                   EVM10480
       TXI     *+1,1,-1                                                 EVM10490
       PXD     ,                                                        EVM10500
       TRA     CKSA                                                     EVM10510
*                                                                       EVM10520
*      CHECKSUM ERROR ROUTINE                                           EVM10530
 CKSC  LXD     K1,1           FILE NO. OF RECORDS TO BE DROPPED         EVM10540
       CLA     FLWD,1         PICK UP ADR. OF RECORD                    EVM10550
FXSW08 TRA     ITSVR          BECOMES NOP WHEN FIXED                    EVM10560
       STA     ATDAR                                                    EVM10570
       TRA     WCARES                                                   EVM10580
ITSVR  PAX     ,1             INCREASE                                  EVM10590
       LXA     MRDVWC,4         ADDRESS                                 EVM10600
       SXD     *+1,4              OF RECORD                             EVM10610
       TXI     *+1,1,**             BY NUMBER                           EVM10620
       SXA     ATDAR,1                OPTION WORDS                      EVM10630
WCARES LXA     NWTR,1         NUMBER WORDS THIS RECORD                  EVM10640
       LAC     MRDVWC,4       REDUCE NO. WORDS                          EVM10650
       SXD     *+1,4            THIS RECORD BY                          EVM10660
       TXI     *+1,1,**             NUMBER OF                           EVM10670
       SXD     ATDAR,1                OPTION WORDS                      EVM10680
       TXI     *+1,1,-1                                                 EVM10710
       LXD     K1,1                                                     EVM10720
       CAL     FLWD,1                                                   EVM10730
       TSX     (DECVA,4                                                 EVM10740
       STQ     MRES6+4                                                  EVM10750
       TSX     MSGSUP,4,2                                               EVM10760
       PZE     1                                                     (5)EVM10761
       PZE     MRES6,,8+512*4                                           EVM10770
       CALL    DEBLK                                                 (2)EVM10772
       PZE     ATDAR-1,,2                                            (2)EVM10774
       TSX     (PAWSX,4                                                 EVM10780
       CLA     MRD                                                      EVM10790
       ADD     ONE                                                      EVM10800
       STO     MRD                                                      EVM10810
       CLA     WRCT                                                     EVM10820
       SUB     ONE                                                      EVM10830
       STO     WRCT                                                     EVM10840
       LXD     K1,1                                                     EVM10850
       CAL     FLWD,1                                                   EVM10860
       TRA     MR106          RETURN TO NEXT RECORD                     EVM10870
*                                                                       EVM10880
       EJECT                                                            EVM10890
*      OUT OF SORT RECORD ROUTINE                                       EVM10900
MRER2  LXD     K1,4                                                     EVM10910
       LDQ     FLWD,4       LOCATION OF RECORD OUT OF SORT              EVM10920
       LGL     18                                                       EVM10930
       TSX     (BCD5R,4                                                 EVM10940
       SLW     AMS20+4                                                  EVM10950
       LDQ     LOC                                                      EVM10960
       LGL     18                                                       EVM10970
       TSX     (BCD5R,4                                                 EVM10980
       SLW     AMS21+4                                                  EVM10990
       TSX     MSGSUP,4,2                                               EVM11000
       PZE     3                                                        EVM11010
       PZE     AMS19,,5+512*4                                           EVM11020
       PZE     AMS20,,5                                                 EVM11030
       PZE     AMS21,,5+512*4                                           EVM11040
       SXA     *+4,2                                                    EVM11050
       LXD     K1,2                                                     EVM11060
       TXI     *+1,2,-1                                                 EVM11070
       CLA*    CHAPR-3                                                  EVM11080
       AXT     **,2                                                     EVM11090
       STA     *+1                                                      EVM11100
       LDQ     **                                                       EVM11110
       TSX     MSGSUP,4,3                                               EVM11120
       PZE     AMS22,,8+512*4                                           EVM11130
       LXD     K1,4                                                     EVM11140
       CAL     FLWD,4                                                   EVM11150
       PDX     0,4                                                      EVM11160
       CLA     ADDR,4                                                   EVM11170
       SSP                                                              EVM11180
       SUB     TWO                                                      EVM11190
       STA     *+1                                                      EVM11200
       LDQ     **                                                       EVM11210
       LGL     18                                                       EVM11220
       TSX     (BCD5R,4                                                 EVM11230
       SLW     AMS23+5                                                  EVM11240
       TSX     MSGSUP,4,2                                               EVM11250
       PZE     1                                                        EVM11260
       PZE     AMS23,,6+512*4                                           EVM11270
       TSX     VMSOMS,4                                                 EVM11280
       TSX     (PAUSE,4                                                 EVM11290
       TSX     VMROEP,4                                                 EVM11300
       TSX     VMWNOW,4                                                 EVM11310
       TRA     DELET                                                    EVM11320
VMSOSR CLA     WRCT                                                     EVM11330
       TZE     *+2                                                      EVM11340
       TSX     MRWR,4                                                   EVM11350
       SLN     1                                                        EVM11360
       TRA     MR100A                                                   EVM11370
DELET  STL     ERAPR-18                                                 EVM11380
       XEC     MRXR4                                                    EVM11390
       TRA     4,4                                                      EVM11400
       SPACE                                                            EVM11410
*      ROUTINE TO PRINT OPTIONS                                         EVM11420
VMSOMS SXA     VMSOMR,4                                                 EVM11430
       TSX     MSGSUP,4,2                                               EVM11440
       PZE     4                                                        EVM11450
       PZE     VMSG03,,6                                                EVM11460
       PZE     VMSG04,,6                                                EVM11470
       PZE     VMSG05,,6                                                EVM11480
       PZE     VMSG06,,6+512*4                                          EVM11490
VMSOMR AXT     **,4                                                     EVM11500
       TRA     1,4                                                      EVM11510
*                                                                       EVM11520
MRER3  TSX     MSGSUP,4,2                                               EVM11530
       PZE     1                                                        EVM11540
       PZE     MRES13,,7+512*4                                          EVM11550
       TSX     VMSOMS,4                                                 EVM11560
       TSX     (PAUSE,4                                                 EVM11570
       TSX     VMROEP,4                                                 EVM11580
       TSX     VMWNOW,4                                                 EVM11590
       TRA     DELET                                                    EVM11600
*TEST  FOR MULTIPLE SETTING OF SS4,SS3                                  EVM11610
VMROEP SXA     VMRROG,4                                                 EVM11620
       AXT     0,4                                                      EVM11630
       AXT     4,1                                                      EVM11640
       SWT     4,1                                                      EVM11650
       TRA     *+2                                                      EVM11660
       TXI     *+1,4,1                                                  EVM11670
       TIX     *+1,1,1                                                  EVM11680
       TXH     *-4,1,2                                                  EVM11690
       TXL     VMRROG,4,1                                               EVM11700
       TSX     MSGSUP,4,2                                               EVM11710
       PZE     1                                                        EVM11720
       PZE     VMSG01,,9                                                EVM11730
       LXA     VMRROG,4                                                 EVM11740
       TRA     -1,4                                                     EVM11750
VMRROG AXT     **,4                                                     EVM11760
       TRA     1,4                                                      EVM11770
*                                                                       EVM11780
*      SELECT AN OPTION                                                 EVM11790
VMWNOW SWT     4                                                        EVM11800
       TRA     *+2                                                      EVM11810
       CALL    RESTAR                                                   EVM11820
       SWT     3                                                        EVM11830
       TRA     1,4                                                      EVM11840
       SXA     *+4,4                                                    EVM11850
       TSX     MSGSUP,4,2                                               EVM11860
       PZE     1                                                        EVM11870
       PZE     AMS25,,5+512*4                                           EVM11880
       AXT     **,4                                                     EVM11890
       TRA     2,4                                                      EVM11900
       EJECT                                                            EVM11910
       TITLE                                                            EVM11920
MRES1  BCI     9,MERGE PHASE PASS 0 COMPLETED. RECORD COUNT             EVM11930
MRES2  BCI     7,RECORDS WITH BAD CKSUMS THIS PASS                      EVM11940
MRES3  BCI     5,  MERGE PHASE COMPLETED                                EVM11950
MRES6  BCI     8,CKSUM ERROR, RECORD, LOC       *CS02                   EVM11960
VMSG03 BCI     6,**OPTIONS**             SS3  SS4                       EVM11970
VMSG04 BCI     6,TO DELETE SORT---------- UP   UP                       EVM11980
VMSG05 BCI     6,TO RETURN TO LAST CKPT-- UP   DN                       EVM11990
VMSG06 BCI     6,TO GO ON(IGNORE)-------- DN   UP                       EVM12000
AMS09  BCI     5,NO READ AREAS AVAILABLE * LE04                         EVM12010
AMS12  BCI     8,COUNTS OF RECORDS DO NOT AGREE.  THE COUNTS ARE        EVM12020
       BCI     3,AS FOLLOWS---*LE03                                     EVM12030
AMS13  BCI     6,   READS        WRITES        DUMPED                   EVM12040
AMS14  BCI     6,                                                       EVM12050
AMS15  BCI     7,SORT INTERRUPT REQUESTED  *RP01                        EVM12060
AMS16  BCI     8,      1.  LABEL AND SAVE ALL TAPES FOR A LATER R       EVM12070
       BCI     4,ESTART. THEN PRESS START                               EVM12080
AMS17  BCI     8,      2.  IF SORT IS TO CONTINUE--RESET SS2 AND        EVM12090
       BCI     2,PRESS START.                                           EVM12100
AMS18  BCI     3,                OR                                     EVM12110
AMS19  BCI     5,RECORD OUT OF SEQUENCE *SQ02                           EVM12120
AMS20  BCI     5,THIS RECORD IS AT LOC.                                 EVM12130
AMS21  BCI     5,LAST RECORD IS AT LOC.                                 EVM12140
AMS22  BCI     8, IS THE UNIT WHERE OUT-OF-SORT RECORD ORIGINATED       EVM12150
AMS23  BCI     6,IT IS IN TAPE RECORD NUMBER                            EVM12160
AMS24  BCI     9,ALL INPUT TAPES TO PHASE 2 ARE AT END OF FILE *MR04    EVM12170
AMS25  BCI     5,CONTINUED (IGNORED)                                    EVM12180
VMSG01 BCI     9,MORE THAN ONE SS ON--CLARIFY YOUR CHOICE AND START     EVM12190
MRES13 BCI     7,MERGE TAPES-TOO SHORT *MR05                            EVM12200
       DETAIL                                                           EVM12210
       EJECT                                                            EVM12220
* MERGE LOOP FOR ALL COMPARISONS, EITHER LOGICAL OR ALGEBRAIC,          EVM12230
*   ASCENDING OR DESCENDING SEQUENCE.                                   EVM12240
*                                                                       EVM12250
*                                                                       EVM12260
MRLOOP         C(9)           ORDER IS 16                               EVM12270
               C(9)                   15.                               EVM12280
               C(9)                   14.                               EVM12290
               C(9)                   13.                               EVM12300
               C(9)                   12.                               EVM12310
               C(9)                   11.                               EVM12320
               C(9)                   10.                               EVM12330
               C(9)                    9.                               EVM12340
               C(5)                    8.                               EVM12350
               C(5)                    7.                               EVM12360
               C(5)                    6.                               EVM12370
               C(5)                    5.                               EVM12380
               C(3)                    4.                               EVM12390
               C(3)                    3.                               EVM12400
               C(2)                    2.                               EVM12410
               MR100                    1  =  RUNOUT                    EVM12420
*      COMPARE K1 AND K2                                                EVM12430
C(2)   LXA     NWDCF,1                                                  EVM12440
CAL2   CAL*    K1                                                       EVM12450
       LAS*    K2                                                       EVM12460
       TRA     ((2)                                                     EVM12470
       TRA     TIX2                                                     EVM12480
       TRA     ((1)                                                     EVM12490
TIX2   TIX     CAL2,1,1                                                 EVM12500
       CAL     K1                                                       EVM12510
       LAS     K2                                                       EVM12520
       TRA     ((2)                                                     EVM12530
       TRA     ((1)                                                     EVM12540
       TRA     ((1)                                                     EVM12550
*      COMPARE K1 AND K3                                                EVM12560
C(3)   LXA     NWDCF,1                                                  EVM12570
CAL3   CAL*    K1                                                       EVM12580
       LAS*    K3                                                       EVM12590
       TRA     B3H                                                      EVM12600
       TRA     TIX3                                                     EVM12610
       TRA     C(2)                                                     EVM12620
TIX3   TIX     CAL3,1,1                                                 EVM12630
       CAL     K1                                                       EVM12640
       LAS     K3                                                       EVM12650
       TRA     B3H                                                      EVM12660
       TRA     C(2)                                                     EVM12670
       TRA     C(2)                                                     EVM12680
*      COMPARE K1 AND K4                                                EVM12690
C(4)   LXA     NWDCF,1                                                  EVM12700
CAL4   CAL*    K1                                                       EVM12710
       LAS*    K4                                                       EVM12720
       TRA     ((4)                                                     EVM12730
       TRA     TIX4                                                     EVM12740
       TRA     ((3)                                                     EVM12750
TIX4   TIX     CAL4,1,1                                                 EVM12760
       CAL     K1                                                       EVM12770
       LAS     K4                                                       EVM12780
       TRA     ((4)                                                     EVM12790
       TRA     ((3)                                                     EVM12800
       TRA     ((3)                                                     EVM12810
*      COMPARE K1 AND K5                                                EVM12820
C(5)   LXA     NWDCF,1                                                  EVM12830
CAL5   CAL*    K1                                                       EVM12840
       LAS*    K5                                                       EVM12850
       TRA     B5H                                                      EVM12860
       TRA     TIX5                                                     EVM12870
       TRA     C(3)                                                     EVM12880
TIX5   TIX     CAL5,1,1                                                 EVM12890
       CAL     K1                                                       EVM12900
       LAS     K5                                                       EVM12910
       TRA     B5H                                                      EVM12920
       TRA     C(3)                                                     EVM12930
       TRA     C(3)                                                     EVM12940
*      COMPARE K1 AND K6                                                EVM12950
C(6)   LXA     NWDCF,1                                                  EVM12960
CAL6   CAL*    K1                                                       EVM12970
       LAS*    K6                                                       EVM12980
       TRA     ((6)                                                     EVM12990
       TRA     TIX6                                                     EVM13000
       TRA     ((5)                                                     EVM13010
TIX6   TIX     CAL6,1,1                                                 EVM13020
       CAL     K1                                                       EVM13030
       LAS     K6                                                       EVM13040
       TRA     ((6)                                                     EVM13050
       TRA     ((5)                                                     EVM13060
       TRA     ((5)                                                     EVM13070
*      COMPARE K1 AND K7                                                EVM13080
C(7)   LXA     NWDCF,1                                                  EVM13090
CAL7   CAL*    K1                                                       EVM13100
       LAS*    K7                                                       EVM13110
       TRA     B7H                                                      EVM13120
       TRA     TIX7                                                     EVM13130
       TRA     C(6)                                                     EVM13140
TIX7   TIX     CAL7,1,1                                                 EVM13150
       CAL     K1                                                       EVM13160
       LAS     K7                                                       EVM13170
       TRA     B7H                                                      EVM13180
       TRA     C(6)                                                     EVM13190
       TRA     C(6)                                                     EVM13200
*      COMPARE K1 AND K8                                                EVM13210
C(8)   LXA     NWDCF,1                                                  EVM13220
CAL8   CAL*    K1                                                       EVM13230
       LAS*    K8                                                       EVM13240
       TRA     ((8)                                                     EVM13250
       TRA     TIX8                                                     EVM13260
       TRA     ((7)                                                     EVM13270
TIX8   TIX     CAL8,1,1                                                 EVM13280
       CAL     K1                                                       EVM13290
       LAS     K8                                                       EVM13300
       TRA     ((8)                                                     EVM13310
       TRA     ((7)                                                     EVM13320
       TRA     ((7)                                                     EVM13330
*      COMPARE K1 AND K9                                                EVM13340
C(9)   LXA     NWDCF,1                                                  EVM13350
CAL9   CAL*    K1                                                       EVM13360
       LAS*    K9                                                       EVM13370
       TRA*    B9HI+9,2                                                 EVM13380
       TRA     TIX9                                                     EVM13390
       TRA     C(5)                                                     EVM13400
TIX9   TIX     CAL9,1,1                                                 EVM13410
       CAL     K1                                                       EVM13420
       LAS     K9                                                       EVM13430
       TRA*    B9HI+9,2                                                 EVM13440
       TRA     C(5)                                                     EVM13450
       TRA     C(5)                                                     EVM13460
*      COMPARE K1 AND K10                                               EVM13470
C(10)  LXA     NWDCF,1                                                  EVM13480
CAL10  CAL*    K1                                                       EVM13490
       LAS*    K10                                                      EVM13500
       TRA     ((10)                                                    EVM13510
       TRA     TIX10                                                    EVM13520
       TRA     ((9)                                                     EVM13530
TIX10  TIX     CAL10,1,1                                                EVM13540
       CAL     K1                                                       EVM13550
       LAS     K10                                                      EVM13560
       TRA     ((10)                                                    EVM13570
       TRA     ((9)                                                     EVM13580
       TRA     ((9)                                                     EVM13590
*      COMPARE K1 AND K11                                               EVM13600
C(11)  LXA     NWDCF,1                                                  EVM13610
CAL11  CAL*    K1                                                       EVM13620
       LAS*    K11                                                      EVM13630
       TRA     B11H                                                     EVM13640
       TRA     TIX11                                                    EVM13650
       TRA     C(10)                                                    EVM13660
TIX11  TIX     CAL11,1,1                                                EVM13670
       CAL     K1                                                       EVM13680
       LAS     K11                                                      EVM13690
       TRA     B11H                                                     EVM13700
       TRA     C(10)                                                    EVM13710
       TRA     C(10)                                                    EVM13720
*      COMPARE K1 AND K12                                               EVM13730
C(12)  LXA     NWDCF,1                                                  EVM13740
CAL12  CAL*    K1                                                       EVM13750
       LAS*    K12                                                      EVM13760
       TRA     ((12)                                                    EVM13770
       TRA     TIX12                                                    EVM13780
       TRA     ((11)                                                    EVM13790
TIX12  TIX     CAL12,1,1                                                EVM13800
       CAL     K1                                                       EVM13810
       LAS     K12                                                      EVM13820
       TRA     ((12)                                                    EVM13830
       TRA     ((11)                                                    EVM13840
       TRA     ((11)                                                    EVM13850
*      COMPARE K1 AND K13                                               EVM13860
C(13)  LXA     NWDCF,1                                                  EVM13870
CAL13  CAL*    K1                                                       EVM13880
       LAS*    K13                                                      EVM13890
       TRA*    B13HI+13,2                                               EVM13900
       TRA     TIX13                                                    EVM13910
       TRA     C(11)                                                    EVM13920
TIX13  TIX     CAL13,1,1                                                EVM13930
       CAL     K1                                                       EVM13940
       LAS     K13                                                      EVM13950
       TRA*    B13HI+13,2                                               EVM13960
       TRA     C(11)                                                    EVM13970
       TRA     C(11)                                                    EVM13980
*      COMPARE K1 AND K14                                               EVM13990
C(14)  LXA     NWDCF,1                                                  EVM14000
CAL14  CAL*    K1                                                       EVM14010
       LAS*    K14                                                      EVM14020
       TRA     ((14)                                                    EVM14030
       TRA     TIX14                                                    EVM14040
       TRA     ((13)                                                    EVM14050
TIX14  TIX     CAL14,1,1                                                EVM14060
       CAL     K1                                                       EVM14070
       LAS     K14                                                      EVM14080
       TRA     ((14)                                                    EVM14090
       TRA     ((13)                                                    EVM14100
       TRA     ((13)                                                    EVM14110
*      COMPARE K1 AND K15                                               EVM14120
C(15)  LXA     NWDCF,1                                                  EVM14130
CAL15  CAL*    K1                                                       EVM14140
       LAS*    K15                                                      EVM14150
       TRA*    B15HI+15,2                                               EVM14160
       TRA     TIX15                                                    EVM14170
       TRA     C(14)                                                    EVM14180
TIX15  TIX     CAL15,1,1                                                EVM14190
       CAL     K1                                                       EVM14200
       LAS     K15                                                      EVM14210
       TRA*    B15HI+15,2                                               EVM14220
       TRA     C(14)                                                    EVM14230
       TRA     C(14)                                                    EVM14240
*      COMPARE K1 AND K16                                               EVM14250
C(16)  LXA     NWDCF,1                                                  EVM14260
CAL16  CAL*    K1                                                       EVM14270
       LAS*    K16                                                      EVM14280
       TRA     ((16)                                                    EVM14290
       TRA     TIX16                                                    EVM14300
       TRA     ((15)                                                    EVM14310
TIX16  TIX     CAL16,1,1                                                EVM14320
       CAL     K1                                                       EVM14330
       LAS     K16                                                      EVM14340
       TRA     ((16)                                                    EVM14350
       TRA     ((15)                                                    EVM14360
       TRA     ((15)                                                    EVM14370
*  TRANSFERS FROM 3RD ENTRY COMPARE.                                    EVM14380
B3H    TXL     ((3),2,3      IF MERGE ORDER IS 3, WE ARE DONE.          EVM14390
       TRA     C(4)          GREATER THAN 3.  COMPARE 4TH ENTRY.        EVM14400
*  TRANSFERS FROM 5TH ENTRY COMPARE.                                    EVM14410
B5H    TXH     C(7),2,7      COMPARE 7TH ENTRY IF MERGE ORDER 8 OR MORE.EVM14420
       XEC     B5HI+5,2      MERGE ORDER LESS THAN 8.                   EVM14430
       TRA     C(7)           ORDER IS 7. COMPARE 7TH ENTRY.            EVM14440
       TRA     C(6)          ORDER IS 6.  COMPARE 6TH ENTRY.            EVM14450
B5HI   TRA     ((5)          ORDER IS 5.  FINISHED.                     EVM14460
*  TRANSFERS FROM 7TH ENTRY COMPARE.                                    EVM14470
B7H    TXL     ((7),2,7      DONE IF ORDER IS 7.                        EVM14480
       TRA     C(8)          ORDER 8 OR MORE.  COMPARE 8TH ENTRY.       EVM14490
*  TRANSFERS FROM 9TH ENTRY COMPARE.                                    EVM14500
       TRA     C(13)         ORDER 16.  COMPARE 13TH ENTRY.             EVM14510
       TRA     C(13)         ORDER 15.  DITTO.                          EVM14520
       TRA     C(13)         ORDER 14.  DITTO.                          EVM14530
       TRA     C(13)         ORDER 13.  DITTO.                          EVM14540
       TRA     C(11)         ORDER 12.  COMPARE 11TH ENTRY.             EVM14550
       TRA     C(11)         ORDER 11.  DITTO.                          EVM14560
       TRA     C(10)         ORDER 10.  COMPARE 10TH ENTRY.             EVM14570
B9HI   TRA     ((9)          ORDER 9.  DONE.                            EVM14580
*  TRANSFERS FROM 11TH ENTRY COMPARE.                                   EVM14590
B11H   TXL     ((11),2,11    DONE IF ORDER 11.                          EVM14600
       TRA     C(12)         ORDER 12 OR MORE.  COMPARE 12TH ENTRY.     EVM14610
*  TRANSFERS FROM 13TH ENTRY COMPARE.                                   EVM14620
       TRA     C(15)         ORDER 16.  COMPARE 15TH ENTRY.             EVM14630
       TRA     C(15)         ORDER 15.  DITTO.                          EVM14640
       TRA     C(14)         ORDER 14.  COMPARE 14TH ENTRY.             EVM14650
B13HI  TRA     ((13)         ORDER 13.  DONE.                           EVM14660
*  TRANSFERS FROM 15TH ENTRY COMPARE.                                   EVM14670
       TRA     C(16)         ORDER 16.  COMPARE 16TH ENTRY.             EVM14680
B15HI  TRA     ((15)         ORDER 15.  DONE.                           EVM14690
*  ENTRY TO THIS TABLE LOADS IR2 WITH INSERTION LEVEL OF ITEM MERGED.   EVM14700
((16)  AXT     16,2                                                     EVM14710
       TRA     MRXCL                                                    EVM14720
((15)  AXT     15,2                                                     EVM14730
       TRA     MRXCL                                                    EVM14740
((14)  AXT     14,2                                                     EVM14750
       TRA     MRXCL                                                    EVM14760
((13)  AXT     13,2                                                     EVM14770
       TRA     MRXCL                                                    EVM14780
((12)  AXT     12,2                                                     EVM14790
       TRA     MRXCL                                                    EVM14800
((11)  AXT     11,2                                                     EVM14810
       TRA     MRXCL                                                    EVM14820
((10)  AXT     10,2                                                     EVM14830
       TRA     MRXCL                                                    EVM14840
((9)   AXT     9,2                                                      EVM14850
       TRA     MRXCL                                                    EVM14860
((8)   AXT     8,2                                                      EVM14870
       TRA     MRXCL                                                    EVM14880
((7)   AXT     7,2                                                      EVM14890
       TRA     MRXCL                                                    EVM14900
((6)   AXT     6,2                                                      EVM14910
       TRA     MRXCL                                                    EVM14920
((5)   AXT     5,2                                                      EVM14930
       TRA     MRXCL                                                    EVM14940
((4)   AXT     4,2                                                      EVM14950
       TRA     MRXCL                                                    EVM14960
((3)   AXT     3,2                                                      EVM14970
       TRA     MRXCL                                                    EVM14980
((2)   AXT     2,2                                                      EVM14990
       TRA     MRXCL                                                    EVM15000
 ((1)  TRA     MR100                                                    EVM15010
       SPACE                                                            EVM15020
*  INSERT PRESENT K1 RECORD AT PROPER LEVEL AND SHIFT K TABLE           EVM15030
 MRXCL LDQ     K1                                                       EVM15040
       CAL     K1+1,2                                                   EVM15050
       STQ     K1+1,2                                                   EVM15060
       XCL                                                              EVM15070
       TIX     *-3,2,1                                                  EVM15080
       TRA     MR100                                                    EVM15090
       EJECT                                                            EVM15100
*                                                                       EVM15110
LOC    PZE                                                              EVM15120
*      MAXIMUM OUTPUT BLOCK SIZE                                        EVM15130
MAXOPB PZE     0              MAX. RECORDS FIXED/WORDS VARIABLE         EVM15140
CNT9   PZE                    READ COUNT, IN NO. OF RECORDS             EVM15150
ONE    DEC     1                                                        EVM15160
TWO    DEC     2                                                        EVM15170
 FOUR  DEC     4                                                        EVM15180
 SIX   DEC     6                                                        EVM15190
WRK    FVE     0                                                        EVM15200
MZ     FOR                                                              EVM15210
 TAG4  PZE     ,4,                                                      EVM15220
SETCVS TRA     BCDCV                                                    EVM15230
SETVCK PZE     CKS                                                      EVM15240
MORD1                         MERGE ORDER - NO. OF FILES FROM XS        EVM15250
MORD2                         NO. OF FILES LEFT TO BE MERGED            EVM15260
MORD3                         CURRENT MERGE ORDER                       EVM15270
MORT                          NO. OF AVAILABLE MERGE TAPES, CURRENT     EVM15280
CNTR                          TOTAL NO. OF RECORDS READ                 EVM15290
CNTW                          TOTAL NO. OF RECORDS WRITTEN              EVM15300
NRSUMM PZE     0              COUNT OF RECORDS SUMMARIZED.              EVM15310
MRT1                          FILE NO. OF PREVIOUS READ,,AREA NO.       EVM15320
MRT2                          FILE NO. OF PRESENT READ,,AREA NO.        EVM15330
MRT3                          FILE NO. OF PRESENT WRITE                 EVM15340
CNT5                          SEQUENCE COUNT                            EVM15350
WRCT   PZE                    COUNT FOR EACH WRITE                      EVM15360
WRTB1  PZE     ,2,            WRITE TABLE 1                             EVM15370
WRTB2  PZE     ,2,            WRITE TABLE 2                             EVM15380
MRSC   PZE     ,1,            SEQUENCE CHECK WORD                       EVM15390
*                                                                       EVM15400
* CONTROL FIELD WORD TABLE FOR MERGE                                    EVM15410
K16    PZE     ,1,16                                                    EVM15420
K15    PZE     ,1,15                                                    EVM15430
K14    PZE     ,1,14                                                    EVM15440
K13    PZE     ,1,13                                                    EVM15450
K12    PZE     ,1,12                                                    EVM15460
K11    PZE     ,1,11                                                    EVM15470
K10    PZE     ,1,10                                                    EVM15480
K9     PZE     ,1,9                                                     EVM15490
K8     PZE     ,1,8                                                     EVM15500
K7     PZE     ,1,7                                                     EVM15510
K6     PZE     ,1,6                                                     EVM15520
K5     PZE     ,1,5                                                     EVM15530
K4     PZE     ,1,4                                                     EVM15540
K3     PZE     ,1,3                                                     EVM15550
K2     PZE     ,1,2                                                     EVM15560
K1     PZE     ,1,1                                                     EVM15570
CFWD   BES     0                                                        EVM15580
*                                                                       EVM15590
*      TABLE OF LOCATION OF EXTRACTED CONTROL FIELDS FOR EACH FILE      EVM15600
CFADR  BES     16             ADR.= LOC. OF LAST WORD+1 OF CONTROL FLD. EVM15610
       SPACE                                                            EVM15620
*      TABLE OF AREA WORDS * DEC. = NO. RECORDS LAST READ INTO AREA     EVM15630
*                             ADR. = NO. RECORDS REMAINING IN AREA      EVM15640
ARWD   BES     33                                                       EVM15650
       SPACE                                                            EVM15660
*      TABLE OF FILE WORDS *  ADR.= LOC. OF PRESENT REC. FOR THIS FILE  EVM15670
*                             DEC.= PRESENT AREA NO. OF THIS FILE       EVM15680
FLWD   BES     16                                                       EVM15690
       SPACE                                                            EVM15700
*      1ST. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  EVM15710
*                                     DEC=AREA NO. OF THE BLOCK         EVM15720
RFWD1  BES     16                                                       EVM15730
       SPACE                                                            EVM15740
*      2ND. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  EVM15750
*                                     DEC=AREA NO. OF THE BLOCK         EVM15760
RFWD2  BES     16                                                       EVM15770
       SPACE                                                            EVM15780
*      3RD. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  EVM15790
*                                     DEC=AREA NO. OF THE BLOCK         EVM15800
RFWD3  BES     16                                                       EVM15810
       SPACE                                                            EVM15820
       PZE     RFWD3,1                                                  EVM15830
       PZE     RFWD2,1                                                  EVM15840
       PZE     RFWD1,1                                                  EVM15850
RWD    BES     0                                                        EVM15860
       SPACE                                                            EVM15870
*      RECORD STORAGE AREA ADDRESS TABLE                                EVM15880
ADDR   BES     33               POINTS TO LOC. OF 1ST. WORD OF AREA     EVM15890
       SPACE                                                            EVM15900
FLNO   BES     16             OUTPUT FILE NO. TABLE                     EVM15910
       SPACE                                                            EVM15920
MR777  PZE                                                              EVM15930
       SPACE                                                            EVM15940
*      END OF FILE TABLE                                                EVM15950
EOFIND BES     16             IF NONZERO FILE IS AT EOF.                EVM15960
 NOP   NOP                                                              EVM15970
 TRA   TRA     0                                                        EVM15980
 AACNT PZE                    NUMBER OF READ AREAS AVAILABLE COUNTER    EVM15990
EFNAA  PZE     0              NUMBER AREAS AVAILABLE FOR USE.           EVM16000
       SPACE                                                            EVM16010
*      TABLE FOR SELECTING NEXT READ FILE                               EVM16020
*        DECREMENT = NO. BLOCKS IN CORE FOR THIS FILE                   EVM16030
*        ADDRESS = FILE NUMBER                                          EVM16040
 MRBKC BES     16                                                       EVM16050
       SPACE                                                            EVM16060
 ONED  PZE     0,0,1                                                    EVM16070
 MSK1  OCT     377777000000                                             EVM16080
 ONEHI OCT     007000000000                                             EVM16090
 NWTR  PZE     0              NUMBER OF WORDS THIS RECORD.              EVM16100
MRNWRW PZE     0              NUMBER WORDS READY TO WRITE               EVM16110
*                                                                       EVM16120
*      CELLS USED WHEN DUMPING A RECORD                                 EVM16130
       PZE     DRERC1,,6                                                EVM16140
ATDAR  PZE     0,,0           ADR.=LOC. OF REC.  DEC.=NO. WORDS         EVM16150
*                                                                       EVM16160
DRERC1 BCI     6,INVALID CHECKSUM RECORD PHASE 2                        EVM16170
       SPACE                                                            EVM16180
*      INPUT FILES BLOCK SEQUENCE BREAK TABLE                           EVM16190
MRIBSC BES     16                                                       EVM16200
*                                                                       EVM16210
*      OUTPUT BLOCK SEQUENCE BREAK INDICATOR                            EVM16220
MROSBI PZE     0                                                        EVM16230
       SPACE                                                            EVM16240
*      MODIFICATIONS FOR FIXED LENGTH                                   EVM16250
FXSETA TRA     FXCKS                                                    EVM16260
FXSETB CLA     WRCT                                                     EVM16270
FXSETC TRA     MR106                                                    EVM16280
FXSETD TRA     MR209                                                    EVM16290
FXSETE PAX     ,4                                                       EVM16300
FXSETF XCL                                                              EVM16310
       EJECT                                                            EVM16320
*      MERGE, PHASE 2, INITIALIZATION                                   EVM16330
VMRHKP STZ     RAWPR-11                                                 EVM16340
       STZ     RAWPR-8                                                  EVM16350
       STZ     RDIND1         TURN OFF EOF INDICATOR                    EVM16360
       STZ     ERAPR-19      RESET- INSURES NO COMPLEMENT OF EQUALS WORDEVM16370
       AXT     2,2                                                      EVM16380
       SXA     PHIND,2        SET PHASE INDICATOR TO 2                  EVM16390
       STL     RDIND          SET READ COMPLETION INDICATOR.            EVM16400
       STL     WRIND          SET WRITE COMPLETION INDICATOR.           EVM16410
       AXT     NWTR,2                                                   EVM16430
       SXA     ERAPR-3,2                                                EVM16440
       AXT     NWLR,2                                                   EVM16450
       SXA     ERAPR-4,2                                                EVM16460
       CLA     XSCT           TRANSFER INTERNAL SORT PHASE, RECORD COUNTEVM16470
       STO     MRCT             TO MERGE PHASE RECORD COUNT             EVM16480
       LXA     MR777,1        COMPUTE STARTING LOCATION                 EVM16490
       PXA     ,1               OF VARIABLE LENGTH                      EVM16500
       ADD     ONE                TABLES                                EVM16510
       LXA     MORDER,1       INITIALIZE ADDRESS TABLE OF CFWDS         EVM16520
       AXT     1,2                                                      EVM16530
       ADD     NWDCF          CFADR WILL POINT TO LAST WORD +1 OF       EVM16540
       STO     CFADR,2          EXTRACTED CONTROL FIELD                 EVM16550
       TXI     *+1,2,1                                                  EVM16560
       TIX     *-3,1,1                                                  EVM16570
       ADD     NWDCF          INITIALIZE ADDRESS OF SEQ. CHECK CONTROL  EVM16580
       STA     MRSC             FIELD = LAST WORD +1 OF CF              EVM16590
       ADD     TWO                                                      EVM16600
       STA     WRTB1          INITIALIZE TWO WRITE TABLES               EVM16610
       ADD     NRPBL                                                    EVM16620
       ADD     TWO                                                      EVM16630
       STA     WRTB2                                                    EVM16640
       ADD     NRPBL                                                    EVM16650
       ADD     FOUR                                                     EVM16660
       ADD     TAG4                                                     EVM16670
       LXA     CNT6,1         INITIALIZE RECORD STORAGE AREA            EVM16680
       AXT     1,2              ADDRESS TABLE                           EVM16690
       STO     ADDR,2                                                   EVM16700
       ADD     MBL                                                      EVM16710
       ADD     FOUR                                                     EVM16720
       TXI     *+1,2,1                                                  EVM16730
       TIX     *-4,1,1                                                  EVM16740
       SPACE                                                          FXEVM16750
*      TEST FOR FIXED OR VARIABLE                                     FXEVM16760
       ZET     FXORVA                                                 FXEVM16770
       TRA     MVARIA                                                 FXEVM16780
       SPACE                                                          FXEVM16790
*      INITIALIZE PROGRAM TO PROCESS FIXED LENGTH RECORDS             FXEVM16800
       CLA     RL             STORE RECORD LENGTH IN NUMBER           FXEVM16810
       STO     NWTR             WORDS THIS RECORD COUNTER.            FXEVM16820
       CLA     NRPBL          INITIALIZE OUTPUT BLOCK COUNTER WITH      EVM16830
       STO     MAXOPB           MAX. NUMBER OF RECORDS PER BLOCK.       EVM16840
       CLA     FXSETB                                                   EVM16850
       STO     FXSW01                                                   EVM16860
       CLA     FXSETC                                                   EVM16870
       STO     FXSW02                                                   EVM16880
       CLA     FXSETD                                                   EVM16890
       STO     FXSW03                                                   EVM16900
       CLA     FXSETE                                                   EVM16910
       STO     FXSW04                                                   EVM16920
       STO     FXSW05                                                   EVM16930
       CLA     FXSETF                                                   EVM16940
       STO     FXSW06                                                   EVM16950
       STO     FXSW07                                                   EVM16960
       LDQ     NOP                                                      EVM16970
       SLQ     FXSW08                                                   EVM16980
       AXT     0,4                                                      EVM16990
       ZET     EQOPT          TEST FOR EQUALS OPTION                    EVM17000
       TXI     *+1,4,1                                                  EVM17010
       NZT     CKSIND         TEST FOR CHECKSUM OPTION.               FXEVM17020
       TRA     VMR404         NO CHECKSUM.                            FXEVM17030
       TXI     *+1,4,1        INCREASE COUNT OF NO. OPTIONS.          FXEVM17040
       CLA     FXSETA         SET CHECKSUM SWITCH TO ENTER            FXEVM17050
       STO     MRCKSW           FIXED LENGTH CHECKSUM ROUTINE.        FXEVM17060
       TRA     VMR404                                                 FXEVM17070
       SPACE                                                            EVM17080
*      VARIABLE LENGTH ONLY                                             EVM17090
MVARIA CLA     SETCVS                                                   EVM17100
       NZT     MODEI          TEST FOR BCD OR BINARY.                   EVM17110
       STO     BCDSW          BCD-SET SW. FOR CHARACTER CONVERSION      EVM17120
       SPACE                                                            EVM17130
*      INITIALIZE WRITE CONTROL COUNTER                                 EVM17140
       CLA     MBL            MERGE BLOCKING IN NUMBER OF WORDS         EVM17150
       STO     MAXOPB                                                   EVM17160
       SPACE                                                            EVM17170
*      TEST FOR EQUALS AND CHECKSUM OPTIONS AND INITIALIZE              EVM17180
*        NECESSARY CELLS AND SWITCHES                                   EVM17190
       AXT     0,4                                                      EVM17200
       ZET     EQOPT                                                    EVM17210
       TXI     VMR403,4,1     EQUALS OPTION SPECIFIED                   EVM17220
*      EQUALS OPTION NOT SPECIFIED                                      EVM17230
       CLA     CKSD           MODIFY                                    EVM17240
       STA     CKS              CHECKSUM                                EVM17250
       LXA     *-2,1              ROUTINE                               EVM17260
       TXI     *+1,1,1              TO                                  EVM17270
       PXA     ,1                     BYPASS                            EVM17280
       ADD     TRA                      EQUALS                          EVM17290
       STO     CKS+1                     OPTIONS                        EVM17300
       CLA     CKSD+2                       WORD                        EVM17310
       STA     CKSE-1                                                   EVM17320
       SPACE                                                            EVM17330
VMR403 NZT     CKSIND                                                   EVM17340
       TRA     VMR404         CHECKSUM OPTION NOT SPECIFIED             EVM17350
*      CHECKSUM OPTION SPECIFIED                                        EVM17360
       TXI     *+1,4,1        ADD A WORD FOR CHECKSUM                   EVM17370
       CLA     SETVCK         SET SWITCH                                EVM17380
       STA     MRCKSW           FOR CHECKSUM                            EVM17390
       SPACE                                                            EVM17400
*  INITIALIZE ADDRESS OF CELL MRDVWC WITH NO. WDS. ADDED FOR OPTIONS    EVM17410
VMR404 SXA     MRDVWC,4                                                 EVM17420
*                                                                       EVM17430
       SXD     BUMP,4                                                   EVM17440
       SPACE                                                            EVM17450
*      INITIALIZE IOCP COMMANDS IN TWO WRITE TABLES.                    EVM17460
       LXA     NRPBL,1        MAX. NO. REC. PER BLOCK TO IR1.           EVM17470
       AXT     0,2                                                      EVM17480
       LXA     NWTR,4                                                   EVM17490
       PXD     ,4                                                       EVM17500
       SSM                                                              EVM17510
       STO*    WRTB1                                                    EVM17520
       STO*    WRTB2                                                    EVM17530
       TXI     *+1,2,-1                                                 EVM17540
       TIX     *-3,1,1                                                  EVM17550
       SPACE                                                            EVM17560
*      MORE INITIALIZATION                                              EVM17570
MMOREI LXA     MORDER,4       ORDER OF MERGE TO IR4.                    EVM17580
       TXI     *+1,4,-1                                                 EVM17590
       SXD     KAZOO,4                                                  EVM17600
       LXA     CNT6,4                                                   EVM17610
       SXD     MRN49,4                                                  EVM17620
       CLA     LABPR-4                                                  EVM17630
       ADD     TWO                                                      EVM17640
       STO     FLN                                                      EVM17650
       ADD     ONE                                                      EVM17660
       STO     PSN                                                      EVM17670
       TRA     VMR721                                                   EVM17680
*                                                                       EVM17690
       EJECT                                                            EVM17700
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    EVM17710
CKSIND SYN     OPTPR-1      CHECKSUM OPTION INDICATOR  ZERO= NO CHECKSUMEVM17720
NOCKPT SYN     OPTPR-2      NO CKPT OPTION ZERO=TAKE CHECKPOINT         EVM17730
EQOPT  SYN     OPTPR-3      EQUALS OPTION ZERO= NO EQUALS OPTION        EVM17740
OLPRT  SYN     OPTPR-6      ON-LINE PRINT OPTION, NONZERO=PRINT         EVM17750
 OVEPR COMMON  2            OVERFLOW CARD PARAMETERS                    EVM17760
 LABPR COMMON  5            LABEL CARD PARAMETERS                       EVM17770
 CHAPR COMMON  6            CHANNEL CARD PARAMETERS                     EVM17780
CHIND  SYN     CHAPR-2      MERGE INPUT CHANNEL                         EVM17790
 FILPR COMMON  14           FILE CARD PARAMETERS                        EVM17800
MFBK   SYN     FILPR-2      ADDRESS OF MERGE FILE BLOCK                 EVM17810
 MODPR COMMON  50           MODIFICATION CARD PARAMETERS                EVM17820
MRMOD1 SYN     MODPR-10     MERGE USERS MOD. 1   ZERO = NO MODIFICATION EVM17830
MRMOD2 SYN     MODPR-11     MERGE USERS MOD. 2   ZERO = NO MODIFICATION EVM17840
MRMOD3 SYN     MODPR-12     MERGE USERS MOD. 3   ZERO = NO MODIFICATION EVM17850
MRMOD4 SYN     MODPR-13     MERGE USERS MOD. 4   ZERO = NO MODIFICATION EVM17860
MRMOD5 SYN     MODPR-14     MERGE USERS MOD. 5   ZERO = NO MODIFICATION EVM17870
MCEM1  SYN     MODPR-35     CE MODIFICATION 1, ZERO=NO MODIFICATION     EVM17880
MCEM2  SYN     MODPR-36     CE MODIFICATION 2, ZERO=NO MODIFICATION     EVM17890
MCEM3  SYN     MODPR-37     CE MODIFICATION 3, ZERO=NO MODIFICATION     EVM17900
MCEM4  SYN     MODPR-38     CE MODIFICATION 4, ZERO=NO MODIFICATION     EVM17910
MCEM5  SYN     MODPR-39     CE MODIFICATION 5, ZERO=NO MODIFICATION     EVM17920
 RECPR COMMON  10           RECORD CARD PARAMETERS                      EVM17930
FXORVA SYN     RECPR-5      FIXED OR VARIABLE IND. ZERO=FIXED           EVM17940
 DELPR COMMON  2            DELETE CARD PARAMETERS                      EVM17950
 SAMPR COMMON  7            SORT AND MERGE CARD PARAMETERS              EVM17960
MORDER SYN     SAMPR-1      MERGE ORDER                                 EVM17970
MRGS   SYN     SAMPR-2      NUMBER OF FILES TO BE MERGED                EVM17980
CFDATA SYN     SAMPR-3      CONTROL FIELD INFORMATION                   EVM17990
XTRMG  SYN     SAMPR-5      EXTERNAL MERGE FILE INDICATOR               EVM18000
 CALPR COMMON  50           CALCULATED PARAMETERS                       EVM18010
RL     SYN     CALPR-9      RECORD LENGTH                               EVM18020
NWDCF  EQU     CALPR-32        NUMBER OF WORD IN EXTRACTED CONTROL FIELDEVM18030
MBL    SYN     CALPR-13     MERGE BLOCKING, IN NUMBER OF WORDS          EVM18040
NRPBL  SYN     CALPR-14     MERGE BLOCKING, IN NUMBER OF RECORDS        EVM18050
CNT6   SYN     CALPR-15     NUMBER OF MERGE AREAS                       EVM18060
 GENPR COMMON  10           GENERAL PARAMETERS                          EVM18070
PHIND  SYN     GENPR        PHASE INDICATOR                             EVM18080
MODEI  SYN     GENPR-1      BINARY-BCD INDICATOR ZERO=BCD               EVM18090
PNBR   SYN     GENPR-2      PASS NUMBER                                 EVM18100
GEN03  EQU     GENPR-3       ADDR-CKPT EXIT.    DECR-MONITOR RETURN     EVM18110
RAWPR  COMMON  30            READ AND WRITE PARAMETERS.                 EVM18120
RWCS   SYN     RAWPR        CALLING SEQ. WORD ONE FOR IO                EVM18130
RWCS1  SYN     RAWPR-1      CALLING SEQ. WORD TWO FOR IO                EVM18140
RDIND  SYN     RAWPR-2      READ COMPLETION INDICATOR,NONZERO=COMPLETE  EVM18150
RDIND1 SYN     RAWPR-3      READ CHANNEL EOF INDICATOR,NONZERO=EOF      EVM18160
WRIND  SYN     RAWPR-4      WRITE COMPLETION INDICATOR,NONZERO=COMP.    EVM18170
WRIND1 SYN     RAWPR-5      END OF TAPE INDICATOR, NONZERO=EOT          EVM18180
CNT11  SYN     RAWPR-8      WORD-COUNT WORD FOR WRITE                   EVM18190
RAW11  EQU     RAWPR-11      I/O PRIORITY REQUEST CELL.                 EVM18200
 CNTPR COMMON  20           COUNT PARAMETERS                            EVM18210
XSCT   SYN     CNTPR        XS PHASE RECORD COUNT                       EVM18220
MRCT   SYN     CNTPR-1      MERGE PHASE RECORD COUNT                    EVM18230
MRDCT  SYN     CNTPR-4      COUNT OF DUMPED RECORDS IN PHASE 2          EVM18240
MRD    SYN     CNTPR-7      COUNT OF DUMPED RECORDS IN THIS PASS        EVM18250
COMNT  SYN     CNTPR-15     COUNT OF NUMBER OF STRINGS                  EVM18260
 ERAPR COMMON  30           ERASABLE STORAGE PARAMETERS                 EVM18270
RCWD   SYN     ERAPR-9      COMM. WORD WITH EXTRACT ROUTINE             EVM18280
FLN    SYN     ERAPR-20     FILE NUMBER - COMM. WITH LABEL ROUTINE      EVM18290
PSN    SYN     ERAPR-21     PASS NUMBER - COMM. WITH LABEL ROUTINE      EVM18300
 REFPR COMMON  1                                                        EVM18310
       EXTERN  MSGSUP                                                   EVM18320
       END                                                              EVM18330
* 7090/7094 SORT VER 7 MOD 9 POST PROCESSOR                          (9)FPP00000
*      FAP
       COUNT   200                                                      FPP00010
       ENTRY   POSTP                                                    FPP00020
       ENTRY   POST1                                                    FPP00030
       SST                                                              FPP00040
*                                                                       FPP00050
*  POST PROCESSOR FOR 7090 SORT                                         FPP00060
*                                                                       FPP00070
*      1.  PRINTS                                                       FPP00080
*              A.  COUNT OF INPUT RECORDS TO SORT OR MERGE              FPP00090
*              B.  COUNT OF RECORDS SORTED OR MERGED                    FPP00100
*              C.  COUNT OF RECORDS DUMPED                              FPP00110
*              D.  COUNT OF RECORDS DELETED                             FPP00120
*              E.  COUNT OF HIGH PADDING RECORDS IN FINAL OUTPUT        FPP00130
*                                      OR                               FPP00140
*              F.  COUNT OF LOW PADDING RECORDS IN FINAL OUTPUT         FPP00150
*      2.  ASSIGNS ALL INTERSYSTEM TAPES                                FPP00160
*      3.  RELEASES ALL OTHER TAPES ASSIGNED FOR SORTING                FPP00170
*                                                                       FPP00180
       TITLE                                                            FPP00190
POSTP  SXA     POST4,4       SAVE RETURN REGISTER.                      FPP00200
       TRA     START                                                    FPP00230
POST1  STL     POST2         DELETE-SORT ENTRY FROM SORT MONITOR.    (2)FPP00240
       TRA     POSTP                                                    FPP00250
 POST2 PZE                   INTERRUPT ENTRY SWITCH                     FPP00260
 POST4 AXT     **,4           RESTORE RETURN REGISTER                   FPP00270
       LDI     GEN04     GET READ-AHEAD INDICATOR BITS FROM EDIT PHAS(2)FPP00275
       NZT     POST2         TEST FOR NORMAL RETURN                     FPP00280
       TRA     RLTEST        TEST FOR RELOAD OF SORT.                (2)FPP00290
       TSX     MSGSUP,4,2    PRINT SORT DELETED.                        FPP00300
       PZE     1                                                        FPP00310
       PZE     DELMS,,2+2048                                            FPP00320
       XEC     POST4         RELOAD XR4.                                FPP00330
       CAL     =O1000000                                                FPP00340
       ORS     SYSJOB                                                   FPP00350
       LDI     GEN04         GET READ-AHEAD INDICATOR BITS.          (2)FPP00351
       LFT     60000         BOTH BITS OFF IF SORT TO BE RELOADED.   (2)FPP00352
       TRA     SYSRET        DO NOT RELOAD SORT.                     (2)FPP00353
       LDQ     =O400000000000 SET INDICATION THAT PREVIOUS SORT      (2)FPP00354
       TRA     3,4            HAS BEEN DELETED.                      (2)FPP00360
RLTEST LNT     400000        SIGN BIT ON MEANS RELOAD SORT.          (2)FPP00362
       TRA     POST07        DO NOT RELOAD SORT.                     (2)FPP00363
       LDQ     =0            SET MQ PLUS TO INDICATE SORT NOT DELETED(2)FPP00364
       TRA     1,4           EXIT TO FINAL MERGE SUBPROGRAM          (2)FPP00365
POST07 LNT     200000        BIT 1 ON MEANS RETURN TO SYSRET.        (2)FPP00366
       TRA     SYSRPT        READ-AHEAD CARD WAS $JOB.  GO TO SYSRPT.(2)FPP00367
       LNT     100000        BIT 2 ON SAYS PRINT '$IBSYS'.           (2)FPP00368
       TRA     SYSRET        DO NOT PRINT - JUST GO TO SYSRET.       (2)FPP0036A
       TSX     MSGSUP,4,2                                            (2)FPP0036B
       PZE     1             PRINT OUT '$IBSYS'.                     (2)FPP0036C
       PZE     =H$IBSYS,,1+512*4                                     (2)FPP0036D
       TRA     SYSRET                                                (2)FPP0036E
START  TSX     MSGSUP,4,4    PRINT HEADINGS                             FPP00370
       PZE     1                                                        FPP00380
       PZE     PMES1,,12                                                FPP00390
       LDQ     CNTPR-14       COUNT OF INPUT RECORDS TO SORT AND MERGE  FPP00400
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00410
       STO     PME2A+6                                                  FPP00420
       STQ     PME2A+7                                                  FPP00430
       NZT     SAMPR-5       IF SORT ONLY, FINAL MERGE PHASE COUNT      FPP00440
       TRA     POST10         IS NOT APPLICABLE.                        FPP00450
       LDQ     CNTPR-16                                                 FPP00460
       CALL    BTD                                                      FPP00470
       STO     PME2A+10                                                 FPP00480
       STQ     PME2A+11                                                 FPP00490
POST10 BSS     0                                                        FPP00500
       TSX     MSGSUP,4,4    PRINT COUNT OF INPUT RECORDS               FPP00510
       PZE     2                                                        FPP00520
       PZE     PMES2,,6                                                 FPP00530
       PZE     PME2A,,12                                                FPP00540
       LDQ     CNTPR          NUMBER OF RECORDS SORTED IN PHASE 1       FPP00550
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00560
       STO     PMES3+6                                                  FPP00570
       STQ     PMES3+7                                                  FPP00580
       LDQ     CNTPR-1        NUMBER OF RECORDS MERGED IN PHASE 2       FPP00590
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00600
       STO     PMES3+8                                                  FPP00610
       STQ     PMES3+9                                                  FPP00620
       LDQ     CNTPR-2        NUMBER OF RECORDS MERGED IN PHASE 3       FPP00630
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00640
       STO     PMES3+10                                                 FPP00650
       STQ     PMES3+11                                                 FPP00660
       TSX     MSGSUP,4,4    PRINT NUMBER OF RECORDS SORTED AND         FPP00670
       PZE     1              MERGED IN PHASWS 1, 2, AND 3              FPP00680
       PZE     PMES3,,12                                                FPP00690
       LDQ     CNTPR-3       NUMBER OF WORDS DUMPED IN PHASE 1.         FPP00700
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00710
       STO     PMES4+6                                                  FPP00720
       STQ     PMES4+7                                                  FPP00730
       LDQ     CNTPR-4       NUMBER OF WORDS DUMPED IN PHASE 2.         FPP00740
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00750
       STO     PMES4+8                                                  FPP00760
       STQ     PMES4+9                                                  FPP00770
       LDQ     CNTPR-5        NUMBER OF RECORDS DUMPED IN PHASE 3       FPP00780
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00790
       STO     PMES4+10                                                 FPP00800
       STQ     PMES4+11                                                 FPP00810
       TSX     MSGSUP,4,4    PRINT NUMBER OF WORDS DUMPED IN            FPP00820
       PZE     1              PHASES 1, 2, AND 3.                       FPP00830
       PZE     PMES4,,12                                                FPP00840
       LDQ     CNTPR-8        NUMBER OF RECORDS DELETED                 FPP00850
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00860
       STO     PMES5+6                                                  FPP00870
       STQ     PMES5+7                                                  FPP00880
       LDQ     CNTPR-9       NUMBER DELETES PHASE 3                     FPP00890
       CALL    BTD           CONVERT TO DECIMAL                         FPP00900
       STO     PMES5+10                                                 FPP00910
       STQ     PMES5+11                                                 FPP00920
       TSX     MSGSUP,4,4    PRINT NUMBER OF RECORDS DELETED            FPP00930
       PZE     1                                                        FPP00940
       PZE     PMES5,,12                                                FPP00950
       LDQ     CNTPR-11       COUNT OF HIGH PADDING-FINAL MERGE         FPP00960
       CALL    BTD            CONVERT BINARY TO BCD                     FPP00970
       STO     PMES6+10                                                 FPP00980
       STQ     PMES6+11                                                 FPP00990
       TSX     MSGSUP,4,4    PRINT COUNT OF RECORDS OF PADDING          FPP01000
       PZE     1                                                        FPP01010
       PZE     PMES6,,12                                                FPP01020
       LDQ     CNTPR-10       COUNT OF LOW PADDING-FINAL MERGE          FPP01030
       CALL    BTD            CONVERT BINARY TO BCD                     FPP01040
       STO     PMES7+10                                                 FPP01050
       STQ     PMES7+11                                                 FPP01060
       TSX     MSGSUP,4,4    PRINT COUNT OF LOW PADDING-FINAL MERGE     FPP01070
       PZE     1                                                        FPP01080
       PZE     PMES7,,12+512*4                                          FPP01090
*                                                                       FPP01130
*  ASSIGNEMNT OF INTERSYSTEM TAPES                                      FPP01140
*                                                                       FPP01150
       ZET     POST2                                                 (2)FPP01152
       TRA     NONAS                                                 (2)FPP01153
       NZT     CHAPR-4       INTERSYSTEM RESERVE UNIT FOR OUTPUT.    (2)FPP01155
       TRA     POST50        NO.                                     (2)FPP01160
       CLA     CHAPR-2       YES. GET THE BASE OF TABLE P6I5TING TO  (2)FPP01161
       ADD     =1                 OUTPUT UNITS.                      (2)FPP01162
       STA     A             INTERSYSTEM ALWAYS AT THE TOP OF THE TAB(2)FPP01163
       STA     C             SAVE TO COMPARE WITH SYSUNI ENTRIES     (4)FPP01164
       LXA     SAMPR-1,1                                             (4)FPP01165
C      CLA     **,1                                                  (4)FPP01166
       STA     TEST                                                  (4)FPP01167
AGAIN  LXD     SYSUNI,2      LENGTH OF SYSUNI TABLE                  (4)FPP01168
       PXA     ,2                                                    (4)FPP01169
       ADD     SYSUNI                                                (4)FPP0116A
       ADD     =1                                                    (4)FPP0116B
       STA     BUNI          BASE OF SYSUNI TABLE                    (4)FPP0116C
BUNI   CLA     **,2                                                  (4)FPP0116D
       ANA     =O00000077777   ONLY ADDRESS NEEDED FOR COMPARE       (4)FPP0116E
       SSP                                                           (4)FPP0116F
       SUB     TEST          OUTPUT FROM INTERNAL SORT PHASE.        (4)FPP0116G
       TZE     NOGO          INTERSYSTEM UNIT CANNOT BE ASSIGNED.    (4)FPP0116H
       TIX     BUNI,2,1                                              (4)FPP0116I
GATE   TRA     A             GO TO SAVE INTERSYSTEM DESIGNATION.     (4)FPP0116J
NOGO   TSX     MSGSUP,4,2                                            (4)FPP0116K
       PZE     1                                                     (4)FPP0116L
       PZE     NOIS,,12+512*4                                        (4)FPP0116M
       TRA     POST50                                                (4)FPP0116N
A      CLA     **,1                                                  (4)FPP0116O
       ANA     =O77777777777 PREFIX IS ZEROED OUT FOR IBSYS USE.     (4)FPP0116P
       STO*    A                                                     (4)FPP0116Q
       STA     B                                                     (4)FPP0116R
       LAC     CHAPR-1,2     SAVE FIRST INTERSYSTEM DESIGNATION IN UC(4)FPP0116S
       CAL     0,2                                                   (2)FPP01170
B      STA     **                                                    (2)FPP01171
       STA     MESAG1+5      PRINT MESSAGE-                          (2)FPP01172
       LDQ*    B              UNIT XX IS INTERSYSTEM RESERVE UNIT YY.(2)FPP01173
       TSX     MSGSUP,4,3                                            (2)FPP01174
       PZE     MESAG1,,6+512*4                                       (2)FPP01175
       CLA     =O40000000000 SET RESERVE BIT IN UCW SO AS TO         (2)FPP01176
       ORS*    B              RESERVE THIS UNIT.                     (2)FPP01177
       LAC     FILPR-1,1                                             (2)FPP01178
       CAL     -15,1                                                 (2)FPP01179
       SBM     =1            IS THE OUTPUT MORE THAN 1 REEL.         (2)FPP01180
       TZE     POST50        NO. FORGET ABOUT SECOND INTERSYSTEM UNIT(2)FPP01181
       CAL     CHAPR-4       YES.                                    (2)FPP01182
       PBT                   IS THERE A SECOND PARAMETER IN OUTPUT CA(2)FPP01183
       TRA     POST50        NO.                                     (2)FPP01184
       LDQ     -15,1          FROM SORT, CALCULATE -                 (2)FPP01185
       ZAC                    (NO.OF REELS)/(MERGE ORDER-1)          (2)FPP01186
       LXA     SAMPR-1,1                                             (2)FPP01187
       TXI     *+1,1,-1      IS IT 1 WAY MERGE.                      (2)FPP01188
       TXL     POSTP,1,0     YES.                                    (2)FPP01189
       TXL     E,1,1         NO.  IS IT 2 WAY MERGE.  YES.           (2)FPP01190
       SXA     MORDM1,1      NO.                                     (2)FPP01191
       DVP     MORDM1                                                (2)FPP01192
       PAX     ,1            IS THE REMAINDER GREATER THAN 1.        (2)FPP01193
       TXH     F,1,1         YES.                                    (2)FPP01194
       TXH     E,1,0         NO. IS IT =1. YES.                      (2)FPP01195
       CLA     MORDM1        NO.  MAKE REMAINDER = (MERGE ORDER-1).  (2)FPP01196
F      SBM     =1                                                    (2)FPP01197
       STO     REMAND                                                (2)FPP01198
       CAL     SAMPR-1       (MERGE ORDER-(REMAINDER-1)).            (2)FPP01199
       SBM     REMAND                                                (2)FPP01200
       PAX     ,1                                                    (2)FPP01201
E      XEC     A                                                     (2)FPP01202
       ANA     =O77777777777  PREFIX IS ZEROED OUT FOR IBSYS USE.    (2)FPP01203
       STO*    A                                                     (2)FPP01204
       STA     TEST                                                  (4)FPP01205
       AXT     G,4           CHANGE GATE                             (4)FPP01206
       SXA     GATE,4                                                (4)FPP01207
       TRA     AGAIN                                                 (4)FPP01208
G      XEC     A                                                     (4)FPP01209
       ANA     =O77777777777  PREFIX IS ZEROED OUT FOR IBSYS USE.    (4)FPP0120A
       STO*    A                                                     (4)FPP0120B
       STA     D                                                     (4)FPP0120C
       LAC     CHAPR-1,2      SAVE SECOND INTERSYSTEM DESIGNATION    (9)FPP0120D
       CAL     -1,2                IN UCW1                           (9)FPP0120E
D      STA     **                                                    (9)FPP0120F
       STA     MESAG1+5                                              (9)FPP0120G
       CLA     =O40000000000  SET RESERVE BIT IN UCW1                (9)FPP0120H
       ORS*    D                                                     (9)FPP01210
       LDQ*    D              PRINT MESSAGE-                         (2)FPP01211
       TSX     MSGSUP,4,3        UNIT XX IS INTERSYSTEM RESERVE UNIT (2)FPP01212
       PZE     MESAG1,,6+512*4                                       (2)FPP01213
POST50 TSX     MSGSUP,4,2    PRINT -END OF SORT-ON-LINE.             (2)FPP01214
       PZE     1                                                     (2)FPP01215
       PZE     ENDSRT,,2+512*4                                       (2)FPP01216
*                                                                       FPP01300
*  RELEASE ALL ASSIGNED TAPE UNITS                                      FPP01310
*                                                                       FPP01320
 NONAS BSS     0                                                        FPP01330
       CLA     SAMPR-1       MERGE ORDER                                FPP01340
       ALS     18                                                       FPP01350
       STD     CHAPR-2       SET NUMBER OF TAPES TO RELEASE             FPP01360
       STD     CHAPR-3                                                  FPP01370
       CAL     CHAPR-2       LOCATION OF UNITS TO BE RELEASE            FPP01380
       SLW     *+2                                                      FPP01390
       CALL    RELEAS        RELEASE FINAL OUTPUT TAPES                 FPP01400
       PZE                                                              FPP01410
       CAL     CHAPR-3       ADDRESS OF MERGE TAPES TO BE RELEASED      FPP01420
       SLW     *+2                                                      FPP01430
       CALL    RELEAS        RELEASE INTERMEDIARY MERGE TAPES           FPP01440
       PZE                                                              FPP01450
       CAL     =O77000000      SET INDICATOR THAT RELEAS IS TO       (7)FPP01455
       ORS     CNT19            RELEASE INPUT UNITS                  (7)FPP01456
       CAL     CHAPR         ADDRESS OF INPUT TAPES TO BE RELEASED      FPP01460
       SLW     *+2                                                      FPP01470
       CALL    RELEAS        RELEASE INPUT TAPES                        FPP01480
       PZE                                                              FPP01490
       LXA     CHAPR-1,1      OUTPUT ASSIGNMENTS                        FPP01500
       TXL     OUT,1,0        TEST FOR OUTPUT UNITS GIVEN               FPP01510
       ZET     CHAPR-4       TEST FOR INTERSYSTEM OUTPUT                FPP01520
       TRA     OUT                                                      FPP01530
       CLA     SAMPR-1       MERGE ORDER                                FPP01540
       ALS     18                                                       FPP01550
       STD     CHAPR-1                                                  FPP01560
       CAL     CHAPR-1        OUTPUT TAPES TO BE RELEASED               FPP01570
       SLW     *+2                                                      FPP01580
       CALL    RELEAS        RELEASE OUTPUT TAPES                       FPP01590
       PZE                                                              FPP01600
OUT    TRA     POST4                                                    FPP01610
 PMES1 BCI     6,                                                       FPP01620
       BCI     6,  PHASE 1     PHASE 2     PHASE 3                      FPP01630
 PMES2 BCI     6,COUNT OF INPUT RECORDS TO SORT                         FPP01640
PME2A  BCI     6, AND/OR MERGE                                          FPP01650
       BCI     6,                 N/A         N/A                       FPP01660
 PMES3 BCI     6,COUNT OF RECORDS SORTED OR MERGED                      FPP01670
       BCI     6,                                                       FPP01680
PMES4  BCI     6,COUNT OF WORDS DUMPED                                  FPP01690
       BCI     6                                                        FPP01700
 PMES5 BCI     6,COUNT OF RECORDS DELETED                               FPP01710
       BCI     6,                 N/A                                   FPP01720
 PMES6 BCI     6,COUNT OF HIGH PADDING RECORDS IN OUT                   FPP01730
       BCI     6,PUT  N/A         N/A                                   FPP01740
 PMES7 BCI     6,COUNT OF LOW PADDING RECORDS IN OUTP                   FPP01750
       BCI     6,UT   N/A         N/A                                   FPP01760
DELMS  BCI     2,SORT DELETED                                           FPP01770
ENDSRT BCI     2,END OF SORT                                            FPP01780
MESAG1 BCI     6, IS INTERSYSTEM RESERVE UNIT                        (2)FPP01785
REMAND PZE     0                                                     (2)FPP01787
TEST   PZE                                                           (4)FPP01788
MORDM1 PZE                                                           (2)FPP01789
NOIS   BCI     6,OUTPUT IS ON UTILITY FUNC-INTERSYSTE                (4)FPP0178A
       BCI     6,M RESERVATION CANNOT BE MADE.                       (4)FPP0178B
       DETAIL                                                           FPP01790
 OPTPR COMMON  15                                                       FPP01800
 OVEPR COMMON  2                                                        FPP01810
 LABPR COMMON  5                                                        FPP01820
 CHAPR COMMON  6                                                        FPP01830
 FILPR COMMON  14                                                       FPP01840
 MODPR COMMON  50         MODIFICATION CARD PARAMETERS                  FPP01850
 RECPR COMMON  10                                                       FPP01860
 DELPR COMMON  2                                                        FPP01870
 SAMPR COMMON  7                                                        FPP01880
 CALPR COMMON  50                                                       FPP01890
 GENPR COMMON  10                                                       FPP01900
 RAWPR COMMON  30                                                       FPP01910
 CNTPR COMMON  20                                                       FPP01920
 ERAPR COMMON  30                                                       FPP01930
 REFPR COMMON  1                                                        FPP01940
GEN04  EQU     GENPR-4                                               (2)FPP01941
CNT19  EQU     CNTPR-19                                              (7)FPP01942
       EXTERN  MSGSUP                                                   FPP01950
       END                                                              FPP01960
*VER 7 MOD 0   729 TAPE CHECKPOINT WRITER                               GCK00000
*      FAP
       COUNT   75                                                       GCK00010
       SPACE                                                            GCK00020
       ENTRY   CKPT                                                     GCK00030
       SST                                                              GCK00040
       SPACE                                                            GCK00050
       SPACE                                                            GCK00060
CKPT   SXA     SAVE4,4       SAVE REGISTER FOUR,                        GCK00070
       SXA     SAVE2,2          TWO,                                    GCK00080
       SXA     SAVE1,1             AND ONE                              GCK00090
       LXA     SYSCK2,4      IS THERE A SYSCK2.                         GCK00100
       TXL     SAVE4,4,0     EXIT IF NOT ATTACHED.                      GCK00110
       AXT     SAVE4,1       GIVE TRANSFER ADDRESS                      GCK00120
       SXA     GENPR-3,1      TO RESTART PROGRAM.                       GCK00130
       LAC     CHAPR-2,1                                                GCK00140
       CLA*    0,1           GET UCW1 FOR TAPE ON OUT-CHANNEL.          GCK00150
       TSX     WAIT,4        WAIT FOR OUTPUT TO STOP.                   GCK00160
       CLA*    SYSCK2                                                   GCK00170
       TSX     WAIT,4        WAIT FOR SYSCK2 CHANNEL TO BE FREE.        GCK00180
       LDI*    SYSCK2                                                   GCK00190
       LNT     20000                                                    GCK00200
       TRA     NONHYP        7607 CHANNEL.                              GCK00210
       STL     HYPER         7909 CHANNEL.                              GCK00220
       CAL     ONE                                                      GCK00230
       LFT     40                                                       GCK00240
       ORS     SMS           INTERFACE 1.                               GCK00250
       CLA*    SYSCK2        INTERFACE 0.                               GCK00260
       ANA     =O17000000    UPDATE HSEL                                GCK00270
       PDX     ,4             BY GETTING                                GCK00280
       TXI     *+1,4,8576     UNIT ADDRESS                              GCK00290
       SXD     HSEL,4         OF CKPT TAPE.                             GCK00300
       TSX     (NDSLX,4      REWIND                                     GCK00310
       PZE     SYSCK2,,30     CKPT TAPE.                                GCK00320
       TRA     USUAL                                                    GCK00330
NONHYP TSX     (NDSLX,4      REWIND                                     GCK00340
       PZE     SYSCK2,,3        CKPT TAPE                               GCK00350
USUAL  CLA     RWCS1         SET UP                                     GCK00360
       STO     RAWPR            CALLING SEQUENCE                        GCK00370
       CLA     =O1000000           TO SKIP                              GCK00380
       STO     RAWPR-1                FIRST FILE.                       GCK00390
       CALL    SKIP                                                     GCK00400
       LXA     GENPR,4                                                  GCK00410
       LXA     SAMPR-1,2                                                GCK00420
NEXT   TXI     *+1,2,-1                                                 GCK00430
       CLA*    CHAPR-2                                                  GCK00440
       TXL     *+2,4,2                                                  GCK00450
       CLA*    CHAPR-3                                                  GCK00460
       PAC     ,1                                                       GCK00470
       ZET     1,1                                                      GCK00480
       TRA     *-1                                                      GCK00490
       TXH     NEXT,2,0                                                 GCK00500
WRITE  LAC     SYSCK2,2      PLACE ADDRESS OF SELECT ROUTINE            GCK00510
       CAL     SELADD              IN SECOND WORD                       GCK00520
       SLW     1,2                                                      GCK00530
       SXA     IOCOM2,0                                                 GCK00540
       SXA     CPYD,0                                                   GCK00550
       TSX     (ACTVX,4      ACTIVATE                                   GCK00560
       MZE     SYSCK2           UNIT                                    GCK00570
       ZET     1,2           DELAY                                      GCK00580
       TRA     *-1              LOOP                                    GCK00590
       CALL    SNDAT                                                    GCK00600
       PZE     SYSCK2,,3                                                GCK00610
SAVE4  AXT     **,4                                                     GCK00620
SAVE2  AXT     **,2                                                     GCK00630
SAVE1  AXT     **,1                                                     GCK00640
       TRA     1,4                                                      GCK00650
SELEC  SXA     SAVIT,4                                                  GCK00660
       SXA     SAVIT+1,1                                                GCK00670
       PAC     ,2                                                       GCK00680
       TMI     SMINUS        GO TO SELECT MINUS                         GCK00690
       NZT     HYPER                                                    GCK00700
       TRA     TP729                                                    GCK00710
       CLA     SMSADR                                                   GCK00720
       STA*    (RCHXI                                                   GCK00730
       TRA     HYPWRT                                                   GCK00740
TP729  CLA     IOAD2                                                    GCK00750
       STA*    (RCHXI                                                   GCK00760
       CLA*    SYSCK2        GET ADDRESS OF I/O                         GCK00770
       ARS     18               UNIT AND MAKE                           GCK00780
       ORA     MASK                IT BINARY                            GCK00790
       STA     *+1           SET TO                                     GCK00800
       WRS     **               WRITE                                   GCK00810
HYPWRT XEC*    (RCHXI                                                   GCK00820
SAVIT  AXT     **,4                                                     GCK00830
       AXT     **,1                                                     GCK00840
       TRA     1,4           RETURN                                     GCK00850
SMINUS LXA     IOCOM2,1                                                 GCK00860
       ZET     HYPER                                                    GCK00870
       LXA     CPYD,1                                                   GCK00880
       TXI     *+1,1,4096                                               GCK00890
       SXA     CPYD,1                                                   GCK00900
       SXA     IOCOM2,1                                                 GCK00910
       TXH     SAVIT,1,0                                                GCK00920
       STZ     1,2                                                      GCK00930
       TRA     SAVIT                                                    GCK00940
WAIT   ARS     9                                                        GCK00950
       ANA     MASKO                                                    GCK00960
       PDC     ,1                                                       GCK00970
       TXI     *+1,1,1                                                  GCK00980
       ZET*    (CHXAC                                                   GCK00990
       TRA     *-1                                                      GCK01000
       TRA     1,4                                                      GCK01010
ONE    DEC     1                                                        GCK01020
MASK   OCT     20                                                       GCK01030
HYPER  PZE                                                              GCK01040
SMSADR PZE     SMS                                                      GCK01050
SMS    SMS     70                                                       GCK01060
       CTLW    HSEL                                                     GCK01070
CPYD   CPYD    0,,4096                                                  GCK01080
       TCH     SYSTWT                                                   GCK01090
HSEL   OCT     120600120112    HSEL ** AND HEOS.                        GCK01100
MASKO  PZE     0,,15                                                    GCK01110
SELADD MZE     0,,SELEC                                                 GCK01120
RWCS1  MZE     3,,-1                                                    GCK01130
IOAD2  PZE     IOCOM2                                                   GCK01140
IOCOM2 IORT    0,,4096                                                  GCK01150
       COMMON  22                                                       GCK01160
 CHAPR COMMON  6                                                        GCK01170
       COMMON  76                                                       GCK01180
SAMPR  COMMON  7                                                        GCK01190
CALPR  COMMON  50                                                       GCK01200
GENPR  COMMON  10                                                       GCK01210
RAWPR  COMMON  30                                                       GCK01220
       END                                                              GCK01230
*  7090/94 SORT, VER 7, MOD 0.  DELETE SUBPROGRAM                       GDE00000
*      FAP
       COUNT   90                                                       GDE00010
* CALLING SEQUENCE                                                      GDE00020
*      TSX     DELETE,4                                                 GDE00030
*         RETURN                                                        GDE00040
       SPACE                                                            GDE00050
       ENTRY   DELETE                                                   GDE00060
       SPACE                                                            GDE00070
DELETE SXA     DEL80,1       SAVE                                       GDE00080
       SXA     DEL82,2        INDEX                                     GDE00090
       SXA     DEL85,4        REGISTERS.                                GDE00100
       LXD     WBASE,1       COMPUTE BASE OF WRITE                      GDE00110
       PXA     ,1             LIST FOR USE IN TIXING                    GDE00120
       ADD     WBASE          THROUGH TO EXAMINE                        GDE00130
       STA     DEL27          SUCCESSIVE RECORDS.                       GDE00140
 DEL05 CLA*    DEL27         IF THIS RECORD HAS                         GDE00150
       PDX     ,4             ALREADY BEEN DEPADDED,                    GDE00160
       TXL     DEL75,4,0      DO NOT DELETE IT.                         GDE00170
       CLA     DELCF         OBTAIN AND SAVE                            GDE00180
       PDX     ,4             NUMBER OF                                 GDE00190
 DEL10 SXA     DEL67,4        DELETE FIELDS.                            GDE00200
       STA     DEL15         STORE LOCATION OF                          GDE00210
       STA     DEL20          DELETE CONTROL FIELD                      GDE00220
       STA     DEL22          INFORMATION                               GDE00230
       SUB     ONE           STORE LOCATION                             GDE00240
       STA     DEL30          OF LEFT MASK.                             GDE00250
       SUB     ONE           STORE LOCATION                             GDE00260
       STA     DEL55          OF RIGHT MASK.                            GDE00270
       ALS     18            DETERMINE WHERE THE INFORMATION            GDE00280
 DEL15 SUB     **             FOR THE NEXT FIELD BEGINS (IN CASE THERE  GDE00290
       PDX     ,2             ARE MORE THAN ONE PER RECORD)             GDE00300
       SXA     DEL35,2        AND USE THE LOCATION AS THE BASE          GDE00310
 DEL20 LXD     **,2          KEEP LENGTH                                GDE00320
 DEL22 LDC     **,4           OF FIELD.                                 GDE00330
       PXA     ,2            DETERMINE AND SAVE                         GDE00340
       ADD*    DEL15          THE BASE OF THE                           GDE00350
 DEL27 ADM     **,1           FIELD WITHIN THE RECORD,                  GDE00360
       SUB     ONE            I. E., THE LOCATION                       GDE00370
       STA     DEL32          OF THE NEXT WORD                          GDE00380
 DEL30 CAL     **            USE LEFT MASK WHEN                         GDE00390
 DEL32 ANA     **,2           BRINGING IN FIRST WORD.                   GDE00400
 DEL35 LAS     **,4          COMPARE WITH FIRST CONTROL WORD.           GDE00410
       TRA     DEL65                                                    GDE00420
       TRA     DEL40                                                    GDE00430
       TRA     DEL65                                                    GDE00440
 DEL40 TXL     DEL50,2,2     TRANSFER IS FIELD LESS THAN THREE WORDS.   GDE00450
       TXI     *+1,2,-1      UPDATE                                     GDE00460
       TXI     *+1,4,1        REGISTERS.                                GDE00470
       CAL*    DEL32         COMPARE NEXT RECORD WORD WITH              GDE00480
       XEC     DEL35          NEXT CONTROL WORD                         GDE00490
       TRA     DEL65                                                    GDE00500
       TRA     DEL40                                                    GDE00510
       TRA     DEL65                                                    GDE00520
 DEL50 TXL     DEL70,2,1     TRANSFER IF FIELD HAD ONLY ONE WORD.       GDE00530
       TXI     *+1,2,-1      UPDATE                                     GDE00540
       TXI     *+1,4,1        REGISTERS.                                GDE00550
 DEL55 CAL     **            USE RIGHT MASK WHEN                        GDE00560
       XEC     DEL32          BRING IN LAST WORD.                       GDE00570
       XEC     DEL35         COMPARE WITH LAST CONTROL WORD.            GDE00580
       TRA     DEL65                                                    GDE00590
       TRA     DEL70                                                    GDE00600
 DEL65 CAL     DEL35         IF THERE IS ANOTHER FIELD, GET ITS CONTROL GDE00610
 DEL67 AXT     **,4           INFORMATION BEGINNING POINT               GDE00620
       TIX     DEL10,4,1      AND GO TO CHECK IT.                       GDE00630
       TRA     DEL75         TRANSFER IF NO MORE FIELDS.                GDE00640
 DEL70 ZAC                   MAKE COMMAND WORD COUNT EQUAL              GDE00650
       STD*    DEL27          ZERO FOR EVERY DELETED RECORD.            GDE00660
       CLA     WTFCT         UPDATE COUNT OF DELETED OR                 GDE00670
       ADD     ONE            DEPADDED RECORDS OF                       GDE00680
       STO     WTFCT          THIS WRITE LIST.                          GDE00690
       CLA     DELCT         UPDATE COUNT                               GDE00700
       ADD     ONE            OF ALL                                    GDE00710
       STO     DELCT          DELETED RECORDS.                          GDE00720
 DEL75 TIX     DEL05,1,1     GO CHECK NEXT RECORD, IF THERE IS ONE.     GDE00730
 DEL80 AXT     **,1          RESTORE                                    GDE00740
 DEL82 AXT     **,2           INDEX                                     GDE00750
 DEL85 AXT     **,4           REGISTERS.                                GDE00760
       STL     GENPR-5                                                  GDE00770
       TRA     1,4           RETURN TO MAIN PROGRAM.                    GDE00780
       SPACE                                                            GDE00790
       COMMON  102                                                      GDE00800
 DELPR COMMON  2              DELETE CARD PARAMETERS                    GDE00810
       COMMON  7                                                        GDE00820
 CALPR COMMON  50             CALCULATED PARAMETERS                     GDE00830
 GENPR COMMON  10             GENERAL PARAMETERS                        GDE00840
 RAWPR COMMON  30            READ AND WRITE PARAMETERS                  GDE00850
 CNTPR COMMON  20             COUNT PARAMETERS                          GDE00860
 ERAPR COMMON  30             ERASABLE STORAGE PARAMETERS               GDE00870
       SPACE                                                            GDE00880
 DELCF EQU     DELPR-0       (ADDRESS OF DELETE CONTROL FIELDS)         GDE00890
 ERCLH EQU     CALPR-8       (EFFECTIVE RECORD LENGTH)                  GDE00900
 DELCT EQU     CNTPR-9       (COUNT OF DELETED RECORDS)                 GDE00910
 WBASE EQU     ERAPR-11      (LOCATION AND LENGTH OF WRITE TABLE)       GDE00920
 WTFCT EQU     CNTPR-12      (WRITE TABLE FIXER COUNT)                  GDE00930
       SPACE                                                            GDE00940
  ONE          1                                                        GDE00950
       SPACE   2                                                        GDE00960
       END                                                              GDE00970
* 7090/94 SORT VER 7 MOD 8 FINAL MERGE, PHASE 3                      (8)HFM00000
*      FAP
       COUNT   1900                                                     HFM00010
       ENTRY   HYFIMR                                                   HFM00020
       ENTRY   FIMRG                                                    HFM00030
       SST                                                              HFM00040
       TITLE                                                            HFM00050
*  CARD EVF00010 IS THE COUNT CARD (COUNT GIVEN IS 1900).               HFM00060
       SPACE   3                                                        HFM00070
*  THIS SUBPROGRAM PERFORMS THE SAME FUNCTIONS AS THE                   HFM00080
*   SUBPROGRAM NAMED FIMRG (SERIAL EVF), BUT INCORPORATES               HFM00090
*   THE ADDITIONAL CAPABILITY OF PROCESSING INPUT READ                  HFM00100
*   FROM HYPERTAPES IN FORWARD OR BACKWARD MODE.  IF HYPER-             HFM00110
*   TAPES ARE USED, THIS SUBPROGRAM IS LOADED IN LIEU OF                HFM00120
*   FIMRG.  SEE THE COMMENTS AT THE BEGINNING OF FIMRG FOR              HFM00130
*   A DETAILED DESCRIPTION OF OPERATION.                                HFM00140
       SPACE                                                            HFM00150
HYFIMR BSS     0                                                        HFM00160
FIMRG  SXA     FMXR4,4                                                  HFM00170
       TXI     *+1,4,-1 ADJUST FOR DELETE RETURN TO BE 4,4 FROM RESTA(2)HFM00179
       SXD     GEN03,4     PLACE DELETE JOB RETURN AVAILABLE TO RESTART HFM00180
       SXA     FM777,2       SAVE 1ST USABLE LOCATION, GIVEN BY LOADER. HFM00190
       AXT     3,2           SET PHASE                                  HFM00200
       SXA     GEN00,2        TO 3.                                     HFM00210
       STL     RAW04                                                    HFM00220
*                                                                       HFM00230
*  INITIALIZATION                                                       HFM00240
       NZT     FLIP                                                     HFM00250
       TRA     MODTST                                                   HFM00260
       CAL     CAL16                                                    HFM00270
       SBM     =2                                                       HFM00280
       SLW     CAL16                                                    HFM00290
MODTST ZET     MOD43                                                    HFM00300
       CALL    DFMM04 ************CE DEBUG MOD*****                     HFM00310
       LDQ     =O76100000000 SET UP MODIFICATION SWITCHES.              HFM00320
       ZET     MOD18                                                    HFM00330
       SLQ     NOM04                                                    HFM00340
       AXT     30,4                                                     HFM00350
       CLA     ERA20                                                    HFM00360
       STZ     ERAPR+1,4     CLEAR OUT ERASABLE PARAMETERS.             HFM00370
TIX    TIX     *-1,4,1                                                  HFM00380
       STO     ERA20                                                    HFM00390
       CAL     FIL01         COMPUTE LOCATION OF WORD WHICH             HFM00400
       SUB     =5             CONTAINS BLOCKSIZE SPECIFIED IN           HFM00410
       STA     CMPAR          CONTROL CARD FOR OUTPUT FILE.             HFM00420
       AXT     VF042,1       SET UP COMMUNICATION WITH DELETE.          HFM00430
       SXA     ERA11,1                                                  HFM00440
       CAL     TIX                                                      HFM00450
       STT     MVSTO                                                    HFM00460
       CAL     CNT09         MOVE PHASE 1 DELETE COUNT OUT OF           HFM00470
       SLW     CNT08          THE WAY AND INTO A CELL WHERE POST        HFM00480
       STZ     CNT09          PROCESSOR WILL FIND IT.                   HFM00490
       CAL     CAL16                                                    HFM00500
       ADM     FM777         COMPUTE ARWD.                              HFM00510
       ORA     =O200000                                                 HFM00520
       LXA     ARWDR,1                                                  HFM00530
       STA*    ARWDR,1                                                  HFM00540
       TIX     *-1,1,1                                                  HFM00550
       STO     ERA04                                                    HFM00560
       ADM     CAL16         COMPUTE ADDR.                              HFM00570
       LXA     ADDRR,1                                                  HFM00580
       STA*    ADDRR,1                                                  HFM00590
       TIX     *-1,1,1                                                  HFM00600
       STO     ERA03                                                    HFM00610
       LXA     CAL16,1       PUT TAG OF 4                               HFM00620
       STA     INIT1          INTO ALL ADDR WORDS                       HFM00630
       CAL     CAL17         MAXIMUM MERGE BLOCK SIZE.                  HFM00640
       ALS     18                                                       HFM00650
       STD     MBLKDC                                                   HFM00660
       CAL     TAG4                                                     HFM00670
INIT1  SLW     **,1                                                     HFM00680
       TIX     *-1,1,1                                                  HFM00690
       AXT     FLWD,1                                                   HFM00700
       SXA     ERA05,1                                                  HFM00710
       AXT     BASE1,1                                                  HFM00720
       SXA     ERA08,1                                                  HFM00730
       LXA     MORDER,1                                                 HFM00740
LER8   TXH     NOER8,1,0     ERROR IF ZERO (NO MERGE ORDER GIVEN).      HFM00750
       TSX     BUGPR2,4      PRINT ERROR MESSAGE.                       HFM00760
       PZE     LER8                                                     HFM00770
NOER8  ZET     NWDCF         NO. OF WORDS IN CONTROL FIELD MUST         HFM00780
       TRA     NOER13         NOT BE ZERO.                              HFM00790
       TSX     BUGPR2,4                                                 HFM00800
       PZE     NOER8                                                    HFM00810
NOER13 CAL     INIT1         INITIALIZE ADDRESSES OF CONTROL            HFM00820
       ADM     NWDCF          FIELD REFERENCE TABLE.                    HFM00830
       STA     K1+1,1                                                   HFM00840
       TIX     *-2,1,1                                                  HFM00850
       ADM     NWDCF                                                    HFM00860
       STO     FMSC          INIT. LOC. OF CF FOR SEQ. CHK.             HFM00870
       LXA     NWDCF,1                                                  HFM00880
       STZ*    FMSC          CLEAR THIS CONTROL FIELD AREA.             HFM00890
       TIX     *-1,1,1                                                  HFM00900
       LXA     CAL16,1       INIT. NO. OF AVAILABLE AREAS.              HFM00910
       SXA     NAVLA,1                                                  HFM00920
       ADM     CAL16                                                    HFM00930
       STA     INIT2                                                    HFM00940
       STA     BAAPL                                                    HFM00950
       PXD     ,0                                                       HFM00960
       ADD     =1            INITIALIZE LIST OF AVAILABLE AREAS.        HFM00970
INIT2  STA     **,1                                                     HFM00980
       TIX     *-2,1,1                                                  HFM00990
       CAL     INIT2                                                    HFM01000
       ADM     MORDER        COMPUTE BASE OF LIST OF NOS. OF            HFM01010
       STA     (1)            RESERVE BLOCKS IN MEMORY.                 HFM01020
       LXA     MORDER,1      CLEAR THIS                                 HFM01030
       STZ*    (1)            TABLE.                                    HFM01040
       TIX     *-1,1,1                                                  HFM01050
       AXT     1,1                                                      HFM01060
       ADM     MORDER        BASE OF LIST OF NOS. OF UNMERGED           HFM01070
       STA     NUMB           BLOCKS IN MEMORY.                         HFM01080
       STA     B1308                                                    HFM01090
       LXA     MORDER,1      CLEAR THIS TABLE.                          HFM01100
       STZ*    NUMB                                                     HFM01110
       TIX     *-1,1,1                                                  HFM01120
       ADM     =2                                                       HFM01130
       STA     WRBF1                                                    HFM01140
       STA     MVSTO                                                    HFM01150
       ADM     =4                                                       HFM01160
       ADM     OBFRL                                                    HFM01170
       STA     WRBF2                                                    HFM01180
       ADD     =4                                                       HFM01190
       ADM     OBFRL                                                    HFM01200
       STA     INIT1                                                    HFM01210
       LXA     CAL16,1                                                  HFM01220
       NZT     RAW21         BACKWARD READ.                             HFM01230
       TRA     REF7-1        NO                                         HFM01240
       ALS     18            YES.                                       HFM01250
       ADM     MBLKDC                                                   HFM01260
REF13  STD     (ADDR),1                                                 HFM01270
       ADM     =O4000000                                                HFM01280
       TIX     REF13-1,1,1                                              HFM01290
       NZT     SAM05                                                    HFM01300
       TRA     BFRBLD                                                   HFM01310
       LXA     CAL16,1                                                  HFM01320
       AXT     ADRRS+18,2                                               HFM01330
       SXA     REF7,2                                                   HFM01340
       SXA     ADDRS,2                                                  HFM01350
       CAL     INIT1                                                    HFM01360
REF7   STA     (ADDR),1      INITIALIZE LOCATIONS OF AREAS.             HFM01370
       ADM     CAL17         MAXIMUM MERGE BLOCK SIZE.                  HFM01380
       ADD     =4                                                       HFM01390
       TIX     REF7,1,1                                                 HFM01400
BFRBLD NZT     FLIP          HYPER AND STRAIGHT FROM PHASE1.            HFM01410
       TRA     UZUAL         NO.                                        HFM01420
       STA     RDBFR1        YES.BUILD UP TWO READ BUFFERS.             HFM01430
       ADM     CAL17         MAXIMUM MERGE BLOCK SIZE.                  HFM01440
       ADM     =4                                                       HFM01450
       STA     RDBFR2                                                   HFM01460
       TRA     UZUAL                                                    HFM01470
UZUAL  AXT     1,1                                                      HFM01480
       ZET     OPT01         ARE RECORD CHECKSUMS PRESENT.              HFM01490
       SXA     PRECT,1       YES.  INITIALIZE FOR CHECKSUMS.            HFM01500
       LXA     PRECT,1                                                  HFM01510
       ZET     OPT03         ARE RECORD SEQUENCE WORDS PRESENT.         HFM01520
       TXI     *+1,1,1       YES.  INCREASE COUNT OF WORDS PRECEDING    HFM01530
       SXA     PRECT,1        RECORD CONTROL WORD.                      HFM01540
       NZT     REC05         IS THIS VARIABLE MERGE.                    HFM01550
       STZ     PRECT         NO.  MAKE PRE-COUNT ZERO.                  HFM01560
       LXA     PRECT,1                                                  HFM01570
       SXD     TXI4,1                                                   HFM01580
       LXA     CAL10,1                                                  HFM01590
       SXD     TXI1,1                                                   HFM01600
       SXD     TXI3,1                                                   HFM01610
       LXA     MORDER,1                                                 HFM01620
       SXA     STRVD,1       SET ALL FILES STARVED.                     HFM01630
       SXA     INORD,1       INTERNAL MERGE ORDER.                      HFM01640
       SXA     EXORD,1       EXTERNAL MERGE ORDER.                      HFM01650
       TXI     *+1,1,-1                                                 HFM01660
       SXD     (1.4),1                                                  HFM01670
       SXD     (2.5),1                                                  HFM01680
       NZT     REC05         IS THIS VARIABLE RECORD MERGE.             HFM01690
       TRA     BYOND         NO.                                        HFM01700
*  INITIALIZE SWITCHES FOR VARIABLE MERGE.                              HFM01710
       AXT     VARLEN,2                                                 HFM01720
       SXA     TRA1,2                                                   HFM01730
       AXT     VARIN,2                                                  HFM01740
       SXA     TRA2,2                                                   HFM01750
       AXT     SW3+1,2                                                  HFM01760
       NZT     GEN01         TEST THE INPUT MODE.                       HFM01770
       TRA     INBCD         BCD INPUT.                                 HFM01780
       ZET*    FIL01         BINARY IN.  TEST THE OUTPUT.               HFM01790
       TRA     INSW2         BINARY OUT.                                HFM01800
       SXA     SW3,2         BCD OUT.  SET SWITCH 3 FOR CONVERT.        HFM01810
       STL     ALTER          SET CELL NONZERO FOR BIN. TO BCD CONV.    HFM01820
INBCD  ZET*    FIL01         TEST THE OUTPUT.                           HFM01830
       SXA     SW3,2         BINARY OUT.  SET SWITCH 3 FOR CONVERT.     HFM01840
       TRA     INSW2                                                    HFM01850
*                                                                       HFM01860
BYOND  AXT     FIXLEN,2                                                 HFM01870
       SXA     TRA1,2                                                   HFM01880
       AXT     FIXIN,2                                                  HFM01890
       SXA     TRA2,2                                                   HFM01900
INSW2  AXT     SW2+1,1       TRANSFER ADDRESS FOR SWITCH 2.             HFM01910
       NZT     DEL00         NON-ZERO IF DELETE OPTION SPECIFIED.       HFM01920
       ZET     OPT01         NON-ZERO IF CHECKSUMS SPECIFIED.           HFM01930
       SXA     SW2,1         SET SWITCH.                                HFM01940
       NZT     SAM04         IS THERE INPUT FROM PREVIOUS PHASE.        HFM01950
       TRA     FM03          NO.  STRAIGHT MERGE.                       HFM01960
       ZET     SAM05         YES.  IS THERE ALSO EXTERNAL MERGE INPUT.  HFM01970
       TRA     FM04          YES.  PRINT LOAD MESSAGES.                 HFM01980
       TRA     FINIT         NO EXTERNAL MERGE INPUT.                   HFM01990
FM03   BSS     0             STRAIGHT MERGE.  PUT MINUS SIGN            HFM02000
       LXA     MORDER,2       ON ALL TAPE TABLE ENTRIES AND PUT         HFM02010
EXIN1  TXI     *+1,2,-1       LOCATION OF FILE DATA BLOCK FOR EACH      HFM02020
       CLA     FIL02,2        FILE INTO DECREMENT OF ITS CORRES-        HFM02030
       ALS     18             PONDING TABLE ENTRY.                      HFM02040
       LDI     =O100000000000 IF REWIND BIT IS ON,                      HFM02050
       OFT*    CHA03          SAVE IT.                                  HFM02060
       ORA     =O100000000000                                           HFM02070
       SSM                                                              HFM02080
       XCA                                                              HFM02090
       SLQ*    CHA03                                                    HFM02100
       TXH     EXIN1,2,0                                                HFM02110
       CLS     =O77777000000                                            HFM02120
       STO     RAW00         OPEN CKPT-UNREADABLE                       HFM02130
       CALL    IOPEN         RECORD TAPE.                               HFM02140
       TRA     FINIT         GO FINISH INITIALIZATION.                  HFM02150
FM04   BSS     0             SORT AND MERGE.                            HFM02160
       CLA     CHA03         LOC. OF INPUT CHANNEL TAPE TABLE.          HFM02170
       STA     FM06                                                     HFM02180
       LXA     CNT15,2       NO. OF STRINGS OUTPUT LAST PHASE.          HFM02190
       LXA     SAM02,1       NO. OF EXTERNAL FILES.                     HFM02200
       SXD     SMIN2,1                                                  HFM02210
       AXT     1,1                                                      HFM02220
FM05   CAL     *             MINUS FLAGS TAPE TO BE EXTERNAL FILE.      HFM02230
       ORA*    CHA03         SAVE REWIND BIT IN POS 2.                  HFM02240
       STP*    CHA03         IR2 HAS VALUE EXPLAINED BELOW.             HFM02250
       CLA     FIL01,1       IR1 STARTS AT 1, ADDS 1 FOR                HFM02260
*                             EACH EXTERNAL TAPE LOADED.                HFM02270
       PDX     ,4            SAVE FILE NO. FOR MESSAGE.                 HFM02280
       ALS     18                                                       HFM02290
       STD*    CHA03         IR2 HAS (NO. OF STRINGS OUTPUT FROM        HFM02300
*                             LAST PHASE) + (LOGICAL POSITION           HFM02310
*                             OF THIS MERGE FILE RELATIVE TO            HFM02320
*                             THE OTHER EXTERNAL MERGE FILES, BE-       HFM02330
*                             GINNING WITH 1) - 1.                      HFM02340
       PXA     ,4            RETRIEVE FILE NO. FOR MESSAGE.             HFM02350
       TSX     (DECVA,4      CONVERT FILE NO.                           HFM02360
       STQ     LDMS01+3      INSERT INTO MESSAGE.                       HFM02370
FM06   LDQ*    **,2          GET UCW NO. 1.                             HFM02380
       TSX     MSGSUP,4,3    PRINT LOAD MESSAGE                         HFM02390
       PZE     LDMS01,,4+512*2                                          HFM02400
       TSX     (PAUSE,4      OPERATOR ACTION PAUSE.                     HFM02410
       TXI     *+1,1,1                                                  HFM02420
       TXI     *+1,2,1                                                  HFM02430
SMIN2  TXL     FM05,1,**     (NO. OF EXTERNAL FILES)                    HFM02440
*                            GO ON WHEN ALL EXTERNAL TAPES ARE LOADED.  HFM02450
FINIT  BSS     0                                                        HFM02460
       ZET     MOD15         TEST FOR MOD PROGRAM.                      HFM02470
       CALL    FMM01                                                    HFM02480
       AXT     0,1                                                      HFM02490
       LXA     MORDER,2                                                 HFM02500
INIT9  TXI     *+1,1,1                                                  HFM02510
       PXD     ,1                                                       HFM02520
       STO     RAW00                                                    HFM02530
       ZET     ERA20         PUT FILE NO. INTO                          HFM02540
       STD*    ERA20          LABEL.                                    HFM02550
       CALL    IOPEN         OPEN ALL INPUT TAPES.                      HFM02560
       TIX     INIT9,2,1                                                HFM02570
       CLS     =0                                                       HFM02580
       STO     RAW00                                                    HFM02590
       CALL    IOPEN         OPEN OUTPUT TAPE.                          HFM02600
       STL     RAW02         SET READ COMPLETE.                         HFM02610
       STZ     EOFI          SET NO EOF TO BEGIN WITH.                  HFM02620
       ZET     REC05         IS THIS FIXED LENGTH MERGE.                HFM02630
       TRA     NOPAD1        NO.  NO LOW PADDING.                       HFM02640
       ZET     SAM05         IS THERE EXTERNAL MERGE INPUT.             HFM02650
       TRA     NOPAD1        YES.  LOW PADDING NOT LEGITIMATE.          HFM02660
       LAC     FIL01,4       GET MINUS LOC. OF OUTPUT FILE BLOCK.       HFM02670
       LDI     -2,4          PADDING INDICATOR.                         HFM02680
       RNT     1             IS LOW PADDING SPECIFIED.                  HFM02690
       TRA     NOPAD1        NO.  LEAVE PADDING TO THE LAST.            HFM02700
       CAL     CNT01         RECORD COUNT FROM PHASE 2.                 HFM02710
       TNZ     *+2           PERHAPS PHASE 2 WAS SKIPPED, IN WHICH      HFM02720
       CAL     CNTPR          CASE GET RECORD COUNT, PHASE 1.           HFM02730
       LRS     35            DIVIDE BY OUTPUT BLOCKING.  REMAINDER      HFM02740
       DVP     CAL02          MUST BE PADDED.                           HFM02750
       TZE     NOPAD1        GET NO. OF PADDING RECORDS NEEDED.         HFM02760
       SUB     CAL02                                                    HFM02770
       STA     WRCT          INITIALIZE WRITE COUNT.                    HFM02780
       STA     CNT10         INITIALIZE COUNT FOR POST PROCESSOR.       HFM02790
       PAX     ,1            NO. OF PADDING RECORDS.                    HFM02800
       XCL                                                              HFM02810
       MPY     REC02                                                    HFM02820
       STQ     BLKSZ                                                    HFM02830
       CAL     CAL19         LOC. OF LOW PADDING RECORD.                HFM02840
       TSX     MVPAD,4                                                  HFM02850
NOPAD1 BSS     0                                                        HFM02860
FSTRD  STL     INITR         SET SWITCH FOR INITIAL READS.              HFM02870
       NZT     STRVD                                                    HFM02880
       TRA     SORT                                                     HFM02890
TSTR1  ZET SWCHR             TEST FOR END OF REEL.                      HFM02900
       TSX     SWCHR,4       GO SERVICE END OF REEL.                    HFM02910
       NZT     RAW02                                                    HFM02920
       TRA     TSTR1         READ STILL IN PROGRESS.                    HFM02930
       TSX     READ,4                                                   HFM02940
       TRA     FSTRD                                                    HFM02950
*  END OF INITIALIZATION.                                               HFM02960
       EJECT                                                            HFM02970
*  BEGINNING OF MAIN FLOW.                                              HFM02980
       SPACE                                                            HFM02990
B0202  ZET     STRVD         ARE THERE ANY STARVED FILES.               HFM03000
       TRA     B0604         YES.  MUST READ.                           HFM03010
*  NOW FIND NEXT RECORD TO BE MERGED.  IT BELONGS TO FILE WHOSE NO.     HFM03020
*   IS IN K1 (1ST CFWD).                                                HFM03030
       LXD     K1,2          FILE NO.                                   HFM03040
       ZET     CUTSW         IS THIS RECORD TO BE DROPPED.              HFM03050
       TRA     UPFIL         YES.  JUST UPDATE FLWD.                    HFM03060
       CAL     FLWD,2        COMPUTE LOCATION OF VERY                   HFM03070
       STA     LOC1           1ST WORD OF RECORD.                       HFM03080
       ADM     PRECT         FIND LOCATION OF 1ST WORD OF               HFM03090
       STA     LOC2           RECORD PROPER.                            HFM03100
TRA1   TRA     **            (GO TO FIXLEN OR VARLEN).                  HFM03110
INLEN1 STA     LEN1          INITIALIZE OUTPUT RECORD LENGTH.           HFM03120
TRA2   TRA     **            (GO TO FIXIN OR VARIN).                    HFM03130
INLEN2 STA     LEN2          INITIALIZE TOTAL RECORD LENGTH.            HFM03140
       ADM     LOC1          COMPUTE BASE OF RECORD IN                  HFM03150
       STA     BASE2          INPUT AREA.                               HFM03160
       CAL     LOC2          COMPUTE BASE OF PORTION TO                 HFM03170
       ADM     LEN1           BE MOVED.                                 HFM03180
       STA     BASE1                                                    HFM03190
       CAL     BLKSZ         FIND SIZE OF OUTPUT BLOCK, SHOULD          HFM03200
       ADM     LEN1           THIS RECORD GO.  COMPARE WITH             HFM03210
CMPAR  LAS     **             SIZE SPECIFIED IN FILE BLOCK.             HFM03220
       TRA     B1203         THIS RECORD IS LARGE.  MAYBE IT CANNOT GO. HFM03230
       TRA     *+1           TENTATIVELY ACCEPT                         HFM03240
ACCEPT STA     BLKSZ          THE RECORD.                               HFM03250
UPFIL  CAL     FLWD,2        UPDATE FLWD TO POINT AT NEXT               HFM03260
       ADM     LEN2           RECORD IN THE AREA.                       HFM03270
       STA     FLWD,2                                                   HFM03280
       ZET     CUTSW         IS THIS RECORD TO BE DROPPED.              HFM03290
       TRA     B1808         YES.                                       HFM03300
*  NEXT MODIFICATION SWITCH IS CONVENIENT FOR OMITTING RECORDS IN THE   HFM03310
*   OUTPUT.                                                             HFM03320
*  BYPASS TO SYMBOLIC LOCATION B1808, PRESERVING XR2 WILL               HFM03330
*   ACCOMPLISH THIS.                                                    HFM03340
*  IF A RECORD IS TO BE DROPPED, BE SURE TO REDUCE WORD COUNT IN CELL   HFM03350
*   CALLED BLKSZ.  THIS REFLECTS SIZE OF OUTPUT BLOCK BUILT SO FAR.     HFM03360
NOM04  TRA     SW2                                                      HFM03370
       CALL    FMM04                                                    HFM03380
       TRA     B1808                                                    HFM03390
       SPACE                                                            HFM03400
*  SUBROUTINE TO HANDLE DELETIONS + CHECKSUMS.                          HFM03410
*  NEXT INSTRUCTION IS TRA *+1 IF DELETE OR CHECKSUM OPTIONS SPECIFIED. HFM03420
SW2    TRA     SW3                                                      HFM03430
       NZT     MOD45                                                    HFM03440
       TRA     *+4                                                      HFM03450
       SXA     *+2,4         SAVE XR4.                                  HFM03460
       CALL    DFMM06 ************CE DEBUG MOD*****                     HFM03470
       AXT     **,4          RESTORE XR4.                               HFM03480
       STZ     OUT           RESET SWITCH.                              HFM03490
       ZET     DEL00         IS DELETE OPTION SPECIFIED.                HFM03500
       TRA     VF035         YES.  GO CALL DELETE, THEN RETURN.         HFM03510
VF029  ZET     OPT01         IS CHECKSUM SPECIFIED.                     HFM03520
       TRA     VF037         YES.  GO COMPUTE CHECKSUM AND RETURN.      HFM03530
VF030  NZT     OUT           IS RECORD TO BE DROPPED.                   HFM03540
       TRA     KEEP          NO.                                        HFM03550
       CAL     BLKSZ         YES.  REDUCE SIZE OF                       HFM03560
       SUB     LEN1           OUTPUT BLOCK BY LENGTH OF                 HFM03570
       STA     BLKSZ          THIS RECORD.                              HFM03580
KEEP   LXD     K1,2          RESTORE REGISTERS FOR EXIT.                HFM03590
       ZET     OUT           WAS THIS RECORD TO BE DROPPED.             HFM03600
       TRA     B1808         YES.                                       HFM03610
       TRA     SW3                                                      HFM03620
*  DELETE OPTION SPECIFIED.                                             HFM03630
VF035  LXA     LOC2,2        PUT LOCATION AND LENGTH OF RECORD          HFM03640
       SXA     VF042,2        INTO COMMUNICATION                        HFM03650
       LXA     LEN1,2         CELL FOR                                  HFM03660
       SXD     VF042,2        DELETE.                                   HFM03670
       CALL    DELETE                                                   HFM03680
       LXD     VF042,2       ZERO IF RECORD IS TO BE DELETED.           HFM03690
       TXH     VF029,2,0     TRANSFER IF RECORD KEPT.                   HFM03700
       STL     OUT           RECORD IS OUT.                             HFM03710
       TRA     VF030                                                    HFM03720
VF037  LAC     LOC2,4        MINUS LOC. OF RECORD.                      HFM03730
       LXA     LEN2,1        RECORD LENGTH.                             HFM03740
       ZET     OPT03         ADJUST FOR SEQUENCE AND                    HFM03750
       TXI     *+1,1,-1       CHECKSUM WORDS.                           HFM03760
       TXI     *+1,1,-1                                                 HFM03770
       PXA     ,1                                                       HFM03780
       ADM     LOC2          COMPUTE BASE OF RECORD FOR CHECKSUM        HFM03790
       STA     ADDCK                                                    HFM03800
       PXD     ,0            CLEAR AC.                                  HFM03810
ADDCK  ACL     **,1                                                     HFM03820
       TIX     ADDCK,1,1                                                HFM03830
       NZT     OPT03         IS RECORD SEQUENCE WORD PRESENT.           HFM03840
       TRA     VF041         NO.  GO COMPARE CHECKSUMS.                 HFM03850
       ZET     REC05         YES.  IS THIS FIXED RECORD MERGE.          HFM03860
       TRA     VF039         NO.                                        HFM03870
       AXT     0,1           YES.  ADD SEQUENCE WORD AT END OF          HFM03880
       XEC     ADDCK          RECORD.                                   HFM03890
       AXT     -1,1          COMPARE CHECKSUMS FOR                      HFM03900
TESTCK ERA*    ADDCK         FIXED RECORD.                              HFM03910
       TZE     VF030         TRANSFER IF CKSUM OK.                      HFM03920
       TRA     BADCK         BAD CHECKSUM, FIXED LENGTH RECORD.         HFM03930
VF039  ACL     -2,4          VARIABLE LENGTH RECORD.  ADD SEQUENCE NO.  HFM03940
VF040  ERA     -1,4          COMPARE CHECKSUMS, VARIABLE RECORD.        HFM03950
       TZE     VF030         TRANSFER IF O.K.                           HFM03960
       TRA     BADCK         BAD CHECKSUM, VARIABLE LENGTH RECORD.      HFM03970
VF041  ZET     REC05         IS THIS FIXED RECORD MERGE.                HFM03980
       TRA     VF040         NO.  GO COMPARE CHECKSUMS.                 HFM03990
       AXT     0,1           YES.                                       HFM04000
       TRA     TESTCK                                                   HFM04010
BADCK  STL     OUT           BAD CHECKSUM.  DROP THE RECORD.            HFM04020
       CAL     LOC1          SET UP CALLING SEQUENCE                    HFM04030
       STA     DCELL          FOR DUMPING.  LOCATION                    HFM04040
       LGR     15                                                       HFM04050
       TSX     (BCD5X,4                                                 HFM04060
       SLW     CKMES+4                                                  HFM04070
       LXA     LEN2,4         AND LENGTH OF RECORD.                     HFM04080
       SXD     DCELL,4                                                  HFM04090
NODMP  LXD     K1,2          FILE NUMBER.                               HFM04140
       TXI     *+1,2,-1      GET UNIT + PRINT MESSAGE.                  HFM04150
       CAL*    CHA03                                                    HFM04160
       STA     *+1                                                      HFM04170
       LDQ     **                                                       HFM04180
       TSX     MSGSUP,4,3                                               HFM04190
       PZE     CKMES,,8+512*4                                           HFM04200
       CALL    DEBLK                                                 (2)HFM04202
       PZE     DCELL,,1                                              (2)HFM04204
       TSX     (PAWSX,4                                                 HFM04210
       TRA     VF030                                                    HFM04220
CKMES  BCI     8,CKSUM ERROR, RECORD,LOC       *CS03                    HFM04230
VF042  PZE                   COMMUNICATION CELL FOR DELETE.             HFM04240
DCELL  PZE                   CELL TO HOLD DUMPING INFO.                 HFM04250
OUT    PZE                   SWITCH TO SHOW IF RECORD DROPPED.          HFM04260
FIXLEN CAL     REC02         ENTRY HERE IF FIXED LENGTH RECORDS.        HFM04270
       TRA     INLEN1        PROVIDE OUTPUT RECORD SIZE.                HFM04280
VARLEN NZT     GEN01         ENTER HERE IF VARIABLE LENGTH.             HFM04290
       TRA     BCDCV         BCD RECORDS.  GO CONVERT LENGTH.           HFM04300
       CAL*    LOC2          BINARY RECORD.  FIND OUTPUT                HFM04310
       PDX     ,4             LENGTH.                                   HFM04320
       TXI     *+1,4,1                                                  HFM04330
       PXA     ,4                                                       HFM04340
       TRA     INLEN1                                                   HFM04350
FIXIN  CAL     CAL10         ENTRY FOR FIXED INPUT RECORD               HFM04360
       TRA     INLEN2         LENGTH.                                   HFM04370
VARIN  ADM     PRECT         ENTRY FOR VARIABLE INPUT RECORD            HFM04380
       TRA     INLEN2         LENGTH.                                   HFM04390
       SPACE                                                            HFM04400
*  SUBROUTINE TO CONVERT BINARY RECORD CONTROL WORDS TO                 HFM04410
*   BCD OR VICE VERSA.                                                  HFM04420
*  NEXT INSTRUCTION IS TRA *+1 IF THIS CONVERSION IS NECESSARY.         HFM04430
SW3    TRA     B1201                                                    HFM04440
       CAL*    LOC2          GET 1ST WORD OF RECORD, SAVE               HFM04450
       ANA     =O77777000077  WORD COUNT AND RIGHTMOST                  HFM04460
       STA     CHARC          CHARACTER.                                HFM04470
       ZET     ALTER                                                    HFM04480
       TRA     BINTO         BINARY TO BCD.                             HFM04490
       CAL     LEN1          BCD TO BINARY                              HFM04500
       ALS     18                                                       HFM04510
       SUB     =O1000000                                                HFM04520
       ORA     =O500000200000                                           HFM04530
       TRA     REPLA                                                    HFM04540
BINTO  LDQ     LEN1          LENGTH OF OUTPUT RECORD.                   HFM04550
       MPY     =6            CHANGE TO CHARACTER COUNT, THEN            HFM04560
       XCL                    CONVERT BINARY TO                         HFM04570
       TSX     (DECVA,4       BCD.                                      HFM04580
       XCL                   ANSWER IN MQ.  MOVE TO AC,                 HFM04590
       ALS     6              SHIFT LEFT FOR REPLACING                  HFM04600
REPLA  ORA     CHARC          CHARACTER.                                HFM04610
       SLW*    LOC2          REPLACE 1ST WORD IN RECORD.                HFM04620
B1201  LXA     LEN1,4        MOVE RECORD TO OUTPUT BUFFER.              HFM04630
       CAL     MVSTO         KEEP TRACK OF WHERE RECORD                 HFM04640
       STA     INBUF          BEGINS IN OUTPUT BUFFER.                  HFM04650
       PXA     ,4                                                       HFM04660
       ADM     MVSTO                                                    HFM04670
       STA     MVSTO                                                    HFM04680
BASE1  CLA     **,4          BASE OF RECORD FOR OUTPUT (LOC2+LEN1).     HFM04690
       STO*    MVSTO                                                    HFM04700
       TIX     BASE1,4,1                                                HFM04710
       CAL     LOC1          UPDATE LOCATION OF LAST RECORD             HFM04720
       STA     LASTLC         MERGED.                                   HFM04730
       LDQ     K1            INTERCHANGE CONTROL FIELD POINTERS         HFM04740
       CLA     FMSC           TO MAKE THIS RECORD THE NEW SEQ-          HFM04750
       STA     K1             UENCE CHECK RECORD.                       HFM04760
       STQ     FMSC                                                     HFM04770
       LXA     WRCT,1        UPDATE COUNT OF RECORDS READIED            HFM04780
       TXI     *+1,1,1        FOR WRITING.                              HFM04790
       SXA     WRCT,1                                                   HFM04800
*                                                                       HFM04810
B1808  CAL     FLWD,2                                                   HFM04820
       PDX     ,4                                                       HFM04830
       STZ     CUTSW         RESET SWITCH FOR DROPPING RECORDS.         HFM04840
REF12  CAL     (ARWD),4      UPDATE RECORD COUNT IN AREA WORD.          HFM04850
       PAX     ,1                 **                                    HFM04860
LER4   TXH     NOER4,1,0     TRANSFER IF NO ERROR.                      HFM04870
       TSX     BUGPR2,4      IMPOSSIBLE SITUATION, LOGICALLY.  AREA WORDHFM04880
       PZE     LER4           ALREADY INDICATES AREA EMPTY.             HFM04890
NOER4  SUB     =1                                                       HFM04900
REF1   STA     (ARWD),4                                                 HFM04910
       PAX     ,1            IF RECORD COUNT HAS DROPPED TO             HFM04920
       TXH     B0508,1,0      ZERO, THE AREA IS NOW EXHAUSTED.          HFM04930
       PXA     ,4            AREA IS EXHAUSTED.  PUT ITS NO. IN AC.     HFM04940
       LXA     NAVLA,4                                                  HFM04950
       TXI     *+1,4,1                                                  HFM04960
       SXA     NAVLA,4                                                  HFM04970
       STA*    BAAPL                                                    HFM04980
B1308  CAL     **,2          (BASE OF NO. OF UNMERGED BLOCKS LIST).     HFM04990
LER2   TNZ     NOER2                                                    HFM05000
       TSX     BUGPR2,4      LOGICALLY IMPOSSIBLE SITUATION...WE HAVE   HFM05010
       PZE     LER2           JUST MERGED A BLOCK THAT WASN'T THERE.    HFM05020
NOER2  SUB     =1            REDUCE COUNT OF NO. OF BLOCKS IN MEMORY    HFM05030
       STO*    B1308          FOR THIS FILE.                            HFM05040
       TNZ     STLSM         IF NO MORE UNMERGED BLOCKS                 HFM05050
       CAL     STRVD          FOR THIS FILE, INCREASE                   HFM05060
       ADD     =1             STARVED COUNT BY 1.                       HFM05070
       STA     STRVD                                                    HFM05080
STLSM  BSS     0                                                        HFM05090
LER3   NZT     AJUSX                                                    HFM05100
       TRA     NOER3                                                    HFM05110
       TSX     BUGPR1,4      ERROR IF COME TO HERE.                     HFM05120
       PZE     LER3          MERGING WOULD HAVE OCCURRED WHILE          HFM05130
*                             NO RECORDS WERE AVAILABLE FROM 1 OR MORE  HFM05140
*                             FILES.  OUT OF SORT COULD OCCUR NOW.      HFM05150
NOER3  STL     AJUSX         SET AREA-JUST EXHAUSTED SWITCH.            HFM05160
B0508  ZET     SWCHR         CHECK FOR END OF REEL                      HFM05170
       TSX     SWCHR,4        ACTION.                                   HFM05180
       ZET     RAW02         IS READ IN PROGRESS.                       HFM05190
       TRA     B0511         NO.  READ COMPLETE.                        HFM05200
B0116  ZET     AJUSX         WAS AREA JUST EXHAUSTED.                   HFM05210
       TRA     B0219         YES.                                       HFM05220
B0516  LXD     K1,1          FILE NO., LAST RECORD MERGED.              HFM05230
       CAL     FLWD,1        PUT LOC. OF NEXT REC. INTO CALL. SEQ.      HFM05240
       STA     ERA09          WORD FOR EXTRACT ROUTINE.                 HFM05250
       LXA     K1,4          BASE OF CONTROL FIELD EXTRACTION AREA.     HFM05260
       SXD     ERA09,4       PUT IN CALLING SEQUENCE TO EXTRACT ROUTINE.HFM05270
       CALL    MERXTR        EXTRACT CONTROL FIELD FOR NEXT RECORD TO BEHFM05280
*                             INSERTED INTO CF REFERENCE TABLE.         HFM05290
       LXA     INORD,2                                                  HFM05300
       ZET     MOD44                                                    HFM05310
       CALL    DFMM05 ************CE DEBUG MOD*****                     HFM05320
       TRA*    MERGE+16,2    GO TO APPROPRIATE MERGE COMPARE.           HFM05330
*  AFTER GOING TO MERGE, RETURN HERE.                                   HFM05340
*  NEXT RECORD TO WRITE IS NOW FOUND BY                                 HFM05350
*  MEANS OF K1, WHICH POINTS AT THE EX-                                 HFM05360
*  TRACTED CF (FILE NO. IN DECR).                                       HFM05370
*  FIRST, WE WILL CHECK THE SEQUENCING.  THEN                           HFM05380
*  IF THAT IS OK, WE WILL GO BACK TO                                    HFM05390
*  PUT THE RECORD OUT FOR WRITING.                                      HFM05400
B1816  LXA     NWDCF,1       NO. OF WORDS IN EXTRACTED CONTROL FIELD.   HFM05410
SCCAL  CAL*    FMSC          GET OLD RECORD CONTROL FIELD               HFM05420
       LAS*    K1             AND COMPARE AGAINST NEW.                  HFM05430
       TRA     SEQER         ERROR.  OLD HIGHER THAN NEW.               HFM05440
       TRA     SCTIX         EQUAL SO FAR.  TRY NEXT CF.                HFM05450
       TRA     B0202         SEQUENCE CHECKS OK.                        HFM05460
SCTIX  TIX     SCCAL,1,1     TRY NEXT CF.                               HFM05470
       NZT     MOD16         ALL EQUAL.  DOES USER WANT TO SUMMAR-      HFM05480
       TRA     B0202          IZE.  NO, IF COME HERE.                   HFM05490
       NZT     REC05                                                    HFM05500
       TRA     CALMOD        FIXED.                                     HFM05510
       LXD     K1,2          VARIABLE.                                  HFM05520
       CAL     FLWD,2                                                   HFM05530
       ADM     PRECT                                                    HFM05540
       STA     *+1                                                      HFM05550
       CAL     **                                                       HFM05560
       NZT     GEN01                                                    HFM05570
       TRA     BCDFIL        BCD.                                       HFM05580
       PDX     ,4            BINARY.                                    HFM05590
       TXI     *+1,4,1                                                  HFM05600
       PXA     ,4                                                       HFM05610
       TRA     CALMOD                                                   HFM05620
BCDFIL XCA                   CONVERT BCD TO BINARY.                     HFM05630
       PXD     ,0                                                       HFM05640
       CAQ     DTBT1,0,5                                                HFM05650
       LRS     51                                                       HFM05660
       DVP     =6                                                       HFM05670
       XCL                                                              HFM05680
CALMOD LXD     K1,2          COMPUTE LOCATION OF FIRST               (8)HFM05690
       CAL     FLWD,2         WORD OF NEXT LOGICAL RECORD            (8)HFM05691
       STA     ERA19          FOR USER EXIT PROGRAM                  (8)HFM05692
       CALL    FMM02         RETURN TO 1,4                           (8)HFM05693
       STL     CUTSW          SAYS TO DROP THIS RECORD.                 HFM05700
       TRA     B0202         RETURN TO 2,4 RETAINS THE RECORD.          HFM05710
B1203  LXA     WRCT,4                                                   HFM05720
       TXH     OK,4,0                                                   HFM05730
       NZT     DROPSW                                                   HFM05740
       TRA     *+3                                                      HFM05750
       STL     CUTSW                                                    HFM05760
       TRA     UPFIL                                                    HFM05770
       LDQ     CAL28         IF RECORD TOO LARGE FOR BUFFER,            HFM05780
       TLQ     *+2            MQ IS LOW.                                HFM05790
       TRA     ACCEPT        RECORD FITS IN BUFFER.  ACCEPT IT.         HFM05800
       CAL     DELMS                                                    HFM05810
       ZET     CHA05         IF NO SYSCK2 ATTACHED, CHANGE DUMPED       HFM05820
       SLW     BIGMS1+8       MESSAGE TO DELETED MESSAGE.               HFM05830
       LXA     CAL28,4       MAKE RECORD DUMPED SAME SIZE               HFM05840
       SXD     DCELL,4        AS OUTPUT BUFFER - THAT SHOULD BE ENOUGH. HFM05850
       CAL     LOC1                                                     HFM05860
       STA     DCELL                                                    HFM05870
       LGR     15            GET LOCATION FOR                           HFM05880
       TSX     (BCD5X,4       MESSAGE.                                  HFM05890
       SLW     BIGMS1+2                                                 HFM05900
       CAL     LEN2          GET SIZE FOR MESSAGE.                      HFM05910
       TSX     (DECVA,4                                                 HFM05920
       STQ     SIZMS                                                    HFM05930
       ZET     CHAPR-5                                                  HFM05940
       TRA     *+3                                                      HFM05950
       CALL    DEBLK         DUMP THE RECORD IF SYSCK2                  HFM05960
       PZE     DCELL,,1       IS ATTACHED.                              HFM05970
       TSX     MSGSUP,4,2                                               HFM05980
       PZE     3                                                        HFM05990
       PZE     BIGMS1,,7                                                HFM06000
       PZE     SIZMS,,2                                                 HFM06010
       PZE     BIGMS2,,5                                                HFM06020
       TSX     (PAUSE,4                                                 HFM06030
       LXD     GENPR-3,4                                                HFM06040
       TRA     4,4                                                      HFM06050
OK     STL     WRTRQ         SET SWITCH REQUESTING A WRITE.             HFM06060
       TRA     B1005         GO TO READ-WRITE.                          HFM06070
*  AT LEAST ONE FILE IS STARVED.  WE MUST READ, IF POSSIBLE.            HFM06080
B0604  STL     MSTGT         SET MUST-GET SWITCH.                       HFM06090
B1005  BSS     0                                                        HFM06100
       NZT     NAVLA         IS THERE AN AREA AVAILABLE FOR READING.    HFM06110
       TRA     B0705         NO.                                        HFM06120
*  READ-WRITE PROVIDER ROUTINE.                                         HFM06130
PR1    ZET     RAW04         AT LEAST ONE AREA OPEN.                    HFM06140
       TRA     PR7           WRITE NOT IN PROGRESS.                     HFM06150
PR2    ZET     SWCHR         WRITE IN PROGRESS.  TEST FOR END OF REEL.  HFM06160
       TSX     SWCHR,4                                                  HFM06170
       NZT     RAW02         IS READ IN PROGRESS.                       HFM06180
       TRA     PR8           YES.  IS WRITE REQUESTED.                  HFM06190
       ZET     NAVLA                                                    HFM06200
PR3    TSX     READ,4        READ NOT IN PROGRESS.  CALL READ ROUTINE.  HFM06210
PR4    NZT     WRTRQ         IS WRITE REQUESTED.                        HFM06220
       TRA     B0116         NO.  GO ON.                                HFM06230
PR5    NZT     RAW04         YES.  IS WRITE IN PROGRESS.                HFM06240
       TRA     *-1           YES.  WAIT.                                HFM06250
PR6    TSX     WRITE,4       NO.  GO AHEAD + WRITE.                     HFM06260
       TRA     PR2           GO TRY TO READ.                            HFM06270
PR7    NZT     WRTRQ         IS WRITE REQUESTED.                        HFM06280
       TRA     PR2           NO.  TRY TO READ.                          HFM06290
       TRA     PR6           YES.  GO TO WRITE.                         HFM06300
PR8    ZET     WRTRQ         IS WRITE REQUESTED.                        HFM06310
       TRA     PR1           YES.  START OVER.                          HFM06320
       ZET     MSTGT         NO.  IS READ REQUESTED.                    HFM06330
       TRA     PR2           YES.  TRY TO READ.                         HFM06340
       TRA     B0116         NO.  GO ON.                                HFM06350
*                                                                       HFM06360
B0705  NZT     MSTGT         IS THIS READ REQUEST.                      HFM06370
       TRA     PR1           NO.                                        HFM06380
       ZET     RAW02         IS READ IN PROGRESS.                       HFM06390
LER14  NZT     SERVC         NO.  WAS LAST READ SERVICED.               HFM06400
       TRA     PR8           NO.  MAYBE END OF FILE.                    HFM06410
       TSX     BUGPR2,4      MUST READ, NO AREAS AVAILABLE.             HFM06420
       PZE     LER14                                                    HFM06430
       TRA     *-2                                                      HFM06440
B0511  ZET     NAVLA         ARE ANY AREAS AVAILABLE FOR READ.          HFM06450
       TSX     READ,4        YES.  GO READ.                             HFM06460
       TRA     B0116         GO GET ANOTHER RECORD.                     HFM06470
*  AREA HAS BEEN EXHAUSTED.  GET NEXT BLOCK FOR THIS FILE.              HFM06480
B0219  LXD     K1,1          FILE NO.                                   HFM06490
       CLA*    NUMB          TEST NO. OF UNMERGED BLOCKS FOR THIS FILE. HFM06500
       PAX     ,4                                                       HFM06510
B0619  TXL     B0222,4,0                                                HFM06520
       LDQ*    RSWRT+NRW,4   MOVE RESERVE FILE-WORDS FOR                HFM06530
       XCL                    THIS FILE INTO 1 LOWER                    HFM06540
       STQ*    RSWRT+NRW,4    POSITION EACH, AND PUT                    HFM06550
       TIX     *-3,4,1        NEXT RESERVE BLOCK INTO                   HFM06560
       SLW     FLWD,1         MERGE STATUS.                             HFM06570
       CAL*    (1)           REDUCE COUNT OF RESERVE                    HFM06580
       SUB     =1             BLOCKS IN MEMORY FOR                      HFM06590
LER6   LAS*    (1)           **(SHOULD NOT REDUCE                       HFM06600
       TRA     ER6           ** BEYOND ZERO)                            HFM06610
       TRA     ER6           **                                         HFM06620
       STA*    (1)            THIS FILE.                                HFM06630
       STZ     AJUSX         RESET AREA-JUST-EXHAUSTED SWITCH.          HFM06640
       TRA     B0516                                                    HFM06650
ER6    BSS     0             ERROR.                                     HFM06660
       TSX     BUGPR2,4      COUNT OF RESERVE BLOCKS WAS ZERO OR        HFM06670
       PZE     LER6           LITERAL (=1) WAS OFF.                     HFM06680
       PXD     ,0                                                       HFM06690
       TRA     LER6+3                                                   HFM06700
B0222  TNZ     B0622         TRANSFER IF THIS FILE HAS HIT EOF.         HFM06710
       TRA     B0202                                                    HFM06720
B0622  STZ     AJUSX         RESET AREA-JUST-EXHAUSTED SWITCH.          HFM06730
       LXA     INORD,4                                                  HFM06740
       TXI     *+1,4,-1                                                 HFM06750
       SXA     INORD,4       REDUCE MERGE ORDER BY 1.                   HFM06760
       TXL     FLUSH,4,0                                                HFM06770
       CAL     K1,4                                                     HFM06780
       LDQ     K1+1,4                                                   HFM06790
       XCL                                                              HFM06800
       STQ     K1+1,4                                                   HFM06810
       TIX     *-3,4,1                                                  HFM06820
       TRA     B0516                                                    HFM06830
       EJECT                                                            HFM06840
*  PREPARE FOR FINAL WRITE-OUT OF REMAINING RECORDS.                    HFM06850
FLUSH  LXA     WRCT,4                                                   HFM06860
       TXL     ISC,4,0                                               (4)HFM06870
       ZET     REC05         IS THIS FIXED MERGE.                       HFM06880
       TRA     NOPAD2        NO.  NO PADDING PROBLEMS.                  HFM06890
       LAC     FIL01,4       DOES OUTPUT PADDING INDICATOR              HFM06900
       NZT     -2,4           REQUEST PADDING.                          HFM06910
       TRA     NOPAD2        NO.                                        HFM06920
       LXA     WRCT,1        COUNT OF RECORDS IN OUTPUT                 HFM06930
       PXA     ,1             BUFFER SO FAR.                            HFM06940
       SUB     CAL02         IF BLOCK IS ALREADY FULL,                  HFM06950
       TZE     NOPAD2         NO PADDING NEEDED.                        HFM06960
       PAX     ,1                                                       HFM06970
       STA     CNT11         INITIALIZE COUNT FOR POST PROCESSOR.       HFM06980
       CAL     CAL20         LOC. OF HIGH PADDING RECORD.               HFM06990
       TSX     MVPAD,4                                                  HFM07000
       LXA     CAL02,4                                                  HFM07010
       SXA     WRCT,4                                                   HFM07020
       LXA     CAL28,4                                                  HFM07030
       SXA     BLKSZ,4                                                  HFM07040
NOPAD2 BSS     0                                                        HFM07050
       NZT     RAW04                                                    HFM07060
       TRA     *-1                                                      HFM07070
       TSX     WRITE,4                                                  HFM07080
ISC    NZT     CHAPR-4       INTERSYSTEM UNIT FOR OUTPUT             (4)HFM07081
       TRA     NOWRT         NO.                                     (4)HFM07082
       LAC     FILPR-1,1     YES. -L(FDB) FOR OUTPUT                 (4)HFM07083
       ZET     -15,1                                                 (4)HFM07084
       TRA     NOWRT                                                 (4)HFM07085
       CAL     CHAPR-4       IS SECOND I.S. PARAMETER GIVEN          (4)HFM07086
       PBT                                                           (4)HFM07087
       TRA     NOWRT         NO.                                     (4)HFM07088
       STL     ISCL          YES.                                    (4)HFM07089
       TRA     WREOT         MUST WRITE EOF ON SECOND I.S. UNIT.     (4)HFM0708A
NOWRT  CLS     =0            CLOSE ALL FILES.                           HFM07090
       STO     RAW00                                                    HFM07100
       STO     RAW01         FINAL OUTPUT REEL.                         HFM07110
       CALL    SCL                                                      HFM07120
       LXA     MORDER,1                                                 HFM07130
FINCL  PXD     ,1                                                       HFM07140
       STO     RAW00         ALL INPUT REELS.                           HFM07150
       CALL    SCL                                                      HFM07160
       TIX     FINCL,1,1                                                HFM07170
       CLS     =O77777000000                                            HFM07180
       STO     RAW00                                                    HFM07190
       CALL    SCL           CHECKPOINT-UNREADABLE RECORD TAPE.         HFM07200
       CALL    POSTP                                                    HFM07210
FMXR4  AXT     **,4 RELOAD FOR RETURN.  MQ PRESERVED FOR MONITOR.    (2)HFM07220
       TRA     3,4           RETURN TO SORT MONITOR.                    HFM07230
       EJECT                                                            HFM07240
*  SUBROUTINE TO CONVERT BCD CHARACTER COUNT TO BINARY WORD COUNT.      HFM07250
*  ENTERED FROM VARLEN+1, RETURNS TO INLEN1.                            HFM07260
BCDCV  LDQ*    LOC2          GET RECORD LENGTH WORD.                    HFM07270
       ZET     MOD40                                                    HFM07280
       CALL    DFMM01 ************CE DEBUG MOD*****                     HFM07290
       PXD     ,0            CLEAR AC.                                  HFM07300
       CAQ     DTBT1,0,5     CONVERT BCD TO BINARY.                     HFM07310
       LRS     51            FROM AC (19) TO MQ (35).                   HFM07320
       DVP     =6            CHANGE CHARACTER COUNT TO WORD COUNT.      HFM07330
       XCL                   PUT BACK INTO AC.                          HFM07340
       TRA     INLEN1        RETURN TO MAIN FLOW.                       HFM07350
*  CONVERSION TABLE FOR ABOVE SUBROUTINE.                               HFM07360
DTBT1  DUP     1,10                                                     HFM07370
       VFD     20/**10000-DTBT1*10000,16/DTBT2                          HFM07380
DTBT2  DUP     1,10                                                     HFM07390
       VFD     20/**1000-DTBT2*1000,16/DTBT3                            HFM07400
DTBT3  DUP     1,10                                                     HFM07410
       VFD     20/**100-DTBT3*100,16/DTBT4                              HFM07420
DTBT4  DUP     1,10                                                     HFM07430
       VFD     20/**10-DTBT4*10,16/DTBT5                                HFM07440
DTBT5  DUP     1,10                                                     HFM07450
       VFD     20/**1-DTBT5*1                                           HFM07460
       EJECT                                                            HFM07470
*  ROUTINE TO PUT CONTROL FIELD WORDS (K1,...,K16) INTO SORTED ORDER.   HFM07480
SORT   BSS     0                                                        HFM07490
       LXA     INORD,2                                                  HFM07500
       TXL     FLUSH,2,0                                                HFM07510
       STZ     INITR                                                    HFM07520
SORT1  CAL     K1+1,2                                                   HFM07530
       PDX     ,1                                                       HFM07540
       ALS     18                                                       HFM07550
       STD     ERA09                                                    HFM07560
       CAL     FLWD,1                                                   HFM07570
       STA     ERA09                                                    HFM07580
       CALL    MERXTR                                                   HFM07590
       ZET     MOD41                                                    HFM07600
       CALL    DFMM02 ************CE DEBUG MOD*****                     HFM07610
       TIX     SORT1,2,1                                                HFM07620
SORTF  LXA     INORD,4       DO AS MANY AS                              HFM07630
       TXI     *+1,4,-1       ORDER OF MERGE.                           HFM07640
       TXL     SRTIX+1,4,0                                              HFM07650
       LXA     NWDCF,1                                                  HFM07660
SRCAL  CAL*    K1,4                                                     HFM07670
SRLAS  LAS*    K1+1,4                                                   HFM07680
       TRA     SRTIX                                                    HFM07690
       TRA     SEQTX                                                    HFM07700
       TRA     SINTR                                                    HFM07710
SEQTX  TIX     SRCAL,1,1                                                HFM07720
       CAL*    SRCAL                                                    HFM07730
       LAS*    SRLAS                                                    HFM07740
       TRA     SRTIX                                                    HFM07750
LER15  TRA     ER15                                                     HFM07760
SINTR  CAL*    SRCAL                                                    HFM07770
       LDQ*    SRLAS                                                    HFM07780
       SLW*    SRLAS                                                    HFM07790
       STQ*    SRCAL                                                    HFM07800
       TRA     SORTF                                                    HFM07810
SRTIX  TIX     SRCAL-1,4,1                                              HFM07820
       TRA     B0202                                                    HFM07830
ER15   TSX     BUGPR2,4      EQUALS COMPARE SHOULD                      HFM07840
       PZE     LER15          NEVER OCCUR.                              HFM07850
       TRA     ER15                                                     HFM07860
*  SUBROUTINE TO MOVE PADDING RECORDS TO OUTPUT BUFFER.                 HFM07870
MVPAD  ADD     REC02                                                    HFM07880
       STA     PADGT                                                    HFM07890
       CAL     MVSTO                                                    HFM07900
UP     ADD     REC02                                                    HFM07910
       STA     MVSTO                                                    HFM07920
       STA     PADPT                                                    HFM07930
       LXA     REC02,2                                                  HFM07940
PADGT  LDI     **,2                                                     HFM07950
PADPT  STI     **,2                                                     HFM07960
       TIX     PADGT,2,1                                                HFM07970
       TIX     UP,1,1                                                   HFM07980
       TRA     1,4                                                      HFM07990
*                                                                       HFM08000
       EJECT                                                            HFM08010
*  MERGE LOOPS.                                                         HFM08020
       SPACE                                                            HFM08030
MERGE          C(9)          ORDER IS 16.                               HFM08040
               C(9)                   15.                               HFM08050
               C(9)                   14.                               HFM08060
               C(9)                   13.                               HFM08070
               C(9)                   12.                               HFM08080
               C(9)                   11.                               HFM08090
               C(9)                   10.                               HFM08100
               C(9)                    9.                               HFM08110
               C(5)                    8.                               HFM08120
               C(5)                    7.                               HFM08130
               C(5)                    6.                               HFM08140
               C(5)                    5.                               HFM08150
               C(3)                    4.                               HFM08160
               C(3)                    3.                               HFM08170
               C(2)                    2.                               HFM08180
               ((1)                    1.                               HFM08190
C(2)   LXA     NWDCF,1                                                  HFM08200
GET2   CAL*    K1                                                       HFM08210
       LAS*    K2                                                       HFM08220
       TRA     ((2)                                                     HFM08230
       TRA     TIX2                                                     HFM08240
       TRA     ((1)                                                     HFM08250
TIX2   TIX     GET2,1,1                                                 HFM08260
       CAL     K1                                                       HFM08270
       LAS     K2                                                       HFM08280
       TRA     ((2)                                                     HFM08290
       TSX     ERC,4                                                    HFM08300
       TRA     ((1)                                                     HFM08310
C(3)   LXA     NWDCF,1                                                  HFM08320
GET3   CAL*    K1                                                       HFM08330
       LAS*    K3                                                       HFM08340
       TRA     B3H                                                      HFM08350
       TRA     TIX3                                                     HFM08360
       TRA     C(2)                                                     HFM08370
TIX3   TIX     GET3,1,1                                                 HFM08380
       CAL     K1                                                       HFM08390
       LAS     K3                                                       HFM08400
       TRA     B3H                                                      HFM08410
       TSX     ERC,4                                                    HFM08420
       TRA     C(2)                                                     HFM08430
C(4)   LXA     NWDCF,1                                                  HFM08440
GET4   CAL*    K1                                                       HFM08450
       LAS*    K4                                                       HFM08460
       TRA     ((4)                                                     HFM08470
       TRA     TIX4                                                     HFM08480
       TRA     ((3)                                                     HFM08490
TIX4   TIX     GET4,1,1                                                 HFM08500
       CAL     K1                                                       HFM08510
       LAS     K4                                                       HFM08520
       TRA     ((4)                                                     HFM08530
       TSX     ERC,4                                                    HFM08540
       TRA     ((3)                                                     HFM08550
C(5)   LXA     NWDCF,1                                                  HFM08560
GET5   CAL*    K1                                                       HFM08570
       LAS*    K5                                                       HFM08580
       TRA     B5H                                                      HFM08590
       TRA     TIX5                                                     HFM08600
       TRA     C(3)                                                     HFM08610
TIX5   TIX     GET5,1,1                                                 HFM08620
       CAL     K1                                                       HFM08630
       LAS     K5                                                       HFM08640
       TRA     B5H                                                      HFM08650
       TSX     ERC,4                                                    HFM08660
       TRA     C(3)                                                     HFM08670
C(6)   LXA     NWDCF,1                                                  HFM08680
GET6   CAL*    K1                                                       HFM08690
       LAS*    K6                                                       HFM08700
       TRA     ((6)                                                     HFM08710
       TRA     TIX6                                                     HFM08720
       TRA     ((5)                                                     HFM08730
TIX6   TIX     GET6,1,1                                                 HFM08740
       CAL     K1                                                       HFM08750
       LAS     K6                                                       HFM08760
       TRA     ((6)                                                     HFM08770
       TSX     ERC,4                                                    HFM08780
       TRA     ((5)                                                     HFM08790
C(7)   LXA     NWDCF,1                                                  HFM08800
GET7   CAL*    K1                                                       HFM08810
       LAS*    K7                                                       HFM08820
       TRA     B7H                                                      HFM08830
       TRA     TIX7                                                     HFM08840
       TRA     C(6)                                                     HFM08850
TIX7   TIX     GET7,1,1                                                 HFM08860
       CAL     K1                                                       HFM08870
       LAS     K7                                                       HFM08880
       TRA     B7H                                                      HFM08890
       TSX     ERC,4                                                    HFM08900
       TRA     C(6)                                                     HFM08910
C(8)   LXA     NWDCF,1                                                  HFM08920
GET8   CAL*    K1                                                       HFM08930
       LAS*    K8                                                       HFM08940
       TRA     ((8)                                                     HFM08950
       TRA     TIX8                                                     HFM08960
       TRA     ((7)                                                     HFM08970
TIX8   TIX     GET8,1,1                                                 HFM08980
       CAL     K1                                                       HFM08990
       LAS     K8                                                       HFM09000
       TRA     ((8)                                                     HFM09010
       TSX     ERC,4                                                    HFM09020
       TRA     ((7)                                                     HFM09030
C(9)   LXA     NWDCF,1                                                  HFM09040
GET9   CAL*    K1                                                       HFM09050
       LAS*    K9                                                       HFM09060
       TRA*    B9HI+9,2                                                 HFM09070
       TRA     TIX9                                                     HFM09080
       TRA     C(5)                                                     HFM09090
TIX9   TIX     GET9,1,1                                                 HFM09100
       CAL     K1                                                       HFM09110
       LAS     K9                                                       HFM09120
       TRA*    B9HI+9,2                                                 HFM09130
       TSX     ERC,4                                                    HFM09140
       TRA     C(5)                                                     HFM09150
C(10)  LXA     NWDCF,1                                                  HFM09160
GET10  CAL*    K1                                                       HFM09170
       LAS*    K10                                                      HFM09180
       TRA     ((10)                                                    HFM09190
       TRA     TIX10                                                    HFM09200
       TRA     ((9)                                                     HFM09210
TIX10  TIX     GET10,1,1                                                HFM09220
       CAL     K1                                                       HFM09230
       LAS     K10                                                      HFM09240
       TRA     ((10)                                                    HFM09250
       TSX     ERC,4                                                    HFM09260
       TRA     ((9)                                                     HFM09270
C(11)  LXA     NWDCF,1                                                  HFM09280
GET11  CAL*    K1                                                       HFM09290
       LAS*    K11                                                      HFM09300
       TRA     B11H                                                     HFM09310
       TRA     TIX11                                                    HFM09320
       TRA     C(10)                                                    HFM09330
TIX11  TIX     GET11,1,1                                                HFM09340
       CAL     K1                                                       HFM09350
       LAS     K11                                                      HFM09360
       TRA     B11H                                                     HFM09370
       TSX     ERC,4                                                    HFM09380
       TRA     C(10)                                                    HFM09390
C(12)  LXA     NWDCF,1                                                  HFM09400
GET12  CAL*    K1                                                       HFM09410
       LAS*    K12                                                      HFM09420
       TRA     ((12)                                                    HFM09430
       TRA     TIX12                                                    HFM09440
       TRA     ((11)                                                    HFM09450
TIX12  TIX     GET12,1,1                                                HFM09460
       CAL     K1                                                       HFM09470
       LAS     K12                                                      HFM09480
       TRA     ((12)                                                    HFM09490
       TSX     ERC,4                                                    HFM09500
       TRA     ((11)                                                    HFM09510
C(13)  LXA     NWDCF,1                                                  HFM09520
GET13  CAL*    K1                                                       HFM09530
       LAS*    K13                                                      HFM09540
       TRA*    B13HI+13,2                                               HFM09550
       TRA     TIX13                                                    HFM09560
       TRA     C(11)                                                    HFM09570
TIX13  TIX     GET13,1,1                                                HFM09580
       CAL     K1                                                       HFM09590
       LAS     K13                                                      HFM09600
       TRA*    B13HI+13,2                                               HFM09610
       TSX     ERC,4                                                    HFM09620
       TRA     C(11)                                                    HFM09630
C(14)  LXA     NWDCF,1                                                  HFM09640
GET14  CAL*    K1                                                       HFM09650
       LAS*    K14                                                      HFM09660
       TRA     ((14)                                                    HFM09670
       TRA     TIX14                                                    HFM09680
       TRA     ((13)                                                    HFM09690
TIX14  TIX     GET14,1,1                                                HFM09700
       CAL     K1                                                       HFM09710
       LAS     K14                                                      HFM09720
       TRA     ((14)                                                    HFM09730
       TSX     ERC,4                                                    HFM09740
       TRA     ((13)                                                    HFM09750
C(15)  LXA     NWDCF,1                                                  HFM09760
GET15  CAL*    K1                                                       HFM09770
       LAS*    K15                                                      HFM09780
       TRA*    B15HI+15,2                                               HFM09790
       TRA     TIX15                                                    HFM09800
       TRA     C(14)                                                    HFM09810
TIX15  TIX     GET15,1,1                                                HFM09820
       CAL     K1                                                       HFM09830
       LAS     K15                                                      HFM09840
       TRA*    B15HI+15,2                                               HFM09850
       TSX     ERC,4                                                    HFM09860
       TRA     C(14)                                                    HFM09870
C(16)  LXA     NWDCF,1                                                  HFM09880
GET16  CAL*    K1                                                       HFM09890
       LAS*    K16                                                      HFM09900
       TRA     ((16)                                                    HFM09910
       TRA     TIX16                                                    HFM09920
       TRA     ((15)                                                    HFM09930
TIX16  TIX     GET16,1,1                                                HFM09940
       CAL     K1                                                       HFM09950
       LAS     K16                                                      HFM09960
       TRA     ((16)                                                    HFM09970
       TSX     ERC,4                                                    HFM09980
       TRA     ((15)                                                    HFM09990
*  TRANSFERS FROM 3RD ENTRY COMPARE.                                    HFM10000
B3H    TXL     ((3),2,3      IF MERGE ORDER IS 3, WE ARE DONE.          HFM10010
       TRA     C(4)          GREATER THAN 3.  COMPARE 4TH ENTRY.        HFM10020
*  TRANSFERS FROM 5TH ENTRY COMPARE.                                    HFM10030
B5H    TXH     C(7),2,6      COMPARE 7TH ENTRY IF MERGE ORDER 7 OR MORE.HFM10040
       XEC     B5HI+5,2      MERGE ORDER LESS THAN 8.                   HFM10050
       TRA     C(6)          ORDER IS 6.  COMPARE 6TH ENTRY.            HFM10060
B5HI   TRA     ((5)          ORDER IS 5.  FINISHED.                     HFM10070
*  TRANSFERS FROM 7TH ENTRY COMPARE.                                    HFM10080
B7H    TXL     ((7),2,7      DONE IF ORDER IS 7.                        HFM10090
       TRA     C(8)          ORDER 8 OR MORE.  COMPARE 8TH ENTRY.       HFM10100
*  TRANSFERS FROM 9TH ENTRY COMPARE.                                    HFM10110
       TRA     C(13)         ORDER 16.  COMPARE 13TH ENTRY.             HFM10120
       TRA     C(13)         ORDER 15.  DITTO.                          HFM10130
       TRA     C(13)         ORDER 14.  DITTO.                          HFM10140
       TRA     C(13)         ORDER 13.  DITTO.                          HFM10150
       TRA     C(11)         ORDER 12.  COMPARE 11TH ENTRY.             HFM10160
       TRA     C(11)         ORDER 11.  DITTO.                          HFM10170
       TRA     C(10)         ORDER 10.  COMPARE 10TH ENTRY.             HFM10180
B9HI   TRA     ((9)          ORDER 9.  DONE.                            HFM10190
*  TRANSFERS FROM 11TH ENTRY COMPARE.                                   HFM10200
B11H   TXL     ((11),2,11    DONE IF ORDER 11.                          HFM10210
       TRA     C(12)         ORDER 12 OR MORE.  COMPARE 12TH ENTRY.     HFM10220
*  TRANSFERS FROM 13TH ENTRY COMPARE.                                   HFM10230
       TRA     C(15)         ORDER 16.  COMPARE 15TH ENTRY.             HFM10240
       TRA     C(15)         ORDER 15.  DITTO.                          HFM10250
       TRA     C(14)         ORDER 14.  COMPARE 14TH ENTRY.             HFM10260
B13HI  TRA     ((13)         ORDER 13.  DONE.                           HFM10270
*  TRANSFERS FROM 15TH ENTRY COMPARE.                                   HFM10280
       TRA     C(16)         ORDER 16.  COMPARE 16TH ENTRY.             HFM10290
B15HI  TRA     ((15)         ORDER 15.  DONE.                           HFM10300
*  ENTRY TO THIS TABLE LOADS XR2 WITH INSERTION LEVEL OF ITEM MERGED.   HFM10310
((16)  AXT     16,2                                                     HFM10320
       TRA     FMXCL                                                    HFM10330
((15)  AXT     15,2                                                     HFM10340
       TRA     FMXCL                                                    HFM10350
((14)  AXT     14,2                                                     HFM10360
       TRA     FMXCL                                                    HFM10370
((13)  AXT     13,2                                                     HFM10380
       TRA     FMXCL                                                    HFM10390
((12)  AXT     12,2                                                     HFM10400
       TRA     FMXCL                                                    HFM10410
((11)  AXT     11,2                                                     HFM10420
       TRA     FMXCL                                                    HFM10430
((10)  AXT     10,2                                                     HFM10440
       TRA     FMXCL                                                    HFM10450
((9)   AXT     9,2                                                      HFM10460
       TRA     FMXCL                                                    HFM10470
((8)   AXT     8,2                                                      HFM10480
       TRA     FMXCL                                                    HFM10490
((7)   AXT     7,2                                                      HFM10500
       TRA     FMXCL                                                    HFM10510
((6)   AXT     6,2                                                      HFM10520
       TRA     FMXCL                                                    HFM10530
((5)   AXT     5,2                                                      HFM10540
       TRA     FMXCL                                                    HFM10550
((4)   AXT     4,2                                                      HFM10560
       TRA     FMXCL                                                    HFM10570
((3)   AXT     3,2                                                      HFM10580
       TRA     FMXCL                                                    HFM10590
((2)   AXT     2,2                                                      HFM10600
       TRA     FMXCL                                                    HFM10610
((1)   TRA     B1816                                                    HFM10620
FMXCL  LDQ     K1            INSERTION DONE HERE.                       HFM10630
       CAL     K1+1,2                                                   HFM10640
       STQ     K1+1,2                                                   HFM10650
       XCL                                                              HFM10660
       TIX     *-3,2,1                                                  HFM10670
       TRA     B1816                                                    HFM10680
ERC    PXA     ,4            ERROR IN MERGING COMPARE LOOPS.            HFM10690
       PAC     ,4            ON EQUAL CONDITION, FILE NUMBERS           HFM10700
       SXA     *+2,4          HAVE COMPARED EQUAL.  SHOULD              HFM10710
       TSX     BUGPR2,4       NEVER HAPPEN.                             HFM10720
       PZE     **                                                       HFM10730
       TRA     *-2                                                      HFM10740
       EJECT                                                            HFM10750
*  READ ROUTINE--COMMUNICATES WITH I/O PROGRAMS.                        HFM10760
READ   SXA     (5),1                                                    HFM10770
       SXA     (6),2                                                    HFM10780
       SXA     (7),4                                                    HFM10790
EOFSW  BSS     0                                                        HFM10800
       STZ     RAW00                                                    HFM10810
       ZET     SWCHR         TEST FOR END OF REEL ACTION.               HFM10820
       TSX     SWCHR,4       GO TAKE CARE OF END OF REEL.               HFM10830
       NZT     RAW02         TEST FOR READ COMPLETE.                    HFM10840
       TRA     EOFSW         NOT COMPLETE.                              HFM10850
       NZT     SERVC         WAS LAST READ SERVICED.                    HFM10860
       TRA     NSRVCD        NO.                                        HFM10870
       CAL     TRA           YES.                                       HFM10880
       STD     NOPTRA        MAKE NOPTRA A (TRA).                       HFM10890
       TRA     S                                                        HFM10900
NSRVCD STL     SERVC         SET LAST READ SERVICED.                    HFM10910
       ZET     EOFI          WAS THERE AN EOF.                          HFM10920
       TRA     EF            YES.                                       HFM10930
       CLA     NOP           NO.                                        HFM10940
       STD     NOPTRA        MAKE NOPTRA A (NOP).                       HFM10950
       CLA     CFILE         MAKE CURRENT FILE THE                      HFM10960
       STO     PFILE          PREVIOUS FILE.                            HFM10970
       LXA     PFILE,1                                                  HFM10980
       CLA*    NUMB          UPDATE COUNT OF BLOCKS FOR THIS FILE BY 1. HFM10990
       TNZ     UPDCT         IF THIS FILE WAS STARVED,                  HFM11000
       LXA     STRVD,4       REDUCE COUNT OF STARVED                    HFM11010
       TXI     *+1,4,-1      FILES BY 1.                                HFM11020
LER5   TXH     ER5,4,-2      TRANSFER IF ERROR.                         HFM11030
       SXA     STRVD,4                                                  HFM11040
UPDCT  ADD     =1                                                       HFM11050
       STA*    NUMB                                                     HFM11060
S      AXT     1,1                                                      HFM11070
GRTR   SXA     F,1           SAVE FILE NO.                              HFM11080
       CLA*    NUMB          GET BLOCK COUNT FOR THIS FILE.             HFM11090
(1.4)  TXH     (2.5),1,**    (M.O.-1 IN DECR.).                         HFM11100
(1.6)  TXI     (2),1,1       INCREASE FILE NO. AND COMPARE AGAIN.       HFM11110
(2)    CAS*    NUMB          COMPARE AC AGAINST NO. OF UNMERGED BLOCKS  HFM11120
       TRA     GRTR          IN MEMORY FOR THIS FILE.                   HFM11130
       TRA     (2.5)                                                    HFM11140
(2.5)  TXL     (1.6),1,**    M.0.-1 IN DECR.                            HFM11150
       PAX     ,1                                                       HFM11160
LER1   TXH     ER1,1,NRW+1   TRANSFER IF ERROR.                         HFM11170
       TXH     TSTALT,1,NRW    CANNOT READ-NO RESERVE AREAS.            HFM11180
       TRA     F                                                        HFM11190
TSTALT NZT     FLIP                                                     HFM11200
       TRA     NOPTRA                                                   HFM11210
       CAL     ALTRSW                                                   HFM11220
       TNZ     MAKZRO                                                   HFM11230
       STL     ALTRSW                                                   HFM11240
       TRA     NOPTRA                                                   HFM11250
MAKZRO STZ     ALTRSW                                                   HFM11260
       TRA     NOPTRA                                                   HFM11270
F      AXT     **,1          FILE NO.FOR NEXT READ.                     HFM11280
       LXA     NAVLA,4       GET NO. OF AVAILABLE AREAS.                HFM11290
       TXH     AAVLB,4,0     TRANSFER IF AT LEAST ONE. **               HFM11300
       CAL     NAVCT         UPDATE NO. OF OCCURANCES OF THIS. **       HFM11310
       ADD     =1            **                                         HFM11320
       STA     NAVCT         **                                         HFM11330
       TXL     NOPTRA,4,0    TRANSFER IF NO AREAS AVAILABLE.            HFM11340
NAVCT  PZE                   **                                         HFM11350
AAVLB  BSS     0             **                                         HFM11360
       CLA*    BAAPL         GET AREA NO.                               HFM11370
       TXI     *+1,4,-1                                                 HFM11380
       SXA     NAVLA,4       SAVE NO. OF AVAILABLE AREAS LEFT.          HFM11390
       PAX     ,2            AREA NO. TO XR2.                           HFM11400
REF6   CLA     (ADDR),2      GET LOC. OF AREA.                          HFM11410
       SXD     CFILE,2       AREA NO.TO CURRENT FILE INDICATOR.         HFM11420
       ZET     RAW21         IS IT BACKWARD READ.                       HFM11430
       TRA     TSTEXT        YES.                                       HFM11440
       NZT     FLIP          NO. STRAIGHT FROM PHASE1 AND HYPER.        HFM11450
       TRA     ASUSAL        NO.                                        HFM11460
       CAL     ALTRSW        YES.                                       HFM11470
       TZE     BUFR1         READ INTO                                  HFM11480
       CLA     RDBFR2        BUFFER1                                    HFM11490
       STZ     ALTRSW        AND                                        HFM11500
       TRA     ASUSAL        BUFFER2                                    HFM11510
BUFR1  CLA     RDBFR1        ALTERNATELY.                               HFM11520
       STL     ALTRSW                                                   HFM11530
       TRA     ASUSAL                                                   HFM11540
TSTEXT XCA                                                              HFM11550
       SXA     AXT,2                                                    HFM11560
       PXA     ,1                                                       HFM11570
       PAX     ,2                                                       HFM11580
       TXI     *+1,2,-1                                                 HFM11590
       CAL*    CHA03         IS IT EXTERNAL                             HFM11600
       PBT                   INPUT TAPE.                                HFM11610
       TRA     XCACMQ        NO.                                        HFM11620
AXT    AXT     **,2          YES.                                       HFM11630
ADDRS  CAL     **,2                                                     HFM11640
       STA*    REF6                                                     HFM11650
       TRA     ASUSAL                                                   HFM11660
XCA    XCA                                                              HFM11670
       TRA     ASUSAL                                                   HFM11680
XCACMQ XCA                   INTERNAL INPUT TAPE                        HFM11690
       ARS     18            IS TO BE READ BACKWORD.                    HFM11700
       ORA     =O200000000000                                           HFM11710
       STP     RAW00                                                    HFM11720
       SBM     =1                                                       HFM11730
ASUSAL STA     RAW01         LOC. TO CALLING SEQUENCE.                  HFM11740
       SXA     CFILE,1       SAVE CURRENT READ FILE NO.                 HFM11750
       PXD     ,1                                                       HFM11760
       STD     RAW00         FILE NO. TO CALLING SEQ. DECR.             HFM11770
       STZ     MSTGT         RESET READ DEMAND SWITCH.                  HFM11780
       CLA     PFILE                                                    HFM11790
       SBM     CFILE                                                    HFM11800
       PAX     ,1            READING SAME FILE AS BEFORE.               HFM11810
       TXH     DIFUNT,1,0    NO.                                        HFM11820
       ZAC                   YES.                                       HFM11830
       ORA     =O100000000000                                           HFM11840
       ORS     RAW00                                                    HFM11850
DIFUNT CALL    MRGIO         CALL I/O FOR READ.                         HFM11860
       STZ     RAW00                                                    HFM11870
       ZET     MOD42                                                    HFM11880
       CALL    DFMM03  ******CE DEBUG MOD*******                        HFM11890
       STZ     SERVC         INDICATE THIS READ NOT SERVICED.           HFM11900
NOPTRA         (5)           THIS IS (NOP) OR (TRA).                    HFM11910
       NZT     FLIP          IS IT HYPER AND STRAIGHT FROM PHASE1.      HFM11920
       TRA     (3)           NO. EXIT.                                  HFM11930
       LXA     RDBFR1,1      YES.                                       HFM11940
       ZET     ALTRSW        GET THE                                    HFM11950
       LXA     RDBFR2,1       BUFFER TO BE                              HFM11960
       SXA     BRNGBF,1       FLIPPED OVER OR                           HFM11970
       SXA     CLA1,1         MOVED INTO PROPER AREA.                   HFM11980
       LXA     PFILE,2                                                  HFM11990
       TXI     *+1,2,-1                                                 HFM12000
       CAL*    CHA03                                                    HFM12010
       PBT                   IS IT EXTERNAL TAPE.                       HFM12020
       TRA     FLIPOV        NO. FLIP OVER.                             HFM12030
       AXT     1,1           YES. JUST MOVE.                            HFM12040
BRNGBF CAL     **,1          (BUFFER1 OR BUFFER2 LOC.).                 HFM12050
       PAX     ,1            GET                                        HFM12060
       STA     LENGTH         THE                                       HFM12070
       TXI     *+1,1,1        BASE                                      HFM12080
       ADM     BRNGBF         OF                                        HFM12090
       STA     CLA            THE                                       HFM12100
       LXD     PFILE,2        BUFFER                                    HFM12110
REF15  CLA     (ADDR),2       AND THE                                   HFM12120
       ADM     LENGTH         PROPER                                    HFM12130
       STA     AREABZ         AREA.                                     HFM12140
CLA    CLA     **,1          (BUFFER BASE).                             HFM12150
AREABZ STO     **,1          (AREA BASE).                               HFM12160
       TIX     CLA,1,1       MOVE.                                      HFM12170
       TRA     (3)           EXIT.                                      HFM12180
FLIPOV AXT     2,1                                                      HFM12190
       LXD     PFILE,2                                                  HFM12200
REF16  CLA     (ADDR),2                                                 HFM12210
       STA     STO1                                                     HFM12220
       STA     STO2                                                     HFM12230
       STA     STO3                                                     HFM12240
CLA1   CLA     **,1          (BUFFER1 OR BUFFER2).                      HFM12250
STO1   STO     **,1          (ADDR. OF AREA).                           HFM12260
       TIX     CLA1,1,1      MOVE FIRST TWO WORDS PRECEDING DATA.       HFM12270
       PAX     ,1                                                       HFM12280
       SXA     AXT6,1                                                   HFM12290
       ZET     REC05                                                    HFM12300
       TRA     VARIBL        VARIABLE RECORDS.                          HFM12310
       PXA     ,1            FIXED RECORDS.                             HFM12320
       PAC     ,4                                                       HFM12330
       SXA     AXT1,4                                                   HFM12340
       XCL                                                              HFM12350
       ZAC                                                              HFM12360
       DVP     CAL10                                                    HFM12370
       XCL                                                              HFM12380
       PAX     ,1                                                       HFM12390
       CAL     CAL10                                                    HFM12400
       PAX     ,2                                                       HFM12410
       ADM     CLA1                                                     HFM12420
       STA     CLA2                                                     HFM12430
TXI1   TXI     *+1,4,**      (INPUT RECORD LENGTH).                     HFM12440
CLA2   CLA     **,2          (BASE OF LOGICAL RECORD IN READ BUFFER).   HFM12450
STO2   STO     **,4          (ADDR. OF AREA).                           HFM12460
       TXI     *+1,4,-1      MOVE THE LOGICAL RECORD.                   HFM12470
       TIX     CLA2,2,1                                                 HFM12480
       CAL     CAL10                                                    HFM12490
       PAX     0,2                                                      HFM12500
       ADM     CLA2                                                     HFM12510
       STA     CLA2                                                     HFM12520
TXI3   TXI     *+1,4,**      (INPUT RECORD LENGTH).                     HFM12530
       TIX     TXI1,1,1      MOVE ALL THE LOGICAL RECORDS.              HFM12540
AXT1   AXT     **,4          -(NO. OF DATA WORDS IN BLOCK).             HFM12550
       SBM     CAL10                                                    HFM12560
       STA     *+1                                                      HFM12570
       CLA     **            MOVE CLOCKWORD AT THE END OF BLOCK.        HFM12580
       XEC     STO2                                                     HFM12590
       TRA     (3)           EXIT                                       HFM12600
VARIBL CAL     CLA1                                                     HFM12610
ADM1   ADM     PRECT                                                    HFM12620
       STA     *+1                                                      HFM12630
CLA4   CAL     **            THIS POINTS TO CONTROL WORD OF LOGICAL RCD.HFM12640
       NZT     GEN01         IS IT BINARY.                              HFM12650
       TRA     VARBCD        NO. BCD. IT COMES BACK TO PDX2.            HFM12660
PDX2   PDX     ,2            YES. BINARY.                               HFM12670
       ARS     18                                                       HFM12680
       ADM     =1                                                       HFM12690
       ADM     CLA4                                                     HFM12700
NOOOP  NOP     TOMOVE        NOP FIRST TIME,THEN ON (TRA) FOR           HFM12710
       TIX     ADM1,1,1       EVERY READ.                               HFM12720
       STA     *+1                                                      HFM12730
       CAL     **            THIS POINTS TO LAST CLOCKWORD.             HFM12740
       PDX     ,2                                                       HFM12750
       SXA     AXT5,2                                                   HFM12760
       PDC     ,4                                                       HFM12770
       CAL     TRA           MAKE NOOOP A (TRA).                        HFM12780
       STD     NOOOP                                                    HFM12790
AXT6   AXT     **,1          (NO.OF DATA WORDS IN BLOCK).               HFM12800
       TRA     VARIBL                                                   HFM12810
TOMOVE TXI     *+1,2,1                                                  HFM12820
TXI4   TXI     *+1,2,**      (EQUALS AND-OR CHECKSUM WORDS PRECEDING    HFM12830
       SXD     TXI2,2         THE RECORD PROPER).                       HFM12840
       SXD     TXI5,2                                                   HFM12850
       STA     CLA5                                                     HFM12860
TXI2   TXI     *+1,4,**      (RCDLTH+PRECT+1).                          HFM12870
CLA5   CLA     **,2          (BASE OF LOGICAL RECORD).                  HFM12880
STO3   STO     **,4          (ADDR. OF AREA).                           HFM12890
       TXI     *+1,4,-1                                                 HFM12900
       TIX     CLA5,2,1                                                 HFM12910
       CAL     CLA5                                                     HFM12920
TXI5   TXI     *+1,4,**      (RCDLTH+PRECT+1).                          HFM12930
       TIX     ADM1,1,1                                                 HFM12940
AXT5   AXT     **,4          (NO.OF DATA WORDS IN BLOCK).               HFM12950
       STA     *+1                                                      HFM12960
       CLA     **            MOVE CLOCKWORD AT THE END OF BLOCK.        HFM12970
       XEC     STO3                                                     HFM12980
       CAL     NOP           MAKE NOOOP A (NOP).                        HFM12990
       STD     NOOOP                                                    HFM13000
       TRA     (3)           EXIT.                                      HFM13010
VARBCD XCA                                                              HFM13020
       ZAC                                                              HFM13030
       CAQ     DTBT1,0,5                                                HFM13040
       LRS     51                                                       HFM13050
       DVP     =6                                                       HFM13060
       XCL                                                              HFM13070
       SBM     =1                                                       HFM13080
       ALS     18                                                       HFM13090
       TRA     PDX2                                                     HFM13100
(3)    NZT     RAW21         BACKWARD READ.                             HFM13110
       TRA     FORWRD        NO.                                        HFM13120
       LXA     PFILE,2       YES.                                       HFM13130
       TXI     *+1,2,-1                                                 HFM13140
       CAL*    CHA03                                                    HFM13150
       PBT                   EXTERNAL INPUT TAPE.                       HFM13160
       TRA     INTRNL        NO. INTERNAL INPUT TAPE.                   HFM13170
       TRA     FORWRD        YES.                                       HFM13180
INTRNL LXD     PFILE,2                                                  HFM13190
REF14  CAL     (ADDR),2                                                 HFM13200
       ARS     18                                                       HFM13210
       STA     *+1                                                      HFM13220
BASERD CLA     **            GET THE                                    HFM13230
       ARS     18            LOC. OF FIRST                              HFM13240
       SSM                   DATA WORD                                  HFM13250
       ADD     BASERD        OF THIS                                    HFM13260
       STA*    REF14         BLOCK.                                     HFM13270
FORWRD LXD     PFILE,2       PUT AREA NO. INTO XR2.                     HFM13280
       AXT     1,4           INDEX TO OBTAIN WORD JUST PRECEDING DATA.  HFM13290
REF4   CAL*    (ADDR),2      GET COUNT OF RECORDS READ.                 HFM13300
       PBT                   EXTERNAL OR FIXED LENGTH RECORDS.          HFM13310
       TRA     (8)           NO.                                        HFM13320
       SXA     EXTNL,2       YES. SET SWITCH FOR EXTERNAL INPUT         HFM13330
       TRA     REF2           WITH AREA NO.                             HFM13340
(8)    ANA     =O77777                                                  HFM13350
       SLW     CNT9          SAVE.                                      HFM13360
       ADD     CNTR          UPDATE TOTAL NO. OF RECORDS READ           HFM13370
       STO     CNTR          AND SAVE IN CNTR.                          HFM13380
       CLA     CNT9                                                     HFM13390
REF2   STA     (ARWD),2      AREA WORD GETS RECORD                      HFM13400
       ALS     18             COUNT IN BOTH DECREMENT AND ADDR.         HFM13410
REF3   STD     (ARWD),2      ADDR. IS UPDATED AS                        HFM13420
REF5   LDI     (ADDR),2       EACH RECORD IS MERGED.                    HFM13430
       RIR     400000        KNOCK OUT TAG.                             HFM13440
       SIR     100000        PUT IN TAG OF 1.                           HFM13450
       LXA     PFILE,1       FILE NO.TO XR1.                            HFM13460
(1)    CLA     **,1          GET COUNT OF RESERVE BLOCKS                HFM13470
       ADD     =1             AND UPDATE BY 1.                          HFM13480
       STA*    (1)                                                      HFM13490
       PAX     ,4            TEST TO SEE HOW MANY RESERVE WORDS WERE    HFM13500
LER16  TXH     ER16,4,NRW     LEFT. TRANSFER IF NONE.                   HFM13510
       STI*    RSWRT+NRW,4   SET UP RESERVE FILE-WORD.                  HFM13520
       PXD     ,2            AREA NO. GOES TO DECREMENT                 HFM13530
       STD*    RSWRT+NRW,4    OF RESERVE FILE-WORD.                     HFM13540
       ZET     INITR         WAS THIS AN INITIAL READ.                  HFM13550
       TRA     PRIME         YES.                                       HFM13560
LXAXNL LXA     EXTNL,2       WAS THIS INPUT EXTERNAL OR FIXED           HFM13570
*                             LENGTH RECORDS.                           HFM13580
       TXL     (5),2,0       EXIT IF NO.                                HFM13590
(4)    BSS     0             RECORDS IN EXTERNAL BLOCK OR FIXED         HFM13600
*                             LENGTH RECORD BLOCK MUST BE COUNTED.      HFM13610
       STZ     EXTNL         CLEAR SWITCH BEFORE WE FORGET.             HFM13620
       AXT     1,4                                                      HFM13630
REF8   CAL*    (ADDR),2      GET WORD JUST PRECEDING DATA.              HFM13640
       ANA     =O77777       WORD COUNT IS IN ADDRESS.                  HFM13650
       NZT     REC05         TRANSFER IF FIXED LENGTH                   HFM13660
       TRA     FIXED          RECORDS ARE BEING MERGED.                 HFM13670
       AXT     0,4           RECORD COUNT STARTS AT ZERO.               HFM13680
       PAX     ,1            BLOCK LENGTH.                              HFM13690
REF9   ADM     (ADDR),2      COMPUTE BASE LOC. OF BLOCK.                HFM13700
       STA     BINRY                                                    HFM13710
TSTMD  NZT     GEN01         IF RECORD IS BCD TRANSFER                  HFM13720
       TRA     CNVRT          OUT AND CONVERT LENGTH WORD.              HFM13730
BINRY  CAL     **,1          GET RECORD LENGTH WORD.                    HFM13740
       ADD     =O1000000                                                HFM13750
STCNT  TXI     *+1,4,1       INCREASE RECORD COUNT BY 1.                HFM13760
       ANA     =O77777000000                                            HFM13770
LER9   TNZ     NOER9                                                    HFM13780
       TSX     BUGPR2,4                                                 HFM13790
       PZE     LER9                                                     HFM13800
NOER9  STD     *+1                                                      HFM13810
       TIX     TSTMD,1,**                                               HFM13820
       SXD     TESTL,1                                                  HFM13830
       PDC     ,1                                                       HFM13840
TESTL  TXI     *+1,1,**                                                 HFM13850
LER7   TXL     NOER7,1,0     TRANSFER IF EVERYTHING OK.                 HFM13860
       TSX     BUGPR2,4      INPUT BLOCK HAS WRONG 1ST WORD, POSSIBLY.  HFM13870
       PZE     LER7          PRINT ERROR MESSAGE.  LENGTH DOESN,T CHECK.HFM13880
NOER7  PXA     ,4            IF VARIABLE RECORD MERGE, UPDATE NO.       HFM13890
       NZT     REC05         OF MERGE INPUT RECORDS                     HFM13900
       TRA     VF280          READ.                                     HFM13910
       ADD     CNT16                                                    HFM13920
       STO     CNT16                                                    HFM13930
VF280  PXA     ,4            FIXED INTERNAL INPUT ENTRY.                HFM13940
       STO     CNT9          SAVE RECORD COUNT.                         HFM13950
       ADD     CNTR                                                     HFM13960
       STO     CNTR                                                     HFM13970
       CLA     CNT9                                                     HFM13980
REF10  STA     (ARWD),2                                                 HFM13990
       ALS     18                                                       HFM14000
REF11  STD     (ARWD),2                                                 HFM14010
(5)    AXT     **,1          RELOAD FOR EXIT.                           HFM14020
(6)    AXT     **,2                                                     HFM14030
(7)    AXT     **,4                                                     HFM14040
RTURN  TRA     1,4                                                      HFM14050
*  ENTER HERE TO COMPUTE RECORD COUNT WHEN RECORDS ARE FIXED LENGTH.    HFM14060
FIXED  BSS     0                                                        HFM14070
LER17  TNZ     NOER17                                                   HFM14080
       TSX     BUGPR2,4      WORD COUNT FROM I/O PROGRAM                HFM14090
       PZE     LER17          SHOULD NOT BE ZERO WITHOUT                HFM14100
       TRA     *-2            EOF INDICATION.                           HFM14110
NOER17 LGR     36            COMPUTE NO. OF RECORDS IN                  HFM14120
       DVP     CAL10          INPUT BLOCK.                              HFM14130
       XCA                                                              HFM14140
       PAX     ,4            RECORD COUNT TO XR4.                       HFM14150
       LXA     PFILE,2                                                  HFM14160
       TXI     *+1,2,-1                                                 HFM14170
       CLA*    CHA03         GET TAPE TABLE ENTRY.                      HFM14180
       LXD     PFILE,2       RESTORE XR2 WITH AREA NO.                  HFM14190
       TMI     NOER7         TRANSFER IF EXTERNAL INPUT.                HFM14200
       TRA     VF280         INTERNAL INPUT, SO UPDATE ONLY FOR IT.     HFM14210
*  SETS UP FILE WORD ON INITIAL READ OF EACH FILE.                      HFM14220
PRIME  CAL*    RSWRT+NRW-1   PUT RESERVE BLOCK INTO                     HFM14230
       SLW     FLWD,1         MERGE STATUS.                             HFM14240
       CAL*    (1)           REDUCE NO. OF RESERVE                      HFM14250
       SUB     =1             BLOCKS FOR THIS FILE.                     HFM14260
LER10  LAS*    (1)           CHECK FOR ERROR.                           HFM14270
       TRA     ER10          **                                         HFM14280
       TRA     ER10          **                                         HFM14290
       STA*    (1)                                                      HFM14300
       TRA     LXAXNL                                                   HFM14310
ER10   BSS     0             ERROR.  COUNT OF RESERVE BLOCKS WAS        HFM14320
       TSX     BUGPR2,4       ALREADY ZERO OR LITERAL (=1) IS ZERO.     HFM14330
       PZE     LER10                                                    HFM14340
       PXD     ,0                                                       HFM14350
       TRA     LER10+3                                                  HFM14360
EXTNL  PZE                   EXTERNAL INPUT SWITCH.                     HFM14370
INITR  PZE                   INITIAL READ SWITCH.                       HFM14380
CNVRT  LDQ*    BINRY                                                    HFM14390
       PXD     ,0                                                       HFM14400
       CAQ     DTBT1,0,5                                                HFM14410
       LRS     51                                                       HFM14420
       DVP     =6                                                       HFM14430
       XCL                                                              HFM14440
       ALS     18                                                       HFM14450
       TRA     STCNT                                                    HFM14460
ER1    BSS     0             LOGICAL ERROR.                             HFM14470
       TSX     BUGPR1,4      NO. OF BLOCKS IN MEMORY FOR THIS           HFM14480
       PZE     LER1           FILE IS GREATER THAN NO. OF AVAILABLE     HFM14490
       TRA     LER1+1         RESERVE WORDS PLUS 1.                     HFM14500
ER5    BSS     0             INCONSISTENCY.  STRVD CELL INDICATES NO    HFM14510
       TSX     BUGPR1,4       FILES STARVED, BUT THIS ONE HAS NO BLOCKS.HFM14520
       PZE     LER5                                                     HFM14530
       PXD     ,0                                                       HFM14540
       TRA     UPDCT                                                    HFM14550
ER11   BSS     0                                                        HFM14560
       TSX     BUGPR1,4                                                 HFM14570
       PZE     LER11                                                    HFM14580
       AXT     0,2                                                      HFM14590
       TRA     LER11+1                                                  HFM14600
ER16   TSX     BUGPR2,4      NO RESERVE AREAS WERE AVAILABLE            HFM14610
       PZE     LER16          FOR THIS FILE, BUT A BLOCK                HFM14620
       TRA     ER16           WAS READ.                                 HFM14630
SERVC  PZE     *             LAST-READ-SERVICED INDICATOR.              HFM14640
       SPACE   5                                                        HFM14650
*                                                                       HFM14660
*  END OF FILE ROUTINE                                                  HFM14670
*                                                                       HFM14680
EF     LXA     CFILE,1       GET CURRENT READ FILE NO.                  HFM14690
       CLA     CFILE                                                    HFM14700
       STO     PFILE                                                    HFM14710
       ZET     MOD47                                                    HFM14720
       CALL    DFMM08  ******CE DEBUG MOD*****                          HFM14730
       STZ     EOFI          RESET EOF INDICATION.                      HFM14740
       CAL     TRA                                                      HFM14750
       STD     NOPTRA        MAKE NOPTRA A (TRA).                       HFM14760
       CAL     *             SET EOF INDICATION                         HFM14770
       STD*    NUMB           FOR THIS FILE.                            HFM14780
       CAL*    NUMB          IF THIS FILE WAS                           HFM14790
       PAX     ,4             STARVED.                                  HFM14800
       TXH     NSTVD,4,0     REDUCE STARVED                             HFM14810
       LXA     STRVD,4        COUNT BY 1.                               HFM14820
       TXI     *+1,4,-1                                                 HFM14830
       SXA     STRVD,4                                                  HFM14840
NSTVD  BSS     0                                                        HFM14850
       LXA     EXORD,4       REDUCE NO. OF INPUT TAPES                  HFM14860
       TXI     *+1,4,-1       REMAINING.                                HFM14870
       SXA     EXORD,4                                                  HFM14880
       TXH     MORE,4,0      IF NO MORE TAPES,                          HFM14890
       CLA     RTURN          SET SWITCH TO RETURN                      HFM14900
       STO     EOFSW          IMMEDIATELY FROM                          HFM14910
MORE   BSS     0              ANY READ ENTRY.                           HFM14920
       ZET     INITR                                                    HFM14930
       TRA     REDUCE                                                   HFM14940
(9)    TXH     S,4,0         TRANSFER IF MORE TAPES LEFT.               HFM14950
TRA    TRA     (5)                                                      HFM14960
NOP    NOP                                                              HFM14970
REDUCE LXA     INORD,2                                                  HFM14980
       TXI     *+1,2,-1                                                 HFM14990
LER11  TXH     ER11,2,-2     TRANSFER IF ERROR.                         HFM15000
       SXA     INORD,2                                                  HFM15010
       AXT     1,2                                                      HFM15020
       SXD     COMPAR,1      SAVE FILE NO. FOR COMPARE.                 HFM15030
SNORT  CAL     K1+1,2        FIND K-TABLE ENTRY WITH                    HFM15040
       ANA     =O77777000000  FILE NO. SAME AS FILE THAT                HFM15050
       CAS     COMPAR         LAST HIT EOF. WHEN IT IS                  HFM15060
       TXI     SNORT,2,1      FOUND,REMOVE IT.                          HFM15070
       TRA     EQUAL                                                    HFM15080
       TXI     SNORT,2,1                                                HFM15090
EQUAL  BSS     0             ENTRY IS FOUND.                            HFM15100
LER12  TXL     SNOBS,2,15    MOVE TRANSFER IF NO ERROR.                 HFM15110
       TSX     BUGPR2,4                                                 HFM15120
       PZE     LER12                                                    HFM15130
SNOBS  CAL     K1,2          BRING K-TABLE                              HFM15140
       SLW     K1+1,2         DOWN BY 1.                                HFM15150
       TXH     (9),2,14                                                 HFM15160
       TXI     SNOBS,2,1                                                HFM15170
COMPAR PZE                                                              HFM15180
       EJECT                                                            HFM15190
*  WRITE SUBROUTINE.                                                    HFM15200
WRITE  SXA     WRSV1,1                                                  HFM15210
       SXA     WRSV2,2                                                  HFM15220
       SXA     WRSV4,4                                                  HFM15230
       NZT     RAW04         **TEST FOR WRITE IN PROGRESS.              HFM15240
       TRA     *-1           **WRITE IN PROGRESS.                       HFM15250
       ZET     RAW05         DID LAST WRITE HIT EOT.                    HFM15260
       TRA     WREOT         YES.                                       HFM15270
GOWRT  CAL     WRBF1                                                    HFM15280
       STA     RAW01                                                    HFM15290
       LXA     BLKSZ,4                                                  HFM15300
       SXD     RAW01,4                                                  HFM15310
       CLS     =0                                                       HFM15320
       STO     RAW00                                                    HFM15330
       ZET     MOD23                                                    HFM15340
       CALL    FMM09                                                    HFM15350
       ZET     MOD46                                                    HFM15360
       CALL    DFMM07 ************CE DEBUG MOD*****                     HFM15370
       CALL    IOBB                                                     HFM15380
       CAL     NWRTS         KEEP COUNT OF                              HFM15390
       ADD     =1             NO. OF WRITES                             HFM15400
       SLW     NWRTS          DONE.                                     HFM15410
       LXA     WRCT,4                                                   HFM15420
       PXA     ,4                                                       HFM15430
       ADD     WRTOT                                                    HFM15440
       STO     WRTOT                                                    HFM15450
       SXA     WRCT,0                                                   HFM15460
       STZ     BLKSZ                                                    HFM15470
       STZ     WRTRQ                                                    HFM15480
       CAL     WRBF2                                                    HFM15490
       STA     MVSTO         RESET MOVE ADDRESS FOR NEXT OUTPUT BLOCK.  HFM15500
       LDQ     WRBF1                                                    HFM15510
       SLW     WRBF1                                                    HFM15520
       STQ     WRBF2                                                    HFM15530
WRSV1  AXT     **,1                                                     HFM15540
WRSV2  AXT     **,2                                                     HFM15550
WRSV4  AXT     **,4                                                     HFM15560
       TRA     1,4                                                      HFM15570
*  END OF TAPE ACTION.                                                  HFM15580
WREOT  BSS     0                                                        HFM15590
       ZET     MOD48                                                    HFM15600
       CALL    DFMM09 ************CE DEBUG MOD*****                     HFM15610
       STZ     RAW05         CLEAR EOT INDICATOR.                       HFM15620
       CLS     =0            SET UP CALLING SEQ. FOR CLOSING.           HFM15630
       STO     RAW00                                                    HFM15640
       STZ     RAW01                                                    HFM15650
       CALL    SCL                                                      HFM15660
       ZET     ISCL          WAS ONLY EOF WRITTEN ON SECOND I.S. UNIT(4)HFM15661
       TRA     NOWRT         YES.                                    (4)HFM15662
       NZT     NOCKPT        NO.                                     (4)HFM15670
       CALL    CKPT                                                     HFM15680
       SWT     2                                                        HFM15690
       TRA     GOWRT                                                    HFM15700
       TSX     (PROUT,4                                                 HFM15710
       PZE     5                                                        HFM15720
       PZE     INTRM1,,4                                                HFM15730
       PZE     INTRM2,,8                                                HFM15740
       PZE     INTRM3,,4                                                HFM15750
       PZE     INTRM4,,7                                                HFM15760
       PZE     INTRM5,,3+DBLSP                                          HFM15770
       TSX     (PAUSE,4                                                 HFM15780
       SWT     2                                                        HFM15790
       TRA     GOWRT                                                    HFM15800
       TRA     NONE                                                     HFM15810
SEQER  BSS     0                                                        HFM15820
       ZET     MOD49                                                    HFM15830
       CALL    DFMM10 ************CE DEBUG MOD*****                     HFM15840
       LXD     K1,4                                                     HFM15850
       CAL     FLWD,4        LOCATION OF OUT-OF-SEQUENCE RECORD.        HFM15860
       LGR     15                                                       HFM15870
       TSX     (BCD5X,4                                                 HFM15880
       SLW     SQMS2+4                                                  HFM15890
       CAL     LASTLC        LOCATION OF LAST RECORD MERGED.            HFM15900
       LGR     15                                                       HFM15910
       TSX     (BCD5X,4                                                 HFM15920
       SLW     SQMS3+4                                                  HFM15930
       CAL     INBUF         LOCATION OF LAST RECORD IN OUTPUT BUFFER.  HFM15940
       LGR     15                                                       HFM15950
       TSX     (BCD5X,4                                                 HFM15960
       SLW     SQMS3.+3                                                 HFM15970
       TSX     MSGSUP,4,2                                               HFM15980
       PZE     4                                                        HFM15990
       PZE     SQMS1,,5                                                 HFM16000
       PZE     SQMS2,,5                                                 HFM16010
       PZE     SQMS3,,5                                                 HFM16020
       PZE     SQMS3.,,7                                                HFM16030
       LXD     K1,2                                                     HFM16040
       TXI     *+1,2,-1                                                 HFM16050
       CLA*    CHA03                                                    HFM16060
       STA     *+1                                                      HFM16070
       LDQ     **                                                       HFM16080
       TSX     MSGSUP,4,3                                               HFM16090
       PZE     SQMS4,,8+DBLSP                                           HFM16100
       TSX     PRINT1,4                                                 HFM16110
       PZE                                                              HFM16120
       TRA     B0202                                                    HFM16130
       EJECT                                                            HFM16140
*  ERROR MESSAGE AND OPTION PRINTING ROUTINES.                          HFM16150
BUGPR1 STL     CONSW                                                    HFM16160
BUGPR2 SXA     GOON4,4                                                  HFM16170
       CAL     1,4                                                      HFM16180
       LGR     15                                                       HFM16190
       TSX     (BCD5X,4                                                 HFM16200
       SLW     BUGMS+2                                                  HFM16210
       TSX     MSGSUP,4,2                                               HFM16220
       PZE     1                                                        HFM16230
       PZE     BUGMS,,4+DBLSP                                           HFM16240
       TRA     STOPS1                                                   HFM16250
PRINT1 STL     CONSW                                                    HFM16260
       TRA     STOPS                                                    HFM16270
PRINT2 STZ     CONSW                                                    HFM16280
STOPS  SXA     GOON4,4                                                  HFM16290
STOPS1 TSX     MSGSUP,4,2                                               HFM16300
       PZE     2                                                        HFM16310
       PZE     OPTMS,,6+DBLSP                                           HFM16320
       PZE     DLSMS,,6                                                 HFM16330
       LXA     GEN03,4                                                  HFM16340
       TXL     NORES,4,0                                                HFM16350
       TSX     MSGSUP,4,2                                               HFM16360
       PZE     1                                                        HFM16370
       PZE     RESMS,,6                                                 HFM16380
NORES  NZT     CONSW                                                    HFM16390
       TRA     NOCON                                                    HFM16400
       TSX     MSGSUP,4,2                                               HFM16410
       PZE     1                                                        HFM16420
       PZE     CONMS,,6+DBLSP                                           HFM16430
NOCON  BSS     0                                                        HFM16440
PAUSE  TSX     (PAUSE,4                                                 HFM16450
       AXT     2,4                                                      HFM16460
       PXD     ,0                                                       HFM16470
SWT    SWT     5,4                                                      HFM16480
       TRA     OFF                                                      HFM16490
       TZE     SAVE                                                     HFM16500
       TSX     MSGSUP,4,2                                               HFM16510
       PZE     1                                                        HFM16520
       PZE     AMBMS,,8+DBLSP                                           HFM16530
       TRA     PAUSE                                                    HFM16540
SAVE   PXA     ,4            SAVE SWITCH THAT IS ON.                    HFM16550
OFF    TIX     SWT,4,1                                                  HFM16560
       CAS     =1                                                       HFM16570
       TRA     THRON         SW3 IS ON.  CONTINUE OPTION.               HFM16580
       TRA     FORON         SW 4 IS ON.  RESTART OPTION.               HFM16590
NONE   STL     ERA18         NO SWITCHES.  RETURN TO SORT MONITOR.      HFM16600
       XEC     FMXR4         RELOAD XR4.                                HFM16610
       TRA     5,4           RETURN TO 5,4 TO DELETE SORT.           (2)HFM16620
FORON  LXA     GEN03,4                                                  HFM16630
       TXH     RESTR,4,0                                                HFM16640
       PZE     INTRM6,,3+DBLSP                                          HFM16650
REJECT TSX     MSGSUP,4,2                                               HFM16660
       PZE     2                                                        HFM16670
       MZE     IMPMS,,4                                                 HFM16680
       PZE     AMBMS+3,,5+DBLSP                                         HFM16690
       TRA     PAUSE                                                    HFM16700
RESTR  CALL    RESTAR                                                   HFM16710
THRON  ZET     CONSW                                                    HFM16720
       TRA     GOON                                                     HFM16730
       TRA     REJECT                                                   HFM16740
GOON   TSX     MSGSUP,4,2                                               HFM16750
       PZE     1                                                        HFM16760
       PZE     CNTMS,,2+512*4                                           HFM16770
GOON4  AXT     **,4                                                     HFM16780
       STZ     CONSW                                                    HFM16790
RETRN  TRA     2,4                                                      HFM16800
CONSW  PZE                   CONTINUE NOT POSSIBLE IF ZERO.             HFM16810
BUGMS  BCI     4,ERROR, LOC.        *LE10                               HFM16820
OPTMS  BCI     6,**OPTIONS**              SS3  SS4                      HFM16830
DLSMS  BCI     6,TO DELETE SORT-----------UP   UP                       HFM16840
RESMS  BCI     6,TO RETURN TO LAST CKPT---UP   DN                       HFM16850
CONMS  BCI     6,TO GO ON (IGNORE)--------DN   UP                       HFM16860
CNTMS  BCI     2,(IGNORED)                                              HFM16870
AMBMS  BCI     8,MORE THAN 1 SS ON--CLARIFY YOUR CHOICE AND START       HFM16880
IMPMS  BCI     4,IMPROPER CHOICE TAKEN---                               HFM16890
SQMS1  BCI     5,RECORD OUT OF SEQUENCE *SQ03                           HFM16900
SQMS2  BCI     5,THIS RECORD IS AT LOC.  XXXXXX                         HFM16910
SQMS3  BCI     5,LAST RECORD WAS AT LOC. XXXXXX                         HFM16920
SQMS3. BCI     7,AND NOW IS AT LOC.XXXXXX IN OUTPUT BUFFER.             HFM16930
SQMS4  BCI     8, IS THE UNIT WHERE OUT-OF-SORT RECORD ORIGINATED       HFM16940
LDMS01 BCI     4, MOUNT MERGE FILE XXXXXX                               HFM16950
INTRM1 BCI     4,SORT INTERRUPT REQUESTED                               HFM16960
INTRM2 BCI     8,      1. LABEL AND SAVE ALL TAPES FOR LATER            HFM16970
INTRM3 BCI     4,RESTART.  PRESS START.                                 HFM16980
INTRM4 BCI     7,      2. IF SORT IS TO CONTINUE, PUT SS5               HFM16990
INTRM5 BCI     3,UP--PRESS START.                                       HFM17000
INTRM6 BCI     3,SORT INTERRUPTED.                                      HFM17010
BIGMS1 BCI     7,RECORD, LOC XXXXXX, INVALID FORMAT *VR03               HFM17020
SIZMS  BCI     2,XXXXXX WORDS                                           HFM17030
DELMS  BCI     1,ELETED                                                 HFM17040
BIGMS2 BCI     5,PRESS START TO DELETE SORT.                            HFM17050
       EJECT                                                            HFM17060
*  CONTROL FIELD REFERENCES.                                            HFM17070
K16    PZE     ,1,K1+1-*     TABLE     LOCATION OF LAST CELL + 1 OF     HFM17080
K15    PZE     ,1,K1+1-*               EXTRACTED CONTROL FIELD IS IN    HFM17090
K14    PZE     ,1,K1+1-*               THE ADDRESS PART OF EACH WORD,   HFM17100
K13    PZE     ,1,K1+1-*     OF        FILE NO. IS IN DECREMENT.  THIS  HFM17110
K12    PZE     ,1,K1+1-*               TABLE IS KEPT IN SORTED ORDER    HFM17120
K11    PZE     ,1,K1+1-*               SUCH THAT THE BOTTOM ENTRY (K1)  HFM17130
K10    PZE     ,1,K1+1-*     CONTROL   REPRESENTS THE CURRENT RECORD    HFM17140
K9     PZE     ,1,K1+1-*               TO BE PUT OUT FROM THE MERGE.    HFM17150
K8     PZE     ,1,K1+1-*                                                HFM17160
K7     PZE     ,1,K1+1-*     FIELD                                      HFM17170
K6     PZE     ,1,K1+1-*                                                HFM17180
K5     PZE     ,1,K1+1-*                                                HFM17190
K4     PZE     ,1,K1+1-*     REFERENCE                                  HFM17200
K3     PZE     ,1,K1+1-*                                                HFM17210
K2     PZE     ,1,K1+1-*                                                HFM17220
K1     PZE     ,1,K1+1-*     WORDS.                                     HFM17230
       EJECT                                                            HFM17240
*  FILE WORD TABLES.                                                    HFM17250
       DUP     1,16                                                     HFM17260
       PZE     ,1                                                       HFM17270
FLWD   BES     0             LOC. OF NEXT RECORD IN THIS FILE IN ADDR,  HFM17280
*                             TAG OF 1, AREA NO. FOR THIS RECORD IN     HFM17290
*                             DECREMENT.  FLWD-1 REFERS TO LOGICAL FILE HFM17300
*                             NO. 1, FLWD-2 TO FILE 2, ETC.             HFM17310
       DUP     1,16                                                     HFM17320
       PZE     ,1                                                       HFM17330
RFWD2  BES     0             2ND LEVEL RESERVE FILE WORDS.              HFM17340
       DUP     1,16                                                     HFM17350
       PZE     ,1                                                       HFM17360
RFWD1  BES     0             1ST LEVEL RESERVE FILE WORDS.              HFM17370
RSWRT  BSS     0             RESERVE FILE-WORD TABLE.                   HFM17380
       PZE     RFWD2,1                                                  HFM17390
       PZE     RFWD1,1                                                  HFM17400
       EJECT                                                            HFM17410
*  INITIALIZATION TABLES.                                               HFM17420
AR1    PZE     REF12         REFERENCES TO ARWD.                        HFM17430
       PZE     REF1                                                     HFM17440
       PZE     REF2                                                     HFM17450
       PZE     REF3                                                     HFM17460
       PZE     REF10                                                    HFM17470
       PZE     REF11                                                    HFM17480
ARWDR  PZE     *-AR1         NO. OF REFERENCES TO ARWD.                 HFM17490
AD1    PZE     REF4          REFERENCES TO ADDR.                        HFM17500
       PZE     REF5                                                     HFM17510
       PZE     REF6                                                     HFM17520
       PZE     REF7                                                     HFM17530
       PZE     REF8                                                     HFM17540
       PZE     REF9                                                     HFM17550
               REF14                                                    HFM17560
               REF15                                                    HFM17570
               REF13                                                    HFM17580
               REF16                                                    HFM17590
ADDRR  PZE     *-AD1         NO. OF REFERENCES TO ADDR.                 HFM17600
       SPACE                                                            HFM17610
*  PROGRAM CONSTANTS.                                                   HFM17620
TAG4   PZE     ,4                                                       HFM17630
       SPACE                                                            HFM17640
       SPACE                                                            HFM17650
*  PROGRAM VARIABLES.                                                   HFM17660
CHARC  PZE                   HOLDS 6TH CHAR. OF 1ST WORD OF REC.        HFM17670
CNT9   PZE                   NO. OF RECORDS READ LAST TIME.             HFM17680
NAVLA  PZE                   NO. OF AVAILABLE READ AREAS.               HFM17690
NWRTS  PZE                   NO. OF WRITES DONE.                        HFM17700
STRVD  PZE                   COUNT OF STARVED FILES.                    HFM17710
       SPACE                                                            HFM17720
*  SWITCHES.                                                            HFM17730
AJUSX  PZE                   AREA-JUST-EXHAUSTED INDICATOR.             HFM17740
ALTER  PZE                   NON-ZERO IF INPUT BINARY, OUTPUT BCD.      HFM17750
DROPSW PZE                   NON-ZERO IF ALL LONG RECORDS TO BE DROPPED.HFM17760
ISCL   PZE                   NON-ZERO WHEN ONLY EOF WANTED ON I.S.   (4)HFM17761
       SPACE                                                            HFM17770
*  LOCATORS.                                                            HFM17780
BAAPL  PZE     ,4            BASE OF AVAILABLE-AREAS-POOL LIST.         HFM17790
FM777  PZE                   HOLDS LOC. OF 1ST USABLE CORE WORD.        HFM17800
NUMB   PZE     ,1            BASE OF LIST OF NOS. OF UNMERGED BLOCKS.   HFM17810
WRBF2  PZE                   LOC. OF ALTERNATE WRITE BUFFER.            HFM17820
       EJECT                                                            HFM17830
       DETAIL                                                           HFM17840
*  DEFINITIONS.                                                         HFM17850
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    HFM17860
OVEPR  COMMON  2             OVERFLOW PARAMETERS.                       HFM17870
LABPR  COMMON  5             LABEL PARAMETERS.                          HFM17880
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   HFM17890
FILPR  COMMON  14            FILE CARD PARAMETERS.                      HFM17900
MODPR  COMMON  50            MODIFICATION PARAMETERS.                   HFM17910
RECPR  COMMON  10            RECORD PARAMETERS.                         HFM17920
DELPR  COMMON  2             DELETE PARAMETERS.                         HFM17930
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            HFM17940
CALPR  COMMON  50            CALCULATED PARAMETERS.                     HFM17950
GENPR  COMMON  10            GENERAL PARAMETERS.                        HFM17960
RAWPR  COMMON  30            READ AND WRITE PARAMETERS.                 HFM17970
CNTPR  COMMON  20            COUNTS.                                    HFM17980
ERAPR  COMMON  30            ERASABLE COMMON PARAMETERS.                HFM17990
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER.           HFM18000
BLKSZ  EQU     ERAPR-2       CURRENT OUTPUT BLOCKSIZE, WORDS.           HFM18010
CAL02  EQU     CALPR-2                                                  HFM18020
CAL10  EQU     CALPR-10      EFFECTIVE RECORD LENGTH, PHASE 3.          HFM18030
CAL19  EQU     CALPR-19      LOC. OF LOW PADDING RECORD.                HFM18040
CAL20  EQU     CALPR-20      LOC. OF HIGH PADDING RECORD.               HFM18050
CAL28  EQU     CALPR-28                                                 HFM18060
CHA02  EQU     CHAPR-2       OUTPUT CHANNEL REFERENCE CELL.             HFM18070
CHA05  EQU     CHAPR-5       NON-ZERO MEANS NO SYSCK2 ATTACHED.         HFM18080
CNT01  EQU     CNTPR-1       NO. OF RECORDS OUTPUT FROM PHASE 2.        HFM18090
CNT05  EQU     CNTPR-5       COUNT OF RECORDS DUMPED.                   HFM18100
CNT08  EQU     CNTPR-8       PHASE 1 DELETE COUNT.                      HFM18110
CNT09  EQU     CNTPR-9       CURRENT PHASE DELETE COUNT.                HFM18120
CNT10  EQU     CNTPR-10      LOW PADDING COUNT KEPT HERE.               HFM18130
CNT11  EQU     CNTPR-11      HIGH PADDING COUNT.                        HFM18140
CNT16  EQU     CNTPR-16      COUNT OF EXTERNAL INPUT RECORDS TO PHASE 3.HFM18150
DEL00  EQU     DELPR         DELETE OPTION - NONZERO=YES.               HFM18160
ERA03  EQU     ERAPR-3       LOC. OF ADDR TABLE LAST WORD+1, TAG OF 2.  HFM18170
ERA04  EQU     ERAPR-4       LOC. OF ARWD TABLE LAST WORD + 1, TAG OF 2.HFM18180
ERA05  EQU     ERAPR-5       LOC. OF FLWD TABLE LAST + 1, TAG OF 1.     HFM18190
ERA08  EQU     ERAPR-8       LOC. OF BASE1 (BASE OF CURRENT RECORD      HFM18200
*                             BEING MERGED).                            HFM18210
ERA11  EQU     ERAPR-11      DELETION COMMUNICATION CELL.               HFM18220
ERA18  EQU     ERAPR-18      DELETE THIS JOB SWITCH.                    HFM18230
ERA19  EQU     ERAPR-19                                              (8)HFM18231
ERA20  EQU     ERAPR-20      ADDRESS OF FILE NO. IN LABEL.              HFM18240
FMSC   EQU     ERAPR-7       LOC. OF LAST CELL + 1 OF SEQUENCE CHECK    HFM18250
*                             CONTROL FIELD.                            HFM18260
GEN03  EQU     GENPR-3       DECREMENT HAS RETURN FOR CKPT.             HFM18270
INBUF  EQU     ERAPR-20      LOC. OF RECORD IN OUTPUT BUFFER.           HFM18280
MOD49  EQU     MODPR-49      SWITCH FOR DFMM10                          HFM18290
MOD48  EQU     MODPR-48                 DFMM09                          HFM18300
MOD47  EQU     MODPR-47                 DFMM08                          HFM18310
MOD46  EQU     MODPR-46                 DFMM07                          HFM18320
MOD45  EQU     MODPR-45                 DFMM06                          HFM18330
MOD44  EQU     MODPR-44                 DFMM05                          HFM18340
MOD43  EQU     MODPR-43                 DFMM04                          HFM18350
MOD42  EQU     MODPR-42                 DFMM03                          HFM18360
MOD41  EQU     MODPR-41                 DFMM02                          HFM18370
MOD40  EQU     MODPR-40                 DFMM01                          HFM18380
MOD24  EQU     MODPR-24      SWITCH FOR FMM10                           HFM18390
MOD23  EQU     MODPR-23      SWITCH FOR FMM09                           HFM18400
MOD22  EQU     MODPR-22      SWITCH FOR FMM08                           HFM18410
MOD21  EQU     MODPR-21      SWITCH FOR FMM07                           HFM18420
MOD20  EQU     MODPR-20      SWITCH FOR FMM06                           HFM18430
MOD19  EQU     MODPR-19      SWITCH FOR FMM05                           HFM18440
MOD18  EQU     MODPR-18      SWITCH FOR FMM04                           HFM18450
MOD17  EQU     MODPR-17      SWITCH FOR FMM03                           HFM18460
MOD16  EQU     MODPR-16      SWITCH FOR FMM02                           HFM18470
MOD15  EQU     MODPR-15      SWITCH FOR FMM01                           HFM18480
RAW00  EQU     RAWPR                                                    HFM18490
RAW01  EQU     RAWPR-1                                                  HFM18500
RAW02  EQU     RAWPR-2                                                  HFM18510
RAW03  EQU     RAWPR-3                                                  HFM18520
RAW04  EQU     RAWPR-4                                                  HFM18530
RAW05  EQU     RAWPR-5                                                  HFM18540
REC01  EQU     RECPR-1       FIXED RECORD LENGTH TO PHASE 3.            HFM18550
REC02  EQU     RECPR-2       OUTPUT RECORD LENGTH.                      HFM18560
REC05  EQU     RECPR-5       NON-ZERO IF RECORDS ARE NOT FIXED LENGTH.  HFM18570
ERA09  EQU     ERAPR-9                                                  HFM18580
SAM02  EQU     SAMPR-2       NO. OF EXTERNAL MERGE FILES.               HFM18590
SAM04  EQU     SAMPR-4       NON-ZERO MEANS SORT.                       HFM18600
SAM05  EQU     SAMPR-5       NON-ZERO MEANS EXTERNAL MERGE.             HFM18610
WRBF1  EQU     ERAPR-6       LOC. OF CURRENT BUFFER FOR OUTPUT.         HFM18620
WRCT   EQU     ERAPR-1       COUNT OF RECORDS PLACED IN OUTPUT BUFFER.  HFM18630
FIL01  EQU     FILPR-1                                                  HFM18640
FIL02  EQU     FILPR-2       LOC. OF 1ST MERGE FILE BLOCK.              HFM18650
CNT15  EQU     CNTPR-15      NO. OF STRINGS OUTPUT BY LAST PHASE.       HFM18660
GEN00  EQU     GENPR         PHASE INDICATOR.                           HFM18670
CHA03  EQU     CHAPR-3       LOC. OF INPUT CHAN. TAPE TABLE, TAG OF 2.  HFM18680
OPT02  EQU     OPTPR-2       NOCKPT OPTION.                             HFM18690
EOFI   EQU     RAWPR-3       END OF FILE INDICATOR.                     HFM18700
NWDCF  EQU     CALPR-32      NO. OF WORDS IN EXTRACTED CONTROL FIELD.   HFM18710
MORDER EQU     SAMPR-1       ORDER OF MERGE.                            HFM18720
CAL16  EQU     CALPR-16      NO. OF INPUT AREAS.                        HFM18730
MXROP  EQU     CALPR-2       MAXIMUM NO. OF RECORDS, OUTPUT BLOCK.      HFM18740
CAL17  EQU     CALPR-17      MAXIMUM MERGE BLOCK SIZE.                  HFM18750
OBFRL  EQU     CALPR-28      OUTPUT BUFFER SIZE, WORDS.                 HFM18760
OPT01  EQU     OPTPR-1       CHECKSUMS INDICATOR.                       HFM18770
OPT03  EQU     OPTPR-3       EQUALS OPTION INDICATOR.                   HFM18780
GEN01  EQU     GENPR-1       BINARY/BCD INDICATOR.                      HFM18790
NOCKPT EQU     OPTPR-2       NO-CHECKPOINT OPTION INDICATOR.            HFM18800
WRTOT  EQU     CNTPR-2       TOTAL NO. OF RECORDS WRITTEN.              HFM18810
BASE2  EQU     ERAPR-10      BASE OF ENTIRE RECORD (LOC1+LEN2).         HFM18820
LEN1   EQU     ERAPR-12      LENGTH OF OUTPUT RECORD.                   HFM18830
LEN2   EQU     ERAPR-13      LENGTH OF ENTIRE LOGICAL RECORD.           HFM18840
LOC1   EQU     ERAPR-14      LOC. OF VERY 1ST WORD OF LOGICAL RECORD.   HFM18850
LOC2   EQU     ERAPR-15      LOC. OF 1ST WORD OF RECORD PROPER.         HFM18860
LASTLC EQU     ERAPR-16      LOC1 OF LAST RECORD MOVED TO BUFFER.       HFM18870
PRECT  EQU     ERAPR-17      COUNT OF WORDS PRECEDING RECORD PROPER.    HFM18880
MVSTO  EQU     ERAPR-21                                                 HFM18890
CUTSW  EQU     ERAPR-22      NON-ZERO IF THIS RECORD TO BE DROPPED.     HFM18900
CFILE  EQU     ERAPR-23      CURRENT FILE READING,,AREA NO.             HFM18910
PFILE  EQU     ERAPR-24      PREVIOUS FILE READ,,AREA NO.               HFM18920
CNTR   EQU     ERAPR-25      TOTAL NO. OF RECORDS READ SO FAR.          HFM18930
EXORD  EQU     ERAPR-26      EXTERNAL ORDER OF MERGE.                   HFM18940
INORD  EQU     ERAPR-27      INTERNAL ORDER OF MERGE.                   HFM18950
MSTGT  EQU     ERAPR-28      READ-DEMAND INDICATOR.                     HFM18960
SWCHR  EQU     RAWPR-11      REEL SWITCHING CELL.                       HFM18970
WRTRQ  EQU     ERAPR-29      WRITE-REQUEST INDICATOR.                   HFM18980
NRW    EQU     2             NO. OF RESERVE WORDS, EACH FILE.           HFM18990
VECTOR EQU     30            LENGTH OF TRANSFER VECTOR.                 HFM19000
DBLSP  EQU     2048                                                     HFM19010
MBLKDC                       MERGE BLOCKING IN DECREMENT.               HFM19020
RAW21  EQU     RAWPR-21                                                 HFM19030
FLIP   EQU     RAWPR-23      HYPER AND STRAIGHT FROM PHASE 1 INDICATION HFM19040
ADRRS  BSS     18                                                       HFM19050
RDBFR1                                                                  HFM19060
RDBFR2                                                                  HFM19070
ALTRSW                                                                  HFM19080
LENGTH                                                                  HFM19090
(ADDR) EQU     0                                                        HFM19100
(ARWD) EQU     0                                                        HFM19110
       EXTERN  MSGSUP                                                   HFM19120
       END                                                              HFM19130
* 7090/94 SORT VER 7 MOD 5 BUFFER/READ, SCATTER/BUFFER WRITE(HYPER)  (5)HIO00000
*      FAP
       COUNT   1200                                                     HIO00010
       SPACE                                                            HIO00020
       ENTRY   MRGHYO                                                   HIO00030
       ENTRY   MRGIO                                                    HIO00040
       ENTRY   IOBB                                                     HIO00050
       SST                                                              HIO00060
       SPACE                                                            HIO00070
*  CONTROL ROUTINE FOR BUFFER-READ, SCATTER WRITE.                      HIO00080
       TITLE                                                            HIO00090
MRGIO  BSS     0                                                        HIO00100
MRGHYO BSS     0                                                        HIO00110
       SXA     BCLEV,1       SAVE                                       HIO00120
       SXA     BCLEV+1,2      REGISTERS.                                HIO00130
       SXA     BCLEV+2,4                                                HIO00140
       LDQ     RWCS1         1ST CALLING SEQUENCE WORD.                 HIO00150
       TQP     BREAD         TRANSFER IF READ.                          HIO00160
       AXT     WRCS2,2       TELL WRITE ROUTINE (THRU COMMON).          HIO00170
       SXA     LCSTW,2        WHERE CALLING SEQ. TABLE IS.              HIO00180
       LXD     RWCS1,2       GET FILE NO.                               HIO00190
       TXL     *+3,2,0       IF FINAL OUTPUT.                           HIO00200
       STZ     XOUTS         RESET FINAL OUTPUT SWITCH.                 HIO00210
       TXI     *+2,2,-1                                                 HIO00220
       STL     XOUTS         SET FINAL OUTPUT SWITCH.                   HIO00230
       CAL*    SPR16         GET L(UCB) FOR OUTPUT.                     HIO00240
       STA     LUCBC         SAVE.                                      HIO00250
       CAL*    SPR20         SET MODE FROM FDB.                         HIO00260
       ZET     XOUTS         SKIP IF NOT FINAL OUTPUT.                  HIO00270
       CAL*    SPR29         FINAL OUTPUT.  GET ITS MODE.               HIO00280
       SLW     WRTMD         PUT MODE IN COMMON CELL FOR WRITE.         HIO00290
       TSX     HYTST,4      TEST FOR HYPER...WHEN YES,SET UP            HIO00300
       CTLW    HYCTL        THE SMS BITS,THE ORDER AND THE UNIT.        HIO00310
       LDQ     LWRSL         L(SEL) TO DECREMENT OF MQ.                 HIO00320
       AXC     BC020,4                                                  HIO00330
LDUCW  BSS     0                                                        HIO00340
 LUCBC CAL     **            GET UCW1.                                  HIO00350
       ARS     9             ISOLATE CHAN. NO.                          HIO00360
       ANA     17DEC                                                    HIO00370
       PDC     ,1            -CHAN. NO. TO IR 1.                        HIO00380
       TXI     *+1,1,1       ADJUST TO MAKE 0 FOR CHANNEL A, -1 FOR B...HIO00390
       LAC     LUCBC,2                                                  HIO00400
       NZT*    (CHXAC        WAIT FOR COMPLETION OF ACTIVITY            HIO00410
       ZET     1,2            ON CHANNEL AND UNIT.                      HIO00420
17DEC  TXI     *-2,0,15                                                 HIO00430
       ENB     K0            DISABLE TRAPS.                             HIO00440
       STQ     1,2                                                      HIO00450
       LDQ     RWCS2                                                    HIO00460
 BC020 TRA     1,4                                                      HIO00470
       STQ     WRCS2,1       SAVE CALLING SEQUENCE FOR WRITE.           HIO00480
 BCACT TSX     (ACTIV,4      ACTIVATE THE UNIT.                         HIO00490
       PZE     LUCBC                                                    HIO00500
 BCLEV AXT     ,1            LEAVE I/O CONTROL.                         HIO00510
       AXT     ,2                                                       HIO00520
       AXT     ,4                                                       HIO00530
       TRA     1,4           EXIT.                                      HIO00540
*  BUFFER WRITE REQUEST ENTRY.                                          HIO00550
IOBB   STL     BUFWR         SET BUFFER WRITE SWITCH.                   HIO00560
       TRA     MRGIO                                                    HIO00570
*                                                                       HIO00580
WAIT   ZET     SWCHR         CHECK FOR END OF REEL.                     HIO00590
       TSX     SWCHR,4       TAKE CARE OF END OF REEL.                  HIO00600
       NZT     RDCSW         WAIT FOR READ COMPLETION AFTER PRIORITY    HIO00610
       TRA     WAIT          REQUEST ON ENTRY TO I/O.                   HIO00620
       TRA     TESTP-1        READ COMPLETE. TEST PRIORITY SWITCH.   (5)HIO00630
 RECOV AXT     **,1         EXIT TO MAIN PROGRAM                        HIO00640
       AXT     **,2         AFTER A                                     HIO00650
       AXT     **,4         BAD                                         HIO00660
       TRA     1,4          READ RECOVER                                HIO00670
       SPACE                                                            HIO00680
*  ENTER HERE IF BUFFER READ IS REQUESTED.                              HIO00690
       SPACE                                                            HIO00700
 BREAD BSS     0                                                        HIO00710
       TRA     *+1            GATE. INITIALIZE ONCE.                    HIO00720
       AXT     RDCS2,2       PUT LOCATION OF CALLING SEQUENCE           HIO00730
       SXA     LCSTR,2        TABLE IN COMMON FOR READ ROUTINE.         HIO00740
       CLA     BCLEV         SET TAG FOR INDIRECT REFERENCES            HIO00750
       STT     LCSTR          BY CHANNEL TO CALLING SEQUENCE            HIO00760
       STT     LCSTW          TABLES.                                   HIO00770
       STL     BREAD         SET BYPASS.                                HIO00780
 RED1  LDC     RWCS1,4       -LOGICAL FILE NO.                          HIO00790
       NZT     EOFIN,4       IS EOF TO BE SET FOR THIS FILE NOW.        HIO00800
       TRA     BRED1         NO.                                        HIO00810
       STZ     EOFIN,4       YES.  CLEAR THE SWITCH INDICATING THIS.    HIO00820
       CLS     K1            SET END OF FILE INDICATION                 HIO00830
       STO     EOFI           AND EXIT WITHOUT                          HIO00840
       TRA     BCLEV          READING.                                  HIO00850
 BRED1 LXD     RWCS1,2        LOGICAL FILE NO.                          HIO00860
       SXA     LGLFN,2       SAVE.                                      HIO00870
       TXI     *+1,2,-1                                                 HIO00880
       CAL     PHASE                                                    HIO00890
       SUB     K2                                                       HIO00900
       TZE     PHSE2         TRANSFER IF PHASE 2.                       HIO00910
       CLA*    SPR15         PHASE 3.  IF TABLE ENTRY NEG., EXTERNAL INPHIO00920
       STZ     XINSW         SET SWITCH FOR INTERNAL INPUT.             HIO00930
       TPL     SVUCW         IF INTERNAL INPUT.                         HIO00940
       PDX     ,4            EXTERNAL INPUT.  SAVE L(FDB) FOR SELECT    HIO00950
       SXA     LFDBR,4        ROUTINES.                                 HIO00960
       PDC     ,4            GET MODE FOR THIS FILE.                    HIO00970
       LDQ     0,4                                                      HIO00980
       STL     XINSW         SET SWITCH INDICATIONG EXTERNAL INPUT.     HIO00990
       TRA     SVUCW                                                    HIO01000
 PHSE2 STZ     XINSW         SET SWITCH FOR INTERNAL INPUT.             HIO01010
       CLA*    SPR15         FIND L(UCB).                               HIO01020
 SVUCW STA     LUCBC         SAVE L(UCB).                               HIO01030
       STQ     REDMD         SAVE MODE THIS INPUT FILE.                 HIO01040
       TSX     HYTST,4      TEST FOR HYPER...WHEN YES SET UP            HIO01050
       CTL     HCTLR        THE SMS BITS,THE ORDER AND THE UNIT.        HIO01060
       LAC     LFDBR,4       -L(FILE DATA BLOCK)                        HIO01070
       LDQ     -20,4         GROUPING FACTOR FOR THIS FILE (EXTERNAL).  HIO01080
       STQ     CRGPF         SAVE GROUPING FACTOR (NO. BLOCKS PER READ) HIO01090
       LDQ     RDSEL         L(SEL) TO DECR. OF MQ.                     HIO01100
       TSX     LDUCW,4       GO TO INITIALIZE UCW2.                     HIO01110
       STQ     RDCS2,1       SAVE CALLING SEQUENCE FOR READ.            HIO01120
       TRA     BCACT         GO TO ACTIVATE AND EXIT.                   HIO01130
       SPACE                                                            HIO01140
*  END OF BUFFER READ, SCATTER WRITE CONTROL ROUTINE.                   HIO01150
*  BUFFER READ SELECT ROUTINES.                                         HIO01160
*   ENTERED FROM                                                        HIO01170
*   ACTIV TO INITIATE AN I/O OPERATION, OR FROM                         HIO01180
*   IOEX AT TRAP TIME.                                                  HIO01190
       SPACE                                                            HIO01200
 SELCT SXA     BRP37,1       SAVE.                                      HIO01210
       SXA     BRP37+1,2                                                HIO01220
       SXA     BRP37+2,4                                                HIO01230
       STA     UCWAD                                                    HIO01240
       PAC     ,2                                                       HIO01250
       TMI     BSELM                                                    HIO01260
*  ENTRY TO SELECT (+).                                                 HIO01270
       SPACE   2                                                        HIO01280
       CLA     3,2                                                      HIO01290
       STA     BFRDS          INITIALIZE SELECT ADDRESS.                HIO01300
       NZT     SELPR         IS THIS TAPE CHECK ENTRY.                  HIO01310
       ZET     LONG          IS THIS LONG BLOCK REREAD REQUEST.         HIO01320
       TRA     BRP19        YES....OVERLAY READ.                        HIO01330
       NZT     ACCPT          WAS LAST READ ACCEPTED.                   HIO01340
       TRA     BRP19        NO.....OVERLAY READ.                        HIO01350
       NZT     RDCSW          WAS LAST READ COMPLETED.                  HIO01360
       TRA     BRP41          NO.  UPDATE FOR NEXT BLOCK.               HIO01370
       TRA     BRP18                                                    HIO01380
 BRP19 NZT     HBKRD        THESE INSTRUCTIONS                          HIO01390
       TRA     BRP20        EFFECT                                      HIO01400
       CAL     HOVLY        A HYPERTAPE                                 HIO01410
       STA     RIORT        READ                                        HIO01420
       TRA     BRP20        OVERLAY.                                    HIO01430
       SPACE                                                            HIO01440
*  ENTER HERE WHEN LAST READ COMPLETED AND ACCEPTED.  IF FILE IS        HIO01450
*   EXTERNAL INPUT, WE MUST SET UP FOR SEVERAL READS FOR THIS REQUEST.  HIO01460
       SPACE                                                            HIO01470
 BRP18 CAL*    LCSTR        GET ADDR.OF BUFFER AREA FOR NEW             HIO01480
       ZET     XINSW        EXTERNAL INPUT SWITCH.                      HIO01490
       TRA     *+4          EXTERNAL                                    HIO01500
       ZET     HBKRD                                                    HIO01510
       ADD     K3                                                       HIO01520
       SUB     K2             INTERNAL INPUT.  ADJUST BUFFER ADDRESS.   HIO01530
       STA     HOVLY                                                    HIO01540
       STA     RIORT          INITIALIZE ADDRESS OF IORT.               HIO01550
       LXA     CRGPF,4       PUT CURRENT READ GROUPING FACTOR           HIO01560
       SXD     SMTFF,4        INTO TEST IN SELECT MINUS.                HIO01570
 BRP20 CAL     MMRBL         GET MAXIMUM MERGE BLOCK LENGTH.            HIO01580
       ADD     K3            ADJUST FOR WORD COUNT OF IORT FOR INTERNAL HIO01590
*                             INPUT.                                    HIO01600
       NZT     XINSW          IS THIS EXTERNAL INPUT.                   HIO01610
       TRA     BRP21          NO.  KEEP MERGE BLOCK SIZE FOR COUNT.     HIO01620
       LAC     LFDBR,4        YES.  COMPUTE WORD COUNT.                 HIO01630
       CAL     -5,4          BLOCKSIZE FROM FILE DATA BLOCK,            HIO01640
       ADD     K1              AUGMENT BY 1 FOR LENGTH CHECK.           HIO01650
 BRP21 PAX     IORTN,4                                                  HIO01660
 BRP25 SXD     RIORT,4       INITIALIZE IORT DECREMENT WITH WORD COUNT. HIO01670
       TXI     *+1,4,1      ADD ONE TO FORCE A                          HIO01680
       SXD     HCTLR+1,4    HYPERTAPE NON CONCURRENCE INTERRUPT.        HIO01690
 BRP33 CLA     BRP25          INITIALIZE ADDRESS OF RESET + LOAD        HIO01700
       STA*    RCHXI           CHANNEL WITH LOCATION OF COMMAND.        HIO01710
       NZT     HYPSW        SKIP THE RDS IF HYPER.                      HIO01720
 BFRDS RDS     **             SELECT UNIT.                              HIO01730
       XEC*    RCHXI           RESET AND LOAD CHANNEL.                  HIO01740
       STZ     ACCPT          RESET ACCEPTANCE SWITCH,                  HIO01750
       STZ     RDCSW           SET READ IN PROGRESS,                    HIO01760
       STL     SELPR          SET SELECT PLUS SWITCH,                   HIO01770
 BRP37 AXT     ,1             AND EXIT.                                 HIO01780
       AXT     ,2                                                       HIO01790
BRP39  AXT     **,4                                                     HIO01800
       ZET     REXSW         IF WE HAVE SERVICED AN END OF REEL,        HIO01810
       TRA     REXIT         EXIT THRU THAT ROUTINE.                    HIO01820
       TRA     1,4                                                      HIO01830
       SPACE                                                            HIO01840
*  LAST READ DID NOT COMPLETE A GROUP.  UPDATE FOR                      HIO01850
*   NEXT BLOCK.  IORT ADDRESS MUST BE INCREASED                         HIO01860
*   BY BLOCK LENGTH, AND DECREASED BY 1 IF THERE                        HIO01870
*   IS A BLOCK SEQUENCE AND CHECKSUM WORD.                              HIO01880
       SPACE                                                            HIO01890
 BRP41 LXA     HWLNG,4                                                  HIO01900
       PXA     ,4            WORD COUNT TO ADDRESS,                     HIO01910
       ADM     RIORT           ADD TO ADDRESS OF IORT,                  HIO01920
       LAC     LFDBR,4        SUBTRACT 1 IF SEQUENCE WORD               HIO01930
       ZET     -19,4          EXPECTED.                                 HIO01940
       SUB     K1                                                       HIO01950
       STA     RIORT          UPDATE ADDRESS OF IORT.                   HIO01960
       TRA     BRP33         GO TO SELECT AND EXIT.                     HIO01970
       SPACE                                                            HIO01980
*  END OF BUFFER READ SELECT PLUS ROUTINE.                              HIO01990
HYTST  BSS     0                                                        HIO02000
* SUBROUTINE TO SET UP SMS BITS FOR HYPERTAPE,SPOT UNIT NO.             HIO02010
*  AND ESTABLISH READD DIRECTION.                                       HIO02020
       LAC     LUCBC,2                                                  HIO02030
       LDI     0,2                                                      HIO02040
       CAL     RAWPR                                                    HIO02050
       PBT                                                              HIO02060
       TRA     RDING                                                    HIO02070
WRTING STZ     HYWSW                                                    HIO02080
       LNT     020000                                                   HIO02090
       TRA     2,4                                                      HIO02100
       STL     HYWSW                                                    HIO02110
       TRA     CONTIN                                                   HIO02120
RDING  STZ     HYPSW                                                    HIO02130
       STZ     HBKRD                                                    HIO02140
       LNT     020000                                                   HIO02150
       TRA     2,4                                                      HIO02160
       STL     HYPSW                                                    HIO02170
CONTIN AXT     103,1                                                    HIO02180
       LNT     000040        INTERFACE TEST.                            HIO02190
       TXI     *+1,1,-1      ZERO.                                      HIO02200
       RIL     777760                                                   HIO02210
       PBT                                                              HIO02220
       STP     RDSEL                                                    HIO02230
       ANA     =O700000000000 MASK OUT UNWANTED BITS.                   HIO02240
       OAI                                                              HIO02250
       CLA     K3                                                       HIO02260
       CAS     PHASE                                                    HIO02270
       TRA     BKTST         PHASE 2                                    HIO02280
       NZT     HYWSW         PHASE 3                                    HIO02290
       TRA     RDTST         PHASE 3 READ                               HIO02300
       NZT*    -1,4                                                     HIO02310
       TXI     BKTST,1,16                                               HIO02320
       TRA     BKTST                                                    HIO02330
 RDTST NZT     XINSW                                                    HIO02340
       TRA     BKTST                                                    HIO02350
       NZT*    -1,4                                                     HIO02360
       TXI     *+1,1,16                                                 HIO02370
 BKTST LNT     200000        BACKWARD TEST                              HIO02380
       TXI     *+2,1,-32     FORWARD                                    HIO02390
       STL     HBKRD                                                    HIO02400
       CAL     1,4           OBTAIN DUMMY CONTROL                       HIO02410
       STA     SPOT                                                     HIO02420
       SUB     K2             ADJUST FOR SMS LOCATION                   HIO02430
       STA     *+1                                                      HIO02440
       SXA     **,1          PLACE SMS BITS                             HIO02450
       LFT     100000                                                   HIO02460
       ORA     =O20000000000                                            HIO02470
       STP*    1,4                                                      HIO02480
       STD*    1,4                                                      HIO02490
       AXT     8576,1        20600 OCTAL                                HIO02500
       PIA                   UNIT NUM. TO AC                            HIO02510
       LFT     200000        TEST BACKWARD                              HIO02520
       TXI     *+1,1,64      ADD BACKWARD TO ORDER.                     HIO02530
       STD     *+1                                                      HIO02540
       TXI     *+1,1,**      ADD UNIT NUM.                              HIO02550
HOVLY  PXD     **,1                                                     HIO02560
SPOT   LAC     **,1                                                     HIO02570
       STD     0,1                                                      HIO02580
       TRA     2,4                                                      HIO02590
 HNDAT SXA     HNDAX,4                                                  HIO02600
       CAL     1,4          DECREMENT HAS THE 729 SPACE CODE.           HIO02610
       SLW     HNDAL+1                                                  HIO02620
       ZET     HYPSW        TEST HYPER SWITCH.                          HIO02630
 HNBSR TXI     HNDAL+4,,34                                              HIO02640
 HNDAL TSX     (NDATA,4                                                 HIO02650
       PZE     **,,**       THIS BECOMES SPACE COMMAND OR HYPER ORDER.  HIO02660
 HNDAX AXT     **,4         RETURN                                      HIO02670
       TRA     2,4          TO I/O.                                     HIO02680
       CAL     HNBSR        BACKSPACE HYPERTAPE.                        HIO02690
       ZET     HBKRD        TEST BACKWARD READ SWITCH.                  HIO02700
       CAL     HNSKP        SKIP = BACKWARD BACKSPACE.                  HIO02710
       STD     HNDAL+1                                                  HIO02720
 HNSKP TXI     HNDAL,,36                                                HIO02730
       EJECT                                                            HIO02740
*  SELECT MINUS ROUTINE FOR BUFFER READ.                                HIO02750
       SPACE                                                            HIO02760
 BSELM NZT     HYPSW                                                    HIO02770
       TRA     BBDEC                                                    HIO02780
       LDQ     COMMM                                                    HIO02790
       RQL     18                                                       HIO02800
       NZT     HBKRD                                                    HIO02810
       TRA     NBKRD                                                    HIO02820
       CAL     RIORT                                                    HIO02830
       ADD     K1                                                       HIO02840
       STA     COMMM                                                    HIO02850
       XCL                                                              HIO02860
       ADD     K1                                                       HIO02870
       STA     RIORT                                                    HIO02880
       TRA     *+2                                                      HIO02890
 NBKRD STQ     COMMM                                                    HIO02900
       CAL     =O000074000000                                           HIO02910
       LFT     001000       TEST UNUSUAL END                            HIO02920
       TIF     HPKUP         NCI IF SUMMARY BITS OFF                    HIO02930
       RFT     000010       EOF TEST                                    HIO02940
       TRA     TSTXI                                                    HIO02950
       RFT     003742       TEST DATA CHECK                             HIO02960
       TRA     BDIFF+2      DATA CHECK CONFIRMED.                       HIO02970
       LDQ     0,2                                                      HIO02980
       TSX     MSGSUP,4,3                                               HIO02990
       PZE     TMS15,,6+512*4                                           HIO03000
       TSX     MSGSUP,4,2                                               HIO03010
       PZE     TMS15+6,,5+512*4                                         HIO03020
       TSX     (PAUSE,4                                                 HIO03030
       LXD     GENPR-3,4                                                HIO03040
       TRA     4,4                                                      HIO03050
 TMS15 BCI     8, APPEARS TO HAVE MALFUNCTIONED *RD10PRESS START        HIO03060
       BCI     3,TO DELETE SORT.                                        HIO03070
 HPKUP CAL     COMMM                                                    HIO03080
       ORA     BBDEC        HYPERTAPE                                   HIO03090
       SBM     RIORT        NOISE                                       HIO03100
       ANA     =O77777      CHECK.                                      HIO03110
       SUB     K3                                                       HIO03120
       TPL     BMXIN        NOT NOISE.                                  HIO03130
       LDQ     0,2                                                      HIO03140
       TSX     MSGSUP,4,3                                               HIO03150
       PZE     TMS16,,5+512*4                                           HIO03160
       TRA     NSOAP          GO FOR REREAD=                            HIO03170
 TMS16 BCI     5, NOISE REC DISCARDED BY SORT.                          HIO03180
BBDEC  LNT     400000        NOISE RECORD TEST                       (4)HIO03190
       TRA     2,4           NOISE RECORD RETURN.                    (4)HIO03200
       LFT     300000        TEST 729 EOF OR PERM. TAPE CHECK.       (4)HIO03210
       TRA     BDIFF         YES.                                    (4)HIO03220
       SPACE                                                            HIO03230
*  COME HERE IF WE HAVE TRAPPED ON BUFFER READ OF EXTERNAL INPUT FILE.  HIO03240
*   FIRST ASK IF STORE CHANNEL RESULTS AGREE WITH EXPECTED BLOCK LENGTH.HIO03250
       SPACE                                                            HIO03260
 BMXIN CAL     (COMMM                                                   HIO03270
       ORA     BBDEC                                                    HIO03280
       SBM     RIORT         OBTAIN NO. OF WORDS READ.                  HIO03290
       STA     HWLNG                                                    HIO03300
       ANA     =O77777                                                  HIO03310
       NZT     XINSW         IS THIS EXTERNAL INPUT.                    HIO03320
       TRA     CKINTL        NO.  CHECK INTERNAL INPUT.                 HIO03330
       LAC     LFDBR,4       -L(FILE DATA BLOCK).                       HIO03340
TESTV  ZET     REC05         IS VARIABLE - RECORD SWITCH SET.           HIO03350
       TRA     CHKVL         YES.  CHECK VARIABLE RECORD BLOCK.         HIO03360
       CAS     -22,4         COMPARE WITH LENGTH IN FILE BLOCK.         HIO03370
       TRA     BLONG         BLOCK APPEARS LONG.                        HIO03380
       TRA     CLNTH         LENGTH O.K.                                HIO03390
       SBM     -22,4         BLOCK APPEARS SHORT.  FIND HOW             HIO03400
       LAS     K1             MUCH.  COMPARE WITH 1.                    HIO03410
       TRA     CKVBL         MORE THAN 1 WORD SHORT.                    HIO03420
 OFSZC AXT     **,4          1 WORD SHORT.  HAVE WE ALREADY RE-READ     HIO03430
       TXI     *+1,4,1        THIS BLOCK FOR SIZE ENOUGH TIMES.         HIO03440
       SXA     OFSZC,4                                                  HIO03450
       TXH     CKVBL,4,LIMIT                                            HIO03460
       TSX     HNDAT,4                                                  HIO03470
       PZE     UCWAD,,BSR                                               HIO03480
       TRA     NSOAP         GO FOR RE-READ OF SHORT BLOCK.             HIO03490
 CKVBL NZT     VBLOP         IS VARIABLE BLOCK OPTION SPECIFIED.        HIO03500
       TRA     SBDMP         NO.  DUMP THE BLOCK.                       HIO03510
       CLA     HWLNG         PUT BLOCK LENGTH LESS SEQUENCE WORD,       HIO03520
       ZET     -19,4          IF ONE, IN MQ.                            HIO03530
       SUB     K1                                                       HIO03540
       XCA                                                              HIO03550
       PXD     ,0                                                       HIO03560
       DVP     RCLP3         ASK IF BLOCK CONTAINS AN INTEGRAL          HIO03570
       STQ     HOLDQ                                                    HIO03580
       TNZ     SBDMP          NO. OF RECORDS.  TRANSFER IF NOT.         HIO03590
       ZET     -19,4         IS THERE A BLOCK SEQUENCE WORD.            HIO03600
       TSX     CKSQW,4       YES.  CHECK IT.                            HIO03610
       TRA     CLNTH                                                    HIO03620
 SBDMP LXA     HWLNG,4       DUMP THE SHORT BLOCK.                      HIO03630
       CLA     RIORT                                                    HIO03640
       STA     DMPCS                                                    HIO03650
       SXD     DMPCS,4       LENGTH TO CALLING SEQ. DECREMENT.          HIO03660
       CLA     HWLNG                                                    HIO03670
       TSX     (DECVA,4                                                 HIO03680
       STQ     TMS01+5                                                  HIO03690
       LAC     UCWAD,2                                                  HIO03700
       CLA     2,2                                                      HIO03710
       TSX     (DECVD,4      FILE NO. FOR MESSAGE.                      HIO03720
       STQ     TMS01+1                                                  HIO03730
       CLA     2,2                                                      HIO03740
       TSX     (DECVA,4                                                 HIO03750
       STQ     TMS01+3       REC. NO.                                   HIO03760
       LDQ     0,2                                                      HIO03770
       TSX     MSGSUP,4,3                                               HIO03780
       PZE     TMS01,,8+512*4                                           HIO03790
       SXA     OFSZC,0       RESET COUNT OF OFFSIZE READS OF THIS BLOCK.HIO03800
       STZ     LONG          RESET LONG BLOCK INDICATOR.                HIO03810
       TSX     SETTT,4                                                  HIO03840
       TRA     NSOAP                                                    HIO03850
       CALL    DEBLK                                                    HIO03860
       PZE     DMPCS,,1                                                 HIO03870
       NZT     XINSW                                                    HIO03880
       TRA     UPINF                                                    HIO03890
DMPCS  TIX     **,,**                                                   HIO03900
       TSX     UNSET,4                                                  HIO03910
       PZE     NSOAP                                                    HIO03920
       TRA     RECOV                                                    HIO03930
CHKVL  BSS     0                                                        HIO03940
CV05   CAS     -22,4         COMPARE LENGTH AGAINST THAT SPECIFIED      HIO03950
       TRA     BLONG          IN FILE DATA BLOCK.                       HIO03960
       TRA     *+1           BLOCK LENGTH O.K.                          HIO03970
       ZET     -19,4         IS THERE A BLOCK SEQUENCE WORD.            HIO03980
       TSX     CKSQW,4       YES,CHECK IT.                              HIO03990
       CAL     HWLNG         GET NO. OF DATA WORDS                      HIO04000
       LAC     LFDBR,4        IN BLOCK AND GIVE TO                      HIO04010
       ZET     -19,4          MERGE ROUTN.                              HIO04020
       SBM     K1                                                       HIO04030
       LAC     RIORT,4                                                  HIO04040
       SSM                                                              HIO04050
       STO     -1,4                                                     HIO04060
       TRA     CMPLT                                                    HIO04070
TMS01  BCI     8, FILE XXXXXX, REC XXXXXX OFSZ XXXXXX WRDS *RD04        HIO04080
 NOPRI PZE                                                              HIO04090
*  ENTER HERE IF LONG BLOCK ENCOUNTERED ON EXTERNAL MERGE INPUT.        HIO04100
       SPACE   1                                                        HIO04110
 BLONG BSS     0                                                        HIO04120
       LXA     OFSZC,4       GET OFFSIZE OCCURRENCES COUNT.            1HIO04130
       TXI     *+1,4,1       ADD 1.                                    1HIO04140
       SXA     OFSZC,4                                                 1HIO04150
       STL     LONG          SET LONG BLOCK INDICATOR.                 1HIO04160
       TXH     SBDMP,4,LIMIT TRANSFER IF TOO MANY SUCCESSIVE TIMES.    1HIO04170
       TSX     HNDAT,4       BACKSPACE FOR RE-READ.                    1HIO04180
       PZE     UCWAD,,BSR                                              1HIO04190
       TRA     NSOAP                                                    HIO04200
*  ENTER HERE IF EXTERNAL INPUT BLOCK IS CORRECT LENGTH.                HIO04210
       SPACE                                                            HIO04220
 CLNTH LAC     LFDBR,4                                                  HIO04230
       SXA     OFSZC,0                                                  HIO04240
       STZ     LONG                                                     HIO04250
       ZET     -19,4         IS THERE A TRAILER WORD.                   HIO04260
       TSX     CKSQW,4       YES.  CHECK IT.                            HIO04270
       CAL     HWLNG                                                    HIO04280
       LAC     LFDBR,4                                                  HIO04290
       ZET     -19,4                                                    HIO04300
       SBM     K1                                                       HIO04310
       ADM     LNGTH                                                    HIO04320
       SLW     LNGTH                                                    HIO04330
       SPACE                                                            HIO04340
*  UPDATE COUNT OF LOGICAL RECORDS READ AND ACCEPTED.                   HIO04350
       SPACE                                                            HIO04360
 UPDCT CAL     HWLNG                                                    HIO04370
       LAC     LFDBR,4                                                  HIO04380
       ZET     -19,4                                                    HIO04390
       SBM     K1                                                       HIO04400
       LRS     35                                                       HIO04410
       DVP     RCLP3                                                    HIO04420
       XCL                                                              HIO04430
       ADM     CNTPR-16      UPDATE NO. OF LOGICAL RECORDS READ         HIO04440
       STO     CNTPR-16       AND ACCEPTED FROM EXTERNAL MERGE FILE.    HIO04450
       LAC     LGLFN,4                                                  HIO04460
       NZT     EOFIN,4                                                  HIO04470
       TRA     BLKCT                                                    HIO04480
       LXA     PHASE,4                                                  HIO04490
       TXH     RSTBC,4,2                                                HIO04500
       EJECT                                                            HIO04510
*  ENTER HERE WHEN EXTERNAL READ IS CHECKED OUT.                        HIO04520
       SPACE                                                            HIO04530
 BLKCT AXT     1,4           UPDATE COUNT OF BLOCKS THIS GROUP.         HIO04540
       TXI     *+1,4,1                                                  HIO04550
       SPACE                                                            HIO04560
*  TEST HERE TO SEE IF MORE BLOCKS MUST BE READ TO COMPLETE A GROUP.    HIO04570
       SPACE                                                            HIO04580
 SMTFF TXL     GOFMR,4,**    CURRENT GROUPING FACTOR IN DECREMENT.      HIO04590
 RSTBC AXT     1,4           THIS WAS LAST BLOCK.  READ COMPLETE.       HIO04600
       SXA     BLKCT,4       RESTORE BLOCK COUNT TO 1.                  HIO04610
       SPACE                                                            HIO04620
*  GIVE WORD COUNT WITH MINUS SIGN TO FINAL MERGE PROGRAM.              HIO04630
       SPACE                                                            HIO04640
       LXA     PHASE,4                                                  HIO04650
       TXL     CMPLT,4,2                                                HIO04660
       CLA     LNGTH         SET THE SIGN MINUS TO INDICATE             HIO04670
       SSM                    IT IS A WORD COUNT AND NOT                HIO04680
       XCA                    A RECORD COUNT.                           HIO04690
       STZ     LNGTH                                                    HIO04700
       LXA     BRP37,1       GET CHANNEL INDEX AND                      HIO04710
       CAL*    LCSTR          FIND LOCATION OF READ BUFFER.             HIO04720
       PAC     ,4            INITIALIZE WORD JUST BEFORE                HIO04730
       STQ     -1,4           BUFFER WITH LENGTH OF DATA BLOCK.         HIO04740
 CMPLT LAC     UCWAD,2                                                  HIO04750
       STZ     1,2           RELEASE UNIT.                              HIO04760
       STL     RDCSW         SET READ COMPLETE.                         HIO04770
 MRBLK STL     ACCPT         ACCEPT LAST READ.                          HIO04780
RESFZC SXA     OFSZC,0       RESET OFFSIZE COUNT.                       HIO04790
 NSOAP STZ     SELPR         RESET SELECT PLUS SWITCH.                  HIO04800
       TRA     BRP37         EXIT.                                      HIO04810
 GOFMR SXA     BLKCT,4       SAVE UPDATED BLOCK COUNT.                  HIO04820
       TRA     MRBLK         TO TO ACCEPT AND EXIT.                     HIO04830
RECVRY SXA     RECOV,1      SAVE                                        HIO04840
       SXA     RECOV+1,2    MAIN PROGRAM LINK                           HIO04850
       SXA     RECOV+2,4                                                HIO04860
       STZ     RAWPR-11     CLEAR BAD READ RECOVER LINK.                HIO04870
       ZET     PRIOR                                                 (5)HIO04872
 TESTP TRA*    **           GO TO DUMP,MESSAGE ETC..                    HIO04880
       TRA     BCLEV                                                 (5)HIO04882
       EJECT                                                            HIO04890
*  ENTER HERE IF INTERNAL INPUT.                                        HIO04900
CKINTL LXD     RIORT,4                                                  HIO04910
       SXA     EXPCTD,4                                                 HIO04920
       CAS     EXPCTD                                                   HIO04930
       TRA     LARGE                                                    HIO04940
       TRA     SIZEOK                                                   HIO04950
       ZET     REC05                                                    HIO04960
       TRA     SIZEOK                                                   HIO04970
       SUB     K3                                                       HIO04980
       LRS     35                                                       HIO04990
       DVP     CALPR-9                                                  HIO05000
       TZE     SIZEOK                                                   HIO05010
LARGE  LXA     OFSZC,4                                                  HIO05020
       TXI     *+1,4,1                                                  HIO05030
       SXA     OFSZC,4                                                  HIO05040
       TXH     SBDMP,4,LIMIT                                            HIO05050
       TSX     HNDAT,4                                                  HIO05060
       PZE     UCWAD,,BSR                                               HIO05070
       TRA     NSOAP                                                    HIO05080
SIZEOK CAL     RIORT                                                    HIO05090
       ADD     K1                                                       HIO05100
       PAC     ,4                                                       HIO05110
       ADM     0,4                                                      HIO05120
       ADD     K1                                                       HIO05130
       NZT     REC05                                                    HIO05140
       TRA     *+3                                                      HIO05150
       CAL     (COMMM                                                   HIO05160
       SUB     K1                                                       HIO05170
       STA     PULW                                                     HIO05180
       CAL*    RIORT                                                    HIO05190
       TRA     CLKCK                                                    HIO05200
UPINF  BSS     0                                                        HIO05210
       TSX     UPCTR,4       INCREASE BLOCK SEQUENCE NUMBER             HIO05220
       TSX     UNSET,4                                                  HIO05230
       PZE     RESFZC                                                   HIO05240
       TRA     RECOV                                                    HIO05250
*                                                                       HIO05260
*     CHECK FIRST AND LAST CLOCK WORDS FOR CORRECT POSITION             HIO05270
*                                                                       HIO05280
 PUFW  CAL     **            FETCH FIRST WORD                           HIO05290
CLKCK  STA     FSEQ          SAVE FIRST SEQUENCE NUMBER.                HIO05300
       ANA     LHMSK         MASK CLOCK PORTION                         HIO05310
       SLW     FCLK          SAVE CLOCK PORTION                         HIO05320
 PULW  CAL     **            FETCH LAST WORD                            HIO05330
       STD     LSEQ          SAVE LAST SEQUENCE NUMBER                  HIO05340
       ANA     RHMSK         MASK CLOCK PORTION                         HIO05350
       ORA     FCLK          PLACE FIRST AND LAST CLOCK WORDS IN ALL    HIO05360
       LXA     BRP39,4                                                  HIO05370
       LAS     =O631463631463 COMPAPE WITH KNOWN CLOCK WORD             HIO05380
       TRA     *+2           GO TO ERROR EXIT                           HIO05390
       TRA     OKAGN                                                    HIO05400
       NZT     HYPSW                                                    HIO05410
       TRA     3,4                                                      HIO05420
       LXA     OFSZC,4                                                  HIO05430
       TXI     *+1,4,1                                                  HIO05440
       SXA     OFSZC,4                                                  HIO05450
       TXH     BDIFF+2,4,LIMIT                                          HIO05460
       TSX     HNDAT,4                                                  HIO05470
       PZE     UCWAD,,BSR                                               HIO05480
       TRA     NSOAP                                                    HIO05490
*                                                                       HIO05500
*     CHECK FOR EQUAL FIRST AND LAST BLOCK SEQUENCE WORDS               HIO05510
*                                                                       HIO05520
*                                                                       HIO05530
*     CHECK TO SEE IF THIS BLOCK IS IN CORRECT POSITION                 HIO05540
*                                                                       HIO05550
OKAGN  ZET     HYPSW        WHEN HYPERTAPE                              HIO05560
       TRA     END+1        TAKE BYPASS                                 HIO05570
       CAL     0,2                                                      HIO05580
       STA     PSEQ          SAVE SEQUENCE NUMBER ONLY                  HIO05590
       CLA     PSEQ          PICKUP PREVIOUS SEQUENCE WORD              HIO05600
       SUB     FSEQ          REDUCE BY CURRENT SEQUENCE WORD+1          HIO05610
       TNZ     3,4                                                      HIO05620
       TRA     POSOK         HEAD AND TAIL SEQUENCE NUMBERS AGREE.      HIO05630
*                                                                       HIO05640
*     DETERMINE IF BLOCK SEQUENCE NUMBER AND RECORD COUNT AGREE         HIO05650
*                                                                       HIO05660
 POSOK CAL     2,2           PICK UP RECORD COUNT                       HIO05670
       SUB     FSEQ          REDUCE BY SEQUENCE NUMBER                  HIO05680
       ANA     =O77777       MASK ADDRESS                               HIO05690
       TZE     END           RETURN FOR REMAINDER OF CLEANUP.           HIO05700
       CAL     2,2           PICK UP RECORD COUNT                       HIO05710
       TSX     (DECVA,4       CONVERT TO BCD                            HIO05720
       STQ     SRMSG+5                                                  HIO05730
       CLA     FSEQ          PICK UP SEQUENCE NUMBER                    HIO05740
       STA     2,2           PLACE IN RECORD COUNT                      HIO05750
       TSX     (DECVA,4      CONVERT TO BCD FOR                         HIO05760
       STQ     SRMSG+7       SEQUENCE MESSAGE                           HIO05770
       LDQ     0,2           CONVERT AND PRINT                          HIO05780
       TSX     MSGSUP,4,3    PRINT SEQUENCE ERROR MESSAGE.              HIO05790
       PZE     SRMSG,,9+512*4                                           HIO05800
END    TSX     UPCTR,4       INCREASE BLOCK SEQUENCE NUMBER             HIO05810
       ZET     HBKRD                                                    HIO05820
       TRA     HYFXR                                                    HIO05830
       XEC     BRP37         IF THIS IS FIXED LENGTH                    HIO05840
       CAL*    LCSTR          RECORD SORT, THE WORD BEFORE              HIO05850
       PAC     ,4             DATA HAS A BLOCK LENGTH                   HIO05860
       CAL     *              (WORD COUNT), AND SHOULD                  HIO05870
       NZT     REC05          BE SET MINUS.                             HIO05880
       STP     -1,4                                                     HIO05890
       TRA     CMPLT         GO BACK TO READ NEXT BLOCK                 HIO05900
 HYFXR CAL     RIORT                                                    HIO05910
       ADM     K1                                                       HIO05920
       STA     *+3                                                      HIO05930
       CAL     *                                                        HIO05940
       NZT     REC05                                                    HIO05950
       STP     **                                                       HIO05960
       TRA     CMPLT                                                    HIO05970
       SPACE   2                                                        HIO05980
*                                                                       HIO05990
*     SUBROUTINE TO UPDATE THE PREVIOUS BLOCK SEQUENCE NUMBER           HIO06000
*                                                                       HIO06010
 UPCTR SXA     UPIR2,2       SAVE IR2                                   HIO06020
       LAC     UCWAD,2       -L(UCB) TO IR2                             HIO06030
       CAL     0,2           PICK UP SEQUENCE NUMBER                    HIO06040
       ADD     K1            INCREASE BY ONE                            HIO06050
       STA     0,2           REPLACE IN UCB                             HIO06060
 UPIR2 AXT     **,2          RESTORE IR2                                HIO06070
       TRA     1,4                                                      HIO06080
       SPACE                                                            HIO06090
       SPACE                                                            HIO06100
*  ENTRY ON END OF FILE OR PERMANENT REDUNDANCY CHECK.                  HIO06110
       SPACE                                                            HIO06120
 BDIFF LFT     200000        IS THIS EOF.                               HIO06130
       TRA     TSTXI         YES.                                       HIO06140
RDMP   CAL     (COMMM        NO.  BLOCK UNREADABLE.                     HIO06150
       ORA     BDIFF         MAKE LARGER THAN RIORT.                    HIO06160
       SBM     RIORT                                                    HIO06170
       STA     HWLNG                                                    HIO06180
       ANA     =O77777                                                  HIO06190
       TSX     (DECVA,4                                                 HIO06200
       STQ     TMS12                                                    HIO06210
       TSX     SETTT,4                                                  HIO06220
       TRA     NSOAP                                                    HIO06230
       CLA     RIORT                                                    HIO06240
       STA     DMPCS                                                    HIO06250
       LXA     HWLNG,4                                                  HIO06260
       SXD     DMPCS,4                                                  HIO06270
       CLA     TMS11                                                    HIO06280
       LXA     PHASE,4                                                  HIO06290
       TXL     *+2,4,2                                                  HIO06300
       STO     TMS10+3                                                  HIO06310
       LAC     UCWAD,2                                                  HIO06320
       CLA     2,2                                                      HIO06330
       TSX     (DECVA,4                                                 HIO06340
       STQ     TMS01+3                                                  HIO06350
       CLA     2,2                                                      HIO06360
       TSX     (DECVD,4                                                 HIO06370
       STQ     TMS01+1                                                  HIO06380
       LDQ     0,2                                                      HIO06390
       TSX     MSGSUP,4,3                                               HIO06400
       PZE     TMS01,,4                                                 HIO06410
       TSX     MSGSUP,4,2                                               HIO06420
       PZE     2                                                        HIO06430
       PZE     TMS10,,4                                                 HIO06440
       PZE     TMS12,,2+512*4                                           HIO06450
       CALL    DEBLK         DUMP UNREADABLE BLOCK.                     HIO06480
       PZE     DMPCS,,1                                                 HIO06490
PRONLY NZT     XINSW                                                    HIO06500
       TRA     UPINF                                                    HIO06510
       TSX     UNSET,4                                                  HIO06520
       PZE     NSOAP                                                    HIO06530
       TRA     RECOV                                                    HIO06540
       SPACE   1                                                        HIO06550
*  END OF FILE ENTRY                                                    HIO06560
       SPACE   1                                                        HIO06570
 TSTXI NZT     XINSW         IS THIS EXTERNAL INPUT.                    HIO06580
       TRA     SETEF         NO.  SET EOF AND EXIT.                     HIO06590
       CAL     RENTRY        PUT ENTRY FOR END OF REEL ACTION           HIO06600
       SLW     SWCHR         INTO REEL SWITCH.                          HIO06610
       LAC     UCWAD,2       RELEASE                                    HIO06620
       STZ     1,2           UNIT.                                      HIO06630
       TRA     NSOAP         RETURN TO IOEX.                            HIO06640
RENTRY TTR     ENDRL                                                    HIO06650
ENDRL  SXA     RLXR1,1       SAVE REGISTERS                             HIO06660
       SXA     RLXR2,2       FROM MAIN                                  HIO06670
       SXA     RLXR4,4       PROGRAM.                                   HIO06680
       STZ     SWCHR         RESET END OF REEL SWITCH.                  HIO06690
       CALL    SAVEW         SAVE RAWPR AND RAWPR-1.                    HIO06700
       LXA     LGLFN,4       PUT LOGICAL FILE NO INTO                   HIO06710
       PXD     ,4            CALLING SEQUENCE WORD                      HIO06720
       STO     RWCS1         RAWPR FOR CLOSING.                         HIO06730
       CALL    SCL           CLOSE SORT OR MERGE EXTERNAL INPUT REEL.   HIO06740
       TRA     *+2                                                      HIO06750
SWICH  PZE                   NON-ZERO IF THIS IS LAST REEL.             HIO06760
       ZET     SWICH         TEST TO SEE IF MORE REELS.                 HIO06770
       TRA     LASTR         TRANSFER IF THIS WAS LAST REEL.            HIO06780
       LXA     LGLFN,4       PUT LOGICAL FILE NO. INTO                  HIO06790
       PXD     ,4            CALLING SEQUENCE FOR OPENING.              HIO06800
       STO     RWCS1                                                    HIO06810
       CALL    IOPEN         OPEN NEW INPUT REEL.                       HIO06820
       STL     NOPRI         SET SWITCH TO OBTAIN                       HIO06830
       AXT     SELCT,4       REACTIVATION OF UNIT.  PUT                 HIO06840
       SXD     REMEM,4       L (SELECT) INTO CELL FOR UCW2.             HIO06850
       TSX     UNSET,4       REACTIVATE THE UNIT.                       HIO06860
       PZE                                                              HIO06870
REXIT  STZ     REXSW         RETURN TO                                  HIO06880
RLXR1  AXT     **,1          MAIN                                       HIO06890
RLXR2  AXT     **,2          PROGRAM.                                   HIO06900
RLXR4  AXT     **,4                                                     HIO06910
       TRA     1,4                                                      HIO06920
LASTR  CALL    RESTW         RESTORE RAWPR AND RAWPR-1.                 HIO06930
       STZ     SWICH                                                    HIO06940
       STL     REXSW         SET SWITCH FOR EXIT FROM REEL-SWITCHING    HIO06950
       TRA     SETEF         ROUTINE.  GO TO SET UP FOR EOF.            HIO06960
       SPACE                                                            HIO06970
*  NO MORE REELS, INPUT.  SET END OF FILE INDICATOR.                    HIO06980
       SPACE                                                            HIO06990
 SETEF BSS     0                                                        HIO07000
       CAL     PHASE                                                    HIO07010
       LAS     K2                                                       HIO07020
       NZT     XINSW                                                    HIO07030
       TRA     STEOF                                                    HIO07040
       LXA     BLKCT,4       NO. OF BLOCKS IN THIS GROUP + 1.           HIO07050
       TXL     STEOF,4,1     SET EOF IF NO DATA HAS BEEN READ.          HIO07060
       LAC     LGLFN,4       SET SWITCH TO CAUSE EOF FLAG TO BE SET     HIO07070
       STL     EOFIN,4        ON NEXT ENTRY FOR READ FOR THIS FILE.     HIO07080
       TRA     RSTBC                                                    HIO07090
 STEOF STL     EOFI                                                     HIO07100
       TRA     CMPLT         ACCEPT AND RELEASE.                        HIO07110
       EJECT                                                            HIO07120
       SPACE   1                                                        HIO07130
*  ROUTINE TO CHECK BLOCK SEQUENCE AND CHECKSUM WORDS IN EXTERNAL INPUT.HIO07140
       SPACE   1                                                        HIO07150
 CKSQW BSS     0                                                        HIO07160
       SXA     SAVE4,4                                                  HIO07170
       LAC     UCWAD,2       -L(UCB).                                   HIO07180
       CAL     (COMMM                                                   HIO07190
       SUB     K1                                                       HIO07200
       STA     SUMUP                                                    HIO07210
       STA     BBASE                                                    HIO07220
       LAC     LFDBR,4                                                  HIO07230
       NZT     -8,4          IS THERE A BLOCK CHECKSUM.                 HIO07240
       TRA     SUMOK         NO.  SKIP CKSUM CALC.                      HIO07250
       LXA     HWLNG,4       LENGTH OF BLOCK JUST READ.                 HIO07260
       TXI     *+1,4,-1                                                 HIO07270
       PXD     ,0                                                       HIO07280
 SUMUP ACL     **,4                                                     HIO07290
       TIX     *-1,4,1                                                  HIO07300
       LGR     18                                                       HIO07310
       STZ     TEMP                                                     HIO07320
       SLQ     TEMP                                                     HIO07330
       ALS     18                                                       HIO07340
       ACL     TEMP                                                     HIO07350
       LBT                                                              HIO07360
       TRA     *+2                                                      HIO07370
       ACL     =O1000000                                                HIO07380
       ERA*    BBASE                                                    HIO07390
       ANA     =O777777000000                                           HIO07400
       TZE     SUMOK                                                    HIO07410
       CLA     2,2           RECORD NO.                                 HIO07420
       TSX     (DECVA,4                                                 HIO07430
       STQ     TMS13+2                                                  HIO07440
       LDQ     0,2           PRINT ''UNIT XX RECORD NO. XXXX            HIO07450
       TSX     MSGSUP,4,3                                               HIO07460
       PZE     TMS13,,3+SNGL                                            HIO07470
       TSX     MSGSUP,4,2                                               HIO07480
       PZE     1                                                        HIO07490
       PZE     TMS14,,3+DBL                                             HIO07500
 SUMOK LAC     LFDBR,4                                                  HIO07510
       NZT     -9,4          IS THERE A BLOCK SEQ. NO.                  HIO07520
       TRA     SEQOK         NO.  SKIP CHECKING.                        HIO07530
       CAL     2,2                                                      HIO07540
       ERA*    BBASE                                                    HIO07550
       PAX     ,4                                                       HIO07560
       TXL     SEQOK,4,0     TRANSFER IF SEQ. NO. SAME AS REC. NO.      HIO07570
       CLA*    BBASE                                                    HIO07580
       TSX     (DECVA,4      BLOCK SEQ. NO.                             HIO07590
       STQ     SRMSG+7                                                  HIO07600
       CLA     2,2                                                      HIO07610
       TSX     (DECVA,4                                                 HIO07620
       STQ     SRMSG+5                                                  HIO07630
       LDQ     RD07                                                     HIO07640
       STQ     SRMSG+8                                                  HIO07650
       LDQ     0,2                                                      HIO07660
       TSX     MSGSUP,4,3                                               HIO07670
       PZE     SRMSG,,9+512*4                                           HIO07680
       CLA*    BBASE                                                    HIO07690
       STA     2,2           CHANGE RECORD COUNT.                       HIO07700
 SEQOK BSS     0                                                        HIO07710
 SAVE4 AXT     **,4                                                     HIO07720
       TRA     1,4                                                      HIO07730
 BBASE PZE                   LOC. OF WORD FOLLOWING DATA BLOCK.         HIO07740
 SETPR LAC     UCWAD,2                                                  HIO07750
       CLA     1,2                                                      HIO07760
       STD     REMEM                                                    HIO07770
       STZ     1,2                                                      HIO07780
       STL     PRIOR                                                    HIO07790
       CLA     1,4                                                      HIO07800
       STA     *+2                                                      HIO07810
       STL     TESTP        ESTABLISH CONTROL VECTOR FOR TRA*           HIO07820
 REMEM TXH     **,,**                                                   HIO07830
       TRA     2,4                                                      HIO07840
 REACT BSS     0                                                        HIO07850
       SXA     REAC4,4                                                  HIO07860
       CAL*    1,4                                                      HIO07870
 NEWUN PAC     ,4                                                       HIO07880
       STA     NEWUN                                                    HIO07890
       CLA     REMEM                                                    HIO07900
       STD     1,4                                                      HIO07910
       STZ     RDCSW                                                    HIO07920
       TSX     (ACTVX,4                                                 HIO07930
       PZE     NEWUN                                                    HIO07940
 REAC4 AXT     **,4                                                     HIO07950
       TRA     2,4                                                      HIO07960
 SETTT SXA     GOFOR,4                                                  HIO07970
       TSX     SETPR,4                                                  HIO07980
       PZE     DUMP1                                                    HIO07990
       STL     NOPRI                                                    HIO08000
       CAL     TRPTR        ESTABLISH BAD READ RECOVER LINK             HIO08010
       SLW     RAWPR-11     FOR MAIN PROGRAM.                           HIO08020
 GOFOR AXT     **,4                                                     HIO08030
       TRA     1,4                                                      HIO08040
 TRPTR TTR     RECVRY       CONTROL VECTOR FOR MAIN PROGRAM.            HIO08050
 DUMP1 STZ     PRIOR                                                    HIO08060
       CALL    SAVEW                                                    HIO08070
       LXA     GOFOR,4                                                  HIO08080
       TRA     2,4                                                      HIO08090
 UNSET SXA     COMFR,4                                                  HIO08100
       NZT     NOPRI                                                    HIO08110
       TRA*    1,4                                                      HIO08120
       STZ     NOPRI                                                    HIO08130
       CALL    RESTW                                                    HIO08140
       CLA*    CHAPR         IF THIS IS PHASE 1,                        HIO08150
       LXA     PHASE,4        PLACE NEW UNIT CONTROL                    HIO08160
       TXH     *+2,4,1        WORD ADDRESS INTO                         HIO08170
       STA     UCWAD          UCWAD.                                    HIO08180
       TSX     REACT,4                                                  HIO08190
       PZE     UCWAD                                                    HIO08200
 COMFR AXT     **,4                                                     HIO08210
       TRA     2,4                                                      HIO08220
 PRIOR PZE                                                              HIO08230
       DUP     1,11                                                     HIO08240
 EOFIN PZE                   TABLE OF SWITCHES TO INDICATE EOF FLAG     HIO08250
*                             MUST BE SET ON NEXT ENTRY TO IO TO        HIO08260
*                             READ A PARTICULAR LOGICAL FILE.           HIO08270
TMS10  BCI     4,UNRDBL BLK DUMPED  *RD05                               HIO08280
TMS11  BCI     1, *RD06                                                 HIO08290
TMS12  BCI     2,       WORDS                                           HIO08300
 TMS13 BCI     3,RECORD NO.                                             HIO08310
TMS14  BCI     3,CKSUM ERROR  *RD08                                     HIO08320
SRMSG  BCI     9,BLKSEQ ERROR-UCW3 CHGD FROM   XXXXXX  TO  XXXXXX *RD09 HIO08330
RD07   BCI     1, *RD07                                                 HIO08340
*  TABLES, SWITCHES, AND CONSTANTS.                                     HIO08350
       SPACE                                                            HIO08360
 WRCS2 BSS     8             TABLE FOR WRITE CALL. SEQ. WORDS NO. 2.    HIO08370
 RDCS2 BSS     8             TABLE FOR READ CALL. SEQ. WORDS NO. 2.     HIO08380
 UCWAD PZE                   UNIT CONTROL BLOCK ADDRESS SAVED HERE.     HIO08390
 LBRTT PZE                   PERM. REDUND., LONG BLOCK SWITCH.          HIO08400
 LNGTH PZE                   NO. OF WRDS OF MERGE INPUT, THIS READ.     HIO08410
*  READ REQUEST.                                                        HIO08420
 HOLDQ PZE                   SAVE MQ HERE.                              HIO08430
LONG   BSS     0                                                        HIO08440
 DRLNG PZE                   DUMMY-READ-LONG-BLOCK SWITCH.              HIO08450
 IORTN IORTN   0,,-1                                                    HIO08460
 HWLNG PZE                   BLOCK LENGTH SAVED HERE.                   HIO08470
 SELPR PZE                    SELECT(+) READ SWITCH.                    HIO08480
 ACCPT SIX                   LAST-READ-ACCEPTANCE SWITCH.               HIO08490
 RIORT IORT    **,,**         READ IORT.                                HIO08500
 HYSMI SMS     **                                                       HIO08510
       LIPT    *+1                                                      HIO08520
 HCTLR CTLR    HYRORD                                                   HIO08530
       CPYD*   RIORT,,**                                                HIO08540
       TCH     SYSTWT                                                   HIO08550
 K0    PZE                   CONSTANT ZERO.                             HIO08560
 K3    PZE     3             CONSTANT 3.                                HIO08570
K4     PZE     4              CONSTANT4.                                HIO08580
 RDSEL PZE     ,,SELCT                                                  HIO08590
LWRSL  MZE     ,,WRSEL                                                  HIO08600
 LGTPO PZE                   LAST WORD +1 OF READ AREA                  HIO08610
 DIFER PZE                   DIFFERENCE FROM EXPECTED LENGTH            HIO08620
 ACDIF PZE                   EXPECTED LENGTH                            HIO08630
 FSEQ  PZE     **            FIRST SEQUENCE WORD IN ADDRESS             HIO08640
 FCLK  PZE     **            LEFT HALF CONTAINS FIRST CLOCK WORD        HIO08650
 LSEQ  PZE     **            LAST SEQUENCE WORD IN DECREMENT            HIO08660
 PSEQ  PZE     **            PREVIOUS SEQUENCE WORD + 1                 HIO08670
 LHMSK OCT     777777000000  LEFT HALF MASK                             HIO08680
 RHMSK OCT     777777        RIGHT HALF MASK                            HIO08690
 LCMD  PZE     IOCMD         LOCATION OF IO COMMAND                     HIO08700
 IOCMD IOSTN   0,,-1          SKIP COMMAND                              HIO08710
 DIOCM IOCT    **,,**                                                   HIO08720
REXSW  PZE                   NON-ZERO MEANS EXIT TO MAIN PROGRAM.       HIO08730
 PMBSW PZE                   POSSIBLE MISSING BLOCK SWITCH 0=OFF        HIO08740
HYRORD OCT     120600120100                                             HIO08750
       EXTERN  MSGSUP                                                   HIO08760
NOSOAP EQU     NSOAP                                                    HIO08770
       EJECT                                                            HIO08780
*  DEFINITIONS.                                                         HIO08790
       SPACE                                                            HIO08800
OPTPR  COMMON  15            OPTION CARD PARAMETERS                     HIO08810
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  HIO08820
 LABPR COMMON  5              LABEL CARD PARAMETERS                     HIO08830
 CHAPR COMMON  6              CHANNEL CARD PARAMETERS                   HIO08840
 FILPR COMMON  14             FILE CARD PARAMETERS                      HIO08850
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              HIO08860
 RECPR COMMON  10             RECORD CARD PARAMETERS                    HIO08870
 DELPR COMMON  2              DELETE CARD PARAMETERS                    HIO08880
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            HIO08890
 CALPR COMMON  50             CALCULATED PARAMETERS                     HIO08900
 GENPR COMMON  10             GENERAL PARAMETERS                        HIO08910
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  HIO08920
 CNTPR COMMON  20             COUNT PARAMETERS                          HIO08930
 ERAPR COMMON  30             ERASABLE SORAGE PARAMETERS                HIO08940
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           HIO08950
 BIT31 BOOL    20                                                       HIO08960
 BIT33 BOOL    4                                                        HIO08970
 BLKNG EQU     CALPR-1                                                  HIO08980
 BSR   EQU     5                                                        HIO08990
 COMMM EQU     (COMMM         CELL WHERE SCHX RESULTS ARE PUT.          HIO09000
 CRGPF EQU     RAWPR-6       GROUPING FACTOR FOR CURRENT READ.          HIO09010
 CTPAD EQU     CNTPR-6                                                  HIO09020
 DBLSP EQU     4                                                        HIO09030
 DBL   EQU     512*DBLSP                                                HIO09040
 EOFI  EQU     RAWPR-3                                                  HIO09050
 GRPFR EQU     CALPR-17      SORT INPUT GROUPING FACTOR IN DECREMENT.   HIO09060
 LCSTR EQU     RAWPR-14       LOC. OF CALL. SEQ. TABLE, READ.           HIO09070
 LFDBR EQU     RAWPR-10       LOCATION OF FILE DATA BLOCK, READ.        HIO09080
 LGLFN EQU     RAWPR-7       LOG. FILE NO. OF CURRENT READ IN ADDRESS.  HIO09090
 LIMIT EQU     5             MAX. NO. OF REREADS FOR OFFSIZE.           HIO09100
 MMRBL EQU     CALPR-13       MAXIMUM MERGE BLOCKING.                   HIO09110
 PADNG EQU     CALPR-20      ADDRESS OF PADDING RECORD.                 HIO09120
 RCLP3 EQU     RECPR-1       INPUT RECORD LENGTH (LOG. REC. ), PHASE 3. HIO09130
 RDCSW EQU     RAWPR-2        READ COMPLETION SWITCH.                   HIO09140
 RECLN EQU     RECPR                                                    HIO09150
REC05  EQU     RECPR-5       TYPE OF RECORD (FIXED, VARIABLE, OR 'TYPE')HIO09160
 REDMD EQU     RAWPR-16                                                 HIO09170
 RESTR EQU     1                                                        HIO09180
 RWCS1 EQU     RAWPR         READ-WRITE CALLING SEQUENCE WORD NO. 1.    HIO09190
 RWCS2 EQU     RAWPR-1       READ-WRITE CALLING SEQUENCE WORD NO. 2.    HIO09200
 SNGLS EQU     0                                                        HIO09210
 SNGL  EQU     512*SNGLS                                                HIO09220
 SPR14 EQU     CHAPR                                                    HIO09230
 SPR15 EQU     CHAPR-3                                                  HIO09240
 SPR16 EQU     CHAPR-2                                                  HIO09250
 SPR20 EQU     FILPR                                                    HIO09260
SWCHR  EQU     RAWPR-11                                                 HIO09270
 TRAPX EQU     (TRAPX                                                   HIO09280
 VBLOP EQU     OPTPR-5                                                  HIO09290
 WRTMD EQU     RAWPR-17                                                 HIO09300
 XINSW EQU     RAWPR-13       EXTERNAL INPUT SWITCH.                    HIO09310
 XOUTS EQU     RAWPR-12      EXTERNAL OUTPUT SWITCH.                    HIO09320
DOUBLE EQU     2048          DOUBLE-SPACE CODE.                         HIO09330
       DETAIL                                                           HIO09340
*  WRITE SELECT ENTRY.                                                  HIO09350
*  ASSUMPTIONS - ON NORMAL ENTRY (SCATTER WRITE) THE ADDRESS OF         HIO09360
*   RAWPR-1 HAS LOCATION OF WRITE TAG LIST, DECREMENT HAS LENGTH        HIO09370
*   OF THIS LIST.  BUFFER WRITE ENTRY (IOBB) IS ONLY DONE               HIO09380
*   IN PHASE 3 (FINAL MERGE).  ON BUFFER WRITE ENTRY THE                HIO09390
*   ADDRESS OF RAWPR-1 HAS LOCATION OF BEGINNING OF THE BUFFER,         HIO09400
*   AND THE DECREMENT HAS THE NO. OF WORDS OF DATA TO BE WRITTEN.       HIO09410
 WRSEL BSS     0                                                        HIO09420
       SXA     WRSV1,1                                                  HIO09430
       SXA     WRSV2,2                                                  HIO09440
       SXA     WRSV2+1,4                                                HIO09450
       TMI     WRTMN                                                    HIO09460
       PAC     ,2            -L(UCB) TO IR2.                            HIO09470
       CAL     3,2           UCW4.                                      HIO09480
       STA     WSLCT         INITIALIZE SELECT ADDRESS.                 HIO09490
       ZET     SELPW         IF TO BE A REWRITE,                        HIO09500
       TRA     REWRT          WE SKIP FOLLOWING INIT.                   HIO09510
       CAL     2,2           UCW3                                       HIO09520
       PAX     ,4             RECORD COUNT.                             HIO09530
       TXI     *+1,4,1       NEXT RECORD COUNT.                         HIO09540
       SXA     FSTCL,4       INITIALIZE 1ST AND                         HIO09550
       LXA     RAWPR-8,4                                                HIO09560
       CAL     RAWPR-9                                                  HIO09570
       STD     LSTCL                                                    HIO09580
       NZT     REC05                                                    HIO09590
       SXD     LSTCL,4        FINAL WORDS WITH SEQUENCE COUNT.          HIO09600
       LXA     PHASE,4                                                  HIO09610
       TXL     WRTP1,4,1     TRANSFER IF PHASE 1.                       HIO09620
       TXL     WRTP2,4,2     TRANSFER IF PHASE 2.                       HIO09630
       SXD     HIOCP,0       PHASE 3.  ZERO THE DECREMENTS OF           HIO09640
       SXD     TIORT,0        HIOCP AND TIORT, THEN TEST                HIO09650
       LAC     SPR29,4        FOR BLOCK SEQUENCE + CHECKSUM WORD.       HIO09660
       NZT     -19,4         TRANSFER AROUND NEXT IF NONE.              HIO09670
       TRA     NOSEQ                                                    HIO09680
       STZ     TLWRD                                                    HIO09690
       AXT     TLWRD,4       PUT ADDRESS OF COMPUTED BLOCK              HIO09700
       SXA     TIORT,4        SEQUENCE AND CKSUM WORD IN                HIO09710
       AXT     1,4            TIORT ADDRESS, 1 IN DECREMENT,            HIO09720
       SXD     TIORT,4        TO CAUSE THIS WORD TO BE WRITTEN OUT.     HIO09730
       LAC     SPR29,4       ARE WE TO                                  HIO09740
       NZT     -8,4           COMPUTE CKSUM.                            HIO09750
       TRA     NOCKS         NO.                                        HIO09760
       CAL*    LCSTW         GET CALLING SEQUENCE WORD NO. 2.           HIO09770
       STD     CMPBS                                                    HIO09780
 HLORG PAX     HYSMS,4                                                  HIO09790
 CMPBS TXI     *+1,4,**                                                 HIO09800
       ZET     BUFWR                                                    HIO09810
       TRA     BCKSM                                                    HIO09820
       SXA     GETTG,4       INITIALIZE TAG LIST BASE ADDRESS.          HIO09830
       PDX     ,4            NO. OF TAGS TO IR4.                        HIO09840
       STZ     TEMP                                                     HIO09850
 GETTG CAL     **,4          GET TAG,                                   HIO09860
       PDX     ,2             PUT LOGICAL RECORD LENGTH INTO XR2        HIO09870
       SXA     *-1,2                                                    HIO09880
       ADM     *-2           COMPUTE BASE OF RECORD AREA,               HIO09890
       STA     ADDUP          INITIALIZE FOR SUMMING.                   HIO09900
       CAL     TEMP                                                     HIO09910
 ADDUP ACL     **,2          DO ONE LOGICAL RECORD                      HIO09920
       TIX     *-1,2,1        AT A TIME.                                HIO09930
       SLW     TEMP                                                     HIO09940
       TIX     GETTG,4,1     GO FOR NEXT LOGICAL RECORD.                HIO09950
 XCL   XCL                   ALL DONE.                                  HIO09960
       STZ     TEMP           NOW FOLD.                                 HIO09970
       SLQ     TEMP                                                     HIO09980
       XCL                                                              HIO09990
       ALS     18                                                       HIO10000
       ACL     TEMP                                                     HIO10010
       LBT                                                              HIO10020
       TRA     *+3                                                      HIO10030
       ACL     1DEC                                                     HIO10040
       ERA     K1                                                       HIO10050
       SLW     TLWRD         FOLDED CHECKSUM IN LEFT HALF.              HIO10060
 NOCKS LAC     SPR29,4                                                  HIO10070
       NZT     -9,4          TEST FOR BLOCK SEQUENCING.                 HIO10080
       TRA     NOSEQ                                                    HIO10090
       CAL     FSTCL                                                    HIO10100
       STA     TLWRD         BLOCK SEQUENCE NO.                         HIO10110
 NOSEQ CAL*    LCSTW         GET CALLING SEQ. WORD NO. 2.               HIO10120
       ZET     BUFWR         IS THIS BUFFER WRITE.                      HIO10130
       TRA     SETBF         YES.                                       HIO10140
       STA     WCTRL                                                    HIO10150
       STD     WCTRL                                                    HIO10160
 WRT29 SUB     K1                                                       HIO10170
       STA*    (RCHXI        INITIALIZE RESET AND LOAD CHANNEL.         HIO10180
       STA     GTHIO+1                                                  HIO10190
       ARS     18                                                       HIO10200
       ADM     WCTRL         COMPUTE TAG LIST BASE ADDRESS.             HIO10210
       STA     GTTIO+1                                                  HIO10220
       CLA*    GTHIO+1       GET HEAD TAG AND                           HIO10230
       STO     SVWTG          SAVE.                                     HIO10240
       CLA*    GTTIO+1       SAVE BASE TAG.                             HIO10250
       STO     SVWTG+1                                                  HIO10260
       NZT     HYWSW                                                    HIO10270
       TRA     GTHIO                                                    HIO10280
       CLA     HYHCP        HEAD CPYP                                   HIO10290
       XEC     GTHIO+1      SPOT AT HEAD OF WRITE LIST.                 HIO10300
       CAL     GTTIO+1                                                  HIO10310
       ADD     K1                                                       HIO10320
       STA     CPYRE                                                    HIO10330
       CAL*    CPYRE                                                    HIO10340
       SLW     SVWTG+2                                                  HIO10350
       CLA     HTCHS                                                    HIO10360
 CPYRE STO     **                                                       HIO10370
       CLA     HYTCP                                                    HIO10380
       XEC     GTTIO+1                                                  HIO10390
       CLA     HIOCP                                                    HIO10400
       STD*    GTHIO+1                                                  HIO10410
       CLA     TIORT                                                    HIO10420
       STD*    GTTIO+1                                                  HIO10430
       CLA     HLORG                                                    HIO10440
       STA*    RCHXI                                                    HIO10450
       TRA     WSLCT+1                                                  HIO10460
 GTHIO CLA     HIOCP         HEAD IOCP TO BEGINNING OF                  HIO10470
       STO     **             WRITE LIST.                               HIO10480
 GTTIO CLA     TIORT         TAIL IORT TO TAIL OF WRITE                 HIO10490
       STO     **             LIST.                                     HIO10500
 WSLCT WRS     **            SELECT OUTPUT UNIT.                        HIO10510
       XEC*    (RCHXI        RESET AND LOAD CHANNEL.                    HIO10520
       STZ     WRCSW         SET WRITE IN PROGRESS.                     HIO10530
       STL     SELPW         FLAG SELECT MINUS LAST.                    HIO10540
 WRSV1 AXT     **,1                                                     HIO10550
 WRSV2 AXT     **,2                                                     HIO10560
       AXT     **,4                                                     HIO10570
       STL     GENPR-5                                                  HIO10580
       TRA     1,4           RETURN TO IOEX.                            HIO10590
*  BUFFER WRITE ENTRY.                                                  HIO10600
BWRSEL STL     BUFWR         SET FOR BUFFER WRITE.                      HIO10610
       TRA     WRSEL                                                    HIO10620
*                                                                       HIO10630
 BUFWR PZE                   BUFFER WRITE SWITCH.                       HIO10640
 BCKSM SXA     BACL,4        BASE OF BLOCK TO ACL.                      HIO10650
       PDX     ,4            LENGTH OF BLOCK TO IR4.                    HIO10660
       PXD     ,0            CLEAR AC FOR CHECKSUMMING.                 HIO10670
 BACL  ACL     **,4          TAKE CHECKSUM.                             HIO10680
       TIX     *-1,4,1                                                  HIO10690
       TRA     XCL           GO FOLD IT.                                HIO10700
 SETBF STA     BIOCP                                                    HIO10710
       STD     BIOCP                                                    HIO10720
       CAL     TIORT                                                    HIO10730
       ZET     HYWSW                                                    HIO10740
       TRA     HYBFW                                                    HIO10750
       SLW     BIOCP+1                                                  HIO10760
       CAL     SETBF                                                    HIO10770
       STA*    (RCHXI                                                   HIO10780
       TRA     WSLCT                                                    HIO10790
 HYBFW STD     HYTCP                                                    HIO10800
       CAL     HYTCP                                                    HIO10810
       SLW     BIOCP+1                                                  HIO10820
       CLA     SETBF                                                    HIO10830
       STA     GTHIO+1                                                  HIO10840
       SBM     K1                                                       HIO10850
       STA*    RCHXI                                                    HIO10860
       TRA     WSLCT+1                                                  HIO10870
       TCH     HYSMS                                                    HIO10880
 BIOCP IOCP    **,,**                                                   HIO10890
       PZE                                                              HIO10900
       TCH     SYSTWT                                                   HIO10910
*  WRITE, PHASE 2.                                                      HIO10920
       SPACE                                                            HIO10930
 WRTP2 CLA     RAWPR-8       INITIALIZE SEQUENCE BREAK AND              HIO10940
       STO     SQBRK          BLOCK LENGTH WORD.                        HIO10950
       TSX     P1P2C,4       SET UP HEAD AND TAIL COMMANDS,             HIO10960
       TRA     NOSEQ          GO FINISH INITIALIZATION.                 HIO10970
       SPACE                                                            HIO10980
*  WRITE, PHASE 1.                                                      HIO10990
 WRTP1 BSS     0                                                        HIO11000
       ZET     WRCSW         IS THIS A NEW WRITE GROUP.                 HIO11010
       TRA     NEWRT         YES.  GO INITIALIZE FOR IT.                HIO11020
       STZ     SQBRK         SET NO-SEQUENCE-BREAK FLAG (SIGN BIT).     HIO11030
       CLA     GTTIO+1       GET LAST BASE LOCATION, PUT INTO           HIO11040
       STA     WCTRL          ADDRESS OF WRITE CONTROL WORD.            HIO11050
 CMPAR CAL     CALPR-14      COMPARE MAXIMUM MERGE BLOCKING             HIO11060
       CAS     RMAIN          AGAINST NO. OF RECORDS REMAINING          HIO11070
       CAL     RMAIN          TO WRITE.  TAKE THE LESSER AND            HIO11080
 WCTRL TXH     **,,**         PLACE IN DECREMENT OF WRITE CONTROL WORD. HIO11090
       PAX     ,4                                                       HIO11100
       SXD     WCTRL,4                                                  HIO11110
       SUB     RMAIN         UPDATE NO. OF RECORDS REMAINING.           HIO11120
       STA     RMAIN                                                    HIO11130
       PXA     ,4            COMPUTE ADDRESS PORTION OF SEQUENCE        HIO11140
       LRS     35             BREAK AND BLOCKING WORD.                  HIO11150
       MPY     P2REC                                                    HIO11160
       XCA                                                              HIO11170
       STA     SQBRK                                                    HIO11180
       CAL     RAWPR-8       GET SEQUENCE BREAK LEVEL                   HIO11190
       STD     SQBRK                                                    HIO11200
       TSX     P1P2C,4                                                  HIO11210
       CAL     WCTRL                                                    HIO11220
       TRA     WRT29                                                    HIO11230
 NEWRT CAL     RAWPR-8       NEW WRITE.  SET SEQUENCE BREAK FLAG        HIO11240
       STP     SQBRK          AS GIVEN BY MAIN ROUTINE.                 HIO11250
       CAL*    LCSTW         INITIALIZE WRITE CONTROL WORD WITH         HIO11260
       STA     WCTRL          ADDRESS OF TAG LIST FOR NEW               HIO11270
       PDX     ,4             WRITE.  PUT COUNT INTO COUNT              HIO11280
       SXA     RMAIN,4        OF REMAINING RECORDS.                     HIO11290
       PXA     ,4                                                       HIO11300
       ADM     COUNT                                                    HIO11310
       STO     COUNT                                                    HIO11320
       TRA     CMPAR                                                    HIO11330
       SPACE                                                            HIO11340
*  SET UP FOR A REWRITE.                                                HIO11350
       SPACE                                                            HIO11360
 REWRT NZT     HYWSW                                                    HIO11370
       TRA     *+4                                                      HIO11380
       CLA     HLORG                                                    HIO11390
       STA*    RCHXI                                                    HIO11400
       TRA     WSLCT+1                                                  HIO11410
       CLA     GTHIO+1                                                  HIO11420
       ZET     BUFWR                                                    HIO11430
       CLA     SETBF                                                    HIO11440
       STA*    (RCHXI         CHANNEL AND GO TO SELECT.                 HIO11450
       TRA     WSLCT                                                    HIO11460
       SPACE                                                            HIO11470
*  ROUTINE TO SET UP HEAD AND TAIL COMMANDS FOR PHASE 1 AND PHASE 2.    HIO11480
       SPACE                                                            HIO11490
 P1P2C BSS     0                                                        HIO11500
       SXA     CBACK,4                                                  HIO11510
       AXT     2,4                                                      HIO11520
       SXD     HIOCP,4                                                  HIO11530
       AXT     LSTCL,4                                                  HIO11540
       SXA     TIORT,4                                                  HIO11550
       AXT     1,4                                                      HIO11560
       SXD     TIORT,4                                                  HIO11570
 CBACK AXT     **,4                                                     HIO11580
       TRA     1,4                                                      HIO11590
       EJECT                                                            HIO11600
*  WRITE SELECT MINUS.                                                  HIO11610
 WRTMN STZ     SELPW                                                    HIO11620
       ZET     HYWSW                                                    HIO11630
       TRA     HEWAT                                                    HIO11640
       LFT     200000        WAS THIS END OF TAPE.                      HIO11650
       STL     EOTI          YES.  SET END OF TAPE INDICATOR.           HIO11660
       ZET     BUFWR                                                    HIO11670
       TRA     DONE                                                     HIO11680
       TRA     RSTAG                                                    HIO11690
 HEWAT PAC     0,2                                                      HIO11700
       LDI     0,2                                                      HIO11710
       RFT     400000                                                   HIO11720
       STL     EOTI                                                     HIO11730
       ZET     BUFWR                                                    HIO11740
       TRA     DONE                                                     HIO11750
RSTAG  LDQ     SVWTG         RESTORE DISPLACED TAG TO LIST.             HIO11760
       STQ*    GTHIO+1                                                  HIO11770
       LDQ     SVWTG+1                                                  HIO11780
       STQ*    GTTIO+1                                                  HIO11790
       CAL     SVWTG+2                                                  HIO11800
       ZET     HYWSW                                                    HIO11810
       SLW*    CPYRE                                                    HIO11820
       TRA     DONE                                                     HIO11830
       ZET     RMAIN         ARE THERE MORE RECORDS TO WRITE.           HIO11840
       TRA     WRSV1          YES.  DO NOT RELEASE UNIT, AND EXIT.      HIO11850
       CLS     CALPR-6       TEST FOR OVERFLOW.                         HIO11860
       ALS     1             -2M                                        HIO11870
       SUB     CALPR-5       -L-2M                                      HIO11880
       ADD     CALPR-11      CAPACITY-L-2M                              HIO11890
       CAS     COUNT                                                    HIO11900
       TRA     *+3                                                      HIO11910
       TRA     *+1           CAPACITY IS REACHED                        HIO11920
       STZ     OVFLS          OR EXCEEDED.                              HIO11930
 DONE  STL     WRCSW         SET WRITE COMPLETE.                        HIO11940
       STZ     BUFWR         RESET BUFFER WRITE SWITCH.                 HIO11950
       STZ     1,2           RELEASE UNIT.                              HIO11960
       CAL     2,2                                                      HIO11970
       ZET     HYWSW                                                    HIO11980
       SLW     3,2                                                      HIO11990
       TRA     WRSV1         GO TO EXIT.                                HIO12000
       SPACE   2                                                        HIO12010
*  CONSTANTS AND SWITCHES.                                              HIO12020
       SPACE                                                            HIO12030
 HYSMS SMS     **                                                       HIO12040
       LIPT    *+1                                                      HIO12050
 HYCTL CTLW    HYORD                                                    HIO12060
 HYTCH TCH*    GTHIO+1                                                  HIO12070
 HTCHS TCH     SYSTWT                                                   HIO12080
 HYHCP CPYP*   HIOCP,,**                                                HIO12090
 HIOCP IOCP    FSTCL,,**                                                HIO12100
 HYTCP CPYD*   TIORT,,**                                                HIO12110
 TIORT IORT    **,,**        TAIL IORT.                                 HIO12120
 TLWRD PZE                   CELL TO HOLD TERMINAL WORD FOR WRITE-OUT.  HIO12130
 SELPW PZE                   WRITE SEL(+) SWITCH.                       HIO12140
 FSTCL OCT     631463000000  FIRST CLOCKWORD.                           HIO12150
 SQBRK PZE                   SEQUENCE BRK + BLOCKSIZE WRD BUILT HERE.   HIO12160
 LSTCL OCT     631463        LAST CLOCKWORD.                            HIO12170
 SVWTG BSS     3                                                        HIO12180
 TEMP  PZE                   TEMPORARY STORAGE.                         HIO12190
 1DEC  PZE     ,,1                                                      HIO12200
 RMAIN PZE                   NO. OF LOG. RECORDS LEFT TO WRITE OUT.     HIO12210
K1     PZE     1             CONSTANT 1.                                HIO12220
  K2   PZE     2,,                                                      HIO12230
EXPCTD PZE                                                              HIO12240
 COUNT PZE                   COUNT OF RECORDS WRITTEN.                  HIO12250
 HYORD OCT     120600120100                                             HIO12260
 HYPSW PZE                                                              HIO12270
 HBKRD PZE                                                              HIO12280
 HYWSW PZE                                                              HIO12290
       EJECT                                                            HIO12300
*  DEFINITION CARDS FOR WRITE SELECT ROUTINE.                           HIO12310
EOTI   EQU     RAWPR-5                                                  HIO12320
LCSTW  EQU     RAWPR-15                                                 HIO12330
 OVFLS EQU     RAWPR-9                                                  HIO12340
 P2REC EQU     CALPR-9       FIXED RECORD LENGTH OF PHASE 2.            HIO12350
 P3REC EQU     RECPR-2       FIXED RECORD LENGTH FROM PHASE 3.          HIO12360
PHASE  EQU     GENPR                                                    HIO12370
RCHXI  EQU     (RCHXI                                                   HIO12380
SPR29  EQU     FILPR-1                                                  HIO12390
WRCSW  EQU     RAWPR-4                                                  HIO12400
       END                                                              HIO12410
* 7090/94 SORT VER 7 MOD 10 MERGE, PHASE 2, MULTI-PASS              (10)HMR00000
*      FAP
       COUNT   1800                                                     HMR00010
       TITLE                                                            HMR00020
       ENTRY   HYMERG                                                   HMR00030
       ENTRY   MERGE                                                    HMR00040
       SST                                                              HMR00050
       PMC                                                              HMR00060
*                                                                       HMR00070
       PMC                                                              HMR00080
       EJECT                                                            HMR00090
       PMC                                                              HMR00100
       EJECT                                                            HMR00110
HYMERG BSS     0                                                        HMR00120
MERGE  SXA     MRXR4,4                                                  HMR00130
       SXD     GEN03,4       PLACE DELETE JOB RETRN AVAIL TO RESTART    HMR00140
*  START INITIALIZATION FOR MERGE PHASE                                 HMR00150
       SXA     MR777,2        GET THE ADDRESS FROM LOADER               HMR00160
       TRA     VMRHKP          TO PHASE 2 INITIALIZATION                HMR00170
*                                                                       HMR00180
*   THIS PASS IS AN ODD PASS                                            HMR00190
ODDPAS LDQ     WRTA2                                                    HMR00200
       STQ     WRTB1              NORMAL                                HMR00210
       LDQ     WRTA4                                                    HMR00220
       STQ     WRTB2                         SCHEME                     HMR00230
       LDQ     BBCK                                                     HMR00240
       STQ     VMR104                                 ODD PASS          HMR00250
       STL     ERAPR-19        SET EQUAL EXTRACT SWITCH                 HMR00260
       CALL    MREXIV          SET EXTRACT ROUTINE INVERSE              HMR00270
       TRA     PASS+1                                                   HMR00280
       SPACE   2                                                        HMR00290
*   CHECK THIS PASS IS THE LAST PASS                                    HMR00300
HYPRW  TSX     LASTCK,4        LAST PASS CONTROL ROUTINE                HMR00310
       ZET     ODDEVE                                                   HMR00320
       TRA     ODDPAS          THIS IS ODD PASS                         HMR00330
       NZT     LASTPS                                                   HMR00340
       TRA     GC              THIS IS NOT THE LAST PASS                HMR00350
       LDQ     WRTA1           LAST PASS IS AN EVEN PASS                HMR00360
       STQ     WRTB1           SET UP NORMAL WRITE MOOD                 HMR00370
       LDQ     WRTA3                                                    HMR00380
       STQ     WRTB2                                                    HMR00390
       LDQ     BACK                                                     HMR00400
       STQ     VMR104                                                   HMR00410
       STZ     ERAPR-19        RESET EQUAL WORD EXTRACT SWITCH          HMR00420
       CLA     NOP                                                      HMR00430
       STO     GA                                                       HMR00440
       STO     GB                                                       HMR00450
       STL     NORMAL                                                   HMR00460
       TRA     GD                                                       HMR00470
GC     LDQ     WRTA2           THIS IS EVEN PASS                        HMR00480
       STQ     WRTB1           SET                                      HMR00490
       LDQ     WRTA4              REVERSE                               HMR00500
       STQ     WRTB2                     WRITE                          HMR00510
       LDQ     BBCK                           SCHEME                    HMR00520
       STQ     VMR104                               FOR EVEN PASS       HMR00530
       STZ     ERAPR-19    INHIBIT COMPLEMENT OF EQUALS WORD BY EXTRACT HMR00540
GD     CALL    MREXNM          SET EXTRACT ROUTINE NORMAL               HMR00550
       TRA     PASS+1                                                   HMR00560
       SPACE   2                                                        HMR00570
*   BEGIN OF EACH PASS COME TO HERE                                     HMR00580
 PASS  NOP     HYPRW           WILL BE TRA TO HYPRW WHEN RUN ALL HYPER  HMR00590
       SLF                     TURN OFF ALL SENSE LIGHT                 HMR00600
       LXA     MORDER,1       ORDER OF MERGE TO IR1                     HMR00610
       SXA     MORD1,1                                                  HMR00620
       SXA     MORT,1                                                   HMR00630
       SXD     VMR153,1                                                 HMR00640
       SXD     WR15,1                                                   HMR00650
       AXT     1,2                                                      HMR00660
       CLA     ONE                                                      HMR00670
       STO     FLNO,2                                                   HMR00680
       ADD     ONE                                                      HMR00690
       TXI     *+1,2,1                                                  HMR00700
       TIX     *-3,1,1                                                  HMR00710
*  INITIALIZE NUMBER OF AVAILABLE AREAS EQUAL TO 2M+2                   HMR00720
       LXA     CNT6,4                                                   HMR00730
       SXA     AACNT,4                                                  HMR00740
       SXA     EFNAA,4                                                  HMR00750
*      INITIALIZE BLOCK SEQUENCE TABLES                                 HMR00760
       AXT     17,1                                                     HMR00770
       STZ     MROSBI+1,1                                               HMR00780
       TIX     *-1,1,1                                                  HMR00790
*      SET EOF INDICATOR TO ZERO.                                       HMR00800
       AXT     16,1                                                     HMR00810
       STZ     EOFIND,1                                                 HMR00820
       TIX     *-1,1,1                                                  HMR00830
*      INITIALIZE SWITCHES                                              HMR00840
       LDQ     TRA                                                      HMR00850
       SLQ     MRRSW1                                                   HMR00860
       SLQ     MRRSW2                                                   HMR00870
       SLQ     MR375S                                                   HMR00880
       SLQ     MRRSW4                                                   HMR00890
       SLQ     MRSBSW                                                   HMR00900
       SLQ     MR26                                                     HMR00910
       LDQ     NOP                                                      HMR00920
       SLQ     MRRSW3                                                   HMR00930
*      INITIALIZE SELECT TABLE                                          HMR00940
       AXT     16,1                                                     HMR00950
       PXA     ,1                                                       HMR00960
       STO     MRBKC,1                                                  HMR00970
       TIX     *-2,1,1                                                  HMR00980
*      OPEN ALL INPUT FILES                                             HMR00990
VMROPN SLN     4              TURN ON SENSE LITE 4.                     HMR01000
       STZ     RWCS                                                     HMR01010
MRA12  LXA     MORDER,2                                                 HMR01020
       AXT     1,1                                                      HMR01030
       STL     GENPR-4                                                  HMR01040
MORE   SXD     RWCS,1                                                   HMR01050
       PXD     ,1                                                       HMR01060
       STD*    FLN                                                      HMR01070
       NZT     PURE                                                     HMR01080
       STL     RAWPR-21                                                 HMR01090
OPEN   CALL    IOPEN                                                    HMR01100
       TXI     *+1,1,1                                                  HMR01110
       TIX     MORE,2,1                                                 HMR01120
*      OPEN ALL OUTPUT FILES                                            HMR01130
 OPENO SLT     4                                                        HMR01140
       TRA     PAT            I/P AND O/P FILES ARE OPENED.             HMR01150
       CAL     *                                                        HMR01160
       STP     RWCS                                                     HMR01170
       CLA*    PSN                                                      HMR01180
       ADD     ONE                                                      HMR01190
       STO*    PSN                                                      HMR01200
       TRA     MRA12                                                    HMR01210
*      INITIAL READS FROM EACH FILE                                     HMR01220
 PAT   LXA     MORDER,1       ORDER OF MERGE TO IR1.                    HMR01230
 MRST  SXA     MRA1,1                                                   HMR01240
       TSX     MRREAD,4                                                 HMR01250
       ZET     RAWPR-11                                                 HMR01260
       TSX     RAWPR-11,4                                               HMR01270
       NZT     RDIND                                                    HMR01280
       TRA     *-3                                                      HMR01290
       NZT     RDIND1        TEST FOR END OF FILE                       HMR01300
       TRA     MRA2                                                     HMR01310
*      EOF ON INITIAL READ                                              HMR01320
C1     STZ     RDIND1                                                   HMR01330
       CLA     AACNT          INCREASE COUNT OF                         HMR01340
       ADD     ONE              NUMBER READ AREAS                       HMR01350
       STO     AACNT              AVAILABLE                             HMR01360
       LXA     MRT2,1                                                   HMR01370
       CLA     *              SET EOF INDICATOR                         HMR01380
       STO     EOFIND,1         FOR THIS FILE.                          HMR01390
       STZ     FLWD,1         ZERO FILE WORD FOR THIS FILE.             HMR01400
       AXT     28672,4        SET SELECT CONTROL WORD                   HMR01410
       PXD     ,4               HIGH FOR THIS                           HMR01420
       STD     MRBKC,1            FILE.                                 HMR01430
*      TEST FOR ALL FILES AT EOF.                                       HMR01440
       LXA     MORDER,1                                                 HMR01450
       NZT     EOFIND,1                                                 HMR01460
       TRA     VMRSTA                                                   HMR01470
       TIX     *-2,1,1                                                  HMR01480
*      ALL FILES AT EOF - NO RECORDS FOR PHASE 2.                       HMR01490
       TSX     MSGSUP,4,2                                               HMR01500
       PZE     4                                                        HMR01510
       PZE     AMS24,,9+512*4                                           HMR01520
       PZE     VMSG03,,6                                                HMR01530
       PZE     VMSG04,,6                                                HMR01540
       PZE     VMSG05,,6+512*4                                          HMR01550
       TSX     (PAUSE,4                                                +HMR01560
       SWT     4                                                        HMR01570
       TRA     DELET                                                    HMR01580
       CALL    RESTAR                                                   HMR01590
*  ONE OF THE INPUT FILES GOT EOF DURING INITIAL READ                   HMR01600
VMRSTA LXA     MORD1,1        REDUCE MERGE ORDER BY 1.                  HMR01610
       TXI     *+1,1,-1                                                 HMR01620
       SXA     MORD1,1                                                  HMR01630
       TRA     MRA1                                                     HMR01640
 MRA2  LXD     MRT2,2         AREA NO. OF COMPLETED READ TO IR2         HMR01650
       LXA     MRT2,1         FILE NO. OF COMPLETED READ TO IR1         HMR01660
       NZT     RBK                                                      HMR01670
       TRA     Q                                                        HMR01680
       AXT     0,4                                                      HMR01690
       CLA*    BKRD,2                                                   HMR01700
       PDX     0,4,0                                                    HMR01710
       TXI     *+1,4,-1                                                 HMR01720
       PXA     0,4                                                      HMR01730
       COM                                                              HMR01740
       ADD     BKRD,2                                                   HMR01750
       STA     ADDR,2                                                   HMR01760
Q      AXT     1,4                                                      HMR01770
       CAL*    ADDR,2         NO. WORDS IN BLOCK FIXED/NO. REC. VARIABLEHMR01780
       STD     MRIBSC,1       INITIALIZE SEQ. LEVEL NO. FOR THIS FILE   HMR01790
FXSW04 TRA     VMRA2A         TRANSFER IF VARIABLE                      HMR01800
*      PAX     0,4            REPLACES INST. AT FXSW04 WHEN FIXED.      HMR01810
       PXA     0,4            CONVERT                                   HMR01820
       LRS     35               WORD COUNT                              HMR01830
       DVP     NWTR               TO                                    HMR01840
       XCL                          RECORD COUNT                        HMR01850
VMRA2A STA     CNT9           SAVE NO. RECORDS THIS BLOCK.              HMR01860
       STA     ARWD,2         SET UP                                    HMR01870
       ALS     18               AREA                                    HMR01880
       STD     ARWD,2             WORD                                  HMR01890
       CLA     CNT9           UPDATE TOTAL NO.                          HMR01900
       ADD     CNTR             RECORDS READ                            HMR01910
       STO     CNTR               COUNTER                               HMR01920
       CLA     ADDR,2         SET UP FILE WORD                          HMR01930
       STA     FLWD,1                                                   HMR01940
       PXD     ,2                                                       HMR01950
       STD     FLWD,1                                                   HMR01960
MRA1   AXT     **,1            MERGE ORDER IN DECREMENT                 HMR01970
       TIX     MRST,1,1                                                 HMR01980
       SPACE                                                            HMR01990
 MRC   SLN     1              TO INITIALIZE SEQ. CONTROL IND. FOR/OP    HMR02000
       LXA     MORD1,4                                                  HMR02010
       SXA     MORD2,4                                                  HMR02020
       SXA     MORD3,4                                                  HMR02030
       TSX     MRREAD,4       START M+1 READ                            HMR02040
       LDQ     TRA            SET SWITCH TO INDICATE INITIAL            HMR02050
       SLQ     MRRSW3           READ COMPLETED FROM EACH FILE           HMR02060
       SPACE                                                            HMR02070
*      EXTRACT CONTROL FIELDS FROM EACH FILE.                           HMR02080
       AXT     1,1                                                      HMR02090
       AXT     1,2                                                      HMR02100
VMR154 CLA     FLWD,1         LOCATION OF FIRST WORD OF RECORD          HMR02110
       TZE     TIM            TRANSFER IF FILE IS AT EOF.               HMR02120
       STA     RCWD             TO EXTRACT CALLING SEQUENCE WORD        HMR02130
       CLA     CFADR,1                                                  HMR02140
       STA     CFWD,2         TO K TABLE ADDRESS                        HMR02150
       PAX     ,4                                                       HMR02160
       SXD     RCWD,4         TO DEC. OF EXTRACT CALLING SEQ. WORD      HMR02170
       PXD     ,1             FILE NUMBER                               HMR02180
       STD     CFWD,2           TO K TABLE DECREMENT                    HMR02190
       CALL    MERXTR         CALL EXTRACT ROUTINE                      HMR02200
       TXI     *+1,2,1                                                  HMR02210
 TIM   TXI     *+1,1,1                                                  HMR02220
VMR153 TXL     VMR154,1,**    ORDER OF MERGE (MORDER) IN DECREMENT.     HMR02230
       SPACE                                                            HMR02240
*      PRELIMARY SORT                                                   HMR02250
 MR155 TSX     SORTF,4        TO SORT K TABLE                           HMR02260
       SPACE   1                                                        HMR02270
*      MOVE CONTROL FIELD TO AREA FOR NEXT SEQUENCE CHECK               HMR02280
MR100A LXA     NWDCF,1                                                  HMR02290
       CAL*    K1                                                       HMR02300
       SLW*    MRSC                                                     HMR02310
       TIX     *-2,1,1                                                  HMR02320
       SPACE                                                            HMR02330
FXSW01 TRA     MRDVWC         TRANSFER WHEN VARIABLE                    HMR02340
*      CLA     WRCT           REPLACES INST. AT FXSW01 WHEN FIXED       HMR02350
       ADD     ONE                                                      HMR02360
       TRA     MROPOT                                                   HMR02370
       SPACE                                                            HMR02380
*      DETERMINE WORD COUNT OF LOW (K1) RECORD (VARIABLE LENGTH ONLY)   HMR02390
MRDVWC AXC     **,4                                                     HMR02400
       LXD     K1,1                                                     HMR02410
       CAL     FLWD,1                                                   HMR02420
       STA     *+1                                                      HMR02430
       CAL     **,4           REC. WD. COUNT (BIN) OR CHAR. COUNT (BCD) HMR02440
 BCDSW PDX     ,1             INST. CHANGED,TO (TRA  BCDCV) WHEN BCD I/PHMR02450
       TXI     BUMP,1,1       INCREASE COUNT BY 1, WHEN BINARY I/P.     HMR02460
*      CONVERT BCD CHARACTER COUNT TO A BINARY WORD COUNT.              HMR02470
       ZET     MODPR-38                                                 HMR02480
       CALL    DMP04          CALL CE MOD.                              HMR02490
BCDCV  XCL                     CHARACTER COUNT TO MQ                    HMR02500
       PXD     ,0             CLEAR AC.                                 HMR02510
       CAQ     DTBT1,0,5      CONVERT BCD CHARACTER COUNT TO BINARY     HMR02520
       LRS     51             FROM AC (19) TO MQ (35).                  HMR02530
       DVP     SIX            CHANGE CHARACTER COUNT TO WORD COUNT.     HMR02540
       XCL                                                              HMR02550
       PAX     ,1             WORD COUNT OF BCD RECORD TO IR1.          HMR02560
 BUMP  TXI     *+1,1,**       INCREASE BY NO. OF OPTIONS (BOTH BIN./BCD)HMR02570
CM     NOP                                                              HMR02580
       PXA     ,1             SAVE TOTAL WORD COUNT                     HMR02590
       STO     NWTR             OF THIS RECORD.                         HMR02600
       ADD     MRNWRW         NO. WORDS ALREADY MERGED AND READY TO WR. HMR02610
MROPOT SUB     MAXOPB         MAX. O/P BLOCK SIZE,(WORDS/VAR.)(REC./FXD)HMR02620
       TMI     VMMK1          MAX. BLOCK SIZE WILL NOT BE EXCEEDED.     HMR02630
       TZE     VMMK1          MAX. BLOCK SIZE WILL NOT BE EXCEEDED.     HMR02640
       SPACE                                                            HMR02650
*      INCLUSION OF THIS RECORD WOULD EXCEED MAX. BLOCK LENGTH          HMR02660
VMFWR  NZT     WRIND          TEST FOR WRITE CHANNEL IN OPERATION.      HMR02670
       TRA     *+3            IN OPERATION.                             HMR02680
       TSX     MRWR,4         TO WRITE THE BLOCK.                       HMR02690
       TRA     VMMK1                                                    HMR02700
       NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       HMR02710
       TRA     VMFWR          IN OPERATION.                             HMR02720
       NZT     AACNT          NOT IN OPERATION-TEST FOR AVAILABLE AREA. HMR02730
       TRA     *+2            NO READ AREA AVAILABLE.                   HMR02740
       TSX     MRREAD,4       AREA AVAILABLE-READ A BLOCK.              HMR02750
       TSX     MRWR,4         TO WRITE THE BLOCK.                       HMR02760
       SPACE                                                            HMR02770
*      MOVE K1 RECORD TO WRITE TABLE                                    HMR02780
 VMMK1 LXD     K1,1           FILE NUMBER TO IR1.                       HMR02790
       CAL     FLWD,1                                                   HMR02800
       SPACE                                                            HMR02810
*      CHECKSUM OPTION SWITCH                                           HMR02820
MRCKSW TRA     VMR104                                                   HMR02830
*      TRA     FXCKS          REPLACES MRCKSW WHEN FIXED CHECKSUM       HMR02840
*      TRA     CKS            REPLACES MRCKSW WHEN VARIABLE CHECKSUM    HMR02850
VMR104 LAC     WRCT,2                                                   HMR02860
       STA*    WRTB1          MOVE ADDRESS TO WRITE TABLE               HMR02870
       STA     LOC                                                      HMR02880
FXSW02 TRA     *+1            BECOMES TRA TO MR106 WHEN FIXED           HMR02890
       LXA     NWTR,4         MOVE NO. WORDS THIS RECORD                HMR02900
       PXD     ,4               TO                                      HMR02910
       STD*    WRTB1              WRITE TABLE.                          HMR02920
       SPACE                                                            HMR02930
 MR106 LXD     K1,1           FILE NO.                                  HMR02940
       CAL     FLWD,1                                                   HMR02950
       ADD     NWTR           RECORD LENGTH                             HMR02960
       SLW     FLWD,1         UPDATE FLWD WORD                          HMR02970
       PDX     ,2             AREA NO. TO IR2                           HMR02980
       CLA     ARWD,2                                                   HMR02990
       PAX     ,4                                                       HMR03000
       TXL     PHYL+3,4,0                                               HMR03010
       TXI     *+1,4,-1                                                 HMR03020
 PHYL  PXA     ,4                                                       HMR03030
       STA     ARWD,2         UPDATE AREA WORD                          HMR03040
       TXH     MR26,4,0       TRANSFER IF AREA NOT EXHAUSTED            HMR03050
       CAL     *              AREA IS EXHAUSTED -                       HMR03060
       STP     ARWD,2           SET SIGN MINUS IN ARWD AND              HMR03070
       SLN     3                TURN ON SENSE LITE 3.                   HMR03080
*                                                                       HMR03090
 MR26  TRA     BETH                                                     HMR03100
       LDQ     TRA                                                      HMR03110
       SLQ     MR26                                                     HMR03120
       TRA     MR209                                                    HMR03130
 BETH  CLA     WRCT           UPDATE NUMBER OF RECORDS MERGED COUNT.    HMR03140
       ADD     ONE                                                      HMR03150
       STO     WRCT                                                     HMR03160
FXSW03 TRA     *+1            BECOMES TRA TO MR209 WHEN FIXED           HMR03170
       CLA     MRNWRW         UPDATE NO. WORDS MERGED COUNT             HMR03180
       ADD     NWTR                                                     HMR03190
       STO     MRNWRW                                                   HMR03200
*                                                                       HMR03210
 MR209 SLT     3              ON IF AREA EXHAUSTED                      HMR03220
       TRA     MR210A         NOT EXHAUSTED.                            HMR03230
       TRA     MR373          EXHAUSTED                                 HMR03240
*      TEST FOR POSSIBLE READ                                           HMR03250
MR210A NZT     RDIND                                                    HMR03260
       TRA     MR210                                                    HMR03270
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              HMR03280
       TRA     MR210                                                    HMR03290
       TSX     MRREAD,4       TO READ ROUTINE                           HMR03300
       TRA     MR210                                                    HMR03310
*      EXTRACT NEXT RECORD                                              HMR03320
MR210  LXD     K1,1           FILE NO. TO IR1                           HMR03330
       CLA     FLWD,1                                                   HMR03340
       STA     RCWD           ADDRESS OF RECORD                         HMR03350
       CLA     CFADR,1                                                  HMR03360
       PAX     ,1                                                       HMR03370
       SXD     RCWD,1         ADR. OF LAST WORD OF CF +1                HMR03380
       CALL    MERXTR         ENTER EXTRACT                             HMR03390
       EJECT                                                            HMR03400
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         HMR03410
*      ENTER INTERNAL MERGE LOOP AT APPROPRIATE COMPARE       *         HMR03420
*      RETURN WILL BE TO MR100 WHERE RECORD, SELECTED         *         HMR03430
*      TO BE MERGED, WILL BE SEQUENCED CHECKED AND MOVED      *         HMR03440
*      TO WRITE TABLE.                                        *         HMR03450
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         HMR03460
MRGOMR LXA     MORD3,2        CURRENT INTERNAL MERGE ORDER TO IR2.      HMR03470
       TRA*    MRLOOP,2        GO TO PROPER MERGE COMPARE               HMR03480
       SPACE                                                            HMR03490
       SPACE                                                            HMR03500
*      SEQUENCE CHECK THIS RECORD WITH PREVIOUS RECORD                  HMR03510
       ZET     MODPR-35        CE                                       HMR03520
       CALL    DMP01                                                    HMR03530
MR100  LXA     NWDCF,1                                                  HMR03540
MR100B CAL*    K1                                                       HMR03550
       LAS*    MRSC                                                     HMR03560
       TRA     MR100A         OK RECORD HIGH.                           HMR03570
       TRA     MR100C         EQUAL ON THIS WORD.                       HMR03580
       SLT     4              RECORD LOW TEST FOR NEW SEQUENCE.         HMR03590
       TRA     MRER2          GO TO OUT OF SEQUENCE ROUTINE.            HMR03600
       SLN     1              NEW SEQUENCE.                             HMR03610
       TRA     MR100A                                                   HMR03620
MR100C TIX     MR100B,1,1     TO COMPARE NEXT WORD.                     HMR03630
       SPACE                                                            HMR03640
       SPACE                                                            HMR03650
       NZT     MODPR-13       TEST FOR USER MOD.                        HMR03660
       TRA     FXSW01         NO MODIFICATION.                          HMR03670
SUMPOS NZT     WRCT           PREV. RECORD AVAIL. FOR SUMMARIZATION.    HMR03680
       TRA     FXSW01         NOT AVAIL. IT IS BEING WRITTEN            HMR03690
*      SUMMARIZATION POSSIBLE (RECORD IN WRTB1 IS NOT IN WRITE STATUS)  HMR03700
       LXD     K1,1                                                 (10)HMR03705
       CAL     FLWD,1                                                   HMR03710
       ZET     FXORVA                                                   HMR03720
       ACL     MRDVWC         VARIABLE.                                 HMR03730
       PAX     ,1                                                       HMR03740
       SXD     LOEQRC,1                                                 HMR03750
       NZT     FXORVA                                                   HMR03760
       TRA     BOT                                                      HMR03770
       CLA     SW                                                       HMR03780
       STO     CM                                                       HMR03790
       CLA     NWTR                                                     HMR03800
       STO     NWLR                                                     HMR03810
       TRA     MRDVWC                                                   HMR03820
BOR    SXA     NWTR,1                                                   HMR03830
       CLA     NOP                                                      HMR03840
       STO     CM                                                       HMR03850
BOT    LAC     WRCT,2                                                   HMR03860
       TXI     *+1,2,1                                                  HMR03870
       CLA*    WRTB1                                                    HMR03880
       ZET     FXORVA                                                   HMR03890
       ACL     MRDVWC         VARIABLE                                  HMR03900
       STA     LOEQRC                                                   HMR03910
       CAL     LOEQRC                                                   HMR03920
       STL     GENPR-4        SAVE LOCATION COUNTER FOR TRACING.        HMR03930
USRM4  CALL    MPM04          EXIT TO MODIFICATION PROGRAM.             HMR03940
       TRA     FXSW01         RETURN FROM MPM04 IF SUMM. NOT PERFORMED  HMR03950
       CLA     NRSUMM         RETURN FROM MPM04 IF SUMM. PERFORMED.     HMR03960
       ADD     ONE                                                      HMR03970
       STO     NRSUMM                                                   HMR03980
       LDQ     NOP                                                      HMR03990
       SLQ     MR26                                                     HMR04000
       TRA     MR106          FIXED.                                    HMR04010
LOEQRC PZE     0                                                        HMR04020
NWLR   PZE                                                              HMR04030
SW     TRA     BOR                                                      HMR04040
       SPACE                                                            HMR04050
*      AREA IS EXHAUSTED                                                HMR04060
 MR373 LXD     K1,1           FILE NUMBER TO IR1.                       HMR04070
       SXA     MR374,1                                                  HMR04080
       CLA     MRBKC,1        REDUCE BLOCK COUNT                        HMR04090
       PDX     ,4               FOR THIS FILE                           HMR04100
       TXI     *+1,4,-1           IN READ                               HMR04110
       PXD     ,4                   CONTROL                             HMR04120
       STD     MRBKC,1                TABLE                             HMR04130
       NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       HMR04140
       TRA     *+4            IN OPERATION.                             HMR04150
       NZT     AACNT          TEST FOR READ AREA AVAILABLE.             HMR04160
       TRA     *+2            AREA NOT AVAIL.                           HMR04170
       TSX     MRREAD,4       READ A BLOCK.                             HMR04180
       LXA     MR374,1                                                  HMR04190
       CLA     RFWD1,1        TEST FOR RESERVE BLOCK FOR THIS FILE.     HMR04200
       TNZ     MR374A         BLOCK IN RESERVE FOR THIS FILE.           HMR04210
       CLA     EOFIND,1                                                 HMR04220
       TNZ     MREF3          EOF THIS FILE.                            HMR04230
MR374B NZT     WRIND          TEST FOR WRITE CHANNEL IN OPERATION.      HMR04240
       TRA     MR374C         IN OPERATION.                             HMR04250
       TSX     SMRTMA,4       MAKE ALL POSSIBLE AREAS AVAIL. FOR READ.  HMR04260
       NZT     AACNT          TEST FOR AVAILABLE READ AREA.             HMR04270
       TRA     MR374D         NO AREA AVAIL.                            HMR04280
       TSX     MRREAD,4       READ.                                     HMR04290
       TRA     MR374E                                                   HMR04300
MR374C NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       HMR04310
       TRA     MR374B         IN OPERATION.                             HMR04320
       NZT     AACNT          TEST FOR AVAIL. READ AREA.                HMR04330
       TRA     MR374B+2       NO AREA AVAIL.                            HMR04340
       TRA     MR374C-2       AREA AVAIL.                               HMR04350
MR374D LDQ     MRRSW2          READ ACCOMPLISHED ON                     HMR04360
       SLQ     *+1            LAST ENTRY TO                             HMR04370
       TRA     *+2            MRREAD ROUTINE.                           HMR04380
       TRA     MR375          NO.                                       HMR04390
       LDQ     NOP            YES-MAKE LAST BLOCK                       HMR04400
       SLQ     MRRSW4           READ AVAILABLE FOR                      HMR04410
       TRA     MR374C-2           MERGING.                              HMR04420
MR374E LXA     MR374,1                                                  HMR04430
       CLA     RFWD1,1                                                  HMR04440
       TZE     MR375                                                    HMR04450
MR374A TMI     ARS3                                                     HMR04460
 MR374 AXT     **,1                                                     HMR04470
       CLA     RFWD1,1                                                  HMR04480
       STO     FLWD,1                                                   HMR04490
       STZ     RFWD1,1                                                  HMR04500
       AXT     2,4                                                      HMR04510
MRTE   NZT*    RWD,4                                                    HMR04520
       TRA     MR210A                                                   HMR04530
       LDQ*    RWD,4                                                    HMR04540
       STZ*    RWD,4                                                    HMR04550
       STQ*    RWD+1,4                                                  HMR04560
       TXI     *+1,4,1                                                  HMR04570
       TXL     MRTE,4,3       TEST FOR ADDITIONAL RESERVE RECORDS.      HMR04580
       TRA     MR210A                                                   HMR04590
*                                                                       HMR04600
*     FILE EXHAUSTED                                                    HMR04610
 MR375 CLA     EOFIND,1                                                 HMR04620
       TNZ     MREF3          EOF THIS FILE                             HMR04630
       NZT     WRIND                                                    HMR04640
       TRA     MR375D         WRITE CHANNEL IS IN OPERATION.            HMR04650
       TSX     MRWR,4         TO WRITE                                  HMR04660
*                                                                       HMR04670
MR375S TRA     MR375B         SWITCH - NOP WHEN READ HAS BEEN STARTED.  HMR04680
       LDQ     TRA            RESET                                     HMR04690
       SLQ     MR375S           SWITCH.                                 HMR04700
       TRA     MR375A                                                   HMR04710
*                                                                       HMR04720
MR375B NZT     AACNT          TEST FOR READ AREA AVAILABLE.             HMR04730
       TRA     MR375C         NO READ AREA AVAILABLE                    HMR04740
       TSX     MRREAD,4       TO READ ROUTINE                           HMR04750
MR375A LXA     MR374,1                                                  HMR04760
       CLA     RFWD1,1                                                  HMR04770
       TZE     *+3            RECORDS NOT AVAIL. THIS FILE              HMR04780
       TMI     ARS3           SEQUENCE BREAK THIS FILE                  HMR04790
       TRA     MR374                                                    HMR04800
       CLA     EOFIND,1                                                 HMR04810
       TNZ     MREF3          EOF THIS FILE                             HMR04820
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              HMR04830
       TRA     MR375C         READ AREA NOT AVAILABLE                   HMR04840
       TRA     MR375A-1                                                 HMR04850
MR375D NZT     RDIND          TEST FOR READ CHANNEL IN OPERATION.       HMR04860
       TRA     MR375+2        READ CHANNEL IN OPERATION                 HMR04870
       NZT     AACNT          TEST FOR READ AREA AVAILABLE              HMR04880
       TRA     MR375S-1       NO READ AREA AVAILABLE                    HMR04890
       TSX     MRREAD,4       TO READ ROUTINE                           HMR04900
       LDQ     NOP            SET                                       HMR04910
       SLQ     MR375S           SWITCH                                  HMR04920
       TRA     MR375S-1                                                 HMR04930
*                                                                       HMR04940
MR375C TSX     SMRTMA,4       MAKE ALL POSSIBLE READ AREAS AVAIL.       HMR04950
*                                                                       HMR04960
MR376A NZT     AACNT          TEST FOR READ AREA AVAILABLE              HMR04970
       TRA     MR377          NO READ AREA AVAILABLE                    HMR04980
       TSX     MRREAD,4       TO READ ROUTINE                           HMR04990
       LXA     MR374,1                                                  HMR05000
       CLA     RFWD1,1                                                  HMR05010
       TZE     *+2                                                      HMR05020
       TRA     MR375A+3       RECORDS NOW AVAIL. THIS FILE              HMR05030
       CLA     EOFIND,1                                                 HMR05040
       TNZ     MREF3          EOF THIS FILE                             HMR05050
       TRA     MR376A                                                   HMR05060
*                                                                       HMR05070
MR377  LDQ     MRRSW2          READ ACCOMPLISHED ON                     HMR05080
       SLQ     *+1              LAST ENTRY TO                           HMR05090
       TRA     *+2                MRREAD ROUTINE.                       HMR05100
       TRA     MR377A         NO.                                       HMR05110
       LDQ     NOP            YES-SET SWITCH IN READ ROUTINE            HMR05120
       SLQ     MRRSW4           TO BYPASS ACTUAL READ                   HMR05130
*                             SIMULATE A READ TO MAKE LAST BLOCK        HMR05140
       TSX     MRREAD,4         READ AVAILABLE FOR MERGE                HMR05150
*                                                                       HMR05160
MR377A LXA     MR374,1                                                  HMR05170
       CLA     RFWD1,1                                                  HMR05180
       TZE     *+2                                                      HMR05190
       TRA     MR375A+3                                                 HMR05200
       CLA     EOFIND,1                                                 HMR05210
       TNZ     MREF3          EOF THIS FILE                             HMR05220
       TSX     MSGSUP,4,2                                               HMR05230
       PZE     4                                                        HMR05240
       PZE     AMS09,,5+512*4                                           HMR05250
       PZE     VMSG03,,6                                                HMR05260
       PZE     VMSG04,,6                                                HMR05270
       PZE     VMSG05,,6+512*4                                          HMR05280
       TSX     (PAUSE,4                                                 HMR05290
       SWT     4                                                        HMR05300
       TRA     DELET                                                    HMR05310
       CALL    RESTAR                                                   HMR05320
ARS3   BSS     0              NEW BLOCK IS EITHER NEW SEQUENCE          HMR05330
       LXA     MR374,1                                                  HMR05340
       STZ     FLWD,1         OR EOF                                    HMR05350
       LXA     MORD3,4                                                  HMR05360
       TXL     MR378,4,1      TEST FOR ALL FILES AT NEW SEQUENCE        HMR05370
       TIX     *+1,4,1        REDUCE MORD3 BY ONE                       HMR05380
       SXA     MORD3,4                                                  HMR05390
       CAL     CFWD-1,4       MOVE DOWN CFWDS                           HMR05400
       LDQ     CFWD,4                                                   HMR05410
       XCL                                                              HMR05420
       STQ     CFWD,4                                                   HMR05430
       TIX     *-3,4,1                                                  HMR05440
       TRA     MR100                                                    HMR05450
       SPACE                                                            HMR05460
*      ALL FILES AT NEW SEQUENCE LEVEL                                  HMR05470
 MR378 LXA     MORDER,4                                                 HMR05480
       CLA     MRBKC,4                                                  HMR05490
       SSP                                                              HMR05500
       STO     MRBKC,4                                                  HMR05510
       TIX     *-3,4,1                                                  HMR05520
       CLA     WRCT                                                     HMR05530
       TZE     NSEQ             NO RECORDS REMAINING TO BE WRITTEN      HMR05540
       TSX     MRWR,4           TO WRITE REMAINING RECORDS THIS SEQ     HMR05550
 NSEQ  LXA     MORD2,4        NUMBER OF FILES LEFT TO BE MERGED         HMR05560
       SXA     MORD3,4          TO CURRENT MERGE ORDER.                 HMR05570
       SXD     MR253,4                                                  HMR05580
       SLN     4                                                        HMR05590
       LXA     MORDER,4                                                 HMR05600
 CHRIS LDQ     RFWD1,4        MOVE RFWD1 INTO FLWD.                     HMR05610
       STQ     FLWD,4                                                   HMR05620
       CAL     RFWD2,4        MOVE RFWD2 INTO RFWD1                     HMR05630
       SLW     RFWD1,4                                                  HMR05640
       CAL     RFWD3,4        MOVE RFWD3 INTO RFWD2                     HMR05650
       SLW     RFWD2,4                                                  HMR05660
       STZ     RFWD3,4        ZERO OUT RFWD3                            HMR05670
       TIX     CHRIS,4,1                                                HMR05680
*                                                                       HMR05690
*      EXTRACT CONTROL FIELDS                                           HMR05700
       AXT     1,1                                                      HMR05710
       AXT     1,2                                                      HMR05720
 MR254 CLA     FLWD,1         LOCATION OF FIRST WORD OF RECORD          HMR05730
       TNZ     MARY                                                     HMR05740
       TXI     *-2,1,1                                                  HMR05750
 MARY  STA     RCWD                                                     HMR05760
       CLA     CFADR,1                                                  HMR05770
       STA     CFWD,2                                                   HMR05780
       PAX     ,4                                                       HMR05790
       SXD     RCWD,4                                                   HMR05800
       PXD     ,1             FILE NUMBER                               HMR05810
       STD     CFWD,2           TO DECREMENT OF K TABLE                 HMR05820
       CALL    MERXTR         ENTER EXTRACT ROUTINE                     HMR05830
       TXI     *+1,2,1                                                  HMR05840
 MR253 TXL     MR254+2,2,**   MORD3 IN DECREMENT.                       HMR05850
*                                                                       HMR05860
*      PRELIMARY SORT                                                   HMR05870
       TSX     SORTF,4        SORT K TABLE                              HMR05880
       TRA     MR100                                                    HMR05890
       EJECT                                                            HMR05900
*************************                                               HMR05910
*  MERGE WRITE ROUTINE  *                                               HMR05920
*************************                                               HMR05930
       SPACE                                                            HMR05940
 MRWR  BSS     0                                                        HMR05950
       SXA     WRRET,4        SAVE IR4 FOR RETURN                       HMR05960
       SPACE                                                            HMR05970
*      UPDATE STATUS OF RECORD STORAGE AREAS BY CHANGING -(ARWD) WORDS  HMR05980
*      TO -1 AND -1 WORDS TO ZERO                                       HMR05990
       LXA     CNT6,1         NO. OF AREAS TO IR1                       HMR06000
       CLA     ARWD,1                                                   HMR06010
       TMI     WR1A                                                     HMR06020
 WR1   TIX     *-2,1,1                                                  HMR06030
       TRA     WRWAIT                                                   HMR06040
 WR1A  ALS     2              TEST FOR -1                               HMR06050
       PBT                                                              HMR06060
       TRA     WR2                                                      HMR06070
       STZ     ARWD,1         SET -1 TO ZERO                            HMR06080
       CLA     AACNT                                                    HMR06090
       ADD     ONE                                                      HMR06100
       STO     AACNT                                                    HMR06110
       TRA     WR1                                                      HMR06120
  WR2  CAL     FIVE            SET -ARWD TO -1                          HMR06130
       STP     ARWD,1                                                   HMR06140
       TRA     WR1                                                      HMR06150
       SPACE                                                            HMR06160
WRWAIT NZT     WRIND          WAIT FOR COMPLETION OF                    HMR06170
       TRA     *-1              PREVIOUS WRITE.                         HMR06180
 WR3   ZET     WRIND1         TEST FOR END OF TAPE                      HMR06190
       TRA     UP             END OF TAPE.                              HMR06200
*                                                                       HMR06210
       CLA     WRCT           NO. RECORDS IN OUPUT BLOCK.               HMR06220
FXSW07 TRA     WR6            TRANSFER IF VARIABLE.                     HMR06230
*      XCL                    REPLACES INST. AT FXSW07 WHEN FIXED       HMR06240
       MPY     NWTR           CONVERT RECORDS                           HMR06250
       XCL                      TO WORDS.                               HMR06260
 WR6   STA     CNT11          NO. WORDS IF FIXED/NO. RECORDS IF VAR     HMR06270
       SPACE                                                            HMR06280
       LXA     MRT3,1         SELECT FILE FOR WRITE                     HMR06290
       SLT     1              TEST WHETHER NEW SEQUENCE                 HMR06300
       TRA     WR5            OLD SEQUENCE                              HMR06310
*      NEW SEQUENCE                                                     HMR06320
       CLA     CNT5           UPDATE NO. OF SEQ. WRITTEN COUNT          HMR06330
       ADD     ONE                                                      HMR06340
       STO     CNT5                                                     HMR06350
       LXA     MROSBI,4       UPDATE OUTPUT                             HMR06360
       TXI     *+1,4,1          SEQUENCE                                HMR06370
       SXA     MROSBI,4           INDICATOR                             HMR06380
       SXD     CNT11,4        STORE SEQ. BREAK IND. IN DEC. OF CNT11    HMR06390
       TXI     *+1,1,1        INCREASE OUTPUT FILE NO. BY 1             HMR06400
WR15   TXH     WR4,1,**       CURRENT NO. OF OUTPUT FILES IN DECREMENT. HMR06410
       SXA     MRT3,1         SAVE PRESENT WRITE FILE                   HMR06420
       TRA     WR5                                                      HMR06430
       SPACE                                                            HMR06440
 WR4   AXT     1,1            REINITIALIZE WRITE FILE TO 1              HMR06450
       SXA     MRT3,1           AND SAVE IN MRT3                        HMR06460
*      INITIALIZE WRITE CALLING SEQUENCE WORDS                          HMR06470
 WR5   CLS     ONE                                                      HMR06480
       STO     RWCS                                                     HMR06490
       CLA     FLNO,1                                                   HMR06500
       PAX     0,1                                                      HMR06510
       SXD     RWCS,1                                                   HMR06520
FOW    ZET     PURE                                                     HMR06530
       TRA     FW                                                       HMR06540
       CLA     WRTB1                                                    HMR06550
GA     SUB     WRCT                                                     HMR06560
GB     ADD     ONE                                                      HMR06570
       STA     RWCS1                                                    HMR06580
       TRA     FP                                                       HMR06590
FW     CLA     WRTB1                                                    HMR06600
       STA     RWCS1                                                    HMR06610
FP     LXA     MRNWRW,1                                                 HMR06620
       SXD     RAWPR-9,1                                                HMR06630
       LXA     WRCT,1                                                   HMR06640
       SXD     RWCS1,1                                                  HMR06650
       STL     GENPR-4                                                  HMR06660
       ZET     MODPR-36       CE                                        HMR06670
       CALL    DMP02                                                    HMR06680
       CALL    MRGIO                                                    HMR06690
*      UPDATE TOTAL RECORDS WRITTEN COUNT                               HMR06700
BB     CLA     CNTW                                                     HMR06710
       ADD     WRCT            UPDATE THE TOTAL NUMBER                  HMR06720
       STO     CNTW            OF RECORDS WRITTEN COUNTER               HMR06730
       STZ     WRCT            RESET NO. OF RECORDS WRITTEN/BLK COUNTER HMR06740
       STZ     MRNWRW          RESET NO. OF WORDS READY TO WRITE COUNTERHMR06750
       LDQ     WRTB1                                                    HMR06760
       CAL     WRTB2           INTER-CHANGE THE WRITE TABLE             HMR06770
       SLW     WRTB1                                                    HMR06780
       STQ     WRTB2                                                    HMR06790
 WRRET AXT     **,4           RESTORE IR4                               HMR06800
       TRA     1,4              AND EXIT FROM WRITE                     HMR06810
       EJECT                                                            HMR06820
*      MAKE AREAS THAT HAVE BEEN WRITTEN AVAILABLE FOR READING (BY      HMR06830
*        CHANGING -1(ARWD) WORDS TO ZERO).                              HMR06840
SMRTMA LXA     CNT6,1                                                   HMR06850
       CLA     ARWD,1                                                   HMR06860
       TMI     TMONE                                                    HMR06870
SMTNA  TIX     *-2,1,1                                                  HMR06880
       NZT     WRIND          WAIT FOR COMPLETION OF LAST WRITE         HMR06890
       TRA     *-1                                                      HMR06900
       TRA     1,4            RETURN.                                   HMR06910
TMONE  ALS     2                                                        HMR06920
       PBT                                                              HMR06930
       TRA     SMTNA                                                    HMR06940
       STZ     ARWD,1                                                   HMR06950
       CLA     AACNT                                                    HMR06960
       ADD     ONE                                                      HMR06970
       STO     AACNT                                                    HMR06980
       TRA     SMTNA                                                    HMR06990
       EJECT                                                            HMR07000
************************                                                HMR07010
*  MERGE READ ROUTINE  *                                                HMR07020
************************                                                HMR07030
       SPACE                                                            HMR07040
MRREAD SXA     MRSWR,4                                                  HMR07050
       SPACE                                                            HMR07060
MRRSW1 TRA     *+2           SWITCH WILL BE NOP WHEN                    HMR07070
       TRA     1,4             ALL FILES ARE AT EOF                     HMR07080
       ZET     RAWPR-11        CHECK LAST READ IS GOOD READ             HMR07090
       TSX     RAWPR-11,4      IT IS BAD ONE                            HMR07100
       NZT     RDIND           IT IS GOOD READ                          HMR07110
       TRA     *-3                                                      HMR07120
MRRSW2 TRA     MRRSW3        SWITCH WILL BE NOP WHEN READ WAS NOT       HMR07130
       LDQ     TRA             ACCOMPLISHED ON LAST ENTRY               HMR07140
       SLQ     MRRSW2                                                   HMR07150
       TRA     MRRDSL                                                   HMR07160
       SPACE                                                            HMR07170
MRRSW3 NOP     MREOFT         SWITCH WILL BE SET TO TRA AFTER           HMR07180
       TRA     MRRDSL         INITIAL READ COMPLETED ON EACH FILE       HMR07190
       SPACE                                                            HMR07200
MREOFT ZET     RDIND1         TEST FOR END OF FILE ON LAST READ         HMR07210
       TRA     MREF2         TO SET END OF FILE INDICATOR               HMR07220
*   LAST READ DOES NOT MAKE END OF FILE                                 HMR07230
       CLA     MRT1                                                     HMR07240
       LDQ     MRT2                                                     HMR07250
       STO     MRT2                                                     HMR07260
       STQ     MRT1                                                     HMR07270
       SPACE                                                            HMR07280
       LXD     MRT1,2         AREA NO. OF LAST READ TO IR2              HMR07290
       LXA     MRT1,1         FILE NO. OF LAST READ TO IR1              HMR07300
       NZT     RBK             CHECK FOR READ BACKWARD                  HMR07310
       TRA     FORR            RBK=0 , THAT IS FORWARD READ             HMR07320
       AXT     0,4                                                      HMR07330
       CLA*    BKRD,2          GET THE LAST WORD OF BLOCK               HMR07340
       PDX     0,4,0           LENGTH OF THIS BLOCK                     HMR07350
       TXI     *+1,4,-1                                                 HMR07360
       PXA     0,4                                                      HMR07370
       COM                                                              HMR07380
 CONST ADD     BKRD,2                                                   HMR07390
       STA     ADDR,2                                                   HMR07400
FORR   AXT     1,4                                                      HMR07410
       CAL*    ADDR,2         NO. WORDS IN BLOCK FIXED/NO. RECORDS VAR. HMR07420
FXSW05 TRA     MRRFV          TRANSFER IF VARIABLE.                     HMR07430
*      PAX     ,4             REPLACES INST. AT FXSW05 WHEN FIXED.      HMR07440
       PXA     ,4             CONVERT                                   HMR07450
       LRS     35               WORD COUNT                              HMR07460
       DVP     NWTR               TO                                    HMR07470
       XCL                          RECORD COUNT                        HMR07480
MRRFV  STA     CNT9           SAVE NO. RECORDS READ THIS BLOCK.         HMR07490
       STA     ARWD,2         SET UP                                    HMR07500
       ALS     18               AREA                                    HMR07510
       STD     ARWD,2             WORD                                  HMR07520
       CLA     CNTR           UPDATE TOTAL NO.                          HMR07530
       ADD     CNT9             RECORDS READ                            HMR07540
       STO     CNTR               COUNTER                               HMR07550
       SPACE                                                            HMR07560
*      SET UP RESERVE FILE WORD                                         HMR07570
       AXT     1,4                                                      HMR07580
       CAL*    ADDR,2         CHECK FOR SEQUENCE BREAK                  HMR07590
       ANA     MSK1                                                     HMR07600
       LAS     MRIBSC,1       COMPARE WITH PREV. SEQ. LEVEL THIS FILE.  HMR07610
       TRA     *+2                                                      HMR07620
       TRA     MRSTN1-1       SAME SEQUENCE                             HMR07630
       LDQ     NOP            SET SWITCH TO INDICATE SEQUENCE BREAK     HMR07640
       SLQ     MRSBSW                                                   HMR07650
       STD     MRIBSC,1       REINITIALIZE SEQ. BREAK NO. FOR THIS FILE.HMR07660
       CLA     MRBKC,1        SET SELECT CONTROL WORD                   HMR07670
       SSM                      TABLE MINUS FOR                         HMR07680
       STO     MRBKC,1            THIS FILE                             HMR07690
       CLA     ADDR,2         LOCATION OF FIRST RECORD THIS AREA TO AC  HMR07700
MRSTN1 ZET*    RWD,4          TEST FOR AVAILABLE RESERVE WORD THIS FILE HMR07710
       TXI     *-1,4,1                                                  HMR07720
       STA*    RWD,4          LOCATION OF 1ST. RECORD TO ADR. RES. WORD HMR07730
       PXD     ,2             AREA NUMBER TO DECREMENT.                 HMR07740
       STD*    RWD,4            OF RESERVE WORD                         HMR07750
MRSBSW TRA     MRRSW4         SWITCH NOP WHEN SEQUENCE BREAK            HMR07760
       LDQ     TRA            RESET                                     HMR07770
       SLQ     MRSBSW           SWITCH                                  HMR07780
       CLS*    RWD,4          SET SIGN OF RESERVE WORD MINUS TO         HMR07790
       STO*    RWD,4            INDICATE BLOCK IS A NEW SEQUENCE        HMR07800
       TRA     MRRSW4                                                   HMR07810
       SPACE                                                            HMR07820
MRRSW4 TRA     MRRDSL        WILL BE NOP WHEN ROUTINE                   HMR07830
       LDQ     TRA             HAS BEEN ENTERED                         HMR07840
       SLQ     MRRSW4             FOR A SIMULATED READ                  HMR07850
SISW2  LDQ     NOP            SET SW. TO BYPASS MOVING RESERVE TABLE.   HMR07860
       SLQ     MRRSW2           TO CURRENT TABLE ON NEXT READ ENTRY     HMR07870
       TRA     MRSWR          TO EXIT WITHOUT A READ                    HMR07880
       SPACE                                                            HMR07890
*      SELECT  FILE FOR NEXT READ                                       HMR07900
MRRDSL AXT     2,2                                                      HMR07910
       LXA     MORDER,1                                                 HMR07920
       TXI     *+1,1,-1                                                 HMR07930
       CLA     MRBKC-1                                                  HMR07940
       TPL     *+3                                                      HMR07950
       SSP                                                              HMR07960
       ADD     ONEHI                                                    HMR07970
MRRSLA LDQ     MRBKC,2                                                  HMR07980
       TQP     *+5                                                      HMR07990
       XCA                                                              HMR08000
       SSP                                                              HMR08010
       ADD     ONEHI                                                    HMR08020
       XCA                                                              HMR08030
       TLQ     *+4                                                      HMR08040
BERNIC TIX     *+2,1,1                                                  HMR08050
       TRA     MRRSLB        LOW FILE IN AC                             HMR08060
       TXI     MRRSLA,2,1                                               HMR08070
       XCA                                                              HMR08080
       TRA     BERNIC                                                   HMR08090
       SPACE                                                            HMR08100
*      SET UP  READ CALLING SEQUENCE WORDS                              HMR08110
MRRSLB PAX     ,1             NO. OF FILE TO BE READ                    HMR08120
       ZET     RFWD3,1        TEST FOR 3 BLOCKS IN RESERVE FOR THIS FILEHMR08130
       TRA     RNAA           THREE BLOCKS IN RESERVE - BYPASS READ.    HMR08140
       SPACE                                                            HMR08150
 VMRNN CLA     ONE            SETUP I/O                                 HMR08160
       STO     RWCS             CALLING SEQUENCE                        HMR08170
       SXD     RWCS,1                                                   HMR08180
       TRA     R1                                                       HMR08190
       PXA     0,1                                                      HMR08200
       ERA     FL                                                       HMR08210
       TNZ     *+3                                                      HMR08220
       CLA     ONEA                                                     HMR08230
       ORS     RWCS                                                     HMR08240
R1     SXA     MRT2,1                                                   HMR08250
       SXA     FL,1                                                     HMR08260
MRN48  AXT     1,1              SELECT AREA NO.                         HMR08270
       NZT     ARWD,1                                                   HMR08280
       TRA     MRN49A                                                   HMR08290
       TXI     *+1,1,1                                                  HMR08300
MRN49  TXL     *-3,1,         NO. OF MERGE AREAS IN DECREMENT           HMR08310
       TRA     RNAA           NO AREAS CURRENTLY AVAIL. - BYPASS READ.  HMR08320
MRN49A CLA     ADDR,1          WILL BE CLA BKRD,1 WHEN BACKWARD READ    HMR08330
       NOP                     WILL BE SUB ONE WHEN IN BACKWARD READ    HMR08340
       STA     RWCS1                                                    HMR08350
       SXD     MRT2,1         SAVE AREA NO. OF PRESENT READ             HMR08360
*      UPDATE BLOCK COUNT FOR THIS FILE IN CONTROL TABLE                HMR08370
NONHY  LXA     MRT2,1                                                   HMR08380
       CAL     ONED                                                     HMR08390
       ACL     MRBKC,1                                                  HMR08400
       SLW     MRBKC,1                                                  HMR08410
       STL     GENPR-4                                                  HMR08420
       CALL    MRGIO                                                    HMR08430
AA     CLA     AACNT           REDUCE COUNT OF ONE                      HMR08440
       SUB     ONE              NUMBER READ AREAS                       HMR08450
       STO     AACNT              AVAILABLE                             HMR08460
*                                                                       HMR08470
 MRSWR AXT     **,4           RESTORE IR4                               HMR08480
       TRA     1,4              AND EXIT FROM READ                      HMR08490
RNAA   CAL     MORD2          PRESENT INTERNAL ORDER OF MERGE.          HMR08500
       ALS     20             MULTIPLY BY 4 AND SHIFT TO DEC.           HMR08510
       STD     *+2                                                      HMR08520
       LXA     EFNAA,1        NO. AREAS AVAIL. FOR USE.                 HMR08530
       TXL     SISW2,1,**       DEC. = 4M = NO. OF USABLE AREAS.        HMR08540
       CLA     AACNT          REDUCE NO. AREAS CURRENTLY AVAIL. BY 1.   HMR08550
       TZE     SISW2                                                    HMR08560
       SUB     ONE                                                      HMR08570
       STO     AACNT                                                    HMR08580
       TXI     *+1,1,-1       REDUCE NO. AREAS AVAIL. FOR USE BY 1.     HMR08590
       SXA     EFNAA,1                                                  HMR08600
       TRA     SISW2                                                    HMR08610
       EJECT                                                            HMR08620
*      END OF FILE ROUTINE                                              HMR08630
MREF2  STZ     RDIND1         RESET INDICATOR                           HMR08640
       CLA     AACNT          INCREASE COUNT OF                         HMR08650
       ADD     ONE              NUMBER READ AREAS                       HMR08660
       STO     AACNT              AVAILABLE                             HMR08670
*          SET EOF INDICATOR FOR THIS FILE                              HMR08680
       LXA     MRT2,1         FILE NO. OF LAST READ                     HMR08690
       CLA     *                                                        HMR08700
       STO     EOFIND,1       SET INDICATOR NON-ZERO                    HMR08710
*      SET SELECT CONTROL WORD HIGH FOR THIS FILE                       HMR08720
       AXT     28672,4                                                  HMR08730
       PXD     ,4                                                       HMR08740
       STD     MRBKC,1                                                  HMR08750
       LXA     MORDER,1       ORDER OF MERGE                            HMR08760
       NZT     EOFIND,1                                                 HMR08770
       TRA     MRRDSL         ALL FILES ARE NOT AT END OF FILE          HMR08780
       TIX     *-2,1,1                                                  HMR08790
*          ALL FILES ARE AT END OF FILE                                 HMR08800
       LDQ     NOP                                                      HMR08810
       SLQ     MRRSW1         SET SWITCH TO BYPASS READS                HMR08820
       LXA     MRSWR,4                                                  HMR08830
       TRA     1,4                                                      HMR08840
*                                                                       HMR08850
       SPACE                                                            HMR08860
*      END OF TAPE ACTION                                               HMR08870
 UP    STZ     WRIND1         RESET END OF TAPE INDICATOR.              HMR08880
       LXA     MORT,1         CURRENT NO. OF AVAIL. MERGE TAPES.        HMR08890
       TXL     MRER3,1,1      TRANSFER IF NO TAPE LEFT.                 HMR08900
       TXI     *+1,1,-1       REDUCE NO. OF AVAIL. MERGE TAPES          HMR08910
       SXA     MORT,1           AND SAVE AS CURRENT NO.                 HMR08920
       SXD     WR15,1                                                   HMR08930
       SXD     *+2,1                                                    HMR08940
       LXA     MRT3,1         FILE NO. OF PRESENT WRITE.                HMR08950
       TXH     ETP2,1,**      NO. OF REMAINING MERGE TAPES IN DEC.      HMR08960
       CAL     FLNO,1                                                   HMR08970
       LDQ     FLNO-1,1                                                 HMR08980
       STQ     FLNO,1                                                   HMR08990
       TXI     *+1,1,1                                                  HMR09000
 KAZOO TXL     *-3,1,**       MORT-1 IN DECREMENT.                      HMR09010
       SLW     FLNO,1                                                   HMR09020
       CLA     WRCT           NO. RECORDS IN OUPUT BLOCK.               HMR09030
FXSW06 TRA     MRSWOR         TRANSFER IF VARIABLE                      HMR09040
*      XCL                    REPLACES INST. AT FXSW06 WHEN FIXED       HMR09050
       MPY     NWTR           CONVERT RECORDS                           HMR09060
       XCL                      TO WORDS.                               HMR09070
MRSWOR STA     CNT11          NO. WORDS IF FIXED/NO. RECORDS IF VAR.    HMR09080
       CLA     CNT5           UPDATE NO. SEQ. WRITTEN COUNTS            HMR09090
       ADD     ONE                                                      HMR09100
       STO     CNT5                                                     HMR09110
       LXA     MROSBI,4       UPDATE OUTPUT                             HMR09120
       TXI     *+1,4,1          SEQUENCE                                HMR09130
       SXA     MROSBI,4           INDICATOR                             HMR09140
       SXD     CNT11,4        STORE SEQ. BREAK IND. IN DEC. OF CNT11    HMR09150
       LXA     MRT3,1                                                   HMR09160
       SLT     1                                                        HMR09170
       TRA     WR5                                                      HMR09180
       TRA     WR5                                                      HMR09190
 ETP2  SLN     1                                                        HMR09200
       TRA     WR3+2                                                    HMR09210
*                                                                       HMR09220
*   FILE AT EOF AND ALL RECORD HAVE BEEN MERGED OUT                     HMR09230
 MREF3 LXA     MORD2,1                                                  HMR09240
       TXL     MREAM,1,1       TEST FOR END OF ALL FILES                HMR09250
       TIX     *+1,1,1         REDUCE NO. OF FILE                       HMR09260
       SXA     MORD2,1         LEFT TO BE MERGED BY ONE                 HMR09270
       TRA     ARS3                                                     HMR09280
MREAM  ZET     WRCT           TEST FOR RECORDS TO BE WRITTEN            HMR09290
       TSX     MRWR,4         WRITE REMAINING RECORDS                   HMR09300
*      END OF MERGE PASS ROUTINE                                        HMR09310
       STZ     WRIND1        REINITIALIZE EOT SWITCH                 (4)HMR09315
       SPACE                                                            HMR09320
*      CLOSE INPUT FILES                                                HMR09330
MREND  ZET     RAW11                                                    HMR09340
       TSX     RAW11,4                                                  HMR09350
       NZT     RDIND                                                    HMR09360
       TRA     MREND                                                    HMR09370
       LXA     MORDER,2                                                 HMR09380
       STZ     RWCS                                                     HMR09390
       AXT     1,1                                                      HMR09400
       STL     GENPR-4                                                  HMR09410
CLOSE  SXD     RWCS,1                                                   HMR09420
       NZT     PURE                                                     HMR09430
       STL     RAWPR-21                                                 HMR09440
CLOSEI CALL    SCL                                                      HMR09450
       TXI     *+1,1,1                                                  HMR09460
       TIX     CLOSE,2,1                                                HMR09470
*      CLOSE OUTPUT FILES                                               HMR09480
AB     NZT     WRIND                                                    HMR09490
       TRA     *-1                                                      HMR09500
       LXA     MORDER,2                                                 HMR09510
       CLA     MZ                                                       HMR09520
       STO     RWCS                                                     HMR09530
       AXT     1,1                                                      HMR09540
       STL     GENPR-4                                                  HMR09550
CL     SXD     RWCS,1                                                   HMR09560
       PXD     0,1                                                      HMR09570
       STD*    FLN                                                      HMR09580
       NZT     PURE                                                     HMR09590
       STL     RAWPR-21                                                 HMR09600
CLOSEO CALL    SCL                                                      HMR09610
       TXI     *+1,1,1                                                  HMR09620
       TIX     CL,2,1                                                   HMR09630
*                                                                       HMR09640
       CLA     PNBR           UPDATE PASS NUMBER                        HMR09650
       ADD     ONE                                                      HMR09660
       STO     PNBR                                                     HMR09670
       CAL     MRES1+2                                                  HMR09680
       ADD     ONE                                                      HMR09690
       SLW     MRES1+2                                                  HMR09700
*                                                                       HMR09710
       LDQ     CNTW           TABULATE AND PRINT RECORD COUNTS          HMR09720
       STL     GENPR-4                                                  HMR09730
       CALL    BTD                                                      HMR09740
       STO     MRES1+7                                                  HMR09750
       STQ     MRES1+8                                                  HMR09760
       STO     AMS14+2                                                  HMR09770
       STQ     AMS14+3                                                  HMR09780
       TSX     MSGSUP,4,4                                               HMR09790
       PZE     1                                                        HMR09800
       PZE     MRES1,,9                                                 HMR09810
       LDQ     MRD                                                      HMR09820
       STL     GENPR-4                                                  HMR09830
       CALL    BTD                                                      HMR09840
       STQ     MRES2+6                                                  HMR09850
       STO     AMS14+4                                                  HMR09860
       STQ     AMS14+5                                                  HMR09870
       NZT     MRD                                                      HMR09880
       TRA     *+4                                                      HMR09890
       TSX     MSGSUP,4,4                                               HMR09900
       PZE     1                                                        HMR09910
       PZE     MRES2,,7+512*4                                           HMR09920
*                                                                       HMR09930
       CLA     MRD            CHECK IF READ COUNTS ARE CORRECT          HMR09940
       ADD     CNTW                                                     HMR09950
       SUB     CNTR                                                     HMR09960
       TZE     MR705                                                    HMR09970
       ADD     NRSUMM                                                   HMR09980
       TZE     MR705                                                    HMR09990
       LDQ     CNTR                                                     HMR10000
       CALL    BTD                                                      HMR10010
       STO     AMS14                                                    HMR10020
       STQ     AMS14+1                                                  HMR10030
       TSX     MSGSUP,4,4                                               HMR10040
       PZE     3                                                        HMR10050
       PZE     AMS12,,11+512*4                                          HMR10060
       PZE     AMS13,,6                                                 HMR10070
       PZE     AMS14,,6+512*4                                           HMR10080
       TSX     VMSOMS,4                                                 HMR10090
       TSX     (PAUSE,4                                                 HMR10100
       TSX     VMROEP,4                                                 HMR10110
       TSX     VMWNOW,4                                                 HMR10120
       TRA     DELET                                                    HMR10130
       TRA     MR705                                                    HMR10140
MR705  NZT     NOCKPT                                                   HMR10150
       CALL    CKPT                                                     HMR10160
       SWT     2               TEST FOR INTERRUPT                       HMR10170
       TRA     MR706          NO                                        HMR10180
       TSX     MSGSUP,4,2                                               HMR10190
       PZE     3                                                        HMR10200
       PZE     AMS15,,7+512*4                                           HMR10210
       PZE     AMS16,,12                                                HMR10220
       PZE     AMS17,,10+512*4                                          HMR10230
       TSX     (PAUSE,4                                                 HMR10240
       SWT     2                                                        HMR10250
       TRA     MR706                                                    HMR10260
       STL     ERAPR-18      SET DELETE SWITCH.                         HMR10270
       XEC     MRXR4                                                    HMR10280
       TRA     4,4                                                      HMR10290
MR706  CLA     CHIND         INTERCHANGE CHANNELS                       HMR10300
       LDQ     CHIND-1                                                  HMR10310
       STO     CHIND-1                                                  HMR10320
       STQ     CHIND                                                    HMR10330
*                                                                       HMR10340
       CLA     CNT5          GET COUNT OF STRINGS OUTPUT, AND           HMR10350
       STO     COMNT           SAVE FOR NEXT PHASE                      HMR10360
       ZET     XTRMG          SEE IF ANY MERGE FILES                    HMR10370
       ADD     MRGS          ADD NO. OF EXTERNAL MERGE FILES.           HMR10380
       CAS     MORDER                                                   HMR10390
       TRA     VMR720         ANOTHER PASS REQUIRED                     HMR10400
       TRA     *+1                                                      HMR10410
       LAC     CHAPR-1,4     ADDRESS OF OUTPUT CHANNEL                  HMR10420
       SXD     *+2,4                                                    HMR10430
       LXA     CHAPR-3,4     ADDRESS OF INPUT CHANNEL                   HMR10440
       TXI     *+1,4,**                                                 HMR10450
       TXL     VMR720,4,0      NEED ADDITIONAL PASS                     HMR10460
*  CHECK LAST PASS CONTROL SWITCH                                       HMR10470
 LBBB  TRA     GETOUT          WILL BE NOP IF ALL HYPER CHANNEL         HMR10480
       ZET     LASTPS          CHECK LAST LASS SWITCH                   HMR10490
       TRA     *+8             LAST PASS SWITCH ON                      HMR10500
 FORD  CLA     WRTB1           LAST PASS SWITCH OFF                     HMR10510
       ERA     WRTA1           CHECK FORWARD WRITE                      HMR10520
       TZE     *+5             YES                                      HMR10530
       TSX     MSGSUP,4,2                                               HMR10540
       PZE     1               MESSAGE                                  HMR10550
       PZE     VMS25,,8               LAST PASS TOO SOON                HMR10560
       TRA     HHERE                                                    HMR10570
       ZET     ODDEVE                                                   HMR10580
       TRA     MORECK          ODD PASS                                 HMR10590
       NZT     NORMAL          EVEN PASS                                HMR10600
       TRA     *+2                                                      HMR10610
       TRA     FINAL           THIS PASS WAS WRITTEN NORMAL             HMR10620
       TSX     MSGSUP,4,2                                               HMR10630
       PZE     1               MESSAGE                                  HMR10640
       PZE     VMS26,,8               LAST PASS SET UP WRONG            HMR10650
       TRA     HHERE                                                    HMR10660
FINAL  TSX     REWC,4          REWIND OUTPUT TAPES                      HMR10670
       STZ     RAWPR-21        SET FORWARD READ SWITCH FOR PHASE 3      HMR10680
 FIN   TRA     GETOUT                                                   HMR10690
MORECK NZT     NORMAL          CHECK ODD PASS BEEN WRITTEN  INVERSE     HMR10700
       TRA     LASS            YES                                      HMR10710
       TSX     MSGSUP,4,2                                               HMR10720
       PZE     1               MESSAGE                                  HMR10730
       PZE     VMS27,,8               ODD PASS WRITE TABLE SET WRONG    HMR10740
       TSX     REWC,4                                                   HMR10750
       TRA     REW                                                      HMR10760
LASS   STL     RAWPR-21        SET BACKWARD READ SWITCH FOR PHASE 3     HMR10770
GETOUT TSX     MSGSUP,4,4                                               HMR10780
       PZE     1               END OF PHASE 2                           HMR10790
       PZE     MRES3,,5                                                 HMR10800
INEXX  ZET     ERAPR-29        CHECK EXTRACT ROUTINE BEEN INVERTED      HMR10810
       CALL    MREXNM          INVERTED, RESTOR TO NORMAL               HMR10820
       CLA     CNTW                                                     HMR10830
       STO     MRCT                                                     HMR10840
MRXR4  AXT     ,4                                                       HMR10850
       TRA     3,4             TO PHASE 3                               HMR10860
       SPACE   2                                                        HMR10870
*  THIS PASS WAS ANTICIPATED AS THE LAST PASS                           HMR10880
ENDPAS ZET     LASTPS          CHECK LAST PASS SWITCH                   HMR10890
       TRA     MISEXP          YES,THIS PASS WAS EXPECTED AS LAST PASS  HMR10900
HHERE  CLA     SIX             NO,LAST PASS,CHECK ODDEVEN               HMR10910
       ZET     ODDEVE                                                   HMR10920
       ZAC                     IF THIS IS ODD,SET TO EVEN               HMR10930
       STO     ODDEVE          IF THIS IS EVEN,SET TO ODD               HMR10940
       TRA     VMR720+1                                                 HMR10950
MISEXP ZET     ODDEVE                                                   HMR10960
       TRA     HHERE           THIS IS ODD PASS                         HMR10970
REW    CLA     NOP                                                      HMR10980
       STO     MRN49A+1                                                 HMR10990
       STZ     RBK                                                      HMR11000
       TSX     REWC,4          REWIND ALL CHAPR-3 TAPES                 HMR11010
       AXT     ONE,4           SET FORWARD WRITE                        HMR11020
       SXA     VMRNN,4           SWITCH                                 HMR11030
       STL     PURE                                                     HMR11040
       STZ     RAWPR-21                                                 HMR11050
       AXT     ADDR,4                                                   HMR11060
       SXA     MRN49A,4                                                 HMR11070
       TRA     VMR720+1                                                 HMR11080
*  END  OF EVERY PASS CHECKING                                          HMR11090
VMR720 NOP     ENDPAS          WILL BE TRA ENDPASS                      HMR11100
       CLA     CNTW            WHEN ALL HYPER CHANNEL                   HMR11110
       STO     MRCT            STORE RECORD COUNT IN COMMON             HMR11120
       STZ     LASTPS          RESET LAST PASS SWITCH                   HMR11130
       SPACE                                                            HMR11140
*      INITIALIZE K TABLE                                               HMR11150
       LXA     MORDER,1        MAKE FIRST ENTRY OF CFWD                 HMR11160
       PXD     0,1             HAS FILE NO. 1 , SECOND  ENTRY HAS       HMR11170
       STD     CFWD,1          FILE NO. 2, ETC.                         HMR11180
       TIX     *-2,1,1                                                  HMR11190
*      ZERO NECESSARY AREAS                                             HMR11200
VMR721 AXT     RFWD3-CFADR,1   ZERO CLEAR ALL AREA REFERENCE TABLE      HMR11210
       STZ     RFWD3,1                                                  HMR11220
       TIX     *-1,1,1                                                  HMR11230
       AXT     WRCT-MORT,1     ZERO OUT ALL AOUNTERS                    HMR11240
       STZ     WRCT+1,1                                                 HMR11250
       TIX     *-1,1,1                                                  HMR11260
       STZ     MRD             ZERO DUMPED RECORDS COUNTER              HMR11270
       TRA     PASS            TO THE BEGINNING OF EACH PASS            HMR11280
       EJECT                                                            HMR11290
*  ROUTINE TO PUT CONTROL FIELD WORDS (K1,...,K16) INTO SORTED ORDER.   HMR11300
 SORTF SXA     SRTIX+1,4                                                HMR11310
       LXA     MORD3,4       DO AS MANY AS                              HMR11320
       TXI     *+1,4,-1       ORDER OF MERGE.                           HMR11330
       TXL     SRTIX+1,4,0                                              HMR11340
       LXA     NWDCF,1                                                  HMR11350
SRCAL  CAL*    K1,4                                                     HMR11360
SRLAS  LAS*    K1+1,4                                                   HMR11370
       TRA     SRTIX                                                    HMR11380
       TRA     SEQTX                                                    HMR11390
       TRA     SINTR                                                    HMR11400
SEQTX  TIX     SRCAL,1,1                                                HMR11410
       CAL*    SRCAL                                                    HMR11420
       LAS*    SRLAS                                                    HMR11430
       TRA     SRTIX                                                    HMR11440
       TRA     SRTIX                                                    HMR11450
SINTR  CAL*    SRCAL                                                    HMR11460
       LDQ*    SRLAS                                                    HMR11470
       SLW*    SRLAS                                                    HMR11480
       STQ*    SRCAL                                                    HMR11490
       TRA     SORTF+1                                                  HMR11500
SRTIX  TIX     SRCAL-1,4,1                                              HMR11510
       AXT     **,4                                                     HMR11520
       TRA     1,4                                                      HMR11530
       EJECT                                                            HMR11540
*  ROUTINE TO REWIND ALL HYPER TAPES                                    HMR11550
 REWC  SXA     REWG,4          SAVE INDEX REGISTER                      HMR11560
 REWA  CLA     CHAPR-3           REWIND                                 HMR11570
       STA     REWT                                                     HMR11580
       STA     REWB                                                     HMR11590
       PDX     0,2                   ALL                                HMR11600
 REWD  TXL     REWG,2,0                 OUTPUT                          HMR11610
       TXI     *+1,2,-1                                                 HMR11620
REWB   CLA*    **,2                                                     HMR11630
       STA     *+2                                                      HMR11640
       AXC     3,4             PUT ZERO IN THE 4TH UCW                  HMR11650
       STZ     **,4                                                     HMR11660
       TSX     (NDATA,4                            BECAUSE              HMR11670
 REWT  PZE     **,2,30                                                  HMR11680
       TRA     REWD                                         MIS-CALCUL. HMR11690
 REWG  AXT     **,4                                                     HMR11700
       TRA     1,4             GO BACK TO CALLER                        HMR11710
       EJECT                                                            HMR11720
* TABLE FOR BCD CHARACTER COUNT CONVERSION                              HMR11730
DTBT1  DUP     1,10                                                     HMR11740
       VFD     20/**10000-DTBT1*10000,16/DTBT2                          HMR11750
DTBT2  DUP     1,10                                                     HMR11760
       VFD     20/**1000-DTBT2*1000,16/DTBT3                            HMR11770
DTBT3  DUP     1,10                                                     HMR11780
       VFD     20/**100-DTBT3*100,16/DTBT4                              HMR11790
DTBT4  DUP     1,10                                                     HMR11800
       VFD     20/**10-DTBT4*10,16/DTBT5                                HMR11810
DTBT5  DUP     1,10                                                     HMR11820
       VFD     20/**1-DTBT5*1                                           HMR11830
       EJECT                                                            HMR11840
*      VARIABLE LENGTH CHECKSUM ENTRY POINT                             HMR11850
 CKS   STA     CKSE           ADR. BECOMES CKSB WHEN NO EQUALS OPTION   HMR11860
       PAX     ,1             BECOMES TRA TO *+3 WHEN NO EQUALS OPTION  HMR11870
       TXI     *+1,1,1                                                  HMR11880
 CKSD  SXA     CKSB,1                                                   HMR11890
       ADD     NWTR                                                     HMR11900
       STA     CKSA                                                     HMR11910
       PXD     ,0             CLEAR AC                                  HMR11920
       LXA     NWTR,1         NO. WORDS THIS RECORD TO IR1.             HMR11930
       TXI     *+1,1,-1      ADR. BECOMES CKSA WHEN NO EQUALS OPTION    HMR11940
 CKSE  ACL     **                                                       HMR11950
       TXI     *+1,1,-1                                                 HMR11960
       SPACE                                                            HMR11970
 CKSA  ACL     **,1          COMPUTE CHECKSUM                           HMR11980
       TIX     *-1,1,1                                                  HMR11990
       ZET     MODPR-39       CE                                        HMR12000
       CALL    DMP05                                                    HMR12010
 CKSB  ERA     **             COMPARE WITH CHECKSUM WORD                HMR12020
       TNZ     CKSC          ERROR                                      HMR12030
       LXD     K1,1          CHECKSUM IS OK                             HMR12040
       CAL     FLWD,1                                                   HMR12050
       TRA     VMR104                                                   HMR12060
*                                                                       HMR12070
*      FIXED LENGTH CHECKSUM ENTRY POINT                                HMR12080
FXCKS  ADD     NWTR                                                     HMR12090
       SUB     ONE                                                      HMR12100
       STA     CKSA                                                     HMR12110
       STA     CKSB                                                     HMR12120
       LXA     NWTR,1                                                   HMR12130
       TXI     *+1,1,-1                                                 HMR12140
       PXD     ,                                                        HMR12150
       TRA     CKSA                                                     HMR12160
*                                                                       HMR12170
*      CHECKSUM ERROR ROUTINE                                           HMR12180
 CKSC  LXD     K1,1           FILE NO. OF RECORDS TO BE DROPPED         HMR12190
       CLA     FLWD,1         PICK UP ADR. OF RECORD                    HMR12200
FXSW08 TRA     ITSVR          BECOMES NOP WHEN FIXED                    HMR12210
       STA     ATDAR                                                    HMR12220
       TRA     WCARES                                                   HMR12230
ITSVR  PAX     ,1             INCREASE                                  HMR12240
       LXA     MRDVWC,4         ADDRESS                                 HMR12250
       SXD     *+1,4              OF RECORD                             HMR12260
       TXI     *+1,1,**             BY NUMBER                           HMR12270
       SXA     ATDAR,1                OPTION WORDS                      HMR12280
WCARES LXA     NWTR,1         NUMBER WORDS THIS RECORD                  HMR12290
       LAC     MRDVWC,4       REDUCE NO. WORDS                          HMR12300
       SXD     *+1,4            THIS RECORD BY                          HMR12310
       TXI     *+1,1,**             NUMBER OF                           HMR12320
       SXD     ATDAR,1                OPTION WORDS                      HMR12330
       TXI     *+1,1,-1                                                 HMR12360
       LXD     K1,1                                                     HMR12370
       CAL     FLWD,1                                                   HMR12380
       TSX     (DECVA,4                                                 HMR12390
       STQ     MRES6+4                                                  HMR12400
       TSX     MSGSUP,4,2                                               HMR12410
       PZE     1                                                     (5)HMR12412
       PZE     MRES6,,8+512*4                                           HMR12420
       CALL    DEBLK                                                 (2)HMR12422
       PZE     ATDAR-1,,2                                            (2)HMR12424
       TSX     (PAWSX,4                                                 HMR12430
       CLA     MRD                                                      HMR12440
       ADD     ONE                                                      HMR12450
       STO     MRD                                                      HMR12460
       CLA     WRCT                                                     HMR12470
       SUB     ONE                                                      HMR12480
       STO     WRCT                                                     HMR12490
       LXD     K1,1                                                     HMR12500
       CAL     FLWD,1                                                   HMR12510
       TRA     MR106          RETURN TO NEXT RECORD                     HMR12520
*                                                                       HMR12530
*   ROUTINE TO DETERMIN THIS PASS WILL BECOME THE LAST PASS OR NOT      HMR12540
LASTCK SXA     EEEF,4          SAVE INDEX FOR RETURN                    HMR12550
       LDQ     MORDER                                                   HMR12560
       MPY     MORDER          M.M                                      HMR12570
       CAL     CNTPR-15        N MEANS THE NO. OF STRINGS               HMR12580
       TLQ     EXITF           N GREATER THAN M.M NEED ONE MORE PASS    HMR12590
       XCL                     N EQUAL OR LESS M.M                      HMR12600
       ZAC                                                              HMR12610
       DVP     MORDER          N/M                                      HMR12620
       TNZ     *+3             GOT REMAINDER                            HMR12630
       ZAC                     NO REMAINDER                             HMR12640
       TRA     *+3                                                      HMR12650
       CAL     ONE             IF N/M NOT DIVIDED EVEN, ADD 2           HMR12660
       STQ     ERAPR-28        N/M IN ERAPR-28                          HMR12670
       ADD     ERAPR-28                                                 HMR12680
       ADD     SAMPR-2         (N/M)+K, K IS NO. OF EXTENAL FILE        HMR12690
       LDQ     MORDER                                                   HMR12700
       TLQ     EXITF           (N/M)+KGREATER M                         HMR12710
       CAL     CHAPR-2         (N/M)+K EQUAL OR LESS THAN M             HMR12720
       ERA     CHAPR-1         FINAL OUTPUT CHANNEL EQUAL TO            HMR12730
       TZE     EXITF           MERGE WRITING CHANNEL                    HMR12740
       STL     LASTPS          SET LAST PASS SWITCH ON                  HMR12750
 EEEF  AXT     **,4                                                     HMR12760
       TRA     1,4                                                      HMR12770
EXITF  STZ     LASTPS          SET LAST PASS SWITCH OFF                 HMR12780
       TRA     *-3                                                      HMR12790
*      OUT OF SORT RECORD ROUTINE                                       HMR12800
MRER2  LXD     K1,4                                                     HMR12810
       LDQ     FLWD,4       LOCATION OF RECORD OUT OF SORT              HMR12820
       LGL     18                                                       HMR12830
       TSX     (BCD5R,4                                                 HMR12840
       SLW     AMS20+4                                                  HMR12850
       LDQ     LOC                                                      HMR12860
       LGL     18                                                       HMR12870
       TSX     (BCD5R,4                                                 HMR12880
       SLW     AMS21+4                                                  HMR12890
       TSX     MSGSUP,4,2                                               HMR12900
       PZE     3                                                        HMR12910
       PZE     AMS19,,5+512*4                                           HMR12920
       PZE     AMS20,,5                                                 HMR12930
       PZE     AMS21,,5+512*4                                           HMR12940
       SXA     *+4,2                                                    HMR12950
       LXD     K1,2                                                     HMR12960
       TXI     *+1,2,-1                                                 HMR12970
       CLA*    CHAPR-3                                                  HMR12980
       AXT     **,2                                                     HMR12990
       STA     *+1                                                      HMR13000
       LDQ     **                                                       HMR13010
       TSX     MSGSUP,4,3                                               HMR13020
       PZE     AMS22,,8+512*4                                           HMR13030
       LXD     K1,4                                                     HMR13040
       CAL     FLWD,4                                                   HMR13050
       PDX     0,4                                                      HMR13060
       CLA     ADDR,4                                                   HMR13070
       SSP                                                              HMR13080
       SUB     TWO                                                      HMR13090
       STA     *+1                                                      HMR13100
       LDQ     **                                                       HMR13110
       LGL     18                                                       HMR13120
       TSX     (BCD5R,4                                                 HMR13130
       SLW     AMS23+5                                                  HMR13140
       TSX     MSGSUP,4,2                                               HMR13150
       PZE     1                                                        HMR13160
       PZE     AMS23,,6+512*4                                           HMR13170
       TSX     VMSOMS,4                                                 HMR13180
       TSX     (PAUSE,4                                                 HMR13190
       TSX     VMROEP,4                                                 HMR13200
       TSX     VMWNOW,4                                                 HMR13210
       TRA     DELET                                                    HMR13220
VMSOSR CLA     WRCT                                                     HMR13230
       TZE     *+2                                                      HMR13240
       TSX     MRWR,4                                                   HMR13250
       SLN     1                                                        HMR13260
       TRA     MR100A                                                   HMR13270
DELET  STL     ERAPR-18                                                 HMR13280
       XEC     MRXR4                                                    HMR13290
       TRA     4,4                                                      HMR13300
       SPACE                                                            HMR13310
*      ROUTINE TO PRINT OPTIONS                                         HMR13320
VMSOMS SXA     VMSOMR,4                                                 HMR13330
       TSX     MSGSUP,4,2                                               HMR13340
       PZE     4                                                        HMR13350
       PZE     VMSG03,,6                                                HMR13360
       PZE     VMSG04,,6                                                HMR13370
       PZE     VMSG05,,6                                                HMR13380
       PZE     VMSG06,,6+512*4                                          HMR13390
VMSOMR AXT     **,4                                                     HMR13400
       TRA     1,4                                                      HMR13410
*                                                                       HMR13420
MRER3  TSX     MSGSUP,4,2                                               HMR13430
       PZE     1                                                        HMR13440
       PZE     MRES13,,7+512*4                                          HMR13450
       TSX     VMSOMS,4                                                 HMR13460
       TSX     (PAUSE,4                                                 HMR13470
       TSX     VMROEP,4                                                 HMR13480
       TSX     VMWNOW,4                                                 HMR13490
       TRA     DELET                                                    HMR13500
*TEST  FOR MULTIPLE SETTING OF SS4,SS3                                  HMR13510
VMROEP SXA     VMRROG,4                                                 HMR13520
       AXT     0,4                                                      HMR13530
       AXT     4,1                                                      HMR13540
       SWT     4,1                                                      HMR13550
       TRA     *+2                                                      HMR13560
       TXI     *+1,4,1                                                  HMR13570
       TIX     *+1,1,1                                                  HMR13580
       TXH     *-4,1,2                                                  HMR13590
       TXL     VMRROG,4,1                                               HMR13600
       TSX     MSGSUP,4,2                                               HMR13610
       PZE     1                                                        HMR13620
       PZE     VMSG01,,9                                                HMR13630
       LXA     VMRROG,4                                                 HMR13640
       TRA     -1,4                                                     HMR13650
VMRROG AXT     **,4                                                     HMR13660
       TRA     1,4                                                      HMR13670
*                                                                       HMR13680
*      SELECT AN OPTION                                                 HMR13690
VMWNOW SWT     4                                                        HMR13700
       TRA     *+2                                                      HMR13710
       CALL    RESTAR                                                   HMR13720
       SWT     3                                                        HMR13730
       TRA     1,4                                                      HMR13740
       SXA     *+4,4                                                    HMR13750
       TSX     MSGSUP,4,2                                               HMR13760
       PZE     1                                                        HMR13770
       PZE     AMS25,,5+512*4                                           HMR13780
       AXT     **,4                                                     HMR13790
       TRA     2,4                                                      HMR13800
       EJECT                                                            HMR13810
       TITLE                                                            HMR13820
MRES1  BCI     9,MERGE PHASE PASS 0 COMPLETED. RECORD COUNT             HMR13830
MRES2  BCI     7,RECORDS WITH BAD CKSUMS THIS PASS                      HMR13840
MRES3  BCI     5,  MERGE PHASE COMPLETED                                HMR13850
MRES6  BCI     8,CKSUM ERROR, RECORD, LOC       *CS02                   HMR13860
VMSG03 BCI     6,**OPTIONS**             SS3  SS4                       HMR13870
VMSG04 BCI     6,TO DELETE SORT---------- UP   UP                       HMR13880
VMSG05 BCI     6,TO RETURN TO LAST CKPT-- UP   DN                       HMR13890
VMSG06 BCI     6,TO GO ON(IGNORE)-------- DN   UP                       HMR13900
AMS09  BCI     5,NO READ AREAS AVAILABLE * LE04                         HMR13910
AMS12  BCI     8,COUNTS OF RECORDS DO NOT AGREE.  THE COUNTS ARE        HMR13920
       BCI     3,AS FOLLOWS---*LE03                                     HMR13930
AMS13  BCI     6,   READS        WRITES        DUMPED                   HMR13940
AMS14  BCI     6,                                                       HMR13950
AMS15  BCI     7,SORT INTERRUPT REQUESTED *RP01                         HMR13960
AMS16  BCI     8,      1.  LABEL AND SAVE ALL TAPES FOR A LATER R       HMR13970
       BCI     4,ESTART. THEN PRESS START                               HMR13980
AMS17  BCI     8,      2.  IF SORT IS TO CONTINUE--RESET SS2 AND        HMR13990
       BCI     2,PRESS START.                                           HMR14000
AMS18  BCI     3,                OR                                     HMR14010
AMS19  BCI     5,RECORD OUT OF SEQUENCE *SQ02                           HMR14020
AMS20  BCI     5,THIS RECORD IS AT LOC.                                 HMR14030
AMS21  BCI     5,LAST RECORD IS AT LOC.                                 HMR14040
AMS22  BCI     8, IS THE UNIT WHERE OUT-OF-SORT RECORD ORIGINATED       HMR14050
AMS23  BCI     6,IT IS IN TAPE RECORD NUMBER                            HMR14060
AMS24  BCI     9,ALL INPUT TAPES TO PHASE 2 ARE AT END OF FILE *MR04    HMR14070
AMS25  BCI     5,CONTINUED (IGNORED)                                    HMR14080
VMSG01 BCI     9,MORE THAN ONE SS ON--CLARIFY YOUR CHOICE AND START     HMR14090
MRES13 BCI     7,MERGE TAPES-TOO SHORT *MR05                            HMR14100
VMS25  BCI     8,LAST PASS TOO SOON                                     HMR14110
VMS26  BCI     8,LAST PASS SET UP WRONG                                 HMR14120
VMS27  BCI     8,ODD PASS WRITE TABLE SET WRONG                         HMR14130
       DETAIL                                                           HMR14140
       EJECT                                                            HMR14150
*    MERGE LOOP FOR COMPARISON                                          HMR14160
*   EXTRACT ROUTINE CONVERTED ANY OTHER SEQUENCE                        HMR14170
*   INTO LOGICAL ASCENDING SEQUENCE                                     HMR14180
*                                                                       HMR14190
               C(9)            ORDER IS 16                              HMR14200
               C(9)                   15.                               HMR14210
               C(9)                   14.                               HMR14220
               C(9)                   13.                               HMR14230
               C(9)                   12.                               HMR14240
               C(9)                   11.                               HMR14250
               C(9)                   10.                               HMR14260
               C(9)                    9.                               HMR14270
               C(5)                    8.                               HMR14280
               C(5)                    7.                               HMR14290
               C(5)                    6.                               HMR14300
               C(5)                    5.                               HMR14310
               C(3)                    4.                               HMR14320
               C(3)                    3.                               HMR14330
               C(2)                    2.                               HMR14340
               MR100                    1  =  RUNOUT                    HMR14350
MRLOOP BSS     0                                                        HMR14360
*      COMPARE K1 AND K2                                                HMR14370
C(2)   LXA     NWDCF,1                                                  HMR14380
CAL2   CAL*    K1                                                       HMR14390
       LAS*    K2                                                       HMR14400
       TRA     ((2)                                                     HMR14410
       TRA     TIX2                                                     HMR14420
       TRA     ((1)                                                     HMR14430
TIX2   TIX     CAL2,1,1                                                 HMR14440
       CAL     K1                                                       HMR14450
       LAS     K2                                                       HMR14460
       TRA     ((2)                                                     HMR14470
       TRA     ((1)                                                     HMR14480
       TRA     ((1)                                                     HMR14490
*      COMPARE K1 AND K3                                                HMR14500
C(3)   LXA     NWDCF,1                                                  HMR14510
CAL3   CAL*    K1                                                       HMR14520
       LAS*    K3                                                       HMR14530
       TRA     B3H                                                      HMR14540
       TRA     TIX3                                                     HMR14550
       TRA     C(2)                                                     HMR14560
TIX3   TIX     CAL3,1,1                                                 HMR14570
       CAL     K1                                                       HMR14580
       LAS     K3                                                       HMR14590
       TRA     B3H                                                      HMR14600
       TRA     C(2)                                                     HMR14610
       TRA     C(2)                                                     HMR14620
*      COMPARE K1 AND K4                                                HMR14630
C(4)   LXA     NWDCF,1                                                  HMR14640
CAL4   CAL*    K1                                                       HMR14650
       LAS*    K4                                                       HMR14660
       TRA     ((4)                                                     HMR14670
       TRA     TIX4                                                     HMR14680
       TRA     ((3)                                                     HMR14690
TIX4   TIX     CAL4,1,1                                                 HMR14700
       CAL     K1                                                       HMR14710
       LAS     K4                                                       HMR14720
       TRA     ((4)                                                     HMR14730
       TRA     ((3)                                                     HMR14740
       TRA     ((3)                                                     HMR14750
*      COMPARE K1 AND K5                                                HMR14760
C(5)   LXA     NWDCF,1                                                  HMR14770
CAL5   CAL*    K1                                                       HMR14780
       LAS*    K5                                                       HMR14790
       TRA     B5H                                                      HMR14800
       TRA     TIX5                                                     HMR14810
       TRA     C(3)                                                     HMR14820
TIX5   TIX     CAL5,1,1                                                 HMR14830
       CAL     K1                                                       HMR14840
       LAS     K5                                                       HMR14850
       TRA     B5H                                                      HMR14860
       TRA     C(3)                                                     HMR14870
       TRA     C(3)                                                     HMR14880
*      COMPARE K1 AND K6                                                HMR14890
C(6)   LXA     NWDCF,1                                                  HMR14900
CAL6   CAL*    K1                                                       HMR14910
       LAS*    K6                                                       HMR14920
       TRA     ((6)                                                     HMR14930
       TRA     TIX6                                                     HMR14940
       TRA     ((5)                                                     HMR14950
TIX6   TIX     CAL6,1,1                                                 HMR14960
       CAL     K1                                                       HMR14970
       LAS     K6                                                       HMR14980
       TRA     ((6)                                                     HMR14990
       TRA     ((5)                                                     HMR15000
       TRA     ((5)                                                     HMR15010
*      COMPARE K1 AND K7                                                HMR15020
C(7)   LXA     NWDCF,1                                                  HMR15030
CAL7   CAL*    K1                                                       HMR15040
       LAS*    K7                                                       HMR15050
       TRA     B7H                                                      HMR15060
       TRA     TIX7                                                     HMR15070
       TRA     C(6)                                                     HMR15080
TIX7   TIX     CAL7,1,1                                                 HMR15090
       CAL     K1                                                       HMR15100
       LAS     K7                                                       HMR15110
       TRA     B7H                                                      HMR15120
       TRA     C(6)                                                     HMR15130
       TRA     C(6)                                                     HMR15140
*      COMPARE K1 AND K8                                                HMR15150
C(8)   LXA     NWDCF,1                                                  HMR15160
CAL8   CAL*    K1                                                       HMR15170
       LAS*    K8                                                       HMR15180
       TRA     ((8)                                                     HMR15190
       TRA     TIX8                                                     HMR15200
       TRA     ((7)                                                     HMR15210
TIX8   TIX     CAL8,1,1                                                 HMR15220
       CAL     K1                                                       HMR15230
       LAS     K8                                                       HMR15240
       TRA     ((8)                                                     HMR15250
       TRA     ((7)                                                     HMR15260
       TRA     ((7)                                                     HMR15270
*      COMPARE K1 AND K9                                                HMR15280
C(9)   LXA     NWDCF,1                                                  HMR15290
CAL9   CAL*    K1                                                       HMR15300
       LAS*    K9                                                       HMR15310
       TRA*    B9HI+9,2                                                 HMR15320
       TRA     TIX9                                                     HMR15330
       TRA     C(5)                                                     HMR15340
TIX9   TIX     CAL9,1,1                                                 HMR15350
       CAL     K1                                                       HMR15360
       LAS     K9                                                       HMR15370
       TRA*    B9HI+9,2                                                 HMR15380
       TRA     C(5)                                                     HMR15390
       TRA     C(5)                                                     HMR15400
*      COMPARE K1 AND K10                                               HMR15410
C(10)  LXA     NWDCF,1                                                  HMR15420
CAL10  CAL*    K1                                                       HMR15430
       LAS*    K10                                                      HMR15440
       TRA     ((10)                                                    HMR15450
       TRA     TIX10                                                    HMR15460
       TRA     ((9)                                                     HMR15470
TIX10  TIX     CAL10,1,1                                                HMR15480
       CAL     K1                                                       HMR15490
       LAS     K10                                                      HMR15500
       TRA     ((10)                                                    HMR15510
       TRA     ((9)                                                     HMR15520
       TRA     ((9)                                                     HMR15530
*      COMPARE K1 AND K11                                               HMR15540
C(11)  LXA     NWDCF,1                                                  HMR15550
CAL11  CAL*    K1                                                       HMR15560
       LAS*    K11                                                      HMR15570
       TRA     B11H                                                     HMR15580
       TRA     TIX11                                                    HMR15590
       TRA     C(10)                                                    HMR15600
TIX11  TIX     CAL11,1,1                                                HMR15610
       CAL     K1                                                       HMR15620
       LAS     K11                                                      HMR15630
       TRA     B11H                                                     HMR15640
       TRA     C(10)                                                    HMR15650
       TRA     C(10)                                                    HMR15660
*      COMPARE K1 AND K12                                               HMR15670
C(12)  LXA     NWDCF,1                                                  HMR15680
CAL12  CAL*    K1                                                       HMR15690
       LAS*    K12                                                      HMR15700
       TRA     ((12)                                                    HMR15710
       TRA     TIX12                                                    HMR15720
       TRA     ((11)                                                    HMR15730
TIX12  TIX     CAL12,1,1                                                HMR15740
       CAL     K1                                                       HMR15750
       LAS     K12                                                      HMR15760
       TRA     ((12)                                                    HMR15770
       TRA     ((11)                                                    HMR15780
       TRA     ((11)                                                    HMR15790
*      COMPARE K1 AND K13                                               HMR15800
C(13)  LXA     NWDCF,1                                                  HMR15810
CAL13  CAL*    K1                                                       HMR15820
       LAS*    K13                                                      HMR15830
       TRA*    B13HI+13,2                                               HMR15840
       TRA     TIX13                                                    HMR15850
       TRA     C(11)                                                    HMR15860
TIX13  TIX     CAL13,1,1                                                HMR15870
       CAL     K1                                                       HMR15880
       LAS     K13                                                      HMR15890
       TRA*    B13HI+13,2                                               HMR15900
       TRA     C(11)                                                    HMR15910
       TRA     C(11)                                                    HMR15920
*      COMPARE K1 AND K14                                               HMR15930
C(14)  LXA     NWDCF,1                                                  HMR15940
CAL14  CAL*    K1                                                       HMR15950
       LAS*    K14                                                      HMR15960
       TRA     ((14)                                                    HMR15970
       TRA     TIX14                                                    HMR15980
       TRA     ((13)                                                    HMR15990
TIX14  TIX     CAL14,1,1                                                HMR16000
       CAL     K1                                                       HMR16010
       LAS     K14                                                      HMR16020
       TRA     ((14)                                                    HMR16030
       TRA     ((13)                                                    HMR16040
       TRA     ((13)                                                    HMR16050
*      COMPARE K1 AND K15                                               HMR16060
C(15)  LXA     NWDCF,1                                                  HMR16070
CAL15  CAL*    K1                                                       HMR16080
       LAS*    K15                                                      HMR16090
       TRA*    B15HI+15,2                                               HMR16100
       TRA     TIX15                                                    HMR16110
       TRA     C(14)                                                    HMR16120
TIX15  TIX     CAL15,1,1                                                HMR16130
       CAL     K1                                                       HMR16140
       LAS     K15                                                      HMR16150
       TRA*    B15HI+15,2                                               HMR16160
       TRA     C(14)                                                    HMR16170
       TRA     C(14)                                                    HMR16180
*      COMPARE K1 AND K16                                               HMR16190
C(16)  LXA     NWDCF,1                                                  HMR16200
CAL16  CAL*    K1                                                       HMR16210
       LAS*    K16                                                      HMR16220
       TRA     ((16)                                                    HMR16230
       TRA     TIX16                                                    HMR16240
       TRA     ((15)                                                    HMR16250
TIX16  TIX     CAL16,1,1                                                HMR16260
       CAL     K1                                                       HMR16270
       LAS     K16                                                      HMR16280
       TRA     ((16)                                                    HMR16290
       TRA     ((15)                                                    HMR16300
       TRA     ((15)                                                    HMR16310
*  TRANSFERS FROM 3RD ENTRY COMPARE.                                    HMR16320
B3H    TXL     ((3),2,3      IF MERGE ORDER IS 3, WE ARE DONE.          HMR16330
       TRA     C(4)          GREATER THAN 3.  COMPARE 4TH ENTRY.        HMR16340
*  TRANSFERS FROM 5TH ENTRY COMPARE.                                    HMR16350
B5H    TXH     C(7),2,7      COMPARE 7TH ENTRY IF MERGE ORDER 8 OR MORE.HMR16360
       XEC     B5HI+5,2      MERGE ORDER LESS THAN 8.                   HMR16370
       TRA     C(7)           ORDER IS 7. COMPARE 7TH ENTRY.            HMR16380
       TRA     C(6)          ORDER IS 6.  COMPARE 6TH ENTRY.            HMR16390
B5HI   TRA     ((5)          ORDER IS 5.  FINISHED.                     HMR16400
*  TRANSFERS FROM 7TH ENTRY COMPARE.                                    HMR16410
B7H    TXL     ((7),2,7      DONE IF ORDER IS 7.                        HMR16420
       TRA     C(8)          ORDER 8 OR MORE.  COMPARE 8TH ENTRY.       HMR16430
*  TRANSFERS FROM 9TH ENTRY COMPARE.                                    HMR16440
       TRA     C(13)         ORDER 16.  COMPARE 13TH ENTRY.             HMR16450
       TRA     C(13)         ORDER 15.  DITTO.                          HMR16460
       TRA     C(13)         ORDER 14.  DITTO.                          HMR16470
       TRA     C(13)         ORDER 13.  DITTO.                          HMR16480
       TRA     C(11)         ORDER 12.  COMPARE 11TH ENTRY.             HMR16490
       TRA     C(11)         ORDER 11.  DITTO.                          HMR16500
       TRA     C(10)         ORDER 10.  COMPARE 10TH ENTRY.             HMR16510
B9HI   TRA     ((9)          ORDER 9.  DONE.                            HMR16520
*  TRANSFERS FROM 11TH ENTRY COMPARE.                                   HMR16530
B11H   TXL     ((11),2,11    DONE IF ORDER 11.                          HMR16540
       TRA     C(12)         ORDER 12 OR MORE.  COMPARE 12TH ENTRY.     HMR16550
*  TRANSFERS FROM 13TH ENTRY COMPARE.                                   HMR16560
       TRA     C(15)         ORDER 16.  COMPARE 15TH ENTRY.             HMR16570
       TRA     C(15)         ORDER 15.  DITTO.                          HMR16580
       TRA     C(14)         ORDER 14.  COMPARE 14TH ENTRY.             HMR16590
B13HI  TRA     ((13)         ORDER 13.  DONE.                           HMR16600
*  TRANSFERS FROM 15TH ENTRY COMPARE.                                   HMR16610
       TRA     C(16)         ORDER 16.  COMPARE 16TH ENTRY.             HMR16620
B15HI  TRA     ((15)         ORDER 15.  DONE.                           HMR16630
*  ENTRY TO THIS TABLE LOADS IR2 WITH INSERTION LEVEL OF ITEM MERGED.   HMR16640
((16)  AXT     16,2                                                     HMR16650
       TRA     MRXCL                                                    HMR16660
((15)  AXT     15,2                                                     HMR16670
       TRA     MRXCL                                                    HMR16680
((14)  AXT     14,2                                                     HMR16690
       TRA     MRXCL                                                    HMR16700
((13)  AXT     13,2                                                     HMR16710
       TRA     MRXCL                                                    HMR16720
((12)  AXT     12,2                                                     HMR16730
       TRA     MRXCL                                                    HMR16740
((11)  AXT     11,2                                                     HMR16750
       TRA     MRXCL                                                    HMR16760
((10)  AXT     10,2                                                     HMR16770
       TRA     MRXCL                                                    HMR16780
((9)   AXT     9,2                                                      HMR16790
       TRA     MRXCL                                                    HMR16800
((8)   AXT     8,2                                                      HMR16810
       TRA     MRXCL                                                    HMR16820
((7)   AXT     7,2                                                      HMR16830
       TRA     MRXCL                                                    HMR16840
((6)   AXT     6,2                                                      HMR16850
       TRA     MRXCL                                                    HMR16860
((5)   AXT     5,2                                                      HMR16870
       TRA     MRXCL                                                    HMR16880
((4)   AXT     4,2                                                      HMR16890
       TRA     MRXCL                                                    HMR16900
((3)   AXT     3,2                                                      HMR16910
       TRA     MRXCL                                                    HMR16920
((2)   AXT     2,2                                                      HMR16930
       TRA     MRXCL                                                    HMR16940
 ((1)  TRA     MR100                                                    HMR16950
       SPACE                                                            HMR16960
*  INSERT PRESENT K1 RECORD AT PROPER LEVEL AND SHIFT K TABLE           HMR16970
 MRXCL LDQ     K1                                                       HMR16980
       CAL     K1+1,2                                                   HMR16990
       STQ     K1+1,2                                                   HMR17000
       XCL                                                              HMR17010
       TIX     *-3,2,1                                                  HMR17020
       TRA     MR100                                                    HMR17030
       EJECT                                                            HMR17040
*                                                                       HMR17050
LOC    PZE                                                              HMR17060
*      MAXIMUM OUTPUT BLOCK SIZE                                        HMR17070
MAXOPB PZE     0              MAX. RECORDS FIXED/WORDS VARIABLE         HMR17080
CNT9   PZE                    READ COUNT, IN NO. OF RECORDS             HMR17090
ONE    DEC     1                                                        HMR17100
TWO    DEC     2                                                        HMR17110
 THE   DEC     3                                                        HMR17120
 FOUR  DEC     4                                                        HMR17130
 SIX   DEC     6                                                        HMR17140
SEVEN  DEC     7                                                        HMR17150
ONEA   ONE                                                              HMR17160
  TOO  TWO                                                              HMR17170
THREE  THREE                                                            HMR17180
 FORE  FOR                                                              HMR17190
 FIVE  FVE                                                              HMR17200
MZ     FOR                                                              HMR17210
 TAG4  PZE     ,4,                                                      HMR17220
SETCVS TRA     BCDCV                                                    HMR17230
SETVCK PZE     CKS                                                      HMR17240
MORD1                         MERGE ORDER - NO. OF FILES FROM XS        HMR17250
MORD2                         NO. OF FILES LEFT TO BE MERGED            HMR17260
MORD3                         CURRENT MERGE ORDER                       HMR17270
MORT                          NO. OF AVAILABLE MERGE TAPES, CURRENT     HMR17280
CNTR                          TOTAL NO. OF RECORDS READ                 HMR17290
CNTW                          TOTAL NO. OF RECORDS WRITTEN              HMR17300
NRSUMM PZE     0              COUNT OF RECORDS SUMMARIZED.              HMR17310
MRT1                          FILE NO. OF PREVIOUS READ,,AREA NO.       HMR17320
MRT2                          FILE NO. OF PRESENT READ,,AREA NO.        HMR17330
MRT3                          FILE NO. OF PRESENT WRITE                 HMR17340
CNT5                          SEQUENCE COUNT                            HMR17350
WRCT   PZE                    COUNT FOR EACH WRITE                      HMR17360
WRTB1  PZE     ,2,            WRITE TABLE 1                             HMR17370
WRTB2  PZE     ,2,            WRITE TABLE 2                             HMR17380
WRTA1  PZE     ,2,             START LOCATION OF WRITE TABLE 1          HMR17390
WRTA2  PZE     ,2,             END LOC. OF WRITE TABLE 1                HMR17400
WRTA3  PZE     ,2,             START LOCATION OF WRITE TABLE 2          HMR17410
WRTA4  PZE     ,2,             END LOC. OF WRITE TABLE 2                HMR17420
MRSC   PZE     ,1,            SEQUENCE CHECK WORD                       HMR17430
NORMAL PZE     0,0,0           NO ZERO WHEN WRITE NORMAL                HMR17440
CLKWD  OCT     631463000000    TRAILER CK WORD, NO. OF WORDS IN ADDR.   HMR17450
*                                                                       HMR17460
* CONTROL FIELD WORD TABLE FOR MERGE                                    HMR17470
K16    PZE     ,1,16                                                    HMR17480
K15    PZE     ,1,15                                                    HMR17490
K14    PZE     ,1,14                                                    HMR17500
K13    PZE     ,1,13                                                    HMR17510
K12    PZE     ,1,12                                                    HMR17520
K11    PZE     ,1,11                                                    HMR17530
K10    PZE     ,1,10                                                    HMR17540
K9     PZE     ,1,9                                                     HMR17550
K8     PZE     ,1,8                                                     HMR17560
K7     PZE     ,1,7                                                     HMR17570
K6     PZE     ,1,6                                                     HMR17580
K5     PZE     ,1,5                                                     HMR17590
K4     PZE     ,1,4                                                     HMR17600
K3     PZE     ,1,3                                                     HMR17610
K2     PZE     ,1,2                                                     HMR17620
K1     PZE     ,1,1                                                     HMR17630
CFWD   BES     0                                                        HMR17640
*                                                                       HMR17650
*      TABLE OF LOCATION OF EXTRACTED CONTROL FIELDS FOR EACH FILE      HMR17660
CFADR  BES     16             ADR.= LOC. OF LAST WORD+1 OF CONTROL FLD. HMR17670
       SPACE                                                            HMR17680
*      TABLE OF AREA WORDS * DEC. = NO. RECORDS LAST READ INTO AREA     HMR17690
*                             ADR. = NO. RECORDS REMAINING IN AREA      HMR17700
ARWD   BES     33                                                       HMR17710
       SPACE                                                            HMR17720
*      TABLE OF FILE WORDS *  ADR.= LOC. OF PRESENT REC. FOR THIS FILE  HMR17730
*                             DEC.= PRESENT AREA NO. OF THIS FILE       HMR17740
FLWD   BES     16                                                       HMR17750
       SPACE                                                            HMR17760
*      1ST. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  HMR17770
*                                     DEC=AREA NO. OF THE BLOCK         HMR17780
RFWD1  BES     16                                                       HMR17790
       SPACE                                                            HMR17800
*      2ND. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  HMR17810
*                                     DEC=AREA NO. OF THE BLOCK         HMR17820
RFWD2  BES     16                                                       HMR17830
       SPACE                                                            HMR17840
*      3RD. LEVEL RESERVE FILE WORD * ADR=LOC. OF 1ST. RECORD OF BLOCK  HMR17850
*                                     DEC=AREA NO. OF THE BLOCK         HMR17860
RFWD3  BES     16                                                       HMR17870
       SPACE                                                            HMR17880
       PZE     RFWD3,1                                                  HMR17890
       PZE     RFWD2,1                                                  HMR17900
       PZE     RFWD1,1                                                  HMR17910
RWD    BES     0                                                        HMR17920
       SPACE                                                            HMR17930
*      RECORD STORAGE AREA ADDRESS TABLE                                HMR17940
ADDR   BES     33               POINTS TO LOC. OF 1ST. WORD OF AREA     HMR17950
 BKRD  BES     33              POINTS TO LOC. OF LAST WORD IN THE BUFFERHMR17960
       SPACE   1                                                        HMR17970
FLNO   BES     16             OUTPUT FILE NO. TABLE                     HMR17980
       SPACE                                                            HMR17990
MR777  PZE                                                              HMR18000
       SPACE                                                            HMR18010
*      END OF FILE TABLE                                                HMR18020
EOFIND BES     16             IF NONZERO FILE IS AT EOF.                HMR18030
 NOP   NOP                                                              HMR18040
 TRA   TRA     0                                                        HMR18050
 AACNT PZE                    NUMBER OF READ AREAS AVAILABLE COUNTER    HMR18060
EFNAA  PZE     0              NUMBER AREAS AVAILABLE FOR USE.           HMR18070
       SPACE                                                            HMR18080
*      TABLE FOR SELECTING NEXT READ FILE                               HMR18090
*        DECREMENT = NO. BLOCKS IN CORE FOR THIS FILE                   HMR18100
*        ADDRESS = FILE NUMBER                                          HMR18110
 MRBKC BES     16                                                       HMR18120
       SPACE                                                            HMR18130
 ONED  PZE     0,0,1                                                    HMR18140
 MSK1  OCT     377777000000                                             HMR18150
 ONEHI OCT     007000000000                                             HMR18160
 NWTR  PZE     0              NUMBER OF WORDS THIS RECORD.              HMR18170
MRNWRW PZE     0              NUMBER WORDS READY TO WRITE               HMR18180
*                                                                       HMR18190
*      CELLS USED WHEN DUMPING A RECORD                                 HMR18200
       PZE     DRERC1,,6                                                HMR18210
ATDAR  PZE     0,,0           ADR.=LOC. OF REC.  DEC.=NO. WORDS         HMR18220
*                                                                       HMR18230
DRERC1 BCI     6,INVALID CHECKSUM RECORD PHASE 2                        HMR18240
       SPACE                                                            HMR18250
*      INPUT FILES BLOCK SEQUENCE BREAK TABLE                           HMR18260
MRIBSC BES     16                                                       HMR18270
*                                                                       HMR18280
*      OUTPUT BLOCK SEQUENCE BREAK INDICATOR                            HMR18290
MROSBI PZE     0                                                        HMR18300
       SPACE                                                            HMR18310
*      MODIFICATIONS FOR FIXED LENGTH                                   HMR18320
FXSETA TRA     FXCKS                                                    HMR18330
FXSETB CLA     WRCT                                                     HMR18340
FXSETC TRA     MR106                                                    HMR18350
FXSETD TRA     MR209                                                    HMR18360
FXSETE PAX     ,4                                                       HMR18370
FXSETF XCL                                                              HMR18380
LASTPS PZE                     LAST PASS SWITCH WHENNON ZERO            HMR18390
 PURE  PZE     0,0,0                                                    HMR18400
 MSK2  OCT     000700000000                                             HMR18410
SHORTP PZE                     LOCATION OF UNIT CONTROL WORD            HMR18420
ODDEVE PZE     1,0,0           ODD=  EVEN=0                             HMR18430
  TWT  OCT     200000000000    BACKWARD READ RAWPR                      HMR18440
 BACK  LAC     WRCT,2                                                   HMR18450
 BBCK  LXA     WRCT,2                                                   HMR18460
  RBK  PZE                     BACKWARD READ , NON ZERO                 HMR18470
 ADJL  SUB     ONE                                                      HMR18480
 FL    PZE                                                              HMR18490
FRWD   SUB     MBL                                                      HMR18500
       EJECT                                                            HMR18510
*      MERGE, PHASE 2, INITIALIZATION                                   HMR18520
VMRHKP STZ     RAWPR-11                                                 HMR18530
       STZ     RAWPR-8                                                  HMR18540
       AXT     2,2                                                      HMR18550
       SXA     PHIND,2        SET PHASE INDICATOR TO 2                  HMR18560
       STL     RDIND          SET READ COMPLETION INDICATOR.            HMR18570
       STL     WRIND          SET WRITE COMPLETION INDICATOR.           HMR18580
       STZ     WRIND1         TURN OFF EOT INDICATOR.                   HMR18590
       STZ     RDIND1          TURN OFF EOF INDICATOR                   HMR18600
       AXT     NWTR,2                                                   HMR18610
       SXA     ERAPR-3,2                                                HMR18620
       AXT     NWLR,2                                                   HMR18630
       SXA     ERAPR-4,2                                                HMR18640
       CLA     XSCT            TRANSFER INTERNAL SORT PHASE RECORD      HMR18650
       STO     MRCT            COUNT TO MERGE PHASE RECORD COUNT        HMR18660
       LXA     MR777,1        COMPUTE STARTING LOCATION                 HMR18670
       PXA     ,1               OF VARIABLE LENGTH                      HMR18680
       ADD     ONE                TABLES                                HMR18690
       LXA     MORDER,1       INITIALIZE ADDRESS TABLE OF CFWDS         HMR18700
       AXT     1,2                                                      HMR18710
       ADD     NWDCF          CFADR WILL POINT TO LAST WORD +1 OF       HMR18720
       STO     CFADR,2          EXTRACTED CONTROL FIELD                 HMR18730
       TXI     *+1,2,1                                                  HMR18740
       TIX     *-3,1,1                                                  HMR18750
       ADD     NWDCF          INITIALIZE ADDRESS OF SEQ. CHECK CONTROL  HMR18760
       STA     MRSC             FIELD = LAST WORD +1 OF CF              HMR18770
       ADD     TWO                                                      HMR18780
       STA     WRTA1           SAVE THE BEGINNING OF WRITE TABLE 1      HMR18790
       ADD     NRPBL                                                    HMR18800
       SUB     ONE                                                      HMR18810
       STA     WRTA2           SAVE THE END OF WRITE TABLE 2            HMR18820
       ADD     SEVEN                                                    HMR18830
       STA     WRTA3           SAVE THE BEGINNING OF WRITE TABLE 2      HMR18840
       ADD     NRPBL                                                    HMR18850
       SUB     ONE                                                      HMR18860
       STA     WRTA4           SAVE THE END OF WRITE TABLE 2            HMR18870
       ADD     SEVEN                                                    HMR18880
       ADD     TAG4                                                     HMR18890
       LXA     CNT6,1         INITIALIZE RECORD STORAGE AREA            HMR18900
       AXT     1,2              ADDRESS TABLE                           HMR18910
       STO     ADDR,2                                                   HMR18920
       ADD     MBL                                                      HMR18930
       STO     BKRD,2                                                   HMR18940
       ADD     SIX                                                      HMR18950
       TXI     *+1,2,1                                                  HMR18960
       TIX     *-5,1,1                                                  HMR18970
       SPACE                                                          FXHMR18980
*      TEST FOR FIXED OR VARIABLE                                     FXHMR18990
       ZET     FXORVA                                                 FXHMR19000
       TRA     MVARIA                                                 FXHMR19010
       SPACE                                                          FXHMR19020
*      INITIALIZE PROGRAM TO PROCESS FIXED LENGTH RECORDS             FXHMR19030
       CLA     CALPR-9         STORE RECORD LENGTH IN                   HMR19040
       STO     NWTR            NUMBER OF WORDS THIS RECORD COUNTER      HMR19050
       CLA     NRPBL          INITIALIZE OUTPUT BLOCK COUNTER WITH      HMR19060
       STO     MAXOPB           MAX. NUMBER OF RECORDS PER BLOCK.       HMR19070
       CLA     FXSETB                                                   HMR19080
       STO     FXSW01                                                   HMR19090
       CLA     FXSETC                                                   HMR19100
       STO     FXSW02                                                   HMR19110
       CLA     FXSETD                                                   HMR19120
       STO     FXSW03                                                   HMR19130
       CLA     FXSETE                                                   HMR19140
       STO     FXSW04                                                   HMR19150
       STO     FXSW05                                                   HMR19160
       CLA     FXSETF                                                   HMR19170
       STO     FXSW06                                                   HMR19180
       STO     FXSW07                                                   HMR19190
       LDQ     NOP                                                      HMR19200
       SLQ     FXSW08                                                   HMR19210
       AXT     0,4                                                      HMR19220
       ZET     EQOPT          TEST FOR EQUALS OPTION                    HMR19230
       TXI     *+1,4,1                                                  HMR19240
       NZT     CKSIND         TEST FOR CHECKSUM OPTION.               FXHMR19250
       TRA     VMR404         NO CHECKSUM.                            FXHMR19260
       TXI     *+1,4,1        INCREASE COUNT OF NO. OPTIONS.          FXHMR19270
       CLA     FXSETA         SET CHECKSUM SWITCH TO ENTER            FXHMR19280
       STO     MRCKSW           FIXED LENGTH CHECKSUM ROUTINE.        FXHMR19290
       TRA     VMR404                                                 FXHMR19300
       SPACE                                                            HMR19310
*      VARIABLE LENGTH ONLY                                             HMR19320
MVARIA CLA     SETCVS                                                   HMR19330
       NZT     MODEI          TEST FOR BCD OR BINARY.                   HMR19340
       STO     BCDSW          BCD-SET SW. FOR CHARACTER CONVERSION      HMR19350
       SPACE                                                            HMR19360
*      INITIALIZE WRITE CONTROL COUNTER                                 HMR19370
       CLA     MBL            MERGE BLOCKING IN NUMBER OF WORDS         HMR19380
       STO     MAXOPB                                                   HMR19390
       SPACE                                                            HMR19400
*      TEST FOR EQUALS AND CHECKSUM OPTIONS AND INITIALIZE              HMR19410
*        NECESSARY CELLS AND SWITCHES                                   HMR19420
       AXT     0,4                                                      HMR19430
       ZET     EQOPT                                                    HMR19440
       TXI     VMR403,4,1     EQUALS OPTION SPECIFIED                   HMR19450
*      EQUALS OPTION NOT SPECIFIED                                      HMR19460
       CLA     CKSD           MODIFY                                    HMR19470
       STA     CKS              CHECKSUM                                HMR19480
       LXA     *-2,1              ROUTINE                               HMR19490
       TXI     *+1,1,1              TO                                  HMR19500
       PXA     ,1                     BYPASS                            HMR19510
       ADD     TRA                      EQUALS                          HMR19520
       STO     CKS+1                     OPTIONS                        HMR19530
       CLA     CKSD+2                       WORD                        HMR19540
       STA     CKSE-1                                                   HMR19550
       SPACE                                                            HMR19560
VMR403 NZT     CKSIND                                                   HMR19570
       TRA     VMR404         CHECKSUM OPTION NOT SPECIFIED             HMR19580
*      CHECKSUM OPTION SPECIFIED                                        HMR19590
       TXI     *+1,4,1        ADD A WORD FOR CHECKSUM                   HMR19600
       CLA     SETVCK         SET SWITCH                                HMR19610
       STA     MRCKSW           FOR CHECKSUM                            HMR19620
       SPACE                                                            HMR19630
*  INITIALIZE ADDRESS OF CELL MRDVWC WITH NO. WDS. ADDED FOR OPTIONS    HMR19640
VMR404 SXA     MRDVWC,4                                                 HMR19650
*                                                                       HMR19660
       SXD     BUMP,4                                                   HMR19670
       SPACE                                                            HMR19680
*      INITIALIZE IOCP COMMANDS IN TWO WRITE TABLES.                    HMR19690
       LXA     NRPBL,1        MAX. NO. REC. PER BLOCK TO IR1.           HMR19700
       AXT     0,2                                                      HMR19710
       LXA     NWTR,4                                                   HMR19720
       PXD     ,4                                                       HMR19730
       SSM                                                              HMR19740
       LDQ     WRTA1           SET UP                                   HMR19750
       STQ     WRTB1                 WRITE TABLE WITH                   HMR19760
       LDQ     WRTA3                                        COPY OR     HMR19770
       STQ     WRTB2                                               IOCP HMR19780
       STO*    WRTB1                                                    HMR19790
       STO*    WRTB2                                                    HMR19800
       TXI     *+1,2,-1                                                 HMR19810
       TIX     *-3,1,1                                                  HMR19820
       SPACE                                                            HMR19830
*      MORE INITIALIZATION                                              HMR19840
MMOREI LXA     MORDER,4       ORDER OF MERGE TO IR4.                    HMR19850
       TXI     *+1,4,-1                                                 HMR19860
       SXD     KAZOO,4                                                  HMR19870
       LXA     CNT6,4                                                   HMR19880
       SXD     MRN49,4                                                  HMR19890
       CLA     LABPR-4                                                  HMR19900
       ADD     TWO                                                      HMR19910
       STO     FLN                                                      HMR19920
       ADD     ONE                                                      HMR19930
       STO     PSN                                                      HMR19940
*      CHECK THIS IS A HYPER MERGE OR MIXED CHANNEL MERGE               HMR19950
       AXT     0,2                                                      HMR19960
       CAL*    CHAPR-2                                                  HMR19970
       STA     *+1                                                      HMR19980
       CLA     **                                                       HMR19990
       ANA     MSK2                                                     HMR20000
       STZ     PURE                                                     HMR20010
       TZE     *+2             HYPER CHANNEL,PURE=0                     HMR20020
       STL     PURE            729 CHANNEL, PURE NON ZERO               HMR20030
       CAL*    CHAPR-3                                                  HMR20040
       STA     *+1                                                      HMR20050
       CLA     **                                                       HMR20060
       ANA     MSK2                                                     HMR20070
       ZET     PURE                                                     HMR20080
       TRA     *+2                                                      HMR20090
       TZE     HYPER           ALL HYPER CHANNEL                        HMR20100
       STL     PURE                                                     HMR20110
       TRA     VMR721          MIXED CHANNEL                            HMR20120
*   MORE INITIALIZATION FOR ALL HYPER MERGE CHANNELS                    HMR20130
HYPER  LDQ     TRA                                                      HMR20140
       SLQ     PASS            SET UP VARIABLE CONNECTOR IN EVERY PASS  HMR20150
       SLQ     VMR720          TO CHECK LAST PASS OR NOT                HMR20160
       STL     RAWPR-21        SET BACKWARD OPEN AND CLOSE SWITCH       HMR20170
       AXT     TWT,1           SET READ BACKWARD MOOD                   HMR20180
       SXA     VMRNN,1                                                  HMR20190
       STL     RBK                                                      HMR20200
       STL     ODDEVE          SET PASS CONTROL TO ODD                  HMR20210
       LDQ     NOP             SET FINAL EXIT SWITCH FOR                HMR20220
       SLQ     LBBB            ALL HYPER CHANNEL                        HMR20230
       CLA     CONST           SET UP THE LOCATION OF LAST WORD         HMR20240
       STA     MRN49A          OF THE STORAGE BUFFER FOR BACKWARD READ  HMR20250
       CLA     ADJL                                                     HMR20260
       STO     MRN49A+1                                                 HMR20270
       TRA     VMR721                                                   HMR20280
 MWR   SYN     (PROUT                                                   HMR20290
CVPRT  SYN     (CVPRT                                                   HMR20300
 OPTPR COMMON  15            OPTION CARD PARAMETERS                     HMR20310
CKSIND SYN     OPTPR-1      CHECKSUM OPTION INDICATOR  ZERO= NO CHECKSUMHMR20320
NOCKPT SYN     OPTPR-2      NO CKPT OPTION ZERO=TAKE CHECKPOINT         HMR20330
EQOPT  SYN     OPTPR-3      EQUALS OPTION ZERO= NO EQUALS OPTION        HMR20340
OLPRT  SYN     OPTPR-6      ON-LINE PRINT OPTION, NONZERO=PRINT         HMR20350
 OVEPR COMMON  2            OVERFLOW CARD PARAMETERS                    HMR20360
 LABPR COMMON  5            LABEL CARD PARAMETERS                       HMR20370
 CHAPR COMMON  6            CHANNEL CARD PARAMETERS                     HMR20380
CHIND  SYN     CHAPR-2      MERGE INPUT CHANNEL                         HMR20390
 FILPR COMMON  14           FILE CARD PARAMETERS                        HMR20400
MFBK   SYN     FILPR-2      ADDRESS OF MERGE FILE BLOCK                 HMR20410
 MODPR COMMON  50           MODIFICATION CARD PARAMETERS                HMR20420
MRMOD1 SYN     MODPR-10     MERGE USERS MOD. 1   ZERO = NO MODIFICATION HMR20430
MRMOD2 SYN     MODPR-11     MERGE USERS MOD. 2   ZERO = NO MODIFICATION HMR20440
MRMOD3 SYN     MODPR-12     MERGE USERS MOD. 3   ZERO = NO MODIFICATION HMR20450
MRMOD4 SYN     MODPR-13     MERGE USERS MOD. 4   ZERO = NO MODIFICATION HMR20460
MRMOD5 SYN     MODPR-14     MERGE USERS MOD. 5   ZERO = NO MODIFICATION HMR20470
MCEM1  SYN     MODPR-35     CE MODIFICATION 1, ZERO=NO MODIFICATION     HMR20480
MCEM2  SYN     MODPR-36     CE MODIFICATION 2, ZERO=NO MODIFICATION     HMR20490
MCEM3  SYN     MODPR-37     CE MODIFICATION 3, ZERO=NO MODIFICATION     HMR20500
MCEM4  SYN     MODPR-38     CE MODIFICATION 4, ZERO=NO MODIFICATION     HMR20510
MCEM5  SYN     MODPR-39     CE MODIFICATION 5, ZERO=NO MODIFICATION     HMR20520
 RECPR COMMON  10           RECORD CARD PARAMETERS                      HMR20530
FXORVA SYN     RECPR-5      FIXED OR VARIABLE IND. ZERO=FIXED           HMR20540
 DELPR COMMON  2            DELETE CARD PARAMETERS                      HMR20550
 SAMPR COMMON  7            SORT AND MERGE CARD PARAMETERS              HMR20560
MORDER SYN     SAMPR-1      MERGE ORDER                                 HMR20570
MRGS   SYN     SAMPR-2      NUMBER OF FILES TO BE MERGED                HMR20580
CFDATA SYN     SAMPR-3      CONTROL FIELD INFORMATION                   HMR20590
XTRMG  SYN     SAMPR-5      EXTERNAL MERGE FILE INDICATOR               HMR20600
 CALPR COMMON  50           CALCULATED PARAMETERS                       HMR20610
RL     SYN     CALPR-9      RECORD LENGTH                               HMR20620
MBL    SYN     CALPR-13     MERGE BLOCKING, IN NUMBER OF WORDS          HMR20630
NRPBL  SYN     CALPR-14     MERGE BLOCKING, IN NUMBER OF RECORDS        HMR20640
CNT6   SYN     CALPR-15     NUMBER OF MERGE AREAS                       HMR20650
NWDCF  EQU     CALPR-32        NUMBER OF WORD IN EXTRACTED CONTROL FIELDHMR20660
 GENPR COMMON  10           GENERAL PARAMETERS                          HMR20670
PHIND  SYN     GENPR        PHASE INDICATOR                             HMR20680
MODEI  SYN     GENPR-1      BINARY-BCD INDICATOR ZERO=BCD               HMR20690
PNBR   SYN     GENPR-2      PASS NUMBER                                 HMR20700
GEN03  EQU     GENPR-3       CONTAINS RETURNS FROM RESTART.             HMR20710
 RAWPR COMMON  30            READ AND WRITE PARAMETERS                  HMR20720
RWCS   SYN     RAWPR        CALLING SEQ. WORD ONE FOR IO                HMR20730
RWCS1  SYN     RAWPR-1      CALLING SEQ. WORD TWO FOR IO                HMR20740
RDIND  SYN     RAWPR-2      READ COMPLETION INDICATOR,NONZERO=COMPLETE  HMR20750
RDIND1 SYN     RAWPR-3      READ CHANNEL EOF INDICATOR,NONZERO=EOF      HMR20760
WRIND  SYN     RAWPR-4      WRITE COMPLETION INDICATOR,NONZERO=COMP.    HMR20770
WRIND1 SYN     RAWPR-5      END OF TAPE INDICATOR, NONZERO=EOT          HMR20780
CNT11  SYN     RAWPR-8      WORD-COUNT WORD FOR WRITE                   HMR20790
CLOCK  SYN     RAWPR-9         ADDRESS POINTS TO TRAILER CLOCK WORD     HMR20800
RAW11  EQU     RAWPR-11      I/O PRIORITY REQUEST CELL.                 HMR20810
 CNTPR COMMON  20           COUNT PARAMETERS                            HMR20820
XSCT   SYN     CNTPR        XS PHASE RECORD COUNT                       HMR20830
MRCT   SYN     CNTPR-1      MERGE PHASE RECORD COUNT                    HMR20840
MRDCT  SYN     CNTPR-4      COUNT OF DUMPED RECORDS IN PHASE 2          HMR20850
MRD    SYN     CNTPR-7      COUNT OF DUMPED RECORDS IN THIS PASS        HMR20860
COMNT  SYN     CNTPR-15     COUNT OF NUMBER OF STRINGS                  HMR20870
 ERAPR COMMON  30           ERASABLE STORAGE PARAMETERS                 HMR20880
RCWD   SYN     ERAPR-9      COMM. WORD WITH EXTRACT ROUTINE             HMR20890
FLN    SYN     ERAPR-20     FILE NUMBER - COMM. WITH LABEL ROUTINE      HMR20900
PSN    SYN     ERAPR-21     PASS NUMBER - COMM. WITH LABEL ROUTINE      HMR20910
 REFPR COMMON  1                                                        HMR20920
       EXTERN  MSGSUP                                                   HMR20930
       END                                                              HMR20940
* 7090/94 SORT VER 7 MOD 7 TAPE OPEN AND CLOSE ROUTINE               (7)HOP00000
*      FAP
       COUNT   1100                                                     HOP00010
       SPACE                                                            HOP00020
       ENTRY   HYOPEN                                                   HOP00030
       ENTRY   IOPEN                                                    HOP00040
       ENTRY   SCL                                                      HOP00050
       ENTRY   SKIP                                                     HOP00060
       ENTRY   SNDAT                                                    HOP00070
       ENTRY   SAVEW                                                    HOP00080
       ENTRY   RESTW                                                    HOP00090
       ENTRY   MSGSUP                                                   HOP00100
       SST                                                              HOP00110
       SPACE                                                            HOP00120
       TITLE                                                            HOP00130
*  FILE OPEN AND CLOSE ROUTINES.  CALLING SEQ. IS CALL IOPEN (OR SCL)   HOP00140
*                                 REMAINDER OF CS IS IN RWCS.           HOP00150
       SPACE                                                            HOP00160
HYOPEN BSS     0                                                        HOP00170
IOPEN  BSS     0                                                        HOP00180
       SXA     CLP1,1        SAVE                                       HOP00190
       SXA     CLP2,2         INDEX                                     HOP00200
       SXA     CLP4,4         REGISTERS.                                HOP00210
       TSX     OPEN,4        GO TO MAIN OPEN ROUTINE.                   HOP00220
       TRA     CLP1          EXIT FROM OPEN ROUTINE)                    HOP00230
 SCL   BSS     0                                                        HOP00240
       SXA     CLP1,1        SAVE                                       HOP00250
       SXA     CLP2,2         INDEX                                     HOP00260
       SXA     CLP4,4         REGISTERS.                                HOP00270
       TSX     CLOSE,4       GO TO MAIN CLOSE ROUTINE.                  HOP00280
CLP1   AXT     ,1            EXIT FROM OPEN OR CLOSE.                   HOP00290
CLP2   AXT     ,2                                                       HOP00300
CLP4   AXT     ,4                                                       HOP00310
       STL     GENPR-5                                                  HOP00320
       TRA     1,4           RETURN.                                    HOP00330
 CLOSE SXA     CL1,1         SAVE                                       HOP00340
       SXA     CL2,2          INDEX                                     HOP00350
       SXA     CL3,4          REGISTERS.                                HOP00360
       CLA     RAW00         GET FILE NO. FROM CALL SEQ.                HOP00370
       PDX     ,2             AND SIGN ALSO TELLS IF INPUT OR OUTPUT.   HOP00380
       TXL     CL9,2,0       TRANSFER IF FILE NO. ZERO.                 HOP00390
       TXH     CL18,2,-2     TRANSFER IF FILE IS UNRT.                  HOP00400
       TXI     *+1,2,-1                                                 HOP00410
       TPL     CL4           FILE IS EITHER INTERMEDIATE MERGE TAPE OR  HOP00420
*                            EXTERNAL MERGE INPUT TAPE.  IS IT INPUT.   HOP00430
       CLA*    PR16          NO, OUTPUT FILE.  GET L(UCB),              HOP00440
       TSX     OP400,4        AND PREPARE TO WRITE EOF.                 HOP00450
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP00460
       TSX     SNDAT,4       CALL SORT NON-DATA SELECT TO               HOP00470
       PZE     UCWIT,,WEF     WRITE EOF.                                HOP00480
       TRA     *+1           END-OF-TAPE RETURN.                        HOP00490
       ZET     HYPSW         IF HYPER,                                  HOP00500
       TRA     CL001          TRANSFER.                                 HOP00510
 CL000 TSX     SNDAT,4        REWIND THE TAPE.                          HOP00520
       PZE     UCWIT,,REW                                               HOP00530
 CL1   AXT     ,1            RELOAD                                     HOP00540
 CL2   AXT     ,2             INDEX                                     HOP00550
 CL3   AXT     ,4             REGISTERS AND                             HOP00560
       STL     GENPR-5                                                  HOP00570
       TRA     1,4            EXIT FROM CLOSE ROUTINE.                  HOP00580
*  HYPERTAPE ROUTINE FOR CLOSE OF INTERNAL MERGE OUTPUT                 HOP00590
 CL001 ZET     RDBCK         IS READ BACKWARD                           HOP00600
       TRA     *+4            REQUESTED.  YES.                          HOP00610
       LAC     UCWIT,4       NO. ZERO OUT UCW4                          HOP00620
       STZ     3,4            AND REWIND.                               HOP00630
       TRA     CL000                                                    HOP00640
       AXT     1,1           CS SAYS TO USE INT. HEADER WHEN YOU        HOP00650
       CALL    LABEL         PREPARE TRAILER FOR INTERMEDIATE MERGE.    HOP00660
       PZE     UCWIT                                                    HOP00670
       STL     GENPR-4                                                  HOP00680
       TSX     LABRW,4       WRITE TRAILER WITH                         HOP00690
       MTH                   NO EOF FOLLOWING.                          HOP00700
       TRA     CL1           EXIT.                                      HOP00710
*  FILE IS INTERMEDIATE INPUT OR ELSE EXTERNAL MERGE INPUT.  IF MERGE   HOP00720
*   INPUT, WE MUST READ TRAILER LABEL AND REWIND.  IF INTERMEDIATE      HOP00730
*   INPUT, SIMPLY REWIND.                                               HOP00740
CL4    LDI     OPENCL        IS THIS INPUT                              HOP00750
       CAL     K1             FILE ALREADY CLOSED.                      HOP00760
       ALS     15,2                                                     HOP00770
       TIF     CL1           TRANSFER TO EXIT IF IT IS.                 HOP00780
       IIA                   SET IT CLOSED.                             HOP00790
       STI     OPENCL                                                   HOP00800
       CLA*    PR15          GET L(UCB) AND                             HOP00810
       TSX     OP400,4        SAVE.  ENSURE ACTIVITY COMPLETE.          HOP00820
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP00830
       TPL     CL8           TRANSFER IF FILE IS INTERNAL MERGE INPUT.  HOP00840
       PDX     ,1            SAVE                                       HOP00850
       SXA     OPN76,1       L(FDB).                                    HOP00860
       LAC     OPN76,4                                                  HOP00870
       CLA     -3,4                                                     HOP00880
       PAX     ,2                                                       HOP00890
       STZ     LABCTL        RESET LABEL CONTROL INDICATOR.             HOP00900
       STZ     LASTR         RESET LAST-REEL INDICATOR.                 HOP00910
       TXH     CL005,2,1     SKIP IF NO LABELS.                         HOP00920
       CLA     (LTPOS        SAVE THE RECORD COUNT                      HOP00930
       STO     GEN07         FOR LABEL.                                 HOP00940
       CLA     -15,4         WORD 16 OF FILE DATA BLOCK IS              HOP00950
       TPL     CL045          MINUS IF REELS UNDER LABEL CONTROL,       HOP00960
       STL     LABCTL         INWHICH CASE SET LABEL CONTROL INDICATOR. HOP00970
 CL045 TSX     LABRW,4       READ TRAILER LABEL.                        HOP00980
       OCT     320000000000  NO EOF FOLLOWING.  ENABLE NCI.             HOP00990
       ZET     NOLAB                                                    HOP01000
       TRA     SETNOL        LABEL UNREADABLE.  INDICATE THIS.          HOP01010
       AXT     CTLMI,1       CHECK LABEL JUST READ.                     HOP01020
       CAL     OPN76                                                    HOP01030
       NZT     LAB20         WAS LABEL 14 WDS.                          HOP01040
       SSM                   NO. ASSUME THAT IT WAS 20.                 HOP01050
       CALL    LABEL                                                    HOP01060
       PZE     UCWIT                                                    HOP01070
       TSX     OP220,2                                                  HOP01080
       PZE     CL045,,1      ERROR RETRN TO CL045,,1 BSR.               HOP01090
       STI     EOFEOR        SAVE EOR OR EOF INDICATION.                HOP01100
 CL005 NZT     RELSW         TEST FOR REW OR RUN.                       HOP01110
       TRA     CLR05         RUN                                        HOP01120
       TSX     SNDAT,4       REWIND ONLY.                               HOP01130
       PZE     UCWIT,,REW                                               HOP01140
       TRA     *+3                                                      HOP01150
 CLR05 TSX     SNDAT,4       REWIND AND UNLOAD.                         HOP01160
       PZE     UCWIT,,RUN                                               HOP01170
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             HOP01180
       TRA     TESTEF        YES.  TEST FOR LAST REEL.                  HOP01190
       LAC     OPN76,4       -L(FDB).                                   HOP01200
       CAL     -15,4         CHECK FOR MORE REELS.                      HOP01210
       CAS     -21,4                                                    HOP01220
       TRA     CL006         MORE REELS.                                HOP01230
       NOP                   SHOULDN'T NEED THIS, BUT LET'S BE SAFE.    HOP01240
CL055  LXA     CLP4,4        LAST REEL.  SET INDICATION                 HOP01250
       STL     2,4            IN CALLING PROGRAM.                       HOP01260
       TRA     CL1           EXIT.                                      HOP01270
CL006  LAC     OPN76,4                                                  HOP01280
       CAL     -14,4                                                    HOP01290
       TSX     (DECVA,4                                                 HOP01300
       STQ     CL300+5                                                  HOP01310
       LDQ*    UCWIT                                                    HOP01320
       TSX     MSGSUP,4,3                                               HOP01330
       PZE     CL300,,7+512*DBLSP                                       HOP01340
       ZET     RELSW         IF TAPE WAS NOT UNLOADED,                  HOP01350
       TSX     (PAUSE,4       WAIT FOR OPERATOR ACTION.                 HOP01360
       TRA     CL1           EXIT.                                      HOP01370
SETNOL STZ     EOFEOR        SET LABEL UNREADABLE.                      HOP01380
       TRA     CL005         IGNORE LABEL CHECKING.                     HOP01390
TESTEF CAL     EOFEOR        GET WORD FROM LABEL.                       HOP01400
       LAS     =H1EOF        COMPARE FOR LAST REEL.                     HOP01410
       TRA     *+2                                                      HOP01420
       TRA     CL055         LAST REEL.  GO SET INDICATOR.              HOP01430
       SUB     =H1EOR                                                   HOP01440
       TZE     CL006         SHOULD BE ZERO.  OTHERWISE, LABEL          HOP01450
       LDQ*    UCWIT          WAS UNREADABLE. PRINT MESSAGE.            HOP01460
       TSX     MSGSUP,4,3     FOR OPERATOR ACTION AS TO WHETHER         HOP01470
       PZE     CL330,,6       HE WANTS TO CALL THIS THE LAST            HOP01480
       TSX     MSGSUP,4,2     REEL OR NOT.                              HOP01490
       PZE     1                                                        HOP01500
       PZE     CL340,,9+512*DBLSP                                       HOP01510
       TSX     C178.3,4      GO GET OPTION AND PRINT IT OUT.            HOP01520
       ZET     LASTR         WAS LAST-REEL INDICATOR SET IN             HOP01530
       TRA     CL055          THE PREVIOUS SUBROUTINE.                  HOP01540
       TRA     CL006         NO.  GO PRINT NEXT REEL LOAD MESSAGE.      HOP01550
*  FILE IS INTERNAL MERGE INPUT.                                        HOP01560
 CL8   ZET     RDBCK         FILE IS INTERNAL MERGE INPUT.              HOP01570
       TRA     CL83          TRA IF RD. BCKWD. (ALL MERGE TAPES MUST BE HOP01580
       TSX     SNDAT,4        HYPER).  IF MIXED CHANNELS OR ALL 729     HOP01590
       PZE     UCWIT,,REW     REWIND AND                                HOP01600
       TRA     CL1            GO TO EXIT.                               HOP01610
 CL83  STL     GENPR-4                                                  HOP01620
       TSX     LABRW,4       GO TO READ, HEADER, NO EOF                 HOP01630
       OCT     140000000000  FOLLOWING. IT WILL BE READ BACKWARDS.      HOP01640
       ZET     NOLAB                                                    HOP01650
       TRA     CL1           GO TO EXIT.                                HOP01660
       TRA     CL1           TEMPORARY BYPASS OF LABEL CHECK.           HOP01670
       AXT     2,1           SET UP CS FOR LABEL TO CHECK               HOP01680
       CALL    LABEL         AN INTERMEDIATE HEADER.                    HOP01690
       PZE     UCWIT                                                    HOP01700
       TSX     OP240,2       RETURN TO HERE MEANS LABEL MUST BE REREAD. HOP01710
       PZE     CL83,,1       SKIP ONE RECORD AND GO TO CL83 FOR RETRY.  HOP01720
       TRA     CL1           NORMAL RETURN FROM LABEL.  GO TO EXIT.     HOP01730
*  FILE IS EITHER ORIGINAL INPUT OR FINAL OUTPUT.  TEST FOR WHICH.      HOP01740
 CL9   TPL     CL14          IF FILE IS INPUT TO SORT PROGRAM.          HOP01750
       CAL*    PR16          FILE IS FINAL OUTPUT.  GET L(UCB).         HOP01760
       TSX     OP400,4                                                  HOP01770
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP01780
       LAC     PR29,4        -L(FDB) FOR OUTPUT.                        HOP01790
       CAL     -15,4         UPDATE NO. OF OUTPUT                       HOP01800
       ADD     K1             REELS BY 1.                               HOP01810
       STA     -15,4                                                    HOP01820
       STA     CLCNT                                                    HOP01830
       CAL     -7,4          ADD                                        HOP01840
       SLW     CL260+4                                                  HOP01850
       TSX     ADBCD1,4       1 TO REEL SEQUENCE                        HOP01860
       LAC     PR29,4         NO. FOR                                   HOP01870
       STQ     -7,4          NEXT OUTPUT REEL.                          HOP01880
       LDQ*    UCWIT                                                    HOP01890
       TSX     MSGSUP,4,3                                               HOP01900
       PZE     CL260,,6+512*DBLSP                                       HOP01910
       CLA     RAW01         GET SIGN TO FLAG WHETHER CLOSING FINAL     HOP01920
       TPL     MORE           OUTPUT REEL OR NOT.  INITIALIZE GATE.     HOP01930
       CLS     CL11          SET GATE.                                  HOP01940
       STO     CL11                                                     HOP01950
 MORE  LAC     UCWIT,4       GET -L(UCB) TO GET                         HOP01960
       CLA     2,4            BLOCK COUNT, GET -L(FDB)                  HOP01970
       LAC     PR29,4         TO PUT BLOCK COUNT                        HOP01980
       STA     -20,4          INTO WORD 21 OF FDB FOR LABEL ROUTINE.    HOP01990
       TSX     SNDAT,4       WRITE EOF ON FINAL                         HOP02000
       PZE     UCWIT,,WEF     OUTPUT TAPE.                              HOP02010
       TXH     0,0,0         EOT RETURN.                                HOP02020
       LAC     PR29,4        GET 4TH WORD OF FDB.  CONTAINS             HOP02030
       CAL     -3,4           LABEL CODE.                               HOP02040
       PAX     ,2                                                       HOP02050
       TXH     CL10,2,1      TRANSFER IF NO LABELS.                     HOP02060
       AXT     PTLOR,1                                                  HOP02070
       CLA     CL11                                                     HOP02080
       TPL     *+2           IF FINAL OUTPUT REEL,                      HOP02090
       AXT     PTLFR,1        SET CALLING SEQUENCE                      HOP02100
       CLA     PR29           FOR PREPARATION ROUTINE.                  HOP02110
       LXA     LAB03,4       IF INPUT LABEL WAS 20                      HOP02120
       TXH     *+3,4,19       WDS, SSM.                                 HOP02130
       STL     LABST                                                    HOP02140
       ZET     HYPSW         IS THIS UNIT HYPER.                        HOP02150
       SSM                   YES.  SET LABEL CS FOR 20 WD LABEL.        HOP02160
       CALL    LABEL         PREPARE LABEL.                             HOP02170
       PZE     UCWIT                                                    HOP02180
       STL     GENPR-4                                                  HOP02190
       ZET     HYPSW         IS THIS UNIT HYPER.                        HOP02200
       STL     LABST          YES. SET SW. TO WR 20 WD. TRAILER.        HOP02210
       TSX     LABRW,4       WRITE TRAILER LABEL.                       HOP02220
       IOSP    LAB03,,0                                                 HOP02230
       STZ     LABST          RESET SW.                                 HOP02240
 CL10  BSS     0                                                        HOP02250
 GATE1 TRA     *+1           GATE.  NEXT DONE ONLY ONCE.                HOP02260
       LXD     CHA02,4        NUMBER OF UNITS ASSIGNED FOR OUTPUT       HOP02270
       TXH     CL105,4,1      TEST FOR HIGHER THAN 1-WAY MERGE          HOP02280
       CLS     GATE2                                                    HOP02290
       STO     GATE2                                                    HOP02300
 CL105 BSS     0                                                        HOP02310
       SXD     CL113,4                                                  HOP02320
       TXI     *+1,4,-2                                                 HOP02330
       SXA     ORDPA,4        SAVE AS A PARAMETER.                      HOP02340
       STL     GATE1                                                    HOP02350
       CAL     PR16          COMPUTE BASE LOCATION OF                   HOP02360
       STA     LDQEN          OUTPUT TAPE TABLE.                        HOP02370
       ADD     K1                                                       HOP02380
       STA     CALEN                                                    HOP02390
 ORDPA AXT     **,4          MERGE ORDER MINUS 2.                       HOP02400
 CHGOR TXI     *+1,4,1       DECREMENT IS CLEARED IN CASE OF ISC,       HOP02410
       SXD     GOOUT,4        CAUSING 1 LESS TAPE TO BE ROTATED.        HOP02420
       AXT     1,4                                                      HOP02430
 CALEN CAL     **,4                                                     HOP02440
 LDQEN LDQ     **,4                                                     HOP02450
       STQ*    CALEN                                                    HOP02460
 GOOUT TXH     SLWEN,4,**                                               HOP02470
       TXI     LDQEN,4,1                                                HOP02480
 SLWEN SLW*    CALEN         TABLE IS ROTATED.                          HOP02490
 GATE2 TXL     ISCCK,0,0     GO TEST FOR INTER-SYSTEM                   HOP02500
 NOISC NZT     RELSW         TEST FOR REW OR RUN.                       HOP02510
       TRA     NOISR         RUN                                        HOP02520
       TSX     SNDAT,4       REWIND ONLY.                               HOP02530
       PZE     UCWIT,,REW                                               HOP02540
       TRA     *+3                                                      HOP02550
 NOISR TSX     SNDAT,4       REWIND AND UNLOAD.                         HOP02560
       PZE     UCWIT,,RUN                                               HOP02570
 CL11  TXH     CL1,0,0       A GATE.  TXL IF LAST OUTPUT REEL.          HOP02580
       TSX     SAVEW,4                                                  HOP02590
       CLS     K0            NOT LAST.  GO OPEN NEW INPUT FILE.         HOP02600
       STO     RAW00                                                    HOP02610
 CLCNT AXT     **,2          GET COUNT OF REELS DONE.                   HOP02620
       TXI     *+1,2,1                                                  HOP02630
 CL113 TXL     CL115,2,**                                               HOP02640
CL114  AXT     0,2           PRINT MESSAGE TO                           HOP02650
       CLA*    PR16           MAKE                                      HOP02660
       PAC     ,2             NEXT                                      HOP02670
       LDQ     0,2            UNIT                                      HOP02680
       TSX     MSGSUP,4,3     READY.                                    HOP02690
       PZE     CL270,,7+512*DBLSP                                       HOP02700
       TSX     MSGSUP,4,2                                               HOP02710
       PZE     1                                                        HOP02720
       PZE     CL271,,7+512*4                                           HOP02730
       TSX     (PAUSE,4                                                 HOP02740
 CL115 TSX     OPEN,4                                                   HOP02750
       TSX     RESTW,4                                                  HOP02760
       TRA     CL1            AND EXIT.                                 HOP02770
 ISCCK BSS     0                                                        HOP02780
       NZT     CHAPR-4       IS THE OUTPUT TO BE COMMUNICATED           HOP02790
       TRA     NOISC          TO ANOTHER SYSTEM WHICH FOLLOWS.          HOP02800
       TSX     SNDAT,4       YES.  REWIND ONLY,AND                      HOP02810
       PZE     UCWIT,,REW     SET PARAMETER FOR ROTATION OF             HOP02820
       SXD     CHGOR,0        1 LESS TAPE IN TABLE.                     HOP02830
       CLS     GATE2         SET GATE FOR NO MORE ENTRIES.              HOP02840
       STO     GATE2                                                    HOP02850
       TRA     CL11                                                     HOP02860
 UCWIT PZE                   UCB ADDRESS KEPT HERE.                     HOP02870
*  FILE TO BE CLOSED IS EXTERNAL SORT INPUT.                            HOP02880
 CL14  CAL*    PR14          GET L(UCB) AND SAVE.                       HOP02890
       TSX     OP400,4                                                  HOP02900
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP02910
       ALS     1                                                        HOP02920
       PBT                   IS THIS UNIT TO BE USED FOR MERGE.         HOP02930
       TRA     *+3           NO.                                        HOP02940
       ARS     1                                                        HOP02950
       STA     MRGSW         SAVE L(UCB) FOR FUTURE MERGE UNIT.         HOP02960
       NZT     OPENCL        IS THIS FILE ALREADY CLOSED.               HOP02970
       TRA     CL1           YES.  EXIT.                                HOP02980
       STZ     OPENCL        SET THIS FILE CLOSED.                      HOP02990
       LAC     PR20,4        PREPARE TO READ TRAILER LABEL, IF ONE.     HOP03000
       CLA     -3,4          GET LABEL INDICATOR.                       HOP03010
       PAX     ,1                                                       HOP03020
       NZT     OVFLS                                                    HOP03030
       TRA     CL15                                                     HOP03040
       TXH     CL15,1,1      TRANSFER IF NO LABEL.                      HOP03050
       CLA     (LTPOS        SAVE THE RECORD COUNT                      HOP03060
       STO     GEN07         FOR LABEL.                                 HOP03070
       CLA     -15,4         IF WORD 16 OF FILE DATA BLOCK IS           HOP03080
       TPL     *+2            MINUS, SET INDICATION THAT REELS          HOP03090
       STL     LABCTL         ARE UNDER LABEL CONTROL.                  HOP03100
       STL     GENPR-4                                                  HOP03110
 CL145 TSX     LABRW,4       READ TRAILER LABEL.                        HOP03120
       OCT     320000000000  NO EOF FOLLOWING.  ENABLE NCI.             HOP03130
       AXT     CTLSI,1                                                  HOP03140
       ZET     NOLAB                                                    HOP03150
       TRA     C178.0        IF LABEL WAS NOT READABLE, GIVE OPTION.    HOP03160
       CLA     PR20          GET L(FDB).                                HOP03170
       NZT     LAB20         WAS LABEL 14 WDS.                          HOP03180
       SSM                   NO. ASSUME THAT IT WAS 20.                 HOP03190
       CALL    LABEL         CHECK TRAILER LABEL.                       HOP03200
       PZE     UCWIT         INDIRECT ADDRESS OF L(UCB).                HOP03210
       TSX     OP220,2       TO BACKSPACE ROUTINE IF TROUBLE.           HOP03220
       PZE     CL145,,1      RETURN ADDRESS,,BACKSPACE 1 RECORD.        HOP03230
       STI     EOFEOR        SAVE 1ST WORD OF LABEL.                    HOP03240
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             HOP03250
       TRA     C178.4        YES.  GO SAVE INDICATION OF WHICH REEL.    HOP03260
 CL15  NZT     RELSW         TEST FOR REW AND RUN.                      HOP03270
       TRA     CL15R         RUN                                        HOP03280
       TSX     SNDAT,4       REWIND SORT                                HOP03290
       PZE     UCWIT,,REW     INPUT FILE.                               HOP03300
       TRA     *+3                                                      HOP03310
 CL15R TSX     SNDAT,4       REWIND AND UNLOAD                          HOP03320
       PZE     UCWIT,,RUN     INPUT FILE.                               HOP03330
       NZT     OVFLS                                                    HOP03340
       TRA     CL17                                                     HOP03350
       ZET     LABCTL        ARE REELS UNDER LABEL CONTROL.             HOP03360
       TRA     C178.6        YES.  CHECK FOR LAST REEL.                 HOP03370
       LAC     PR20,4        CHECK FOR MORE REELS.                      HOP03380
       CLA     -15,4         GET NO. OF INPUT REELS.                    HOP03390
       LAS     -21,4         COMPARE WITH NO. PROCESSED SO FAR.         HOP03400
       TRA     CL175         NOT THE LAST.                              HOP03410
*  NO MORE INPUT REELS FOR SORT.  PRINT MESSAGE AND EXIT FROM CLOSE.    HOP03420
 CL17  LDQ*    UCWIT                                                    HOP03430
       LXA     CLP4,4        GIVE FINAL REEL INDICATION TO              HOP03440
       STL     2,4            MAIN PROGRAM.                             HOP03450
       TSX     MSGSUP,4,5    IF HIST OPTION WAS SPECIFIED,PRINT UNIT XX HOP03460
       PZE     CL25,,4+512*DBLSP WAS FINAL REEL OF INPUT.               HOP03470
       NZT     MRGSW         IS AN INPUT UNIT TO BE USED FOR MERGE.     HOP03480
       TRA     CL1           NO.  EXIT.                                 HOP03490
       LDQ*    MRGSW         PRINT ''UNIT XX TO BE USED FOR MERGING.    HOP03500
       TSX     MSGSUP,4,3    LOAD THIS UNIT WITH SCRATCH TAPE.          HOP03510
       PZE     CL320,,5+512*SNGLS                                       HOP03520
       TSX     MSGSUP,4,2                                               HOP03530
       PZE     1                                                        HOP03540
       PZE     CL310,,6+512*DBLSP                                       HOP03550
       ZET     RELSW         WAS THIS REEL UNLOADED.  EXIT IF SO.       HOP03560
       TSX     (PAUSE,4      GIVE OPERATOR CHANCE TO CHANGE REELS.      HOP03570
       TRA     CL1           EXIT FROM CLOSE ROUTINE.                   HOP03580
 MRGSW PZE                   NZ=INPUT UNIT TO BE SED UN MERGE.          HOP03590
 CL175 LDQ*    UCWIT                                                    HOP03600
       TSX     MSGSUP,4,3    PRINT--UNIT XX...EOF SORT INPUT REEL.      HOP03610
       PZE     CL23,,6+512*SNGLS LOAD NEXT REEL ON''                    HOP03620
       LAC     PR14,4        SWITCH REELS IF MORE THAN 1 DRIVE.         HOP03630
       CLA     -1,4                                                     HOP03640
       TZE     CL176         NO SWITCH - ONLY 1 DRIVE.                  HOP03650
       LDQ     0,4                                                      HOP03660
       STQ     -1,4                                                     HOP03670
       STO     0,4                                                      HOP03680
       CAL     CNT19         SWITCH RELEASE BITS IN CASE INPUT       (7)HOP03681
       LGR     1              IS ON INTERSYSTEM RESERVE UNITS        (7)HOP03682
       STA     CNT19          THIS KEEPS RELEASE BITS                (7)HOP03683
       ZAC                    ASSOCIATED WITH THE PROPER UNITS       (7)HOP03684
       LGL     1                                                     (7)HOP03685
       ALS     1                                                     (7)HOP03686
       ORS     CNT19                                                 (7)HOP03687
       CLA     0,4                                                   (7)HOP03688
       LDQ     -1,4                                                  (7)HOP03689
       TSX     OP400,4       CHANGE L(UCW).                             HOP03690
 CL176 LDQ*    UCWIT                                                    HOP03700
       TSX     MSGSUP,4,3                                               HOP03710
       PZE     CL24,,2+512*DBLSP                                        HOP03720
       TRA     CL1                                                      HOP03730
C178.0 NZT     LABCTL        ARE REELS UNDER LABEL CONTROL.             HOP03740
       TRA     CL15          NO.  IGNORE FAILURE TO READ LABEL.         HOP03750
C178.2 LDQ*    UCWIT         PRINT- TRAILER LABEL UNREADABLE. IF MORE   HOP03760
       TSX     MSGSUP,4,3     INPUT REELS, SET SW3 DOWN.  IF NO MORE    HOP03770
       PZE     CL330,,6       REELS, PUT SS3 UP--PRESS START.           HOP03780
       TSX     MSGSUP,4,2                                               HOP03790
       PZE     1                                                        HOP03800
       PZE     CL340,,9+512*DBLSP                                       HOP03810
       TSX     C178.3,4                                                 HOP03820
       TRA     CL15          GO REWIND.                                 HOP03830
C178.3 SXA     SAVE4,4                                                  HOP03840
       TSX     (PAUSE,4                                                 HOP03850
       SWT     3                                                        HOP03860
       TRA     SETL          OPERATOR SAYS NO MORE REELS.               HOP03870
       TSX     MSGSUP,4,2    PRINT MESSAGE THAT                         HOP03880
       PZE     1             SWITCH 3 IS SET.                           HOP03890
       PZE     CL350,,3+512*DBLSP                                       HOP03900
       TRA     SAVE4                                                    HOP03910
SETL   TSX     MSGSUP,4,2    PRINT MESSAGE THAT SWITCH                  HOP03920
       PZE     1              3 IS UP.                                  HOP03930
       PZE     CL360,,3+512*DBLSP                                       HOP03940
       STL     LASTR         INDICATE NO MORE REELS OF INPUT.           HOP03950
SAVE4  AXT     **,4                                                     HOP03960
       TRA     1,4                                                      HOP03970
C178.4 CAL     EOFEOR        GET 1ST WORD FROM TRAILER LABEL.           HOP03980
       LAS     =H1EOF                                                   HOP03990
       TRA     *+2                                                      HOP04000
       TRA     SETLST        LABEL SAYS THIS IS LAST REEL.              HOP04010
       SUB     =H1EOR                                                   HOP04020
       TZE     CL15          IF LABEL IS UNREADABLE,                    HOP04030
       TRA     C178.2         GO GET CHOICE FROM OPERATOR.              HOP04040
C178.6 ZET     LASTR         IS THIS THE LAST REEL.                     HOP04050
       TRA     CL17          YES.                                       HOP04060
       TRA     CL175         NO.  PRINT NEXT LOAD MESSAGE.              HOP04070
SETLST STL     LASTR         SET LAST REEL INDICATOR.                   HOP04080
       TRA     CL15          GO REWIND.                                 HOP04090
LABCTL PZE                   SET NON-ZERO IF UNDER LABEL CONTROL.       HOP04100
LASTR  PZE                   SET NON-ZERO IF THIS IS LAST REEL.         HOP04110
EOFEOR PZE                   HOLDS 1ST WORD OF LABEL.                   HOP04120
*  UNIT TO BE CLOSED IS UNREADABLE RECORD AND CHECKPOINT TAPE.          HOP04130
       SPACE   1                                                        HOP04140
CL18   LXA     SYSCK2,4      IS THERE A SYSCK2.                         HOP04150
       TXL     CL1,4,0       EXIT IF NOT ATTACHED.                      HOP04160
       TSX     SNDAT,4       REWIND AND                                 HOP04170
       PZE     UNRT,,REW                                                HOP04180
       TRA     CL1           EXIT.                                      HOP04190
 CL23  BCI     6, EOF INPUT REEL.  LOAD NEXT REEL ON                    HOP04200
 CL24  BCI     2, .     *IN01                                           HOP04210
CL25   BCI     4, WAS FINAL REEL OF INPUT                               HOP04220
 CL260 BCI     6, CLOSING OUTPUT REEL NO.       *OU01                   HOP04230
 CL270 BCI     7, MAKE READY FOR NEXT OUTPUT REEL.    *OU02             HOP04240
 CL271 BCI     7, WHEN BLANK REEL IS LOADED, PRESS START.               HOP04250
 CL300 BCI     7, LOAD NEXT REEL OF MERGE FILE  XXXXX *MR02             HOP04260
 CL310 BCI     6, LOAD THIS UNIT WITH A SCRATCH TAPE.                   HOP04270
 CL320 BCI     5, TO BE USED FOR MERGING  *MR01                         HOP04280
 CL330 BCI     6, TRAILER LABEL UNREADABLE.    *IN02                    HOP04290
 CL340 BCI     9, IF LAST REEL,SET SS3 UP. IF NOT.SET SS3 DOWN.--START. HOP04300
 CL350 BCI     3, (SS3 IS SET DOWN)                                     HOP04310
 CL360 BCI     3, (SS3 IS SET UP)                                       HOP04320
 SDNL  EQU     1                                                        HOP04330
 SDNH  EQU     2                                                        HOP04340
 REW   EQU     3                                                        HOP04350
 RUN   EQU     4                                                        HOP04360
 BSR   EQU     5                                                        HOP04370
 BSF   EQU     6                                                        HOP04380
 WEF   EQU     7                                                        HOP04390
 DBLSP EQU     4                                                        HOP04400
       EJECT                                                            HOP04410
*  SORT FILE OPENING ROUTINE.                                           HOP04420
OPEN   SXA     OPN13,1       SAVE                                       HOP04430
       SXA     OPN15,2       INDEX                                      HOP04440
       SXA     OPN17,4       REGISTERS.                                 HOP04450
       CLA     RAW00         GET CALLING SEQUENCE WORD NO. 1.           HOP04460
       PDX     ,2            LOGICAL FILE NO.                           HOP04470
       TXL     OPN23,2,0     TRANSFER IF EXTERNAL INPUT OR OUTPUT FILE. HOP04480
       TXH     OPN57,2,-2    TRANSFER IF UNRT.  OTHERWISE, OPEN         HOP04490
*                             MERGE FILE.                               HOP04500
       EJECT                                                            HOP04510
*  FILE IS A MERGE FILE.                                                HOP04520
       TXI     *+1,2,-1                                                 HOP04530
       TMI     OPN21         MERGE FILE.  IS THIS OUTPUT.               HOP04540
       LDI     OPENCL        NO, INPUT. IS THIS FILE                    HOP04550
       CAL     K1             ALREADY OPENED.                           HOP04560
       ALS     15,2          TRANSFER TO EXIT IF                        HOP04570
       TIO     OPN13          IT IS.                                    HOP04580
       OAI                   SET THIS FILE OPENED.                      HOP04590
       STI     OPENCL                                                   HOP04600
       CLA*    PR15          GET L(UCB) AND SAVE.                       HOP04610
       TSX     OP400,4       IF FILE IS EXTERNAL MERGE INPUT,           HOP04620
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP04630
       TMI     OPN18          TRANSFER TO OPEN IT.                      HOP04640
*                                                                       HOP04650
*  FILE IS INTERNAL INTERMEDIATE INPUT.                                 HOP04660
       NZT     HYPSW         IF THIS IS 729, TRANSFER                   HOP04670
       TRA     OP120         AROUND THE FOLLOWING HYPER ROUTINE.        HOP04680
       ZET     RDBCK         IS READ BACKWARD REQUESTED.                HOP04690
       TRA     *+4           YES. TRANSFER. DO NOT REWIND.              HOP04700
       TSX     (NDATA,4      NO. REWIND                                 HOP04710
       PZE     UCWIT,,30     THIS HYPER UNIT.                           HOP04720
       TRA     OP123         GO TO READ HEADER.                         HOP04730
 OP122 STL     GENPR-4                                                  HOP04740
       TSX     LABRW,4       GO TO READ A TRAILER, EOF EXPECTED.        HOP04750
       OCT     240000000000  IT WILL BE READ BACKWARDS.                 HOP04760
       ZET     NOLAB                                                    HOP04770
       TRA     OP125                                                    HOP04780
       AXT     2,1           PREPARE CS TO CHECK INT. HEADER AS         HOP04790
       CALL    LABEL         MERGE TRAILER.                             HOP04800
       PZE     UCWIT                                                    HOP04810
       TSX     OP240,2       RETURN TO HERE MEANS LABEL MUST BE REREAD. HOP04820
       PZE     OP122,,2      SKIP ONE RECORD AND GO TO OP122 FOR RETRY. HOP04830
       LAC     UCWIT,2       NORMAL RETURN FOR LABEL.                   HOP04840
       CLA     3,2           PUT PROPER RECORD COUNT                    HOP04850
       STO     2,2            INTO UCW3.                                HOP04860
       TRA     OP125         GO TO EXIT.                                HOP04870
 OP120 TSX     (NDSLX,4      FILE IS INTERNAL 729.  SET DENSITY HIGH.   HOP04880
       PZE     UCWIT,,SDNH                                              HOP04890
       TSX     (NDSLX,4                                                 HOP04900
       PZE     UCWIT,,REW                                               HOP04910
 OP123 STL     GENPR-4                                                  HOP04920
       TSX     LABRW,4       READ HEADER LABEL, INTERNAL FILE.          HOP04930
       PZE                                                              HOP04940
       ZET     NOLAB                                                    HOP04950
       TRA     OP125                                                    HOP04960
       AXT     CHLMI,1       PREPARE CS FOR LABEL CHECK.                HOP04970
       CALL    LABEL         GO TO CHECK LABEL.                         HOP04980
       PZE     UCWIT                                                    HOP04990
       TSX     OP220,2       RETURN HERE MEANS READ LABEL AGAIN, I.E.,  HOP05000
       PZE     OP120,,2       BACKSPACE AND GO TO OP120.                HOP05010
 OP125 CLA     K1            INITIALIZE SEQUENCE                        HOP05020
       LDI     RAW01                                                    HOP05030
       ONT     =O777777777777                                           HOP05040
       STA*    UCWIT         COUNT.                                     HOP05050
       TRA     OP215         GO SET MODE BINARY.                        HOP05060
 OPN13 AXT     **,1          RELOAD                                     HOP05070
 OPN15 AXT     **,2           INDEX                                     HOP05080
 OPN17 AXT     **,4           REGISTERS                                 HOP05090
       STL     GENPR-5                                                  HOP05100
       TRA     1,4            AND EXIT.                                 HOP05110
       SPACE   2                                                        HOP05120
*  ROUTINE TO SET DENSITY HIGH OR LOW.                                  HOP05130
       SPACE   1                                                        HOP05140
 OP175 AXT     SDNL,1                                                   HOP05150
       ZET     HYPSW         IF HYPERTAPE,SKIP SETTING THE DENSITY      HOP05160
       TRA     1,2            AND RETURN.                               HOP05170
       NZT     -4,4                                                     HOP05180
       AXT     SDNH,1                                                   HOP05190
       SXD     *+2,1                                                    HOP05200
       TSX     (NDSLX,4                                                 HOP05210
       PZE     UCWIT,,**                                                HOP05220
       TRA     1,2                                                      HOP05230
       SPACE   1                                                        HOP05240
*  FILE IS EXTERNAL MERGE INPUT.                                        HOP05250
 OPN18 BSS     0                                                        HOP05260
       PDX     ,2                                                       HOP05270
       SXA     OPN76,2                                                  HOP05280
       PDC     ,1            PUT CORRECT-MODE ADDRESS IN                HOP05290
       TSX     SETMD,4        UCW4.                                     HOP05300
       TSX     SNDAT,4       GO TO SORT NON-DATA ROUTINE.               HOP05310
       PZE     UCWIT,,REW                                               HOP05320
       LAC     OPN76,4       SET LABEL DENSITY.                         HOP05330
       TSX     OP175,2                                                  HOP05340
       LAC     OPN76,4                                                  HOP05350
       CLA     -3,4                                                     HOP05360
       PAX     ,2                                                       HOP05370
       CAL     -21,4         UPDATE NO. OF INPUT                        HOP05380
       ADD     K1             REELS PROCESSED ON                        HOP05390
       STO     -21,4          THIS FILE.                                HOP05400
       TXH     OP186,2,1     SKIP NEXT IF NO LABELS.                    HOP05410
       SXA     LABTYP,2                                                 HOP05420
       TXH     *+2,2,0                                                  HOP05430
       STL     LABTYP                                                   HOP05440
 OP185 TSX     LABRW,4                                                  HOP05450
       OCT     020000000000  READ HEADER W/EOF AFTER.  ENABLE NCI.      HOP05460
       ZET     NOLAB                                                    HOP05470
       TRA     OP186                                                    HOP05480
       AXT     CHLEI,1       CHECK HEADER LABEL.                        HOP05490
       CAL     OPN76                                                    HOP05500
       NZT     LAB20         WAS LABEL 14 WDS.                          HOP05510
       SSM                   NO.  ASSUME THAT IT WAS 20.                HOP05520
       CALL    LABEL                                                    HOP05530
       PZE     UCWIT                                                    HOP05540
       TSX     OP220,2                                                  HOP05550
       PZE     OP185,,2                                                 HOP05560
       LAC     OPN76,2       UPDATE REEL                                HOP05570
       CAL     -7,2           SEQUENCE NO.                              HOP05580
       TZE     OP186          (ONLY IF NONZERO)                         HOP05590
       TSX     ADBCD1,4       BY 1.                                     HOP05600
       STQ     -7,2          PUT BACK INTO FILE BLOCK.                  HOP05610
 OP186 LAC     OPN76,4                                                  HOP05620
       TXI     *+1,4,-3                                                 HOP05630
       TSX     OP175,2       SET FILE DENSITY.                          HOP05640
       LAC     OPN76,4                                                  HOP05650
       CAL     -17,4         TEST FOR CHECKPOINT FILE.                  HOP05660
       CAS     K1                                                       HOP05670
       TRA     NCKPT         NONE.                                      HOP05680
       TRA     OP189         NONSTANDARD.                               HOP05690
 OP188 TXL     BYPAS,0,0     STANDARD.  BYPASS ON 1ST REEL.             HOP05700
 OP189 TSX     SAVEW,4       SKIP CHECKPOINT-FILE.                      HOP05710
       CAL     =O1000000                                                HOP05720
       STO     RAW01                                                    HOP05730
       TSX     SKIP,4                                                   HOP05740
 NCKPT TRA     OPN13                                                    HOP05750
 BYPAS CLS     OP188                                                    HOP05760
       STO     OP188                                                    HOP05770
       TRA     OPN13                                                    HOP05780
 OPN21 CLA*    PR16          THIS IS INTERMEDIATE OUTPUT FILE.  GET     HOP05790
       TSX     OP400,4       L(UCB) TO SET MODE AND DENSITY.            HOP05800
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP05810
       TSX     SNDAT,4        GO TO SORT NON-DATA TO REWIND AND THEN    HOP05820
       PZE     UCWIT,,REW     WRITE THE HEADER LABEL. REWIND HERE.      HOP05830
       TSX     SNDAT,4        SET DENSITY HIGH.                         HOP05840
       PZE     UCWIT,,SDNH                                              HOP05850
       AXT     PHLMO,1       PREPARE HEADER LABEL                       HOP05860
       CALL    LABEL          FOR INTERMEDIATE FILE.                    HOP05870
       PZE     UCWIT                                                    HOP05880
       STL     GENPR-4                                                  HOP05890
       TSX     LABRW,4       WRITE THE LABEL.                           HOP05900
       MZE                                                              HOP05910
       LAC     UCWIT,4       PUT UCW3 INTO UCW4                         HOP05920
       CLA     2,4            FOR RESTART PURPOSES.                     HOP05930
       STO     3,4                                                      HOP05940
 OP215 AXC     *,1           PUT BINARY MODE UNIT ADDRESS               HOP05950
       TSX     SETMD,4        IN UCW4.                                  HOP05960
       TRA     OPN13         EXIT.                                      HOP05970
       SPACE   1                                                        HOP05980
*  ROUTINE TO PUT CORRECT-MODE TAPE ADDRESS INTO UCW4.                  HOP05990
 SETMD LAC     UCWIT,2                                                  HOP06000
       ZET     HYPSW         IF HYPER, LEAVE UCW4 ALONE                 HOP06010
       TRA     1,4            AND EXIT.                                 HOP06020
       CAL     0,2                                                      HOP06030
       ZET     0,1           TEST FILE BLOCK MODE INDICATOR.            HOP06040
       ORA     =O20000000                                               HOP06050
       ARS     18                                                       HOP06060
       ANA     =O17777                                                  HOP06070
       STA     3,2                                                      HOP06080
       TRA     1,4                                                      HOP06090
       SPACE   3                                                        HOP06100
*  ROUTINE TO BACKSPACE FOR REREADING LABEL.  ENTER                     HOP06110
*   WITH TSX   OP220,2.  L(L(UCB)) IS IN -1,2 AND RETURN IS INDIRECT    HOP06120
*   ADDRESS GIVEN IN 1,2.  NO. OF RECORDS TO BACKSPACE IN DECR(1,2).    HOP06130
       SPACE                                                            HOP06140
 OP220 CAL     -1,2          INITIALIZE CALLING SEQUENCE WITH           HOP06150
       STA     OP222          L(L(UCB)).                                HOP06160
       CLA     1,2           GET NO. OF RECORDS TO BACKSPACE            HOP06170
       PDX     ,1             AND PLACE IN IR1.                         HOP06180
       TXL     OP223,1,0                                                HOP06190
 OP221 TSX     SNDAT,4       GO TO BACKSPACE RECORD.                    HOP06200
 OP222 PZE     **,,BSR                                                  HOP06210
       TIX     OP221,1,1     DO AS MANY AS REQUESTED.                   HOP06220
 OP223 TRA*    1,2           RETURN.                                    HOP06230
       SPACE   1                                                        HOP06240
*  ROUTINE TO SKIP FORWARD FOR REREADING A LABEL THAT WAS               HOP06250
*   ORIGINALLY READ BACKWARDS. ENTRY IS THE SAME AS ABOVE.              HOP06260
       SPACE   1                                                        HOP06270
 OP240 CAL     -1,2          INITIALIZE CALL SEQ. WITH                  HOP06280
       STA     OP244         L(L(UCB).                                  HOP06290
       CLA     1,2                                                      HOP06300
       PDX     ,1            PUT NUMBER OF RECORDS TO SKIP IN IR1.      HOP06310
       TXL     OP246,1,0                                                HOP06320
 OP242 TSX     (NDATA,4      GO TO SKIP RECORDS                         HOP06330
 OP244 PZE     **,,36        ON HYPER.                                  HOP06340
       ZET     EFETS         IF THERE WAS NO EOF MARK SKIP ONLY ONCE.   HOP06350
       TIX     OP242,1,1     DO AS MANY AS REQUESTED.                   HOP06360
 OP246 TRA*    1,2           RETURN.                                    HOP06370
       SPACE   1                                                        HOP06380
*  ROUTINE TO CHECK IF A UNIT IS HYPERTAPE.                             HOP06390
       SPACE   1                                                        HOP06400
 TESHY LDI*    UCWIT         PUT FIRST WORD OF UCB IN INDS.             HOP06410
       STZ     HYPSW         IF THIS UNIT IS NOT 729                    HOP06420
       LNT     000200        IT IS ASSUMED TO BE HYPER, AND             HOP06430
       STL     HYPSW         THIS SWITCH IS SET TO NON-ZERO.            HOP06440
       TRA     1,4                                                      HOP06450
 HYPSW PZE                   HYPER SWITCH.  NON-ZERO IF HYPER.          HOP06460
       SPACE   1                                                        HOP06470
       EJECT                                                            HOP06480
*  FILE IS EITHER SORT INPUT OR FINAL OUTPUT.                           HOP06490
 OPN23 TPL     OPN43         EXTERNAL FILE.  IS IT INPUT.               HOP06500
 OPN24 TRA     *+1                                                      HOP06510
*                            NO, OUTPUT.  SET UP FINAL OUTPUT REFERENCE HOP06520
       CAL     CHA01          CELL.  IF CHA04 INDICATES THAT            HOP06530
       LDQ     CHA02                                                    HOP06540
       TZE     OPN25          OUTPUT IS ON SYMBOLIC CHANNEL, DO         HOP06550
       NZT     CHA04          NOT CHANGE CHA02.  USE MERGE CHANNEL      HOP06560
       XCL                                                              HOP06570
       SLW     CHA01                                                    HOP06580
       STQ     CHA02                                                    HOP06590
 OPN25 STL     OPN24                                                    HOP06600
       CLA*    CHA02         GET TAPE IN NO. 1 POSITION.                HOP06610
       SPACE   1                                                        HOP06620
*  EXTERNAL OUTPUT FILE HAS BEEN FOUND.  CONTINUE OPENING WITH REWIND.  HOP06630
       SPACE   1                                                        HOP06640
       TSX     OP400,4       INITIALIZE L(UCB) FOR NDATA.               HOP06650
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP06660
       TSX     SNDAT,4       GO TO REWIND AN OUTPUT TAPE.               HOP06670
       PZE     UCWIT,,REW                                               HOP06680
       LAC     PR29,4        SET LABEL                                  HOP06690
       TSX     OP175,2        DENSITY.                                  HOP06700
       LAC     PR29,4                                                   HOP06710
       NZT     -10,4         IS DICTIONARY SPECIFIED FOR OUTPUT.        HOP06720
       STZ     OP800         NO.  SET NO-DICTIONARY SWITCH.             HOP06730
       CLA     -3,4                                                     HOP06740
       PAX     ,2                                                       HOP06750
       TXH     OP295,2,1     SKIP LABELING.                             HOP06760
       TXH     *+2,2,0       IF STD. LABEL, SET SWITCH                  HOP06770
       STL     LABST          TO NON-ZERO.                              HOP06780
       LXA     K1,4                                                     HOP06790
       NZT     HYPSW    IF HYPER,                                       HOP06800
       LXD     K0,4           TELL LABEL ROUTINE THAT IT IS.            HOP06810
       SXD     LAB01,4                                                  HOP06820
       AXT     PHLFO,1                                                  HOP06830
 OP270 CAL     PR29                                                     HOP06840
       LXA     LAB03,4       IF INPUT LABEL WAS 20                      HOP06850
       TXH     *+2,4,19      WDS, SSM.                                  HOP06860
       ZET     HYPSW         IS THIS UNIT HYPER.                        HOP06870
       SSM                   YES.  SET LABEL CS FOR 20 WD LABEL.        HOP06880
       CALL    LABEL         PREPARE HEADER LABEL FOR FINAL OUTPUT.     HOP06890
       PZE     UCWIT                                                    HOP06900
       CAL     *                                                        HOP06910
       ZET     OP800         ARE THERE DICTIONARIES.                    HOP06920
       ALS     3                YES. SET NO EOF AFTER LABEL.            HOP06930
       STP     OP294                                                    HOP06940
       STL     GENPR-4                                                  HOP06950
       TSX     LABRW,4       WRITE HEADER LABEL.                        HOP06960
 OP294 PZE     LAB03         POINT TO WORD CONTAINING LENGTH.           HOP06970
       STZ     LABST          RESET SW.                                 HOP06980
 OP295 NZT     OP800         ARE THERE DICTIONARIES.                    HOP06990
       TRA     OP300          NO.  SKIP DICTIONARY RETRIEVE.            HOP07000
       STZ     OP800         RESET DICTIONARY INDICATION FOR FUTURE REELHOP07010
       TSX     SNDAT,4       REWIND CKPT TAPE.                          HOP07020
       PZE     SYSCK2,,REW                                              HOP07030
       AXT     -1,4          POSITION CKPT TAPE AFTER 2ND FILE.         HOP07040
       SXD     RAW00,4       SET CALLING SEQ. TO SKIP 2                 HOP07050
       CLA     =O2000000      FILES ON CKPT TAPE.                       HOP07060
       SLW     RAW01                                                    HOP07070
       TSX     SKIP,4         SKIP THE TWO FILES.                       HOP07080
       STL     GENPR-4                                                  HOP07090
       TSX     DCTNY,4       RETRIEVE DICTIONARY RECORDS.               HOP07100
       PZE     SYSCK2,,UCWIT                                            HOP07110
 OP300 LAC     PR29,1        PUT CORRECT-MODE UNIT ADDRESS              HOP07120
       TSX     SETMD,4        INTO UCW4.                                HOP07130
       LAC     PR29,4                                                   HOP07140
 OP320 TXI     *+1,4,-3                                                 HOP07150
       TSX     OP175,2       SET FILE DENSITY.                          HOP07160
       TRA     OPN13         EXIT.                                      HOP07170
       SPACE   1                                                        HOP07180
*                                                                       HOP07190
*  ROUTINE TO WAIT FOR COMPLETION OF ACTIVITY.                          HOP07200
 OP400 SXA     OP405,4                                                  HOP07210
       STA     UCWIT         SAVE L(UCW).                               HOP07220
       PAI                                                              HOP07230
       RIS     =O677777777777                                           HOP07240
       STI     RELSW         SAVE RELEASE INDICATOR.                    HOP07250
       PAC     ,4                                                       HOP07260
       ZET     1,4           TEST UCW2 FOR ZERO.                        HOP07270
       TRA     *-1           UNIT IS BUSY.                              HOP07280
 OP405 AXT     **,4                                                     HOP07290
       STL     GENPR-5                                                  HOP07300
       TRA     1,4                                                      HOP07310
 RELSW PZE                   RELEASE SWITCH IN PREFIX                   HOP07320
       SPACE   2                                                        HOP07330
*  CALLING SEQUENCE SAYS TO OPEN AN INPUT FILE.                         HOP07340
 OPN43 CAL*    PR14          GET L(UCB) FOR INPUT FILE.                 HOP07350
       TSX     OP400,4       SET UP FOR REWIND.                         HOP07360
       ZET     OPENCL        IS THIS FILE ALREADY OPENED.               HOP07370
       TRA     OPN13         YES-EXIT.                                  HOP07380
       STL     OPENCL        SET THIS FILE OPENED.                      HOP07390
       TSX     TESHY,4       GO TO TEST IF UNIT IS HYPER.               HOP07400
       TSX     SNDAT,4       GO TO SORT NON-DATA ROUTINE                HOP07410
       PZE     UCWIT,,3       TO REWIND THIS TAPE.                      HOP07420
 OP435 LAC     PR20,4                                                   HOP07430
       CAL     -3,4          GET LABEL INDICATOR FROM FILE BLOCK        HOP07440
       PAX     ,2             TO ASK WHETHER LABELS OR NOT.             HOP07450
       TXH     OPN45,2,1     TRANSFER AROUND FOLLOWING IF NO LABEL.     HOP07460
       SXA     LABTYP,2                                                 HOP07470
       TXH     *+2,2,0                                                  HOP07480
       STL     LABTYP                                                   HOP07490
       PXD     ,0                                                       HOP07500
       ZET     OVEPR         IF THIS IS OVERFLOW SORT, THIS             HOP07510
       TRA     OP441          CANNOT BE THE 1ST REEL.                   HOP07520
       ZET     -10,4         TEST FOR DICTIONARIES.                     HOP07530
 OP440 CAL     OP320         GET PREFIX OF 1.                           HOP07540
 OP441 STP     OP445                                                    HOP07550
       TSX     OP175,2       SET LABEL DENSITY.                         HOP07560
       STL     GENPR-4                                                  HOP07570
       TSX     LABRW,4       READ HEADER LABEL.                         HOP07580
 OP445 OCT     020000000000  ENABLE NCI.                                HOP07590
       ZET     NOLAB                                                    HOP07600
       TRA     OP447                                                    HOP07610
       AXT     CHLSI,1                                                  HOP07620
       CLA     PR20          GET FDB ADDRESS FOR LABEL CHECK.           HOP07630
       NZT     LAB20         WAS LABEL 14 WDS.                          HOP07640
       SSM                   NO. ASSUME THAT IT WAS 20.                 HOP07650
       CALL    LABEL         CHECK LABEL JUST READ.                     HOP07660
       PZE     UCWIT                                                    HOP07670
       TSX     OP220,2       RETURN HERE IF TROUBLE.                    HOP07680
       PZE     OP435,,2      BACKSPACE AND GO TO OP435.                 HOP07690
 OP447 AXT     K0,4          LABELS FINISHED.  SET NO DICTIONARY        HOP07700
       SXA     OP440,4        HEREAFTER.                                HOP07710
 OPN45 LAC     PR20,1                                                   HOP07720
       TSX     SETMD,4                                                  HOP07730
       LAC     PR20,4                                                   HOP07740
       CAL     -7,4          GET REEL SEQUENCE NO.                      HOP07750
       TZE     OP453         IF ZERO, MUST REMAIN SO.                   HOP07760
       TSX     ADBCD1,4      ADD 1.                                     HOP07770
       LAC     PR20,4        PUT NEW SEQUENCE NUMBER                    HOP07780
       STQ     -7,4           INTO FILE DATA BLOCK.                     HOP07790
 OP453 CAL     -21,4         UPDATE NUMBER OF                           HOP07800
       ADD     K1             REELS PROCESSED                           HOP07810
       STO     -21,4          BY ONE.                                   HOP07820
       PAX     ,2            KEEP THIS REEL NUMBER IN IR2.              HOP07830
       CLA     -17,4         CKPT INDICATOR TO AC.                      HOP07840
       PAX     ,1            CKPT INDICATOR TO IR1.                     HOP07850
       TXI     *+1,1,-2      -2, STANDARD. -1, NONSTANDARD. 0, NONE.    HOP07860
       ZET     OVEPR         SKIP IF NOT OVERFLOW SORT.                 HOP07870
       TRA     OP455         OVERFLOW SORT.                             HOP07880
       TXH     OP485,2,1     TRANSFER IF NOT 1ST REEL.                  HOP07890
       ZET     -10,4         1ST REEL.  TEST FOR DICTIONARY.            HOP07900
       TRA     OP560         YES.  GO SAVE DICTIONARY.                  HOP07910
 OP455 TXL     OP480,1,-2    TRANSFER IF NOT NON-STANDARD CKPT.         HOP07920
 OP456 LAC     PR20,4                                                   HOP07930
       TXI     *+1,4,-3                                                 HOP07940
       TSX     OP175,2       SET FILE DENSITY.                          HOP07950
       CAL     =O1000000      SET UP TO SKIP CKPT FILE.                 HOP07960
       STO     RAW01                                                    HOP07970
       STZ     RAW00                                                    HOP07980
       TSX     SKIP,4         SKIP CKPT FILE.                           HOP07990
 OP480 LAC     PR20,4                                                   HOP08000
       TXI     *+1,4,-3                                                 HOP08010
       TSX     OP175,2       SET FILE DENSITY.                          HOP08020
       LXA     OVEPR,4       GET OVERFLOW SWITCH (CONTAINS SKIP NO.).   HOP08030
       PXA     ,4                                                       HOP08040
       STO     RAW01                                                    HOP08050
       TSX     SKIP,4         SKIP N RECORDS FOR OVERFLOW.              HOP08060
       STZ     OVEPR                                                    HOP08070
       TRA     OPN13                                                    HOP08080
 OP485 TXL     OP480,1,0     TRANSFER IF NO CKPT.                       HOP08090
       TRA     OP456         SKIP CKPT FILE.                            HOP08100
       SPACE                                                            HOP08110
ADBCD1 LGR     6             SUBROUTINE TO                              HOP08120
       AXT     5,1            ADD BCD 1                                 HOP08130
       ADD     K1             TO REEL SEQUENCE                          HOP08140
AD101  PAI                    NUMBER IN                                 HOP08150
       RNT     12             ACCUMULATOR,                              HOP08160
       TRA     *+2            LEAVING THE                               HOP08170
       ADD     =54            NEW NUMBER                                HOP08180
       LGR     6              IN THE MQ.                                HOP08190
       TIX     AD101,1,1                                                HOP08200
       TRA     1,4           END OF SUBROUTINE TO ADD BCD 1.            HOP08210
       SPACE   1                                                        HOP08220
*  COME HERE TO SAVE DICTIONARY RECORDS FROM INPUT TAPE.  SAVED         HOP08230
*   ON UNREADABLE RECORD TAPE.                                          HOP08240
       SPACE   1                                                        HOP08250
 OP560 ZET     CHAPR-5       IS THERE AN UNREADABLE RECORD TAPE.        HOP08260
       TRA     OP565          NO.  SKIP, PRINT MESSAGE + GO ON.         HOP08270
       STL     OP800         SET DICTIONARY SWITCH YES.                 HOP08280
       STL     GENPR-4                                                  HOP08290
       TSX     DCTNY,4       SAVE DICTIONARY RECORDS ON                 HOP08300
       PZE     UCWIT,,UNRT    UNRT.                                     HOP08310
       TRA     OP480         RETURN TO FINISH OPENING INPUT FILE.       HOP08320
       SPACE   1                                                        HOP08330
*  NO CKPT TAPE.  DELETE DICTIONARIES BY SKIPPING 1 FILE,               HOP08340
*   PRINT MESSAGE TO THIS EFFECT, AND CONTINUE OPENING INPUT FILE.      HOP08350
       SPACE   1                                                        HOP08360
 OP565 STZ     RAW00                                                    HOP08370
       CAL     =O1000000                                                HOP08380
       STO     RAW01                                                    HOP08390
       TSX     SKIP,4         SKIP 1 FILE ON INPUT TAPE.                HOP08400
       LDQ*    UCWIT                                                    HOP08410
       TSX     MSGSUP,4,3    PRINT DICTIONARY DELETION MESSAGE.         HOP08420
       PZE     OPM01,,4+512*DBLSP                                       HOP08430
       TRA     OP480         COMPLETE OPENING THE INPUT FILE.           HOP08440
 OPM01 BCI     4, ,DICT'ARY FILE DELETED.                               HOP08450
       EJECT                                                            HOP08460
*  THIS IS UNRT TO BE OPENED.  TEST IF THERE, THEN REWIND.              HOP08470
       SPACE   1                                                        HOP08480
OPN57  LXA     SYSCK2,4      IS THERE A SYSCK2.                         HOP08490
       TXL     OPN13,4,0     EXIT IF NOT ATTACHED.                      HOP08500
       STZ     RESSW                                                    HOP08510
       TMI     *+2           TRANSFER IF NORMAL OPEN.                   HOP08520
       STL     RESSW         SET OPEN-FOR-RESTART SWITCH.               HOP08530
       CLA     UNRT                                                     HOP08540
       TSX     OP400,4                                                  HOP08550
       TSX     TESHY,4                                                  HOP08560
       TSX     SNDAT,4       REWIND                                     HOP08570
       PZE     SYSCK2,,REW    SYSCK2.                                   HOP08580
       ZET     RESSW         IS THIS OPEN FOR RESTART.                  HOP08590
       TRA     REOPN         YES.                                       HOP08600
       AXT     PHLUR,1                                                  HOP08610
       CALL    LABEL         GO TO PREPARE LABEL.                       HOP08620
       PZE     UNRT                                                     HOP08630
       STL     GENPR-4                                                  HOP08640
       TSX     LABRW,4       WRITE HEADER ON UNRT.                      HOP08650
       IOCP    0,,0                                                     HOP08660
       ZET     OPTPR-2       IS NO-CKPT OPTION SPECIFIED.               HOP08670
       TRA     OP573         YES. NO DUMMY CKPT.  JUST WRITE AN EOF.    HOP08680
       AXT     TRACY,4       WRITE A DUMMY CHECKPOINT FILE.             HOP08690
       PXD     ,4                                                       HOP08700
       LAC     UCWIT,4                                                  HOP08710
       SSM                                                              HOP08720
       STO     1,4                                                      HOP08730
       TSX     (ACTVX,4                                                 HOP08740
       PZE     UCWIT                                                    HOP08750
       NZT     RENEE                                                    HOP08760
       TRA     *-1                                                      HOP08770
       ZET     EOTI                                                     HOP08780
       TRA     OP580-1                                                  HOP08790
 OP573 TSX     SNDAT,4       WRITE EOF.                                 HOP08800
       PZE     UNRT,,WEF                                                HOP08810
       TRA     OP580         EOT.                                       HOP08820
       TSX     SNDAT,4       WRITE DUMMY DICTIONARY                     HOP08830
       PZE     UNRT,,WEF      FILE.                                     HOP08840
       TRA     OP580         EOT RETURN.                                HOP08850
       LAC     PR20,4        IS THERE A DICTIONARY ON THE               HOP08860
       ZET     -10,4          INPUT TAPE.                               HOP08870
       TRA     OP575         YES.  MERELY BACKSPACE FILE, POSITIONING   HOP08880
       TSX     SNDAT,4        UNRT IN DICTIONARY FILE.                  HOP08890
       PZE     UNRT,,REW     NO.  REWIND UNRT.                          HOP08900
       TRA     OPN13         EXIT.                                      HOP08910
 OP575 TSX     SNDAT,4       BACKSPACE FILE.                            HOP08920
       PZE     UNRT,,BSF                                                HOP08930
       TRA     OPN13         EXIT.                                      HOP08940
       STZ     EOTI                                                     HOP08950
 OP580 LDQ*    UCWIT                                                    HOP08960
       TSX     MSGSUP,4,3                                               HOP08970
       PZE     OPM02,,5+512*DBLSP                                       HOP08980
       TSX     SNDAT,4                                                  HOP08990
       PZE     UNRT,,RUN                                                HOP09000
       CLA     RAW00                                                    HOP09010
       TRA     OPN57                                                    HOP09020
 REOPN STL     GENPR-4       FOOTPRINTS.                                HOP09030
       TSX     LABRW,4       READ UNRT HEADER LABEL.                    HOP09040
       PZE                                                              HOP09050
       ZET     NOLAB                                                    HOP09060
       TRA     OPN13         EXIT IF NO LABEL TO BE CHECKED.            HOP09070
       AXT     CHLUR,1       SET UP TO CHECK LABEL.                     HOP09080
       STL     GENPR-4                                                  HOP09090
       CALL    LABEL         CHECK LABEL.                               HOP09100
       PZE     UNRT                                                     HOP09110
       TSX     OP220,2       RETURN HERE IF UNACCEPTABLE.               HOP09120
       PZE     REOPN,,2                                                 HOP09130
       TRA     OPN13         RETURN HERE IF ACCEPTED.                   HOP09140
 RESSW PZE                   OPEN-FOR-RESTART SWITCH.                   HOP09150
 TRACY SXA     MARGE,4                                                  HOP09160
       SXA     JOYCE,1                                                  HOP09170
       PAC     ,2                                                       HOP09180
       ZET     HYPSW         IS THIS UNIT HYPER.                        HOP09190
       TRA     UNHYP         YES.  TRANSFER TO HYPER SEL PLUS.          HOP09200
       TMI     DMCPM                                                    HOP09210
       CLA     0,2                                                      HOP09220
 POINT PDX     IORT,4                                                   HOP09230
       SXA     WRS,4                                                    HOP09240
       CLA     POINT                                                    HOP09250
       STA*    (RCHXI                                                   HOP09260
 WRS   WRS     **                                                       HOP09270
       XEC*    (RCHXI                                                   HOP09280
       STZ     RENEE                                                    HOP09290
 PEGGY AXT     **,4                                                     HOP09300
 JOYCE AXT     **,1                                                     HOP09310
 IORT  IORT    0,,4096                                                  HOP09320
       TRA     1,4                                                      HOP09330
 DMCPM LFT     200000        TEST FOR EOT                               HOP09340
       TRA     ENDTP         EOT                                        HOP09350
 COUNT AXT     **,4                                                     HOP09360
       TXI     *+1,4,1                                                  HOP09370
       TXL     AGAIN,4,9                                                HOP09380
 DONE  SXA     COUNT,0                                                  HOP09390
       STZ     1,2                                                      HOP09400
       STL     RENEE                                                    HOP09410
       TRA     PEGGY                                                    HOP09420
 AGAIN SXA     COUNT,4                                                  HOP09430
       TRA     PEGGY                                                    HOP09440
 ENDTP STL     EOTI                                                     HOP09450
       TRA     DONE                                                     HOP09460
 RENEE PZE                   COMPLETION SWITCH.                         HOP09470
 EOTI  PZE                   END OF TAPE INDICATOR.                     HOP09480
 MARGE EQU     PEGGY                                                    HOP09490
 OPM02 BCI     5, (UNRT) EOT. CHANGE TAPE *CK01                         HOP09500
 OPN76 PZE     **,,**        CALLING SEQUENCE WORD FOR LABEL ROUTINE.   HOP09510
*   HYPER SELECT PLUS                                                   HOP09520
 UNHYP TMI     UNHYM         IF MINUS TRA TO HYPER SEL MINUS.           HOP09530
       CLA     0,2           GET UCW1.                                  HOP09540
       ANA     MASK1         GET INTERFACE AND UNIT NUMBER.             HOP09550
       PAI                                                              HOP09560
       ANA     MASK2         GET ONLY UNIT NUMBER                       HOP09570
       ORA     MASK3         AND INSERT ORDERS.                         HOP09580
       STO     UNWOR                                                    HOP09590
       PIA                   RETRIEVE THE INTERFACE BIT,                HOP09600
       ARS     23            BIT 12, AND SHIFT IT TO 35.                HOP09610
       ADM     UNSMS         ADM THE STANDARD SMS                       HOP09620
       SSM                                                              HOP09630
       STO     UNCOM                                                    HOP09640
       CLA     *-1                                                      HOP09650
       STA*    (RCHXI                                                   HOP09660
       XEC*    (RCHXI        START THE CHANNEL.                         HOP09670
       STZ     RENEE                                                    HOP09680
       TRA     PEGGY                                                    HOP09690
 UNCOM SMS     0                                                        HOP09700
       CTLW    UNWOR                                                    HOP09710
       CPYD    0,,1024                                                  HOP09720
       TCH     SYSTWT                                                   HOP09730
 UNWOR PZE                   ORDER AREA.                                HOP09740
 UNSMS SMS     0             STANDARD SMS.                              HOP09750
*  HYPER SELECT MINUS.                                                  HOP09760
 UNHYM LNT     001000        TEST IF UNUSUAL END.                       HOP09770
       TRA     COUNT         IF NOT, TRANSFER.                          HOP09780
       RFT     000004        TEST IF IN EWA.                            HOP09790
       TRA     ENDTP         YES.                                       HOP09800
       TRA     COUNT         GO ON ANYWAY.                              HOP09810
       EJECT                                                            HOP09820
*  DICTIONARY SAVE AND RETRIEVE.                                        HOP09830
       SPACE   1                                                        HOP09840
 DCTNY SXA     DSVE4,4                                                  HOP09850
       SXA     DSVE2,2                                                  HOP09860
       SXA     DSVE1,1                                                  HOP09870
       CLA     1,4           SAVE L(UCB) FOR                            HOP09880
 SLUCW PAC     ,4             INPUT AND                                 HOP09890
 DCTCT PDC     ,2             OUTPUT.                                   HOP09900
       CLA     0,4                                                      HOP09910
       STA     INDCT                                                    HOP09920
       CLA     0,2                                                      HOP09930
       STA     OUDCT                                                    HOP09940
       SXA     DCTCT,0       CLEAR COUNT.                               HOP09950
       STL     DICTS         SET DICTIONARY SWITCH.                     HOP09960
       LXA     UCWIT,4       SAVE L(UCW) FOR CURRENT                    HOP09970
       SXA     SLUCW,4        SORT TAPE.                                HOP09980
 DBGIO LXA     INDCT,4       SET UP FOR READ.                           HOP09990
       SXA     UCWIT,4                                                  HOP10000
       STL     GENPR-4                                                  HOP10010
       TSX     LABRW,4       READ DICTIONARY RECORD.                    HOP10020
       TXI     DEOFR,0,0     EOF RETURN AND CALLING SEQUENCE.           HOP10030
       LXA     DCTCT,4       UPDATE COUNT OF DICTIONARY RECORDS         HOP10040
       TXI     *+1,4,1        READ.                                     HOP10050
       SXA     DCTCT,4                                                  HOP10060
       LXA     OUDCT,4       SET UP FOR WRITE.                          HOP10070
       SXA     UCWIT,4                                                  HOP10080
       STL     GENPR-4                                                  HOP10090
       TSX     LABRW,4       WRITE DICTIONARY RECORD.                   HOP10100
       TXL     DEOTR,0,0     EOT RETURN AND CALLING SEQUENCE.           HOP10110
       TRA     DBGIO         RETURN FOR MORE.                           HOP10120
       SPACE   1                                                        HOP10130
*  END OF FILE READING DICTIONARY RECORDS.  POLISH OFF WITH EOF AND     HOP10140
*   MESSAGE.                                                            HOP10150
 DEOFR TSX     SNDAT,4       EOF HAS BEEN READ ON INPUT. WEF ON OUTPUT. HOP10160
       PZE     OUDCT,,WEF                                               HOP10170
       TRA     DEOTR         EOT RETURN.                                HOP10180
       TSX     SNDAT,4                                                  HOP10190
       PZE     UNRT,,REW                                                HOP10200
       CLA     DCTCT         CONVERT COUNT OF DICTIONARY RECORDS.       HOP10210
       TSX     (DECVA,4       TRANSFERRED AND INSERT                    HOP10220
       STQ     DMS01          IN MESSAGE.                               HOP10230
       TSX     MSGSUP,4,4    IF HIST OPTION, PRINT MESS. --XXXXX DICT.  HOP10240
       PZE     1              RECORDS TRANSFERRED FROM UNIT XX          HOP10250
       PZE     DMS01,,7       TO UNIT XX AND EOF WRITTEN.''             HOP10260
       LDQ*    INDCT                                                    HOP10270
       TSX     MSGSUP,4,5                                               HOP10280
       PZE     DMS02,,1                                                 HOP10290
       LDQ*    OUDCT                                                    HOP10300
       TSX     MSGSUP,4,5                                               HOP10310
       PZE     DMS03,,3+512*DBLSP                                       HOP10320
NOPRT  BSS     0                                                        HOP10330
       STZ     DICTS         CLEAR DICTIONARY ACTIVITY SWITCH.          HOP10340
       LXA     SLUCW,4        RESTORE L(UCW) FOR                        HOP10350
       SXA     UCWIT,4        CURRENT SORT TAPE,                        HOP10360
 DSVE4 AXT     **,4           EXIT.                                     HOP10370
 DSVE2 AXT     **,2                                                     HOP10380
 DSVE1 AXT     **,1                                                     HOP10390
       STL     GENPR-5                                                  HOP10400
       TRA     2,4                                                      HOP10410
       SPACE   1                                                        HOP10420
*  END OF TAPE ON DICTIONARY WRITE.  PRINT MESSAGE AND RESTART.         HOP10430
       SPACE   1                                                        HOP10440
 DEOTR LDQ*    OUDCT         PRINT ''UNIT XX, EOT WRITING DICT-         HOP10450
       TSX     MSGSUP,4,3     IONARIES. CHANGE TAPE, PRESS              HOP10460
       PZE     DMS04,,6       START FOR RESTART.''                      HOP10470
       TSX     MSGSUP,4,2                                               HOP10480
K1     PZE     1                                                        HOP10490
       PZE     DMS05,,7+512*DBLSP                                       HOP10500
       TSX     SNDAT,4                                                  HOP10510
(NDLSX EQU     (NDSLX                                                   HOP10520
       PZE     OUDCT,,RUN                                               HOP10530
       TSX     (PAUSE,4                                                 HOP10540
       STL     GENPR-4                                                  HOP10550
       CALL    RESTAR        GO TO RESTART.                             HOP10560
 INDCT PZE                   L(UCB) FOR DICTIONARY INPUT UNIT.          HOP10570
 OUDCT PZE                   L(UCB) FOR DICTIONARY OUTPUT UNIT.         HOP10580
 DICTS PZE                   DICTIONARY SWITCH.                         HOP10590
 DMS01 BCI     7,       DICTIONARY RECORDS TRANSFERRED FROM             HOP10600
 DMS02 BCI     1, TO                                                    HOP10610
 DMS03 BCI     3, AND EOF WRITTEN.                                      HOP10620
 DMS04 BCI     6, ,EOT WRITING DICTIONARIES.  *CK02                     HOP10630
 DMS05 BCI     7, CHANGE TAPE, PRESS START FOR RESTART.                 HOP10640
       EJECT                                                            HOP10650
*  LABEL READ-WRITE ROUTINE.                                            HOP10660
*  UTILIZES TRAPS VIA IOEX.                                             HOP10670
*  CALLING SEQUENCE IS   TSX  LABRW,4                                   HOP10680
*                        P                                              HOP10690
*  P CONSISTS OF 5 BITS.  BIT S ON MEANS                                HOP10700
*  LABEL WRITE, OFF MEANS READ.  BIT 1 ON                               HOP10710
*  MEANS TRAILER LABEL, OFF MEANS HEADER.                               HOP10720
*  BIT 2 ON MEANS NO EOF AFTER THE LABEL,                               HOP10730
*  OFF MEANS EOF EXPECTED (READ) OR TO BE                               HOP10740
*  WRITTEN (WRITE) AFTER LABEL.  BIT 3 ON                               HOP10750
*  MEANS READ BACKWARD, OFF MEANS FORWARD.                              HOP10760
*  BIT 4 ON MEANS ENABLE FOR NCI,                                       HOP10770
*  OFF MEANS DO NOT ENABLE FOR NCI.                                     HOP10780
       SPACE   2                                                        HOP10790
 LABRW SXA     LB970,4                                                  HOP10800
       SXA     LB975,2                                                  HOP10810
       SXA     LB980,1                                                  HOP10820
       STZ     NOLAB         RESET NO-LABEL SWITCH.                     HOP10830
       STZ     LAB20         RESET 14WD/20WD LABEL SWITCH.              HOP10840
       CAL     1,4           SET UP SWITCHES FROM CALLING               HOP10850
       AXT     5,4            SEQUENCE.                                 HOP10860
 SETSW STL     RDWRT+5,4                                                HOP10870
       PBT                                                              HOP10880
       STZ     RDWRT+5,4                                                HOP10890
       ALS     1                                                        HOP10900
       TIX     SETSW,4,1                                                HOP10910
 LB010 TSX     LBACT,4       SET UCW2 AND ACTIVATE.                     HOP10920
       NZT     EFETS         IS THIS EOF OR EOT.                        HOP10930
       TRA     LB040         NO.                                        HOP10940
       ZET     DICTS         YES.  IS THIS DICTIONARY ACTION.           HOP10950
       TRA     LB150         YES.  TAKE EOF/EOT RETURN (1,4).           HOP10960
       NZT     RDWRT         NO.  IS THIS READ OR WRITE.                HOP10970
       TRA     LB030         READ.                                      HOP10980
       ZET     HDRTR         WRITE.  IS THIS HEADER LABEL.              HOP10990
       TRA     LB040         NO. IGNORE EOT AND GO ON TO WRITE EOF.     HOP11000
       ZET     HYPSW         EOT ON HEADER LABEL.   PRINT               HOP11010
       TRA     LB340          HYPER OR                                  HOP11020
       TRA     LB400          729 MESSAGE.                              HOP11030
*  END OF FILE ON LABEL READ.                                           HOP11040
 LB030 CLA     LBM06         HEADER LABEL.                              HOP11050
       ZET     HDRTR                                                    HOP11060
       CLA     LBM07         TRAILER LABEL.                             HOP11070
       STO     LBM05+2                                                  HOP11080
       LDQ*    UCWIT                                                    HOP11090
       TSX     MSGSUP,4,3                                               HOP11100
       PZE     LBM05,,4+512*DBLSP                                       HOP11110
       STL     NOLAB         SET NO-LBL SWITCH TO SKIP CHECKING.        HOP11120
       TRA     LB970         EXIT.                                      HOP11130
*                                                                       HOP11140
 LB040 ZET     EOFAF         SHOULD THERE BE AN EOF FOLLOWING LABEL.    HOP11150
       TRA     LB970         NO.  EXIT.                                 HOP11160
       ZET     RDWRT         READ OR WRITE.                             HOP11170
       TRA     LB300         WRITE EOF.                                 HOP11180
       STL     EOFRQ         READ.  REQUEST TO READ EOF.                HOP11190
       TSX     LBACT,4       LOAD UCW2 AND ACTIVATE.                    HOP11200
       STZ     EOFRQ         RESET EOF REQUEST SWITCH.                  HOP11210
       ZET     EFETS         DID WE GET AN EOF.                         HOP11220
       TRA     LB970         YES.  EXIT.                                HOP11230
       CLA     LBM06         NO.  PRINT ''UNIT XX...NO EOF FOLLOWING    HOP11240
       ZET     HDRTR          (HEADER)(TRAILR) LABEL.''                 HOP11250
       CLA     LBM07                                                    HOP11260
       STO     LBM08+4                                                  HOP11270
       LDQ*    UCWIT                                                    HOP11280
       TSX     MSGSUP,4,3                                               HOP11290
       PZE     LBM08,,6+512*DBLSP                                       HOP11300
       NZT     HCSWH          IF THIS WAS A BCK WD READ,                HOP11310
       TRA     *+4             REPOSITION BY SKIPPING                   HOP11320
       TSX     (NDATA,4          FORWARD ONE RECORD.                    HOP11330
       PZE     UCWIT,,36                                                HOP11340
       TRA     LB970           EXIT.                                    HOP11350
       TSX     SNDAT,4       BACKSPACE 1 RECORD.                        HOP11360
       PZE     UCWIT,,BSR                                               HOP11370
       TRA     LB970         EXIT.                                      HOP11380
       SPACE   1                                                        HOP11390
*  EOF OR EOT ON DICTIONARY READ/WRITE.  TAKE RETURN 1,4.               HOP11400
       SPACE   1                                                        HOP11410
 LB150 XEC     LB970                                                    HOP11420
       TXI     LB975,4,1     RETURN 1,4.                                HOP11430
       SPACE   1                                                        HOP11440
*                                                                       HOP11450
       SPACE   1                                                        HOP11460
 LB300 TSX     SNDAT,4       WRITE EOF.                                 HOP11470
       PZE     UCWIT,,WEF                                               HOP11480
       ZET     HDRTR         EOT. PRINT MESSAGE IF HEADER.              HOP11490
       TRA     LB340         NORMAL RETURN.                             HOP11500
 LB400 LDQ     LBM12         SET UP PROPER                              HOP11510
       STQ     LBM01         MESSAGE FOR 729                            HOP11520
*  ROUTINE TO PRINT HEADER LABEL EOT MESSAGE AND UNLOAD TAPE.           HOP11530
 LB670 LDQ*    UCWIT         PRINT -UNIT XX  EOT WRITING                HOP11540
       TSX     MSGSUP,4,3     HEADER LABEL - CHANGE TAPE                HOP11550
       PZE     LBM01,,8+512*DBLSP                                       HOP11560
       TSX     SNDAT,4       UNLOAD THE TAPE.                           HOP11570
       PZE     UCWIT,,RUN                                               HOP11580
       TSX     (PAUSE,4      OPERATOR ACTION PAUSE.                     HOP11590
       TRA     LB010         RETURN FOR RETRY ON NEW TAPE.              HOP11600
 LB340 NZT     EWALW         TEST IF IN EWA.                            HOP11610
       TRA     LB970         NO.  NORMAL  EXIT.                         HOP11620
       ZET     HDRTR         YES.  WAS THIS A HEADER.                   HOP11630
       TRA     LB970         NO.  NORMAL EXIT.                          HOP11640
       LDQ     LBM11         SET UP PROPER                              HOP11650
       STQ     LBM01         MESSAGE FOR HYPER.                         HOP11660
       TRA     LB670         RETURN TO PRINT MESSAGE.                   HOP11670
*  ROUTINE TO LOAD UCW2 AND ACTIVATE.                                   HOP11680
 LBACT SXA     LB765,4                                                  HOP11690
       ZET     RDWRT         IS THIS A READ.                            HOP11700
       TRA     LB755         NO.  WRITE.                                HOP11710
       ZET     EOFRQ         READ.  IS EOF READ REQUESTED.              HOP11720
       TRA     LB780         YES.  SKIP FILLING WITH BLANKS.            HOP11730
 LB750 AXT     20,4          FILL LABEL INPUT AREA WITH BLANKS.         HOP11740
       CAL     LAB00                                                    HOP11750
       ADM     LB750                                                    HOP11760
       STA     LB753                                                    HOP11770
       CLA     BLANK                                                    HOP11780
 LB753 STO     **,4                                                     HOP11790
       TIX     *-1,4,1                                                  HOP11800
       TRA     LB780         GO TO READ.                                HOP11810
 LB755 CLS     LCSEL         WRITE.                                     HOP11820
 LB756 LAC     UCWIT,2                                                  HOP11830
       ZET     1,2                                                      HOP11840
       TRA     *-1                                                      HOP11850
       STO     1,2                                                      HOP11860
       TSX     (ACTVX,4                                                 HOP11870
       MZE     UCWIT                                                    HOP11880
       ZET     1,2                                                      HOP11890
       TRA     *-1                                                      HOP11900
 LB765 AXT     **,4                                                     HOP11910
       TRA     1,4                                                      HOP11920
 LB780 CLA     LCSEL                                                    HOP11930
       ZET     HCSWH         IF READ BACKWARD                           HOP11940
       ORA     MASK4          TELL IOEX.                                HOP11950
       TRA     LB756                                                    HOP11960
 LB970 AXT     **,4                                                     HOP11970
 LB975 AXT     **,2                                                     HOP11980
 LB980 AXT     **,1                                                     HOP11990
       STL     GENPR-5                                                  HOP12000
       TRA     2,4                                                      HOP12010
 LBM01 BCI     8, EOT WRITING HEADER LABEL - CHANGE TAPE.  *MR03        HOP12020
 LBM05 BCI     4,   EOF.  NO        LABEL                               HOP12030
 LBM06 BCI     1,HEADER                                                 HOP12040
 LBM07 BCI     1,TRAILR                                                 HOP12050
 LBM08 BCI     6,  NO EOF MARK FOLLOWING        LABEL                   HOP12060
 LBM09 BCI     1,(LBL)                                                  HOP12070
 LBM10 BCI     1,(DICT)                                                 HOP12080
 BLANK BCI     1,                                                       HOP12090
 LBM11 BCI     1, EWA W                                                 HOP12100
 LBM12 BCI     1, EOT W                                                 HOP12110
       EJECT                                                            HOP12120
*  SELECT ROUTINES.                                                     HOP12130
       SPACE   2                                                        HOP12140
 SELCT SXA     LVSEL,4                                                  HOP12150
       SXA     LVSEL+1,2                                                HOP12160
       SXA     LVSEL+2,1                                                HOP12170
       PAC     ,2                                                       HOP12180
       LDQ     1,2                                                      HOP12190
       ZET     HYPSW         IF HYPER,TRANSFER TO THE                   HOP12200
       TRA     HLSEL         HYPERTAPE SELECT PLUS ROUTINE.             HOP12210
       TMI     LSELM                                                    HOP12220
       CLA     LAB00                                                 (4)HOP12221
       STA     LIRTN-1                                               (4)HOP12225
       CLA     LIRTN                                                    HOP12230
       AXT     31872,4       RDS.                                       HOP12240
       TQP     *+2                                                      HOP12250
       AXT     32128,4       WRS.                                       HOP12260
       SXD     RDOWR,4                                                  HOP12270
       NZT     EOFRQ                                                    HOP12280
       SUB     K1                                                       HOP12290
       STA*    (RCHXI                                                   HOP12300
       NZT     LABST         IS STD LABEL TO BE WRITTEN.  PH 3.         HOP12310
       TRA     LB982         NO.                                        HOP12320
       ZET     LAB02         YES.  IS THERE A LABEL CARD.               HOP12330
       TRA     LB982          YES.                                      HOP12340
       LXA     LABTYP,4       NO.  IF THE INPUT LABEL WAS STD,          HOP12350
       TXH     LB982,4,1       GO TO GET THE COUNT FROM LAB03.          HOP12360
       CLA     =O16000000     SINCE THERE WAS NO LABEL CARD AND THERE ISHOP12370
       STD     LIRTN-1        EITHER NO LABEL OR A NON STD LABEL ON THE HOP12380
       TRA     LB985          INPUT, THIS LABEL WILL BE 14 WORDS.       HOP12390
 LB982 LXA     LB970,4       IF THE ADDRESS PART OF THE CALLING SE-     HOP12400
       CLA     1,4            QUENCE WORD (1,4) FOR THIS I/O ROUTINE IS HOP12410
       PAC     ,4             NONZERO AND THIS IS NOT DICTIONARY ACTION HOP12420
       TXL     LB985,4,0      (I.E.,DICTS IS ZERO), THEN IT CONTAINS    HOP12430
       CLA     0,4            THE LOCATION OF A WORD WHOSE ADDRESS      HOP12440
       PAX     ,4             SPECIFIES THE LENGTH OF THE LABEL WE ARE  HOP12450
       TXL     LB985,4,0      CURRENTLY PROCESSING. THEREFORE, WE       HOP12460
       NZT     DICTS          SHOULD USE THAT LENGTH IN THE WORD COUNT  HOP12470
       SXD     LIRTN-1,4      PART OF THE I/O COMMAND AT LIRTN-1.       HOP12480
 LB985 CLA     0,2           GET UCW1 FOR UNIT ADDRESS.                 HOP12490
       PDX     ,4                                                       HOP12500
       SXA     RDOWR,4                                                  HOP12510
 RDOWR PZE                   SELECT THE UNIT.                           HOP12520
       XEC*    (RCHXI                                                   HOP12530
       STZ     EFETS                                                    HOP12540
 LVSEL AXT     ,4                                                       HOP12550
       AXT     ,2                                                       HOP12560
       AXT     ,1                                                       HOP12570
       CLA     =O24000000    RESTORE LABEL LENGTH TO 20 WORDS.          HOP12580
       STD     LIRTN-1                                                  HOP12590
       STL     GENPR-5                                                  HOP12600
       TRA     1,4                                                      HOP12610
       SPACE   1                                                        HOP12620
*  SELECT PLUS ENTRY FOR HYPERTAPE, LABEL READ-WRITE.                   HOP12630
       SPACE   1                                                        HOP12640
 HLSEL TMI     HSELM         IF MINUS,TRANSFER TO HYPER SELECT MINUS.   HOP12650
       CLA     HLCOM         FIRST COMM TO ACC.                         HOP12660
       STZ     EWALW         RESET EWA SW.                              HOP12670
       LDI     HCTLR         LOAD A CTLR IN TO INDS.                    HOP12680
       TQP     *+3           TRA IF UCW2 SAYS READ.                     HOP12690
       LDI     HCTLW         WASN'T READ. LDI WITH CONTROL WRITE.       HOP12700
       STZ     HCSWH         WRITE.                                     HOP12710
       STI     HCTLX         STORE IN CONTROL COMMAND.                  HOP12720
       LDI     HNEOF         LOAD COPY CONSTANT AND IF                  HOP12730
       ZET     LBNCI         NCI IS REQUESTED SET THE                   HOP12740
       SIL     000001        COUNT TO 21.                               HOP12750
       ZET     EOFRQ         IF EOF READ IS REQUESTED                   HOP12760
       LDI     HWEOF         INSERT THE OTHER CPYD                      HOP12770
       STI     HCTLX+1       INTO COMMAND AREA.                         HOP12780
       CLA     HLSEL+1                                                  HOP12790
       STA*    (RCHXI        PUT LOCATION OF FIRST COMMAND INTO (RCHXI. HOP12800
       CLA     0,2                                                      HOP12810
       ANA     MASK1         AND THIS MASK TO GET UNIT AND INTERFACE.   HOP12820
       PAI                                                              HOP12830
       ANA     MASK2         AND THIS MASK TO GET ONLY THE UNIT NUMBER. HOP12840
       ORA     MASK3         OR MASK3 TO PUT UNIT NUMBER INTO THE ORDER.HOP12850
       ZET     HCSWH         IF READ BACK IS REQUESTED                  HOP12860
       ADD     =O100000000    CHANGE HYPER ORDER HSEL TO A HSBR.        HOP12870
       STO     HCONT         STORE THE HYPER ORDER.                     HOP12880
       PIA                                                              HOP12890
       ARS     23            SHIFT BIT 12 TO POSITION 35                HOP12900
       ADM     =O26          AND ADM BITS 31,33 AND 24.                 HOP12910
       ZET     HCSWH         TEST IF BK. RD.                            HOP12920
       ADD     =32           YES.  ADD BIT 30 TO THE SMS.               HOP12930
       ZET     LBNCI         IS NCI REQUESTED.                          HOP12940
       ADD     =64           YES.  ADD BIT 29 TO THE SMS.               HOP12950
       STA     HIRTN          INSERT IN SMS COMMAND.                    HOP12960
       CLA     LAB00                                                    HOP12970
       ZET     HCSWH         IF BACKWARD READ                           HOP12980
       ADD     =19           GET THE END OF THE LABEL                   HOP12990
       STA     HCTLX+1       AREA AND STORE IN THE COPY COMMAND.        HOP13000
       ZET     LABST         IF THIS IS PH3 AND WE WANT                 HOP13010
       TRA     LB990         TO WRITE A STD. LABEL, TRANSFER.           HOP13020
       LXA     LB970,4       IF THE ADDRESS PART OF THE CALLING SEQ-    HOP13030
       CLA     1,4            UENCE WORD (1,4) FOR THIS I/O ROUTINE IS  HOP13040
       PAC     ,4             NON ZERO AND THIS IS NOT DICTIONARY ACTIONHOP13050
       TXL     LB990,4,0      (I.E., DICTS IS ZERO), THEN IT CONTAINS   HOP13060
       CLA     0,4            THE LOCATION OF A WORD WHOSE ADDRESS      HOP13070
       PAX     ,4             SPECIFIES THE LENGTH OF THE LABEL WE ARE  HOP13080
       TXL     LB990,4,0      CURRENTLY PROCESSING.  THEREFORE, WE      HOP13090
       NZT     DICTS          SHOULD USE THAT LENGTH IN THE WORD COUNT  HOP13100
       SXD     HCTLX+1,4      PART OF THE I/O COMMAND AT HCTLX+1.       HOP13110
 LB990 XEC*    (RCHXI        RESET AND START I/O.                       HOP13120
       STZ     EFETS                                                    HOP13130
       TRA     LVSEL         EXIT FROM HYPER SEL + FOR LABRW.           HOP13140
 HLCOM LIPT    *+1                                                      HOP13150
 HIRTN SMS     22            BITS 31, 33, 34.                           HOP13160
 HCTLX CTLR    HCONT                                                    HOP13170
       CPYD    **,,-1                                                   HOP13180
       TCH     SYSTWT                                                   HOP13190
 HCONT PZE                   HYPERTAPE ORDER AREA.                      HOP13200
 HCTLR CTLR    HCONT         READ CONTROL COMMAND.                      HOP13210
 HCTLW CTLW    HCONT         WRITE CONTROL COMMAND.                     HOP13220
 HNEOF CPYD    **,,20        COPY 20 WDS.                               HOP13230
 HWEOF CPYD    **,,3                                                    HOP13240
 MASK1 OCT     000057000000  MASK TO GET UNIT AND INTERFACE.            HOP13250
 MASK2 OCT     000017000000  MASK TO GET UNIT NUMBER.                   HOP13260
 MASK3 OCT     120600120112  MASK OF HSEL AND HEOS.                     HOP13270
 MASK4 OCT     200000000000                                             HOP13280
       SPACE                                                            HOP13290
*  SELECT MINUS ENTRY, LABEL READ-WRITE.                                HOP13300
       SPACE   1                                                        HOP13310
LSELM  LNT     400000                                                (4)HOP13320
       TRA     LBSM3         NOISE RECORD. TAKE RETURN 2 IF READ.    (4)HOP13330
       LFT     300000                                                (4)HOP13340
       TRA     LBSM1         EOF/EOT/PERM. REDUNDANCY.               (4)HOP13350
 LBSCH NZT     LBNCI         IF A NON-STD. LENGTH LABEL IS NOT          HOP13360
       TRA     LBSM0          EXPECTED,TRANSFER.                        HOP13370
       LXA     (COMMM,4                                                 HOP13380
       ZET     HYPSW         IF HYPER                                   HOP13390
       LXD     (COMMM,4      LOAD IR4 FROM THE DEC.                     HOP13400
       PXA     ,4                                                       HOP13410
       SUB     LAB00                                                    HOP13420
       TZE     LBSM0         IF LENGTH IS ZERO, BYPASS.                 HOP13430
       NZT     LAB03                                                    HOP13440
       STA     LAB03                                                    HOP13450
       SUB     =14                                                      HOP13460
       TZE     *+2           IF LABEL WAS 14 WORDS                      HOP13470
       TRA     LBSM0         SET LAB20 TO NON-ZERO.                     HOP13480
       STL     LAB20                                                    HOP13490
 LBSM0 STZ     1,2                                                      HOP13500
       TRA     LVSEL         EXIT.                                      HOP13510
 LBSM1 LFT     200000                                                   HOP13520
       TRA     LBSM2         EOF/EOT                                    HOP13530
 LBSM4 AXT     LBM10,4                                                  HOP13540
       NZT     DICTS                                                    HOP13550
       AXT     LBM09,4                                                  HOP13560
       SXA     REDCS,4                                                  HOP13570
       TSX     MSGSUP,4,2                                               HOP13580
       PZE     1                                                        HOP13590
 REDCS PZE     **,,1+512*DBLSP                                          HOP13600
       TRA     LBSM0         ACCEPT AS IS.                              HOP13610
 LBSM2 STL     EFETS                                                    HOP13620
       TRA     LBSM0                                                    HOP13630
 LBSM3 LXA     LVSEL,4                                                  HOP13640
       TXI     LVSEL+1,4,-1  TAKE RETURN 2,4.                           HOP13650
       SPACE   1                                                        HOP13660
*  SELECT MINUS ENTRY FOR HYPERTAPE,LABEL READ-WRITE.                   HOP13670
       SPACE   1                                                        HOP13680
 HSELM LNT     001000        TEST FOR UNUSUAL END.                      HOP13690
       TRA     LBSCH         NO . GO TO TEST IF NCI WAS ENABLED         HOP13700
       LFT     000074        ARE THERE ANY BITS BESIDES BIT 8.          HOP13710
       TRA     *+2           YES.                                       HOP13720
       TRA     LBSCH         NO.  THIS MUST BE NCI.                     HOP13730
       RFT     000010        TEST IF TAPE MARK WAS READ.                HOP13740
       TRA     LBSM2         YES.                                       HOP13750
       RNT     000004         TEST IF IN EWA.                           HOP13760
       TRA     *+3           NO.                                        HOP13770
       STL     EWALW         YES.  SET SWITCH TO NON-ZERO               HOP13780
       TRA     LBSM2         AND EXIT.                                  HOP13790
       TRA     LBSM4         EXIT. IOEX PRINTS OPERATOR MESSAGE.        HOP13800
 EWALW PZE                   NZ=EWA INDICATOR ON.                       HOP13810
       SPACE   2                                                        HOP13820
*                                                                       HOP13830
*                                                                       HOP13840
       IORT    **,,20        THIS MUST COME JUST BEFORE LIRTN.       (4)HOP13850
 LIRTN IORTN   *,,-1                                                    HOP13860
 NOLAB PZE                   NO-LABEL SWITCH.                           HOP13870
 EOFRQ PZE                   EOF-REQUEST SWITCH.                        HOP13880
 LCSEL PZE     ,,SELCT                                                  HOP13890
 EFETS PZE                   END OF FILE, END OF TAPE SWITCH.           HOP13900
*  THE 5 FOLLOWING CELLS ARE THE LABRW CALLING SEQUENCE CELLS.          HOP13910
 RDWRT PZE                   READ = ZERO, WRITE = NZ.                   HOP13920
 HDRTR PZE                   HEADER = ZERO, TRAILER = NZ.               HOP13930
 EOFAF PZE                   EOF AFTER = ZERO, NONE = NZ.               HOP13940
 HCSWH PZE                   WRITE AND RD FWD = ZERO, RD BCK = NZ.      HOP13950
 LBNCI PZE                   NZ = ENABLE FOR NCI IS REQUESTED.          HOP13960
*                                                                       HOP13970
 LAB20 PZE                   LABEL READ WAS 14 WDS = NZ.  20 WDS = ZERO.HOP13980
 LABST PZE                  NZ= STD LABEL TO BE WRITTEN IN PH 3.        HOP13990
       EJECT                                                            HOP14000
* SKIP ROUTINE - SKIPS RECORDS AND FILES ON TAPE.                       HOP14010
*       CALLING SEQUENCE IS  -                                          HOP14020
*           TSX   SKIP,4                                                HOP14030
*                                                                       HOP14040
*       CONTENTS OF RAWPR AND RAWPR-1 MUST BE AS FOLLOWS -              HOP14050
*                                                                       HOP14060
*         RAWPR.....DECR CONTAINS LOGICAL FILE NO. OF TAPE TO SKIP ON.  HOP14070
*                   SIGN IS PLUS FOR AN INPUT TAPE, MINUS FOR OUTPUT.   HOP14080
*         RAWPR-1...DECR CONTAINS NO. OF FILES TO SKIP.                 HOP14090
*                   ADDR CONTAINS NO. OF RECORDS TO SKIP AFTER FILES    HOP14100
*                     HAVE BEEN SKIPPED.                                HOP14110
*                                                                       HOP14120
SKIP   NZT     RAW01         TEST FOR ZERO ENTRY.                       HOP14130
       TRA     1,4           NOTHING TO DO.  RETURN.                    HOP14140
       SXA     SKP52,2                                                  HOP14150
       SXA     SKP54,4                                                  HOP14160
       CLA     RAW00                                                    HOP14170
       PDX     ,2            SAVE FILE NUMBER.                          HOP14180
       TXH     SKP32,2,-2    TRANSFER IF CHECKPOINT TAPE.               HOP14190
       TMI     SKP20         TRANSFER IF FILE IS OUTPUT.                HOP14200
       TXH     SKP10,2,0     TRANSFER IF FILE NUMBER IS NONZERO.        HOP14210
       CLA*    AIUCW         PICK                                       HOP14220
       TRA     SKP40          UP                                        HOP14230
 SKP10 TXI     *+1,2,-1       LOCATION                                  HOP14240
       CLA*    MIUCW          OF                                        HOP14250
       TRA     SKP40          UCW                                       HOP14260
SKP20  TXL     *+2,2,0        OF UNIT INVOLVED.                         HOP14270
 SKP30 TXI     *+1,2,-1                                                 HOP14280
       CLA*    MOUCW                                                    HOP14290
       TRA     SKP40                                                    HOP14300
 SKP32 CLA     SYSCK2                                                   HOP14310
 SKP40 STA     SKP60         SAVE FOR ACTIVATE AND RDS.                 HOP14320
       PAC     ,2                                                       HOP14330
       CAL     2,2                                                      HOP14340
       ANA     =O77777000000                                            HOP14350
       ADM     RAW01                                                    HOP14360
       STA     GOAL                                                     HOP14370
       STD     GOAL                                                     HOP14380
       ZET     1,2                                                      HOP14390
       TRA     *-1                                                      HOP14400
       LDI     0,2                                                      HOP14410
       LNT     200                                                      HOP14420
       TRA     SKHYR                                                    HOP14430
       CLA     SELLC          THE LOCATION OF THE                       HOP14440
       SLW     1,2            SELECT ROUTINE                            HOP14450
       TSX     (ACTIV,4      ACTIVATE                                   HOP14460
       MZE     SKP60          UNIT.                                     HOP14470
       ZET     1,2           WAIT FOR COMPLETION                        HOP14480
       TRA     *-1            OF ACTIVITY.                              HOP14490
 SKP52 AXT     **,2                                                     HOP14500
 SKP54 AXT     **,4                                                     HOP14510
       TRA     1,4                                                      HOP14520
       SPACE   2                                                        HOP14530
SKPSL  PAC     ,2                                                       HOP14540
       TMI     SKPSM                                                    HOP14550
       STZ*    (RCTXI        SUPPRESS REDUNDANCY CHECKING.              HOP14560
       CLA     LIRTN         INITIALIZE                                 HOP14570
       STA*    (RCHXI         RCH.                                      HOP14580
SKP60  LXD     **,2          PUT TAPE ADDRESS IN                        HOP14590
       SXA     *+1,2          AND EXECUTE                               HOP14600
       RDS     **             THE RDS.                                  HOP14610
       XEC*    (RCHXI                                                   HOP14620
       TRA     1,4                                                      HOP14630
       SPACE   1                                                        HOP14640
       SPACE   2                                                        HOP14650
 SKPSM LFT     200000        TRANSFER IF EOF                            HOP14660
       TRA     SKP90          WAS REACHED.                              HOP14670
       CAL     (COMMM                                                   HOP14680
       SUB     LIRTN                                                    HOP14690
       ANA     =O77777                                                  HOP14700
       LDQ     K2                                                       HOP14710
       TLQ     SKP90                                                    HOP14720
       CAL     2,2                                                      HOP14730
       SUB     K1                                                       HOP14740
       STO     2,2                                                      HOP14750
SKP90  CAL     2,2                                                      HOP14760
       ANA     =O77777777777                                            HOP14770
       SUB     GOAL                                                     HOP14780
       TMI     *+2                                                      HOP14790
       STZ     1,2                                                      HOP14800
       TRA     1,4                                                      HOP14810
GOAL   PZE                                                              HOP14820
 SELLC         **,,SKPSL                                                HOP14830
*  ROUTINE TO SKIP RECORD OR FILE ON HYPERTAPE.                         HOP14840
SKHYR  TSX     (NDATA,4                                                 HOP14850
       PZE     SKP60,,36                                                HOP14860
       CAL     2,2                                                      HOP14870
       ANA     =O77777777777                                            HOP14880
       SUB     GOAL                                                     HOP14890
       TMI     SKHYR                                                    HOP14900
       TRA     SKP52                                                    HOP14910
       EJECT                                                            HOP14920
*  ROUTINE TO DO THE NON-DATA OPERATIONS FOR HYPER AND 729.             HOP14930
*  SDNL, SDNH, WILL BE DONE FOR 729, BYPASSED FOR HYPER. IT WILL ALSO   HOP14940
*   HANDLE REW,RUN,WEF,BSR, AND BSF.  CALLING SEQUENCE IS               HOP14950
*                            TSX     SNDAT,4                            HOP14960
*                            PZE     (L(L(UCB),,NDS FOR 729             HOP14970
       SPACE   1                                                        HOP14980
 SNDAT SXA     SETOT,4                                                  HOP14990
       STZ     SETOV                                                    HOP15000
       CLA     1,4                                                      HOP15010
       STO     SETOR                                                    HOP15020
       STA     *+1                                                      HOP15030
       LDI*    **            PUT FIRST WORD OF UCB INTO INDS.           HOP15040
       LFT     000200        IS THIS UNIT HYPER.                        HOP15050
       TRA     SETOO+1       NO. GO TO DO A 729 (NDATA.                 HOP15060
       PDX     0,4           YES.                                       HOP15070
       TXL     SETOT,4,2     EXIT IF INVALID NON-DATA.                  HOP15080
       TXH     SETOO,4,7     EXAMINE THE DECREMENT                      HOP15090
       TXI     *+1,4,27       OF 1,4                                    HOP15100
       TNX     *+5,4,31       AND CHANGE THE 729                        HOP15110
       TXI     *+1,4,33       CODE TO ITS PROPER                        HOP15120
       TNX     *+3,4,35       COUNTER PART FOR                          HOP15130
       TXI     *+1,4,32       HYPERTAPE.                                HOP15140
       STL     SETOV         IF THIS WAS WEF SET SW.                    HOP15150
 SETOO SXD     SETOR,4                                                  HOP15160
       TSX     (NDATA,4      PERFORM THE NON-DATA OPERATION.            HOP15170
 SETOR PZE     **,,**                                                   HOP15180
       TRA     *+2           NORMAL RTN.  (EOT ON WEF RETURN ALSO).     HOP15190
       STL     SETOV         NORMAL RETURN ON 729 WEF.                  HOP15200
 SETOT AXT     **,4                                                     HOP15210
       STL     GENPR-5                                                  HOP15220
       NZT     SETOV                                                    HOP15230
       TRA     2,4           EXIT.                                      HOP15240
       TRA     3,4           EXIT FOR A WEF.                            HOP15250
 SETOV PZE                   WEF RETURN SW.                             HOP15260
       SPACE   1                                                        HOP15270
       SPACE   2                                                        HOP15280
*  ROUTINE TO SAVE CALLING SEQUENCE + RESTORE IT.                       HOP15290
       SPACE   1                                                        HOP15300
 SAVEW CLA     RAWPR                                                    HOP15310
       STO     SAVE1                                                    HOP15320
       CLA     RAWPR-1                                                  HOP15330
       STO     SAVE2                                                    HOP15340
       TRA     1,4                                                      HOP15350
 RESTW CLA     SAVE1                                                    HOP15360
       STO     RAWPR                                                    HOP15370
       CLA     SAVE2                                                    HOP15380
       STO     RAWPR-1                                                  HOP15390
       TRA     1,4                                                      HOP15400
 SAVE1 PZE                                                              HOP15410
 SAVE2 PZE                                                              HOP15420
       SPACE                                                            HOP15430
       SPACE   8                                                        HOP15440
       EJECT                                                            HOP15450
*  7090 SORT  MESSAGE  SUPERVISOR                                       HOP15460
* WHEN THE DECREMENT OF THE TSX MSGSUP,4,** IS-                         HOP15470
*      1       USE CONVERT AND PRINT                                    HOP15480
*      2       MUST BE PRINTED ONLINE                                   HOP15490
*      3       CONVERT AND MUST BE PRINTED ONLINE                       HOP15500
*      4       TEST HIST                                                HOP15510
*      5       TEST HIST AND CONVERT                                    HOP15520
*      8       TEST MAP                                                 HOP15530
*      9       TEST MAP AND CONVERT                                     HOP15540
*      16      TEST TAPES                                               HOP15550
*      17      TEST TAPES AND CONVERT                                   HOP15560
*      32      TEST CARDS                                               HOP15570
*      33      TEST CARDS AND CONVERT                                   HOP15580
*      ALSO  WHEN                                                       HOP15590
*      NOF     IS (Z) PRINT OFF LINE                                    HOP15600
*      MAP     IS (NZ) PRINT ONLINE                                     HOP15610
*      HIST    IS (NZ) PRINT ONLINE                                     HOP15620
*      TAPES   IS (NZ) PRINT ONLINE                                     HOP15630
*      CARDS   IS (NZ) PRINT ONLINE                                     HOP15640
MSGSUP ENB     K0            DISABLE ALL TRAPS                          HOP15650
       SXA     SAVXR4,4                                                 HOP15660
DETERM LDI     0,4           DETERMINE TYPE OF MESSAGE REQUESTED        HOP15670
       LFT     000002        MUST BE PRINTED ONLINE +                   HOP15680
       TRA     MUST          YES                                        HOP15690
       AXT     *,4           LOAD XR IN CASE OF ERROR                   HOP15700
       LFT     000004        TEST HIST                                  HOP15710
       AXT     HIST,4        YES                                        HOP15720
       LFT     000010        TEST MAP +                                 HOP15730
       AXT     MAP,4         YES                                        HOP15740
       LFT     000020        TEST TAPES +                               HOP15750
       AXT     TAPES,4       YES                                        HOP15760
       LFT     000040        TEST CARDS +                               HOP15770
       AXT     CARDS,4       YES                                        HOP15780
       SXA     TEST,4                                                   HOP15790
SAVXR4 AXT     **,4                                                     HOP15800
TEST   ZET     **            PRINT ONLINE +                             HOP15810
       TRA     MUST          YES                                        HOP15820
       ZET     NOF           NO-PRINT OFFLINE +                         HOP15830
       TRA     GOBACK        NO                                         HOP15840
       CAL     MON           YES-GO PRINT                               HOP15850
       TRA     ALTER         OFFLINE ONLY                               HOP15860
MUST   CAL     *             SET UP FOR BOTH                            HOP15870
       NZT     NOF           PRINT OFFLINE ALSO +                       HOP15880
ALTER  STP     1,4           ALTER CALLING SEQUENCE                     HOP15890
       LFT     000001        CONVERSION NECESSARY +                     HOP15900
       TRA     (CVPRT        YES                                        HOP15910
       TRA     (PROUT        NO                                         HOP15920
GOBACK CLS     MON           CONSTANT TO AC                             HOP15930
       LNT     000001        ONLY ONE CALL SEQ ENTRY +                  HOP15940
       ADM     1,4           NO CALCULATE                               HOP15950
       STA     BACK          RETURN                                     HOP15960
       NZT     (TRPSW                                                   HOP15970
       ENB*    (TRAPX        RE-ENABLE TRAPS                            HOP15980
BACK   TRA     **,4                                                     HOP15990
MON    MON     2                                                        HOP16000
 K0    PZE     0                                                        HOP16010
 K2    PZE     2                                                        HOP16020
OPENCL PZE                   INPUT FILE STATUS INDICATOR.               HOP16030
 OPTPR COMMON  15             OPTION CARD PARAMETERS                    HOP16040
 OVEPR COMMON  2              OVERFLOW CARD PARAMETERS                  HOP16050
 LABPR COMMON  5              LABEL CARD PARAMETERS                     HOP16060
 CHAPR COMMON  6              CHANNEL PARAMETERS                        HOP16070
 FILPR COMMON  14             FILE CARD PARAMETERS                      HOP16080
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              HOP16090
 RECPR COMMON  10             RECORD CARD PARAMETERS                    HOP16100
 DELPR COMMON  2              DELETE CARD PARAMETERS                    HOP16110
 SAMPR COMMON  7              SORT AND MERGE CARD PARAMETERS            HOP16120
 CALPR COMMON  50             CALCULATED PARAMETERS                     HOP16130
 GENPR COMMON  10             GENERAL PARAMETERS                        HOP16140
 RAWPR COMMON  30             READ AND WRITE PARAMETERS                 HOP16150
 CNTPR COMMON  20             COUNT PARAMETERS                          HOP16160
 ERAPR COMMON  30             ERASABLE SORAGE PARAMETERS                HOP16170
 REFPR COMMON  1              REFERENCED PARAMETERS PARAMETER           HOP16180
 AIUCW EQU     CHAPR                                                    HOP16190
 MOUCW EQU     CHAPR-2                                                  HOP16200
 MIUCW EQU     CHAPR-3                                                  HOP16210
RAW00  EQU     RAWPR                                                    HOP16220
RAW01  EQU     RAWPR-1                                                  HOP16230
 CHA01 EQU     CHAPR-1       L(OUTPUT CHANNEL TABLE), IF SPECIFIED      HOP16240
 CHA02 EQU     CHAPR-2       L(MERGE OUTPUT CHANNEL TABLE)              HOP16250
 CHA03 EQU     CHAPR-3       L(MERGE INPUT CHANNEL TABLE)               HOP16260
 CHA04 EQU     CHAPR-4       NON-ZERO IF SYMBOLIC OUTPUT CHANNEL SPECIF-HOP16270
*                             IED.                                      HOP16280
 PR14  EQU     CHAPR                                                    HOP16290
 PR15  EQU     CHAPR-3                                                  HOP16300
 PR16  EQU     CHAPR-2                                                  HOP16310
 PR19  EQU     CHAPR-1                                                  HOP16320
 PR20  EQU     FILPR                                                    HOP16330
 PR29  EQU     FILPR-1       ADDR. OF OUTPUT FILE DATA BLOCK.           HOP16340
CNT19  EQU     CNTPR-19                                              (7)HOP16341
 UNRT  EQU     SYSCK2                                                   HOP16350
 CTLSI EQU     4             CODE TO CHECK TRAILER LABEL, SORT INPUT.   HOP16360
 OP800 EQU     GENPR-8       DICTIONARY INDICATION SWITCH.              HOP16370
 CHLUR EQU     0             CODE TO CHECK HEADER LABEL, UNRT.          HOP16380
 CHLMI EQU     2             CODE TO CHECK HEADER LABEL, MERGE INPUT.   HOP16390
 CHLSI EQU     3             CODE TO CHECK HEADER LABEL, SORT INPUT.    HOP16400
 CTLMI EQU     4             CODE TO CHECK TRAILER LABEL, MERGE INPUT.  HOP16410
 PTLOR EQU     6             CODE TO PREPARE TRAILER LABEL, OUTPUT REEL.HOP16420
 PTLFR EQU     7             CODE TO PREPARE TRAILER LABEL, FINAL REEL. HOP16430
 CHLEI EQU     3             CODE TO CHECK HEADER LABEL, EXTERNAL INPUT.HOP16440
 PHLFO EQU     5             CODE TO PREPARE HEADER LABEL, FINAL OUTPUT.HOP16450
 PHLUR EQU     8             CODE TO PREPARE HEADER LABEL, UNRT.        HOP16460
 PHLMO EQU     1             CODE TO PREPARE HEADER LABEL, MERGE OUTPUT.HOP16470
 SNGLS EQU     0                                                        HOP16480
 OVFLS EQU     RAWPR-25                                                 HOP16490
MORDER EQU     SAMPR-1                                                  HOP16500
 RDBCK EQU     RAWPR-21      NON-ZERO IF BACKWARD READ.                 HOP16510
LABTYP EQU     GENPR-6      NZ= STD.  1= NON STD.  ZERO = NO LABEL      HOP16520
 GEN07 EQU     GENPR-7       CONTAINS RECORD COUNT OF INPUT TAPE.       HOP16530
MAP    EQU     OPTPR-6                                                  HOP16540
NOF    EQU     OPTPR-7                                                  HOP16550
HIST   EQU     OPTPR-8                                                  HOP16560
TAPES  EQU     OPTPR-9                                                  HOP16570
CARDS  EQU     OPTPR-10                                                 HOP16580
 LAB00 EQU     LABPR                                                    HOP16590
LAB01  EQU     LABPR-1                                                  HOP16600
 LAB02 EQU     LABPR-2                                                  HOP16610
 LAB03 EQU     LABPR-3                                                  HOP16620
       DETAIL                                                           HOP16630
       END                                                              HOP16640
* 7090/94 SORT VER 7 MOD 8 BUFFER READ VARIABLE LENGTH, PHASE 1      (8)HYG00000
*      FAP
       COUNT   900                                                      HYG00010
       ENTRY   HYGET                                                    HYG00020
       ENTRY   GET                                                      HYG00030
       SST                                                              HYG00040
*  GET HANDLES THE READING OF UNSORTED VARIABLE LENGTH RECORDS IN       HYG00050
*  PHASE 1.BLOCKS OF RECORDS ARE READ INTO THE BUFFER AND THE LOCATION  HYG00060
*  AND WORD LENGTH OF EACH RECORD IS PUT INTO THE LOCATE TABLE.ERAPR-3  HYG00070
*  POINTS TO THE LIST OF AVAILABLE BINS TO BE USED FOR EACH CALL TO GET.HYG00080
*  RECORDS ARE MOVED INTO BINS UNTIL THE LIST IS EXHAUSTED OR UNTIL     HYG00090
*  THE SORT TABLE IS FILLED.EACH ENTRY IN THE SORT TABLE TELLS THE      HYG00100
*  LOCATION OF THE FIRST BIN OF A RECORD AND THE NUMBER OF WORDS WHICH  HYG00110
*  WILL BE WRITTEN FROM PHASE 1 FOR THAT RECORD.EQUALS AND/OR CHECKSUM, HYG00120
*  IF OPTIONED,ARE ADDED WHEN THE RECORD IS MOVED INTO THE BINS.THE     HYG00130
*  LOCATION AND LENGTH OF THE SORT TABLE IS GIVEN IN ERAPR-9.           HYG00140
       TITLE                                                            HYG00150
       SPACE   2                                                        HYG00160
HYGET  BSS     0                                                        HYG00170
GET    SXA     EXTRGS,1      SAVE ALL                                   HYG00180
       SXA     EXTRGS+1,2    THE REGS.                                  HYG00190
       SXA     EXTRGS+2,4                                               HYG00200
       NZT     DUMPSW        IS DUMP SWITCH SET.                        HYG00210
       TRA     CAL                                                      HYG00220
       CAL     HYPER         IS IT HYPER.                               HYG00230
       TZE     CALL          NO.                                        HYG00240
       CALL    DEBLK         YES.                                       HYG00250
       PZE     CPYD,,1                                                  HYG00260
       TRA     STZ                                                      HYG00270
CALL   CALL    DEBLK         YES-GO AND DUMP                            HYG00280
       PZE     TPTOBF,,1     THAT BLOCK.                                HYG00290
STZ    STZ     DUMPSW        RESET DUMPSW.                              HYG00300
CAL    CAL     ERAPR-3       GET THE LENGTH OF THE                      HYG00310
       LGR     18            AVAILABLE TABLE                            HYG00320
       STA     ATLT          TO BE REFERED TO.                          HYG00330
       ADM     ONE           INITIALIZE THISAV SO THAT IN CASE          HYG00340
       PAC     ,1            NO BIN IS USED, THE DECR. PART OF          HYG00350
       SXA     THISAV,1      ERAPR-3 REMAINS AS IT IS.                  HYG00360
       CAL     SRTBLT        INITIALIZE SRTBBP                          HYG00370
       SLW     SRTBBP        WITH SRTBLT.                               HYG00380
       CAL     SWTCHR        IS SWITCH R SET.                           HYG00390
       TNZ     CLOSE         YES-GO AND CLOSE THIS FILE AND OPEN NEW.   HYG00400
       CAL     SWTCHF        NO-IS SWITCH F SET.                        HYG00410
       TNZ     ENTRY1        YES-GO TO ENTRY1.                          HYG00420
       CAL     GETSWT        NO-IS IT FIRST TIME THROUGH.               HYG00430
       TNZ     TSTSWA        NO-GO AND TEST SWITCH A.                   HYG00440
       STL     GETSWT                                                   HYG00450
       AXT     0,2                                                      HYG00460
       CAL*    CHAPR-2                                                  HYG00470
       STA     *+1                                                      HYG00480
       LDI     **                                                       HYG00490
       LNT     20000                                                    HYG00500
       TRA     *+4                                                      HYG00510
       CAL     CAL           IF PUT WILL USE HYPERTAPES                 HYG00520
       STP     FINALE         CHANGE FINALE INTO CPYP.                  HYG00530
       STL     SHYPER                                                   HYG00540
       LXA     ERAPR,1       YES INITIALISE.                            HYG00550
       SXA     BUFRLC,1      TAKE                                       HYG00560
       SXA     BUFBOT,1      THE                                        HYG00570
       LXD     ERAPR,1       DATA                                       HYG00580
       SXA     BUFRLT,1      FROM                                       HYG00590
       LXD     ERAPR-1,1     EDIT PHASE                                 HYG00600
       SXA     BFTBLT,1      AND                                        HYG00610
       SXA     BFTBEP,1      STORE                                      HYG00620
       SXA     BFTBBP,1      THEM                                       HYG00630
       LXD     ERAPR-2,1     IN APPROPRIATE CELLS.                      HYG00640
       SXA     LCTBLT,1      ALSO                                       HYG00650
       SXA     LCTBEP,1      INITIALIZE                                 HYG00660
       SXA     LCTBBP,1      SRTBBP,                                    HYG00670
       LXA     CALPR-6,1     BFTBEP,LCTBEP,LCTBBP,                      HYG00680
       SXA     SRTBLT,1      BUFREP                                     HYG00690
       SXA     SRTBBP,1      AND BFTBBP.                                HYG00700
       LXA     CALPR-12,1    GET THE LENGTH OF                          HYG00710
       SXA     XCFLTH,1      THE EXTRECTED CONTROL FIELD.               HYG00720
       CAL     *-1                                                      HYG00730
       STT     ERAPR-21                                                 HYG00740
       CAL     CALPR-26      GET THE MAX-BLOCK LENGTH AND               HYG00750
       ADD     ONE           INCREASE BY 1 TO TAKE CARE OF WORD 1717''''HYG00760
       LAC     FILPR,2       IF THERE IS                                HYG00770
       ZET     -19,2         ANY CHECKSUM OR BLOCK SEQUENCE OPTION,     HYG00780
       ADD     ONE           INCREASE THE LIMIT BY ONE.                 HYG00790
       SLW     MXBKP1                                                   HYG00800
       SUB     ONE                                                      HYG00810
       SLW     MAXBP1                                                   HYG00820
       CAL     D2000         INCREASE 2000 WORDS LONG BLOCK BY 1        HYG00830
       ADD     ONE           TO TAKE CARE OF 171717171717.              HYG00840
       LAC     FILPR,2       IF THERE IS                                HYG00850
       ZET     -19,2         ANY CHECKSUM OR BLOCK SEQUENCE OPTION,     HYG00860
       ADD     ONE           INCREASE THE LIMIT BY ONE.                 HYG00870
       SLW     T000P                                                    HYG00880
       SUB     ONE                                                      HYG00890
       SLW     T000M                                                    HYG00900
       CAL     BUFRLC        GET THE                                    HYG00910
       ADD     BUFRLT        BASE OF                                    HYG00920
       SLW     BUFRND        BUFFER.                                    HYG00930
       SLW     BUFTOP                                                   HYG00940
       CAL     ERAPR-1       GET THE BASE                               HYG00950
       ADM     BFTBLT        OF BUFFER TABLE.                           HYG00960
       STA     BFTB1                                                    HYG00970
       STA     BFTB2                                                    HYG00980
       STA     BFTB3                                                    HYG00990
       STA     BFTB4                                                    HYG01000
       STA     BFTB5                                                    HYG01010
       STA     BFTB6                                                    HYG01020
       STA     BFTB7                                                    HYG01030
       CAL     ERAPR-2       GET THE BASE OF                            HYG01040
       ADM     LCTBLT        LOCATION TABLE.                            HYG01050
       SLW     LCTBND        LOCATION TABLE.                            HYG01060
       STA     LCTB1                                                    HYG01070
       STA     LCTB2                                                    HYG01080
       STA     LCTB3                                                    HYG01090
       STA     LCTB4                                                    HYG01100
       STA     LCTB5                                                    HYG01110
       STA     LCTB8                                                    HYG01120
       STA     LCTB9                                                    HYG01130
       STA     LOCMOR                                                   HYG01140
       STA     MOVRCD                                                   HYG01150
       CAL     ERAPR-9       GET THE BASE                               HYG01160
       ADM     SRTBLT        OF SORT TABLE.                             HYG01170
       STA     SRTB1                                                    HYG01180
       STA     SRTB2                                                    HYG01190
       CAL     CALPR-3       GET                                        HYG01200
       SLW     BINLTH        BIN LENGTH                                 HYG01210
       SUB     ONE           MINUS                                      HYG01220
       SLW     BNMINS        ONE.                                       HYG01230
       LGL     18            PUT BIN LENGTH-1 IN THE                    HYG01240
       STD     COMPAR        DECR. PORTION OF COMPAR INSTRUCTION.       HYG01250
       CAL     OPTPR-1       GET THE TOTAL OF THE WORDS                 HYG01260
       ADD     OPTPR-3       REQUIRED FOR XCFLTH                        HYG01270
       ADD     XCFLTH        AND CHECKSUM OR EQUALS                     HYG01280
       SLW     XFCKEQ        OPTION IF GIVEN.                           HYG01290
       LXA     RECPR-1,2                                                HYG01300
       SXD     MXRCD,2                                                  HYG01310
       LXA     RECPR,2                                                  HYG01320
       TXI     *+1,2,-1                                                 HYG01330
       SXD     MNRCD,2                                                  HYG01340
       CLA*    CHAPR         GET THE                                    HYG01350
       STA     LOCUCB        LOCATION                                   HYG01360
       PAX     ,2            OF UCW1,                                   HYG01370
       TXI     *+1,2,1       UCW2 AND                                   HYG01380
       SXA     UCW2,2        UCW3.                                      HYG01390
       TXI     *+1,2,1                                                  HYG01400
       SXA     UCW3,2                                                   HYG01410
       LDI*    LOCUCB                                                   HYG01420
       LNT     20000                                                    HYG01430
       TRA     NONHYP        7607 CHANNEL.                              HYG01440
       STL     HYPER         7909 CHANNEL.                              HYG01450
       CAL     =16                                                      HYG01460
       NZT*    FILPR                                                    HYG01470
       ORS     SMS                                                      HYG01480
       CAL     =1                                                       HYG01490
       LFT     40                                                       HYG01500
       ORS     SMS                                                      HYG01510
NONHYP LXA     MXBKP1,1                                                 HYG01520
       SXD     TPTOBF,1                                                 HYG01530
       SXD     CPYD,1                                                   HYG01540
       CAL     BUFRLC        INITIALIZE FOR                             HYG01550
       STA     TPTOBF        THE FIRST READ.                            HYG01560
       STA     CPYD                                                     HYG01570
       LAC     LOCUCB,2                                                 HYG01580
       CAL     SELLOC                                                   HYG01590
       ZET     1,2           IS THE UCW2 ZERO.                          HYG01600
       TRA     *-1           NO-WAIT.                                   HYG01610
       ENB     =0            YES-PUT THE LOC. OF SELECT IN              HYG01620
       SLW     1,2           THE DECR. PART OF UCW2.                    HYG01630
       ZET     HYPER         IS IT HYPER.                               HYG01640
       TRA     ACTIV         YES.                                       HYG01650
       CLA*    LOCUCB        NO-GET THE TAPE                            HYG01660
       ANA     =O017777000000   UNIT ADDRESS.                           HYG01670
       PDX     ,4                                                       HYG01680
       ZET*    FILPR         IS INPUT IN BCD.                           HYG01690
       TXI     *+1,4,16      NO-BINARY.                                 HYG01700
       SXA     RDS,4         YES-BCD.PUT UNIT ADDRESS IN RDS.           HYG01710
ACTIV  TSX     (ACTVX,4      READ TAPE.                                 HYG01720
       PZE     LOCUCB                                                   HYG01730
TSTSWA CAL     SWTCHA        IS READ COMPLETE.                          HYG01740
       TZE     ENTRY1        NO-GO AND TEST FOR THE ENTRY1 IN BUFTAB.   HYG01750
       LXA     BFTBBP,1      YES-IS BUFFER TABLE                        HYG01760
BFTB6  CLA     **,1          FULL.                                      HYG01770
       TNZ     ENTRY1        YES-GO TO ENTRY1.                          HYG01780
RDAGAN CLA     BUFBOT        NO.                                        HYG01790
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         HYG01800
       TZE     ENTRY1        IF ZERO-GO TO ENTRY1,                      HYG01810
       TMI     TPMNBT        IF MINUS-GO TO TPMNBT,                     HYG01820
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   HYG01830
       SBM     BUFBOT        CAN WE READ AGAIN                          HYG01840
       ADD     ONE           INTO THE                                   HYG01850
       CAS     MXBKP1        BUFFER.                                    HYG01860
       TRA     *+3           YES-READ                                   HYG01870
       TRA     *+2           YES-AGAIN.                                 HYG01880
       TRA     BIGRID        NO-TEST FOR READING FROM THE BEGINNING.    HYG01890
SAME1  CAL     BUFBOT        YES-MODIFY THE IORT INSTRUCTION            HYG01900
       STA     TPTOBF        TO READ AGAIN INTO THE BUFFER.             HYG01910
       STA     CPYD                                                     HYG01920
       TRA     RIDMEN        GO AND READ.                               HYG01930
TPMNBT CAL     BUFTOP                                                   HYG01940
       SBM     BUFBOT        CAN WE READ AGAIN                          HYG01950
       ADD     ONE           INTO THE BUFFER.                           HYG01960
       CAS     MXBKP1                                                   HYG01970
       TRA     SAME1         YES-READ                                   HYG01980
       TRA     SAME1         YES-AGAIN.                                 HYG01990
       TRA     ENTRY1        NO-GO TO ENTRY1.                           HYG02000
BIGRID CAL     BUFTOP        CAN WE READ                                HYG02010
       SBM     BUFRLC        FROM THE                                   HYG02020
       ADD     ONE           BEGINNING OF                               HYG02030
       CAS     MXBKP1        THE BUFFER.                                HYG02040
       TRA     *+3           YES-READ FROM                              HYG02050
       TRA     *+2           THE BEGINNING.                             HYG02060
       TRA     ENTRY1        NO-GO TO ENTRY1.                           HYG02070
       CAL     BUFRLC        INITIALIZE                                 HYG02080
       STA     TPTOBF        FOR                                        HYG02090
       STA     CPYD          NEW                                        HYG02100
       LXA     MXBKP1,1      READ.                                      HYG02110
       SXD     TPTOBF,1                                                 HYG02120
       SXD     CPYD,1                                                   HYG02130
RIDMEN CLA*    CHAPR                                                    HYG02140
       STA     LOCUCB        GET THE                                    HYG02150
       PAX     ,2            LOCATION                                   HYG02160
       TXI     *+1,2,1       OF UCW1,                                   HYG02170
       SXA     UCW2,2        UCW2 AND                                   HYG02180
       TXI     *+1,2,1       UCW3.                                      HYG02190
       SXA     UCW3,2                                                   HYG02200
       PAC     ,2                                                       HYG02210
       CAL     SELLOC                                                   HYG02220
       ZET     1,2                                                      HYG02230
       TRA     *-1                                                      HYG02240
       ENB     =0                                                       HYG02250
       SLW     1,2                                                      HYG02260
       ZET     HYPER         IS IT HYPER.                               HYG02270
       TRA     ACTIVE        YES.                                       HYG02280
       CLA*    LOCUCB        NO-GET THE TAPE                            HYG02290
       ANA     =O017777000000   UNIT ADDRESS.                           HYG02300
       PDX     ,4                                                       HYG02310
       ZET*    FILPR         IS INPUT IN BCD.                           HYG02320
       TXI     *+1,4,16      NO-BINARY.                                 HYG02330
       SXA     RDS,4         YES-BCD.PUT UNIT ADDRESS IN RDS.           HYG02340
ACTIVE TSX     (ACTVX,4                                                 HYG02350
       PZE     LOCUCB                                                   HYG02360
ENTRY1 LXA     BFTBEP,1      BFTBEP HAS BFTBLT FIRST TIME THROUGH.      HYG02370
BFTB1  ZET     **,1          IS THERE ANY ENTRY IN THE BUFFER TABLE.    HYG02380
       TRA     LOCATE        YES-GO AND LOCATE RECORDS.                 HYG02390
       ZET     SWTCHF        NO-IS IT EOF.                              HYG02400
       TRA     NTRY2         YES-GO TO NTRY2.                           HYG02410
       NZT     DUMPSW        NO-IS DUMP SWITCH SET.                     HYG02420
       ZET     SWTCHR        NO-IS SWITCH R SET.                        HYG02430
       TRA     GETEXT        YES-GO TO GETEXT.                          HYG02440
       TRA     ENTRY2        NO-GO TO ENTRY2.                           HYG02450
LOCATE LXA     LCTBBP,2      PUT THE LOCATION                           HYG02460
BFTB2  CAL     **,1          OF THE NEXT                                HYG02470
       LGR     18            TAPE RECORD                                HYG02480
       STA     NEXTRC        IN NEXTRC                                  HYG02490
       LGL     18            AND THE LOCATION OF THIS                   HYG02500
       STA     SERCH         TAPE RECORD IN SERCH.                      HYG02510
BFTB3  STZ     **,1          ZERO OUT BUFTAB ENTRY ALREADY BEEN LOCATED.HYG02520
       TIX     *+2,1,1       IS IT THE END OF BUFFER TABLE.             HYG02530
       LXA     BFTBLT,1      YES-REINITIALIZE REG1 WITH BFTBLT.         HYG02540
       SXA     BFTBEP,1      NO-SAVE THE NEXT ENTRY POINT TO BE TESTED. HYG02550
LOCMOR STA     **,2          STORE THE LOC. OF CONTROL WORD IN LOCTAB.  HYG02560
       CAL*    SERCH         GET THE LENGTH                             HYG02570
       SLW     WDCONT        OF THE LOGICAL RECORD.                     HYG02580
       ZET*    FILPR         IS IT BINARY.                              HYG02590
       TRA     BINARY        YES-BINARY.                                HYG02600
       TSX     DECBIN,4      NO-BCD-GO AND CONVERT                      HYG02610
       TRA     DELOPT        IT TO BINARY.                              HYG02620
BINARY CAL*    SERCH         INCREASE THE LENGTH                        HYG02630
       PDX     ,4            OF LOGICAL                                 HYG02640
       PXA     ,4            RECORD BY 1                                HYG02650
       ADD     ONE           TO TAKE CARE OF                            HYG02660
       SLW     WDCONT        THE CONTROL WORD.                          HYG02670
DELOPT LGL     18            STORE THE COUNT WORD IN                    HYG02680
LCTB1  STD     **,2          THE DECR. PART OF LOCATE TABLE.            HYG02690
*                                                                       HYG02700
       PDX     ,4            IS THIS RECORD OUT OF RANGE.               HYG02710
MXRCD  TXH     ERROR,4,**    (MAX.RCD LENGTH).   YES.                   HYG02720
MNRCD  TXL     ERROR,4,**    (MIN.RCD LENGTH-1).   YES.                 HYG02730
       TRA     USUAL         NO.                                        HYG02740
ERROR  CAL     SERCH         PRINT THE MESSAGE SAYING-                  HYG02750
       LGL     18            INVALID RECORD FORMAT *VR01                HYG02760
       XCL                   RECORD AT LOC. XXXXXX                      HYG02770
       TSX     (BCD5R,4      PAUSE                                      HYG02780
       STO     MESAG5+3      PRESS START TO DELETE SORT.                HYG02790
       TSX     MSGSUP,4,2                                               HYG02800
       PZE     3                                                        HYG02810
       PZE     MESAG6,,5                                                HYG02820
       PZE     MESAG5,,4                                                HYG02830
       PZE     MESAG7,,5                                                HYG02840
       TSX     (PAUSE,4                                                 HYG02850
       LXD     GENPR-3,4                                                HYG02860
       TRA     4,4                                                      HYG02870
*                                                                       HYG02880
USUAL  CAL     CNTPR-14      KEEP COUNT OF THE                          HYG02890
       ADD     =1            NO. OF LOGICAL RECORDS.                    HYG02900
       SLW     CNTPR-14                                                 HYG02910
       NZT     DELPR         DELETE OPTION.                             HYG02920
       TRA     NODELT        NO.                                        HYG02930
       PXA     ,2                                                       HYG02940
       SSM                                                              HYG02950
       ADD     LCTBND                                                   HYG02960
       STO     ERAPR-11                                                 HYG02970
       AXT     1,4                                                      HYG02980
       SXD     ERAPR-11,4                                               HYG02990
       CALL    DELETE        YES.                                       HYG03000
LCTB2  CAL     **,2                                                     HYG03010
       PDX     ,1                                                       HYG03020
       TXL     OVRLAY,1,0                                               HYG03030
NODELT TIX     *+2,2,1       IS IT THE END OF LOCATE TABLE.             HYG03040
       LXA     LCTBLT,2      YES-REINITIALIZE REG2 WITH LCTBLT.         HYG03050
OVRLAY SXA     LCTBBP,2      NO-GET THE LOCATION OF SUPPOSEDLY NXT RCD. HYG03060
LCTB9  STZ     **,2                                                     HYG03070
       CAL     WDCONT        IS IT                                      HYG03080
       ADD     SERCH         SAME AS THE                                HYG03090
       STA     SERCH         THE NEXT                                   HYG03100
       CAS     NEXTRC        TAPE RECORD.                               HYG03110
       TRA     ENTRY1        YES-WE ARE THROUGH WITH                    HYG03120
       TRA     ENTRY1        YES-LOCATING THE LOGICAL RECORDS.          HYG03130
       TRA     LOCMOR                                                   HYG03140
NTRY2  LXA     LCTBEP,1      IS THERE ANY ENTRY IN                      HYG03150
LCTB3  ZET     **,1          THE LOCATE TABLE.                          HYG03160
       TRA     LCTB5         YES- GO TO LCTB5.                          HYG03170
       CAL     SRTBLT        NO-IS THERE ANY ENTRY                      HYG03180
       SBM     SRTBBP        IN THE SORT TABLE.                         HYG03190
       TNZ     GETEXT        YES-GO TO GETEXT WITHOUT SETTING EOF FOR XSHYG03200
       STL     RAWPR-3       NO-SET EOF INDICATOR FOR XS AND            HYG03210
       TRA     GETEXT        GO TO GETEXT.                              HYG03220
ENTRY2 LXA     LCTBEP,1      IS THERE ANY ENTRY IN                      HYG03230
LCTB4  ZET     **,1          THE LOCATE TABLE.                          HYG03240
       TRA     LCTB5         YES- GO AND TEST FOR THE AVAILABLE BINS.   HYG03250
       NZT     SWTCHA        IS READ COMPLETE.                          HYG03260
       TRA     ENTRY1        NO.                                        HYG03270
       LXA     BFTBEP,1      YES.                                       HYG03280
       XEC     BFTB1         ANY ENTRY IN THE BUFFER TABLE.             HYG03290
       TRA     ENTRY1        YES.                                       HYG03300
       CAL     BUFRND        NO. UPDATE BUFTOP                          HYG03310
       SLW     BUFTOP         AND BUFBOT.                               HYG03320
       CAL     BUFRLC                                                   HYG03330
       SLW     BUFBOT                                                   HYG03340
       ZET     DUMPSW        IS DUMP SWITCH SET.                        HYG03350
       TRA     GETEXT        YES.                                       HYG03360
       ZET     SWTCHF        NO.  IS IT EOF                             HYG03370
       TRA     NTRY2          YES.                                      HYG03380
       ZET     SWTCHR         NO.  IS SWTCHR SET.                       HYG03390
       TRA     GETEXT          YES.                                     HYG03400
       TRA     TPMNBT        NO. READ FROM THE TOP OF BUFFER.           HYG03410
LCTB5  CAL     **,1          STORE ADDRESS OF LOCATION PRIOR         (8)HYG03420
       SUB     =1             TO FIRST WORD OF LOGICAL RECORD        (8)HYG03421
       STA     ERAPR-26       FROM CONTROL WORD IN LOCATE TABLE      (8)HYG03422
       LGR     18            STORE LENGTH OF LOGICAL RECORD          (8)HYG03430
       STA     RCDLTH         FROM CONTROL WORD IN LOCATE TABLE      (8)HYG03440
       ZET     NOTCMP        DID IT COME FROM READ INCOMPLETE.          HYG03450
       TRA     SMALUP        YES-GO TO SMALUP.                          HYG03460
       CAL     ERAPR-3       NO.                                        HYG03470
       SBM     ONE           GET THE BASE OF AVAILABLE BINS TABLE       HYG03480
       STA     AVAL1         ON THE TOP OF L TABLE.                     HYG03490
       STA     AVAL2                                                    HYG03500
       STA     ERAPR-21                                                 HYG03510
       LAC     ATLT,2        FIND OUT                                   HYG03520
       SXA     NWATLT,2      THE TOTAL                                  HYG03530
       LDQ     ATLT          NUMBER                                     HYG03540
TSTBIN MPY     BNMINS        OF BINS                                    HYG03550
       XCA                   AVAILABLE.                                 HYG03560
       SUB     XFCKEQ        ARE THERE                                  HYG03570
       STO     AVLCEL        ENOUGH BINS                                HYG03580
       CAL     RCDLTH        TO CONTAIN THE                             HYG03590
       CAS     AVLCEL        LAST LOGICAL RECORD.                       HYG03600
       TRA     GETEXT        NO-GO TO GETEXT.                           HYG03610
       TRA     TSTMOD        YES-GO TO                                  HYG03620
       TRA     TSTMOD        YES-TSTMOD.                                HYG03630
SMALUP CAL     THISAV        GET NEW LENGTH OF                          HYG03640
       ADD     ONE           THE REMAINING                              HYG03650
       STA     NWATLT        AVAILABLE CELLS.                           HYG03660
       PAC     ,2                                                       HYG03670
       PXA     ,2                                                       HYG03680
       XCA                                                              HYG03690
       TRA     TSTBIN                                                   HYG03700
TSTMOD ZET     MOD05                                                    HYG03710
       CALL    XSM06         MODIFICATION EXIT.                         HYG03720
       TRA     MOVRCD        NORMAL RETURN.                             HYG03730
NOBIN  TRA     GETEXT        CANNOT REPLACE OR INSERT RECORD.           HYG03740
       TRA     FRMMOD        RECORD INSERTED.                           HYG03750
       TRA     ZROLCT        RECORD REPLACED.                           HYG03760
       STL     MODELT        RECORD DELETED.                            HYG03770
       TRA     ZROLCT                                                   HYG03780
MOVRCD CAL     **,1          REG1 HAS THE SAME VALUE AS ENTRY2.         HYG03790
       ADD     RCDLTH        DETERMINE THE BASE OF                      HYG03800
       STA     FILBIN        LOGICAL RECORD                             HYG03810
       STA     RCDND1        AND INITIALISE                             HYG03820
       LXA     RCDLTH,2      REG2 WITH RCDLTH.                          HYG03830
       SUB     ONE           PUT THE LAST LOCATION OF THE AREA VACATED  HYG03840
       STA     TMPBTP                                                   HYG03850
       CAL     BNMINS        INITIALISE REG 4 WITH                      HYG03860
       SUB     XCFLTH        BINLTH-FINALE WORD-XCFLTH                  HYG03870
       PAX     ,4            FOR FILLING UP THE FIRST BIN.              HYG03880
       LXA     NWATLT,1                                                 HYG03890
FINRCD CAL*    ERAPR-21      DETERMINE                                  HYG03900
       SXA     THISAV,1      THE BASE                                   HYG03910
       ADD     BINLTH        OF THE                                     HYG03920
       SUB     ONE           BIN (BINEND).                              HYG03930
       STA     BINEND                                                   HYG03940
       STA     BIN1                                                     HYG03950
       STA     BIN2                                                     HYG03960
       STA     BIN3                                                     HYG03970
       ZET     FRSTIM        IS IT FIRST TIME THRU FOR PARTICULAR RCD.  HYG03980
       TRA     FILBIN        NO-GO AND FILL UP THE NEXT BIN.            HYG03990
       NZT     OPTPR-3       YES-IS THERE ANY EQUALS OPTION.            HYG04000
       TRA     TSTCKS        NO-GO TO TSTCKS.                           HYG04010
       CAL     EQLSWD        YES-CALCULATE EQUALS WORD.                 HYG04020
       ADD     =1                                                       HYG04030
       SLW     EQLSWD                                                   HYG04040
BIN1   SLW     **,4          STORE EQUALS WORD INTO THE BIN.            HYG04050
       TIX     *+1,4,1                                                  HYG04060
TSTCKS NZT     OPTPR-1       IS THERE  CHECKSUM OPTION.                 HYG04070
       TRA     FILBIN        NO-GO TO FILBIN.                           HYG04080
       ZAC                   YES-CALCULATE CHECKSUM.                    HYG04090
RCDND1 ACL     **,2                                                     HYG04100
       TIX     *-1,2,1                                                  HYG04110
       ZET     OPTPR-3       IS THERE EQUALS OPTION.                    HYG04120
       ACL     EQLSWD        YES-ADD EQLSWD ALSO.                       HYG04130
       LXA     RCDLTH,2                                                 HYG04140
BIN2   SLW     **,4          STORE CHECKSUM INTO THE BIN.               HYG04150
       TIX     *+1,4,1                                                  HYG04160
FILBIN CAL     **,2          MOVE THE CONTROL WORD AND THE WORDS OF A   HYG04170
BIN3   SLW     **,4          LOGICAL RECORD INTO THE BINS.              HYG04180
       TIX     TIX,2,1       IS THE LOGICAL RECORD EXHAUSTED.           HYG04190
       STZ*    BINEND        YES-PUT ZEROES IN THE FINALE WORD.         HYG04200
       CAL     TMPBTP                                                   HYG04210
       STA     BUFTOP        IN BUFTOP-POINTER IS ON THE BLANK SIDE.    HYG04220
       TRA     ZROLCT        GO AND CHECK FOR READ COMPLETION.          HYG04230
TIX    TIX     FILBIN,4,1    NO-IS BIN EXHAUSTED.NO-GO FILL UP THE BIN. HYG04240
COMPAR TXH     *+3,2,**      YES-CAN THE REMAINING LOGICAL RECORD FIT   HYG04250
       SXD     FINALE,2      IN THE NEXT BIN.YES-PUT IT IN FINALE WORD. HYG04260
       TRA     *+3                                                      HYG04270
       LXA     BNMINS,1      NO-PUT BINLTH IN THE                       HYG04280
       SXD     FINALE,1      DECREMENT PORTION OF FINALE.               HYG04290
       LXA     THISAV,1      PUT THE ADDRESS OF THE                     HYG04300
       TXI     *+1,1,1       NEXT AVAILABLE BIN INTO THE                HYG04310
AVAL1  CAL     **,1          ADDRESS PORTION OF FINALE WORD.            HYG04320
       STA     FINALE                                                   HYG04330
       CAL     FINALE        PUT FINALE WORD IN THE                     HYG04340
       SLW*    BINEND        LAST WORD OF A BIN.                        HYG04350
       LXA     BNMINS,4      REINITIALIZE REG.4 WITH BNMINS.            HYG04360
       STL     FRSTIM                                                   HYG04370
       TRA     FINRCD        GO AND FINISH THIS LOGICAL RECORD.         HYG04380
ZROLCT LXA     LCTBEP,1      ZERO OUT THE CELLS IN                      HYG04390
LCTB8  STZ     **,1          LOCTAB WHICH HAVE BEEN MOVED INTO THE BINS.HYG04400
       TIX     *+2,1,1       POINT TO THE NEXT                          HYG04410
       LXA     LCTBLT,1      LOCATION IN LOCATE TABLE.                  HYG04420
       SXA     LCTBEP,1                                                 HYG04430
       NZT     MODELT                                                   HYG04440
       TRA     FRMMOD                                                   HYG04450
       STZ     MODELT                                                   HYG04460
       TRA     FROMOD                                                   HYG04470
FRMMOD STZ     FRSTIM                                                   HYG04480
       LXA     SRTBBP,2      SRTBBP HAS                                 HYG04490
       CAL     RCDLTH        SRTBLT INITIALLY.                          HYG04500
       ADD     XFCKEQ        PUT THE LENGTH OF                          HYG04510
       SBM     XCFLTH        CKSM+EQUAL+CONTROL WORD+LOGICAL RECORD     HYG04520
       LGL     18            IN THE DECR. PART                          HYG04530
       NZT     SHYPER                                                   HYG04540
       TRA     *+3                                                      HYG04550
       ORA     =O400000100000                                           HYG04560
       TRA     *+2                                                      HYG04570
       ORA     =O600000100000   AND THE LOCATION OF                     HYG04580
SRTB1  SLW     **,2          THE FIRST BIN INTO                         HYG04590
       LXA     NWATLT,1      THE ADDRESS PORTION OF                     HYG04600
AVAL2  CAL     **,1          THE INSTRUCTION IN THE SORT TABLE.         HYG04610
       ADM     XCFLTH                                                   HYG04620
SRTB2  STA     **,2          IN SHORT-UPDATE THE SORT TABLE.            HYG04630
       TIX     *+4,2,1       IS SORT TABLE FULL.                        HYG04640
       TXI     *+1,2,-1      YES-REDUCE IT TO ZERO AND                  HYG04650
       SXA     SRTBBP,2      SAVE IT.                                   HYG04660
       TRA     GETEXT        GO TO GETEXT.                              HYG04670
       SXA     SRTBBP,2      NO-SAVE REG2.                              HYG04680
FROMOD ZET     SWTCHF        IS IT EOF.                                 HYG04690
       TRA     SETNCM        YES-GO TO SETNCM.                          HYG04700
       CAL     SWTCHA        NO-IS READ                                 HYG04710
       TZE     SETNCM        COMPLETE.                                  HYG04720
       NZT     DUMPSW        YES-IS DUMP SWITCH SET.                    HYG04730
       ZET     SWTCHR        NO-IS SWITCH R SET.                        HYG04740
       TRA     GETEXT        YES-GO TO GETEXT.                          HYG04750
       STL     NOTCMP        NO-SET NOTCMP SWITCH AND                   HYG04760
       TRA     RDAGAN        THEN GO TO RDAGAN.                         HYG04770
SETNCM STL     NOTCMP        NO-SET NOTCMP SWITCH AND                   HYG04780
       TRA     ENTRY2        GO TO ENTRY2.                              HYG04790
GETEXT LXA     THISAV,1      REDUCE THISAV BY 1 AS THIS                 HYG04800
       TXI     *+1,1,1       BIN HAS ALREADY                            HYG04810
       PXA     ,1            BEEN USED UP.                              HYG04820
       PAC     ,1                                                       HYG04830
       SXD     ERAPR-3,1                                                HYG04840
       CAL     SRTBLT        GIVE THE LENGTH                            HYG04850
       SUB     SRTBBP        OF SORT TABLE.                             HYG04860
       LGL     18                                                       HYG04870
       STD     ERAPR-9       NOTE THAT IT HAS THE SAME LOCATION.        HYG04880
EXTRGS AXT     **,1                                                     HYG04890
       AXT     **,2                                                     HYG04900
       AXT     **,4                                                     HYG04910
       STL     GENPR-5                                                  HYG04920
       STZ     NOTCMP                                                   HYG04930
       TRA     1,4           GO BACK TO XS.                             HYG04940
       EJECT                                                            HYG04950
************************************************************************HYG04960
*  CONVERSION OF CONTROL WORD FROM BCD TO BINARY.                       HYG04970
************************************************************************HYG04980
       SPACE   2                                                        HYG04990
DECBIN SXA     DECSV4,4                                                 HYG05000
       LDQ     WDCONT                                                   HYG05010
       AXT     30,4                                                     HYG05020
       ZAC                                                              HYG05030
       STZ     DEC1          ZERO OUT SUM HOLDER.                       HYG05040
DECBLP LGL     6             GET NEXT DIGIT.                            HYG05050
       ACL     DEC1          ADD SUM HOLDER.                            HYG05060
       TNX     DECONT,4,6    TO EXIT IF FINISHED.                       HYG05070
       STQ     DEC2                                                     HYG05080
       XCL                                                              HYG05090
       MPY     =10                                                      HYG05100
       STQ     DEC1          SAVE PARTIAL PRODUCT.                      HYG05110
       LDQ     DEC2                                                     HYG05120
       TRA     DECBLP                                                   HYG05130
DECONT XCL                                                              HYG05140
       ZAC                                                              HYG05150
       DVP     =6            IS THE CONTROL WORD MULTIPLE OF 6.         HYG05160
       TNZ     NOTMLT        NO-GO TO NOTMLT.                           HYG05170
       STQ     WDCONT        YES.                                       HYG05180
       XCL                                                              HYG05190
DECSV4 AXT     **,4                                                     HYG05200
       TRA     1,4                                                      HYG05210
NOTMLT TRA     ERROR         GO AND PRINT THE MESSAGE AND DELETE SORT.  HYG05220
       EJECT                                                            HYG05230
************************************************************************HYG05240
*                  SELECT    ROUTINE                                    HYG05250
************************************************************************HYG05260
       SPACE   2                                                        HYG05270
SELECT SXA     SAVIOX,1      SAVE                                       HYG05280
       SXA     SAVIOX+1,2    ALL THE                                    HYG05290
       SXA     SAVIOX+2,4    REGS.                                      HYG05300
       TMI     RSELM         IF AC IS MINUS-GO TO RSELM.                HYG05310
       SPACE   5                                                        HYG05320
*                                                                       HYG05330
*      SELECT (+) ROUTINE                                               HYG05340
*                                                                       HYG05350
       STZ     SWTCHA                                                   HYG05360
       NZT     HYPER         IS IT HYPER.                               HYG05370
       TRA     TP729         NO.                                        HYG05380
       CAL     SMSADR        YES-INITIALIZE                             HYG05390
       STA*    (RCHXI        TO READ HYPER TAPE.                        HYG05400
       CLA*    LOCUCB        GET UNIT NUMBER.                           HYG05410
       ANA     =O17000000                                               HYG05420
       PDX     ,4                                                       HYG05430
       TXI     *+1,4,8576                                               HYG05440
       SXD     HSEL,4                                                   HYG05450
       TRA     CKRDNC                                                   HYG05460
TP729  CAL     SWIORT        INITIALIZE                                 HYG05470
       STA*    (RCHXI        TO READ 729 TAPE.                          HYG05480
CKRDNC CAL     REDNCY        WAS THE LAST RECORD REDUNDANT.             HYG05490
       TNZ     BFREAD        YES.                                       HYG05500
       CAL     SWTCHL        NO-IS SWITCH L SET.                        HYG05510
       TNZ     R2000         YES-GO TO R2000.                           HYG05520
       AXT     MAXBP1,2      NO-MODIFY ADDD                             HYG05530
       SXA     ADDD,2        BY MAXBP1.                                 HYG05540
       CAL     TPTOBF        PUT THE RCKWRD                             HYG05550
ADDD   ADD     **            VIZ.171717171717 INTO THE                  HYG05560
       SLW     CKWORD        LAST CELL OF THE BUFFER                    HYG05570
       CAL     RCKWRD        WHERE THE LONGEST                          HYG05580
       SLW*    CKWORD        RECORD IS TO BE READ.                      HYG05590
       TRA     BFREAD                                                   HYG05600
R2000  AXT     T000M,2       MODIFY ADDD                                HYG05610
       SXA     ADDD,2        BY T000M.                                  HYG05620
       TRA     ADDD-1                                                   HYG05630
BFREAD NZT     HYPER         IS IT HYPER.                               HYG05640
RDS    RDS     **            NO-READ 729 TAPE.                          HYG05650
       XEC*    (RCHXI        YES-READ HYPER TAPE.                       HYG05660
       STL     REDNCY        SET SWITCH CALLED REDNCY.                  HYG05670
       TRA     SAVIOX                                                   HYG05680
       SPACE   10                                                       HYG05690
*                                                                       HYG05700
*     SELECT (-) ROUTINE                                                HYG05710
*                                                                       HYG05720
RSELM  STZ     REDNCY        RESET SWITCH CALLED REDNCY.                HYG05730
       ZET     HYPER         IS IT HYPER.                               HYG05740
       TRA     LFT           YES.                                       HYG05750
       LNT     400000        IS IT A NOISE RECORD.                   (4)HYG05760
       TRA     2,4           YES-GO BACK TO IOEX                     (4)HYG05770
       LFT     300000        IS IT PERM. REDUNDANCY OR EOF           (4)HYG05780
       TRA     TSTEOF        YES                                     (4)HYG05790
       CAL     TPTOBF        NO.                                        HYG05800
ZET    ZET     SWTCHL        IS SWTCHL SET.                             HYG05810
       TRA     NOCHNG        YES.                                       HYG05820
       ADD     MAXBP1        NO-MAX.EXPECTED LENGTH TO SEE              HYG05830
       STA     CKLTRC        IF BLOCK IS LONGER THAN THE                HYG05840
       CAL*    CKLTRC        PARAMETER GIVEN BY THE USER.               HYG05850
       LAS     RCKWRD        IS IT LONGER THAN EXPECTED.                HYG05860
       TRA     LONGER        YES-GO TO LONGER.                          HYG05870
       TRA     OK            NO-GO TO OK.                               HYG05880
       TRA     LONGER        YES-GO TO LONGER.                          HYG05890
LFT    LFT     000010        IS IT PERMANENT REDUNDANCY.                HYG05900
       TRA     RIDNCY        YES.                                       HYG05910
       RFT     000010        NO-IS IT EOF.                              HYG05920
       TRA     SETR          YES.                                       HYG05930
       CAL     CPYD          NO.                                        HYG05940
       TRA     ZET           CHECK THE WORD FOLLOWING THE               HYG05950
NOCHNG ADD     T000M         2000 WORDS LONG RECORD TO SEE IF           HYG05960
       STA     CKLTRC        BLOCK IS LONGER THAN 2000 WORDS.           HYG05970
       CAL*    CKLTRC        IS IT LONGER                               HYG05980
       LAS     RCKWRD        THAN 2000 WORDS.                           HYG05990
       TRA     VRYLNG        YES-GO TO VRYLNG.                          HYG06000
       TRA     BITLNG        NO-GO TO BITLNG.                           HYG06010
       TRA     VRYLNG        YES-GO TO VRYLNG.                          HYG06020
VRYLNG STL     DUMPSW        SET DUMP SWITCH.                           HYG06030
       STZ     SWTCHL        RESET SWITCH L.                            HYG06040
       ZET     HYPER         IS IT HYPER.                               HYG06050
       TRA     CALCOM        YES.                                       HYG06060
       CAL     (COMMM        NO-CHANGE THE COUNT IN THE                 HYG06070
       SBM     TPTOBF        DECR. PART OF THE IORT                     HYG06080
       LGL     18            INSTRUCTION TO THE ACTUAL                  HYG06090
       STD     TPTOBF        LENGTH OF THE TAPE BLOCK.                  HYG06100
PRINT  TSX     PRINTR,4      GO AND PRINT THE MESSAGE.                  HYG06110
       TRA     RELESE        GO TO RELESE.                              HYG06120
CALCOM CAL     (COMMM                                                   HYG06130
       LGR     18                                                       HYG06140
       ORA     MZE                                                      HYG06150
       SBM     CPYD                                                     HYG06160
       LGL     18                                                       HYG06170
       STD     CPYD                                                     HYG06180
       TRA     PRINT                                                    HYG06190
LGR    LGR     18                                                       HYG06200
       ORA     MZE                                                      HYG06210
       SBM     CPYD                                                     HYG06220
       TRA     PRNT                                                     HYG06230
BITLNG CAL     (COMMM                                                   HYG06240
       ZET     HYPER         IS IT HYPER.                               HYG06250
       TRA     LGR           YES.                                       HYG06260
       SBM     TPTOBF        NO.                                        HYG06270
PRNT   TSX     (DECVA,4                                                 HYG06280
       STQ     LGACMS+3      PRINT OUT THE MESSAGE SAYING-              HYG06290
       TSX     UNITSM,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          HYG06300
       TSX     (PROUT,4      LONG BLK ACCEPTED,XXXXXX,*RD11.            HYG06310
       PZE     1                                                        HYG06320
       PZE     LGACMS,,5                                                HYG06330
OK     CAL     TPTOBF                                                   HYG06340
       ZET     HYPER                                                    HYG06350
       CAL     CPYD                                                     HYG06360
       LXA     BFTBBP,1      BFTBBP HAS BFTBLT INITIALLY.               HYG06370
BFTB4  STA     **,1          PUT THE BEGINNING OF THE LAST              HYG06380
       CAL     (COMMM        RECORD READ INTO THE ADDRESS PART          HYG06390
       ZET     HYPER         (SKIP NSI FOR 7607 CHANNEL)                HYG06400
       LGR     18            (HYPER).                                   HYG06410
       LAC     FILPR,4       AND BEGINNING OF NEXT RECORD OR THE        HYG06420
       ZET     -19,4         LOC. OF THE CHECKSUM AND/OR BLOCK SEQ. OF  HYG06430
       SUB     ONE           THE LAST RECORD READ                       HYG06440
       LGL     18            IN THE DECR. PART OF THE                   HYG06450
BFTB5  STD     **,1          CELL IN THE BUFFER TABLE.                  HYG06460
       LGR     18                                                       HYG06470
       STA     BUFBOT                                                   HYG06480
       CAL     HYPER         IS IT HYPER.                               HYG06490
       TZE     CALCMM        NO.                                        HYG06500
       CAL     (COMMM        YES.                                       HYG06510
       LGR     18                                                       HYG06520
       ORA     MZE                                                      HYG06530
       SBM     CPYD                                                     HYG06540
       TRA     STA                                                      HYG06550
CALCMM CAL     (COMMM                                                   HYG06560
       SBM     TPTOBF                                                   HYG06570
STA    STA     HWLNG                                                    HYG06580
       TIX     *+2,1,1       IS IT THE END OF THE BUFFER TABLE.         HYG06590
       LXA     BFTBLT,1      YES-REINITIALIZE WITH BFTBLT.              HYG06600
       SXA     BFTBBP,1      NO-SAVE THE REMAINING LENGTH OF THE BUFTAB.HYG06610
       TSX     CKSQW,4       GO AND CHECK FOR CHECKSUM AND BLOCK SEQ.   HYG06620
       CAL     SWTCHL        IS SWITCH L SET.                           HYG06630
       TZE     READAG        NO-GO TO READAG.                           HYG06640
       STZ     SWTCHL        YES-RESET SWITCH L AND                     HYG06650
       CAL     MXBKP1        CHANGE THE WORD COUNT                      HYG06660
       LGL     18            FROM 2000 TO MXBKP1                        HYG06670
       STD     TPTOBF        IN THE IORT COMMAND.                       HYG06680
       STD     CPYD                                                     HYG06690
READAG LXA     BFTBBP,1      IS BUFFER TABLE                            HYG06700
BFTB7  CLA     **,1          FULL.                                      HYG06710
       TNZ     RELESE        YES-GO TO RELESE.                          HYG06720
       CLA     BUFBOT        NO.                                        HYG06730
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         HYG06740
       TZE     RELESE        IF ZERO-GO TO RELESE,                      HYG06750
       TMI     TPMIBT        IF MINUS-GO TO TPMIBT,                     HYG06760
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   HYG06770
       SBM     BUFBOT        CAN WE READ AGAIN                          HYG06780
       ADD     ONE           INTO THE BUFFER.                           HYG06790
       CAS     MXBKP1                                                   HYG06800
       TRA     *+3           YES-READ AGAIN                             HYG06810
       TRA     *+2           YES-INTO THE BUFFER.                       HYG06820
       TRA     RIDBIG        NO-GO TO RIDBIG.                           HYG06830
SAME2  CAL     BUFBOT        MODIFY TPTOBF TO                           HYG06840
       STA     TPTOBF        READ AGAIN INTO THE BUFFER.                HYG06850
       STA     CPYD                                                     HYG06860
       STZ     SWTCHA        RESET SWITCH A.                            HYG06870
       TRA     SAVIOX        GO TO SAVIOX.                              HYG06880
TPMIBT CAL     BUFTOP                                                   HYG06890
       SBM     BUFBOT        CAN WE READ AGAIN                          HYG06900
       ADD     ONE           INTO THE BUFFER.                           HYG06910
       CAS     MXBKP1                                                   HYG06920
       TRA     SAME2         YES-READ                                   HYG06930
       TRA     SAME2         YES-AGAIN.                                 HYG06940
       TRA     RELESE                                                   HYG06950
RIDBIG CAL     BUFTOP        CAN WE                                     HYG06960
       SBM     BUFRLC        READ FROM                                  HYG06970
       ADD     ONE           THE BEGINNING                              HYG06980
       CAS     MXBKP1        OF THE BUFFER.                             HYG06990
       TRA     *+3           YES                                        HYG07000
       TRA     *+2           YES.                                       HYG07010
       TRA     RELESE        NO-GO TO RELESE.                           HYG07020
SAME3  CAL     BUFRLC        MODIFY TPTOBF TO READ                      HYG07030
       TRA     SAME2+1       FROM THE BEGINNING OF THE BUFFER.          HYG07040
RELESE STZ*    UCW2          ZERO OUT SECOND WORD IN UCB.               HYG07050
       STL     SWTCHA        SET SWITCH A.                              HYG07060
SAVIOX AXT     **,1          RESTORE ALL                                HYG07070
       AXT     **,2          THE REGS. AND                              HYG07080
       AXT     **,4          GO BACK                                    HYG07090
       STL     GENPR-4       TO IOEX.                                   HYG07100
       TRA     1,4                                                      HYG07110
LONGER CAL     HYPER         IS IT HYPER.                               HYG07120
       TZE     NDATA         NO.                                        HYG07130
       TSX     (NDATA,4      YES. BACK SPACE 1 RECORD.                  HYG07140
       PZE     LOCUCB,,34                                               HYG07150
       TRA     SETSWL                                                   HYG07160
NDATA  TSX     (NDATA,4      BACK SPACE 1 RECORD.                       HYG07170
       PZE     LOCUCB,,5                                                HYG07180
SETSWL STL     SWTCHL        SET SWITCH L.                              HYG07190
       CAL     T000P         CHANGE THE WORD COUNT                      HYG07200
       LGL     18            IN TPTOBF TO 2000.                         HYG07210
       STD     TPTOBF                                                   HYG07220
       STD     CPYD                                                     HYG07230
       CLA     BUFBOT                                                   HYG07240
       SUB     BUFTOP        SEE BUFBOT-BUFTOP.                         HYG07250
       TZE     RELESE        IF ZERO-GO TO RELESE,                      HYG07260
       TMI     TPMYBT        IF MINUS-GO TO TPMYBT,                     HYG07270
       CAL     BUFRND        IF PLUS-GO THROUGH HERE.                   HYG07280
       SBM     BUFBOT        CAN WE READ 2000                           HYG07290
       ADD     ONE           WORDS AGAIN                                HYG07300
       CAS     T000P         INTO THE BUFFER.                           HYG07310
       TRA     *+3           YES-GO AND                                 HYG07320
       TRA     *+2           YES-READ.                                  HYG07330
       TRA     REDBEG        NO-GO TO REDBEG.                           HYG07340
       CAL     BUFBOT        MODIFY TPTOBF                              HYG07350
       STA     TPTOBF        TO READ AGAIN INTO THE BUFFER.             HYG07360
       STA     CPYD                                                     HYG07370
       STZ     SWTCHA        RESET SWITCH A.                            HYG07380
       TRA     SAVIOX        GO TO SAVIOX.                              HYG07390
REDBEG CAL     BUFTOP        CAN WE                                     HYG07400
       SBM     BUFRLC        READ 2000 WORDS                            HYG07410
       ADD     ONE           FROM THE BEGINNING                         HYG07420
       CAS     T000P         OF THE BUFFER.                             HYG07430
       TRA     SAME3         YES.                                       HYG07440
       TRA     SAME3         YES.                                       HYG07450
       TRA     RELESE        NO-GO TO RELESE.                           HYG07460
TPMYBT CAL     BUFTOP                                                   HYG07470
       SBM     BUFBOT        CAN WE READ                                HYG07480
       ADD     ONE           2000 WORDS AGAIN                           HYG07490
       CAS     T000P         INTO THE BUFFER.                           HYG07500
       TRA     SAME2         YES-READ                                   HYG07510
       TRA     SAME2         YES-AGAIN.                                 HYG07520
       TRA     RELESE        NO-GO TO RELESE.                           HYG07530
TSTEOF LFT     200000        IS IT EOF.                                 HYG07540
       TRA     SETR          YES-GO AND SET SWITCH R.                   HYG07550
RIDNCY STL     DUMPSW        NO-(PERMANENT REDNCY)-SET DUMP SWITCH.     HYG07560
       STL     SWTCHA        SET SWITCH A.                              HYG07570
       STZ*    UCW2          ZERO OUT UCW2.                             HYG07580
       CAL     HYPER         IS IT HYPER.                               HYG07590
       TZE     CALCMN        NO.                                        HYG07600
       CAL     (COMMM        YES.                                       HYG07610
       LGR     18                                                       HYG07620
       ORA     MZE                                                      HYG07630
       SBM     CPYD                                                     HYG07640
       LGL     18                                                       HYG07650
       STD     CPYD                                                     HYG07660
       TRA     LGR18                                                    HYG07670
CALCMN CAL     (COMMM        CHANGE THE                                 HYG07680
       SBM     TPTOBF        COUNT IN THE DECREMENT                     HYG07690
       LGL     18            PORTION OF IORT INSTRUCTION                HYG07700
       STD     TPTOBF        TO ACTUAL LENGTH OF                        HYG07710
LGR18  TSX     PRINTR,4      GO AND PRINT THE MESSAGE.                  HYG07720
       TRA     SAVIOX                                                   HYG07730
SETR   STL     SWTCHR                                                   HYG07740
       TRA     RELESE                                                   HYG07750
*                                                                       HYG07760
PRINTR SXA     RESTRE,4      ROUTINE TO PRINT THE MESSAGE SAYING-       HYG07770
       TSX     (DECVD,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          HYG07780
       STQ     DPMSG+3       UNRDBL RECORD DUMPED,XXXXXX,*RD01.         HYG07790
       TSX     UNITSM,4                                                 HYG07800
       TSX     (PROUT,4                                                 HYG07810
       PZE     1                                                        HYG07820
       PZE     DPMSG,,5                                                 HYG07830
RESTRE AXT     **,4                                                     HYG07840
       TRA     1,4                                                      HYG07850
*                                                                       HYG07860
UNITSM SXA     RESTOR,4      ROUTINE TO PRINT-                          HYG07870
       SXA     RESTOR+1,2    UNIT XX,FILE XXXXXX,RECORD XXXXXX.         HYG07880
       LAC     LOCUCB,2                                                 HYG07890
       CAL     2,2                                                      HYG07900
       TSX     (DECVD,4                                                 HYG07910
       STQ     UNTMSG+1                                                 HYG07920
       CAL     2,2                                                      HYG07930
       TSX     (DECVA,4                                                 HYG07940
       STQ     UNTMSG+4                                                 HYG07950
       LDQ     0,2                                                      HYG07960
       TSX     MSGSUP,4,3                                               HYG07970
       PZE     UNTMSG,,5                                                HYG07980
RESTOR AXT     **,4                                                     HYG07990
       AXT     **,2                                                     HYG08000
       TRA     1,4                                                      HYG08010
       EJECT                                                            HYG08020
************************************************************************HYG08030
*    CHECK SUM AND BLOCK SEQUENCE ROUTINE                               HYG08040
************************************************************************HYG08050
       SPACE   2                                                        HYG08060
CKSQW  SXA     SAVE4,4                                                  HYG08070
       CAL     (COMMM                                                   HYG08080
       ZET     HYPER                                                    HYG08090
       ARS     18            GET THE                                    HYG08100
       SUB     ONE           LAST WORD                                  HYG08110
       STA     SUMUP         IN A BLOCK.                                HYG08120
       STA     BBASE                                                    HYG08130
       LAC     FILPR,2       IS THERE A                                 HYG08140
       NZT     -8,2          CHECKSUM OPTION.                           HYG08150
       TRA     SUMOK         NO-GO TO SUMOK.                            HYG08160
       LXA     HWLNG,4       YES-CALCULATE                              HYG08170
       TXI     *+1,4,-1      THE CHECKSUM.                              HYG08180
       ZAC     ,0                                                       HYG08190
SUMUP  ACL     **,4                                                     HYG08200
       TIX     *-1,4,1                                                  HYG08210
       LGR     18                                                       HYG08220
       STZ     TEMP                                                     HYG08230
       SLQ     TEMP                                                     HYG08240
       ALS     18                                                       HYG08250
       ACL     TEMP                                                     HYG08260
       LBT                                                              HYG08270
       TRA     *+2           IS THE CALCULATED                          HYG08280
       ACL     =O1000000     CHECKSUM                                   HYG08290
       ERA*    BBASE         SAME AS THAT                               HYG08300
       ANA     =O777777000000 IN THE INPUT.                             HYG08310
       TZE     SUMOK         YES-GO TO SUMOK.                           HYG08320
       TSX     UNITSM,4      NO-PRINT OUT THE MESSAGE SAYING-           HYG08330
       TSX     (PROUT,4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          HYG08340
       PZE     1             INPUT CHKSM ERROR *RD02                    HYG08350
       PZE     MESAG8,,4                                                HYG08360
SUMOK  LAC     FILPR,4       IS THERE A                                 HYG08370
       NZT     -9,4          BLOCK SEQUENCE OPTION.                     HYG08380
       TRA     SEQOK         NO-GO TO SEQOK.                            HYG08390
       LAC     LOCUCB,2                                                 HYG08400
       CAL     2,2           YES-IS IT O.K.                             HYG08410
       ERA*    BBASE                                                    HYG08420
       PAX     ,4                                                       HYG08430
       TXL     SEQOK,4,0     YES-GO TO SEQOK.                           HYG08440
       CLA*    BBASE         NO-PRINT OUT THE                           HYG08450
       TSX     (DECVA,4      MESSAGE SAYING-                            HYG08460
       STQ     MESAG9+4      UNIT XX,FILE XXXXXX,RECORD XXXXXX          HYG08470
       TSX     UNITSM,4      INPUT BLOCK SEQ ERROR XXXXXX *RD03.        HYG08480
       TSX     (PROUT,4                                                 HYG08490
       PZE     1                                                        HYG08500
       PZE     MESAG9,,6                                                HYG08510
       CLA*    BBASE                                                    HYG08520
       STA     2,2                                                      HYG08530
SEQOK  BSS     0                                                        HYG08540
SAVE4  AXT     **,4                                                     HYG08550
       TRA     1,4                                                      HYG08560
       EJECT                                                            HYG08570
*                                                                       HYG08580
* CLOSE PRESENT FILE AND OPEN NEW FILE (IF ANY).                        HYG08590
*                                                                       HYG08600
CLOSE  CALL    SAVEW         SAVE CALLING SEQUENCE WORDS.               HYG08610
       STZ     RAWPR                                                    HYG08620
       STZ     SWTCHR                                                   HYG08630
       CALL    SCL           CLOSE OLD INPUT FILE.                      HYG08640
       TRA     *+2                                                      HYG08650
LSTRIL PZE                   NONZERO MEANS LAST REEL.                   HYG08660
       ZET     LSTRIL        ARE THERE MORE REELS.                      HYG08670
       TRA     SETF          NO-GO TO SETF.                             HYG08680
       NZT     OPTPR-2       TEST FOR NOCKPT OPTION.                    HYG08690
       CALL    CKPT          TAKE CHECKPOINT.                           HYG08700
       STZ     RAWPR         YES.                                       HYG08710
       CALL    IOPEN         OPEN NEW INPUT FILE.                       HYG08720
       CALL    RESTW         RESTORE CALLING SEQUENCE WORDS.            HYG08730
       TRA     RDAGAN                                                   HYG08740
SETF   STL     SWTCHF                                                   HYG08750
       STZ*    UCW2                                                     HYG08760
       TRA     ENTRY1                                                   HYG08770
       SPACE   10                                                       HYG08780
************************************************************************HYG08790
*   CONSTANTS AND SWITCHES.                                             HYG08800
************************************************************************HYG08810
       SPACE   2                                                        HYG08820
OPTPR  COMMON  15            OPTION CARD PARAMETERS.                    HYG08830
OVEPR  COMMON  2             OVERFLOW CARD PARAMETERS.                  HYG08840
LABPR  COMMON  5             LABEL CARD PARAMETERS.                     HYG08850
CHAPR  COMMON  6             CHANNEL CARD PARAMETERS.                   HYG08860
FILPR  COMMON  14            FILE CARD PARAMETERS.                      HYG08870
 MODPR COMMON  50             MODIFICATION CARD PARAMETERS              HYG08880
RECPR  COMMON  10            RECORD CARD PARAMETERS.                    HYG08890
DELPR  COMMON  2             DELETE CARD PARAMETERS.                    HYG08900
SAMPR  COMMON  7             SORT AND MERGE CARD PARAMETERS.            HYG08910
CALPR  COMMON  50            CALCULATED PARAMETERS.                     HYG08920
GENPR  COMMON  10            GENERAL PARAMETERS.                        HYG08930
RAWPR  COMMON  30            READ AND WRITE PARAMETERS                  HYG08940
CNTPR  COMMON  20            COUNT PARAMETERS.                          HYG08950
ERAPR  COMMON  30            ERASABLE STORAGE PARAMETERS.               HYG08960
REFPR  COMMON  1             REFERENCED PARAMETERS PARAMETER.           HYG08970
       EXTERN  MSGSUP                                                   HYG08980
GETSWT DEC     0                                                        HYG08990
SWTCHA EQU     RAWPR-2                                                  HYG09000
SWTCHR DEC     0                                                        HYG09010
SWTCHF EQU     RAWPR-24                                                 HYG09020
MOD05  EQU     MODPR-5                                                  HYG09030
SWTCHL DEC     0                                                        HYG09040
SELLOC PZE     0,0,SELECT                                               HYG09050
TPTOBF IORT    **,,**                                                   HYG09060
FINALE IOSP    **,,**                                                   HYG09070
ONE    DEC     1                                                        HYG09080
TMPBTP DEC     0                                                        HYG09090
XCFLTH DEC     0                                                        HYG09100
XFCKEQ DEC     0                                                        HYG09110
NEXTRC DEC     0                                                        HYG09120
SERCH  DEC     0                                                        HYG09130
WDCONT DEC     0                                                        HYG09140
DEC1   DEC     0                                                        HYG09150
DEC2   DEC     0                                                        HYG09160
BUFTOP EQU     ERAPR-23                                                 HYG09170
BUFBOT DEC     0                                                        HYG09180
BFTBLT DEC     0                                                        HYG09190
SRTBLT DEC     0                                                        HYG09200
LCTBLT DEC     0                                                        HYG09210
BUFRLT DEC     0                                                        HYG09220
BUFRLC DEC     0                                                        HYG09230
BUFRND DEC     0                                                        HYG09240
LCTBND DEC     0                                                        HYG09250
BFTBEP DEC     0                                                        HYG09260
LCTBEP DEC     0                                                        HYG09270
LCTBBP DEC     0                                                        HYG09280
ATLT   DEC     0                                                        HYG09290
BINLTH DEC     0                                                        HYG09300
BNMINS DEC     0                                                        HYG09310
MXBKP1 DEC     0                                                        HYG09320
NOTCMP DEC     0                                                        HYG09330
RCDLTH EQU     ERAPR-25                                                 HYG09340
NWATLT DEC     0                                                        HYG09350
EQLSWD EQU     ERAPR-24                                                 HYG09360
THISAV EQU     ERAPR-22                                                 HYG09370
MODELT DEC     0                                                        HYG09380
LOCUCB DEC     0                                                        HYG09390
REDNCY DEC     0                                                        HYG09400
CKWORD DEC     0                                                        HYG09410
RCKWRD OCT     171717171717                                             HYG09420
SWIORT PZE     TPTOBF                                                   HYG09430
D2000  DEC     2000                                                     HYG09440
CKLTRC DEC     0                                                        HYG09450
HWLNG  DEC     0                                                        HYG09460
UCW2   DEC     0                                                        HYG09470
UCW3   DEC     0                                                        HYG09480
HYPER  DEC     0                                                        HYG09490
MZE    MZE     0                                                        HYG09500
SMSADR PZE     SMS                                                      HYG09510
SMS    SMS     70                                                       HYG09520
       CTLR    HSEL                                                     HYG09530
CPYD   CPYD    **,,**                                                   HYG09540
       TCH     SYSTWT                                                   HYG09550
HSEL   OCT     120600120112  HSEL ** AND HEOS.                          HYG09560
BBASE  DEC     0                                                        HYG09570
TEMP   DEC     0                                                        HYG09580
SRTBBP DEC     0                                                        HYG09590
BFTBBP DEC     0                                                        HYG09600
AVLCEL DEC     0                                                        HYG09610
BINEND DEC     0                                                        HYG09620
DUMPSW DEC     0                                                        HYG09630
RCMSG  DEC     0                                                        HYG09640
FRSTIM DEC     0                                                        HYG09650
MAXBP1 DEC     0                                                        HYG09660
T000P  DEC     0                                                        HYG09670
T000M  DEC     0                                                        HYG09680
SHYPER DEC     0                                                        HYG09690
DPMSG  BCI     5,UNRDBL BLK DUMPED        *RD01                         HYG09700
UNTMSG BCI     5, FILE XXXXXX,  RECORD   XXXXXX                         HYG09710
MESAG5 BCI     4,RECORD AT LOC.                                         HYG09720
MESAG6 BCI     5,INVALID RECORD FORMAT *VR01                            HYG09730
MESAG7 BCI     5,PRESS START TO DELETE SORT                             HYG09740
MESAG8 BCI     4,INPUT CHKSM ERROR *RD02                                HYG09750
MESAG9 BCI     6,INPUT BLOCK SEQ ERROR          *RD03                   HYG09760
LGACMS BCI     5,LONG BLK ACCEPTED        *RD11                         HYG09770
       END                                                              HYG09780
