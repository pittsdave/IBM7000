$JOB           ASSEMBLE IOCS
$EXECUTE       IBSFAP
*      FAP
       PCC                                                              IOA00000
       COUNT   7600                                                    $IOA00010
*                  7090/7094  IOCS     7090-IO-919-IOCS-VERSION  6      IOA00020
       ABS                                                              IOA00030
       SST                                                              IOA00040
       TITLE                                                            IOA00050
*                   IOCS INPUT/OUTPUT CONTROL SYSTEM                    IOA00060
*                   VERSION 6   MODIFICATION LEVEL 5                 (5)IOA00061
       SPACE   1                                                        IOA00070
*     THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO       IOA00080
*       THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD         IOA00090
       SPACE   1                                                        IOA00100
*                            SYSTEM PRINTER                             IOA00110
       SPACE   1                                                        IOA00120
*         PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10           IOA00130
EJECT  EQU     1                                                        IOA00140
       SPACE   1                                                        IOA00150
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       IOA00160
DBLSP  EQU     4                                                        IOA00170
       SPACE   1                                                        IOA00180
*               LINES PER PAGE FOR PREPROCESSOR PRINTING                IOA00190
BCTLN  EQU     50                                                       IOA00200
       SPACE   1                                                        IOA00210
*                            SENSE SWITCHES                             IOA00220
       SPACE   1                                                        IOA00230
*   SENSE SWITCH FOR CHECKPOINT CONTROL. DOWN INITIATES CHECKPOINT.     IOA00240
SWTCP  EQU     2                                                        IOA00250
       SPACE   1                                                        IOA00260
*      SENSE SWITCH FOR LABEL CONTROL. DOWN IGNORES LABEL ERRORS.       IOA00270
LERIG  EQU     3                                                        IOA00280
       SPACE   1                                                        IOA00290
*  STANDARD FILE BLOCK ORIGIN. IF=0, ORIGIN IMMEDIATELY FOLLOWS IOCS.   IOA00300
SFBO   EQU     0                                                        IOA00310
       SPACE   1                                                        IOA00320
*        STANDARD DENSITY OF LABELED BLANK TAPE. 0=LOW, 1=HIGH.         IOA00330
SLDEN  EQU     0                                                        IOA00340
       SPACE   1                                                        IOA00350
 NOCH  SET     5     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM IOA00360
       SPACE   1                                                       $IOA00370
NOHYP  EQU     0                   NO HYPERTAPE DEFINED IN IOCS         IOA00380
       SPACE   1                                                       $IOA00390
*           END OF EQU CARDS TO BE DEFINED BY INSTALLATION.             IOA00400
       TTL     INTERMEDIATE DEFINITIONS                                 IOA00410
PROUT  EQU     (PROUT                                                   IOA00420
PAWS   EQU     (PAWSX                                                   IOA00430
NDATA  EQU     (NDATA                                                   IOA00440
BPRNT  EQU     (PROUT                                                   IOA00450
BSK1   EQU     EJECT                                                    IOA00460
BPAWS  EQU     (PAWSX                                                   IOA00470
PAUSE  EQU     (PAUSE                                                   IOA00480
STOP   EQU     (STOPX                                                   IOA00490
ACTV   EQU     (ACTIV                                                   IOA00500
TRPSW  EQU     (TRPSW                                                   IOA00510
TRAPS  EQU     (TRAPS                                                   IOA00520
CVPRT  EQU     (CVPRT                                                   IOA00530
BCD5   EQU     (BCD5X                                                   IOA00540
COMM   EQU     (COMMM                                                   IOA00550
LTPOS  EQU     (LTPOS                                                   IOA00560
INTRAP EQU     (TRPSW                                                   IOA00570
SYUNCV EQU     (SYMUN                                                   IOA00580
       TTL     IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION.   IOA00590
       SPACE   1                                                        IOA00600
       BES     SYSCUR-*                                                 IOA00610
       BCI     1,IOCS                                                   IOA00620
       BES     SYSORG-*            ORIGIN AT COMMON SYSTEM ORG.         IOA00630
IOCS   TTR     JOBEND              END OF JOB                           IOA00640
       BES     3                                                       *IOA00650
DEFINE STL     ROUTE               DEFINE A BUFFER POOL                 IOA00660
       TXL     ENTRY,,DEFIN.                                            IOA00670
JOIN   STL     ROUTE               JOIN TWO BUFFER POOLS                IOA00680
       TXL     ENTRY,,JOINX                                             IOA00690
ATTACH STL     ROUTE               ATTACH FILES TO A                    IOA00700
       TXL     ENTRY,,ATTCH.       BUFFER POOL                          IOA00710
CLOSE  STL     ROUTE               CLOSE FILE(S),OPTIONALLY             IOA00720
       TXL     ENTRY,,CLOSE.       DETACHING FROM A POOL                IOA00730
OPEN   STL     ROUTE               OPEN A FILE                          IOA00740
       TXL     ENTRY,,OPEN.                                             IOA00750
READ   STL     ROUTE               BUFFERED READ                        IOA00760
       TXL     ENTRY,,READ.                                             IOA00770
WRITE  STL     ROUTE               BUFFERED WRITE                       IOA00780
       TXL     ENTRY,,WRITE.                                            IOA00790
COPY   STL     ROUTE               TRANSFER INPUT BUFFER(S)             IOA00800
       TXL     ENTRY,,COPY.        TO OUTPUT FILE                       IOA00810
REW    STL     ROUTE               REWIND A FILE                        IOA00820
       TXL     ENTRY,,REW.                                              IOA00830
WEF    STL     ROUTE               WEF (OUTPUT FILE ONLY)               IOA00840
       TXL     ENTRY,,WEF.                                              IOA00850
BSR    STL     ROUTE               BACKSPACE PHYSICAL                   IOA00860
       TXL     ENTRY,,BSR.         RECORD                               IOA00870
BSF    STL     ROUTE               BACKSPACE TO BEGINNING               IOA00880
       TXL     ENTRY,,BSF.         OF DATA FILE                         IOA00890
CKPT   STL     ROUTE               INITIATE CHECKPOINT                  IOA00900
       TRA     CKPT.               ON CHECKPOINT FILE                   IOA00910
STASH  STL     ROUTE               BUFFER TRANSFER                      IOA00920
       TXL     ENTRY,,STASH.                                            IOA00930
READR  STL     ROUTE               BUFFERED READ WITH                  $IOA00940
       TXL     ENTRY,,READR1       NO RELEASE OF LAST BUF              $IOA00950
RELESE STL     ROUTE               RELEASE THE BUFFER                  $IOA00960
       TXL     ENTRY,,RELASE                                           $IOA00970
       BES     2                                                       $IOA00980
       TTL 0                                                            IOA00990
MWR    TTR     (PROUT              MESSAGE WRITER                       IOA01000
DATE   BCI     1,00 000            SYSTEM DATE CELL                     IOA01010
JOBID  BCI     3,                   JOB NAME                            IOA01020
LAREA  BSS     14                  LABEL AREA                           IOA01030
LFLBLK MZE     **,,**              L(FILE BLOCK),,SIZE                  IOA01040
CPFILE PZE     **                  CURRENT CHECKPOINT FILE              IOA01050
CPSEQ  BCI     1, 00001            SEQ NUMBER + 1 OF LAST CHECKPOINT    IOA01060
LTSX   PZE     0,,**               L(TSX)                               IOA01070
XEOB   PZE     0,,**               L( EOB EXIT)                         IOA01080
XEOF   PZE     **,,0               L( EOF EXIT)                         IOA01090
XERR   PZE     0,,**               L( ERROR EXIT)                       IOA01100
LTRAD  PZE     **,,0               LAST TRANSMIT ADDRESS                IOA01110
TRANS  PZE     **,,0               TRANSMIT ADDRESS                     IOA01120
WDCT   PZE     0,,**               WORD COUNT                           IOA01130
IRS    PZE     **,,**              INDEX REGISTER STORAGE               IOA01140
SENSE  PZE     0,,0                SENSE INDICATOR STORAGE              IOA01150
FCW    IORT    **,,**              IO WORD FOR BUFS AND IN IOCS SWITCH  IOA01160
LAREA1 BSS     6                   EXTRA HYPERTAPE LABEL AREA          $IOA01170
RANDEF TRA     RANMOR                                                  $IOA01180
RANREQ TRA     RANMOR+2                                                $IOA01190
RANCLS TRA     RANMOR+4                                                $IOA01200
RANRPL TRA     RANMOR+6                                                $IOA01210
RANFLG PZE                                                             $IOA01220
RANCAV PZE                                                             $IOA01230
RANMOR BOOL    15000                                                   $IOA01240
LUNBLK PZE     UBLOK,,**           LOC. AND LENGTH RESERVE UNIT BLOCK   IOA01250
CKPT1  TTR     CHCPT                                                    IOA01260
SWITCD TTR     MONSW               POST SWITCH OF SYSTEM UNITS          IOA01270
MONEOF TTR     TEOR                TEST FOR END OF REEL                 IOA01280
*                           CONTROL SWITCHES                            IOA01290
       SPACE   1                                                        IOA01300
SWTC   SWT     SWTCP                                                    IOA01310
SWTE   SWT     LERIG                                                    IOA01320
       TTL                   CONSTANT POOL                              IOA01330
L(0)   PZE                                                              IOA01340
L(1)   PZE     1                                                       $IOA01350
L(6)   PZE     6                                                       $IOA01360
L(22)  PZE     22                                                      $IOA01370
L(377) OCT     377                                                      IOA01380
L(400) OCT     400                                                      IOA01390
ADDRS  PZE     -1                                                       IOA01400
1DEC   PZE     0,,1                                                     IOA01410
1B17   EQU     1DEC                                                     IOA01420
TTOCT  OCT     17600000                                                 IOA01430
L(0)D  PZE     0,,L(0)                                                  IOA01440
DECRE  PZE     0,,-1                                                    IOA01450
1PRE   PON                                                              IOA01460
FOR    FOR                                                              IOA01470
SIX    SIX                                                              IOA01480
6PRE   EQU     SIX                                                      IOA01490
L(DWRC OCT     100677777777                                            $IOA01500
LDWRC  OCT     000600000000                                            $IOA01510
L(40)  PZE     40                                                      $IOA01520
BVDG   OCT     020100000000                                            $IOA01530
DEC15  OCT     000017000000                                            $IOA01540
BLNKS  BCI     1,                                                       IOA01550
7PRE   SVN                                                              IOA01560
B1FIN  BSS     0                                                        IOA01570
       TTL              IOCS LOADER                                     IOA01580
       LBL     LOAD0000,1                                               IOA01590
       SPACE   1                                                        IOA01600
       BES     SYSTRA-*                                                 IOA01610
       TRA     BV00                                                     IOA01620
       BES     SYSEND-300-*                                            *IOA01630
BV00   TSX     (PROUT,4            PRINT SIGN ON INFO                   IOA01640
       PZE     1                   FOR OPERATOR                         IOA01650
       PZE     BV12,,9+512*DBLSP   X                                    IOA01660
       CLA     SYSJOB              TELL IBSYS THAT IOCS                *IOA01670
       SSM                         MAY HAVE CHANGED THE                *IOA01680
       STO     SYSJOB              AVAILABILITY CHAIN                  *IOA01690
       AXT     2,4                 SET UP TO READ IN                    IOA01700
       SXA     BRECT,4             PREPROCESSOR                         IOA01710
       LAC     SYSPOS,2                                                $IOA01720
       CLA     SYSLB1-1,2          GET SYSTEM TAPE U.C.B LOC.          $IOA01730
       STZ     BV03                REFERENCE TO SYSTAPE                $IOA01740
       STA     BV03                X                                   $IOA01750
       STA     BV01                X                                   $IOA01760
       TSX     BV01,4              READ IN PREPROCESSOR                 IOA01770
       LNT     20000               7909 CHANNEL                        $IOA01780
       TRA     BA00                TO PREPROCESSOR                     $IOA01790
       AXT     35,2                CHANGE NDATA SELECT                 $IOA01800
       SXD     BVD1+2,2            FOR A HYPER OP. OF                  $IOA01810
       SXD     BVD1+4,2            BACKSPACE                           $IOA01820
       TRA     BA00                TO PREPROCESSOR                     $IOA01830
BV12   BCI     6,BASIC MONITOR HAS ENTERED INPUT/OUTP                   IOA01840
       BCI     3,UT CONTROL SYSTEM.                                     IOA01850
       SPACE   1                                                        IOA01860
*                LOAD PROGRAM RECORDS FROM SYSTEM TAPE                  IOA01870
       BES     B1FIN-*                                                  IOA01880
BV01   AXC     **,2                PICK UP SYSTEM UCW                  $IOA01890
       SXA     BV02,4              SAVE IR4                             IOA01900
       LXA     BRECT,1             GET COUNT OF RECORDS                $IOA01910
       TXL     BV02,1,0            EXIT IF RECORD COUNT IS ZERO        $IOA01920
       LDI     0,2                 TEST UCB                            $IOA01930
       LFT     100                 FOR 1301                            $IOA01940
       TRA     BVD                 YES 1301                            $IOA01950
       CAL     BV04                SET UP SELECT                        IOA01960
       SLW     1,2                 IN UEW WORD 2                        IOA01970
       TSX     (ACTIV,4            ACTIVATE SYSTEM                      IOA01980
       PZE     BV03                CHANNEL                              IOA01990
       ZET     1,2                 WAIT UNTIL RECORDS                   IOA02000
       TRA     *-1                 ARE IN                               IOA02010
BV02   AXT     **,4                RESTORE IR4                          IOA02020
       TRA     1,4                 RETURN TO CALLER                     IOA02030
BRECT  BSS     1                   RECORD COUNT TO LOAD.                IOA02040
BV03   BSS     1                   INDIRECT REFERENCE TO SYSTAP         IOA02050
BVD    AXT     *+3,4                                                   $IOA02060
       SXA     SYSTRA,4                                                $IOA02070
       TSX     SYSLDR,4,0          LOAD FROM DISK                      $IOA02080
       LXA     BRECT,4             PICK UP RECORD COUNT AND SUBTRACT 1 $IOA02090
       TNX     BV02,4,1                                                $IOA02100
       SXA     BRECT,4                                                 $IOA02110
       TRA     *-4                                                     $IOA02120
BV04   PZE     BV91,,BV05          UCW SELECT WORD                      IOA02130
BV05   SXA     BV06,4              SELECT ROUTINE. SAVE IR4             IOA02140
       PAC     0,2                 PICKUP L(UCW) IN IR2                 IOA02150
       TMI     BV07                TEST SELECT + OR -                   IOA02160
       CAL     0,2                 SELECT PLUS PICKUP UCW               IOA02170
       PDX     0,4                 WORD 1. UNIT ADDRESS TO IR4.         IOA02180
       CAL     1,2                 GET COMMAND LOCATION                $IOA02190
       TXH     BV06+2,4,8192       IF HYPER, GO SET IT UP              $IOA02200
       TXI     *+1,4,16            SET BINARY MODE.                     IOA02210
       SXA     *+1,4               PUT IN SELECT ADDRESS                IOA02220
       RDS     **                  SELECT SYSTAP                        IOA02230
       STA*    (RCHXI              STORE IN RCH FOR SYSTEM              IOA02240
       XEC*    (RCHXI              CHANNEL AND EXECUTE RCH.             IOA02250
BV06   AXT     **,4                RELOAD IR4 AND RETURN                IOA02260
       TRA     1,4                 TO IOEX.                             IOA02270
       CLA     *+5                 GET LOC. OF SMS                     $IOA02280
       STA*    (RCHXI              STORE RCH FOR CHANNEL               $IOA02290
       PXA     0,4                 GET INTERFACE AND UNIT              $IOA02300
       ANA     L(377)              NO. FROM UCB                        $IOA02310
       LGR     5                   UNIT IN MQ                          $IOA02320
       ORS     BV13                STORE INTERFACE IN SMS              $IOA02330
       LGL     23                                                      $IOA02340
       ANA     DEC15                                                   $IOA02350
       ORS     BV13-1                                                  $IOA02360
       TRA     BV06-1                                                  $IOA02370
BV07   CAL     0,2                 IS THIS HYPER                       $IOA02380
       PDX     0,4                 TAPE OR NOT                         $IOA02390
       TXH     BV10+1,4,8192       GO HANDLE HYPER                     $IOA02400
       LFT     100000              POST COMPLETION OF IO               $IOA02410
       TRA     BV09                REDUNDANCY ON SYSTAP.                IOA02420
       LFT     200000              IF END OF FILE                       IOA02430
       TRA     BV06                KEEP ON GOING.                       IOA02440
       LXA     BRECT,4             PICK UP RECORD COUNT.                IOA02450
       TNX     BV08,4,1            ENOUGH RECORDS.                      IOA02460
       SXA     BRECT,4             NO. SAVE REMAINING                   IOA02470
       TRA     BV06                COUNT AND RETURN TO IOEX             IOA02480
BV08   STZ     1,2                 DONE. CLEAR UCW WORD 2               IOA02490
       STZ     BRECT               CLEAR RECORD COUNT                   IOA02500
       STZ     BV10                CLEAR REDUNDANCY FLAG                IOA02510
       TRA     BV06                RETURN TO IOEX                       IOA02520
BV09   ZET     BV10                REDUNDANCY ON SYSTAP                 IOA02530
       TRA     BV11                2ND TIME THRU.                       IOA02540
       LXA     BV06,4              1ST TIME. SETUP TO TRY               IOA02550
       STL     BV10                AGAIN.                               IOA02560
       TRA     3,4                 TAKE RETRY EXIT.                     IOA02570
BV10   PZE     **                  REDUNDANCY FLAG.                     IOA02580
       RFT     10                  IF END OF FILE                      $IOA02590
       TRA     BV08-5              KEEP GOING                          $IOA02600
       LFT     7100                UNUSUAL END TESTS                   $IOA02610
       TRA     BV09                HYPER ERROR ON SYSTAPE              $IOA02620
       TRA     BV08-4              GO DETERMINE IF FINISHED            $IOA02630
BV11   TSX     (PROUT,4            TELL OPERATOR ABOUT IT.              IOA02640
       PZE     1                   PRINT MESSAGE ON LINE                IOA02650
       PZE     *+3,,5              X                                    IOA02660
       TSX     (PAWSX,4            WAIT FOR HIS DECISION.               IOA02670
       TRA     BV09+2              HE SAYS RETRY.                       IOA02680
       BCI     5,REDUNDANCY ON SYSTEM TAPE.                             IOA02690
       OCT     120600120100        SELECT LESS UNIT PLUS END           $IOA02700
BV13   SMS     6                                                       $IOA02710
       CTLR    *-2                                                     $IOA02720
BV91   IOCP    *+1,,1                                                   IOA02730
       PZE     0                                                        IOA02740
       TCH     BV91                                                     IOA02750
BV92   PZE     *+1,,BV05                                                IOA02760
       IOCTN   15000,,77777        SKIP FOR RELOC. PROG.                IOA02770
       SPACE   1                                                        IOA02780
STOPD  STL     JOBERR              ERROR RETURN                        *IOA02790
JOBEND TSX     (PROUT,4                                                 IOA02800
       PZE     1                                                        IOA02810
       PZE     JMES,,2                                                  IOA02820
       XEC     BV01                                                    $IOA02830
       LDI     0,2                 TEST FOR                            $IOA02840
       LNT     20100               1301                                $IOA02850
       TRA     BVD1+1              NO                                  $IOA02860
       AXT     POST,4              YES  1301                           $IOA02870
       SXA     SYSTRA,4            SET UP AND                          $IOA02880
       TSX     SYSLDR,4,1          GO TO LOAD                          $IOA02890
BVD1   BCI     1,POST              POST RECORD FROM DISK               $IOA02900
       TSX     NDATA,4                                                 $IOA02910
       PZE     BV03,,BSFOP                                              IOA02920
       TSX     NDATA,4                                                  IOA02930
       PZE     BV03,,BSFOP                                              IOA02940
       AXT     1,4                 READ IN POST PROCESSOR               IOA02950
       SXA     BRECT,4                                                  IOA02960
       TSX     BV01,4                                                   IOA02970
       TRA     POST                                                     IOA02980
JMES   BCI     2, END OF JOB                                            IOA02990
JOBERR PZE     **                                                       IOA03000
       TTL         REEL SWITCH POSTING ROUTINE                          IOA03010
MONSW  CAL     0,2                 NOTE SWITCH IN                       IOA03020
       SXA     MONS4,4             SYSTEM UNITS                         IOA03030
       PAC     0,4                 TEST FOR                             IOA03040
       STD     *+1                 SAME UNIT                            IOA03050
       TXI     *+1,4,**            X                                    IOA03060
       TXH     *+3,4,0             SWAP ENTRIES                         IOA03070
MONS4  AXT     **,4                SAME UNIT.                           IOA03080
       TRA     1,4                 EXIT                                 IOA03090
       STA     MONS1               DIFFERENT UNITS SAVE L(UCW)1         IOA03100
       ARS     18                  X                                    IOA03110
       STA     MONS2               SAVE L(UCW)2                         IOA03120
       CAL     SYSUNI              GET INDEX TO SYSUNI                  IOA03130
       ARS     18                  COMPUTE INDEX ADDRESS                IOA03140
       ACL     SYSUNI              X                                    IOA03150
       STA     MONS3               X                                    IOA03160
       SXA     MONS5,2             SAVE IR2                             IOA03170
       LXD     SYSUNI,4            NUMBER OF UNITS IN SYSUNI            IOA03180
       LXD     SYSUNI,2            X                                    IOA03190
       STA     *+1                 X                                    IOA03200
MONS6  CAL     **,4                FIND SYSTEM FUNCTION                 IOA03210
       ANA     ADDRS               USING UNIT 1                         IOA03220
       ERA     MONS1               X                                    IOA03230
       TZE     *+3                 FOUND.                               IOA03240
       TIX     *-4,4,1             NOT YET.                             IOA03250
       TRA     MONS5               ALL DONE                             IOA03260
MONS3  CAL     **,2                FIND SYSTEM FUNCTION                 IOA03270
       ANA     ADDRS               USING UNIT 2                         IOA03280
       ERA     MONS2               X                                    IOA03290
       TZE     *+3                 FOUND.                               IOA03300
       TIX     MONS3,2,1           NOT YET.                             IOA03310
       TRA     MONS5               ALL DONE.                            IOA03320
       CLA     MONS1               SWITCH                               IOA03330
       STA*    MONS3               SYSTEM UNITS.                        IOA03340
       CLA     MONS2               X                                    IOA03350
       STA*    MONS6               X                                    IOA03360
MONS5  AXT     **,2                RESTORE IR2                          IOA03370
       TRA     MONS4               GO RESTORE IR1 AND EXIT.             IOA03380
MONS1  PZE     **                  UNIT 1 (L(UCW))                      IOA03390
MONS2  PZE     **                  UNIT 2 (L(UCW))                      IOA03400
       TTL 0                                                            IOA03410
TEOR   SXA     EORX4,4             SAVE IR4                             IOA03420
       STI     EORI                SAVE INDICATORS                      IOA03430
       CAL     EORT                SET UP SELECT                        IOA03440
       AXT     0,4                 TEST FOR                             IOA03450
       LDI*    0,2                 CARD UNIT                            IOA03460
       LFT     100                 X                                    IOA03470
       TRA     EORX4               ALWAYS EOF IF CARD UNIT              IOA03480
       AXC     1,4                 TO READ NEXT RECORD                  IOA03490
       SLW*    0,2                 AFTER END OF FILE                    IOA03500
       TSX     (NDATA,4            BACK SPACE OVER                      IOA03510
       PZE     0,2,BSROP           RECORD.                              IOA03520
       AXC     1,4                 WAIT TILL                            IOA03530
       ZET*    0,2                 ALL DONE.                            IOA03540
       TRA     *-1                 X                                    IOA03550
       CAL     LAREA               COMPARE WITH                         IOA03560
       ERA     MONEOR              MONITOR END REEL                     IOA03570
EORX4  AXT     **,4                RESTORE IR4                          IOA03580
       LDI     EORI                RESTORE INDICATORS                   IOA03590
       TZE     2,4                 EXIT IF END REEL                     IOA03600
       TRA     1,4                 END OF FILE.                         IOA03610
EORT   PZE     EORIOC,,*+1         SELECT WORD.                         IOA03620
       PAC     0,2                 SELECT ROUTINE.                      IOA03630
       TMI     EORM                TRANSFER IF POSTING.                 IOA03640
       LDI     0,2                                                     $IOA03650
       LFT     20000               HYPER                               $IOA03660
       TRA     EORH                YES                                 $IOA03670
       CAL     0,2                 SET UP FOR                           IOA03680
       ARS     18                  READ                                 IOA03690
       STA     *+1                 X                                    IOA03700
       RDS     **                  SELECT UNIT                          IOA03710
       CAL     1,2                 PICK UP COMMAND LOCATION.            IOA03720
       STA*    (RCHXI              INTO RCHX                            IOA03730
       XEC*    (RCHXI              READ INTO LABEL AREA.                IOA03740
       STZ*    (RCTXI              SUPPRESS REDUNDANCY CHECKING.        IOA03750
       TRA     1,4                 RETURN TO IOEX.                      IOA03760
EORM   STZ     1,2                 CLEAR UCB WORD 2                     IOA03770
       TRA     1,4                 RETURN TO IOEX.                      IOA03780
EORH   CLA     HYSEL                                                   $IOA03790
       ANS     HSMS+5                                                  $IOA03800
       PIA                                                             $IOA03810
       ANA     DEC15                                                   $IOA03820
       ORS     HSMS+5                                                  $IOA03830
       CAL     L(22)                                                   $IOA03840
       LFT     40                                                      $IOA03850
       ADD     L(1)                                                    $IOA03860
       STA     HSMS                                                    $IOA03870
       CAL     *-1                                                     $IOA03880
       TRA     EORM-4                                                  $IOA03890
HSMS   SMS     22                                                      $IOA03900
       CTLR    *+3                                                     $IOA03910
       CPYD    LAREA,,14                                               $IOA03920
       TCH     SYSTWT                                                  $IOA03930
       OCT     120600120112                                            $IOA03940
EORIOC IORT    LAREA,,14           COMMAND TO READ RECORD.              IOA03950
MONEOR BCI     1,$ENDRE            EL MONITOR END OF REEL DESIGNATION.  IOA03960
EORI   PZE     **,,**              TEMP STORAGE FOR INDICATORS          IOA03970
       EJECT                                                            IOA03980
BDZ4   RDS     **                  SIMULATE LOAD KEY SEQUENCE           IOA03990
BDZ5   RCHA    BDZ7                TO CALL PROGRAM                      IOA04000
BDZ6   LCHA    0                                                        IOA04010
       TRA     1                                                        IOA04020
UNBLK  BSS     0                   UP TO                                IOA04030
UBLOK  BSS     10                  TEN INTER SYSTEM RESERVE UNITS       IOA04040
       TCD     BV00                                                     IOA04050
       TTL     POST PROCESSOR                                           IOB00000
B2FIN  BSS     0                                                        IOB00010
       LBL     POST0000,1                                               IOB00020
POST   BCI     1,POST              NAME CELL FOR EDITOR                 IOB00030
       BES     B2FIN-*                                                  IOB00040
       NZT     LFLBLK              IF INITIAL ENTRY                     IOB00050
       TRA     POSTB               READ IN PREPROCESSOR                 IOB00060
       LXD     LUNBLK,2            GET LENGTH OF RESERVE UNIT           IOB00070
       LXD     LUNBLK,1                                                 IOB00080
       TXL     POSTA,1,0           BLOCK. EXIT IF NO ENTRIES.           IOB00090
       TXI     *+1,1,UBLOK         SETUP INDEX ADDRESS                  IOB00100
       ZET     JOBERR                                                   IOB00110
       TRA     POSTC                                                    IOB00120
       SXA     *+4,1               PUT SYMBOLIC DESIGNATION IN          IOB00130
       SXA     *+5,1               ADDRESS OF UCB WORD 1                IOB00140
       SXA     *+5,1               FOR EACH INTER SYSTEM RESERVE        IOB00150
       SXA     *+7,1               UNIT USED BY IOCS.                   IOB00160
       CAL     **,2                GET SYMBOL AND PUT                   IOB00170
       ARS     18                  IT IN ADDRESS                        IOB00180
       STA*    **,2                X                                    IOB00190
       LDI*    **,2                MAKE UNIT UNAVAILABLE                IOB00200
       RIL     200000              X                                    IOB00210
       SIL     400000              X                                    IOB00220
       STI*    **,2                X                                    IOB00230
       TIX     *-7,2,1             BACK FOR NEXT UNIT                   IOB00240
       SXD     LUNBLK,0            RESET COUNT OF RESERVE UNITS         IOB00250
       TRA     POSTA                                                    IOB00260
POSTC  SXA     *+2,1               RESET RESERVE STATUS BITS            IOB00270
       SXA     *+3,1               IN RESERVE UNITS USED BY             IOB00280
       LDI*    **,2                THIS JOB.                            IOB00290
       RIL     40000               X                                    IOB00300
       STI*    **,2                X                                    IOB00310
       TIX     *-3,2,1             X                                    IOB00320
POSTA  ZET     JOBERR              IF JOB HAD ERROR STOP                IOB00330
       TTR     SYSDMP              DUMP. OBJECT CODE IS STILL IN.       IOB00340
POSTB  CAL     L(1)                LOAD IN.                             IOB00350
       SLW     BRECT               PREPROCESSOR.                        IOB00360
       AXC     BA00-1,4            GIVE IT CONTROL BY                   IOB00370
       TRA     BV01                DUMMY TSX                            IOB00380
       TCD     POST                                                     IOB00390
       TTL     709/7090/7094 INPUT-OUTPUT CONTROL SYSTEM-PREPROCESSOR   IOC00000
       LBL     PREP0000,1                                               IOC00010
       SPACE   1                                                        IOC00020
*      THE PREPROCESSOR ASSUMES THE FOLLOWING MEMORY ALLOCATION-        IOC00030
*                     1. IOCS IN LOW-ORDER MEMORY.                      IOC00040
*                   2. PREPROCESSOR IN UPPER MEMORY.                    IOC00050
*    3. THE PREPROCESSOR USES WORKING STORAGE IMMEDIATELY FOLLOWING     IOC00060
*   THE IOCS. THE FILE BLOCK IS GENERATED HERE, AND IS MOVED UPWARD     IOC00070
*                 TO ITS FINAL LOCATION IF NECESSARY.                   IOC00080
       SPACE   1                                                        IOC00090
BORGB  EQU     SYSEND-4607                                              IOC00100
       SPACE   1                                                        IOC00110
*                      MISCELLANEOUS DEFINITIONS                        IOC00120
       SPACE   1                                                        IOC00130
BFCBL  EQU     12                  LENGTH OF A FILE CONTROL BLOCK       IOC00140
BDATB  EQU     DATE                DATE CELL (FILE FORM                 IOC00150
       TTL                   INITIALIZATION                             IOC00160
       BES     BORGB-*                                                  IOC00170
       BCI     1,PREP                                                   IOC00180
       BES     2-*                 INITIALIZE CELL 2                    IOC00190
       TTR     SYSDMP              FOR DUMP ON STR INSTRUCTION          IOC00200
       BES     CPFILE-*                                                 IOC00210
       PZE                         CLEAR LAST CHECKPOINT FILE           IOC00220
       BES     LAREA-*                                                  IOC00230
BDZ0   AXC     **,4                CLEAR MEMORY BLOCK BEYOND            IOC00240
       TXL     *+3,4,-SYSEND+200   WORKING FILE BLOCK                 **IOC00250
       STZ     0,4                 X                                    IOC00260
       TXI     *-2,4,-1            X                                    IOC00270
BDZ1   AXC     **,4                                                     IOC00280
       TXL     BDZ4,4,0            SKIP IF FILE BLOCK IS ZERO LENGTH    IOC00290
       TXI     *+1,4,1             MOVE FILE BLOCK UP TO FINAL          IOC00300
BDZ2   CAL     **,4                POSITION, CLEARING WORKING           IOC00310
       STZ*    *-1                 FILE BLOCK                           IOC00320
BDZ3   SLW     **,4                X                                    IOC00330
       TXH     *-4,4,0             X                                    IOC00340
       TRA     BDZ4                PUSH LOAD BUTTON                     IOC00350
BDZ7   IOCT    0,0,3                                                    IOC00360
       BES     LAREA1-*                                                $IOC00370
BDZ9   SMS     14                                                      $IOC00380
       CTLR    *+3                                                     $IOC00390
       CPYP    0,,3                                                    $IOC00400
       TCH     0                                                       $IOC00410
BDZA   OCT     120600120112                                            $IOC00420
       BES     BORGB-*                                                  IOC00430
BA00   CAL     SYSIN1              PICKUP SYSTEM INPUT UNIT            *IOC00440
       SLW     BX00                SET INPUT UNIT CELL                  IOC00450
       AXT     5,4                 INITIALIZE PREPROCESSOR COUNTS       IOC00460
       STZ     BCDCT+5,4                                                IOC00470
       TIX     *-1,4,1                                                  IOC00480
       CAL     SYSUAV                                                   IOC00490
       ARS     18                                                       IOC00500
       ACL     SYSUAV                                                   IOC00510
       STA     *+3                                                     $IOC00520
       LXD     SYSUAV,1                                                 IOC00530
       PXD     0,0                                                     $IOC00540
       STA     **,1                                                    $IOC00550
       TIX     *-1,1,1                                                  IOC00560
       CAL     SYSUCW                                                   IOC00570
       STA     BA005                                                    IOC00580
       PDX     0,1                                                      IOC00590
BA001  LDI*    BA005                                                    IOC00600
       LNT     20000               7909 CHANNEL                        $IOC00610
       TRA     *+5                 NO                                  $IOC00620
       LNT     20100                                                   $IOC00630
       TRA     BA003-4                                                 $IOC00640
       LNT     600000                                                  $IOC00650
       TRA     BA003               DISK AND ATTACHED                   $IOC00660
       LFT     40100               IF RESERVED OR CARD                 $IOC00670
       TRA     BA004               DO NOT PROCESS IT.                   IOC00680
       LNT     400000              IF ASSIGNED                          IOC00690
       TRA     BA002               TEST FOR SYSTEM UNIT                 IOC00700
       LFT     200000              IF DETACHED                          IOC00710
       TRA     BA004               DO NOT PROCESS IT                    IOC00720
BA003  RIR     77777               RESET ADDRESS                        IOC00730
       STI*    BA005               STORE UCB WORD 1                     IOC00740
       RIL     760777              RESET ALL BUT CHANNEL NUMBER         IOC00750
       PIA                         X                                    IOC00760
       ARS     27                  X                                    IOC00770
       SUB     L(1)                COMPUTE L(AVAILABILITY CHAIN         IOC00780
       ACL     SYSUAV              LOCATOR) FOR CHANNEL                 IOC00790
       PAX     0,4                 FIND LAST UNIT IN CHAIN              IOC00800
       TXL     *+4,4,0             FOUND.                               IOC00810
       PAC     0,2                 STEP TO NEXT UNIT                    IOC00820
       CAL     0,2                 X                                    IOC00830
       TRA     *-4                 TEST FOR END OF CHAIN                IOC00840
       CAL     BA005               PUT THIS UNIT AT END OF CHAIN.       IOC00850
       STA     0,2                 X                                    IOC00860
       TRA     BA004               STEP TO NEXT UCB                     IOC00870
BA002  CAL     SYSUNI              GET SYSUNI LOCATOR.                  IOC00880
       ARS     18                  COMPUTE INDEX ADDRESS.               IOC00890
       PAX     0,4                 X                                    IOC00900
       ACL     SYSUNI              X                                    IOC00910
       STA     *+1                 X                                    IOC00920
       CAL     **,4                PICK UP SYSTEM UNIT                  IOC00930
       ANA     ADDRS               MASK OFF L(UCW)                      IOC00940
       ERA     BA005               COMPARE WITH THIS UNIT               IOC00950
       TZE     BA004-1             EXIT IF SYSTEM UNIT                 $IOC00960
       TIX     *-4,4,1             STEP TO NEXT UNIT.                   IOC00970
       RIL     200000              UNIT WAS LEFT OUT IN LEFT FIELD      IOC00980
       SIL     400000              SET REPOSITIONING FLAG AND.          IOC00990
       TRA     BA003               UNASSIGNED FLAG. PUT UNIT IN CHAIN.  IOC01000
       STI*    BA005               IN SYSTEM UCB WORD 1                 IOC01010
BA004  LXA     BA005,4             PICK UP L(UCW)                       IOC01020
       TXI     *+1,4,4             STEP TO NEXT                         IOC01030
       SXA     BA005,4             UNIT.                                IOC01040
       TIX     BA001,1,4           X                                    IOC01050
       TRA     BB00                GO TO PREPROCESSOR.                  IOC01060
BA005  PZE     **                  CURRENT UNIT UNDER TEST.             IOC01070
       TTL     READ CONTROL CARD AND BRANCH ON OPERATION                IOC01080
BB00   TSX     BCARD,4             GET NEXT CARD                        IOC01090
       LXA     BCDCT,4             PREVIOUS CARD NUMBER                 IOC01100
       TXI     *+1,4,1             INCREMENT                            IOC01110
       SXA     BCDCT,4             AND STORE                            IOC01120
       TXL     BB001,4,1           TRANSFER IF THIS IS FIRST CARD       IOC01130
       CAL     BQ00+1              OPERATION FROM CARD                  IOC01140
       AXT     BFST-BZ02,1         INITIALIZE TABLE SEARCH              IOC01150
       LAS     BFST,1                                                   IOC01160
       TRA     *+2                                                      IOC01170
       TRA*    BFST+1,1            BRANCH ON OPERATION                  IOC01180
       TIX     *-3,1,2                                                  IOC01190
       SLW     BU02+4              HERE IF OP IS ILLEGAL                IOC01200
       ERA     BRTN+1              CHECK IF                            $IOC01210
       TZE     BB006               *IBSYS OR                           $IOC01220
       CAL     BQ00                $IBSYS RETURN                       *IOC01230
       ERA     BRTN                TO BASIC MONITOR                    $IOC01240
       TZE     BB006               OTHERWISE GO                        $IOC01250
       CAL     BQ00                                                    *IOC01260
       ERA     BRTR                ILLEGAL BUT THIS IS                 *IOC01270
       TZE     BB002               $JOB                                *IOC01280
       CAL     BQ00                                                    *IOC01290
       ERA     BRTO                ILLEGAL BUT THIS IS                 *IOC01300
       TZE     BB009               $STOP                               *IOC01310
       TSX     BERR,4              PRINT ERROR                          IOC01320
       PZE     BU02,,6                                                  IOC01330
       TRA     BB00                TO NEXT CARD                         IOC01340
BB001  LXD     SYSJOB,4            EXIT IF LAST PHASE                  *IOC01350
       TXL     *+4,4,0             OF JOB BLEW UP                      *IOC01360
       CLA     BRTQ                                                    *IOC01370
       STO     SYSGET                                                  *IOC01380
       TRA     BB006                                                   *IOC01390
       CAL     BQ00+1              OPERATION FROM CARD                 *IOC01400
       ERA     BJOBB               IS THIS A JOB CARD                   IOC01410
       TZE     BJOB                YES-GO TO PROCESS CARD               IOC01420
       CAL     BQ00                TEST FOR BASIC MONITOR               IOC01430
       ERA     BRTN                RETURN CONTROL CARD                  IOC01440
       TZE     BB006               $IBSYS                               IOC01450
       CAL     BQ00                RETURN TO IBSYS IF                  *IOC01460
       ERA     BRTR                CURRENT OP IS $JOB                  *IOC01470
       TZE     BB002                                                   *IOC01480
       CAL     BQ00                                                    *IOC01490
       ERA     BRTO                IS CURRENT OP $STOP                 *IOC01500
       TNZ     *+3                 NO                                  *IOC01510
BB009  CLA     BRTO                                                    *IOC01520
       TRA     BB002+1             $STOP                               *IOC01530
       CAL     BQ00                IS CURRENT OP                       *IOC01540
       ERA     BRTP                $EXECUTE                            *IOC01550
       TNZ     BB008               NO                                  *IOC01560
       CAL     BQ00+2                                                  *IOC01570
       LDQ     BQ00+3                                                  *IOC01580
       LGR     18                  PICK UP COL 16-21                   *IOC01590
       XCL                                                             *IOC01600
       ERA     BRTT                $EXECUTE IOCS                       *IOC01610
       TNZ     BB010               NO                                  *IOC01620
       TSX     (PROUT,4                                                *IOC01630
       PZE     1                                                       *IOC01640
       PZE     BQ00,,12+512*DBLSP                                      *IOC01650
       TRA     BB003                                                   *IOC01660
BB010  CAL     BQ00+2              PLACE $EXECUTE   SYSNAM             *IOC01670
       LDQ     BQ00+3              INTO SYSGET                         *IOC01680
       LGR     18                                                      *IOC01690
       STQ     SYSGET                                                  *IOC01700
       TRA     BB006                                                   *IOC01710
BB008  CAL     BQ00                TEST FOR $ID CARD                   *IOC01720
       ERA     BIDR                $ID                                  IOC01730
       ARS     18                  CHECK FIRST 3 CHARACTERS ONLY        IOC01740
       TNZ     BB011               NO                                  *IOC01750
       ZET     SYSACC              $ID CARD TO BE PRINTED              *IOC01760
       TRA     *+4                 NO                                  *IOC01770
       TSX     (PROUT,4            YES                                 *IOC01780
       PZE     1                                                       *IOC01790
       PZE     BQ00,,12                                                *IOC01800
       TSX     SYSIDR,4            YES, LET INSTALLATION                IOC01810
       PZE     BQ00                ACCOUNTING ROUTINE PROCESS IT.       IOC01820
       TRA     BB003               DO NOT COUNT IT                      IOC01830
BB011  CAL     BQ00+1              CHECK FOR                           *IOC01840
       ERA     BRST                * RESTART                            IOC01850
       TZE     RESTRT              X                                    IOC01860
       CAL     BQ00+1              CHECK FOR                           $IOC01870
       ERA     BRTN+1              *IBSYS                              $IOC01880
       TZE     BB006               RETURN TO IBSYS                     $IOC01890
       ZET     BB004               ARE WE SKIPING AGAIN                 IOC01900
       TRA     BB003               YES.                                 IOC01910
       TSX     (PROUT,4            PRINT ON FIRST CARD SKIPPED          IOC01920
       PZE     1                   ONLY                                 IOC01930
       PZE     BB005,,5+512*DBLSP  X                                    IOC01940
       STL     BB004                                                    IOC01950
BB003  STZ     BCDCT               RESET CARD COUNT AND                 IOC01960
       STZ     BF55                RESET FIRST CARD SWITCH             *IOC01970
       TRA     BB00                GO READ NEXT CARD                    IOC01980
BRTN   BCI     1,$IBSYS                                                 IOC01990
       BCI     1,*IBSYS                                                $IOC02000
BRTO   BCI     1,$STOP                                                  IOC02010
BRTP   BCI     1,$EXECU                                                 IOC02020
BRTQ   BCI     1,IBSXEC                                                 IOC02030
BRTR   BCI     1,$JOB                                                   IOC02040
BRTS   BCI     1,IBSBSR                                                 IOC02050
BRTT   BCI     1,IOCS                                                   IOC02060
BIDR   BCI     1,$ID                                                    IOC02070
BRST   BCI     1,*RESTA            RT                                   IOC02080
BB004  PZE     **                  FIRST SKIP SWITCH                    IOC02090
BB005  BCI     5,IOCS LOOKING FOR CONTROL CARDS                         IOC02100
BB002  CLA     BRTS                TELL IBSYS TO BACKSPACE             *IOC02110
       STO     SYSGET              TO PICK-UP $JOB CARD                *IOC02120
BB006  TSX     (PROUT,4            PRINT RETURNING TO BASIC            $IOC02130
       PZE     1                   MONITOR.                             IOC02140
       PZE     BB007,,6+512*EJECT  X                                    IOC02150
       CAL     BQ00                RETURN TO BASIC MONITOR             *IOC02160
       ERA     BRTR                VIA SYSRET EXCEPT IF                *IOC02170
       TNZ     SYSRET              THIS IS $JOB                        *IOC02180
       TSX     SYSRPT,4                                                *IOC02190
BB007  BCI     6,IOCS RETURNING TO BASIC MONITOR.                       IOC02200
       TTL              JOB CARD PROCESSING                             IOC02210
BJOB   AXT     3,4                 MOVE JOB TITLE TO HEADERS           $IOC02220
       CAL     BQ00+5,4                                                 IOC02230
       SLW     BU00+9,4            ERROR HEADER                         IOC02240
       SLW     BU50+4,4            IO ASSIGNMENT HEADER                 IOC02250
       SLW     JOBID+3,4                                                IOC02260
       TIX     *-4,4,1                                                  IOC02270
       LDI     L(0)                SCAN IOBS LOADING CONTROL            IOC02280
       LDQ     BQ00+10                                                 $IOC02290
       RQL     12                                                      $IOC02300
       TSX     BCNTR,4                                                 $IOC02310
       PZE     BW90,,2*2                                               $IOC02320
       STI     RORG                                                    $IOC02330
       LDI     L(0)                                                    $IOC02340
       LDQ     BQ00+9                                                   IOC02350
       TSX     BCNTR,4                                                  IOC02360
       PZE     BW09,,2*4                                                IOC02370
       STI     BRECT               IOBS RECORD COUNT                    IOC02380
       LAC     BRECT,4             SET WORKING AND STANDARD             IOC02390
       CAL     BVORG,4             FILE BLOCK ORIGINS                   IOC02400
       NZT     BWORG               IS A FIXED ORIGIN SPECIFIED          IOC02410
       SLW     BWORG                                                    IOC02420
       SLW     BFORG                                                    IOC02430
       LDQ     BY05                                                    $IOC02440
       TSX     BSCAN,4             SCAN FILE BLOCK ORIGIN               IOC02450
       TXL     BJ005,2,0           TRANSFER IF BLANK                   $IOC02460
       RFT     000176                                                   IOC02470
       TRA     BJ03                ERROR-NOT OCTAL                      IOC02480
       PXD     0,0                                                      IOC02490
       RQL     3                                                        IOC02500
       LGL     3                                                        IOC02510
       TIX     *-2,2,6                                                  IOC02520
       LAS     BWORG                                                    IOC02530
       TRA     *+4                                                     $IOC02540
       TRA     *+3                                                     $IOC02550
       TRA     FITSW+1                                                 $IOC02560
BJ005  CAL     BWORG               USE STANDARD BLOCK ORGIN            $IOC02570
       SLW     BNORG                                                   $IOC02580
       STA     BDZ3                SET PROGRAM LOADER                   IOC02590
       PAC     0,4                                                      IOC02600
       SXD     BJ08,4                                                   IOC02610
       STA     LFLBLK              FILE BLOCK ORIGIN FOR CHECKPOINT     IOC02620
       LDQ     BY03                                                     IOC02630
       TSX     BSCAN,4             SCAN FCW COUNT                       IOC02640
       RFT     000174                                                   IOC02650
       TRA     BJ04                ERROR-FIELD NOT NUMERIC              IOC02660
       TSX     BCONV,4             CONVERT COUNT                        IOC02670
BJ07   PAX     0,2                                                      IOC02680
       SXD     BH00,2              SET FCW LIMIT TEST                   IOC02690
       XCL                                                              IOC02700
       VLM     BFCB,0,10                                                IOC02710
       LLS     10                                                       IOC02720
       STA     BJ06                                                     IOC02730
       STA     BDZ1                SET PROGRAM LOADER                   IOC02740
       PAX     0,4                                                      IOC02750
       SXD     LFLBLK,4            FILE BLOCK LENGTH FOR CHECKPOINT     IOC02760
BJ08   TXH     BJ05,4,**                                                IOC02770
       ADD     BFORG                                                    IOC02780
       STA     BUFIN                                                    IOC02790
       STA     BDZ0                SET PROGRAM LOADER                   IOC02800
       STA     BDZ8                TOADDRESS FOR LOADER                $IOC02810
       STZ     BMORG               MISCELLANEOUS STORAGE BLOCK SETUP    IOC02820
       TSX     BV01,4              READ IN IOBS                         IOC02830
       TRA     BJ08A                                                 (3)IOC02840
       LFT     100                 ON DISK                             $IOC02850
       TRA     BJ06                YES                                 $IOC02860
       LNT     020000              HYPERTAPE                           $IOC02870
       TRA     *+4                 NO                                  $IOC02880
       TSX     NDATA,4             YES                                 $IOC02890
       PZE     BV03,,HSKFP         SKIP FORWARD ONE FILE               $IOC02900
       TRA     BJ06                                                    $IOC02910
       CLA     BV92                NO                                   IOC02920
       SLW     1,2                                                     $IOC02930
       AXT     BV08,4              SELECT CHANGE                       $IOC02940
       SXA     BV08-5,4            ROUTINE                             $IOC02950
       TSX     (ACTIV,4                                                 IOC02960
       PZE     BV03                                                     IOC02970
       AXT     BV06,4              WAIT FOR SELECT MINUS               $IOC02980
       ZET     1,2                 AND RESTORE SELECT ROUTINE          $IOC02990
       TRA     *-1                                                     $IOC03000
       SXA     BV08-5,4                                                $IOC03010
BJ06   AXT     **,4                                                     IOC03020
       TXL     BJ03-1,4,0          NO FILE BLOCKS                      $IOC03030
       STZ*    BUFIN               CLEAR FILE BLOCK                     IOC03040
       TIX     *-1,4,1                                                  IOC03050
       TRA     BB00                TO NEXT CONTROL CARD                $IOC03060
BJ03   TSX     BERR,4              FILE BLOCK ORIGIN NOT OCTAL          IOC03070
       PZE     BU04,,5                                                  IOC03080
       TRA     BJ005               USE STANDARD ORGIN                  $IOC03090
BJ04   TSX     BERR,4              FCB COUNT ERROR                      IOC03100
       PZE     BU05,,5                                                  IOC03110
       CAL     BJ90                USE ARBITRARY COUNT                  IOC03120
       TRA     BJ07                                                     IOC03130
BJ05   ZET     FITSW               FIT FILE BLOCK BEFORE               $IOC03140
       TRA     SYSDMP              YES, GO BACK                        $IOC03150
       SXA     FITSW,4             NO,SET SWITCH TO SHOW THAT          $IOC03160
       TSX     BERR,4              FILE BLOCK WILL NOT FIT             $IOC03170
       PZE     BU06,,4                                                 $IOC03180
       TRA     BJ005               USE STANDARD ORGIN                  $IOC03190
BJ50   TSX     BERR,4              JOB CARD OUT OF PLACE                IOC03200
       PZE     BU12,,4                                                  IOC03210
       TRA     BB00                SKIP CARD                            IOC03220
BJ90   PZE     50                                                       IOC03230
FITSW  PZE     **                  FILE BLOCK LENGTH SWITCH            $IOC03240
       TSX     BERR,4                                                  $IOC03250
       PZE     *+2,,3                                                  $IOC03260
       TRA     BJ005                                                   $IOC03270
       BCI     3,FCB OVERLAPS IOCS                                      IOC03280
       TTL     FILE CONTROL CARD PROCESSING                             IOC03290
BFILE  LDQ     BY00                                                     IOC03300
       TSX     BSCAN,4             SCAN FILE NUMBER FIELD               IOC03310
       TXL     BH03,2,0            TRANSFER IF FIELD IS BLANK           IOC03320
       RFT     000174                                                   IOC03330
       TRA     BH04                ERROR-FIELD NOT NUMERIC              IOC03340
       TSX     BCONV,4             CONVERT                              IOC03350
       PAX     0,4                                                      IOC03360
       TXL     BH04,4,0                                                 IOC03370
BH00   TXH     BH04,4,**           ERROR-FILE NO. EXCEEDS LIMIT         IOC03380
       XCL                                                              IOC03390
       VLM     BFCB,0,10                                                IOC03400
       LLS     10                                                       IOC03410
       SUB     BFCB                BASE LOCATION FOR FCB                IOC03420
       ADD     BFORG                                                    IOC03430
       PAC     0,1                                                      IOC03440
BH01   CAL     BQ00+9              MOVE FILE NAME                      $IOC03450
       SLW     9,1                                                      IOC03460
       CAL     BQ00+10                                                  IOC03470
       SLW     10,1                                                     IOC03480
       CAL     BQ00+11                                                  IOC03490
       SLW     11,1                                                     IOC03500
       LDQ     BY08                SCAN FILE SERIAL                     IOC03510
       TSX     BSCAN,4                                                  IOC03520
       TXL     BH20,2,0            DO NOT STORE IF BLANKS               IOC03530
       LDQ     BQ00+7                                                   IOC03540
       STQ     6,1                 STORE FILE SERIAL                    IOC03550
BH20   LDQ     BY09                SCAN RETENTION DAYS                  IOC03560
       TSX     BSCAN,4                                                  IOC03570
       PXD     0,0                                                      IOC03580
       LGR     24,2                                                     IOC03590
       CAL     BLANKZ                                                   IOC03600
       LGR     12                                                       IOC03610
       STQ     8,1                 STORE RETENTION DAYS                 IOC03620
       LDQ     BY07                SCAN REEL SEQUENCE NUMBER            IOC03630
       TSX     BSCAN,4                                                  IOC03640
       TXL     BH10,2,0            TRANSFER IF BLANK                    IOC03650
       RFT     000174                                                   IOC03660
       TRA     BH11                ERROR-FIELD IS NOT NUMERIC           IOC03670
       PXD     0,0                                                      IOC03680
       LGR     24,2                                                     IOC03690
       CAL     BLANKZ                                                   IOC03700
       LGR     12                                                       IOC03710
       RQL     6                                                        IOC03720
BH09   STQ     7,1                 STORE REEL SEQUENCE NUMBER           IOC03730
       LDI     BSNK                                                     IOC03740
       LDQ     BQ00+4                                                   IOC03750
       RQL     12                                                       IOC03760
       TSX     BCNTR,4             SCAN LIST CONTROL                    IOC03770
       PZE     BW10,,2*2                                                IOC03780
       STI     4,1                                                      IOC03790
       LDI     BZERO                                                    IOC03800
       TSX     BCNTR,4             SCAN FILE TYPE                       IOC03810
       PZE     BW00,,2*4                                                IOC03820
       TSX     BCNTR,4             SCAN MULTI-REEL FLAG                 IOC03830
       PZE     BW01,,2*3                                                IOC03840
       TSX     BCNTR,4             SCAN DENSITY FLAG                    IOC03850
       PZE     BW02,,2*5           OR REW OR F.P. AT REEL SWITCH       $IOC03860
       LDQ     BQ00+5                                                   IOC03870
       TSX     BCNTR,4             SCAN MODE FLAG                       IOC03880
       PZE     BW03,,2*4                                                IOC03890
       TSX     BCNTR,4             SCAN LABEL FLAG                      IOC03900
       PZE     BW04,,2*5                                               $IOC03910
       TSX     BCNTR,4             SCAN SEQUENCE COUNT FLAG             IOC03920
       PZE     BW05,,2*2                                                IOC03930
       TSX     BCNTR,4             SCAN CHECKSUM FLAG                   IOC03940
       PZE     BW06,,2*2                                                IOC03950
       TSX     BCNTR,4             SCAN CHECKPOINT CONVENTION           IOC03960
       PZE     BW07,,2*3                                               $IOC03970
       STI     1,1                                                     $IOC03980
       TRA     BH036+2                                                 $IOC03990
BH19   LDI     1,1                                                     $IOC04000
       RNT     400000              STANDARD LABEL CONVENTION            IOC04010
       TRA     BH035               NO                                  $IOC04020
       VFD     O15/00570,3/0,1/1-SLDEN,2/2,15/0                         IOC04030
       RFT     100000              SET OUTPUT LABEL TO FILE DENSITY     IOC04040
       SIR     200000                                                   IOC04050
       LFT     003000                                                  $IOC04060
       TRA     BH036                                                   $IOC04070
       RIR     400000              YES                                  IOC04080
BH035  RFT     200000              SET INPUT LABEL TO FILE DENSITY      IOC04090
       SIR     400000                                                   IOC04100
BH036  STI     1,1                                                      IOC04110
       TRA     BB00                                                    $IOC04120
       LDQ     BY01                SCAN UNIT 1 FIELD                    IOC04130
       TSX     BSCAN,4                                                  IOC04140
       TXH     *+2,2,0             IF BLANK                             IOC04150
       TXI     BH08-1,2,SECOND+ANY ASSIGN ANY UNIT                      IOC04160
       TXL     *+3,2,6             IF ONLY 1 CHARACTER OR               IOC04170
       TXH     *+2,2,12            OVER 2, USE NORMAL ASSIGNMENT.       IOC04180
       TRA     BH037               SPECIAL TEST FOR SYSTEM UNITS        IOC04190
       TSX     BASGN,4             ASSIGN UNIT 1                        IOC04200
       TXL     BH06,2,0            ERROR-ILLEGAL UNIT                   IOC04210
       TXH     BH12,2,-2                                                IOC04220
       PXA     0,2                                                      IOC04230
BH08   PAI                                                              IOC04240
       LDQ     BQ00+2                                                   IOC04250
       RQL     24                                                       IOC04260
       TSX     BCNTR,4             SCAN IMMEDIATE MOUNTING FLAG         IOC04270
       PZE     BW08,,2*2                                                IOC04280
       STI     0,1                                                      IOC04290
       PXD     0,2                 AND DUPLICATE AS                     IOC04300
       STD     0,1                 UNIT 2                               IOC04310
       LDQ     BY02                SCAN UNIT 2 FIELD                    IOC04320
       TSX     BSCAN,4                                                  IOC04330
       CLA     DUCBW               IS THIS DISK                        $IOC04340
       TRA     AB01                                                  (1)IOC04350
       TXL     BH02,2,0            FIELD IS BLANK                      $IOC04360
       TSX     BASGN,4             ASSIGN UNIT 2                        IOC04370
       TXL     BH07,2,0            ERROR-ILLEGAL UNIT                   IOC04380
       PXD     0,2                                                      IOC04390
       STD     0,1                 STORE UCW2 LOCATION                  IOC04400
BH02   LDQ     BQ00+5                                                   IOC04410
       RQL     30                                                       IOC04420
       LDI     BZERO                                                    IOC04430
       TSX     BCNTR,4             SCAN RESTART POSITIONING             IOC04440
       PZE     BW11,,2*2           CONTROL FLAG                         IOC04450
       RNT     000001              IS THE CONTROL ON                    IOC04460
       TRA     BH025-1             NO                                  $IOC04470
       ZET     CHATY               HYPER?                              $IOC04480
       TRA     HNOREP              YES,SET NO REPOSITIONING            $IOC04490
       CAL     0,1                                                      IOC04500
       PAX     0,2                 UCB1                                 IOC04510
       PDX     0,4                 UCB2                                 IOC04520
       TXL     *+2,2,SECOND-1      SKIP IF ASSIGNED                     IOC04530
       TXI     *+1,2,NOREP         SET FLAG FOR NO REPOSITIONING        IOC04540
       TXL     *+2,4,SECOND-1      SKIP IF ASSIGNED                     IOC04550
       TXI     *+1,4,NOREP         SET FLAG FOR NO REPOSITIONING        IOC04560
       PXD     0,4                 UNIT IS DESIGNATED. REPLACE          IOC04570
       STD     0,1                 UNIT DESIGNATION INTO                IOC04580
       PXA     0,2                 FCB WORD 1                           IOC04590
       STA     0,1                 X                                    IOC04600
       NZT     CHATY               HYPER?                              $IOC04610
BH025  TRA     BH19                                                    $IOC04620
       LDI     0,1                 YES                                 $IOC04630
       PIA                                                             $IOC04640
       PAX     0,2                                                     $IOC04650
       SXD     DUCBW,2             SET UP FOR AND GO                   $IOC04660
       TRA     DKERR5              FIND UCB ASKED FOR                  $IOC04670
HNOREP LDI     0,1                 TURN ON NO REP BIT                  $IOC04680
       SIL     200000                                                  $IOC04690
       TRA     BH025+2             GO FIND UCB ADDRESS                 $IOC04700
BH04   TSX     BERR,4              FCB NUMBER ERROR                    $IOC04710
       PZE     BU07,,6                                                 $IOC04720
BH03   LXA     BMORG,1             NEXT LOCATION IN MISC. STORAGE      $IOC04730
       LXA     BMORG,4                                                 $IOC04740
       TXH     *+3,4,0             TRANSFER IF NOT FIRST USE            IOC04750
       LAC     BUFIN,4             INITILIZE MISCELLANEOUS STORAGE     $IOC04760
       LAC     BUFIN,1                                                 $IOC04770
       TXI     *+1,4,-BFCBL                                             IOC04780
       SXA     BMORG,4             SET NEXT AVAILABLE LOCATION          IOC04790
       TRA     BH01                                                     IOC04800
BH06   TSX     BERR,4              UNIT 1 ERROR                         IOC04810
       PZE     BU08,,3                                                  IOC04820
       PXD     0,0                                                      IOC04830
       TRA     BH08                NO UNIT LOCATION STORED              IOC04840
BH07   TSX     BERR,4              UNIT 2 ERROR                         IOC04850
       PZE     BU09,,3                                                  IOC04860
       TRA     BH02                NO UNIT LOCATION STORED              IOC04870
BH11   TSX     BERR,4              INDICATE REEL SEQ ERROR             $IOC04880
       PZE     BU15,,6                                                 $IOC04890
BH10   LDQ     BH90                FORCE SEQUENCE NUMBER 1              IOC04900
       TRA     BH09                                                     IOC04910
BH12   CAL     BMZE                INDICATE INTERNAL FILE               IOC04920
       SLW     3,1                                                      IOC04930
       CAL     BSNK                SET UP BUFFER CHAIN                  IOC04940
       SLW     0,1                                                      IOC04950
       LDI     1,1                 RESET TOTAL BLOCK                   $IOC04960
       RIL     002000              OUTPUT BIT                          $IOC04970
       STI     1,1                                                     $IOC04980
       TRA     BH025                                                    IOC04990
BH90   BCI     1, 0001                                                  IOC05000
BH037  PXD     0,0                 IF UNIT 1 IS DESIGNATED              IOC05010
       LGL     12                  IN, OU, PP OR CK, THE                IOC05020
       AXT     4,2                 PRIMARY AND SECONDARY UNITS          IOC05030
       LAS     BH038+4,2           ARE ASSIGNED FROM THE                IOC05040
       TRA     *+2                 CURRENT SYSTEM UNITS.                IOC05050
       TRA*    BH039+4,2           X                                    IOC05060
       TIX     *-3,2,1             X                                    IOC05070
       AXT     12,2                NOT ANY OF THESE SO                  IOC05080
       LGR     12                  REVERT BACK TO                       IOC05090
       TRA     BH08-4              SYMBOLIC ASSIGNMENTS.                IOC05100
BH038  BCI     1,0000IN                                                 IOC05110
       BCI     1,0000OU                                                 IOC05120
       BCI     1,0000PP                                                 IOC05130
       BCI     1,0000CK                                                 IOC05140
BH039  HTR     BH03A                                                    IOC05150
       HTR     BH03B                                                    IOC05160
       HTR     BH03C                                                    IOC05170
       HTR     BH03D                                                    IOC05180
BH03A  LDI     IN1IN2              SYSTEM INPUT TAPES                   IOC05190
BH03E  LDQ     BQ00+2              SCAN MOUNT INDICATOR                 IOC05200
       RQL     24                  X                                    IOC05210
       TSX     BCNTR,4             X                                    IOC05220
       PZE     BW08,,2*2           X                                    IOC05230
       STI     0,1                 UNITS ARE ASSIGNED.                  IOC05240
       TRA     BH02                FINISH SCAN                          IOC05250
BH03B  LDI     OU1OU2              SYSTEM OUTPUT TAPES                  IOC05260
       TRA     BH03E                                                    IOC05270
BH03C  LDI     PP1PP2              PERIPHERAL PUNCH TAPES               IOC05280
       TRA     BH03E                                                    IOC05290
BH03D  LDI     CK1CK2              CHECKPOINT TAPES                     IOC05300
       TRA     BH03E                                                    IOC05310
IN1IN2 PZE     SYSIN1+1-SYSLB1,,SYSIN2+1-SYSLB1                         IOC05320
OU1OU2 PZE     SYSOU1+1-SYSLB1,,SYSOU2+1-SYSLB1                         IOC05330
PP1PP2 PZE     SYSPP1+1-SYSLB1,,SYSPP2+1-SYSLB1                         IOC05340
CK1CK2 PZE     SYSCK1+1-SYSLB1,,SYSCK2+1-SYSLB1                         IOC05350
DCYL   RFT     000174                                                  $IOC05360
       TRA     DCYLER                                                  $IOC05370
       TSX     BCONV,4        CONVERT                                  $IOC05380
       TRA     AB02                                                  (1)IOC05390
CYGO1  TXH     DCYLER,2,250                                            $IOC05400
       SXA     CYCNT,2             SAVE NO. OF CYCL.                   $IOC05410
       LDQ     BQ00+6         PICK UP 1ST CYL.                         $IOC05420
       LGL     4                                                       $IOC05430
       CLA     0,1                 SHOULD HAVE (-) MQ IF               $IOC05440
       TQP     *+3                 WRITE CHECK                         $IOC05450
       SSM                         SET WRITE CHECK                     $IOC05460
       TRA     *+2                                                     $IOC05470
       SSP                         SET NO WRITE CHECK                  $IOC05480
       STO     0,1                 BIT OFF                             $IOC05490
       LDQ     BY07                                                    $IOC05500
       TSX     BSCAN,4             YES                                 $IOC05510
       RFT     000174         1ST CHARACTER                            $IOC05520
       TRA     DSCAL1                                                  $IOC05530
       TSX     BCONV,4                                                 $IOC05540
       ANA     ADDRS                                                   $IOC05550
CYCNT  XCL     **                  BINARY START                        $IOC05560
       MPY     L(40)               CYL. TO MQ                          $IOC05570
       XCL                         INCRESE BY TRACKS                   $IOC05580
       PAX     0,2                 PUT THE BINARY HEAD                 $IOC05590
       PXD     0,2                 AND TRACK OF STARTING CYL.          $IOC05600
       STD     7,1                 INTO THE FCB                        $IOC05610
       CLA     CYCNT               PICK UP NO. OF CYL                  $IOC05620
       ANA     ADDRS               CREATE BINARY HEAD                  $IOC05630
       TZE     DKERR               IF ZERO GO TO ERROR                 $IOC05640
       XCL                         AND TRACK                           $IOC05650
       SXA     CYCNT,2             SUBTRACT ONE                        $IOC05660
       MPY     L(40)               ADD STARTING                        $IOC05670
       XCL                         CYL AND PUT                         $IOC05680
       SUB     L(1)                IN FCW EIGHT                        $IOC05690
       SUB     CYCNT                                                   $IOC05700
       STA     7,1                                                     $IOC05710
       PAX     0,2                                                     $IOC05720
       TRA     AB03                                                  (1)IOC05730
       TRA     DKERR                                                   $IOC05740
DKERR4 TRA     AB04                                                  (1)IOC05750
       PDX     0,2                                                     $IOC05760
       PXA     0,2                                                     $IOC05770
       STA     7,1                                                     $IOC05780
DKERR5 CLA     SYSUAV              L(UCB) READY FOR USE                $IOC05790
       STA     DUCB                                                    $IOC05800
       CLA     DUCBW               FIND CHANNEL AND                    $IOC05810
       ARS     9                   GET RID OF 7909 BIT                 $IOC05820
       PDC     0,2                                                     $IOC05830
       SXA     DUCB+1,2                                              (4)IOC05831
       TXI     *+1,2,17            -CHANNEL NO.-1)                     $IOC05840
DUCB   CLA     **,2                GET - UCB ADDRESS,, NO. UCB S       $IOC05850
       PAC     0,2            FIRST UCB                                $IOC05860
DTAGIN CAL     0,2                 GET THE WANTED                      $IOC05870
       PAX     0,4                                                     $IOC05880
       ANA     DECRE               FORM OF UCB                         $IOC05890
       LAS     DUCBW               COMPARE FOR                         $IOC05900
       TRA     *+2                 MATCH OF WANTED UCB                 $IOC05910
       TRA     DFOND          FOUND STORE IT                           $IOC05920
       TXL     *+4,4,0             IF MORE TRY AGAIN                   $IOC05930
       PXA     0,4                 ON NEXT UNIT                        $IOC05940
       PAC     0,2                 IF NO MORE                          $IOC05950
       TXL     DTAGIN,0,384                                          (4)IOC05960
       CAL     *-1      384                                          (4)IOC05961
       ANA     DECRE                                                 (4)IOC05962
       ORS     DUCBW                                                 (4)IOC05963
       LXA     DUCB+1,4                                              (4)IOC05964
       LXA     DUCB+1,2                                              (4)IOC05965
       SXA     DUCB+1,0        -                                     (4)IOC05966
       TXH     DUCB-1,4,0                                            (4)IOC05967
       CAL     CHATY               HYPER TAPE                          $IOC05970
       TZE     DFOND-4             NO                                  $IOC05980
       TSX     BERR,4              PRINT ERROR MESG.                   $IOC05990
       PZE     NOTAP,,4                                                $IOC06000
       AXT     0,2                 ZERO FCB WORD ONE                   $IOC06010
       TRA     HNEX                DO WE GO AROUND AGAIN               $IOC06020
       TSX     BERR,4         PRINT ERROR                              $IOC06030
       PZE     NOARM,,5                                                $IOC06040
       STZ     0,1            ZERO OUT FCB 1                           $IOC06050
       TRA     DMASK-2             GET NEXT CARD                       $IOC06060
DFOND  PXA     0,2                                                     $IOC06070
       ZET     CHATY               HYPER TAPE                          $IOC06080
       TRA     HNEX                YES                                 $IOC06090
       STP     0,2                                                     $IOC06100
       PAC     0,2                                                     $IOC06110
       PXA     0,2                                                     $IOC06120
       STA     0,1                 L(UCB) TO FCB                       $IOC06130
       CAL     BH11                PUT MOUNT FLAG ON                   $IOC06140
       STT     0,1                 IN FCB                              $IOC06150
       LDI     6,1                 GET LABEL                           $IOC06160
       RIS     DMASK               CLEAR BLANKS                        $IOC06170
       LFT     77                     RIGHT CHARACTER                  $IOC06180
       TRA     *+2                 YES                                 $IOC06190
       SIL     12                  MAKE THE REST 12                    $IOC06200
       LFT     7700                LEFT CHARACTER                      $IOC06210
       TRA     *+2                 YES                                 $IOC06220
       SIL     1200                MAKE NOTHING 12                     $IOC06230
       STI     6,1                                                     $IOC06240
       CAL     CYCNT               GET STARTING ADDRESS                $IOC06250
       STA     6,1                 STORE IN FCW 7                      $IOC06260
       STZ     DUCBW                                                   $IOC06270
       TRA     AB05                                                  (1)IOC06280
DMASK  OCT     770000777777                                            $IOC06290
DCYLER CLA     CYGO1                                                   $IOC06300
       TRA     AB06                                                  (1)IOC06310
       TRA     CYGO1+1                                                 $IOC06320
HNEX   AXT     **,4                0=PRIMARY-1=SECONDARY               $IOC06330
       TXL     *+5,2,0             THERE HAS BEEN AN ERROR             $IOC06340
       LFT     200000              REPOSITIONING                       $IOC06350
       ORA     PTW                 YES, SET INDICATOR                  $IOC06360
       STP     0,2                 PUT IN UCB                          $IOC06370
       PAC     0,2                                                     $IOC06380
       XEC     HYPST,4             GET AND STORE UCB ADDRESS           $IOC06390
       XEC     HYPST+2,4           FOR PRIMARY OR SECONDARY            $IOC06400
       PIA                                                             $IOC06410
       STD     DUCBW                                                   $IOC06420
       TXH     HYFIN,4,0           FINISH FCB FOR HYPER                $IOC06430
       TXI     *+1,4,1             CHANGE INDEX TO                     $IOC06440
       SXA     HNEX,4              POINT AT SECONDARY UNIT             $IOC06450
       TRA     DKERR5              GO BACK FOR SECONDARY UNIT          $IOC06460
       PXD     0,2                 THE NEXT FOUR INSTR.                $IOC06470
HYPST  PXA     0,2                 ARE XEC ON IR4                      $IOC06480
       STD     0,1                                                     $IOC06490
       STA     0,1                                                     $IOC06500
HYFIN  PXA     0,0                 ZERO OUT ALL FLAGS                  $IOC06510
       STO     DUCBW               FOR THE NEXT FILE CARD              $IOC06520
       STA     HNEX                AND SET UP THE RETURN               $IOC06530
       STO     CHATY               VECTOR                              $IOC06540
       TRA     BB00                NEXT CARD                           $IOC06550
       SPACE   5                                                       $IOC06560
BDATE  CAL     BQ00+2                                                   IOC06570
       ANA     BG025                                                    IOC06580
       SLW     SYSDAT              SAVE DATE IN SYSDAT                  IOC06590
       TRA     BB00                TO NEXT CARD                         IOC06600
       TTL         LOAD CARD PROCESSING                                 IOC06610
BLOAD  CAL     SYSDAT              PICKUP SYSTEM DATE                   IOC06620
       XCL                                                              IOC06630
       RQL     24                  POSITION TO YEAR                     IOC06640
       AXT     12,2                                                     IOC06650
       TSX     BCONV,4             CONVERT YEAR                         IOC06660
       ANA     BG90                                                     IOC06670
       SLW     BM00                SET LEAP YEAR TEST                   IOC06680
       AXT     12,2                                                     IOC06690
       TSX     BCONV,4             CONVERT MONTH                        IOC06700
       PAC     0,1                                                      IOC06710
       TXL     BG01,1,-13          ERROR-MONTH GREATER THAN 12          IOC06720
       AXT     12,2                                                     IOC06730
       TSX     BCONV,4             CONVERT DAY                          IOC06740
       ADD     BG90,1              ADD BASE COUNT FOR MONTH             IOC06750
       TXH     *+3,1,-3            IS MONTH JAN OR FEB                  IOC06760
       NZT     BM00                NO-LEAP YEAR TEST                    IOC06770
       ADD     BONE                ADJUST FOR LEAP YEAR                 IOC06780
       XCL                                                              IOC06790
       TSX     BCVR,4              CONVERT DAY OF YEAR TO BCD           IOC06800
       LGR     24                                                       IOC06810
       CAL     SYSDAT                                                   IOC06820
       LGR     12                  YEAR TO FILE DATE                    IOC06830
       XCL                                                              IOC06840
       ANA     BG05                                                     IOC06850
       SLW     BDATB               STORE FILE DATE                      IOC06860
       LDQ     SYSDAT                                                   IOC06870
       PXD     0,0                                                      IOC06880
       LGL     12                                                       IOC06890
       ALS     6                                                        IOC06900
       LGL     12                                                       IOC06910
       ALS     6                                                        IOC06920
       ORA     BG03                                                     IOC06930
       XCL                                                              IOC06940
       ORA     BG04                                                     IOC06950
       SLW     BU50+7                                                   IOC06960
       STQ     BU50+6                                                   IOC06970
       TRA     BG07                TO WRAP UP                          $IOC06980
BG01   TSX     BERR,4              DATE ERROR                           IOC06990
       PZE     BU11,0,2                                                 IOC07000
       CAL     BG06                                                     IOC07010
       SLW     BDATB                                                    IOC07020
       TRA     BG07                                                    $IOC07030
BG025  OCT     171717171717                                             IOC07040
BG03   BCI     1,00/00/                                                 IOC07050
BG04   BCI     1,00                                                     IOC07060
BG05   OCT     171777171717                                             IOC07070
BG06   BCI     1,00 000                                                 IOC07080
BG90   OCT     000000000003                                             IOC07090
       PZE     0                   JAN                                  IOC07100
       PZE     31                  FEB                                  IOC07110
       PZE     59                  MAR                                  IOC07120
       PZE     90                  APR                                  IOC07130
       PZE     120                 MAY                                  IOC07140
       PZE     151                 JUN                                  IOC07150
       PZE     181                 JUL                                  IOC07160
       PZE     212                 AUG                                  IOC07170
       PZE     243                 SEP                                  IOC07180
       PZE     273                 OCT                                  IOC07190
       PZE     304                 NOV                                  IOC07200
       PZE     334                 DEC                                  IOC07210
BG07   CLA     BUFIN               PICKUP AND                           IOC07220
       SUB     BFORG               GENERATE                             IOC07230
       ANA     ADDRS               CONTROL WORD                         IOC07240
       TZE     BG08                FOR UNIT ASSIGN                     $IOC07250
       ALS     18                  ROUTINE                              IOC07260
       ORA     BFORG               X                                    IOC07270
       SSM                                                              IOC07280
*                       UNIT ASSIGNMENT ROUTINE                         IOC07290
       SPACE   1                                                        IOC07300
       PDC     0,4                 COMPLEMENT BLOCK LENGTH              IOC07310
       TXL     BG08,4,0            EXIT IF BLOCK LENGTH IS ZERO         IOC07320
       SXD     BA07,4                                                   IOC07330
       SXA     BA10,1              SAVE XR1, XR2                        IOC07340
       SXA     BA11,2                                                   IOC07350
       STI     BA99                AND INDICATORS                       IOC07360
       SXA     BA32,0              RESET ANALYSES TABLE ENTRY COUNTER.  IOC07370
       STA     BA02                                                     IOC07380
       AXT     -BFCBL,4            SET IR4 TO - FCB LENGTH             $IOC07390
       SUB     BONE                                                    $IOC07400
       STA     BA70                2ND FCW                             $IOC07410
       SUB     BONE                                                     IOC07420
       STA     BA71                                                     IOC07430
       SXD     BA06,4              STORE INCREMENT                      IOC07440
       CAL     SYSUNI                                                   IOC07450
       STA     BTABL                                                    IOC07460
       PDC     0,4                                                      IOC07470
       TXI     *+1,4,-1                                                 IOC07480
       SXD     BA03,4                                                   IOC07490
       LDC     SYSUCW,4                                                 IOC07500
       SXD     *+3,4                                                    IOC07510
       LAC     SYSUCW,4                                                 IOC07520
       SXD     BA037+1,4                                                IOC07530
       TXI     *+1,4,**                                                 IOC07540
       SXD     BA037,4                                                  IOC07550
       AXT     0,4                                                      IOC07560
BA01   AXT     2,2                                                      IOC07570
BA02   CAL     **,4                ADDRESS OF 1ST FCB WORD ONE         $IOC07580
       XEC     BA80+2,2            PICK UP DEC- THEN ADDRESS           $IOC07590
       TXL     BA05,1,0                                                 IOC07600
       TXL     BA30,1,16384                                             IOC07610
       SXA     BA0381,1            SAVE IR1 FOR DISK                   $IOC07620
BA03   TXH     *+4,1,**                                                $IOC07630
       TXL     BA05,2,1            IGNORE INTERNAL FILE.                IOC07640
       XEC     BA037                                                   $IOC07650
       TRA     BA05                                                    $IOC07660
       TXI     *+1,1,1                                                  IOC07670
       CAL*    BTABL               TABLE ENTRY                          IOC07680
       PAC     0,1                                                      IOC07690
       TXL     BLAST9+4,1,0                                            $IOC07700
BA037  TXL     BA40,1,**                                                IOC07710
       TXH     BA40,1,**                                                IOC07720
       LDI     0,1                                                      IOC07730
       LNT     400000              IS UNIT ALREADY AVAILABLE            IOC07740
       TRA     BA038                                                    IOC07750
       LNT     020100              CHECK FOR DISK                      $IOC07760
       TRA     *+2                 NO                                  $IOC07770
       TRA     BA50                YES NOT AVAILABLE                   $IOC07780
       LFT     200000              IS UNIT ATTACHED                     IOC07790
       TRA     BA50                NO                                   IOC07800
       RIL     400000              MAKE UNIT AVAILABLE                  IOC07810
       STI     0,1                                                      IOC07820
BA038  LNT     20000               7909                                $IOC07830
       TRA     BA0386              NO, CONTINUE WITH 7607              $IOC07840
       ORA     PTW                 SYSTEM UNIT                         $IOC07850
       LFT     40                  INTERFACE                           $IOC07860
       ORA     FOR                 ONE                                 $IOC07870
       TXI     *+1,4,-2            ZERO                                $IOC07880
       STP*    BA02                SAVE RESULTS IN                     $IOC07890
       TXI     *+1,4,2             FCB WORD 3                          $IOC07900
       LNT     020100              IS THIS DISK                        $IOC07910
       TRA     BA04                NO, CONTINUE WITH HYPER             $IOC07920
       TXH     BA50,2,1            IGNORE SECONDARY REFERENCE          $IOC07930
       SXA     BA0385,2                                                $IOC07940
BA0381 AXT     **,2                                                    $IOC07950
       STO     BA100               SAVE AC                             $IOC07960
       CAL     SYSUNI              GET DISK LIMITS                     $IOC07970
       STA     *+5                 SAVE SYSUNI ENTRY                   $IOC07980
       ARS     18                  FIND END                            $IOC07990
       ACL     SYSUNI              OF TABLE                            $IOC08000
       STA     *+4                 AND SAVE                            $IOC08010
       TXI     *+1,2,1                                                 $IOC08020
       CAL     **,2                GET + SAVE                          $IOC08030
       STD     TEMP                SYSUNI HA2                          $IOC08040
       LDQ     **,2                                                    $IOC08050
       LGL     18                  MOVE DEND INTO AC                   $IOC08060
       LXA     BA02,2              GET FCB ORG IN IR2                  $IOC08070
       TXI     *+1,2,7             POINT AT FCB WORD 8                 $IOC08080
       SXA     BA0383,2                                                $IOC08090
BA0383 STA     **,4                PUT DEND INTO WORD 8                $IOC08100
       SLQ*    BA0383              PUT DORG INTO WORD 8                $IOC08110
       SLQ*    BA02                PUT DORG INTO WORD 1                $IOC08120
       ALS     18                                                    (1)IOC08130
       SLQ     BA0387              SAVE DORG                           $IOC08140
       SUB     BA0387              IF DORG LARGER                      $IOC08150
       TPL     *+3                 THAN DEND USE                       $IOC08160
       TRA     AB07                                                  (1)IOC08170
       STA*    BA0383              AS DEND                             $IOC08180
       TXI     *+1,2,-1            POINT TO FCW WORD 7                 $IOC08190
       SXA     BA0383,2                                                $IOC08200
       LGL     18                  PUT DORG IN AC                      $IOC08210
       STA*    BA0383              PUT DORG IN WORD 7                  $IOC08220
       CAL     TEMP                GET HA2 FROM SYSUNI                 $IOC08230
       STD*    BA0383              ZERO MAKE IT 12'S                   $IOC08240
BA0385 AXT     **,2                                                    $IOC08250
       CLA     BA100               RESTORE AC                          $IOC08260
       TRA     BA04                CONTINUE                            $IOC08270
BA0387 PZE     0                                                       $IOC08280
BA0386 XCL     9999                                                    $IOC08290
BA70   LDI     **,4                ADDRESS + 1 OF FCB                  $IOC08300
       TQP     *+3                                                     $IOC08310
       SIR     100000                                                  $IOC08320
       TRA     *+2                                                     $IOC08330
       RIR     100000                                                  $IOC08340
       STI*    BA70                                                    $IOC08350
BA71   LDI     **,4                FLAG UNIT AS                        $IOC08360
       SIL     200000              SYSTEM UNITS                        $IOC08370
       STI*    BA71                X                                   $IOC08380
       XCL                                                              IOC08390
BA04   TXL     *+2,2,1                                                  IOC08400
       ALS     18                                                       IOC08410
       XEC     BA81+2,2                                                 IOC08420
BA05   TIX     BA02,2,1                                                 IOC08430
BA06   TXI     *+1,4,**                                                 IOC08440
BA07   TXH     BA01,4,**                                                IOC08450
       TRA     BA33                GO ANALIZE SECONDARY REFERENCES.     IOC08460
       LDI     BA99                RESTORE INDICATORS                   IOC08470
BA10   AXT     **,1                RESTORE XRS                          IOC08480
BA11   AXT     **,2                                                     IOC08490
       TRA     BG08                                                     IOC08500
*                      UNIT IS IN SECONDARY TABLE                       IOC08510
BA30   PXA     0,1                 ENTER DESIGNATION AND                IOC08520
       PAC     0,1                 INDEX TO REFERENCE WORD              IOC08530
       PXA     0,1                 IN TABLE FOR ANALYSIS.               IOC08540
       PAI                         UNIT TO INDICATORS                   IOC08550
       PXD     0,4                 INDEX TO FCB TO                      IOC08560
       OAI                         INDICATORS                           IOC08570
       PXD     0,2                 PRIMARY OR SECONDARY                 IOC08580
       ALS     15                  UNIT TO PREFIX                       IOC08590
       OAI                         OF INDICATORS.                       IOC08600
BA32   AXT     0,1                 ENTER DESIGNATION IN                 IOC08610
       STI     BA991,1             TABLE BA991.                         IOC08620
       TXI     *+1,1,-1            STEP TO NEXT ENTRY.                  IOC08630
       SXA     BA32,1              SAVE POSITION.                       IOC08640
       TRA     BA05                                                    $IOC08650
       TTL     TABLE OF UNITS MUST BE SORTED                            IOC08660
BA33   LAC     BA32,4                                                   IOC08670
       LAC     BA32,2                                                   IOC08680
       LAC     BA32,1                                                   IOC08690
       TXL     BA10-1,1,0          EXIT IF NO ENTRIES                   IOC08700
       TXI     *+1,1,BA991         COMPUTE INDEX ADDRESS                IOC08710
       SXA     *+2,1               FOR COMPARING ENTRIES.               IOC08720
       SXA     *+4,1               X                                    IOC08730
BA33A  CAL     **,2                PICKUP AN ENTRY                      IOC08740
       ANA     UMASK               MASK OUT NO REPOSITION FLAG          IOC08750
       STA     BA992               SORT ON ADDRESS ONLY                 IOC08760
BA33B  CAL     **,4                COMPARE ENTRIES                      IOC08770
       ANA     UMASK               X                                    IOC08780
       CAS     BA992               X                                    IOC08790
       TRA     BA33C               SWAP ENTRIES.                        IOC08800
       AXT     0,0                 NOP (1 CYCLE)                        IOC08810
       TIX     BA33A,2,1                                                IOC08820
       TNX     BA34,4,1            STEP TO NEXT ENTRY.                  IOC08830
       PXA     0,4                 X                                    IOC08840
       PAX     0,2                 X                                    IOC08850
       TRA     BA33A               X                                    IOC08860
BA33C  CAL*    BA33A               SWAP ENTRIES.                        IOC08870
       LDQ*    BA33B               X                                    IOC08880
       SLW*    BA33B               X                                    IOC08890
       STQ*    BA33A               X                                    IOC08900
       TRA     BA33A               BACK TO COMPARE.                     IOC08910
UMASK  OCT     77377                                                    IOC08920
NOREP  BOOL    400                 NO REPOSITIONING ON RESTART          IOC08930
MODII  BOOL    1000                MOD II OR V SPECIFIED.               IOC08940
REMOVE BOOL    2000                REMOVE RESERVE STATUS.               IOC08950
RESERV BOOL    4000                RESERVE UNIT FOR/FROM ANOTHER SYSTEM.IOC08960
SYMBOL BOOL    10000               SYMBOLIC CHANNEL DESIGNATED.         IOC08970
SAME   BOOL    20000               (*) UNIT2 DESIGNATED                 IOC08980
ANY    BOOL    20377               BLANK UNIT DESIGNATED                IOC08990
SECOND BOOL    40000               RELATIVE UNIT IS IN SECONDARY TABLE. IOC09000
       TTL         UNIT ASSIGNMENT                                      IOC09010
*           UNITS TO BE ASSIGNED ARE IN THE FOLLOWING ORDER.            IOC09020
*                  REAL CHANNEL MOD IV RELATIVE UNIT                    IOC09030
*                  REAL CHANNEL MOD II RELATIVE UNIT                    IOC09040
*          INTER SYSTEM RESERVE MOD IV RELATIVE CHANNEL/UNIT            IOC09050
*          INTER SYSTEM RESERVE MOD II RELATIVE CHANNEL/UNIT            IOC09060
*                SYMBOLIC MOD IV RELATIVE CHANNEL/UNIT                  IOC09070
*                SYMBOLIC MOD II RELATIVE CHANNEL/UNIT                  IOC09080
*              ANY CHANNEL ANY UNIT (BLANK IN FILE CARD)                IOC09090
*                         * (SAME TYPE UNITS)                           IOC09100
*               CARD AND SYSTEM UNITS HAVE BEEN ASSIGNED                IOC09110
       SPACE   1                                                        IOC09120
*            UNIT ASSIGNMENTS ARE FINALIZED BY THIS ROUTINE             IOC09130
BA34   TSX     BAMAP,4             GENERATE TABLE OF AVAILABLE UNITS.   IOC09140
       LAC     BA32,2              PICKUP COUNT OF UNITS                IOC09150
BA34A  CAL*    BA33A               GET UNIT DESIGNATION.                IOC09160
       STA     BA992               SAVE INDICATOR BITS FOR UNIT         IOC09170
       SXA     BA34B,2             SAVE CURRENT STARTING INDEX.         IOC09180
       TNX     BA34E,2,1           EXIT IF LAST UNIT                    IOC09190
BA34D  LDI*    BA33A               PICK UP NEXT UNIT                    IOC09200
       IIS     BA992               COMPARE WITH LAST ONE                IOC09210
       RFT     37377                                                    IOC09220
       TRA     BA34C               DIFFERENT                            IOC09230
       TIX     BA34D,2,1           SAME UNIT                            IOC09240
       TRA     BA34E               NO MORE. PROCESS LAST GROUP.         IOC09250
BA34C  AXT     0,1                 COUNT UNIT                           IOC09260
       RFT     37360               IF UNIT ONLY DIFFERENT               IOC09270
       TXI     BA34F,1,1           NO. OTHER DESIGNATION DIFFERENT.     IOC09280
       TXI     *+1,1,1             UNIT ONLY. STEP UNIT COUNT.          IOC09290
       CAL*    BA33A               GET NEXT UNIT DESIGNATION            IOC09300
       STA     BA992               TO COUNT DIFFERENT UNITS             IOC09310
       SXA     BA34C,1             SAVE COUNT AND GO                    IOC09320
       TIX     BA34D,2,1           BACK FOR NEXT UNIT                   IOC09330
BA34E  AXT     0,2                 LAST UNIT TO BE ASSIGNED             IOC09340
       LXA     BA34C,1             PICKUP COUNT.                        IOC09350
       TXI     *+1,1,1             ACCOUNT FOR FIRST UNIT.              IOC09360
BA34F  SXA     BA34C,0             RESET UNIT COUNTER                   IOC09370
       SXD     BA34X,2             SAVE POSITION INDICATOR              IOC09380
BA34B  AXT     **,2                RELOAD FIRST UNIT INDEX              IOC09390
       LDI*    BA33A               FIRST UNIT TYPE TO INDICATORS        IOC09400
       PIA                         SET FIRST UNIT DESIGNATION           IOC09410
       STA     BA992               INTO BA992 FOR COMPARE               IOC09420
       SXD     BA994,1             UNIT COUNT TO BA994                  IOC09430
       RNT     ANY                 IS IT BLANK TYPE                     IOC09440
       TRA     *+2                 NO                                   IOC09450
       TRA     BA34G               YES, ASSIGN ANY UNIT                 IOC09460
       RFT     SAME                IS IT (*) TYPE                       IOC09470
       TRA     BA34H               YES, ASSIGN ANY UNIT OR SAME UNIT    IOC09480
       RFT     SYMBOL              IS IT S-Z CHANNEL                    IOC09490
       TRA     BA34I               YES, FIND CHANNEL THAT FITS.         IOC09500
       RFT     RESERV              IS IT J-Q RESERVE UNIT.              IOC09510
       TRA     BA34J               YES, FIND UNIT OR CHANNEL THAT FITS. IOC09520
       CLA     SYSUBC              REAL CHANNEL SET LIMIT TEST          IOC09530
       STD     BA34Q               FOR THIS MACHINE                     IOC09540
       PIA                         NO. MOD IV OR VI DESIRED             IOC09550
       LGR     8                   CHANNEL AND UNIT TO MQ               IOC09560
       PXD     0,0                 CLEAR AC                             IOC09570
       LGL     4                   CHANNEL NO (-1) TO AC                IOC09580
       PAX     0,1                 TO IR1                               IOC09590
       TXI     *+1,1,1             CHANNEL NO TO IR1                    IOC09600
       CLS     BA994               COUNT TO AC                          IOC09610
BA34Q  TXH     BA34I,1,**          REVERT TO SYMBOLIC                   IOC09620
       RFT     MODII                                                    IOC09630
       TRA     BA34K                                                    IOC09640
       LAS     BAUIV,1             COMPARE WITH MOD IV CONTROL          IOC09650
       TRA     BA34I               NOT ENOUGH UNITS. REVERT TO SYMBOLIC IOC09660
       STR     *                   SHOULD NEVER BE EQUAL                IOC09670
       ADD     BAUIV,1             REDUCE COUNT OF UNITS                IOC09680
       STD     BAUIV,1             ON CHANNEL.                          IOC09690
BA34N  STA     BA993               SAVE UNIT ADDRESS                    IOC09700
       CAL*    BAUIV,1             TAKE UNIT OUT OF CHAIN               IOC09710
       STA     BAUIV,1             X                                    IOC09720
       CLA*    BA993               MAKE UNIT AVAILABLE                  IOC09730
       LDI     BA992               AND SET NO REPOSITIONING             IOC09740
       RFT     NOREP               FLAG IF REQUIRED.                    IOC09750
       ORA     PTW                 X                                    IOC09760
       SLW*    BA993               X                                    IOC09770
BA34O  LDI*    BA33A               PICK UP UNIT DESIGNATION             IOC09780
       IIS     BA992               COMPARE UNITS                        IOC09790
       RFT     17                  X                                    IOC09800
       TRA     BA34M               DIFFERENT, STEP TO NEXT UNIT         IOC09810
       PIA                         SAME                                 IOC09820
       PDX     0,4                 FILE INDEX TO IR4                    IOC09830
       ARS     15                  PRIMARY OR SECONDARY                 IOC09840
       SXA     *+8,1               UNIT TO                              IOC09850
       PDX     0,1                 IR1                                  IOC09860
       CAL     BA993               PICKUP L(UCW)                        IOC09870
       TXL     *+4,1,1             TRANSFER IF PRIMARY UNIT.            IOC09880
       ALS     18                  SECONDARY UNIT TO                    IOC09890
       STD*    BA02                FILE CONTROL BLOCK                   IOC09900
       TRA     *+2                 X                                    IOC09910
       STA*    BA02                PRIMARY UNIT TO FCB                  IOC09920
       AXT     **,1                RELOAD CHANNEL NO. IN IR1            IOC09930
       TNX     BA35A,2,1           EXIT IF LAST UNIT                    IOC09940
BA34X  TXL     BA34A,2,**          BACK IF LAST OF GROUP.               IOC09950
       TRA     BA34O               BACK FOR NEXT UNIT OF GROUP          IOC09960
BA34M  CAL*    BA33A               STEP TO NEXT UNIT.                   IOC09970
       STA     BA992               SAVE DESIGNATION                     IOC09980
       CAL     BAUIV,1             PICKUP UNIT FROM CHAIN               IOC09990
       TRA     BA34N               AND USE IT NEXT.                     IOC10000
       TTL         MOD II REAL CHANNEL REQUIRED                         IOC10010
BA34K  LAS     BAUII,1             COMPARE WITH MOD II CONTROL          IOC10020
       TRA     BA34I               NOT ENOUGH UNITS. TRY SYMBOLIC       IOC10030
       STR     *                   SHOULD NEVER BE EQUAL                IOC10040
       ADD     BAUII,1             ADJUST COUNT OF UNITS ON             IOC10050
       STD     BAUII,1             CHANNEL. SAVE. REMAINING NO.         IOC10060
BA34P  STA     BA993               SAVE L(UCW)                          IOC10070
       CAL*    BAUII,1             REMOVE UNIT FROM CHAIN.              IOC10080
       STA     BAUII,1             X                                    IOC10090
       CLA*    BA993               MAKE UNIT AVAILABLE AND              IOC10100
       LDI     BA992               SET NO REPOSITIONING                 IOC10110
       RFT     NOREP               FLAG IF REQUIRED.                    IOC10120
       ORA     PTW                 X                                    IOC10130
       SLW*    BA993               X                                    IOC10140
BA34R  LDI*    BA33A               PICKUP UNIT INDICATORS               IOC10150
       IIS     BA992               COMPARE UNITS                        IOC10160
       RFT     17                  X                                    IOC10170
       TRA     BA34S               DIFFERENT UNITS. STEP TO NEXT.       IOC10180
       PIA                         SAME. USE CURRENT UNIT.              IOC10190
       PDX     0,4                 FILE INDEX TO IR4.                   IOC10200
       ARS     15                  PRIMARY OR SECONDARY                 IOC10210
       SXA     *+8,1               UNIT TO                              IOC10220
       PDX     0,1                 IR1                                  IOC10230
       CAL     BA993               PICKUP L(UCB)                        IOC10240
       TXL     *+4,1,1             TRANSFER IF PRIMARY UNIT.            IOC10250
       ALS     18                  PLACE L(UCB) IN                      IOC10260
       STD*    BA02                SECONDARY UNIT OF FCB                IOC10270
       TRA     *+2                 X                                    IOC10280
       STA*    BA02                SET PRIMARY UNIT.                    IOC10290
       AXT     **,1                RELOAD IR1 WITH CHANNEL NO.          IOC10300
       TNX     BA35A,2,1           EXIT IF NO MORE UNITS.               IOC10310
       XEC     BA34X               BACK FOR NEXT GROUP.                 IOC10320
       TRA     BA34R               BACK FOR NEXT UNIT.                  IOC10330
BA34S  CAL*    BA33A               UNITS ARE DIFFERENT.                 IOC10340
       STA     BA992               STEP TO NEXT UNIT                    IOC10350
       CAL     BAUII,1             PICKUP L(UCW)                        IOC10360
       TRA     BA34P               AND USE IT.                          IOC10370
       TTL     INTER SYSTEM RESERVE TYPE REQUIRED.                      IOC10380
BA34J  CAL     SYSUCW              LOOK FOR UNIT IN                     IOC10390
       STD     *+2                 UCW. SET UP INDEX TO                 IOC10400
       PAX     0,1                 UNITS.                               IOC10410
       TXI     *+1,1,**            X                                    IOC10420
       SXA     BA34Y,1             SAVE INDEX ADDRESS                   IOC10430
       PDX     0,1                 COUNT TO IR1                         IOC10440
       CAL     BA992               RESTORE ORIGINAL SYMBOL              IOC10450
       LGR     8                   USED IN FILE CARD                    IOC10460
       CAL     BTWO                X                                    IOC10470
       LGL     4                   X                                    IOC10480
       ADD     L(1)                X                                    IOC10490
       ALS     2                   X                                    IOC10500
       LGL     4                   X                                    IOC10510
       STA     BA995               SAVE IT FOR COMPARISON.              IOC10520
BA34Y  LDI     **,1                FIND UNIT WITH MATCHING              IOC10530
       LFT     40000               NAME.                                IOC10540
       TRA     *+3                 UNIT IS RESERVE. TEST IT.            IOC10550
       TIX     BA34Y,1,4           TRY NEXT ONE.                        IOC10560
       TRA     BA35J-1             MAY NOT BE IN RESERVE STATUS        $IOC10570
       IIS     BA995               COMPARE ADDRESS OF UCW TO            IOC10580
       RFT     77777               SYMBOLIC DESIGNATION.                IOC10590
       TRA     *-4                 NO MATCH.                            IOC10600
BA35G  PXA     0,1                 UNIT FOUND                          $IOC10610
       COM                         COMPUTE UCW ADDRESS                  IOC10620
       ACL     BA34Y               X                                    IOC10630
       STA     BA993               SAVE IT                              IOC10640
       LDI*    BA33A               PICK UP INDICATORS FOR UNIT          IOC10650
       CLA*    BA993               GET UCB WORD 1                       IOC10660
       RFT     REMOVE              SET FLAG FOR REMOVAL OF              IOC10670
       TRA     BA35H               RESERVE STATUS                      $IOC10680
BA35I  RFT     NOREP               SET NO REPOSITIONING FLAG IF        $IOC10690
       ORA     PTW                 DESIRED.                             IOC10700
       SLW*    BA993               MAKE UNIT AVAILABLE.                 IOC10710
       PIA                         ASSIGN UNIT TO                       IOC10720
       PDX     0,4                 FILE. PICKUP FILE INDEX.             IOC10730
       ARS     15                  PRIMARY OR SECONDARY                 IOC10740
       PDX     0,1                 UNIT TO IR1                          IOC10750
       CLA     BA993               PICK UP L(UCW)                       IOC10760
       TXL     *+4,1,1             TRANSFER IF PRIMARY.                 IOC10770
       ALS     18                  SECONDARY UNIT IS                    IOC10780
       STD*    BA02                DECREMENT OF FCB WORD 1.             IOC10790
       TRA     *+2                 X                                    IOC10800
       STA*    BA02                ASSIGN PRIMARY UNIT.                 IOC10810
       TNX     BA35A,2,1           EXIT IF LAST ONE.                    IOC10820
       XEC     BA34X               RETURN IF LAST OF GROUP              IOC10830
       CAL*    BA33A               PICKUP NEXT UNIT                     IOC10840
       STA     BA992               SAVE INDICATORS                      IOC10850
       TRA     BA34J               GO GET IT.                           IOC10860
BA35H  SXA     CANDY,1             SAVE UNIT ADDRESS                   $IOC10870
       ANA     BIT4                IN CASE ANOTHER                     $IOC10880
       LXA     BA35H,1             RESERVE UNIT IS USED, RESET RESERVE $IOC10890
       TXI     *+1,1,1             STATUS AND PROCEED                  $IOC10900
       SXA     BA35H,1                                                 $IOC10910
       TRA     BA35I                                                   $IOC10920
       AXT     CANDY,1                                                 $IOC10930
BA35J  SXA     *+1,1               FIND IF UNIT HAS BEEN               $IOC10940
       LXA     **,1                REMOVED                             $IOC10950
       TXL     BA34W,1,0           NO, NOT IN RESERVE STATUS YET       $IOC10960
       LDI*    BA34Y                                                   $IOC10970
       IIS     BA995                                                   $IOC10980
       RFT     77777               FIND UNIT                           $IOC10990
       TRA     *+2                 NOT FOUND                           $IOC11000
       TRA     BA35G               FOUND                               $IOC11010
       LXA     BA35J+1,1           TO NEXT UNIT                        $IOC11020
       TXI     BA35J,1,1                                               $IOC11030
CANDY  DUP     1,100               REMOVE, TABLE FOR RESERVE UNITS     $IOC11040
       PZE     0                                                       $IOC11050
       TTL     RESERVE UNIT REQUIRED FOR OUTPUT OR INPUT NOT GENERATED  IOC11060
BA34W  CAL*    BA33A               TEST FOR INPUT UNIT                  IOC11070
       PDX     0,4                 GET INDEX TO FILE.                   IOC11080
       LDI*    BA70                PICKUP FILE BITS.                    IOC11090
       LFT     OUTPUT              CHECK FOR OUTPUT.                    IOC11100
       TRA     *+2                 OK.                                  IOC11110
       TRA     BLAST5              INPUT NOT DEFINED-ERROR.             IOC11120
BA34Z  CAL     SYSUBC              SET LIMIT TEST.                      IOC11130
       STD     BA34T               TRY EQUATING SYMBOLIC TO             IOC11140
       CAL     BA992               ACTUAL CHANNEL FIRST.                IOC11150
       LGR     8                   CHANNEL NO.-1 TO MQ                  IOC11160
       PXD     0,0                 CLEAR AC.                            IOC11170
       LGL     4                   CHANNEL TO AC                        IOC11180
       PAX     0,1                 TO IR1                               IOC11190
       TXI     *+1,1,1             X                                    IOC11200
BA34T  TXH     BA34U,1,**          OUT OF SYSTEM. GET ANY UNIT.         IOC11210
       LDI*    BA33A               TEST FOR                             IOC11220
       RNT     MODII               MOD II (OR V)                        IOC11230
       TRA     *+9                 MOD IV (OR VI) DESIRED.              IOC11240
BA341  CAL     BAUII,1             PICKUP A MOD II (OR V).              IOC11250
       TZE     BA34U               NONE AVAILABLE ON CHANNEL.           IOC11260
       STA     BA993               GOT ONE. USE IT                      IOC11270
       SUB     1B17                REDUCE COUNT OF REMAINING MOD IIS    IOC11280
       STD     BAUII,1             SAVE REDUCED COUNT.                  IOC11290
       CAL*    BAUII,1             RECHAIN UNITS.                       IOC11300
       STA     BAUII,1             X                                    IOC11310
       TRA     *+8                 GO ASSIGN IT                         IOC11320
BA342  CAL     BAUIV,1             PICK UP A MOD IV (OR VI).            IOC11330
       TZE     BA34U               NONE AVAILABLE ON CHANNEL.           IOC11340
       STA     BA993               GOT ONE.                             IOC11350
       SUB     1B17                REDUCE UNIT COUNT.                   IOC11360
       STD     BAUIV,1             SAVE REMAINING UNIT COUNT.           IOC11370
       CAL*    BAUIV,1             REMOVE UNIT FROM CHAIN.              IOC11380
       STA     BAUIV,1             X                                    IOC11390
       CAL     BA995               PUT SYMBOLIC DESIGNATION             IOC11400
       STA*    BA993               INTO UCB WORD 1.                     IOC11410
       CAL     BIT3                FLAG AS INTER SYSTEM                 IOC11420
       ORS*    BA993               RESERVE. GO FIND IT                  IOC11430
       TRA     BA34J               AGAIN AND ASSIGN IT.                 IOC11440
BA34U  LXD     SYSUBC,1            MAKE A SYMBOLIC ASSIGNMENT.          IOC11450
       RNT     MODII               MOD II                               IOC11460
       TRA     BA34V               NO. MOD IV DESIRED.                  IOC11470
       ZET     BAUII,1             FIND A CHANNEL WITH MOD II           IOC11480
       TRA     BA341               TAPES. FOUND ONE.                    IOC11490
       TIX     *-2,1,1             TRY NEXT CHANNEL.                    IOC11500
       LXD     SYSUBC,1            NO. MOD II DRIVES LEFT               IOC11510
       ZET     BAUIV,1             TRY MOD IV                           IOC11520
       TRA     BA342               FOUND ONE.                           IOC11530
       TIX     *-2,1,1             TRY NEXT CHANNEL.                    IOC11540
       TRA     BLAST               NO MORE UNITS AVAILABLE.             IOC11550
BA34V  ZET     BAUIV,1             MOD IV DESIRED. FIND ONE.            IOC11560
       TRA     BA342               GOT ONE.                             IOC11570
       TIX     *-2,1,1             TRY NEXT CHANNEL.                    IOC11580
       LXD     SYSUBC,1            NO MORE MOD IV TAPES                 IOC11590
       ZET     BAUII,1             TRY MOD II.                          IOC11600
       TRA     BA341               FOUND ONE.                           IOC11610
       TIX     *-2,1,1             TRY NEXT CHANNEL.                    IOC11620
       TRA     BLAST               NO MORE UNITS AVAILABLE.             IOC11630
       TTL                   SYMBOLIC CHAIN                             IOC11640
*      SYMBOLIC CHANNEL DESIGNATED. CHAIN LOCATORS NOW SORTED BY        IOC11650
*                     NUMBER OF UNITS ON CHANNEL.                       IOC11660
BA34I  LXD     SYSUBC,4            NO. OF CHANNEL TO IR4                IOC11670
       LXD     SYSUBC,1            AND IR1                              IOC11680
       CAL     BAUII,1             SORT MOD IIS                         IOC11690
       LAS     BAUII,4             COMPARE LOCATORS                     IOC11700
       TRA     *+11                EXCHANGE LOCATORS.                   IOC11710
       AXT     0,0                 NOP (1 CYCLE)                        IOC11720
       CAL     BAUIV,1             COMPARE MOD IVS                      IOC11730
       LAS     BAUIV,4             X                                    IOC11740
       TRA     *+11                EXCHANGE LOCATORS.                   IOC11750
       AXT     0,0                 NOP (1 CYCLE)                        IOC11760
       TIX     BA34I+2,4,1         BACK FOR NEXT COMPARE                IOC11770
       TNX     BA343,1,1           STEP TO NEXT SET.                    IOC11780
       PXA     0,1                 X                                    IOC11790
       PAX     0,4                 X                                    IOC11800
       TRA     BA34I+2             X                                    IOC11810
       LDQ     BAUII,4             EXCHANGE MODII                       IOC11820
       SLW     BAUII,4             LOCATORS.                            IOC11830
       STQ     BAUII,1             X                                    IOC11840
       TRA     *-12                BACK TO COMPARE MOD IVS              IOC11850
       LDQ     BAUIV,4             EXCHANGE MOD IV                      IOC11860
       SLW     BAUIV,4             LOCATORS.                            IOC11870
       STQ     BAUIV,1             X                                    IOC11880
       TRA     *-12                BACK TO STEP TO NEXT COMPARE.        IOC11890
BA343  LXD     SYSUBC,1            FIND A CHANNEL                       IOC11900
       LDI*    BA33A               WITH ENOUGH UNITS TO SATISFY         IOC11910
       SXD     BA370,1             SAVE IR FOR COMPARE                 $IOC11920
       PIA                          GET CHANNEL                         IOC11930
       ARS     4                    NUMBER IN IR1                       IOC11940
       ANA     BA347+2              FOR COMPARE                         IOC11950
       PAX     0,1                                                      IOC11960
       TXI     *+1,1,1                                                  IOC11970
BA370  TXH     BA372,1,**                                               IOC11980
       CLS     BA994                TEST FOR MOD II TAPES               IOC11990
       RNT     MODII                                                    IOC12000
       TRA     BA371                                                    IOC12010
       LAS     BAUII,1                                                  IOC12020
       TRA     BA372                                                    IOC12030
       STR     0                                                        IOC12040
       TRA     BA348-2             BACK TO SYMBOLIC                     IOC12050
BA371  LAS     BAUIV,1             TEST FOR MOD IV TAPES                IOC12060
       TRA     BA372                                                    IOC12070
       STR     0                                                        IOC12080
       TRA     BA349-2            BACK TO SYMBOLIC                      IOC12090
BA372  LXD     SYSUBC,1                                                 IOC12100
       CLS     BA994               THIS SET.                            IOC12110
       RNT     MODII               MOD II OR IV                         IOC12120
       TRA     BA344               MOD IV DESIRED.                      IOC12130
       LAS     BAUII,1             COMPARE WITH MOD II LOCATORS         IOC12140
       TRA     *+3                 NOT ENOUGH.                          IOC12150
       STR     *                   SHOULD NEVER BE EQUAL.               IOC12160
       TRA     *+3                 FOUND                                IOC12170
       TIX     *-4,1,1             TRY NEXT CHANNEL.                    IOC12180
       TRA     BA344-1             TRY MOD IV S                         IOC12190
       ADD     BAUII,1             REDUCE COUNT BY NO. OF UNITS         IOC12200
       STD     BAUII,1             IN SET AND SAVE REMAINDER.           IOC12210
BA348  STA     BA993               SAVE L (UCW)                         IOC12220
       CAL*    BAUII,1             REMOVE UNIT FROM CHAIN.              IOC12230
       STA     BAUII,1             X                                    IOC12240
       CLA*    BA993               PICK UP UCB WORD 1                   IOC12250
       LDI     BA992               SET NO REPOSITIONING FLAG            IOC12260
       RFT     NOREP               IF DESIRED.                          IOC12270
       ORA     PTW                 X                                    IOC12280
       SLW*    BA993               MAKE UNIT AVAILABLE.                 IOC12290
BA347  LDI*    BA33A               SEE IF UNITS CHANGED.                IOC12300
       IIS     BA992               X                                    IOC12310
       RFT     17                  TEST FOR SAME OR FIRST UNIT          IOC12320
       TRA     BA345               DIFFERENT. GET ANOTHER ONE.          IOC12330
       PIA                         SAME. ASSIGN UNIT.                   IOC12340
       PDX     0,4                 PICKUP INDEX TO FCB                  IOC12350
       ARS     15                  PRIMARY OR SECONDARY                 IOC12360
       SXA     *+8,1               UNIT TO IR 1                         IOC12370
       PDX     0,1                 X                                    IOC12380
       CAL     BA993               PICKUP L(UCW)                        IOC12390
       TXL     *+4,1,1             TRANSFER IF PRIMARY UNIT.            IOC12400
       ALS     18                  SECONDARY UNIT TO                    IOC12410
       STD*    BA02                DECREMENT OF FCB WORD 1              IOC12420
       TRA     *+2                 X                                    IOC12430
       STA*    BA02                ASSIGN PRIMARY UNIT.                 IOC12440
       AXT     **,1                RELOAD CHANNEL INDEX.                IOC12450
       TNX     BA35A,2,1           EXIT IF LAST UNIT.                   IOC12460
       XEC     BA34X               EXIT IF LAST UNIT OF SET.            IOC12470
       TRA     BA347               ASSIGN NEXT UNIT OF SET.             IOC12480
BA345  CAL*    BA33A               GET NEXT UNIT INDICATORS             IOC12490
       STA     BA992               FOR COMPARE.                         IOC12500
       CAL     BAUII,1             GET NEXT MOD II IN CHAIN.            IOC12510
       TRA     BA348               GO ASSIGN IT.                        IOC12520
       LXD     SYSUBC,1                                                 IOC12530
BA344  LAS     BAUIV,1             FIND A CHANNEL WITH ENOUGH           IOC12540
       TRA     *+3                 MOD IV TAPES. NOT THIS ONE.          IOC12550
       STR     *                   SHOULD NEVER BE EQUAL.               IOC12560
       TRA     *+3                 FOUND.                               IOC12570
       TIX     *-4,1,1             TRY NEXT CHANNEL.                    IOC12580
       TRA     BA346               COMBINE MOD II S AND MODIVS          IOC12590
       ADD     BAUIV,1             FOUND. REDUCE COUNT BY SET COUNT     IOC12600
       STD     BAUIV,1             SAVE REMAINDER.                      IOC12610
BA349  STA     BA993               SAVE L (UCW)                         IOC12620
       CAL*    BAUIV,1             REMOVE UNIT FROM CHAIN               IOC12630
       STA     BAUIV,1             X                                    IOC12640
       CLA*    BA993               PICK UP UCB WORD 1                   IOC12650
       LDI     BA992               GET INDICATORS FOR UNIT.             IOC12660
       RFT     NOREP               SET NO REPOSITIONING FLAG            IOC12670
       ORA     PTW                 IF DESIRED.                          IOC12680
       SLW*    BA993               MAKE UNIT AVAILABLE.                 IOC12690
BA350  LDI*    BA33A               COMPARE UNITS OF SET FOR             IOC12700
       IIS     BA992               SAME OR FIRST UNIT.                  IOC12710
       RFT     17                  X                                    IOC12720
       TRA     BA351               DIFFERENT UNIT.STEP TO NEXT ONE.     IOC12730
       PIA                         SAME UNIT. GET INDEX                 IOC12740
       PDX     0,4                 TO FCB IN IR 4                       IOC12750
       ARS     15                  PRIMARY OR SECONDARY UNIT            IOC12760
       SXA     *+8,1               TO IR 1.                             IOC12770
       PDX     0,1                 X                                    IOC12780
       CAL     BA993               GET L (UCW)                          IOC12790
       TXL     *+4,1,1             TRANSFER IF PRIMARY UNIT             IOC12800
       ALS     18                  ASSIGN SECONDARY UNIT                IOC12810
       STD*    BA02                X                                    IOC12820
       TRA     *+2                 X                                    IOC12830
       STA*    BA02                ASSIGN PRIMARY UNIT.                 IOC12840
       AXT     **,1                RESTORE CHANNEL INDEX.               IOC12850
       TNX     BA35A,2,1           EXIT IF NO MORE UNITS.               IOC12860
       XEC     BA34X               EXIT IF LAST OF SET.                 IOC12870
       TRA     BA350               GO ASSIGN NEXT UNIT OF SET.          IOC12880
BA351  CAL*    BA33A               STEP TO NEXT UNIT                    IOC12890
       STA     BA992               SAVE UNIT FOR COMPARE.               IOC12900
       CAL     BAUIV,1             GET NEXT UNIT IN CHAIN               IOC12910
       TRA     BA349               BACK TO ASSIGN NEXT UNIT.            IOC12920
       TTL     SECONDARY UNIT SEARCH                                    IOC12930
*    (*) IN FILE CARD AS SECONDARY UNIT SEARCH FOR IDENTICAL TYPE.      IOC12940
BA34H  PIA                         UNIT TYPE FROM PRIMARY               IOC12950
       PDX     0,4                 GET INDEX TO FCB                  (5)IOC12960
       ARS     15                  TEST TO MAKE SURE IT                 IOC12970
       PDX     0,1                 IS SECONDARY UNIT                    IOC12980
       TXH     *+4,1,1             X                                    IOC12990
       TSX     BERR,4              GOOF. * IN PRIMARY UNIT.             IOC13000
       PZE     BAERM,,4                                                 IOC13010
       TRA     BA352               DO NOT ASSIGN UNIT.                  IOC13020
       CAL*    BA02                GET FCB WORD 1                       IOC13030
       PAC     0,1                 INDEX TO PRIMARY UCB                 IOC13040
       CAL     0,1                 GET UCB WORD 1                       IOC13050
       ARS     9                   CHANNEL NO. TO AC 14-17              IOC13060
       ANA     L(15D)              MASK OFF CHANNEL NO.                 IOC13070
       LDI     0,1                 UCW TO INDICATORS                    IOC13080
       PDX     0,1                 CHANNEL NO. TO IR 1                  IOC13090
       LNT     100000              IS IT A MOD IV                       IOC13100
       TRA     BA353               NO                                   IOC13110
BA356  NZT     BAUIV,1             GET A MOD IV FROM SAME CHAN.         IOC13120
       TRA     BA354               NO MORE MOD IV UNITS ON CHANNEL      IOC13130
       CAL     BAUIV,1             GOT ONE.                             IOC13140
       SUB     1B17                REDUCE COUNT OF MOD IVS ON           IOC13150
       STD     BAUIV,1             CHANNEL.                             IOC13160
       STA     BA993               SAVE L (UCW)                         IOC13170
       CAL*    BAUIV,1             REMOVE UNIT FROM CHAIN               IOC13180
       STA     BAUIV,1             X                                    IOC13190
BA355  CLA*    BA993               PICK UP UCB WORD 1                   IOC13200
       LFT     200000              SET NO REPOSITIONING FLAGS           IOC13210
       ORA     PTW                 SAME.                                IOC13220
       SLW*    BA993               MAKE UNIT AVAILABLE.                 IOC13230
       CLA     BA993               ASSIGN UNIT AS                       IOC13240
       ALS     18                  SECONDARY FOR FILE.                  IOC13250
       STD*    BA02                X                                    IOC13260
BA352  TNX     BA35A,2,1           EXIT IF NO MORE UNITS               $IOC13270
       TRA     BA34A               HANDLE THESE ONE AT A TIME.          IOC13280
BA353  NZT     BAUII,1             GET A MOD II ON SAME CHANNEL.        IOC13290
       TRA     BA354               NO MORE MOD II UNITS ON CHANNEL      IOC13300
       CAL     BAUII,1             GOT ONE.                             IOC13310
       SUB     1B17                REDUCE COUNT OF UNITS ON             IOC13320
       STD     BAUII,1             CHANNEL. SAVE REMAINDER.             IOC13330
       STA     BA993               SAVE L (UCW)                         IOC13340
       CAL*    BAUII,1             REMOVE UNIT FROM CHAIN.              IOC13350
       STA     BAUII,1             X                                    IOC13360
       TRA     BA355               GO ASSIGN IT.                        IOC13370
BA354  ZET     BAUII,1             TRY MOD II ON SAME CHANNEL          $IOC13380
       TRA     BA353               FOUND ONE.                           IOC13390
       ZET     BAUIV,1             TRY MOD IV ON SAME CHANNEL          $IOC13400
       TRA     BA356               FOUND ONE.                           IOC13410
       TRA     BA346-2                                               (5)IOC13420
       DUP     1,5                                                   (5)IOC13430
       PZE                         PATCH SPACE                       (5)IOC13440
       CAL*    BA02                NONE ANYWHERE SO ASSIGN              IOC13480
       TRA     BA352-2             PRIMARY AS SECONDARY                $IOC13490
*             CALL FOR COMBINED MOD II AND MODIV CHANNEL.               IOC13500
BA346  ZET     BATST               HAVE WE BEEN THRU THIS BEFORE.       IOC13510
       TRA     BA360               YES                                  IOC13520
       STL     BATST               NO FLAG THAT WE HAVE.                IOC13530
       LXD     SYSUBC,1            NO. OF CHANNELS TO IR 1              IOC13540
       ZET     BAUII,1             ANY MOD IIS                          IOC13550
       TRA     *+5                 YES                                  IOC13560
BA361  TIX     *-2,1,1             NO                                   IOC13570
       ZET     BATTS               DID WE COMBINE ANY                   IOC13580
       TRA     BA34I               YES.                                 IOC13590
       TRA     BA360               NO. COMBINE CHANNELS.                IOC13600
       NZT     BAUIV,1             FOUND MOD IIS ANY MOD IVS            IOC13610
       TRA     BABBB               NO.                                  IOC13620
       STL     BATTS               YES FLAG COMBINED UNITS              IOC13630
       CAL     BAUIV,1             FIND END OF MOD IV CHAIN             IOC13640
       PDX     0,4                 X                                    IOC13650
       STA     BA993               X                                    IOC13660
       TNX     *+3,4,1             FOUND END OF CHAIN.                  IOC13670
       CLA*    BA993               STEP TO NEXT ENTRY                   IOC13680
       TRA     *-3                 X                                    IOC13690
       CAL     BAUII,1             LINK MOD IIS TO END OF               IOC13700
       STA*    BA993               MOD IV CHAIN.                        IOC13710
       ACL     BAUIV,1             ADD COUNTS                           IOC13720
       STD     BAUIV,1             SAVE TOTAL AND                       IOC13730
       STZ     BAUII,1             CLEAR MOD II LOCATOR.                IOC13740
       TRA     BA361               BACK TO COMBINE OTHER CHANNELS       IOC13750
BATST  PZE     **                  COMBINATION ENTRY FLAG               IOC13760
BATTS  PZE     **                  UNITS HAVE BEEN COMBINED FLAG.       IOC13770
BATTT  PZE     **                  CHANNELS HAVE BEEN COMBINED FLAG.    IOC13780
BA360  ZET     BATTT               SECOND ENTRY TO THIS ROUTINE         IOC13790
       TRA     BLAST               CAUSES EXIT. NOT ENOUGH UNITS.       IOC13800
       STL     BATTT               FLAG ENTRANCE TO THIS ROUTINE.       IOC13810
       LXD     SYSUBC,1            NO. OF CHANNELS TO IR 1              IOC13820
       NZT     BAUIV,1             ANY UNITS ON THIS CHANNEL           $IOC13830
       TIX     *-1,1,1             NO,STEP TO NEXT CHANNEL             $IOC13840
       TNX     BLAST,1,1           NOT ENOUGH UNITS IF ONLY 1 CHANNEL.  IOC13850
BA36A  CAL     BAUIV,1             COMBINE UNITS FROM BOTH CHANNELS.    IOC13860
       PDX     0,4                 FIND END OF CHAIN ON 2ND CHANNEL     IOC13870
       STA     BA993               X                                    IOC13880
       TNX     *+3,4,1             X                                    IOC13890
       CAL*    BA993               X                                    IOC13900
       TRA     *-3                 X                                    IOC13910
       CAL     BAUIV-1,1           LINK FIRST CHAIN TO SECOND           IOC13920
       STA*    BA993               X                                    IOC13930
       ACL     BAUIV,1             COMBINE COUNTS                       IOC13940
       STD     BAUIV,1             X                                    IOC13950
       STZ     BAUIV-1,1           CLEAR 1ST CHANNEL LOCATOR.           IOC13960
       TIX     BA36A,1,1           COMBINE ALL UNITS ON 1 CHANNEL.      IOC13970
       TRA     BA34I               TRY AGAIN.                           IOC13980
       SPACE   1                                                        IOC13990
BA34G  LFT     200000              IF SECONDARY UNIT IT IS              IOC14000
       TRA     BA362               PROCESSED LATER                      IOC14010
       LXD     SYSUBC,1            ASSIGN BLANK PRIMARY UNIT            IOC14020
       ZET     BAUIV,1             FIND A UNIT ANY WHERE.               IOC14030
       TRA     BA363               FOUND ONE.                           IOC14040
       ZET     BAUII,1             TRY A MOD II                         IOC14050
       TRA     BA364               FOUND ONE.                           IOC14060
       TIX     *-4,1,1             STEP TO NEXT CHANNEL                 IOC14070
       TRA     BLAST               NO MORE UNITS ANY WHERE.             IOC14080
BA363  CAL     BAUIV,1             ASSIGN A MOD IV TO FILE              IOC14090
       STA     BA993               REMOVE UNIT FROM CHAIN.              IOC14100
       SUB     1B17                X                                    IOC14110
       STD     BAUIV,1             X                                    IOC14120
       CAL*    BAUIV,1             X                                    IOC14130
       STA     BAUIV,1             X                                    IOC14140
       TRA     BA365               GO ASSIGN IT.                        IOC14150
BA364  CAL     BAUII,1             PICK UP A MOD II AND                 IOC14160
       STA     BA993               ASSIGN IT                            IOC14170
       SUB     1B17                X                                    IOC14180
       STD     BAUII,1             X                                    IOC14190
       CAL*    BAUII,1             X                                    IOC14200
       STA     BAUII,1             X                                    IOC14210
BA365  PIA                         UNIT DESIGNATION TO AC.              IOC14220
       PDX     0,4                 FILE INDEX TO IR 4                   IOC14230
       CAL     BA993               ASSIGN PRIMARY UNIT                  IOC14240
       STA*    BA02                TO FILE.                             IOC14250
       CLA*    BA993               SET NO REPOSITIONING                 IOC14260
       RFT     NOREP               FLAG IF DESIGNATED.                  IOC14270
       ORA     PTW                 X                                    IOC14280
       SLW*    BA993               MAKE UNIT AVAILABLE.                 IOC14290
BA362  TIX     BA34A,2,1           BACK FOR NEXT UNIT.                  IOC14300
       TTL     FINAL WRAP UP ROUTINE FOR ASSIGNING TAPES                IOC14310
BA35A  LAC     BA32,2              PICKUP COUNT OF UNITS                IOC14320
       CAL*    BA33A               PICKUP AN ENTRY                      IOC14330
       PDX     0,4                 INDEX TO FCB TO IR 4                 IOC14340
       CAL*    BA02                GET FIRST WORD OF FCB                IOC14350
       PDX     0,1                 ASSIGN SECONDARY UNIT                IOC14360
       TXL     *+3,1,16383         SAME AS PRIMARY IF NOT              $IOC14370
       ALS     18                  ASSIGNED ALREADY.                    IOC14380
       STD*    BA02                X                                    IOC14390
       TIX     BA35A+1,2,1         BACK FOR NEXT FILE.                  IOC14400
       CAL     SYSUAV              REGENERATE AVAILABILITY              IOC14410
       STD     *+2                 CHAINS.                              IOC14420
       PAX     0,1                 START BY CLEARING                    IOC14430
       TXI     *+1,1,**            LOCATOR WORDS.                       IOC14440
       SXA     *+3,1               X                                   $IOC14450
       PDX     0,1                 X                                    IOC14460
       PXD     0,0                 X                                   $IOC14470
       STA     **,1                X                                   $IOC14480
       TIX     *-1,1,1             X                                    IOC14490
       CAL     SYSUCW              PICKUP UNIT BLOCK PARAMETERS.        IOC14500
       STD     *+2                 AND SET UP INDEX                     IOC14510
       PAX     0,1                 ADDRESS.                             IOC14520
       TXI     *+1,1,**            X                                    IOC14530
       SXA     *+2,1               X                                    IOC14540
       PDX     0,2                 X                                    IOC14550
BA35C  LDI     **,2                UCW WORD 1 TO INDICATORS             IOC14560
       LNT     400000              NOT ASSIGNED.                        IOC14570
       TRA     BA35E               ASSIGNED. SEE IF RESERVED            IOC14580
       LFT     20000               IF 7909 CHANNEL                     $IOC14590
       TRA     *+3                 PUT IN AVAIL. CHAIN                 $IOC14600
       LFT     240100              ATTACHED, NOT RESERVE OR CARD.       IOC14610
       TRA     BA35E               TEST FOR RESERVE                    $IOC14620
       LFT     200000              IF NOT ATTACHED                     $IOC14630
GORD   TRA     BA35D               DO NOT PUT IN CHAIN                 $IOC14640
       PIA                         UCW TO AC                            IOC14650
       ARS     9                   CHANNEL TO AC 14-17                  IOC14660
       ANA     L(15D)              MASK CHANNEL NO.                     IOC14670
       SUB     1B17                -1                                   IOC14680
       ARS     18                  TO AC 32-35                          IOC14690
       ACL     SYSUAV              COMPUTE AVAILABILITY CHAIN LOCATOR   IOC14700
       STA     *+4                 ADDRESS.                             IOC14710
       PXA     0,2                 COMPUTE UCW ADDRESS                  IOC14720
       COM                         BY ADDING 2S COMPLIMENT              IOC14730
       ACL     BA35C               OF IR2 TO INDEX ADD.(CARRY FORCED)   IOC14740
       LDQ     **                  PICK UP LOCATOR WORD                 IOC14750
       STA*    *-1                 AND LINK UCW TO                      IOC14760
       STA     *+2                 CHAIN OF AVAILABLE UNITS             IOC14770
       XCA                         X                                    IOC14780
       STA     **                  X                                    IOC14790
BA35D  TIX     BA35C,2,4           BACK FOR NEXT UNIT.                  IOC14800
       LAC     BA35F,2             SAVE COUNT OF RESERVE UNITS          IOC14810
       SXD     LUNBLK,2            FOR POST PROCESSOR                   IOC14820
       TRA     BA10-1              ALL DONE                             IOC14830
BA35E  LNT     40000               TEST UNIT FOR                       $IOC14840
       TRA     BA35K               RESERVE STATUS NO.                  $IOC14850
       PXA     0,2                 RESERVED COMPUTE                     IOC14860
       COM                         L (UCW)                              IOC14870
       ACL     BA35C               X                                    IOC14880
BA35F  AXT     0,1                 SAVE IN UNIT BLOCK.                  IOC14890
       STZ     UNBLK,1             CLEAR ENTRY                          IOC14900
       STA     UNBLK,1             X                                    IOC14910
       CAL*    UNBLK,1             PICKUP SYMBOL USED.                  IOC14920
       ALS     18                  SAVE IN DECREMENT OF                 IOC14930
       STD     UNBLK,1             UNIT BLOCK                           IOC14940
       TXI     *+1,1,-1            STEP ENTRY COUNT.                    IOC14950
       SXA     BA35F,1             SAVE IT.                             IOC14960
       TRA     BA35D               BACK FOR NEXT UNIT.                  IOC14970
BA35K  LNT     20100               7909 CHANNEL                        $IOC14980
       TRA     BA35D               NO                                  $IOC14990
       TRA     GORD+1              PUT IN AVAIL. CHAIN                 $IOC15000
BA992  PZE     **                  UNIT INDICATOR BITS                  IOC15010
BA993  PZE     **                  L (UCW) BEING ASSIGNED.              IOC15020
BA994  PZE     0,,**               COUNT OF DIFFERENT UNITS IN GROUP    IOC15030
BA995  PZE     **                  SYMBOLIC DESIGNATION OF RESERVE UNIT.IOC15040
BAMAP  CAL     SYSUNI              GENERATE AVAILABLE UNIT CHAINS       IOC15050
       STD     *+2                 COMPUTE INDEX ADDRESS TO             IOC15060
       PAX     0,1                 SYSTEM UNIT TABLE.                   IOC15070
       TXI     *+1,1,**            X                                    IOC15080
       SXA     BA996,1             X                                    IOC15090
       CAL     SYSUCW              START WITH FIRST UNIT                IOC15100
       STA     BA997               X                                    IOC15110
       PDX     0,1                 WORD COUNT TO IR 1                   IOC15120
       SXA     BAMP7,1             SAVE CURRENT COUNT.                  IOC15130
BAMP1  LDI*    BA997               PICKUP UCB WORD 1                    IOC15140
       LFT     060100              RESERVE,CARD,OR 7909                $IOC15150
       TRA     BAMP2               YES, STEP TO NEXT UNIT.              IOC15160
       LFT     400000              ASSIGNED.                            IOC15170
       TRA     BAMP3               NO.                                  IOC15180
       LXD     SYSUNI,2            MAYBE. COMPARE WITH                  IOC15190
       CAL*    BA996               SYSTEM UNITS                         IOC15200
       ANA     ADDRS               X                                    IOC15210
       ERA     BA997               X                                    IOC15220
       TZE     BAMP2               IS USED AS SYSTEM UNIT               IOC15230
       TIX     *-4,2,1             TRY NEXT SYSUNI ENTRY                IOC15240
       RIL     200000              UNIT WAS LEFT IN LEFT FIELD.         IOC15250
       SIL     400000              SET NOT ASSIGNED AND REPOSITION FLAGSIOC15260
       STI*    BA997               IN UCB WORD 1                        IOC15270
BAMP5  CAL*    BA997               PUT UNIT IN CHAIN.                   IOC15280
       ARS     9                   GET CHANNEL NO.                      IOC15290
       ANA     L(15D)              MASK IT OFF.                         IOC15300
       PDX     0,2                 CHANNEL TO IR 2                      IOC15310
       LNT     100000              MOD IV                               IOC15320
       TRA     BAMPI               NO. PUT IN MOD II CHAIN.             IOC15330
       CAL     BAUIV,2             PUT UNIT IN MOD IV CHAIN             IOC15340
       TNZ     BAMP4               CHAIN IS STARTED.                    IOC15350
       CAL     BA997               START CHAIN.                         IOC15360
       ACL     1B17                COUNT 1 UNIT                         IOC15370
       SLW     BAUIV,2             PUT IN LOCATOR                       IOC15380
       PXD     0,0                 CLEAR ADDRESS                        IOC15390
       STA*    BA997               OF UCB WORD 1                        IOC15400
       TRA     BAMP2               STEP TO NEXT UNIT.                   IOC15410
BAMP3  LFT     200000              UNIT NOT ASSIGNED.                   IOC15420
       TRA     BAMP2               DETACHED. STEP TO NEXT UNIT          IOC15430
       TRA     BAMP5               ATTACHED, PUT IN CHAIN.              IOC15440
BAMPI  CAL     BAUII,2             PUT MOD II UNIT IN MOD II CHAIN.     IOC15450
       TNZ     BAMP6               CHAIN STARTED                        IOC15460
       CAL     BA997               START MOD II CHAIN.                  IOC15470
       ACL     1B17                FIRST UNIT                           IOC15480
       SLW     BAUII,2             SET LOCATOR.                         IOC15490
       PXD     0,0                 CLEAR ADDRESS                        IOC15500
       STA*    BA997               OF UCB WORD 1                        IOC15510
       TRA     BAMP2               STEP TO NEXT UNIT                    IOC15520
BAMP4  PDX     0,1                 FIND END OF MOD IV CHAIN.            IOC15530
       STA     BA993               X                                    IOC15540
       TNX     *+3,1,1             END FOUND                            IOC15550
       CAL*    BA993               STEP TO NEXT LINK                    IOC15560
       TRA     *-3                 X                                    IOC15570
       CAL     BA997               PUT UNIT AT END OF CHAIN             IOC15580
       STA*    BA993               X                                    IOC15590
       CAL     BAUIV,2             STEP COUNT OF UNITS IN               IOC15600
       ACL     1B17                CHAIN BY ONE.                        IOC15610
       STD     BAUIV,2             SAVE COUNT                           IOC15620
       PXD     0,0                 CLEAR ADDRESS OF                     IOC15630
       STA*    BA997               UCB WORD 1                           IOC15640
       TRA     BAMP2               STEP TO NEXT UNIT                    IOC15650
BAMP6  PDX     0,1                 FIND END OF MOD II CHAIN.            IOC15660
       STA     BA993               X                                    IOC15670
       TNX     *+3,1,1             FOUND.                               IOC15680
       CAL*    BA993               STEP TO NEXT                         IOC15690
       TRA     *-3                 LINK.                                IOC15700
       CAL     BA997               PUT UNIT AT END OF CHAIN             IOC15710
       STA*    BA993               X                                    IOC15720
       CAL     BAUII,2             STEP COUNT OF UNITS IN               IOC15730
       ACL     1B17                CHAIN BY ONE                         IOC15740
       STD     BAUII,2             SAVE COUNT                           IOC15750
       PXD     0,0                 CLEAR ADDRESS OF                     IOC15760
       STA*    BA997               UCB WORD 1                           IOC15770
BAMP2  LXA     BA997,1             STEP TO NEXT UNIT.                   IOC15780
       TXI     *+1,1,4             BUMP ADDRESS BY 4.                   IOC15790
       SXA     BA997,1             X                                    IOC15800
BAMP7  AXT     **,1                GET COUNT OF REMAINING UCWS          IOC15810
       TIX     BAMP1-1,1,4         STEP TO NEXT UNIT.                   IOC15820
       TRA     1,4                 ALL DONE.                            IOC15830
BA996  PZE     **,2                INDIRECT ADDRESS TO SYSUNI.          IOC15840
BA997  PZE     **                  L (UCW) UNDER TEST                   IOC15850
       DUP     1,8                 CHAIN LOCATOR WORDS FOR              IOC15860
       PZE                         MOD II UNITS BY CHANNEL.             IOC15870
BAUII  BSS     0                   X                                    IOC15880
       DUP     1,8                 CHAIN LOCATOR WORDS FOR              IOC15890
       PZE                         MOD IV UNITS BY CHANNEL.             IOC15900
BAUIV  BSS     0                   X                                    IOC15910
BA991  BSS     200                 ROOM FOR 100 FILES.                  IOC15920
BABBB  CAL     BAUII,1             MOD II UNITS TO FILL                 IOC15930
       SLW     BAUIV,1             VOID MOD IV CHAIN.                   IOC15940
       STZ     BAUII,1             CLEAR MOD II LOCATOR                 IOC15950
       TRA     BA361               TRY NEXT CHANNEL.                    IOC15960
       SPACE   1                                                        IOC15970
BLAST  PXA     0,2                 CONVERT NUMBER OF                    IOC15980
       TSX     (DECVA,4            UNITS NOT ASSIGNED AND               IOC15990
       STQ     BLAST3              PRINT MESSAGE FOR OPERATOR.          IOC16000
       TSX     (PROUT,4            X                                    IOC16010
       PZE     1                                                       *IOC16020
       PZE     BLAST3,,7           X                                    IOC16030
       TRA     BLAST1                                                  *IOC16040
BLAST3 BCI     7,       UNITS NOT ASSIGNED. NONE AVAILABLE.             IOC16050
       BCI     2, PRESS START                                           IOC16060
BAERM  BCI     4,SOME UNIT 1 IS (*)                                     IOC16070
BLAST5 TSX     (PROUT,4                                                 IOC16080
       PZE     3                                                        IOC16090
       PZE     BLAST6,,7                                                IOC16100
       PZE     BLAST7,,9                                                IOC16110
       PZE     BLAST8,,7                                                IOC16120
       TSX     (PAWSX,4                                                 IOC16130
       SWT     4                                                        IOC16140
       TRA     *+2                                                     *IOC16150
       TRA     BA34Z                                                    IOC16160
BLAST1 CLA     SYSJOB                                                  *IOC16170
       ORA     1DEC                SET PHASE ERROR                     *IOC16180
       STO     SYSJOB              RETURN TO IBSYS                     *IOC16190
       TSX     (PROUT,4                                                *IOC16200
       PZE     1                                                       *IOC16210
       PZE     BLAST2,,3                                               *IOC16220
       TRA     IOCS                                                    *IOC16230
BLAST2 BCI     3,JOB DISCONTINUED                                      *IOC16240
BLAST6 BCI     7,INTER SYSTEM RESERVE INPUT NOT AVAILABLE.              IOC16250
BLAST7 BCI     6,IF SENSE SWITCH 4 DOWN, ANOTHER UNIT                   IOC16260
       BCI     3, WILL BE ASSIGNED.                                     IOC16270
BLAST8 BCI     7,IF SENSE SWITCH 4 UP, JOB WILL BE SKIPPED.             IOC16280
BTD    BCI     1,00000D                                                $IOC16290
       BCI     1,00000H                                                $IOC16300
DKERR  TSX     BERR,4                                                  $IOC16310
       PZE     DKERR1,,9                                               $IOC16320
       TSX     PAUSE,4             OPERATOR PAUSE                      $IOC16330
       TRA     DKERR4                                                  $IOC16340
DKERR1 BCI     9,CYL LIMIT ERROR-MAX SIZE GIVEN PRESS START TO CONTINUE$IOC16350
NOARM  BCI     5, NO SUCH ACCESS-MUST CORRECT                          $IOC16360
DSCAL  BCI     5, CYLINDER START NON-NUMERIC                           $IOC16370
NOTAP  BCI     4,HYPER UNIT NOT AVAILABLE                              $IOC16380
DUCBW  PZE                                                              IOC16390
DSCAL1 TSX     BERR,4                                                  $IOC16400
       PZE     DSCAL,,5                                                $IOC16410
       TRA     BLAST1              SET PHASE ERROR                   (1)IOC16420
BLAST9 BCI     4,THERE IS NO     UNIT                                  $IOC16430
       XEC     BA02                                                    $IOC16440
       PAC     0,4                                                     $IOC16450
       LDQ     BTTBL-1,4                                               $IOC16460
       RQL     18                                                      $IOC16470
       SLQ     BLAST9+2                                                $IOC16480
       TSX     (PROUT,4                                                $IOC16490
       PZE     1                                                       *IOC16500
       PZE     BLAST9,,4                                               $IOC16510
       TRA     BLAST1                                                  *IOC16520
       TTL     INVALID UCB REFERENCE IN TABLE                           IOC16530
BA40   PXD     0,0                                                      IOC16540
       TRA     BA04                                                     IOC16550
*                      UNIT IN TABLE NOT ATTACHED                       IOC16560
BA50   PXD     0,0                                                      IOC16570
       TRA     BA04                                                     IOC16580
       SPACE   1                                                        IOC16590
BA80   PDC     0,1                                                      IOC16600
       PAC     0,1                                                      IOC16610
BA81   STD*    BA02                                                     IOC16620
       STA*    BA02                                                     IOC16630
       SPACE   1                                                        IOC16640
BTABL  PZE     **,1                                                     IOC16650
BA99   BSS     1                                                        IOC16660
BA100  PZE     0                                                       $IOC16670
BG08   PXD     0,0                 PICKUP                               IOC16680
       LDQ     BQ00+3              SYSUNI NAME                          IOC16690
       LGL     18                  IN AC                                IOC16700
       AXT     0,1                 SET POINTER                          IOC16710
       LAS     BTTBL,1             COMPARE WITH NAMES                   IOC16720
       TXI     *+3,1,-1            NOT THIS ONE.                        IOC16730
       TRA     *+4                 FOUND                                IOC16740
       TXI     *+1,1,-1            NOT YET.                             IOC16750
       TXH     *-4,1,-19           BACK IF MORE                         IOC16760
       TRA     *+5                 USE IN1                              IOC16770
       CAL     SYSUNI              FOUND. PICKUP BASE                   IOC16780
       STA     *+1                 OF SYSUNI.                           IOC16790
       CAL     **,1                PICKUP CURRENT ASSIGNMENT            IOC16800
       STA     BX00                USE IT.                              IOC16810
       TTL     SCAN AND LIST CONTROL BLOCKS                             IOC16820
       SPACE   1                                                        IOC16830
       LDI     L(0)                INITIALIZE INDICATORS                IOC16840
       LAC     BUFIN,1                                                  IOC16850
       SXD     *+3,1               FIRST PASS                           IOC16860
       LAC     BFORG,1                                                  IOC16870
       AXT     0,2                 FILE CONTROL BLOCK COUNT             IOC16880
BC01   TXL     BC05,1,**           IS THIS PASS COMPLETE                IOC16890
       TRA     *+1                 DUMMY TRA                           $IOC16900
       AXT     GS12,4              RESTORE SCAN AND                    $IOC16910
       SXA     BC01+1,4            LIST ROUTINE                        $IOC16920
       SXA     GS10,1              SAVE IR1                            $IOC16930
       LXD     BC01,4              SET UP FOR SCAN                     $IOC16940
       SXD     GS00,4              OF FCBS FOR HYPER                   $IOC16950
       RFT     000004              IS THIS A RESTART                   $IOC16960
       TRA     BC01                YES                                 $IOC16970
GS00   TXL     GS10,1,**           GO PRINT FILES                      $IOC16980
       CAL     0,1                                                     $IOC16990
       PAC     0,4                 OBTAIN UCB                          $IOC17000
       PDC     0,2                 SECONDARY UNIT                      $IOC17010
       LDI     0,4                                                     $IOC17020
       LNT     20000               7909 CHANNEL                        $IOC17030
       TRA     GS02+2              MAKE SURE SEC. IS 7607              $IOC17040
       CLA     SIX                                                     $IOC17050
       LFT     100                 DISK                                $IOC17060
       CAL     FOR                 YES, SET DISK                       $IOC17070
       STP     5,1                                                     $IOC17080
       TMI     *+4                 HYPER                               $IOC17090
       CLA     7,1                 DISK                                $IOC17100
       STD     0,1                 PLACE BEGINNING OF FILE             $IOC17110
GS01   TXI     GS00,1,-BFCBL       NEXT FCB                            $IOC17120
       LDI     0,2                                                     $IOC17130
       LNT     20100               DISK                                $IOC17140
       LNT     20000               NO, HYPER                           $IOC17150
       TRA     *+2                 NO, FIX SECONDARY UNIT              $IOC17160
       TRA     GS01                                                    $IOC17170
       CAL     0,1                 FCW ONE                             $IOC17180
       ALS     18                  MAKE TWO UNITS                      $IOC17190
GS02   STD     0,1                 AGREE IN FCB                        $IOC17200
       TRA     GS01                                                    $IOC17210
       LDI     0,2                                                     $IOC17220
       LNT     20000               IF BOTH UNITS                       $IOC17230
       TRA     GS01                NOT 7607 MAKE                       $IOC17240
       TRA     GS02-2              THEM SUCH                           $IOC17250
GS10   AXT     **,1                                                    $IOC17260
       LDI     L(0)                                                    $IOC17270
       TRA     BC01-1                                                  $IOC17280
GS12   TXI     *+1,2,1             INCREMENT FCB COUNT                 $IOC17290
       CLA     0,1                                                      IOC17300
       TZE     BC04                                                     IOC17310
       RFT     000004              IS THIS A RESTART SCAN               IOC17320
       TRA     BC73                YES                                  IOC17330
       ERA     SYSIN1                                                  $IOC17340
       ANA     ADDRS                                                   $IOC17350
       TNZ     *+3                 IS THIS SYSIN1                      $IOC17360
       CLA     7PRE                NO, PUT A 3 IN PREFIX               $IOC17370
       STP     2,1                 IN WORD 3 OF FCB                    $IOC17380
       CLA     4,1                 TRANSFER IF FILE                    $IOC17390
       TMI     BC04                LIST IS SUPPRESSED                  $IOC17400
       CLA     0,1                                                     $IOC17410
BC015  RIR     400010              INDICATE FIRST LINE                  IOC17420
BC016  AXT     12,4                CLEAR IMAGE TO BLANKS                IOC17430
       LDQ     BLANKZ                                                   IOC17440
       STQ     BQ00+12,4                                                IOC17450
       TIX     *-1,4,1                                                  IOC17460
       RFT     000010                                                   IOC17470
       TRA     BC025                                                   $IOC17480
       RFT     000001              IS THIS THE MISC. BLOCK              IOC17490
       TRA     BC02                YES                                  IOC17500
       PXA     0,2                 NO-GET FILE NUMBER                   IOC17510
       XCL                                                              IOC17520
       TSX     BCVR,4              CONVERT TO BCD                       IOC17530
       XCL                                                              IOC17540
       RQL     18                                                       IOC17550
       STQ     BQ00+1              IN IMAGE                             IOC17560
BC02   CAL     9,1                 GET FILE TITLE                       IOC17570
       SLW     BQ00+2                                                   IOC17580
       CAL     10,1                                                     IOC17590
       SLW     BQ00+3                                                   IOC17600
       CAL     11,1                                                     IOC17610
       SLW     BQ00+4                                                   IOC17620
       CLA     3,1                                                      IOC17630
       TMI     BC045               TRANSFER IF INTERNAL                 IOC17640
       CLA     5,1                 IS THIS DISK                        $IOC17650
       TMI     BC60                YES                                 $IOC17660
       AXT     0,4                                                     $IOC17670
BC020  ALS     1                                                       $IOC17680
       PBT                         IS IT DISK                          $IOC17690
       TRA     *+5                 NO                                  $IOC17700
       LDQ*    0,1                 CONVERT UNIT NO.                    $IOC17710
       TSX     (SYMUN,4                                                $IOC17720
       SLW     BQ00+5              STORE DISK UNIT                     $IOC17730
       TRA     BC021+4             AND PROCEED                         $IOC17740
       CAL*    0,1                 GET UCB OF PRIMARY UNIT             $IOC17750
       ANA     AB000               IS IT UNIT RECORD                   $IOC17760
       TZE     BC021-1             NO                                  $IOC17770
       CAL     0,1                 YES                                 $IOC17780
       PAX     0,4                 MAKE PRIMARY                        $IOC17790
       PXD     0,4                 AND SECONDARY                       $IOC17800
       STD     0,1                 THE SAME                            $IOC17810
       SIR     400000              SET CARD EQ. BIT                    $IOC17820
       CAL     0,1                                                      IOC17830
BC021  TSX     BC90,4              UNIT TO BCD                          IOC17840
       XCL                                                              IOC17850
       RQL     6                                                        IOC17860
       STQ     BQ00+5              AND IMAGE                            IOC17870
       RFT     400000              CARD EQ.                            $IOC17880
       TRA     BC024+1             YES                                 $IOC17890
       CAL     BC81                                                     IOC17900
       SLW     BQ00+6                                                   IOC17910
       LDQ     7,1                 REEL SEQUENCE NUMBER                 IOC17920
       RQL     6                                                        IOC17930
       RFT     000010              IS THIS THE FIRST LINE               IOC17940
       TRA     BC10                NO                                   IOC17950
       STQ     BQ00+7                                                   IOC17960
       CAL     0,1                 YES-TEST FOR IMMEDIATE MOUNTING      IOC17970
       ANA     BC910                                                    IOC17980
       TZE     BC022                                                    IOC17990
       CAL     BC80                ASTERISK FOR IMMEDIATE MOUNTING      IOC18000
       SLW     BQ00                                                     IOC18010
       STD     BERCT                                                    IOC18020
       RFT     000004              IS THIS A RESTART                    IOC18030
       TRA     BC024+1                                                  IOC18040
BC022  STI     BM00+3              NO                                   IOC18050
       LDI     1,1                                                      IOC18060
       LFT     003000              IS THIS AN INPUT FILE                IOC18070
       TRA     *+2                 NO                                   IOC18080
       TRA     BC024               YES-LINE FINISHED                    IOC18090
       CAL     BC82                HERE IF OUTPUT                       IOC18100
       SLW     BQ00+9                                                  $IOC18110
       LFT     000400              IS THIS A LABELLED FILE              IOC18120
       TRA     *+3                 YES                                  IOC18130
       AXT     BC85+2,4            UNLABELLED                          $IOC18140
       TRA     BC023                                                    IOC18150
       CLA     5,1                 IS THIS DISK                        $IOC18160
       TPL     *+3                 NO                                  $IOC18170
       AXT     BC86+2,4                                                $IOC18180
       TRA     BC023                                                   $IOC18190
       TNZ     *-2                                                     $IOC18200
       AXT     BC83+2,4                                                $IOC18210
       RFT     400000                                                   IOC18220
       AXT     BC84+2,4            HIGH DEN                            $IOC18230
BC023  SXA     *+2,4                                                    IOC18240
       AXT     2,4                 MOVE OUTPUT TAPE MOUNTING ORDERS    $IOC18250
       CAL     **,4                                                     IOC18260
       SLW     BQ00+12,4                                                IOC18270
       TIX     *-2,4,1                                                  IOC18280
BC024  LDI     BM00+3              RESTORE INDICATORS                   IOC18290
       RFT     000002                                                   IOC18300
       TRA     BC03                                                     IOC18310
       SIR     000002                                                   IOC18320
       TSX     BWRT,4              FCB HEADER 1                         IOC18330
       PZE     BU51,,9                                                  IOC18340
       TSX     BWRT,4              FCB HEADER 2                         IOC18350
       PZE     BU52,,12                                                 IOC18360
BC03   TSX     BWRT,4                                                   IOC18370
       PZE     BQ00,,12                                                 IOC18380
       RFT     000010              IS THIS THE FIRST LINE               IOC18390
BC04   TXI     BC01,1,-BFCBL       NO-TO NEXT FILE CONTROL BLOCK        IOC18400
       CLA     3,1                                                      IOC18410
       TMI     BC04                TRANSFER IF INTERNAL FILE            IOC18420
       CLA     5,1                 IS THIS DISK                        $IOC18430
       TMI     BC04                YES                                 $IOC18440
       CAL     0,1                 SEE IF ADDITIONAL LINE IS NEEDED     IOC18450
       STA     BC900                                                    IOC18460
       PDX     0,4                                                      IOC18470
       PXA     0,4                 UNIT 2                               IOC18480
       LAS     BC900                                                    IOC18490
       TRA     *+2                                                      IOC18500
       TRA     BC04                UNITS EQUAL-NO ADDITIONAL LINE       IOC18510
       SIR     000010                                                   IOC18520
       TRA     BC016               TO EXTRA LINE                        IOC18530
BC025  XCL                                                             $IOC18540
       CAL     5,1                                                     $IOC18550
       ANA     SIX                 DISK                                $IOC18560
       TZE     *+5                 NO                                  $IOC18570
       XCL                         GET UNIT ADDRESS                    $IOC18580
       STA     *+1                 IN LDQ INSTRUCTION                  $IOC18590
       LDQ     **                  AND GO CONVERT                      $IOC18600
       TRA     BC020+4                                                 $IOC18610
       XCL                         UNIT ADDRESS IN AC                  $IOC18620
       TRA     BC021               GO CONVERT                          $IOC18630
BC045  CAL     BC930                                                    IOC18640
       SLW     BQ00+5                                                   IOC18650
       TRA     BC024+1                                                  IOC18660
BC10   SXA     BC11,2              SAVE FILE BLOCK NUMBER               IOC18670
       AXT     24,2                                                     IOC18680
       TSX     BCONV,4                                                  IOC18690
       ADD     BONE                                                     IOC18700
       XCL                                                              IOC18710
       TSX     BCVR,4                                                   IOC18720
       ANA     BC920                                                    IOC18730
       XCL                                                              IOC18740
       RQL     12                                                       IOC18750
       STQ     BQ00+7                                                   IOC18760
BC11   AXT     **,2                RESTORE FILE BLOCK NUMBER            IOC18770
       TRA     BC022                                                    IOC18780
BC05   RFT     000004              WAS THIS A RESTART SCAN              IOC18790
       TRA     CHK22               YES EXIT                            $IOC18800
       RFT     000001              FINISHING MISCELLANEOUS BLOCK        IOC18810
BC06   TRA     BC50                                                     IOC18820
       LXA     BMORG,1             NO-SET UP TO SCAN                    IOC18830
       TXL     BC06,1,0            MISCELLANEOUS BLOCK                  IOC18840
       SXD     BC01,1                                                   IOC18850
       LAC     BUFIN,1                                                  IOC18860
       SIR     000001                                                   IOC18870
       TRA     BC01                                                     IOC18880
BC60   AXT     0,4                 GET UCB                             $IOC18890
       LDQ*    0,1                                                     $IOC18900
       TSX     (SYMUN,4            SYMBOLIC UNIT                       $IOC18910
       SLW     BQ00+5              TO IMAGE                            $IOC18920
       CAL     BC88                                                    $IOC18930
       SLW     BQ00+6              TRKS                                $IOC18940
       CLA     7,1                                                     $IOC18950
       TSX     (DECVD,4            FIRST TRACK ADDRESS                 $IOC18960
       RQL     12                                                      $IOC18970
       XCL                                                             $IOC18980
       ORA     BC87                                                    $IOC18990
       SLW     BQ00+7                                                  $IOC19000
       CLA     7,1                                                     $IOC19010
       TSX     (DECVA,4            LAST TRACK ADDRESS                  $IOC19020
       RQL     6                                                       $IOC19030
       XCL                                                             $IOC19040
       ORA     SIX                                                     $IOC19050
       SLW     BQ00+8                                                  $IOC19060
       TRA     BC022                                                   $IOC19070
BC80   BCI     1,    *                                                  IOC19080
BC81   BCI     1, REEL                                                  IOC19090
BC82   BCI     1,BLANK-                                                 IOC19100
 BC83  BCI     2,LO DEN LAB                                            $IOC19110
 BC84  BCI     2,HI DEN LAB                                            $IOC19120
 BC85  BCI     2,UNLABELLED                                            $IOC19130
 BC86  BCI     2,LABELLED                                              $IOC19140
BC900  PZE     0                                                        IOC19150
BC910  OCT     400000400000                                             IOC19160
BC930  BCI     1,  CORE                                                 IOC19170
BC920  OCT     777717171717                                             IOC19180
 BC88  BCI     1, TRKS                                                 $IOC19190
 BC87  OCT     000000000040                                            $IOC19200
AB000  OCT     000100000000        UNIT RECORD OR DISK                 $IOC19210
       SPACE   1                                                        IOC19220
*        ALTERNATE ENTRY TO FCB SCAN, USED BY RESTART PROCEDURE         IOC19230
       SPACE   1                                                       $IOC19240
BLIST  CAL     CKM11               COMPUTE AND SET SCAN LIMITS         $IOC19250
       PDC     0,4                                                      IOC19260
       SXD     *+3,4                                                    IOC19270
       PAC     0,4                                                     $IOC19280
       PAC     0,1                                                     $IOC19290
       TXI     *+1,4,**                                                 IOC19300
       SXD     BC01,4                                                   IOC19310
       AXT     7,4                 MODIFY PAGE HEADER                   IOC19320
       CAL     BC795+7,4                                                IOC19330
       SLW     BU50+8,4                                                 IOC19340
       TIX     *-2,4,1                                                  IOC19350
       AXT     BC01+2,4            RESTORE FOR NO                      $IOC19360
       SXA     BC01+1,4            LABEL SCAN ON RESTART               $IOC19370
       LDI     L(4)                INDICATE RESTART SCAN               $IOC19380
       TRA     BC01-1              TO SCAN FILE BLOCK                   IOC19390
BC73   LDQ     1,1                                                      IOC19400
       RQL     16                                                       IOC19410
       TQP     BC015               FILE NOT PERM. CLOSED               $IOC19420
       TRA     BC04                                                     IOC19430
BC795  BCI     7, RESTART                                               IOC19440
       TTL                   PREPROCESSOR WRAP - UP                     IOC19450
*  PREPROCESSOR WRAP-UP. THIS SECTION DISABLES TRAPS, MOVES THE FILE    IOC19460
*   BLOCK IF NECESSARY, AND INITIATES A LOAD SEQUENCE TO THE PROGRAM    IOC19470
*                             INPUT UNIT.                               IOC19480
       SPACE   1                                                        IOC19490
BC50   NZT     BERCT                                                    IOC19500
       TRA     BC52                                                     IOC19510
       TSX     BPRNT,4             RESTORE TO FOLLOWING PAGE            IOC19520
       PZE     1,0,0                                                    IOC19530
       PZE     BU60,0,512*BSK1                                          IOC19540
       LXD     BERCT,4             WERE ANY IMMEDIATE MOUNTING          IOC19550
       TXL     *+4,4,0             INSTRUCTIONS GIVEN                   IOC19560
       TSX     BPRNT,4                                                  IOC19570
       PZE     1,0,0                                                    IOC19580
       PZE     BU595,0,4                                                IOC19590
       LXA     BERCT,4             WERE ANY ERRORS FOUND                IOC19600
       TXL     *+6,4,0                                                 $IOC19610
       TSX     BPRNT,4                                                  IOC19620
       PZE     1,0,0                                                    IOC19630
       PZE     BU60,0,8                                                 IOC19640
       TSX     BPAWS,4             ERROR PAUSE                          IOC19650
       TRA     *+2                                                      IOC19660
       TSX     PAUSE,4             OPERATOR ACTION PAUSE                IOC19670
BC52   ENB     BZERO               DISABLE TRAPS, ALL CHANNELS          IOC19680
       CLA*    BX00                INPUT UNIT                           IOC19690
       PDX     0,4                 TO                                   IOC19700
       TXL     BC53,4,8192         IS THIS HYPER                       $IOC19710
       ANA     DEC15               YES                                 $IOC19720
       ORS     BDZA                STORE UNIT NUMBER                   $IOC19730
       PXA     0,4                                                     $IOC19740
       ARS     5                                                       $IOC19750
       ANA     L(1)                SAVE INTERFACE                      $IOC19760
       ORS     BDZ9                IN SMS                              $IOC19770
       PXA     15,4                                                    $IOC19780
       ARS     9                                                       $IOC19790
       ANA     *-2                                                     $IOC19800
       SUB     L(1)                                                    $IOC19810
       PAC     0,1                 -(CH NO.-1)=IR1                     $IOC19820
       CLA     *-6                                                     $IOC19830
       STA*    (RCHXI              A LOADER USING THIS                 $IOC19840
       CLA     BDZ40               LOAD SEQ MUST HAVE                  $IOC19850
       STO     BDZ4                A CPYP *+1,,2! CPYP**,,**           $IOC19860
       CLA     BDZ50               +A TCH 0---PROGRAM--                $IOC19870
       STO     BDZ5                WTR LOADED INTO LOC ONE             $IOC19880
       CLA     *-1                 WITH START LOC OF PROG              $IOC19890
       STA*    (TCOXI              IN LOC TWO.                         $IOC19900
       CLA     BDZ60                                                   $IOC19910
       STO     BDZ6                                                    $IOC19920
       TRA     BC54                                                    $IOC19930
BDZ40  XEC*    (RCHXI                                                  $IOC19940
BDZ50  XEC*    (TCOXI                                                  $IOC19950
BDZ60  TRA     2                                                       $IOC19960
BC53   PXA     0,4                 ADDRESS                             $IOC19970
       ORA     BD89                FORCE BINARY ADDRESS                 IOC19980
       STA     BDZ4                SET ADDRESS OF RDS                   IOC19990
       LGR     9                                                        IOC20000
       SUB     BONE                                                     IOC20010
       LGR     1                                                        IOC20020
       ALS     24                                                       IOC20030
       LLS     0                                                        IOC20040
       ORA     BD90                                                     IOC20050
       STO     BDZ5                SET RCHX                             IOC20060
       ORA     BD91                                                     IOC20070
       STO     BDZ6                SET LCHX                             IOC20080
       SXA     BDZ6,0              SET LCHX ADDRESS TO ZERO             IOC20090
       LDQ     BDZ4                RDS FOR INPUT UNIT                   IOC20100
BC54   LXA     BFORG,4                                                 $IOC20110
       SXA     BDZ2,4                                                   IOC20120
       NZT     RORG                                                     IOC20130
       TRA     BD89-2              TO MOVE FILE BLOCK, LOAD PROGRAM    $IOC20140
       XEC     BV01                                                     IOC20150
       LDI     0,2                                                     $IOC20160
       LNT     20100               IS SYSLB1 DISK...                 (3)IOC20170
       TRA     BDZ8-4              NO                                  $IOC20180
       AXT     BDZ8-1,4            COME BACK TO LOADER                  IOC20190
       SXA     SYSTRA,4                                                 IOC20200
       TSX     SYSLDR,4,1          LOAD FROM DISK                       IOC20210
       BCI     1,RANDOM                                                 IOC20220
       AXT     1,4                 SET RECORD COUNT TO ONE              IOC20230
       SXA     BRECT,4                                                  IOC20240
       TSX     BV01,4              LOAD RECORD FROM TAPE                IOC20250
       TSX     RSLDR,4             RELOCATE RECORD                     $IOC20260
BDZ8   PZE     **,,18946                                               $IOC20270
       PZE     RANDEF                                                  $IOC20280
       STA     BDZ0                CHANGE ZERO OUT LIMIT                IOC20290
       LDI     L(0)                                                    $IOC20300
       TRA     BDZ0                                                     IOC20310
BD89   OCT     000000000020                                             IOC20320
BD90   RCHA    BDZ7                                                     IOC20330
BD91   OCT     000400000000                                             IOC20340
       TTL     CHECKPOINT ROUTINE PART 2 - RESTART                      IOC20350
*      CALLING SEQUENCE                                                 IOC20360
*      TSX     CKPT2,4                                                  IOC20370
*      PZE     FILE,T                                                   IOC20380
*      PZE     FILE CT,DN                                               IOC20390
CHYCW  DUP     1,8                                                      IOC20400
       PZE     **,2,**             LAST UCW+1 FOR CHAN,, NO. OF UCW    $IOC20410
       SPACE   1                                                        IOC20420
CKPT2  STL     CHP3                                                     IOC20430
       TTR     STORE                                                    IOC20440
       TRA     CHKPT                                                    IOC20450
       CAL     CHYCW-1,1           FIND L(UCW) OF CHECKPOINT TAPE       IOC20460
       PDX     0,2                 IR1=CH. NO. OF CP. TAPE             $IOC20470
       CAL*    CHYCW-1,1                                                IOC20480
       ANA     DECRE               IS THIS CP. UCB POINTER             $IOC20490
       SUB     CHP19                                                    IOC20500
       TZE     CHK1                YES                                 $IOC20510
       TIX     *-4,2,4                                                  IOC20520
CHK23  LDQ     CHP19                                                    IOC20530
       TSX     CVPRT,4                                                  IOC20540
       PZE     CHK14,,6                                                 IOC20550
       TRA     SYSDMP              NO SUCH CP TAPE ADDRESS             $IOC20560
CHK1   PXA     0,2                 COMPUTE L(UCW)                       IOC20570
       SUB     CHYCW-1,1                                                IOC20580
       STA     CHK2                                                     IOC20590
       STA     CHP1                                                    $IOC20600
       LDI*    CHK2                                                     IOC20610
       LFT     000100              CARD OR DISK                        $IOC20620
       TRA     CHK23               YES, NOT A CP FILE                  $IOC20630
       RIL     400000                                                   IOC20640
       STI*    CHK2                                                     IOC20650
       CAL     2,4                                                      IOC20660
CKM01  TXI     *+1,2,**            DECREMENT=-DELTA                     IOC20670
       SLW*    CHYCW-1,1                                                IOC20680
       PAX     0,4                                                      IOC20690
       TXI     *+1,2,-2                                                $IOC20700
       LFT     20000               HYPER                               $IOC20710
       TRA     CHK31               YES                                 $IOC20720
       PAI                                                              IOC20730
       PXD     0,4                                                      IOC20740
       SLW*    CHYCW-1,1                                                IOC20750
       TSX     (NDATA,4            REWIND                              $IOC20760
       PZE     CHK2,,3                                                  IOC20770
       RFT     200000              TEST DENSITY AT LOAD POINT           IOC20780
       TRA     *+4                                                      IOC20790
       TSX     (NDATA,4            SET DENSITY LOW                     $IOC20800
       PZE     CHK2,,1                                                  IOC20810
       TRA     *+3                                                      IOC20820
       TSX     (NDATA,4            SET DENSITY HIGH                    $IOC20830
       PZE     CHK2,,2                                                  IOC20840
       NZT*    CHYCW-1,1           TEST FOR DESIRED TAPE POSITION       IOC20850
CKM02  TXI     CHK28-2,2,**        DECREMENT=DELTA+1                   $IOC20860
       TXI     *+1,2,**            DITTO, IR2 POINTS AT UCB+1 OF CP    $IOC20870
       CAL     CHK99                                                    IOC20880
       SLW*    CHYCW-1,1                                                IOC20890
       TSX     ACTV,4              POSITION CHECKPOINT TAPE             IOC20900
       PZE     CHK2                                                     IOC20910
       ZET*    CHYCW-1,1           HOLD                                 IOC20920
       TRA     *-1                                                      IOC20930
CHK28  CAL     CHK95               READ MESSAGE BLOCK                   IOC20940
       SLW*    CHYCW-1,1                                                IOC20950
       TSX     ACTV,4                                                   IOC20960
       PZE     CHK2                                                     IOC20970
       ZET*    CHYCW-1,1                                                IOC20980
       TRA     *-1                                                      IOC20990
       LXD     SYSUCW,4            4 * NOUCW TO IR4                     IOC21000
CHK27  CAL     **,4                ADDRESS=UEA11+4*NOUCW+DELTA          IOC21010
CKM03  SLW     **,4                ADDRESS=UEA11+4*NOUCW                IOC21020
       ANA     SIX                 SKIP TAPES NOT                      $IOC21030
       TNZ     *+9                 TO BE REPOSITIONED                  $IOC21040
CKM04  CLA     **,4                ADDRESS=UEA11+4*NOUCW+DELTA+2        IOC21050
       TZE     *+7                 UEA11=L(1STUCB)                     $IOC21060
       TPL     *+6                 DELTA=LAST L(IOCS)-L(1STUCB)        $IOC21070
       SXA     *+4,4                                                    IOC21080
CKM05  LDQ     **,4                ADDRESS=UEA11+4*NOUCW+DELTA          IOC21090
       TSX     CVPRT,4                                                  IOC21100
       PZE     CHK50,,8+512*DBLSP                                       IOC21110
       AXT     **,4                                                     IOC21120
       PXD     0,0                                                      IOC21130
CKM06  STP     **,4                ADDRESS=UEA11+4*NOUCW+DELTA+2        IOC21140
       TIX     CHK27,4,4           STEP TO NEXT UNIT                    IOC21150
CHK2   CLS     **                                                       IOC21160
       STO*    *-1                 DISABLE CP TAPE REPOSITIONING       $IOC21170
CKM07  CAL     **                  STORE CHECKPOINT ID                  IOC21180
       SLW     CHK18+2                                                  IOC21190
       AXT     6,2                 PREPARE MESSAGE FOR                  IOC21200
CKM08  LDQ     **                  ADDRESS=CHK11+4*NOUCW                IOC21210
       RQL     17                                                       IOC21220
       CAL     CHK20                                                    IOC21230
       TQP     *+2                                                      IOC21240
       ANS     CHK19+9,2                                               $IOC21250
       RQL     1                   SET UP SENSE SWITCH MSG.            $IOC21260
       TIX     *-3,2,1                                                  IOC21270
       TSX     PROUT,4                                                  IOC21280
       PZE     3                                                        IOC21290
       PZE     ,,512*EJECT                                              IOC21300
       PZE     CHK18,,3            RESTART ID LINE                      IOC21310
       PZE     CHK19,,9+512*DBLSP                                       IOC21320
CKM09  CLA     **                  ADDRESS=CHK11+4*NOUCW+3              IOC21330
       TRA     *+3                                                     $IOC21340
CKM10  LXD     **,2                NO. OF WORDS IN MESSAGE BLOCK        IOC21350
       TRA     CHK21                                                    IOC21360
       STD     *+2                                                      IOC21370
       TRA     BLIST                                                   $IOC21380
CKM11  PZE     **,,**              ADDRESS=CHK11+4*NOUCW+4              IOC21390
CHK31  TXI     *+1,4,1                                                 $IOC21400
       SXA     *+3,4                                                   $IOC21410
       TSX     (NDATA,4            REWIND CP TAPE                      $IOC21420
       PZE     CHK2,,30                                                $IOC21430
       AXT     **,4                RESTORE IR4 TO REQ FILE +1          $IOC21440
       TIX     *+2,4,1             SPACE FORWARD TO REQ FILE           $IOC21450
       TRA     CKM02               CP TAPE IS POSITIONED               $IOC21460
       SXA     *-3,4                                                   $IOC21470
       TSX     (NDATA,4            SKIP FORWARD ONE FILE               $IOC21480
       PZE     CHK2,,37                                                $IOC21490
       TRA     *-6                                                     $IOC21500
CHK21  CAL*    CHK12                                                    IOC21510
       STD     CHK12                                                    IOC21520
       STD     *+1                                                      IOC21530
       TIX     *+4,2,**                                                 IOC21540
       TNX     CHK22,2,1                                                IOC21550
       SXD     CHK12,2                                                  IOC21560
       AXT     1,2                                                      IOC21570
       CAL     CHK12                                                    IOC21580
       ADD     L(1)                                                     IOC21590
       STA     CHK12                                                    IOC21600
       TSX     PROUT,4             PRINT RESTART MESSAGE                IOC21610
       PZE     1                                                        IOC21620
CHK12  PZE     **,,**              ADDRESS=CHK11+4*NOUCW+4              IOC21630
       LXD     CHK12,4                                                  IOC21640
       PXA     0,4                                                      IOC21650
       ACL     CHK12                                                    IOC21660
       STA     CHK12                                                    IOC21670
       TIX     CHK21,2,1                                                IOC21680
CHK22  TSX     PAUSE,4                                                  IOC21690
       LXD     SYSUCW,4            4*(NO. OF UCWS) TO IR4               IOC21700
       LXD     SYSUBC,1            NO. OF CHANNELS TO IR1               IOC21710
       TXI     *+1,1,CHYCW                                              IOC21720
       SXA     CHK3,1                                                   IOC21730
       SXA     CKM13,1                                                  IOC21740
       SXA     CKM14,1                                                  IOC21750
       SXA     CKM15,1                                                  IOC21760
       SXA     CKM16,1                                                  IOC21770
       SXA     CKM21,1                                                  IOC21780
       SXA     HYRER-4,1                                               $IOC21790
       SXA     HYRER,1                                                 $IOC21800
       TIX     *+1,1,CHYCW                                              IOC21810
CHK3   CAL     **,1                INITIALIZE TAPE POSITIONING          IOC21820
       PDX     0,2                                                      IOC21830
       TXL     CHK6,2,0                                                 IOC21840
       PXA     0,2                                                     $IOC21850
CKM13  SBM     **,1                                                    $IOC21860
       STA     CHK7                L(UCB) TO BE POSITIONED             $IOC21870
       SXA     CHK5,4                                                  $IOC21880
CKM14  LDI*    **,1                1ST UCW CP READ                     $IOC21890
       LFT     600100              SKIP CARD EQUIPMENT                 $IOC21900
       TRA     CHK4-1              AND UNASSIGNED TAPES                $IOC21910
       LFT     20000               HYPER                               $IOC21920
       TRA     CKM18               YES                                 $IOC21930
       TSX     (NDATA,4            REWIND                              $IOC21940
       PZE     CHK7,,3                                                 $IOC21950
CKM17  AXC     **,4                ADDRESS=DELTA                        IOC21960
CHK7   LDI     **,4                                                     IOC21970
       RFT     200000              TEST DENSITY AT LOAD POINT           IOC21980
       TRA     *+4                                                      IOC21990
       TSX     (NDATA,4            SET DENSITY LOW                     $IOC22000
       PZE     CHK7,,1                                                  IOC22010
       TRA     *+3                                                      IOC22020
       TSX     (NDATA,4            SET DENSITY HIGH                    $IOC22030
       PZE     CHK7,,2                                                  IOC22040
CKM18  TXI     *+1,2,**            DECREMENT=-DELTA-2                   IOC22050
CKM15  NZT*    **,1                TEST DESIRED TAPE POSITION           IOC22060
CKM19  TXI     CHK5,2,**           DECREMENT=DELTA+1                    IOC22070
       LFT     20000                                                   $IOC22080
       TRA     HYREP-2                                                 $IOC22090
CKM20  TXI     *+1,2,**            DITTO                                IOC22100
       CAL     CHK99                                                    IOC22110
CKM16  SLW*    **,1                ADDRESS=CHYCW+CHH5                   IOC22120
       TSX     ACTV,4              INITIATE POSITIONING                 IOC22130
       PZE     CHK7                                                     IOC22140
CHK5   AXT     **,4                                                     IOC22150
       TXI     *+2,2,-3                                                 IOC22160
       TXI     *+1,2,-4                                                 IOC22170
CHK4   PXD     0,2                 SET INDEX TO NEXT UCW                IOC22180
CKM21  STD     **,1                ADDRESS=CHYCW+CHH5                   IOC22190
       TNX     *+4,4,4                                                 $IOC22200
CHK6   TIX     CHK3,1,1            TRY NEXT CHANNEL                     IOC22210
       LXD     SYSUBC,1            GO AROUND AGAIN                     $IOC22220
       TRA     CHK3                                                    $IOC22230
       AXT     0,2                 RESTORE CORE                         IOC22240
       TRA     CHP4                                                     IOC22250
*                      INITIALIZATION OF RESTART.                       IOC22260
CHKPT  LXA     SYSUCW,4            COMPUTE DELTA                        IOC22270
       SXD     *+2,4                                                    IOC22280
       AXT     CHK11,4                                                  IOC22290
       TIX     *+1,4,**                                                 IOC22300
       SXD     DELTA,4                                                  IOC22310
       PXA     0,4                                                      IOC22320
       PAC     0,4                                                      IOC22330
       SXD     CKM01,4                                                  IOC22340
       TXI     *+1,4,-2                                                 IOC22350
       SXD     CKM18,4                                                  IOC22360
       STA     CKM22                                                    IOC22370
       STA     CKM17                                                    IOC22380
       PAX     0,4                                                      IOC22390
       TXI     *+1,4,1                                                  IOC22400
       SXD     CKM02,4                                                  IOC22410
       SXD     CKM02+1,4                                                IOC22420
       SXD     CKM19,4                                                  IOC22430
       SXD     CKM20,4                                                  IOC22440
       TXI     *+1,4,1                                                  IOC22450
       SXA     CHK86,4                                                  IOC22460
       SXA     CKM23,4                                                  IOC22470
       LXD     SYSUCW,4                                                 IOC22480
       SXD     *+3,4                                                    IOC22490
       SXD     *+11,4                                                   IOC22500
       LXA     SYSUCW,4                                                 IOC22510
       TXI     *+1,4,**                                                 IOC22520
       SXA     CKM03,4                                                  IOC22530
DELTA  TXI     *+1,4,**                                                 IOC22540
       SXA     CHK27,4                                                  IOC22550
       SXA     CKM05,4                                                  IOC22560
       TXI     *+1,4,2                                                  IOC22570
       SXA     CKM04,4                                                  IOC22580
       SXA     CKM06,4                                                  IOC22590
       AXT     CHK11,4                                                  IOC22600
       TXI     *+1,4,**                                                 IOC22610
       SXA     CKM08,4                                                  IOC22620
       TXI     *+1,4,2                                                  IOC22630
       SXA     CKM07,4                                                  IOC22640
       SXA     CKM24,4                                                  IOC22650
       TXI     *+1,4,1                                                  IOC22660
       SXA     CKM09,4                                                  IOC22670
       SXA     CKM10,4                                                  IOC22680
       TXI     *+1,4,1                                                  IOC22690
       SXA     CKM11,4                                                  IOC22700
       SXA     CHK12,4                                                  IOC22710
       LXD     SYSUCW,4                                                 IOC22720
       TXI     *+1,4,1                                                  IOC22730
       SXD     CHK16,4                                                  IOC22740
       LAC     SYSUBC,4                                                 IOC22750
       SXA     *+13,1                                                   IOC22760
       LXD     SYSUBC,1                                                 IOC22770
       AXT     0,2                                                      IOC22780
       CAL     0,4                                                      IOC22790
       ARS     16                                                       IOC22800
       ACL     0,4                                                      IOC22810
       STA     CHYCW,2                                                  IOC22820
       CAL     0,4                 BUILD TABLE AT CHYCW                $IOC22830
       ALS     2                                                        IOC22840
       STD     CHYCW,2                                                  IOC22850
       TXI     *+1,2,-1                                                 IOC22860
       TXI     *+1,4,-1                                                 IOC22870
       TIX     *-9,1,1                                                  IOC22880
       AXT     **,1                                                     IOC22890
       XEC     CHPX4               RESTORE X4                           IOC22900
       TRA     CKPT2+3                                                  IOC22910
       TTL     SPECIAL FUNCTION FOR TAPE POSITIONING                    IOC22920
SPCHK  SXA     CHK83,4                                                  IOC22930
       STA     CHK96                                                    IOC22940
       PAC     0,2                                                      IOC22950
       TMI     CHK84               TRANSFER IF POSTING ENTRY            IOC22960
       CAL     0,2                                                      IOC22970
       PDX     0,4                                                      IOC22980
       SXA     CHK80,4                                                  IOC22990
       CAL     CHK98                                                    IOC23000
       STA*    (RCHXI                                                   IOC23010
       STZ*    (RCTXI                                                   IOC23020
CHK80  RDS     **                                                       IOC23030
       XEC*    (RCHXI                                                   IOC23040
CHK83  AXT     **,4                                                     IOC23050
       TRA     1,4                 EXIT                                 IOC23060
CHK84  CLA     2,2                                                      IOC23070
       SSP                         TURN OFF NOISE BIT                   IOC23080
       SUB     1B17                                                     IOC23090
       TNZ     CHK85                                                    IOC23100
CKM22  LDI     **,2                BEGINNING OF FILE 2                  IOC23110
       RFT     100000                                                   IOC23120
       TRA     *+4                                                      IOC23130
       TSX     (NDATA,4            SET DENSITY LOW                     $IOC23140
       PZE     CHK96,,1                                                 IOC23150
       TRA     *+3                                                      IOC23160
       TSX     (NDATA,4            SET DENSITY HIGH                    $IOC23170
       PZE     CHK96,,2                                                 IOC23180
CHK85  CLA     2,2                 CURRENT TAPE POSITION                IOC23190
CKM23  CAS     **,2                DESIRED TAPE POSITION                IOC23200
       TRA     CHK86                                                    IOC23210
       TRA     CHK87                                                    IOC23220
       TRA     CHK83                                                   $IOC23230
CHK86  LDI     **,2                ADDRESS=DELTA+2                      IOC23240
       RNT     700000                                                   IOC23250
       TRA     CHK29                                                    IOC23260
       PIA                                                              IOC23270
       SXA     CHK87-1,1                                                IOC23280
       PAC     0,1                 NUMBER OF BSR NEEDED                 IOC23290
       TSX     (NDATA,4                                                $IOC23300
       PZE     CHK96,,5                                                 IOC23310
       TIX     *-2,1,1                                                  IOC23320
       AXT     **,1                                                     IOC23330
CHK87  STZ     1,2                                                      IOC23340
       TRA     CHK83                                                   $IOC23350
       SPACE   1                                                        IOC23360
CHK29  LDQ*    TRPSW                                                    IOC23370
       TSX     CVPRT,4                                                  IOC23380
       PZE     CHK30,,3                                                 IOC23390
       CLA     CHK1-1              CAUSE STOP IF ERROR                 $IOC23400
       STO     CHK28                                                    IOC23410
       STO     CHP4                                                     IOC23420
       TRA     CHK87                                                    IOC23430
       TTL     SPECIAL HYPER CP. TAPE POSITIONING                       IOC23440
       TSX     (NDATA,4            REWIND                              $IOC23450
       PZE     CHK7,,30                                                $IOC23460
HYREP  TSX     (NDATA,4            FORWARD SPACE RECORDS               $IOC23470
       PZE     CHK7,,36            UNTIL EITHER=OR GREATER             $IOC23480
       LAC     CHK7,4              THAN CP RECORD UCB                  $IOC23490
       CLA     2,4                 CURRENT UCW3                        $IOC23500
       CAS*    **,1                OLD UCW 3                           $IOC23510
       TRA     *+3                                                     $IOC23520
       TRA     CKM19                                                   $IOC23530
       TRA     HYREP                                                   $IOC23540
HYRER  LDI*    **,1                                                    $IOC23550
       RNT     700000              COMPLEMENT RECORD COUNT             $IOC23560
       TRA     HYBRP               NO                                  $IOC23570
       PIA                         YES                                 $IOC23580
       SXA     *+5,1                                                   $IOC23590
       PAC     0,1                                                     $IOC23600
       TSX     (NDATA,4            BACKSPACE UNTIL EQUAL               $IOC23610
       PZE     CHK7,,34                                                $IOC23620
       TIX     *-2,1,1                                                 $IOC23630
       AXT     **,1                                                    $IOC23640
       TRA     CKM19                                                   $IOC23650
HYBRP  LDQ     0,4                                                     $IOC23660
       TSX     CVPRT,4             PRINT MESG.                         $IOC23670
       PZE     CHK30,,3                                                $IOC23680
       CLA     CHK1-1                                                  $IOC23690
       STO     CHK28               STORE STOP                          $IOC23700
       STO     CHP4                DEAD CELL                           $IOC23710
       TRA     CKM19                                                   $IOC23720
       SPACE   1                                                        IOC23730
*                  SPECIAL FUNCTION FOR MESSAGE BLOCK                   IOC23740
       SPACE   1                                                        IOC23750
SPCK1  SXA     CHK70,4                                                  IOC23760
       PAC     0,4                                                      IOC23770
       TMI     CHK71               TRANSFER IF POSTING ENTRY            IOC23780
       CAL     0,4                                                      IOC23790
       PAI                                                             $IOC23800
       LFT     20000               HYPER                               $IOC23810
       TRA     CHK72               YES                                 $IOC23820
       ORA     CHK94               SET BINARY MODE                      IOC23830
       PDX     0,4                                                      IOC23840
       SXA     *+3,4                                                    IOC23850
       CAL     CHK95                                                    IOC23860
       STA*    (RCHXI                                                   IOC23870
       RDS     **                  INITIATE READING BLOCK               IOC23880
       XEC*    (RCHXI                                                   IOC23890
CHK70  AXT     **,4                                                     IOC23900
       TRA     1,4                 EXIT                                 IOC23910
CHK71  STZ     1,4                                                      IOC23920
       TRA     *-3                                                      IOC23930
CHK72  ANA     HSMA                SET UNIT NO. IN                     $IOC23940
       ORA     HYSEL               CONTROL STATEMENT                   $IOC23950
       STD     HSMA-1                                                  $IOC23960
       CLA     1,4                                                     $IOC23970
       SUB     L(2)                SET START CHANNEL                   $IOC23980
       STA*    (RCHXI                                                  $IOC23990
       STA     *+4                                                     $IOC24000
       PIA                         SET INTERFACE                       $IOC24010
       ARS     23                  INTO SMS                            $IOC24020
       ANA     L(1)                                                    $IOC24030
       ORS     **                                                      $IOC24040
       CAL     CHK18               CHANGE IORT TO                      $IOC24050
       STP     CKM24               A COPY AND DISCONNECT               $IOC24060
       TRA     CHK70-1                                                 $IOC24070
       TTL                             CONSTANTS                        IOC24080
CHK94  OCT     000020000000                                             IOC24090
CHK95  PZE     CHK16,,SPCK1                                             IOC24100
CHK96  PZE     0                                                        IOC24110
CHK98  PZE     CHK13                                                    IOC24120
CHK99  PZE     0,0,SPCHK                                                IOC24130
CHK20  OCT     777777772445                                             IOC24140
CHK13  IORTN   0,,-1                                                    IOC24150
       SMS     70                  NCI                                 $IOC24160
       CTLR    HSMA-1                                                  $IOC24170
CHK16  IOCP    CHK11,,**           DECREMENT=4*NOUCW+1                  IOC24180
CKM24  IORT    **,,-1              ADDRESS=CHK11+4*NOUCW+2              IOC24190
       TCH     SYSTWT              INTERUPT                            $IOC24200
CHK50  BCI     8,NOISE RECORDS MAY CAUSE INCORRECT POSITIONING          IOC24210
CHK18  BCI     3,RESTART     XXXXXX                                     IOC24220
CHK19  BCI     9,SET SENSE SWITCHES   1UP   2UP   3UP   4UP   5UP   6UP IOC24230
CHK30  BCI     3,POSITIONING FAILED                                     IOC24240
CHK14  BCI     6,INCORRECT CHECKPOINT TAPE ADDRESS                      IOC24250
       OCT     120612120112                                            $IOC24260
HSMA   OCT     000017000000                                            $IOC24270
       SPACE   1                                                        IOC24280
RESTRT TSX     (PROUT,4                                                 IOC24290
       PZE     1                                                        IOC24300
       PZE     CMT11,,4                                                 IOC24310
       TSX     PAUSE,4                                                  IOC24320
       ENK                         GET CODE FROM KEYS                  $IOC24330
       STQ     *+3                                                      IOC24340
       TSX     CKPT2,4             LETS RESTART                        $IOC24350
       PZE     *+1,1                                                    IOC24360
       PZE     **                                                       IOC24370
CMT11  BCI     4,SET KEYS TO RESTART CODE                               IOC24380
       TTL     GENERATE BCD I/O UNIT DESIGNATION                        IOC24390
*      CALLING SEQUENCE                                                 IOC24400
       SPACE   1                                                        IOC24410
*      TSX BC90,4                                                       IOC24420
       SPACE   1                                                        IOC24430
*       INPUT-UNIT CONTROL WORD LOCATION IN ACCUMULATOR ADDRESS         IOC24440
       SPACE   1                                                        IOC24450
*          OUTPUT-BCD UNIT DESIGNATION IN LOGICAL ACCUMULATOR           IOC24460
*                 RIGHT JUSTIFIED WITH LEADING BLANKS                   IOC24470
       SPACE   1                                                        IOC24480
*              TAPE - XNN (X=CHANNEL LETTER, N=1,...,10)                IOC24490
*                        CARD UNITS-RDX,PUX,PRX                         IOC24500
       SPACE   1                                                        IOC24510
*         NOTE-IF THE UCW LOCATION IS ZERO, THE ACCUMULATOR IS          IOC24520
*                             ALL BLANKS.                               IOC24530
       SPACE   1                                                        IOC24540
BC90   SXA     BC91,4              SAVE XR4                             IOC24550
       SXA     BC94,2              IR2                                  IOC24560
       STI     BC97                AND INDICATORS                       IOC24570
       PAC     0,4                 UCW LOCATION                         IOC24580
       TXL     BC93,4,0            TRANSFER IF NO UNIT                  IOC24590
       CAL     0,4                                                      IOC24600
       LGR     27                  POSITION IO ADDRESS                  IOC24610
       ANA     BC95                KEEP CHANNEL NUMBER                  IOC24620
       ORA     BC96                12-ZONE, LEADING BLANKS              IOC24630
       SLW     BM00+2              SAVE CHANNEL LETTER                  IOC24640
       PXD     0,0                                                      IOC24650
       LGL     3                                                        IOC24660
       LBT                                                              IOC24670
       TRA     BC92                TRANSFER IF TAPE                     IOC24680
       PXD     0,0                                                      IOC24690
       LGL     2                                                        IOC24700
       PAC     0,4                                                      IOC24710
       CAL     BM00+2                                                   IOC24720
       LGR     6                                                        IOC24730
       CAL     BC95,4              UNIT ABBREVIATION                    IOC24740
       LGL     6                   SUFFIX CHANNEL LETTER                IOC24750
BC91   AXT     **,4                RESTORE XR4                          IOC24760
BC94   AXT     **,2                IR2                                  IOC24770
       LDI     BC97                AND INDICATORS                       IOC24780
       TRA     1,4                 EXIT                                 IOC24790
BC92   PXD     0,0                 HERE IF TAPE                         IOC24800
       LGL     6                   GET UNIT NUMBER                      IOC24810
       PAX     0,4                                                      IOC24820
       TIX     *+1,4,16            MAY BE BINARY ADDRESS                IOC24830
       PXA     0,4                                                      IOC24840
       XCL                                                              IOC24850
       TSX     BCVR,4              CONVERT NUMBER TO BCD                IOC24860
       LDQ     BLANKZ                                                   IOC24870
       LGR     12                                                       IOC24880
       AXT     12,2                LEFT JUSTIFY UNIT NUMBER             IOC24890
       TSX     BSCNA,4                                                  IOC24900
       CAL     BM00+2              PREFIX CHANNEL LETTER                IOC24910
       LGL     12                                                       IOC24920
       TRA     BC91                                                     IOC24930
BC93   CAL     BLANKZ                                                   IOC24940
       TRA     BC91                                                     IOC24950
BC95   OCT     000000000017                                             IOC24960
       BCI     1,    RD                                                 IOC24970
       BCI     1,    PU                                                 IOC24980
       BCI     1,    PR                                                 IOC24990
BC96   BCI     1,     +                                                 IOC25000
BC97   PZE     0                                                        IOC25010
       TTL     I/O UNIT ASSIGNMENT ROUTINE                              IOC25020
*          THIS ROUTINE, ENTERED AFTER AN INITIAL SCAN OF THE           IOC25030
*            UNIT FIELD, USING BSCAN, CONVERTS THE SYMBOLIC             IOC25040
*    UNIT DESIGNATION TO AN INTERMEDIATE DESIGNATION FOR THE UNIT.      IOC25050
       SPACE   1                                                        IOC25060
*      CALLING SEQUENCE                                                 IOC25070
       SPACE   1                                                        IOC25080
*      TSX BASGN,4                                                      IOC25090
       SPACE   1                                                        IOC25100
*                                ENTRY                                  IOC25110
*      1.X2 CONTAINS THE COUNT OF SIGNIFICANT BITS IN THE               IOC25120
*        SYMBOLIC UNIT DESIGNATION.                                     IOC25130
*      2.THE HIGH MQ CONTAINS THE UNIT DESIGNATION                      IOC25140
*      3.THE RIGHT INDICATORS CONTAIN THE CHARACTER TYPES               IOC25150
*        FROM BSCAN.                                                    IOC25160
       SPACE   1                                                        IOC25170
*                                 EXIT                                  IOC25180
*      1,THE INTERMEDIATE DESIGNATION IS IN XR2.C(XR2)=0 IF THE         IOC25190
*        UNIT IS NOT PRESENT OR IF THE SYMBOLIC DESIGNATION             IOC25200
*        IS ILLEGAL. C(IR2)=77777 IF THE FILE IS INTERNAL.              IOC25210
       SPACE   1                                                        IOC25220
*             THE SYMBOLIC UNIT DESIGNATION MUST BE OF THE              IOC25230
*                            FOLLOWING FORM                             IOC25240
       SPACE   1                                                        IOC25250
*                                TAPE -  XKM                            IOC25260
*      WHERE X=LOGICAL CHANNEL (A,..,H), SYMBOLIC CHANNEL (S,..Z)       IOC25270
*          OR INTER SYSTEM RESERVE SYMBOLIC CHANNEL (J,..,Q)            IOC25280
*              K= UNIT NUMBER (0...,9). K=0 IS EQUIVALENT TO            IOC25290
*                                  K=10                                 IOC25300
*              M=II FOR A MODEL II TAPE DRIVE OR M TO INDICATE          IOC25310
*         AN INTER SYSTEM RESERVE INPUT IS TO BE REMOVED FROM           IOC25320
*                            RESERVE STATUS                             IOC25330
*                         ON-LINE READER - RDX                          IOC25340
*                        ON-LINE PRINTER - PRX                          IOC25350
*                         ON-LINE PUNCH - PUX                           IOC25360
*                  WHERE X=LOGICAL CHANNEL (A,...,H)                    IOC25370
*                       SYSTEM UNITS OF THE SET                         IOC25380
*   LB1,LB2,LB3,LB4,CRD,PRT,PCH,OU1,OU2,IN1,IN2,PP1,PP2,CK1,CK2,UT1,    IOC25390
*                             UT2,UT3,UT4.                              IOC25400
       SPACE   1                                                        IOC25410
BASGN  SXA     BT99,4              SAVE IRS                             IOC25420
       SXA     BT99+1,1                                                 IOC25430
       SXA     BT00,2              SAVE BIT COUNT                       IOC25440
       TXL     BT01,2,12           IF ONLY 2 CHARACTERS IT IS TAPE      IOC25450
       TXL     BT02,2,18           IF 3 CHARACTERS TEST SYSUNI.         IOC25460
BT01   AXT     6,2                 4 CHARACTERS OR 2 OR 1               IOC25470
       TSX     BSCNA,4             SCAN FIRST CHARACTER.                IOC25480
       RFT     000034              IS IT ALPHABETIC                    $IOC25490
       TRA     *+2                 YES                                 $IOC25500
       TRA     BT500               TEST FOR * MEANING SAME UNIT TYPE    IOC25510
       LGL     2                   ROLL OFF ZONE                        IOC25520
       PXD     0,0                 CLEAR IT                             IOC25530
       LGL     4                   NUMERIC TO AC                        IOC25540
       PAX     0,1                 SAVE IT IN IR1                       IOC25550
BT00   AXT     **,2                                                     IOC25560
       RFT     30                                                      $IOC25570
       TRA     BT10                                                    $IOC25580
       TXH     BT515,1,8           TRANSFER IF INTERNAL FILE           $IOC25590
       TXL     BT01A,2,6           CHANNEL ONLY DESIGNATED              IOC25600
       AXT     6,2                                                      IOC25610
       TSX     BSCNA,4             SCAN UNIT NUMBER                     IOC25620
       RFT     174                 TEST FOR NUMERIC                     IOC25630
       TRA     BT04A               NOT NUMERIC TEST MODEL               IOC25640
       PXD     0,0                                                      IOC25650
       LGL     6                   UNIT TO AC                           IOC25660
       TNZ     *+2                 IF ZERO                              IOC25670
       CAL     BTEN                MAKE IT 10                           IOC25680
       PAX     0,2                 UNIT TO IR2                          IOC25690
       PXD     0,1                 CHANNEL TO AC                        IOC25700
       SUB     1B17                -1                                   IOC25710
       ALS     4                   *16                                  IOC25720
       STD     *+1                 TO                                   IOC25730
       TXI     *+1,2,**            IR2                                  IOC25740
BT04   TXI     *+1,2,SECOND        SET SYMBOLIC UNIT DESIGNATED         IOC25750
       LXA     BT00,1              PICKUP CHARACTER COUNT.              IOC25760
       TXL     BT99,1,12           DONE IF ONLY 2 CHARACTERS.           IOC25770
       TXH     BT03,1,18           4 CHARACTERS, TEST II OR IV.         IOC25780
BT04B  PXD     0,0                 SINGLE CHARACTER                     IOC25790
       LGL     6                   TO AC.                               IOC25800
       LAS     BTR                 COMPARE WITH R                       IOC25810
       TRA     *+2                 NO. TRY V FOR MOD V                  IOC25820
       TXI     BT99,2,REMOVE       REMOVE RESERVE STATUS                IOC25830
       LAS     BTV                 COMPARE WITH MOD V                   IOC25840
       TRA     BT51                ERROR                                IOC25850
       TXI     BT99,2,MODII        FLAG MOD II OR V DESIRED             IOC25860
       TRA     AB08                                                  (1)IOC25870
BT04A  RNT     4                   A - I ALPHABETIC                     IOC25880
       TRA     BT04B               NO, CHECK FOR REMOVE                 IOC25890
BT03   PXD     0,0                 CLEAR AC                             IOC25900
       LGL     12                  2 CHARACTERS TO AC                   IOC25910
       LAS     BTII                COMPARE WITH II                      IOC25920
       TRA     *+2                 NO.                                  IOC25930
       TXI     BT99,2,MODII        FLAG MODEL II DESIRED                IOC25940
       LAS     BTIV                COMPARE WITH IV                      IOC25950
       TRA     BT51                ERROR                                IOC25960
       TRA     BT99                MOD IV OK.                           IOC25970
       LGR     6              SET UP AND                               $IOC25980
       RIR     7                                                       $IOC25990
       LAS     BTD            COMPARE WITH 'D'                         $IOC26000
       TRA     *+3                                                     $IOC26010
       TRA     DASGN          SET UP AS DISK UCW                       $IOC26020
       TRA     BT51                                                    $IOC26030
       LAS     BTD+1               COMPARE WITH-H-                     $IOC26040
       TRA     BT51                ERROR                               $IOC26050
       TRA     *+2                 HYPER TAPE                          $IOC26060
       TRA     BT51                ERROR                               $IOC26070
       CLA     L(1)                7909 CHANNEL BIT                    $IOC26080
       SIR     1                   SET HYPER BIT                       $IOC26090
       ALS     7                                                       $IOC26100
       RQL     11                  LEAVE ROOM FOR CHANNEL              $IOC26110
       LGL     1                   INTERFACE BIT                       $IOC26120
       RQL     25                                                      $IOC26130
       LGL     5                   UNIT NUMBER                         $IOC26140
       TRA     *+9                                                     $IOC26150
DASGN  CLA     L(1)                7909 CHANNEL BIT                    $IOC26160
       ALS     7              LEAVE ROOM FOR CHAN.                     $IOC26170
       TRA     AB09                                                  (1)IOC26180
       LGL     4              GET RID                                  $IOC26190
       ARS     4              OFF EXCESS                               $IOC26200
       LGL     4              GET ACCESS                               $IOC26210
       ARS     2              SHIFT OFF EXCESS                         $IOC26220
       LGL     4              GET MODULE                               $IOC26230
       STA     DUCBW                                                   $IOC26240
       PXA     0,1            PUT CHANNEL                              $IOC26250
       ALS     9              IN THE                                   $IOC26260
       ORS     DUCBW          TEMP. UCBW                               $IOC26270
       LXA     DUCBW,2                                                 $IOC26280
       STZ     DUCBW                                                   $IOC26290
       SXD     DUCBW,2                                                 $IOC26300
       RNT     1                   IF ON HYPER                         $IOC26310
       TRA     BT99                                                    $IOC26320
       STZ     DUCBW               AFTER ZEROING OUT THE               $IOC26330
       STL     CHATY               DISK CONTROL WORD                   $IOC26340
       TRA     BT99                AND SETTING HYPER FLAG              $IOC26350
BT01A  PXD     0,1                 CHANNEL ONLY. USE TRUE               IOC26360
       SUB     1B17                UNIT ZERO                            IOC26370
       ALS     4                   CHANNEL-1 * 16                       IOC26380
       PDX     0,2                 TO IR2                               IOC26390
       TXI     BT99,2,SECOND       EXIT.                                IOC26400
BT500  PXD     0,0                                                      IOC26410
       LGL     6                                                        IOC26420
       LAS     BTS                                                      IOC26430
       TRA     BT51                                                     IOC26440
       TRA     *+2                                                      IOC26450
       TRA     BT51                                                     IOC26460
       AXT     SAME+SECOND,2       SAME TYPE UNIT FLAG                 $IOC26470
       TRA     BT99                                                     IOC26480
*     3 CHARACTERS ARE DESIGNATED FOR UNIT. TEST FOR SYSTEM TYPE.       IOC26490
BT02   PXD     0,0                 CLEAR AC                             IOC26500
       LGL     18                  3 CHARACTERS TO AC                   IOC26510
       AXT     1,2                 SET INDEX TO FIRST SYS UNI.          IOC26520
       AXT     0,4                 POINTER TO FIRST SYMBOLIC UNIT.      IOC26530
       LAS     BTTBL,4             COMPARE WITH TABLE.                  IOC26540
       TXI     *+3,2,1             NOT THIS ONE.                        IOC26550
       TRA     AB10                SYSTEM UNIT FUNCTION              (1)IOC26560
       TXI     *+1,2,1             NOT YET.                             IOC26570
       TXI     *+1,4,-1            TRY NEXT ONE.                        IOC26580
       TXH     *-5,4,-19           BACK UNLESS                          IOC26590
       LGR     6                   NOT SYSTEM UNIT. MAY BE              IOC26600
       AXT     3,1                 CARD UNIT                            IOC26610
       LAS     BT91+3,1            TRY PRINTER,                         IOC26620
       TRA     *+2                 PUNCH, THEN READER.                  IOC26630
       TRA     BT021               FOUND. TEST CHANNEL.                 IOC26640
       TIX     *-3,1,1             TRY NEXT TYPE                        IOC26650
       LGR     12                  NOT CARD UNIT                        IOC26660
       TRA     BT01                BACK TO TAPE.                        IOC26670
BT021  TXI     *+1,1,-1            UNIT TYPE FOR ASSIGNMENT             IOC26680
       PXD     0,1                                                      IOC26690
       STD     BT023                                                    IOC26700
       ALS     2                                                        IOC26710
       STD     BT022                                                    IOC26720
       AXT     6,2                 SCAN CHANNEL                         IOC26730
       TSX     BSCNA,4             DESIGNATION                          IOC26740
       RNT     4                   IS IT A-I ALPHABETIC.                IOC26750
       TRA     BT51                NO. ERROR.                           IOC26760
       LGL     2                   SHIFT OFF ZONE                       IOC26770
       PXD     0,0                 X                                    IOC26780
       LGL     4                   NUMERIC TO AC                        IOC26790
       PAX     0,1                 TO IR1                               IOC26800
       SUB     BONE                CHANNEL-1                            IOC26810
       ACL     SYSUBC              A BASE OF UNIT CONFIGURATION         IOC26820
       STD     *+1                 TABLE. NO OF CHANNEL TO COMPARE.     IOC26830
       TXH     BT51,1,**           ERROR. CHANNEL NOT ON SYSTEM.        IOC26840
       STA     *+1                 PICKUP CONFIGURATION OF              IOC26850
       CAL     **                  CHANNEL DESIGNATED.                  IOC26860
       PAX     0,2                                                      IOC26870
       ARS     15                  PREFIX CONTAINS CARD EQUIP. COUNT.   IOC26880
       PDX     0,1                 NO. OF CARD UNITS TO IR1             IOC26890
BT023  TXL     BT51,1,**           ERROR. UNIT NOT ON CHANNEL           IOC26900
BT022  TXI     BT99,2,**           DESIGNATE CARD UNIT.                 IOC26910
*                 UNIT IS SYMBOLIC CHANNEL TEST TYPE.                   IOC26920
BT10   RNT     10                  J-R ALPHABETIC                       IOC26930
       TRA     BT30                S-Z ALPHABETIC.                      IOC26940
*     UNIT IS J-R ALPHABETIC INDICATING INTER SYSTEM RESERVE UNIT.      IOC26950
       TXL     BT11,2,6            USE TRUE UNIT ZERO.                  IOC26960
       AXT     6,2                 SCAN UNIT NUMBER                     IOC26970
       TSX     BSCNA,4             X                                    IOC26980
       RFT     174                 TEST FOR NUMERIC                     IOC26990
       TRA     BT12                ALPHABETIC TEST MOD TYPE             IOC27000
       PXD     0,0                 CLEAR AC                             IOC27010
       LGL     6                   NUMBER TO AC                         IOC27020
       TNZ     *+2                 SUBSTITUTE                           IOC27030
       CAL     BTEN                10 FOR ZERO                          IOC27040
       PAX     0,2                 UNIT TO IR2                          IOC27050
       PXD     0,1                 CHANNEL NO. TO AC                    IOC27060
       SUB     1B17                -1                                   IOC27070
       ALS     4                   *16                                  IOC27080
       STD     *+1                 TO                                   IOC27090
       TXI     *+1,2,**            IR2                                  IOC27100
       TXI     BT04,2,RESERV       GO FINISH OUT DESIGNATION.           IOC27110
BT30   TXL     BT31,2,6            CHANNEL ONLY                        $IOC27120
       AXT     6,2                 SCAN                                 IOC27130
       TSX     BSCNA,4             UNIT NUMBER                          IOC27140
       RFT     174                 TEST FOR NUMERIC                     IOC27150
       TRA     BT51                ERROR NOT NUMERIC                    IOC27160
       PXD     0,0                 CLEAR AC                             IOC27170
       LGL     6                   UNIT NUMBER TO AC                    IOC27180
       TNZ     *+2                 SUBSTITUTE 10 FOR                    IOC27190
       CAL     BTEN                ZERO.                                IOC27200
       PAX     0,2                 UNIT TO IR2                          IOC27210
       PXD     0,1                 CHANNEL+1 TO AC                      IOC27220
       SUB     1B17                -1=CHANNEL                           IOC27230
       SUB     1B17                -1                                   IOC27240
       ALS     4                   *16                                  IOC27250
       STD     *+1                 TO                                   IOC27260
       TXI     *+1,2,**            IR2                                  IOC27270
       TXI     BT04,2,SYMBOL       GO FINISH OUT DESIGNATION.           IOC27280
BT31   PXD     0,1                 CHANNEL ONLY                         IOC27290
       SUB     1B17                DESIGNATED                           IOC27300
       SUB     1B17                USE TRUE UNIT ZERO                   IOC27310
       ALS     4                   X                                    IOC27320
       PDX     0,2                 X                                    IOC27330
       TXI     BT99,2,SECOND+SYMBOL EXIT WITH SYMBOLIC CHAN. ONLY       IOC27340
BT11   PXD     0,1                 CHANNEL ONLY DESIGNATED              IOC27350
       SUB     1B17                USE TRUE UNIT ZERO                   IOC27360
       ALS     4                   X                                    IOC27370
       PDX     0,2                 CHANNEL-1 * 16 TO IR2                IOC27380
       TXI     BT99,2,RESERV       EXIT WITH CHANNEL ONLY               IOC27390
BT12   PXD     0,1                                                      IOC27400
       SUB     1B17                                                     IOC27410
       ALS     4                                                        IOC27420
       PDX     0,2                                                      IOC27430
       TXI     *+1,2,SECOND+RESERV                                      IOC27440
       RNT     4                   A - I ALPHABETIC                     IOC27450
       TRA     BT04A               NO, TEST FOR REMOVE                  IOC27460
       PXD     0,0                                                      IOC27470
       LGL     12                                                       IOC27480
       LAS     BTII                MOD II                               IOC27490
       TRA     *+2                 NO.                                  IOC27500
       TXI     BT99,2,MODII        INDICATE MOD II                      IOC27510
       LAS     BTIV                MOD IV                               IOC27520
       TRA     BT51                NO ERROR                             IOC27530
       TRA     BT99                YES OK                               IOC27540
*                        ERROR UNIT IS ILLEGAL                          IOC27550
BT51   AXT     0,2                                                      IOC27560
BT99   AXT     **,4                                                     IOC27570
       AXT     **,1                                                     IOC27580
       TRA     1,4                                                      IOC27590
*                     INTERNAL FILE IS DESIGNATED                       IOC27600
BT515  AXT     -1,2                                                     IOC27610
       TRA     BT99                                                     IOC27620
BT91   BCI     1,0000PR                                                 IOC27630
       BCI     1,0000PU                                                 IOC27640
       BCI     1,0000RD                                                 IOC27650
BTII   BCI     1,0000II                                                 IOC27660
BTIV   BCI     1,0000IV                                                 IOC27670
BTS    BCI     1,00000*                                                 IOC27680
BTR    BCI     1,00000R                                                 IOC27690
BTV    BCI     1,00000V                                                 IOC27700
BTTBL  BCI     1,000LB1                                                 IOC27710
       BCI     1,000LB2                                                 IOC27720
       BCI     1,000LB3                                                 IOC27730
       BCI     1,000LB4                                                 IOC27740
       BCI     1,000CRD                                                 IOC27750
       BCI     1,000PTR                                                 IOC27760
       BCI     1,000PCH                                                 IOC27770
       BCI     1,000OU1                                                 IOC27780
       BCI     1,000OU2                                                 IOC27790
       BCI     1,000IN1                                                 IOC27800
       BCI     1,000IN2                                                 IOC27810
       BCI     1,000PP1                                                 IOC27820
       BCI     1,000PP2                                                 IOC27830
       BCI     1,000CK1                                                 IOC27840
       BCI     1,000CK2                                                 IOC27850
       BCI     1,000UT1                                                 IOC27860
       BCI     1,000UT2                                                 IOC27870
       BCI     1,000UT3                                                 IOC27880
       BCI     1,000UT4                                                 IOC27890
       TTL              NORMAL MESSAGE ROUTINE                          IOC27900
*          THIS ROUTINE PRINTS ANY OF THE NORMAL PREPROCESSOR           IOC27910
*           MESSAGES, RESTORING TO AND HEADING THE FOLLOWING            IOC27920
*                         PAGE WHEN NECESSARY.                          IOC27930
       SPACE   1                                                        IOC27940
*      CALLING SEQUENCE                                                 IOC27950
       SPACE   1                                                        IOC27960
*      TSX BWRT,4                                                       IOC27970
*      PZE L,,N                                                         IOC27980
       SPACE   1                                                        IOC27990
*                                WHERE                                  IOC28000
*                         L=ORIGIN OF MESSAGE                           IOC28010
*              N=NUMBER OF WORDS IN MESSAGE (12 OR LESS)                IOC28020
       SPACE   1                                                        IOC28030
BWRT   SXA     BD03,4              SAVE XR4                             IOC28040
       CAL     1,4                 SET UP PROUT C.S.                    IOC28050
       SLW     BD02                                                    *IOC28060
       LXD     BLTP,4              REMAINING LINES, THIS PAGE           IOC28070
       TIX     BD01,4,1            ARE WE AT END OF PAGE               $IOC28080
       CAL     BPGN2               YES-INCREMENT PAGE NUMBER            IOC28090
       ADD     BONE                                                     IOC28100
       SLW     BPGN2                                                    IOC28110
       XCL                                                              IOC28120
       TSX     BCVR,4              CONVERT TO BCD                       IOC28130
       SLW     BU50+11             STORE IN HEADER                      IOC28140
       TSX     BPRNT,4             RESTORE,PRINT HEADER                 IOC28150
       PZE     3                                                        IOC28160
       PZE     BU50,0,512*BSK1                                          IOC28170
       PZE     BU50,0,12                                                IOC28180
       PZE     BU50,0,0                                                 IOC28190
       AXT     BCTLN-2,4           SET LINE COUNT FOR PAGE              IOC28200
BD01   SXD     BLTP,4              SAVE LINE COUNT                      IOC28210
       LDC     BD02,4                                                   IOC28220
       TXL     BD03,4,0            EXIT IF NO MESSAGE                   IOC28230
       TSX     BPRNT,4             PRINT MESSAGE                        IOC28240
       PZE     1                                                       $IOC28250
BD02   PZE     **,,**                                                   IOC28260
BD03   AXT     **,4                                                     IOC28270
       TRA     2,4                 EXIT                                 IOC28280
       TTL              ERROR MESSAGE ROUTINE                           IOC28290
*          THIS ROUTINE PRINTS A PREPROCESSOR ERROR MESSAGE,            IOC28300
*           RESTORING TO AND HEADING THE FOLLOWING PAGE WHEN            IOC28310
*            NECESSARY. ALL MESSAGES ARE CONSIDERED URGENT.             IOC28320
*         THE CONTROL CARD NUMBER IS PRINTED WITH THE MESSAGE.          IOC28330
       SPACE   1                                                        IOC28340
*      CALLING SEQUENCE                                                 IOC28350
       SPACE   1                                                        IOC28360
*      TSX BERR,4                                                       IOC28370
*      PZE L,,N                                                         IOC28380
       SPACE   1                                                        IOC28390
*                                WHERE                                  IOC28400
*                         L=ORIGIN OF MESSAGE                           IOC28410
*               N=NUMBER OF WORDS IN MESSAGE (9 OR LESS)                IOC28420
       SPACE   1                                                        IOC28430
*              AN EXTRA SPACE IS GIVEN AFTER EACH MESSAGE               IOC28440
       SPACE   1                                                        IOC28450
BERR   SXA     BE04,4              SAVE XR4                             IOC28460
       CAL     1,4                                                      IOC28470
       STA     BE06                                                     IOC28480
       PDC     0,4                                                      IOC28490
       SXD     BE00,4              SET INDEX LIMIT FOR TRANSFER         IOC28500
       ADD     BE05                                                     IOC28510
       STD     BE03                STORE TOTAL WORD COUNT               IOC28520
       LDQ     BCDCT                                                    IOC28530
       TSX     BCVR,4              CONVERT CARD NUMBER                  IOC28540
       XCL                                                              IOC28550
       RQL     12                                                       IOC28560
       STQ     BU01+2              STORE IN IMAGE                       IOC28570
       AXT     0,4                                                      IOC28580
BE06   CAL     **,4                MOVE ERROR MESSAGE                   IOC28590
       SLW     BU01+3,4                                                 IOC28600
       TXI     *+1,4,-1                                                 IOC28610
BE00   TXH     *-3,4,**                                                 IOC28620
       LXA     BLTP,4              REMAINING LINES, THIS PAGE           IOC28630
       TIX     BE02,4,2            ARE WE AT END OF PAGE                IOC28640
       CAL     BPGN1               YES-INCREMENT PAGE NUMBER            IOC28650
       ADD     BONE                                                     IOC28660
       SLW     BPGN1                                                    IOC28670
       XCL                                                              IOC28680
       TSX     BCVR,4              CONVERT PAGE NUMBER TO BCD           IOC28690
       SLW     BU00+11             STORE IN HEADER                      IOC28700
       TSX     BPRNT,4             RESTORE,PRINT HEADER                 IOC28710
       PZE     3,0,0                                                    IOC28720
       PZE     BU00,0,512*BSK1                                          IOC28730
       PZE     BU00,0,12                                                IOC28740
       PZE     BU00,0,0                                                 IOC28750
       AXT     BCTLN-2,4           SET LINE COUNT FOR PAGE              IOC28760
BE02   SXA     BLTP,4              SAVE LINE COUNT                      IOC28770
       TSX     BPRNT,4             PRINT MESSAGE                        IOC28780
       PZE     2,0,0                                                    IOC28790
BE03   PZE     BU01,,**                                                 IOC28800
       PZE     BU00,0,0                                                 IOC28810
       CAL     BERCT               INCREASE ERROR COUNT                 IOC28820
       ADD     BONE                                                     IOC28830
       SLW     BERCT                                                    IOC28840
BE04   AXT     **,4                RESTORE XR4                          IOC28850
       TRA     2,4                 EXIT                                 IOC28860
BE05   PZE     0,0,3                                                    IOC28870
       SPACE   1                                                        IOC28880
*                            ERROR MESSAGES                             IOC28890
       SPACE   1                                                        IOC28900
BU00   BCI     9, IOCS PREPROCESSOR ERROR LIST. JOB- XXXXXXXXXXXXXXXXXX IOC28910
       BCI     3,        PAGE   XXX                                     IOC28920
BU01   BCI     9,      CARD   XXX                                       IOC28930
       BCI     3,                                                       IOC28940
BU02   BCI     6,ILLEGAL OPERATION--    (XXXXXX)                        IOC28950
BU04   BCI     5,FILE BLOCK ORIGIN NOT OCTAL                            IOC28960
BU05   BCI     5,FILE CONTROL BLOCK COUNT ERROR                         IOC28970
BU06   BCI     4,FILE BLOCK WILL NOT FIT                                IOC28980
BU07   BCI     6,FILE CONTROL BLOCK NUMBER ERROR                        IOC28990
BU08   BCI     3,UNIT 1 ILLEGAL                                         IOC29000
BU09   BCI     3,UNIT 2 ILLEGAL                                         IOC29010
BU11   BCI     2,DATE ERROR                                             IOC29020
BU12   BCI     4,JOB CARD OUT OF PLACE                                  IOC29030
BU13   BCI     3,CONTROL CARD EOF                                       IOC29040
BU14   BCI     4,CONTROL CARD REDUNDANCY                                IOC29050
BU15   BCI     6,REEL SEQUENCE NUMBER NOT NUMERIC                       IOC29060
       SPACE   1                                                        IOC29070
*                      ASSIGNMENT LISTING HEADERS                       IOC29080
       SPACE   1                                                        IOC29090
BU50   BCI     9, JOB- XXXXXXXXXXXXXXXXXX      DATE  00/00/00           IOC29100
       BCI     3,        PAGE   XXX                                     IOC29110
BU51   BCI     9,   FILE DESCRIPTIONS (MOUNT FILES MARKED WITH *)--     IOC29120
BU52   BCI     9,       NO.  FILE NAME          UNIT  MOUNT TAPES--     IOC29130
       BCI     3,                                                       IOC29140
BU595  BCI     4,MOUNT INDICATED TAPES                                  IOC29150
BU60   BCI     8,CONTINUE IF CONTROL CARD ERRORS CAN BE IGNORED         IOC29160
       TTL              FILE CONTROL ITEM SCAN                          IOC29170
*      CALLING SEQUENCE                                                 IOC29180
       SPACE   1                                                        IOC29190
*      TSX BCNTR,4                                                      IOC29200
*      PZE L,,2*N                                                       IOC29210
       SPACE   1                                                        IOC29220
*           WHERE L IS THE ORIGIN OF A TABLE OF N WORD PAIRS            IOC29230
*        WORD 1   BCI  1,00000X                                         IOC29240
*        WORD 2   OCT  NNNNNNNNNNNN                                     IOC29250
*          X IS A PERMITTED BCD CONTROL CHARACTER. WORD 2 IS            IOC29260
*                 THE CORRESPONDING INDICATOR SETTING.                  IOC29270
       SPACE   1                                                        IOC29280
*                                ENTRY                                  IOC29290
*          THE BCD CONTROL CHARACTER IS IN THE MQ.BITS S,1-5            IOC29300
       SPACE   1                                                        IOC29310
*                                 EXIT                                  IOC29320
*         THE MQ HAS BEEN SHIFTED LEFT 6 BITS. A TABLE LOOK-UP          IOC29330
*          HAS BEEN MADE TO MATCH THE CONTROL CHARACTER. WHEN           IOC29340
*          A MATCH OCCURS, THE NEXT TABLE WORD IS ORED TO THE           IOC29350
*         INDICATORS. IF NO MATCH OCCURS, THE LAST TABLE WORD           IOC29360
*                      IS ORED TO THE INDICATORS.                       IOC29370
       SPACE   1                                                        IOC29380
BCNTR  SXA     BR01,4              SAVE XR4                             IOC29390
       CAL     1,4                                                      IOC29400
       PAX     0,4                                                      IOC29410
       STD     *+1                                                      IOC29420
       TXI     *+1,4,**                                                 IOC29430
       SXA     BR00,4                                                   IOC29440
       LXD     *-2,4                                                    IOC29450
       PXD     0,0                                                      IOC29460
       LGL     6                   GET CONTROL CHARACTER                IOC29470
BR00   CAS     **,4                TABLE LOOK-UP                        IOC29480
       TRA     *+2                                                      IOC29490
       TRA     *+2                                                      IOC29500
       TIX     *-3,4,2                                                  IOC29510
       TXI     *+1,4,-1                                                 IOC29520
       OSI*    BR00                                                     IOC29530
BR01   AXT     **,4                RESTORE XR4                          IOC29540
       TRA     2,4                 EXIT                                 IOC29550
       TTL              FIELD SCAN ROUTINE                              IOC29560
*      CALLING SEQUENCE                                                 IOC29570
       SPACE   1                                                        IOC29580
*      TSX BSCAN,4                                                      IOC29590
       SPACE   1                                                        IOC29600
*                                ENTRY                                  IOC29610
*      1. THE MQ CONTAINS THE APPROPRIATE CONTROL CARD                  IOC29620
*         FIELD DEFINITION WORD                                         IOC29630
*              VFD 6/6*N,12/S,3/0,15/L                                  IOC29640
*       N=NUMBER OF CHARACTERS IN FIELD(LESS THAN OR EQUAL TO 6)        IOC29650
*        L=RELATIVE LOCATION IN CONTROL CARD IMAGE(BQ00) OF THE         IOC29660
*             WORD IN WHICH THE FIELD BEGINS(L=0,1,...,11)              IOC29670
*           S=AMOUNT OF RIGHT SHIFT REQUIRED TO LEFT JUSTIFY            IOC29680
*          THE FIELD IN THE MQ IF A IS LOADED WITH C(L), THE            IOC29690
*                            MQ WITH C(L+1)                             IOC29700
       SPACE   1                                                        IOC29710
*                                 EXIT                                  IOC29720
*      1. X2 CONTAINS 6*M, WHERE M IS THE NUMBER OF                     IOC29730
*         SIGNIFICANT (NON-BLANK) CHARACTERS IN THE                     IOC29740
*         FIELD.                                                        IOC29750
*      2. THE 6*M HIGH BITS OF THE MQ CONTAIN THE M                     IOC29760
*         SIGNIFICANT CHARACTERS OF THE FIELD. TRAILING                 IOC29770
*         BLANKS HAVE BEEN REPLACED BY ZEROS. IF THE                    IOC29780
*         FIELD IS ENTIRELY BLANK, THE HIGH 6*N BITS OF                 IOC29790
*         THE MQ ARE ZERO, AND C(X2)=0.                                 IOC29800
*      3. THE RIGHT INDICATOR BITS INDICATE THE CHARACTER               IOC29810
*         TYPES ENCOUNTERED BY THE SCAN (BLANK SETS NO                  IOC29820
*         INDICATOR)                                                    IOC29830
       SPACE   1                                                        IOC29840
*         35   OCTAL NUMERIC (0,...,7)                                  IOC29850
*         34   DECIMAL NUMERIC (8,9)                                    IOC29860
*         33   ALPHABETIC (A-I)                                         IOC29870
*         32   ALPHABETIC (J-R)                                         IOC29880
*         31   ALPHABETIC (S-Z)                                         IOC29890
*         30   CONNECTORS,SPECIAL CHARACTERS                            IOC29900
*         29   ILLEGAL CHARACTERS                                       IOC29910
       SPACE   1                                                        IOC29920
*                     NOTE- C(XR1) ARE PRESERVED.                       IOC29930
       SPACE   1                                                        IOC29940
BSCAN  SXA     BS04,4              SAVE XRS                             IOC29950
       SXA     BS03,1                                                   IOC29960
       PXD     0,0                                                      IOC29970
       LGL     6                   GET BIT COUNT OF FIELD               IOC29980
       RQL     12                                                       IOC29990
       PAX     0,2                                                      IOC30000
       XCL                                                              IOC30010
       PDC     0,4                 RELATIVE LOCATION OF FIELD           IOC30020
       STA     *+3                                                      IOC30030
       CAL     BQ00,4                                                   IOC30040
       LDQ     BQ00+1,4                                                 IOC30050
       LGR     **                  FIELD TO HIGH MQ                     IOC30060
BS05   SXA     BS02,2              INITIALIZE FINAL SHIFT               IOC30070
       RIR     777777                                                   IOC30080
       AXT     0,4                 INITIALIZE SIG. BIT COUNT            IOC30090
BS00   CRQ     BZ00,1,1            SCAN NEXT CHARACTER                  IOC30100
       TXL     BS01,1,0            TRANSFER IF BLANK                    IOC30110
       PXA     0,1                                                      IOC30120
       OAI                         SET INDICATOR FOR TYPE               IOC30130
       TXH     *+2,4,0             IS THIS FIRST NON-BLANK              IOC30140
       SXA     BS02,2              YES                                  IOC30150
       TXI     *+1,4,6             INCREMENT SIG. BIT COUNT             IOC30160
BS01   TIX     BS00,2,6            DONE                                 IOC30170
BS02   AXT     **,2                NO                                   IOC30180
       RQL     36,2                POSITION FIELD                       IOC30190
       PXA     0,4                 MOVE SIG. BIT COUNT                  IOC30200
       PAX     0,2                                                      IOC30210
BS03   AXT     **,1                RESTORE XRS                          IOC30220
BS04   AXT     **,4                                                     IOC30230
       TRA     1,4                 EXIT                                 IOC30240
       SPACE   1                                                        IOC30250
*                            ALTERNATE SCAN                             IOC30260
       SPACE   1                                                        IOC30270
*      CALLING SEQUENCE                                                 IOC30280
       SPACE   1                                                        IOC30290
*      TSX BSCNA,4                                                      IOC30300
       SPACE   1                                                        IOC30310
*                                ENTRY                                  IOC30320
*      1. X2 CONTAINS 6*N, THE NUMBER OF BITS TO SCAN.                  IOC30330
*      2. THE HIGH 6*N BITS OF THE MQ CONTAIN N BCD                     IOC30340
*         CHARACTERS TO BE SCANNED.                                     IOC30350
       SPACE   1                                                        IOC30360
*                                 EXIT                                  IOC30370
*             THE SAME INFORMATION IS PROVIDED AS ON EXIT               IOC30380
*                             FROM BSCAN.                               IOC30390
       SPACE   1                                                        IOC30400
*      NOTE - THIS ROUTINE IS MERELY AN ALTERNATE ENTRY TO BSCAN.       IOC30410
       SPACE   1                                                        IOC30420
BSCNA  SXA     BS04,4              SAVE XRS                             IOC30430
       SXA     BS03,1                                                   IOC30440
       TRA     BS05                ENTER BSCAN                          IOC30450
       TTL              CONTROL CARD INPUT ROUTINE                      IOC30460
*      CALLING SEQUENCE                                                 IOC30470
       SPACE   1                                                        IOC30480
*      TSX BCARD,4                                                      IOC30490
       SPACE   1                                                        IOC30500
*            THIS ROUTINE STORES THE NEXT CONTROL CARD AS A             IOC30510
*           BCD IMAGE IN A 12-WORD BUFFER BEGINNING AT BQ00.            IOC30520
*           THE INPUT UNIT REFERENCE WORD IS BX00. INPUT MAY            IOC30530
*             BE FROM THE CARD READER OR FROM TAPE. INPUT               IOC30540
*             BUFFERING IS INTERRUPTED WHEN A LOAD CONTROL              IOC30550
*                            CARD IS READ.                              IOC30560
       SPACE   1                                                        IOC30570
BCARD  SXA     BF91,1              SAVE XRS                             IOC30580
       SXA     BF92,2                                                   IOC30590
       SXA     BF94,4                                                   IOC30600
       STI     BF88                                                     IOC30610
       ZET     BF55                IS THIS THE FIRST ENTRY              IOC30620
       TRA     BF01                NO                                   IOC30630
       AXT     12,1                YES-INITIALIZE                       IOC30640
       STL     BF55                SET ENTRY GATE                       IOC30650
       CAL*    BX00                EXAMINE INPUT UNIT ADDRESS           IOC30660
       ANA     BF82                                                     IOC30670
       ERA     BF83                                                     IOC30680
       TNZ     *+2                 TRANSFER IF TAPE INPUT               IOC30690
       TXI     *+1,1,12            ADJUST RECORD WORD COUNT             IOC30700
       SXD     BF02,1                                                   IOC30710
BF04   TSX     BF70,4              REQUEST FIRST CARD                   IOC30720
BF01   NZT     BF85                SYNCHRONIZE LAST REQUEST             IOC30730
       TRA     *-1                                                      IOC30740
       LDI     BF85                                                     IOC30750
       LFT     200000                                                   IOC30760
       TRA     BF61                EOF                                  IOC30770
       LFT     100000                                                   IOC30780
       TRA     BF62                REDUNDANCY                           IOC30790
BF03   LXA     BF81,4              SET REFERENCE CELL LOCATION          IOC30800
BF02   TXI     *+1,4,**                                                 IOC30810
       SXA     BF51,4                                                   IOC30820
       SXA     BF52,4                                                   IOC30830
       CAL     BZ10                MODIFY CONVERT TABLE TO INVERT       IOC30840
       SLW     BZ00                ZEROS AND BLANKS                     IOC30850
       AXT     12,1                SET BCD WORD COUNT                   IOC30860
BF50   LXD     BF02,2              GET INPUT WORD COUNT                 IOC30870
       TXH     *+3,2,12            SKIP IF CARD INPUT                   IOC30880
BF51   LDQ     **,1                GET NEXT WORD                        IOC30890
       TRA     BF53                                                     IOC30900
       TXH     *+2,1,6             IS THIS RIGHT HALF                   IOC30910
       TXI     *+1,2,-1            YES-ADJUST LOCATION                  IOC30920
       STZ     BN00                CLEAR SUMMER 1                       IOC30930
       STZ     BN00+1              CLEAR SUMMER 2                       IOC30940
       STZ     BN00+2              CLEAR SUMMER 3                       IOC30950
BF52   LDQ     **,2                                                     IOC30960
       PXD     0,0                                                      IOC30970
       CAQ     BZ01,0,1            SPREAD THIS 6 BIT GROUP              IOC30980
       STQ*    BF52                                                     IOC30990
       TXH     *+5,2,6             SKIP IF NOT ZONE                     IOC31000
       ALS     4                   0,X,Y ROWS                           IOC31010
       ACL     BN00+1                                                   IOC31020
       SLW     BN00+1                                                   IOC31030
       TRA     *+3                                                      IOC31040
       ACL     BN00                1,...,9 ROWS                         IOC31050
       SLW     BN00                                                     IOC31060
       ACL     BN00+2                                                   IOC31070
       SLW     BN00+2                                                   IOC31080
       TIX     BF52,2,2            IS THIS BCD WORD DONE                IOC31090
       XCL                         CONVERT ZEROS TO BLANKS,             IOC31100
       AXT     6,2                 BLANKS TO ZEROS                      IOC31110
       CRQ     BZ00,0,1                                                 IOC31120
       TIX     *-1,2,1                                                  IOC31130
BF53   STQ     BQ00+12,1           STORE WORD IN IMAGE                  IOC31140
       TXL     BF54,1,10           IS THIS THE OP WORD                  IOC31150
       TXH     *+4,1,11                                                *IOC31160
BF56   TRA     *+1                                                     *IOC31170
       TSX     BF69,4              REQUEST NEXT CARD                   *IOC31180
       TRA     BF54                                                    *IOC31190
       XCL                         IS CURRENT OP IBSYS                 $IOC31200
       ERA     BLNKS               OR OTHER IBSYS CONTROL CARD         $IOC31210
       TRA     BF57                SKIP REQUEST                      (2)IOC31220
       STL     BF56                                                    *IOC31230
BF54   TIX     BF50,1,1            IS THE CARD COMPLETE                 IOC31240
       CAL     BZ12                                                     IOC31250
       SLW     BZ00                                                     IOC31260
BF91   AXT     **,1                RESTORE XRS                          IOC31270
BF92   AXT     **,2                                                     IOC31280
BF94   AXT     **,4                                                     IOC31290
       LDI     BF88                                                     IOC31300
       TRA     1,4                 EXIT                                 IOC31310
BF55   PZE     **                  ENTRY GATE                           IOC31320
*                      REQUEST NEXT CONTROL CARD                        IOC31330
BF69   CAL     BQ00+12,1           GET COL 7-12                        *IOC31340
       ERA     BF84                IS THE CURRENT OP LOAD               IOC31350
       TNZ     *+3                 NOT A LOAD CARD                     $IOC31360
       ZET     BCDCT               SKIPPING                            $IOC31370
       TRA     1,4                 NO AND THIS IS AN *LOAD CARD        *IOC31380
       CAL     BQ00+12,1           IS CURRENT OP IBSYS                 $IOC31390
       ERA     BRTN+1              IF SO WE SHALL                      $IOC31400
       TZE     1,4                 SKIP REQUEST                        *IOC31410
BF70   SXA     BF71,4                                                  *IOC31420
       AXT     BF56+1,4                                                *IOC31430
       SXA     BF56,4                                                  *IOC31440
       AXC     1,4                 INVERT ALTERNATOR                    IOC31450
       SXA     *-1,4                                                    IOC31460
       CAL     BF81,4              GET BUFFER ADDRESS                   IOC31470
       STA     BF81                SET UP IO COMMAND                    IOC31480
       LAC     BX00,4                                                   IOC31490
       CAL     BF86                                                     IOC31500
       SLW     1,4                 UCW WORD 2                           IOC31510
       STZ     BF85                INITIALIZE ACTIVITY CONTROL          IOC31520
       TSX     (ACTIV+1,4          ACTIVATE INPUT UNIT                  IOC31530
       PZE     BX00                                                     IOC31540
BF71   AXT     **,4                                                     IOC31550
       TRA     1,4                 EXIT                                 IOC31560
       SPACE   1                                                        IOC31570
BSEL   SXA     BF20,4                                                   IOC31580
       PAC     0,4                                                      IOC31590
       XCA                                                             $IOC31600
       CAL     0,4                 GET UNIT ADDRESS                     IOC31610
       PDX     0,2                                                     $IOC31620
       XCA                                                             $IOC31630
       TXH     BF72,2,8192         HYPER,TRA IF YES                    $IOC31640
       TMI     BF21                POSTING ENTRY                       $IOC31650
       SXA     BF18,2                                                  $IOC31660
       CAL     BF87                                                     IOC31670
       STA*    (RCHXI                                                   IOC31680
BF18   RDS     **                                                       IOC31690
       XEC*    (RCHXI                                                   IOC31700
       NZT     BCDCT               IF FIRST CARD OR SKIPPING            IOC31710
       STZ*    (RCTXI              SUPPRESS REDUNDANCY CHECKING         IOC31720
BF20   AXT     **,4                                                     IOC31730
       TRA     1,4                                                      IOC31740
BF21   STI     BF85                SET ACTIVITY CONTROL CELL            IOC31750
       STL     BF85                                                     IOC31760
       STZ     1,4                 CLEAR UCW WORD 2                     IOC31770
       TRA     BF20                                                     IOC31780
       PZE     BP00+24             INPUT BUFFER2                        IOC31790
BF81   IORT    **,0,24                                                  IOC31800
       PZE     BP00                INPUT BUFFER 1                       IOC31810
BF82   OCT     000777000000                                             IOC31820
BF83   OCT     000321000000                                             IOC31830
BF84   BCI     1,*LOAD                                                  IOC31840
BF85   PZE     0                                                        IOC31850
BF86   PZE     0,0,BSEL                                                 IOC31860
BF87   PZE     BF81                                                     IOC31870
BF88   PZE     0                                                        IOC31880
BF61   NZT     BCDCT               IF SKIPPING                          IOC31890
       TRA     BF04                IGNORE END OF FILE                   IOC31900
       TSX     BERR,4              CONTROL CARD EOF BEFORE LOAD         IOC31910
       PZE     BU13,,3                                                  IOC31920
       TSX     BPAWS,4             TO PAUSE ROUTINE                     IOC31930
       TRA     BF04                GO TO REINITIATE READING             IOC31940
BF62   TSX     BERR,4              CONTROL CARD REDUNDANCY              IOC31950
       PZE     BU14,,4                                                  IOC31960
       TRA     BF03                PROCESS CARD                         IOC31970
BF72   TMI     BF73                POST FOR HYPER                      $IOC31980
       PXD     0,2                                                     $IOC31990
       ANA     DEC15                                                   $IOC32000
       ORS     BF74                PUT UNIT IN SELECT                  $IOC32010
       PXA     0,2                                                     $IOC32020
       ARS     5                                                       $IOC32030
       ANA     L(1)                                                    $IOC32040
       ORS     BF76                PUT INTER FACE IN SMS               $IOC32050
       CLA     *-1                                                     $IOC32060
       STA*    (RCHXI                                                  $IOC32070
       CLA     BF81                PUT CORRECT BUF ADDRESS             $IOC32080
       STA     BF75                IN CPYD COMMAND                     $IOC32090
       XEC*    (RCHXI                                                  $IOC32100
       TRA     BF20                                                    $IOC32110
BF73   LFT     7100                ERROR                               $IOC32120
       TRA     *+3                 YES                                 $IOC32130
       LDI     FOR                                                     $IOC32140
       TRA     BF21                                                    $IOC32150
       RFT     14                  EOF,EWA                             $IOC32160
       TRA     *+3                                                     $IOC32170
       LDI     SIX                 EOF                                 $IOC32180
       TRA     BF21                                                    $IOC32190
       LDI     L(0)                REDUNDANCY                          $IOC32200
       TRA     BF21                                                     IOC32210
BF76   SMS     22                                                      $IOC32220
       CTLR    *+3                                                     $IOC32230
BF75   CPYD    **,,14                                                  $IOC32240
       TCH     SYSTWT                                                  $IOC32250
BF74   OCT     120600120112                                            $IOC32260
       TTL              BCD TO BINARY INTEGER CONVERSION                IOC32270
*      CALLING SEQUENCE                                                 IOC32280
       SPACE   1                                                        IOC32290
*      TSX BCONV,4                                                      IOC32300
       SPACE   1                                                        IOC32310
*                                ENTRY                                  IOC32320
*      1. N NUMERIC BCD CHARACTERS IN HIGH ORDER MQ. (N MUST BE         IOC32330
*         6 OR LESS).                                                   IOC32340
*      2. 6*N  IN X2.                                                   IOC32350
       SPACE   1                                                        IOC32360
*                                 EXIT                                  IOC32370
*      1. BINARY INTEGER IN LOGICAL ACCUMULATOR,B=35.                   IOC32380
       SPACE   1                                                        IOC32390
BCONV  STZ     BN00                INITIALIZE SUMMER                    IOC32400
       PXD     0,0                                                      IOC32410
BCON1  LGL     6                   GET NEXT DIGIT                       IOC32420
       ACL     BN00                ADD SUMMER                           IOC32430
       TNX     BCON2,2,6           TO EXIT IF COMPLETED                 IOC32440
       STQ     BN00+1                                                   IOC32450
       XCL                                                              IOC32460
       MPY     BTEN                                                     IOC32470
       STQ     BN00                SAVE PARTIAL PRODUCT                 IOC32480
       LDQ     BN00+1                                                   IOC32490
       TRA     BCON1                                                    IOC32500
BCON2  TRA     1,4                 EXIT                                 IOC32510
       TTL              BINARY TO BCD CONVERSION ROUTINE                IOC32520
*      CALLING SEQUENCE                                                 IOC32530
*      TSX BCVR,4                                                       IOC32540
       SPACE   1                                                        IOC32550
*                                ENTRY                                  IOC32560
*    UNSIGNED BINARY INTEGER (LESS THAN OR EQUAL TO 999999) IN MQ.      IOC32570
       SPACE   1                                                        IOC32580
*                                 EXIT                                  IOC32590
*         BCD INTEGER IN A, WITH LEADING BLANKS IF NECESSARY.           IOC32600
       SPACE   1                                                        IOC32610
*      NOTES                                                            IOC32620
*      1. ZERO CONVERTS TO ALL BLANKS.                                  IOC32630
*      2. THE MQ IS NORMALLY ZERO ON EXIT. IF THE INPUT INTEGER         IOC32640
*         IS GREATER THAN 999999, THE QUOTIENT,                         IOC32650
*         N/1000000, IS IN THE MQ.                                      IOC32660
BCVR   SXA     BCVR4,4             SAVE XR4                             IOC32670
       AXT     36,4                                                     IOC32680
       STZ     BN00                                                     IOC32690
BCVR1  PXD     0,0                                                      IOC32700
       DVP     BTEN                GET NEXT DIGIT                       IOC32710
       TZE     BCVR5                                                    IOC32720
       ALS     36,4                                                     IOC32730
       ORS     BN00                                                     IOC32740
BCVR2  TXI     *+1,4,-6                                                 IOC32750
       TXH     BCVR1,4,0                                                IOC32760
BCVR3  CAL     BLANKZ                                                   IOC32770
       ALS     36,4                                                     IOC32780
       ORA     BN00                                                     IOC32790
BCVR4  AXT     **,4                RESTORE XR4                          IOC32800
       TRA     1,4                 EXIT                                 IOC32810
BCVR5  STQ     BN00+1                                                   IOC32820
       ZET     BN00+1                                                   IOC32830
       TRA     BCVR2               CONTINUE-NOT DONE                    IOC32840
       TRA     BCVR3               CONVERSION FINISHED                  IOC32850
       SPACE   1                                                        IOC32860
*                    CONTROL CARD FIELD DEFINITIONS                     IOC32870
       SPACE   1                                                        IOC32880
BY00   VFD     6/6*3,12/0,3/0,15/1 FILE OR UNIT NUMBER                  IOC32890
BY01   VFD     6/6*4,12/6,3/0,15/2 UNIT1                                IOC32900
BY02   VFD     6/6*4,12/18,3/0,15/3 UNIT 2                              IOC32910
BY03   VFD     6/6*3,12/24,3/0,15/5 FILE CONTROL BLOCK COUNT            IOC32920
BY05   VFD     6/6*5,12/30,3/0,15/7 FILE BLOCK ORIGIN                   IOC32930
BY07   VFD     6/6*4,12/30,3/0,15/6 REEL SEQUENCE NUMBER FIELD          IOC32940
BY08   VFD     6/6*5,12/30,3/0,15/7 FILE SERIAL NUMBER FIELD            IOC32950
BY09   VFD     6/6*4,12/30,3/0,15/8 RETENTION DAYS                      IOC32960
       TTL     CONTROL CARD OPERATION LIST                              IOC32970
BZ02   BCI     1,*FILE                                                  IOC32980
       PZE     BFILE                                                    IOC32990
       BCI     1,*DATE                                                  IOC33000
       PZE     BDATE                                                    IOC33010
BJOBB  BCI     1,*JOB                                                   IOC33020
       PZE     BJ50                ERROR MESSAGE                        IOC33030
       BCI     1,*LOAD                                                  IOC33040
       PZE     BLOAD                                                    IOC33050
BFST   BSS     0                   THIS MUST TERMINATE THE OP LIST      IOC33060
       SPACE   1                                                        IOC33070
*                    TABLES FOR FILE CONTROL ITEMS                      IOC33080
       SPACE   1                                                        IOC33090
       SPACE   1                                                        IOC33100
*                           FILE TYPE TABLE                             IOC33110
       SPACE   1                                                        IOC33120
BW00   BCI     1,00000C            CHECKPOINT                           IOC33130
       OCT     003000000000                                             IOC33140
       BCI     1,00000P            PARTIAL OUTPUT                       IOC33150
       OCT     001000000000                                             IOC33160
       BCI     1,00000T            TOTAL OUTPUT                         IOC33170
       OCT     002000000000                                             IOC33180
       BCI     1,00000I            INPUT                                IOC33190
       OCT     000000000000                                             IOC33200
       SPACE   1                                                        IOC33210
*                        MULTI-REEL FLAG TABLE                          IOC33220
       SPACE   1                                                        IOC33230
BW01   BCI     1,00000M            MULTI-REEL (UNLABELLED ONLY)         IOC33240
       OCT     000040000000                                             IOC33250
       BCI     1,00000L            LABEL SEARCH(LABELLED ONLY)         $IOC33260
       OCT     000040000000                                             IOC33270
       BCI     1,00000                                                  IOC33280
       OCT     000000000000                                             IOC33290
       SPACE   1                                                        IOC33300
*                          DENSITY FLAG TABLE                           IOC33310
       SPACE   1                                                        IOC33320
BW02   BCI     1,00000H            HIGH                                 IOC33330
       OCT     000000100000                                             IOC33340
       BCI     1,000001            REWIND AT REEL SWITCH               $IOC33350
       OCT     000000200000                                            $IOC33360
       BCI     1,000002            FILE PROTECT AT REEL SWITCH         $IOC33370
       OCT     000000100000                                            $IOC33380
       BCI     1,000003            REW+FP AT REEL SWITCH               $IOC33390
       OCT     000000300000                                            $IOC33400
       BCI     1,00000L            LOW                                  IOC33410
       OCT     000000000000                                             IOC33420
       SPACE   1                                                        IOC33430
*                           MODE FLAG TABLE                             IOC33440
       SPACE   1                                                        IOC33450
BW03   BCI     1,00000N            MIXED,SPECIAL (1ST RECORD BINARY)    IOC33460
       OCT     404000000000                                             IOC33470
       BCI     1,00000B            BINARY                               IOC33480
       OCT     004000000000                                             IOC33490
       BCI     1,00000M            MIXED (FIRST RECORD BCD)             IOC33500
       OCT     400000000000                                             IOC33510
       BCI     1,00000D            DECIMAL                              IOC33520
       OCT     000000000000                                             IOC33530
       SPACE   1                                                        IOC33540
*                           LABEL FLAG TABLE                            IOC33550
       SPACE   1                                                        IOC33560
BW04   BCI     1,00000H            LABELLED-HIGH DENSITY                IOC33570
       OCT     000400200000                                             IOC33580
       BCI     1,00000L            LABELLED-LOW DENSITY                 IOC33590
       OCT     000400000000                                             IOC33600
       BCI     1,00000S            STANDARD SCRATCH TAPE CONVENTION     IOC33610
       OCT     000400400000                                             IOC33620
       BCI     1,000001            HYPER LABEL                         $IOC33630
       OCT     000400000000                                            $IOC33640
       BCI     1,00000             UNLABELLED                           IOC33650
       OCT     000000000000                                             IOC33660
       SPACE   1                                                        IOC33670
*                      SEQUENCE COUNT FLAG TABLE                        IOC33680
       SPACE   1                                                        IOC33690
BW05   BCI     1,00000S            YES-FORCE BINARY MODE                IOC33700
       OCT     004200000000                                             IOC33710
       BCI     1,00000             NO                                   IOC33720
       OCT     000000000000                                             IOC33730
       SPACE   1                                                        IOC33740
*                         CHECKSUM FLAG TABLE                           IOC33750
       SPACE   1                                                        IOC33760
BW06   BCI     1,00000C            YES-FORCE BINARY MODE, SEQUENCE      IOC33770
       OCT     004300000000                                             IOC33780
       BCI     1,00000             NO                                   IOC33790
       OCT     000000000000                                             IOC33800
       SPACE   1                                                        IOC33810
*                     CHECKPOINT CONVENTION TABLE                       IOC33820
       SPACE   1                                                        IOC33830
BW07   BCI     1,00000F            CHECKPOINT ON THIS FILE             $IOC33840
       OCT     200000000000                                             IOC33850
       BCI     1,00000C            CHECKPOINT ON CHECKPOINT FILE       $IOC33860
       OCT     100000000000                                             IOC33870
       SPACE   1                                                        IOC33880
*                       IMMEDIATE MOUNTING FLAG                         IOC33890
       SPACE   1                                                        IOC33900
BW08   BCI     1,00000             NO                                   IOC33910
       OCT     000000000000                                             IOC33920
       BCI     1,00000*                                                 IOC33930
       OCT     400000400000                                             IOC33940
       SPACE   1                                                        IOC33950
*                      IOCS LOADING CONTROL TABLE                       IOC33960
       SPACE   1                                                        IOC33970
BW09   BCI     1,00000E            EXECUTOR ONLY                        IOC33980
       PZE     3                                                        IOC33990
       BCI     1,00000M            MINIMUM IOCS                         IOC34000
       PZE     2                                                        IOC34010
       BCI     1,00000B            BASIC IOCS WITHOUT LABELS            IOC34020
       PZE     1                                                        IOC34030
       BCI     1,00000L            IOCS WITH LABEL PACKAGE              IOC34040
       PZE     0                                                        IOC34050
BW90   BCI     1,00000R            RANDOM IOCS                         $IOC34060
       PZE     2                                                       $IOC34070
       BCI     1,000007                                                $IOC34080
       PZE     0                                                       $IOC34090
       SPACE   1                                                        IOC34100
*                          LIST CONTROL FLAG                            IOC34110
       SPACE   1                                                        IOC34120
BW10   BCI     1,00000             LIST THIS FILE                       IOC34130
       PZE     0                                                        IOC34140
       BCI     1,00000N            DO NOT LIST                          IOC34150
       MZE     0                                                        IOC34160
       SPACE   1                                                        IOC34170
*                   RESTART POSITIONING CONTROL FLAG                    IOC34180
       SPACE   1                                                        IOC34190
BW11   BCI     1,00000             BLANK-REPOSITION                     IOC34200
       PZE     0                                                        IOC34210
       BCI     1,00000N            SUPPRESS RESTART REPOSITIONING       IOC34220
       PZE     1                                                        IOC34230
       SPACE   1                                                        IOC34240
*                   CONVERSION TABLE FOR FIELD SCAN                     IOC34250
       SPACE   1                                                        IOC34260
BZ00   OCT     000000000001        0                                    IOC34270
       OCT     010000000001        1                                    IOC34280
       OCT     020000000001        2                                    IOC34290
       OCT     030000000001        3                                    IOC34300
       OCT     040000000001        4                                    IOC34310
       OCT     050000000001        5                                    IOC34320
       OCT     060000000001        6                                    IOC34330
       OCT     070000000001        7                                    IOC34340
       OCT     100000000002        8                                    IOC34350
       OCT     110000000002        9                                    IOC34360
       OCT     540000000100        ILLEGAL(*)                           IOC34370
       OCT     130000000040        =                                    IOC34380
       OCT     140000000040        ,                                    IOC34390
       OCT     540000000100        ILLEGAL(*)                           IOC34400
       OCT     540000000100        ILLEGAL(*)                           IOC34410
       OCT     540000000100        ILLEGAL(*)                           IOC34420
       OCT     200000000040        +                                    IOC34430
       OCT     210000000004        A                                    IOC34440
       OCT     220000000004        B                                    IOC34450
       OCT     230000000004        C                                    IOC34460
       OCT     240000000004        D                                    IOC34470
       OCT     250000000004        E                                    IOC34480
       OCT     260000000004        F                                    IOC34490
       OCT     270000000004        G                                    IOC34500
       OCT     300000000004        H                                    IOC34510
       OCT     310000000004        I                                    IOC34520
       OCT     320000000040        0-11                                 IOC34530
       OCT     330000000040        .                                    IOC34540
       OCT     340000000040        )                                    IOC34550
       OCT     540000000100        ILLEGAL(*)                           IOC34560
       OCT     540000000100        ILLEGAL(*)                           IOC34570
       OCT     540000000100        ILLEGAL(*)                           IOC34580
       OCT     400000000040        -                                    IOC34590
       OCT     410000000010        J                                    IOC34600
       OCT     420000000010        K                                    IOC34610
       OCT     430000000010        L                                    IOC34620
       OCT     440000000010        M                                    IOC34630
       OCT     450000000010        N                                    IOC34640
       OCT     460000000010        O                                    IOC34650
       OCT     470000000010        P                                    IOC34660
       OCT     500000000010        Q                                    IOC34670
       OCT     510000000010        R                                    IOC34680
       OCT     520000000040        0-12                                 IOC34690
       OCT     530000000040        $                                    IOC34700
       OCT     540000000040        $                                    IOC34710
       OCT     540000000100        ILLEGAL(*)                           IOC34720
       OCT     540000000100        ILLEGAL(*)                           IOC34730
       OCT     540000000100        ILLEGAL(*)                           IOC34740
       OCT     000000000000        BLANK                                IOC34750
       OCT     610000000040        /                                    IOC34760
       OCT     620000000020        S                                    IOC34770
       OCT     630000000020        T                                    IOC34780
       OCT     640000000020        U                                    IOC34790
       OCT     650000000020        V                                    IOC34800
       OCT     660000000020        W                                    IOC34810
       OCT     670000000020        X                                    IOC34820
       OCT     700000000020        Y                                    IOC34830
       OCT     710000000020        Z                                    IOC34840
       OCT     540000000100        ILLEGAL(*)                           IOC34850
       OCT     730000000040        ,                                    IOC34860
       OCT     740000000040        (                                    IOC34870
       OCT     540000000100        ILLEGAL(*)                           IOC34880
       OCT     540000000100        ILLEGAL(*)                           IOC34890
       OCT     540000000100        ILLEGAL(*)                           IOC34900
BZ10   OCT     600000000001                                             IOC34910
       OCT     600000000000                                             IOC34920
BZ12   OCT     000000000001                                             IOC34930
       SPACE   1                                                        IOC34940
*           CONVERSION TABLE - ROW BINARY CARD TO BCD IMAGE             IOC34950
       SPACE   1                                                        IOC34960
BZ01   OCT     000000000000                                             IOC34970
       OCT     000000000001                                             IOC34980
       OCT     000000000100                                             IOC34990
       OCT     000000000101                                             IOC35000
       OCT     000000010000                                             IOC35010
       OCT     000000010001                                             IOC35020
       OCT     000000010100                                             IOC35030
       OCT     000000010101                                             IOC35040
       OCT     000001000000                                             IOC35050
       OCT     000001000001                                             IOC35060
       OCT     000001000100                                             IOC35070
       OCT     000001000101                                             IOC35080
       OCT     000001010000                                             IOC35090
       OCT     000001010001                                             IOC35100
       OCT     000001010100                                             IOC35110
       OCT     000001010101                                             IOC35120
       OCT     000100000000                                             IOC35130
       OCT     000100000001                                             IOC35140
       OCT     000100000100                                             IOC35150
       OCT     000100000101                                             IOC35160
       OCT     000100010000                                             IOC35170
       OCT     000100010001                                             IOC35180
       OCT     000100010100                                             IOC35190
       OCT     000100010101                                             IOC35200
       OCT     000101000000                                             IOC35210
       OCT     000101000001                                             IOC35220
       OCT     000101000100                                             IOC35230
       OCT     000101000101                                             IOC35240
       OCT     000101010000                                             IOC35250
       OCT     000101010001                                             IOC35260
       OCT     000101010100                                             IOC35270
       OCT     000101010101                                             IOC35280
       OCT     010000000000                                             IOC35290
       OCT     010000000001                                             IOC35300
       OCT     010000000100                                             IOC35310
       OCT     010000000101                                             IOC35320
       OCT     010000010000                                             IOC35330
       OCT     010000010001                                             IOC35340
       OCT     010000010100                                             IOC35350
       OCT     010000010101                                             IOC35360
       OCT     010001000000                                             IOC35370
       OCT     010001000001                                             IOC35380
       OCT     010001000100                                             IOC35390
       OCT     010001000101                                             IOC35400
       OCT     010001010000                                             IOC35410
       OCT     010001010001                                             IOC35420
       OCT     010001010100                                             IOC35430
       OCT     010001010101                                             IOC35440
       OCT     010100000000                                             IOC35450
       OCT     010100000001                                             IOC35460
       OCT     010100000100                                             IOC35470
       OCT     010100000101                                             IOC35480
       OCT     010100010000                                             IOC35490
       OCT     010100010001                                             IOC35500
       OCT     010100010100                                             IOC35510
       OCT     010100010101                                             IOC35520
       OCT     010101000000                                             IOC35530
       OCT     010101000001                                             IOC35540
       OCT     010101000100                                             IOC35550
       OCT     010101000101                                             IOC35560
       OCT     010101010000                                             IOC35570
       OCT     010101010001                                             IOC35580
       OCT     010101010100                                             IOC35590
       OCT     010101010101                                             IOC35600
       SPACE   1                                                        IOC35610
*                              CONSTANTS                                IOC35620
       SPACE   1                                                        IOC35630
BZERO  PZE     0                                                        IOC35640
BMZE   MZE     0                                                        IOC35650
BONE   PZE     1                                                        IOC35660
BTWO   PZE     2                                                        IOC35670
BTEN   PZE     10                                                       IOC35680
BIT4   OCT     737777777777                                            $IOC35690
BIT3   DEC     1B3                                                      IOC35700
L(15D) PZE     ,,15                                                     IOC35710
BLANKZ BCI     1,                                                       IOC35720
PTW    PTW                                                             $IOC35730
       SPACE   1                                                        IOC35740
*          ASSEMBLY PARAMETERS, MISCELLANEOUS REFERENCE CELLS           IOC35750
       SPACE   1                                                        IOC35760
BFCB   PZE     BFCBL               LENGTH OF FILE CONTROL BLOCK         IOC35770
BSNK   PZE     L(0)                                                     IOC35780
BFORG  PZE     0                   WORKING FILE BLOCK ORIGIN            IOC35790
BWORG  PZE     SFBO                STANDARD FILE BLOCK ORIGIN           IOC35800
BUFIN  PZE     **,4                END OF (STANDARD) FILE BLOCK         IOC35810
RORG   PZE     0                   RANDOM SWITCH                       $IOC35820
BVORG  BSS     0                                                        IOC35830
       PZE     B6FIN                                                    IOC35840
       PZE     B5FIN                                                    IOC35850
       PZE     B4FIN                                                    IOC35860
       PZE     B3FIN                                                    IOC35870
       SPACE   1                                                        IOC35880
       SPACE   1                                                        IOC35890
*                         PREPROCESSOR COUNTS                           IOC35900
       SPACE   1                                                        IOC35910
BCDCT  BSS     1                   CONTROL CARD COUNT                   IOC35920
BPGN1  BSS     1                   ERROR LIST PAGE NUMBER               IOC35930
BPGN2  BSS     1                   ASSIGNMENT LIST PAGE NUMBER          IOC35940
BERCT  BSS     1                   ERROR COUNT                          IOC35950
BLTP   BSS     1                   LINES THIS PAGE (BERR,BWRT)          IOC35960
*                               BUFFERS                                 IOC35970
       SPACE   1                                                        IOC35980
BX00   BSS     1                   PROGRAM UNIT REFERENCE WORD          IOC35990
BNORG  BSS     1                   NON-STANDARD FILE BLOCK ORIGIN       IOC36000
BMORG  BSS     1                   END OF MISCELLANEOUS STORAGE BLOCK   IOC36010
BP00   BSS     48                  CONTROL CARD INPUT BUFFER            IOC36020
BQ00   BSS     24                  CONTROL CARD OUTPUT BUFFER           IOC36030
BM00   BSS     4                   WORKING STORAGE BLOCK                IOC36040
BN00   BSS     3                   WORKING STORAGE B                    IOC36050
       TTL     IOCS RELOCATABLE LOADER                                  IOC36060
*                                                                      $IOC36070
*              CALLING SEQUENCE TO LOADER                              $IOC36080
*                                                                      $IOC36090
*              TSX                 RSLDR,4                             $IOC36100
*              PZE                 TO,,FROM                            $IOC36110
*              PZE                 TRAVET                              $IOC36120
*                                                                      $IOC36130
*              1.  TO IS THE ADDRESS WHERE RELOCATION IS TO BEGIN      $IOC36140
*                  THAT ADDRESS IS EQUAL TO THE RELOCATION CONSTANT    $IOC36150
*                                                                      $IOC36160
*              2.  FROM IS THE ADDRESS OF THE FIRST CARD OF            $IOC36170
*                  PROGRAM TO BE RELOCATED                             $IOC36180
*                                                                      $IOC36190
*              3.  TRAVET IS THE LOCATION OF THE FIRST COMMUNICATION   $IOC36200
*                  CELL ASSIGNED TO THE SUBPROGRAM IN THE IOCS         $IOC36210
*                  COMMUNICATION TABLE                                 $IOC36220
*                                                                      $IOC36230
 RSLDR SXA     IRX1,1              SAVE                                $IOC36240
       SXA     IRX2,2                 ALL                              $IOC36250
       SXA     IRX4,4                     IRXS                         $IOC36260
       STZ     FLAGA                                                   $IOC36270
       CLA     1,4                 SAVE                                $IOC36280
       STA     LP002               THE INCREMENT                       $IOC36290
       PDX     ,2                  INITIAL LOADING ADDRESS TO IRX2     $IOC36300
       CLA     2,4                                                     $IOC36310
       PAC     0,4                 STORE THE TRAVET                    $IOC36320
 START SXA     COUNT,2             SAVE THE FIRST ADDR. OF THE PROG.   $IOC36330
       LAC     *+1,2                                                   $IOC36340
 COUNT CLA     **                  STORAGE FOR 9L ADDRESS              $IOC36350
       PDX     0,1                                                     $IOC36360
       TIX     *+1,1,320           STRIP CONTROL PUNCH                 $IOC36370
       TMI     PROGRA              IF IT IS MINUS IT IS PROGRAM CARD   $IOC36380
       ANA     SIX                 TEST FOR                            $IOC36390
       TZE     OUT1                CORRECT CARD FORMAT                 $IOC36400
       TXH     *+2,1,26            IS IT DATA/INSTRUCTION CARD         $IOC36410
       TRA     LD040               YES  GO TO RELOCATE                 $IOC36420
       CAL     1,2                 IF 9R EQUAL ZERO                    $IOC36430
       TZE     TRACAD              THIS IS TRANSFER CARD               $IOC36440
       TRA     OUT1                                                    $IOC36450
PROGRA ZET     FLAGA               IT IS FIRST OR SECOND PROGRAM CARD  $IOC36460
       TRA     SECONE              IT IS SECOND PROG CARD              $IOC36470
       TIX     *+1,1,2             EXCLUDE 8L 8R WORD COUNT            $IOC36480
       CLA     2,2                 GET  8L INTO ACCUMULATOR            $IOC36490
       STA     LP004               SAVE PROGRAM BREAK                  $IOC36500
 LOOP1 CLA     5,2                                                     $IOC36510
       ADD     LP002               ADD CURRENT INCREMENT               $IOC36520
 LOOP2 ORA     BOX                 STORE TRA TO+N ADDRESS              $IOC36530
       STO     0,4                 BEGINNING AT TRAVET                 $IOC36540
       TXI     *+1,4,-1                                                $IOC36550
       TXI     *+1,2,-2                                                $IOC36560
       TIX     LOOP1,1,2                                               $IOC36570
       STL     FLAGA               TO INDICATE SECOND PROGRAM CARD     $IOC36580
       TRA     SETUP                                                   $IOC36590
SECONE CLA     3,2                                                     $IOC36600
       TRA     LOOP2-1                                                 $IOC36610
  OUT1 TSX     (PROUT,4            PRINT MESSAGE                       $IOC36620
       PZE     1                      STATING THAT                     $IOC36630
       PZE     LD601,,5+512*4      ERROR IN CARD FORMAT                $IOC36640
       TSX     (PAWSX,4            PAUSE AND START                     $IOC36650
       TRA     SETUP                                                   $IOC36660
TRACAD CLA     LP004               PUT LENGTH OF PROGRAM               $IOC36670
       ADD     LP002               PLUS RELOCATION CONSTANT IN ACCUM.  $IOC36680
  IRX1 AXT     **,1                RESTORE                             $IOC36690
  IRX2 AXT     **,2                  INDEX                             $IOC36700
  IRX4 AXT     **,4                     REGISTERS                      $IOC36710
       TRA     3,4                                                     $IOC36720
 SETUP LXA     COUNT,2             PREVIOUS ADDRESS TO IRX2            $IOC36730
       TXI     START,2,24                                              $IOC36740
*                                                                      $IOC36750
*              RELOCATING THE DATA OR INSTRUCTION IN CORE              $IOC36760
*                                                                      $IOC36770
LD040  SXA     LP008,1             SAVE CURRENT WORD COUNT             $IOC36780
LD040A CLA     4,2                 GET FIRST DATA/INSTRUCTION          $IOC36790
       ARS     18                  GET DECREMENT                       $IOC36800
       STL     LP005               PUT RELOCATION INDICATOR ON FOR DECR$IOC36810
LD040B STA     LP009               HOLD DECR/ADDR TEMPORALILY          $IOC36820
       TSX     LD050,4             CHECK RELOCATION BIT                $IOC36830
       TQP     LD045               TEST FOR 1 OR 0                     $IOC36840
       TSX     LD050,4             CHECK RELOCATION BIT                $IOC36850
       CAS     LP004               IS ADDRESS /DECRE ABOVE PROGRAM BREA$IOC36860
       TRA     LD041               YES ORDINARY RELOCATION             $IOC36870
       TRA     LD041               YES ORDINARY RELOCATION             $IOC36880
       TQP     LD041+1             TEST FOR SECOND BIT                 $IOC36890
       ADD     LD007               ADD RELOCATION CONSTANT             $IOC36900
       SUB     LD145               SUB RELOCATION CONSTANT             $IOC36910
       TRA     LD045                                                   $IOC36920
 LD041 TQP     *-3                 TEST FOR  THE SECOND BIT            $IOC36930
       ADD     LP002               ADD INCREMENT                       $IOC36940
 LD045 NZT     LP005               IF RELOCATION INDICATOR ON          $IOC36950
       TRA     LD046                                                   $IOC36960
       ALS     18                  RETURN DECREMENT                    $IOC36970
       STD     4,2                 GET ADDRESS TO BE RELOCATED         $IOC36980
       STZ     LP005               TURN INDICATOR OFF                  $IOC36990
       CLA     4,2                                                     $IOC37000
       TRA     LD040B                                                  $IOC37010
 LD046 STA     4,2                                                     $IOC37020
       TXI     *+1,2,-1                                                $IOC37030
       TIX     LD040A,1,1                                              $IOC37040
       TRA     LD055               LOAD RELOCATED CARD                 $IOC37050
 LD050 SXA     LD051,2             START TO CHECK A BIT                $IOC37060
       LAC     COUNT,2                                                 $IOC37070
       CLA     2,2                 GET 8L                              $IOC37080
       LDQ     3,2                 GET 8R                              $IOC37090
       LGL     1                                                       $IOC37100
       SLW     2,2                 STORE IN 8L ADDRESS                 $IOC37110
       STQ     3,2                                                     $IOC37120
       XCA                         ACCUMULATOR SIGN INTO MQ            $IOC37130
       CLA     LP009               ADDR/RECRE TO BE RELOCATED INTO ACCU$IOC37140
 LD051 AXT     **,2                RESTORE THE WORKING ADDR            $IOC37150
       TRA     1,4                                                     $IOC37160
 LD055 LXA     LP008,1             GET WORD COUNT                      $IOC37170
       LAC     COUNT,2             LOAD WITH 9L                        $IOC37180
       CLA     0,2                 GET 9L                              $IOC37190
       ADD     LP002               GET INCREMENT                       $IOC37200
       ADD     LP008               ADD WORD COUNT                      $IOC37210
       STA     PLACE                                                   $IOC37220
       CLA     4,2                 GET 7R                              $IOC37230
 PLACE STO     **,1                LOAD IT STARTING AT TO              $IOC37240
       TXI     *+1,2,-1                                                $IOC37250
       TIX     *-3,1,1                                                 $IOC37260
       TRA     SETUP                                                   $IOC37270
*                                                                      $IOC37280
*                                  MESSAGE TABLE                       $IOC37290
*                                                                      $IOC37300
LD601  BCI     5,ERROR IN RELOCATABLE CARD TYPE                        $IOC37310
*                                                                      $IOC37320
*                                  STORAGE ALLOCATION                  $IOC37330
*                                                                      $IOC37340
 LD007 OCT     316                                                     $IOC37350
 LD145 PZE                         HOLD COMMON RELOCATION CONSTANT     $IOC37360
*                                                                      $IOC37370
*                                  INFORMATION TABLE                   $IOC37380
*                                                                      $IOC37390
 LP002 PZE                         INCREMENT ' INITIAL LOADING ADDRS   $IOC37400
 LP004 PZE                         LENGTH OF THE PROGRAM               $IOC37410
 LP005 PZE                         RELOCATION INDICATOR 0'OFF  NZ'ON   $IOC37420
 LP008 PZE                         STORAGE FOR WORD COUNT              $IOC37430
 LP009 PZE                         HOLD ADDR/DECR TO BE RELOCATED      $IOC37440
 FLAGA PZE                         SWITCH FOR FIRST OR SECOND PROG CARD$IOC37450
   BOX TRA     **                                                      $IOC37460
AB01   TNZ     DCYL                DISK OR DRUM WAS SPECIFIED        (1)IOC37461
       NZT     BT09                IS THIS A DISK OR DRUM SYSUNI     (1)IOC37462
       TRA     BH02-5              NO                                (1)IOC37463
       STZ     BT09                YES,DISREGARD ANY                 (1)IOC37464
       AXT     0,2                 SECONDARY UNIT SPECIFICATION      (1)IOC37465
       TRA     BH02-5                                                (1)IOC37466
AB02   PAX     0,2                                                   (1)IOC37467
       ZET     NUCBW                                                 (1)IOC37468
       TXH     DCYLER,2,10         MAXIMUM DRUM CYLINDER NUMBER      (1)IOC37469
       TXH     DCYLER,2,250        MAXIMUM DISK CYLINDER NUMBER      (1)IOC3746A
       TRA     CYGO1+1                                               (1)IOC3746B
AB03   ZET     NUCBW                                                 (1)IOC3746C
       TXH     DKERR,2,399         MAXIMUM DRUM TRACK NUMBER         (1)IOC3746D
       TXH     DKERR,2,9999        MAXIMUM DISK TRACK NUMBER         (1)IOC3746E
       TRA     DKERR5                                                (1)IOC3746F
AB04   CAL     AB03+2                                                (1)IOC3746G
       ZET     NUCBW                                                 (1)IOC3746H
       CAL     AB03+1              DRUM                              (1)IOC3746I
       TRA     DKERR4+1                                              (1)IOC3746J
AB05   STZ     NUCBW               RESET DRUM FLAG                   (1)IOC3746K
       TRA     BB00                                                  (1)IOC3746L
AB06   ZET     NUCBW                                                 (1)IOC3746M
       CLA     AB02+2              DRUM                              (1)IOC3746N
       PDX     0,2                                                   (1)IOC3746O
       TXI     CYGO1+1,2,1         FORCE ERROR                       (1)IOC3746P
AB07   CLA     BA0386              LAST DISK TRACK                   (1)IOC3746Q
       LFT     000200                                                (1)IOC3746R
       CLA     *+2                 LAST DRUM TRACK                   (1)IOC3746S
       TRA     BA0383+8                                              (1)IOC3746T
       PZE     399                                                   (1)IOC3746U
AB08   LAS     NUCBW+1             IS THIS DRUM                      (1)IOC3746V
       TRA     BT51                NO,ERROR                          (1)IOC3746W
       TRA     *+2                                                   (1)IOC3746X
       TRA     BT51                NO,ERROR                          (1)IOC3746Y
       RIR     7                                                     (1)IOC3746Z
       STL     NUCBW               SET DRUM FLAG WORD                (1)IOC37470
       TRA     DASGN                                                 (1)IOC37471
NUCBW  PZE     **                  DRUM FLAG WORD                    (1)IOC37472
       BCI     1,00000N                                              (1)IOC37473
AB09   ADD     L(1)                DISK BIT                          (1)IOC37474
       ZET     NUCBW                                                 (1)IOC37475
       ADD     L(2)                DRUM BIT                          (1)IOC37476
       TRA     DASGN+3                                               (1)IOC37477
AB10   STI     BT07                SAVE SENSE INDICATORS             (1)IOC37478
       CLA     SYSUNI                                                (1)IOC37479
       STA     *+1                                                   (1)IOC3747A
       LDI*    **,4                UCB WORD 1 FOR THIS SYSUNI        (1)IOC3747B
       LNT     020100              IS THIS DISK OR DRUM              (1)IOC3747C
       TRA     BT07-2              NO,EXIT                           (1)IOC3747D
       XEC     BT99+1              IR1 = L(FCB)                      (1)IOC3747E
       LDQ     BQ00+6              GET WRITE CHECK FLAG              (1)IOC3747F
       LGL     4                                                     (1)IOC3747G
       CLA     0,1                                                   (1)IOC3747H
       TQP     *+3                 MINUS IF WRITE CHECK REQUESTED    (1)IOC3747I
       SSM                         SET WRITE CHECK BIT               (1)IOC3747J
       TRA     *+2                                                   (1)IOC3747K
       SSP                         SET NO WRITE CHECK                (1)IOC3747L
       STO     0,1                                                   (1)IOC3747M
       STL     BT09                                                  (1)IOC3747N
       LDI     BT07                RESTORE SENSE INDICATORS          (1)IOC3747O
       TRA     BT99                                                  (1)IOC3747P
BT07   PZE     **                                                    (1)IOC3747Q
BT09   PZE     **                  DISK OR DRUM SYSUNI FLAG          (1)IOC3747R
 BF57  TZE     BF54                                                  (2)IOC3747S
       STZ     BF55                                                  (2)IOC3747T
       TRA     BF54-1                                                (2)IOC3747U
BJ08A  XEC     BV01                PICK UP SYSTEM UCB                (3)IOC3747V
       LDI     0,2                                                   (3)IOC3747W
       TRA     BJ08+8                                                (3)IOC3747X
       BES     100-*+AB01                                            (3)IOC3747Y
       TTL     OVERLAY OF COMMUNICATIONS REGION FOR IOBS IN STORAGE     IOC37480
       LBL     IOBL0000,1                                               IOC37490
       SPACE   1                                                        IOC37500
       BES     DEFINE-*                                                 IOC37510
       STL     ROUTE                                                    IOC37520
       TXL     ENTRY,,DEFIN.                                            IOC37530
       STL     ROUTE                                                    IOC37540
       TXL     ENTRY,,JOINX                                             IOC37550
       STL     ROUTE                                                    IOC37560
       TXL     ENTRY,,ATTCH.                                            IOC37570
       STL     ROUTE                                                    IOC37580
       TXL     ENTRY,,CLOSE.                                            IOC37590
       STL     ROUTE                                                    IOC37600
       TXL     ENTRY,,OPEN.                                             IOC37610
       STL     ROUTE                                                    IOC37620
       TXL     ENTRY,,READ.                                             IOC37630
       STL     ROUTE                                                    IOC37640
       TXL     ENTRY,,WRITE.                                            IOC37650
       STL     ROUTE                                                    IOC37660
       TXL     ENTRY,,COPY.                                             IOC37670
       STL     ROUTE                                                    IOC37680
       TXL     ENTRY,,REW.                                              IOC37690
       STL     ROUTE                                                    IOC37700
       TXL     ENTRY,,WEF.                                              IOC37710
       STL     ROUTE                                                    IOC37720
       TXL     ENTRY,,BSR.                                              IOC37730
       STL     ROUTE                                                    IOC37740
       TXL     ENTRY,,BSF.                                              IOC37750
       STL     ROUTE                                                    IOC37760
       TRA     CKPT.                                                    IOC37770
       STL     ROUTE                                                    IOC37780
       TXL     ENTRY,,STASH.                                            IOC37790
       STL     ROUTE                                                   $IOC37800
       TXL     ENTRY,,READR1                                           $IOC37810
       STL     ROUTE                                                   $IOC37820
       TXL     ENTRY,,RELASE                                           $IOC37830
       BES     RANDEF-*                                                $IOC37840
       TSX     (PROUT,4                                                $IOC37850
       TIX     1,,                                                     $IOC37860
       TIX     *+2,,2                                                  $IOC37870
       TSX     STOPD,4                                                 $IOC37880
       BCI     2,NEED RANDOM                                           $IOC37890
200    TTL     IOBS SECTION OF IOCS                                     IOC40000
       BES     B2FIN-*                                                  IOC40010
       SPACE   1                                                        IOC40020
*                      I O B S SECTION OF I O C S                       IOC40030
*                      B U F F E R I N G  R O U T I N E S               IOC40040
*                        INDICATOR ASSIGNMENTS                          IOC40050
       SPACE   1                                                        IOC40060
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $IOC40070
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $IOC40080
CP2    BOOL    100000              ARE 00,01,10                        $IOC40090
OPEND  BOOL    40000               IF=1 FILE OPEN                       IOC40100
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               IOC40110
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              IOC40120
MODE   BOOL    04000               IF=1 BINARY FILE                     IOC40130
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             IOC40140
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 IOC40150
LABEL  BOOL    00400               IF=1 LABELS                          IOC40160
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                IOC40170
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       IOC40180
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               IOC40190
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              IOC40200
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        IOC40210
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                IOC40220
NOEOT  BOOL    00004               IF=1 NO EOT                          IOC40230
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            IOC40240
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                IOC40250
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           IOC40260
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          IOC40270
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $IOC40280
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  IOC40290
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  IOC40300
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            IOC40310
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    IOC40320
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    IOC40330
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             IOC40340
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  IOC40350
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       IOC40360
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               IOC40370
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        IOC40380
STSH   BOOL    00100               IF =1 STASH ROUTINE                  IOC40390
CPYFN  BOOL    00040               IF =1 COPY MODE                      IOC40400
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         IOC40410
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  IOC40420
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    IOC40430
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    IOC40440
IOSY   BOOL    00004               IF=1, IOSY WRITE                     IOC40450
NORUN  BOOL    00002               IF=1 NO REW UNLD                     IOC40460
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 IOC40470
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          IOC40480
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $IOC40490
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               IOC40500
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        IOC40510
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     IOC40520
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 IOC40530
CDBTS  BOOL    24000               DISCN+EOB                            IOC40540
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     IOC40550
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        IOC40560
OUTPUT BOOL    03000               PTO+TTO                              IOC40570
OPDET  BOOL    40002               OPEND+DETACH                         IOC40580
RESOP  BOOL    60000               RESER+OPEND                          IOC40590
OPNEOT BOOL    40004               OPEND+NOEOT                          IOC40600
RANDG  BOOL    00030               RUSH+GIVUP                           IOC40610
EOBITS BOOL    44400               DONLY+EOB+HOLD                       IOC40620
DIGEN  BOOL    30000               DISCN+GENER                          IOC40630
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     IOC40640
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       IOC40650
NOREOF BOOL    00003               NORED + NOEOF                        IOC40660
RBITS  BOOL    00011               RUSH + RHIST                        $IOC40670
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 IOC40680
NETIH  BOOL    10004               NO EOT+NINHIB                        IOC40690
REWNUN BOOL    00006               NORUN + NOREW                       $IOC40700
*                  CONSTANTS AND MASKS FOR INDICATORS                   IOC40710
       SPACE   1                                                        IOC40720
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              IOC40730
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  IOC40740
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              IOC40750
NTRES  SVN     -1-SWATT-NOREW-NORUN-NOEOFM,7,-1-RESER                   IOC40760
NOTIN  SVN     -1,7,-1-NINHIB                                           IOC40770
EOTBT  SVN     -1,7,-1-NOEOT                                            IOC40780
NEOTBT PZE     0,,NOEOT                                                 IOC40790
MODBT  PZE     0,0,MODE                                                 IOC40800
EOFBT  PZE     0,0,OUTPUT          MASK FOR BSF                        $IOC40810
       TTL     COMMON ENTRY TO ALL JOBS ROUTINES                        IOC40820
*      SAVES   1. SENSE INDICATORS AND ALL INDEX REGISTERS              IOC40830
*              2.L(ENTRY) TO ROUTINE (I.E. L(TSX))                      IOC40840
*              3.L(TSX+2)                                               IOC40850
*              4.PLACES IN CELL -FCW- AND IN IR2 COMPLEMENTED           IOC40860
*                 A.L(POOL) FOR DEFINE,JOIN AND ATTACH                  IOC40870
*                 B.L(FILE) FOR ALL OTHER IOCS ROUTINES                 IOC40880
*              5.PLACES IN CELL-XEOB-                                   IOC40890
*                 A.EOB EXIT FOR READ AND WRITE                         IOC40900
*                 B.L(POOL2) FOR JOIN                                   IOC40910
*                 C.L(FILE2) FOR COPY AND STASH                         IOC40920
*              6.PLACES FILE CONTROL BITS IN SI                         IOC40930
       SPACE   1                                                        IOC40940
ENTRY  ZET     L(0)                                                    $IOC40950
       TSX     STOP,4                                                  $IOC40960
       STI     SENSE                                                   $IOC40970
       SXA     LTSX,4              SAVE L(ENTRY)                       $IOC40980
       TXI     *+1,4,-2                                                 IOC40990
       SXA     GTIOX,4             SAVE L(TSX)+2                        IOC41000
       SXA     IRS,2               SAVE IR2                             IOC41010
       SXD     IRS,1               SAVE IR1                             IOC41020
ROUTE  LXD     **,1                FIND L(ROUTINE)                     $IOC41030
       SXA     GO,1                WHICH WAS CALLED                    $IOC41040
       STZ     TCHEX               CLEAR TCH SWITCH                    $IOC41050
       CAL     -1,4                SAVE IN-LFCW-AND IR2(COMPLEMENTED)  $IOC41060
       ENB     L(0)                THE FOLLOWING DISABLING TRAPS        IOC41070
       STA     FCW                 L(BPC) FOR DEFINE,JOIN AND ATTACH    IOC41080
       PAC     0,2                 L(FCW) FOR READ,WRITE,COPY,REW,      IOC41090
       STD     XEOB                WEF,OPEN AND CLOSE                   IOC41100
       ZET     DERR                TEST FOR ANY DISK ERROR             $IOC41110
       TSX     STOPA,4             HAS BEEN A DISK ERROR               $IOC41120
       LDI     6,2                 TEST FOR END OF TRACK + EOB EXIT    $IOC41130
       RNT     700000                                                  $IOC41140
       TRA     *+2            NO                                       $IOC41150
       TXH     ENDTRK-2,1,ATTCH.                                       $IOC41160
       BES     *-6+NOCH/NOCH*6-*    OVERLAY                            $IOC41170
       LDI     1,2                 FILE INDICATORS TO SI                IOC41180
       RIR     77777                                                   $IOC41190
       ENB     TRAPS               ALLOW TRAPS (FILE BITS IN SI)        IOC41200
       TXL     GO,1,OPEN.          IF REFERENCE TO A FILE               IOC41210
       TXI     *+1,1,-RELASE       IS THIS A RELASE ENTRY              $IOC41220
       TXL     GO,1,0              YES, GO THERE                       $IOC41230
       LFT     NOEOT               AND EOT OR NON-LABELED EOF           IOC41240
GO     TTR     **                  GO TO ROUTINE CALLED                 IOC41250
       LFT     OUTPUT              IS FILE INPUT                        IOC41260
       TRA     ENT2                OR OUTPUT                            IOC41270
       LFT     LABEL               IF LABELLED INPUT                    IOC41280
       TRA*    GO                  GO TO ROUTINE WHICH WILL GIVE EOF    IOC41290
       TSX     SWITCH,1            IF EOF NON LABELED FILE AGAIN        IOC41300
       TSX     CPINT,4             CHECKPOINT IF SPECIFIED              IOC41310
ENT1   SIL     NOEOT               REFERENCED,SWITCH REELS AND          IOC41320
       LXA     GTIOX,4             RESTORE IR4 AND                      IOC41330
       TRA*    GO                  GO.......                            IOC41340
ENT2   TSX     EOTOF,1             HANDLE EOT                           IOC41350
       TRA     ENT1                TURN OFF EOT AND CONTINUE            IOC41360
STOPA  CLA     DERR                SAVE + ZERO OUT                     $IOC41370
       STZ     DERR                THE DISK ERROR                      $IOC41380
       TRA     STOP                SWITCH                              $IOC41390
       TTL     COMMON. EXIT ROUTINE - COMXIT-                           IOC41400
*                              TRA COMXIT                               IOC41410
*                          NO RETURN POSSIBLE                           IOC41420
*                        THIS ROUTINE RESTORES                          IOC41430
*              1.IR2,IR1,SI                                             IOC41440
*              2. FILE CONTROL BITS TO FILE WORDS                       IOC41450
*         AND PLACES HISTORY IN THE AC                                  IOC41460
       SPACE   1                                                        IOC41470
NOPXIT SXD     LTRAD,4             SAVE LAST WORD WORKED ON            $IOC41480
       TSX     FEEIT,1                                                 $IOC41490
COMXIT ENB     L(0)                DISABLE TRAPS                        IOC41500
       PIA                         RESTORE CONTROL                      IOC41510
       STD     1,2                 BITS TO FILE                         IOC41520
       SXA     FCW,0               SET IOBS SWITCH =0                   IOC41530
       SXA     READR2,0            SET READ WITH RETENTION ZERO        *IOC41540
       ENB     TRAPS               ALLOW TRAPS                          IOC41550
EX14   XEC     SWTC                IF ASSIGNED SENSE                    IOC41560
       TRA     EX19                SWITCH FOR CKPTS                     IOC41570
       ZET     CPSW                DOWN WAIT TILL PLACED UP             IOC41580
       TRA     EX23                THEN DOWN...                         IOC41590
       STL     CPSW                SENSE LITE ON SIGNIFIES THAT         IOC41600
       TSX     CKPT.,4             THE CORRESPONDING SENSE              IOC41610
       TRA     EX23                SWITCH HAS NOT BEEN SENSED           IOC41620
EX19   STZ     CPSW                IN THE UP POSITION.                  IOC41630
EX23   CLA     LTRAD               HISTORY TO AC                        IOC41640
EX24   LXA     GTIOX,4             IF TCH OCCURRED                      IOC41650
       ZET     TCHEX               EXIT AT L(1ST TCH) +1                IOC41660
       LXA     TCHEX,4             ELSE AT NORMAL EXIT                  IOC41670
EX34   LXA     IRS,2               RESTORE IR2                          IOC41680
       LXD     IRS,1                                                    IOC41690
       LDI     SENSE               RESTORE SI                           IOC41700
       TTR     0,4                 RETURN TO USER                       IOC41710
       TTL     DEFINE A. BUFFER POOL                                    IOC41720
*      CALLING SEQUENCE                                                 IOC41730
*              TSX  DEFINE,4                                            IOC41740
*              PZE  L(POOL)                                             IOC41750
*              PZE  N,,EFF BUF SIZE                                     IOC41760
*              RETURN                                                   IOC41770
*                                WHERE                                  IOC41780
*                  L(POOL) = LOCATION OF BUFFER POOL                    IOC41790
*                  N= NUMBER OF BUFFERS TO BE FORMED                    IOC41800
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            IOC41810
*      COMMENTS-                                                        IOC41820
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   IOC41830
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   IOC41840
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                IOC41850
*         3.THE MAXIMUM NUMBER OF BUFFERS PER POOL =32,767              IOC41860
       SPACE   1                                                        IOC41870
DEFIN. CLS     -1,4                SAVE                                 IOC41880
       ACL     L(1)                L(POOL+1)                            IOC41890
       STA     DE1                                                      IOC41900
       ACL     L(1)                SET LOCATION                         IOC41910
       STA     DE3                 OF 1ST BUFFER                        IOC41920
       STO*    FCW                 SET BPC= FOR BUF1,,0                 IOC41930
       CAL     0,4                 SET SECOND WORD                      IOC41940
       ANA     DECRE               OF POOL =                            IOC41950
       LGL     4                   S-13= BUF. SIZE                      IOC41960
DE1    SLW     **                  14-35 = 0                            IOC41970
       CLA     0,4                 SET IORT                             IOC41980
       STD     FCW                 =IORT POOL,,SIZE                     IOC41990
       PDX     0,1                 PLACE SIZE+2                         IOC42000
       TXI     *+1,1,2             INTO IR1                             IOC42010
       PAX     0,2                 NUMBER OF BUFFERS                    IOC42020
       ALS     18                  TO IR2                               IOC42030
       STD*    FCW                 AND POOL                             IOC42040
       CLA     DE3                 GO SETUP                             IOC42050
       TRA     DE5                 CHAIN MECHANISM                      IOC42060
DE2    CLA     FCW                 CHAIN BUFFER POOL                    IOC42070
DE3    STZ     **                  1ST BUFFER CONTROL WORD              IOC42080
       STA*    *-1                 = 0 00000 0 CHAIN                    IOC42090
DE4    STO     **                  2ND= IORT BPC,,SIZE                  IOC42100
       TNX     DE6,2,1             TEST IF N FORMED                     IOC42110
       PXA     0,1                 CHAIN LAST                           IOC42120
       ACL     DE3                 BUF TO NEXT                          IOC42130
       STA*    DE3                 FINAL BUFFER IS                      IOC42140
       STA     DE3                 CHAINED TO BPC                       IOC42150
DE5    ACL     L(1)                                                     IOC42160
       ANA     ADDRS                                                    IOC42170
       CAS     DE7                 IF BUFFER                            IOC42180
       TRA     *+3                 BEING DEFINED IS                     IOC42190
       TRA     *+2                 IN SYSTEM -GIVE                      IOC42200
       TRA     PERR                '' POOL ERROR ''                     IOC42210
       STA     DE4                                                      IOC42220
       TRA     DE2                                                      IOC42230
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              IOC42240
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         IOC42250
       TXI     EX34,4,-1           EXIT AT 3,4                          IOC42260
DE7    PZE     B6FIN+2,,0          LOWER LIMIT OF BUFFERS               IOC42270
*                           JOIN ENTRY POINT                            IOC42280
*         PLACED HERE FOR L(ENTRY) CHECK IN EOT CHECK SUPPRESS          IOC42290
       SPACE   1                                                        IOC42300
JOINX  TRA     JOIN.               GO TO JOIN                           IOC42310
       SPACE   1                                                        IOC42320
*                POOL DEFINITION OR JOIN ERROR HANDLER                  IOC42330
*   ENTRY AT TSXR STORES AC AS MESSAGE PARAM, ADDS L(TSX) AND PRINTS    IOC42340
PERR   CAL     PRR1                POOL ERROR MESSAGE USE               IOC42350
TSXR   LAC     LTSX,1              FIND L(TSX)                         $IOC42360
       SLW     TSXR1               STORE MESSAGE PARAM                  IOC42370
       PXA     0,1                 L(TSX) TO AC                         IOC42380
       LGR     15                                                       IOC42390
       ENB     L(0)                TRAP PROTECT BCD5 ROUTINE            IOC42400
       TSX     BCD5,4                                                   IOC42410
       SLW     TEMP                                                     IOC42420
       TSX     PROUT,4             PRINT MESSAGE                        IOC42430
L(2)   PZE     2                   ADDING L(TSX)                       $IOC42440
TSXR1  MZE     **,,**              TO END OF IT                         IOC42450
       PZE     TEMP,,1                                                  IOC42460
       TSX     STOP,4              STOP -IMPOSSIBLE TO CONTINUE         IOC42470
PRR1   MZE     MESS5,,3                                                 IOC42480
       TTL     ATTACH AND CLOSE ROUTINE                                 IOC42490
*                          CALLING SEQUENCES                            IOC42500
       SPACE   1                                                        IOC42510
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 IOC42520
*              PZE  POOL            TO SPECIFIED POOL                   IOC42530
*              PZE  LIST,,FILECT                                        IOC42540
       SPACE   1                                                        IOC42550
*              TSX  CLOSE,4        MULTIPLE FILE CLOSE                  IOC42560
*              PRE  LIST,,FILECT                                        IOC42570
       SPACE   1                                                        IOC42580
*              TSX CLOSE,4         SINGLE FILE CLOSE                    IOC42590
*              PRE  FILE                                                IOC42600
*                                   PRE=PZE REWIND UNLOAD               IOC42610
*                                      =PTW REWIND                      IOC42620
*                                      =MZE NO REWIND                   IOC42630
*                                      =MON NO EOF OR TRAILERS          IOC42640
*                             RESTRICTIONS                              IOC42650
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        IOC42660
*                  IN ONE ATTACH CALLING SEQUENCE                       IOC42670
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       IOC42680
*              3. THE BUFFERS SET ASIDE FOR A GROUP ARE REGAINED WHEN   IOC42690
*                  THE SVN WORD IS REFERENCED IN A CLOSE LIST           IOC42700
*              4. IF A RESERVE GROUP WORD APPEARS IN A CLOSE LIST       IOC42710
*                  THE ENTIRE GROUP OF RESERVE FILES MUST APPEAR AND    IOC42720
*                  BE INCLUDED IN THE FILECT.                           IOC42730
*              5. LAST RESERVE GROUP MUST HAVE AT LEAST ONE FILE        IOC42740
*              6. ALL IMMEDIATE FILES MUST PRECEDE ALL RESERVE FILES    IOC42750
*              7. FILES OF MORE THAN ONE POOL MAY APPEAR IN A CLOSE     IOC42760
*                  LIST.                                                IOC42770
*              8. A FILE IF REWOUND UNLOADED MAY NEVER AGAIN            IOC42780
*                  BE REFERENCED                                        IOC42790
       SPACE   1                                                        IOC42800
*                            CLOSE ROUTINE                              IOC42810
CLOSE. AXT     SHUT,1              PLACE CLOSE ACTION IN CALL           IOC42820
       STZ     7GRP                TO SUBROUTINES                       IOC42830
       CAL     -1,4                PLACE CLOSE                          IOC42840
       ARS     33                  MODE BITS IN                         IOC42850
       PAI                         SI                                   IOC42860
       CLA     -1,4                                                     IOC42870
       PDX     0,2                 TEST FOR SINGLE OR                   IOC42880
       TXH     CA1,2,0             MULTIPLE CLOSE                       IOC42890
       SXA     *+1,4               DUMMY LIST HANDLER TO                IOC42900
       AXC     **,2                HANDLE ONE FILE IN                   IOC42910
       TXI     CA2,2,-2            ACTUAL CALLING SEQUENCE              IOC42920
*                            ATTACH ROUTINE                             IOC42930
ATTCH. STA     LBC                 SAVE L(POOL)                         IOC42940
       CLA     1TAG                SET OUTPUT CHAIN =0                  IOC42950
       STA     1,2                 IF POOL HAS BEEN                     IOC42960
       ANA     1,2                 JOINED TO ANOTHER POOL GIVE          IOC42970
       TNZ     PERR                '' POOL ERROR ''                     IOC42980
       LDI     CA27                PLACE ATTACH MODE BIT IN SI          IOC42990
       AXT     OPAT,1              PLACE OPEN CALL                      IOC43000
       CLA     0,4                 FOR SUBROUTINE                       IOC43010
       TXI     CA1,4,-1            ADVANCE EXIT TO ACCT FOR XTRA WORD   IOC43020
       TTL     COMMON ROUTINE ATTACH AND CLOSE                          IOC43030
CA1    PAX     0,2                 PLACE L(LIST)-1                      IOC43040
       TXI     *+1,2,-1            IN LIST PROCESSOR                    IOC43050
CA2    SXA     CA51,2                                                   IOC43060
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       IOC43070
       SXA     GTIOX,4             SAVE L(EXIT)                         IOC43080
       SXA     CA23+1,1            PLACE CALL FOR OPEN OR SHUT          IOC43090
       RNT     SWATT               ATTACH OR                            IOC43100
       TRA     CA10                CLOSE                                IOC43110
*                          ATTACH SUPERVISOR                            IOC43120
CA3    TSX     CA50,4              GET ENTRY FROM LIST                  IOC43130
       TRA     CA6                 ENTRY IS PZE FILE                    IOC43140
       LAC     CA24,1              ENTRY IS SVN FILECT,,BUFCT           IOC43150
       SXD     CA4,1               STORE FILECT FOR REDUCING BUFCT      IOC43160
       PDX     0,1                 REDUCE                              $IOC43170
       PDX     0,4                 THE                                 $IOC43180
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             IOC43190
       PXD     0,4                 THAT THE SPECIFIED NUMBER            IOC43200
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        IOC43210
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        IOC43220
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   IOC43230
       SIL     RESER               SET RESERVE BIT                      IOC43240
CA5    PXD     **,1                REDUCE IBACT BY                      IOC43250
       TSX     ADIBC,1             BUFFER COUNT FOR THE GROUP           IOC43260
       TRA     CA3                 PROCESS FILE LIST                    IOC43270
*                        FILE HANDLER (ATTACH)                          IOC43280
       SPACE   1                                                        IOC43290
CA6    LFT     OPDET               IF ATTEMPTED ATTACH OF AN OPEN OR    IOC43300
       TRA     CA60                DETACHED FILE -ERROR STOP            IOC43310
       CLA     LBC                 PLACE L(POOL) IN                     IOC43320
       STA     2,2                 FILE CONTROL WORDS                   IOC43330
       ALS     18                  2ND WORD ADDRESS AND                 IOC43340
       STD     4,2                 5TH WORD DECREMENT                   IOC43350
       CAL     CA5                 IF THE FILE                          IOC43360
       LFT     RESER               IS A RESERVE FILE                    IOC43370
       STA     3,2                 PLACE L(SVN WORD)                    IOC43380
       TRA     CA20                IN FILE CONTROL BLOCK                IOC43390
*                           CLOSE SUPERVISOR                            IOC43400
CA10   TSX     CA50,4              PROCESS ENTRY IN FILE LIST           IOC43410
       TRA     CA13                ENTRY WAS PZE FILE                   IOC43420
       LXD     CA26,1              IF SINGLE FILE CLOSE                $IOC43430
       TXL     CA13,1,0            GO AS IF NO SUN                     $IOC43440
       ZET     7GRP                ENTRY IS SVN WORD                    IOC43450
       TSX     CA11,4              IF A SVN OCCURRED BEFORE-UPDATE      IOC43460
       CLA     CA51                ITS COUNTS AND SAVE THE              IOC43470
       STA     7GRP                LOCATION OF THE NEW SVN WORD         IOC43480
       TRA     CA10                PROCESS FILE LIST                    IOC43490
*POST-PROCESSOR OF SVN WORD (AFTER FILES OF THE GROUP HAVE BEEN CLOSED) IOC43500
CA11   CLA*    7GRP                UP THE BUFFER COUNT                  IOC43510
       PAX     0,1                 BY THE FILECT OF THE                 IOC43520
       SXD     CA12,1              GROUP , THEN ADJUST                  IOC43530
       PDX     0,1                 IBACT BY THE INCREMENTED             IOC43540
CA12   TXI     *+1,1,**            BUFFER COUNT THAT WAS                IOC43550
       PXD     0,1                 RESERVED SOLELY FOR                  IOC43560
       STD*    7GRP                THE RESERVE GROUPS USAGE             IOC43570
       SSM                         SET TO ADD THIS COUNT.               IOC43580
       TSX     ADIBC,1                                                  IOC43590
       TRA     1,4                 EXIT                                 IOC43600
*                        FILE PROCESSOR(CLOSE)                          IOC43610
CA13   LFT     RESOP               IF FILE IS ALREADY                   IOC43620
       LFT     DETACH              PERMANENTLY CLOSED                  $IOC43630
       TRA     CA25                THIS CLOSE IS A NOP                  IOC43640
       TSX     FNLBC,4             FIND L(POOL)                         IOC43650
*                GENERAL FILE HANDLER ATTACH AND CLOSE                  IOC43660
CA20   LAC     LBC,4               L(POOL) TO IR4                       IOC43670
       LFT     RESER               IF THE FILE IS A RESERVE, COUNTS     IOC43680
       TRA     CA23                HAVE BEEN ADJUSTED ALREADY           IOC43690
       LFT     TTO                 1ST TTO(ATTACH) AND LAST TTO (CLOSE) IOC43700
       TRA     CA40                AFFECTS BY ONE BUFFER                IOC43710
CA22   CLS     1DEC                ADJUST IBACT BY                     $IOC43720
       TSX     ADIBC,1             1 EACH INPUT,PTO AND 1 ALL TTOS      IOC43730
CA23   ENB     TRAPS               ALLOW TRAPS                          IOC43740
       TSX     **,4                EITHER OPEN OR                       IOC43750
CA24   PZE     **                  SHUT THE FILE                        IOC43760
       PIA                         PLACE CONTROL BITS                   IOC43770
       STD     1,2                 IN FILE                              IOC43780
CA25   LXD     CA26,1              ADVANCE                              IOC43790
       TNX     CA27,1,1            ALONG FILE LIST                      IOC43800
       SXD     CA26,1              AS LONG AS MORE FILES                IOC43810
       RNT     SWATT               RETURN TO                            IOC43820
CA26   TXL     CA10,0,**           CA10 (CLOSE)                         IOC43830
       TRA     CA3                 CA3 (ATTACH)                         IOC43840
CA27   RNT     SWATT               IF A SVN APPEARED                    IOC43850
       NZT     7GRP                IN A CLOSE LIST AND                  IOC43860
       TRA     COMXIT+3            LIST ENDS ADJUST SVN WORD            IOC43870
       TSX     CA11,4              COUNTS BEFORE                        IOC43880
       TRA*    *-2                 EXITING                              IOC43890
       EJECT                                                            IOC43900
*                           TTO FILE HANDLER                            IOC43910
CA40   CAL     1,4                 DETERMINE IF THIS                    IOC43920
       RNT     SWATT               TTO IS THE FIRST ONE                 IOC43930
       SSM                         ATTACHED OR THE LAST                 IOC43940
       ADD     2TAG                ONE CLOSED, IF SO                    IOC43950
       SLW     1,4                 ADJUST IBACT BY ONE                  IOC43960
       ANA     TTOCT               NOTE.... RESERVE FILES (TTO)         IOC43970
       TZE     CA22                ARE NOT INCLUDED IN TTO CT           IOC43980
       ERA     2TAG                NOR DO THEY AFFECT                   IOC43990
       RFT     SWATT               ANY COUNTS AS THEY ARE HANDLED       IOC44000
       TZE     CA22                BY SVN WORD                          IOC44010
       TRA     CA23                                                     IOC44020
*                         FILE LIST PROCESSOR                           IOC44030
CA50   CLA     CA51                ADVANCE IN LIST                      IOC44040
       ACL     L(1)                NOTE... THAT L(LIST)-1 ORIGINALLY    IOC44050
       STA     CA51                IN LIST LOCATOR                      IOC44060
       RNT     SWATT               RESET ALL CONTROL BITS EXCEPT        IOC44070
       RIL     RESER               SWATT AND IF ATTACHING               IOC44080
       RIS     NTRES               RESERVE BIT                          IOC44090
       ENB     L(0)                TRAP PROTECT                         IOC44100
CA51   CAL     **                  WHILE ADJUSTING                      IOC44110
       PAC     0,2                 COUNTS                               IOC44120
       STA     CA24                L(FILE) TO IR2 AND CA24              IOC44130
       STA     FCW                 IN FCW CELL                          IOC44140
       ANA     6PRE                CHECK IF SIX OR                      IOC44150
       OAI                         SVN WORD APPEARS                     IOC44160
       CLA*    CA51                PICKUP LIST ENTRY                    IOC44170
       LNT     600000              SIX OR SVN                           IOC44180
       TRA     *+2                 IF SO EXIT                           IOC44190
       TRA     2,4                 AT 2,4                               IOC44200
       RFT     SWATT               IF ATTACHING                         IOC44210
       STD     2,2                 SAVE L(NON-STANDARD LABEL PKG.)      IOC44220
       CLA     1,2                 PLACE FILE CONTROL BITS              IOC44230
       RIL     700000              RESET SIX OR SVN CODE IN SI PREFIX   IOC44240
       ANA     PDMSK               IN SENSE INDICATORS                  IOC44250
       OAI                         AND EXIT AT                          IOC44260
       TRA     1,4                 1,4                                  IOC44270
*                      OPEN ERROR MESSAGE SENDER                        IOC44280
CA60   TSX     DRANO,4             UNIT NO. TO MESSAGE                  IOC44290
       TSX     PROUT,4             PRINT ERROR MESSAGE                  IOC44300
       PZE     3                   DETACHED FILE                        IOC44310
       MZE     MESS1,,2            AND STOP.                            IOC44320
       MZE     9,2,3               IF OPERATOR                          IOC44330
       PZE     MESS7,,6            PROCEEDS THEN FILE IS                IOC44340
       TSX     PAWS,4              NOT OPENED                           IOC44350
       TRA     OP1+1                                                    IOC44360
       TTL                         DE-ACTIVATE FILE                     IOC44370
*                           CALLING SEQUENCE                            IOC44380
*              TSX  SHUT,4         IR2 MUST= -L(FCW)                    IOC44390
*              **      **                                               IOC44400
*              RETURNS AT CA24+1                                        IOC44410
       SPACE   1                                                        IOC44420
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     IOC44430
       LNT     RESOP               IF CLOSING AN OPEN                   IOC44440
       TRA     *+4                 RESERVE FILE                         IOC44450
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   IOC44460
       ACL     L(1)                ALLOWING ANOTHER FILE                IOC44470
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      IOC44480
SH1    CLA     3,2                 HANDLE INTERNAL                      IOC44490
       TMI     INTCL               FILE SEPARATELY                      IOC44500
       LNT     OUTPUT              IF CHECKPOINT FILE OR                IOC44510
       LNT     OPEND               IF FILE NEVER                        IOC44520
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $IOC44530
       LFT     OUTPUT              INPUT OR                             IOC44540
       TRA     SH5                 OUTPUT FILE                          IOC44550
       SPACE   1                                                        IOC44560
*                           CLOSE INPUT FILE                            IOC44570
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  IOC44580
       CAL     0,2                 MAKE SURE EOF                       $IOC44590
       ANA     FOR                 FLAG IS OFF                         $IOC44600
       STP     0,2                                                     $IOC44610
SH2    CLA     5,2                 CHECK FOR HYPER                     $IOC44620
       ANA     SIX                                                     $IOC44630
       TNZ     SH4                                                     $IOC44640
       RNT     REWNUN                                                  $IOC44650
       TRA     SH6                 RETURN                              $IOC44660
       RIR     REWNUN              TAKE OUT HYPER OPTION               $IOC44670
       TRA     SH6                 RETURN                              $IOC44680
SH4    RNT     5                                                       $IOC44690
       TRA     *+3                                                     $IOC44700
       RNT     2                                                       $IOC44710
       TRA     *+5                                                     $IOC44720
       RNT     NOEOFM              TEST FOR FILE PROTECT               $IOC44730
       TRA     *+3                 NO                                  $IOC44740
       TSX     (NDSLX,4            YES                                 $IOC44750
       PZE     0,2,HFPNP           FILE PROTECT                        $IOC44760
       RNT     REWNUN              TEST FOR UNLOAD                     $IOC44770
       TRA     SH6                 NO                                  $IOC44780
       TSX     (NDSLX,4            YES                                 $IOC44790
       PZE     0,2,HUNLP           UNLOAD                              $IOC44800
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $IOC44810
       TRA     SH4.1-2             EXIT                                $IOC44820
       BES     SH4+NOHYP/NOHYP**-NOHYP/NOHYP*SH4-*                     $IOC44830
SH6    RNT     NOREW               IF NO REWIND FINISH UP              $IOC44840
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $IOC44850
       RFT     NOREW               IF NO REWIND                         IOC44860
       TRA     SH4.1               SPECIFIED SKIP OUT                   IOC44870
       CAL     3DEC                FORM REW CODE (=3)                   IOC44880
       RNT     NORUN               OR REW UNLOAD                        IOC44890
       ACL     1DEC                CODE (=4)                            IOC44900
       STD     *+2                                                      IOC44910
       TSX     NDSEL+1,4           ISSUE REW                            IOC44920
       PZE     0,2,**              OR RUN                               IOC44930
       RFT     REWNUN              IF REWOUND AND                      $IOC44940
       TRA     SH4.1               UNLOADED                             IOC44950
       SIL     DETACH              PRINT MESSAGE                        IOC44960
       TSX     UNMNT,4             TO OPERATOR                          IOC44970
SH4.1  LFT     RESER               RESET FILE                           IOC44980
       ZET     7GRP                BITS UNLESS SINGLE CLOSE             IOC44990
       RIL     SEVER               OF A RESERVE FILE                    IOC45000
       RIL     OPEND               RESET OPENED BIT                     IOC45010
       TRA     CA24+1              EXIT                                 IOC45020
       SPACE   1                                                        IOC45030
*                          CLOSE OUTPUT FILE                            IOC45040
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            IOC45050
       RNT     000005              CHECK FOR HYPER OPTIONS             $IOC45060
       TRA     *+3                 NOT MON OPTION                      $IOC45070
       RNT     NORUN               IF TRUE MON OPTION                  $IOC45080
       TRA     SH3                 SKIP EOF AND LABEL WRITES            IOC45090
       TSX     NDSEL+1,4           WRITE                                IOC45100
       PZE     0,2,WEFOP           EOF                                  IOC45110
       NOP                         IGNORE EOT                           IOC45120
SH9    LFT     LABEL               IF LABELLED                          IOC45130
       TSX     LABCO,1             FILE THEN WRITE TRAILER              IOC45140
SH3    LAC     LBC,4               L(POOL) TO IR4                       IOC45150
       SXD     SH33,2              REMOVE FILE FROM                     IOC45160
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              IOC45170
       PAX     0,1                 FILE THAT REFERENCES CLOSING         IOC45180
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           IOC45190
       TXL     SH34,1,0            FOUND.                               IOC45200
       PAC     0,4                 NOT FOUND. ADVANCE                   IOC45210
       TRA     SH32                ALONG CHAIN.                         IOC45220
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           IOC45230
       STA     1,4                 REFERENCED CLOSING FILE              IOC45240
       RNT     000005              IS THIS CLOSE                       $IOC45250
       TRA     *+3                 A TRUE MON OPTION                   $IOC45260
       RNT     NORUN                                                   $IOC45270
       TRA     SH4.1               YES,POST AND RETURN                 $IOC45280
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $IOC45290
       TTL                         OPEN ROUTINE                         IOC45300
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              IOC45310
       SPACE   1                                                        IOC45320
*                           CALLING SEQUENCE                            IOC45330
*              TSX OPEN,4                                               IOC45340
*               P  FILE,,1                                              IOC45350
*      WHERE                                                            IOC45360
*              P= PZE REWIND BEFORE OPEN                                IOC45370
*              P= MZE NO REWIND                                         IOC45380
*              P= MON NO REWIND, NO LABELS                              IOC45390
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  IOC45400
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           IOC45410
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE IOC45420
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     IOC45430
*      ACTIONS ....                                                     IOC45440
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      IOC45450
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             IOC45460
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                IOC45470
       SPACE   1                                                        IOC45480
OPEN.  LNT     OPEND               IF FILE ALREADY OPN                  IOC45490
       TRA     OP2                 CLEAR INHIBITED INDICATOR            IOC45500
OP1    SIL     OPNEOT              SET OPEN AND NO EOT CODE             IOC45510
       RFT     SWATT               IF ATTACHING                         IOC45520
       TRA     CA24+1              RETURN THERE                         IOC45530
       TRA     COMXIT              ELSE EXIT TO USER                    IOC45540
OPAT   LNT     RESER               RESERVE FILES ARE                    IOC45550
       TXI     OP2,4,-2            NOT OPENED AT ATTACHMENT             IOC45560
       SIL     NETIH               SET NO EOT CODE+ NOT INHIBITED       IOC45570
       TRA     CA24+1                                                   IOC45580
OP2    SIL     NETIH               SET NO EOT + NOT INHIB               IOC45590
       LFT     DETACH              IF FILE HAS BEEN REWOUND-UNLOADED    IOC45600
       TRA     CA60                PRINT ERROR MESSAGE                  IOC45610
       LNT     RESER               IF FILE IS RESERVE TYPE              IOC45620
       TRA     OP4                 CHECK TO MAKE                        IOC45630
       CLA*    3,2                 SURE THAT NO MORE                    IOC45640
       PAX     0,1                 THAN THE SPECIFIED                   IOC45650
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  IOC45660
       TXH     OP10,1,4096         SIMULTANEOUSLY OPENED                IOC45670
       PXA     0,1                                                      IOC45680
       STA*    3,2                                                      IOC45690
OP4    CLA     3,2                 OPEN INTERNAL FILE                   IOC45700
       TMI     INTOP               HANDLED SEPARATELY                   IOC45710
       SXA     2TAG+2,4            SAVE IR 4                            IOC45720
       LDQ     0,2                 CHECK                                IOC45730
       RQL     18                  REEL IS MOUNTED                      IOC45740
       TQP     OP11                IF NOT INFORM OPERATOR               IOC45750
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $IOC45760
       STA     4,2                 = L(0)                               IOC45770
       TSX     (NDATA,4            TEST LEGALITY                       $IOC45780
2TAG   PZE     0,2,TESTP           OF UNIT                              IOC45790
       TSX     DENSE,4             SET FILE DENSITY                     IOC45800
       AXT     **,4                                                     IOC45810
       CLA     -1,4                                                     IOC45820
       TPL     *+4                 IF PZE- REW                          IOC45830
       ANA     1PRE                MZE- NO REW                          IOC45840
       TNZ     OP9.3               MON-NO REW, NO LABELS                IOC45850
       TRA     OP6                                                      IOC45860
       TSX     NDSEL+1,4           REWIND BEFORE                        IOC45870
       PZE     0,2,REWOP           OPEN                                 IOC45880
OP6    TSX     OP7.1-3,1           CHECK FOR HYPER DETAILS             $IOC45890
       CAL     SIX                 CLEAR ERROR INFO.                   $IOC45900
       ANS     5,2                 HISTORY AND                         $IOC45910
       STD     3,2                 BLOCK SEQUENCE                      $IOC45920
       LFT     OUTPUT                                                  $IOC45930
       TRA     OP9                 IS DONE EXCEPT LABELS                IOC45940
       SPACE   1                                                        IOC45950
*                           OPEN INPUT FILE                             IOC45960
       TSX     FNLBC,4             FIND L(POOL)                         IOC45970
       LFT     LABEL               LABEL ACTION                         IOC45980
OP7    TSX     LABCI,1             OPEN INPUT                           IOC45990
       PXD     0,0                 CLEAR BUFFER COUNT                   IOC46000
       STA     1,2                 IN FCB.                              IOC46010
       TSX     BORBF,1             INITIATE READ                        IOC46020
LBC    NOP                         IF POSSIBLE ... L(POOL)...           IOC46030
       TRA     OP1                 EXIT                                 IOC46040
       SPACE   1                                                        IOC46050
*                           OPEN OUTPUT FILE                            IOC46060
OP9    LNT     OUTPUT              LOOK FOR CHECKPOINT                  IOC46070
       TRA     OP9.1               FILE DEFINITION                      IOC46080
       CAL     FCW                 BY OPENING                           IOC46090
       STA     CPFILE              OUTPUT FILE                          IOC46100
       TRA     OP1                 CODE= PTO+TTO                        IOC46110
OP9.1  LFT     LABEL               ACTION                               IOC46120
OP9.2  TSX     LABOO,1             OPEN OUTPUT                          IOC46130
       TSX     FNLBC,4             FIND L(POOL)                         IOC46140
       LAC     LBC,4               L(POOL) TO IR4                       IOC46150
       CLA     1,4                 PLACE OUTPUT                         IOC46160
       STA     1,2                 FILE IN SYNCING                      IOC46170
       CLA     FCW                 CHAIN USED TO                        IOC46180
       STA     1,4                 RELEASED TO THE                      IOC46190
       TRA     OP1                 BUFFER POOL                          IOC46200
*                   BYPASS REWIND AND LABEL ACTION.                     IOC46210
OP9.3  TSX     OP7.1-3,1           CHECK FOR HYPER DETAILS             $IOC46220
       LNT     OUTPUT              TEST FOR CHECKPOINT                 $IOC46230
       TRA     *+2                 NO.                                  IOC46240
       TRA     OP9+2               ASSIGN CHECKPOINT.                   IOC46250
       LFT     OUTPUT              INPUT OR                             IOC46260
       TRA     OP9.2+1             OUTPUT. ENTER IN CHAIN.              IOC46270
       TSX     FNLBC,4             INPUT. FIND L(POOL)                  IOC46280
       TRA     OP7+1               INITIATE READ.                       IOC46290
       SPACE   1                                                        IOC46300
*                     ERROR TOO MANY RESERVES OPEN                      IOC46310
OP10   TSX     PROUT,4             PRINT RESERVE FILE                   IOC46320
       PZE     2                   CONFLICT ERROR                       IOC46330
3DEC   MZE     9,2,3               AND STOP.... IF STARTED              IOC46340
       PZE     MESS6,,7            NO OPEN OCCURS                       IOC46350
       TSX     PAWS,4                                                   IOC46360
       TRA     OP1+1                                                    IOC46370
       SPACE   1                                                        IOC46380
*          FILE IS NOT MOUNTED SEND INSTRUCTIONS TO OPERATOR            IOC46390
OP11   CLA     5,2                 IF DISK,JUST                        $IOC46400
       TMI     *+4                 PUT MOUNT FLAG ON                   $IOC46410
       CAL     7,2                 REEL NUMBER TO MOUNT                $IOC46420
       TSX     MOUNT,4                                                  IOC46430
       TSX     PAUSE,4             WAIT FOR OPERATOR                    IOC46440
       CLA     *-1                 PUT MOUNT FLAG ON                   $IOC46450
       STT     0,2                                                     $IOC46460
       TRA     OP4.5               PROCEED IN OPEN                     $IOC46470
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $IOC46480
       CLA     5,2                 IS THIS HYPER                       $IOC46490
       ANA     SIX                                                     $IOC46500
       TZE     OP7.3               NO                                  $IOC46510
OP7.1  RIR     MXDMD               RESET BACKWARD READ                 $IOC46520
       PIA                                                             $IOC46530
       STT     1,2                                                     $IOC46540
       LFT     OUTPUT              IF OUTPUT                           $IOC46550
       TRA     1,1                 ALL DONE                            $IOC46560
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $IOC46570
       TXL     OP7.2,4,0           NO                                  $IOC46580
       ORA     *-1                 SET READ                            $IOC46590
       STT     1,2                 BACKWARD                            $IOC46600
       AXC     2,4                                                     $IOC46610
       CLA*    0,2                                                     $IOC46620
       ANA     ADDRS               IF NEXT READ IS NOT A               $IOC46630
       TNZ     OP7.2               FILE MARK THEN PROCEED              $IOC46640
       TSX     (NDSLX,4            ELSE BACKSPACE FILE                 $IOC46650
       PZE     0,2,HBSFP                                               $IOC46660
OP7.2  LXA     2TAG+2,4                                                $IOC46670
       CLA     -1,4                TEST FOR THE                        $IOC46680
       ANA     SIX                 SETTING OF FILE PROTECT             $IOC46690
       TZE     *+3                 NO                                  $IOC46700
       TSX     (NDSLX,4                                                $IOC46710
       PZE     0,2,HFPNP           FILE PROTECT                        $IOC46720
       TRA     1,1                                                     $IOC46730
       BES     OP7.1+NOHYP/NOHYP**-NOHYP/NOHYP*OP7.1-*                 $IOC46740
OP7.3  LFT     OUTPUT                                                  $IOC46750
       TRA     1,1                                                     $IOC46760
       LXD     XEOB,4              IF READ                             $IOC46770
       TXL     OP7.3+1,4,0         BACKWARD                            $IOC46780
       TSX     NDSEL+1,4           REWIND 729                          $IOC46790
       PZE     0,2,REWOP           OR DISK INPUT                       $IOC46800
       TRA     1,1                                                     $IOC46810
       TTL     RELEASE BUFFER AND  READ WITH RETENTION                  IOC46820
RELASE ENB     L(0)                                                    $IOC46830
       LDC     XEOB,2              -L(FILE) IN IR2                     $IOC46840
       TSX     FNLBC,4             FIND THE BUFFER POOL                $IOC46850
       CAL     FCW                 GET BUFFER CONTROL                  $IOC46860
       SUB     L(2)                ADDRESS AND                         $IOC46870
       STA     *+1                 MAKE SURE IT IS                     $IOC46880
RELASD LDI     **                  ABLE TO BE RELEASED                 $IOC46890
       LNT     100000                                                  $IOC46900
       TRA     COMXIT+3                                                $IOC46910
       LDI     1,2                 FILE BITS TO INDICATORS             $IOC46920
       TSX     BCKBB,1             RESTORE BUF COUNT                   $IOC46930
       CAL     RELASD                                                  $IOC46940
       TSX     BTP2,1              PUT BUF IN POOL                     $IOC46950
       XCA                                                             $IOC46960
       ERA     2,2                 IF BUFFER RELEASED IS THE SAME      $IOC46970
       ANA     ADDRS               AS THE BUFFER IN USE PUT            $IOC46980
       TNZ     *+3                 THE BUFFER POOL ADDRESS IN          $IOC46990
       CLA     LBC                 THE THIRD WORD OF THE FCB           $IOC47000
       STA     2,2                                                     $IOC47010
       TRA     COMXIT+3            EXIT                                $IOC47020
READR1 STL     *+2                 SET READ/RETENTION SW               $IOC47030
       TRA     READ.                                                   $IOC47040
       BES     RELASE+NOCH/NOCH**-NOCH/NOCH*RELASE-*                   $IOC47050
READR2 PZE     **                                                       IOC47060
       TTL                         BUFFERED READ ROUTINE                IOC47070
*              TSX  READ,4              BUFFERED READ                   IOC47080
*              PZE  FILE,,EOB           END OF BLOCK                    IOC47090
*              PZE  EOF,,ERR              END OF FILE AND               IOC47100
*                   *                     ERROR EXITS                   IOC47110
*                   *                                                   IOC47120
*                  IO-LIST                                              IOC47130
*                   *                                                   IOC47140
*              RETURN                                                   IOC47150
       SPACE   1                                                        IOC47160
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                IOC47170
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               IOC47180
*                              IS GIVEN.                                IOC47190
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   IOC47200
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      IOC47210
*                            BUFFER AREA ATTACHED TO THE FILE           IOC47220
       SPACE   1                                                        IOC47230
READ.  SIR     RDSWIT              SET READ SWITCH                     $IOC47240
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    IOC47250
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             IOC47260
       CLA     -1,4                SAVE MODAL EXITS                     IOC47270
       STA     XEOF                END OF FILE                          IOC47280
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     IOC47290
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     IOC47300
       TRA     EOFER               TAKE END OF FILE EXIT                IOC47310
       LFT     OUTPUT              IF OUTPUT FILE                       IOC47320
       TRA     NOPXIT              DO NOTHING, JUST EXIT.               IOC47330
       TSX     FNLBC,4             FIND L(POOL)                         IOC47340
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      IOC47350
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             IOC47360
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       IOC47370
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 IOC47380
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     IOC47390
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     IOC47400
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           IOC47410
       PZE     TRM1                3.TRANSMIT FROM                      IOC47420
       PZE     TRM2                BUFFER TO WORKING STORAGE            IOC47430
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   IOC47440
       TTL                         BUFFERED WRITE ROUTINE               IOC47450
*              TSX WRITE,4              BUFFERED WRITE                  IOC47460
*              PZE  FILE,,EOB            END OF BLOCK EXIT              IOC47470
*                    *                                                  IOC47480
*                    *                                                  IOC47490
*                  IO-LIST                                              IOC47500
*                   *                                                   IOC47510
*              RETURN                                                   IOC47520
       SPACE   1                                                        IOC47530
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                IOC47540
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               IOC47550
*                              IS GIVEN.                                IOC47560
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  IOC47570
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      IOC47580
*                            BUFFER AREA ATTACHED TO THE FILE           IOC47590
       SPACE   1                                                        IOC47600
WRITE. LNT     OUTPUT              CAN'T WRITE ON CKPT FILE             IOC47610
       LNT     OPEND               IF FILE NOT OPEN                     IOC47620
       TRA     NOPXIT              DO NOTHING JUST EXIT                 IOC47630
       LFT     OUTPUT              IF OUTPUT FILE                       IOC47640
       TRA     *+2                 ALL IS WELL.                         IOC47650
       TRA     NOPXIT              INPUT, DO NOTHING, JUST EXIT         IOC47660
       TSX     FNLBC,4             FIND L(POOL)                         IOC47670
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    IOC47680
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    IOC47690
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   IOC47700
       PZE     TRM2                3.TRANSMIT FROM                      IOC47710
       PZE     TRM1                WORKING STORAGE TO BUFFER            IOC47720
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  IOC47730
       EJECT                                                            IOC47740
*                  FIND L(BPC) FROM FILE CONTROL WORD                   IOC47750
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            IOC47760
FNLBC  CLA     4,2                                                      IOC47770
       PDX     0,1                                                      IOC47780
       SXA     LBC,1                                                    IOC47790
       TRA     1,4                                                      IOC47800
       SPACE   1                                                        IOC47810
*     ADJUST INPUT BUFFER AVAILABILITY COUNT ( ATTACH AND CLOSE )       IOC47820
*              TSX  ADIBC,1                                             IOC47830
ADIBC  RFT     SWATT               ADJUST IBACT BY                      IOC47840
       SSP                                                             $IOC47850
L(0)A  ENB     L(0)                TRAP PROTECT                         IOC47860
       ADD*    LBC                 +1 CLOSE INPUT,PTO,LAST TTO          IOC47870
       TPL     AD1                 -1 ATTACH INPUT, PTO, 1ST TTO        IOC47880
       STD*    LBC                 +RESCT CLOSE RESERVE GROUP           IOC47890
       ENB     TRAPS                                                    IOC47900
       TRA     1,1                 -RESCT ATTACH RESERVE GROUP          IOC47910
*                         ERROR IBACT NEGATIVE                          IOC47920
AD1    CAL     AD2                 PICK UP MESSAGE PARAM                IOC47930
       TRA     TSXR                AND GO ADD L(TSX) ,PRINT AND STOP    IOC47940
AD2    MZE     MESS8,,3            '' ATTACH ERROR AT ***** ''          IOC47950
*            ROUTINE TO PREPARE REDUNDANCY ERROR COUNTS ON              IOC47960
*                       PRINTER FOR THE OPERATOR                        IOC47970
       SPACE   1                                                        IOC47980
REDCT  SXA     RCT1,4              SAVE IR4                             IOC47990
       CAL     5,2                 IF ASSIGNED SENSE                   $IOC48000
       ALS     4                   IS UP AND ERROR HISTORY             $IOC48010
       TZE     RCT0                PRINT OR ELSE PRINT IT              $IOC48020
       TSX     DRANO,4             DRIVE ADDRESS TO MESSAGE             IOC48030
       LDQ     7,2                 REEL SEQ                             IOC48040
       STQ     MES10+1             TO MESSAGE                           IOC48050
       CLA     3,2                 RECORD                               IOC48060
       TSX     (DECVD,4            COUNT                                IOC48070
       STQ     MES10+3                                                  IOC48080
       CLA     5,2                 REDUN                                IOC48090
       TSX     (DECVA,4            COUNT                               $IOC48100
       STQ     MES12                                                    IOC48110
       LDQ     BLNKS                                                   $IOC48120
       LFT     OUTPUT                                                  $IOC48130
       TRA     *+3                                                     $IOC48140
       CLA     5,2                 PERM. OR                             IOC48150
       TSX     (DECVD,4            ERASE COUNT                         $IOC48160
       STQ     MES12+3                                                  IOC48170
       CLA     MES13               PLACE ''ERASE'' FOR OUTPUT           IOC48180
       LFT     OUTPUT              OR ''PERM.'' FOR INPUT               IOC48190
       CLA     MES14               IN MESSAGE                           IOC48200
       STO     MES12+1                                                 $IOC48210
       CLA     MES26                                                   *IOC48220
       LDQ     5,2                 TEST FOR DISK                       *IOC48230
       TQP     *+2                 NO,TAPE                             *IOC48240
       CLA     MES25               YES,CHANGE PRINT OUT                *IOC48250
       STO     *+5                                                     *IOC48260
       BES     *-5+NOCH/NOCH*5-*                                        IOC48270
       TSX     PROUT,4             PRINT                                IOC48280
       PZE     4                                                        IOC48290
       MZE     MESS1,,2                                                 IOC48300
       MZE     9,2,3                                                    IOC48310
       PZE     MES10,,6                                                 IOC48320
       PZE     MES11,,9+512*DBLSP                                       IOC48330
RCT0   CAL     SIX                 SET BLOCK SEQUENCE                  $IOC48340
       ANS     5,2                 ERROR INFORMATION                   $IOC48350
       STD     3,2                 AND BLOCK COUNT 'IS ZERO            $IOC48360
RCT1   AXT     **,4                RESTORE IR4                          IOC48370
       TRA     1,4                 EXIT                                 IOC48380
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         IOC48390
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          IOC48400
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    IOC48410
       SPACE   1                                                        IOC48420
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            IOC48430
*                          IR4 MUST= -L(POOL)                           IOC48440
       SPACE   1                                                        IOC48450
TOKBB  ENB     L(0)                TRAP PROTECT                         IOC48460
TOKBF  SXA     TK3,4               SAVE IR4                             IOC48470
       LNT     RESER               IF A RESERVE FILE                    IOC48480
       TRA     TK1                 THEN REDUCE THE RESERVE BUFFER       IOC48490
       CLA*    3,2                 COUNT AND IF IT                      IOC48500
       PDX     0,1                 GOES NEGATIVE THEN                   IOC48510
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  IOC48520
       TXL     TK2,1,4096                                               IOC48530
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               IOC48540
       PDX     0,4                 IMMEDIATE FILES                      IOC48550
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              IOC48560
       SUB     1DEC                                                     IOC48570
       STD*    LBC                                                      IOC48580
TK2    PXD     0,1                 RESTORE RESERVE                      IOC48590
       LFT     RESER               BUFFER COUNT IF A RESERVE            IOC48600
       STD*    3,2                 FILE                                 IOC48610
TK3    AXT     **,4                RESTORE IR4                          IOC48620
       TRA     2,4                 EXIT                                 IOC48630
TK4    LXA     TK3,4               TAKE ERROR EXIT                      IOC48640
       TRA     1,4                                                      IOC48650
       SPACE   1                                                        IOC48660
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            IOC48670
       SPACE   1                                                        IOC48680
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      IOC48690
BCKBF  LNT     RESER               IF A RESERVE                         IOC48700
       TRA     BK1                 FILE THEN INCREMENT                  IOC48710
       SXA     BK2,1               SAVE IR1                             IOC48720
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       IOC48730
       PDX     0,1                                                      IOC48740
       ACL     1DEC                                                     IOC48750
       STD*    3,2                                                      IOC48760
       TXL     BK3,1,4096          IF IT WAS NEGATIVE INCREMENT         IOC48770
BK2    AXT     **,1                RESTORE IR1                          IOC48780
BK1    CAL     0,4                 POOL CT ALSO                         IOC48790
       ADD     1DEC                                                     IOC48800
       STD     0,4                                                      IOC48810
       TRA     1,1                 EXIT                                 IOC48820
BK3    LXA     BK2,1               RESTORE IR1                          IOC48830
       TRA     1,1                 AND TAKE EXIT                        IOC48840
       TTL             MOUNT AND DISMOUNT INSTRUCTIONS TO OPERATOR      IOC48850
*                                                                       IOC48860
*        PRINT REEL DISMOUNTING INSTRUCTIONS TO OPERATOR                IOC48870
*      TSX     UNMNT,4                                                  IOC48880
*      RETURN                                                           IOC48890
*                                                                       IOC48900
UNMNT  SXA     UNM1,4              SAVE IR4                             IOC48910
       TSX     DRANO,4             ABS UNIT TO MESSAGE                  IOC48920
       CAL     7,2                 REEL NUMBER                          IOC48930
       SLW     MES23+2             TO MESSAGE                           IOC48940
       TSX     PROUT,4             PRINT                                IOC48950
L(3)   PZE     3                   --UNIT *****                        $IOC48960
       MZE     MESS1,,2            FILE-NAME                            IOC48970
       MZE     9,2,3               REMOVE REEL ***** ''                 IOC48980
       PZE     MES23,,3+512*DBLSP                                       IOC48990
UNM1   AXT     **,4                                                     IOC49000
       TRA     1,4                 EXIT                                 IOC49010
       SPACE   1                                                        IOC49020
*          PRINT INSTRUCTIONS TO OPERATOR TO MOUNT A NEW REEL           IOC49030
*                  THE REEL NUMBER MUST BE IN THE AC                    IOC49040
*      TSX     MOUNT,4                                                  IOC49050
*      RETURN                                                           IOC49060
*                                                                       IOC49070
MOUNT  SXA     MNT3,4              SAVE IR4                             IOC49080
       SLW     MES23+2             SAVE REEL NUMBER IN MESSAGE          IOC49090
       TSX     DRANO,4             UNIT NUMBER TO MESSAGE               IOC49100
       CLA     MNT4                IF INPUT FILE                        IOC49110
       LFT     OUTPUT              ''MOUNT REEL *****''                 IOC49120
       TRA     *+2                 IF NON-LABELED OUTPUT                IOC49130
       TRA     MNT1                ''MOUNT BLANK''                      IOC49140
       CLA     MNT5                IF LABELED OUTPUT                    IOC49150
       LFT     LABEL               '' MOUNT LABELED BLANK''             IOC49160
       CLA     MNT6                                                     IOC49170
MNT1   STO     *+5                 EXTRA MESSAGE TO LIST                IOC49180
MNT2   TSX     PROUT,4             PRINT INSTRUCTIONS TO OPERATOR       IOC49190
L(4)   PZE     4                                                       $IOC49200
       MZE     MESS1,,2                                                 IOC49210
       MZE     9,2,3                                                    IOC49220
       MZE     **                                                       IOC49230
       PZE     MES23+1,,2                                               IOC49240
       CLA     MNT2                SET INDICATOR THAT UNIT IS           IOC49250
       STT     0,2                 MOUNTED                              IOC49260
MNT3   AXT     **,4                                                     IOC49270
       TRA     1,4                                                      IOC49280
MNT4   MZE     MES24,,1                                                 IOC49290
MNT5   MZE     MES24,,2                                                 IOC49300
MNT6   MZE     LMSG5,,3                                                 IOC49310
       TTL     FIND TAPE ADDRESS AND PLACE IN MESSAGE+UNIT*****+        IOC49320
*         TSX  DRANO,4             EXECUTES ENB L(0),NO ENB TRAPS       IOC49330
       SPACE   1                                                        IOC49340
DRANO  SXA     *+6,4               CLEAR IR4 FOR * ADDRESSING           IOC49350
       AXT     0,4                                                      IOC49360
       LDQ*    0,2                                                      IOC49370
       ENB     L(0)                TRAP PROTECT SYUNCV ROUTINE          IOC49380
       TSX     SYUNCV,4            CONVERT UNIT TO SYMBOLIC             IOC49390
       SLW     MESS1+1                                                  IOC49400
       AXT     **,4                                                     IOC49410
       TRA     1,4                                                      IOC49420
       SPACE   1                                                        IOC49430
*                      FOLDED CHECKSUM CALCULATOR                       IOC49440
*                   CHECKSUMS LOCATOR SPECIFICATION                     IOC49450
*                         FOR FILE AND LEAVES                           IOC49460
*                  FOLDED 18 BIT CHECKSUM IN MQ S-17                    IOC49470
       SPACE   1                                                        IOC49480
*                           CALLING SEQUENCE                            IOC49490
       SPACE   1                                                        IOC49500
*              TSX SUMMIT,1   IR2 MUST = -L(FILE)                       IOC49510
       SPACE   1                                                        IOC49520
SUMMIT CLA*    TR5                 SETUP NUMBER                         IOC49530
       SXA     SUM3,1              SAVE IR1                             IOC49540
       PDX     0,1                 WDS TO                               IOC49550
       PXA     0,0                 CHECKSUM                             IOC49560
       TRA     *+2                 DONT CHECKSUM BLOCK SEQ WORD         IOC49570
SUM1   ACL     **,1                CHECKSUM                             IOC49580
2PRE   TIX     *-1,1,1             BUFFER                               IOC49590
       XCL                         FOLD                                 IOC49600
       STZ     TEMP                CHECKSUM TO 18 BITS                  IOC49610
       SLQ     TEMP                UPPER BITS S-17                      IOC49620
       XCL                         ADDED TO LOWER BITS 18-35            IOC49630
       ALS     18                  THEN OVERFLOW ADDED                  IOC49640
       ACL     TEMP                TO SUM                               IOC49650
       LBT                         FOLDED 18-BIT                        IOC49660
       TRA     SUM2                CHECKSUM                             IOC49670
       ACL     1DEC                LEFT IN MQ                           IOC49680
SUM2   XCL                         CHECKSUM IN MQ S-17                  IOC49690
SUM3   AXT     **,1                                                     IOC49700
       TTR     1,1                                                      IOC49710
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    IOC49720
*                    HANDLES EOB,EOF,AND URR EXITS                      IOC49730
       SPACE   1                                                        IOC49740
EOFER  CLA     0,4                 END OF FILE                          IOC49750
       ANA     1PRE                EXIT INPUT FILE                      IOC49760
       RIL     100000              NOT OPEN                             IOC49770
       OAI                         PLACE 1ST COMMAND IN SI              IOC49780
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   IOC49790
       SXA     GTIOX,4             COMMAND                              IOC49800
       TRA     EOF.0               TAKE EOF EXIT                        IOC49810
EOFEX  LFT     LABEL               END OF FILE                          IOC49820
       TSX     LAEOF,1             LABELED FILE                         IOC49830
       LFT     MULTI               MULTI-REEL                           IOC49840
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            IOC49850
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   IOC49860
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         IOC49870
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     IOC49880
EOF.1  SXA     TCHEX,4                                                  IOC49890
       TXL     STOPD,4,0                                               $IOC49900
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             IOC49910
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     IOC49920
       LDQ     LTSX                LOAD EXIT HISTORY                    IOC49930
       RQL     18                                                      $IOC49940
       TRA     COMXIT              EXIT                                 IOC49950
SEQEX  CAL     1PRE                LOAD SEQUENCE ERROR CODE             IOC49960
       TRA     BLKEX               TAKE BLOCK ERROR EXIT                IOC49970
CKSEX  CLA     SY7.1               STORE UPDATED                        IOC49980
       STD     3,2                 BLOCK SEQ NUMBER                     IOC49990
       CAL     2PRE                LOAD CHECKSUM ERROR CODE             IOC50000
BLKEX  RNT     NORED               IF REDUNDANCY ERROR                  IOC50010
       ACL     FOR                 ALSO OCCURRED ADD REDUN BIT          IOC50020
       TRA     ERREX               TAKE ERROR EXIT                      IOC50030
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         IOC50040
ERREX  ARS     18                  CODE IN                             $IOC50050
       STT     LTSX                TAG OF HISTORY                      $IOC50060
       CLA*    2,2                 MAKE HISTORY                        $IOC50070
       STA     LTRAD               REFLECT THIS OP.                    $IOC50080
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                IOC50090
       LDC     XERR,4              ERROR EXITS                          IOC50100
       TRA     EOF.1                                                    IOC50110
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        IOC50120
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          IOC50130
       TRA     EOF.1                                                    IOC50140
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  IOC50150
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        IOC50160
       SXD     LTRAD,4             INTO HISTORY                         IOC50170
       ZET     TCHEX               HAS A TCH OCCURRED                   IOC50180
       TRA     TCHOC               YES-                                 IOC50190
       LFT     100000              NO-IS THIS OP AN IOXT                IOC50200
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            IOC50210
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          IOC50220
FEEIT  TXI     *+1,4,-1            NO-                                 $IOC50230
       CAL     -1,4                SEARCH                               IOC50240
       LGR     34                  FOR                                  IOC50250
       TZE     *+2                 EXIT                                 IOC50260
       TQP     *-4                                                      IOC50270
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  IOC50280
       TRA     *+2                                                      IOC50290
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  IOC50300
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $IOC50310
       TRA     1,1                 RETURN                               IOC50320
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       IOC50330
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  IOC50340
*                        MASTER CONTROL ROUTINE                         IOC50350
*                          FOR READ AND WRITE                           IOC50360
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   IOC50370
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         IOC50380
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            IOC50390
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              IOC50400
*              PRE TRM2 OR TRM1        TRANSMITTING                     IOC50410
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     IOC50420
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            IOC50430
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        IOC50440
*              XEC  N,4                                                 IOC50450
       SPACE   1                                                        IOC50460
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          IOC50470
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         IOC50480
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              IOC50490
       ANA     7PRE                SHOULD BE DISCONNECTED              $IOC50500
       TZE     GTIOX-1             NONE ATTACHED                        IOC50510
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   IOC50520
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     IOC50530
*                         GET NEXT IO COMMAND                           IOC50540
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          IOC50550
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              IOC50560
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        IOC50570
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  IOC50580
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             IOC50590
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    IOC50600
       SPACE   1                                                        IOC50610
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           IOC50620
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         IOC50630
       TXI     *+1,1,-1            SETUP L(NEXT)                        IOC50640
       SXA     GTIOX,1             IOXY                                 IOC50650
       CAL     -1,1                THIS IO COMMAND TO AC                IOC50660
       STA     TRANS               SAVE TRANSMIT LOC                    IOC50670
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       IOC50680
       STD     WDCT                SAVE WORD COUNT                      IOC50690
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   IOC50700
       ANA     IOOP                AND NOT DISTURBING FILE              IOC50710
       OAI                         CONDITION OR HISTORY BITS           $IOC50720
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              IOC50730
       LFT     600000              SEPARATE TCH AND IOCD                IOC50740
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  IOC50750
       LFT     100000              IOCD OR TCH COMMAND                  IOC50760
       TRA     TCH                 TCH                                  IOC50770
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  IOC50780
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     IOC50790
       TRA     RW0                 NO                                   IOC50800
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   IOC50810
       CLA*    TRANS                                                    IOC50820
       STA     TRANS                                                    IOC50830
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   IOC50840
RW0    NZT     WDCT                IF WORD COUNT IS                     IOC50850
       LNT     400000              ZERO ON IOCY OR IOSY                 IOC50860
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           IOC50870
       TRA     RW8                                                      IOC50880
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD IOC50890
       TPL     RW2                 BUFFER IS CONNECTED TO FILE          IOC50900
RW1.4  XEC     2,4                 GET NEXT BUFFER                      IOC50910
       CLA*    2,2                 PICKUP BUFFER CONTROL WORD           IOC50920
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                IOC50930
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        IOC50940
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        IOC50950
       TNZ     RW2.1               IF SOME WORDS ARE                    IOC50960
       PDX     0,1                 AVAILABLE AND COMMAND IS             IOC50970
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    IOC50980
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    IOC50990
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        IOC51000
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     IOC51010
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            IOC51020
*                       COUNT CONTROL EXECUTION                         IOC51030
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  IOC51040
       SIR     GENER               SET GENERATED DISCONNECT             IOC51050
       XEC     1,4                 DISCONNECT                           IOC51060
       RIR     GENER               RESET GENER BIT                      IOC51070
       TRA     RW1.4               AND GO ATTACH NEXT ONE               IOC51080
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              IOC51090
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   IOC51100
       TPL     RW5                 IS BUFFER OVERFLOWED                 IOC51110
       STD     DUMMY               YES- SAVE NUMBER OFF                 IOC51120
       LNT     200000              UNLESS COMMAND IS IOSY               IOC51130
       SIR     GENER               SET BIT FOR GENERATED COMMAND        IOC51140
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                IOC51150
RW4    STD     WDCT                ON THIS BUFFER                       IOC51160
       PXA     0,0                 SET ZERO REMAINING WORDS             IOC51170
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                IOC51180
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   IOC51190
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $IOC51200
       STD*    2,2                 TO ADJUST LOCATOR                    IOC51210
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   IOC51220
       RNT     200000              IF IOXYN **,,CT                      IOC51230
       TRA     RW6                 OR IOXYN* ADDR,,CT                   IOC51240
       CLA     TRANS               THEN PLACE L(WORDS)                  IOC51250
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $IOC51260
       STA     0,1                 RESPECTIVELY                         IOC51270
       SIR     XECNT               INDICATE IOXYN EXECUTED              IOC51280
RW6    LXD     WDCT,1              FORM FIRST                           IOC51290
       PXA     0,1                 TRANSMIT                             IOC51300
       ACL*    2,2                 ADDRESS                              IOC51310
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $IOC51320
       STA*    2,2                 ADJUST LOCATOR                       IOC51330
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           IOC51340
       PXA     0,1                 COMPUTE                              IOC51350
       ACL     TRANS               SECOND TRANSMIT ADDRESS              IOC51360
       STA*    4,4                 AND STORE IT                         IOC51370
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        IOC51380
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            IOC51390
       LXA     TRANS,1             TEST FIRST XMIT                      IOC51400
       TXL     *+2,1,0             ILLEGAL TO WRITE INSIDE IOCS        $IOC51410
       XEC     RW7                 FOR BOUNDS ERROR                     IOC51420
       LXA     TRM2,1              IF TRANSMIT INSIDE                   IOC51430
       TXL     *+2,1,0                                                 $IOC51440
RW7    TXL     BOUND,1,B6FIN-1     SYSTEM BOUNDRIES STOP               $IOC51450
       RFT     200000              IF NON-TRANSMITTING                  IOC51460
       TRA     RW8                 SKIP OVER MOVES                      IOC51470
       LXD     WDCT,1              WDCT TO IR1                          IOC51480
TRM1   CAL     **,1                TRANSMIT                             IOC51490
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                IOC51500
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               IOC51510
*                         TERMINATE IO COMMAND                          IOC51520
RW8    NZT     XEOB                IF USER NOT LOCATING                 IOC51530
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        IOC51540
       RNT     EOB                 IF EOB DID NOT OCCUR                 IOC51550
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   IOC51560
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       IOC51570
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            IOC51580
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       IOC51590
       TRA     RW13                YES                                  IOC51600
RW10   LNT     100000              IS COMMAND                           IOC51610
       TRA     GTIOX               IOXP OR IOXT                         IOC51620
RW12   RFT     HELD                IF A HOLD OCCURRED                   IOC51630
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      IOC51640
       RFT     RDSWIT              IF READING EXECUTE                   IOC51650
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   IOC51660
       RFT     EOBXIT              EXIT AT                              IOC51670
       TRA     EOBEX               -EOB EXIT                            IOC51680
       TRA     COMXIT              -NORMAL EXIT                         IOC51690
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) IOC51700
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       IOC51710
       TRA     RW10                -NO IT IS COMPLETE                   IOC51720
       RIR     GENER               RESET GENER BIT                      IOC51730
       LFT     200000              IF IOCY                              IOC51740
       TRA     RW14+2              NO- IOSY INTERRUPTED                 IOC51750
       RNT     200000              IF IOCYN                             IOC51760
       TRA     RW14                NO -IOC TRANSMITTING                 IOC51770
       ZET     XEOB                IF IOCYN LOCATING                    IOC51780
       TRA     RW16                TAKE EOB INTERRUPT EXIT              IOC51790
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   IOC51800
       STA     TRANS               ADDRESS                              IOC51810
       CLA     DUMMY               SET NEW                              IOC51820
       STD     WDCT                WORD COUNT                           IOC51830
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            IOC51840
RW16   CAL     2TAG                SET EOB IOCYN                       *IOC51850
       TRA     RW17+1              INTERRUPTED CODE                     IOC51860
RW17   CAL     RW13                SET END OF BUFFERS CODE             *IOC51870
       STT     LTSX                STORE CODE                          *IOC51880
       SIR     EOBXIT              SET AND TAKE                         IOC51890
       TRA     RW12                EOB EXIT                             IOC51900
       SPACE   1                                                        IOC51910
*                       BOUNDS ERROR IO COMMAND                         IOC51920
BOUND  LAC     GTIOX,1             PLACE L(IOXY) IN IR1                $IOC51930
       CAL     MESS9+4             PLACE ''WRITE''                     $IOC51940
       RFT     RDSWIT              ON IF READ                          $IOC51950
       CAL     MESS9+5             OR ''READ''                         $IOC51960
       SLW     MESS9+3             IN MESSAGE                          $IOC51970
       CAL     *+2                 PARAM TO AC                          IOC51980
       TXI     TSXR+1,1,-1         GO PRINT L(IOXY) IN IR1             $IOC51990
       MZE     MESS9,,4            ''BOUNDS ERROR READ (WRITE) *****'' $IOC52000
       EJECT                                                            IOC52010
*                  HANDLER FOR IORY AND IOSY READING                    IOC52020
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              IOC52030
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     IOC52040
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    IOC52050
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       IOC52060
       SIR     DISCN               SET COMMAND DISCONNECT               IOC52070
       TRA     RW4                 EXECUTE READ                         IOC52080
       SPACE   1                                                        IOC52090
*                  HANDLER FOR IORY AND IOSY WRITING                    IOC52100
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 IOC52110
       LNT     400000              IS IT ACTUALLY IOSY                  IOC52120
       IIR     EBDSY               NO-SET EOB DISCONNECT, TURN OFF IOSY IOC52130
       SUB     WDCT                REDUCE WORD COUNT AVAILABLE          IOC52140
       TPL     RW5                 IF ENOUGH WERE AVAIL,EXECUTE COMMAND IOC52150
       LNT     400000              NOT ENOUGH                           IOC52160
       TRA     RW3                 IORY- REDUCE CT AND EXECUTE          IOC52170
       LXD     DUMMY,1             IF SECOND ATTEMPT ON IOSY            IOC52180
       TXH     RW3,1,0             IS STILL TOO BIG, THEN REDUCE COUNT  IOC52190
       SIR     GENER               IOSY -SET GENER TO DO ON NEXT BUF    IOC52200
       CLA     WDCT                SETUP GENERATED                      IOC52210
       STD     DUMMY               COMMAND                              IOC52220
       RFT     XECNT               IF AN IOXYN WAS                      IOC52230
       SIR     EOB                 ALREADY EXECUTED SET EOB TESTS       IOC52240
       TRA     RW8                 GO RELEASE THIS BUF AND DO GENER     IOC52250
       SPACE   1                                                        IOC52260
*                         HANDLER TCH COMMAND                           IOC52270
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      IOC52280
       NZT     TCHEX               IF 1ST TCH THEN                      IOC52290
       STA     TCHEX               EXIT = L(TCH)+1                      IOC52300
       RNT     400000              IF NOT INDIRECT                      IOC52310
       TRA     GTIOX+1             TCH EXECUTED                         IOC52320
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             IOC52330
       PAC     0,1                 GO ONE MORE LEVEL AND                IOC52340
       TRA     GTIOX+1             EXIT                                 IOC52350
       SPACE   1                                                        IOC52360
*                     PRIORITY EXIT TESTS FOR READ                      IOC52370
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         IOC52380
       ANA     L(377)                                                   IOC52390
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        IOC52400
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        IOC52410
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  IOC52420
       RIL     PRIBTS              AND EXIT.                            IOC52430
       RFT     REINT               IF LAST BUF SYNCED                   IOC52440
       TRA     *+4                 GIVE FILE A KICK                     IOC52450
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    IOC52460
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         IOC52470
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  IOC52480
       TSX     BORBF,1             IF NO RUSH OCCURRED                  IOC52490
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      IOC52500
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  IOC52510
       TTL     READ SUBROUTINE - SYNCR-                                 IOC52520
*                   GETS A BUFFER FROM THE EXECUTOR                     IOC52530
*                         VIA THE SYNC ROUTINE                          IOC52540
       SPACE   1                                                        IOC52550
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   IOC52560
*              RETURN              INDEXS ARE NOT DISTRUBED             IOC52570
       SPACE   1                                                        IOC52580
SYNCR  SXA     SY8.2,4             SAVE IR4                             IOC52590
       SXA     SY8.1,1             IR1                                  IOC52600
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $IOC52610
       ENB     L(0)                TRAP PROTECT                        $IOC52620
       NZT*    4,2                 ANYTHING TO SYNC                     IOC52630
       TRA     SY10                -NO                                  IOC52640
       CLA     5,2                                                     *IOC52650
       ANA     SIX                 HYPER                               $IOC52660
       TZE     *+5                 NO                                  $IOC52670
       LDQ     1,2                 WHAT                                $IOC52680
       RQL     18                  TYPE                                $IOC52690
       TQP     *+2                 READ                                $IOC52700
       SIR     100000              HYPER READ BACKWARD                 $IOC52710
       BES     *-7+NOHYP/NOHYP*7-*                                     $IOC52720
       CLA     4,2                 SYNCED BUFFER TO                     IOC52730
       STA     2,2                 BUFFER IN USE ADDRESS                IOC52740
       CAL     1,2                 REDUCE COUNT OF                      IOC52750
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     IOC52760
       STA     1,2                                                      IOC52770
       CLA*    4,2                 UPDATE SYNC                         $IOC52780
       STA     4,2                 CHAIN CARRYING L(END)                IOC52790
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             IOC52800
       STD*    4,2                 UNLESS NO CHAIN EXISTS               IOC52810
       ENB     TRAPS               ALLOW TRAPS                          IOC52820
       LGR     33                  SET EOF AND/ OR REDUN                IOC52830
       IIA                         BITS=0 IF CONDITION OCCURRED         IOC52840
       LXD     SYNCT,1             ADVANCE COUNT                        IOC52850
       TXI     *+1,1,1             OF BUFFERS                           IOC52860
       SXD     SYNCT,1             USED THIS READ                       IOC52870
       CAL     2,2                                                      IOC52880
       ACL     L(1)                                                     IOC52890
       PAC     0,4                 IR4 = -L(IORT)                       IOC52900
       ACL     L(1)                SET LOCATOR ADDRESS                  IOC52910
       ANA     XCPTP               CLEAR PREFIX                        $IOC52920
       STO*    2,2                                                     $IOC52930
       RNT     100000              READ BACKWARD                       $IOC52940
       TRA     SY4                 NO                                  $IOC52950
       ALS     18                  FIRST DATA WORD                     $IOC52960
       ACL     0,4                 IN BUFFER                           $IOC52970
       ARS     18                  LAST DATA WORD                      $IOC52980
       PAX     0,1                 +1 OF BUFFER                        $IOC52990
       ORA     7PRE                                                    $IOC53000
       BES     *-7+NOHYP/NOHYP*7-*                                     $IOC53010
SY4    SUB     0,4                 LOCATOR - IORT                      $IOC53020
       ALS     18                  =WORD COUNT                         $IOC53030
       STD*    2,2                                                     $IOC53040
       RNT     100000                                                  $IOC53050
       TRA     SY5                                                     $IOC53060
       CAL     0,4                 STARTING DATA                       $IOC53070
       STA*    2,2                                                     $IOC53080
       PXA     0,1                 LAST LOC+1 OF                       $IOC53090
       STA     0,4                 BUFFER IN TO IORT                   $IOC53100
       BES     *-6+NOHYP/NOHYP*6-*                                     $IOC53110
SY5    RNT     NOEOF               DID EOF OCCUR                       $IOC53120
       TRA     SY11                - YES                                IOC53130
       CLA     1,2                 IF LAST BUFFER                       IOC53140
       ANA     L(377)              AHEAD IS                             IOC53150
       PAX     0,1                 SYNCED OUT                           IOC53160
       CAL     3,2                 AND NOT                              IOC53170
       PBT                         AN INTERNAL FILE                     IOC53180
       TXL     SY9,1,0             INITIATE ANOTHER                     IOC53190
SY5.6  RNT     100000                                                  $IOC53200
       ADD     1DEC                BLOCK SEQUENCE                      $IOC53210
       LNT     BLKSEQ              BLOCK SEQ CHECK                      IOC53220
       TRA     SY7.6+1             - NO                                $IOC53230
       STD     SY7.1               SAVE SEQ NUMBER FOR TEST             IOC53240
       CAL*    2,2                 REDUCE                               IOC53250
       SUB     1DEC                USABLE WORD COUNT                    IOC53260
       STD*    2,2                 BY ONE                               IOC53270
       CAL     0,4                 GET L(SEQ. WD.)                     $IOC53280
       SUB     L(1)                FOR USE SOON                        $IOC53290
       RNT     100000              BACKWARD READ                       $IOC53300
       TRA     *+3                 NO                                  $IOC53310
       LNT     LABEL                                                   $IOC53320
       TRA     SY7.1+2                                                 $IOC53330
       BES     *-4+NOHYP/NOHYP*4-*                                     $IOC53340
       STA     *+1                                                     $IOC53350
       LAC     **,1                CHECK BLOCK                         $IOC53360
SY7.1  TXI     *+1,1,**            SEQUENCE                             IOC53370
       TXH     SEQEX,1,0           ADVANCED BY ONE                      IOC53380
       LNT     CKSUMS              ARE CHECKSUMS TO BE CHECKED          IOC53390
       TRA     SY7.6               -NO                                  IOC53400
       STA     SY7.5               -YES SAVE L(BLK WORD)                IOC53410
       STA     SUM1                SET LAST CKSUM ADDRESS+1             IOC53420
       CLA*    2,2                 CHECKSUM WDCT TO AC                  IOC53430
       ACL     1DEC                DONT CHECKSUM CKSUM WD               IOC53440
       TSX     SUMMIT+1,1          FORM FOLDED CHECKSUM                 IOC53450
       SLQ     TEMP                FOR COMPARE                          IOC53460
SY7.5  CAL     **                  DOES CHECKSUM COMPUTED               IOC53470
       ANA     PDMSK               COMPARE WITH                         IOC53480
       ERA     TEMP                CHECKSUM IN BLOCK WORD               IOC53490
       TNZ     CKSEX               IF NOT TAKE CKSUM ERROR EXIT         IOC53500
SY7.6  CLA     SY7.1               SEQ NUMBER TO AC                     IOC53510
       RFT     100000                                                  $IOC53520
       SUB     1DEC                                                    $IOC53530
       RIR     100000                                                  $IOC53540
       RNT     NORED               IF URR OCCURRED                      IOC53550
       TRA     URREX               TAKE ERROR EXIT                      IOC53560
       STD     3,2                 STORE NEW SEQ. NO. IN FILE          $IOC53570
SY8.2  AXT     **,4                RESTORE IR4                          IOC53580
SY8.1  AXT     **,1                IR1                                  IOC53590
       TTR     1,1                 RETURN                               IOC53600
       SPACE   1                                                        IOC53610
*                          LAST BUFFER SYNCED                           IOC53620
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        IOC53630
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    IOC53640
       CAL     3,2                 BLK SEQ NUMBER-1 TO AC               IOC53650
       TRA     SY5.6               CONTINUE                             IOC53660
       SPACE   1                                                        IOC53670
*                  NO BUFFER AVAILABLE WHEN NEEDED                      IOC53680
       RFT     NOREOF              IF ON TRY                           $IOC53690
       TRA     SY10-4              TO GET A BUFFER                     $IOC53700
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   IOC53710
       TRA     RW17                TAKE IT , ELSE GIVE                  IOC53720
       TRA     GET4                '' ILLEGAL FILE USE '' ERROR         IOC53730
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                IOC53740
       RIR     NOREOF              SET TRIED ONCE                      $IOC53750
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       IOC53760
       TSX     BORBF,1             INITIATE READ                        IOC53770
       TRA     SY9.3-2             COULD NOT                           $IOC53780
SY10   CLA     3,2                 EOB ON INTERNAL                     $IOC53790
       TMI     EOFEX               FILE IS = END OF FILE                IOC53800
       SIL     RBITS               SET RUSH PRIORITY BITS              $IOC53810
       AXC     1,4                 IS THERE ANY REQUEST                 IOC53820
       NZT*    0,2                 TO BE SYNCED                         IOC53830
       TRA     SY10-2              -NO                                  IOC53840
       TSX     ACTV+1,4            -YES ACTIVIATE PRIORITY              IOC53850
       MZE     0,2                 THAT FILE                            IOC53860
       TRA     SY3                 CONTINUE SYNC OUT                    IOC53870
       SPACE   1                                                        IOC53880
*                             EOF ON SYNC                               IOC53890
SY11   STZ     READR2              NULLIFY READR                       *IOC53900
       TSX     DISCON,1            DISCONNECT BUFFER                    IOC53910
       LDQ     2,2                 CHECK FOR TRAILERS.                  IOC53920
       RQL     2                   ONLY SYSIN1 OR SYSIN2               $IOC53930
       TQP     EOFEX               MONITOR CONTROL OF EOF'S             IOC53940
       TSX     MONEOF,4            EXECUTE MONITOR EOF CONTROL          IOC53950
       TRA     EOFEX               AND TAKE EOF EXIT                    IOC53960
       TSX     SWITCH,1            2,4 RETURN CAUSES REEL SWITCH        IOC53970
       TRA     SYNCR+2             AND AUTOMATIC PROCEED                IOC53980
       TTL                         READ SUBROUTINE-BORBF-               IOC53990
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   IOC54000
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            IOC54010
       SPACE   1                                                        IOC54020
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  IOC54030
*              ERROR RETURN        INDEX REGISTERS ARE                  IOC54040
*              NORMAL RETURN        NOT DISTURBED                       IOC54050
       SPACE   1                                                        IOC54060
BORBF  SXA     BOR8,1              SAVE IR1                             IOC54070
       SXA     BOR2,4              SAVE IR4                             IOC54080
       LAC     LBC,4               IF NO BUFFERS                        IOC54090
       ENB     L(0)                                                    $IOC54100
       CLA*    0,4                 ARE PRESENTLY                        IOC54110
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               IOC54120
       LXA     BOR8,1              RESTORE IR1                          IOC54130
BOR2   AXT     **,4                RESTORE IR4                          IOC54140
       ENB     TRAPS                                                    IOC54150
       TRA     1,1                 AND EXIT                             IOC54160
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $IOC54170
       TXI     BOR2,1,-1           EXIT AT 2,1                          IOC54180
       STA     XERR                SAVE L(NEXT BUFFER)                 $IOC54190
       CLA     1,2                 IF INITIAL                           IOC54200
       PAX     0,4                 BUFFER DONT                          IOC54210
       TXL     *+3,4,0             ADJUST COUNTS                        IOC54220
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 IOC54230
       TRA     BOR2-1              NO BUFFER AVAILABLE                  IOC54240
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              IOC54250
       CLA     XERR                UPDATE POOL                         $IOC54260
       STA*    LBC                 BUFFER CHAIN                         IOC54270
       CAL     1,2                 UP COUNT BUFFERS                     IOC54280
       ADD     L(1)                IN USE BY                            IOC54290
       STA     1,2                 THE FILE                             IOC54300
       ENB     TRAPS               RESTORE TRAPPING                     IOC54310
       TSX     RDSEL,1             ISSUE STACKED SELECT                 IOC54320
BOR8   AXT     **,1                RESTORE IR1                          IOC54330
       TXI     BOR2,1,-1           EXIT AT 2,1                          IOC54340
       TTL                         INPUT BUFFER RELEASE ROUTINES        IOC54350
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  IOC54360
*              TSX  RELES,1        CANNOT BE USED AT TRAP               IOC54370
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     IOC54380
       SPACE   1                                                        IOC54390
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               IOC54400
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               IOC54410
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     IOC54420
       SPACE   1                                                        IOC54430
DISCON SIR     DONLY               SET DISCONNECT ONLY                  IOC54440
RELES  SIR     RDSWIT              SET RELEASE MODE                     IOC54450
       SXA     RE2,1               SAVE IR1                             IOC54460
       SXA     RE2+1,4             AND IR4                              IOC54470
RE1    CLA*    2,2                 IS A BUFFER                          IOC54480
       TPL     RE4                 CONNECTED NORMALLY                   IOC54490
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            IOC54500
       ANA     7PRE                IF BUFFER HELD                       IOC54510
       TZE     RE2                 OR NO BUFFER CONNECTED               IOC54520
       SPACE   1                                                        IOC54530
*                         RELEASE HELD BUFFERS                          IOC54540
       RNT     RDSWIT              RELEASE OR                           IOC54550
       TRA     TR1                 TRUNCATE                             IOC54560
       LAC     LBC,4                                                    IOC54570
       LDQ     2,2                 L(BUF TO MQ)                         IOC54580
       TSX     POOLRD,1            RELEASE BUFFER                       IOC54590
       RNT     DONLY               UNLESS DISCONNECT ONLY               IOC54600
       TSX     CKGIV,1             IF GIVUP ON REINITIATE               IOC54610
RE1.5  CLA     TCHAN               CHAIN HELD                           IOC54620
       STA     2,2                 BUFFERS                              IOC54630
       RNT     CPYFN               UNLESS COPYING                       IOC54640
       TRA     RE1                 RELEASE ALL HELD BUFFERS             IOC54650
RE2    AXT     **,1                RESTORE IR1                          IOC54660
       AXT     **,4                AND IR4                              IOC54670
       RNT     GENER               IF GENERATED DISCONNECT SAVE         IOC54680
       RIR     DISCN               COMMAND DISCONNECT BIT               IOC54690
       RIR     EOBITS                                                   IOC54700
       RFT     RDSWIT                                                   IOC54710
       RIR     XECNT                                                    IOC54720
       TRA     1,1                 EXIT                                 IOC54730
       SPACE   1                                                        IOC54740
*                        RELEASE BUFFER IN USE                          IOC54750
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            IOC54760
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    IOC54770
       RNT     RDSWIT              RELEASE OR                           IOC54780
       TRA     TR1.1               TRUNCATE                             IOC54790
       RNT     HOLD                IS HOLD BIT ON                       IOC54800
       TRA     RE5                 ENTER HOLD                           IOC54810
       TSX     ENTHLD,4            BUFFER INTO                          IOC54820
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          IOC54830
       TRA     RE6                 HOLD CHAIN                           IOC54840
RE5    LDQ     2,2                 L(BUF) TO MQ                         IOC54850
       LAC     LBC,4                                                    IOC54860
       TSX     POOLRD,1            BUFFER TO POOL                       IOC54870
RE6    CLA     LBC                 SET FILE TO REFER                    IOC54880
       STA     2,2                 TO POOL                              IOC54890
       RNT     DONLY               IF DISCONNECT ONLY                   IOC54900
       TSX     CKGIV,1             DONT PRIORITY INITIATE               IOC54910
       TRA     RE2                                                      IOC54920
*                  RELEASE BUFFER FROM INTERNAL FILE                    IOC54930
RE7    TSX     ENTIN,1             ENTER BUFFER INTO CHAIN              IOC54940
       ENB     TRAPS               ALLOW TRAPS                          IOC54950
       RNT     INSAT               EXIT EITHER TO                       IOC54960
       TRA     RE1.5               RELEASING HELD                       IOC54970
       TRA     RE6                 RELEASING THOSE IN USE               IOC54980
       TTL                         RELEASE INPUT BUFFER TO POOL         IOC54990
*                            IR2 = -L(FILE)                             IOC55000
*                            IR4 = -L(POOL)                             IOC55010
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        IOC55020
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        IOC55030
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               IOC55040
       SPACE   1                                                        IOC55050
TOPOOL LDI     1,2                 FILE BITS TO                         IOC55060
       RIR     77777               SI-RIGHT SIDE TO ZERO                IOC55070
TOCLOS ENB     L(0)                TRAP PROTECT                         IOC55080
       CAL     1,2                 REDUCE                               IOC55090
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     IOC55100
       STA     1,2                 USE COUNT                            IOC55110
*                      RELEASE INPUT BUF TO POOL                        IOC55120
POOLRD ENB     L(0)                TRAP PROTECT                         IOC55130
       CAL     1,2                 REDUCE CT                            IOC55140
       SUB     L(400)              OF BUFS LOGICALLY                    IOC55150
       STA     1,2                 IN USE BY FILE                       IOC55160
       RNT     RDSWIT              IS THE RELEASE MODE ON               IOC55170
       TRA     TCHAN               NO                                   IOC55180
       ZET     READR2              IS THIS READ RETENTION              *IOC55190
       TRA     PRD2+1              YES                                  IOC55200
TCHAN  XCA     **                  L(BUF) TO AC                         IOC55210
       RNT     STSH                IF STASH AND XEOB IS NOT ZERO        IOC55220
       TRA     *+4                 (SIGNIFYING RELEASE ALREADY          IOC55230
       ZET     XEOB                ACCOUNTED FOR BY TSX BCKBF,1 )       IOC55240
       TRA     PRD2+1              SKIP TO EXIT, ALL STASHES ARE        IOC55250
       TRA     PRD1                DESTRUCTIVE RELEASES FROM INPUT      IOC55260
       LDQ     3,2                 IF AN INTERNAL FILE                  IOC55270
       TQP     *+2                 GO OUT AND CHECK DESTRUCTIVE         IOC55280
       TMI     RE7                 READ MODE OR NOT                     IOC55290
PRD1   SXA     PRD2,1              SAVE IR1                             IOC55300
       RNT     CPYFN               UNLESS COPYING                       IOC55310
       TSX     BTP2,1              RELEASE BUF TO POOL                  IOC55320
       CLA     1,2                 IF LAST                              IOC55330
       PAX     0,1                 BUFFER                               IOC55340
       TXL     PRD2,1,0            IN USE THEN SKIP                     IOC55350
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 IOC55360
PRD2   AXT     **,1                RESTORE IR1                          IOC55370
       NZT     INTRAP              UNLESS AT TRAP                       IOC55380
       ENB     TRAPS               RESTORE TRAPPING                     IOC55390
       TRA     1,1                 EXIT                                 IOC55400
       TTL     PRIORITY REINITIATE AN INPUT BUFFER                      IOC55410
CKGIV  CLA     3,2                 IF AN INTERNAL FILE                  IOC55420
       TMI     1,1                 SKIP PRIORITY                        IOC55430
       CAL     1,2                 IF NO                                IOC55440
       ANA     L(377)              BUFFERS                              IOC55450
       TZE     CK2                 AHEAD                                IOC55460
       LFT     GIVUP               OR BUFFER ALREADY                    IOC55470
       TRA     CK2                 GIVEN UP REINITIATE                  IOC55480
       SIL     GIVUP                                                    IOC55490
CK1    LNT     RUSH                IF RUSH OCCURRED                     IOC55500
       TRA     1,1                 REINITIATE , ELSE EXIT               IOC55510
       RIL     RANDG               RESET RUSH AND GIVUP BITS            IOC55520
CK2    SXA     *+3,1               SAVE IR1                             IOC55530
       TSX     BORBF,1             INITIATE BUFFER                      IOC55540
       SIR     REINT               COULDN'T SET REINITIATE AT EXIT      IOC55550
       AXT     **,1                RESTORE                             $IOC55560
       TRA     CK1                 GO TEST RUSH                         IOC55570
       TTL                         WRITE SUBROUTINE-TRUNC-              IOC55580
*                      TRUNCATE AN OUTPUT BUFFER                        IOC55590
       SPACE   1                                                        IOC55600
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          IOC55610
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    IOC55620
       SPACE   1                                                        IOC55630
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    IOC55640
       TRA     RELES+1             USE RELES ROUTINE                    IOC55650
       SPACE   1                                                        IOC55660
*                        TRUNCATE HELD BUFFERS                          IOC55670
TR1    CLA*    2,2                 HOLD CODE TO AC                      IOC55680
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         IOC55690
       CLA     TCHAN               UPDATE FILE                          IOC55700
       STA     2,2                 HOLD CHAIN                           IOC55710
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        IOC55720
       SPACE   1                                                        IOC55730
*                        TRUNCATE BUFFER IN USE                         IOC55740
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $IOC55750
       TRA     TR2                 NO, WRITTEN                         $IOC55760
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $IOC55770
       TRA     TR3                                                     $IOC55780
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $IOC55790
       SXA     TR10+2,1                                                $IOC55800
       CAL     2,2                 FIND                                $IOC55810
       ACL     L(1)                L(IORT)                              IOC55820
       STA     TR5                                                      IOC55830
       CLA*    2,2                 PICK UP LOCATOR                     $IOC55840
       TMI     TR5+1               IN HOLD CHAIN                       $IOC55850
TR5    STA     **                                                       IOC55860
       CLA*    TR5                 GET LOCATOR                         $IOC55870
       STA     TR10                FOR CHECKSUMMING CALC.               IOC55880
       STA     SUM1                AND STORE                            IOC55890
       SUB     TR5                 FORM COUNT AND STORE                $IOC55900
       LNT     BLKSEQ                                                   IOC55910
       SUB     L(1)                IN IORT                              IOC55920
       ALS     18                                                       IOC55930
       STD*    TR5                                                      IOC55940
       LFT     BLKSEQ              IF ONLY ONE WORD (THE BLKSEQ WORD)   IOC55950
       SUB     1DEC                EXISTS OR IF NO DATA WORDS           IOC55960
       TNZ     TR9                 EXIST THEN                           IOC55970
       LDQ     2,2                 DONT WRITE BUFFER OUT                IOC55980
       LAC     LBC,4               L(POOL) TO IR4                       IOC55990
       CAL     1,4                 RESTORE                              IOC56000
       ARS     4                   SIZE TO                              IOC56010
       STD*    TR5                 IORT                                 IOC56020
       ENB     L(0)                TRAP PROTECT                         IOC56030
       TSX     BTP1,1              BUFFER IN POOL                       IOC56040
       CLA     3,2                 IF AN INTERNAL FILE THEN             IOC56050
       TPL     *+2                 ADJUST BUFFER COUNTS                 IOC56060
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         IOC56070
       ENB     TRAPS               ALLOW TRAPS AND EXIT SO              IOC56080
       LXA     TR10+2,1            NO WRITE                            $IOC56090
       TRA     1,1                 IS EXECUTED                         $IOC56100
TR9    LNT     CKSUMS              ARE CKSUMS DESIRED                   IOC56110
       TRA     *+3                                                      IOC56120
       TSX     SUMMIT,1            FORM AND STORE IN BLKSEQ             IOC56130
TR10   SLQ     **                  WORD THE 18 BIT                      IOC56140
       AXT     **,4                RESTORE IRS                         $IOC56150
       AXT     **,1                AND RETURN                          $IOC56160
       TRA     1,4                                                     $IOC56170
TR2    TSX     WRSEL,1             WRITE BUFFER                         IOC56180
TR3    CLA     LBC                 SET FILE REFERENCE                   IOC56190
       STA     2,2                 TO POOL                              IOC56200
       TRA     RE2                                                      IOC56210
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       IOC56220
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             IOC56230
*              TSX  GTBUF,1        IR2 =-L(FILE)                        IOC56240
*              RETURN               INDICES NOT DISTURBED               IOC56250
       SPACE   1                                                        IOC56260
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            IOC56270
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    IOC56280
*              RETURN               IR1 DESTROYED                       IOC56290
       SPACE   1                                                        IOC56300
OBTIB  SXA     GET8,4              SAVE IR4                             IOC56310
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $IOC56320
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           IOC56330
       TRA     1,4                 EXIT                                 IOC56340
       SPACE   1                                                        IOC56350
GTBUF  SXA     GET8,4              SAVE IR4                             IOC56360
       CLA     3,2                 IF AN INTERNAL FILE                  IOC56370
       TPL     GET0                CHECK TO MAKE SURE AFTER             IOC56380
       SXA     GET8+1,1            SAVING INDEX 1 ,                     IOC56390
       TSX     TOKBB,4             THAT FILE IS ALLOWED                 IOC56400
       TRA     SY9.3               TO TAKE A BUFFER , IF SO             IOC56410
       TRA     *+2                 SKIP SAVING OF IR1                   IOC56420
GET0   SXA     GET8+1,1            SAVE IR1                             IOC56430
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           IOC56440
       CLA     1,4                 NECESSARY IT WILL BE STARTED         IOC56450
       LDQ*    0,4                 WITH FIRST FILE                      IOC56460
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          IOC56470
       SPACE   1                                                        IOC56480
*                         NO BUFFER AVAILABLE                           IOC56490
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   IOC56500
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $IOC56510
       LAC     LBC,4               L(BPCW)                           (2)IOC56520
       LDQ*    0,4                                                   (2)IOC56530
       TQP     GET5                BUF AVAIL-JOIN IT                   $IOC56540
       TRA     SY9.3               NONE-TRY EOB                        $IOC56550
       STA     CPY7                SETUP SYNC SEQUENCE                  IOC56560
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           IOC56570
       CLA     0,1                 PLACE L(UCW)                         IOC56580
CPY7   PAC     **,4                IN IR4                               IOC56590
       CLA     1,4                 IF PRIORITY WORD                     IOC56600
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             IOC56610
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          IOC56620
       TSX     ACTV+1,4            ACTIVATE THIS UNIT GIVING            IOC56630
1TAG   MZE     0,1                 IT HIGH PRIORITY                     IOC56640
       LAC     LBC,4               WAIT UNTIL                           IOC56650
       CLA*    0,4                 A BUFFER PLACED IN                   IOC56660
       TPL     GET5                POOL BY TRAP                         IOC56670
       TRA     *-2                 ROUTINE                              IOC56680
       EJECT                                                            IOC56690
*                     UNIT HAS NO REQUESTS WAITING                      IOC56700
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   IOC56710
       ANA     NEOTBT              AND EOT CONDITION                    IOC56720
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             IOC56730
GET3   CLA     1,1                 ADVANCE AROUND                       IOC56740
       TRA     GET1                OUTPUT CHAIN                         IOC56750
*        ERROR-NO FILES CAN GIVUP BUFFERS - ILLEGAL FILE USE -          IOC56760
GET4   TSX     PROUT,4             AN ILLEGAL FILE USAGE SUCH           IOC56770
       PZE     1                   AS USING A TTO AS A PTO              IOC56780
       PZE     MES22,,3            WILL CAUSE THIS ERROR                IOC56790
       TSX     STOP,4                                                   IOC56800
       SPACE   1                                                        IOC56810
*                  GOT A BUFFER - READY IT FOR OUTPUT                   IOC56820
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 IOC56830
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     IOC56840
       ENB     L(0)                TRAP PROTECT                         IOC56850
       RNT     HELD                IF A HELD BUFFER                     IOC56860
       TRA     GET6                EXIST,COUNT                          IOC56870
       CLA     3,2                 SHOULD BE ADJUSTED                   IOC56880
       TMI     *+4                 ( EXCEPT INTERNAL FILES)             IOC56890
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           IOC56900
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    IOC56910
       LAC     LBC,4               L(POOL) TO IR4                       IOC56920
       CAL     7PRE                SET CODE 7                           IOC56930
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            IOC56940
GET6   CLA*    0,4                 UPDATE AVAILABLE                     IOC56950
       STA     CPY7                BUFFER CHAIN                         IOC56960
       CLA     0,4                 SET L(BUF)                           IOC56970
       STA     2,2                 INTO FILE REFERENCE                  IOC56980
       ACL     L(1)                SAVE                                 IOC56990
       STA     GET7                L(IORT)                              IOC57000
       ACL     L(1)                SET LOCATOR                          IOC57010
       STA*    2,2                 = PZE *+2,,**                        IOC57020
       CAL     CPY7                UPDATE POOL TO REFER                 IOC57030
       STA     0,4                 TO NEXT BUFFER                       IOC57040
       ENB     TRAPS               ALLOW TRAPS                          IOC57050
GET7   CLA     **                  PICKUP IORT                          IOC57060
       LFT     BLKSEQ              AND FORM                             IOC57070
       SUB     1DEC                EFFECTIVE SIZE OF BUFFER             IOC57080
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     IOC57090
GET8   AXT     **,4                RESTORE IR4                          IOC57100
       AXT     **,1                1                                    IOC57110
       RIR     FREEUP              RESET FREEUP BIT                    $IOC57120
       TRA     1,1                 EXIT                                 IOC57130
       TTL                         HOLD FUNCTION SUBROUTINES            IOC57140
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              IOC57150
       SPACE   1                                                        IOC57160
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  IOC57170
*              RETURN              IR1 DESTROYED                        IOC57180
       SPACE   1                                                        IOC57190
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      IOC57200
       LFT     OUTPUT                                                  $IOC57210
       TRA     FIX                                                     $IOC57220
       TPL     FIX                 IF REGEN INTERNAL FILE              $IOC57230
FIX1   RFT     HELD                IF ALREADY HOLDING                  $IOC57240
       TRA     EN1                 SKIP INITIALIZATION                  IOC57250
       PAX     0,1                 ENTER 1ST BUFFER                     IOC57260
       SIR     HELD                IN CHAIN                             IOC57270
       SXD     HOLDS,1             PRESET * STORE                       IOC57280
       TRA     EN1+1                                                   $IOC57290
FIX    PAC     0,1                 BCW TO IR1                          $IOC57300
       CLA*    2,2                 GET LOCATOR AND                     $IOC57310
       STA     1,1                 SAVE FOR WRITE                      $IOC57320
       CLA     2,2                 IN ITS IORT                         $IOC57330
       TRA     FIX1                PUT IN HOLD CHAIN                   $IOC57340
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                IOC57350
       STA     HOLDS               UPDATE CHAIN                         IOC57360
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $IOC57370
       STP*    HOLDS               IN BUFFER                            IOC57380
       TRA     1,4                                                     $IOC57390
       SPACE   1                                                        IOC57400
*                           SETUP HOLD CHAIN                            IOC57410
*                           IN FILE AT EXIT                             IOC57420
*                          FROM READ OR WRITE                           IOC57430
       SPACE   1                                                        IOC57440
*                           CALLING SEQUENCE                            IOC57450
       SPACE   1                                                        IOC57460
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        IOC57470
*              RETURN                                                   IOC57480
       SPACE   1                                                        IOC57490
HOOK   CLA     2,2                                                      IOC57500
       STA*    HOLDS                                                    IOC57510
       LXD     HOLDS,1                                                  IOC57520
       PXA     0,1                                                      IOC57530
       STA     2,2                                                      IOC57540
       RIR     HELD                                                     IOC57550
       TRA     1,4                                                      IOC57560
       TTL             NON-DATA SELECT CODES FOR IOEX                   IOC57570
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        IOC57580
       SPACE   1                                                        IOC57590
HFPNP  EQU     42                  FILE PROTECT                         IOC57600
HUNLP  EQU     39                  UNLOAD                               IOC57610
HSKFP  EQU     37                  SKIP FILE                            IOC57620
HSKRP  EQU     36                  SKIP RECORD                          IOC57630
HBSFP  EQU     35                  BACKSPACE FILE                       IOC57640
HBSRP  EQU     34                  BACKSPACE RECORD                     IOC57650
HWTMP  EQU     33                  WRITE TAPE MARK                      IOC57660
HERGP  EQU     32                  ERASE LONG GAP                       IOC57670
HRUNP  EQU     31                  REWIND AND UNLOAD                    IOC57680
HRWDP  EQU     30                  REWIND                               IOC57690
WEFOP  EQU     7                   WEF                                  IOC57700
BSFOP  EQU     6                   BSF                                  IOC57710
BSROP  EQU     5                   BSR                                  IOC57720
RUNOP  EQU     4                   RUN                                  IOC57730
REWOP  EQU     3                   REW                                  IOC57740
SDNHP  EQU     2                   SDNH                                 IOC57750
SDNLP  EQU     1                   SDNL                                 IOC57760
TESTP  EQU     0                   TEST OP                              IOC57770
       SPACE   2                                                       $IOC57780
*              THESE ARE USED IN THE SELECT ENTRY IF NO 7909 CHANNEL    IOC57790
       SPACE   1                                                       $IOC57800
X09CH  EQU     NOCH/NOCH+NOHYP/NOHYP                                   $IOC57810
NOCHX  EQU     X09CH/X09CH                                             $IOC57820
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         IOC57830
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 IOC57840
*      TSX  WRSEL,1                          2,2 (21-35)                IOC57850
*         TSX    WRSLH,1         WRITE HELD BUFFER                      IOC57860
*                                  IR4 IS DESTROYED                     IOC57870
       SPACE   1                                                        IOC57880
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $IOC57890
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      IOC57900
SEL4   PZE     **,,ISSUE           SELECT WORD                          IOC57910
WRSEL  CLA     3,2                 HANDLE INTERNAL FILE                 IOC57920
       TMI     SEL5.8              SEPARATELY                           IOC57930
       TSX     SETWR,4             SET UP TO WRITE                     $IOC57940
       LDQ     2,2                 L(BUF) TO MQ                         IOC57950
RDSEL  XCA                                                              IOC57960
       STA     SEL4                L(BUF) TO SEL4                       IOC57970
       LDQ     L(0)D               SET BUFFER                           IOC57980
       LGL     18                  1ST WD =                             IOC57990
       SLW*    SEL4                PZE L(0),,*                          IOC58000
SEL0   AXC     1,4                                                      IOC58010
       ENB     L(0)                                                     IOC58020
       CLA*    0,2                 CHECK FILE ALREADY                   IOC58030
       TZE     SEL3                ACTIVE                               IOC58040
       STA     SEL1                YES                                  IOC58050
       CAL     FCW                                                     $IOC58060
       AXT     0,4                                                     $IOC58070
       ERA*    0,2                 IS THIS THE SAME FILE               $IOC58080
       ANA     ADDRS                                                   $IOC58090
       TZE     SEL1                YES                                 $IOC58100
       TSX   (ACTVX,4              NO                                  $IOC58110
       MZE     0,2                                                     $IOC58120
       TRA     SEL0                                                    $IOC58130
SEL1   CLA     **                  ADD NEW                              IOC58140
       PDC     0,4                 BUFFER TO END                        IOC58150
       CLA     SEL4                OF EXISTING                          IOC58160
       STA     0,4                 BUFFER CHAIN                         IOC58170
       ALS     18                  SET L(NEW BUF) INTO                  IOC58180
       STD*    SEL1                DECREMENT 1ST ENTRY                  IOC58190
       ENB     TRAPS               ALLOW TRAPS                          IOC58200
       TRA     1,1                 EXIT                                 IOC58210
       SPACE   1                                                        IOC58220
*                         ENTER INITIAL SELECT                          IOC58230
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    IOC58240
       TRA     SEL6                GO HANDLE IT SPECIAL                 IOC58250
       AXT     0,4                 CHECK FOR                            IOC58260
       CLA*    0,2                 ENTERING INITIAL SELECT ON           IOC58270
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         IOC58280
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         IOC58290
       LGL     18                  HAS ENCOUNTERED EOT                  IOC58300
       STA     CPY7                IF SO THEN HANDLE                    IOC58310
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        IOC58320
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   IOC58330
       TSX     EOTOF,1                                                  IOC58340
       TSX     CPY6,4                                                   IOC58350
SEL2.4 AXT     **,1                RESTORE IR1                          IOC58360
SEL2.5 STI     TEMIND                                                  $IOC58370
       AXT     0,4                 GET FILE BLOCK ADDRESS              $IOC58380
       CAL     FCW                 AND STORE IN UCW ONE                $IOC58390
       STA*    0,2                                                     $IOC58400
       LDI*    0,2                 UCW 1                               $IOC58410
       LFT     20000               1301                                $IOC58420
       TRA     SEL2.6              MAYBE                               $IOC58430
SEL2.7 CAL     SEL4                NO                                  $IOC58440
       AXC     1,4                                                     $IOC58450
       LDI     TEMIND                                                  $IOC58460
       LFT     OUTPUT              OUTPUT                              $IOC58470
       ORA     FOR                 YES-SET BIT                         $IOC58480
       SLW*    0,2                 STORE ISSUE IN UCW 2                $IOC58490
       TSX     ACTV+1,4            ACTIVATE                             IOC58500
       PZE     0,2                 THIS FILE                            IOC58510
       TRA     1,1                                                      IOC58520
SEL2.6 LNT     100                 1301                                $IOC58530
       TRA     SEL8           NO                                       $IOC58540
       SXA     SEL2.8+1,1          YES                                 $IOC58550
       CLA     0,2                 PUT -L(UCB) IN IR4                  $IOC58560
       PAC     0,4                                                     $IOC58570
       LDQ     6,2                 CHECK IF EOF ON DISK                $IOC58580
       TQP     SEL2.8              NO                                  $IOC58590
       ARS     18                  PUT CORRECT SEEK                    $IOC58600
       STA     6,2                 IN WORD SEVEN                       $IOC58610
       STP     6,2                 AND TURN OFF EOF BIT                $IOC58620
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $IOC58630
       AXT     **,1                                                    $IOC58640
       TRA     SEL2.7         RETURN                                   $IOC58650
       TXI     *+1,1,-RELASE       IS THIS A RELEASE ENTRY             $IOC58660
       TXL     GO,1,0              YES GO THERE                        $IOC58670
ENDTRK TSX     PROUT,4             PRINT OUT NOTICE                    $IOC58680
       PZE     2                   TO OPERATOR                         $IOC58690
       MZE     9,2,3                                                   *IOC58700
       PZE     MESS2,,3       AND STOP                                 $IOC58710
       LDI     1,2            RESTORE IND                              $IOC58720
       RIR     77777                                                   $IOC58730
       PXA     0,0                                                     $IOC58740
       STT     6,2                                                     $IOC58750
       TRA     BOFEX                                                   $IOC58760
       BES     SEL2.6+NOCH/NOCH**-NOCH/NOCH*SEL2.6-*                   $IOC58770
SEL8   PXD     0,0                                                     $IOC58780
       LDI     1,2                                                     $IOC58790
       RFT     400000              IS THIS READ BACKWARD               $IOC58800
       CLA     SIX                 YES, SET BACKWARD READ MODE         $IOC58810
       ACL     SEL4                YES                                 $IOC58820
       AXC     3,4                 STORE ZERO                          $IOC58830
       STZ*    0,2                 IN UCW 4                            $IOC58840
       TRA     SEL2.7+1                                                $IOC58850
       BES     *-8+NOHYP/NOHYP*8-*                                     $IOC58860
TEMIND PZE                                                              IOC58870
       TTL 0                                                            IOC58880
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         IOC58890
SEL5   CLA     3,2                 IF AN INTERNAL FILE                  IOC58900
       TMI     SEL5.8              HANDLE IT SEPARATELY                 IOC58910
       SXA     SEL5.6,1            SAVE IR1                             IOC58920
       ENB     L(0)                DISABLE TRAPS                        IOC58930
       TSX     BCKBB,1                                                  IOC58940
SEL5.6 AXT     **,1                RESTORE IR1                          IOC58950
       TRA     WRSEL+2             RETURN TO WRITE                      IOC58960
*                      WRITE INTERNAL FILE BUFFER                       IOC58970
SEL5.8 TSX     SETWR,4             SET UP TO WRITE                     $IOC58980
       SXA     SEL5.6,1            SAVE IR1                            $IOC58990
       CLA     2,2                 L(BUF)                               IOC59000
       PAC     0,1                 TO IR1                               IOC59010
       LAC     LBC,4               RESTORE SIZE TO                      IOC59020
       CAL     1,4                 IORT                                $IOC59030
       ARS     4                                                        IOC59040
       STD     1,1                                                      IOC59050
       CLA     2,2                 SET THIS BUFFER                      IOC59060
SEL5.9 TSX     ENTIN,1             INTO RE-GENERATIVE CHAIN             IOC59070
       CAL     3,2                 ADVANCE BLOCK SEQ                    IOC59080
       ACL     1DEC                                                     IOC59090
       STD     3,2                                                      IOC59100
       LXA     SEL5.6,1            RESTORE IR1                          IOC59110
       TRA     1,1                 EXIT                                 IOC59120
       SPACE   1                                                        IOC59130
*                        EOF OR EOT ENCOUNTERED                         IOC59140
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            IOC59150
       TRA     SEL7-1                                                   IOC59160
       LDQ     SEL4                RELEASE BUFFER                       IOC59170
       LAC     LBC,4               -L(POOL) TO IR4                      IOC59180
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  IOC59190
       SPACE   1                                                        IOC59200
*                             EOT OCCURRED                              IOC59210
       SXA     *+2,1               SAVE IR1                             IOC59220
SEL7   TSX     EOTOF,1             HANDLE EOT                           IOC59230
       AXT     **,1                RESTORE IR1                          IOC59240
       TRA     SEL0                AND CONTINUE                         IOC59250
       TTL                         DENSITY SETTING ROUTINE              IOC59260
*                             TSX DENSE,4                               IOC59270
       SPACE   1                                                        IOC59280
DENSE  CLA     1,2                 PLACE FILE                           IOC59290
       ANA     1TAG                DENSITY BIT                          IOC59300
       ALS     3                   IN DECREMENT                         IOC59310
       ACL     1DEC                ADD 1 TO FORM                        IOC59320
       STD     *+3                 LOW DEN. = 1                         IOC59330
       SXA     *+3,4               HI DEN. = 2                          IOC59340
       TSX     NDSEL+1,4           SET DENSITY                         $IOC59350
       PZE     0,2,**                                                   IOC59360
       AXT     **,4                RESTORE IR4                          IOC59370
       TRA     1,4                 EXIT                                 IOC59380
       TTL                         UNBUFFER INPUT FILE                  IOC59390
*    TSX  UNBFI,4           DESTROYS IR1                                IOC59400
       SPACE   1                                                        IOC59410
UNBFI  SXA     UB7,4               SAVE IR4                             IOC59420
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       IOC59430
UB1    ENB     L(0)                TRAP PROTECT                         IOC59440
       AXC     1,4                 IF NO BUFS IN REQ                    IOC59450
       CLA*    0,2                 CHAIN THEN GO RELEASE                IOC59460
       TZE     UB4                 SYNC CHAIN                           IOC59470
UB1.1  AXC     0,4                                                     $IOC59480
       LDQ*    0,2                 CHECK FOR DISK                      $IOC59490
       RQL     4                                                       $IOC59500
       TQP     *+2                                                     $IOC59510
       TRA     UB3                 DISK, GO TO UB3                     $IOC59520
       BES     UB1.1+NOCH/NOCH*5-*                                     $IOC59530
       STA     UB2                 SAVE L(1ST REQ)                      IOC59540
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       IOC59550
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         IOC59560
       TRA     UB3                 HOOKING REMAINDER OF REQ             IOC59570
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       IOC59580
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         IOC59590
       XCA                         ITS COMPLETION                       IOC59600
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    IOC59610
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           IOC59620
       LDQ     4,2                 ADD 2ND ON REQS                      IOC59630
       STA     4,2                 TO SYNC CHAIN                        IOC59640
       PDC     0,1                                                      IOC59650
       XCA                                                              IOC59660
       STA     0,1                                                      IOC59670
       CLA*    0,1                                                      IOC59680
       STD*    4,2                                                      IOC59690
UB3    TSX     ACTV+1,4            WHICH AT TRAP WILL                   IOC59700
       MZE     0,2                 BE ENTERED INTO                      IOC59710
       AXC     1,4                 SYNC CHAIN                           IOC59720
       ZET*    0,2                 WAIT                                 IOC59730
       TRA     *-1                                                      IOC59740
       SPACE   1                                                        IOC59750
*                      ALL BUFFERS IN SYNC CHAIN                        IOC59760
UB4    SXD     SYNCT,0             PRESET SYNC CT                       IOC59770
       STZ     TEMP                SET EOF DELETE SWITCH =0             IOC59780
UB4.1  CLA*    4,2                 PLACE BUFFERS                        IOC59790
       TZE     UB6                 FROM SYNC CHAIN                      IOC59800
       TPL     *+4                 TO POOL ,+ BUFFERS                   IOC59810
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          IOC59820
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 IOC59830
       SXD     SYNCT,1             NECESSARY TO REPOSITION              IOC59840
       LDQ     4,2                 TO POOL                              IOC59850
       STA     4,2                                                      IOC59860
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           IOC59870
       TZE     UB4.2               WITH THIS BUFFER                     IOC59880
       XCA                         YES- SO PICKUP                       IOC59890
       PAC     0,1                 THE TAPE POSITION                    IOC59900
       XCA                         AND SAVE FOR AFTER BSR               IOC59910
       CLA     2,1                 ACROSS EOF MARK                      IOC59920
       STO     TEMP                                                     IOC59930
UB4.2  LAC     LBC,4                                                    IOC59940
       TSX     TOCLOS,1                                                 IOC59950
       TRA     UB4.1                                                    IOC59960
       SPACE   1                                                        IOC59970
*                         FORM NEW SYNC CHAIN                           IOC59980
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  IOC59990
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $IOC60000
       TRA     UB3                 AND CONTINUE                         IOC60010
       SPACE   1                                                        IOC60020
*                            EXIT SEQUENCE                              IOC60030
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              IOC60040
       TXL     UB7,1,0             SETUP AND BACKSPACE                  IOC60050
       LDQ     5,2                                                     $IOC60060
       RQL     1                   HYPER                               $IOC60070
       TQP     *+7                 NO                                  $IOC60080
       LDQ     1,2                                                     $IOC60090
       RQL     18                  READ BACKWARD                       $IOC60100
       TQP     *+4                 NO                                  $IOC60110
       TSX     (NDSLX,4                                                $IOC60120
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $IOC60130
       TRA     UB6.3-1                                                 $IOC60140
       BES     *-9+NOHYP/NOHYP*9-*                                     $IOC60150
       TSX     NDSEL+1,4                                                IOC60160
       PZE     0,2,BSROP                                                IOC60170
       NZT     TEMP                IF BSR ACROSS EOF MARK               IOC60180
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $IOC60190
       CLA     5,2                                                   (3)IOC60191
       TMI     UB7-2                                                 (3)IOC60192
       CLA     TEMP                AND CONTINUE                         IOC60200
       AXC     2,4                                                      IOC60210
       STO*    0,2                                                      IOC60220
       STZ     TEMP                                                     IOC60230
       SIL     NINHIB              UN-INHIBIT FILE                      IOC60240
       TRA     UB6.3                                                    IOC60250
UB7    AXT     **,4                RESTORE IR4                          IOC60260
       TRA     1,4                 EXIT                                 IOC60270
       TTL     UNBUFFER OUTPUT FILE                                     IOC60280
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   IOC60290
*    TSX  UNBFO,4     DESTROYS IR1                                      IOC60300
       SPACE   1                                                        IOC60310
UNBFO  SXA     UNBO,4              SAVE IR4                             IOC60320
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         IOC60330
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 IOC60340
       NZT*    0,2                 TO DO GIVE IT                        IOC60350
       TRA     UNBO                PRIORITY AND WAIT.....               IOC60360
       TSX     ACTV+1,4            FOR ALL REQUESTS TO GET DONE         IOC60370
       MZE     0,2                                                      IOC60380
       TRA     UNBF1                                                    IOC60390
UNBO   AXT     **,4                                                     IOC60400
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        IOC60410
       TRA     1,4                 ELSE EXIT                            IOC60420
       TSX     EOTOF,1                                                  IOC60430
       TRA     UNBO-3                                                   IOC60440
       TTL                         IOCS SELECT ROUTINES                 IOC60450
*             (INITIATE A SELECT AND POST ITS COMPLETION)               IOC60460
       SPACE   1                                                        IOC60470
CHATY  PZE                         UNIT AND CHANNEL TYPE               $IOC60480
ISSUE  SXA     S3,4                SAVE IR4                             IOC60490
       SXA     S3+1,1              SAVE IR1                             IOC60500
       PAC     0,4                 -L(UCW) TO IR4                       IOC60510
       XCA                         SAVE + OR - ENTRY                    IOC60520
CHATT  CLA     0,4                 SET UP AND                          $IOC60530
       ANA     BVDG                TEST FOR UNIT                       $IOC60540
       PDX     0,2                 AND CHANNEL TYPE                    $IOC60550
       TXL     *+3,2,8191          7909 OR 7607                        $IOC60560
       TXL     *+3,2,8192          HYPER                               $IOC60570
       TXI     *+2,2,1             DISK                                $IOC60580
       AXT     0,2                 IF 7607'''ZERO IR2                  $IOC60590
       SXA     CHATY,2             SAVE INDICATION                     $IOC60600
       BES     CHATT+NOCHX/NOCHX**-NOCHX/NOCHX*CHATT-*                 $IOC60610
       CLA     0,4                 0=7607, 20101=DISK, 20000=HYPER     $IOC60620
       PAC     0,2                 L(FILE) TO IR2                      $IOC60630
       TQP     SELP                SEPARATE SEL+ ENTRY                 $IOC60640
       CLA     CHATY               CHANNEL TYPE                        $IOC60650
       TNZ     MSEL-2              79O9 CHANNEL                        $IOC60660
*                  SELECT (-) ENTRY = POST COMPLETION                   IOC60670
       LFT     400000              IF SHORT RECORD                      IOC60680
       TRA     MXMDT               INDICATION IS ON                     IOC60690
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 IOC60700
       SUB     L(1)                THEN SETUP TO EXIT                   IOC60710
       STA     S3                  AT 2,4                               IOC60720
       CLA     1,4                 IF READING                           IOC60730
       TPL     S3                  DISCARD NOISE RECORD                 IOC60740
MXMDT  CLA     1,2                 IF MIXED MODE                        IOC60750
       TMI     MXMOD               PERFORM EXTRA CALCULATIONS           IOC60760
SELM1  CLA*    (URRXI              IF ANY TAPE                          IOC60770
       TZE     *+3                 ERRORS OCCURRED                      IOC60780
       ACL     5,2                 ADJUST ERROR                         IOC60790
       SLW     5,2                 COUNTS                               IOC60800
       TSX     URC1,1              UPDATE REQUEST CHAIN                 IOC60810
       NZT     CHATY                                                   $IOC60820
       TRA     HSEL1               729 OR CARD UNIT                    $IOC60830
       CLA     1,4                                                     $IOC60840
       TZE     *+4                 NO REQUEST CHAIN                    $IOC60850
       PXD     0,0                 PREFIX FOR REINSTRUCT               $IOC60860
       LNT     200000              OR IF EOF                           $IOC60870
       TRA     HSEL1                                                   $IOC60880
       STA     0,4                 ZERO FCB FROM UCW1                  $IOC60890
       CAL     S3                  RESTORE                             $IOC60900
       ADD     L(1)                ADDRESS                             $IOC60910
       STA     S3                  FOR RETURN                          $IOC60920
       BES     *-11+NOHYP/NOHYP*11-*                                   $IOC60930
HSEL1  LDC     COMM,1              RESTORE TO                          $IOC60940
       TQP     POSTR               IF MQ + READ IS DONE                 IOC60950
       SPACE   1                                                        IOC60960
*                        POST WRITE COMPLETION                          IOC60970
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $IOC60980
       PDC     0,4                                                      IOC60990
       CAL     1,4                 RESTORE BUFFER                       IOC61000
       ARS     4                   SIZE TO IORT                         IOC61010
       STD     -1,1                TO IORT                              IOC61020
       TSX     BTP1,1              PLACE BUF IN POOL                    IOC61030
       LNT     200000              DID EOT OCCUR                        IOC61040
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         IOC61050
*                        EOT HANDLE TRAP WRITE                          IOC61060
       AXC     1,4                                                      IOC61070
       CLA*    0,2                                                      IOC61080
       TZE     *+2                                                      IOC61090
       STA     4,2                                                      IOC61100
       CAL     EOTBT                                                   $IOC61110
*                         INHIBIT BITS TO FILE                          IOC61120
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $IOC61130
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $IOC61140
       LXA     FCW,1                                                   $IOC61150
INEX2  TXI     *+1,1,**                                                 IOC61160
       TXH     INEX4,1,0                                                IOC61170
       ANS     (IOXSI                                                   IOC61180
INEX4  ANS     1,2                                                      IOC61190
       TRA     S3                                                       IOC61200
       SPACE   1                                                        IOC61210
*                         POST READ COMPLETION                          IOC61220
POSTR  CAL     COMM                                                     IOC61230
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $IOC61240
       PIA                                                              IOC61250
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $IOC61260
       CLA*    4,2                 DOES SYNC CHAIN EXIST                IOC61270
       TZE     PSTR8               NO                                   IOC61280
       PDC     0,1                 SAVE L(END)                          IOC61290
       XCA                         L(BUF) TO AC                         IOC61300
       STA     0,1                 UPDATE                               IOC61310
       LDQ     L(0)D               SYNC CHAIN                           IOC61320
       LGL     18                                                       IOC61330
       STA*    0,1                                                     $IOC61340
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $IOC61350
       LNT     200000         IF NO EOF                                $IOC61360
       TRA     S3                  THEN EXIT                            IOC61370
       SPACE   1                                                        IOC61380
*                        EOF HANDLER TRAP INPUT                         IOC61390
       SXA     PSTR5,4             SAVE L(UCW)                          IOC61400
       LXA     CHATY,1                                                 $IOC61410
       TXH     DEOF1,1,8192                                            $IOC61420
       LDQ     LTPOS               SAVE TAPE POSITION                   IOC61430
       STQ*    COMM                JUST PRIOR TO EOF MARK               IOC61440
PSTR4  NZT     1,4                 IF LAST BUFFER                       IOC61450
       TRA     PSTR6               DO NOTHING                           IOC61460
PSTR2  TSX     URC1,1              DELETE AHEAD                        $IOC61470
       CLA     4,2                 L(POOL) TO IR4                       IOC61480
       PDC     0,4                                                      IOC61490
       TSX     TOPOOL,1            BUFFERS                              IOC61500
PSTR5  AXT     **,4                RESTORE L(UCW)                       IOC61510
       TRA     PSTR4               DELETE ALL                           IOC61520
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              IOC61530
       CAL     NOTIN               WD UCW AND                          $IOC61540
       TRA     INEX                GO INHIBIT FILE                      IOC61550
       SPACE   1                                                        IOC61560
*                           START SYNC CHAIN                            IOC61570
PSTR8  XCA                         PUT BUF READ IN AC                  $IOC61580
       STA     4,2                                                      IOC61590
       LDQ     L(0)D                                                    IOC61600
       LGL     18                                                       IOC61610
       STA*    4,2                 L(1) IN BUF CW                      $IOC61620
       TRA     PSTR3                                                    IOC61630
       TTL     SELECT (+) ENTRY                                         IOC61640
*                      SIGN OF UCW WD2 0-RD 1-WR                        IOC61650
*                        INSERTS *+1 INTO IORT                          IOC61660
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   IOC61670
*                   AND INCREMENTS IT IN FILE WORDS                     IOC61680
       SPACE   1                                                        IOC61690
SELP   LDI     1,2                 FILE BITS TO SI                      IOC61700
       CLA     CHATY                                                   $IOC61710
       LBT                         UNIT TYPE TEST                      $IOC61720
       TNZ     HYPL                HYPER                               $IOC61730
       TNZ     DRWRS               DISK                                $IOC61740
       LFT     MXDMD               IF MIXED MODE                       $IOC61750
       TRA     MXMP                SKIP OUT                             IOC61760
       CLA     1,4                 GET ADDRESS OF                       IOC61770
       ACL     L(1)                THE IORT TO BE USED                  IOC61780
       STA*    (RCHXI                                                   IOC61790
       STA     S1+3                                                    $IOC61800
       TPL     S1             THIS IS READ                             $IOC61810
S4     ZET*    (URRXI              ERROR ON THIS BLOCK                 $IOC61820
       TRA     S1                  YES START ACTIVITY                   IOC61830
       STA     S0                  NO                                   IOC61840
       XCA                         SAVE ADDRESS OF IORT                $IOC61850
       CLA     3,2                 GET BLOCK SEQ                        IOC61860
       ACL     1DEC                UP BY ONE                            IOC61870
       STD     3,2                                                      IOC61880
       LNT     BLKSEQ              CHECK FOR BLOCK SEQING               IOC61890
       TRA     S1-1                NO                                   IOC61900
       ARS     18                  YES                                  IOC61910
S0     STA*    **                  STORE BLOCK SEQ IN LAST WORD OF BUFF IOC61920
       XCA                         ADDRESS OF IORT IN MQ                IOC61930
S1     ACL     L(1)                                                     IOC61940
       ZET     CHATY                                                   $IOC61950
       TRA     HYSA                                                    $IOC61960
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      IOC61970
       CLA     1,2                 FORM SELECT                          IOC61980
       ANA     MODBT               INSERTING TAPE MODE BIT              IOC61990
       ARS     7                                                        IOC62000
       ORA     0,4                                                      IOC62010
RWRS   ARS     18                                                       IOC62020
       STA     SELCT               UNIT ADDRESS TO SELECT               IOC62030
       CLA     S2                                                       IOC62040
       LDQ     1,4                                                      IOC62050
       TQP     *+2                 RDS IN SELECT                        IOC62060
       ALS     15                  WRS IN SELECT                        IOC62070
       STD     SELCT                                                    IOC62080
SELCT  RDS     **                  SEL                                  IOC62090
       XEC*    (RCHXI              RCHX                                 IOC62100
S3     AXT     **,4                                                     IOC62110
       AXT     **,1                                                     IOC62120
       TRA     1,4                 RETURN TO IOEX                       IOC62130
S2     OCT     076200766000        RDS...WRS                            IOC62140
       TTL     7909 CHANNEL SELECT ROUTINES                             IOC62150
       LBT                         DISK                                $IOC62160
       TRA     HSELM               NO                                  $IOC62170
MSEL   LFT     7100                TEST UNUSUAL END                    $IOC62180
       TRA     DERR+1                                                  $IOC62190
       LDI     0,2                                                     $IOC62200
       CLA*    1,4            GET FLAG WORD USED                       $IOC62210
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $IOC62220
       ADD     L(1)           FOR THIS OPERATION                       $IOC62230
       STA     *+3                                                     $IOC62240
       LFT     200000              EOF FROM LAST READ                  $IOC62250
       TRA     SEOFI               YES                                 $IOC62260
       LDI     **             PUT FLAG WORD IN INDICATORS              $IOC62270
       LNT     400000              IS RECORD COMPLETE                  $IOC62280
       TRA     FINREC         NO-FINISH RECORD                         $IOC62290
       LFT     200000         EOF OCCUR                                $IOC62300
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $IOC62310
       LDI     FOR            SET INDICATORS AS 7607                   $IOC62320
SELM2  CLA     1,2                 IF MIXED MODE                       $IOC62330
       TMI     1KA                 PERFORM EXTRA CALC.                 $IOC62340
       CLA*    (URRXI              IF ERRORS ADJUST                    $IOC62350
       TZE     *+3            ERROR COUNTS IN FCB                      $IOC62360
       ACL     5,2                                                     $IOC62370
       SLW     5,2                                                     $IOC62380
       CAL     1,4                                                     $IOC62390
       SUB     L(1)                                                    $IOC62400
       SXA     *+3,4          SAVE IR4                                 $IOC62410
       PAC     0,4            IR4=-L(COMM-1)                           $IOC62420
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $IOC62430
SELM5  AXT     **,4                RESTORE IR4                         $IOC62440
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $IOC62450
       CLA     1,4                 PUT ADDRESS OF                      $IOC62460
       PAC     0,1                 COMD CHAIN IN IR 1                  $IOC62470
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $IOC62480
       STZ     1,1                 ZERO OUT COUNT SAVED                $IOC62490
       CAL     8,1                                                     $IOC62500
       ACL     L(1)                                                    $IOC62510
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $IOC62520
       CAL     FCW                 RESTORE IORT                        $IOC62530
       STP     -1,1                IN BUFFER                           $IOC62540
       LDQ     1,4                                                     $IOC62550
       NZT*    1,4                 IF ZERO-ZERO OUT                    $IOC62560
       TRA     *+4                 AND KILL SEEK                       $IOC62570
       LFT     200000              IF EOF                              $IOC62580
       TRA     *+3                 KILL SEEK OR                        $IOC62590
       TRA     *+4                 ELSE PROCEED                        $IOC62600
       STZ     1,4                                                     $IOC62610
       CAL     2,4                                                     $IOC62620
       STO     2,4                                                     $IOC62630
       TQP     SELM4               IF MQ + READ IS DONE                $IOC62640
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $IOC62650
       TRA     SELM3               GO POST WRITE COMPLETION            $IOC62660
SELM4  CAL     *+1                                                     $IOC62670
       XCA     **                  MQ = ADDRESS OF BUF CW              $IOC62680
       SXA     C8,1                                                    $IOC62690
       CAL     -1,1                PICK UP COUNT FROM FLAG             $IOC62700
 ER    AXT     **,1                                                    $IOC62710
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $IOC62720
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $IOC62730
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $IOC62740
       LFT     200000              IF EOF GO                           $IOC62750
       TSX     EOF,4               TAKE CARE OF IT                     $IOC62760
       CLA     4,2                 PICK UP AND                         $IOC62770
       PDC     0,4                 RESTORE THE                         $IOC62780
       CAL     1,4                 BUFFER SIZE                         $IOC62790
       ARS     4                   IN THE IORT                         $IOC62800
       STD     -1,1                NOW GO POST                         $IOC62810
       XEC     SELM5               READ COMPLETION                     $IOC62820
       TRA     POSTR+2             SOME JOB                            $IOC62830
EOF    ENB     L(0)                                                    $IOC62840
       LDQ     0,2                 EXCHANGE START AND                  $IOC62850
       CAL     6,2                 FINISH OF FILE                      $IOC62860
       LGL     18                  PUT A MINUS                         $IOC62870
       STD     0,2                 IN WORD SEVEN                       $IOC62880
       STA     6,2                 TO INDICATE SPECIAL                 $IOC62890
       CLS     6,2                 HANDLING NEEDED                     $IOC62900
       STO     6,2                 FOR NEXT DATA OPER.                 $IOC62910
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $IOC62920
       TRA     1,4                 GO HOME                             $IOC62930
DEOF1  NZT     1,4            IF LAST BUFFER                           $IOC62940
       TRA     PSTR6          DO NOTHING                               $IOC62950
       CAL*    1,4                 DISK OPERATIONS                     $IOC62960
       STZ*    1,4                 ARE DONE FOR NOW                    $IOC62970
       STA     1,4                 RESTORE REQUEST CHAIN               $IOC62980
       TRA     PSTR2               AS TAPE (UCB2)                      $IOC62990
FINREC LFT     200000              IOCS EOF                            $IOC63000
       TRA     DEOF                YES                                 $IOC63010
       CLA     1,4                                                     $IOC63020
       PAC     0,1            -L(COMMANDS)IN IR1                       $IOC63030
       CLA     L(STL               IF READ HAS FILLED                  $IOC63040
       ERA     1,1                 BUFFER AREA,GO BACK                 $IOC63050
       TNZ     *+3                 AS FINISHED RECORD                  $IOC63060
       LXA     S3+1,1                                                  $IOC63070
       TRA     SEOF+1                                                  $IOC63080
       CLA     1,1            PICK UP AND COUNT                        $IOC63090
       SXA     *+2,2                                                   $IOC63100
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $IOC63110
D7     AXT     **,2                RESTORE IR2                         $IOC63120
       CLA     1,4            READ OR WRITE                            $IOC63130
       TPL     D4                  READ                                $IOC63140
       CAL     6,2                 UPDATE NEXT TRACK                   $IOC63150
       ACL     L(2)                TO BE USED BY FILE                  $IOC63160
       ALS     18                  STORE IN FLAG WORD                  $IOC63170
       STD*    8,1                                                     $IOC63180
 D4    CAL     9,1                 PUT THE NEXT READ                    IOC63190
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (4)IOC63200
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (4)IOC63201
       LXA     D7,2         RESTORE IR2                              (4)IOC63202
       STA     9,1            COMMAND                                  $IOC63210
       SXA     *+2,1                                                   $IOC63220
       TSX     CKSEE,1        IS SEEK NECESSARY                        $IOC63230
       AXT     **,1           RESTORE IR1                              $IOC63240
       CLA     6,2            CREATE BCD CHARACTERS                    $IOC63250
       SXA     *+2,4          FOR THE NEXT PREPARE                     $IOC63260
       TSX     (DECVA,4       TO VERIFY COMMAND                        $IOC63270
       AXT     **,4                                                    $IOC63280
       CLA     6,2            GET REC LAB                              $IOC63290
       ADD     TRKC                UP TRACK COUNT                      $IOC63300
       SLW     6,2                 FOR RECORD                          $IOC63310
       ARS     6                   AND PUT IN                          $IOC63320
       STO     *+2            P.V. WORD                                $IOC63330
       TSX     (FDAMT,2                                                $IOC63340
       PZE                                                             $IOC63350
       PZE     15,1                                                    $IOC63360
       XEC     D7                                                      $IOC63370
       TSX     WCHK,4                                                  $IOC63380
       TRA     S3             RETURN TO IOEX                           $IOC63390
DERR   PZE     0                   FLAG FOR ERROR IN HA2, FORMAT, ETC. $IOC63400
       LNT     100                 INTERFACE CHECK                     $IOC63410
       TRA     *+4                 NO                                  $IOC63420
       AXC     *+1,4               SET SWITCH FOR SEL+                 $IOC63430
       SXA     CHATT-1,4           RETURN 2,4                          $IOC63440
       TRA     DCHG                                                    $IOC63450
       CLA     1,4                 GET COMMAND LIST ADDRESS            $IOC63460
       PAC     0,1                 FOR STZ OPERATION                   $IOC63470
       STO     DERR                SET UNUSUAL END FLAG                $IOC63480
       STZ     1,4                 ZERO OUT REQUEST                    $IOC63490
       CLA     4,2                 GET BUFFER POOL                     $IOC63500
       PDC     0,4                 AND PLACE IT IN IR4                 $IOC63510
       CLA     0,1                 GET BUFFER IN USE                   $IOC63520
       STZ     ,1                  ZERO OUT COMMAND LIST               $IOC63530
       STZ     1,1                 CONTROL WORDS                       $IOC63540
DERG   PAC     0,1                 RESTORE                             $IOC63550
       STA     *-1                 IORT                                $IOC63560
       CLA     FCW                 AND                                 $IOC63570
       STP     1,1                 BUFFER                              $IOC63580
       CLA     1,4                 COUNT                               $IOC63590
       ARS     4                                                       $IOC63600
       STD     1,1                                                     $IOC63610
       CLA     DERG                                                    $IOC63620
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $IOC63630
       TRA     S3                  GO BACK                             $IOC63640
TRKC   OCT     010000000000                                            $IOC63650
TRKRC  OCT     007777777777                                            $IOC63660
SEOH   CLA     SIX                 SET EOF BIT ON                      $IOC63670
       STP     0,2                 FOR STRANGE EOF                     $IOC63680
       TRA     SEOF+1              FINISH READ                         $IOC63690
SEOFI  RIL     200000              TURN OFF                            $IOC63700
       STI     0,2                 STRANGE EOF                         $IOC63710
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *IOC63720
       TRA     SELM2                                                   *IOC63730
       TTL     SELECT PLUS FOR 7909 CHANNEL                             IOC63740
DRWRS  CLA     1,4                                                      IOC63750
       PAX     0,1                 IF THIS IS A LIST WORD               IOC63760
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        IOC63770
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             IOC63780
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     IOC63790
       TZE     *+3                                                      IOC63800
       TIX     *-2,1,COMADL-LCOMAD                                      IOC63810
       TRA     DER1                                                     IOC63820
       PXA     0,1                                                      IOC63830
       SUB     DRWRX                                                    IOC63840
       PAC     0,1                                                     $IOC63850
       STA     DRWRS1-2            SAVE LIST ADDRESS                   $IOC63860
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          IOC63870
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  IOC63880
       CLA*    1,4                 GET BUFFERS AHEAD                   $IOC63890
       STD     0,1                                                      IOC63900
       CLA     DRWRS1-2            PICK UP LIST ADDRESS AND             IOC63910
       STA     1,4                 PUT IT IN UCW 2                      IOC63920
       CLA     1,4                                                     $IOC63930
DRWRW  LXA     S3+1,1              RESTORE IR 1                         IOC63940
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         IOC63950
       TPL     *+2                 READ                                $IOC63960
       ACL     L(3)                WRITE                               $IOC63970
       STA*    (RCHXI              SET START CHAN INST                 $IOC63980
       ZET*    (URRXI              FIRST TIME THRU                     $IOC63990
       TRA     C3                  NO                                  $IOC64000
       LXA     CHATT-1,1           WAS CHANNEL                         $IOC64010
       SXA     CHATT-1,0           LIST SET UP                         $IOC64020
       TXH     C3,1,0              YES                                 $IOC64030
       STA     C7                                                      $IOC64040
       CLA     1,4                 ADDRESS OF COMMD                    $IOC64050
       PAC     0,1                 LIST TO IR1                         $IOC64060
       ZET     1,1                 PARTIAL RECORD                      $IOC64070
       TRA     C3                  YES START CHANNEL                   $IOC64080
       TPL     DRWRS1              IF READ                             $IOC64090
       CAL     3,2                                                     $IOC64100
       ACL     1DEC                UP BLOCK COUNT                      $IOC64110
       STD     3,2                                                     $IOC64120
       LNT     BLKSEQ                                                  $IOC64130
       TRA     DRWRS1              NO BLOCK SEQ                        $IOC64140
       ARS     18                                                      $IOC64150
       XCA                    SAVE COUNT                               $IOC64160
       CLA*    1,4            LOC OF BUF TO BE USED                    $IOC64170
       ACL     L(1)                                                    $IOC64180
       STA     *+2                                                     $IOC64190
       XCA     **                  RESTORE COUNT                       $IOC64200
       STA*    **                  (L) OF LAST WORD OF BUF             $IOC64210
DRWRS1 CLA     L(6)                BCD MODE                            $IOC64220
       LNT     MODE                                                    $IOC64230
       CLA     L(22)               BINARY MODE                         $IOC64240
C7     STA     **                  ADDRESS OF SMS                      $IOC64250
       CLA     0,1            ADDRESS OF BUFFER                        $IOC64260
       ACL     L(1)                                                    $IOC64270
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $IOC64280
       ACL     L(1)                                                    $IOC64290
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $IOC64300
       CLA*    8,1            PICK UP COUNT                            $IOC64310
       ARS     18                  MOVE COUNT OVER                     $IOC64320
       ANA     ADDRS               MASK ALL BUT ADDRESS                $IOC64330
       SXA     *+2,2                                                   $IOC64340
       TSX     SIZE,2         CHECK RECORD SIZE                        $IOC64350
C9     AXT     **,2                                                    $IOC64360
       CAL     6,2                 CREATE BCD CHARACTER                $IOC64370
       ANA     TRKRC               CHANGE THE TRACK                    $IOC64380
       ADD     TRKC                COUNT TO ONE FOR RECORD             $IOC64390
       SLW     6,2                 PUT BACK TO FCB                     $IOC64400
       SXA     *+2,4          FOR PV COMMAND                           $IOC64410
       TSX     (DECVA,4                                                $IOC64420
C2     AXT     **,4                                                    $IOC64430
       CAL     6,2                 GET SEEK ADDRESS                    $IOC64440
       ADD     L(1)                                                    $IOC64450
       ALS     18                  MOVE SEEK ADDRESS OVER              $IOC64460
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $IOC64470
       CAL     6,2                 LABEL FOR                           $IOC64480
       ARS     6                   RECORD ADDRESS                      $IOC64490
       STO     *+2                                                     $IOC64500
       TSX     (FDAMT,2       PLACE P.V. COMMAND                       $IOC64510
       PZE                    BITS IN PROPER PLACE                     $IOC64520
       PZE     15,1                                                    $IOC64530
       XEC     C9                  RESTORE IR2                         $IOC64540
       CLA     *-3                 SET INTERFACE BIT                   $IOC64550
       ANA     L(1)                ON FOR SMS INST.                    $IOC64560
       ORS*    C7                                                      $IOC64570
       TSX     WCHK,4         CHECK FOR WRITE CHECK                    $IOC64580
C3     XEC     S3+1                RESTORE IR1                         $IOC64590
       CAL     0,2                 IS THERE A STRANGE                  $IOC64600
       ALS     1                   EOF ON THIS FILE -                  $IOC64610
       PBT                                                             $IOC64620
       TRA     S3-1                NO                                  $IOC64630
       XEC     C2                  YES - RESTORE XR4                   $IOC64640
       CLA*    1,4                 YES                                 $IOC64650
       ACL     L(1)                GET FLAG WORD                       $IOC64660
       STA     DRWRS2              ADDRESS AND SAVE                    $IOC64670
       CAL     6,2                 GET SEEK ADDRESS                    $IOC64680
       SUB     L(1)                MINUS 1 AND STORE                   $IOC64690
       STA     3,4                 IN UCB 4 AND FCB 7                  $IOC64700
       STA     6,2                                                     $IOC64710
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $IOC64720
       AXT     SYSTWT,2            START CHANNEL                       $IOC64730
       PXA     0,2                 FOR A                               $IOC64740
       STA*    (RCHXI              TRAP                                $IOC64750
       TRA     S3-1                GO                                  $IOC64760
LCOMAD PZE                         CHAIN TO BUFFERS                    $IOC64770
       PZE                         COUNT FOR MULTI TRACK RECORD        $IOC64780
       SMS     **                  SET MODE FOR READ                   $IOC64790
       CTLR    *+12                PREPARE DISK FOR READ               $IOC64800
       TCH     *+4                 GO DO DATA MOVEMENT                 $IOC64810
       SMS     **                  SET MODE FOR WRITE                  $IOC64820
       LCC     0                   COUNTER FOR WRITE CHECK             $IOC64830
       CTLW    *+8                 PREPARE DISK FOR WRITE              $IOC64840
       CPYP    **,,1               FLAG WORD MOVEMENT                  $IOC64850
       CPYP    **,,**              DATA MOVEMENT                       $IOC64860
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $IOC64870
       TDC     *+2                 CHECK FOR WRITE CHECK               $IOC64880
       TCH     SYSTWT              INTERUPT CPU                        $IOC64890
       CTLW    *+4                 PREPARE FOR WRITE CHECK             $IOC64900
       TCH     *-6                 GO DO WRITE CHECK                   $IOC64910
       DVTA    ,,                                                      $IOC64920
       DWRC    ,,                                                      $IOC64930
COMADL PZE                                                             $IOC64940
       PZE                                                             $IOC64950
       SMS     **                                                      $IOC64960
       CTLR    *+12                                                    $IOC64970
       TCH     *+4                                                     $IOC64980
       SMS     **                                                      $IOC64990
       LCC     0                                                       $IOC65000
       CTLW    *+8                                                     $IOC65010
       CPYP    **,,1                                                   $IOC65020
       CPYP    **,,**                                                  $IOC65030
       CPYD    0,,0                                                    $IOC65040
       TDC     *+2                                                     $IOC65050
       TCH     SYSTWT                                                  $IOC65060
       CTLW    *+4                                                     $IOC65070
       TCH     *-6                                                     $IOC65080
       DVTA    ,,                                                      $IOC65090
       DWRC    ,,                                                      $IOC65100
       PZE                                                             $IOC65110
       PZE                                                             $IOC65120
       SMS     **                                                      $IOC65130
       CTLR    *+12                                                    $IOC65140
       TCH     *+4                                                     $IOC65150
       SMS     **                                                      $IOC65160
       LCC     0                                                       $IOC65170
       CTLW    *+8                                                     $IOC65180
       CPYP    **,,1                                                   $IOC65190
       CPYP    **,,**                                                  $IOC65200
       CPYD    0,,0                                                    $IOC65210
       TDC     *+2                                                     $IOC65220
       TCH     SYSTWT                                                  $IOC65230
       CTLW    *+4                                                     $IOC65240
       TCH     *-6                                                     $IOC65250
       DVTA    ,,                                                      $IOC65260
       DWRC    ,,                                                      $IOC65270
       PZE                                                             $IOC65280
       PZE                                                             $IOC65290
       SMS     **                                                      $IOC65300
       CTLR    *+12                                                    $IOC65310
       TCH     *+4                                                     $IOC65320
       SMS     **                                                      $IOC65330
       LCC     0                                                       $IOC65340
       CTLW    *+8                                                     $IOC65350
       CPYP    **,,1                                                   $IOC65360
       CPYP    **,,**                                                  $IOC65370
       CPYD    0,,0                                                    $IOC65380
       TDC     *+2                                                     $IOC65390
       TCH     SYSTWT                                                  $IOC65400
       CTLW    *+4                                                     $IOC65410
       TCH     *-6                                                     $IOC65420
       DVTA    ,,                                                      $IOC65430
       DWRC    ,,                                                      $IOC65440
       PZE                                                             $IOC65450
       PZE                                                             $IOC65460
       SMS     **                                                      $IOC65470
       CTLR    *+12                                                    $IOC65480
       TCH     *+4                                                     $IOC65490
       SMS     **                                                      $IOC65500
       LCC     0                                                       $IOC65510
       CTLW    *+8                                                     $IOC65520
       CPYP    **,,1                                                   $IOC65530
       CPYP    **,,**                                                  $IOC65540
       CPYD    0,,0                                                    $IOC65550
       TDC     *+2                                                     $IOC65560
       TCH     SYSTWT                                                  $IOC65570
       CTLW    *+4                                                     $IOC65580
       TCH     *-6                                                     $IOC65590
       DVTA    ,,                                                      $IOC65600
       DWRC    ,,                                                      $IOC65610
       PZE                                                             $IOC65620
       PZE                                                             $IOC65630
       SMS     **                                                      $IOC65640
       CTLR    *+12                                                    $IOC65650
       TCH     *+4                                                     $IOC65660
       SMS     **                                                      $IOC65670
       LCC     0                                                       $IOC65680
       CTLW    *+8                                                     $IOC65690
       CPYP    **,,1                                                   $IOC65700
       CPYP    **,,**                                                  $IOC65710
       CPYD    0,,0                                                    $IOC65720
       TDC     *+2                                                     $IOC65730
       TCH     SYSTWT                                                  $IOC65740
       CTLW    *+4                                                     $IOC65750
       TCH     *-6                                                     $IOC65760
       DVTA    ,,                                                      $IOC65770
       DWRC    ,,                                                      $IOC65780
       PZE                                                             $IOC65790
       PZE                                                             $IOC65800
       SMS     **                                                      $IOC65810
       CTLR    *+12                                                    $IOC65820
       TCH     *+4                                                     $IOC65830
       SMS     **                                                      $IOC65840
       LCC     0                                                       $IOC65850
       CTLW    *+8                                                     $IOC65860
       CPYP    **,,1                                                   $IOC65870
       CPYP    **,,**                                                  $IOC65880
       CPYD    0,,0                                                    $IOC65890
       TDC     *+2                                                     $IOC65900
       TCH     SYSTWT                                                  $IOC65910
       CTLW    *+4                                                     $IOC65920
       TCH     *-6                                                     $IOC65930
       DVTA    ,,                                                      $IOC65940
       DWRC    ,,                                                      $IOC65950
       PZE                                                             $IOC65960
       PZE                                                             $IOC65970
       SMS     **                                                      $IOC65980
       CTLR    *+12                                                    $IOC65990
       TCH     *+4                                                     $IOC66000
       SMS     **                                                      $IOC66010
       LCC     0                                                       $IOC66020
       CTLW    *+8                                                     $IOC66030
       CPYP    **,,1                                                   $IOC66040
       CPYP    **,,**                                                  $IOC66050
       CPYD    0,,0                                                    $IOC66060
       TDC     *+2                                                     $IOC66070
       TCH     SYSTWT                                                  $IOC66080
       CTLW    *+4                                                     $IOC66090
       TCH     *-6                                                     $IOC66100
       DVTA    ,,                                                      $IOC66110
       DWRC    ,,                                                      $IOC66120
       PZE                                                             $IOC66130
       PZE                                                             $IOC66140
       SMS     **                                                      $IOC66150
       CTLR    *+12                                                    $IOC66160
       TCH     *+4                                                     $IOC66170
       SMS     **                                                      $IOC66180
       LCC     0                                                       $IOC66190
       CTLW    *+8                                                     $IOC66200
       CPYP    **,,1                                                   $IOC66210
       CPYP    **,,**                                                  $IOC66220
       CPYD    0,,0                                                    $IOC66230
       TDC     *+2                                                     $IOC66240
       TCH     SYSTWT                                                  $IOC66250
       CTLW    *+4                                                     $IOC66260
       TCH     *-6                                                     $IOC66270
       DVTA    ,,                                                      $IOC66280
       DWRC    ,,                                                      $IOC66290
       PZE                                                             $IOC66300
       PZE                                                             $IOC66310
       SMS     **                                                      $IOC66320
       CTLR    *+12                                                    $IOC66330
       TCH     *+4                                                     $IOC66340
       SMS     **                                                      $IOC66350
       LCC     0                                                       $IOC66360
       CTLW    *+8                                                     $IOC66370
       CPYP    **,,1                                                   $IOC66380
       CPYP    **,,**                                                  $IOC66390
       CPYD    0,,0                                                    $IOC66400
       TDC     *+2                                                     $IOC66410
       TCH     SYSTWT                                                  $IOC66420
       CTLW    *+4                                                     $IOC66430
       TCH     *-6                                                     $IOC66440
       DVTA    ,,                                                      $IOC66450
       DWRC    ,,                                                      $IOC66460
ENDLIS BES     LCOMAD+NOCH*19-*                                        $IOC66470
       TTL 0                                                           $IOC66480
*              THIS SETS UP FOR A WRITE CHECK                          $IOC66490
*              TSX WCHK,4                                              $IOC66500
*              RETURN                                                  $IOC66510
*                                                                      $IOC66520
WCHK   CLA     0,2                                                     $IOC66530
       TMI     *+3            WRITE CHECK NEC.                         $IOC66540
       PXA     0,0                 PUT ZERO IN LCC                     $IOC66550
       TRA     STCC                                                    $IOC66560
       CAL     15,1                PUT THE PREPARE                     $IOC66570
       ANA     L(DWRC         TO VERIFY IN THE                         $IOC66580
       ORA     LDWRC                                                   $IOC66590
       SLW     17,1                WRITE CHECK ORDER                   $IOC66600
       CLA     16,1                                                    $IOC66610
       STO     18,1                                                    $IOC66620
       CLA     L(1)                PUT ONE IN LCC                      $IOC66630
STCC   STA     6,1                                                     $IOC66640
       TRA     1,4            RETURN                                   $IOC66650
*                                                                      $IOC66660
*              TSX CKSEE,1                                             $IOC66670
*              RETURN                                                  $IOC66680
*                                                                      $IOC66690
*                                                                      $IOC66700
CKSEE  CAL     6,2            UPDATE SEEK                              $IOC66710
       ACL     L(4)                                                    $IOC66720
       ERA     7,2            ADDRESS                                  $IOC66730
       ANA     ADDRS                                                   $IOC66740
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $IOC66750
       TXH     D9,1,-TEMIND                                            $IOC66760
       CAL     6,2                                                     $IOC66770
       ADD     L(1)                                                    $IOC66780
       STA     6,2            NEXT ADDRESS FOR SEEK                    $IOC66790
       CAL     3,4                                                     $IOC66800
       ADD     L(1)                                                    $IOC66810
       STA     3,4                 UPDATE SEEK ADDRESS                 $IOC66820
       ERA     6,2                 SAME ARM POSITION                   $IOC66830
       ANA     ADDRS               AS DESIRED                          $IOC66840
       TZE     D8                  YES                                 $IOC66850
D9     CAL     6,2                 NO, PUT DESIRED                     $IOC66860
       STA     3,4                 POSITION IN REQUEST                 $IOC66870
       TRA     D6                  AND ASK FOR SEEK                    $IOC66880
D8     CLA     3,4                 GET POSITION AND                    $IOC66890
       ANA     ADDRS          CHECK IF ANOTHER                         $IOC66900
       XCA                    SEEK NEC. NOW                            $IOC66910
       PXA     0,0                                                     $IOC66920
       DVP     L(40)                                                   $IOC66930
       TNZ     1,1            RETURN IF NO SEEK                        $IOC66940
D6     CLS     2,4            SET 3RD UCW TO                           $IOC66950
       STO     2,4            DEMAND A SEEK                            $IOC66960
       TRA     1,1                                                     $IOC66970
*                                                                      $IOC66980
*              COUNT IN ACC                                            $IOC66990
*              TSX SIZE,2                                              $IOC67000
*              RETURN                                                  $IOC67010
*                                                                      $IOC67020
 SIZE  SXA     C11,2        SAVE IR2                                 (4)IOC67030
       XCA                  SAVE COUNT                               (4)IOC67040
       CAL     0,4          UCW1                                     (4)IOC67050
       ARS     6            MOVE AND                        7=1302   (4)IOC67060
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (4)IOC67070
       PDX     0,2          DEVICE TO IR2                   1=1301   (4)IOC67080
 SVCOD XCA     **           ADDR. FOR DEVICE CODE                    (4)IOC67090
       TIX     *+1,2,5      IF 1302,IR2 BECOMES 2                    (4)IOC67100
       SXA     *-2,2        SAVE DEVICE CODE FOR FINREC              (4)IOC67101
       SUB     L(STL,2      SUB FULL TRK. FROM COUNT                 (4)IOC67110
       TMI     D1           LESS THAN OR                             (4)IOC67120
       TZE     D1           EQUAL TO FULL TRACK                      (4)IOC67130
       STA     1,1          SAVE EXTRA WORD COUNT                    (4)IOC67140
       CLA     L(STL,2      GET FULL TRACK                           (4)IOC67150
 C1    SLW*    8,1          PUT IN FLAG WORD                         (4)IOC67160
       ALS     18           PUT COUNT IN                             (4)IOC67170
       STD     9,1          COPY COMMAND                             (4)IOC67180
 C11   AXT     **,2         RETURN                                   (4)IOC67190
       TRA     1,2          RETURN                                   (4)IOC67200
 D1    ADD     L(STL,2      GET COUNT BACK                           (4)IOC67210
       STL     1,1          MAKE FALSE COUNT                         (4)IOC67220
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (4)IOC67230
       TXI     C1,0,7       FINISH UP                                (4)IOC67240
 ENTRK CLA     TRKRC        SET END OF TRACK                         (4)IOC67250
       STT     6,2          INDICATION IN FCW7                       (4)IOC67260
       TRA     CKSEE+5      AND RETURN                               (4)IOC67270
       PZE     524          7320 DRUM TRACK SIZE (USED)              (4)IOC67280
       PZE     969          1302 DISK TRACK SIZE (USED)              (4)IOC67290
       PZE     465          1301 DISK TRACK SIZE (USED)              (4)IOC67291
 L(STL PZE     D2                                                    (4)IOC67292
       BES     MSEL+NOCH/NOCH**-NOCH/NOCH*MSEL-*                       $IOC67300
HBEG   SMS     **                  SET INTERFACE                       $IOC67310
       LIPT    *+1                 LEAVE INTERUPT STATUS               $IOC67320
       CTLR    *+7                 SELECT FOR READ                     $IOC67330
       TCH     *+3                 DO IO                               $IOC67340
       SMS     **                  SET INTERFACE                       $IOC67350
       CTLW    *+4                 SELECT FOR WRITE                    $IOC67360
       CPYP    **,,**              DO IO                               $IOC67370
       CPYD    0,,0                                                    $IOC67380
       TCH     SYSTWT              INTERUPT                            $IOC67390
       OCT     120600120112        HSEL AND EOS                        $IOC67400
HLIS   SMS     **                                                      $IOC67410
       LIPT    *+1                                                     $IOC67420
       CTLR    *+7                                                     $IOC67430
       TCH     *+3                                                     $IOC67440
       SMS     **                                                      $IOC67450
       CTLW    *+4                                                     $IOC67460
       CPYP    **,,**                                                  $IOC67470
       CPYD    0,,0                                                    $IOC67480
       TCH     SYSTWT                                                  $IOC67490
       OCT     120600120112                                            $IOC67500
       SMS     **                                                      $IOC67510
       LIPT    *+1                                                     $IOC67520
       CTLR    *+7                                                     $IOC67530
       TCH     *+3                                                     $IOC67540
       SMS     **                                                      $IOC67550
       CTLW    *+4                                                     $IOC67560
       CPYP    **,,**                                                  $IOC67570
       CPYD    0,,0                                                    $IOC67580
       TCH     SYSTWT                                                  $IOC67590
       OCT     120600120112                                            $IOC67600
       SMS     **                                                      $IOC67610
       LIPT    *+1                                                     $IOC67620
       CTLR    *+7                                                     $IOC67630
       TCH     *+3                                                     $IOC67640
       SMS     **                                                      $IOC67650
       CTLW    *+4                                                     $IOC67660
       CPYP    **,,**                                                  $IOC67670
       CPYD    0,,0                                                    $IOC67680
       TCH     SYSTWT                                                  $IOC67690
       OCT     120600120112                                            $IOC67700
HEND   BES     HBEG+NOHYP*10-*                                         $IOC67710
       PZE     HEND                                                    $IOC67720
       TTL     SELECT ROUTINES FOR HYPER                                IOC67730
HYPL   CLA     3,4                 IF REINSTRUCT                       $IOC67740
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $IOC67750
       AXT     HEND-HBEG,1         FIND CH. LIST POINTER               $IOC67760
       SXA     HSXA,1              SAVE CH. LIST POINTER               $IOC67770
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $IOC67780
       ANA     DECRE               THIS CHANNEL TO USE                 $IOC67790
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $IOC67800
       ARS     18                                                      $IOC67810
       SUB     S3+1                                                    $IOC67820
       ANA     ADDRS                                                   $IOC67830
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $IOC67840
       TIX     HYPL+3,1,HLIS-HBEG                                      $IOC67850
       TRA     DER1                                                    $IOC67860
       LXA     S3+1,1              GET CHANNEL NO                      $IOC67870
       PXD     0,1                                                     $IOC67880
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $IOC67890
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $IOC67900
       PXA     0,1                 COMPUTE THE                         $IOC67910
       SUB     HEND                CHANNEL LIST                        $IOC67920
       STA     HSXA                START ADDRESS                       $IOC67930
       CLA     1,4                                                     $IOC67940
       ACL     L(1)                                                    $IOC67950
       LXA     S3+1,1                                                  $IOC67960
       TMI     S4                  OUTPUT                              $IOC67970
       STA     S0                  SAVE ADDRESS OF IORT                $IOC67980
       ACL     L(1)                PUT LOCATION OF                     $IOC67990
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $IOC68000
       STA     6,1                 ADDRESS FOR START CH.               $IOC68010
       XCA                         SAVE READ OR WRITE                  $IOC68020
       CLA*    S0                  GET NO. OF WORDS                    $IOC68030
       STD     6,1                 STORE IN COPY                        IOC68040
       RNT     400000              READ BACKWARD                        IOC68050
       TRA     *+4                 NO                                   IOC68060
       ARS     18                  PUT LAST LOCATION                    IOC68070
       ACL     S0                  OF BUFFER IN                         IOC68080
       STA     6,1                 COPY COMMAND                         IOC68090
       CLA     3,4                 IS THIS A REINSTRUCT                 IOC68100
       TZE     HNSL                NO                                   IOC68110
       CLA     HYCLN               TURN OFF THE                         IOC68120
       ORS     2,1                 CONTROL OPERATION                    IOC68130
       ORS     5,1                                                      IOC68140
       LXA     S3+1,1                                                   IOC68150
       NZT*    (URRXI              IF NO ERROR                          IOC68160
       TRA     S3-1                START CHANNEL                        IOC68170
HNSL   CAL     HSXA                SMS ADDRESS                         $IOC68180
       STA     3,4                 SAVE CH LIST IN UCW4                $IOC68190
       TQP     *+2                 READ                                 IOC68200
       ADD     L(4)                WRITE                               $IOC68210
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $IOC68220
       STA*    (RCHXI              START CHANNEL ADDRESS               $IOC68230
       ZET*    (URRXI              BACK ON ERROR CONDITION             $IOC68240
       TRA     S3-1                YES, START CHANNEL                  $IOC68250
       CLA     CHATT-1             IF RETURN FROM                      $IOC68260
       ANA     ADDRS               SEL-WITH INTERFACE                  $IOC68270
       SXA     CHATT-1,0           NOT READY, THEN                     $IOC68280
       TNZ     S3-1                JUST TRY AGAIN                      $IOC68290
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $IOC68300
       CLA     0,4                 SAVE UNIT                           $IOC68310
       ANA     DEC15               NO. IN SEL ORDER                    $IOC68320
       ORA     HYSEL                                                   $IOC68330
       RFT     400000              IS THIS READ BACKWARD               $IOC68340
       ORA     L(64D)              YES, FIX SEL ORDER                  $IOC68350
       STD     9,1                                                     $IOC68360
       CLA     HYCTL               SET CONTROL                         $IOC68370
       ANS     2,1                 OPERATION ON                        $IOC68380
       ANS     5,1                                                     $IOC68390
       CLA     HSMSN               SET UP SMS COMMAND                  $IOC68400
       LNT     004000              IF OFF BCD MODE                     $IOC68410
       ORA     L(22)                                                   $IOC68420
       RFT     400000                                                  $IOC68430
       ORA     HSMSR               BACKWARD READ                       $IOC68440
       LDI     0,4                 PUT THE                             $IOC68450
       LFT     40                  INTERFACE                           $IOC68460
       ORA     L(1)                IN SMS                              $IOC68470
       STA     0,1                                                     $IOC68480
       STA     4,1                                                     $IOC68490
       LXA     S3+1,1                                                  $IOC68500
       TRA     S3-1                                                    $IOC68510
       TTL     SELECT MINUS FOR HYPER                                   IOC68520
HSELM  CLA     1,4                 UCW 2 TO AC                         $IOC68530
       ACL     L(1)                IORT ADDRESS OF BUF                 $IOC68540
       STA     HIORT                                                   $IOC68550
       ACL     L(1)                                                    $IOC68560
       LFT     7100                ERROR                               $IOC68570
       TRA     HEROR               YES                                 $IOC68580
       ALS     18                  DEC= 1ST WORD WRITTEN               $IOC68590
       STD     COMM                SAVE AS 76O7 CH.                    $IOC68600
HIORT  CLA     **                  LAST WORD WRITTEN                   $IOC68610
       STA     COMM                SAVE AS 7607 CH.                    $IOC68620
HRETN  CAL     S3                  FIX EXIT                            $IOC68630
       SUB     L(1)                FOR CONTINUED                       $IOC68640
       STA     S3                  PRIORITY ON UNIT                    $IOC68650
       CLA     1,2                 IF MIXED MODE                       $IOC68660
       TPL     SELM1               GO HANDEL IT                        $IOC68670
       STZ     3,4                 MAKE REINSTRUCT                     $IOC68680
       TRA     MXMOD+3             IMPOSSIBLE                          $IOC68690
HSMRD  LDI     FOR                 GOOD READ                           $IOC68700
       LDQ     COMM                MAKE COMM LOOK                      $IOC68710
       LGL     18                  LIKE 7607 CHANNEL                   $IOC68720
       SLW     COMM                                                    $IOC68730
       ANA     ADDRS                                                   $IOC68740
       LDQ     1,4                                                     $IOC68750
       RQL     1                   TYPE READ                           $IOC68760
       TQP     HREAD               READ FORWARD                        $IOC68770
       LNT     200000              END OF FILE TEST                    $IOC68780
       TNZ     *+2                 IF LONG LENGTH RECORD               $IOC68790
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $IOC68800
       ACL     L(1)                ELSE IT POINTS AT LAST              $IOC68810
       STA     COMM                WORD READ                           $IOC68820
HREAD  TNZ     HRETN                                                   $IOC68830
       CAL     COMM                MAKE IT POINT AT                    $IOC68840
       ADD*    HIORT               LAST REC IN BUFF+1                  $IOC68850
       ARS     18                  IF LONG RECORD READ                 $IOC68860
       TRA     HREAD-1                                                 $IOC68870
HEROR  RFT     377777              NCI INTERRUPT                       $IOC68880
       TRA     *+2                 NO                                  $IOC68890
       TRA     HSMRD               YES                                 $IOC68900
       LNT     100                 INTERFACE CHECK                     $IOC68910
       TRA     *+4                 NO                                  $IOC68920
       AXC     *+1,4               SET SWITCH FOR SEL+                 $IOC68930
       SXA     CHATT-1,4           RETURN 2,4                          $IOC68940
       TRA     DCHG                                                    $IOC68950
       RFT     020014                                                  $IOC68960
       TRA     HYSEL+1             EOT, EOF, BOT                       $IOC68970
       LDI     1,4                                                     $IOC68980
       LFT     400000                                                  $IOC68990
       TRA     *+3                 WRITE ERROR                         $IOC69000
       LDI     1PRE                READ ERROR                          $IOC69010
       TRA     HSMRD+1             GO POST                             $IOC69020
       CAL     S3                                                      $IOC69030
       SUB     L(2)                CHANGE EXIT                         $IOC69040
       STO     S3                  TO 3,4                              $IOC69050
       CLA*    (URRXI              UPDATE ERROR                        $IOC69060
       ACL     5,2                                                     $IOC69070
       SLW     5,2                 HISTORY AND TRY                     $IOC69080
       TRA     S3                  TO WRITE AGAIN                      $IOC69090
HSMSR  OCT     000000000040        CONSTANTS                           $IOC69100
HSMSN  OCT     000000000106        FOR                                 $IOC69110
HYCTL  OCT     757777777777        HYPER                               $IOC69120
HYCLN  OCT     020000000000        SELECT                              $IOC69130
HYSEL  OCT     120600120112                                            $IOC69140
       LDI     SIX                                                     $IOC69150
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE             *IOC69160
       TPL     HSMRD+1             READ EOF                            $IOC69170
       TRA     HIORT-2             WRITE EOT                           $IOC69180
       BES     HBEG+NOHYP/NOHYP**-NOHYP/NOHYP*HBEG-*                   $IOC69190
DER1   STL     DERR                                                    $IOC69200
       STZ     1,4                 ZERO OUT UCW2                       $IOC69210
       TRA     DCHG                RETURN 2,4                          $IOC69220
       TTL                         BTP (BUFFER TO POOL) ROUTINE         IOC69230
*              TSX BTP,1                                                IOC69240
       SPACE   1                                                        IOC69250
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           IOC69260
*              MQ                  TSX BTP1,1                           IOC69270
       SPACE   1                                                        IOC69280
BTP1   XCA                         L(BUF. IN USE IN AC                 $IOC69290
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $IOC69300
       STA     0,4                 PUT BUF IN USE BACK                 $IOC69310
       XCA                         BUF FROM CHAIN IN AC                $IOC69320
       STZ*    0,4                 ZERO IN BUF CW                      $IOC69330
       STA*    0,4                 ADDRESS OF CHAIN                    $IOC69340
       TRA     1,1                                                      IOC69350
       SPACE   1                                                        IOC69360
*                      URC (UPDATE REQUEST CHAIN)                       IOC69370
*                       IR4 = -L(UCW) TSX URC1,1                        IOC69380
       SPACE   1                                                        IOC69390
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $IOC69400
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $IOC69410
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $IOC69420
       NZT*    1,4                 LOC OF ZERO                         $IOC69430
       TRA     *+3                                                      IOC69440
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $IOC69450
       TRA     1,1                                                      IOC69460
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $IOC69470
       TRA     1,1                                                      IOC69480
       TTL                         MESSAGES FOR MINIMUM IOCS            IOC69490
MESS1  BCI     2, UNIT  *****                                           IOC69500
MESS2  BCI     3,CYL. LIMITS XCEDED                                    $IOC69510
MESS5  BCI     3,POOL ERROR TSX AT                                      IOC69520
MESS6  BCI     7, OPEN COUNT EXCEEDED - OPEN NOT POSSIBLE               IOC69530
MESS7  BCI     6, NOT AVAILABLE FOR INITIALIZATION                      IOC69540
MESS8  BCI     3, ATTACH ERROR AT                                       IOC69550
MESS9  BCI     7, ILLEGAL TRANSMIT  ***** WRITE READ  *****            $IOC69560
MES10  BCI     6, REEL  *****   -   ***** RECORDS                       IOC69570
MES11  BCI     4,      REDUNDANCY HISTORY                               IOC69580
MES12  BCI     5, ***** RETRYS      ***** PERM.                        $IOC69590
MES13  BCI     1, RETRY                                                $IOC69600
MES14  BCI     1, ERASE                                                 IOC69610
MES22  BCI     3,ILLEGAL FILE USE                                       IOC69620
MES23  BCI     3,REMOVE  REEL *****                                     IOC69630
MES24  BCI     2, MOUNT BLANK                                           IOC69640
MES25  PZE     MES10+3,,3                                              $IOC69650
MES26  PZE     MES10,,6                                                $IOC69660
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      IOC69670
*                    IN SEARCHING OUTPUT FILE CHAIN                     IOC69680
       SPACE   1                                                        IOC69690
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              IOC69700
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               IOC69710
       SPACE   1                                                        IOC69720
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      IOC69730
       TSX     EOTOF,1             HANDLE EOT                           IOC69740
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           IOC69750
       TRA     GET0+1              AND IR2 THEN EXIT                    IOC69760
       SPACE   1                                                        IOC69770
*                       EOT HANDLER OUTPUT FILE                         IOC69780
       SPACE   1                                                        IOC69790
*      TSX     EOTOF,1             IR2 = -L(FILE)                       IOC69800
*      RETURN                      INDICES NOT DISTURBED                IOC69810
       SPACE   1                                                        IOC69820
EOTOF  SXA     ETOF5,4             SAVE IR4                             IOC69830
       SXA     ETOF6,1             IR1                                  IOC69840
       TSX     NDSEL+1,4           WEF ON OLD                           IOC69850
       PZE     0,2,WEFOP           FILE                                 IOC69860
       NOP                         IGNORE EOT                           IOC69870
       LFT     LABEL               IF LABELLED                          IOC69880
ETOF3  TSX     LBEOT,1             WRITE TRAILERS                       IOC69890
       TSX     SWITCH,1            SWITCH REELS                         IOC69900
       LFT     LABEL               IF LABELLED                          IOC69910
       TSX     LABOO,1             CHECK AND PREPARE LABELS             IOC69920
       TSX     CPINT,4             INITIATE CHECKPOINT (CONDITIONAL)    IOC69930
       SIL     NOEOT               SET NO EOT CONDITION                 IOC69940
       NZT*    4,2                 IF NO SELECTS TO DO                  IOC69950
       TRA     ETOF5               SKIP OUT                             IOC69960
       CLA     4,2                 SET EOT CHAIN OF SELECTS             IOC69970
       STA     ETOF7               INTO UCW OF                          IOC69980
       CAL     ETOF7               NEW REEL                             IOC69990
       AXC     1,4                                                      IOC70000
       ZET*    0,2                 WAIT FOR COMPLETION                 $IOC70010
       TRA     *-1                 OF ANY NON-DATA                     $IOC70020
       ORS*    0,2                                                      IOC70030
       CLA     L(0)A               SET EOT CHAIN                        IOC70040
       STA     4,2                 = 0                                  IOC70050
       TSX     ACTV+1,4            ACTIVATE                             IOC70060
       PZE     0,2                 NEW REEL                             IOC70070
ETOF5  AXT     **,4                RESTORE IR4                          IOC70080
ETOF6  AXT     **,1                IR1                                  IOC70090
       TRA     1,1                 EXIT                                 IOC70100
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          IOC70110
       TTL                         REEL SWITCHING ROUTINE               IOC70120
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  IOC70130
*      RETURN                      INDICES NOT DISTURBED                IOC70140
       SPACE   1                                                        IOC70150
*                               ACTIONS                                 IOC70160
*            1. REWINDS UNLOADS OLD REEL                                IOC70170
*            2. SWITCHES TO ALTERNATE UNIT                              IOC70180
*            3. PRINTS MESSAGE TO OPERATOR                              IOC70190
*            4. ADVANCES REEL SEQ. NUMBER                               IOC70200
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  IOC70210
       SPACE   1                                                        IOC70220
SWITCH SXA     SW3,4               SAVE IR4                             IOC70230
       SXA     SW4,1               IR1                                  IOC70240
       LDQ     5,2                                                     $IOC70250
       RQL     1                   HYPER                               $IOC70260
       TQP     SW8                 NO                                  *IOC70270
       STI     TEMP                                                    $IOC70280
       LDI     1,2                                                     $IOC70290
       RNT     100000              FILE PROTECT                        $IOC70300
       TRA     *+3                 NO                                  $IOC70310
       TSX     (NDSLX,4                                                $IOC70320
       PZE     0,2,HFPNP                                               $IOC70330
       RFT     200000              UNLOAD                               IOC70340
       TRA     *+4                 NO                                  $IOC70350
       TSX     (NDSLX,4                                                $IOC70360
       PZE     0,2,HUNLP                                               $IOC70370
       TRA     *+3                                                     $IOC70380
       BES     *-14+NOHYP/NOHYP*14-*                                    IOC70390
SW8    TSX     NDSEL+1,4           REWIND AND UNLOAD                    IOC70400
       PZE     0,2,RUNOP           OLD REEL                             IOC70410
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           IOC70420
       TSX     UNMNT,4             PRINT UNMOUNT INSTRUCTIONS           IOC70430
       CLA     0,2                 SET IR1 =0                           IOC70440
       PAC     0,1                 FOR SINGLE DRIVE FILE                IOC70450
       STD     *+1                 NOT=0 FOR MULTI-DRIVE                IOC70460
       TXI     *+1,1,**                                                 IOC70470
       CAL     7,2                 UPDATE                               IOC70480
       ACL     1P5                 REEL SEQUENCE                        IOC70490
       TSX     BCDCV,4             NUMBER IN                            IOC70500
       ACL     HLBLK               FILE WORDS                           IOC70510
       SLW     7,2                                                      IOC70520
       CAL     0,2                 SAVE FOR SECOND DRIVE               $IOC70530
       STP     SW7                 MOUNTED TEST                        $IOC70540
       CLA     LFLBLK                                                  $IOC70550
       PDC     0,4                 TOTAL NO. OF FCW                    $IOC70560
       STA     SW5+5               ADDRESS OF 1ST FCB                  $IOC70570
       ACL     L(1)                                                    $IOC70580
       STA     SW5+2                                                   $IOC70590
       STI     TEMIND              SAVE INDICATORS                     $IOC70600
       CLA*    FCW                 L(FCB) BEING WORKED ON              $IOC70610
SW5    TXL     SW6,4,0             END OF FCB                          $IOC70620
       TXI     *+1,4,12            NEXT FCB                            $IOC70630
       LDI     **,4                CHECK IF FILE OPEN                  $IOC70640
       LNT     OPEND               IF NOT TRY NEXT FCB                 $IOC70650
       TRA     SW5                                                     $IOC70660
       CAS     **,4                IF MORE THAN ONE FCB                $IOC70670
       TRA     SW5                 USING THE SAME UCB                  $IOC70680
       TRA     *+2                 UPDATE FCW ONE                      $IOC70690
       TRA     SW5                                                     $IOC70700
       LDQ*    SW5+5               ROTATE PRIMARY UNIT                 *IOC70710
       RQL     18                  WITH SECONDARY UNIT                 $IOC70720
       STQ*    SW5+5                                                   *IOC70730
       TRA     SW5                 FINISH FCB                          $IOC70740
SW6    LDI     TEMIND              RESTORE INDICATORS                  $IOC70750
       CLA     FCW                 PLACE LOCATION                      $IOC70760
       AXT     0,4                 OF FILE IN                          $IOC70770
       STA*    0,2                 SECONDARY UNIT                      $IOC70780
       CAL     7,2                 RESTORE AC                          $IOC70790
       TXL     SW2,1,0             IF SINGLE DRIVE SKIP FURTHER TESTS  $IOC70800
       CLA     *+3                 CHECK LEGALITY                      $IOC70810
       TMI     SW1-1               OF UNIT TO BE MOUNTED               $IOC70820
       TSX     (NDATA,4                                                $IOC70830
SW7    PZE     0,2,TESTP                                               $IOC70840
       CAL     7,2                 IF NOT MOUNTED                       IOC70850
       TSX     MOUNT,4             TELL OPERATOR                        IOC70860
       TSX     PAUSE,4             TO MOUNT NOW                         IOC70870
       TSX     ROTAT,4                                                  IOC70880
SW1    CAL     7,2                 TELL OPERATOR                        IOC70890
       ACL     1P5                 TO MOUNT REEL N+2                    IOC70900
       TSX     BCDCV,4             ON UNIT OF REEL N                    IOC70910
       ACL     HLBLK               ( IF MULTI-DRIVE)                    IOC70920
SW2    TSX     MOUNT,4                                                  IOC70930
       TSX     ROTAT,4                                                  IOC70940
       TXH     *+2,1,0             IF SAME DRIVE                        IOC70950
       TSX     PAUSE,4             PAUSE FOR OPERATOR                   IOC70960
       TSX     DENSE,4                                                  IOC70970
       LDQ     5,2                                                     $IOC70980
       RQL     1                                                       $IOC70990
       TQP     *+6                                                     $IOC71000
       RNT     100000                                                  $IOC71010
       TRA     *+3                                                     $IOC71020
       TSX     (NDSLX,4                                                $IOC71030
       PZE     0,2,HFPNP                                               $IOC71040
       LDI     TEMP                                                    $IOC71050
       BES     *-8+NOHYP/NOHYP*8-*                                     $IOC71060
       SIL     NINHIB              UN-INHIBIT FILE                     $IOC71070
       TSX     NDSEL+1,4           VERIFY NEXT REEL                    $IOC71080
       PZE     0,2,REWOP           IS REWOUND                          $IOC71090
       LDQ     2,2                 IF MONITORED END OPTION              IOC71100
       RQL     1                   IS SPECIFIED                         IOC71110
       TQP     SW3                 LET SUPERVISORY                      IOC71120
       TSX     SWITCD,4            SYSTEM NOTE CHANGE                   IOC71130
SW3    AXT     **,4                RESTORE IR4                          IOC71140
SW4    AXT     **,1                                                     IOC71150
       TRA     1,1                 EXIT                                 IOC71160
       SPACE   1                                                        IOC71170
*                          ROTATE FILE WORD 1                           IOC71180
*                         (CHANGE TO ALT UCW)                           IOC71190
ROTAT  LDQ     0,2                                                      IOC71200
       RQL     18                                                       IOC71210
       STQ     0,2                                                      IOC71220
       TRA     1,4                                                      IOC71230
       SPACE   1                                                        IOC71240
*                     BCD CONVERT AFTER ADD IN AC                       IOC71250
       SPACE   1                                                        IOC71260
*      TSX     BCDCV,4                                                  IOC71270
       SPACE   1                                                        IOC71280
BCDCV  ANA     17SS                                                     IOC71290
       ACL     66SS                                                     IOC71300
       ANS     60SS                                                     IOC71310
       SBM     60SS                                                     IOC71320
       ALS     3                                                        IOC71330
       SBM     60SS                                                     IOC71340
       ARS     3                                                        IOC71350
       LDQ     BLNKS                                                    IOC71360
       STQ     60SS                                                     IOC71370
       TRA     1,4                                                      IOC71380
17SS   OCT     171717373717                                            *IOC71390
66SS   OCT     006666666666                                             IOC71400
60SS   OCT     606060606060                                             IOC71410
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             IOC71420
*                               ACTIONS                                 IOC71430
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          IOC71440
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      IOC71450
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                IOC71460
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              IOC71470
*                MODE WILL BE USED AND THE RECORD WILL BE READ          IOC71480
*                WITHOUT REDUNDANCY CHECKING                            IOC71490
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 IOC71500
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             IOC71510
*                            XX XX XX X5 XX XX    BIN   BIN             IOC71520
*                            XX XX XX X1 XX XX    BCD   BIN             IOC71530
*                            XX XX XX X1 XX XX    BIN   BCD             IOC71540
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   IOC71550
*                            XX XX 00 00 00 00    BCD   BCD             IOC71560
*                            00 01 00 05 00 04    BIN   BIN             IOC71570
*                            XX XX 11 11 07 07    BCD   BIN             IOC71580
*                            00 00 00 01 00 00    BIN   BCD             IOC71590
*             5. WRITE MIXED MODE WORKS ............                    IOC71600
MXMOD  CLA     0,4                 MIXED MODE                           IOC71610
       ANA     L(64D)              CARD EQUIPMENT                       IOC71620
       TNZ     CDMXM               CHECKS FOR EOF CARD                  IOC71630
       STI     MX2                 SAVE SI                              IOC71640
       LNT     100000              IF NO REDUNDANCY ANALYZE             IOC71650
       TRA     LKAD                LOOK AHEAD BITS                      IOC71660
       LDI     1,4                 IF CODE 3 THEN                       IOC71670
       LNT     300000              10 TRIES ON FIRST MODE DONE          IOC71680
       TRA     MX1                                                      IOC71690
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         IOC71700
MX0    STZ*    (URRXI              ERROR PRINT                          IOC71710
       STI     1,4                                                      IOC71720
       LDI     1,2                 REVERSE                              IOC71730
       IIL     MODE                MODE OF                              IOC71740
       STI     1,2                 SELECT                               IOC71750
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     IOC71760
       LXA     S3+1,1              RESTORE IR 1                         IOC71770
       LXA     S3,4                RETURN TO                            IOC71780
       TRA     3,4                 EXECUTOR TO RE-TRY                   IOC71790
*                   SECOND AND THIRD MODE TRIES SEL-                    IOC71800
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      IOC71810
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $IOC71820
       IIL     300000              IF SECOND GO TRY AGAIN               IOC71830
       TRA     MX0                 AT FIRST MODE                        IOC71840
MX2    PZE     **                  SI STORAGE                           IOC71850
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   IOC71860
MXMP   LDI     1,4                 IF FIRST TIME                        IOC71870
       LFT     300000              SELECT SET ALTERNATOR                IOC71880
       TRA     MX3                 CODE =3                              IOC71890
       IIL     300000                                                   IOC71900
       STI     1,4                 RESTORE UCW 2ND WORD                 IOC71910
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           IOC71920
       STZ*    (RCTXI              THIRD TRY DISABLE REDUNDANCY         IOC71930
       LDI     1,2                 RESTORE SI                           IOC71940
       TRA     S4-5                EXIT                                $IOC71950
       EJECT                                                            IOC71960
*                      INTERROGATE LOOKAHEAD BITS                       IOC71970
1KA    LFT     200000              EOF                                 $IOC71980
       TRA     SELM2+2             NO CHANGE IN MODE                   $IOC71990
       STI     MX2                 SAVE INDICATORS                     $IOC72000
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $IOC72010
       CLA     1,4                                                     $IOC72020
       PAC     0,1                                                     $IOC72030
       CLA     9,1                 LAST COMMAND                        $IOC72040
       ARS     18                                                      $IOC72050
       ADD     9,1                 LAST WORD READ + 1                  $IOC72060
       PAC     0,1                                                     $IOC72070
       TRA     LWRD+1                                                  $IOC72080
       BES     1KA+NOCH/NOCH**-NOCH/NOCH*1KA-*                         $IOC72090
       LDI     MX2                                                     $IOC72100
LKAD   LFT     200000              EOF                                 $IOC72110
       TRA     MX5                 NO CHANGE IN MODE                   $IOC72120
       LDI     1,2                                                     $IOC72130
LWRD   LAC     COMM,1              INTERROGATE                         $IOC72140
       CLA     -1,1                LAST WORD IN BUFFER                  IOC72150
       ANA     MXBB2                                                   $IOC72160
       LNT     MODE                TEST MODE                           $IOC72170
       TZE     MX5                 BCD TO BCD                          $IOC72180
       ANA     DISCON              BIN CHECK BIN'BIN                   $IOC72190
       TNZ     MX5                 BIN TO BIN                          $IOC72200
       IIL     MODE                CHANGE MODE BIT                     $IOC72210
       STI     1,2                 STORE IN FILE BITS                   IOC72220
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     IOC72230
MX5    LDI     MX2                 RESTORE SI FOR SELM                  IOC72240
       LXA     S3+1,1                                                  $IOC72250
       CLA     CHATY                                                   $IOC72260
       LBT                                                             $IOC72270
       TRA     *+2                                                     $IOC72280
       TRA     SELM2+2             DISK SEL-                           $IOC72290
       TNZ     SELM1               HYPER SEL-                          $IOC72300
       CAL     XCPT3               CLEAR READ                          $IOC72310
       ANS     1,4                 MODE SWITCH                         $IOC72320
       TRA     SELM1               POST COMPLETION                      IOC72330
MXBB2  OCT     000000050000                                            $IOC72340
XCPT3  OCT     477777777777                                             IOC72350
       SPACE   1                                                        IOC72360
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      IOC72370
*                     BEING REFERENCED BY THE IOBS                      IOC72380
INVM   SXA     INVM1,1             SAVE IR1                             IOC72390
       CLA     0,4                 IF FILE IS                           IOC72400
       ALS     18                  CURRENTLY BEING                      IOC72410
       STD     *+2                 REFERENCED BY IOBS                   IOC72420
       LAC     FCW,1               THEN MODIFY MODE                     IOC72430
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              IOC72440
       TXH     *+4,1,0             AS STORED BY                         IOC72450
       LDI     (IOXSI              IOEX.......                          IOC72460
       IIL     MODE                                                     IOC72470
       STI     (IOXSI                                                   IOC72480
INVM1  AXT     **,1                RESTORE IR1                          IOC72490
       TRA     1,1                 EXIT                                 IOC72500
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    IOC72510
CDMXM  SXA     CDMX4,4             SAVE IR4                             IOC72520
       CAL     1,4                 FIND L(9L)-2                         IOC72530
       PAC     0,4                 IF BOTH                              IOC72540
       CLA     4,4                 8L AND 7L                            IOC72550
       TPL     CDMX4               ARE                                  IOC72560
       CLA     6,4                 (-) TREAT IT AS                      IOC72570
       TPL     CDMX4               END OF FILE                          IOC72580
       LXD     COMM,4              SET L(IORT)+1                        IOC72590
       SXA     COMM,4              AS LAST WD STORED+1                  IOC72600
       SIL     200000              SET EOF BIT                          IOC72610
CDMX4  AXT     **,4                RESTORE IR4                          IOC72620
       TRA     SELM1               RETURN                               IOC72630
*                   ROUTINE TO REVERSE FILE CONTROLS                    IOC72640
*                   SI AND IR2 FROM FILE A TO FILE B                    IOC72650
CPY6   XCA     **                  SAVE AC                              IOC72660
       ENB     L(0)                TRAP PROTECT                         IOC72670
       PIA                         RESTORE CONTROL                      IOC72680
       STD     1,2                 BITS TO FILE                         IOC72690
       LXA     CPY7,1              SWITCH                               IOC72700
       LXA     FCW,2               TO OTHER                             IOC72710
       SXA     FCW,1               FILE                                 IOC72720
       SXA     CPY7,2                                                   IOC72730
       LAC     FCW,2               PLACE 2ND                            IOC72740
       CLA     1,2                 FILES CONTROL                        IOC72750
       ANA     DECRE               BITS IN SI                           IOC72760
       RIL     077777                                                   IOC72770
       OAI                                                              IOC72780
       TXH     *+2,4,-SEL2.4                                           $IOC72790
       ENB     TRAPS               ALLOW TRAPS                          IOC72800
       XCA                         RESTORE AC                           IOC72810
       TRA     1,4                 EXIT                                 IOC72820
       TTL     NON-DATA OPERATION CHECK FOR DISK                        IOC72830
*                                                                       IOC72840
D7909  AXT     **,4                                                    *IOC72850
       TRA     (NDSLX                                                (3)IOC72851
SVDID  PZE     **                                                      *IOC72860
       SXA     D7909,4                                                 *IOC72870
       CLA     1,4                                                   (3)IOC72871
       PDX     0,4                                                   (3)IOC72872
       CLA     5,2                                                     *IOC72880
       TMI     7KA                 1301                                *IOC72890
       ANA     SIX                                                     *IOC72900
       TZE     D7909                                                 (3)IOC72910
 HNDS  TXL     HND2,4,2                                              (3)IOC72940
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *IOC72950
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *IOC72960
       TNX     *+4,4,31            FOLLOWING ORDERS                    *IOC72970
       TXI     *+1,4,33            RWD,RUN                             *IOC72980
       TNX     *+2,4,35            BSR,BSF                             *IOC72990
       TXI     *+1,4,32            WTM                                 *IOC73000
HND1   SXD     *+2,4                                                   *IOC73010
       TSX     (NDSLX,4                                                *IOC73020
       PZE     0,2,**                                                  *IOC73030
HND2   LXA     D7909,4                                                 *IOC73040
       TRA     2,4                                                     *IOC73050
       BES     HNDS+NOHYP/NOHYP**-NOHYP/NOHYP*HNDS-*                    IOC73060
 7KA   TXL     DNDSEL+1,4,2                                          (3)IOC73061
       STI     SVDID                                                 (3)IOC73070
       STZ     TEMP                                                    $IOC73080
       LDQ     6,2                 CHECK FOR EOF                      *$IOC73090
       TQP     7KAA          NO                                      (3)IOC73100
       STL     TEMP                                                    $IOC73110
       SXA     *+2,4                                                 (3)IOC73111
       TSX     EOF,4               YES                                 $IOC73120
       AXT     **,4                                                  (3)IOC73130
 7KAA  ENB     TRAPS                                                 (3)IOC73140
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $IOC73180
       TXH     DWEF,4,5            BSF-6 WEF-7                         $IOC73190
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $IOC73200
       ZET     TEMP                                                    $IOC73210
       TRA     7KB                                                     $IOC73220
       CAL     7,2                 GET BOF AND                         $IOC73230
       ARS     18                  TEST IF POSITION                    $IOC73240
       SBM     6,2                 NOW, IS SAME                        $IOC73250
       ANA     ADDRS               IF SO                               $IOC73260
       TZE     DNDSEL              NO BACKSPACE - NOP                  $IOC73270
7KB    PXA     0,0                 GET COUNT OF TRACKS IN RECORD       $IOC73280
       LLS     5                   DEDUCT TRACKS                       $IOC73300
       SUB     6,2                 AND PUT IT BACK                     $IOC73310
       STA     6,2                 FOR NEXT SEEK                       $IOC73320
DNDSEL XEC     DIND                PLACE BACK AND                      $IOC73330
       LXA     D7909,4             RETURN                              $IOC73340
       TRA     2,4                                                     $IOC73350
DNDNOP LXA     D7909,4                                                 $IOC73360
DIND   LDI     SVDID                                                  *$IOC73370
       TRA     BSF5                                                    $IOC73380
NDSEL  EQU     SVDID                                                   $IOC73390
DWEF   SXA     DWEF1,4                                                 $IOC73400
       TXL     DBSF,4,6            BSF                                 $IOC73410
DBSF1  AXC     1,4                                                     $IOC73420
       CLA*    0,2                 GET 2ND WORD OF UCB                 $IOC73430
       TNZ     *-1                 WAIT FOR LAST WRITE                 $IOC73440
       ENB     L(0)                                                    $IOC73450
       CLA     6,2                                                     $IOC73460
       ANA     DECRE                                                   $IOC73470
       ARS     6                                                       $IOC73480
       STO     DSMSB                                                   $IOC73490
       SXA     DWEF6,2                                                 $IOC73500
       CLA     1,2                 TEST MODE                           $IOC73510
       ANA     MODBT                                                    IOC73520
       TZE     *+3                 BCD MODE                             IOC73530
       CLA     L(6)                BINARY MODE                          IOC73540
       TRA     *+2                                                      IOC73550
       CLA     L(22)                                                    IOC73560
       ORS     DSMSB                                                    IOC73570
       CLA     0,2                 GET UCB ADDRESS                     $IOC73580
       STA     DAXC                                                    $IOC73590
       CLA     6,2                                                     $IOC73600
       TSX     (DECVA,4                                                $IOC73610
DAXC   AXC     **,4                'L(UCB)                             $IOC73620
       CLS     2,4                 REQUEST SEEK                        $IOC73630
       STO     2,4                 WITH MINUS SIGN                     $IOC73640
       CLA     6,2                 AND CORRECT                         $IOC73650
       STA     3,4                                                     $IOC73660
       TSX     (FDAMT,2            IOEX ROUTINE TO SET ORDER           $IOC73670
DSMSB  BCI     1,00I006                                                $IOC73680
       PZE     DVTA                                                    $IOC73690
DWEF6  AXT     **,2                L(FCB)                              $IOC73700
       STL     DWAIT               MAKE WAIT CELL NONZERO              $IOC73710
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $IOC73720
       PXD     0,1                                                     $IOC73730
       STD     1,4                 SECOND WORD OF UCB                  $IOC73740
       TSX     (ACTVX,4            ACTIVATE CHAIN OF CHANNEL COMMANDS  $IOC73750
       MZE     0,2                                                     $IOC73760
       ZET     DWAIT               WAIT FOR SELECT MINUS                IOC73770
       TRA     *-1                 TO FINISH                           $IOC73780
       XEC     DWEF1                                                   $IOC73790
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $IOC73800
       CAL     6,2                 SET UP SEEK                         $IOC73810
       ACL     L(1)                AND FILE START                      $IOC73820
       STA     6,2                 ADDRESS FOR                         $IOC73830
       TSX     EOF,4               BACKSPACE FILE                      $IOC73840
       ENB     TRAPS                                                   $IOC73850
DWEF1  AXT     **,4                AT LAST                             $IOC73860
       AXT     **,1                                                    $IOC73870
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $IOC73880
       CAL     7,2                 GET BOT ADDRESS                     $IOC73890
       STD     0,2                 AND PUT IN BOTH                     $IOC73900
       ARS     18                  WORD ONE AND SEVEN                  $IOC73910
       STA     6,2                                                     $IOC73920
       TXL     DNDSEL,4,3                                              $IOC73930
       PXA     0,0                                                     $IOC73940
       STA     0,2                 ZERO OUT UCB                        $IOC73950
       XEC     DIND                RESTORE INDICATORS                  $IOC73960
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $IOC73970
       TRA     DNDSEL+1            RETURN                              $IOC73980
DWAIT  PZE                                                             $IOC73990
DVTA   DVTA    ,,                                                      $IOC74000
DBSF   LDI     6,2                 1ST TIME AROUND                     $IOC74010
       SXA     DWEF1+1,1                                               $IOC74020
       CLA     7,2                                                     $IOC74030
       STD     *+3                 IF AT                               $IOC74040
       CLA     0,2                 BOT DO NOT                          $IOC74050
       PDC     0,1                 DO THE                              $IOC74060
       TXI     *+1,1,**            BACKSPACE                           $IOC74070
       TXL     DNDNOP,1,0          FILE                                $IOC74080
       LFT     600000                                                  $IOC74090
       TRA     DBSF4               NOT 1ST TIME                        $IOC74100
       CLA     0,2                 EXCHANGE SEEK POINTER               $IOC74110
DBSF6  ARS     18                  TO BE BEGINNING                     $IOC74120
       STA     6,2                 OF THE FILE                         $IOC74130
       CAL     SIX                 PUT NOT FIRST                       $IOC74140
       STP     6,2                 TIME THRU FLAG ON                   $IOC74150
       LXA     DWEF1+1,1                                               $IOC74160
       TIX     DBSF,1,1            THERE IS ANOTHER TO DO -            $IOC74170
       TRA     DNDNOP              EXIT                                $IOC74180
DBSF4  LFT     200000                                                  $IOC74190
       TRA     DBSF5               NOT FIRST TIME THRU                 $IOC74200
       PIA     **                  PUT SEEK ADDRESS                    $IOC74210
       ALS     18                  AND BEGINNING OF                    $IOC74220
       STD     0,2                 FILE EQUAL                          $IOC74230
       TRA     DBSF6+2             EXIT                                $IOC74240
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $IOC74250
       SXA     DSELP+2,4           FOR BACKSPACE                       $IOC74260
       PIA                                                             $IOC74270
       SUB     L(1)                MAKE SEEK ADDRESS                   $IOC74280
       STA     6,2                 EOF ADDRESS                         $IOC74290
       TRA     DBSF1               GET FLAG FOR EOF                    $IOC74300
DBSF3  AXT     DCTL,4              RESTORE START                       $IOC74310
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $IOC74320
       CAL     DFLAG               GET NEW B.O.F.                      $IOC74330
       STD     0,2                 AND PUT IT IN THE                   $IOC74340
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $IOC74350
*                                                                      $IOC74360
DISUE  ACL     L(1)                GET ADDRESS OF                      $IOC74370
       STA     DSELM1              UCB + 1                             $IOC74380
       LXA     DWEF6,2             -L (FILE) IN IR2                    $IOC74390
       TPL     DSELP                                                   $IOC74400
       STZ     DWAIT                                                   $IOC74410
DSELM1 STZ     **                                                      $IOC74420
       TRA     1,4                 RETURN                              $IOC74430
DSELP  CAL     0,2                 PUT FILE                            $IOC74440
       STD     DFLAG               START POINT IN FLAG                 $IOC74450
       AXT     DCTL,2              COMM. LIST                          $IOC74460
       PXA     0,2                                                     $IOC74470
       STA*    (RCHXI                                                  $IOC74480
       XEC*    (RCHXI              SEL+ START CHANNEL                  $IOC74490
       TRA     1,4                 EOF LOCATION                        $IOC74500
*              7909 CHANNEL PROGRAM                                    $IOC74510
*                                                                      $IOC74520
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              IOC74530
       CTLW    DVTA                                                    $IOC74540
       CPYD    DFLAG,,1                                                $IOC74550
       TCH     SYSTWT                                                  $IOC74560
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $IOC74570
       CTLR    DVTA                FOR BACK SPACE                      $IOC74580
       TCH     DCTL+2              FILE ROUTINE                        $IOC74590
DFLAG  PTW                         EOF FLAG WORD                       $IOC74600
       BES     7KA+NOCH/NOCH**-NOCH/NOCH*7KA-*                          IOC74610
       TTL                         BSR (BACKSPACE RECORD) ROUTINE       IOC74620
*      TSX     BSR,4                                                    IOC74630
*      PZE     FILE,,BOFEX         BOFEX= BEGINNING OF FILE EXIT        IOC74640
       SPACE   1                                                        IOC74650
*      ACTIONS                                                          IOC74660
*             1. UNBUFFERS FILE                                         IOC74670
*             2. BSR GIVEN AND BLOCK SEQ. REDUCED BY ONE                IOC74680
*             3. IF FILE AT FILE -N- RECORD -0-  BOF EXIT OCCURS        IOC74690
       SPACE   1                                                        IOC74700
BSR.   TRA     BSCKS               PERFORM CHECKS AND UNBUFFER          IOC74710
       RNT     600000              READ BACKWARD                       $IOC74720
       TRA     *+5                 NO                                  *IOC74730
       TSX     (NDSLX,4                                                $IOC74740
       PZE     0,2,HSKRP           SKIP FORWARD                        $IOC74750
       CLA     1DEC                                                    *IOC74760
       TRA     BSR2                                                    $IOC74770
       BES     *-6+NOHYP/NOHYP*6-*                                      IOC74780
       TSX     NDSEL+1,4           EXECUTE                              IOC74790
       PZE     0,2,BSROP           BACKSPACE                            IOC74800
       CLS     1DEC                                                    *IOC74810
BSR2   ADM     3,2                 ADJUST BLOCK                        *IOC74820
       STD     3,2                 SEQUENCE NUMBER                     *IOC74830
       LDQ     5,2                                                     $IOC74840
       TQP     *+4                                                     $IOC74850
       ZET     TEMP                                                    $IOC74860
       TRA     BOFEX                                                   $IOC74870
       TRA     COMXIT                                                  $IOC74880
       BES     *-5+NOCH/NOCH*5-*                                        IOC74890
       AXC     2,4                 IF CURRENT POSITION                 $IOC74900
       CLA*    0,2                 IS AT FILE -N-                      $IOC74910
       ANA     ADDRS               RECORD -0- THEN GIVE                $IOC74920
       ERA     ADDRS               =BEGINNING OF FILE= EXIT            $IOC74930
       TNZ     COMXIT                                                  $IOC74940
       STD     3,2                                                     $IOC74950
       TRA     BOFEX                                                   $IOC74960
*                 ENTRY ROUTINE COMMON TO BSR AND BSF                   IOC74970
BSCKS  LNT     OPEND               IF FILE NOT OPEN                     IOC74980
       TRA     COMXIT              TAKE NORMAL EXIT                     IOC74990
       TSX     FNLBC,4             FIND L(POOL)                         IOC75000
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     IOC75010
       LFT     OUTPUT              IF INPUT FILE                        IOC75020
       TRA     BSC2                UNBUFFER                             IOC75030
       TSX     UNBFI,4             INPUT                                IOC75040
BSC1   LAC     GO,1                LOAD -L(BSR.) OR -L(BSF.)            IOC75050
       LDQ     5,2                                                     $IOC75060
       RQL     1                                                       $IOC75070
       RIR     200000                                                  $IOC75080
       TQP     *+2                 NOT HYPER                           $IOC75090
       SIR     200000              HYPER                               $IOC75100
       BES     *-5+NOHYP/NOHYP*5-*                                     $IOC75110
       TRA     1,1                 AND RETURN                           IOC75120
BSC2   TSX     UNBFO,4             UNBUFFER OUTPUT                      IOC75130
       TRA     BSC1                FILE                                 IOC75140
       TTL     CONSTANT POOL                                            IOC75150
XCPTP  OCT     077777777777                                            $IOC75160
L(64D) PZE     0,,64                                                    IOC75170
PDMSK  SVN     ,,-1                                                     IOC75180
1P5    BCI     1,000010                                                *IOC75190
HLBLK  BCI     1, 0000                                                 $IOC75200
       SPACE   1                                                        IOC75210
*                          TEMPORARY STORAGE                            IOC75220
HOLDS  PZE     *                   CHAIN CELL                           IOC75230
TCHEX  PZE     **                  TCH SWITCH                           IOC75240
7GRP   PZE     **                  CLOSE RESERVE GROUP ERASEABLE        IOC75250
TEMP   PZE     **                  ERASEABLE STORAGE                    IOC75260
BASIO  BSS     0                   END MINIMUM IOBS                     IOC75270
       TTL                         JOIN TWO BUFFER POOLS                IOC75280
*      TSX     JOIN,4                                                   IOC75290
*      PZE     POOL1,,POOL2                                             IOC75300
       SPACE   1                                                        IOC75310
*            1.POOL2 IS APPENDED TO POOL1                               IOC75320
*            2.POOL2 MUST HAVE AT LAST REFERENCE BEEN DEFINED           IOC75330
*            3.POOL1 MAY HAVE FILES ATTACHED                            IOC75340
*            4.POOL1 OR POOL2 MUST NOT HAVE                             IOC75350
*              PREVIOUSLY JOINED ELSEWHERE                              IOC75360
*            5.AFTER TSX JOIN,4 POOL2 NO LONGER EXISTS                  IOC75370
       SPACE   1                                                        IOC75380
JOIN.  LDC     XEOB,1              CHECK IF EITHER                      IOC75390
       LDI     1,1                 FILE JOINED                          IOC75400
       OSI     1,2                 ELSEWHERE                            IOC75410
       RFT     100000              IF SO GIVE                           IOC75420
       TRA     PERR                ''POOL ERROR''                       IOC75430
       CAL     1,1                 CHECK IF BUFFERS ARE                 IOC75440
       ERA     1,2                 THE SAME SIZE                        IOC75450
       ARS     22                  IF NOT GIVE                          IOC75460
       TNZ     PERR                POOL ERROR                           IOC75470
       ENB     L(0)                TRAP PROTECT                         IOC75480
       LDQ     0,2                 JOIN THE BUFFER POOLS                IOC75490
       CLA     0,1                 BY-                                  IOC75500
       STA     0,2                 CHAIN (1) TO END CHAIN(2)            IOC75510
       XCA                         CHAIN(2) TO CHAIN(1)                 IOC75520
       STA*    1,1                                                      IOC75530
       ACL     0,1                 SUM BUFFER COUNTS                    IOC75540
       STD     0,2                 AND SET IN POOL1                     IOC75550
       ENB     TRAPS               ALLOW TRAPS                          IOC75560
       CAL     *+1                 SET JOINED                           IOC75570
       STT     1,1                 CODE INTO POOL2                      IOC75580
       TRA     EX24                EXIT                                 IOC75590
       TTL                         COPY AND STASH ROUTINES              IOC75600
*      TSX     COPY,4              TSX  STASH,4                         IOC75610
*      PZE     FILE1,,FILE2        PZE  FILE1,,FILE2                    IOC75620
*                                  PZE  NTS                             IOC75630
*                             COMMENTS...                               IOC75640
*             1. NO ACTION IF NO INPUT BUFFER                           IOC75650
*             2. PRESENT OUTPUT BUFFER,IF ANY, TRUNCATED                IOC75660
STASH. TXI     *+1,4,-1            SETUP L( NORMAL EXIT)                IOC75670
       SXA     GTIOX,4                                                  IOC75680
       CLA     -1,4                SAVE                                 IOC75690
       STA     XEOF                NTS EXIT                             IOC75700
       SIR     STSH                SET STASH MODE                       IOC75710
COPY.  LNT     OPEND               IF INPUT FILE                        IOC75720
       TRA     COMXIT              NOT OPEN THEN EXIT                   IOC75730
       TSX     FNLBC,4             FIND L(POOL)                         IOC75740
       LXD     XEOB,1              SET FILE2 INTO                       IOC75750
       SXA     CPY7,1              SWITCHING ROUTINE                    IOC75760
       LAC     CPY7,1                                                  $IOC75770
       ERA     4,1                 FIND OUT IF FILE1 AND               $IOC75780
       ANA     DECRE               FILE2 ARE IN THE SAME POOL          $IOC75790
       TNZ     GET4                THEY ARE NOT                        $IOC75800
       TSX     CPY6,4              SWITCH TO OTHER FILES CONTROLS       IOC75810
       LNT     OPEND               IF OUTPUT FILE                       IOC75820
       TRA     COMXIT              NOT OPEN ,THEN EXIT                  IOC75830
       STL     CPY2+1              SET COPY MODE                        IOC75840
       NOP     CPY2+2              TRA*                                 IOC75850
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     IOC75860
       TSX     TRUNC,1             TRUNCATE ANY OUTPUT BUFFER           IOC75870
       RFT     STSH                BRANCH TO                            IOC75880
       TRA     STSH1               STASH ROUTINE                        IOC75890
CPY1   TSX     CPY6,4              REVERSE FILE BITS TO FILE1           IOC75900
       RIR     CPYHLD              RESET COPY HOLD                      IOC75910
CPY2   SIR     CPYFN               SET COPY MODE FOR RELES+TRUNC        IOC75920
       TRA*    **                  DUMMY TRANSFER FOR CASES 2 + 4 STASH IOC75930
       CLA*    2,2                 IF NO BUFFERS ATTACHED               IOC75940
       STA     CPY6                SAVE L( POSSIBLE HOLD CHAIN)         IOC75950
       TPL     CPY3                TO FILE , THEN EXIT                  IOC75960
       SIR     CPYHLD              SET HOLD CHAIN COPY                  IOC75970
       ANA     1PRE                IS NEGATIVE BUFFER                   IOC75980
       TZE     COMXIT              A HELD BUFFER OR THE POOL            IOC75990
       CLA     2,2                 SETUP BUFFER AS                      IOC76000
       PAC     0,4                 IF JUST FILLED BY WRITE              IOC76010
       CLA     1,4                 ROUTINE                              IOC76020
       STA*    2,2                                                      IOC76030
       LDQ     L(0)                                                     IOC76040
       SLQ*    2,2                                                      IOC76050
CPY3   CLA     2,2                 ATTACH INPUT                         IOC76060
       TSX     CPY6,4              BUFFER TO                            IOC76070
       STA     2,2                 OUTPUT FILE                          IOC76080
       TSX     TRUNC,1             TRUNCATE TRANSFERRED BUFFER          IOC76090
       TSX     CPY6,4              RELEASE ASSIGNMENT                   IOC76100
       LAC     LBC,4               (-L(POOL) TO IR4)                    IOC76110
       LDQ     2,2                 FROM INPUT                           IOC76120
       TSX     POOLRD,1            FILE                                 IOC76130
       TSX     CKGIV,1             DO PRIORITY FOR RELEASE              IOC76140
       SIR     CPYFN               SET COPY FUNCTION BIT BACK ON        IOC76150
       RIL     GIVUP               RESET GIVUP PRIORITY                 IOC76160
       CLA     CPY6                                                     IOC76170
       RNT     CPYHLD              IF NOT A HELD BUFFER                 IOC76180
       CLA     LBC                 L(POOL) TO AC                        IOC76190
       STA     2,2                                                      IOC76200
       RNT     CPYHLD              IF COPYING A HELD BUFFER             IOC76210
       TRA     COMXIT              CONTINUE ELSE EXIT                   IOC76220
       TRA     CPY2-1                                                  $IOC76230
       SPACE   1                                                        IOC76240
*                     STASH MASTER CONTROL ROUTINE                      IOC76250
STSH1  STZ     XEOB                SET STASH SWITCH =0                  IOC76260
       CLA     3,2                 FOR CASES 2 AND 4 (FILE2 INTERNAL    IOC76270
       TMI     STSH3               OUTPUT) SKIP TO STSH3                IOC76280
       TSX     CPY6,4              IF FILE2 REGULAR OUTPUT              IOC76290
       LFT     OUTPUT              AND FILE1 IS AN INTERNAL OUTPUT      IOC76300
       TRA     STSH2               (CASE 1) , SKIP TO STSH2             IOC76310
       TRA     CPY2-1              CASE 3 USES COPY ROUTINE             IOC76320
*             TRANSFER OF FIRST BUFFER OF A FILE (CASE 1)               IOC76330
STSH2  TSX     TRUNC,1             TRUNCATE ANY OUTPUT PREPARED         IOC76340
       CLA*    0,2                 IF NO OUTPUT IN REGEN CHAIN          IOC76350
       TZE     EOF.0+1             YET TAKE NTS EXIT                    IOC76360
       LDQ     0,2                 REMOVE 1ST                           IOC76370
       STA     0,2                 BUFFER FROM                          IOC76380
       ZET*    0,2                 FILE1'S REGEN                        IOC76390
       STD*    0,2                 CHAIN AND PLACE                      IOC76400
       STQ     TEMP                INTO REGULAR OUTPUT FILE             IOC76410
       LAC     TEMP,4              FOR ACTUAL OUTPUT                    IOC76420
       CLA     1,4                 SETUP BUFFER SO LOCATOR              IOC76430
       STZ     0,4                 SHOWS BUFFER CONTENT                 IOC76440
       STA     0,4                                                      IOC76450
       ENB     L(0)                TRAP PROTECT                         IOC76460
       TSX     BCKBB,1             RELEASE ONE FROM OUTPUT-1            IOC76470
       CAL     3,2                 REDUCE                               IOC76480
       ACL     DECRE               SEQUENCE                             IOC76490
       STD     3,2                 COUNT BY ONE                         IOC76500
       TSX     CPY6+1,4            SWITCH TO FILE 2 BITS                IOC76510
       STA     2,2                 OUTPUT                               IOC76520
       SIR     CPYFN                                                    IOC76530
       TSX     TRUNC,1             BUFFER                               IOC76540
       TRA     COMXIT              EXIT                                 IOC76550
       EJECT                                                            IOC76560
*                       SETUP CASES 2 + 4 STASH                         IOC76570
STSH3  STL     CPY2+1              SET TRANSFER TO                      IOC76580
       NOP     STSH4               STASH EXIT TEST                      IOC76590
       TRA     CPY1                FOR NTS CONDITIONS                   IOC76600
*      CASES 2 AND 4 STASH EXECUTION (TESTS COUNTS BEFORE COPY)         IOC76610
STSH4  STZ     XEOB                SET STASH SWITCH=0                   IOC76620
       CLA*    2,2                 IF NO NEXT                           IOC76630
       TPL     STSH5               BUFFER TO BE                         IOC76640
       ANA     1PRE                STASHED,THEN                         IOC76650
       TZE     COMXIT              EXIT                                 IOC76660
STSH5  TSX     CPY6,4              CHANGE TO FILE 2 BITS                IOC76670
       TSX     TOKBB,4             CAN FILE2 ACCEPT A BUFFER            IOC76680
       TRA     STSH6               -NO                                  IOC76690
       TSX     CPY6,4              BACK TO FILE 1 BITS                  IOC76700
       TRA     CPY2+2              COPY THAT BUFFER                     IOC76710
STSH6  TSX     CPY6,4              BACK TO FILE 1 BITS                  IOC76720
       ZET     XEOB                IF SWITCH NOT =0 COUNT               IOC76730
       TRA     STSH7               MUST BE RESTORED AND NTS EXIT TAKEN  IOC76740
       CLA     1,2                 IF PRIME BUFFER                      IOC76750
       SUB     L(400)              COUNT SHOULD NOT                     IOC76760
       PAX     0,1                 BE ADJUSTED                          IOC76770
       TXL     EOF.0+1,1,0         TAKE NTS EXIT                        IOC76780
       STL     XEOB                STE SWITCH NOT =0 FOR 2 ND TIME THRU IOC76790
       ENB     L(0)                TRAP PROTECT                         IOC76800
       TSX     BCKBB,1             RELEASE COUNT FROM INPUT             IOC76810
       TRA     STSH5               SEE IF THAT WILL ALLOW OUTPUT        IOC76820
STSH7  TSX     TOKBB,4             RESTORE BUFFER COUNT TO FILE1        IOC76830
       STL     XEOB                ERROR IF THIS INSTRUCTION EXECUTED   IOC76840
       TRA     EOF.0+1             TAKE NTS EXIT                        IOC76850
       TTL                         BSF (BACKSPACE FILE) ROUTINE         IOC76860
*      TSX     BSF,4                                                    IOC76870
*      PZE     FILE,,CT                                                 IOC76880
       SPACE   1                                                        IOC76890
*      ACTIONS                                                          IOC76900
*             1. UNBUFFERS FILE                                         IOC76910
*             2. GIVES CT NUMBER OF BSF'S                               IOC76920
*             3. FORWARD SPACE ONE RECORD (OVER EOF MARK) EXCPT AT LOAD IOC76930
*             4. IF CT =0 ,FILE ONLY UNBUFFERS                          IOC76940
       SPACE   1                                                        IOC76950
BSF.   TRA     BSCKS               PERFORM CHECKS AND UNBUFFER          IOC76960
       LXD     XEOB,1              IF BSF COUNT                         IOC76970
       TXL     COMXIT,1,0          =0 JUST EXIT                         IOC76980
       RNT     600000              HYPER BACKWARD READ                 $IOC76990
       TRA     BSF1-1              NO                                  $IOC77000
       TSX     (NDSLX,4                                                $IOC77010
       PZE     0,2,HSKFP           FORWARD SPACE FILE                  $IOC77020
       AXC     0,4                                                     $IOC77030
       LDQ*    0,2                                                     $IOC77040
       RQL     18                                                      $IOC77050
       TQP     BSF1+4                                                  $IOC77060
       TRA     HBSF                                                    $IOC77070
       BES     *-9+NOHYP/NOHYP*9-*                                     $IOC77080
       TSX     NDSEL+1,4           BACKSPACE                            IOC77090
BSF1   PZE     0,2,BSFOP           N FILES                              IOC77100
       AXC     2,4                 IF AT LOAD                           IOC77110
       NZT*    0,2                 POINT DONT                           IOC77120
       TRA     BSF2                MOVE FORWARD                         IOC77130
       TIX     BSF1-1,1,1          OR CONTINUE TO BACKSPACE            $IOC77140
       RNT     600000                                                  $IOC77150
       TRA     *+4                                                     $IOC77160
HBSF   TSX     (NDSLX,4            MOVE OVER FILE MARK                 $IOC77170
       PZE     0,2,HBSFP           BACKSPACE FILE                      $IOC77180
       TRA     BSF5                                                    $IOC77190
       RNT     400000              HYPER                               $IOC77200
       TRA     *+4                 NO                                  $IOC77210
       TSX     (NDSLX,4            SKIP OVER                           $IOC77220
       PZE     0,2,HSKFP           EOF                                 $IOC77230
       TRA     BSF5                                                    $IOC77240
       BES     *-10+NOHYP/NOHYP*10-*                                   $IOC77250
       RIL     OUTPUT              SET FOR READ                        $IOC77260
       LDQ     BSF3                ISSUE DUMMY READ                     IOC77270
       TSX     RDSEL,1             ACROSS EOF MARK                      IOC77280
       NZT*    4,2                 WAIT TILL                            IOC77290
       TRA     *-1                 READ DONE                            IOC77300
BSF5   SIL     NINHIB              SET NOT INHIBITED                    IOC77310
       CAL     1,2                 SET INDICATORS                      $IOC77320
       ANA     EOFBT               TO THE CORRECT                      $IOC77330
       OAI                         STATUS READ OR WRITE                $IOC77340
       CLA     L(0)A               SET SYNC                             IOC77350
       STA     4,2                 CHAIN EQUAL ZERO                     IOC77360
BSF2   PXA     0,0                 CLEAR BLOCK SEQUENCE                 IOC77370
       TRA     BSR2                COUNT                                IOC77380
BSF3   PZE     *+1                 DUMMY BUFFER FOR DUMMY               IOC77390
       PZE     L(0),,0             READ ACROSS EOF                      IOC77400
       IORT    **,,0                                                   $IOC77410
       PZE     **                                                      $IOC77420
       TTL                         REWIND AND WRITE EOF ROUTINES        IOC77430
*                          CALLING SEQUENCES                            IOC77440
*      TSX     REW(WEF),4                                               IOC77450
*      PZE     FILE,,EOT                                                IOC77460
*      RETURN                                                           IOC77470
*                                WHERE                                  IOC77480
*                   FILE SPECIFIES THE DESIRED FILE                     IOC77490
*                               COMMENTS                                IOC77500
*              1. WEF ON INPUT IS A NOP                                 IOC77510
*              2. WEF OR REW ON LABELLED FILE IS NOP                    IOC77520
*              3. EOT EXIT IS TAKEN IF EOT OCCURS ON WEF                IOC77530
*                 IF OP IS REW AND EOT NON-ZERO,HYPER IS FILE-PROTECTED IOC77540
*              4. ANY EOF THAT HAS BEEN DETECTED BUT NOT                IOC77550
*                 YET LOGICALLY REACHED IS CANCELLED DUE TO THE         IOC77560
*                 UNBUFFERING PROCESS THAT TAKES PLACE                  IOC77570
       SPACE   1                                                        IOC77580
REW.   AXT     REWOP,1             REWIND ENTRY                         IOC77590
       CLA     5,2                                                     *IOC77600
       ANA     SIX                 IS THIS 7340                        *IOC77610
       TZE     *+7                 NO                                  *IOC77620
       LXD     XEOB,4              IS FILE PROTECT DESIRED             *IOC77630
       TXL     *+5,4,0             NO                                  *IOC77640
       TSX     (NDSLX,4            YES                                 *IOC77650
       PZE     0,2,HFPNP                                               *IOC77660
       BES     REW.+1+NOHYP/NOHYP**-NOHYP/NOHYP*REW.-NOHYP/NOHYP-*      IOC77670
       TRA     *+2                 PRESET REW OP CODE                   IOC77680
WEF.   AXT     WEFOP,1             WEF ENTRY                            IOC77690
       LNT     LABEL               IF FILE IS LABELLED OR               IOC77700
       LNT     OPEND               NOT OPEN THEN                        IOC77710
       TRA     COMXIT              EXIT                                 IOC77720
       SXD     REW4,1              SET OP CODE                          IOC77730
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     IOC77740
       LNT     OUTPUT              IF FILE IS A                         IOC77750
       TRA     *+2                 CKPT FILE THEN SKIP                  IOC77760
       TRA     REW3                DIRECTLY TO ND SEL                   IOC77770
       TSX     FNLBC,4             FIND L(POOL)                         IOC77780
       LFT     OUTPUT              IS FILE INPUT                        IOC77790
       TRA     REW2                OR OUTPUT                            IOC77800
       LXD     REW4,1              SELECT TO IR1                        IOC77810
       TXI     *+1,1,-WEFOP        WEF ON INPUT FILE                    IOC77820
       TXL     COMXIT,1,0          IS A NOP                             IOC77830
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  IOC77840
       TRA     REW3                                                     IOC77850
REW2   TSX     UNBFO,4             UNBUFFER OUTPUT                      IOC77860
REW3   TSX     NDSEL+1,4           REQUEST                              IOC77870
REW4   PZE     0,2,**              REW OR WEF                           IOC77880
       SIL     NINHIB              CANCEL ANY EOF                       IOC77890
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           IOC77900
       NZT*    4,2                 CHECK FOR EOT                        IOC77910
       TRA     COMXIT              EXIT                                 IOC77920
       LDC     XEOB,4              TAKE                                 IOC77930
       SXA     GTIOX,4             EOT                                  IOC77940
       TRA     COMXIT              EXIT                                 IOC77950
       TTL                   INTERNAL FILE OPEN                         IOC77960
INTOP  CAL     -1,4                PLACE OPTION                         IOC77970
       ARS     33                  BITS IN SI                           IOC77980
       OAI                                                              IOC77990
       RNT     INTRD               READ OR                              IOC78000
       TRA     IOP3                WRITE                                IOC78010
       RIL     OUTPUT              SET INPUT TYPE                       IOC78020
       CLA     3,2                 SET                                  IOC78030
       ARS     18                  SEQ CT+1                             IOC78040
       ACL     L(1)                AS THE                               IOC78050
       STA     1,2                 NUMBER OF BUFFERS                    IOC78060
       STD     3,2                 AVAILABLE                            IOC78070
       CLA     0,2                 SET RE-GENERATIVE                    IOC78080
       STA     4,2                 BUFFER CHAIN SYNC                    IOC78090
       CLA     L(0)A               SET RE-GEN                           IOC78100
       STA     0,2                 = L(0)                               IOC78110
       PIA                         SET READ                             IOC78120
       ARS     2                   MODE (DESTRUCTIVE                    IOC78130
       ALS     35                  OR NOT)                              IOC78140
       STP     2,2                                                      IOC78150
       TRA     OP1                 EXIT                                 IOC78160
IOP3   RNT     RETAIN                                                   IOC78170
       TSX     DESTRY,4                                                 IOC78180
       SIL     PTO                                                      IOC78190
       CAL     L(0)A                                                   $IOC78200
       ENB     TRAPS                                                    IOC78210
       STA     4,2                                                     $IOC78220
       TRA     OP1                                                      IOC78230
       SPACE   1                                                        IOC78240
*              DESTROY CONTENT OF FILE (RELEASE TO POOL)                IOC78250
DESTRY PXA     0,0                 SET                                  IOC78260
       STA     1,2                 BUF IN USE CT                        IOC78270
       STD     3,2                 AND SEQ CT =0                        IOC78280
       SXA     DEST2,4             SAVE IR4                             IOC78290
       TSX     FNLBC,4             FIND L(POOL)                         IOC78300
       LAC     LBC,4               L(POOL) 0O IR4                       IOC78310
DEST1  CLA*    0,2                 RELEASE                              IOC78320
       TZE     DEST2               ALL                                  IOC78330
       LDQ     0,2                 BUFFERS                              IOC78340
       ENB     L(0)                                                     IOC78350
       STA     0,2                 IN USE                               IOC78360
       TSX     BTP1,1                                                   IOC78370
       TSX     BCKBF+2,1                                                IOC78380
       TRA     DEST1                                                    IOC78390
DEST2  AXT     **,4                RESTORE IR4                          IOC78400
       TRA     1,4                 EXIT                                 IOC78410
       TTL                         INTERNAL FILE CLOSE                  IOC78420
INTCL  LFT     OUTPUT              DISCONNECT                           IOC78430
       TRA     *+3                 ANY BUFFERS                          IOC78440
       TSX     DISCON,1            IN USE                               IOC78450
       TRA     *+2                                                      IOC78460
       TSX     TRUNC,1                                                  IOC78470
       CAL     3,2                 SUM                                  IOC78480
       ARS     18                  BUFFERS IN                           IOC78490
       ACL     1,2                 USE CT AND                           IOC78500
       ALS     18                  SEQ CT FOR                           IOC78510
       LFT     OPEND               FILE OPEN                           $IOC78520
       LFT     OUTPUT              TRUE NUMBER OF BUFFERS               IOC78530
       TRA     *+2                 ADJUST COUNT                         IOC78540
       SUB     1DEC                BY ONE AS AN EXTRA                   IOC78550
       STD     3,2                 WAS ADDED WHEN INPUT                 IOC78560
       STA     1,2                 WAS OPENED                           IOC78570
       CLA*    0,2                 FORM IN                              IOC78580
       TZE     ICL2                0,2 THE                              IOC78590
       PDC     0,1                 COMPLETE                             IOC78600
       CLA     4,2                 CHAIN OF                             IOC78610
       STA     0,1                 BUFFERS                              IOC78620
       CLA*    4,2                 THAT ARE                             IOC78630
       TZE     *+2                 CURRENTLY                            IOC78640
       STD*    0,2                 IN USE                               IOC78650
ICL1   CLA     L(0)A               BY THE FILE                          IOC78660
       STA     4,2                                                      IOC78670
       RNT     RETAIN              IF BUFFERS ARE NOT TO BE             IOC78680
       TSX     DESTRY,4            RETAINED RELEASE THEM TO POOL        IOC78690
       TRA     SH4.1               EXIT                                 IOC78700
ICL2   CLA     4,2                 IF RE-GEN =L(0)                      IOC78710
       STA     0,2                 SET SYNC CHAIN                       IOC78720
       TRA     ICL1                IN THERE                             IOC78730
       TTL                         ENTER BUFFER INTO INTERNAL FILE      IOC78740
ENTIN  SXA     EIN,1               SAVE IR1                             IOC78750
       XCA                         SAVE L(BUF) IN MQ                    IOC78760
       CLA*    0,2                 INSERT BUFFER                        IOC78770
       TNZ     *+3                 INTO RE-GENERATIVE CHAIN             IOC78780
       LAC     FCW,1               SETTING UP IR1 AS L(FILE)            IOC78790
       TRA     *+2                 IF NO CHAIN EXISTS                   IOC78800
       PDC     0,1                 L(END) CHAIN TO IR1                  IOC78810
       XCA                         L(BUF) TO AC                         IOC78820
       STA     0,1                                                      IOC78830
       LDQ     L(0)D                                                    IOC78840
       LGL     18                                                       IOC78850
       STO*    0,1                                                      IOC78860
       STD*    0,2                                                      IOC78870
EIN    AXT     **,1                                                     IOC78880
       TRA     1,1                                                      IOC78890
       TTL  IOCS REQUESTED CHECKPOINT BY USER ON CHECKPOINT FILE        IOC78900
*           OR OPERATOR VIA SENSE SWITCH ON CHECKPOINT FILE             IOC78910
       SPACE   1                                                        IOC78920
CKPT.  STI     CPT2                SET CKPT ON CKPT                     IOC78930
       LDI     1PRE                FILE CODE =(01)                      IOC78940
       TRA     CPINT+2             GO INITIATE CHECKPOINT               IOC78950
*                     INTERNAL INITIATE CHECKPOINT                      IOC78960
*              INITIATES ON CODE SPECIFIED WITH FILE BITS               IOC78970
       SPACE   1                                                        IOC78980
*      TSX     CPINT,4                                                  IOC78990
*      RETURN                                                           IOC79000
       SPACE   1                                                        IOC79010
CPINT  STI     CPT2                SAVE SI                              IOC79020
       LDI     1,2                 FILE BITS                            IOC79030
       SXA     CPT1,4              TO SI                                IOC79040
       LFT     CP1+CP2                                                 $IOC79050
       TRA     CPT3                IF CODE=(00) NO CKPTS                IOC79060
       LDI     CPT2                RESTORE SI                           IOC79070
CPT1   AXT     **,4                RESTORE IR4                          IOC79080
       TRA     1,4                 EXIT                                 IOC79090
CPT2   PZE     0,,0                SI TEMP STORAGE                      IOC79100
CPT3   LNT     CP2                 IS CHECKPOINT                       $IOC79110
       TRA     CPT4                REQ'D ON CKPT FILE                   IOC79120
       LXA     CPFILE,4            YES                                  IOC79130
       TRA     CPT5                                                     IOC79140
CPT4   LFT     OUTPUT              IS OUTPUT FILE                       IOC79150
       LNT     LABEL               LABELLED,IF NOT                      IOC79160
       TRA     CPT1-1              CKPT NOT ALLOWED                     IOC79170
       LXA     FCW,4               IF CKPT FILE OR FILE                 IOC79180
CPT5   SXA     CPT6,4              TO BE WRITTEN ON                     IOC79190
       TXL     CPT1-1,4,0          DOESNT EXIST THEN EXIT               IOC79200
       CAL     LFLBLK              MOVE FILE BLOCK LOCATION             IOC79210
       SLW     CPT6+1              INTO CKPT                            IOC79220
       TSX     CKPT1,4             CALL                                 IOC79230
CPT6   PZE     **,,CPSEQ                                                IOC79240
       PZE     **,,**                                                   IOC79250
       TRA     CPT1-1              IGNORE CKPT ERROR                    IOC79260
       CAL     CPSEQ               ADVANCE                              IOC79270
       ACL     L(1)                CPSEQ NUMBER                         IOC79280
       TSX     BCDCV,4                                                  IOC79290
       ACL     6PRE                ADD HI -BLANK                        IOC79300
       SLW     CPSEQ                                                    IOC79310
       TRA     CPT1-1              EXIT                                 IOC79320
CPSW   PZE     **,,0               =0 IF CKPT SENSE SWITCH WAS UP       IOC79330
       TTL     CHECKPOINT ROUTINE PART 1 -DUMP                          IOC79340
*                           CALLING SEQUENCE                            IOC79350
*      TSX     CKPT1,4                                                  IOC79360
*      PZE     FILE,T,L(ID)                                             IOC79370
*      P       L,,N                                                     IOC79380
*              ERROR RETURN                                             IOC79390
*              NORMAL RETURN                                            IOC79400
*               IF P=PZE, L IS LOCATION OF MESSAGE BLOCK                IOC79410
       SPACE   1                                                        IOC79420
*                  =MZE, LS IS LOCATION OF FCW BLOCK                    IOC79430
*       UPON RETURN THE ACCUMULATOR CONTAINS THE RESTART CODE--         IOC79440
*      PZE     FILE CT,DN,TAPE ADDRESS                                  IOC79450
       SPACE   1                                                        IOC79460
*   ERROR RETURN IS GIVEN, IF CHECKPOINT DUMP IS ATTEMPTED AT OTHER     IOC79470
*            THAN BEGINNING OF FILE OR ON UNAVAILABLE TAPE.             IOC79480
CHCPT  STL     CHP3                                                     IOC79490
       TTR     STORE                                                    IOC79500
       LXD     SYSUCW,2                                                 IOC79510
       SXD     *+2,2                                                    IOC79520
       LXA     SYSUCW,2                                                 IOC79530
       TXI     *+1,2,**                                                 IOC79540
       TXI     *+1,2,2                                                  IOC79550
       SXA     CHP41,2                                                  IOC79560
       LXD     SYSUCW,2                                                 IOC79570
       CLS     SYSUCW                                                   IOC79580
       STO     CHP25+1                                                 *IOC79590
CHP41  LDI     **,2                TEST FOR COMPLEMENT RECORD COUNT.    IOC79600
       RFT     400000                                                   IOC79610
       TRA     CHP40                                                    IOC79620
       TIX     *-3,2,4                                                  IOC79630
       CAL     TRPCH                                                    IOC79640
       ALS     -1,1                IR1=CH. NO.                         $IOC79650
       ANA     (TRAPS                                                   IOC79660
       SLW     ONETRP                                                   IOC79670
       LAC     CHP1,1              -L(UCW)                              IOC79680
       LDI     0,1                 UCW WORD1                            IOC79690
       LFT     400000                                                  $IOC79700
       TXI     CHPX2,4,1           THE TAPE IS UNAVAILABLE              IOC79710
       AXT     ONETRP,4                                                 IOC79720
       SXA     (TRAPX,4                                                 IOC79730
       TSX     ACTV,4              HOLD UNTIL THIS UNIT IS FREE         IOC79740
       MZE     CHP1                                                     IOC79750
       ZET     1,1                                                      IOC79760
       TRA     *-1                                                      IOC79770
       LDI     2,1                 CURRENT TAPE POSITION                IOC79780
       LXA     CHPX4,4                                                  IOC79790
       RFT     777777              TEST FOR BEGINNING OF FILE           IOC79800
       TXI     CHPX2,4,1                                                IOC79810
       CAL     2,4                                                      IOC79820
       STA     CHP14+2             SET UP IORT FOR MESSAGE BLOCK        IOC79830
       STD     CHP14+2                                                  IOC79840
       ORA     FCW                                                     $IOC79850
       STP     CHP14+2                                                  IOC79860
       CAL     1,4                                                      IOC79870
       PDX     0,4                 SET UP IOCP FOR IO                   IOC79880
       SXA     CHP14,4                                                  IOC79890
       CAL*    CHP14               ID INTO MESSAGE                      IOC79900
       SLW     CMT5+2                                                   IOC79910
CHPSS  PIA     **                                                       IOC79920
       LGR     33                  MOVE INFO TO MQ                     $IOC79930
       CAL     0,1                                                      IOC79940
       ARS     15                                                       IOC79950
       LGR     21                                                       IOC79960
       AXT     36,4                                                     IOC79970
       ALS     3                   LEFT HALF OF RESTART CODE            IOC79980
       LGL     3                                                        IOC79990
       TIX     *-2,4,6                                                  IOC80000
       SLW     CMT5+4                                                   IOC80010
       PXD     0,0                                                      IOC80020
       ALS     3                   RIGHT HALF OF RESTART CODE           IOC80030
       LGL     3                                                        IOC80040
       TIX     *-2,4,1                                                  IOC80050
       LDQ     BLNKS                                                    IOC80060
       LGR     6                                                        IOC80070
       STQ     CMT5+6                                                   IOC80080
       ORA     SIX                                                      IOC80090
       SLW     CMT5+5                                                   IOC80100
       LDQ     0,1                                                      IOC80110
       TSX     CVPRT,4             PRINT CHECKPOINT LINE                IOC80120
       PZE     CMT5,,7+512*DBLSP                                        IOC80130
       AXT     (TRAPS,4                                                 IOC80140
       SXA     (TRAPX,4                                                 IOC80150
       STI     CHPTP                                                   $IOC80160
       LDI     0,1                                                     $IOC80170
       CLA     2,1                 UPDATE CHECKPOINT TAPE POSITION     $IOC80180
       LNT     20000               HYPER                               $IOC80190
       ADD     1DEC                BY BUMPING FILE CT                  $IOC80200
       SLW     2,1                                                      IOC80210
       SXA     CHPSS,0                                                  IOC80220
       AXT     6,4                 SAVE SENSE SWITCH CONDITION          IOC80230
       CAL     1B17                                                     IOC80240
       PSE     119,4               SWT 7,4                              IOC80250
       TRA     *+2                                                      IOC80260
       ORS     CHPSS                                                    IOC80270
       ARS     1                                                        IOC80280
       TIX     *-4,4,1                                                  IOC80290
       AXT     1,2                 1 INTO X2 FOR WRS                    IOC80300
       STL     (CHPSW                                                   IOC80310
       ENB     (TRAPS                                                   IOC80320
       TRA     CHP4                                                     IOC80330
CHP40  RFT     200000              TEST FOR READING OR WRITING          IOC80340
       TRA     CHP41+3                                                 $IOC80350
       TXI     CHPX2,4,1           EXIT-IMPROPER TAPE POSITION          IOC80360
CHP25  IOCP    CHP24,,1                                                *IOC80370
       IOCP    **,,**                                                  *IOC80380
       IOCP    CHPSS,,1                                                 IOC80390
CHP14  IOCP    **,,1                                                    IOC80400
       IOCP    *+1,,1                                                   IOC80410
       IORT    **,,**                                                   IOC80420
       TCM     CHP27,0,0,0                                             $IOC80430
       CTL     CHP29-2             BACKSPACE                           $IOC80440
       TDC     CHP26+2                                                 $IOC80450
       TCH     HYGS                                                    $IOC80460
       BES     *-4+NOHYP/NOHYP*4-*                                     $IOC80470
CMT5   BCI     7, CHECKPOINT XXXXXX CODE XXXXXX XXXXXX                  IOC80480
       TTL                         STORE ROUTINE                        IOC80490
*                           CALLING SEQUENCE                            IOC80500
*     STL     CHC3                                                      IOC80510
*     TTR     STORE                                                     IOC80520
       SPACE   1                                                        IOC80530
*                     USED BY CHECK POINT ROUTINES                      IOC80540
*       1. SAVES INDEX REGISTERS                                        IOC80550
*       2. SETS UP INDIRECTLY ADDRESSABLE CELL FOR DUMP TAPE            IOC80560
*       3. SETS UP CHANNEL INSTRUCTIONS                                 IOC80570
*       4. PLACES -(CHANNEL NO.) INTO X1                                IOC80580
       SPACE   1                                                        IOC80590
STORE  ENB     L(0)                DISABLE TRAPS                        IOC80600
       STI     CHPSI               SAVE SENSE INDICATOR                 IOC80610
       SXA     CHPX4,4             SAVE INDEX REGISTERS                 IOC80620
       SXA     CHPX2,2                                                  IOC80630
       SXA     CHPX1,1                                                  IOC80640
       SXA     CHPX4-4,3                                               $IOC80650
       AXT     0,1                                                     $IOC80660
       AXT     1,3                                                      IOC80670
       TXH     *+5,1,0             7090                                 IOC80680
       STL     X94                 7094                                 IOC80690
       SXA     CHPX4-3,5                                               $IOC80700
       SXA     CHPX4-2,6                                               $IOC80710
       SXA     CHPX4-1,7                                               $IOC80720
       SXA     CHPSL,0                                                  IOC80730
       AXT     4,1                 SAVE SENSE LIGHT CONDITION           IOC80740
       CAL     L(1)                                                     IOC80750
       SLT     5,1                                                      IOC80760
       TRA     *+2                                                      IOC80770
       ORS     CHPSL                                                    IOC80780
       ALS     1                                                        IOC80790
       TIX     *-4,1,1                                                  IOC80800
       CAL     1,4                 FILE,T                               IOC80810
CHP2   PAI     16                                                       IOC80820
       STA     *+2                                                      IOC80830
       RNT     100000              TEST FOR INDIRECT ADDRESSING         IOC80840
       CAL     **                  ADDRESS=ADDRESS OF KEYS STORAGE     $IOC80850
       STA     CHP1                                                     IOC80860
CHP3   AXC     **,2                                                     IOC80870
       PXD     0,0                 TEST FOR 7090 OR 7094                IOC80880
       OCT     044300012000        DOUBLE LOAD                          IOC80890
       TZE     *+2                 THIS IS A 7090                       IOC80900
       OCT     476000000016        ENTER MULTIPLE TAG MODE              IOC80910
       TXL     CHP1,2,*            CHECKPOINT                          $IOC80920
       TSX     (NDATA,4                                                 IOC80930
       PZE     CHP1,0,TESTP                                             IOC80940
       LXA     CHPX4,4                                                 $IOC80950
CHP1   CAL     **                  UCW WORD1                            IOC80960
       STD     CHP19                                                    IOC80970
       ARS     18                  PHYSICAL TAPE ADDRESS                IOC80980
       ORA     CHP2                SET MODE TO BINARY                   IOC80990
       AXT     5,1                                                      IOC81000
       STA     CHP7+3,1            SET UP SELECT INSTRUCTIONS           IOC81010
       TIX     *-1,1,1                                                  IOC81020
       ARS     9                                                        IOC81030
       ANA     *+1                                                      IOC81040
       PAC     15,1                -(CHANNEL NO.)                       IOC81050
       TXI     *+1,1,1                                                  IOC81060
       LDQ*    (TRCXI                                                   IOC81070
       SLQ     CHP17               TRCX                                 IOC81080
       LDQ*    (TCOXI                                                   IOC81090
       CAL     (CKWAT                                                   IOC81100
       ACL     L(1)                                                     IOC81110
       STA     *+1                                                      IOC81120
       SLQ     **                  TCOX                                 IOC81130
       CAL*    (RCHXI                                                   IOC81140
       ORA     D48                                                      IOC81150
CHPSL  XCL     **                  SENSE LIGHT CONDITION                IOC81160
       SLQ     CHP15               RCHX*                                IOC81170
       LDQ*    (ETTXI                                                   IOC81180
       STQ     CHP16                                                    IOC81190
       LDQ*    (TEFXI                                                   IOC81200
       SLQ     CHP13               TEFX                                 IOC81210
       TXI     *+1,1,-1                                                 IOC81220
       TRA     1,2                                                      IOC81230
CHPSI                                                                   IOC81240
CHP19  PZE     0,,**                                                    IOC81250
       EJECT                                                            IOC81260
*                                 EXIT                                  IOC81270
*                         DUMP OR RESTORE CORE                          IOC81280
*                       RESTORE INDEX REGISTERS                         IOC81290
       SPACE   1                                                        IOC81300
CHP4   LDC     SYSUBC,1            -NO. OF CHANNELS TO X1               IOC81310
       TXI     *+1,1,1             DELAY UNTIL                          IOC81320
       ZET*    (CHXSP              ALL CHANNELS                        $IOC81330
       TRA     CHP4                BECOME DORMANT.                      IOC81340
       TXH     *-3,1,0                                                  IOC81350
       ENB     L(0)                DISABLE TRAPS                        IOC81360
       STZ     (CHPSW                                                  $IOC81370
CHP30  LDI*    CHP1                                                    $IOC81380
       LFT     20000               7909 CHANNEL                        $IOC81390
       TRA     CHGSH               YES                                 $IOC81400
       BES     *-3+NOHYP/NOHYP*3-*                                     $IOC81410
       TXL     *+5,2,0             ZERO IF RESTART                     $IOC81420
       AXT     6,1                                                     $IOC81430
       TSX     RDWR,4              WRITE MESSAGE BLOCK                 $IOC81440
       PZE     CHP25                                                    IOC81450
       TRA     CHP6                                                     IOC81460
       TSX     RDWR,4                                                   IOC81470
       PZE     CHP8                                                     IOC81480
       TRA     CHP6                RTC RETURN                           IOC81490
       AXT     2,2                 2 INTO X2 FOR WEF                    IOC81500
       TSX     RDWR,4                                                   IOC81510
       PZE                                                              IOC81520
       TRA     CHP6                                                     IOC81530
CHP76  AXT     L(0),4                                                  $IOC81540
       SXA     (TRAPX,4                                                 IOC81550
       LXD     SYSUBC,1                                                 IOC81560
       SXD     *+1,1                                                    IOC81570
       TXI     *+1,1,**                                                 IOC81580
       TXI     *+1,1,10                                                 IOC81590
       SXA     *+5,1                                                    IOC81600
       TXI     *+1,1,1                                                  IOC81610
       SXA     *+4,1                                                    IOC81620
       TXI     *+1,1,-11                                                IOC81630
       CAL     CHP10               ACTIVATE ALL CHANNELS                IOC81640
       STA     **,1                                                     IOC81650
       TRA     **,1                                                     IOC81660
CHP11  TIX     *-2,1,2                                                  IOC81670
       NZT     X94                 7090                                $IOC81680
       TRA     CHPX4               YES                                 $IOC81690
       OCT     076000000016        LEAVE MULTIPLE TAG MODE             $IOC81700
       AXT     **,3                RESTORE IR FOR 94                   $IOC81710
       AXT     **,5                                                    $IOC81720
       AXT     **,6                                                    $IOC81730
       AXT     **,7                                                    $IOC81740
CHPX4  AXT     **,4                RESTORE INDEX REGISTERS              IOC81750
CHPX2  AXT     **,2                                                     IOC81760
       SLF                                                              IOC81770
       AXT     4,1                 RESTORE SENSE LIGHTS                 IOC81780
       CAL     CHPSL                                                    IOC81790
       LBT                                                              IOC81800
       TRA     *+2                                                      IOC81810
       SLN     5,1                                                      IOC81820
       ARS     1                                                        IOC81830
       TIX     *-4,1,1                                                  IOC81840
       AXT     (TRAPS,1                                                 IOC81850
       SXA     (TRAPX,1                                                 IOC81860
CHPX1  AXT     **,1                                                     IOC81870
CHP10  PIA     CHP11               TAPE POSITION OF CHECK POINT         IOC81880
       STZ     X94                 ZERO 7094 SWITCH                    $IOC81890
       ENB     (TRAPS                                                   IOC81900
       TRA     4,4                 EXIT                                 IOC81910
X94    PZE                         7094 SWITCH                         $IOC81920
CHGSH  PIA                                                             $IOC81930
       ANA     DEC15               PUT UNIT NUMBER                     $IOC81940
       ORA     HYSEL               IN SELECT ORDER                     $IOC81950
       STD     CHP27-1                                                 $IOC81960
       CLA     CHP11+3                                                 $IOC81970
       STA     CHP26                                                   $IOC81980
       STA     CHP28                                                   $IOC81990
       PIA                                                             $IOC82000
       ARS     23                  SET THE SMS                         $IOC82010
       ANA     L(1)                TO CORRECT                          $IOC82020
       ORS     CHP26               INTERFACE                           $IOC82030
       ORS     CHP28                                                   $IOC82040
       CAL     CDTCT               MAKE COMMANDS                       $IOC82050
       STP     CHP14+2             COPY AND DISCONNECT                 $IOC82060
       TXL     *+3,2,0             ZERO IF RESTART                     $IOC82070
       TSX     *+4,4                                                   $IOC82080
       PZE     CHP26               CHECKPOINT CTLW                     $IOC82090
       TSX     *+2,4                                                   $IOC82100
CHP24  PZE     CHP28               RESTART CTLR                        $IOC82110
       XEC     CHP15               START CHANNEL                       $IOC82120
       TSX     (CKWAT,4            WAIT UNTIL FINISHED                 $IOC82130
       ZET     CHP29+1             WAS THERE AN ERROR                  $IOC82140
       TRA     CHP29               YES                                 $IOC82150
       CAL     FCW                 RESTORE COMMAND                     $IOC82160
       STP     CHP14+2             TO IORT                             $IOC82170
       TXL     *+3,2,0             ZERO IF RESTART                     $IOC82180
       TSX     (NDATA,4            WRITE TAPE MARK                     $IOC82190
       PZE     CHP1,,HWTMP                                             $IOC82200
       TRA     CHP76                                                   $IOC82210
CHP26  SMS     14                                                      $IOC82220
       LCC     4                                                       $IOC82230
       LIPT    *+1                                                     $IOC82240
       CTLW    CHP27-1                                                 $IOC82250
       TCH     CHP25                                                   $IOC82260
       OCT     120600120112                                            $IOC82270
CHP27  LCC     5                                                       $IOC82280
       LIPT    *+1                                                     $IOC82290
       CTLW    CHP27-1                                                 $IOC82300
       CPYP    0,,1                                                    $IOC82310
       CPYD    1,,-1                                                   $IOC82320
       TCM     HYGS+3,0,0,0                                            $IOC82330
       CTL     CHP29-2                                                 $IOC82340
       TDC     CHP27+1                                                 $IOC82350
HYGS   XMT     CHP29+1,,1                                              $IOC82360
       TRA     CHP29+2             ERROR TRANSFER                      $IOC82370
       CTL     CHP29-1                                                 $IOC82380
       LCC     0                                                       $IOC82390
       WTR     *                   WAIT                                $IOC82400
CHP28  SMS     14                                                      $IOC82410
       CTLR    CHP27-1                                                 $IOC82420
       CPYP    0,,1                                                    $IOC82430
       CPYD    1,,-1                                                   $IOC82440
       TCM     HYGS+3,0,0,0        TRANSFER NO ERRORS                  $IOC82450
       CTL     *+3                 BACKSPACE.                          $IOC82460
       LIPT    CHP28+1             RETRY                               $IOC82470
       OCT     030512010000        BACKSPACE CTL                       $IOC82480
       OCT     031112010000        UNLOAD CARTRIDGE                    $IOC82490
CHP29  IOT                                                             $IOC82500
       PZE     0                   ZERO IF NO ERROR ON C.P.            $IOC82510
       STZ     *-1                                                     $IOC82520
       TRA     CHP70+4             PRINT MSG. AND RETRY                $IOC82530
       BES     CHGSH+NOHYP/NOHYP**-NOHYP/NOHYP*CHGSH-*                 $IOC82540
       TTL                         READ OR WRITE CHECKPOINT             IOC82550
*                      UPON ENTRY X2 MUST CONTAIN                       IOC82560
*                              0 FOR RDS                                IOC82570
*                              1 FOR WRS                                IOC82580
*                              2 FOR WEF                                IOC82590
CHPRW  RUNA    **                                                       IOC82600
       WEFA    **                                                       IOC82610
CHP7   WTBA    **                                                       IOC82620
       RTBA    **                                                       IOC82630
CHP6   BSRA    **                                                       IOC82640
       TXL     RDWR+1,2,0          TXL IF RDS                           IOC82650
       XEC     CHP7                                                     IOC82660
       XEC     CHP16                                                    IOC82670
       TRA     CHP18               EOT ON ERASE                         IOC82680
RDWR   SXA     CHP20+4,4                                                IOC82690
       TXL     *+3,2,0                                                 $IOC82700
       TXH     *+2,2,1                                                 $IOC82710
       TNX     CHP70,1,1                                               $IOC82720
       XEC     CHP7+1,2            SELX                                 IOC82730
       TXH     *+2,2,1             TXH IF WEF                           IOC82740
CHP15  RCHA*   1,4                                                      IOC82750
       TSX     (CKWAT,4                                                 IOC82760
       LXA     CHP20+4,4                                                IOC82770
       IOT                                                              IOC82780
       TRA     CHP20               I/O CHECK                            IOC82790
CHP16  ETTA                                                             IOC82800
       TRA     CHP70                                                    IOC82810
CHP13  TEFA    *                                                        IOC82820
CHP17  TRCA    2,4                                                      IOC82830
       TRA     3,4                                                      IOC82840
CHP18  LDQ     CHP19                                                    IOC82850
       TSX     CVPRT,4                                                  IOC82860
       PZE     CMT4,,2                                                  IOC82870
       TSX     STOP,4                                                   IOC82880
CHP20  TSX     PROUT,4                                                  IOC82890
       PZE     1                                                        IOC82900
       PZE     CMT8,,2                                                  IOC82910
       TSX     PAWS,4                                                   IOC82920
       AXT     **,4                                                     IOC82930
       TRA     CHP16                                                    IOC82940
CHPTP  PZE     **                                                       IOC82950
CHP8   IOCP    0,,1                                                     IOC82960
       IOCD    1,,-1                                                    IOC82970
D48    PZE     0,0,48                                                   IOC82980
CHP70  LAC     CHP1,4              HERE ON EOT                          IOC82990
       CLA     1DEC                                                    $IOC83000
       STO     2,4                                                     $IOC83010
       XEC     CHPRW               RUN                                  IOC83020
       TSX     PROUT,4                                                  IOC83030
       PZE     1                                                        IOC83040
       PZE     CHP71,,8+512*DBLSP                                      $IOC83050
       CAL     BLNKS                                                   $IOC83060
       ANA     XCPTP                                                   $IOC83070
       LAC     CHP1,4                                                  $IOC83080
       SLW     CMT5+6                                                  $IOC83090
       LDQ     0,4                                                     $IOC83100
       TSX     CVPRT,4                                                 $IOC83110
       PZE     CMT5,,7+512*DBLSP                                       $IOC83120
       TRA     CHP30                                                   $IOC83130
CHP71  BCI     8,CHECKPOINT INVALID, MOUNT NEW REEL TO CONTINUE        $IOC83140
CMT4   BCI     2,EOT ON ERASE                                           IOC83150
CMT8   BCI     2,I/O CHECK                                              IOC83160
       TTL                         BASIC IOCS CONSTANTS                 IOC83170
TRPCH  PZE     1,,1                                                     IOC83180
ONETRP PZE     **                                                       IOC83190
FULIO  BSS     0                   END BASIC IOBS                       IOC83200
       TTL     SET UP INDIRECT REFERENCES TO LABEL HANDLING ROUTINES    IOC83210
*           THE ROUTINE SPECIFIED IN THE DECREMENT OF WORD 3            IOC83220
*            OF THE FILE IS USED AS THE BASE ADDRESS OF THE             IOC83230
*                FIVE (5) IMAGE ROUTINES WHICH ARE USED                 IOC83240
       SPACE   1                                                        IOC83250
*      TSX     LBSET,1             -L(FILE) IN  IR2                     IOC83260
*      RETURN                      IR4  DESTROYED                       IOC83270
*                                                                       IOC83280
LBSET  STZ     HHDR                RESET HYPER LABEL FLAG              *IOC83290
       CLA     5,2                                                     *IOC83300
       ANA     SIX                                                     *IOC83310
       TZE     *+3                 729,1301                            *IOC83320
       STL     HHDR                                                    *IOC83330
       TRA     *+4                                                     *IOC83340
       BES     LBSET+NOHYP/NOHYP**-NOHYP/NOHYP*LBSET-*                  IOC83350
       CLA     2,2                                                     *IOC83360
       PDX     0,4                                                     *IOC83370
       TXH     *+2,4,0                                                 *IOC83380
       LXD     LBRTN,4             SETUP LIST OF                       *IOC83390
       PXA     0,4                 ENTRIES TO                          *IOC83400
       AXT     5,4                 IMAGE ROUTINES                       IOC83410
       STA     LABRT5+1,4                                               IOC83420
       ACL     L(1)                                                     IOC83430
       TIX     *-2,4,1                                                  IOC83440
       STZ     DHDR                DISK HEADER FLAG                    $IOC83450
       TRA     1,1                                                      IOC83460
LABRT1 TSX     **,1                INPUT LABEL CHECK                    IOC83470
LABRT2 TSX     **,1                INPUT TRAILER CHECK                  IOC83480
LABRT3 TSX     **,1                CHECK LABEL FOR VALID OUTPUT REEL    IOC83490
LABRT4 TSX     **,1                PREPARE OUTPUT TRAILER               IOC83500
LABRT5 TSX     **,1                PREPARE OUTPUT LABEL                 IOC83510
       SPACE   1                                                        IOC83520
*                    STANDARD LABEL IMAGE ROUTINES                      IOC83530
LBRTN  TXL     LCKIN,,LBRTN        INPUT LABEL CHECK                    IOC83540
       TRA     TCKIN               INPUT TRAILER CHECK                  IOC83550
       TRA     LCKOF               CHECK LABEL FOR VALID OUTPUT REEL    IOC83560
       TRA     TPROF               PREPARE OUTPUT TRAILER               IOC83570
       TRA     LPROF               PREPARE OUTPUT LABEL                 IOC83580
       TTL                         LABEL HANDLER AT EOF                 IOC83590
*      TSX     LAEOF,1                                                  IOC83600
*             EXITS AT SYNCR+2 IF EOR TRAILER ENCOUNTERED               IOC83610
*              EXITS AT EOF.1 IF EOF TRAILER ENCOUNTERED                IOC83620
*           (IN LAST CASE,EOF FOLLOWING TRAILER IS SKIPPED)             IOC83630
       SPACE   1                                                        IOC83640
LAEOF  SXA     LF1,4               SAVE IR4                             IOC83650
       SXA     LF1+1,1             AND IR1                              IOC83660
       TSX     LBSET,1             SETUP LABEL IMAGE CALLS              IOC83670
       TSX     RDLAB,4             READ TRAILER                         IOC83680
       TRA     LF3                 NO TRAILER EXIT OR EOF EXIT          IOC83690
       STZ     TEMP                RESET SEQ ERROR FOR NON-STANDARD    *IOC83700
       XEC     LABRT2              XEC TRAILER CHECK                    IOC83710
       TQP     LF2                 EOR- SWITCH REELS AND CONTINUE      $IOC83720
       RIL     NOEOT                                                   $IOC83730
       CLA     5,2                 TEST FOR DISK                       $IOC83740
       TMI     *+2                 YES                                 $IOC83750
       TSX     SKIP,4              EOF-SKIP OVER EOF MARK AND EXIT     $IOC83760
       NZT     TEMP                IF SEQUENCE ERROR                    IOC83770
       TRA     EOF.0               TAKE EOF EXIT                        IOC83780
       TRA     SEQEX               TAKE SEQUENCE EXIT                   IOC83790
LF2    TSX     SWITCH,1            SWITCH REELS                        $IOC83800
       STI     CPT2                SAVE INDICATORS                     $IOC83810
       TSX     LABCI,1             HANDLE LABELS NEW REEL               IOC83820
       LDI     CPT2                RESTORE INDICATORS                  $IOC83830
       TSX     CPINT,4             ISSUE CONDITIONAL CHECKPOINT         IOC83840
LF1    AXT     **,4                RESTORE IR4                          IOC83850
       AXT     **,1                AND IR1                              IOC83860
       NZT     TEMP                UNLESS SEQ ERROR IN TRAILER          IOC83870
       TRA     SYNCR+2             CONTINUE TO SYNC                     IOC83880
       TRA     SEQEX                                                    IOC83890
LF3    TSX     PROUT,4             WHEN TRAILER NOT RECOGNIZABLE        IOC83900
       PZE     2                   BECAUSE OF LENGTH                    IOC83910
       MZE     9,2,3               PRINT '' NO TRAILER''                IOC83920
       PZE     LMG11,,2+512*DBLSP  AND TAKE EOF EXIT                    IOC83930
       TRA     EOF.0                                                    IOC83940
       TTL                         LABEL HANDLER INPUT FILE             IOC83950
*      TSX     LABCI,1                                                  IOC83960
*      RETURN                                                           IOC83970
       SPACE   1                                                        IOC83980
LABCI  SXA     LH4,4               SAVE IR4                             IOC83990
       SXA     LH4+1,1             AND IR1                              IOC84000
       TSX     LBSET,1             SET UP LABEL IMAGE CALLS            $IOC84010
       CLA     5,2                 IS THIS DISK                        $IOC84020
       TPL     LH2                 NO                                  $IOC84030
       STL     DHDR                DISK HEADER FLAG                    $IOC84040
       TRA     LH2                 SKIP UNLOAD(FOR ERROR RETRY)         IOC84050
       ZET     DHDR                IF DISK NEXT JOB                    $IOC84060
       TSX     STOPD,4             YES                                 $IOC84070
LH1    TSX     NDSEL+1,4           UNLOAD IF ERROR                      IOC84080
       PZE     0,2,RUNOP           RE-TRY AFTER REEL SWITCH             IOC84090
LH2    TSX     LBDNR,4             SET DENSITY FOR READING LABEL        IOC84100
       TSX     RDLAB,4             READ LABEL                           IOC84110
       TRA     LH7                 EOF OR NO LABEL EXIT                 IOC84120
LH2.5  XEC     LABRT1              VALIDATE CORRECT LABEL               IOC84130
       TRA     LH3                 OK                                   IOC84140
       NZT     DHDR                                                    $IOC84150
       TRA     *+3                                                     $IOC84160
       CAL     LH6.5               DISK                                $IOC84170
       TRA     *+4                                                     $IOC84180
       BES     *-4+NOCH/NOCH*4-*                                        IOC84190
       LFT     SEARCH              IF SEARCHING GO OUT AND TEST         IOC84200
       TRA     LH8                                                      IOC84210
       CAL     LH6                 PRINT                                IOC84220
       TSX     LBERR,4             --INPUT REEL INVALID--              $IOC84230
       XEC     SWTE                IF SENSE SWITCH ASSIGNED IS UP       IOC84240
       TRA     LH1-2               TRY NEXT UNIT IF NOT DISK           $IOC84250
LH3    NZT     LH11                WERE WE SEARCHING                   *IOC84260
       TRA     LH3.5               NO                                  *IOC84270
*                  LABEL FOUND..... NOTIFY OPERATOR                     IOC84280
       TSX     PROUT,4                                                 *IOC84290
       PZE     2                                                       *IOC84300
       MZE     9,2,3               ''FILE-NAME''                       *IOC84310
       PZE     LMG10,,1            ''FOUND''                           *IOC84320
       STZ     LH11                RESET SEARCH SWITCH                 *IOC84330
*                                                                       IOC84340
LH3.5  ZET     DHDR                                                    *IOC84350
       TRA     LH4                                                     *IOC84360
       TSX     SKIP,4              SKIP OVER EOF AFTER LABEL           $IOC84370
       TSX     DENSE,4             SET FILE DENSITY                     IOC84380
       CLA     LAREA+6                                                 *IOC84390
       ZET     HHDR                CHECKPOINT BIT                      *IOC84400
       CLA     LAREA+10                                                *IOC84410
       LBT                         IF CHECKPOINT FOLLOWS               *IOC84420
       TRA     *+2                                                     *IOC84430
       TSX     SKIP,4              SKIP OVER THAT FILE.                 IOC84440
LH4    AXT     **,4                RESTORE IR4                          IOC84450
       AXT     **,1                AND IR1                              IOC84460
       TRA     1,1                 EXIT                                 IOC84470
LH6    PZE     LMSG1,,3            ERROR MESSAGE PARAMETER              IOC84480
LH6.5  PZE     BLNKS,,1                                                $IOC84490
LH7    TSX     PROUT,4             IF NO LABEL ON OUTPUT                IOC84500
       PZE     2                   PRINT '' NO LABEL'' AND              IOC84510
       MZE     9,2,3               AND CONTINUE FURTHER                 IOC84520
       PZE     LMG13,,4+512*DBLSP  LABEL CHECKS WILL CATCH ERROR       *IOC84530
       TRA     LH2.5                                                    IOC84540
*                       LABEL SEARCHING ROUTINES                        IOC84550
LH8    ZET     LH11                IF INITIAL ENTRY                     IOC84560
       TRA     LH9                 PRINT LABEL SEARCHING MESSAGE        IOC84570
       STL     LH11                AND GIVE OPERATOR CHOICE             IOC84580
       TSX     PROUT,4             PRINT MESSAGE INFORMING OPERATOR OF  IOC84590
       PZE     2                   THE IMPENDING SEARCH                 IOC84600
       MZE     9,2,3                                                    IOC84610
       PZE     LMG12,,9                                                 IOC84620
       STL     SERSW               SET SWITCH CELL NON ZERO             IOC84630
       XEC     SWTE                IF SENSE SWITCH IS ORIGINALLY        IOC84640
       STZ     SERSW               DOWN                                 IOC84650
LH9    TSX     PROUT,4             PRINT THE LABEL OF BYPASSED          IOC84660
       PZE     2                   FILE FOR OPERATOR                   *IOC84670
       PZE     LAREA,,12                                                IOC84680
       PZE     LAREA1+2,,4                                             *IOC84690
       TSX     SKIP,4              SKIP OVER EOF FOLLOWING LABEL        IOC84700
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          IOC84710
       TSX     DENSE,4             SET FILE DENSITY                     IOC84720
       CLA     LAREA+6                                                  IOC84730
       ZET     HHDR                                                    *IOC84740
       CLA     LAREA+10            IF CHECKPOINT FOLLOWS               *IOC84750
       LBT                         THEN SKIP OVER IT                    IOC84760
       TRA     *+3                                                      IOC84770
       TSX     SKIP,4              SKIP CKPT RECORD ( A FILE)           IOC84780
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          IOC84790
       TSX     SKIP,4              SKIP OVER BODY OF DATA FILE          IOC84800
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          IOC84810
       TSX     RDLAB,4             READ TRAILER                         IOC84820
       TRA     LH9.9               EOF OR NO TRAILER EXIT               IOC84830
LH9.2  XEC     LABRT2              VALIDATE TRAILER                     IOC84840
       TQP     *+3                 MQ + IF EOR                          IOC84850
       TSX     SKIP,4              SKIP OVER EOF AFTER TRAILER          IOC84860
       TRA     *+2                 GO CHECK NEXT FILE                  $IOC84870
       TSX     SWITCH,1            SWITCH REELS IF EOR                  IOC84880
       TSX     LH14,4              CHECK OPERATOR INTERVENTION         $IOC84890
       TRA     LH2                 GO CONTINUE SEARCH                   IOC84900
LH9.9  TSX     PROUT,4             PRINT                                IOC84910
       PZE     2                   '' NO TRAILER'' AND                  IOC84920
       MZE     9,2,3               AND CONTINUE                         IOC84930
       PZE     LMG11,,2+512*DBLSP                                       IOC84940
       TRA     LH9.2-2                                                 *IOC84950
       SPACE   1                                                        IOC84960
*       INTERRUPT SEARCH IF OPERATOR PLACES SENSE SWITCH 4 DOWN         IOC84970
LH14   NZT     SERSW               IF SENSE SWITCH WERE ORIGINALLY      IOC84980
       TRA     LH15                UP THEN TEST FOR INTERRUPT           IOC84990
       XEC     SWTE                IF DOWN THEN RECORD WHEN             IOC85000
       STZ     SERSW               IT IS PLACED UP                      IOC85010
       TRA     1,4                 EXIT                                 IOC85020
LH15   XEC     SWTE                IF SENSE SWITCH DOWN AFTER BEING UP  IOC85030
       TRA     1,4                 THEN INTERRUPT SEARCH                IOC85040
       TRA     LH1                 ELSE CONTINUE                        IOC85050
       TTL                         LABEL HANDLER OPEN OUTPUT FILE       IOC85060
*      TSX     LABOO,1                                                  IOC85070
       SPACE   1                                                        IOC85080
LABOO  SXA     LOO3,4              SAVE IR4                             IOC85090
       SXA     LOO3+1,1            IR1                                  IOC85100
       TSX     LBSET,1             SETUP CALLS ON IMAGE ROUTINES        IOC85110
       CLA     5,2                                                     $IOC85120
       TPL     *+3                                                     $IOC85130
       STL     DHDR                DISK HEADER FLAG                    $IOC85140
       TRA     LOO1                                                    $IOC85150
LOOZ   TSX     LBDNR,4             SET DENSITY FOR READING LABELS       IOC85160
       AXC     2,4                 IF REEL                              IOC85170
       CLA*    0,2                 NOT AT LOAD POINT                    IOC85180
       ANA     MSK3                SAVE ORIGINAL TAPE POSITION         *IOC85190
       STO     TEMP                                                     IOC85200
       TZE     LOO1                GO INTRODUCE *****                   IOC85210
       TSX     LOO5,4              AS TAPE SERIAL NUMBER               $IOC85220
LOOA   ZET     DHDR                DISK                                $IOC85230
       TSX     STOPD,4             YES-NEXT JOB                        $IOC85240
       TSX     NDSEL+1,4           REWIND UNLOAD IF                     IOC85250
       PZE     0,2,RUNOP           REEL INVALID BEFORE RE-TRY           IOC85260
       STZ     TEMP                SET TEMP =0 SHOWING LOAD PT START    IOC85270
LOO1   TSX     RDLAB,4             READ LABEL ON OUTPUT REEL            IOC85280
       TRA     LOO10               EOF OR NO LABEL                      IOC85290
       XEC     LABRT3              VALIDATE OK FOR USE                  IOC85300
       TRA     LOO2                -OK                                 $IOC85310
       TRA     LOO7                RETENTION NOT EXPIRED               $IOC85320
       ZET     DHDR                DISK-                               $IOC85330
       TRA     LOO4                YES                                 $IOC85340
LOO5   AXC     1,1                                                     *IOC85350
       ZET     HHDR                                                    *IOC85360
       AXC     5,1                                                     *IOC85370
       LDQ     ASTER                                                   *IOC85380
       ZET     HHDR                INTODUCE  ***** AS                  *IOC85390
       RQL     6                   REEL SERIAL NUMBER                  *IOC85400
       STQ     LAREA,1                                                 *IOC85410
       TXI     *+1,4,LOOA-1                                            $IOC85420
       TXL     LOO2+5,4,0                                              $IOC85430
       CAL     LOO8                -INVALID REEL                       *IOC85440
       TRA     *+2                                                      IOC85450
LOO7   CAL     LOO9                                                    *IOC85460
       TSX     LBERR,4             PRINT LABEL ERROR                    IOC85470
       XEC     SWTE                AND CAUSE ... IF SENSE SWITCH        IOC85480
       TRA     LOOA                IS DOWN ACCEPT AS OK                $IOC85490
LOO2   ZET     DHDR                                                    $IOC85500
       TRA     LOO4                DISK                                $IOC85510
       AXC     1,1                                                     $IOC85520
       ZET     HHDR                                                    $IOC85530
       AXC     5,1                                                     $IOC85540
       AXC     3,4                 IF TAPE WAS INITIALLY               $IOC85550
       CAL     LAREA,1             AT LOAD POINT PLACE REEL            *IOC85560
       NZT     TEMP                SERIAL NUMBER INTO UCW               IOC85570
       SLW*    0,2                 WORD 4. IF NOT AT LOAD POINT         IOC85580
       CAL*    0,2                 PICK UP TAPE SERIAL NUMBER           IOC85590
       SLW     LAREA,1             FROM UCW WORD 4 AND PLACE           *IOC85600
       ZET     HHDR                IN LABEL AREA FOR FILE S/N          *IOC85610
       SLW     11,2                                                    *IOC85620
       LFT     OPEND                                                    IOC85630
       TRA     *+3                 IF FILE SERIAL IS                   *IOC85640
       NZT     6,2                 ZERO THEN ASSIGN REEL                IOC85650
       SLW     6,2                 SERIAL AS FILE SERIAL NUMBER         IOC85660
       ZET     TEMP                UNLESS TAPE WERE AT LD PT            IOC85670
       TRA     *+3                 INITIALLY, SKIP                      IOC85680
       TSX     NDSEL+1,4           BSR OF LABEL READ                   *IOC85690
       PZE     0,2,BSROP                                                IOC85700
LOO4   XEC     LABRT5              PREPARE LABEL RECORD                $IOC85710
       TSX     LBDNW,4             SET LABEL DENSITY FOR WRITING        IOC85720
       TSX     WRLAB,4             WRITE LABEL                         $IOC85730
       TRA     LOO6                EOT-CAUSE REEL SWITCH                IOC85740
       LFT     OPEND               IF FILE BEING                        IOC85750
       TRA     LOO3-1              OPENED PRINT                         IOC85760
       TSX     DRANO,4             LABEL ON LINE                        IOC85770
       AXT     LMSG9,4                                                 *IOC85780
       ZET     DHDR                                                    *IOC85790
       AXT     DLABEL,4            ''DISK FILE LABEL''                 $IOC85800
       NZT     HHDR                                                    *IOC85810
       TRA     *+3                                                     *IOC85820
       TSX     AB00,4                                                  *IOC85830
       AXT     HLABEL,4            ''HYPERTAPE LABEL''                 *IOC85840
       BES     *-4+NOHYP/NOHYP*4-*                                      IOC85850
       SXA     LOO2.6,4                                                *IOC85860
       CLA     1,2                 INSERT                              $IOC85870
       LGR     17                  LABEL DENSITY                       $IOC85880
       CLA     LMSG9+4             INTO MESSAGE                         IOC85890
       TQP     *+2                                                      IOC85900
       CLA     LMSG9+3                                                  IOC85910
       STO     LMSG9+1                                                  IOC85920
       TSX     PROUT,4                                                  IOC85930
       PZE     5                                                       *IOC85940
       MZE     MESS1,,2            '' UNIT ***** **FILE-NAME**''        IOC85950
       MZE     9,2,3               ''LABEL HIGH DENSITY'' OR            IOC85960
LOO2.6 PZE     LMSG9,,3            ''LABEL LOW DENSITY''               $IOC85970
       PZE     LAREA,,12                                                IOC85980
       PZE     LAREA1+2,,4+512*DBLSP                                   *IOC85990
       TSX     DENSE,4                                                  IOC86000
LOO3   AXT     **,4                RESTORE IR4                          IOC86010
       AXT     **,1                AND IR1                              IOC86020
       TRA     1,1                 EXIT                                 IOC86030
*                   EOT OCCURRED WHILE WRITING LABEL                    IOC86040
LOO6   TSX     NDSEL+1,4           WRITE EOF SIGNIFYING                 IOC86050
       PZE     0,2,WEFOP           END DATA                             IOC86060
       NOP                         IGNORE EOT                           IOC86070
       CAL     1EOR                PREPARE AND                          IOC86080
       XEC     LABRT4              WRITE EOR                            IOC86090
       TSX     WRLAB,4             TRAILER                              IOC86100
       NOP                         (IGNORING EOT)                       IOC86110
       TSX     SWITCH,1            SWITCH REELS                         IOC86120
       TRA     LOOZ                CONTINUE ON NEXT REEL                IOC86130
*                SHORT LABEL RECORD ON REEL TO BE USED                  IOC86140
LOO10  CAL     LOO11               PRINT '' NO LABEL ERROR              IOC86150
       TSX     LBERR,4             AND STOP                             IOC86160
       XEC     SWTE                IF SENSE SWITCH IS DOWN              IOC86170
       TRA     LOO1-3              ACCEPT REEL AS OK                    IOC86180
       TRA     LOOA-1              ELSE RUN AND RETRY                  $IOC86190
LOO8   PZE     LMSG2,,4            ''OUTPUT REEL INVALID''              IOC86200
LOO9   PZE     LMSG3,,4            ''RETENTION NOT EXPIRED''            IOC86210
LOO11  PZE     LMSG4,,4+512*DBLSP  ''NO LABEL,BLANK CREATED''           IOC86220
DHDR   PZE     **                  DISK HEADER                         $IOC86230
HHDR   PZE     **                  HYPERTAPE HEADER                    *IOC86240
       TTL                         LABEL CLOSE OUTPUT FILE              IOC86250
*      TSX     LABCO,1                                                  IOC86260
*      RETURN                                                           IOC86270
       SPACE   1                                                        IOC86280
LABCO  SXA     LOO3,4              SAVE IR4                             IOC86290
       SXA     LOO3+1,1            AND IR1                              IOC86300
       TSX     LBSET,1             SETUP IMAGE CALLS                    IOC86310
       CAL     1EOF                PREPARE AND                          IOC86320
LCO1   XEC     LABRT4              WRITE EOF                            IOC86330
       TSX     WRLAB,4             TRAILER                              IOC86340
       TRA     LOO3                IGNORE EOT (IOEX DOES RECORD IT)     IOC86350
       TRA     LOO3                EXIT                                 IOC86360
       SPACE   1                                                        IOC86370
*                         LABEL OUTPUT AT EOT                           IOC86380
       SPACE   1                                                        IOC86390
*      TSX     LBEOT,1                                                  IOC86400
*      RETURN                                                           IOC86410
       SPACE   1                                                        IOC86420
LBEOT  SXA     LOO3,4              SAVE IR4                             IOC86430
       SXA     LOO3+1,1            AND IR1                              IOC86440
       TSX     LBSET,1             SETUP IMAGE CALLS                    IOC86450
       CAL     1EOR                FORM AND WRITE                       IOC86460
       TRA     LCO1                EOR TRAILER                          IOC86470
       SPACE   1                                                        IOC86480
*                       DENSITY SETTING ROUTINES                        IOC86490
*                    FOR LABEL READING AND WRITING                      IOC86500
       SPACE   1                                                        IOC86510
*      TSX     LBDNR,4             SET READ  DENSITY                    IOC86520
*      TSX     LBDNW,4             SET WRITE DENSITY                    IOC86530
       SPACE   1                                                        IOC86540
LBDNR  CLA     1,2                 SET DENSITY                          IOC86550
       ARS     2                   LABEL READING                        IOC86560
       TRA     DENSE+1                                                  IOC86570
LBDNW  CLA     1,2                 SET DENSITY                          IOC86580
       ARS     1                   LABEL WRITING                        IOC86590
       TRA     DENSE+1                                                  IOC86600
       TTL                         FORWARD SPACE FILE                   IOC86610
*      TSX     SKIP,4                                                   IOC86620
       SPACE   1                                                        IOC86630
SKIP   SXA     SK1,4               SAVE IR4                             IOC86640
       ZET     HHDR                                                    *IOC86650
       TRA     SK3                                                     *IOC86660
       CAL     SK2                 PLACE SKIP SELECT                    IOC86670
       AXC     1,4                 IN UNIT CONTROL                      IOC86680
       ORS*    0,2                 WORD                                 IOC86690
SKXWT  CLA     *+1                 SET                                  IOC86700
       STA     WAIT                WAIT FOR TRAP                        IOC86710
       TSX     ACTV+1,4            ACTIVATE WITH                        IOC86720
       MZE     0,2                 PRIORITY                             IOC86730
       XEC     WAIT                WAIT                                 IOC86740
*                  HYPERTAPE SKIP FILE                                  IOC86750
SK3    LDQ     1,2                                                     $IOC86760
       RQL     18                                                      $IOC86770
       TQP     *+4                 NOT IN READ BACKWARD MODE           $IOC86780
       TSX     (NDSLX,4                                                $IOC86790
       PZE     0,2,HBSFP           BACKSPACE FILE                      $IOC86800
       TRA     *+3                                                     $IOC86810
       TSX     (NDSLX,4            SKIP FILE                           $IOC86820
       PZE     0,2,HSKFP                                               $IOC86830
       BES     SK3+NOHYP/NOHYP**-NOHYP/NOHYP*SK3-*                      IOC86840
*                    RETURNS HERE WHEN EOF REACHED                      IOC86850
SK1    AXT     **,4                RESTORE IR4                          IOC86860
       TRA     1,4                 EXIT                                 IOC86870
SK2    PZE     SSL1,,SKSEL         SELECT CALL WORD                     IOC86880
       TTL                   READ OR WRITE LABEL                        IOC86890
*      TSX     RDLAB,4                                                  IOC86900
*              EOF OR SHORT RECORD RETURN                               IOC86910
*              NORMAL RETURN                                            IOC86920
*      TSX     WRLAB,4                                                  IOC86930
*              EOT OR SHORT RECORD WRITTEN (CAN'T HAPPEN)               IOC86940
*              NORMAL RETURN                                            IOC86950
       SPACE   1                                                        IOC86960
RDLAB  STZ     RWL3                                                   *$IOC86970
       SXA     WRL2,4                                                  *IOC86980
       AXT     4,4                 BLANK OUT WORDS 17-20               *IOC86990
       CLA     BLNKS               IN CASE IT IS NECESSARY             *IOC87000
       STO     LAREA1+6,4          TO PRINT LABEL                      *IOC87010
       TIX     *-1,4,1                                                 *IOC87020
       CLA     5,2                 IS THIS DISK                        $IOC87030
       TMI     RDLBD               YES                                 $IOC87040
       CLA     RWL1                                                    $IOC87050
RWL5   LDQ     1,2                                                     *IOC87060
       RQL     18                  READ BACKWARD                       *IOC87070
       TQP     RWL4                NO                                  *IOC87080
       ORA     SIX                                                     *IOC87090
       BES     RWL5+NOHYP/NOHYP**-NOHYP/NOHYP*RWL5-*                    IOC87100
       TRA     RWL4                                                    *IOC87110
WRLAB  CLA     5,2                 IS THIS DISK                        $IOC87120
       TMI     WRLBD               YES                                 $IOC87130
       CLS     RWL1                                                    $IOC87140
       STL     RWL3                                                     IOC87150
       SXA     WRL2,4              SAVE IR4                           *$IOC87160
RWL4   AXC     1,4                 SAVE FILE                            IOC87170
       STO*    0,2                 STORE SELECT WORD                   $IOC87180
       TRA     SKXWT                                                    IOC87190
RWL1   PZE     LSL1,,LBSEL         SELECT WORD                         $IOC87200
RWL3   PZE     **                  RD OR WR LABEL SWITCH                IOC87210
SERSW  PZE     **                  SENSE SWITCH TEST CELL SEARCHING     IOC87220
LH11   PZE     **                  LABEL SEARCHING SWITCH               IOC87230
       TTL                         RETURN HERE WHEN LABEL I/O COMPLETED IOC87240
WRL1   NZT     RWL3                IF WRITE LABEL                      $IOC87250
       TRA     WRL2                THEN WRITE EOF                       IOC87260
       TSX     NDSEL+1,4           ALSO                                 IOC87270
       PZE     0,2,WEFOP                                                IOC87280
       NOP                         IGNORE EOT                           IOC87290
WRL2   AXT     **,4                RESTORE IR4                          IOC87300
       CLA     LBSHS               IF LABEL I/O HISTORY                 IOC87310
       TZE     2,4                 CELL IS ZERO THEN OK EXIT            IOC87320
*        READ GOT EOF OR NOT A SHORT LENGTH RECORD. WRITE GOT EOT       IOC87330
       AXT     13,4                BLANK OUT LABEL AREA                *IOC87340
       LDQ     BLNKS               LABEL RECORD                         IOC87350
       STQ     LAREA+14,4          BLANK OUT LABEL                      IOC87360
       TIX     *-1,4,1             AREA                                 IOC87370
       AXT     6,4                                                     *IOC87380
       STQ     LAREA1+6,4                                              *IOC87390
       TIX     *-1,4,1                                                 *IOC87400
       BES     *-3+NOHYP/NOHYP*3-*                                      IOC87410
       LDQ     BLNK                SET UP                               IOC87420
       STQ     LAREA               STANDARD                             IOC87430
       LDQ     ASTER               BLANK LABEL                          IOC87440
       AXC     1,4                                                     *IOC87450
       ZET     HHDR                                                    *IOC87460
       AXC     5,4                 ****** AS                           *IOC87470
       STQ     LAREA,4             REEL SERIAL NUMBER                  *IOC87480
       LXA     WRL2,4              RESTORE IR4                          IOC87490
       TRA     1,4                 TAKE LABEL ERROR EXIT                IOC87500
       SPACE   1                                                        IOC87510
*                         SPECIAL SELECTS FOR                           IOC87520
*                          FORWARD SPACE FILE                           IOC87530
*                        READ AND WRITE LABELS                          IOC87540
       SPACE   1                                                        IOC87550
SKSEL  TMI     SKSM                SEL+ OR SEL-                         IOC87560
       STZ*    (RCTXI              NO REDUN CHECK FOR FORWARD SPACING  $IOC87570
*                             LABEL SEL+                                IOC87580
LBSEL  TMI     LBSM                LABEL SEL-                           IOC87590
       SXA     S3,4                SAVE IR4                             IOC87600
       SXA     S3+1,1              IR1                                  IOC87610
       PAC     0,4                 -L(UCW) TO IR4                       IOC87620
       CLA     1,4                 SET L(RCHX)                          IOC87630
       STA*    (RCHXI                                                   IOC87640
       CAL     0,4                 UNIT TO AC DECREMENT                 IOC87650
       NZT     HHDR                                                    *IOC87660
       TRA     RWRS                ISSUE SELECT                         IOC87670
*                            HYPERTAPE SEL+                             IOC87680
LSL3   ANA     DEC15               HYPER UNIT NUMBER                   *IOC87690
       ORA     HYSEL               (120600120112)                      *IOC87700
       LDI     1,4                                                     $IOC87710
       LFT     200000                                                  $IOC87720
       ORA     L(64D)                                                  $IOC87730
       SLW     LPRFF                                                   *IOC87740
       CLA     LSL4                CONTROL AND READ                    *IOC87750
       ZET     RWL3                                                    *IOC87760
       CLA     LSL4+1              CONTROL AND WRITE                   *IOC87770
       STO     LSL2+2                                                  *IOC87780
       AXT     LSL5+1,2                                                $IOC87790
       LFT     200000                                                  *IOC87800
       AXT     LSL5+4,2                                                $IOC87810
       SXA     LSL5,2                                                  $IOC87820
       CAL     LPRFI                                                   *IOC87830
       LFT     200000              READ BACKWARD                       *IOC87840
       ORA     HSMSR               YES                                 *IOC87850
       LDI     0,4                                                     *IOC87860
       LFT     000040              INTERFACE 2                         *IOC87870
       ORA     L(1)                YES                                 *IOC87880
       SLW     LSL2                                                    *IOC87890
       CLA     *-1                                                     $IOC87900
       STA*    (RCHXI                                                  $IOC87910
       TRA     SELCT+1             ISSUE SELECT                        *IOC87920
       BES     LSL3+NOHYP/NOHYP**-NOHYP/NOHYP*LSL3-*                    IOC87930
LSL1   IORT    LAREA,,14           I/O LABEL                            IOC87940
LSL2   SMS     **                                                      *IOC87950
       LIPT    *+1                 IN CASE OF INTERRUPT                *IOC87960
       PZE     LPRFF               (1206XX120112)                      *IOC87970
LSL5   TCH     **                                                      $IOC87980
       CPYP    LAREA,,14                                               *IOC87990
       CPYD    LAREA1,,6                                               *IOC88000
       TCH     SYSTWT                                                  *IOC88010
       CPYP    LAREA1+5,,6                                             $IOC88020
       CPYD    LAREA+13,,14                                            $IOC88030
       TCH     SYSTWT                                                  $IOC88040
LSL4   CTLR    LPRFF                                                   *IOC88050
       CTLW    LPRFF                                                   *IOC88060
       BES     LSL2+NOHYP/NOHYP**-NOHYP/NOHYP*LSL2-*                    IOC88070
SSL1   IOCPN   **,,32767           IO FORWARD                           IOC88080
       TCH     *-1                 SPACE FILE                           IOC88090
SCHLS  IORT    LAREA+14,,LSL1+1    SCHX COMPARE FOR LABEL LENGTH CHECK  IOC88100
LBSHS  PZE     **                  SPECIAL SELECT HISTORY CELL          IOC88110
       TTL     POSTING ROUTINES FOR SPECIAL LABEL SELECTS               IOC88120
*                            TAPE SKIP SEL-                             IOC88130
SKSM   PAC     SK1,2               -L(UCW) TO IR2                       IOC88140
       CLA     *-1                 SET NO WAIT                          IOC88150
SKS1   STA     WAIT                IN WAIT SWITCH                       IOC88160
       STZ     1,2                 CLEAR UCW PRIORITY                   IOC88170
       TRA     1,4                 EXIT                                 IOC88180
*                            TAPE LABEL SEL-                            IOC88190
LBSM   PAC     WRL1,2                                                  *IOC88200
       ZET     HHDR                                                    *IOC88210
       TRA     LBS3                                                    *IOC88220
       LNT     400000              IF SHORT RECORD ( 2 WORD REDUN)     *IOC88230
       TRA     2,4                 IGNORE IT ( IT IS NOISE)             IOC88240
       RIS     XCPT2               STORE EOF OR EOT BIT                 IOC88250
       STI     LBSHS               IN HISTORY CELL                      IOC88260
       CAL     COMM                COMPARE SCHX VALUE                   IOC88270
       LAS     SCHLS               WITH PREDICTED TO CHECK              IOC88280
       STL     LBSHS                                                    IOC88290
       TRA     *+2                                                      IOC88300
       STL     LBSHS                                                    IOC88310
LBS2   CLA     LBSM                SET UP WAIT                          IOC88320
       TRA     SKS1                RETURN ADDRESS                       IOC88330
*                            HYPERTAPE SEL-                             IOC88340
LBS3   STZ     LBSHS               RESET ERROR SWITCH                  *IOC88350
       LFT     007100                                                  *IOC88360
       TRA     LBS2-1              ERROR                                IOC88370
       TRA     LBS2                NO ERRORS                           *IOC88380
       BES     LBS3+NOHYP/NOHYP**-NOHYP/NOHYP*LBS3-*                    IOC88390
       SPACE   1                                                        IOC88400
*               TRAP WAITING FOR SKIP AND LABEL SELECTS                 IOC88410
WAIT   TRA     **                  WAIT                                 IOC88420
       TTL              DISK LABEL ROUTINES                             IOC88430
       SPACE                                                           $IOC88440
RDLBD  LDQ     RWL1D               DISK READ SELECT WORD               $IOC88450
       LXA     WRL2,4                                                  *IOC88460
       TRA     *+2                                                     $IOC88470
WRLBD  LDQ     RWL2D               DISK WRITE SELECT WORD              $IOC88480
       SXA     WRL2D,4             SAVE IR4                            $IOC88490
       CAL     0,2                                                     *IOC88500
       PAC     ,4                  UCB                                 $IOC88510
       ZET     1,4                 WAIT FOR FREE ARM                   $IOC88520
       TRA     *-1                                                     $IOC88530
       STQ     1,4                 STORE SELECT WORD                   $IOC88540
       ARS     18                                                      $IOC88550
       NZT     DHDR                HEADER OR TRAILER                   $IOC88560
       TRA     TRAIL               TRAILER                             $IOC88570
       STA     3,4                 SEEK ADDRESS TO UCB                 $IOC88580
       TQP     *+2                 READING LABEL                       $IOC88590
       TRA     *+3                 WRITING LABEL                       $IOC88600
       LFT     003000              UNLESS                              $IOC88610
       TRA     *+3                 READING OUTPUT LABEL                $IOC88620
       ADD     L(1)                UP TRACK COUNT                      $IOC88630
       STA     6,2                                                     $IOC88640
       CLA     6,2                                                     $IOC88650
       ARS     6                                                       $IOC88660
       ANA     MSK1                HA2 TO FDAMT                        $IOC88670
       ORA     L(6)                FOR SMS                             $IOC88680
       STP     6,2                 MAKE ZERO                           $IOC88690
       STO     SMSX                                                    $IOC88700
       TRA     *+3                                                     $IOC88710
TRAIL  SUB     L(1)                SEEK ADDRESS                        $IOC88720
       STA     3,4                 TO UCB                              $IOC88730
       CLS     2,4                                                     $IOC88740
       STO     2,4                 SET ACTIVITY FLAG                   $IOC88750
       CAL     3,4                                                     *IOC88760
       TSX     (DECVA,4                                                *IOC88770
       STQ     TEMP                                                    *IOC88780
       TRA     SKXWT               GO ACTIVATE                         $IOC88790
WRL2D  AXT     **,4                                                    $IOC88800
       TRA     2,4                                                     $IOC88810
RWL1D  PZE     LSL1D,,LBSLD                                            $IOC88820
RWL2D  MZE     LSL2D,,LBSLD                                            $IOC88830
LBSLD  SXA     SAV,4                                                   $IOC88840
       PAC     ,4                                                      $IOC88850
       TMI     LBSDM               SEL(-)                              $IOC88860
       LDQ     TEMP                TTTT  TO MQ                         *IOC88870
       TSX     (FDAMT,2            PREPARE ORDER                       $IOC88880
SMSX   OCT     000012120006                                            $IOC88890
       PZE     DVTN                                                    $IOC88900
       CLA     1,4                                                     $IOC88910
       STA*    (RCHXI                                                  $IOC88920
       XEC*    (RCHXI                                                  $IOC88930
SAV    AXT     **,4                                                    $IOC88940
       TRA     1,4                                                     $IOC88950
LBSDM  CLA     WRLBD+1                                                 $IOC88960
       STA     WAIT                                                    $IOC88970
       STZ     1,4                                                     $IOC88980
       TRA     SAV                                                     $IOC88990
DVTN   DVTN    ,,                                                      $IOC89000
LSL1D  SMS*    SMSX                                                    $IOC89010
       CTLR    DVTN                                                    $IOC89020
       TCH     *+3                                                     $IOC89030
LSL2D  SMS*    SMSX                                                    $IOC89040
       CTLW    DVTN                                                    $IOC89050
       CPYD    LAREA,,14                                               $IOC89060
       TCH     SYSTWT                                                  $IOC89070
       BES     RDLBD+NOCH/NOCH**-NOCH/NOCH*RDLBD-*                     $IOC89080
       TTL         MESSAGE ROUTINE FOR ALL TYPES OF LABEL ERRORS        IOC89090
*                                                                       IOC89100
*      TSX     LBERR,4        AC= ERROR PROUT PARAM                     IOC89110
*      RETURN       AFTER PAUSE                                         IOC89120
       SPACE   1                                                        IOC89130
LBERR  SXA     LBR1,4              SAVE IR4                             IOC89140
       SLW     LBR0                STORE MESSAGE PARAM                  IOC89150
       TSX     DRANO,4             FIND UNIT ADDRESS                    IOC89160
       ZET     HHDR                                                    *IOC89170
       TSX     AB00,4                                                  *IOC89180
       BES     *-2+NOHYP/NOHYP*2-*                                      IOC89190
       TSX     PROUT,4             PRINT                                IOC89200
       PZE     7                                                       *IOC89210
       MZE     MESS1,,2            ''UNIT ***** **FILE-NAME**           IOC89220
       MZE     9,2,3               LABEL ERROR''                        IOC89230
       PZE     LMSG8,,2            '' ** LABEL ** ''                    IOC89240
       PZE     LAREA,,12           '' ADDITIONAL MESSAGE ''             IOC89250
       PZE     LAREA1+2,,4                                             *IOC89260
LBR0   PZE     **,,**              ''IF SSW * DOWN IGNORED''            IOC89270
       PZE     LMSG6,,4                                                 IOC89280
       TSX     PAUSE,4             PAUSE                                IOC89290
LBR1   AXT     **,4                RESTORE IR4                          IOC89300
       TRA     1,4                 EXIT                                 IOC89310
*                                                                       IOC89320
*              THIS ROUTINE BLANKS THE CHECKPOINT INDICATOR             IOC89330
*              AND BLOCK COUNT IF FOUND TO BE ZERO,THUS                 IOC89340
*              PROVIDING A NEATER ON-LINE PRINT OUT                     IOC89350
*                                                                       IOC89360
*      TSX     AB00,4              MUST BE HYPERTAPE LABEL              IOC89370
*      RETURN                                                           IOC89380
*                                                                       IOC89390
AB00   CAL     LAREA+10                                                *IOC89400
       LBT                         SET CHECKPOINT INDICATOR            *IOC89410
       ORA     BL1K                TO BLANK IF ZERO                    *IOC89420
       SLW     LAREA+10                                                *IOC89430
       CAL     BLNKS                                                   *IOC89440
       NZT     LAREA+11            IF BLOCK COUNT IS ZERO,             *IOC89450
       SLW     LAREA+11            SET TO BLANKS                       *IOC89460
       TRA     1,4                                                     *IOC89470
       BES     AB00+NOHYP/NOHYP**-NOHYP/NOHYP*AB00-*                    IOC89480
       TTL                         LABEL MESSAGES                       IOC89490
LMSG1  BCI     3,INPUT REEL INVALID                                     IOC89500
LMSG2  BCI     4, OUTPUT REEL INVALID                                   IOC89510
LMSG3  BCI     4, RETENTION NOT EXPIRED                                 IOC89520
LMSG4  BCI     4, NO LABEL, BLANK CREATED                               IOC89530
LMSG5  BCI     3, MOUNT LAB. BLANK                                      IOC89540
LMSG6  BCI     1,IF SSW            * DOWN IGNORED                       IOC89550
       VFD     O6/60,6/LERIG,O24/60244666                               IOC89560
       BCI     2,N IGNORED                                              IOC89570
LMSG8  BCI     2,LABEL ERROR                                            IOC89580
LMSG9  BCI     5,LABEL **** DENSITYHIGH D LOW D                         IOC89590
LMG10  BCI     1, FOUND                                                 IOC89600
LMG11  BCI     2, NO TRAILER                                            IOC89610
LMG12  BCI     6, SEARCH SKIP LIST FOLLOWS... IF SSW  * DOWN REMOUNT    IOC89620
       VFD     6/LERIG,O30/6024466645                                   IOC89630
       BCI     2, REMOUNT                                               IOC89640
LMG13  BCI     4,  INPUT REEL,NO LABEL   TAPE POSITIONED AFTER 1ST REC  IOC89650
DLABEL BCI     3,DISK FILE LABEL                                       $IOC89660
HLABEL BCI     3, HYPERTAPE LABEL                                       IOC89670
       TTL                         LABEL CHECK INPUT FILE               IOC89680
*      TSX     LCKIN,1  XEC  LABRT1                                     IOC89690
*      RETURN  LABEL OK                                                 IOC89700
*      RETURN  LABEL ERROR                                              IOC89710
       SPACE   1                                                        IOC89720
*  THIS ROUTINE COMPARES     1. FILE SERIAL NUMBER  ) FOR TAPE ONLY    $IOC89730
*                            2. REEL SEQUENCE NUMBER)                  $IOC89740
*                            3. 18 CHARACTER FILE NAME                  IOC89750
       SPACE   1                                                        IOC89760
LCKIN  SXA     LCKI7,1             SAVE IR1                            *IOC89770
       CAL     FCW                 PLACE L(FILE)+12                     IOC89780
       ACL     L(12)               INTO COMPARE                         IOC89790
       STA     LCKI2                                                    IOC89800
       STZ     CHPSI               ZERO ERROR SWITCH                   $IOC89810
       ZET     HHDR                                                    *IOC89820
       TRA     LCK14               7340                                *IOC89830
LCKI4  NZT     DHDR                                                     IOC89840
       TRA     *+5                                                     $IOC89850
       AXT     3,4                 DISK                                $IOC89860
       AXT     3,1                                                     $IOC89870
       LDQ     L(0)                                                    $IOC89880
       TRA     LCKI1                                                   $IOC89890
       BES     LCKI4+NOCH/NOCH**-NOCH/NOCH*LCKI4-*                      IOC89900
       AXT     6,1                 COMPARE                              IOC89910
       AXT     8,4                 FILE WD. TO LABEL WD.                IOC89920
       LDQ     L(12)               7 3                                 $IOC89930
LCKI1  CAL     LAREA+10,4          8 4                                  IOC89940
       TXH     *+2,1,5                                                  IOC89950
       TXH     *+3,1,3             10-12 8-10                           IOC89960
       NZT*    *+2                 IF FILE NAME FIRST 6 CHAR            IOC89970
       TRA     *+4                 =0 SKIP NAME CHECK                  $IOC89980
LCKI2  ERA     **,1                ERROR CHECK                          IOC89990
       TZE     *+2                 IF ERROR                            $IOC90000
       STO     CHPSI               SET ERROR SWITCH                    $IOC90010
       TQP     *+3                                                      IOC90020
       TXI     *+1,1,-1                                                 IOC90030
       TXI     *+2,4,-4                                                 IOC90040
       TXI     *+1,4,-1                                                 IOC90050
       RQL     1                                                        IOC90060
       TIX     LCKI1,1,1                                                IOC90070
LCKI5  RIL     CP1+MODE+CKSUMS+BLKSEQ                                  *IOC90080
       CAL     LAREA                                                   *IOC90090
       ERA     BLNK                BYPASS IF BLANK LABEL               *IOC90100
       TZE     LCKI3                                                   *IOC90110
       AXT     0,4                                                     *IOC90120
       ZET     HHDR                                                    *IOC90130
       AXC     1,4                                                     *IOC90140
       STI     TEMIND              HOLD SI TEMPORARILY               (3)IOC90150
       PXA     0,0                                                     *IOC90160
       LDI*    LCK10,4                                                 *IOC90170
       XEC     LCK11,4                                                 *IOC90180
       ORA     FOR                 MIXED MODE                          *IOC90190
       XEC     LCK12,4                                                 *IOC90200
       ORA     MODBT               BINARY                              *IOC90210
       RNT     000100                                                  *IOC90220
       TRA     *+4                 NO BLOCK SEQUENCE                   *IOC90230
       RFT     010000                                                  *IOC90240
       ORA     L(64D)              BLOCK SEQUENCE AND CHECKSUMS        *IOC90250
       ORA     2P2                 BLOCK SEQ.,BUT NO CHECKSUMS         *IOC90260
       LDI     TEMIND                                                (3)IOC90270
       XEC     LCK13,4                                                 *IOC90280
       RQL     35                                                      *IOC90290
       TQP     *+4                                                   (3)IOC90300
       ACL     MSK2                CHECKPOINT AT                       $IOC90310
       SIL     CP1                 EACH REEL SWITCH                    $IOC90320
       STP     1,2                 MIXED MODE AND CHECKPOINT BITS      $IOC90330
       ANA     DECRE                                                   $IOC90340
       OAI                         BLOCK SEQUENCE AND CHECKSUMS        $IOC90350
LCKI3  TSX     LPRFD-2,4                                               *IOC90360
       PZE     **                  OPTIONAL LABELS                     *IOC90370
       BES     *-2+NOHYP/NOHYP*2-*                                      IOC90380
LCKI7  AXT     **,1                RESTORE IR1                         *IOC90390
       NZT     CHPSI               TEST ERROR SWITCH                   $IOC90400
       TRA     1,1                 EXIT                                $IOC90410
       TRA     2,1                 ERROR EXIT                          $IOC90420
*        LABEL CHECK HYPERTAPE INPUT HEADER                             IOC90430
LCK14  CAL     LAREA+2                           DDDIII                *IOC90440
       LDQ     LAREA+3                                     IIIIII      *IOC90450
       LGL     18                                IIIIII    III000      *IOC90460
       ERA     9,2                 FILE IDENTIFICATION                 *IOC90470
       TNZ     LCK15                                                   *IOC90480
       LGL     18                                XXXIII    000000      *IOC90490
       LDQ     LAREA+4                                     ISSSSS      *IOC90500
       LGL     6                                 XXIIII    SSSSS0      *IOC90510
       ALS     12                                IIII00                *IOC90520
       ERA     10,2                FILE IDENTIFICATION                 *IOC90530
       ARS     12                                                      *IOC90540
       TNZ     LCK15                                                   *IOC90550
       XCL                                       SSSSS0    XXXXXX      *IOC90560
       ARS     6                                 0SSSSS                *IOC90570
       ORA     BLK1                              BSSSSS                *IOC90580
       ERA     6,2                 FILE SERIAL NUMBER                  *IOC90590
       TNZ     LCK15                                                   *IOC90600
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *IOC90610
       RQL     6                                 XXXXXX    RRRRBB      *IOC90620
       XCL                                       RRRRBB                *IOC90630
       ERA     LAREA+6             REEL SEQUENCE NUMBER                *IOC90640
       TZE     *+2                                                     *IOC90650
LCK15  STL     CHPSI               ERROR SWITCH                        *IOC90660
       LDQ     1,2                                                     *IOC90670
       RQL     18                  IN READ BACKWARD MODE               *IOC90680
       TQP     LCKI5               NO                                  *IOC90690
*                  CONVERT BLOCK COUNT FROM BCD TO BINARY               IOC90700
       AXT     36,4                                                    *IOC90710
       LDQ     LAREA+11            BLOCK COUNT                         *IOC90720
       STZ     TEMP                                                    *IOC90730
       PXD     0,0                                                     *IOC90740
LCKI6  LGL     6                   GET NEXT DIGIT                      *IOC90750
       ACL     TEMP                                                    *IOC90760
       TNX     *+7,4,6                                                 *IOC90770
       STQ     RWL3                                                    *IOC90780
       XCL                                                             *IOC90790
       MPY     L(12A)                                                  *IOC90800
       STQ     TEMP                SAVE PARTIAL PRODUCT                *IOC90810
       LDQ     RWL3                                                    *IOC90820
       TRA     LCKI6                                                   *IOC90830
       ALS     18                                                      *IOC90840
       STD     3,2                                                     *IOC90850
       TRA     LCKI5                                                   *IOC90860
       BES     LCK14+NOHYP/NOHYP**-NOHYP/NOHYP*LCK14-*                  IOC90870
LCK10  LDI     LAREA+6                                                 *IOC90880
       LDI     LAREA+7                                                 *IOC90890
LCK11  LFT     2                                                       *IOC90900
       RFT     4                                                       *IOC90910
LCK12  LFT     1                                                       *IOC90920
       RFT     1                                                       *IOC90930
LCK13  LDQ     LAREA+6                                                 *IOC90940
       LDQ     LAREA+10                                                *IOC90950
       TTL              TRAILER CHECK INPUT FILE                        IOC90960
*      TSX     TCKIN,1  XEC  LABRT2                                     IOC90970
*      RETURN IF OK           TAKES SEQEX IF SEQ CHECK FAILS            IOC90980
*      AT EITHER RETURN  MQ +  EOR TRAILER                              IOC90990
*                        MQ -  HDR TRAILER (READ BACKWARD)              IOC91000
*                        MQ -  EOF TRAILER                              IOC91010
*                                                                       IOC91020
TCKIN  STI     TEMP                SAVE INDICATORS,NEED TAG            *IOC91030
       LDI     1,2                 FOR READ BACKWARD BIT               *IOC91040
       ONT     MSK2                                                    *IOC91050
       TRA     TCK3                                                    $IOC91060
       CAL     LAREA               CHECKPOINT AND READ BACKWARD        $IOC91070
       ERA     1HDR                                                    *IOC91080
       TZE     TCK3+3              1HDR-NORMAL SITUATION               *IOC91090
       TSX     (NDSLX,4                                                *IOC91100
       PZE     0,2,HBSFP           HYPERTAPE BACKSPACE FILE            *IOC91110
       TSX     RDLAB,4                                                 *IOC91120
       TRA     TCK4                                                    *IOC91130
       BES     *-10+NOHYP/NOHYP*10-*                                    IOC91140
TCK3   CAL     LAREA               PLACE TEMP + IF EOR                *$IOC91150
       ERA     1EOR                - IF EOF                             IOC91160
       TZE     *+2                                                      IOC91170
       SSM                                                              IOC91180
       LDI     TEMP                                                    *IOC91190
       STO     TEMP                CHECK FOR BOTH BCD AND               IOC91200
       CAL     3,2                 SPREAD OCTAL BLOCK COUNT             IOC91210
       TSX     (DECVD,4                                                $IOC91220
       XCL                                                              IOC91230
       SXA     TCK1,1                                                  *IOC91240
       AXC     1,1                                                     *IOC91250
       ZET     HHDR                WORD 2 IF 729,1301                  *IOC91260
       AXC     11,1                IF 7340,WORD 12                     *IOC91270
       ZET     HHDR                                                    *IOC91280
       ANA     MSK3                MASK OUT HIGH ORDER BLANK           *IOC91290
       ERA     LAREA,1                                                 *IOC91300
       TZE     *+4                                                     $IOC91310
       LDQ     3,2                 IF BLOCK COUNTS                     $IOC91320
       TSX     BCD5-1,4            AGREE THEN                           IOC91330
       ERA     LAREA,1             EXIT...ELSE TAKE                    *IOC91340
TCK2   STO     LPROO               SET SEQUENCE CONDITION              *IOC91350
       TSX     LPRFD-2,4           CHECK FOR                           *IOC91360
       PZE     ,,1                 OPTIONAL LABELS                     *IOC91370
       CLA     LPROO                                                   *IOC91380
       BES     TCK2+NOHYP/NOHYP**-NOHYP/NOHYP*TCK2-*                    IOC91390
       LDQ     TEMP                SEQUENCE ERROR EXIT                  IOC91400
       STO     TEMP                SAVE SEQ CONDITION (=0 OK)           IOC91410
TCK1   AXT     **,1                                                    *IOC91420
       TRA     1,1                 EXIT                                 IOC91430
TCK4   TSX     PROUT,4                                                 *IOC91440
       PZE     2                                                       *IOC91450
       MZE     9,2,3               ''FILE-NAME''                       *IOC91460
       PZE     LMG11,,2+512*DBLSP    ''NO TRAILER''                    *IOC91470
       TRA     LCK3                                                    *IOC91480
       BES     TCK4+NOHYP/NOHYP**-NOHYP/NOHYP*TCK4-*                    IOC91490
       TTL     CHECK LABEL OF SUPPOSED USEABLE OUTPUT REEL FOR LEGALITY IOC91500
*      TSX     LCKOF,1  XEC  LABRT3                                     IOC91510
*      RETURN  USEABLE                                                  IOC91520
*              RETENTION NOT EXPIRED                                   $IOC91530
*              NOT USABLE                                              $IOC91540
       SPACE   1                                                        IOC91550
LCKOF  CAL     LAREA               IF 1ST WORD = 1BLANK                 IOC91560
       ERA     BLNK                REEL OK TO USE                       IOC91570
       TZE     1,1                                                      IOC91580
       CAL     LAREA                                                    IOC91590
       ERA     1HDR                IF NOT 1BLANK OR 1HDR                IOC91600
       TNZ     3,1                 REEL NOT USEABLE                     IOC91610
       ZET     HHDR                                                    *IOC91620
       TRA     LCK3                7340                                *IOC91630
       CAL     LAREA+4             IF DATE(CREATION)+ RETENTION DAYS    IOC91640
       ANA     17SS                HAS NOT BEEN REACHED                $IOC91650
       ACL     LAREA+5             THEN TAKE RETENTION NOT              IOC91660
LCK2   TSX     BCDCV,4             EXPIRED EXIT                        $IOC91670
       SLW     RWL3                                                    *IOC91680
       ANA     MSK4                                                    *IOC91690
       LAS     LDOYR               CHECK SUM OVERFLOW                   IOC91700
       TRA     LCK1                TO NEXT YEAR                        $IOC91710
       AXT     0,0                                                      IOC91720
       CAL     RWL3                                                    *IOC91730
       ACL     BLP4                                                    $IOC91740
       LAS     DATE                IF ''SAVE DATE''                     IOC91750
       TRA     2,1                 NOT REACHED                          IOC91760
       TRA     1,1                 THEN REEL IS                         IOC91770
       TRA     1,1                 '' RETENTION PROTECTED''             IOC91780
LCK1   CAL     RWL3                                                    *IOC91790
       ACL     M365                ADD 1 YEAR,SUBTRACT 365 DAYS       *$IOC91800
       TRA     LCK2                                                    *IOC91810
       SPACE   1                                                        IOC91820
*        CHECK RETENTION PERIOD FOR HYPERTAPE                           IOC91830
LCK3   CAL     LAREA+1             RETENTION PERIOD                    *IOC91840
       ARS     12                  00RRRR                              *IOC91850
       TZE     1,1                 NOT APPLICABLE IF ZERO              *IOC91860
       SLW     RWL3                                                    *IOC91870
       CAL     LAREA+1                                                 *IOC91880
       ALS     6                   RRRYY0                              *IOC91890
       LDQ     LAREA+2                     DDDIII                      *IOC91900
       LGR     18                  YY0DDD                              *IOC91910
       XCL                         BEWARE OF Q BIT                     *IOC91920
       ACL     RWL3                                                    *IOC91930
       TRA     LCK2                                                    *IOC91940
       BES     LCK3+NOHYP/NOHYP**-NOHYP/NOHYP*LCK3-*                    IOC91950
       TTL              PREPARE OUTPUT TRAILER                          IOC91960
*         LOGICAL AC MUST CONTAIN EITHER  1EOF  OR 1EOR                $IOC91970
*      TSX     TPROF,1  XEC  LABRT4                                     IOC91980
*      RETURN                                                           IOC91990
       SPACE   1                                                        IOC92000
TPROF  SLW     LAREA               SET 1EOR OR 1EOF                    $IOC92010
       CAL     3,2                 IN TRAILER                           IOC92020
       TSX     (DECVD,4            CONVERT BLOCK                        IOC92030
       ZET     HHDR                COUNT TO DECIMAL                    $IOC92040
       TRA     TPROH               7340                                *IOC92050
       STQ     LAREA+1                                                  IOC92060
       LDQ     0,2                 INSERT IN TRAILER                    IOC92070
       RQL     21                  CONVERT UCW USED                     IOC92080
       TSX     (BCD5X,4            TO SPREAD OCTAL                     $IOC92090
       SLW     LAREA+2             AND INSERT IN TRAILER                IOC92100
       AXT     11,4                FOR POSSIBLE VISUAL                  IOC92110
       LDQ     BLNKS               USE LATER ON                         IOC92120
       STQ     LAREA+14,4                                               IOC92130
       TIX     *-1,4,1                                                  IOC92140
       AXT     6,4                                                     *IOC92150
       LDQ     LAREA1+6,4          BLANK OUT                           *IOC92160
       TIX     *-1,4,1             WORDS 15 TO 20                      *IOC92170
       BES     *-3+NOHYP/NOHYP*3-*                                      IOC92180
       TRA     1,1                 EXIT                                $IOC92190
TPROH  XCL                                                             *IOC92200
       ANA     MSK3                                                    *IOC92210
       SLW     LAREA+11            BLOCK COUNT                         $IOC92220
       LDQ     DATE                                                    *IOC92230
       STL     LPROO                                                   *IOC92240
       AXT     3,4                                                     *IOC92250
       TRA     LPRFC+2                                                 *IOC92260
       BES     TPROH+NOHYP/NOHYP**-NOHYP/NOHYP*TPROH-*                  IOC92270
       TTL                         PREPARE LABEL OUTPUT FILE            IOC92280
*      TSX     LPROF,1  XEC  LABRT5                                     IOC92290
*      RETURN                                                           IOC92300
       SPACE   1                                                        IOC92310
LPROF  CLA     1HDR                SET 1ST WORD                        $IOC92320
       STO     LAREA               = 1HDR                               IOC92330
       LDQ     DATE                5TH                                 $IOC92340
       ZET     HHDR                IF HYPERTAPE GO TO PREPARE          *IOC92350
       TRA     LPRFC               120 CHARACTER HEADER                *IOC92360
       STQ     LAREA+4             =TODAYS DATE                        $IOC92370
       CLA     8,2                 6TH                                 $IOC92380
       STO     LAREA+5             =RETENTION DAYS                     $IOC92390
LPRFG  NZT     DHDR                                                   *$IOC92400
       TRA     LPRFA               TAPE                                $IOC92410
       AXT     3,4                                                     $IOC92420
       CAL     BLNKS                                                   $IOC92430
       SLW     LAREA+4,4                                               $IOC92440
       TIX     *-1,4,1                                                 $IOC92450
       TRA     LPRFB                                                   $IOC92460
       BES     LPRFG+NOCH/NOCH**-NOCH/NOCH*LPRFG-*                      IOC92470
LPRFA  CLA     6,2                 3RD                                 $IOC92480
       STO     LAREA+2             = FILE SERIAL                        IOC92490
       CAL     7,2                 4TH                                  IOC92500
       SLW     LAREA+3             =REEL SEQUENCE NUMBER                IOC92510
LPRFB  CAL     6PRE                FIRST CHARACTER BLANK               $IOC92520
       STI     LAREA+10            SAVE SI TEMPORARILY                  IOC92530
       LDI     1,2                                                      IOC92540
       RFT     FDEN                FILE DENSITY                        $IOC92550
       ACL     L(64D)              =1 IF HI                            $IOC92560
       LFT     MODE                MODE                                 IOC92570
       ACL     1DEC                =1 IF BINARY                         IOC92580
       LFT     400000              IF MIXED MODE                        IOC92590
       ACL     2DEC                =2 OR 3 (M OR N)                     IOC92600
       LFT     CKSUMS              CHECKSUM                             IOC92610
       ACL     1P4                 =1 IF PRESENT                       *IOC92620
       LFT     BLKSEQ              BLOCK SEQ                            IOC92630
       ACL     1P5A                =1 IF PRESENT                       *IOC92640
       LNT     OPEND               IF OPENING                           IOC92650
       TRA     *+3                 NO CHECKPOINT                        IOC92660
       LFT     CP1                 BIT IN LABEL                        $IOC92670
       ACL     L(1)                CKPT BIT                             IOC92680
       SLW     LAREA+6             =1 IF CHECKPOINT FOLLOWS             IOC92690
       LDQ     9,2                 FILE NAME                            IOC92700
       STQ     LAREA+7             TO LABEL                             IOC92710
       LDQ     10,2                                                     IOC92720
       STQ     LAREA+8                                                  IOC92730
       LDQ     11,2                                                     IOC92740
       STQ     LAREA+9                                                  IOC92750
       LDI     LAREA+10            RESTORE SI                           IOC92760
       AXT     4,4                 BLANK OUT                            IOC92770
       CAL     BLNKS               WORDS 11 TO 14                       IOC92780
       SLW     LAREA+14,4                                               IOC92790
       TIX     *-1,4,1                                                  IOC92800
       AXT     4,4                                                     *IOC92810
       SLW     LAREA1+6,4          BLANK OUT                           *IOC92820
       TIX     *-1,4,1             WORDS 15 TO 20                      *IOC92830
       BES     *-3+NOHYP/NOHYP*3-*                                      IOC92840
       TRA     1,1                 EXIT                                $IOC92850
       TTL     PREPARE 120 CHARACTER HEADER                             IOC92860
*                                                                       IOC92870
*          FIELD  WORD  LENGTH  CONTENTS    DESCRIPTION                 IOC92880
*            1      1      6    1XXXBB      LABEL IDENTIFIER            IOC92890
*            2      2      4    RRRR        RETENTION PERIOD            IOC92900
*            3     2-3     5    YYDDD       CREATION DATE               IOC92910
*            4     3-5    10    IIIIIIIIII  FILE IDENTIFICATION         IOC92920
*            5      5      5    SSSSS       FILE SERIAL                 IOC92930
*            6      6      6    NNNNNB      REEL SERIAL                 IOC92940
*            7      7      5    RRRRB       REEL SEQUENCE               IOC92950
*            8     7-8     3                RESERVE                     IOC92960
*            9      8      1    D  (NA)     DENSITY                     IOC92970
*           10      8      1    C           CHECK SUM                   IOC92980
*           11      8      1    S           BLOCK SEQUENCE              IOC92990
*           12      8      1    T           TAPE CHECK/INTERPRET        IOC93000
*           13      9      1    R  (8)      RECORDING TECHNIQUE         IOC93010
*           14      9      1    P  (6)      PROCESSING TECHNIQUE        IOC93020
*           15      9      4    7090(4)     CREATING SYSTEM             IOC93030
*           16     10      1    F           RECORD FORMAT               IOC93040
*           17     10      5    LLLLL       RECORD LENGTH               IOC93050
*           18     11      5    SSSSS       BLOCK SIZE                  IOC93060
*           19     11      1    C           CHECKPOINT                  IOC93070
*           20     12      6    CCCCCC      BLOCK COUNT (TRAILER ONLY)  IOC93080
*          21-26  13-17   28                RESERVE                     IOC93090
*           27    17-20   20                OPTIONAL                    IOC93100
*                                                                       IOC93110
*                                                                       IOC93120
LPRFC  STZ     LPROO               RESET OUTPUT SWITCH                 *IOC93130
       AXT     2,4                                                     *IOC93140
       SXD     LPRFH,4                                                 *IOC93150
       CAL     8,2                 RETENTION     BBRRRR    MMBDDD      *IOC93160
       LGL     12                                RRRRMM    BDDD00      *IOC93170
       SLW     LAREA+1                                                 *IOC93180
       LGL     24                                XXBDDD    000000      *IOC93190
       LDQ     9,2                 IDENT 1-6               IIIIII      *IOC93200
       LGL     18                                DDDIII    III000      *IOC93210
       SLW     LAREA+2                                                 *IOC93220
       LGL     18                                XXXIII    000000      *IOC93230
       NZT     LPROO               DO NOT SET BLOCK                    *IOC93240
       STQ     LAREA+11            COUNT IF TRAILER                    *IOC93250
       LDQ     10,2                IDENT 7-10              IIIIBB      *IOC93260
       LGL     18                                IIIIII    IBB000      *IOC93270
       SLW     LAREA+3                                                 *IOC93280
       LGL     6                                 XXXXXI    BB0000      *IOC93290
       LDQ     6,2                 FILE SERIAL             BSSSSS      *IOC93300
       RQL     6                                           SSSSSB      *IOC93310
       LGR     6                                 0XXXXX    ISSSSS      *IOC93320
       STQ     LAREA+4                                                 *IOC93330
       LDQ     11,2                REEL SERIAL NUMBER                  *IOC93340
       STQ     LAREA+5                           NNNNNB                *IOC93350
       AXC     3,4                                                     *IOC93360
       ZET     LPROO                                                   *IOC93370
       STQ*    0,2                                                     *IOC93380
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *IOC93390
       RQL     6                                           RRRRBB      *IOC93400
       STQ     LAREA+6                                                 *IOC93410
       STI     LAREA1              HOLD SI TEMPORARILY                 *IOC93420
       LDI     1,2                                                     *IOC93430
       CAL     BB0001              FIRST CHARACTER BLANK               *IOC93440
       LFT     CKSUMS                                                  *IOC93450
       ACL     1P4                 YES                                 *IOC93460
       LFT     BLKSEQ                                                  *IOC93470
       ACL     1P5A                YES                                 *IOC93480
       LNT     MODE                                                    *IOC93490
       ACL     L(1)                BCD                                 *IOC93500
       LFT     400000              BINARY                              *IOC93510
       ACL     L(4)                MIXED MODE                          *IOC93520
       SLW     LAREA+7                                                 *IOC93530
       PXA     0,0                                                     *IOC93540
       OCT     044300012000        DOUBLE LOAD                         *IOC93550
       TZE     *+2                 7090                                *IOC93560
       CAL     L(4)                                                    *IOC93570
       ADM     H7090               CHECKING INTERPRETING TECHNIQUE     *IOC93580
       SLW     LAREA+8             DATA RECORDING TECHNIQUE            *IOC93590
       CAL     BBBBB                                                   *IOC93600
       LNT     OPEND                                                   *IOC93610
       TRA     *+3                 CHECKPOINT ONLY IF REEL SWITCHING   *IOC93620
       LFT     CP1                                                     *IOC93630
       ADM     L(1)                CHECKPOINT                          *IOC93640
       SLW     LAREA+10                                                *IOC93650
       CLA     BLNKS                                                   *IOC93660
       STO     LAREA+9                                                 *IOC93670
       LDI     LAREA1              RESTORE SI                          *IOC93680
       AXT     2,4                                                     *IOC93690
       STO     LAREA+14,4                                              *IOC93700
       TIX     *-1,4,1                                                 *IOC93710
       AXT     6,4                                                     *IOC93720
       STO     LAREA1+6,4          RESERVE AND OPTIONAL                *IOC93730
       TIX     *-1,4,1                                                 *IOC93740
       TSX     LPRFD,4             CHECK FOR USER                      *IOC93750
LPRFH  PZE     **                  LABEL ACTION                        *IOC93760
       TRA     1,1                 EXIT                                *IOC93770
       BES     LPRFC+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFC-*                  IOC93780
       TTL     ADDITIONAL LABEL RECORD ROUTINE                          IOC93790
*      THIS ROUTINE CHECKS FOR USER LABEL ACTION REQUESTS               IOC93800
*      ALL INDEX REGISTERS AND SENSE INDICATORS ARE SAVED               IOC93810
*                                                                       IOC93820
*      TSX     LPRFD-2,4                                                IOC93830
*      PZE     ,,DECREMENT                                              IOC93840
*      RETURN                                                           IOC93850
*                                                                       IOC93860
*                  DECREMENT = 0   CHECK INPUT HEADER                   IOC93870
*                              1   CHECK INPUT TRAILER                  IOC93880
*                              2   PREPARE OUTPUT HEADER                IOC93890
*                              3   PREPARE OUTPUT TRAILER               IOC93900
*                                                                       IOC93910
       NZT     HHDR                                                    *IOC93920
       TRA     2,4                 EXIT IF NOT 7340                    *IOC93930
LPRFD  CLA     1,4                                                     *IOC93940
       STD     LPRFJ                                                   *IOC93950
       CLA     2,2                                                     *IOC93960
       SXA     LPRFE,4                                                 *IOC93970
       PDX     0,4                                                     *IOC93980
       TXL     LPRFE,4,0           EXIT IF NO USER LABEL ACTION        *IOC93990
       SXA     LPRFE-2,1                                               *IOC94000
       SXA     LPRFE-1,2           SAVE IRS AND SI                     *IOC94010
       STI     LPRFF                                                   *IOC94020
LPRFJ  TXI     *+1,4,**                                                *IOC94030
       SXA     *+1,4                                                   *IOC94040
       TSX     **,4                GO TO USER                          *IOC94050
       LDI     LPRFF                                                   *IOC94060
       AXT     **,1                                                    *IOC94070
       AXT     **,2                RESTORE IRS AND SI                  *IOC94080
LPRFE  AXT     **,4                                                    *IOC94090
       TRA     2,4                                                     *IOC94100
LPROO  PZE     **                  NON-ZERO IF PREPARING TRAILER        IOC94110
H7090  BCI     1,867090            RECORDING SYSTEM                     IOC94120
LPRFI  OCT     700000000126                                            $IOC94130
LPRFF  PZE     **                  TEMP STORAGE                         IOC94140
L(12A) PZE     10                                                       IOC94150
BLK1   BCI     1, 00000                                                 IOC94160
       BES     LPRFD+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFD-*                  IOC94170
       TTL                         CONSTANTS FOR LABEL IMAGE ROUTINES   IOC94180
L(12)  PTW     12                                                       IOC94190
2DEC   PZE     0,,2                                                     IOC94200
1EOR   BCI     1,1EOR                                                   IOC94210
1EOF   BCI     1,1EOF                                                   IOC94220
1HDR   BCI     1,1HDR                                                   IOC94230
BLNK   BCI     1,1BLANK                                                 IOC94240
ASTER  BCI     1, *****                                                 IOC94250
BBBBB  BCI     1,     0                                                 IOC94260
LDOYR  BCI     1,000365                                                *IOC94270
BLP4   BCI     1,00 000                                                 IOC94280
M365   BCI     1,009635                                                 IOC94290
XCPT2  OCT     577777777777                                             IOC94300
MSK1   OCT     000077770000                                            $IOC94310
MSK2   OCT     200000400000                                             IOC94320
MSK3   OCT     077777777777                                             IOC94330
MSK4   OCT     000077777777                                            *IOC94340
2P2    BCI     1,020000                                                 IOC94350
1P4    BCI     1,000100                                                 IOC94360
BL1K   BCI     1,00000                                                  IOC94370
BB0001 BCI     1,  0001                                                 IOC94380
1P5A   BCI     1,000010                                                 IOC94390
       SPACE   1                                                        IOC94400
       BES     20                  PATCH AREA...........................IOC94410
B6FIN  BSS     0                   ...END LABEL IOCS STORAGE.........   IOC94420
CHK11  BSS     0                   UCW TABLE AND SS WORD                IOC94430
       TCD     -1                                                       IOC94440
       TTL 0                                                            IOD00000
       LBL     IOBB0000,1                                               IOD00010
*               DUMMY COMMUNICATIONS WITH LABEL PACKAGE                 IOD00020
       BES     FULIO-*                                                  IOD00030
       BCI     1,IOBB              NAME CELL FOR MAINTENANCE            IOD00040
       BES     FULIO-*                                                  IOD00050
LBMIS  SXA     LTSX,1            SAVE L(CALL)                           IOD00060
       CAL     *+2                                                      IOD00070
       TRA     TSXR                GO PRINT OUT ERROR CALL AND STOP     IOD00080
       MZE     *+1,,4                                                   IOD00090
       BCI     4, LABEL IOCS NECESSARY                                  IOD00100
       BES     20                  PATCH AREA                           IOD00110
B5FIN  BSS     0                   ....END BASIC IOCS STORAGE........   IOD00120
       BES     DE7-*                                                    IOD00130
       PZE     B5FIN+2             LOWER LIMIT OF BUFFERS               IOD00140
       BES     SH9+1-*                                                  IOD00150
       TSX     LBMIS,1             TSX LABCO,1                          IOD00160
       BES     OP7-*                                                    IOD00170
       TSX     LBMIS,1             TSX LABCI,1                          IOD00180
       BES     MNT1-1-*                                                 IOD00190
       TSX     LBMIS,1             LABEL MESSAGE                        IOD00200
       BES     OP9.2-*                                                  IOD00210
       TSX     LBMIS,1             TSX LABOO,1                          IOD00220
       BES     EOFEX+1-*                                                IOD00230
       TSX     LBMIS,1             TSX LAEOF,1                          IOD00240
       BES     RW7-*                                                    IOD00250
       TXL     BOUND,1,B5FIN-1     SYSTEM BOUNDARIES TEST               IOD00260
       BES     ETOF3-*                                                  IOD00270
       TSX     LBMIS,1             TSX LBEOT,1                          IOD00280
       TCD     -1                  END BASIC IOCS                       IOD00290
       TTL     DUMMY COMMUNICATIONS TO REST OF IOBS                     IOE00000
       LBL     IOBM0000,1                                               IOE00010
       SPACE   1                                                        IOE00020
       BES     BASIO-*                                                  IOE00030
       BCI     1,IOBM              NAME CELL FOR MAINTENANCE            IOE00040
       BES     BASIO-*                                                  IOE00050
       SXA     LTSX,4              SAVE L(CALL)                         IOE00060
P2MIS  CAL     *+2                                                      IOE00070
       TRA     TSXR                PRINT ILLEGAL CALL AND STOP          IOE00080
       MZE     *+1,,4                                                   IOE00090
       BCI     4, BASIC IOCS NECESSARY                                  IOE00100
LPMIS  SXA     LTSX,1            SAVE L(CALL)                           IOE00110
       CAL     *+2                                                      IOE00120
       TRA     TSXR                PRINT ILLEGAL LABEL CALL AND STOP    IOE00130
       MZE     *+1,,4                                                   IOE00140
       BCI     4, LABEL IOCS NECESSARY                                  IOE00150
       BES     20                  PATCH AREA                           IOE00160
B4FIN  BSS     0                   ...END MINIMUM IOCS STORAGE..........IOE00170
       TTL     OVERLAY IF ONLY MINIMUM IOCS IN MEMORY                   IOE00180
       BES     COPY+1-*                                                 IOE00190
       TXL     ENTRY,,P2MIS        COPY.                                IOE00200
       BES     REW+1-*                                                  IOE00210
       TXL     ENTRY,,P2MIS        REW.                                 IOE00220
       BES     WEF+1-*                                                  IOE00230
       TXL     ENTRY,,P2MIS        WEF.                                 IOE00240
       BES     BSF+1-*                                                  IOE00250
       TXL     ENTRY,,P2MIS        BSF.                                 IOE00260
       BES     CKPT+1-*                                                 IOE00270
       TRA     1,4                 CKPT.                                IOE00280
       BES     STASH+1-*                                                IOE00290
       TXL     ENTRY,,P2MIS        STASH.                               IOE00300
       BES     ENT1-1-*                                                 IOE00310
       NOP                         TSX CPINT,4                         $IOE00320
       BES     EX14-*                                                   IOE00330
       TRA     EX23                NOP CKPT SWT                         IOE00340
       BES     DE7-*                                                    IOE00350
       PZE     B4FIN+2,,0          LOWER LIMIT OF BUFFERS MINIMUM IOCS  IOE00360
       BES     JOINX-*                                                  IOE00370
       TRA     P2MIS               JOIN.                                IOE00380
       BES     SH1-*                                                    IOE00390
       TRA     *+2                 NOP INTERNAL FILE CLOSE              IOE00400
       BES     SH9+1-*                                                  IOE00410
       TSX     LPMIS,1             TSX LABCO,1                          IOE00420
       BES     OP4-*                                                    IOE00430
       TRA     *+2                 NOP INTERNAL FILE OPEN               IOE00440
       BES     OP7-*                                                    IOE00450
       TSX     LPMIS,1             TSX LABCI,1                          IOE00460
       BES     MNT1-1-*                                                 IOE00470
       TSX     LPMIS,1             LABEL MESSAGE                        IOE00480
       BES     OP9.2-*                                                  IOE00490
       TSX     LPMIS,1             TSX LABOO,1                          IOE00500
       BES     EOFEX+1-*                                                IOE00510
       TSX     LPMIS,1             TSX LAEOF,1                          IOE00520
       BES     RW7-*                                                    IOE00530
       TXL     BOUND,1,B4FIN-1     SYSTEM BOUNDARIES TEST               IOE00540
       BES     RE7-*                                                    IOE00550
       TRA     P2MIS               NOP INTERNAL FILE                    IOE00560
       BES     SEL5.9-*                                                 IOE00570
       TRA     P2MIS               NOP INTERNAL FILE                    IOE00580
       BES     ETOF3+2-*                                                IOE00590
       TRA     *+3                 NOP TSX CPINT,4                      IOE00600
       TCD     -1                  END MINIMUM IOCS                     IOE00610
       TTL     OVERLAY IF ONLY IOEX IN MEMORY                           IOF00000
       LBL     NOBS0000,1                                               IOF00010
       BES     B2FIN-*                                                  IOF00020
       BCI     1,NOBS              NAME CELL FOR MAINTENANCE            IOF00030
       BES     B2FIN-*                                                  IOF00040
BSMIS  PXA     0,4                                                      IOF00050
       PAC     0,4                                                      IOF00060
       PXA     0,4                                                      IOF00070
       LGR     15                                                       IOF00080
       ENB     L(0)                                                     IOF00090
       TSX     BCD5,4                                                   IOF00100
       SLW     MSMES+3                                                  IOF00110
       TSX     PROUT,4                                                  IOF00120
       PZE     1                                                        IOF00130
       PZE     MSMES,,4                                                 IOF00140
       TSX     STOP,4                                                   IOF00150
MSMES  BCI     4,IOBS NECESSARY                                         IOF00160
       BES     20                                                       IOF00170
B3FIN  BSS     0                                                        IOF00180
       BES     DEFINE-*                                                 IOF00190
       TRA     BSMIS                                                    IOF00200
       BES     JOIN-*                                                   IOF00210
       TRA     BSMIS                                                    IOF00220
       BES     ATTACH-*                                                 IOF00230
       TRA     BSMIS                                                    IOF00240
       BES     CLOSE-*                                                  IOF00250
       TRA     BSMIS                                                    IOF00260
       BES     OPEN-*                                                   IOF00270
       TRA     BSMIS                                                    IOF00280
       BES     READ-*                                                   IOF00290
       TRA     BSMIS                                                    IOF00300
       BES     WRITE-*                                                  IOF00310
       TRA     BSMIS                                                    IOF00320
       BES     COPY-*                                                   IOF00330
       TRA     BSMIS                                                    IOF00340
       BES     REW-*                                                    IOF00350
       TRA     BSMIS                                                    IOF00360
       BES     WEF-*                                                    IOF00370
       TRA     BSMIS                                                    IOF00380
       BES     BSR-*                                                    IOF00390
       TRA     BSMIS                                                    IOF00400
       BES     BSF-*                                                    IOF00410
       TRA     BSMIS                                                    IOF00420
       BES     CKPT-*                                                   IOF00430
       TRA     BSMIS                                                    IOF00440
       BES     STASH-*                                                  IOF00450
       TRA     BSMIS                                                    IOF00460
       BES     READR-*                                                  IOF00470
       TRA     BSMIS                                                    IOF00480
       BES     RELESE-*                                                 IOF00490
       TRA     BSMIS                                                    IOF00500
       END     -1                                                       IOF00510
