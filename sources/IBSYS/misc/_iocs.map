$*     7090/7094 IBLIB SYSTEM LIBRARY - .IOCS                           3IO00000
$IBMAP .IOCS   5700,()OK                                             $5$3IO00010
       TTL     .IOCS - RELOCATABLE IOCS                             (12)3IO00020
*THIS IS IOCS VERSION -6- WHICH HAS BEEN PREPARED                       3IO00030
*  FROM THE DISTRIBUTED VERSION OF THE IOCS SYSTEM                      3IO00040
* HERE, IOCC IS PRESENTED AS A SET OF SUBROUTINES                       3IO00050
*  WHICH MAY BE USED BY ANY SYSTEM FOR BUFFERRED I/O.                   3IO00060
*  USE OF THE BASIC MONITOR AND EXECUTOR IS REQUIRED.                   3IO00070
*  REFER TO BASIC MONITOR AND IOCS MANUALS FOR                          3IO00080
*  DETAILED CONTENT AND RULES OF USEAGE.                                3IO00090
       SPACE   1                                                        3IO00100
*THE FOLLOWING EQU CARDS MUST BE PROPERLY SETUP ACCORDING TO            3IO00110
*THE MACHINE CONFIGURATION AND THE INSTALLATION STANDARD                3IO00120
       SPACE   1                                                        3IO00130
*SYSTEM PRINTER                                                         3IO00140
       SPACE   1                                                        3IO00150
*      PRINTER BOARD SENSE EXIT FOR EJECT.....1 THROUGH 10              3IO00160
EJECT  EQU     1                                                        3IO00170
       SPACE   1                                                        3IO00180
*      PRINTER BOARD SENSE EXIT FOR DOUBLE SPACE.....1 THROUGH 10       3IO00190
DBLSP  EQU     4                                                        3IO00200
       SPACE   1                                                        3IO00210
*SENSE SWITCHES                                                         3IO00220
       SPACE   1                                                        3IO00230
*SENSE SWITCH FOR CHECKPOINT CONTROL. DOWN INITIATES CHECKPOINT.        3IO00240
SWTCP  EQU     2                                                        3IO00250
       SPACE   1                                                        3IO00260
*SENSE SWITCH FOR LABEL CONTROL. DOWN IGNORES LABEL ERRORS.             3IO00270
LERIG  EQU     3                                                        3IO00280
       SPACE   1                                                        3IO00290
 NOCH  SET     0     NO. OF DIRECT ACCESS MODULES DEFINED IN IOCS *DKDM 3IO00300
       SPACE   1                                                        3IO00310
NOHYP  EQU     0                                                        3IO00320
       SPACE   1                                                       $3IO00330
*END OF EQU CARDS TO BE DEFINED BY INSTALLATION.                        3IO00340
       TTL              IBSYS COMMUNICATION REGION                      3IO00350
IOEX   EQU     .ACTV                                                    3IO00360
(ACTIV EQU     IOEX                VALIDATE UNIT AND                    3IO00370
(ACTVX EQU     IOEX+1               ACTIVATE CHANNEL                    3IO00380
(NDATA EQU     IOEX+2              VALIDATE UNIT AND                    3IO00390
(NDSLX EQU     IOEX+3               NON-DATA SELECT                     3IO00400
(PROUT EQU     IOEX+4              MESSAGE WRITER                       3IO00410
(PUNCH EQU     IOEX+5              HOLLERITH PUNCH                      3IO00420
(FRCHX EQU     IOEX+6              FREE CHANNEL                         3IO00430
(PAWSX EQU     IOEX+7              ERROR PAUSE                          3IO00440
(PAUSE EQU     IOEX+8              OPERATOR ACTION PAUSE                3IO00450
(STOPX EQU     IOEX+9              SYSTEM STOP                          3IO00460
(SYMUN EQU     IOEX+10             SYMBOLIC UNIT CONVERSION             3IO00470
(DECVD EQU     IOEX+11             BIN TO DEC CONV. AC DECRE.           3IO00480
(DECVA EQU     IOEX+12             BIN TO DEC CONV. AC ADDR.            3IO00490
(CKWAT EQU     IOEX+13             CHECKPOINT DELAY ROUTINE             3IO00500
(BCD5R EQU     IOEX+14             BIN TO BCD CONV. MQ 3-17             3IO00510
(BCD5X EQU     IOEX+15             BIN TO BCD CONV. MQ S-14             3IO00520
(CVPRT EQU     IOEX+16             APPEND UNIT AND PRINT MESSAGE        3IO00530
(STOPD EQU     IOEX+17             DEAD STOP                            3IO00540
(CHXAC EQU     IOEX+18             CHANNEL ACTIVITY                     3IO00550
(URRXI EQU     IOEX+19             REDUNDANCY COUNTS                    3IO00560
(RCTXI EQU     IOEX+20             REDUNDANCY CONTROL                   3IO00570
(RCHXI EQU     IOEX+21             RCHX                                 3IO00580
(TCOXI EQU     IOEX+22             TCOX                                 3IO00590
(TRCXI EQU     IOEX+23             TRCX                                 3IO00600
(ETTXI EQU     IOEX+24             ETTX                                 3IO00610
(TEFXI EQU     IOEX+25             TEFX                                 3IO00620
(TRAPX EQU     IOEX+26             INDIRECT REF TRAP CELL               3IO00630
(TRAPS EQU     IOEX+27             CURRENT TRAPS (NORMAL)               3IO00640
(COMMM EQU     IOEX+28             SCHX RESULT AT TRAP                  3IO00650
(LTPOS EQU     IOEX+29             TP. POSITION BEFORE TRAP             3IO00660
(IOXSI EQU     IOEX+30             SI AT TRAP                           3IO00670
(CHPSW EQU     IOEX+31             CHECKPOINT SWITCH                    3IO00680
(TRPSW EQU     IOEX+32             TRAP SWITCH                          3IO00690
(FDAMT EQU     IOEX+33                                                 $3IO00700
(CHXSP EQU     IOEX+38                                                  3IO00710
       SPACE   1                                                        3IO00720
*                  INTERMEDIATE DEFINITIONS                             3IO00730
PROUT  EQU     (PROUT                                                   3IO00740
PAWS   EQU     (PAWSX                                                   3IO00750
PAUSE  EQU     (PAUSE                                                   3IO00760
STOP   EQU     (STOPX                                                   3IO00770
ACTV   EQU     (ACTIV                                                   3IO00780
TRAPS  EQU     (TRAPS                                                   3IO00790
CVPRT  EQU     (CVPRT                                                   3IO00800
       SPACE   1                                                        3IO00810
BCD5   EQU     (BCD5X                                                   3IO00820
COMM   EQU     (COMMM                                                   3IO00830
LTPOS  EQU     (LTPOS                                                   3IO00840
INTRAP EQU     (TRPSW                                                   3IO00850
SYUNCV EQU     (SYMUN                                                   3IO00860
NDATA  EQU     (NDATA                                                   3IO00870
BPRNT  EQU     (PROUT                                                   3IO00880
BSK1   EQU     EJECT                                                    3IO00890
BPAWS  EQU     (PAWSX                                                   3IO00900
TRPSW  EQU     (TRPSW                                                   3IO00910
STOPD  EQU     (STOPX                                                   3IO00920
       SPACE   1                                                        3IO00930
*                  ADDITIONAL OVERLAY EQUATES                           3IO00940
X09CH  EQU     NOCH+NOHYP                                               3IO00950
NOCHX  EQU     X09CH/X09CH                                              3IO00960
       SPACE   1                                                        3IO00970
       SPACE   1                                                        3IO00980
MXDMD  BOOL    400000              IF=1 MIXED MODE FILE                $3IO00990
CP1    BOOL    200000              CKPT BITS-ALLOWABLE CODES           $3IO01000
CP2    BOOL    100000              ARE 00,01,10                        $3IO01010
OPEND  BOOL    40000               IF=1 FILE OPEN                       3IO01020
RESER  BOOL    20000               IF=1 FILE RESERVE TYPE               3IO01030
NINHIB BOOL    10000               IF=1 FILE NOT INHIBITED              3IO01040
MODE   BOOL    04000               IF=1 BINARY FILE                     3IO01050
TTO    BOOL    02000               IF=1 TT0 IF BOTH=0 INPUT             3IO01060
PTO    BOOL    01000               IF=1 PT0 BOTH=1 CKPT                 3IO01070
LABEL  BOOL    00400               IF=1 LABELS                          3IO01080
BLKSEQ BOOL    00200               IF=1 BLOCK SEQ CHECKS                3IO01090
CKSUMS BOOL    00100               IF=1 CKECKSUMS                       3IO01100
SEARCH BOOL    00040               IF = 1 LABEL SEARCHING               3IO01110
MULTI  BOOL    00040               IF=1 MULTIPLE REEL FILE              3IO01120
GIVUP  BOOL    00020               IF=1 BUFFER GIVEN UP RECENTLY        3IO01130
RUSH   BOOL    00010               IF=1 RUSH THIS BUFFER                3IO01140
NOEOT  BOOL    00004               IF=1 NO EOT                          3IO01150
DETACH BOOL    00002               IF=1 FILE WAS PERM CLOSED            3IO01160
RHIST  BOOL    00001               IF=1 A RUSH DID OCCUR                3IO01170
LRDEN  BOOL    4                   IF=1 READ HI DENSITY LABEL           3IO01180
LWDEN  BOOL    2                   IF=1 WRITE HI DENSITY LABEL          3IO01190
FDEN   BOOL    100000              IF FILE DENSITY HIGH THEN=1         $3IO01200
DONLY  BOOL    40000               IF=1 ONLY DISCONNECT PRESENT BUFFER  3IO01210
DISCN  BOOL    20000               IF=1 IOCD OR IORY DISCONNECT BUFFER  3IO01220
GENER  BOOL    10000               IF=1 GENERATED DISCONNECT            3IO01230
EOB    BOOL    04000               IF=1 END OF BUFFER (0 WORDS LEFT)    3IO01240
INSAT  BOOL    02000               IF=1 INITIAL CONDITIONS SATISFIED    3IO01250
REINT  BOOL    01000               IF=1 NO BUFFER REQUESTED             3IO01260
HOLD   BOOL    00400               IF=1 HOLD PRESENT BUF WHEN RELEASED  3IO01270
SWATT  BOOL    00200               IF=1 ATTACH ROUTINE IN CONTROL       3IO01280
HELD   BOOL    00200               IF=1 A BUFFER WAS HELD               3IO01290
EOBXIT BOOL    00100               IF=1 EOB EXIT SHOULD BE TAKEN        3IO01300
STSH   BOOL    00100               IF =1 STASH ROUTINE                  3IO01310
CPYFN  BOOL    00040               IF =1 COPY MODE                      3IO01320
RDSWIT BOOL    00020               IF=1 READ ROUTINE IN CONTROL         3IO01330
XECNT  BOOL    00010               IF=1 A IOXYN WAS EXECUTED ON BUFFER  3IO01340
RETAIN BOOL    00004               IF=1 RETAIN CONTENT INTERNAL FILE    3IO01350
NOREW  BOOL    00004               IF=1 NO REW CLOSE                    3IO01360
IOSY   BOOL    00004               IF=1, IOSY WRITE                     3IO01370
NORUN  BOOL    00002               IF=1 NO REW UNLD                     3IO01380
NOEOF  BOOL    00002               IF=1, NO EOF ON SYNC                 3IO01390
NORED  BOOL    00001               IF=1 NO REDUNDANCY OCCURRED          3IO01400
FREEUP BOOL    100000              IF=1 ONLY FREE-UP A BUFFER          $3IO01410
CPYHLD BOOL    00001               COPY ROUTINE INDICATOR               3IO01420
NOEOFM BOOL    00001               IF =1 NO EOF WRITTEN ON CLOSE        3IO01430
INTRD  BOOL    00001               IF=1 SET READ MODE OPEN INTERNAL     3IO01440
       TTL     MULTIPLE CONDITION INDICATOR ASSIGNMENTS                 3IO01450
CDBTS  BOOL    24000               DISCN+EOB                            3IO01460
EACIO  BOOL    74044               DONLY+DISCN+GENER+EOB+CPYFN+IOSY     3IO01470
SEVER  BOOL    30031               RESER+NINHIB+RUSH+GIVUP+RHIST        3IO01480
OUTPUT BOOL    03000               PTO+TTO                              3IO01490
OPDET  BOOL    40002               OPEND+DETACH                         3IO01500
RESOP  BOOL    60000               RESER+OPEND                          3IO01510
OPNEOT BOOL    40004               OPEND+NOEOT                          3IO01520
RANDG  BOOL    00030               RUSH+GIVUP                           3IO01530
EOBITS BOOL    44400               DONLY+EOB+HOLD                       3IO01540
DIGEN  BOOL    30000               DISCN+GENER                          3IO01550
PRIBTS BOOL    00031               GIVUP+RUSH+RHIST                     3IO01560
EBDSY  BOOL    24004               DISCN+EOB+IOSY                       3IO01570
NOREOF BOOL    00003               NORED + NOEOF                        3IO01580
RBITS  BOOL    00011               RUSH + RHIST                        $3IO01590
OPNEOF BOOL    40004               OPENED+NOEOT (NOEOF)                 3IO01600
NETIH  BOOL    10004               NO EOT+NINHIB                        3IO01610
REWNUN BOOL    00006               NORUN + NOREW                       $3IO01620
       TTL     IOCS INPUT/OUTPUT CONTROL SYSTEM COMMUNICATION REGION    3IO01630
*      MINIUM COMMUNICATION REGION WITH .MINCR                          3IO01640
.DEFI. CONTRL  DEFIN.,DEFIN.                                            3IO01650
.JOINX CONTRL  JOINX,JOINX                                              3IO01660
.ATTC. CONTRL  ATTCH.,ATTCH.                                            3IO01670
.CLOS. CONTRL  CLOSE.,CLOSE.                                            3IO01680
.OPEN. CONTRL  OPEN.,OPEN.                                              3IO01690
.READ. CONTRL  READ.,READ.                                              3IO01700
.WRIT. CONTRL  WRITE.,WRITE.                                            3IO01710
.RER1. CONTRL  READR1,READR1                                            3IO01720
.RLSE. CONTRL  RELASE,RELASE                                            3IO01730
.SWITC CONTRL  SWITCH,SWITCH                                            3IO01740
.GTIOX CONTRL  GTIOX,GTIOX                                              3IO01750
.EOTOF CONTRL  EOTOF,EOTOF                                              3IO01760
.MONSW CONTRL  MONSW,MONSW                                              3IO01770
.TEOR  CONTRL  TEOR,TEOR                                                3IO01780
.RW7   CONTRL  RW7,RW7                                                  3IO01790
.ENDTR CONTRL  ENDTRK,ENDTRK                                            3IO01800
.TCHEX CONTRL  TCHEX,TCHEX                                              3IO01810
.L(0)  CONTRL  L(0),L(0)                                                3IO01820
.FEEIT CONTRL  FEEIT,FEEIT                                              3IO01830
.RER2. CONTRL  READR2,READR2                                            3IO01840
.OP4   CONTRL  OP4,OP4                                                  3IO01860
.SH1   CONTRL  SH1,SH1                                                  3IO01870
.RE7   CONTRL  RE7,RE7                                                  3IO01880
.SEL59 CONTRL  SEL5.9,SEL5.9                                            3IO01890
.ETOF3 CONTRL  ETOF3,ETOF3                                              3IO01900
.SH9   CONTRL  SH9,SH9                                                  3IO01910
.OP7   CONTRL  OP7,OP7                                                  3IO01920
.OP9.2 CONTRL  OP9.2,OP9.2                                              3IO01930
.MNT1A CONTRL  MNT1A,MNT1A                                              3IO01940
.EOFEX CONTRL  EOFEX,EOFEX                                              3IO01950
.BSF5  CONTRL  BSF5,BSF5                                                3IO01960
.BSR.  CONTRL  BSR.,BSR.                                                3IO01970
S5     BSS     0                                                        3IO01980
ENTRY  EQU     .ENTRY                                                   3IO01990
NOPXIT EQU     .NOPXI                                                   3IO02000
COMXIT EQU     .COMXI                                                   3IO02010
CPFILE EQU     .LFBLK+1                                                 3IO02020
CPSEQ  EQU     .LFBLK+2                                                 3IO02030
LTSX   EQU     .LFBLK+3                                                 3IO02040
XEOB   EQU     .LFBLK+4                                                 3IO02050
XEOF   EQU     .LFBLK+5                                                 3IO02060
XERR   EQU     .LFBLK+6                                                 3IO02070
LTRAD  EQU     .LFBLK+7                                                 3IO02080
TRANS  EQU     .LFBLK+8                                                 3IO02090
WDCT   EQU     .LFBLK+9                                                 3IO02100
CKPT1  EQU     .LUNBL+1                                                 3IO02110
SWITCD EQU     .LUNBL+2                                                 3IO02120
MONEOF EQU     .LUNBL+3                                                 3IO02130
IRS    EQU     .AREA1-3                                                 3IO02140
SENSE  EQU     .AREA1-2                                                 3IO02150
FCW    EQU     .AREA1-1                                                 3IO02160
LAREA1 EQU     .AREA1                                                   3IO02170
GO     EQU     .GO                                                      3IO02180
DATE   EQU     .JDATE                                                   3IO02190
ROUTE  EQU     .ENTRY+8                                                 3IO02200
MWR    EQU     .MWR                                                     3IO02210
LAREA  EQU     .LAREA                                                   3IO02220
LFLBLK EQU     .LFBLK                                                   3IO02230
LUNBLK EQU     .LUNBL                                                   3IO02240
* PRIMARY IOCS COMMUNICATIONS                                           3IO02250
       TTL              CONSTANT POOL                                   3IO02260
L(0)   PZE                                                              3IO02270
L(1)   PZE     1                                                        3IO02280
L(6)   PZE     6                                                        3IO02290
L(22)  PZE     22                                                       3IO02300
L(377) OCT     377                                                      3IO02310
L(400) OCT     400                                                      3IO02320
ADDRS  PZE     -1                                                       3IO02330
1DEC   PZE     0,,1                                                     3IO02340
1B17   EQU     1DEC                                                     3IO02350
TTOCT  OCT     17600000                                                 3IO02360
L(0)D  PZE     0,,L(0)                                                  3IO02370
DECRE  PZE     0,,-1                                                    3IO02380
1PRE   PON                                                              3IO02390
FOR    FOR                                                              3IO02400
SIX    SIX                                                              3IO02410
6PRE   EQU     SIX                                                      3IO02420
7PRE   SVN                                                              3IO02430
BLNKS  BCI     1,                                                       3IO02440
L(DWRC OCT     100677777777                                            $3IO02450
LDWRC  OCT     000600000000                                            $3IO02460
L(40)  PZE     40                                                      $3IO02470
BVDG   OCT     020100000000                                             3IO02480
DEC15  OCT     000017000000                                             3IO02490
       BES     *-5+NOCHX/NOCHX*5-*                                      3IO02500
MONSW  CAL     0,2                 NOTE SWITCH IN                       3IO02510
       SXA     MONS4,4             SYSTEM UNITS                         3IO02520
       PAC     0,4                 TEST FOR                             3IO02530
       STD     *+1                 SAME UNIT                            3IO02540
       TXI     *+1,4,**            X                                    3IO02550
       TXH     *+3,4,0             SWAP ENTRIES                         3IO02560
MONS4  AXT     **,4                SAME UNIT.                           3IO02570
       TRA     1,4                 EXIT                                 3IO02580
       STA     MONS1               DIFFERENT UNITS SAVE L(UCW)1         3IO02590
       ARS     18                  X                                    3IO02600
       STA     MONS2               SAVE L(UCW)2                         3IO02610
       CAL     SYSUNI              GET INDEX TO SYSUNI                  3IO02620
       ARS     18                  COMPUTE INDEX ADDRESS                3IO02630
       ACL     SYSUNI              X                                    3IO02640
       STA     MONS3               X                                    3IO02650
       SXA     MONS5,2             SAVE IR2                             3IO02660
       LXD     SYSUNI,4            NUMBER OF UNITS IN SYSUNI            3IO02670
       LXD     SYSUNI,2            X                                    3IO02680
       STA     *+1                 X                                    3IO02690
MONS6  CAL     **,4                FIND SYSTEM FUNCTION                 3IO02700
       ANA     ADDRS               USING UNIT 1                         3IO02710
       ERA     MONS1               X                                    3IO02720
       TZE     *+3                 FOUND.                               3IO02730
       TIX     *-4,4,1             NOT YET.                             3IO02740
       TRA     MONS5               ALL DONE                             3IO02750
MONS3  CAL     **,2                FIND SYSTEM FUNCTION                 3IO02760
       ANA     ADDRS               USING UNIT 2                         3IO02770
       ERA     MONS2               X                                    3IO02780
       TZE     *+3                 FOUND.                               3IO02790
       TIX     MONS3,2,1           NOT YET.                             3IO02800
       TRA     MONS5               ALL DONE.                            3IO02810
       CLA     MONS1               SWITCH                               3IO02820
       STA*    MONS3               SYSTEM UNITS.                        3IO02830
       CLA     MONS2               X                                    3IO02840
       STA*    MONS6               X                                    3IO02850
MONS5  AXT     **,2                RESTORE IR2                          3IO02860
       TRA     MONS4               GO RESTORE IR1 AND EXIT.             3IO02870
MONS1  PZE     **                  UNIT 1 (L(UCW))                      3IO02880
MONS2  PZE     **                  UNIT 2 (L(UCW))                      3IO02890
       TTL         TEST FOR   $ENDREEL   CARD AFTER EOF ON SYSTEM UNIT  3IO02900
TEOR   SXA     EORX4,4             SAVE IR4                             3IO02910
       STI     EORI                SAVE INDICATORS                      3IO02920
       CAL     EORT                SET UP SELECT                        3IO02930
       AXT     0,4                 TEST FOR                             3IO02940
       LDI*    0,2                 CARD UNIT                            3IO02950
       LFT     100                 X                                    3IO02960
       TRA     EORX4               ALWAYS EOF IF CARD UNIT              3IO02970
       AXC     1,4                 TO READ NEXT RECORD                  3IO02980
       SLW*    0,2                 AFTER END OF FILE                    3IO02990
       TSX     (NDATA,4            BACK SPACE OVER                      3IO03000
       PZE     0,2,BSROP           RECORD.                              3IO03010
       AXC     1,4                 WAIT TILL                            3IO03020
       ZET*    0,2                 ALL DONE.                            3IO03030
       TRA     *-1                 X                                    3IO03040
       CAL     LAREA               COMPARE WITH                         3IO03050
       ERA     MONEOR              MONITOR END REEL                     3IO03060
EORX4  AXT     **,4                RESTORE IR4                          3IO03070
       LDI     EORI                RESTORE INDICATORS                   3IO03080
       TZE     2,4                 EXIT IF END REEL                     3IO03090
       TRA     1,4                 END OF FILE.                         3IO03100
EORT   PZE     EORIOC,,*+1         SELECT WORD.                         3IO03110
       PAC     0,2                 SELECT ROUTINE.                      3IO03120
       TMI     EORM                TRANSFER IF POSTING.                 3IO03130
       LDI     0,2                                                     $3IO03140
       LFT     20000               HYPER                               $3IO03150
       TRA     EORH                YES                                 $3IO03160
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO03170
       CAL     0,2                 SET UP FOR                           3IO03180
       ARS     18                  READ                                 3IO03190
       STA     *+3                                                      3IO03200
       STZ     SYSJOB+2                                                 3IO03201
       ZET*    SYSJOB+1                                                 3IO03202
       RDS     **                  SELECT UNIT                          3IO03210
       CAL     1,2                 PICK UP COMMAND LOCATION.            3IO03220
       STA*    (RCHXI              INTO RCHX                            3IO03230
       XEC*    (RCHXI              READ INTO LABEL AREA.                3IO03240
       STZ*    (RCTXI              SUPPRESS REDUNDANCY CHECKING.        3IO03250
       TRA     1,4                 RETURN TO IOEX.                      3IO03260
EORM   STZ     1,2                 CLEAR UCB WORD 2                     3IO03270
       TRA     1,4                 RETURN TO IOEX.                      3IO03280
EORH   CLA     HYSEL                                                   $3IO03290
       ANS     HSMS+5                                                  $3IO03300
       PIA                                                             $3IO03310
       ANA     DEC15                                                   $3IO03320
       ORS     HSMS+5                                                  $3IO03330
       CAL     L(22)                                                   $3IO03340
       LFT     40                                                      $3IO03350
       ADD     L(1)                                                    $3IO03360
       STA     HSMS                                                    $3IO03370
       CAL     *-1                                                     $3IO03380
       TRA     EORM-4                                                  $3IO03390
HSMS   SMS     22                                                      $3IO03400
       CTLR    *+3                                                     $3IO03410
       CPYD    LAREA,,14                                               $3IO03420
       TCH     SYSTWT                                                  $3IO03430
       OCT     120600120112                                            $3IO03440
       BES     EORH+NOHYP/NOHYP**-NOHYP/NOHYP*EORH-*                    3IO03450
EORIOC IORT    LAREA,,14           COMMAND TO READ RECORD.              3IO03460
MONEOR BCI     1,$ENDREEL          MONITOR END OF REEL DESIGNATION.     3IO03470
EORI   PZE     **,,**              TEMP STORAGE FOR INDICATORS          3IO03480
       SPACE   1                                                        3IO03490
NEWIO  SVN     EACIO,7,0           RESET SI AT NEW COMMAND              3IO03500
CDTCT  FVE     CDBTS,0,0           CHANGE IOCD TO IOCT                  3IO03510
IOOP   OCT     700000600000        IO COMMAND OP CODE MASK              3IO03520
NTRES  SVN     -1-SWATT-NOREW-NORUN-NOEOFM,7,-1-RESER                   3IO03530
NOTIN  SVN     -1,7,-1-NINHIB                                           3IO03540
EOTBT  SVN     -1,7,-1-NOEOT                                            3IO03550
NEOTBT PZE     0,,NOEOT                                                 3IO03560
MODBT  PZE     0,0,MODE                                                 3IO03570
EOFBT  PZE     0,0,OUTPUT          MASK FOR BSF                        $3IO03580
       SPACE   1                                                        3IO03590
       TTL     DEFINE A. BUFFER POOL                                    3IO03600
*      CALLING SEQUENCE                                                 3IO03610
*              TSX  DEFINE,4                                            3IO03620
*              PZE  L(POOL)                                             3IO03630
*              PZE  N,,EFF BUF SIZE                                     3IO03640
*              RETURN                                                   3IO03650
*                                WHERE                                  3IO03660
*                  L(POOL) = LOCATION OF BUFFER POOL                    3IO03670
*                  N= NUMBER OF BUFFERS TO BE FORMED                    3IO03680
*           EFF BUF SIZE = THE DESIRED EFFECTIVE BUFFER SIZE            3IO03690
*      COMMENTS-                                                        3IO03700
*         1.THE SIZE OF A POOL = N(EFF BUF SIZE +2)+2                   3IO03710
*         2.THE FIRST TWO CELLS OF THE SPECIFIED AREA                   3IO03720
*            ARE MADE INTO THE BUFFER POOL CONTROL CELLS                3IO03730
*         3.THE MAXIMUM NUMBER OF BUFFERS PER POOL =32,767              3IO03740
       SPACE   1                                                        3IO03750
DEFIN. CLS     -1,4                SAVE                                 3IO03760
       ACL     L(1)                L(POOL+1)                            3IO03770
       STA     DE1                                                      3IO03780
       ACL     L(1)                SET LOCATION                         3IO03790
       STA     DE3                 OF 1ST BUFFER                        3IO03800
       STO*    FCW                 SET BPC= FOR BUF1,,0                 3IO03810
       CAL     0,4                 SET SECOND WORD                      3IO03820
       ANA     DECRE               OF POOL =                            3IO03830
       LGL     4                   S-13= BUF. SIZE                      3IO03840
DE1    SLW     **                  14-35 = 0                            3IO03850
       CLA     0,4                 SET IORT                             3IO03860
       STD     FCW                 =IORT POOL,,SIZE                     3IO03870
       PDX     0,1                 PLACE SIZE+2                         3IO03880
       TXI     *+1,1,2             INTO IR1                             3IO03890
       PAX     0,2                 NUMBER OF BUFFERS                    3IO03900
       ALS     18                  TO IR2                               3IO03910
       STD*    FCW                 AND POOL                             3IO03920
       CLA     DE3                 GO SETUP                             3IO03930
       TRA     DE5                 CHAIN MECHANISM                      3IO03940
DE2    CLA     FCW                 CHAIN BUFFER POOL                    3IO03950
DE3    STZ     **                  1ST BUFFER CONTROL WORD              3IO03960
       STA*    *-1                 = 0 00000 0 CHAIN                    3IO03970
DE4    STO     **                  2ND= IORT BPC,,SIZE                  3IO03980
       TNX     DE6,2,1             TEST IF N FORMED                     3IO03990
       PXA     0,1                 CHAIN LAST                           3IO04000
       ACL     DE3                 BUF TO NEXT                          3IO04010
       STA*    DE3                 FINAL BUFFER IS                      3IO04020
       STA     DE3                 CHAINED TO BPC                       3IO04030
DE5    ACL     L(1)                                                     3IO04040
       ANA     ADDRS                                                    3IO04050
       STA     DE4                                                      3IO04100
       TRA     DE2                                                      3IO04110
DE6    CLA     DE3                 PLACE L(LAST BUFFER) IN              3IO04120
       STA*    DE1                 2ND WD BPC FOR POSSIBLE JOIN         3IO04130
       TXI     .EX34,4,-1          EXIT AT 3,4                          3IO04140
DE7    PZE     .FDPOS,,0      LOWER BUFF LIMIT                          3IO04150
*                           JOIN ENTRY POINT                            3IO04160
*         PLACED HERE FOR L(ENTRY) CHECK IN EOT CHECK SUPPRESS          3IO04170
       SPACE   1                                                        3IO04180
JOINX  BSS     1                   TRA  JOIN                            3IO04190
       SPACE   1                                                        3IO04200
*                POOL DEFINITION OR JOIN ERROR HANDLER                  3IO04210
*   ENTRY AT TSXR STORES AC AS MESSAGE PARAM, ADDS L(TSX) AND PRINTS    3IO04220
PERR   CAL     PRR1                POOL ERROR MESSAGE USE               3IO04230
TSXR   LAC     LTSX,1              FIND L(TSX)                         $3IO04240
       SLW     TSXR1               STORE MESSAGE PARAM                  3IO04250
       PXA     0,1                 L(TSX) TO AC                         3IO04260
       LGR     15                                                       3IO04270
       ENB     L(0)                TRAP PROTECT BCD5 ROUTINE            3IO04280
       TSX     BCD5,4                                                   3IO04290
       SLW     TEMP                                                     3IO04300
       TSX     PROUT,4             PRINT MESSAGE                        3IO04310
L(2)   PZE     2                   ADDING L(TSX)                       $3IO04320
TSXR1  MZE     **,,**              TO END OF IT                         3IO04330
       PZE     TEMP,,1                                                  3IO04340
       TSX     STOP,4              STOP -IMPOSSIBLE TO CONTINUE         3IO04350
PRR1   MZE     MESS5,,3                                                 3IO04360
       TTL     ATTACH AND CLOSE ROUTINE                                 3IO04370
*                          CALLING SEQUENCES                            3IO04380
       SPACE   1                                                        3IO04390
*              TSX  ATTACH,4       MULTIPLE-FILE ATTACH                 3IO04400
*              PZE  POOL            TO SPECIFIED POOL                   3IO04410
*              PZE  LIST,,FILECT                                        3IO04420
       SPACE   1                                                        3IO04430
*              TSX  CLOSE,4        MULTIPLE FILE CLOSE                  3IO04440
*              PRE  LIST,,FILECT                                        3IO04450
       SPACE   1                                                        3IO04460
*              TSX CLOSE,4         SINGLE FILE CLOSE                    3IO04470
*              PRE  FILE                                                3IO04480
*                                   PRE=PZE REWIND UNLOAD               3IO04490
*                                      =PTW REWIND                      3IO04500
*                                      =MZE NO REWIND                   3IO04510
*                                      =MON NO EOF OR TRAILERS          3IO04520
*                             RESTRICTIONS                              3IO04530
*              1. ALL FILES TO USE A GIVEN POOL MUST BE ATTACHED        3IO04540
*                  IN ONE ATTACH CALLING SEQUENCE                       3IO04550
*              2. RESERVE FILES MUST BE OPENED VIA  OPEN  ROUTINE       3IO04560
*              3. THE BUFFERS SET ASIDE FOR A GROUP ARE REGAINED WHEN   3IO04570
*                  THE SVN WORD IS REFERENCED IN A CLOSE LIST           3IO04580
*              4. IF A RESERVE GROUP WORD APPEARS IN A CLOSE LIST       3IO04590
*                  THE ENTIRE GROUP OF RESERVE FILES MUST APPEAR AND    3IO04600
*                  BE INCLUDED IN THE FILECT.                           3IO04610
*              5. LAST RESERVE GROUP MUST HAVE AT LEAST ONE FILE        3IO04620
*              6. ALL IMMEDIATE FILES MUST PRECEDE ALL RESERVE FILES    3IO04630
*              7. FILES OF MORE THAN ONE POOL MAY APPEAR IN A CLOSE     3IO04640
*                  LIST.                                                3IO04650
*              8. A FILE IF REWOUND UNLOADED MAY NEVER AGAIN            3IO04660
*                  BE REFERENCED                                        3IO04670
       SPACE   1                                                        3IO04680
*                            CLOSE ROUTINE                              3IO04690
CLOSE. AXT     SHUT,1              PLACE CLOSE ACTION IN CALL           3IO04700
       STZ     7GRP                TO SUBROUTINES                       3IO04710
       CAL     -1,4                PLACE CLOSE                          3IO04720
       ARS     33                  MODE BITS IN                         3IO04730
       PAI                         SI                                   3IO04740
       CLA     -1,4                                                     3IO04750
       PDX     0,2                 TEST FOR SINGLE OR                   3IO04760
       TXH     CA1,2,0             MULTIPLE CLOSE                       3IO04770
       SXA     *+1,4               DUMMY LIST HANDLER TO                3IO04780
       AXC     **,2                HANDLE ONE FILE IN                   3IO04790
       TXI     CA2,2,-2            ACTUAL CALLING SEQUENCE              3IO04800
*                            ATTACH ROUTINE                             3IO04810
ATTCH. STA     LBC                 SAVE L(POOL)                         3IO04820
       CLA     1TAG                SET OUTPUT CHAIN =0                  3IO04830
       STA     1,2                 IF POOL HAS BEEN                     3IO04840
       ANA     1,2                 JOINED TO ANOTHER POOL GIVE          3IO04850
       TNZ     PERR                '' POOL ERROR ''                     3IO04860
       LDI     CA27                PLACE ATTACH MODE BIT IN SI          3IO04870
       AXT     OPAT,1              PLACE OPEN CALL                      3IO04880
       CLA     0,4                 FOR SUBROUTINE                       3IO04890
       TXI     CA1,4,-1            ADVANCE EXIT TO ACCT FOR XTRA WORD   3IO04900
       TTL     COMMON ROUTINE ATTACH AND CLOSE                          3IO04910
CA1    PAX     0,2                 PLACE L(LIST)-1                      3IO04920
       TXI     *+1,2,-1            IN LIST PROCESSOR                    3IO04930
CA2    SXA     CA51,2                                                   3IO04940
       STD     CA26                PLACE FILE COUNT IN INDEX CELL       3IO04950
       SXA     GTIOX,4             SAVE L(EXIT)                         3IO04960
       SXA     CA23+1,1            PLACE CALL FOR OPEN OR SHUT          3IO04970
       RNT     SWATT               ATTACH OR                            3IO04980
       TRA     CA10                CLOSE                                3IO04990
*                          ATTACH SUPERVISOR                            3IO05000
CA3    TSX     CA50,4              GET ENTRY FROM LIST                  3IO05010
       TRA     CA6                 ENTRY IS PZE FILE                    3IO05020
       LAC     CA24,1              ENTRY IS SVN FILECT,,BUFCT           3IO05030
       SXD     CA4,1               STORE FILECT FOR REDUCING BUFCT      3IO05040
       PDX     0,1                 REDUCE                              $3IO05050
       PDX     0,4                 THE                                 $3IO05060
CA4    TXI     *+1,4,**            BUFFER CT FOR GROUP SUCH             3IO05070
       PXD     0,4                 THAT THE SPECIFIED NUMBER            3IO05080
       STD*    CA51                OF FILES CAN ALWAYS BE OPENED        3IO05090
       LXA     CA51,2              SAVE L(SVN) WORD SUCH THAT IT        3IO05100
       SXA     CA5,2               CAN BE PLACED IN EACH RESERVE FILE   3IO05110
       SIL     RESER               SET RESERVE BIT                      3IO05120
CA5    PXD     **,1                REDUCE IBACT BY                      3IO05130
       TSX     ADIBC,1             BUFFER COUNT FOR THE GROUP           3IO05140
       TRA     CA3                 PROCESS FILE LIST                    3IO05150
*                        FILE HANDLER (ATTACH)                          3IO05160
       SPACE   1                                                        3IO05170
CA6    LFT     OPDET               IF ATTEMPTED ATTACH OF AN OPEN OR    3IO05180
       TRA     CA60                DETACHED FILE -ERROR STOP            3IO05190
       CLA     LBC                 PLACE L(POOL) IN                     3IO05200
       STA     2,2                 FILE CONTROL WORDS                   3IO05210
       ALS     18                  2ND WORD ADDRESS AND                 3IO05220
       STD     4,2                 5TH WORD DECREMENT                   3IO05230
       CAL     CA5                 IF THE FILE                          3IO05240
       LFT     RESER               IS A RESERVE FILE                    3IO05250
       STA     3,2                 PLACE L(SVN WORD)                    3IO05260
       TRA     CA20                IN FILE CONTROL BLOCK                3IO05270
*                           CLOSE SUPERVISOR                            3IO05280
CA10   TSX     CA50,4              PROCESS ENTRY IN FILE LIST           3IO05290
       TRA     CA13                ENTRY WAS PZE FILE                   3IO05300
       LXD     CA26,1              IF SINGLE FILE CLOSE                $3IO05310
       TXL     CA13,1,0            GO AS IF NO SUN                     $3IO05320
       ZET     7GRP                ENTRY IS SVN WORD                    3IO05330
       TSX     CA11,4              IF A SVN OCCURRED BEFORE-UPDATE      3IO05340
       CLA     CA51                ITS COUNTS AND SAVE THE              3IO05350
       STA     7GRP                LOCATION OF THE NEW SVN WORD         3IO05360
       TRA     CA10                PROCESS FILE LIST                    3IO05370
*POST-PROCESSOR OF SVN WORD (AFTER FILES OF THE GROUP HAVE BEEN CLOSED) 3IO05380
CA11   CLA*    7GRP                UP THE BUFFER COUNT                  3IO05390
       PAX     0,1                 BY THE FILECT OF THE                 3IO05400
       SXD     CA12,1              GROUP , THEN ADJUST                  3IO05410
       PDX     0,1                 IBACT BY THE INCREMENTED             3IO05420
CA12   TXI     *+1,1,**            BUFFER COUNT THAT WAS                3IO05430
       PXD     0,1                 RESERVED SOLELY FOR                  3IO05440
       STD*    7GRP                THE RESERVE GROUPS USAGE             3IO05450
       SSM                         SET TO ADD THIS COUNT.               3IO05460
       TSX     ADIBC,1                                                  3IO05470
       TRA     1,4                 EXIT                                 3IO05480
*                        FILE PROCESSOR(CLOSE)                          3IO05490
CA13   LFT     RESOP               IF FILE IS ALREADY                   3IO05500
       LFT     DETACH              PERMANENTLY CLOSED                   3IO05510
       TRA     CA25                THIS CLOSE IS A NOP                  3IO05520
       TSX     FNLBC,4             FIND L(POOL)                         3IO05530
*                GENERAL FILE HANDLER ATTACH AND CLOSE                  3IO05540
CA20   LAC     LBC,4               L(POOL) TO IR4                       3IO05550
       LFT     RESER               IF THE FILE IS A RESERVE, COUNTS     3IO05560
       TRA     CA23                HAVE BEEN ADJUSTED ALREADY           3IO05570
       LFT     TTO                 1ST TTO(ATTACH) AND LAST TTO (CLOSE) 3IO05580
       TRA     CA40                AFFECTS BY ONE BUFFER                3IO05590
CA22   CLS     1DEC                ADJUST IBACT BY                     $3IO05600
       TSX     ADIBC,1             1 EACH INPUT,PTO AND 1 ALL TTOS      3IO05610
CA23   ENB     TRAPS               ALLOW TRAPS                          3IO05620
       TSX     **,4                EITHER OPEN OR                       3IO05630
CA24   PZE     **                  SHUT THE FILE                        3IO05640
       PIA                         PLACE CONTROL BITS                   3IO05650
       STD     1,2                 IN FILE                              3IO05660
CA25   LXD     CA26,1              ADVANCE                              3IO05670
       TNX     CA27,1,1            ALONG FILE LIST                      3IO05680
       SXD     CA26,1              AS LONG AS MORE FILES                3IO05690
       RNT     SWATT               RETURN TO                            3IO05700
CA26   TXL     CA10,0,**           CA10 (CLOSE)                         3IO05710
       TRA     CA3                 CA3 (ATTACH)                         3IO05720
CA27   RNT     SWATT               IF A SVN APPEARED                    3IO05730
       NZT     7GRP                IN A CLOSE LIST AND                  3IO05740
       TRA     COMXIT+3            LIST ENDS ADJUST SVN WORD            3IO05750
       TSX     CA11,4              COUNTS BEFORE                        3IO05760
       TRA*    *-2                 EXITING                              3IO05770
       EJECT                                                            3IO05780
*                           TTO FILE HANDLER                            3IO05790
CA40   CAL     1,4                 DETERMINE IF THIS                    3IO05800
       RNT     SWATT               TTO IS THE FIRST ONE                 3IO05810
       SSM                         ATTACHED OR THE LAST                 3IO05820
       ADD     2TAG                ONE CLOSED, IF SO                    3IO05830
       SLW     1,4                 ADJUST IBACT BY ONE                  3IO05840
       ANA     TTOCT               NOTE.... RESERVE FILES (TTO)         3IO05850
       TZE     CA22                ARE NOT INCLUDED IN TTO CT           3IO05860
       ERA     2TAG                NOR DO THEY AFFECT                   3IO05870
       RFT     SWATT               ANY COUNTS AS THEY ARE HANDLED       3IO05880
       TZE     CA22                BY SVN WORD                          3IO05890
       TRA     CA23                                                     3IO05900
*                         FILE LIST PROCESSOR                           3IO05910
CA50   CLA     CA51                ADVANCE IN LIST                      3IO05920
       ACL     L(1)                NOTE... THAT L(LIST)-1 ORIGINALLY    3IO05930
       STA     CA51                IN LIST LOCATOR                      3IO05940
       RNT     SWATT               RESET ALL CONTROL BITS EXCEPT        3IO05950
       RIL     RESER               SWATT AND IF ATTACHING               3IO05960
       RIS     NTRES               RESERVE BIT                          3IO05970
       ENB     L(0)                TRAP PROTECT                         3IO05980
CA51   CAL     **                  WHILE ADJUSTING                      3IO05990
       PAC     0,2                 COUNTS                               3IO06000
       STA     CA24                L(FILE) TO IR2 AND CA24              3IO06010
       STA     FCW                 IN FCW CELL                          3IO06020
       ANA     6PRE                CHECK IF SIX OR                      3IO06030
       OAI                         SVN WORD APPEARS                     3IO06040
       CLA*    CA51                PICKUP LIST ENTRY                    3IO06050
       LNT     600000              SIX OR SVN                           3IO06060
       TRA     *+2                 IF SO EXIT                           3IO06070
       TRA     2,4                 AT 2,4                               3IO06080
       RFT     SWATT               IF ATTACHING                         3IO06090
       STD     2,2                 SAVE L(NON-STANDARD LABEL PKG.)      3IO06100
       CLA     1,2                 PLACE FILE CONTROL BITS              3IO06110
       RIL     700000              RESET SIX OR SVN CODE IN SI PREFIX   3IO06120
       ANA     PDMSK               IN SENSE INDICATORS                  3IO06130
       OAI                         AND EXIT AT                          3IO06140
       TRA     1,4                 1,4                                  3IO06150
*                      OPEN ERROR MESSAGE SENDER                        3IO06160
CA60   TSX     DRANO,4             UNIT NO. TO MESSAGE                  3IO06170
       TSX     PROUT,4             PRINT ERROR MESSAGE                  3IO06180
       PZE     3                   DETACHED FILE                        3IO06190
       MZE     MESS1,,2            AND STOP.                            3IO06200
       MZE     9,2,3               IF OPERATOR                          3IO06210
       PZE     MESS7,,6            PROCEEDS THEN FILE IS                3IO06220
       TSX     PAWS,4              NOT OPENED                           3IO06230
       TRA     OP1+1                                                    3IO06240
       TTL                         DE-ACTIVATE FILE                     3IO06250
*                           CALLING SEQUENCE                            3IO06260
*              TSX  SHUT,4         IR2 MUST= -L(FCW)                    3IO06270
*              **      **                                               3IO06280
*              RETURNS AT CA24+1                                        3IO06290
       SPACE   1                                                        3IO06300
SHUT   SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO06310
       LNT     RESOP               IF CLOSING AN OPEN                   3IO06320
       TRA     *+4                 RESERVE FILE                         3IO06330
       CLA*    3,2                 ADD 1 TO SIMOPENCT                   3IO06340
       ACL     L(1)                ALLOWING ANOTHER FILE                3IO06350
       STA*    3,2                 OF THE GROUP TO BE OPENED LATER      3IO06360
       CLA     3,2                 HANDLE INTERNAL                      3IO06370
SH1    TRA     *+1                 FILE SEPARATELY   TMI  INTCL         3IO06380
       LNT     OUTPUT              IF CHECKPOINT FILE OR                3IO06390
       LNT     OPEND               IF FILE NEVER                        3IO06400
       TRA     SH2                 IF, ALREADY CLOSED, CLEAN UP        $3IO06410
       LFT     OUTPUT              INPUT OR                             3IO06420
       TRA     SH5                 OUTPUT FILE                          3IO06430
       SPACE   1                                                        3IO06440
*                           CLOSE INPUT FILE                            3IO06450
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3IO06460
       CAL     0,2                 MAKE SURE EOF                       $3IO06470
       ANA     FOR                 FLAG IS OFF                         $3IO06480
       STP     0,2                                                     $3IO06490
       BES     *-3+NOCH/NOCH*3-*                                        3IO06500
SH2    CLA     5,2                 CHECK FOR HYPER                     $3IO06510
       ANA     SIX                                                     $3IO06520
       TNZ     SH4                                                     $3IO06530
       RNT     REWNUN                                                  $3IO06540
       TRA     SH6                 RETURN                              $3IO06550
       RIR     REWNUN              TAKE OUT HYPER OPTION               $3IO06560
       TRA     SH6                 RETURN                              $3IO06570
SH4    RNT     5                                                        3IO06580
       TRA     *+3                                                      3IO06590
       RNT     2                                                        3IO06600
       TRA     *+5                                                      3IO06610
       RNT     NOEOFM              TEST FOR FILE PROTECT                3IO06620
       TRA     *+3                 NO                                  $3IO06630
       TSX     (NDSLX,4            YES                                 $3IO06640
       PZE     0,2,HFPNP           FILE PROTECT                        $3IO06650
       RNT     REWNUN              TEST FOR UNLOAD                     $3IO06660
       TRA     SH6                 NO                                  $3IO06670
       TSX     (NDSLX,4            YES                                 $3IO06680
       PZE     0,2,HUNLP           UNLOAD                              $3IO06690
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $3IO06700
       TRA     SH4.1-2             EXIT                                $3IO06710
       BES     SH2+NOHYP/NOHYP**-NOHYP/NOHYP*SH2-*                      3IO06720
SH6    RNT     NOREW               IF NO REWIND FINISH UP              $3IO06730
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY          $3IO06740
       RFT     NOREW               IF NO REWIND                         3IO06750
       TRA     SH4.1               SPECIFIED SKIP OUT                   3IO06760
       CAL     3DEC                FORM REW CODE (=3)                   3IO06770
       RNT     NORUN               OR REW UNLOAD                        3IO06780
       ACL     1DEC                CODE (=4)                            3IO06790
       STD     *+2                                                      3IO06800
       TSX     NDSEL+1,4           ISSUE REW                            3IO06810
       PZE     0,2,**              OR RUN                               3IO06820
       RFT     REWNUN              IF REWOUND AND                      $3IO06830
       TRA     SH4.1               UNLOADED                             3IO06840
       SIL     DETACH              PRINT MESSAGE                        3IO06850
       TSX     UNMNT,4             TO OPERATOR                          3IO06860
SH4.1  LFT     RESER               RESET FILE                           3IO06870
       ZET     7GRP                BITS UNLESS SINGLE CLOSE             3IO06880
       RIL     SEVER               OF A RESERVE FILE                    3IO06890
       RIL     OPEND               RESET OPENED BIT                     3IO06900
       TRA     CA24+1              EXIT                                 3IO06910
       SPACE   1                                                        3IO06920
*                          CLOSE OUTPUT FILE                            3IO06930
SH5    TSX     UNBFO,4             WAIT TILL ALL I/O IS DONE            3IO06940
       RNT     000005              CHECK FOR HYPER OPTIONS             $3IO06950
       TRA     *+3                 NOT MON OPTION                      $3IO06960
       RNT     NORUN               IF TRUE MON OPTION                  $3IO06970
       TRA     SH3                 SKIP EOF AND LABEL WRITES            3IO06980
       TSX     NDSEL+1,4           WRITE                                3IO06990
       PZE     0,2,WEFOP           EOF                                  3IO07000
       NOP                         IGNORE EOT                           3IO07010
SH9    LFT     LABEL               IF LABELED,WRITE TRAILER             3IO07020
       BSS     1                   TSX  LABCO,1                         3IO07030
SH3    LAC     LBC,4               L(POOL) TO IR4                       3IO07040
       SXD     SH33,2              REMOVE FILE FROM                     3IO07050
SH32   CLA     1,4                 OUTPUT CHAIN BY FINDING              3IO07060
       PAX     0,1                 FILE THAT REFERENCES CLOSING         3IO07070
SH33   TXI     *+1,1,**            FILE AND REPLACING CHAINS.           3IO07080
       TXL     SH34,1,0            FOUND.                               3IO07090
       PAC     0,4                 NOT FOUND. ADVANCE                   3IO07100
       TRA     SH32                ALONG CHAIN.                         3IO07110
SH34   CLA     1,2                 REPLACE CHAIN IN FILE THAT           3IO07120
       STA     1,4                 REFERENCED CLOSING FILE              3IO07130
       RNT     000005              IS THIS CLOSE                       $3IO07140
       TRA     *+3                 A TRUE MON OPTION                   $3IO07150
       RNT     NORUN                                                   $3IO07160
       TRA     SH4.1               YES,POST AND RETURN                 $3IO07170
       TRA     SH2                 NO, CHECK FOR FURTHER ACTION        $3IO07180
       TTL                         OPEN ROUTINE                         3IO07190
*            OPEN THE SPECIFIED FILE (OPTIONAL NO- REWIND)              3IO07200
       SPACE   1                                                        3IO07210
*                           CALLING SEQUENCE                            3IO07220
*              TSX OPEN,4                                               3IO07230
*               P  FILE,,1                                              3IO07240
*      WHERE                                                            3IO07250
*              P= PZE REWIND BEFORE OPEN                                3IO07260
*              P= MZE NO REWIND                                         3IO07270
*              P= MON NO REWIND, NO LABELS                              3IO07280
*              P= PTW REWIND AND FILE PROTECT BEFORE OPEN IF HYPERTAPE  3IO07290
*              P= SIX NO REWIND AND FILE PROTECT IF HYPERTAPE           3IO07300
*              P= SVN NO REWIND,NO LABELS AND FILE PROTECT IF HYPERTAPE 3IO07310
*              1 IN DECREMENT IF HYPERTAPE READ BACKWARD IS DESIRED     3IO07320
*      ACTIONS ....                                                     3IO07330
*              1. ALLOWS ACTUAL I/O TO BE EXECUTED                      3IO07340
*              2. INITIATES PRIMARY INPUT BUFFER INPUT FILE             3IO07350
*              3. LABELS HANDLED AT OPEN INPUT OR OUTPUT                3IO07360
       SPACE   1                                                        3IO07370
OPEN.  LNT     OPEND               IF FILE ALREADY OPN                  3IO07380
       TRA     OP2                 CLEAR INHIBITED INDICATOR            3IO07390
OP1    SIL     OPNEOT              SET OPEN AND NO EOT CODE             3IO07400
       RFT     SWATT               IF ATTACHING                         3IO07410
       TRA     CA24+1              RETURN THERE                         3IO07420
       TRA     COMXIT              ELSE EXIT TO USER                    3IO07430
OPAT   LNT     RESER               RESERVE FILES ARE                    3IO07440
       TXI     OP2,4,-2            NOT OPENED AT ATTACHMENT             3IO07450
       SIL     NETIH               SET NO EOT CODE+ NOT INHIBITED       3IO07460
       TRA     CA24+1                                                   3IO07470
OP2    SIL     NETIH               SET NO EOT + NOT INHIB               3IO07480
       LFT     DETACH              IF FILE HAS BEEN REWOUND-UNLOADED    3IO07490
       TRA     CA60                PRINT ERROR MESSAGE                  3IO07500
       LNT     RESER               IF FILE IS RESERVE TYPE              3IO07510
       TRA     OP4+1               CHECK TO MAKE                        3IO07520
       CLA*    3,2                 SURE THAT NO MORE                    3IO07530
       PAX     0,1                 THAN THE SPECIFIED                   3IO07540
       TXI     *+1,1,-1            NUMBER OF FILES ARE                  3IO07550
       TXH     OP10,1,4096         SIMULTANEOUSLY OPENED                3IO07560
       PXA     0,1                                                      3IO07570
       STA*    3,2                                                      3IO07580
       CLA     3,2                 HANDLE INTERNAL FILE                 3IO07590
OP4    TRA     *+1                 SEPARATELY    TMI  INTOP             3IO07600
       SXA     2TAG+2,4            SAVE IR 4                            3IO07610
       LDQ     0,2                 CHECK                                3IO07620
       RQL     18                  REEL IS MOUNTED                      3IO07630
       TQP     OP11                IF NOT INFORM OPERATOR               3IO07640
OP4.5  CLA     L(0)A               SYNC ADDRESS                        $3IO07650
       STA     4,2                 = L(0)                               3IO07660
       TSX     (NDATA,4            TEST LEGALITY                       $3IO07670
2TAG   PZE     0,2,TESTP           OF UNIT                              3IO07680
       TSX     DENSE,4             SET FILE DENSITY                     3IO07690
       AXT     **,4                                                     3IO07700
       CLA     -1,4                                                     3IO07710
       TPL     *+4                 IF PZE- REW                          3IO07720
       ANA     1PRE                MZE- NO REW                          3IO07730
       TNZ     OP9.3               MON-NO REW, NO LABELS                3IO07740
       TRA     OP6                                                      3IO07750
       TSX     NDSEL+1,4           REWIND BEFORE                        3IO07760
       PZE     0,2,REWOP           OPEN                                 3IO07770
OP6    TSX     OP7.1,1             CHECK FOR HYPER DETAILS              3IO07780
       BES     *-1+NOHYP/NOHYP*1-*                                      3IO07790
       CAL     SIX                 CLEAR ERROR INFO.                   $3IO07800
       ANS     5,2                 HISTORY AND                         $3IO07810
       STD     3,2                 BLOCK SEQUENCE                      $3IO07820
       LFT     OUTPUT                                                  $3IO07830
       TRA     OP9                 IS DONE EXCEPT LABELS                3IO07840
       SPACE   1                                                        3IO07850
*                           OPEN INPUT FILE                             3IO07860
       TSX     FNLBC,4             FIND L(POOL)                         3IO07870
       LFT     LABEL               LABEL ACTION                         3IO07880
OP7    BSS     1                   TSX   LABCI,1                        3IO07890
       PXD     0,0                 CLEAR BUFFER COUNT                   3IO07900
       STA     1,2                 IN FCB.                              3IO07910
       TSX     BORBF,1             INITIATE READ                        3IO07920
LBC    NOP                         IF POSSIBLE ... L(POOL)...           3IO07930
       TRA     OP1                 EXIT                                 3IO07940
       SPACE   1                                                        3IO07950
*                           OPEN OUTPUT FILE                            3IO07960
OP9    LNT     OUTPUT              LOOK FOR CHECKPOINT                  3IO07970
       TRA     OP9.1               FILE DEFINITION                      3IO07980
       CAL     FCW                 BY OPENING                           3IO07990
       STA     CPFILE              OUTPUT FILE                          3IO08000
       TRA     OP1                 CODE= PTO+TTO                        3IO08010
OP9.1  LFT     LABEL               ACTION                               3IO08020
OP9.2  BSS     1                   TSX   LABOO,1                        3IO08030
       TSX     FNLBC,4             FIND L(POOL)                         3IO08040
       LAC     LBC,4               L(POOL) TO IR4                       3IO08050
       CLA     1,4                 PLACE OUTPUT                         3IO08060
       STA     1,2                 FILE IN SYNCING                      3IO08070
       CLA     FCW                 CHAIN USED TO                        3IO08080
       STA     1,4                 RELEASED TO THE                      3IO08090
       TRA     OP1                 BUFFER POOL                          3IO08100
*                   BYPASS REWIND AND LABEL ACTION.                     3IO08110
OP9.3  TSX     OP7.1,1             CHECK FOR HYPER DETAILS              3IO08120
       BES     *-1+NOHYP/NOHYP*1-*                                      3IO08130
       LNT     OUTPUT              TEST FOR CHECKPOINT                 $3IO08140
       TRA     *+2                 NO.                                  3IO08150
       TRA     OP9+2               ASSIGN CHECKPOINT.                   3IO08160
       LFT     OUTPUT              INPUT OR                             3IO08170
       TRA     OP9.2+1             OUTPUT. ENTER IN CHAIN.              3IO08180
       TSX     FNLBC,4             INPUT. FIND L(POOL)                  3IO08190
       TRA     OP7+1               INITIATE READ.                       3IO08200
       SPACE   1                                                        3IO08210
*                     ERROR TOO MANY RESERVES OPEN                      3IO08220
OP10   TSX     PROUT,4             PRINT RESERVE FILE                   3IO08230
       PZE     2                   CONFLICT ERROR                       3IO08240
3DEC   MZE     9,2,3               AND STOP.... IF STARTED              3IO08250
       PZE     MESS6,,7            NO OPEN OCCURS                       3IO08260
       TSX     PAWS,4                                                   3IO08270
       TRA     OP1+1                                                    3IO08280
       SPACE   1                                                        3IO08290
*          FILE IS NOT MOUNTED SEND INSTRUCTIONS TO OPERATOR            3IO08300
OP11   CLA     5,2                 IF DISK,JUST                        $3IO08310
       TMI     MNTFLG              PUT MOUNT FLAG ON                 (4)3IO08313
       AXT     4,1                 CHANGE MSGE COUNT                 (4)3IO08317
       SXD     MNT2+5,1            FOR FILE SERIAL NOTICE            (4)3IO08320
       CAL     6,2                 ON LINE                           (4)3IO08323
       SLW     MES23+4             FOR DEFERRED OPEN                 (4)3IO08327
       CAL     7,2                 REEL NUMBER TO MOUNT                $3IO08330
       TSX     MOUNT,4                                                  3IO08340
       AXT     2,1                 RESTORE MSGE COUNT                (4)3IO08343
       SXD     MNT2+5,1            FOR ANY REEL SWITCH               (4)3IO08347
       TSX     PAUSE,4             WAIT FOR OPERATOR                    3IO08350
MNTFLG CLA     *-1                 PUT MOUNT FLAG ON                 (4)3IO08360
       STT     0,2                                                     $3IO08370
       TRA     OP4.5               PROCEED IN OPEN                     $3IO08380
*              THIS ROUTINE OPENS FOR BACKWARD READ AND F.P.           $3IO08390
OP7.1  CLA     5,2                 IS THIS HYPERTAPE                    3IO08400
       ANA     SIX                                                     $3IO08410
       TZE     OP7.3               NO                                  $3IO08420
       RIR     MXDMD               RESET BACKWARD READ                  3IO08430
       PIA                                                             $3IO08440
       STT     1,2                                                     $3IO08450
       LFT     OUTPUT              IF OUTPUT                           $3IO08460
       TRA     1,1                 ALL DONE                            $3IO08470
       LXD     XEOB,4              BACKWARD READ SPECIFIED             $3IO08480
       TXL     OP7.2,4,0           NO                                  $3IO08490
       ORA     *-1                 SET READ                            $3IO08500
       STT     1,2                 BACKWARD                            $3IO08510
       AXC     2,4                                                     $3IO08520
       CLA*    0,2                                                     $3IO08530
       ANA     ADDRS               IF NEXT READ IS NOT A               $3IO08540
       TNZ     OP7.2               FILE MARK THEN PROCEED              $3IO08550
       TSX     (NDSLX,4            ELSE BACKSPACE FILE                 $3IO08560
       PZE     0,2,HBSFP                                               $3IO08570
OP7.2  LXA     2TAG+2,4                                                $3IO08580
       CLA     -1,4                TEST FOR THE                        $3IO08590
       ANA     SIX                 SETTING OF FILE PROTECT             $3IO08600
       TZE     *+3                 NO                                  $3IO08610
       TSX     (NDSLX,4                                                $3IO08620
       PZE     0,2,HFPNP           FILE PROTECT                        $3IO08630
       TRA     1,1                                                     $3IO08640
       BES     OP7.1+NOHYP/NOHYP**-NOHYP/NOHYP*OP7.1-*                 $3IO08650
OP7.3  LFT     OUTPUT                                                  $3IO08660
       TRA     1,1                                                     $3IO08670
       LXD     XEOB,4              IF READ                             $3IO08680
       TXL     OP7.3+1,4,0         BACKWARD                            $3IO08690
       TSX     NDSEL+1,4           REWIND 729                          $3IO08700
       PZE     0,2,REWOP           OR DISK INPUT                       $3IO08710
       TRA     1,1                                                     $3IO08720
       TTL     RELEASE BUFFER AND  READ WITH RETENTION                  3IO08730
RELASE ENB     L(0)                                                    $3IO08740
       LDC     XEOB,2              -L(FILE) IN IR2                     $3IO08750
       TSX     FNLBC,4             FIND THE BUFFER POOL                $3IO08760
       CAL     FCW                 GET BUFFER CONTROL                  $3IO08770
       SUB     L(2)                ADDRESS AND                         $3IO08780
       STA     *+1                 MAKE SURE IT IS                     $3IO08790
RELASD LDI     **                  ABLE TO BE RELEASED                 $3IO08800
       LNT     100000                                                  $3IO08810
       TRA     COMXIT+3                                                $3IO08820
       LDI     1,2                 FILE BITS TO INDICATORS             $3IO08830
       TSX     BCKBB,1             RESTORE BUF COUNT                   $3IO08840
       CAL     RELASD                                                  $3IO08850
       TSX     BTP2,1              PUT BUF IN POOL                     $3IO08860
       XCA                                                             $3IO08870
       ERA     2,2                 IF BUFFER RELEASED IS THE SAME      $3IO08880
       ANA     ADDRS               AS THE BUFFER IN USE PUT            $3IO08890
       TNZ     *+3                 THE BUFFER POOL ADDRESS IN          $3IO08900
       CLA     LBC                 THE THIRD WORD OF THE FCB           $3IO08910
       STA     2,2                                                     $3IO08920
       TRA     COMXIT+3            EXIT                                $3IO08930
READR1 STL     *+2                 SET READ/RETENTION SW               $3IO08940
       TRA     READ.                                                   $3IO08950
       BES     RELASE+NOCH/NOCH**-NOCH/NOCH*RELASE-*                   $3IO08960
READR2 PZE                                                              3IO08970
       TTL                         BUFFERED READ ROUTINE                3IO08980
*              TSX  READ,4              BUFFERED READ                   3IO08990
*              PZE  FILE,,EOB           END OF BLOCK                    3IO09000
*              PZE  EOF,,ERR              END OF FILE AND               3IO09010
*                   *                     ERROR EXITS                   3IO09020
*                   *                                                   3IO09030
*                  IO-LIST                                              3IO09040
*                   *                                                   3IO09050
*              RETURN                                                   3IO09060
       SPACE   1                                                        3IO09070
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3IO09080
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3IO09090
*                              IS GIVEN.                                3IO09100
*                        1. THE LOCATION +1 OF THE LAST WORD ''READ''   3IO09110
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3IO09120
*                            BUFFER AREA ATTACHED TO THE FILE           3IO09130
       SPACE   1                                                        3IO09140
READ.  SIR     RDSWIT              SET READ SWITCH                     $3IO09150
       TXI     *+1,4,-1            ACCOUNT FOR EXTRA                    3IO09160
       SXA     GTIOX,4             WORD IN CALLING SEQUENCE             3IO09170
       CLA     -1,4                SAVE MODAL EXITS                     3IO09180
       STA     XEOF                END OF FILE                          3IO09190
       STD     XERR                ERROR (CKSUM,URR,BLOCK SEQUENCE)     3IO09200
       LNT     OPNEOF              IF FILE NOT OPEN OR AT LABEL EOF     3IO09210
       TRA     EOFER               TAKE END OF FILE EXIT                3IO09220
       LFT     OUTPUT              IF OUTPUT FILE                       3IO09230
       TRA     NOPXIT              DO NOTHING, JUST EXIT.               3IO09240
       TSX     FNLBC,4             FIND L(POOL)                         3IO09250
       LFT     GIVUP               WAS A BUFFER GIVEN UP LAST READ      3IO09260
       TSX     BORBF,1             YES-TRY TO TAKE ONE BACK             3IO09270
       RIL     GIVUP               COULDNT-TURN OFF GIVE-UP INDIC       3IO09280
       SXD     SYNCT,0             PRESET SYNCT TO ZERO                 3IO09290
       TSX     RDWRT,4             READ DIRECTING MASTER CONTROL TO     3IO09300
       TSX     RELES,1             1.DISCONNECT VIA RELEASE ROUTINE     3IO09310
       TSX     SYNCR,1             2.CONNECT VIA SYNC ROUTINE           3IO09320
       PZE     TRM1                3.TRANSMIT FROM                      3IO09330
       PZE     TRM2                BUFFER TO WORKING STORAGE            3IO09340
       TRA     RSRD                4.HANDLE IORY AND IOSY WITH -RSRD-   3IO09350
       TTL                         BUFFERED WRITE ROUTINE               3IO09360
*              TSX WRITE,4              BUFFERED WRITE                  3IO09370
*              PZE  FILE,,EOB            END OF BLOCK EXIT              3IO09380
*                    *                                                  3IO09390
*                    *                                                  3IO09400
*                  IO-LIST                                              3IO09410
*                   *                                                   3IO09420
*              RETURN                                                   3IO09430
       SPACE   1                                                        3IO09440
*               THE AC CONTAINS AT EXIT A HISTORY OF THE                3IO09450
*              IO ACTION TAKEN. THE FOLLOWING INFORMATION               3IO09460
*                              IS GIVEN.                                3IO09470
*                        1. THE LOCATION+1 OF THE LAST WORD''WRITTEN''  3IO09480
*                         2. THE NUMBER OF WORDS REMAINING  IN THE      3IO09490
*                            BUFFER AREA ATTACHED TO THE FILE           3IO09500
       SPACE   1                                                        3IO09510
WRITE. LNT     OUTPUT              CAN'T WRITE ON CKPT FILE             3IO09520
       LNT     OPEND               IF FILE NOT OPEN                     3IO09530
       TRA     NOPXIT              DO NOTHING JUST EXIT                 3IO09540
       LFT     OUTPUT              IF OUTPUT FILE                       3IO09550
       TRA     *+2                 ALL IS WELL.                         3IO09560
       TRA     NOPXIT              INPUT, DO NOTHING, JUST EXIT         3IO09570
       TSX     FNLBC,4             FIND L(POOL)                         3IO09580
       TSX     RDWRT,4             WRITE DIRECTING MASTER CONTROL TO    3IO09590
       TSX     TRUNC,1             1.DISCONNECT VIA TRUNCATE ROUTINE    3IO09600
       TSX     GTBUF,1             2.CONNECT VIA GET BUFFER FROM POOL   3IO09610
       PZE     TRM2                3.TRANSMIT FROM                      3IO09620
       PZE     TRM1                WORKING STORAGE TO BUFFER            3IO09630
       TRA     RSWR                4. HANDLE IORY AND IOSY WITH -RSWR-  3IO09640
       EJECT                                                            3IO09650
*                  FIND L(BPC) FROM FILE CONTROL WORD                   3IO09660
*      TSX     FNLBC,4    IR2 MUST = -L(FILE)  IR1 DESTROYED            3IO09670
FNLBC  CLA     4,2                                                      3IO09680
       PDX     0,1                                                      3IO09690
       SXA     LBC,1                                                    3IO09700
       TRA     1,4                                                      3IO09710
       SPACE   1                                                        3IO09720
*     ADJUST INPUT BUFFER AVAILABILITY COUNT ( ATTACH AND CLOSE )       3IO09730
*              TSX  ADIBC,1                                             3IO09740
ADIBC  RFT     SWATT               ADJUST IBACT BY                      3IO09750
       SSP                                                             $3IO09760
L(0)A  ENB     L(0)                TRAP PROTECT                         3IO09770
       ADD*    LBC                 +1 CLOSE INPUT,PTO,LAST TTO          3IO09780
       TPL     AD1                 -1 ATTACH INPUT, PTO, 1ST TTO        3IO09790
       STD*    LBC                 +RESCT CLOSE RESERVE GROUP           3IO09800
       ENB     TRAPS                                                    3IO09810
       TRA     1,1                 -RESCT ATTACH RESERVE GROUP          3IO09820
*                         ERROR IBACT NEGATIVE                          3IO09830
AD1    CAL     AD2                 PICK UP MESSAGE PARAM                3IO09840
       TRA     TSXR                AND GO ADD L(TSX) ,PRINT AND STOP    3IO09850
AD2    MZE     MESS8,,3            '' ATTACH ERROR AT ***** ''          3IO09860
*            ROUTINE TO PREPARE REDUNDANCY ERROR COUNTS ON              3IO09870
*                       PRINTER FOR THE OPERATOR                        3IO09880
       SPACE   1                                                        3IO09890
REDCT  SXA     RCT1,4              SAVE IR4                             3IO09900
       CAL     5,2                 IF ASSIGNED SENSE                   $3IO09910
       ALS     4                   IS UP AND ERROR HISTORY             $3IO09920
       TZE     RCT0                PRINT OR ELSE PRINT IT              $3IO09930
       TSX     DRANO,4             DRIVE ADDRESS TO MESSAGE             3IO09940
       LDQ     7,2                 REEL SEQ                             3IO09950
       STQ     MES10+1             TO MESSAGE                           3IO09960
       CLA     3,2                 RECORD                               3IO09970
       TSX     (DECVD,4            COUNT                                3IO09980
       STQ     MES10+3                                                  3IO09990
       CLA     5,2                 REDUN                                3IO10000
       TSX     (DECVA,4            COUNT                               $3IO10010
       STQ     MES12                                                    3IO10020
       LDQ     BLNKS                                                   $3IO10030
       LFT     OUTPUT                                                  $3IO10040
       TRA     *+3                                                     $3IO10050
       CLA     5,2                 PERM. OR                             3IO10060
       TSX     (DECVD,4            ERASE COUNT                         $3IO10070
       STQ     MES12+3                                                  3IO10080
       CLA     MES13               PLACE ''ERASE'' FOR OUTPUT           3IO10090
       LFT     OUTPUT              OR ''PERM.'' FOR INPUT               3IO10100
       CLA     MES14               IN MESSAGE                           3IO10110
       STO     MES12+1                                                 $3IO10120
       CLA     MES26                                                   *3IO10130
       LDQ     5,2                 TEST FOR DISK                       *3IO10140
       TQP     *+2                 NO,TAPE                             *3IO10150
       CLA     MES25               YES,CHANGE PRINT OUT                *3IO10160
       STO     *+5                                                     *3IO10170
       BES     *-5+NOCH/NOCH*5-*                                        3IO10180
       TSX     PROUT,4             PRINT                                3IO10190
       PZE     4                                                        3IO10200
       MZE     MESS1,,2                                                 3IO10210
       MZE     9,2,3                                                    3IO10220
       PZE     MES10,,6                                                 3IO10230
       PZE     MES11,,9+512*DBLSP                                       3IO10240
RCT0   CAL     SIX                 SET BLOCK SEQUENCE                  $3IO10250
       ANS     5,2                 ERROR INFORMATION                   $3IO10260
       STD     3,2                 AND BLOCK COUNT 'IS ZERO            $3IO10270
RCT1   AXT     **,4                RESTORE IR4                          3IO10280
       TRA     1,4                 EXIT                                 3IO10290
       TTL     BUFFER COUNT ADJUSTMENT ROUTINES                         3IO10300
*      TSX     TOKBF,4    WHEN A BUFFER IS DESIRED TO BE TAKEN          3IO10310
*      ERROR RETURN       CANT TAKE ONE EXIT .. IR1 KILLED AT EITHER    3IO10320
       SPACE   1                                                        3IO10330
*      TSX     BCKBF,1    WHEN A BUFFER RETURNED TO THE POOL            3IO10340
*                          IR4 MUST= -L(POOL)                           3IO10350
       SPACE   1                                                        3IO10360
TOKBB  ENB     L(0)                TRAP PROTECT                         3IO10370
TOKBF  SXA     TK3,4               SAVE IR4                             3IO10380
       LNT     RESER               IF A RESERVE FILE                    3IO10390
       TRA     TK1                 THEN REDUCE THE RESERVE BUFFER       3IO10400
       CLA*    3,2                 COUNT AND IF IT                      3IO10410
       PDX     0,1                 GOES NEGATIVE THEN                   3IO10420
       TXI     *+1,1,-1            REDUCE POOL CT ALSO                  3IO10430
       TXL     TK2,1,4096                                               3IO10440
TK1    CAL*    LBC                 REDUCE POOL CT FOR ALL               3IO10450
       PDX     0,4                 IMMEDIATE FILES                      3IO10460
       TXL     TK4,4,0             AND ABOVE RESERVE FILES              3IO10470
       SUB     1DEC                                                     3IO10480
       STD*    LBC                                                      3IO10490
TK2    PXD     0,1                 RESTORE RESERVE                      3IO10500
       LFT     RESER               BUFFER COUNT IF A RESERVE            3IO10510
       STD*    3,2                 FILE                                 3IO10520
TK3    AXT     **,4                RESTORE IR4                          3IO10530
       TRA     2,4                 EXIT                                 3IO10540
TK4    LXA     TK3,4               TAKE ERROR EXIT                      3IO10550
       TRA     1,4                                                      3IO10560
       SPACE   1                                                        3IO10570
*          RESTORE BUFFER COUNT TO RESERVE GROUP AND OR POOL            3IO10580
       SPACE   1                                                        3IO10590
BCKBB  LAC     LBC,4               -L(POOL) TO IR4                      3IO10600
BCKBF  LNT     RESER               IF A ARESERVE                        3IO10610
       TRA     BK1                 FILE THEN INCREMENT                  3IO10620
       SXA     BK2,1               SAVE IR1                             3IO10630
       CLA*    3,2                 THE RESERVE BUFFER COUNT FIRST       3IO10640
       PDX     0,1                                                      3IO10650
       ACL     1DEC                                                     3IO10660
       STD*    3,2                                                      3IO10670
       TXL     BK3,1,4096          IF IT WAS NEGATIVE INCREMENT         3IO10680
BK2    AXT     **,1                RESTORE IR1                          3IO10690
BK1    CAL     0,4                 POOL CT ALSO                         3IO10700
       ADD     1DEC                                                     3IO10710
       STD     0,4                                                      3IO10720
       TRA     1,1                 EXIT                                 3IO10730
BK3    LXA     BK2,1               RESTORE IR1                          3IO10740
       TRA     1,1                 AND TAKE EXIT                        3IO10750
       TTL             MOUNT AND DISMOUNT INSTRUCTIONS TO OPERATOR      3IO10760
*                                                                       3IO10770
*        PRINT REEL DISMOUNTING INSTRUCTIONS TO OPERATOR                3IO10780
*      TSX     UNMNT,4                                                  3IO10790
*      RETURN                                                           3IO10800
*                                                                       3IO10810
UNMNT  SXA     UNM1,4              SAVE IR4                             3IO10820
       TSX     DRANO,4             ABS UNIT TO MESSAGE                  3IO10830
       CAL     =H DONE             IF REEL NO IS ZERO               (11)3IO10831
       ZET     7,2                 MOVE 'DONE' ELSE MOVE            (11)3IO10832
       CAL     7,2                 REEL NUMBER                          3IO10840
       SLW     MES23+2             TO MESSAGE                           3IO10850
       TSX     PROUT,4             PRINT                                3IO10860
L(3)   PZE     3                   --UNIT *****                        $3IO10870
       MZE     MESS1,,2            FILE-NAME                            3IO10880
       MZE     9,2,3               REMOVE REEL ***** ''                 3IO10890
       PZE     MES23,,3+512*DBLSP                                       3IO10900
UNM1   AXT     **,4                                                     3IO10910
       TRA     1,4                 EXIT                                 3IO10920
       SPACE   1                                                        3IO10930
*          PRINT INSTRUCTIONS TO OPERATOR TO MOUNT A NEW REEL           3IO10940
*                  THE REEL NUMBER MUST BE IN THE AC                    3IO10950
*      TSX     MOUNT,4                                                  3IO10960
*      RETURN                                                           3IO10970
*                                                                       3IO10980
MOUNT  SXA     MNT3,4              SAVE IR4                             3IO10990
       SLW     MES23+2             SAVE REEL NUMBER IN MESSAGE          3IO11000
       TSX     DRANO,4             UNIT NUMBER TO MESSAGE               3IO11010
       CLA     MNT4                IF INPUT FILE                        3IO11020
       LFT     OUTPUT              ''MOUNT REEL *****''                 3IO11030
       TRA     *+2                 IF NON-LABELED OUTPUT                3IO11040
       TRA     MNT1                ''MOUNT BLANK''                      3IO11050
       CLA     MNT5                IF LABELED OUTPUT                    3IO11060
       LFT     LABEL               '' MOUNT LABELED BLANK''             3IO11070
MNT1A  BSS     1                   CLA MNT6                             3IO11080
MNT1   STO     *+5                 EXTRA MESSAGE TO LIST                3IO11090
MNT2   TSX     PROUT,4             PRINT INSTRUCTIONS TO OPERATOR       3IO11100
       PTW     4                                                     $5$3IO11110
       MZE     MESS1,,2                                                 3IO11120
       MZE     9,2,3                                                    3IO11130
       MZE     **                                                       3IO11140
       PZE     MES23+1,,2                                               3IO11150
       CLA     MNT2                SET INDICATOR THAT UNIT IS           3IO11160
       STT     0,2                 MOUNTED                              3IO11170
MNT3   AXT     **,4                                                     3IO11180
       TRA     1,4                                                      3IO11190
MNT4   MZE     MES24,,1                                                 3IO11200
MNT5   MZE     MES24,,2                                                 3IO11210
L(4)   PZE     4                                                     $5$3IO11211
       TTL     FIND TAPE ADDRESS AND PLACE IN MESSAGE+UNIT*****+        3IO11220
*         TSX  DRANO,4             EXECUTES ENB L(0),NO ENB TRAPS       3IO11230
       SPACE   1                                                        3IO11240
DRANO  SXA     *+6,4               CLEAR IR4 FOR * ADDRESSING           3IO11250
       AXT     0,4                                                      3IO11260
       LDQ*    0,2                                                      3IO11270
       ENB     L(0)                TRAP PROTECT SYUNCV ROUTINE          3IO11280
       TSX     SYUNCV,4            CONVERT UNIT TO SYMBOLIC             3IO11290
       SLW     MESS1+1                                                  3IO11300
       AXT     **,4                                                     3IO11310
       TRA     1,4                                                      3IO11320
       SPACE   1                                                        3IO11330
*                      FOLDED CHECKSUM CALCULATOR                       3IO11340
*                   CHECKSUMS LOCATOR SPECIFICATION                     3IO11350
*                         FOR FILE AND LEAVES                           3IO11360
*                  FOLDED 18 BIT CHECKSUM IN MQ S-17                    3IO11370
       SPACE   1                                                        3IO11380
*                           CALLING SEQUENCE                            3IO11390
       SPACE   1                                                        3IO11400
*              TSX SUMMIT,1   IR2 MUST = -L(FILE)                       3IO11410
       SPACE   1                                                        3IO11420
SUMMIT CLA*    TR5                 SETUP NUMBER                         3IO11430
       SXA     SUM3,1              SAVE IR1                             3IO11440
       PDX     0,1                 WDS TO                               3IO11450
       PXA     0,0                 CHECKSUM                             3IO11460
       TRA     *+2                 DONT CHECKSUM BLOCK SEQ WORD         3IO11470
SUM1   ACL     **,1                CHECKSUM                             3IO11480
2PRE   TIX     *-1,1,1             BUFFER                               3IO11490
       XCL                         FOLD                                 3IO11500
       STZ     TEMP                CHECKSUM TO 18 BITS                  3IO11510
       SLQ     TEMP                UPPER BITS S-17                      3IO11520
       XCL                         ADDED TO LOWER BITS 18-35            3IO11530
       ALS     18                  THEN OVERFLOW ADDED                  3IO11540
       ACL     TEMP                TO SUM                               3IO11550
       LBT                         FOLDED 18-BIT                        3IO11560
       TRA     SUM2                CHECKSUM                             3IO11570
       ACL     1DEC                LEFT IN MQ                           3IO11580
SUM2   XCL                         CHECKSUM IN MQ S-17                  3IO11590
SUM3   AXT     **,1                                                     3IO11600
       TTR     1,1                                                      3IO11610
       TTL     COMMON SUBROUTINE-ERROR EXITS HANDLER                    3IO11620
*                    HANDLES EOB,EOF,AND URR EXITS                      3IO11630
       SPACE   1                                                        3IO11640
EOFER  CLA     0,4                 END OF FILE                          3IO11650
       ANA     1PRE                EXIT INPUT FILE                      3IO11660
       RIL     100000              NOT OPEN                             3IO11670
       OAI                         PLACE 1ST COMMAND IN SI              3IO11680
       TXI     *+1,4,-1            STEP GTIOX TO NEXT                   3IO11690
       SXA     GTIOX,4             COMMAND                              3IO11700
       TRA     EOF.0               TAKE EOF EXIT                        3IO11710
EOFEX  LFT     LABEL               END OF FILE                          3IO11720
       BSS     1                   TSX   LAEOF,1                        3IO11730
       LFT     MULTI               MULTI-REEL                           3IO11740
       RIL     NOEOT               SET NEXT REFERENCE SWITCH            3IO11750
       SIL     NINHIB              SET NEXT REF TO READ UNLESS EOT ON   3IO11760
EOF.0  TSX     FEXIT,1             FIND EXIT AND UPDATE HISTORY         3IO11770
       LAC     XEOF,4              PLACE EOF EXIT INTO EXIT ROUTINE     3IO11780
EOF.1  SXA     TCHEX,4                                                  3IO11790
       TXL     GET4,4,0            ERROR AND ERROR EXIT = 0         (10)3IO11800
       RFT     HELD                IF BUFFERS IN HOLD CHAIN             3IO11810
       TSX     HOOK,4              CONNECT THEM TO FILE BEFORE EXIT     3IO11820
       LDQ     LTSX                LOAD EXIT HISTORY                    3IO11830
       RQL     18                                                      $3IO11840
       TRA     COMXIT              EXIT                                 3IO11850
SEQEX  CAL     1PRE                LOAD SEQUENCE ERROR CODE             3IO11860
       TRA     BLKEX               TAKE BLOCK ERROR EXIT                3IO11870
CKSEX  CLA     SY7.1               STORE UPDATED                        3IO11880
       STD     3,2                 BLOCK SEQ NUMBER                     3IO11890
       CAL     2PRE                LOAD CHECKSUM ERROR CODE             3IO11900
BLKEX  RNT     NORED               IF REDUNDANCY ERROR                  3IO11910
       ACL     FOR                 ALSO OCCURRED ADD REDUN BIT          3IO11920
       TRA     ERREX               TAKE ERROR EXIT                      3IO11930
URREX  CAL     *                   SET UNRECOVERABLE REDUNDANCY         3IO11940
ERREX  ARS     18                  CODE IN                             $3IO11950
       STT     LTSX                TAG OF HISTORY                      $3IO11960
       CLA*    2,2                 MAKE HISTORY                        $3IO11970
       STA     LTRAD               REFLECT THIS OP.                    $3IO11980
       TSX     FEXIT,1             URR,CKS AND BLOCK SEQ                3IO11990
       LDC     XERR,4              ERROR EXITS                          3IO12000
       TRA     EOF.1                                                    3IO12010
EOBEX  TSX     FEXIT,1             SETUP HISTORY                        3IO12020
BOFEX  LDC     XEOB,4              AND TAKE EOB EXIT ( OR BOF)          3IO12030
       TRA     EOF.1                                                    3IO12040
*                 FIND NORMAL EXIT AND PREPARE HISTORY                  3IO12050
FEXIT  LXA     GTIOX,4             PLACE L(OP)+1                        3IO12060
       SXD     LTRAD,4             INTO HISTORY                         3IO12070
       ZET     TCHEX               HAS A TCH OCCURRED                   3IO12080
       TRA     TCHOC               YES-                                 3IO12090
       LFT     100000              NO-IS THIS OP AN IOXT                3IO12100
       TRA     EXFND               YES- EXIT IS AT NEXT CELL            3IO12110
       TRA     *+2                 CHECK THIS COMMAND FOR IOCD          3IO12120
FEEIT  TXI     *+1,4,-1            NO-                                 $3IO12130
       CAL     -1,4                SEARCH                               3IO12140
       LGR     34                  FOR                                  3IO12150
       TZE     *+2                 EXIT                                 3IO12160
       TQP     *-4                                                      3IO12170
       SXA     GTIOX,4             PLACE COMPUTED EXIT                  3IO12180
       TRA     *+2                                                      3IO12190
TCHOC  LXA     TCHEX,4             IF TCH SET TCH EXIT                  3IO12200
EXFND  SXD     LTSX,4              STORE L(EXIT)                       $3IO12210
       TRA     1,1                 RETURN                               3IO12220
       TTL     IOBS ROUTINES FOR HANDLING BUFFERS                       3IO12230
*              BUFFER LOGIC AND EXECUTING I/O COMMANDS                  3IO12240
*                        MASTER CONTROL ROUTINE                         3IO12250
*                          FOR READ AND WRITE                           3IO12260
*              TSX RDWRT,4         IR2 MUST = -L(FCW)                   3IO12270
*              OP  ROUTINE         1. BUFFER DISCONNECT ROUTINE         3IO12280
*              OP  ROUTINE         2. BUFFER CONNECT ROUTINE            3IO12290
*              PRE TRM1 OR TRM2    3. SPECIFY DIRECTION OF              3IO12300
*              PRE TRM2 OR TRM1        TRANSMITTING                     3IO12310
*              OP  ROUTINE         4. IORY AND IOSY HANDLER ROUTINE     3IO12320
*           THIS ROUTINE WILL RELINQUISH CONTROL ONLY TO THE            3IO12330
*       ROUTINES IN THE CALLING SEQUENCE LIST . CONTROL IS GIVEN        3IO12340
*              XEC  N,4                                                 3IO12350
       SPACE   1                                                        3IO12360
RDWRT  CLA*    2,2                 LOCATOR OF BUF IN USE TO AC          3IO12370
       STZ     TRANS               SET TRANSMIT HISTORY TO ZERO         3IO12380
       TPL     GTIOX-1             TEST IF ATTACHED BUFFER              3IO12390
       ANA     7PRE                SHOULD BE DISCONNECTED              $3IO12400
       TZE     GTIOX-1             NONE ATTACHED                        3IO12410
       XEC     1,4                 DISCONNECT-NON TRANSMIT USED IT UP   3IO12420
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO12430
*                         GET NEXT IO COMMAND                           3IO12440
*        THIS ROUTINE GETS THE NEXT COMMAND IN THE IO LIST AND          3IO12450
*              1. PLACES ITS OP IN THE SI (PREFIX AND TAG)              3IO12460
*              2. COMPUTES CORRECT INDIRECT ADDRESS IF SPECIFIED        3IO12470
*              3. HANDLES TCH COMMANDS AND RECORDS EXIT IF TCH APPEARS  3IO12480
*              4. PLACES  WORD COUNT OF IO COMMAND IN-WDCT-             3IO12490
*              5. PLACES TRANSMIT ADDRESS IN -TRANS-                    3IO12500
       SPACE   1                                                        3IO12510
GTIOX  AXT     **,1                PICKUP IO COMMAND LOCATION           3IO12520
       SXA     INDIR,1             ASSUME IOXYN NOT * ADDRESSED         3IO12530
       TXI     *+1,1,-1            SETUP L(NEXT)                        3IO12540
       SXA     GTIOX,1             IOXY                                 3IO12550
       CAL     -1,1                THIS IO COMMAND TO AC                3IO12560
       STA     TRANS               SAVE TRANSMIT LOC                    3IO12570
       PAC     0,1                 SAVE ADDRESS FOR IOXYN* OR TCH       3IO12580
       STD     WDCT                SAVE WORD COUNT                      3IO12590
       RIS     NEWIO               PLACE OP IN SI PRESETTING SWITCHES   3IO12600
       ANA     IOOP                AND NOT DISTURBING FILE              3IO12610
       OAI                         CONDITION OR HISTORY BITS           $3IO12620
       SXD     DUMMY,0             PRESET IOSY DUMMY COUNT              3IO12630
       LFT     600000              SEPARATE TCH AND IOCD                3IO12640
       TRA     GT1                 FROM IOCP,IOCT,IOSP,IOST,IORP, IORT  3IO12650
       LFT     100000              IOCD OR TCH COMMAND                  3IO12660
       TRA     TCH                 TCH                                  3IO12670
       IIS     CDTCT               IOCD-CHANGE TO IOCT, SET DISCONNECT  3IO12680
GT1    RNT     400000              IS INDIRECT ADDRESSING SPECIFIED     3IO12690
       TRA     RW0                 NO                                   3IO12700
       SXA     INDIR,1             SETUP * ADDRESSING IF NON-TRANSMIT   3IO12710
       CLA*    TRANS                                                    3IO12720
       STA     TRANS                                                    3IO12730
*                  IO COMMAND IS OBTAINED -EXECUTE IT                   3IO12740
RW0    NZT     WDCT                IF WORD COUNT IS                     3IO12750
       LNT     400000              ZERO ON IOCY OR IOSY                 3IO12760
       TRA     RW1                 DO NOTHING-GO TO TEST EXIT           3IO12770
       TRA     RW8                                                      3IO12780
RW1    CLA*    2,2                 PICKUP BUFFER FROM FILE CONTROL WORD 3IO12790
       TPL     RW2                 BUFFER IS CONNECTED TO FILE          3IO12800
RW1.4  XEC     2,4                 GET NEXT BUFFER                      3IO12810
       CLA*    2,2                 PICKUP BUFFER CONTROL WORD           3IO12820
*               BUFFER IS CONNECTED-GO AHEAD AND EXECUTE                3IO12830
RW2    PAX     0,1                 SAVE ADDRESS FOR IOXYN **,,CT        3IO12840
       ANA     DECRE               MASK OUT NUMBER OF WORDS LEFT        3IO12850
       TNZ     RW2.1               IF SOME WORDS ARE                    3IO12860
       PDX     0,1                 AVAILABLE AND COMMAND IS             3IO12870
RW2.1  RFT     200000              IOXYN , SET L(AVAIL) TO TRANS LOC    3IO12880
       SXA     TRANS,1             IF NONE AVAIL , ZERO TO TRANS LOC    3IO12890
*      DETERMINE IF CONTROL SHOULD BE RELEASED FOR IORY AND IOSY        3IO12900
       LFT     200000              SEPARATE IORY AND IOSY FROM IOCY     3IO12910
       XEC     5,4                 BRANCH TO IOR-IOS CONTROL            3IO12920
*                       COUNT CONTROL EXECUTION                         3IO12930
       TNZ     RW2.3               COUNT CONTROL- SOME WORDS AVAILABLE  3IO12940
       SIR     GENER               SET GENERATED DISCONNECT             3IO12950
       XEC     1,4                 DISCONNECT                           3IO12960
       RIR     GENER               RESET GENER BIT                      3IO12970
       TRA     RW1.4               AND GO ATTACH NEXT ONE               3IO12980
RW2.3  SUB     WDCT                REDUCE AVAIL WORD COUNT              3IO12990
       TZE     RW4.5               IF EMPTY SET EOB FOR POSSIBLE HOLD   3IO13000
       TPL     RW5                 IS BUFFER OVERFLOWED                 3IO13010
       STD     DUMMY               YES- SAVE NUMBER OFF                 3IO13020
       LNT     200000              UNLESS COMMAND IS IOSY               3IO13030
       SIR     GENER               SET BIT FOR GENERATED COMMAND        3IO13040
RW3    ADD     WDCT                FORM COUNT TO EXECUTE                3IO13050
RW4    STD     WDCT                ON THIS BUFFER                       3IO13060
       PXA     0,0                 SET ZERO REMAINING WORDS             3IO13070
RW4.5  SIR     EOB                 TURN ON EOB INDICATOR                3IO13080
*  SETUP AND TRANSMIT -IF NON-TRANSMITTING OP ACTUAL TRANSMIT SKIPPED   3IO13090
RW5    RNT     IOSY+200000         DO NOT ALLOW IOSYN WRITE            $3IO13100
       STD*    2,2                 TO ADJUST LOCATOR                    3IO13110
       STD     LTRAD               SAVE NUMBER AVAIL WDS INTO HISTORY   3IO13120
       RNT     200000              IF IOXYN **,,CT                      3IO13130
       TRA     RW6                 OR IOXYN* ADDR,,CT                   3IO13140
       CLA     TRANS               THEN PLACE L(WORDS)                  3IO13150
INDIR  AXT     **,1                INTO ** OR ADDRESS                  $3IO13160
       STA     0,1                 RESPECTIVELY                         3IO13170
       SIR     XECNT               INDICATE IOXYN EXECUTED              3IO13180
RW6    LXD     WDCT,1              FORM FIRST                           3IO13190
       PXA     0,1                 TRANSMIT                             3IO13200
       ACL*    2,2                 ADDRESS                              3IO13210
       RNT     IOSY+200000         AGAIN IOSYN MUST NOT                $3IO13220
       STA*    2,2                 ADJUST LOCATOR                       3IO13230
       STA*    3,4                 STORE ADDRESS FOR TRANSMIT           3IO13240
       PXA     0,1                 COMPUTE                              3IO13250
       ACL     TRANS               SECOND TRANSMIT ADDRESS              3IO13260
       STA*    4,4                 AND STORE IT                         3IO13270
       STA     LTRAD               SAVE L(LAST WD)+1 FOR HISTORY        3IO13280
       TXL     RW8,1,0             IF WDCT = 0 SKIP TRANSMIT            3IO13290
       LXA     TRANS,1             TEST FIRST XMIT                      3IO13300
       TXL     *+2,1,0             ILLEGAL TO WRITE INSIDE IOCS        $3IO13310
       XEC     RW7                 FOR BOUNDS ERROR                     3IO13320
       LXA     TRM2,1              IF TRANSMIT INSIDE                   3IO13330
       TXL     *+2,1,0                                                 $3IO13340
RW7    TXL     BOUND,1,.JBCON+9                                         3IO13350
       RFT     200000              IF NON-TRANSMITTING                  3IO13360
       TRA     RW8                 SKIP OVER MOVES                      3IO13370
       LXD     WDCT,1              WDCT TO IR1                          3IO13380
TRM1   CAL     **,1                TRANSMIT                             3IO13390
TRM2   SLW     **,1                1.BUFFER TO WS (READ)                3IO13400
       TIX     *-2,1,1             2.WS TO BUFFER (WRITE)               3IO13410
*                         TERMINATE IO COMMAND                          3IO13420
RW8    NZT     XEOB                IF USER NOT LOCATING                 3IO13430
       RIR     EOB                 IGNORE SPECIAL ACTIONS AT EOB        3IO13440
       RNT     EOB                 IF EOB DID NOT OCCUR                 3IO13450
       TRA     RW9                 GO DO NORMAL TERMINATION PROCEDURE   3IO13460
       RFT     XECNT               IF LOCATING AND EOB OCCURS AND       3IO13470
       SIR     HOLD                WORDS LOCATED, SETUP HOLD            3IO13480
RW9    RFT     DIGEN               IS A BUFFER TO BE DISCONNECTED       3IO13490
       TRA     RW13                YES                                  3IO13500
RW10   LNT     100000              IS COMMAND                           3IO13510
       TRA     GTIOX               IOXP OR IOXT                         3IO13520
RW12   RFT     HELD                IF A HOLD OCCURRED                   3IO13530
       TSX     HOOK,4              SETUP BUFFER HOLD CHAIN IN FILE      3IO13540
       RFT     RDSWIT              IF READING EXECUTE                   3IO13550
       TSX     RDPRI,4             SPECIAL PRIORITY TESTS BEFORE EXIT   3IO13560
       RFT     EOBXIT              EXIT AT                              3IO13570
       TRA     EOBEX               -EOB EXIT                            3IO13580
       TRA     COMXIT              -NORMAL EXIT                         3IO13590
RW13   XEC     1,4                 DISCONNECT(DISCN,EOB,HOLD,XECNT =0 ) 3IO13600
       RNT     GENER               IS COMMAND ONLY PARTIALLY DONE       3IO13610
       TRA     RW10                -NO IT IS COMPLETE                   3IO13620
       RIR     GENER               RESET GENER BIT                      3IO13630
       LFT     200000              IF IOCY                              3IO13640
       TRA     RW14+2              NO- IOSY INTERRUPTED                 3IO13650
       RNT     200000              IF IOCYN                             3IO13660
       TRA     RW14                NO -IOC TRANSMITTING                 3IO13670
       ZET     XEOB                IF IOCYN LOCATING                    3IO13680
       TRA     RW16                TAKE EOB INTERRUPT EXIT              3IO13690
RW14   CLA*    4,4                 SETUP NEW TRANSMIT                   3IO13700
       STA     TRANS               ADDRESS                              3IO13710
       CLA     DUMMY               SET NEW                              3IO13720
       STD     WDCT                WORD COUNT                           3IO13730
DUMMY  TXL     RW0,,**             EXECUTE GENERATED COMMAND            3IO13740
RW16   CAL     2TAG                SET EOB IOCYN                       *3IO13750
       TRA     RW17+1              INTERRUPTED CODE                     3IO13760
RW17   CAL     RW13                SET END OF BUFFERS CODE             *3IO13770
       STT     LTSX                STORE CODE                          *3IO13780
       SIR     EOBXIT              SET AND TAKE                         3IO13790
       TRA     RW12                EOB EXIT                             3IO13800
       SPACE   1                                                        3IO13810
*                       BOUNDS ERROR IO COMMAND                         3IO13820
BOUND  LAC     GTIOX,1             PLACE L(IOXY) IN IR1                $3IO13830
       CAL     MESS9+4             PLACE ''WRITE''                     $3IO13840
       RFT     RDSWIT              ON IF READ                          $3IO13850
       CAL     MESS9+5             OR ''READ''                         $3IO13860
       SLW     MESS9+3             IN MESSAGE                          $3IO13870
       CAL     *+2                 PARAM TO AC                          3IO13880
       TXI     TSXR+1,1,-1         GO PRINT L(IOXY) IN IR1             $3IO13890
       MZE     MESS9,,4            ''BOUNDS ERROR READ (WRITE) *****'' $3IO13900
       EJECT                                                            3IO13910
*                  HANDLER FOR IORY AND IOSY READING                    3IO13920
RSRD   LFT     400000              IS COMMAND IORY OR IOSY              3IO13930
       TRA     RW2.3               IOSY-LET COUNT CONTROL HANDLE IT     3IO13940
       LXA     GTIOX,1             -L(IOXY+1) TO IR1                    3IO13950
       STD     -1,1                SET ASSIGNED WORD CT INTO IORY       3IO13960
       SIR     DISCN               SET COMMAND DISCONNECT               3IO13970
       TRA     RW4                 EXECUTE READ                         3IO13980
       SPACE   1                                                        3IO13990
*                  HANDLER FOR IORY AND IOSY WRITING                    3IO14000
RSWR   SIR     IOSY                ASSUME IT TO BE IOSY                 3IO14010
       LNT     400000              IS IT ACTUALLY IOSY                  3IO14020
       IIR     EBDSY               NO-SET EOB DISCONNECT, TURN OFF IOSY 3IO14030
       SUB     WDCT                REDUCE WORD COUNT AVAILABLE          3IO14040
       TPL     RW5                 IF ENOUGH WERE AVAIL,EXECUTE COMMAND 3IO14050
       LNT     400000              NOT ENOUGH                           3IO14060
       TRA     RW3                 IORY- REDUCE CT AND EXECUTE          3IO14070
       LXD     DUMMY,1             IF SECOND ATTEMPT ON IOSY            3IO14080
       TXH     RW3,1,0             IS STILL TOO BIG, THEN REDUCE COUNT  3IO14090
       SIR     GENER               IOSY -SET GENER TO DO ON NEXT BUF    3IO14100
       CLA     WDCT                SETUP GENERATED                      3IO14110
       STD     DUMMY               COMMAND                              3IO14120
       RFT     XECNT               IF AN IOXYN WAS                      3IO14130
       SIR     EOB                 ALREADY EXECUTED SET EOB TESTS       3IO14140
       TRA     RW8                 GO RELEASE THIS BUF AND DO GENER     3IO14150
       SPACE   1                                                        3IO14160
*                         HANDLER TCH COMMAND                           3IO14170
TCH    CLA     GTIOX               PICKUP L(TCH)+1                      3IO14180
       NZT     TCHEX               IF 1ST TCH THEN                      3IO14190
       STA     TCHEX               EXIT = L(TCH)+1                      3IO14200
       RNT     400000              IF NOT INDIRECT                      3IO14210
       TRA     GTIOX+1             TCH EXECUTED                         3IO14220
       CAL     0,1                 INDIRECTLY ADDRESSED TCH             3IO14230
       PAC     0,1                 GO ONE MORE LEVEL AND                3IO14240
       TRA     GTIOX+1             EXIT                                 3IO14250
       SPACE   1                                                        3IO14260
*                     PRIORITY EXIT TESTS FOR READ                      3IO14270
RDPRI  CLA     1,2                 IF THE FILE HAS MORE BUFFERS         3IO14280
       ANA     L(377)                                                   3IO14290
       PAX     0,1                 REQUESTED THAN WERE SYNCED BY        3IO14300
SYNCT  TXH     *+2,1,**            THIS READ,THEN FILE IS ENOUGH        3IO14310
       TRA     *+2                 AHEAD. TURN OFF RUSH AND GIVUP BITS  3IO14320
       RIL     PRIBTS              AND EXIT.                            3IO14330
       RFT     REINT               IF LAST BUF SYNCED                   3IO14340
       TRA     *+4                 GIVE FILE A KICK                     3IO14350
       LNT     RHIST               IF NUMBER REQUESTED LT OR = SYNCT    3IO14360
       TRA     1,4                 AND RUSH OCCURRED TRY TO GET         3IO14370
       RIL     GIVUP               BUFFER NOW, IF CANT LEAVE GIVUP ON.  3IO14380
       TSX     BORBF,1             IF NO RUSH OCCURRED                  3IO14390
       SIL     GIVUP               LEAVE GIVUP AS IS,IF IT IS ON A      3IO14400
       TRA     1,4                 NEW BUFFER WILL BE GOTTEN NEXT READ  3IO14410
       TTL     READ SUBROUTINE - SYNCR-                                 3IO14420
*                   GETS A BUFFER FROM THE EXECUTOR                     3IO14430
*                         VIA THE SYNC ROUTINE                          3IO14440
       SPACE   1                                                        3IO14450
*              TSX SYNCR,1         IR2 MUST = -L(FCW)                   3IO14460
*              RETURN              INDEXS ARE NOT DISTRUBED             3IO14470
       SPACE   1                                                        3IO14480
SYNCR  SXA     SY8.2,4             SAVE IR4                             3IO14490
       SXA     SY8.1,1             IR1                                  3IO14500
SY3    SIR     NOREOF              SET REDUN + EOF SWITCHES            $3IO14510
       ENB     L(0)                TRAP PROTECT                        $3IO14520
       NZT*    4,2                 ANYTHING TO SYNC                     3IO14530
       TRA     SY10                -NO                                  3IO14540
       CLA     5,2           TEST FOR HYPERTAPE FILE.                   3IO14550
       ANA     SIX                                                      3IO14560
       TZE     *+5                 NO                                  $3IO14570
       LDQ     1,2                 WHAT                                $3IO14580
       RQL     18                  TYPE                                $3IO14590
       TQP     *+2                 READ                                $3IO14600
       SIR     100000              HYPER READ BACKWARD                 $3IO14610
       BES     *-7+NOHYP/NOHYP*7-*                                     $3IO14620
       CLA     4,2                 SYNCED BUFFER TO                     3IO14630
       STA     2,2                 BUFFER IN USE ADDRESS                3IO14640
       CAL     1,2                 REDUCE COUNT OF                      3IO14650
       ACL     L(377)              BUFS AHEAD,INCREMENT BUFS IN USE     3IO14660
       STA     1,2                                                      3IO14670
       CLA*    4,2                 UPDATE SYNC                         $3IO14680
       STA     4,2                 CHAIN CARRYING L(END)                3IO14690
       ZET*    4,2                 IN DECREMENT FIRST ENTRY             3IO14700
       STD*    4,2                 UNLESS NO CHAIN EXISTS               3IO14710
       ENB     TRAPS               ALLOW TRAPS                          3IO14720
       LGR     33                  SET EOF AND/ OR REDUN                3IO14730
       IIA                         BITS=0 IF CONDITION OCCURRED         3IO14740
       LXD     SYNCT,1             ADVANCE COUNT                        3IO14750
       TXI     *+1,1,1             OF BUFFERS                           3IO14760
       SXD     SYNCT,1             USED THIS READ                       3IO14770
       CAL     2,2                                                      3IO14780
       ACL     L(1)                                                     3IO14790
       PAC     0,4                 IR4 = -L(IORT)                       3IO14800
       ACL     L(1)                SET LOCATOR ADDRESS                  3IO14810
       ANA     XCPTP               CLEAR PREFIX                        $3IO14820
       STO*    2,2                                                     $3IO14830
       RNT     100000              READ BACKWARD                       $3IO14840
       TRA     SY4                 NO                                  $3IO14850
       ALS     18                  FIRST DATA WORD                     $3IO14860
       ACL     0,4                 IN BUFFER                           $3IO14870
       ARS     18                  LAST DATA WORD                      $3IO14880
       PAX     0,1                 +1 OF BUFFER                        $3IO14890
       ORA     7PRE                                                    $3IO14900
       BES     *-7+NOHYP/NOHYP*7-*                                     $3IO14910
SY4    SUB     0,4                 LOCATOR - IORT                      $3IO14920
       ALS     18                  =WORD COUNT                         $3IO14930
       STD*    2,2                                                     $3IO14940
       RNT     100000                                                  $3IO14950
       TRA     SY5                                                     $3IO14960
       CAL     0,4                 STARTING DATA                       $3IO14970
       STA*    2,2                                                     $3IO14980
       PXA     0,1                 LAST LOC+1 OF                       $3IO14990
       STA     0,4                 BUFFER IN TO IORT                   $3IO15000
       BES     *-6+NOHYP/NOHYP*6-*                                     $3IO15010
SY5    RNT     NOEOF               DID EOF OCCUR                       $3IO15020
       TRA     SY11                - YES                                3IO15030
       CLA     1,2                 IF LAST BUFFER                       3IO15040
       ANA     L(377)              AHEAD IS                             3IO15050
       PAX     0,1                 SYNCED OUT                           3IO15060
       CAL     3,2                 AND NOT                              3IO15070
       PBT                         AN INTERNAL FILE                     3IO15080
       TXL     SY9,1,0             INITIATE ANOTHER                     3IO15090
SY5.6  RNT     100000                                                  $3IO15100
       ADD     1DEC                BLOCK SEQUENCE                      $3IO15110
       LNT     BLKSEQ              BLOCK SEQ CHECK                      3IO15120
       TRA     SY7.6+1             - NO                                $3IO15130
       STD     SY7.1               SAVE SEQ NUMBER FOR TEST             3IO15140
       CAL*    2,2                 REDUCE                               3IO15150
       SUB     1DEC                USABLE WORD COUNT                    3IO15160
       STD*    2,2                 BY ONE                               3IO15170
       CAL     0,4                 GET L(SEQ. WD.)                     $3IO15180
       SUB     L(1)                FOR USE SOON                        $3IO15190
       RNT     100000              BACKWARD READ                       $3IO15200
       TRA     *+3                 NO                                  $3IO15210
       LNT     LABEL                                                   $3IO15220
       TRA     SY7.1+2                                                 $3IO15230
       BES     *-4+NOHYP/NOHYP*4-*                                     $3IO15240
       STA     *+1                                                     $3IO15250
       LAC     **,1                CHECK BLOCK                         $3IO15260
SY7.1  TXI     *+1,1,**            SEQUENCE                             3IO15270
       TXH     SEQEX,1,0           ADVANCED BY ONE                      3IO15280
       LNT     CKSUMS              ARE CHECKSUMS TO BE CHECKED          3IO15290
       TRA     SY7.6               -NO                                  3IO15300
       STA     SY7.5               -YES SAVE L(BLK WORD)                3IO15310
       STA     SUM1                SET LAST CKSUM ADDRESS+1             3IO15320
       CLA*    2,2                 CHECKSUM WDCT TO AC                  3IO15330
       ACL     1DEC                DONT CHECKSUM CKSUM WD               3IO15340
       TSX     SUMMIT+1,1          FORM FOLDED CHECKSUM                 3IO15350
       SLQ     TEMP                FOR COMPARE                          3IO15360
SY7.5  CAL     **                  DOES CHECKSUM COMPUTED               3IO15370
       ANA     PDMSK               COMPARE WITH                         3IO15380
       ERA     TEMP                CHECKSUM IN BLOCK WORD               3IO15390
       TNZ     CKSEX               IF NOT TAKE CKSUM ERROR EXIT         3IO15400
SY7.6  CLA     SY7.1               SEQ NUMBER TO AC                     3IO15410
       RFT     100000                                                  $3IO15420
       SUB     1DEC                                                    $3IO15430
       RIR     100000                                                  $3IO15440
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO15450
       RNT     NORED               IF URR OCCURRED                      3IO15460
       TRA     URREX               TAKE ERROR EXIT                      3IO15470
       STD     3,2                                                      3IO15480
SY8.2  AXT     **,4                RESTORE IR4                          3IO15490
SY8.1  AXT     **,1                IR1                                  3IO15500
       TTR     1,1                 RETURN                               3IO15510
       SPACE   1                                                        3IO15520
*                          LAST BUFFER SYNCED                           3IO15530
SY9    TSX     BORBF,1             LAST SYNCED -INITIATE ANOTHER        3IO15540
       SIR     REINT               COULDNT, SET REINITIATE LATER BIT    3IO15550
       CAL     3,2                 BLK SEQ NUMBER-1 TO AC               3IO15560
       TRA     SY5.6               CONTINUE                             3IO15570
       SPACE   1                                                        3IO15580
*                  NO BUFFER AVAILABLE WHEN NEEDED                      3IO15590
       RFT     NOREOF              IF ON TRY                           $3IO15600
       TRA     SY10-5              TO GET A BUFFER                   (8)3IO15610
SY9.3  ZET     XEOB                IF EOB IS PROVIDED                   3IO15620
       TRA     RW17                TAKE IT , ELSE GIVE                  3IO15630
       TRA     GET4                '' ILLEGAL FILE USE '' ERROR         3IO15640
       TTL     RUSH SITUATION - NO BUFFER READY FOR SYNC                3IO15650
       RIR     NOREOF              SET TRIED ONCE                      $3IO15660
       TSX     OBTIB,4             FORCE OUTPUT TO GIVE UP BUFFER       3IO15670
       TSX     BORBF,1             INITIATE READ                        3IO15680
       TRA     SY9.3-2             COULD NOT                           $3IO15690
       TRA     ACT                                                   (8)3IO15691
SY10   CLA     3,2                 EOB ON INTERNAL                     $3IO15700
       TMI     EOFEX               FILE IS = END OF FILE                3IO15710
       SIL     RBITS               SET RUSH PRIORITY BITS              $3IO15720
       AXC     1,4                 IS THERE ANY REQUEST                 3IO15730
       NZT*    0,2                 TO BE SYNCED                         3IO15740
       TRA     SY10-3              -NO                               (8)3IO15750
ACT    TSX     ACTV+1,4            -YES, ACTIVATE PRIORITY           (8)3IO15760
       MZE     0,2                 THAT FILE                            3IO15770
       AXC     1,4                 WAIT UNTIL I/O IS                 (4)3IO15771
       ZET*    0,2                 COMPLETED ON THAT UNIT            (8)3IO15772
       TRA     *-1                                                   (8)3IO15773
       TRA     SY3                 CONTINUE SYNC OUT                    3IO15780
       SPACE   1                                                        3IO15790
*                             EOF ON SYNC                               3IO15800
SY11   STZ     READR2                                                   3IO15810
       TSX     DISCON,1            DISCONNECT BUFFER                    3IO15820
       LDQ     2,2                 CHECK FOR TRAILERS.                  3IO15830
       RQL     2                   ONLY SYSIN1 OR SYSIN2               $3IO15840
       TQP     EOFEX               MONITOR CONTROL OF EOF'S             3IO15850
       TSX     MONEOF,4            EXECUTE MONITOR EOF CONTROL          3IO15860
       TRA     EOFEX               AND TAKE EOF EXIT                    3IO15870
       TSX     SWITCH,1            2,4 RETURN CAUSES REEL SWITCH        3IO15880
       TRA     SYNCR+2             AND AUTOMATIC PROCEED                3IO15890
       TTL                         READ SUBROUTINE-BORBF-               3IO15900
*                  ATTEMPT TO TAKE A BUFFER FROM POOL                   3IO15910
*           IF ONE IS AVAILABLE THEN INITIATE A READ INTO IT            3IO15920
       SPACE   1                                                        3IO15930
*              TSX BORBF,1         IR2 MUST = -L(FILE)                  3IO15940
*              ERROR RETURN        INDEX REGISTERS ARE                  3IO15950
*              NORMAL RETURN        NOT DISTURBED                       3IO15960
       SPACE   1                                                        3IO15970
BORBF  SXA     BOR8,1              SAVE IR1                             3IO15980
       SXA     BOR2,4              SAVE IR4                             3IO15990
       LAC     LBC,4               IF NO BUFFERS                        3IO16000
       ENB     L(0)                                                    $3IO16010
       CLA*    0,4                 ARE PRESENTLY                        3IO16020
       TPL     BOR3                AVAIL THEN EXIT AT 1,1               3IO16030
       LXA     BOR8,1              RESTORE IR1                          3IO16040
BOR2   AXT     **,4                RESTORE IR4                          3IO16050
       ENB     TRAPS                                                    3IO16060
       TRA     1,1                 AND EXIT                             3IO16070
BOR3   LNT     NINHIB              IF FILE INHIBITED                   $3IO16080
       TXI     BOR2,1,-1           EXIT AT 2,1                          3IO16090
       STA     XERR                SAVE L(NEXT BUFFER)                 $3IO16100
       CLA     1,2                 IF INITIAL                           3IO16110
       PAX     0,4                 BUFFER DONT                          3IO16120
       TXL     *+3,4,0             ADJUST COUNTS                        3IO16130
       TSX     TOKBF,4             ADJUST BUFFER COUNTS                 3IO16140
       TRA     BOR2-1              NO BUFFER AVAILABLE                  3IO16150
       LDQ*    LBC                 L(BUF) TO MQ FOR SELECT              3IO16160
       CLA     XERR                UPDATE POOL                         $3IO16170
       STA*    LBC                 BUFFER CHAIN                         3IO16180
       CAL     1,2                 UP COUNT BUFFERS                     3IO16190
       ADD     L(1)                IN USE BY                            3IO16200
       STA     1,2                 THE FILE                             3IO16210
       ENB     TRAPS               RESTORE TRAPPING                     3IO16220
       TSX     RDSEL,1             ISSUE STACKED SELECT                 3IO16230
BOR8   AXT     **,1                RESTORE IR1                          3IO16240
       TXI     BOR2,1,-1           EXIT AT 2,1                          3IO16250
       TTL                         INPUT BUFFER RELEASE ROUTINES        3IO16260
* RELEASE CONNECTED BUFFER (HELD IF HOLD=1) AND REINITIATE ON PRIORITY  3IO16270
*              TSX  RELES,1        CANNOT BE USED AT TRAP               3IO16280
*              RETURN               IR2 MUST=-L(FILE), LBC= L(POOL)     3IO16290
       SPACE   1                                                        3IO16300
*             DISCONNECT PRESENT BUFFER (HELD IF HOLD =1)               3IO16310
*              TSX  DISCON,1       CANNOT BE USED AT TRAP               3IO16320
*              RETURN               IR2 MUST=-L(FILE) ,LBC =L(POOL)     3IO16330
       SPACE   1                                                        3IO16340
DISCON SIR     DONLY               SET DISCONNECT ONLY                  3IO16350
RELES  SIR     RDSWIT              SET RELEASE MODE                     3IO16360
       SXA     RE2,1               SAVE IR1                             3IO16370
       SXA     RE2+1,4             AND IR4                              3IO16380
RE1    CLA*    2,2                 IS A BUFFER                          3IO16390
       TPL     RE4                 CONNECTED NORMALLY                   3IO16400
       STA     TCHAN               SAVE L( POSS. HOLD CHAIN.            3IO16410
       ANA     7PRE                IF BUFFER HELD                       3IO16420
       TZE     RE2                 OR NO BUFFER CONNECTED               3IO16430
       SPACE   1                                                        3IO16440
*                         RELEASE HELD BUFFERS                          3IO16450
       RNT     RDSWIT              RELEASE OR                           3IO16460
       TRA     TR1                 TRUNCATE                             3IO16470
       LAC     LBC,4                                                    3IO16480
       LDQ     2,2                 L(BUF TO MQ)                         3IO16490
       TSX     POOLRD,1            RELEASE BUFFER                       3IO16500
       RNT     DONLY               UNLESS DISCONNECT ONLY               3IO16510
       TSX     CKGIV,1             IF GIVUP ON REINITIATE               3IO16520
RE1.5  CLA     TCHAN               CHAIN HELD                           3IO16530
       STA     2,2                 BUFFERS                              3IO16540
       RNT     CPYFN               UNLESS COPYING                       3IO16550
       TRA     RE1                 RELEASE ALL HELD BUFFERS             3IO16560
RE2    AXT     **,1                RESTORE IR1                          3IO16570
       AXT     **,4                AND IR4                              3IO16580
       RNT     GENER               IF GENERATED DISCONNECT SAVE         3IO16590
       RIR     DISCN               COMMAND DISCONNECT BIT               3IO16600
       RIR     EOBITS                                                   3IO16610
       RFT     RDSWIT                                                   3IO16620
       RIR     XECNT                                                    3IO16630
       TRA     1,1                 EXIT                                 3IO16640
       SPACE   1                                                        3IO16650
*                        RELEASE BUFFER IN USE                          3IO16660
RE4    RNT     INSAT               IF INITIAL CONDITIONS NOT            3IO16670
       TRA     RE2                 SATISFIED NO DISCONNECT OF BUFFER    3IO16680
       RNT     RDSWIT              RELEASE OR                           3IO16690
       TRA     TR1.1               TRUNCATE                             3IO16700
       RNT     HOLD                IS HOLD BIT ON                       3IO16710
       TRA     RE5                 ENTER HOLD                           3IO16720
       TSX     ENTHLD,4            BUFFER INTO                          3IO16730
       SIR     DONLY               SET SKIP OF PRIORITY CHECKS          3IO16740
       TRA     RE6                 HOLD CHAIN                           3IO16750
RE5    LDQ     2,2                 L(BUF) TO MQ                         3IO16760
       LAC     LBC,4                                                    3IO16770
       TSX     POOLRD,1            BUFFER TO POOL                       3IO16780
RE6    CLA     LBC                 SET FILE TO REFER                    3IO16790
       STA     2,2                 TO POOL                              3IO16800
       RNT     DONLY               IF DISCONNECT ONLY                   3IO16810
       TSX     CKGIV,1             DONT PRIORITY INITIATE               3IO16820
       TRA     RE2                                                      3IO16830
*                  RELEASE BUFFER FROM INTERNAL FILE                    3IO16840
RE7    BSS     1                   TSX   ENTIN,1                        3IO16850
       ENB     TRAPS               ALLOW TRAPS                          3IO16860
       RNT     INSAT               EXIT EITHER TO                       3IO16870
       TRA     RE1.5               RELEASING HELD                       3IO16880
       TRA     RE6                 RELEASING THOSE IN USE               3IO16890
       TTL                         RELEASE INPUT BUFFER TO POOL         3IO16900
*                            IR2 = -L(FILE)                             3IO16910
*                            IR4 = -L(POOL)                             3IO16920
*      TSX TOPOOL,1     FILE BITS TO SI FIRST       L(BUF) IN MQ        3IO16930
*          TO CLOS,1    DECREASES BIUCT             L(BUF) IN MQ        3IO16940
*          POOLRD,1    RELEASES BUF TO POOL  L(BUF) IN MQ               3IO16950
       SPACE   1                                                        3IO16960
TOPOOL LDI     1,2                 FILE BITS TO                         3IO16970
       RIR     77777               SI-RIGHT SIDE TO ZERO                3IO16980
TOCLOS ENB     L(0)                TRAP PROTECT                         3IO16990
       CAL     1,2                 REDUCE                               3IO17000
       ACL     L(377)              BUF IN USE CT, INCRE LOGICAL USE     3IO17010
       STA     1,2                 USE COUNT                            3IO17020
*                      RELEASE INPUT BUF TO POOL                        3IO17030
POOLRD ENB     L(0)                TRAP PROTECT                         3IO17040
       CAL     1,2                 REDUCE CT                            3IO17050
       SUB     L(400)              OF BUFS LOGICALLY                    3IO17060
       STA     1,2                 IN USE BY FILE                       3IO17070
       RNT     RDSWIT              IS THE RELEASE MODE ON               3IO17080
       TRA     TCHAN               NO                                   3IO17090
       ZET     READR2                                                   3IO17100
       TRA     PRD2+1              YES                                  3IO17110
TCHAN  XCA     **                  L(BUF) TO AC                         3IO17120
       RNT     STSH                IF STASH AND XEOB IS NOT ZERO        3IO17130
       TRA     *+4                 (SIGNIFYING RELEASE ALREADY          3IO17140
       ZET     XEOB                ACCOUNTED FOR BY TSX BCKBF,1 )       3IO17150
       TRA     PRD2+1              SKIP TO EXIT, ALL STASHES ARE        3IO17160
       TRA     PRD1                DESTRUCTIVE RELEASES FROM INPUT      3IO17170
       LDQ     3,2                 IF AN INTERNAL FILE                  3IO17180
       TQP     *+2                 GO OUT AND CHECK DESTRUCTIVE         3IO17190
       TMI     RE7                 READ MODE OR NOT                     3IO17200
PRD1   SXA     PRD2,1              SAVE IR1                             3IO17210
       RNT     CPYFN               UNLESS COPYING                       3IO17220
       TSX     BTP2,1              RELEASE BUF TO POOL                  3IO17230
       CLA     1,2                 IF LAST                              3IO17240
       PAX     0,1                 BUFFER                               3IO17250
       TXL     PRD2,1,0            IN USE THEN SKIP                     3IO17260
       TSX     BCKBF,1             ADJUST BUFFER COUNTS                 3IO17270
PRD2   AXT     **,1                RESTORE IR1                          3IO17280
       NZT     INTRAP              UNLESS AT TRAP                       3IO17290
       ENB     TRAPS               RESTORE TRAPPING                     3IO17300
       TRA     1,1                 EXIT                                 3IO17310
       TTL     PRIORITY REINITIATE AN INPUT BUFFER                      3IO17320
CKGIV  CLA     3,2                 IF AN INTERNAL FILE                  3IO17330
       TMI     1,1                 SKIP PRIORITY                        3IO17340
       CAL     1,2                 IF NO                                3IO17350
       ANA     L(377)              BUFFERS                              3IO17360
       TZE     CK2                 AHEAD                                3IO17370
       LFT     GIVUP               OR BUFFER ALREADY                    3IO17380
       TRA     CK2                 GIVEN UP REINITIATE                  3IO17390
       SIL     GIVUP                                                    3IO17400
CK1    LNT     RUSH                IF RUSH OCCURRED                     3IO17410
       TRA     1,1                 REINITIATE , ELSE EXIT               3IO17420
       RIL     RANDG               RESET RUSH AND GIVUP BITS            3IO17430
CK2    SXA     *+3,1               SAVE IR1                             3IO17440
       TSX     BORBF,1             INITIATE BUFFER                      3IO17450
       SIR     REINT               COULDN'T SET REINITIATE AT EXIT      3IO17460
       AXT     **,1                RESTORE                             $3IO17470
       TRA     CK1                 GO TEST RUSH                         3IO17480
       TTL                         WRITE SUBROUTINE-TRUNC-              3IO17490
*                      TRUNCATE AN OUTPUT BUFFER                        3IO17500
       SPACE   1                                                        3IO17510
*              TSX TRUNC,1    WITH IR2=-L(FCW)                          3IO17520
*              RETURN              INDEX REGISTERS ARE NOT DISTURBED    3IO17530
       SPACE   1                                                        3IO17540
TRUNC  RIR     RDSWIT              SET TRUNCATE MODE                    3IO17550
       TRA     RELES+1             USE RELES ROUTINE                    3IO17560
       SPACE   1                                                        3IO17570
*                        TRUNCATE HELD BUFFERS                          3IO17580
TR1    CLA*    2,2                 HOLD CODE TO AC                      3IO17590
       TSX     WRSLH,1             ISSUE SELECT FOR HELD BUFFER         3IO17600
       CLA     TCHAN               UPDATE FILE                          3IO17610
       STA     2,2                 HOLD CHAIN                           3IO17620
       TRA     RE1                 CONTINUE TO END OF HOLD CHAIN        3IO17630
       SPACE   1                                                        3IO17640
*                        TRUNCATE BUFFER IN USE                         3IO17650
TR1.1  RNT     HOLD                IS BUFFER TO BE HELD                $3IO17660
       TRA     TR2                 NO, WRITTEN                         $3IO17670
       TSX     ENTHLD,4            ENTER IT INTO HOLD CHAIN            $3IO17680
       TRA     TR3                                                     $3IO17690
SETWR  SXA     TR10+1,4            SAVE IR4 AND 1                      $3IO17700
       SXA     TR10+2,1                                                $3IO17710
       CAL     2,2                 FIND                                $3IO17720
       ACL     L(1)                L(IORT)                              3IO17730
       STA     TR5                                                      3IO17740
       CLA*    2,2                 PICK UP LOCATOR                     $3IO17750
       TMI     TR5+1               IN HOLD CHAIN                       $3IO17760
TR5    STA     **                                                       3IO17770
       CLA*    TR5                 GET LOCATOR                         $3IO17780
       STA     TR10                FOR CHECKSUMMING CALC.               3IO17790
       STA     SUM1                AND STORE                            3IO17800
       SUB     TR5                 FORM COUNT AND STORE                $3IO17810
       LNT     BLKSEQ                                                   3IO17820
       SUB     L(1)                IN IORT                              3IO17830
       ALS     18                                                       3IO17840
       STD*    TR5                                                      3IO17850
       ANA     DECRE                                                    3IO17860
       LFT     BLKSEQ              IF ONLY ONE WORD (THE BLKSEQ WORD)   3IO17870
       SUB     1DEC                EXISTS OR IF NO DATA WORDS           3IO17880
       TNZ     TR9                 EXIST THEN                           3IO17890
       LDQ     2,2                 DONT WRITE BUFFER OUT                3IO17900
       LAC     LBC,4               L(POOL) TO IR4                       3IO17910
       CAL     1,4                 RESTORE                              3IO17920
       ARS     4                   SIZE TO                              3IO17930
       STD*    TR5                 IORT                                 3IO17940
       ENB     L(0)                TRAP PROTECT                         3IO17950
       TSX     BTP1,1              BUFFER IN POOL                       3IO17960
       CLA     3,2                 IF AN INTERNAL FILE THEN             3IO17970
       TPL     *+2                 ADJUST BUFFER COUNTS                 3IO17980
       TSX     BCKBF,1             AS ONE WAS BORROWED IN GTBUF         3IO17990
       ENB     TRAPS               ALLOW TRAPS AND EXIT SO              3IO18000
       LXA     TR10+2,1            NO WRITE                            $3IO18010
       TRA     1,1                 IS EXECUTED                         $3IO18020
TR9    LNT     CKSUMS              ARE CKSUMS DESIRED                   3IO18030
       TRA     *+3                                                      3IO18040
       TSX     SUMMIT,1            FORM AND STORE IN BLKSEQ             3IO18050
TR10   SLQ     **                  WORD THE 18 BIT                      3IO18060
       AXT     **,4                RESTORE IRS                         $3IO18070
       AXT     **,1                AND RETURN                          $3IO18080
       TRA     1,4                                                     $3IO18090
TR2    TSX     WRSEL,1             WRITE BUFFER                         3IO18100
TR3    CLA     LBC                 SET FILE REFERENCE                   3IO18110
       STA     2,2                 TO POOL                              3IO18120
       TRA     RE2                                                      3IO18130
       TTL     WRITE SUBROUTINES-GTBUF-AND-OBTIB-                       3IO18140
*            GET A BUFFER AND ATTACH TO OUTPUT FILE (GTBUF)             3IO18150
*              TSX  GTBUF,1        IR2 =-L(FILE)                        3IO18160
*              RETURN               INDICES NOT DISTURBED               3IO18170
       SPACE   1                                                        3IO18180
*          FORCE AN OUTPUT BUFFER TO BE RELEASED TO THE POOL            3IO18190
*              TSX  OBTIB,4        IR2 NOT DISTURBED                    3IO18200
*              RETURN               IR1 DESTROYED                       3IO18210
       SPACE   1                                                        3IO18220
OBTIB  SXA     GET8,4              SAVE IR4                             3IO18230
       SIR     FREEUP              SET FREE UP BUFFER ONLY MODE        $3IO18240
       TSX     GET0,1              FREE OUTPUT BUFFER TO POOL           3IO18250
       TRA     1,4                 EXIT                                 3IO18260
       SPACE   1                                                        3IO18270
GTBUF  SXA     GET8,4              SAVE IR4                             3IO18280
       CLA     3,2                 IF AN INTERNAL FILE                  3IO18290
       TPL     GET0                CHECK TO MAKE SURE AFTER             3IO18300
       SXA     GET8+1,1            SAVING INDEX 1 ,                     3IO18310
       TSX     TOKBB,4             THAT FILE IS ALLOWED                 3IO18320
       TRA     SY9.3               TO TAKE A BUFFER , IF SO             3IO18330
       TRA     *+2                 SKIP SAVING OF IR1                   3IO18340
GET0   SXA     GET8+1,1            SAVE IR1                             3IO18350
       LAC     LBC,4               SETUP SUCH THAT IF SYNC IS           3IO18360
       CLA     1,4                 NECESSARY IT WILL BE STARTED         3IO18370
       LDQ*    0,4                 WITH FIRST FILE                      3IO18380
       TQP     GET5                BUF AVAIL-GO JOIN WITH FILE          3IO18390
       SPACE   1                                                        3IO18400
*                         NO BUFFER AVAILABLE                           3IO18410
GET1   ANA     ADDRS               CHECK IF NO OUTPUT                   3IO18420
       TNZ     *+5                 CHAIN LEFT-CHECK BUF AVAIL.         $3IO18430
       LAC     LBC,4               L(BPCW)                           $5$3IO18440
       LDQ*    0,4                                                   $5$3IO18450
       TQP     GET5                BUF AVAIL-JOIN IT                   $3IO18460
       TRA     SY9.3               NONE-TRY EOB                        $3IO18470
       STA     CPY7                SETUP SYNC SEQUENCE                  3IO18480
       LAC     CPY7,1              FOR* ADDRESSING OF 2ND UCW           3IO18490
       CLA     0,1                 PLACE L(UCW)                         3IO18500
CPY7   PAC     **,4                IN IR4                               3IO18510
       CLA     1,4                 IF PRIORITY WORD                     3IO18520
       TZE     GET2                =0 OR NOT AN OUTPUT FILE             3IO18530
       TPL     GET3                THEN TRY NEXT FILE IN CHAIN          3IO18540
       TSX     ACTV+1,4            ACTIVATE THIS UNIT GIVING            3IO18550
1TAG   MZE     0,1                 IT HIGH PRIORITY                     3IO18560
       LAC     LBC,4               WAIT UNTIL                           3IO18570
       CLA*    0,4                 A BUFFER PLACED IN                   3IO18580
       TPL     GET5                POOL BY TRAP                         3IO18590
       TRA     CPY7-2                                               (12)3IO18600
       EJECT                                                            3IO18610
*                     UNIT HAS NO REQUESTS WAITING                      3IO18620
GET2   CLA     1,1                 IF UNIT NOT ACTIVE                   3IO18630
       ANA     NEOTBT              AND EOT CONDITION                    3IO18640
       TZE     SYEOT               IS ON THEN HANDEL IT NOW             3IO18650
GET3   CLA     1,1                 ADVANCE AROUND                       3IO18660
       TRA     GET1                OUTPUT CHAIN                         3IO18670
*        ERROR-NO FILES CAN GIVUP BUFFERS - ILLEGAL FILE USE -          3IO18680
GET4   TSX     PROUT,4             AN ILLEGAL FILE USAGE SUCH           3IO18690
       PZE     1                   AS USING A TTO AS A PTO              3IO18700
       PZE     MES22,,3            WILL CAUSE THIS ERROR                3IO18710
       TSX     STOP,4                                                   3IO18720
       SPACE   1                                                        3IO18730
*                  GOT A BUFFER - READY IT FOR OUTPUT                   3IO18740
GET5   RFT     FREEUP              IF ONLY FREEING UP A                 3IO18750
       TRA     GET8                BUFFER DONT CONNECT IT TO A FILE     3IO18760
       ENB     L(0)                TRAP PROTECT                         3IO18770
       RNT     HELD                IF A HELD BUFFER                     3IO18780
       TRA     GET6                EXIST,COUNT                          3IO18790
       CLA     3,2                 SHOULD BE ADJUSTED                   3IO18800
       TMI     *+4                 ( EXCEPT INTERNAL FILES)             3IO18810
       TSX     TOKBF,4             FOR EACH ADDITIONAL BUFFER           3IO18820
       TRA     SY9.3               CANT-TAKE EOB OR GIVE ERROR PRINT    3IO18830
       LAC     LBC,4               L(POOL) TO IR4                       3IO18840
       CAL     7PRE                SET CODE 7                           3IO18850
       STP*    HOLDS               INTO PREVIOUS HELD BUFFER            3IO18860
GET6   CLA*    0,4                 UPDATE AVAILABLE                     3IO18870
       STA     CPY7                BUFFER CHAIN                         3IO18880
       CLA     0,4                 SET L(BUF)                           3IO18890
       STA     2,2                 INTO FILE REFERENCE                  3IO18900
       ACL     L(1)                SAVE                                 3IO18910
       STA     GET7                L(IORT)                              3IO18920
       ACL     L(1)                SET LOCATOR                          3IO18930
       STA*    2,2                 = PZE *+2,,**                        3IO18940
       CAL     CPY7                UPDATE POOL TO REFER                 3IO18950
       STA     0,4                 TO NEXT BUFFER                       3IO18960
       ENB     TRAPS               ALLOW TRAPS                          3IO18970
GET7   CLA     **                  PICKUP IORT                          3IO18980
       LFT     BLKSEQ              AND FORM                             3IO18990
       SUB     1DEC                EFFECTIVE SIZE OF BUFFER             3IO19000
       STD*    2,2                 SET LOCATOR = PZE *+2,,EFF.SIZE.     3IO19010
GET8   AXT     **,4                RESTORE IR4                          3IO19020
       AXT     **,1                1                                    3IO19030
       RIR     FREEUP              RESET FREEUP BIT                    $3IO19040
       TRA     1,1                 EXIT                                 3IO19050
       TTL                         HOLD FUNCTION SUBROUTINES            3IO19060
*            ENTER BUFFER ATTACHED TO FILE INTO HOLD CHAIN              3IO19070
       SPACE   1                                                        3IO19080
*              TSX ENTHLD,4        IR2 MUST = -L(FILE)                  3IO19090
*              RETURN              IR1 DESTROYED                        3IO19100
       SPACE   1                                                        3IO19110
ENTHLD CLA     2,2                 L(BUFFER) TO AC                      3IO19120
       LFT     OUTPUT                                                  $3IO19130
       TRA     FIX                                                     $3IO19140
       TPL     FIX                 IF REGEN INTERNAL FILE              $3IO19150
FIX1   RFT     HELD                IF ALREADY HOLDING                  $3IO19160
       TRA     EN1                 SKIP INITIALIZATION                  3IO19170
       PAX     0,1                 ENTER 1ST BUFFER                     3IO19180
       SIR     HELD                IN CHAIN                             3IO19190
       SXD     HOLDS,1             PRESET * STORE                       3IO19200
       TRA     EN1+1                                                   $3IO19210
FIX    PAC     0,1                 BCW TO IR1                          $3IO19220
       CLA*    2,2                 GET LOCATOR AND                     $3IO19230
       STA     1,1                 SAVE FOR WRITE                      $3IO19240
       CLA     2,2                 IN ITS IORT                         $3IO19250
       TRA     FIX1                PUT IN HOLD CHAIN                   $3IO19260
EN1    STA*    HOLDS               PLACE BUFFER IN CHAIN                3IO19270
       STA     HOLDS               UPDATE CHAIN                         3IO19280
       CAL     CDTCT               PLACE HOLD BITS (PREFIX OF FIVE)    $3IO19290
       STP*    HOLDS               IN BUFFER                            3IO19300
       TRA     1,4                                                     $3IO19310
       SPACE   1                                                        3IO19320
*                           SETUP HOLD CHAIN                            3IO19330
*                           IN FILE AT EXIT                             3IO19340
*                          FROM READ OR WRITE                           3IO19350
       SPACE   1                                                        3IO19360
*                           CALLING SEQUENCE                            3IO19370
       SPACE   1                                                        3IO19380
*              TSX HOOK,4     IR2 MUST= -L(FILE)                        3IO19390
*              RETURN                                                   3IO19400
       SPACE   1                                                        3IO19410
HOOK   CLA     2,2                                                      3IO19420
       STA*    HOLDS                                                    3IO19430
       LXD     HOLDS,1                                                  3IO19440
       PXA     0,1                                                      3IO19450
       STA     2,2                                                      3IO19460
       RIR     HELD                                                     3IO19470
       TRA     1,4                                                      3IO19480
       TTL             NON-DATA SELECT CODES FOR IOEX                   3IO19490
*       EQU CARDS FOR SYMBOLIC DEFINITION OF IOEX COMMUNICATIONS        3IO19500
       SPACE   1                                                        3IO19510
HFPNP  EQU     42                  FILE PROTECT                         3IO19520
HUNLP  EQU     39                  UNLOAD                               3IO19530
HSKFP  EQU     37                  SKIP FILE                            3IO19540
HSKRP  EQU     36                  SKIP RECORD                          3IO19550
HBSFP  EQU     35                  BACKSPACE FILE                       3IO19560
HBSRP  EQU     34                  BACKSPACE RECORD                     3IO19570
HWTMP  EQU     33                  WRITE TAPE MARK                      3IO19580
HERGP  EQU     32                  ERASE LONG GAP                       3IO19590
HRUNP  EQU     31                  REWIND AND UNLOAD                    3IO19600
HRWDP  EQU     30                  REWIND                               3IO19610
WEFOP  EQU     7                   WEF                                  3IO19620
BSFOP  EQU     6                   BSF                                  3IO19630
BSROP  EQU     5                   BSR                                  3IO19640
RUNOP  EQU     4                   RUN                                  3IO19650
REWOP  EQU     3                   REW                                  3IO19660
SDNHP  EQU     2                   SDNH                                 3IO19670
SDNLP  EQU     1                   SDNL                                 3IO19680
TESTP  EQU     0                   TEST OP                              3IO19690
       TTL     SELECT ROUTINES (ENTER BUF. INTO REQUEST STATUS)         3IO19700
*      TSX  RDSEL,1                L(BUF) IN MQ (21-35)                 3IO19710
*      TSX  WRSEL,1                          2,2 (21-35)                3IO19720
*         TSX    WRSLH,1         WRITE HELD BUFFER                      3IO19730
*                                  IR4 IS DESTROYED                     3IO19740
       SPACE   1                                                        3IO19750
WRSLH  LAS     2PRE                IF WRITING HELD BUFFER              $3IO19760
       TRA     SEL5                CODE 7 (NOT LAST) ADJUST COUNTS      3IO19770
SEL4   PZE     **,,ISSUE           SELECT WORD                          3IO19780
WRSEL  CLA     3,2                 HANDLE INTERNAL FILE                 3IO19790
       TMI     SEL5.8              SEPARATELY                           3IO19800
       TSX     SETWR,4             SET UP TO WRITE                     $3IO19810
       LDQ     2,2                 L(BUF) TO MQ                         3IO19820
RDSEL  XCA                                                              3IO19830
       STA     SEL4                L(BUF) TO SEL4                       3IO19840
       LDQ     L(0)D               SET BUFFER                           3IO19850
       LGL     18                  1ST WD =                             3IO19860
       SLW*    SEL4                PZE L(0),,*                          3IO19870
SEL0   AXC     1,4                                                      3IO19880
       ENB     L(0)                                                     3IO19890
       CLA*    0,2                 CHECK FILE ALREADY                   3IO19900
       TZE     SEL3                ACTIVE                               3IO19910
       STA     SEL1                YES                                  3IO19920
       CAL     FCW                                                     $3IO19930
       AXT     0,4                                                     $3IO19940
       ERA*    0,2                 IS THIS THE SAME FILE               $3IO19950
       ANA     ADDRS                                                   $3IO19960
       TZE     SEL1                YES                                 $3IO19970
       TSX   (ACTVX,4              NO                                  $3IO19980
       MZE     0,2                                                     $3IO19990
       TRA     SEL0                                                    $3IO20000
SEL1   CLA     **                  ADD NEW                              3IO20010
       PDC     0,4                 BUFFER TO END                        3IO20020
       CLA     SEL4                OF EXISTING                          3IO20030
       STA     0,4                 BUFFER CHAIN                         3IO20040
       ALS     18                  SET L(NEW BUF) INTO                  3IO20050
       STD*    SEL1                DECREMENT 1ST ENTRY                  3IO20060
       ENB     TRAPS               ALLOW TRAPS                          3IO20070
       TRA     1,1                 EXIT                                 3IO20080
       SPACE   1                                                        3IO20090
*                         ENTER INITIAL SELECT                          3IO20100
SEL3   LNT     NETIH               IF NO EOT OR NOT INHIBITED IS OFF    3IO20110
       TRA     SEL6                GO HANDLE IT SPECIAL                 3IO20120
       AXT     0,4                 CHECK FOR                            3IO20130
       CLA*    0,2                 ENTERING INITIAL SELECT ON           3IO20140
       LGR     18                  UNIT TO WHICH MULTIPLE FILES         3IO20150
       TQP     SEL2.5              ARE ATTACHED AND ONE OF THEM         3IO20160
       LGL     18                  HAS ENCOUNTERED EOT                  3IO20170
       STA     CPY7                IF SO THEN HANDLE                    3IO20180
       SXA     SEL2.4,1            EOT ON THE FILE LAST ATTACHED        3IO20190
       TSX     CPY6,4              (THAT SPECIFIED IN UCW WD 1 ADDR.)   3IO20200
       TSX     EOTOF,1                                                  3IO20210
       TSX     CPY6,4                                                   3IO20220
SEL2.4 AXT     **,1                RESTORE IR1                          3IO20230
SEL2.5 STI     TEMIND                                                  $3IO20240
       AXT     0,4                 GET FILE BLOCK ADDRESS              $3IO20250
       CAL     FCW                 AND STORE IN UCW ONE                $3IO20260
       STA*    0,2                                                     $3IO20270
       LDI*    0,2                 UCW 1                               $3IO20280
       LFT     20000               1301                                $3IO20290
       TRA     SEL2.6              MAYBE                               $3IO20300
SEL2.7 CAL     SEL4                NO                                  $3IO20310
       AXC     1,4                                                     $3IO20320
       LDI     TEMIND                                                  $3IO20330
       LFT     OUTPUT              OUTPUT                              $3IO20340
       ORA     FOR                 YES-SET BIT                         $3IO20350
       SLW*    0,2                 STORE ISSUE IN UCW 2                $3IO20360
       TSX     ACTV+1,4            ACTIVATE                             3IO20370
       PZE     0,2                 THIS FILE                            3IO20380
       TRA     1,1                                                      3IO20390
SEL2.6 LNT     100                 1301                                $3IO20400
       TRA     SEL8           NO                                       $3IO20410
       SXA     SEL2.8+1,1          YES                                 $3IO20420
       CLA     0,2                 PUT -L(UCB) IN IR4                  $3IO20430
       PAC     0,4                                                     $3IO20440
       LDQ     6,2                 CHECK IF EOF ON DISK                $3IO20450
       TQP     SEL2.8              NO                                  $3IO20460
       ARS     18                  PUT CORRECT SEEK                    $3IO20470
       STA     6,2                 IN WORD SEVEN                       $3IO20480
       STP     6,2                 AND TURN OFF EOF BIT                $3IO20490
SEL2.8 TSX     CKSEE,1             SEEK NECESSARY                      $3IO20500
       AXT     **,1                                                    $3IO20510
       TRA     SEL2.7         RETURN                                   $3IO20520
       TXI     *+1,1,-RELASE       IS THIS A RELEASE ENTRY             $3IO20530
       TXL     GO,1,0              YES GO THERE                        $3IO20540
ENDTRK TSX     PROUT,4             PRINT OUT NOTICE                    $3IO20550
       PZE     2                   TO OPERATOR                         $3IO20560
       MZE     9,2,3                                                    3IO20570
       PZE     MESS2,,3       AND STOP                                 $3IO20580
       LDI     1,2            RESTORE IND                              $3IO20590
       RIR     77777                                                   $3IO20600
       PXA     0,0                                                     $3IO20610
       STT     6,2                                                     $3IO20620
       TRA     BOFEX                                                   $3IO20630
       BES     SEL2.6+NOCH/NOCH**-NOCH/NOCH*SEL2.6-*                   $3IO20640
SEL8   PXD     0,0                                                     $3IO20650
       LDI     1,2                                                     $3IO20660
       RFT     400000              IS THIS READ BACKWARD               $3IO20670
       CLA     SIX                 YES, SET BACKWARD READ MODE         $3IO20680
       ACL     SEL4                YES                                 $3IO20690
       AXC     3,4                 STORE ZERO                          $3IO20700
       STZ*    0,2                 IN UCW 4                            $3IO20710
       TRA     SEL2.7+1                                                $3IO20720
       BES     *-8+NOHYP/NOHYP*8-*                                     $3IO20730
TEMIND PZE                                                              3IO20740
       TTL 0                                                            3IO20750
*        ADVANCE RESERVE GROUP BUF.CT. IF NO-COPY WRITE RESERVE         3IO20760
SEL5   CLA     3,2                 IF AN INTERNAL FILE                  3IO20770
       TMI     SEL5.8              HANDLE IT SEPARATELY                 3IO20780
       SXA     SEL5.6,1            SAVE IR1                             3IO20790
       ENB     L(0)                DISABLE TRAPS                        3IO20800
       TSX     BCKBB,1                                                  3IO20810
SEL5.6 AXT     **,1                RESTORE IR1                          3IO20820
       TRA     WRSEL+2             RETURN TO WRITE                      3IO20830
*                      WRITE INTERNAL FILE BUFFER                       3IO20840
SEL5.8 TSX     SETWR,4             SET UP TO WRITE                     $3IO20850
       SXA     SEL5.6,1            SAVE IR1                            $3IO20860
       CLA     2,2                 L(BUF)                               3IO20870
       PAC     0,1                 TO IR1                               3IO20880
       LAC     LBC,4               RESTORE SIZE TO                      3IO20890
       CAL     1,4                                                      3IO20900
       ARS     4                                                        3IO20910
       STD     1,1                                                      3IO20920
       CLA     2,2                 SET THIS BUFFER                      3IO20930
SEL5.9 STR                         TSX  ENTIN,1                         3IO20940
       CAL     3,2                 ADVANCE BLOCK SEQ                    3IO20950
       ACL     1DEC                                                     3IO20960
       STD     3,2                                                      3IO20970
       LXA     SEL5.6,1            RESTORE IR1                          3IO20980
       TRA     1,1                 EXIT                                 3IO20990
SEL9   STR                         BSF TRANSFER FOR DISK                3IO21000
       SPACE   1                                                        3IO21010
*                        EOF OR EOT ENCOUNTERED                         3IO21020
SEL6   LFT     OUTPUT              INPUT FILE OR PUTPUT FILE            3IO21030
       TRA     SEL7-1                                                   3IO21040
       LDQ     SEL4                RELEASE BUFFER                       3IO21050
       LAC     LBC,4               -L(POOL) TO IR4                      3IO21060
       TRA     TOCLOS              TOCLOS EXITS AT 1,1                  3IO21070
       SPACE   1                                                        3IO21080
*                             EOT OCCURRED                              3IO21090
       SXA     *+2,1               SAVE IR1                             3IO21100
SEL7   TSX     EOTOF,1             HANDLE EOT                           3IO21110
       AXT     **,1                RESTORE IR1                          3IO21120
       TRA     SEL0                AND CONTINUE                         3IO21130
       TTL                         DENSITY SETTING ROUTINE              3IO21140
*                             TSX DENSE,4                               3IO21150
       SPACE   1                                                        3IO21160
DENSE  CLA     1,2                 PLACE FILE                           3IO21170
       ANA     1TAG                DENSITY BIT                          3IO21180
       ALS     3                   IN DECREMENT                         3IO21190
       ACL     1DEC                ADD 1 TO FORM                        3IO21200
       STD     *+3                 LOW DEN. = 1                         3IO21210
       SXA     *+3,4               HI DEN. = 2                          3IO21220
       TSX     NDSEL+1,4           SET DENSITY                         $3IO21230
       PZE     0,2,**                                                   3IO21240
       AXT     **,4                RESTORE IR4                          3IO21250
       TRA     1,4                 EXIT                                 3IO21260
       TTL                         UNBUFFER INPUT FILE                  3IO21270
*    TSX  UNBFI,4           DESTROYS IR1                                3IO21280
       SPACE   1                                                        3IO21290
UNBFI  SXA     UB7,4               SAVE IR4                             3IO21300
       TSX     DISCON,1            DISCONNECT BUF IN USE( IF ANY)       3IO21310
UB1    ENB     L(0)                TRAP PROTECT                         3IO21320
       AXC     1,4                 IF NO BUFS IN REQ                    3IO21330
       CLA*    0,2                 CHAIN THEN GO RELEASE                3IO21340
       TZE     UB4                 SYNC CHAIN                       (11)3IO21345
       STA     UB2                 SAVE L (1ST REQUEST)             (11)3IO21350
       CAL     FCW                 FCB OF FILE TO BE CLOSED         (11)3IO21351
       AXT     0,4                                                  (11)3IO21352
       ERA*    0,2                 IS SAME FILE ACTIVE              (11)3IO21353
       ANA     ADDRS                                                (11)3IO21354
       TZE     UB1.1               YES....CONTINUE                  (11)3IO21355
       TRA     UB3                 NO. GO FINISH ACTIVE FILE FIRST  (11)3IO21358
UB1.1  LDQ     5,2                   CHECK FOR DISK                     3IO21370
       TQP     *+2                                                     $3IO21390
       TRA     UB3                 DISK, GO TO UB3                     $3IO21400
       BES     UB1.1+NOCH/NOCH**-NOCH/NOCH*UB1.1-*                   $5$3IO21410
       CLA     UB1                 SAVE REQ CHAIN AND UNLESS ONLY       3IO21430
UB2    NZT*    **                  ONE REQ , BLOCK REQ SEQUENCE         3IO21440
       TRA     UB3                 HOOKING REMAINDER OF REQ             3IO21450
       LDQ*    UB2                 CHAIN TO SYNC CHAIN... IF ONLY       3IO21460
       STA*    UB2                 ONE REQ GO DIRECTLY TO FORCE         3IO21470
       XCA                         ITS COMPLETION                       3IO21480
       NZT*    4,2                 IF SYNC CHAIN DOES NOT EXIST FORM    3IO21490
       TRA     UB5                 ONE FROM BLOCKED REQ CHAIN           3IO21500
       LDQ     4,2                 ADD 2ND ON REQS                      3IO21510
       STA     4,2                 TO SYNC CHAIN                        3IO21520
       PDC     0,1                                                      3IO21530
       XCA                                                              3IO21540
       STA     0,1                                                      3IO21550
       CLA*    0,1                                                      3IO21560
       STD*    4,2                                                      3IO21570
UB3    TSX     ACTV+1,4            WHICH AT TRAP WILL                   3IO21580
       MZE     0,2                 BE ENTERED INTO                      3IO21590
       AXC     1,4                 SYNC CHAIN                           3IO21600
       ZET*    0,2                 WAIT                                 3IO21610
       TRA     *-1                                                      3IO21620
       SPACE   1                                                        3IO21630
*                      ALL BUFFERS IN SYNC CHAIN                        3IO21640
UB4    SXD     SYNCT,0             PRESET SYNC CT                       3IO21650
       STZ     TEMP                SET EOF DELETE SWITCH =0             3IO21660
UB4.1  CLA*    4,2                 PLACE BUFFERS                        3IO21670
       TZE     UB6                 FROM SYNC CHAIN                      3IO21680
       TPL     *+4                 TO POOL ,+ BUFFERS                   3IO21690
       LXD     SYNCT,1             HAVE NOT BEEN LOADED, COUNT          3IO21700
       TXI     *+1,1,1             NUMBER OF BACKSPACES                 3IO21710
       SXD     SYNCT,1             NECESSARY TO REPOSITION              3IO21720
       LDQ     4,2                 TO POOL                              3IO21730
       STA     4,2                                                      3IO21740
       ANA     6PRE                IS THERE AN EOF ASSOCIATED           3IO21750
       TZE     UB4.2               WITH THIS BUFFER                     3IO21760
       XCA                         YES- SO PICKUP                       3IO21770
       PAC     0,1                 THE TAPE POSITION                    3IO21780
       XCA                         AND SAVE FOR AFTER BSR               3IO21790
       CLA     2,1                 ACROSS EOF MARK                      3IO21800
       STO     TEMP                                                     3IO21810
UB4.2  LAC     LBC,4                                                    3IO21820
       TSX     TOCLOS,1                                                 3IO21830
       TRA     UB4.1                                                    3IO21840
       SPACE   1                                                        3IO21850
*                         FORM NEW SYNC CHAIN                           3IO21860
UB5    STA     4,2                 FORM NEW SYNC CHAIN                  3IO21870
       STD*    4,2                 SAVE KIND OF SYNC CHAIN             $3IO21880
       TRA     UB3                 AND CONTINUE                         3IO21890
       SPACE   1                                                        3IO21900
*                            EXIT SEQUENCE                              3IO21910
UB6    LXD     SYNCT,1             IF BUFFERS WERE DELETED              3IO21920
       TXL     UB7,1,0             SETUP AND BACKSPACE                  3IO21930
       LDQ     5,2                                                     $3IO21940
       RQL     1                   HYPER                               $3IO21950
       TQP     *+7                 NO                                  $3IO21960
       LDQ     1,2                                                     $3IO21970
       RQL     18                  READ BACKWARD                       $3IO21980
       TQP     *+4                 NO                                  $3IO21990
       TSX     (NDSLX,4                                                $3IO22000
       PZE     0,2,HSKRP           FORWARD SPACE FILE                  $3IO22010
       TRA     UB6.3-1                                                 $3IO22020
       BES     *-9+NOHYP/NOHYP*9-*                                     $3IO22030
       TSX     NDSEL+1,4                                                3IO22040
       PZE     0,2,BSROP                                                3IO22050
       NZT     TEMP                IF BSR ACROSS EOF MARK               3IO22060
UB6.3  TXI     UB6+1,1,-1          RESTORE TAPE POSITION               $3IO22070
       CLA     5,2                                                   $5$3IO22071
       TMI     *+5                                                   $5$3IO22072
       CLA     TEMP                AND CONTINUE                         3IO22080
       AXC     2,4                                                      3IO22090
       STO*    0,2                                                      3IO22100
       STZ     TEMP                                                     3IO22110
       SIL     NINHIB              UN-INHIBIT FILE                      3IO22120
       TRA     UB6.3                                                    3IO22130
UB7    AXT     **,4                RESTORE IR4                          3IO22140
       TRA     1,4                 EXIT                                 3IO22150
       TTL     UNBUFFER OUTPUT FILE                                     3IO22160
*                 (WAITS TILL ALL IO ACTIVITY CEASES)                   3IO22170
*    TSX  UNBFO,4     DESTROYS IR1                                      3IO22180
       SPACE   1                                                        3IO22190
UNBFO  SXA     UNBO,4              SAVE IR4                             3IO22200
       TSX     TRUNC,1             TRUNCATE BUF IN USE (IF ANY)         3IO22210
UNBF1  AXC     1,4                 IF UNIT HAS REQUESTS                 3IO22220
       NZT*    0,2                 TO DO GIVE IT                        3IO22230
       TRA     UNBO                PRIORITY AND WAIT.....               3IO22240
       TSX     ACTV+1,4            FOR ALL REQUESTS TO GET DONE         3IO22250
       MZE     0,2                                                      3IO22260
       TRA     UNBF1                                                    3IO22270
UNBO   AXT     **,4                                                     3IO22280
       NZT*    4,2                 IF EOT OCCURRED HANDLE IT NOW        3IO22290
       TRA     1,4                 ELSE EXIT                            3IO22300
       TSX     EOTOF,1                                                  3IO22310
       TRA     UNBO-3                                                   3IO22320
       TTL                         IOCS SELECT ROUTINES                 3IO22330
*             (INITIATE A SELECT AND POST ITS COMPLETION)               3IO22340
       SPACE   1                                                        3IO22350
CHATY  PZE                         UNIT AND CHANNEL TYPE               $3IO22360
ISSUE  SXA     S3,4                SAVE IR4                             3IO22370
       SXA     S3+1,1              SAVE IR1                             3IO22380
       PAC     0,4                 -L(UCW) TO IR4                       3IO22390
       XCA                         SAVE + OR - ENTRY                    3IO22400
CHATT  CLA     0,4                 SET UP AND                          $3IO22410
       ANA     BVDG                TEST FOR UNIT                       $3IO22420
       PDX     0,2                 AND CHANNEL TYPE                    $3IO22430
       TXL     *+3,2,8191          7909 OR 7607                        $3IO22440
       TXL     *+3,2,8192          HYPER                               $3IO22450
       TXI     *+2,2,1             DISK                                $3IO22460
       AXT     0,2                 IF 7607'''ZERO IR2                  $3IO22470
       SXA     CHATY,2             SAVE INDICATION                     $3IO22480
       BES     *-8+NOCHX/NOCHX*8-*                                      3IO22490
       CLA     0,4                 0=7607, 20101=DISK, 20000=HYPER     $3IO22500
       PAC     0,2                 L(FILE) TO IR2                      $3IO22510
       TQP     SELP                SEPARATE SEL+ ENTRY                 $3IO22520
       CLA     CHATY               CHANNEL TYPE                        $3IO22530
       TNZ     MSEL-2              79O9 CHANNEL                        $3IO22540
*                  SELECT (-) ENTRY = POST COMPLETION                   3IO22550
       LFT     400000              IF SHORT RECORD                      3IO22560
       TRA     MXMDT               INDICATION IS ON                     3IO22570
DCHG   CAL     S3                  CODE NOT = 4,5, OR 6                 3IO22580
       SUB     L(1)                THEN SETUP TO EXIT                   3IO22590
       STA     S3                  AT 2,4                               3IO22600
       CLA     1,4                 IF READING                           3IO22610
       TPL     S3                  DISCARD NOISE RECORD                 3IO22620
MXMDT  CLA     1,2                 IF MIXED MODE                        3IO22630
       TMI     MXMOD               PERFORM EXTRA CALCULATIONS           3IO22640
SELM1  CLA*    (URRXI              IF ANY TAPE                          3IO22650
       TZE     *+3                 ERRORS OCCURRED                      3IO22660
       ACL     5,2                 ADJUST ERROR                         3IO22670
       SLW     5,2                 COUNTS                               3IO22680
       TSX     URC1,1              UPDATE REQUEST CHAIN                 3IO22690
       NZT     CHATY                                                   $3IO22700
       TRA     HSEL1               729 OR CARD UNIT                    $3IO22710
       CLA     1,4                                                     $3IO22720
       TZE     *+4                 NO REQUEST CHAIN                    $3IO22730
       PXD     0,0                 PREFIX FOR REINSTRUCT               $3IO22740
       LNT     200000              OR IF EOF                           $3IO22750
       TRA     HSEL1                                                   $3IO22760
       STA     0,4                 ZERO FCB FROM UCW1                  $3IO22770
       CAL     S3                  RESTORE                             $3IO22780
       ADD     L(1)                ADDRESS                             $3IO22790
       STA     S3                  FOR RETURN                          $3IO22800
       BES     *-11+NOHYP/NOHYP*11-*                                   $3IO22810
HSEL1  LDC     COMM,1              RESTORE TO                          $3IO22820
       TQP     POSTR               IF MQ + READ IS DONE                 3IO22830
       SPACE   1                                                        3IO22840
*                        POST WRITE COMPLETION                          3IO22850
SELM3  CLA     4,2                 -L(POOL) TO IR4                     $3IO22860
       PDC     0,4                                                      3IO22870
       CAL     1,4                 RESTORE BUFFER                       3IO22880
       ARS     4                   SIZE TO IORT                         3IO22890
       STD     -1,1                TO IORT                              3IO22900
       TSX     BTP1,1              PLACE BUF IN POOL                    3IO22910
       LNT     200000              DID EOT OCCUR                        3IO22920
       TRA     S3                  RESTORE IR4 AND BACK TO IOEX         3IO22930
*                        EOT HANDLE TRAP WRITE                          3IO22940
       AXC     1,4                                                      3IO22950
       CLA*    0,2                                                      3IO22960
       TZE     *+2                                                      3IO22970
       STA     4,2                                                      3IO22980
       CAL     EOTBT                                                   $3IO22990
*                         INHIBIT BITS TO FILE                          3IO23000
INEX   STZ*    0,2                 SET PRIORITY EQUAL TO ZERO          $3IO23010
       SXD     INEX2,2        FILE BLOCK ADDRESS                       $3IO23020
       LXA     FCW,1                                                    3IO23030
INEX2  TXI     *+1,1,**                                                 3IO23040
       TXH     INEX4,1,0                                                3IO23050
       ANS     (IOXSI                                                   3IO23060
INEX4  ANS     1,2                                                      3IO23070
       TRA     S3                                                       3IO23080
       SPACE   1                                                        3IO23090
*                         POST READ COMPLETION                          3IO23100
POSTR  CAL     COMM                                                     3IO23110
       STA     -1,1                ADDRESS+1 OF LAST WD READ IN IORT   $3IO23120
       PIA                                                              3IO23130
       STP     -2,1                SAVE COND OF LAST RECORD IN BCW     $3IO23140
       CLA*    4,2                 DOES SYNC CHAIN EXIST                3IO23150
       TZE     PSTR8               NO                                   3IO23160
       PDC     0,1                 SAVE L(END)                          3IO23170
       XCA                         L(BUF) TO AC                         3IO23180
       STA     0,1                 UPDATE                               3IO23190
       LDQ     L(0)D               SYNC CHAIN                           3IO23200
       LGL     18                                                       3IO23210
       STA*    0,1                                                     $3IO23220
PSTR3  STD*    4,2                 L(BUFF) TO BUFF CW                  $3IO23230
       LNT     200000         IF NO EOF                                $3IO23240
       TRA     S3                  THEN EXIT                            3IO23250
       SPACE   1                                                        3IO23260
*                        EOF HANDLER TRAP INPUT                         3IO23270
       SXA     PSTR5,4             SAVE L(UCW)                          3IO23280
       LXA     CHATY,1                                                 $3IO23290
       TXH     DEOF1,1,8192                                            $3IO23300
       LDQ     LTPOS               SAVE TAPE POSITION                   3IO23310
       STQ*    COMM                JUST PRIOR TO EOF MARK               3IO23320
PSTR4  NZT     1,4                 IF LAST BUFFER                       3IO23330
       TRA     PSTR6               DO NOTHING                           3IO23340
PSTR2  TSX     URC1,1              DELETE AHEAD                        $3IO23350
       CLA     4,2                 L(POOL) TO IR4                       3IO23360
       PDC     0,4                                                      3IO23370
       TSX     TOPOOL,1            BUFFERS                              3IO23380
PSTR5  AXT     **,4                RESTORE L(UCW)                       3IO23390
       TRA     PSTR4               DELETE ALL                           3IO23400
PSTR6  AXC     1,4                 SET UP REFERENCE TO 2ND              3IO23410
       CAL     NOTIN               WD UCW AND                          $3IO23420
       TRA     INEX                GO INHIBIT FILE                      3IO23430
       SPACE   1                                                        3IO23440
*                           START SYNC CHAIN                            3IO23450
PSTR8  XCA                         PUT BUF READ IN AC                  $3IO23460
       STA     4,2                                                      3IO23470
       LDQ     L(0)D                                                    3IO23480
       LGL     18                                                       3IO23490
       STA*    4,2                 L(1) IN BUF CW                      $3IO23500
       TRA     PSTR3                                                    3IO23510
       TTL     SELECT (+) ENTRY                                         3IO23520
*                      SIGN OF UCW WD2 0-RD 1-WR                        3IO23530
*                        INSERTS *+1 INTO IORT                          3IO23540
*                 INSERTS BLOCK SEQ NUMBER IF DESIRED                   3IO23550
*                   AND INCREMENTS IT IN FILE WORDS                     3IO23560
       SPACE   1                                                        3IO23570
SELP   LDI     1,2                 FILE BITS TO SI                      3IO23580
       CLA     CHATY                                                   $3IO23590
       LBT                         UNIT TYPE TEST                      $3IO23600
       TNZ     HYPL                HYPER                               $3IO23610
       TNZ     DRWRS               DISK                                $3IO23620
       LFT     MXDMD               IF MIXED MODE                       $3IO23630
       TRA     MXMP                SKIP OUT                             3IO23640
       CLA     1,4                 GET ADDRESS OF                       3IO23650
       ACL     L(1)                THE IORT TO BE USED                  3IO23660
       STA*    (RCHXI                                                   3IO23670
       STA     S1+3                                                    $3IO23680
       TPL     S1             THIS IS READ                             $3IO23690
S4     ZET*    (URRXI              ERROR ON THIS BLOCK                 $3IO23700
       TRA     S1                  YES START ACTIVITY                   3IO23710
       STA     S0                  NO                                   3IO23720
       XCA                         SAVE ADDRESS OF IORT                $3IO23730
       CLA     3,2                 GET BLOCK SEQ                        3IO23740
       ACL     1DEC                UP BY ONE                            3IO23750
       STD     3,2                                                      3IO23760
       LNT     BLKSEQ              CHECK FOR BLOCK SEQING               3IO23770
       TRA     S1-1                NO                                   3IO23780
       ARS     18                  YES                                  3IO23790
S0     STA*    **                  STORE BLOCK SEQ IN LAST WORD OF BUFF 3IO23800
       XCA                         ADDRESS OF IORT IN MQ                3IO23810
S1     ACL     L(1)                                                     3IO23820
       ZET     CHATY                                                   $3IO23830
       TRA     HYSA                                                    $3IO23840
       STA     **                  PUT ADDRESS OF IORT + 1 IN IORT      3IO23850
       CLA     1,2                 FORM SELECT                          3IO23860
       ANA     MODBT               INSERTING TAPE MODE BIT              3IO23870
       TNZ     *+2                                                      3IO23871
       STZ     SYSJOB+2                                                 3IO23872
       ARS     7                                                        3IO23880
       ORA     0,4                                                      3IO23890
RWRS   ARS     18                                                       3IO23900
       STA     SELCT               UNIT ADDRESS TO SELECT               3IO23910
       CLA     S2                                                       3IO23920
       LDQ     1,4                                                      3IO23930
       TQP     *+2                 RDS IN SELECT                        3IO23940
       ALS     15                  WRS IN SELECT                        3IO23950
       STD     SELCT                                                    3IO23960
       ZET*    SYSJOB+1                                                 3IO23961
SELCT  RDS     **                  SEL                                  3IO23970
       XEC*    (RCHXI              RCHX                                 3IO23980
S3     AXT     **,4                                                     3IO23990
       AXT     **,1                                                     3IO24000
       TRA     1,4                 RETURN TO IOEX                       3IO24010
S2     OCT     076200766000        RDS...WRS                            3IO24020
       TTL     7909 CHANNEL SELECT ROUTINES                             3IO24030
       LBT                         DISK                                $3IO24040
       TRA     HSELM               NO                                  $3IO24050
MSEL   LFT     7100                TEST UNUSUAL END                    $3IO24060
       TRA     DERR                                                     3IO24070
       LDI     0,2                                                     $3IO24080
       CLA*    1,4            GET FLAG WORD USED                       $3IO24090
       STA     SELM4+1             BUFFER ADDRESS FOR LATER            $3IO24100
       ADD     L(1)           FOR THIS OPERATION                       $3IO24110
       STA     *+3                                                     $3IO24120
       LFT     200000              EOF FROM LAST READ                  $3IO24130
       TRA     SEOFI               YES                                 $3IO24140
       LDI     **             PUT FLAG WORD IN INDICATORS              $3IO24150
       LNT     400000              IS RECORD COMPLETE                  $3IO24160
       TRA     FINREC         NO-FINISH RECORD                         $3IO24170
       LFT     200000         EOF OCCUR                                $3IO24180
SEOF   TRA     SEOH                YES - HANDLE STRANGE EOF            $3IO24190
       LDI     FOR            SET INDICATORS AS 7607                   $3IO24200
SELM2  CLA     1,2                 IF MIXED MODE                       $3IO24210
       TMI     1KA                 PERFORM EXTRA CALC.                 $3IO24220
       CLA*    (URRXI              IF ERRORS ADJUST                    $3IO24230
       TZE     *+3            ERROR COUNTS IN FCB                      $3IO24240
       ACL     5,2                                                     $3IO24250
       SLW     5,2                                                     $3IO24260
       CAL     1,4                                                     $3IO24270
       SUB     L(1)                                                    $3IO24280
       SXA     *+3,4          SAVE IR4                                 $3IO24290
       PAC     0,4            IR4=-L(COMM-1)                           $3IO24300
       TSX     URC1+1,1       UPDATE REQUEST CHAIN                     $3IO24310
SELM5  AXT     **,4                RESTORE IR4                         $3IO24320
       TSX     CKSEE,1             UPDATE SEEK ADDRESS                 $3IO24330
       CLA     1,4                 PUT ADDRESS OF                      $3IO24340
       PAC     0,1                 COMD CHAIN IN IR 1                  $3IO24350
       SXA     ER,1                SAVE ADDRESS OF COMD CHAIN          $3IO24360
       STZ     1,1                 ZERO OUT COUNT SAVED                $3IO24370
       CAL     8,1                                                     $3IO24380
       ACL     L(1)                                                    $3IO24390
       PAC     0,1           ITR1=-L(1ST WORD IN BUF)                  $3IO24400
       CAL     FCW                 RESTORE IORT                        $3IO24410
       STP     -1,1                IN BUFFER                           $3IO24420
       LDQ     1,4                                                     $3IO24430
       NZT*    1,4                 IF ZERO-ZERO OUT                    $3IO24440
       TRA     *+4                 AND KILL SEEK                       $3IO24450
       LFT     200000              IF EOF                              $3IO24460
       TRA     *+3                 KILL SEEK OR                        $3IO24470
       TRA     *+4                 ELSE PROCEED                        $3IO24480
       STZ     1,4                                                     $3IO24490
       CAL     2,4                                                     $3IO24500
       STO     2,4                                                     $3IO24510
       TQP     SELM4               IF MQ + READ IS DONE                $3IO24520
       LDQ     SELM4+1             PUT BUFF ADDRESS IN MQ              $3IO24530
       TRA     SELM3               GO POST WRITE COMPLETION            $3IO24540
SELM4  CAL     *+1                                                     $3IO24550
       XCA     **                  MQ = ADDRESS OF BUF CW              $3IO24560
       SXA     C8,1                                                    $3IO24570
       CAL     -1,1                PICK UP COUNT FROM FLAG             $3IO24580
 ER    AXT     **,1                                                    $3IO24590
       ADM     9,1                 NEXT AVAIL WORD IN BUFFER           $3IO24600
C8     AXT     **,1           IR1=L(1ST WD IN BUF)                     $3IO24610
       STA     -1,1                ADDRESS +1 OF LAST WD. READ IN IORT $3IO24620
       LFT     200000              IF EOF GO                           $3IO24630
       TSX     EOF,4               TAKE CARE OF IT                     $3IO24640
       CLA     4,2                 PICK UP AND                         $3IO24650
       PDC     0,4                 RESTORE THE                         $3IO24660
       CAL     1,4                 BUFFER SIZE                         $3IO24670
       ARS     4                   IN THE IORT                         $3IO24680
       STD     -1,1                NOW GO POST                         $3IO24690
       XEC     SELM5               READ COMPLETION                     $3IO24700
       TRA     POSTR+2             SOME JOB                            $3IO24710
EOF    ENB     L(0)                                                    $3IO24720
       LDQ     0,2                 EXCHANGE START AND                  $3IO24730
       CAL     6,2                 FINISH OF FILE                      $3IO24740
       LGL     18                  PUT A MINUS                         $3IO24750
       STD     0,2                 IN WORD SEVEN                       $3IO24760
       STA     6,2                 TO INDICATE SPECIAL                 $3IO24770
       CLS     6,2                 HANDLING NEEDED                     $3IO24780
       STO     6,2                 FOR NEXT DATA OPER.                 $3IO24790
       LDQ     SELM4+1             RESTORE ADDRESS OF BUF IN MQ        $3IO24800
       TRA     1,4                 GO HOME                             $3IO24810
DEOF1  NZT     1,4            IF LAST BUFFER                           $3IO24820
       TRA     PSTR6          DO NOTHING                               $3IO24830
       CAL*    1,4                 DISK OPERATIONS                     $3IO24840
       STZ*    1,4                 ARE DONE FOR NOW                    $3IO24850
       STA     1,4                 RESTORE REQUEST CHAIN               $3IO24860
       TRA     PSTR2               AS TAPE (UCB2)                      $3IO24870
FINREC LFT     200000              IOCS EOF                            $3IO24880
       TRA     DEOF                YES                                 $3IO24890
       CLA     1,4                                                     $3IO24900
       PAC     0,1            -L(COMMANDS)IN IR1                       $3IO24910
       CLA     L(STL               IF READ HAS FILLED                  $3IO24920
       ERA     1,1                 BUFFER AREA,GO BACK                 $3IO24930
       TNZ     *+3                 AS FINISHED RECORD                  $3IO24940
       LXA     S3+1,1                                                  $3IO24950
       TRA     SEOF+1                                                  $3IO24960
       CLA     1,1            PICK UP AND COUNT                        $3IO24970
       SXA     *+2,2                                                   $3IO24980
       TSX     SIZE,2         COUNT FOR DISK OPERATION                 $3IO24990
D7     AXT     **,2                RESTORE IR2                         $3IO25000
       CLA     1,4            READ OR WRITE                            $3IO25010
       TPL     D4                  READ                                $3IO25020
       CAL     6,2                 UPDATE NEXT TRACK                   $3IO25030
       ACL     L(2)                TO BE USED BY FILE                  $3IO25040
       ALS     18                  STORE IN FLAG WORD                  $3IO25050
       STD*    8,1                                                     $3IO25060
 D4    CAL     9,1                 PUT THE NEXT READ                    3IO25070
       LXA     SVCOD,2      DEVICE CODE TO IR2                       (3)3IO25080
       ADD     L(STL,2      FOR PROPER TRACKSIZE                     (3)3IO25081
       LXA     D7,2         RESTORE                                  (3)3IO25082
       STA     9,1            COMMAND                                  $3IO25090
       SXA     *+2,1                                                   $3IO25100
       TSX     CKSEE,1        IS SEEK NECESSARY                        $3IO25110
       AXT     **,1           RESTORE IR1                              $3IO25120
       CLA     6,2            CREATE BCD CHARACTERS                    $3IO25130
       SXA     *+2,4          FOR THE NEXT PREPARE                     $3IO25140
       TSX     (DECVA,4       TO VERIFY COMMAND                        $3IO25150
       AXT     **,4                                                    $3IO25160
       CLA     6,2            GET REC LAB                              $3IO25170
       ADD     TRKC                UP TRACK COUNT                      $3IO25180
       SLW     6,2                 FOR RECORD                          $3IO25190
       ARS     6                   AND PUT IN                          $3IO25200
       STO     *+2            P.V. WORD                                $3IO25210
       TSX     (FDAMT,2                                                $3IO25220
       PZE                                                             $3IO25230
       PZE     15,1                                                    $3IO25240
       XEC     D7                                                      $3IO25250
       TSX     WCHK,4                                                  $3IO25260
       TRA     S3             RETURN TO IOEX                           $3IO25270
DERR   LNT     100                     INTERFACT CHECK                  3IO25280
       TRA     *+4                 NO                                  $3IO25290
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3IO25300
       SXA     CHATT-1,4           RETURN 2,4                          $3IO25310
       TRA     DCHG                                                    $3IO25320
       CLA     1,4                 GET COMMAND LIST ADDRESS            $3IO25330
       PAC     0,1                 FOR STZ OPERATION                   $3IO25340
       STO     .DERR                   SET UNUSUAL END FLAG             3IO25350
       STZ     1,4                 ZERO OUT REQUEST                    $3IO25360
       CLA     4,2                 GET BUFFER POOL                     $3IO25370
       PDC     0,4                 AND PLACE IT IN IR4                 $3IO25380
       CLA     0,1                 GET BUFFER IN USE                   $3IO25390
       STZ     ,1                  ZERO OUT COMMAND LIST               $3IO25400
       STZ     1,1                 CONTROL WORDS                       $3IO25410
DERG   PAC     0,1                 RESTORE                             $3IO25420
       STA     *-1                 IORT                                $3IO25430
       CLA     FCW                 AND                                 $3IO25440
       STP     1,1                 BUFFER                              $3IO25450
       CLA     1,4                 COUNT                               $3IO25460
       ARS     4                                                       $3IO25470
       STD     1,1                                                     $3IO25480
       CLA     DERG                                                    $3IO25490
       TSX     BTP2,1              PUT BUFF BACK IN POOL               $3IO25500
       TRA     S3                  GO BACK                             $3IO25510
TRKC   OCT     010000000000                                            $3IO25520
TRKRC  OCT     007777777777                                            $3IO25530
SEOH   CLA     SIX                 SET EOF BIT ON                      $3IO25540
       STP     0,2                 FOR STRANGE EOF                     $3IO25550
       TRA     SEOF+1              FINISH READ                         $3IO25560
SEOFI  RIL     200000              TURN OFF                            $3IO25570
       STI     0,2                 STRANGE EOF                         $3IO25580
DEOF   LDI     SIX                 SET IND AS TAPE EOF                 *3IO25590
       TRA     SELM2                                                   *3IO25600
       TTL     SELECT PLUS FOR 7909 CHANNEL                             3IO25610
DRWRS  CLA     1,4                                                      3IO25620
       PAX     0,1                 IF THIS IS A LIST WORD               3IO25630
       TXL     *+2,1,LCOMAD-1     FOR NOPOOL OPTION                  (6)3IO25635
       TXL     DRWRW,1,ENDLIS      DO NOT CHANGE                        3IO25640
       AXT     ENDLIS-LCOMAD,1     OTHERWISE FIND LIST WORD             3IO25650
DRWRX  CLA     ENDLIS,1            AND PUT IT UCW 2                     3IO25660
       TZE     *+3                                                      3IO25670
       TIX     *-2,1,COMADL-LCOMAD                                      3IO25680
       TRA     DER1                                                     3IO25690
       PXA     0,1                                                      3IO25700
       SUB     DRWRX                                                    3IO25710
       PAC     0,1                                                     $3IO25720
       STA     DRWRS1-2            SAVE LIST ADDRESS                   $3IO25730
       CLA     1,4                 SAVE BUFFER ADDRESS IN BOTH          3IO25740
       STA     0,1                 ADDRESS AND DECREMENT OF LIST WD. 1  3IO25750
       CLA*    1,4                 GET BUFFERS AHEAD                   $3IO25760
       STD     0,1                                                      3IO25770
       CLA     DRWRS1-2            PICK UP LIST ADDRESS AND             3IO25780
       STA     1,4                 PUT IT IN UCW 2                      3IO25790
       CLA     1,4                                                     $3IO25800
DRWRW  LXA     S3+1,1              RESTORE IR 1                         3IO25810
       ACL     L(2)                LOC. OF READ OR WRITE SELECT         3IO25820
       TPL     *+2                 READ                                $3IO25830
       ACL     L(3)                WRITE                               $3IO25840
       STA*    (RCHXI              SET START CHAN INST                 $3IO25850
       ZET*    (URRXI              FIRST TIME THRU                     $3IO25860
       TRA     C3                  NO                                  $3IO25870
       LXA     CHATT-1,1           WAS CHANNEL                         $3IO25880
       SXA     CHATT-1,0           LIST SET UP                         $3IO25890
       TXH     C3,1,0              YES                                 $3IO25900
       STA     C7                                                      $3IO25910
       CLA     1,4                 ADDRESS OF COMMD                    $3IO25920
       PAC     0,1                 LIST TO IR1                         $3IO25930
       ZET     1,1                 PARTIAL RECORD                      $3IO25940
       TRA     C3                  YES START CHANNEL                   $3IO25950
       TPL     DRWRS1              IF READ                             $3IO25960
       CAL     3,2                                                     $3IO25970
       ACL     1DEC                UP BLOCK COUNT                      $3IO25980
       STD     3,2                                                     $3IO25990
       LNT     BLKSEQ                                                  $3IO26000
       TRA     DRWRS1              NO BLOCK SEQ                        $3IO26010
       ARS     18                                                      $3IO26020
       XCA                    SAVE COUNT                               $3IO26030
       CLA*    1,4            LOC OF BUF TO BE USED                    $3IO26040
       ACL     L(1)                                                    $3IO26050
       STA     *+2                                                     $3IO26060
       XCA     **                  RESTORE COUNT                       $3IO26070
       STA*    **                  (L) OF LAST WORD OF BUF             $3IO26080
DRWRS1 CLA     L(6)                BCD MODE                            $3IO26090
       LNT     MODE                                                    $3IO26100
       CLA     L(22)               BINARY MODE                         $3IO26110
C7     STA     **                  ADDRESS OF SMS                      $3IO26120
       CLA     0,1            ADDRESS OF BUFFER                        $3IO26130
       ACL     L(1)                                                    $3IO26140
       STA     8,1            ADDRESS OF 2ND BUF WORD                  $3IO26150
       ACL     L(1)                                                    $3IO26160
       STA     9,1            ADDRESS OF 3RD BUF WORD                  $3IO26170
       CLA*    8,1            PICK UP COUNT                            $3IO26180
       ARS     18                  MOVE COUNT OVER                     $3IO26190
       ANA     ADDRS               MASK ALL BUT ADDRESS                $3IO26200
       SXA     *+2,2                                                   $3IO26210
       TSX     SIZE,2         CHECK RECORD SIZE                        $3IO26220
C9     AXT     **,2                                                    $3IO26230
       CAL     6,2                 CREATE BCD CHARACTER                $3IO26240
       ANA     TRKRC               CHANGE THE TRACK                    $3IO26250
       ADD     TRKC                COUNT TO ONE FOR RECORD             $3IO26260
       SLW     6,2                 PUT BACK TO FCB                     $3IO26270
       SXA     *+2,4          FOR PV COMMAND                           $3IO26280
       TSX     (DECVA,4                                                $3IO26290
C2     AXT     **,4                                                    $3IO26300
       CAL     6,2                 GET SEEK ADDRESS                    $3IO26310
       ADD     L(1)                                                    $3IO26320
       ALS     18                  MOVE SEEK ADDRESS OVER              $3IO26330
       STD*    8,1                 PUT NEXT SEEK IN FLAG               $3IO26340
       CAL     6,2                 LABEL FOR                           $3IO26350
       ARS     6                   RECORD ADDRESS                      $3IO26360
       STO     *+2                                                     $3IO26370
       TSX     (FDAMT,2       PLACE P.V. COMMAND                       $3IO26380
       PZE                    BITS IN PROPER PLACE                     $3IO26390
       PZE     15,1                                                    $3IO26400
       XEC     C9                  RESTORE IR2                         $3IO26410
       CLA     *-3                 SET INTERFACE BIT                   $3IO26420
       ANA     L(1)                ON FOR SMS INST.                    $3IO26430
       ORS*    C7                                                      $3IO26440
       TSX     WCHK,4         CHECK FOR WRITE CHECK                    $3IO26450
C3     XEC     S3+1                RESTORE IR1                         $3IO26460
       CAL     0,2                 IS THERE A STRANGE                  $3IO26470
       ALS     1                   EOF ON THIS FILE -                  $3IO26480
       PBT                                                             $3IO26490
       TRA     S3-1                NO                                  $3IO26500
       XEC     C2                  YES - RESTORE XR4                   $3IO26510
       CLA*    1,4                 YES                                 $3IO26520
       ACL     L(1)                GET FLAG WORD                       $3IO26530
       STA     DRWRS2              ADDRESS AND SAVE                    $3IO26540
       CAL     6,2                 GET SEEK ADDRESS                    $3IO26550
       SUB     L(1)                MINUS 1 AND STORE                   $3IO26560
       STA     3,4                 IN UCB 4 AND FCB 7                  $3IO26570
       STA     6,2                                                     $3IO26580
DRWRS2 STZ     **                  SET FLAG WORD TO ZERO               $3IO26590
       AXT     SYSTWT,2            START CHANNEL                       $3IO26600
       PXA     0,2                 FOR A                               $3IO26610
       STA*    (RCHXI              TRAP                                $3IO26620
       TRA     S3-1                GO                                  $3IO26630
       BES     MSEL+NOCH/NOCH**-NOCH/NOCH*MSEL-*                        3IO26640
LCOMAD PZE                         CHAIN TO BUFFERS                    $3IO26650
       PZE                         COUNT FOR MULTI TRACK RECORD        $3IO26660
       SMS     **                  SET MODE FOR READ                   $3IO26670
       CTLR    *+12                PREPARE DISK FOR READ               $3IO26680
       TCH     *+4                 GO DO DATA MOVEMENT                 $3IO26690
       SMS     **                  SET MODE FOR WRITE                  $3IO26700
       LCC     0                   COUNTER FOR WRITE CHECK             $3IO26710
       CTLW    *+8                 PREPARE DISK FOR WRITE              $3IO26720
       CPYP    **,,1               FLAG WORD MOVEMENT                  $3IO26730
       CPYP    **,,**              DATA MOVEMENT                       $3IO26740
       CPYD    0,,0                DISCONNECT DATA MOVEMENT            $3IO26750
       TDC     *+2                 CHECK FOR WRITE CHECK               $3IO26760
       TCH     SYSTWT              INTERUPT CPU                        $3IO26770
       CTLW    *+4                 PREPARE FOR WRITE CHECK             $3IO26780
       TCH     *-6                 GO DO WRITE CHECK                   $3IO26790
       DVTA    ,,                                                      $3IO26800
       DWRC    ,,                                                      $3IO26810
COMADL PZE                                                             $3IO26820
       PZE                                                             $3IO26830
       SMS     **                                                      $3IO26840
       CTLR    *+12                                                    $3IO26850
       TCH     *+4                                                     $3IO26860
       SMS     **                                                      $3IO26870
       LCC     0                                                       $3IO26880
       CTLW    *+8                                                     $3IO26890
       CPYP    **,,1                                                   $3IO26900
       CPYP    **,,**                                                  $3IO26910
       CPYD    0,,0                                                    $3IO26920
       TDC     *+2                                                     $3IO26930
       TCH     SYSTWT                                                  $3IO26940
       CTLW    *+4                                                     $3IO26950
       TCH     *-6                                                     $3IO26960
       DVTA    ,,                                                      $3IO26970
       DWRC    ,,                                                      $3IO26980
       PZE                                                             $3IO26990
       PZE                                                             $3IO27000
       SMS     **                                                      $3IO27010
       CTLR    *+12                                                    $3IO27020
       TCH     *+4                                                     $3IO27030
       SMS     **                                                      $3IO27040
       LCC     0                                                       $3IO27050
       CTLW    *+8                                                     $3IO27060
       CPYP    **,,1                                                   $3IO27070
       CPYP    **,,**                                                  $3IO27080
       CPYD    0,,0                                                    $3IO27090
       TDC     *+2                                                     $3IO27100
       TCH     SYSTWT                                                  $3IO27110
       CTLW    *+4                                                     $3IO27120
       TCH     *-6                                                     $3IO27130
       DVTA    ,,                                                      $3IO27140
       DWRC    ,,                                                      $3IO27150
       PZE                                                             $3IO27160
       PZE                                                             $3IO27170
       SMS     **                                                      $3IO27180
       CTLR    *+12                                                    $3IO27190
       TCH     *+4                                                     $3IO27200
       SMS     **                                                      $3IO27210
       LCC     0                                                       $3IO27220
       CTLW    *+8                                                     $3IO27230
       CPYP    **,,1                                                   $3IO27240
       CPYP    **,,**                                                  $3IO27250
       CPYD    0,,0                                                    $3IO27260
       TDC     *+2                                                     $3IO27270
       TCH     SYSTWT                                                  $3IO27280
       CTLW    *+4                                                     $3IO27290
       TCH     *-6                                                     $3IO27300
       DVTA    ,,                                                      $3IO27310
       DWRC    ,,                                                      $3IO27320
       PZE                                                             $3IO27330
       PZE                                                             $3IO27340
       SMS     **                                                      $3IO27350
       CTLR    *+12                                                    $3IO27360
       TCH     *+4                                                     $3IO27370
       SMS     **                                                      $3IO27380
       LCC     0                                                       $3IO27390
       CTLW    *+8                                                     $3IO27400
       CPYP    **,,1                                                   $3IO27410
       CPYP    **,,**                                                  $3IO27420
       CPYD    0,,0                                                    $3IO27430
       TDC     *+2                                                     $3IO27440
       TCH     SYSTWT                                                  $3IO27450
       CTLW    *+4                                                     $3IO27460
       TCH     *-6                                                     $3IO27470
       DVTA    ,,                                                      $3IO27480
       DWRC    ,,                                                      $3IO27490
       PZE                                                             $3IO27500
       PZE                                                             $3IO27510
       SMS     **                                                      $3IO27520
       CTLR    *+12                                                    $3IO27530
       TCH     *+4                                                     $3IO27540
       SMS     **                                                      $3IO27550
       LCC     0                                                       $3IO27560
       CTLW    *+8                                                     $3IO27570
       CPYP    **,,1                                                   $3IO27580
       CPYP    **,,**                                                  $3IO27590
       CPYD    0,,0                                                    $3IO27600
       TDC     *+2                                                     $3IO27610
       TCH     SYSTWT                                                  $3IO27620
       CTLW    *+4                                                     $3IO27630
       TCH     *-6                                                     $3IO27640
       DVTA    ,,                                                      $3IO27650
       DWRC    ,,                                                      $3IO27660
       PZE                                                             $3IO27670
       PZE                                                             $3IO27680
       SMS     **                                                      $3IO27690
       CTLR    *+12                                                    $3IO27700
       TCH     *+4                                                     $3IO27710
       SMS     **                                                      $3IO27720
       LCC     0                                                       $3IO27730
       CTLW    *+8                                                     $3IO27740
       CPYP    **,,1                                                   $3IO27750
       CPYP    **,,**                                                  $3IO27760
       CPYD    0,,0                                                    $3IO27770
       TDC     *+2                                                     $3IO27780
       TCH     SYSTWT                                                  $3IO27790
       CTLW    *+4                                                     $3IO27800
       TCH     *-6                                                     $3IO27810
       DVTA    ,,                                                      $3IO27820
       DWRC    ,,                                                      $3IO27830
       PZE                                                             $3IO27840
       PZE                                                             $3IO27850
       SMS     **                                                      $3IO27860
       CTLR    *+12                                                    $3IO27870
       TCH     *+4                                                     $3IO27880
       SMS     **                                                      $3IO27890
       LCC     0                                                       $3IO27900
       CTLW    *+8                                                     $3IO27910
       CPYP    **,,1                                                   $3IO27920
       CPYP    **,,**                                                  $3IO27930
       CPYD    0,,0                                                    $3IO27940
       TDC     *+2                                                     $3IO27950
       TCH     SYSTWT                                                  $3IO27960
       CTLW    *+4                                                     $3IO27970
       TCH     *-6                                                     $3IO27980
       DVTA    ,,                                                      $3IO27990
       DWRC    ,,                                                      $3IO28000
       PZE                                                             $3IO28010
       PZE                                                             $3IO28020
       SMS     **                                                      $3IO28030
       CTLR    *+12                                                    $3IO28040
       TCH     *+4                                                     $3IO28050
       SMS     **                                                      $3IO28060
       LCC     0                                                       $3IO28070
       CTLW    *+8                                                     $3IO28080
       CPYP    **,,1                                                   $3IO28090
       CPYP    **,,**                                                  $3IO28100
       CPYD    0,,0                                                    $3IO28110
       TDC     *+2                                                     $3IO28120
       TCH     SYSTWT                                                  $3IO28130
       CTLW    *+4                                                     $3IO28140
       TCH     *-6                                                     $3IO28150
       DVTA    ,,                                                      $3IO28160
       DWRC    ,,                                                      $3IO28170
       PZE                                                             $3IO28180
       PZE                                                             $3IO28190
       SMS     **                                                      $3IO28200
       CTLR    *+12                                                    $3IO28210
       TCH     *+4                                                     $3IO28220
       SMS     **                                                      $3IO28230
       LCC     0                                                       $3IO28240
       CTLW    *+8                                                     $3IO28250
       CPYP    **,,1                                                   $3IO28260
       CPYP    **,,**                                                  $3IO28270
       CPYD    0,,0                                                    $3IO28280
       TDC     *+2                                                     $3IO28290
       TCH     SYSTWT                                                  $3IO28300
       CTLW    *+4                                                     $3IO28310
       TCH     *-6                                                     $3IO28320
       DVTA    ,,                                                      $3IO28330
       DWRC    ,,                                                      $3IO28340
ENDLIS BES     LCOMAD+NOCH*19-*                                        $3IO28350
       TTL 0                                                           $3IO28360
*              THIS SETS UP FOR A WRITE CHECK                          $3IO28370
*              TSX WCHK,4                                              $3IO28380
*              RETURN                                                  $3IO28390
*                                                                      $3IO28400
WCHK   CLA     0,2                                                     $3IO28410
       TMI     *+3            WRITE CHECK NEC.                         $3IO28420
       PXA     0,0                 PUT ZERO IN LCC                     $3IO28430
       TRA     STCC                                                    $3IO28440
       CAL     15,1                PUT THE PREPARE                     $3IO28450
       ANA     L(DWRC         TO VERIFY IN THE                         $3IO28460
       ORA     LDWRC                                                   $3IO28470
       SLW     17,1                WRITE CHECK ORDER                   $3IO28480
       CLA     16,1                                                    $3IO28490
       STO     18,1                                                    $3IO28500
       CLA     L(1)                PUT ONE IN LCC                      $3IO28510
STCC   STA     6,1                                                     $3IO28520
       TRA     1,4            RETURN                                   $3IO28530
*                                                                      $3IO28540
*              TSX CKSEE,1                                             $3IO28550
*              RETURN                                                  $3IO28560
*                                                                      $3IO28570
*                                                                      $3IO28580
CKSEE  CAL     6,2            UPDATE SEEK                              $3IO28590
       ACL     L(4)                                                    $3IO28600
       ERA     7,2            ADDRESS                                  $3IO28610
       ANA     ADDRS                                                   $3IO28620
       TZE     ENTRK          NO MORE TRACKS FOR FILE                  $3IO28630
       TXH     D9,1,-TEMIND                                            $3IO28640
       CAL     6,2                                                     $3IO28650
       ADD     L(1)                                                    $3IO28660
       STA     6,2            NEXT ADDRESS FOR SEEK                    $3IO28670
       CAL     3,4                                                     $3IO28680
       ADD     L(1)                                                    $3IO28690
       STA     3,4                 UPDATE SEEK ADDRESS                 $3IO28700
       ERA     6,2                 SAME ARM POSITION                   $3IO28710
       ANA     ADDRS               AS DESIRED                          $3IO28720
       TZE     D8                  YES                                 $3IO28730
D9     CAL     6,2                 NO, PUT DESIRED                     $3IO28740
       STA     3,4                 POSITION IN REQUEST                 $3IO28750
       TRA     D6                  AND ASK FOR SEEK                    $3IO28760
D8     CLA     3,4                 GET POSITION AND                    $3IO28770
       ANA     ADDRS          CHECK IF ANOTHER                         $3IO28780
       XCA                    SEEK NEC. NOW                            $3IO28790
       PXA     0,0                                                     $3IO28800
       DVP     L(40)                                                   $3IO28810
       TNZ     1,1            RETURN IF NO SEEK                        $3IO28820
D6     CLS     2,4            SET 3RD UCW TO                           $3IO28830
       STO     2,4            DEMAND A SEEK                            $3IO28840
       TRA     1,1                                                     $3IO28850
*                                                                      $3IO28860
*              COUNT IN ACC                                            $3IO28870
*              TSX SIZE,2                                              $3IO28880
*              RETURN                                                  $3IO28890
*                                                                      $3IO28900
 SIZE  SXA     C11,2        SAVE IR2                                 (3)3IO28910
       XCA                  SAVE COUNT                               (3)3IO28920
       CAL     0,4          UCW1                                     (3)3IO28930
       ARS     6            MOVE AND                        7=1302   (3)3IO28940
       ANA     D2+1         CLEAR OUT ALL BUT DEVICE CODE   3=7320   (3)3IO28950
       PDX     0,2          DEVICE TO IR2                   1=1301   (3)3IO28960
 SVCOD XCA     **           RESTORE COUNT IN AC. INST ADDR SAVES CODE(3)3IO28970
       TIX     *+1,2,5      IF 1302,MAKE CODE A 2                    (3)3IO28980
       SXA     *-2,2        SAVE THE CODE                            (3)3IO28990
       SUB     L(STL,2      SUB FULL TRACK FROM WORD COUNT           (3)3IO29000
       TMI     D1           LESS THAN OR                             (3)3IO29010
       TZE     D1           EQUAL TO FULL TRACK TRA TO D1            (3)3IO29020
       STA     1,1          SAVE EXTRA WORD COUNT                    (3)3IO29030
       CLA     L(STL,2      GET FULL TRACK                           (3)3IO29040
 C1    SLW*    8,1          PUT IN FLAG WORD                         (3)3IO29050
       ALS     18           PUT COUNT IN                             (3)3IO29060
       STD     9,1          COPY COMMAND                             (3)3IO29070
 C11   AXT     **,2         PREPARE TO RETURN                        (3)3IO29080
       TRA     1,2          RETURN                                   (3)3IO29090
D1     ADD     L(STL,2      GET COUNT BACK                           (3)3IO29100
       STL     1,1          MAKE FALSE COUNT                         (3)3IO29110
 D2    ORA     FOR          SET FLAG WORD FOR COMPLETE RECORD        (3)3IO29120
       TXI     C1,0,7       FINISH UP                                (3)3IO29130
 ENTRK CLA     TRKRC        SET END OF TRACK                         (3)3IO29140
       STT     6,2          INDICATION IN FCW7                       (3)3IO29150
       TRA     CKSEE+5      AND RETURN                               (3)3IO29160
       PZE     524          7320 DRUM TRACKSIZE                      (3)3IO29170
       PZE     969          1302 DISK TRACKSIZE                      (3)3IO29171
       PZE     465          1301 DISK TRACKSIZE                      (3)3IO29172
L(STL  PZE     D2           LOCATION OF STL FOR LATER COMPARE        (3)3IO29173
       BES     WCHK+NOCH/NOCH**-NOCH/NOCH*WCHK-*                        3IO29180
HBEG   SMS     **                  SET INTERFACE                       $3IO29190
       LIPT    *+1                 LEAVE INTERUPT STATUS               $3IO29200
       CTLR    *+7                 SELECT FOR READ                     $3IO29210
       TCH     *+3                 DO IO                               $3IO29220
       SMS     **                  SET INTERFACE                       $3IO29230
       CTLW    *+4                 SELECT FOR WRITE                    $3IO29240
       CPYP    **,,**              DO IO                               $3IO29250
       CPYD    0,,0                                                    $3IO29260
       TCH     SYSTWT              INTERUPT                            $3IO29270
       OCT     120600120112        HSEL AND EOS                        $3IO29280
HLIS   SMS     **                                                      $3IO29290
       LIPT    *+1                                                     $3IO29300
       CTLR    *+7                                                     $3IO29310
       TCH     *+3                                                     $3IO29320
       SMS     **                                                      $3IO29330
       CTLW    *+4                                                     $3IO29340
       CPYP    **,,**                                                  $3IO29350
       CPYD    0,,0                                                    $3IO29360
       TCH     SYSTWT                                                  $3IO29370
       OCT     120600120112                                            $3IO29380
       SMS     **                                                      $3IO29390
       LIPT    *+1                                                     $3IO29400
       CTLR    *+7                                                     $3IO29410
       TCH     *+3                                                     $3IO29420
       SMS     **                                                      $3IO29430
       CTLW    *+4                                                     $3IO29440
       CPYP    **,,**                                                  $3IO29450
       CPYD    0,,0                                                    $3IO29460
       TCH     SYSTWT                                                  $3IO29470
       OCT     120600120112                                            $3IO29480
       SMS     **                                                      $3IO29490
       LIPT    *+1                                                     $3IO29500
       CTLR    *+7                                                     $3IO29510
       TCH     *+3                                                     $3IO29520
       SMS     **                                                      $3IO29530
       CTLW    *+4                                                     $3IO29540
       CPYP    **,,**                                                  $3IO29550
       CPYD    0,,0                                                    $3IO29560
       TCH     SYSTWT                                                  $3IO29570
       OCT     120600120112                                            $3IO29580
HEND   BES     HBEG+NOHYP*10-*                                         $3IO29590
       PZE     HEND                                                    $3IO29600
       TTL     SELECT ROUTINES FOR HYPER                                3IO29610
HYPL   CLA     3,4                 IF REINSTRUCT                       $3IO29620
       TNZ     HSXA+4              POSSIBLE-TAKE OFF                   $3IO29630
       AXT     HEND-HBEG,1         FIND CH. LIST POINTER               $3IO29640
       SXA     HSXA,1              SAVE CH. LIST POINTER               $3IO29650
       CLA     HEND+3,1            IS ONE AVAILABLE FOR                $3IO29660
       ANA     DECRE               THIS CHANNEL TO USE                 $3IO29670
       TZE     HSXA-2              YES, BUT MUST ATTACH IT             $3IO29680
       ARS     18                                                      $3IO29690
       SUB     S3+1                                                    $3IO29700
       ANA     ADDRS                                                   $3IO29710
       TZE     HSXA+2              YES, IT HAS BEEN ATTACHED           $3IO29720
       TIX     HYPL+3,1,HLIS-HBEG                                      $3IO29730
       TRA     DER1                                                    $3IO29740
       LXA     S3+1,1              GET CHANNEL NO                      $3IO29750
       PXD     0,1                                                     $3IO29760
HSXA   AXT     **,1                CHANNEL LIST ADDRESS                $3IO29770
       STD     HEND+3,1            PUT CH. NO. IN 1ST TCH              $3IO29780
       PXA     0,1                 COMPUTE THE                         $3IO29790
       SUB     HEND                CHANNEL LIST                        $3IO29800
       STA     HSXA                START ADDRESS                       $3IO29810
       CLA     1,4                                                     $3IO29820
       ACL     L(1)                                                    $3IO29830
       LXA     S3+1,1                                                  $3IO29840
       TMI     S4                  OUTPUT                              $3IO29850
       STA     S0                  SAVE ADDRESS OF IORT                $3IO29860
       ACL     L(1)                PUT LOCATION OF                     $3IO29870
HYSA   LAC     HSXA,1              1ST WORD IN COPY                    $3IO29880
       STA     6,1                 ADDRESS FOR START CH.               $3IO29890
       XCA                         SAVE READ OR WRITE                  $3IO29900
       CLA*    S0                  GET NO. OF WORDS                    $3IO29910
       STD     6,1                 STORE IN COPY                        3IO29920
       RNT     400000              READ BACKWARD                        3IO29930
       TRA     *+4                 NO                                   3IO29940
       ARS     18                  PUT LAST LOCATION                    3IO29950
       ACL     S0                  OF BUFFER IN                         3IO29960
       STA     6,1                 COPY COMMAND                         3IO29970
       CLA     3,4                 IS THIS A REINSTRUCT                 3IO29980
       TZE     HNSL                NO                                   3IO29990
       CLA     HYCLN               TURN OFF THE                         3IO30000
       ORS     2,1                 CONTROL OPERATION                    3IO30010
       ORS     5,1                                                      3IO30020
       LXA     S3+1,1                                                   3IO30030
       NZT*    (URRXI              IF NO ERROR                          3IO30040
       TRA     S3-1                START CHANNEL                        3IO30050
HNSL   CAL     HSXA                SMS ADDRESS                         $3IO30060
       STA     3,4                 SAVE CH LIST IN UCW4                $3IO30070
       TQP     *+2                 READ                                 3IO30080
       ADD     L(4)                WRITE                               $3IO30090
       LXA     S3+1,1              CH. ADDRESS TO IR1                  $3IO30100
       STA*    (RCHXI              START CHANNEL ADDRESS               $3IO30110
       ZET*    (URRXI              BACK ON ERROR CONDITION             $3IO30120
       TRA     S3-1                YES, START CHANNEL                  $3IO30130
       CLA     CHATT-1             IF RETURN FROM                      $3IO30140
       ANA     ADDRS               SEL-WITH INTERFACE                  $3IO30150
       SXA     CHATT-1,0           NOT READY, THEN                     $3IO30160
       TNZ     S3-1                JUST TRY AGAIN                      $3IO30170
       LAC     HSXA,1              RESTORE IR1 TO LIST ADDRESS         $3IO30180
       CLA     0,4                 SAVE UNIT                           $3IO30190
       ANA     DEC15               NO. IN SEL ORDER                    $3IO30200
       ORA     HYSEL                                                   $3IO30210
       RFT     400000              IS THIS READ BACKWARD               $3IO30220
       ORA     L(64D)              YES, FIX SEL ORDER                  $3IO30230
       STD     9,1                                                     $3IO30240
       CLA     HYCTL               SET CONTROL                         $3IO30250
       ANS     2,1                 OPERATION ON                        $3IO30260
       ANS     5,1                                                     $3IO30270
       CLA     HSMSN               SET UP SMS COMMAND                  $3IO30280
       LNT     004000              IF OFF BCD MODE                     $3IO30290
       ORA     L(22)                                                   $3IO30300
       RFT     400000                                                  $3IO30310
       ORA     HSMSR               BACKWARD READ                       $3IO30320
       LDI     0,4                 PUT THE                             $3IO30330
       LFT     40                  INTERFACE                           $3IO30340
       ORA     L(1)                IN SMS                              $3IO30350
       STA     0,1                                                     $3IO30360
       STA     4,1                                                     $3IO30370
       LXA     S3+1,1                                                  $3IO30380
       TRA     S3-1                                                    $3IO30390
       TTL     SELECT MINUS FOR HYPER                                   3IO30400
HSELM  CLA     1,4                 UCW 2 TO AC                         $3IO30410
       ACL     L(1)                IORT ADDRESS OF BUF                 $3IO30420
       STA     HIORT                                                   $3IO30430
       ACL     L(1)                                                    $3IO30440
       LFT     7100                ERROR                               $3IO30450
       TRA     HEROR               YES                                 $3IO30460
       ALS     18                  DEC= 1ST WORD WRITTEN               $3IO30470
       STD     COMM                SAVE AS 76O7 CH.                    $3IO30480
HIORT  CLA     **                  LAST WORD WRITTEN                   $3IO30490
       STA     COMM                SAVE AS 7607 CH.                    $3IO30500
HRETN  CAL     S3                  FIX EXIT                            $3IO30510
       SUB     L(1)                FOR CONTINUED                       $3IO30520
       STA     S3                  PRIORITY ON UNIT                    $3IO30530
       CLA     1,2                 IF MIXED MODE                       $3IO30540
       TPL     SELM1               GO HANDEL IT                        $3IO30550
       STZ     3,4                 MAKE REINSTRUCT                     $3IO30560
       TRA     MXMOD+3             IMPOSSIBLE                          $3IO30570
HSMRD  LDI     FOR                 GOOD READ                           $3IO30580
       LDQ     COMM                MAKE COMM LOOK                      $3IO30590
       LGL     18                  LIKE 7607 CHANNEL                   $3IO30600
       SLW     COMM                                                    $3IO30610
       ANA     ADDRS                                                   $3IO30620
       LDQ     1,4                                                     $3IO30630
       RQL     1                   TYPE READ                           $3IO30640
       TQP     HREAD               READ FORWARD                        $3IO30650
       LNT     200000              END OF FILE TEST                    $3IO30660
       TNZ     *+2                 IF LONG LENGTH RECORD               $3IO30670
       CAL     HIORT               MAKE IT POINT AT 1ST WORD           $3IO30680
       ACL     L(1)                ELSE IT POINTS AT LAST              $3IO30690
       STA     COMM                WORD READ                           $3IO30700
HREAD  TNZ     HRETN                                                   $3IO30710
       CAL     COMM                MAKE IT POINT AT                    $3IO30720
       ADD*    HIORT               LAST REC IN BUFF+1                  $3IO30730
       ARS     18                  IF LONG RECORD READ                 $3IO30740
       TRA     HREAD-1                                                 $3IO30750
HEROR  RFT     377777              NCI INTERRUPT                       $3IO30760
       TRA     *+2                 NO                                  $3IO30770
       TRA     HSMRD               YES                                 $3IO30780
       LNT     100                 INTERFACE CHECK                     $3IO30790
       TRA     *+4                 NO                                  $3IO30800
       AXC     *+1,4               SET SWITCH FOR SEL+                 $3IO30810
       SXA     CHATT-1,4           RETURN 2,4                          $3IO30820
       TRA     DCHG                                                    $3IO30830
       RFT     020014                                                  $3IO30840
       TRA     HYSEL+1             EOT, EOF, BOT                       $3IO30850
       LDI     1,4                                                     $3IO30860
       LFT     400000                                                  $3IO30870
       TRA     *+3                 WRITE ERROR                         $3IO30880
       LDI     1PRE                READ ERROR                          $3IO30890
       TRA     HSMRD+1             GO POST                             $3IO30900
       CAL     S3                                                      $3IO30910
       SUB     L(2)                CHANGE EXIT                         $3IO30920
       STO     S3                  TO 3,4                              $3IO30930
       CLA*    (URRXI              UPDATE ERROR                        $3IO30940
       ACL     5,2                                                     $3IO30950
       SLW     5,2                 HISTORY AND TRY                     $3IO30960
       TRA     S3                  TO WRITE AGAIN                      $3IO30970
HSMSR  OCT     000000000040        CONSTANTS                           $3IO30980
HSMSN  OCT     000000000106        FOR                                 $3IO30990
HYCTL  OCT     757777777777        HYPER                               $3IO31000
HYCLN  OCT     020000000000        SELECT                              $3IO31010
HYSEL  OCT     120600120112                                            $3IO31020
       LDI     SIX                                                     $3IO31030
       STZ     3,4                 NO RE-INSTRUCT POSSIBLE              3IO31040
       TPL     HSMRD+1             READ EOF                            $3IO31050
       TRA     HIORT-2             WRITE EOT                           $3IO31060
       BES     HBEG+NOHYP/NOHYP**-NOHYP/NOHYP*HBEG-*                   $3IO31070
DER1   STL     .DERR                                                    3IO31080
       STZ     1,4                 ZERO OUT UCW2                       $3IO31090
       TRA     DCHG                RETURN 2,4                          $3IO31100
       BES     *-3+NOCHX/NOCHX*3-*                                      3IO31110
       TTL                         BTP (BUFFER TO POOL) ROUTINE         3IO31120
*              TSX BTP,1                                                3IO31130
       SPACE   1                                                        3IO31140
*      L(BUF) IN AC IR4 = -L(POOL) TSX BTP2,1                           3IO31150
*              MQ                  TSX BTP1,1                           3IO31160
       SPACE   1                                                        3IO31170
BTP1   XCA                         L(BUF. IN USE IN AC                 $3IO31180
BTP2   LDQ     0,4                 MQ= AVAIL  CHAIN                    $3IO31190
       STA     0,4                 PUT BUF IN USE BACK                 $3IO31200
       XCA                         BUF FROM CHAIN IN AC                $3IO31210
       STZ*    0,4                 ZERO IN BUF CW                      $3IO31220
       STA*    0,4                 ADDRESS OF CHAIN                    $3IO31230
       TRA     1,1                                                      3IO31240
       SPACE   1                                                        3IO31250
*                      URC (UPDATE REQUEST CHAIN)                       3IO31260
*                       IR4 = -L(UCW) TSX URC1,1                        3IO31270
       SPACE   1                                                        3IO31280
URC1   LDQ     1,4                 2ND WORD OF UCB IN MQ               $3IO31290
       CLA*    1,4                 CHAIN 1ST WORD OF BCW               $3IO31300
       STA     1,4                 PUT AD OF NEXT BUF IN UCB 2         $3IO31310
       NZT*    1,4                 LOC OF ZERO                         $3IO31320
       TRA     *+3                                                      3IO31330
       STD*    1,4                 NO, NEXT BUF IN CHAIN IN UCW 2      $3IO31340
       TRA     1,1                                                      3IO31350
       STZ     1,4                 SET PRIORITY EQUAL TO ZERO          $3IO31360
       TRA     1,1                                                      3IO31370
       TTL     NON-DATA OPERATION CHECK FOR DISK                        3IO31380
*                                                                       3IO31390
D7909  AXT     **,4                                                    *3IO31400
       TRA     (NDSLX                                                $5$3IO31401
SVDID  PZE     **                                                      *3IO31410
       SXA     D7909,4                                                 *3IO31420
       CLA     1,4                                                   $5$3IO31421
       PDX     0,4                                                   $5$3IO31422
       CLA     5,2                                                     *3IO31430
       TMI     7KA                 1301                                *3IO31440
       ANA     SIX                                                     *3IO31450
       TZE     D7909                                                 $5$3IO31460
 HNDS  TXL     HND2,4,2                                              $5$3IO31490
       TXH     HND1,4,7            CONVERT 729 NDS CODE TO             *3IO31500
       TXI     *+1,4,27            7340 NDS CODE FOR THE               *3IO31510
       TNX     *+4,4,31            FOLLOWING ORDERS                    *3IO31520
       TXI     *+1,4,33            RWD,RUN                             *3IO31530
       TNX     *+2,4,35            BSR,BSF                             *3IO31540
       TXI     *+1,4,32            WTM                                 *3IO31550
HND1   SXD     *+2,4                                                   *3IO31560
       TSX     (NDSLX,4                                                *3IO31570
       PZE     0,2,**                                                  *3IO31580
HND2   LXA     D7909,4                                                 *3IO31590
       TRA     2,4                                                     *3IO31600
       BES     HNDS+NOHYP/NOHYP**-NOHYP/NOHYP*HNDS-*                    3IO31610
  7KA  TXL     DNDSEL+1,4,2                                          $5$3IO31611
       STI     SVDID                                                 $5$3IO31620
       STZ     TEMP                                                     3IO31630
       LDQ     6,2                 CHECK FOR EOF                      *$3IO31640
       TQP     7KAA          NO                                      $5$3IO31650
       STL     TEMP                                                     3IO31660
       SXA     *+2,4                                                 $5$3IO31661
       TSX     EOF,4               YES                                 $3IO31670
       AXT     **,4                                                  $5$3IO31680
 7KAA  ENB     TRAPS                                                 $5$3IO31690
       TXL     DBSF2+1,4,4         REW OR RUN 3 OR 4                   $3IO31730
       TXH     DWEF,4,5            BSF-6 WEF-7                         $3IO31740
       LDQ     6,2                 GET CURRENT POSITION FOR BSR - 5    $3IO31750
       ZET     TEMP                                                     3IO31760
       TRA     7KB                                                      3IO31770
       CAL     7,2                 GET BOT. AND                         3IO31780
       ARS     18                  TEST IF POSITION                    $3IO31790
       SBM     6,2                 NOW, IS SAME                        $3IO31800
       ANA     ADDRS               IF SO                               $3IO31810
       TZE     DNDSEL              NO BACKSPACE - NOP                  $3IO31820
7KB    PXA     0,0                 NO. OF TRACKS IN RECORD              3IO31830
       LLS     5                   DEDUCT TRACKS                       $3IO31850
       SUB     6,2                 AND PUT IT BACK                     $3IO31860
       STA     6,2                 FOR NEXT SEEK                       $3IO31870
DNDSEL XEC     DIND                PLACE BACK AND                      $3IO31880
       LXA     D7909,4             RETURN                              $3IO31890
       TRA     2,4                                                     $3IO31900
DNDNOP LXA     D7909,4                                                 $3IO31910
DIND   LDI     SVDID                                                  *$3IO31920
       TRA     SEL9                                                     3IO31930
NDSEL  EQU     SVDID                                                   $3IO31940
DWEF   SXA     DWEF1,4                                                 $3IO31950
       SXA     DWEF1+1,1                                               $3IO31960
       TXL     DBSF,4,6            BSF                                 $3IO31970
DBSF1  AXC     1,4                                                     $3IO31980
       CLA*    0,2                 GET 2ND WORD OF UCB                 $3IO31990
       TNZ     *-1                 WAIT FOR LAST WRITE                 $3IO32000
       ENB     L(0)                                                    $3IO32010
       CLA     6,2                                                     $3IO32020
       ANA     DECRE                                                   $3IO32030
       ARS     6                                                       $3IO32040
       STO     DSMSB                                                   $3IO32050
       SXA     DWEF6,2                                                 $3IO32060
       CLA     1,2                 TEST MODE                           $3IO32070
       ANA     MODBT                                                    3IO32080
       TZE     *+3                 BCD MODE                             3IO32090
       CLA     L(6)                BINARY MODE                          3IO32100
       TRA     *+2                                                      3IO32110
       CLA     L(22)                                                    3IO32120
       ORS     DSMSB                                                    3IO32130
       CLA     0,2                 GET UCB ADDRESS                     $3IO32140
       STA     DAXC                                                    $3IO32150
       CLA     6,2                                                     $3IO32160
       TSX     (DECVA,4                                                $3IO32170
DAXC   AXC     **,4                'L(UCB)                             $3IO32180
       CLS     2,4                 REQUEST SEEK                        $3IO32190
       STO     2,4                 WITH MINUS SIGN                     $3IO32200
       CLA     6,2                 AND CORRECT                         $3IO32210
       STA     3,4                                                     $3IO32220
       TSX     (FDAMT,2            IOEX ROUTINE TO SET ORDER           $3IO32230
DSMSB  BCI     1,00I006                                                $3IO32240
       PZE     DVTA                                                    $3IO32250
DWEF6  AXT     **,2                L(FCB)                              $3IO32260
       STL     DWAIT               MAKE WAIT CELL NONZERO              $3IO32270
       AXT     DISUE,1             SET ADDRESS OFSELECT ROUTINE IN     $3IO32280
       PXD     0,1                                                     $3IO32290
       STD     1,4                 SECOND WORD OF UCB                  $3IO32300
       TSX     (ACTVX,4            ACTIVATE CHAIN OF CHANNEL COMMANDS  $3IO32310
       MZE     0,2                                                     $3IO32320
       ZET     DWAIT               WAIT FOR SELECT MINUS                3IO32330
       TRA     *-1                 TO FINISH                           $3IO32340
       XEC     DWEF1                                                   $3IO32350
       TXL     DBSF3,4,6           FINISH BACKSPACE FILE               $3IO32360
       CAL     6,2                 SET UP SEEK                         $3IO32370
       ACL     L(1)                AND FILE START                      $3IO32380
       STA     6,2                 ADDRESS FOR                         $3IO32390
       TSX     EOF,4               BACKSPACE FILE                      $3IO32400
       ENB     TRAPS                                                   $3IO32410
DWEF1  AXT     **,4                AT LAST                             $3IO32420
       AXT     **,1                                                    $3IO32430
DBSF2  TRA     DNDSEL              WRITE EOF IS DONE                   $3IO32440
       CAL     7,2                 GET BOT ADDRESS                     $3IO32450
       STD     0,2                 AND PUT IN BOTH                     $3IO32460
       ARS     18                  WORD ONE AND SEVEN                  $3IO32470
       STA     6,2                                                     $3IO32480
       TXL     DNDSEL,4,3                                              $3IO32490
       PXA     0,0                                                     $3IO32500
       STA     0,2                 ZERO OUT UCB                        $3IO32510
       XEC     DIND                RESTORE INDICATORS                  $3IO32520
       SIR     REWNUN              NO MESSAGE TO BE PRINTED.           $3IO32530
       TRA     DNDSEL+1            RETURN                              $3IO32540
DWAIT  PZE                                                             $3IO32550
DVTA   DVTA    ,,                                                      $3IO32560
DBSF   LDI     6,2                 1ST TIME AROUND                     $3IO32570
       CLA     7,2                                                     $3IO32580
       STD     *+3                 IF AT                               $3IO32590
       CLA     0,2                 BOT DO NOT                          $3IO32600
       PDC     0,1                 DO THE                              $3IO32610
       TXI     *+1,1,**            BACKSPACE                           $3IO32620
       TXL     DNDNOP,1,0          FILE                                $3IO32630
       LFT     600000                                                  $3IO32640
       TRA     DBSF4               NOT 1ST TIME                        $3IO32650
       CLA     0,2                 EXCHANGE SEEK POINTER               $3IO32660
DBSF6  ARS     18                  TO BE BEGINNING                     $3IO32670
       STA     6,2                 OF THE FILE                         $3IO32680
       CAL     SIX                 PUT NOT FIRST                       $3IO32690
       STP     6,2                 TIME THRU FLAG ON                   $3IO32700
       LXA     DWEF1+1,1                                               $3IO32710
       TIX     DBSF,1,1            THERE IS ANOTHER TO DO -            $3IO32720
       TRA     DNDNOP              EXIT                                $3IO32730
DBSF4  LFT     200000                                                  $3IO32740
       TRA     DBSF5               NOT FIRST TIME THRU                 $3IO32750
       PIA     **                  PUT SEEK ADDRESS                    $3IO32760
       ALS     18                  AND BEGINNING OF                    $3IO32770
       STD     0,2                 FILE EQUAL                          $3IO32780
       TRA     DBSF6+2             EXIT                                $3IO32790
DBSF5  AXT     DCTL1,4             SET START CHANNEL                   $3IO32800
       SXA     DSELP+2,4           FOR BACKSPACE                       $3IO32810
       PIA                                                             $3IO32820
       SUB     L(1)                MAKE SEEK ADDRESS                   $3IO32830
       STA     6,2                 EOF ADDRESS                         $3IO32840
       TRA     DBSF1               GET FLAG FOR EOF                    $3IO32850
DBSF3  AXT     DCTL,4              RESTORE START                       $3IO32860
       SXA     DSELP+2,4           CHANNEL FOR EOF                     $3IO32870
       CAL     DFLAG               GET NEW B.O.F.                      $3IO32880
       STD     0,2                 AND PUT IT IN THE                   $3IO32890
       TRA     DBSF6               1ST WORD OF FCB, EXIT               $3IO32900
*                                                                      $3IO32910
DISUE  ACL     L(1)                GET ADDRESS OF                      $3IO32920
       STA     DSELM1              UCB + 1                             $3IO32930
       LXA     DWEF6,2             -L (FILE) IN IR2                    $3IO32940
       TPL     DSELP                                                   $3IO32950
       STZ     DWAIT                                                   $3IO32960
DSELM1 STZ     **                                                      $3IO32970
       TRA     1,4                 RETURN                              $3IO32980
DSELP  CAL     0,2                 PUT FILE                            $3IO32990
       STD     DFLAG               START POINT IN FLAG                 $3IO33000
       AXT     DCTL,2              COMM. LIST                          $3IO33010
       PXA     0,2                                                     $3IO33020
       STA*    (RCHXI                                                  $3IO33030
       XEC*    (RCHXI              SEL+ START CHANNEL                  $3IO33040
       TRA     1,4                 EOF LOCATION                        $3IO33050
*              7909 CHANNEL PROGRAM                                    $3IO33060
*                                                                      $3IO33070
DCTL   SMS*    DSMSB               SELECT INTERFACE NUMBER              3IO33080
       CTLW    DVTA                                                    $3IO33090
       CPYD    DFLAG,,1                                                $3IO33100
       TCH     SYSTWT                                                  $3IO33110
DCTL1  SMS*    DSMSB               CHANNEL ROUTINE                     $3IO33120
       CTLR    DVTA                FOR BACK SPACE                      $3IO33130
       TCH     DCTL+2              FILE ROUTINE                        $3IO33140
DFLAG  PTW                         EOF FLAG WORD                       $3IO33150
       BES     7KA+NOCH/NOCH**-NOCH/NOCH*7KA-*                          3IO33160
       TTL                         BSR (BACKSPACE RECORD) ROUTINE       3IO33170
*      TSX     BSR,4                                                    3IO33180
*      PZE     FILE,,BOFEX         BOFEX= BEGINNING OF FILE EXIT        3IO33190
       SPACE   1                                                        3IO33200
*      ACTIONS                                                          3IO33210
*             1. UNBUFFERS FILE                                         3IO33220
*             2. IF TAPE HAS BEEN BACKED OVER FILE MARK - BOF EXIT      3IO33230
*             3. ELSE BSR GIVEN AND BLOCK SEQ. REDUCED BY ONE           3IO33240
       SPACE   1                                                        3IO33250
BSR.   TRA     BSCKS               PERFORM CHECKS AND UNBUFFER          3IO33260
       RNT     600000              READ BACKWARD                       $3IO33270
       TRA     BSR2-3              NO                                   3IO33280
       TSX     (NDSLX,4                                                $3IO33290
       PZE     0,2,HSKRP           SKIP FORWARD                        $3IO33300
       CAL     1DEC                INCREASE BLOCK SEQUENCE              3IO33310
       TRA     BSR2                                                    $3IO33320
       BES     *-6+NOHYP/NOHYP*6-*                                      3IO33330
       TSX     NDSEL+1,4           EXECUTE                              3IO33340
       PZE     0,2,BSROP           BACKSPACE                            3IO33350
       CLS     1DEC                REDUCE BLOCK SEQUENCE                3IO33360
BSR2   ADM     3,2                 AND PUT IN FCB                       3IO33370
       STD     3,2                                                      3IO33380
       LDQ     5,2                 IS THIS DISK                         3IO33390
       TQP     *+4                 NO                                   3IO33400
       ZET     TEMP                YES, DID EOF GET PASSED              3IO33410
       TRA     BOFEX               YES                                  3IO33420
       TRA     COMXIT              NO                                   3IO33430
       BES     *-5+NOCH/NOCH*5-*                                        3IO33440
       AXC     2,4                     IF BACKED OVER                   3IO33450
       CLA*    0,2                     A FILE MARK STORE                3IO33460
       ANA     ADDRS               ZERO IN BLOCK                        3IO33470
       ERA     ADDRS               COUNT AND GIVE THE                   3IO33480
       TNZ     COMXIT                                                   3IO33490
       STD     3,2                     BEGINNING OF FILE                3IO33500
       TRA     BOFEX                   EXIT OR ELSE NORMAL              3IO33510
*                 ENTRY ROUTINE COMMON TO BSR AND BSF                   3IO33520
BSCKS  LNT     OPEND               IF FILE NOT OPEN                     3IO33530
       TRA     COMXIT              TAKE NORMAL EXIT                     3IO33540
       TSX     FNLBC,4             FIND L(POOL)                         3IO33550
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO33560
       LFT     OUTPUT              IF INPUT FILE                        3IO33570
       TRA     BSC2                UNBUFFER                             3IO33580
       TSX     UNBFI,4             INPUT                                3IO33590
BSC1   LAC     GO,1                LOAD -L(BSR.) OR -L(BSF.)            3IO33600
       LDQ     5,2                                                     $3IO33610
       RQL     1                                                       $3IO33620
       RIR     200000                                                  $3IO33630
       TQP     *+2                 NOT HYPER                           $3IO33640
       SIR     200000              HYPER                               $3IO33650
       BES     *-5+NOHYP/NOHYP*5-*                                     $3IO33660
       TRA     1,1                 AND RETURN                           3IO33670
BSC2   TSX     UNBFO,4             UNBUFFER OUTPUT                      3IO33680
       TRA     BSC1                FILE                                 3IO33690
       TTL                         MESSAGES FOR MINIMUM IOCS            3IO33700
MESS1  BCI     2, UNIT  *****                                           3IO33710
MESS2  BCI     3,CYL. LIMITS XCEDED                                    $3IO33720
       BES     *-3+NOCH/NOCH*3-*                                        3IO33730
MESS5  BCI     3,POOL ERROR TSX AT                                      3IO33740
MESS6  BCI     7, OPEN COUNT EXCEEDED - OPEN NOT POSSIBLE               3IO33750
MESS7  BCI     6, NOT AVAILABLE FOR INITIALIZATION                      3IO33760
MESS8  BCI     3, ATTACH ERROR AT                                       3IO33770
MESS9  BCI     7, ILLEGAL TRANSMIT  ***** WRITE READ  *****            $3IO33780
MES10  BCI     6, REEL  *****   -   ***** RECORDS                       3IO33790
MES11  BCI     4,      REDUNDANCY HISTORY                               3IO33800
MES12  BCI     5, ***** RETRYS      ***** PERM.                        $3IO33810
MES13  BCI     1, RETRY                                                $3IO33820
MES14  BCI     1, ERASE                                                 3IO33830
MES22  BCI     3,ILLEGAL FILE USE                                       3IO33840
MES23  BCI     5,REMOVE REEL *****   S/N                             (4)3IO33850
MES24  BCI     2, MOUNT BLANK                                           3IO33860
MES25  PZE     MES10+3,,3                                              $3IO33870
MES26  PZE     MES10,,6                                                $3IO33880
       TTL         EOT HANDLER FOR EOT ENCOUNTERED                      3IO33890
*                    IN SEARCHING OUTPUT FILE CHAIN                     3IO33900
       SPACE   1                                                        3IO33910
*      TRA     SYEOT               L(FILE) IN CPY7 ADDRESS              3IO33920
*        RETURNS AT  GET1           IRS 1 AND 4 DESTROYED               3IO33930
       SPACE   1                                                        3IO33940
SYEOT  TSX     CPY6,4              SET L(FILE) W/EOT IN IR2 AND SI      3IO33950
       TSX     EOTOF,1             HANDLE EOT                           3IO33960
       TSX     CPY6,4              RESTORE ORIGINAL FILE BITS           3IO33970
       TRA     GET0+1              AND IR2 THEN EXIT                    3IO33980
       SPACE   1                                                        3IO33990
*                       EOT HANDLER OUTPUT FILE                         3IO34000
       SPACE   1                                                        3IO34010
*      TSX     EOTOF,1             IR2 = -L(FILE)                       3IO34020
*      RETURN                      INDICES NOT DISTURBED                3IO34030
       SPACE   1                                                        3IO34040
EOTOF  SXA     ETOF5,4             SAVE IR4                             3IO34050
       SXA     ETOF6,1             IR1                                  3IO34060
       TSX     NDSEL+1,4           WEF ON OLD                           3IO34070
       PZE     0,2,WEFOP           FILE                                 3IO34080
       NOP                         IGNORE EOT                           3IO34090
       LFT     LABEL               IF LABELLED                          3IO34100
ETOF3  STR                         WRITE TRAILER    TSX  LBEOT,1        3IO34110
       TSX     SWITCH,1            SWITCH REELS                         3IO34120
       LFT     LABEL               CHECK AND PREPARE LABEL              3IO34130
       STR                         TSX  LABOO,1                         3IO34140
       TRA     *+1                 TSX   CPINT,4                        3IO34150
       SIL     NOEOT               SET NO EOT CONDITION                 3IO34160
       NZT*    4,2                 IF NO SELECTS TO DO                  3IO34170
       TRA     ETOF5               SKIP OUT                             3IO34180
       CLA     4,2                 SET EOT CHAIN OF SELECTS             3IO34190
       STA     ETOF7               INTO UCW OF                          3IO34200
       CAL     ETOF7               NEW REEL                             3IO34210
       AXC     1,4                                                      3IO34220
       ZET*    0,2                                                     $3IO34230
       TRA     *-1                                                     $3IO34240
       ORS*    0,2                                                      3IO34250
       CLA     L(0)A               SET EOT CHAIN                        3IO34260
       STA     4,2                 = 0                                  3IO34270
       TSX     ACTV+1,4            ACTIVATE                             3IO34280
       PZE     0,2                 NEW REEL                             3IO34290
ETOF5  AXT     **,4                RESTORE IR4                          3IO34300
ETOF6  AXT     **,1                IR1                                  3IO34310
       TRA     1,1                 EXIT                                 3IO34320
ETOF7  FOR     **,,ISSUE           SELECT WORD FOR EOT RESTART          3IO34330
       TTL                         REEL SWITCHING ROUTINE               3IO34340
*      TSX     SWITCH,1            IR2 MUST = -L(FILE)                  3IO34350
*      RETURN                      INDICES NOT DISTURBED                3IO34360
       SPACE   1                                                        3IO34370
*                               ACTIONS                                 3IO34380
*            1. REWINDS UNLOADS OLD REEL                                3IO34390
*            2. SWITCHES TO ALTERNATE UNIT                              3IO34400
*            3. PRINTS MESSAGE TO OPERATOR                              3IO34410
*            4. ADVANCES REEL SEQ. NUMBER                               3IO34420
*            5. STOPS IF NEXT REEL TO BE ON SAME DRIVE                  3IO34430
       SPACE   1                                                        3IO34440
SWITCH SXA     SW3,4               SAVE IR4                             3IO34450
       SXA     SW4,1               IR1                                  3IO34460
       LDQ     5,2                                                     $3IO34470
       RQL     1                   HYPER                               $3IO34480
       TQP     *+9                 NO                                  $3IO34490
       STI     TEMP                                                    $3IO34500
       LDI     1,2                                                     $3IO34510
       LFT     OUTPUT                                                  $3IO34520
       RNT     100000              FILE PROTECT                        $3IO34530
       TRA     *+3                 NO                                  $3IO34540
       TSX     (NDSLX,4                                                $3IO34550
       PZE     0,2,HFPNP                                               $3IO34560
       RFT     200000              UNLOAD                               3IO34570
       TRA     *+4                 NO                                  $3IO34580
       TSX     (NDSLX,4                                                $3IO34590
       PZE     0,2,HUNLP                                               $3IO34600
       TRA     *+3                                                     $3IO34610
       BES     *-15+NOHYP/NOHYP*15-*                                   $3IO34620
       TSX     NDSEL+1,4           REWIND UNLOAD                        3IO34630
       PZE     0,2,RUNOP           OLD REEL                             3IO34640
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           3IO34650
       TSX     UNMNT,4             PRINT UNMOUNT INSTRUCTIONS           3IO34660
       CLA     0,2                 SET IR1 =0                           3IO34670
       PAC     0,1                 FOR SINGLE DRIVE FILE                3IO34680
       STD     *+1                 NOT=0 FOR MULTI-DRIVE                3IO34690
       TXI     *+1,1,**                                                 3IO34700
       CAL     7,2                 UPDATE                               3IO34710
       TZE     SW.1                (UNLESS ZERO)                    (11)3IO34711
       ACL     1P5                 REEL SEQUENCE                        3IO34720
       TSX     BCDCV,4             NUMBER IN                            3IO34730
       ACL     HLBLK               FILE WORDS                           3IO34740
       SLW     7,2                                                      3IO34750
SW.1   CAL     0,2                 SAVE FOR SECOND DRIVE            (11)3IO34760
       STP     SW7                 MOUNTED TEST                        $3IO34770
       CLA     LFLBLK                                                  $3IO34780
       PDC     0,4                 TOTAL NO. OF FCW                    $3IO34790
       STA     SW5+5               ADDRESS OF 1ST FCB                  $3IO34800
       ACL     L(1)                                                    $3IO34810
       STA     SW5+2                                                   $3IO34820
       STI     TEMIND              SAVE INDICATORS                     $3IO34830
       CLA*    FCW                 L(FCB) BEING WORKED ON              $3IO34840
SW5    TXL     SW6,4,0             END OF FCB                          $3IO34850
       TXI     *+1,4,12            NEXT FCB                            $3IO34860
       LDI     **,4                CHECK IF FILE OPEN                  $3IO34870
       LNT     OPEND               IF NOT TRY NEXT FCB                 $3IO34880
       TRA     SW5                                                     $3IO34890
       CAS     **,4                IF MORE THAN ONE FCB                $3IO34900
       TRA     SW5                 USING THE SAME UCB                  $3IO34910
       TRA     *+2                 UPDATE FCW ONE                      $3IO34920
       TRA     SW5                                                     $3IO34930
       LDQ*    SW5+5               ROTATE PRIMARY UNIT                 *3IO34940
       RQL     18                  WITH SECONDARY UNIT                 $3IO34950
       STQ*    SW5+5                                                   *3IO34960
       TRA     SW5                 FINISH FCB                          $3IO34970
SW6    LDI     TEMIND              RESTORE INDICATORS                  $3IO34980
       CLA     FCW                 PLACE LOCATION                      $3IO34990
       AXT     0,4                 OF FILE IN                          $3IO35000
       STA*    0,2                 SECONDARY UNIT                      $3IO35010
       CAL     7,2                 RESTORE AC                          $3IO35020
       TXL     SW2,1,0             IF SINGLE DRIVE SKIP FURTHER TESTS  $3IO35030
       CLA     *+3                 CHECK LEGALITY                      $3IO35040
       TMI     SW1-1               OF UNIT TO BE MOUNTED               $3IO35050
       TSX     (NDATA,4                                                $3IO35060
SW7    PZE     0,2,TESTP                                               $3IO35070
       CAL     7,2                 IF NOT MOUNTED                       3IO35080
       TSX     MOUNT,4             TELL OPERATOR                        3IO35090
       TSX     PAUSE,4             TO MOUNT NOW                         3IO35100
       TSX     ROTAT,4                                                  3IO35110
SW1    CAL     7,2                 TELL OPERATOR                        3IO35120
       TZE     SW.2                (UNLESS N = 0)                   (11)3IO35121
       ACL     1P5                 TO MOUNT REEL N+2                    3IO35130
       TSX     BCDCV,4             ON UNIT OF REEL N                    3IO35140
       ACL     HLBLK               ( IF MULTI-DRIVE)                    3IO35150
SW2    TSX     MOUNT,4                                                  3IO35160
       TSX     ROTAT,4                                                  3IO35170
       TXH     *+2,1,0             IF SAME DRIVE                        3IO35180
       TSX     PAUSE,4             PAUSE FOR OPERATOR                   3IO35190
       TSX     DENSE,4                                                  3IO35200
       LDQ     5,2                                                     $3IO35210
       RQL     1                                                       $3IO35220
       TQP     *+6                                                     $3IO35230
       RNT     100000                                                  $3IO35240
       TRA     *+3                                                     $3IO35250
       TSX     (NDSLX,4                                                $3IO35260
       PZE     0,2,HFPNP                                               $3IO35270
       LDI     TEMP                                                    $3IO35280
       BES     *-8+NOHYP/NOHYP*8-*                                     $3IO35290
       TSX     NDSEL+1,4           INSURE REWIND ON NEWLY              $3IO35300
       PZE     0,2,REWOP           LOADED HYPERTAPE                    $3IO35310
       SIL     NINHIB              UN-INHIBIT FILE                      3IO35320
       LDQ     2,2                 IF MONITORED END OPTION              3IO35330
       RQL     1                   IS SPECIFIED                         3IO35340
       TQP     SW3                 LET SUPERVISORY                      3IO35350
       TSX     SWITCD,4            SYSTEM NOTE CHANGE                   3IO35360
SW3    AXT     **,4                RESTORE IR4                          3IO35370
SW4    AXT     **,1                                                     3IO35380
       TRA     1,1                 EXIT                                 3IO35390
SW.2   CAL     =H NEXT             MOVE 'NEXT' TO AC                (11)3IO35391
       TRA     SW2                                                  (11)3IO35392
       SPACE   1                                                        3IO35400
*                          ROTATE FILE WORD 1                           3IO35410
*                         (CHANGE TO ALT UCW)                           3IO35420
ROTAT  LDQ     0,2                                                      3IO35430
       RQL     18                                                       3IO35440
       STQ     0,2                                                      3IO35450
       TRA     1,4                                                      3IO35460
       SPACE   1                                                        3IO35470
*                     BCD CONVERT AFTER ADD IN AC                       3IO35480
       SPACE   1                                                        3IO35490
*      TSX     BCDCV,4                                                  3IO35500
       SPACE   1                                                        3IO35510
BCDCV  ANA     17SS                                                     3IO35520
       ACL     66SS                                                     3IO35530
       ANS     60SS                                                     3IO35540
       SBM     60SS                                                     3IO35550
       ALS     3                                                        3IO35560
       SBM     60SS                                                     3IO35570
       ARS     3                                                        3IO35580
       LDQ     BLNKS                                                    3IO35590
       STQ     60SS                                                     3IO35600
       TRA     1,4                                                      3IO35610
17SS   OCT     171717373717                                            *3IO35620
66SS   OCT     006666666666                                             3IO35630
60SS   OCT     606060606060                                             3IO35640
       TTL     MIXED MODE SELECT AND POSTING PRE-SUPERVISOR             3IO35650
*                               ACTIONS                                 3IO35660
*             1. ASSUMES MODE BIT OF FILE AS MODE TO TRY FIRST          3IO35670
*             2. IF 10 REDUNDANCIES OCCUR  IT WILL                      3IO35680
*                REVERT TO OTHER MODE FOR TEN MORE TRIES                3IO35690
*             3. IF 10 REDUNDANCIES AGAIN OCCUR  THE FIRST              3IO35700
*                MODE WILL BE USED AND THE RECORD WILL BE READ          3IO35710
*                WITHOUT REDUNDANCY CHECKING                            3IO35720
*             4. AT TRAP LAST WORD OF RECORD IS CHECKED                 3IO35730
*                CONTENTS..  XX XX XX X0 XX XX    BCD   BCD             3IO35740
*                            XX XX XX X5 XX XX    BIN   BIN             3IO35750
*                            XX XX XX X1 XX XX    BCD   BIN             3IO35760
*                            XX XX XX X1 XX XX    BIN   BCD             3IO35770
*                THESE CORRESPOND TO LAST WORDS OF STANDARD LOOKAHEAD   3IO35780
*                            XX XX 00 00 00 00    BCD   BCD             3IO35790
*                            00 01 00 05 00 04    BIN   BIN             3IO35800
*                            XX XX 11 11 07 07    BCD   BIN             3IO35810
*                            00 00 00 01 00 00    BIN   BCD             3IO35820
*             5. WRITE MIXED MODE WORKS ............                    3IO35830
MXMOD  CLA     0,4                 MIXED MODE                           3IO35840
       ANA     L(64D)              CARD EQUIPMENT                       3IO35850
       TNZ     CDMXM               CHECKS FOR EOF CARD                  3IO35860
       STI     MX2                 SAVE SI                              3IO35870
       LNT     100000              IF NO REDUNDANCY ANALYZE             3IO35880
       TRA     LKAD                LOOK AHEAD BITS                      3IO35890
       LDI     1,4                 IF CODE 3 THEN                       3IO35900
       LNT     300000              10 TRIES ON FIRST MODE DONE          3IO35910
       TRA     MX1                                                      3IO35920
       RIL     200000              SET NEXT PERM REDUN TO CAUSE         3IO35930
MX0    STZ*    (URRXI              ERROR PRINT                          3IO35940
       STI     1,4                                                      3IO35950
       LDI     1,2                 REVERSE                              3IO35960
       IIL     MODE                MODE OF                              3IO35970
       STI     1,2                 SELECT                               3IO35980
       TSX     INVM,1              IF FILE IN REF INVERT MODE IN SI     3IO35990
       LXA     S3+1,1              RESTORE IR 1                         3IO36000
       LXA     S3,4                RETURN TO                            3IO36010
       TRA     3,4                 EXECUTOR TO RE-TRY                   3IO36020
*                   SECOND AND THIRD MODE TRIES SEL-                    3IO36030
MX1    LNT     100000              IF THIRD TRY (SAME AS 1ST MODE)      3IO36040
       TRA     LKAD-1              ACCEPT AS PERM. REDUN.              $3IO36050
       IIL     300000              IF SECOND GO TRY AGAIN               3IO36060
       TRA     MX0                 AT FIRST MODE                        3IO36070
MX2    PZE     **                  SI STORAGE                           3IO36080
*                 SEL+ ENTRY MIXED MODE READ OR WRITE                   3IO36090
MXMP   LDI     1,4                 IF FIRST TIME                        3IO36100
       LFT     300000              SELECT SET ALTERNATOR                3IO36110
       TRA     MX3                 CODE =3                              3IO36120
       IIL     300000                                                   3IO36130
       STI     1,4                 RESTORE UCW 2ND WORD                 3IO36140
MX3    LNT     100000              FOR 2ND MODE JUST CONTINUE           3IO36150
       STZ*    (RCTXI              THIRD TRY DISABLE REDUNDANCY         3IO36160
       LDI     1,2                 RESTORE SI                           3IO36170
       TRA     S4-5                EXIT                                $3IO36180
       EJECT                                                            3IO36190
*                      INTERROGATE LOOKAHEAD BITS                       3IO36200
1KA    LFT     200000              EOF                                 $3IO36210
       TRA     SELM2+2             NO CHANGE IN MODE                   $3IO36220
       STI     MX2                 SAVE INDICATORS                     $3IO36230
       LDI     1,2                 PLACE MODE OF FILE IN IND.          $3IO36240
       CLA     1,4                                                     $3IO36250
       PAC     0,1                                                     $3IO36260
       CLA     9,1                 LAST COMMAND                        $3IO36270
       ARS     18                                                      $3IO36280
       ADD     9,1                 LAST WORD READ + 1                  $3IO36290
       PAC     0,1                                                     $3IO36300
       TRA     LWRD+1                                                  $3IO36310
       BES     1KA+NOCH/NOCH**-NOCH/NOCH*1KA-*                         $3IO36320
       LDI     MX2                                                     $3IO36330
LKAD   LFT     200000              EOF                                 $3IO36340
       TRA     MX5                 NO CHANGE IN MODE                   $3IO36350
       LDI     1,2                                                     $3IO36360
LWRD   LAC     COMM,1              INTERROGATE                         $3IO36370
       CLA     -1,1                LAST WORD IN BUFFER                  3IO36380
       ANA     MXBB2                                                   $3IO36390
       LNT     MODE                TEST MODE                           $3IO36400
       TZE     MX5                 BCD TO BCD                          $3IO36410
       ANA     DISCON              BIN CHECK BIN'BIN                   $3IO36420
       TNZ     MX5                 BIN TO BIN                          $3IO36430
       IIL     MODE                CHANGE MODE BIT                     $3IO36440
       STI     1,2                 STORE IN FILE BITS                   3IO36450
       TSX     INVM,1              IF FILE IN REF CHANGE SI STORAGE     3IO36460
MX5    LDI     MX2                 RESTORE SI FOR SELM                  3IO36470
       LXA     S3+1,1                                                  $3IO36480
       CLA     CHATY                                                   $3IO36490
       LBT                                                             $3IO36500
       TRA     *+2                                                     $3IO36510
       TRA     SELM2+2             DISK SEL-                           $3IO36520
       TNZ     SELM1               HYPER SEL-                          $3IO36530
       CAL     XCPT3               CLEAR READ                          $3IO36540
       ANS     1,4                 MODE SWITCH                         $3IO36550
       TRA     SELM1               POST COMPLETION                      3IO36560
MXBB2  OCT     000000050000                                            $3IO36570
XCPT3  OCT     477777777777                                             3IO36580
       SPACE   1                                                        3IO36590
*     INVERT MODE BIT IN IOEX SI STORAGE IF THIS FILE IS CURRENTLY      3IO36600
*                     BEING REFERENCED BY THE IOBS                      3IO36610
INVM   SXA     INVM1,1             SAVE IR1                             3IO36620
       CLA     0,4                 IF FILE IS                           3IO36630
       ALS     18                  CURRENTLY BEING                      3IO36640
       STD     *+2                 REFERENCED BY IOBS                   3IO36650
       LAC     FCW,1               THEN MODIFY MODE                     3IO36660
       TXI     *+1,1,**            BIT IN SENSE INDICATORS              3IO36670
       TXH     *+4,1,0             AS STORED BY                         3IO36680
       LDI     (IOXSI              IOEX.......                          3IO36690
       IIL     MODE                                                     3IO36700
       STI     (IOXSI                                                   3IO36710
INVM1  AXT     **,1                RESTORE IR1                          3IO36720
       TRA     1,1                 EXIT                                 3IO36730
*                   CHECK FOR EOF CARD = 8L(-),7L(-)                    3IO36740
CDMXM  SXA     CDMX4,4             SAVE IR4                             3IO36750
       CAL     1,4                 FIND L(9L)-2                         3IO36760
       PAC     0,4                 IF BOTH                              3IO36770
       CLA     4,4                 8L AND 7L                            3IO36780
       TPL     CDMX4               ARE                                  3IO36790
       CLA     6,4                 (-) TREAT IT AS                      3IO36800
       TPL     CDMX4               END OF FILE                          3IO36810
       LXD     COMM,4              SET L(IORT)+1                        3IO36820
       SXA     COMM,4              AS LAST WD STORED+1                  3IO36830
       SIL     200000              SET EOF BIT                          3IO36840
CDMX4  AXT     **,4                RESTORE IR4                          3IO36850
       TRA     SELM1               RETURN                               3IO36860
*                   ROUTINE TO REVERSE FILE CONTROLS                    3IO36870
*                   SI AND IR2 FROM FILE A TO FILE B                    3IO36880
CPY6   XCA     **                  SAVE AC                              3IO36890
       ENB     L(0)                TRAP PROTECT                         3IO36900
       PIA                         RESTORE CONTROL                      3IO36910
       STD     1,2                 BITS TO FILE                         3IO36920
       LXA     CPY7,1              SWITCH                               3IO36930
       LXA     FCW,2               TO OTHER                             3IO36940
       SXA     FCW,1               FILE                                 3IO36950
       SXA     CPY7,2                                                   3IO36960
       LAC     FCW,2               PLACE 2ND                            3IO36970
       CLA     1,2                 FILES CONTROL                        3IO36980
       ANA     DECRE               BITS IN SI                           3IO36990
       RIL     077777                                                   3IO37000
       OAI                                                              3IO37010
       TXH     *+2,4,-SEL2.4                                           $3IO37020
       ENB     TRAPS               ALLOW TRAPS                          3IO37030
       XCA                         RESTORE AC                           3IO37040
       TRA     1,4                 EXIT                                 3IO37050
       TTL     CONSTANT POOL                                            3IO37060
XCPTP  OCT     077777777777                                            $3IO37070
L(64D) PZE     0,,64                                                    3IO37080
PDMSK  SVN     ,,-1                                                     3IO37090
1P5    BCI     1,000010                                                *3IO37100
HLBLK  BCI     1, 0000                                                 $3IO37110
       SPACE   1                                                        3IO37120
*                          TEMPORARY STORAGE                            3IO37130
HOLDS  PZE     *                   CHAIN CELL                           3IO37140
TCHEX  PZE     **                  TCH SWITCH                           3IO37150
7GRP   PZE     **                  CLOSE RESERVE GROUP ERASEABLE        3IO37160
TEMP   PZE     **                  ERASEABLE STORAGE                    3IO37170
BASIO  BSS     0                   END MINIMUM IOBS                     3IO37180
B4FIN  BSS     0                   ...END MINIMUM IOCS STORAGE..........3IO37190
F5     BES     1                                                        3IO37200
       EJECT                                                            3IO37210
.BASIC CONTRL  S6,F7                                                    3IO37220
S6     BSS     0                                                        3IO37230
*      BASIC COMMUNICATION REGION WITH .BASCR                           3IO37240
.COPY. CONTRL  COPY.,COPY.                                              3IO37250
.REW.  CONTRL  REW.,REW.                                                3IO37260
.WEF.  CONTRL  WEF.,WEF.                                                3IO37270
.BSF.  CONTRL  BSF.,BSF.                                                3IO37280
.CKPT. CONTRL  CKPT.,CKPT.                                              3IO37290
.STAS. CONTRL  STASH.,STASH.                                            3IO37300
.CHCPT CONTRL  CHCPT,CHCPT                                              3IO37310
.CPINT CONTRL  CPINT,CPINT                                              3IO37320
.B5FIN CONTRL  B5FIN,B5FIN                                              3IO37330
.JOIN. CONTRL  JOIN.,JOIN.                                              3IO37340
.INTOP CONTRL  INTOP,INTOP                                              3IO37350
.INTCL CONTRL  INTCL,INTCL                                              3IO37360
.ENTIN CONTRL  ENTIN,ENTIN                                              3IO37370
.BASIO CONTRL  BASIO,BASIO                                              3IO37380
SWTC   SWT     SWTCP                                                    3IO37390
       TTL                         JOIN TWO BUFFER POOLS                3IO37400
*      TSX     JOIN,4                                                   3IO37410
*      PZE     POOL1,,POOL2                                             3IO37420
       SPACE   1                                                        3IO37430
*            1.POOL2 IS APPENDED TO POOL1                               3IO37440
*            2.POOL2 MUST HAVE AT LAST REFERENCE BEEN DEFINED           3IO37450
*            3.POOL1 MAY HAVE FILES ATTACHED                            3IO37460
*            4.POOL1 OR POOL2 MUST NOT HAVE                             3IO37470
*              PREVIOUSLY JOINED ELSEWHERE                              3IO37480
*            5.AFTER TSX JOIN,4 POOL2 NO LONGER EXISTS                  3IO37490
       SPACE   1                                                        3IO37500
JOIN.  LDC     XEOB,1              CHECK IF EITHER                      3IO37510
       LDI     1,1                 FILE JOINED                          3IO37520
       OSI     1,2                 ELSEWHERE                            3IO37530
       RFT     100000              IF SO GIVE                           3IO37540
       TRA     PERR                ''POOL ERROR''                       3IO37550
       CAL     1,1                 CHECK IF BUFFERS ARE                 3IO37560
       ERA     1,2                 THE SAME SIZE                        3IO37570
       ARS     22                  IF NOT GIVE                          3IO37580
       TNZ     PERR                POOL ERROR                           3IO37590
       ENB     L(0)                TRAP PROTECT                         3IO37600
       LDQ     0,2                 JOIN THE BUFFER POOLS                3IO37610
       CLA     0,1                 BY-                                  3IO37620
       STA     0,2                 CHAIN (1) TO END CHAIN(2)            3IO37630
       XCA                         CHAIN(2) TO CHAIN(1)                 3IO37640
       STA*    1,1                                                      3IO37650
       ACL     0,1                 SUM BUFFER COUNTS                    3IO37660
       STD     0,2                 AND SET IN POOL1                     3IO37670
       ENB     TRAPS               ALLOW TRAPS                          3IO37680
       CAL     *+1                 SET JOINED                           3IO37690
       STT     1,1                 CODE INTO POOL2                      3IO37700
       TRA     .EX34-3             EXIT                                 3IO37710
       TTL                         COPY AND STASH ROUTINES              3IO37720
*      TSX     COPY,4              TSX  STASH,4                         3IO37730
*      PZE     FILE1,,FILE2        PZE  FILE1,,FILE2                    3IO37740
*                                  PZE  NTS                             3IO37750
*                             COMMENTS...                               3IO37760
*             1. NO ACTION IF NO INPUT BUFFER                           3IO37770
*             2. PRESENT OUTPUT BUFFER,IF ANY, TRUNCATED                3IO37780
STASH. TXI     *+1,4,-1            SETUP L( NORMAL EXIT)                3IO37790
       SXA     GTIOX,4                                                  3IO37800
       CLA     -1,4                SAVE                                 3IO37810
       STA     XEOF                NTS EXIT                             3IO37820
       SIR     STSH                SET STASH MODE                       3IO37830
COPY.  LNT     OPEND               IF INPUT FILE                        3IO37840
       TRA     COMXIT              NOT OPEN THEN EXIT                   3IO37850
       TSX     FNLBC,4             FIND L(POOL)                         3IO37860
       LXD     XEOB,1              SET FILE2 INTO                       3IO37870
       SXA     CPY7,1              SWITCHING ROUTINE                    3IO37880
       LAC     CPY7,1                                                  $3IO37890
       ERA     4,1                 FIND OUT IF FILE1 AND               $3IO37900
       ANA     DECRE               FILE2 ARE IN THE SAME POOL          $3IO37910
       TNZ     GET4                THEY ARE NOT                        $3IO37920
       TSX     CPY6,4              SWITCH TO OTHER FILES CONTROLS       3IO37930
       LNT     OPEND               IF OUTPUT FILE                       3IO37940
       TRA     COMXIT              NOT OPEN ,THEN EXIT                  3IO37950
       STL     CPY2+1              SET COPY MODE                        3IO37960
       NOP     CPY2+2              TRA*                                 3IO37970
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO37980
       TSX     TRUNC,1             TRUNCATE ANY OUTPUT BUFFER           3IO37990
       RFT     STSH                BRANCH TO                            3IO38000
       TRA     STSH1               STASH ROUTINE                        3IO38010
CPY1   TSX     CPY6,4              REVERSE FILE BITS TO FILE1           3IO38020
       RIR     CPYHLD              RESET COPY HOLD                      3IO38030
CPY2   SIR     CPYFN               SET COPY MODE FOR RELES+TRUNC        3IO38040
       TRA*    **                  DUMMY TRANSFER FOR CASES 2 + 4 STASH 3IO38050
       CLA*    2,2                 IF NO BUFFERS ATTACHED               3IO38060
       STA     CPY6                SAVE L( POSSIBLE HOLD CHAIN)         3IO38070
       TPL     CPY3                TO FILE , THEN EXIT                  3IO38080
       SIR     CPYHLD              SET HOLD CHAIN COPY                  3IO38090
       ANA     1PRE                IS NEGATIVE BUFFER                   3IO38100
       TZE     COMXIT              A HELD BUFFER OR THE POOL            3IO38110
       CLA     2,2                 SETUP BUFFER AS                      3IO38120
       PAC     0,4                 IF JUST FILLED BY WRITE              3IO38130
       CLA     1,4                 ROUTINE                              3IO38140
       STA*    2,2                                                      3IO38150
       LDQ     L(0)                                                     3IO38160
       SLQ*    2,2                                                      3IO38170
CPY3   CLA     2,2                 ATTACH INPUT                         3IO38180
       TSX     CPY6,4              BUFFER TO                            3IO38190
       STA     2,2                 OUTPUT FILE                          3IO38200
       TSX     TRUNC,1             TRUNCATE TRANSFERRED BUFFER          3IO38210
       TSX     CPY6,4              RELEASE ASSIGNMENT                   3IO38220
       LAC     LBC,4               (-L(POOL) TO IR4)                    3IO38230
       LDQ     2,2                 FROM INPUT                           3IO38240
       TSX     POOLRD,1            FILE                                 3IO38250
       TSX     CKGIV,1             DO PRIORITY FOR RELEASE              3IO38260
       SIR     CPYFN               SET COPY FUNCTION BIT BACK ON        3IO38270
       RIL     GIVUP               RESET GIVUP PRIORITY                 3IO38280
       CLA     CPY6                                                     3IO38290
       RNT     CPYHLD              IF NOT A HELD BUFFER                 3IO38300
       CLA     LBC                 L(POOL) TO AC                        3IO38310
       STA     2,2                                                      3IO38320
       RNT     CPYHLD              IF COPYING A HELD BUFFER             3IO38330
       TRA     COMXIT              CONTINUE ELSE EXIT                   3IO38340
       TRA     CPY2-1                                                  $3IO38350
       SPACE   1                                                        3IO38360
*                     STASH MASTER CONTROL ROUTINE                      3IO38370
STSH1  STZ     XEOB                SET STASH SWITCH =0                  3IO38380
       CLA     3,2                 FOR CASES 2 AND 4 (FILE2 INTERNAL    3IO38390
       TMI     STSH3               OUTPUT) SKIP TO STSH3                3IO38400
       TSX     CPY6,4              IF FILE2 REGULAR OUTPUT              3IO38410
       LFT     OUTPUT              AND FILE1 IS AN INTERNAL OUTPUT      3IO38420
       TRA     STSH2               (CASE 1) , SKIP TO STSH2             3IO38430
       TRA     CPY2-1              CASE 3 USES COPY ROUTINE             3IO38440
*             TRANSFER OF FIRST BUFFER OF A FILE (CASE 1)               3IO38450
STSH2  TSX     TRUNC,1             TRUNCATE ANY OUTPUT PREPARED         3IO38460
       CLA*    0,2                 IF NO OUTPUT IN REGEN CHAIN          3IO38470
       TZE     EOF.0+1             YET TAKE NTS EXIT                    3IO38480
       LDQ     0,2                 REMOVE 1ST                           3IO38490
       STA     0,2                 BUFFER FROM                          3IO38500
       ZET*    0,2                 FILE1'S REGEN                        3IO38510
       STD*    0,2                 CHAIN AND PLACE                      3IO38520
       STQ     TEMP                INTO REGULAR OUTPUT FILE             3IO38530
       LAC     TEMP,4              FOR ACTUAL OUTPUT                    3IO38540
       CLA     1,4                 SETUP BUFFER SO LOCATOR              3IO38550
       STZ     0,4                 SHOWS BUFFER CONTENT                 3IO38560
       STA     0,4                                                      3IO38570
       ENB     L(0)                TRAP PROTECT                         3IO38580
       TSX     BCKBB,1             RELEASE ONE FROM OUTPUT-1            3IO38590
       CAL     3,2                 REDUCE                               3IO38600
       ACL     DECRE               SEQUENCE                             3IO38610
       STD     3,2                 COUNT BY ONE                         3IO38620
       TSX     CPY6+1,4            SWITCH TO FILE 2 BITS                3IO38630
       STA     2,2                 OUTPUT                               3IO38640
       SIR     CPYFN                                                    3IO38650
       TSX     TRUNC,1             BUFFER                               3IO38660
       TRA     COMXIT              EXIT                                 3IO38670
       EJECT                                                            3IO38680
*                       SETUP CASES 2 + 4 STASH                         3IO38690
STSH3  STL     CPY2+1              SET TRANSFER TO                      3IO38700
       NOP     STSH4               STASH EXIT TEST                      3IO38710
       TRA     CPY1                FOR NTS CONDITIONS                   3IO38720
*      CASES 2 AND 4 STASH EXECUTION (TESTS COUNTS BEFORE COPY)         3IO38730
STSH4  STZ     XEOB                SET STASH SWITCH=0                   3IO38740
       CLA*    2,2                 IF NO NEXT                           3IO38750
       TPL     STSH5               BUFFER TO BE                         3IO38760
       ANA     1PRE                STASHED,THEN                         3IO38770
       TZE     COMXIT              EXIT                                 3IO38780
STSH5  TSX     CPY6,4              CHANGE TO FILE 2 BITS                3IO38790
       TSX     TOKBB,4             CAN FILE2 ACCEPT A BUFFER            3IO38800
       TRA     STSH6               -NO                                  3IO38810
       TSX     CPY6,4              BACK TO FILE 1 BITS                  3IO38820
       TRA     CPY2+2              COPY THAT BUFFER                     3IO38830
STSH6  TSX     CPY6,4              BACK TO FILE 1 BITS                  3IO38840
       ZET     XEOB                IF SWITCH NOT =0 COUNT               3IO38850
       TRA     STSH7               MUST BE RESTORED AND NTS EXIT TAKEN  3IO38860
       CLA     1,2                 IF PRIME BUFFER                      3IO38870
       SUB     L(400)              COUNT SHOULD NOT                     3IO38880
       PAX     0,1                 BE ADJUSTED                          3IO38890
       TXL     EOF.0+1,1,0         TAKE NTS EXIT                        3IO38900
       STL     XEOB                STE SWITCH NOT =0 FOR 2 ND TIME THRU 3IO38910
       ENB     L(0)                TRAP PROTECT                         3IO38920
       TSX     BCKBB,1             RELEASE COUNT FROM INPUT             3IO38930
       TRA     STSH5               SEE IF THAT WILL ALLOW OUTPUT        3IO38940
STSH7  TSX     TOKBB,4             RESTORE BUFFER COUNT TO FILE1        3IO38950
       STL     XEOB                ERROR IF THIS INSTRUCTION EXECUTED   3IO38960
       TRA     EOF.0+1             TAKE NTS EXIT                        3IO38970
       TTL                         BSF (BACKSPACE FILE) ROUTINE         3IO38980
*      TSX     BSF,4                                                    3IO38990
*      PZE     FILE,,CT                                                 3IO39000
       SPACE   1                                                        3IO39010
*      ACTIONS                                                          3IO39020
*             1. UNBUFFERS FILE                                         3IO39030
*             2. GIVES CT NUMBER OF BSF'S                               3IO39040
*             3. FORWARD SPACE ONE RECORD (OVER EOF MARK) EXCPT AT LOAD 3IO39050
*             4. IF CT =0 ,FILE ONLY UNBUFFERS                          3IO39060
       SPACE   1                                                        3IO39070
BSF.   TRA     BSCKS               PREFORM CHECKS AND UNBUFFER          3IO39080
       LXD     XEOB,1              IF BSF COUNT                         3IO39090
       TXL     COMXIT,1,0          =0 JUST EXIT                         3IO39100
BSF4   RNT     600000                HYPER BACKWARD READ                3IO39110
       TRA     BSF1-1              NO                                  $3IO39120
       TSX     (NDSLX,4                                                $3IO39130
       PZE     0,2,HSKFP           FORWARD SPACE FILE                  $3IO39140
       AXC     0,4                                                     $3IO39150
       LDQ*    0,2                                                     $3IO39160
       RQL     18                                                      $3IO39170
       TQP     BSF1+4                                                  $3IO39180
       TRA     HBSF                                                    $3IO39190
       BES     *-9+NOHYP/NOHYP*9-*                                     $3IO39200
       TSX     NDSEL+1,4           BACKSPACE                            3IO39210
BSF1   PZE     0,2,BSFOP           N FILES                              3IO39220
       AXC     2,4                 IF AT LOAD                           3IO39230
       NZT*    0,2                 POINT DONT                           3IO39240
       TRA     BSF2                MOVE FORWARD                         3IO39250
       TIX     BSF4,1,1              OR CONTINUE TO BACKSPACE           3IO39260
       RNT     600000                                                  $3IO39270
       TRA     *+4                                                     $3IO39280
HBSF   TSX     (NDSLX,4            MOVE OVER FILE MARK                 $3IO39290
       PZE     0,2,HBSFP           BACKSPACE FILE                      $3IO39300
       TRA     BSF5                                                    $3IO39310
       RNT     400000              HYPER                               $3IO39320
       TRA     *+4                 NO                                  $3IO39330
       TSX     (NDSLX,4            SKIP OVER                           $3IO39340
       PZE     0,2,HSKFP           EOF                                 $3IO39350
       TRA     BSF5                                                    $3IO39360
       BES     *-10+NOHYP/NOHYP*10-*                                   $3IO39370
       RIL     OUTPUT              SET FOR READ                        $3IO39380
       LDQ     BSF3                ISSUE DUMMY READ                     3IO39390
       TSX     RDSEL,1             ACROSS EOF MARK                      3IO39400
       NZT*    4,2                 WAIT TILL                            3IO39410
       TRA     *-1                 READ DONE                            3IO39420
BSF5   SIL     NINHIB              SET NOT INHIBITED                    3IO39430
       CAL     1,2                 SET INDICATORS                      $3IO39440
       ANA     EOFBT               TO THE CORRECT                      $3IO39450
       OAI                         STATUS READ OR WRITE                $3IO39460
       CLA     L(0)A               SET SYNC                             3IO39470
       STA     4,2                 CHAIN EQUAL ZERO                     3IO39480
BSF2   PXA     0,0                 CLEAR BLOCK SEQUENCE                 3IO39490
       STD     3,2                                                   (8)3IO39500
       TRA     COMXIT                                                (8)3IO39501
BSF3   PZE     *+1                 DUMMY BUFFER FOR DUMMY               3IO39510
       PZE     L(0),,0             READ ACROSS EOF                      3IO39520
       IORT    **,,0                                                   $3IO39530
       PZE     **                                                      $3IO39540
       TTL                         REWIND AND WRITE EOF ROUTINES        3IO39550
*                          CALLING SEQUENCES                            3IO39560
*      TSX     REW(WEF),4                                               3IO39570
*      PZE     FILE,,EOT                                                3IO39580
*      RETURN                                                           3IO39590
*                                WHERE                                  3IO39600
*                   FILE SPECIFIES THE DESIRED FILE                     3IO39610
*                               COMMENTS                                3IO39620
*              1. WEF ON INPUT IS A NOP                                 3IO39630
*              2. WEF OR REW ON LABELLED FILE IS NOP                    3IO39640
*              3. EOT EXIT IS TAKEN IF EOT OCCURS ON WEF                3IO39650
*                 IF OP IS REW AND EOT NON-ZERO,HYPER IS FILE-PROTECTED 3IO39660
*              4. ANY EOF THAT HAS BEEN DETECTED BUT NOT                3IO39670
*                 YET LOGICALLY REACHED IS CANCELLED DUE TO THE         3IO39680
*                 UNBUFFERING PROCESS THAT TAKES PLACE                  3IO39690
       SPACE   1                                                        3IO39700
REW.   AXT     REWOP,1             REWIND ENTRY                         3IO39710
       CLA     5,2                                                     *3IO39720
       ANA     SIX                 IS THIS 7340                        *3IO39730
       TZE     *+7                 NO                                  *3IO39740
       LXD     XEOB,4              IS FILE PROTECT DESIRED             *3IO39750
       TXL     *+5,4,0             NO                                  *3IO39760
       TSX     (NDSLX,4            YES                                 *3IO39770
       PZE     0,2,HFPNP                                               *3IO39780
       BES     *-7+NOHYP/NOHYP*7-*                                      3IO39790
       TRA     *+2                 PRESET REW OP CODE                   3IO39800
WEF.   AXT     WEFOP,1             WEF ENTRY                            3IO39810
       LNT     LABEL               IF FILE IS LABELLED OR               3IO39820
       LNT     OPEND               NOT OPEN THEN                        3IO39830
       TRA     COMXIT              EXIT                                 3IO39840
       SXD     REW4,1              SET OP CODE                          3IO39850
       SIR     INSAT               SET INITIAL CONDITIONS SATISFIED     3IO39860
       LNT     OUTPUT              IF FILE IS A                         3IO39870
       TRA     *+2                 CKPT FILE THEN SKIP                  3IO39880
       TRA     REW3                DIRECTLY TO ND SEL                   3IO39890
       TSX     FNLBC,4             FIND L(POOL)                         3IO39900
       LFT     OUTPUT              IS FILE INPUT                        3IO39910
       TRA     REW2                OR OUTPUT                            3IO39920
       LXD     REW4,1              SELECT TO IR1                        3IO39930
       TXI     *+1,1,-WEFOP        WEF ON INPUT FILE                    3IO39940
       TXL     COMXIT,1,0          IS A NOP                             3IO39950
       TSX     UNBFI,4             UNBUFFER INPUT FILE                  3IO39960
       TRA     REW3                                                     3IO39970
REW2   TSX     UNBFO,4             UNBUFFER OUTPUT                      3IO39980
REW3   TSX     NDSEL+1,4           REQUEST                              3IO39990
REW4   PZE     0,2,**              REW OR WEF                           3IO40000
       SIL     NINHIB              CANCEL ANY EOF                       3IO40010
       TSX     REDCT,4             PREPARE REDUNDANCY HISTORY           3IO40020
       NZT*    4,2                 CHECK FOR EOT                        3IO40030
       TRA     COMXIT              EXIT                                 3IO40040
       LDC     XEOB,4              TAKE                                 3IO40050
       SXA     GTIOX,4             EOT                                  3IO40060
       TRA     COMXIT              EXIT                                 3IO40070
       TTL                   INTERNAL FILE OPEN                         3IO40080
INTOP  CAL     -1,4                PLACE OPTION                         3IO40090
       ARS     33                  BITS IN SI                           3IO40100
       OAI                                                              3IO40110
       RNT     INTRD               READ OR                              3IO40120
       TRA     IOP3                WRITE                                3IO40130
       RIL     OUTPUT              SET INPUT TYPE                       3IO40140
       CLA     3,2                 SET                                  3IO40150
       ARS     18                  SEQ CT+1                             3IO40160
       ACL     L(1)                AS THE                               3IO40170
       STA     1,2                 NUMBER OF BUFFERS                    3IO40180
       STD     3,2                 AVAILABLE                            3IO40190
       CLA     0,2                 SET RE-GENERATIVE                    3IO40200
       STA     4,2                 BUFFER CHAIN SYNC                    3IO40210
       CLA     L(0)A               SET RE-GEN                           3IO40220
       STA     0,2                 = L(0)                               3IO40230
       PIA                         SET READ                             3IO40240
       ARS     2                   MODE (DESTRUCTIVE                    3IO40250
       ALS     35                  OR NOT)                              3IO40260
       STP     2,2                                                      3IO40270
       TRA     OP1                 EXIT                                 3IO40280
IOP3   RNT     RETAIN                                                   3IO40290
       TSX     DESTRY,4                                                 3IO40300
       SIL     PTO                                                      3IO40310
       CAL     L(0)A                                                   $3IO40320
       ENB     TRAPS                                                    3IO40330
       STA     4,2                                                     $3IO40340
       TRA     OP1                                                      3IO40350
       SPACE   1                                                        3IO40360
*              DESTROY CONTENT OF FILE (RELEASE TO POOL)                3IO40370
DESTRY PXA     0,0                 SET                                  3IO40380
       STA     1,2                 BUF IN USE CT                        3IO40390
       STD     3,2                 AND SEQ CT =0                        3IO40400
       SXA     DEST2,4             SAVE IR4                             3IO40410
       TSX     FNLBC,4             FIND L(POOL)                         3IO40420
       LAC     LBC,4               L(POOL) 0O IR4                       3IO40430
DEST1  CLA*    0,2                 RELEASE                              3IO40440
       TZE     DEST2               ALL                                  3IO40450
       LDQ     0,2                 BUFFERS                              3IO40460
       ENB     L(0)                                                     3IO40470
       STA     0,2                 IN USE                               3IO40480
       TSX     BTP1,1                                                   3IO40490
       TSX     BCKBF+2,1                                                3IO40500
       TRA     DEST1                                                    3IO40510
DEST2  AXT     **,4                RESTORE IR4                          3IO40520
       TRA     1,4                 EXIT                                 3IO40530
       TTL                         INTERNAL FILE CLOSE                  3IO40540
INTCL  LFT     OUTPUT              DISCONNECT                           3IO40550
       TRA     *+3                 ANY BUFFERS                          3IO40560
       TSX     DISCON,1            IN USE                               3IO40570
       TRA     *+2                                                      3IO40580
       TSX     TRUNC,1                                                  3IO40590
       CAL     3,2                 SUM                                  3IO40600
       ARS     18                  BUFFERS IN                           3IO40610
       ACL     1,2                 USE CT AND                           3IO40620
       ALS     18                  SEQ CT FOR                           3IO40630
       LFT     OPEND               FILE OPEN                           $3IO40640
       LFT     OUTPUT              TRUE NUMBER OF BUFFERS               3IO40650
       TRA     *+2                 ADJUST COUNT                         3IO40660
       SUB     1DEC                BY ONE AS AN EXTRA                   3IO40670
       STD     3,2                 WAS ADDED WHEN INPUT                 3IO40680
       STA     1,2                 WAS OPENED                           3IO40690
       CLA*    0,2                 FORM IN                              3IO40700
       TZE     ICL2                0,2 THE                              3IO40710
       PDC     0,1                 COMPLETE                             3IO40720
       CLA     4,2                 CHAIN OF                             3IO40730
       STA     0,1                 BUFFERS                              3IO40740
       CLA*    4,2                 THAT ARE                             3IO40750
       TZE     *+2                 CURRENTLY                            3IO40760
       STD*    0,2                 IN USE                               3IO40770
ICL1   CLA     L(0)A               BY THE FILE                          3IO40780
       STA     4,2                                                      3IO40790
       RNT     RETAIN              IF BUFFERS ARE NOT TO BE             3IO40800
       TSX     DESTRY,4            RETAINED RELEASE THEM TO POOL        3IO40810
       TRA     SH4.1               EXIT                                 3IO40820
ICL2   CLA     4,2                 IF RE-GEN =L(0)                      3IO40830
       STA     0,2                 SET SYNC CHAIN                       3IO40840
       TRA     ICL1                IN THERE                             3IO40850
       TTL                         ENTER BUFFER INTO INTERNAL FILE      3IO40860
ENTIN  SXA     EIN,1               SAVE IR1                             3IO40870
       XCA                         SAVE L(BUF) IN MQ                    3IO40880
       CLA*    0,2                 INSERT BUFFER                        3IO40890
       TNZ     *+3                 INTO RE-GENERATIVE CHAIN             3IO40900
       LAC     FCW,1               SETTING UP IR1 AS L(FILE)            3IO40910
       TRA     *+2                 IF NO CHAIN EXISTS                   3IO40920
       PDC     0,1                 L(END) CHAIN TO IR1                  3IO40930
       XCA                         L(BUF) TO AC                         3IO40940
       STA     0,1                                                      3IO40950
       LDQ     L(0)D                                                    3IO40960
       LGL     18                                                       3IO40970
       STO*    0,1                                                      3IO40980
       STD*    0,2                                                      3IO40990
EIN    AXT     **,1                                                     3IO41000
       TRA     1,1                                                      3IO41010
       TTL  IOCS REQUESTED CHECKPOINT BY USER ON CHECKPOINT FILE        3IO41020
*           OR OPERATOR VIA SENSE SWITCH ON CHECKPOINT FILE             3IO41030
       SPACE   1                                                        3IO41040
CKPT.  STI     CPT2                SET CKPT ON CKPT                     3IO41050
       LDI     1PRE                FILE CODE =(01)                      3IO41060
       TRA     CPINT+2             GO INITIATE CHECKPOINT               3IO41070
*                     INTERNAL INITIATE CHECKPOINT                      3IO41080
*              INITIATES ON CODE SPECIFIED WITH FILE BITS               3IO41090
       SPACE   1                                                        3IO41100
*      TSX     CPINT,4                                                  3IO41110
*      RETURN                                                           3IO41120
       SPACE   1                                                        3IO41130
CPINT  STI     CPT2                SAVE SI                              3IO41140
       LDI     1,2                 FILE BITS                            3IO41150
       SXA     CPT1,4              TO SI                                3IO41160
       LFT     CP1+CP2                                                 $3IO41170
       TRA     CPT3                IF CODE=(00) NO CKPTS                3IO41180
       LDI     CPT2                RESTORE SI                           3IO41190
CPT1   AXT     **,4                RESTORE IR4                          3IO41200
       TRA     1,4                 EXIT                                 3IO41210
CPT2   PZE     0,,0                SI TEMP STORAGE                      3IO41220
CPT3   LNT     CP2                 IS CHECKPOINT                       $3IO41230
       TRA     CPT4                REQ'D ON CKPT FILE                   3IO41240
       LXA     CPFILE,4            YES                                  3IO41250
       TRA     CPT5                                                     3IO41260
CPT4   LFT     OUTPUT              IS OUTPUT FILE                       3IO41270
       LNT     LABEL               LABELLED,IF NOT                      3IO41280
       TRA     CPT1-1              CKPT NOT ALLOWED                     3IO41290
       LXA     FCW,4               IF CKPT FILE OR FILE                 3IO41300
CPT5   SXA     CPT6,4              TO BE WRITTEN ON                     3IO41310
       TXL     CPT1-1,4,0          DOESNT EXIST THEN EXIT               3IO41320
       CLA     0,4                                                      3IO41321
       STA     *+1                                                      3IO41322
       CAL     **                                                       3IO41323
       ANA     CPT7                                                     3IO41324
       ARS     9                                                        3IO41325
       SXA     *+5,1                                                    3IO41326
       PDC     0,1                                                      3IO41327
       TXI     *+1,1,1                                                  3IO41328
       NZT*    SYSJOB+1                                                 3IO41329
       TRA     *+3                                                      3IO4132A
       AXT     **,1                                                     3IO4132B
       TRA     *+3                                                      3IO4132C
       XEC     *-2                                                      3IO4132D
       TRA     CPT1-1                                                   3IO4132E
       CAL     LFLBLK              MOVE FILE BLOCK LOCATION             3IO41330
       SLW     CPT6+1              INTO CKPT                            3IO41340
       TSX     CKPT1,4             CALL                                 3IO41350
CPT6   PZE     **,,CPSEQ                                                3IO41360
       PZE     **,,**                                                   3IO41370
       TRA     CPT1-1              IGNORE CKPT ERROR                    3IO41380
       CAL     CPSEQ               ADVANCE                              3IO41390
       ACL     L(1)                CPSEQ NUMBER                         3IO41400
       TSX     BCDCV,4                                                  3IO41410
       ACL     6PRE                ADD HI -BLANK                        3IO41420
       SLW     CPSEQ                                                    3IO41430
       TRA     CPT1-1              EXIT                                 3IO41440
       TTL     CHECKPOINT ROUTINE PART 1 -DUMP                          3IO41450
*                           CALLING SEQUENCE                            3IO41460
*      TSX     CKPT1,4                                                  3IO41470
*      PZE     FILE,T,L(ID)                                             3IO41480
*      P       L,,N                                                     3IO41490
*              ERROR RETURN                                             3IO41500
*              NORMAL RETURN                                            3IO41510
*               IF P=PZE, L IS LOCATION OF MESSAGE BLOCK                3IO41520
       SPACE   1                                                        3IO41530
*                  =MZE, LS IS LOCATION OF FCW BLOCK                    3IO41540
*       UPON RETURN THE ACCUMULATOR CONTAINS THE RESTART CODE--         3IO41550
*      PZE     FILE CT,DN,TAPE ADDRESS                                  3IO41560
       SPACE   1                                                        3IO41570
*   ERROR RETURN IS GIVEN, IF CHECKPOINT DUMP IS ATTEMPTED AT OTHER     3IO41580
*            THAN BEGINNING OF FILE OR ON UNAVAILABLE TAPE.             3IO41590
CHCPT  STL     CHP3                                                     3IO41600
       TTR     STORE                                                    3IO41610
       LXD     SYSUCW,2                                                 3IO41620
       SXD     *+2,2                                                    3IO41630
       LXA     SYSUCW,2                                                 3IO41640
       TXI     *+1,2,**                                                 3IO41650
       TXI     *+1,2,2                                                  3IO41660
       SXA     CHP41,2                                                  3IO41670
       LXD     SYSUCW,2                                                 3IO41680
       CLS     SYSUCW                                                   3IO41690
       STO     CHP25+1                                                  3IO41700
CHP41  LDI     **,2                TEST FOR COMPLEMENT RECORD COUNT.    3IO41710
       RFT     400000                                                   3IO41720
       TRA     CHP40                                                    3IO41730
       TIX     *-3,2,4                                                  3IO41740
       CAL     TRPCH                                                    3IO41750
       ALS     -1,1                IR1=CH. NO.                         $3IO41760
       ANA     (TRAPS                                                   3IO41770
       SLW     ONETRP                                                   3IO41780
       LAC     CHP1,1              -L(UCW)                              3IO41790
       LDI     0,1                 UCW WORD1                            3IO41800
       LFT     400000                                                  $3IO41810
       TXI     CHPX2,4,1           THE TAPE IS UNAVAILABLE              3IO41820
       AXT     ONETRP,4                                                 3IO41830
       SXA     (TRAPX,4                                                 3IO41840
       TSX     ACTV,4              HOLD UNTIL THIS UNIT IS FREE         3IO41850
       MZE     CHP1                                                     3IO41860
       ZET     1,1                                                      3IO41870
       TRA     *-1                                                      3IO41880
       LDI     2,1                 CURRENT TAPE POSITION                3IO41890
       LXA     CHPX4,4                                                  3IO41900
       RFT     777777              TEST FOR BEGINNING OF FILE           3IO41910
       TXI     CHPX2,4,1                                                3IO41920
       CAL     2,4                                                      3IO41930
       STA     CHP14+2             SET UP IORT FOR MESSAGE BLOCK        3IO41940
       STD     CHP14+2                                                  3IO41950
       ORA     FCW                                                     $3IO41960
       STP     CHP14+2                                                  3IO41970
       CAL     1,4                                                      3IO41980
       PDX     0,4                 SET UP IOCP FOR IO                   3IO41990
       SXA     CHP14,4                                                  3IO42000
       CAL*    CHP14               ID INTO MESSAGE                      3IO42010
       SLW     CMT5+2                                                   3IO42020
CHPSS  PIA     **                                                       3IO42030
       LGR     33                  MOVE INFO TO MQ                     $3IO42040
       CAL     0,1                                                      3IO42050
       ARS     15                                                       3IO42060
       LGR     21                                                       3IO42070
       AXT     36,4                                                     3IO42080
       ALS     3                   LEFT HALF OF RESTART CODE            3IO42090
       LGL     3                                                        3IO42100
       TIX     *-2,4,6                                                  3IO42110
       SLW     CMT5+4                                                   3IO42120
       PXD     0,0                                                      3IO42130
       ALS     3                   RIGHT HALF OF RESTART CODE           3IO42140
       LGL     3                                                        3IO42150
       TIX     *-2,4,1                                                  3IO42160
       LDQ     BLNKS                                                    3IO42170
       LGR     6                                                        3IO42180
       STQ     CMT5+6                                                   3IO42190
       ORA     SIX                                                      3IO42200
       SLW     CMT5+5                                                   3IO42210
       LDQ     0,1                                                      3IO42220
       TSX     CVPRT,4             PRINT CHECKPOINT LINE                3IO42230
       PZE     CMT5,,7+512*DBLSP                                        3IO42240
       AXT     (TRAPS,4                                                 3IO42250
       SXA     (TRAPX,4                                                 3IO42260
       STI     CHPTP                                                   $3IO42270
       LDI     0,1                                                     $3IO42280
       CLA     2,1                 UPDATE CHECKPOINT TAPE POSITION     $3IO42290
       LNT     20000               HYPER                               $3IO42300
       ADD     1DEC                BY BUMPING FILE CT                  $3IO42310
       SLW     2,1                                                      3IO42320
       SXA     CHPSS,0                                                  3IO42330
       AXT     6,4                 SAVE SENSE SWITCH CONDITION          3IO42340
       CAL     1B17                                                     3IO42350
       PSE     119,4               SWT 7,4                              3IO42360
       TRA     *+2                                                      3IO42370
       ORS     CHPSS                                                    3IO42380
       ARS     1                                                        3IO42390
       TIX     *-4,4,1                                                  3IO42400
       AXT     1,2                 1 INTO X2 FOR WRS                    3IO42410
       STL     (CHPSW                                                   3IO42420
       ENB     (TRAPS                                                   3IO42430
       TRA     CHP4                                                     3IO42440
CHP40  RFT     200000              TEST FOR READING OR WRITING          3IO42450
       TRA     CHP41+3                                                 $3IO42460
       TXI     CHPX2,4,1           EXIT-IMPROPER TAPE POSITION          3IO42470
CHP25  IOCP    CHP24,,1                                                 3IO42480
       IOCP    **,,**                                                   3IO42490
       IOCP    CHPSS,,1                                                 3IO42500
CHP14  IOCP    **,,1                                                    3IO42510
       IOCP    *+1,,1                                                   3IO42520
       IORT    **,,**                                                   3IO42530
       TCM     CHP27,0,0,0                                             $3IO42540
       CTL     CHP29-2             BACKSPACE                           $3IO42550
       TDC     CHP26+2                                                 $3IO42560
       TCH     HYGS                                                    $3IO42570
       BES     *-4+NOHYP/NOHYP*4-*                                     $3IO42580
CMT5   BCI     7, CHECKPOINT XXXXXX CODE XXXXXX XXXXXX                  3IO42590
CPT7   OCT     017000000000                                             3IO42591
       TTL                         STORE ROUTINE                        3IO42600
*                           CALLING SEQUENCE                            3IO42610
*     STL     CHC3                                                      3IO42620
*     TTR     STORE                                                     3IO42630
       SPACE   1                                                        3IO42640
*                     USED BY CHECK POINT ROUTINES                      3IO42650
*       1. SAVES INDEX REGISTERS                                        3IO42660
*       2. SETS UP INDIRECTLY ADDRESSABLE CELL FOR DUMP TAPE            3IO42670
*       3. SETS UP CHANNEL INSTRUCTIONS                                 3IO42680
*       4. PLACES -(CHANNEL NO.) INTO X1                                3IO42690
       SPACE   1                                                        3IO42700
STORE  ENB     L(0)                DISABLE TRAPS                        3IO42710
       STI     CHPSI               SAVE SENSE INDICATOR                 3IO42720
       SXA     CHPX4,4             SAVE INDEX REGISTERS                 3IO42730
       SXA     CHPX2,2                                                  3IO42740
       SXA     CHPX1,1                                                  3IO42750
       SXA     CHPX4-4,3                                               $3IO42760
       AXT     0,1                                                     $3IO42770
       AXT     1,3                                                      3IO42780
       TXH     *+5,1,0             7090                                 3IO42790
       STL     X94                 7094                                 3IO42800
       SXA     CHPX4-3,5                                               $3IO42810
       SXA     CHPX4-2,6                                               $3IO42820
       SXA     CHPX4-1,7                                               $3IO42830
       SXA     CHPSL,0                                                  3IO42840
       AXT     4,1                 SAVE SENSE LIGHT CONDITION           3IO42850
       CAL     L(1)                                                     3IO42860
       SLT     5,1                                                      3IO42870
       TRA     *+2                                                      3IO42880
       ORS     CHPSL                                                    3IO42890
       ALS     1                                                        3IO42900
       TIX     *-4,1,1                                                  3IO42910
       CAL     1,4                 FILE,T                               3IO42920
CHP2   PAI     16                                                       3IO42930
       STA     *+2                                                      3IO42940
       RNT     100000              TEST FOR INDIRECT ADDRESSING         3IO42950
       CAL     **                  ADDRESS=ADDRESS OF KEYS STORAGE     $3IO42960
       STA     CHP1                                                     3IO42970
CHP3   AXC     **,2                                                     3IO42980
       PXD     0,0                 TEST FOR 7090 OR 7094                3IO42990
       OCT     044300012000        DOUBLE LOAD                          3IO43000
       TZE     *+2                 THIS IS A 7090                       3IO43010
       OCT     476000000016        ENTER MULTIPLE TAG MODE              3IO43020
       TXL     CHP1,2,*            CHECKPOINT                          $3IO43030
       TSX     (NDATA,4                                                 3IO43040
       PZE     CHP1,0,TESTP                                             3IO43050
       LXA     CHPX4,4                                                 $3IO43060
CHP1   CAL     **                  UCW WORD1                            3IO43070
       STD     CHP19                                                    3IO43080
       ARS     18                  PHYSICAL TAPE ADDRESS                3IO43090
       ORA     CHP2                SET MODE TO BINARY                   3IO43100
       AXT     5,1                                                      3IO43110
       STA     CHP7+3,1            SET UP SELECT INSTRUCTIONS           3IO43120
       TIX     *-1,1,1                                                  3IO43130
       ARS     9                                                        3IO43140
       ANA     *+1                                                      3IO43150
       PAC     15,1                -(CHANNEL NO.)                       3IO43160
       TXI     *+1,1,1                                                  3IO43170
       LDQ*    (TRCXI                                                   3IO43180
       SLQ     CHP17               TRCX                                 3IO43190
       LDQ*    (TCOXI                                                   3IO43200
       CAL     (CKWAT                                                   3IO43210
       ACL     L(1)                                                     3IO43220
       STA     *+1                                                      3IO43230
       SLQ     **                  TCOX                                 3IO43240
       CAL*    (RCHXI                                                   3IO43250
       ORA     D48                                                      3IO43260
CHPSL  XCL     **                  SENSE LIGHT CONDITION                3IO43270
       SLQ     CHP15               RCHX*                                3IO43280
       LDQ*    (ETTXI                                                   3IO43290
       STQ     CHP16                                                    3IO43300
       LDQ*    (TEFXI                                                   3IO43310
       SLQ     CHP13               TEFX                                 3IO43320
       TXI     *+1,1,-1                                                 3IO43330
       TRA     1,2                                                      3IO43340
CHPSI                                                                   3IO43350
CHP19  PZE     0,,**                                                    3IO43360
       EJECT                                                            3IO43370
*                                 EXIT                                  3IO43380
*                         DUMP OR RESTORE CORE                          3IO43390
*                       RESTORE INDEX REGISTERS                         3IO43400
       SPACE   1                                                        3IO43410
CHP4   LDC     SYSUBC,1            -NO. OF CHANNELS TO X1               3IO43420
       TXI     *+1,1,1             DELAY UNTIL                          3IO43430
       ZET*    (CHXSP              ALL CHANNELS                        $3IO43440
       TRA     CHP4                BECOME DORMANT.                      3IO43450
       TXH     *-3,1,0                                                  3IO43460
       ENB     L(0)                DISABLE TRAPS                        3IO43470
       STZ     (CHPSW                                                  $3IO43480
CHP30  LDI*    CHP1                                                    $3IO43490
       LFT     20000               7909 CHANNEL                        $3IO43500
       TRA     CHGSH               YES                                 $3IO43510
       BES     *-3+NOHYP/NOHYP*3-*                                     $3IO43520
       TXL     *+5,2,0             ZERO IF RESTART                     $3IO43530
       AXT     6,1                                                     $3IO43540
       TSX     RDWR,4              WRITE MESSAGE BLOCK                 $3IO43550
       PZE     CHP25                                                    3IO43560
       TRA     CHP6                                                     3IO43570
       TSX     RDWR,4                                                   3IO43580
       PZE     CHP8                                                     3IO43590
       TRA     CHP6                RTC RETURN                           3IO43600
       AXT     2,2                 2 INTO X2 FOR WEF                    3IO43610
       TSX     RDWR,4                                                   3IO43620
       PZE                                                              3IO43630
       TRA     CHP6                                                     3IO43640
CHP76  AXT     L(0),4                                                  $3IO43650
       SXA     (TRAPX,4                                                 3IO43660
       LXD     SYSUBC,1                                                 3IO43670
       SXD     *+1,1                                                    3IO43680
       TXI     *+1,1,**                                                 3IO43690
       TXI     *+1,1,10                                                 3IO43700
       SXA     *+5,1                                                    3IO43710
       TXI     *+1,1,1                                                  3IO43720
       SXA     *+4,1                                                    3IO43730
       TXI     *+1,1,-11                                                3IO43740
       CAL     CHP10               ACTIVATE ALL CHANNELS                3IO43750
       STA     **,1                                                     3IO43760
       TRA     **,1                                                     3IO43770
CHP11  TIX     *-2,1,2                                                  3IO43780
       NZT     X94                 7090                                $3IO43790
       TRA     CHPX4               YES                                 $3IO43800
       OCT     076000000016        LEAVE MULTIPLE TAG MODE             $3IO43810
       AXT     **,3                RESTORE IR FOR 94                   $3IO43820
       AXT     **,5                                                    $3IO43830
       AXT     **,6                                                    $3IO43840
       AXT     **,7                                                    $3IO43850
CHPX4  AXT     **,4                RESTORE INDEX REGISTERS              3IO43860
CHPX2  AXT     **,2                                                     3IO43870
       SLF                                                              3IO43880
       AXT     4,1                 RESTORE SENSE LIGHTS                 3IO43890
       CAL     CHPSL                                                    3IO43900
       LBT                                                              3IO43910
       TRA     *+2                                                      3IO43920
       SLN     5,1                                                      3IO43930
       ARS     1                                                        3IO43940
       TIX     *-4,1,1                                                  3IO43950
       AXT     (TRAPS,1                                                 3IO43960
       SXA     (TRAPX,1                                                 3IO43970
CHPX1  AXT     **,1                                                     3IO43980
CHP10  PIA     CHP11               TAPE POSITION OF CHECK POINT         3IO43990
       STZ     X94                 ZERO 7094 SWITCH                    $3IO44000
       ENB     (TRAPS                                                   3IO44010
       TRA     4,4                 EXIT                                 3IO44020
X94    PZE                         7094 SWITCH                         $3IO44030
CHGSH  PIA                                                             $3IO44040
       ANA     DEC15               PUT UNIT NUMBER                     $3IO44050
       ORA     HYSEL               IN SELECT ORDER                     $3IO44060
       STD     CHP27-1                                                 $3IO44070
       CLA     CHP11+3                                                 $3IO44080
       STA     CHP26                                                   $3IO44090
       STA     CHP28                                                   $3IO44100
       PIA                                                             $3IO44110
       ARS     23                  SET THE SMS                         $3IO44120
       ANA     L(1)                TO CORRECT                          $3IO44130
       ORS     CHP26               INTERFACE                           $3IO44140
       ORS     CHP28                                                   $3IO44150
       CAL     CDTCT               MAKE COMMANDS                       $3IO44160
       STP     CHP14+2             COPY AND DISCONNECT                 $3IO44170
       TXL     *+3,2,0             ZERO IF RESTART                     $3IO44180
       TSX     *+4,4                                                   $3IO44190
       PZE     CHP26               CHECKPOINT CTLW                     $3IO44200
       TSX     *+2,4                                                   $3IO44210
CHP24  PZE     CHP28                                                    3IO44220
       XEC     CHP15               START CHANNEL                       $3IO44230
       TSX     (CKWAT,4            WAIT UNTIL FINISHED                 $3IO44240
       ZET     CHP29+1             WAS THERE AN ERROR                  $3IO44250
       TRA     CHP29               YES                                 $3IO44260
       CAL     FCW                 RESTORE COMMAND                     $3IO44270
       STP     CHP14+2             TO IORT                             $3IO44280
       TXL     *+3,2,0             ZERO IF RESTART                     $3IO44290
       TSX     (NDATA,4            WRITE TAPE MARK                     $3IO44300
       PZE     CHP1,,HWTMP                                             $3IO44310
       TRA     CHP76                                                   $3IO44320
CHP26  SMS     14                                                      $3IO44330
       LCC     4                                                       $3IO44340
       LIPT    *+1                                                     $3IO44350
       CTLW    CHP27-1                                                 $3IO44360
       TCH     CHP25                                                   $3IO44370
       OCT     120600120112                                            $3IO44380
CHP27  LCC     5                                                       $3IO44390
       LIPT    *+1                                                     $3IO44400
       CTLW    CHP27-1                                                 $3IO44410
       CPYP    0,,1                                                    $3IO44420
       CPYD    1,,-1                                                   $3IO44430
       TCM     HYGS+3,0,0,0                                            $3IO44440
       CTL     CHP29-2                                                 $3IO44450
       TDC     CHP27+1                                                 $3IO44460
HYGS   XMT     CHP29+1,,1                                              $3IO44470
       TRA     CHP29+2             ERROR TRANSFER                      $3IO44480
       CTL     CHP29-1                                                 $3IO44490
       LCC     0                                                       $3IO44500
       WTR     *                   WAIT                                $3IO44510
CHP28  SMS     14                                                      $3IO44520
       CTLR    CHP27-1                                                 $3IO44530
       CPYP    0,,1                                                    $3IO44540
       CPYD    1,,-1                                                   $3IO44550
       TCM     HYGS+3,0,0,0        TRANSFER NO ERRORS                  $3IO44560
       CTL     *+3                 BACKSPACE.                          $3IO44570
       LIPT    CHP28+1             RETRY                               $3IO44580
       OCT     030512010000        BACKSPACE CTL                       $3IO44590
       OCT     031112010000        UNLOAD CARTRIDGE                    $3IO44600
CHP29  IOT                                                             $3IO44610
       PZE     0                   ZERO IF NO ERROR ON C.P.            $3IO44620
       STZ     *-1                                                     $3IO44630
       TRA     CHP70+4             PRINT MSG. AND RETRY                $3IO44640
       BES     CHGSH+NOHYP/NOHYP**-NOHYP/NOHYP*CHGSH-*                 $3IO44650
       TTL                         READ OR WRITE CHECKPOINT             3IO44660
*                      UPON ENTRY X2 MUST CONTAIN                       3IO44670
*                              0 FOR RDS                                3IO44680
*                              1 FOR WRS                                3IO44690
*                              2 FOR WEF                                3IO44700
CHPRW  RUNA    **                                                       3IO44710
       WEFA    **                                                       3IO44720
CHP7   WTBA    **                                                       3IO44730
       RTBA    **                                                       3IO44740
CHP6   BSRA    **                                                       3IO44750
       TXL     RDWR+1,2,0          TXL IF RDS                           3IO44760
       XEC     CHP7                                                     3IO44770
       XEC     CHP16                                                    3IO44780
       TRA     CHP18               EOT ON ERASE                         3IO44790
RDWR   SXA     CHP20+4,4                                                3IO44800
       TXL     *+3,2,0                                                 $3IO44810
       TXH     *+2,2,1                                                 $3IO44820
       TNX     CHP70,1,1                                               $3IO44830
       XEC     CHP7+1,2            SELX                                 3IO44840
       TXH     *+2,2,1             TXH IF WEF                           3IO44850
CHP15  RCHA*   1,4                                                      3IO44860
       TSX     (CKWAT,4                                                 3IO44870
       LXA     CHP20+4,4                                                3IO44880
       IOT                                                              3IO44890
       TRA     CHP20               I/O CHECK                            3IO44900
CHP16  ETTA                                                             3IO44910
       TRA     CHP70                                                    3IO44920
CHP13  TEFA    *                                                        3IO44930
CHP17  TRCA    2,4                                                      3IO44940
       TRA     3,4                                                      3IO44950
CHP18  LDQ     CHP19                                                    3IO44960
       TSX     CVPRT,4                                                  3IO44970
       PZE     CMT4,,2                                                  3IO44980
       TSX     STOP,4                                                   3IO44990
CHP20  TSX     PROUT,4                                                  3IO45000
       PZE     1                                                        3IO45010
       PZE     CMT8,,2                                                  3IO45020
       TSX     PAWS,4                                                   3IO45030
       AXT     **,4                                                     3IO45040
       TRA     CHP16                                                    3IO45050
CHPTP  PZE     **                                                       3IO45060
CHP8   IOCP    0,,1                                                     3IO45070
       IOCD    1,,-1                                                    3IO45080
D48    PZE     0,0,48                                                   3IO45090
CHP70  LAC     CHP1,4              HERE ON EOT                          3IO45100
       CLA     1DEC                                                    $3IO45110
       STO     2,4                                                     $3IO45120
       XEC     CHPRW               RUN                                  3IO45130
       TSX     PROUT,4                                                  3IO45140
       PZE     1                                                        3IO45150
       PZE     CHP71,,8+512*DBLSP                                      $3IO45160
       CAL     BLNKS                                                   $3IO45170
       ANA     XCPTP                                                   $3IO45180
       LAC     CHP1,4                                                  $3IO45190
       SLW     CMT5+6                                                  $3IO45200
       LDQ     0,4                                                     $3IO45210
       TSX     CVPRT,4                                                 $3IO45220
       PZE     CMT5,,7+512*DBLSP                                       $3IO45230
       TRA     CHP30                                                   $3IO45240
CHP71  BCI     8,CHECKPOINT INVALID, MOUNT NEW REEL TO CONTINUE        $3IO45250
CMT4   BCI     2,EOT ON ERASE                                           3IO45260
CMT8   BCI     2,I/O CHECK                                              3IO45270
       TTL                         BASIC IOCS CONSTANTS                 3IO45280
TRPCH  PZE     1,,1                                                     3IO45290
ONETRP PZE     **                                                       3IO45300
FULIO  BSS     0                   END BASIC IOBS                       3IO45310
B5FIN  BSS     0                   ....END BASIC IOCS STORAGE........   3IO45320
F6     BES     1                                                        3IO45330
       EJECT                                                            3IO45340
.LABEL CONTRL  S7,F7                                                    3IO45350
S7     BSS     0                                                        3IO45360
*      LABEL COMMUNICATION REGION WITH .LABEL                           3IO45370
*                                                                       3IO45380
.LABRT CONTRL  LABRT1,LABRT1                                            3IO45390
.B6FIN CONTRL  B6FIN,B6FIN                                              3IO45400
.LABCO CONTRL  LABCO,LABCO                                              3IO45410
.LABCI CONTRL  LABCI,LABCI                                              3IO45420
.LABOO CONTRL  LABOO,LABOO                                              3IO45430
.MNT6  CONTRL  MNT6,MNT6                                                3IO45440
.LAEOF CONTRL  LAEOF,LAEOF                                              3IO45450
.LBEOT CONTRL  LBEOT,LBEOT                                              3IO45460
SWTE   SWT     LERIG                                                    3IO45470
       TTL     SET UP INDIRECT REFERENCES TO LABEL HANDLING ROUTINES    3IO45480
*           THE ROUTINE SPECIFIED IN THE DECREMENT OF WORD 3            3IO45490
*            OF THE FILE IS USED AS THE BASE ADDRESS OF THE             3IO45500
*                FIVE (5) IMAGE ROUTINES WHICH ARE USED                 3IO45510
       SPACE   1                                                        3IO45520
*      TSX     LBSET,1             -L(FILE) IN  IR2                     3IO45530
*      RETURN                      IR4  DESTROYED                       3IO45540
*                                                                       3IO45550
LBSET  STZ     HHDR                RESET HYPER LABEL FLAG              *3IO45560
       CLA     5,2                                                     *3IO45570
       ANA     SIX                                                     *3IO45580
       TZE     *+3                 729,1301                            *3IO45590
       STL     HHDR                                                    *3IO45600
       TRA     *+4                                                     *3IO45610
       BES     LBSET+NOHYP/NOHYP**-NOHYP/NOHYP*LBSET-*                  3IO45620
       CLA     2,2                                                     *3IO45630
       PDX     0,4                                                     *3IO45640
       TXH     *+2,4,0                                                 *3IO45650
       LXD     LBRTN,4             SETUP LIST OF                       *3IO45660
       PXA     0,4                 ENTRIES TO                          *3IO45670
       AXT     5,4                 IMAGE ROUTINES                       3IO45680
       STA     LABRT5+1,4                                               3IO45690
       ACL     L(1)                                                     3IO45700
       TIX     *-2,4,1                                                  3IO45710
       STZ     DHDR                DISK HEADER FLAG                    $3IO45720
       TRA     1,1                                                      3IO45730
LABRT1 TSX     **,1                INPUT LABEL CHECK                    3IO45740
LABRT2 TSX     **,1                INPUT TRAILER CHECK                  3IO45750
LABRT3 TSX     **,1                CHECK LABEL FOR VALID OUTPUT REEL    3IO45760
LABRT4 TSX     **,1                PREPARE OUTPUT TRAILER               3IO45770
LABRT5 TSX     **,1                PREPARE OUTPUT LABEL                 3IO45780
       SPACE   1                                                        3IO45790
*                    STANDARD LABEL IMAGE ROUTINES                      3IO45800
LBRTN  TXL     LCKIN,,LBRTN        INPUT LABEL CHECK                    3IO45810
       TRA     TCKIN               INPUT TRAILER CHECK                  3IO45820
       TRA     LCKOF               CHECK LABEL FOR VALID OUTPUT REEL    3IO45830
       TRA     TPROF               PREPARE OUTPUT TRAILER               3IO45840
       TRA     LPROF               PREPARE OUTPUT LABEL                 3IO45850
       TTL                         LABEL HANDLER AT EOF                 3IO45860
*      TSX     LAEOF,1                                                  3IO45870
*             EXITS AT SYNCR+2 IF EOR TRAILER ENCOUNTERED               3IO45880
*              EXITS AT EOF.1 IF EOF TRAILER ENCOUNTERED                3IO45890
*           (IN LAST CASE,EOF FOLLOWING TRAILER IS SKIPPED)             3IO45900
       SPACE   1                                                        3IO45910
LAEOF  SXA     LF1,4               SAVE IR4                             3IO45920
       SXA     LF1+1,1             AND IR1                              3IO45930
       TSX     LBSET,1             SETUP LABEL IMAGE CALLS              3IO45940
       TSX     RDLAB,4             READ TRAILER                         3IO45950
       TRA     LF3                 NO TRAILER EXIT OR EOF EXIT          3IO45960
       STZ     TEMP                                                     3IO45970
       XEC     LABRT2              XEC TRAILER CHECK                    3IO45980
       TQP     LF2                 EOR- SWITCH REELS AND CONTINUE      $3IO45990
       RIL     NOEOT                                                   $3IO46000
       CLA     5,2                 TEST FOR DISK                       $3IO46010
       TMI     *+2                 YES                                 $3IO46020
       TSX     SKIP,4              EOF-SKIP OVER EOF MARK AND EXIT     $3IO46030
       NZT     TEMP                IF SEQUENCE ERROR                    3IO46040
       TRA     EOF.0               TAKE EOF EXIT                        3IO46050
       TRA     SEQEX               TAKE SEQUENCE EXIT                   3IO46060
LF2    TSX     SWITCH,1            SWITCH REELS                        $3IO46070
       STI     CPT2                SAVE INDICATORS                     $3IO46080
       STL     SWING                                                (12)3IO46085
       TSX     LABCI,1             HANDLE LABELS NEW REEL               3IO46090
       STZ     SWING                                                (12)3IO46095
       LDI     CPT2                RESTORE INDICATORS                  $3IO46100
       TSX     CPINT,4             ISSUE CONDITIONAL CHECKPOINT         3IO46110
LF1    AXT     **,4                RESTORE IR4                          3IO46120
       AXT     **,1                AND IR1                              3IO46130
       NZT     TEMP                UNLESS SEQ ERROR IN TRAILER          3IO46140
       TRA     SYNCR+2             CONTINUE TO SYNC                     3IO46150
       TRA     SEQEX                                                    3IO46160
LF3    TSX     PROUT,4             WHEN TRAILER NOT RECOGNIZABLE        3IO46170
       PZE     2                   BECAUSE OF LENGTH                    3IO46180
       MZE     9,2,3               PRINT '' NO TRAILER''                3IO46190
       PZE     LMG11,,2+512*DBLSP  AND TAKE EOF EXIT                    3IO46200
       TRA     EOF.0                                                    3IO46210
       TTL                         LABEL HANDLER INPUT FILE             3IO46220
*      TSX     LABCI,1                                                  3IO46230
*      RETURN                                                           3IO46240
       SPACE   1                                                        3IO46250
LABCI  SXA     LH4,4               SAVE IR4                             3IO46260
       SXA     LH4+1,1             AND IR1                              3IO46270
       TSX     LBSET,1             SET UP LABEL IMAGE CALLS            $3IO46280
       CLA     5,2                 IS THIS DISK                        $3IO46290
       TPL     LH2                 NO                                  $3IO46300
       STL     DHDR                DISK HEADER FLAG                    $3IO46310
       TRA     LH2                 SKIP UNLOAD(FOR ERROR RETRY)         3IO46320
       ZET     DHDR                IF DISK NEXT JOB                    $3IO46330
       TSX     STOPD,4             YES                                 $3IO46340
LH1    TSX     NDSEL+1,4           UNLOAD IF ERROR                      3IO46360
       PZE     0,2,RUNOP           RE-TRY AFTER REEL SWITCH             3IO46370
LH2    TSX     LBDNR,4             SET DENSITY FOR READING LABEL        3IO46380
       TSX     RDLAB,4             READ LABEL                           3IO46390
       TRA     LH7                 EOF OR NO LABEL EXIT                 3IO46400
LH2.5  XEC     LABRT1              VALIDATE CORRECT LABEL               3IO46410
       TRA     LH3                 OK                                   3IO46420
       NZT     DHDR                                                    $3IO46430
       TRA     *+3                                                     $3IO46440
       CAL     LH6.5               DISK                                $3IO46450
       TRA     *+4                                                     $3IO46460
       BES     *-4+NOCH/NOCH*4-*                                        3IO46470
       LFT     SEARCH              IF SEARCHING GO OUT AND TEST         3IO46480
       TRA     LH8                                                      3IO46490
       CAL     LH6                 PRINT                                3IO46500
       TSX     LBERR,4             --INPUT REEL INVALID--              $3IO46510
       XEC     SWTE                IF SENSE SWITCH ASSIGNED IS UP       3IO46520
       TRA     LH1-2               TRY NEXT UNIT IF NOT DISK           $3IO46530
LH3    NZT     LH11                                                     3IO46540
       TRA     LH3.5                                                    3IO46550
*                  LABEL FOUND..... NOTIFY OPERATOR                     3IO46560
       TSX     PROUT,4                                                 *3IO46570
       PZE     2                                                       *3IO46580
       MZE     9,2,3               ''FILE-NAME''                       *3IO46590
       PZE     LMG10,,1            ''FOUND''                           *3IO46600
       STZ     LH11                RESET SEARCH SWITCH                 *3IO46610
*                                                                       3IO46620
LH3.5  ZET     DHDR                                                     3IO46630
       TRA     LH4                                                      3IO46640
       TSX     SKIP,4                                                   3IO46650
       TSX     DENSE,4             SET FILE DENSITY                     3IO46660
       CLA     LAREA+6             IF CHECKPOINT FOLLOWS,               3IO46670
       ZET     HHDR                                                     3IO46680
       CLA     LAREA+10                                                 3IO46690
       LBT                                                              3IO46700
       TRA     *+2                                                      3IO46710
       TSX     SKIP,4              SKIP OVER THAT FILE.                 3IO46720
LH4    AXT     **,4                RESTORE IR4                          3IO46730
       AXT     **,1                AND IR1                              3IO46740
       TRA     1,1                 EXIT                                 3IO46750
LH6    PZE     LMSG1,,3            ERROR MESSAGE PARAMETER              3IO46760
LH6.5  PZE     BLNKS,,1                                                $3IO46770
LH7    TSX     PROUT,4             IF NO LABEL ON OUTPUT                3IO46780
       PZE     2                   PRINT '' NO LABEL'' AND              3IO46790
       MZE     9,2,3               AND CONTINUE FURTHER                 3IO46800
       PZE     LMG13,,4+512*DBLSP  LABEL CHECKS WILL CATCH ERROR       *3IO46810
       TRA     LH2.5                                                    3IO46820
*                       LABEL SEARCHING ROUTINES                        3IO46830
LH8    ZET     LH11                IF INITIAL ENTRY                     3IO46840
       TRA     LH9                 PRINT LABEL SEARCHING MESSAGE        3IO46850
       STL     LH11                AND GIVE OPERATOR CHOICE             3IO46860
       TSX     PROUT,4             PRINT MESSAGE INFORMING OPERATOR OF  3IO46870
       PZE     2                   THE IMPENDING SEARCH                 3IO46880
       MZE     9,2,3                                                    3IO46890
       PZE     LMG12,,9                                                 3IO46900
       STL     SERSW               SET SWITCH CELL NON ZERO             3IO46910
       XEC     SWTE                IF SENSE SWITCH IS ORIGINALLY        3IO46920
       STZ     SERSW               DOWN                                 3IO46930
LH9    TSX     PROUT,4             PRINT THE LABEL OF BYPASSED          3IO46940
       PZE     2                   FILE FOR OPERATOR                   *3IO46950
       PZE     LAREA,,12                                                3IO46960
       PZE     LAREA1+2,,4                                             *3IO46970
       TSX     SKIP,4              SKIP OVER EOF FOLLOWING LABEL        3IO46980
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO46990
       TSX     DENSE,4             SET FILE DENSITY                     3IO47000
       CLA     LAREA+6                                                  3IO47010
       ZET     HHDR                                                    *3IO47020
       CLA     LAREA+10            IF CHECKPOINT FOLLOWS               *3IO47030
       LBT                         THEN SKIP OVER IT                    3IO47040
       TRA     *+3                                                      3IO47050
       TSX     SKIP,4              SKIP CKPT RECORD ( A FILE)           3IO47060
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO47070
       TSX     SKIP,4              SKIP OVER BODY OF DATA FILE          3IO47080
       TSX     LH14,4              CHECK OPERATOR INTERVENTION          3IO47090
       TSX     RDLAB,4             READ TRAILER                         3IO47100
       TRA     LH9.9               EOF OR NO TRAILER EXIT               3IO47110
LH9.2  XEC     LABRT2              VALIDATE TRAILER                     3IO47120
       TQP     *+3                 MQ + IF EOR                          3IO47130
       TSX     SKIP,4              SKIP OVER EOF AFTER TRAILER          3IO47140
       TRA     *+2                 GO CHECK NEXT FILE                  $3IO47150
       TSX     SWITCH,1            SWITCH REELS IF EOR                  3IO47160
       TSX     LH14,4              CHECK OPERATOR INTERVENTION         $3IO47170
       TRA     LH2                 GO CONTINUE SEARCH                   3IO47180
LH9.9  TSX     PROUT,4             PRINT                                3IO47190
       PZE     2                   '' NO TRAILER'' AND                  3IO47200
       MZE     9,2,3               AND CONTINUE                         3IO47210
       PZE     LMG11,,2+512*DBLSP                                       3IO47220
       TRA     LH9.2-2                                                 *3IO47230
       SPACE   1                                                        3IO47240
*       INTERRUPT SEARCH IF OPERATOR PLACES SENSE SWITCH 4 DOWN         3IO47250
LH14   NZT     SERSW               IF SENSE SWITCH WERE ORIGINALLY      3IO47260
       TRA     LH15                UP THEN TEST FOR INTERRUPT           3IO47270
       XEC     SWTE                IF DOWN THEN RECORD WHEN             3IO47280
       STZ     SERSW               IT IS PLACED UP                      3IO47290
       TRA     1,4                 EXIT                                 3IO47300
LH15   XEC     SWTE                IF SENSE SWITCH DOWN AFTER BEING UP  3IO47310
       TRA     1,4                 THEN INTERRUPT SEARCH                3IO47320
       TRA     LH1                 ELSE CONTINUE                        3IO47330
       TTL                         LABEL HANDLER OPEN OUTPUT FILE       3IO47340
*      TSX     LABOO,1                                                  3IO47350
       SPACE   1                                                        3IO47360
LABOO  SXA     LOO3,4              SAVE IR4                             3IO47370
       SXA     LOO3+1,1            IR1                                  3IO47380
       TSX     LBSET,1             SETUP CALLS ON IMAGE ROUTINES        3IO47390
       CLA     5,2                                                     $3IO47400
       TPL     *+3                                                     $3IO47410
       STL     DHDR                DISK HEADER FLAG                    $3IO47420
       TRA     LOO1                                                    $3IO47430
LOOZ   TSX     LBDNR,4             SET DENSITY FOR READING LABELS       3IO47440
       AXC     2,4                 IF REEL                              3IO47450
       CLA*    0,2                 NOT AT LOAD POINT                    3IO47460
       ANA     MSK3                SAVE ORIGINAL TAPE POSITION         *3IO47470
       STO     TEMP                                                     3IO47480
       TZE     LOO1                GO INTRODUCE *****                   3IO47490
       TSX     LOO5,4              AS TAPE SERIAL NUMBER                3IO47500
LOOA   ZET     DHDR                DISK                                $3IO47510
       TSX     STOPD,4             YES-NEXT JOB                        $3IO47520
       TSX     NDSEL+1,4           REWIND UNLOAD IF                     3IO47530
       PZE     0,2,RUNOP           REEL INVALID BEFORE RE-TRY           3IO47540
       STZ     TEMP                SET TEMP =0 SHOWING LOAD PT START    3IO47550
LOO1   TSX     RDLAB,4             READ LABEL ON OUTPUT REEL            3IO47560
       TRA     LOO10               EOF OR NO LABEL                      3IO47570
       XEC     LABRT3              VALIDATE OK FOR USE                  3IO47580
       TRA     LOO2                OK                                   3IO47590
       TRA     LOO7                RETENTION NOT EXPIRED                3IO47600
       ZET     DHDR                DISK-                               $3IO47610
       TRA     LOO4                YES                                 $3IO47620
LOO5   AXC     1,1                                                      3IO47630
       ZET     HHDR                                                     3IO47640
       AXC     5,1                                                      3IO47650
       LDQ     ASTER                                                    3IO47660
       ZET     HHDR                INTRODUCE  ***** AS                  3IO47670
       RQL     6                   REEL SERIAL NUMBER                   3IO47680
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO47690
       STQ     LAREA,1                                                  3IO47700
       TXI     *+1,4,LOOA-1                                             3IO47710
       TXL     LOO2A,4,0                                                3IO47720
       CAL     LOO8                -INVALID REEL                       *3IO47730
       TRA     *+2                                                      3IO47740
LOO7   CAL     LOO9                                                     3IO47750
       TSX     LBERR,4             PRINT LABEL ERROR                    3IO47760
       XEC     SWTE                AND CAUSE ... IF SENSE SWITCH        3IO47770
       TRA     LOOA                IS DOWN ACCEPT AS OK                $3IO47780
LOO2   ZET     DHDR                                                    $3IO47790
       TRA     LOO4                DISK                                $3IO47800
       BES     *-2+NOCH/NOCH*2-*                                        3IO47810
       AXC     1,1                                                     *3IO47820
       ZET     HHDR                                                    *3IO47830
       AXC     5,1                                                     *3IO47840
LOO2A  AXC     3,4                 IF TAPE WAS INITIALLY                3IO47850
       CAL     LAREA,1             AT LOAD POINT PLACE REEL            *3IO47860
       NZT     TEMP                SERIAL NUMBER INTO UCW               3IO47870
       SLW*    0,2                 WORD 4. IF NOT AT LOAD POINT         3IO47880
       CAL*    0,2                 PICK UP TAPE SERIAL NUMBER           3IO47890
       SLW     LAREA,1             FROM UCW WORD 4 AND PLACE           *3IO47900
       ZET     HHDR                IN LABEL AREA FOR FILE S/N          *3IO47910
       SLW     11,2                                                    *3IO47920
       LFT     OPEND                                                    3IO47930
       TRA     *+3                 IF FILE SERIAL IS                   *3IO47940
       NZT     6,2                 ZERO THEN ASSIGN REEL                3IO47950
       SLW     6,2                 SERIAL AS FILE SERIAL NUMBER         3IO47960
       ZET     TEMP                UNLESS TAPE WERE AT LD PT            3IO47970
       TRA     *+3                 INITIALLY, SKIP                      3IO47980
       TSX     NDSEL+1,4           BSR OF LABEL READ                   *3IO47990
       PZE     0,2,BSROP                                                3IO48000
LOO4   XEC     LABRT5              PREPARE LABEL RECORD                $3IO48010
       TSX     LBDNW,4             SET LABEL DENSITY FOR WRITING        3IO48020
       TSX     WRLAB,4             WRITE LABEL                         $3IO48030
       TRA     LOO6                EOT-CAUSE REEL SWITCH                3IO48040
       LFT     OPEND               IF FILE BEING                        3IO48050
       TRA     LOO3-1              OPENED PRINT                         3IO48060
       TSX     DRANO,4             LABEL ON LINE                        3IO48070
       AXT     LMSG9,4                                                 *3IO48080
       ZET     DHDR                                                    *3IO48090
       AXT     DLABEL,4            ''DISK FILE LABEL''                 $3IO48100
       BES     *-2+NOCH/NOCH*2-*                                        3IO48110
       NZT     HHDR                                                    *3IO48120
       TRA     *+3                                                     *3IO48130
       TSX     AB00,4                                                  *3IO48140
       AXT     HLABEL,4            ''HYPERTAPE LABEL''                 *3IO48150
       BES     *-4+NOHYP/NOHYP*4-*                                      3IO48160
       SXA     LOO2.6,4                                                *3IO48170
       CLA     1,2                 INSERT                              $3IO48180
       LGR     17                  LABEL DENSITY                       $3IO48190
       CLA     LMSG9+4             INTO MESSAGE                         3IO48200
       TQP     *+2                                                      3IO48210
       CLA     LMSG9+3                                                  3IO48220
       STO     LMSG9+1                                                  3IO48230
       TSX     PROUT,4                                                  3IO48240
       PZE     5                                                       *3IO48250
       MZE     MESS1,,2            '' UNIT ***** **FILE-NAME**''        3IO48260
       MZE     9,2,3               ''LABEL HIGH DENSITY'' OR            3IO48270
LOO2.6 PZE     LMSG9,,3            ''LABEL LOW DENSITY''               $3IO48280
       PZE     LAREA,,12                                                3IO48290
       PZE     LAREA1+2,,4+512*DBLSP                                   *3IO48300
       TSX     DENSE,4                                                  3IO48310
LOO3   AXT     **,4                RESTORE IR4                          3IO48320
       AXT     **,1                AND IR1                              3IO48330
       TRA     1,1                 EXIT                                 3IO48340
*                   EOT OCCURRED WHILE WRITING LABEL                    3IO48350
LOO6   TSX     NDSEL+1,4           WRITE EOF SIGNIFYING                 3IO48360
       PZE     0,2,WEFOP           END DATA                             3IO48370
       NOP                         IGNORE EOT                           3IO48380
       CAL     1EOR                PREPARE AND                          3IO48390
       XEC     LABRT4              WRITE EOR                            3IO48400
       TSX     WRLAB,4             TRAILER                              3IO48410
       NOP                         (IGNORING EOT)                       3IO48420
       TSX     SWITCH,1            SWITCH REELS                         3IO48430
       TRA     LOOZ                CONTINUE ON NEXT REEL                3IO48440
*                SHORT LABEL RECORD ON REEL TO BE USED                  3IO48450
LOO10  CAL     LOO11               PRINT '' NO LABEL ERROR              3IO48460
       TSX     LBERR,4             AND STOP                             3IO48470
       XEC     SWTE                IF SENSE SWITCH IS DOWN              3IO48480
       TRA     LOO1-3              ACCEPT REEL AS OK                    3IO48490
       TRA     LOOA-1              ELSE RUN AND RETRY                   3IO48500
SWING  PZE     0                                                    (12)3IO48505
LOO8   PZE     LMSG2,,4            ''OUTPUT REEL INVALID''              3IO48510
LOO9   PZE     LMSG3,,4            ''RETENTION NOT EXPIRED''            3IO48520
LOO11  PZE     LMSG4,,4+512*DBLSP  ''NO LABEL,BLANK CREATED''           3IO48530
DHDR   PZE     **                  DISK HEADER                         $3IO48540
HHDR   PZE     **                  HYPERTAPE HEADER                    *3IO48550
       TTL                         LABEL CLOSE OUTPUT FILE              3IO48560
*      TSX     LABCO,1                                                  3IO48570
*      RETURN                                                           3IO48580
       SPACE   1                                                        3IO48590
LABCO  SXA     LOO3,4              SAVE IR4                             3IO48600
       SXA     LOO3+1,1            AND IR1                              3IO48610
       TSX     LBSET,1             SETUP IMAGE CALLS                    3IO48620
       CAL     1EOF                PREPARE AND                          3IO48630
LCO1   XEC     LABRT4              WRITE EOF                            3IO48640
       TSX     WRLAB,4             TRAILER                              3IO48650
       TRA     LOO3                IGNORE EOT (IOEX DOES RECORD IT)     3IO48660
       TRA     LOO3                EXIT                                 3IO48670
       SPACE   1                                                        3IO48680
*                         LABEL OUTPUT AT EOT                           3IO48690
       SPACE   1                                                        3IO48700
*      TSX     LBEOT,1                                                  3IO48710
*      RETURN                                                           3IO48720
       SPACE   1                                                        3IO48730
LBEOT  SXA     LOO3,4              SAVE IR4                             3IO48740
       SXA     LOO3+1,1            AND IR1                              3IO48750
       TSX     LBSET,1             SETUP IMAGE CALLS                    3IO48760
       CAL     1EOR                FORM AND WRITE                       3IO48770
       TRA     LCO1                EOR TRAILER                          3IO48780
       SPACE   1                                                        3IO48790
*                       DENSITY SETTING ROUTINES                        3IO48800
*                    FOR LABEL READING AND WRITING                      3IO48810
       SPACE   1                                                        3IO48820
*      TSX     LBDNR,4             SET READ  DENSITY                    3IO48830
*      TSX     LBDNW,4             SET WRITE DENSITY                    3IO48840
       SPACE   1                                                        3IO48850
LBDNR  CLA     1,2                 SET DENSITY                          3IO48860
       ARS     2                   LABEL READING                        3IO48870
       TRA     DENSE+1                                                  3IO48880
LBDNW  CLA     1,2                 SET DENSITY                          3IO48890
       ARS     1                   LABEL WRITING                        3IO48900
       TRA     DENSE+1                                                  3IO48910
       TTL                         FORWARD SPACE FILE                   3IO48920
*      TSX     SKIP,4                                                   3IO48930
       SPACE   1                                                        3IO48940
SKIP   SXA     SK1,4               SAVE IR4                             3IO48950
       ZET     HHDR                                                    *3IO48960
       TRA     SK3                                                     *3IO48970
       CAL     SK2                 PLACE SKIP SELECT                    3IO48980
       AXC     1,4                 IN UNIT CONTROL                      3IO48990
       ORS*    0,2                 WORD                                 3IO49000
SKXWT  CLA     *+1                 SET                                  3IO49010
       STA     WAIT                WAIT FOR TRAP                        3IO49020
       TSX     ACTV+1,4            ACTIVATE WITH                        3IO49030
       MZE     0,2                 PRIORITY                             3IO49040
       XEC     WAIT                WAIT                                 3IO49050
*                  HYPERTAPE SKIP FILE                                  3IO49060
SK3    LDQ     1,2                                                     $3IO49070
       RQL     18                                                      $3IO49080
       TQP     *+4                 NOT IN READ BACKWARD MODE           $3IO49090
       TSX     (NDSLX,4                                                $3IO49100
       PZE     0,2,HBSFP           BACKSPACE FILE                      $3IO49110
       TRA     *+3                                                     $3IO49120
       TSX     (NDSLX,4            SKIP FILE                           $3IO49130
       PZE     0,2,HSKFP                                               $3IO49140
       BES     SK3+NOHYP/NOHYP**-NOHYP/NOHYP*SK3-*                      3IO49150
*                    RETURNS HERE WHEN EOF REACHED                      3IO49160
SK1    AXT     **,4                RESTORE IR4                          3IO49170
       TRA     1,4                 EXIT                                 3IO49180
SK2    PZE     SSL1,,SKSEL         SELECT CALL WORD                     3IO49190
       TTL                   READ OR WRITE LABEL                        3IO49200
*      TSX     RDLAB,4                                                  3IO49210
*              EOF OR SHORT RECORD RETURN                               3IO49220
*              NORMAL RETURN                                            3IO49230
*      TSX     WRLAB,4                                                  3IO49240
*              EOT OR SHORT RECORD WRITTEN (CAN'T HAPPEN)               3IO49250
*              NORMAL RETURN                                            3IO49260
       SPACE   1                                                        3IO49270
RDLAB  STZ     RWL3                                                   *$3IO49280
       SXA     WRL2,4                                                  *3IO49290
       AXT     4,4                 BLANK OUT WORDS 17-20               *3IO49300
       CLA     BLNKS               IN CASE IT IS NECESSARY             *3IO49310
       STO     LAREA1+6,4          TO PRINT LABEL                      *3IO49320
       TIX     *-1,4,1                                                 *3IO49330
       CLA     5,2                 IS THIS DISK                        $3IO49340
       TMI     RDLBD               YES                                 $3IO49350
       CLA     RWL1                                                    $3IO49360
RWL5   LDQ     1,2                                                     *3IO49370
       RQL     18                  READ BACKWARD                       *3IO49380
       TQP     RWL4                NO                                  *3IO49390
       ORA     SIX                                                     *3IO49400
       BES     RWL5+NOHYP/NOHYP**-NOHYP/NOHYP*RWL5-*                    3IO49410
       TRA     RWL4                                                    *3IO49420
WRLAB  CLA     5,2                 IS THIS DISK                        $3IO49430
       TMI     WRLBD               YES                                 $3IO49440
       CLS     RWL1                                                    $3IO49450
       STL     RWL3                                                     3IO49460
       SXA     WRL2,4              SAVE IR4                           *$3IO49470
RWL4   AXC     1,4                 SAVE FILE                            3IO49480
       STO*    0,2                 STORE SELECT WORD                   $3IO49490
       TRA     SKXWT                                                    3IO49500
RWL1   PZE     LSL1,,LBSEL         SELECT WORD                         $3IO49510
RWL3   PZE     **                  RD OR WR LABEL SWITCH                3IO49520
SERSW  PZE     **                  SENSE SWITCH TEST CELL SEARCHING     3IO49530
LH11   PZE     **                  LABEL SEARCHING SWITCH               3IO49540
       TTL                         RETURN HERE WHEN LABEL I/O COMPLETED 3IO49550
WRL1   NZT     RWL3                IF WRITE LABEL                      $3IO49560
       TRA     WRL2                THEN WRITE EOF                       3IO49570
       TSX     NDSEL+1,4           ALSO                                 3IO49580
       PZE     0,2,WEFOP                                                3IO49590
       NOP                         IGNORE EOT                           3IO49600
WRL2   AXT     **,4                RESTORE IR4                          3IO49610
       CLA     LBSHS               IF LABEL I/O HISTORY                 3IO49620
       TZE     2,4                 CELL IS ZERO THEN OK EXIT            3IO49630
*        READ GOT EOF OR NOT A SHORT LENGTH RECORD. WRITE GOT EOT       3IO49640
       AXT     13,4                BLANK OUT LABEL AREA                *3IO49650
       LDQ     BLNKS               LABEL RECORD                         3IO49660
       STQ     LAREA+14,4          BLANK OUT LABEL                      3IO49670
       TIX     *-1,4,1             AREA                                 3IO49680
       AXT     6,4                                                     *3IO49690
       STQ     LAREA1+6,4                                              *3IO49700
       TIX     *-1,4,1                                                 *3IO49710
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO49720
       LDQ     BLNK                SET UP                               3IO49730
       STQ     LAREA               STANDARD                             3IO49740
       LDQ     ASTER               BLANK LABEL                          3IO49750
       AXC     1,4                                                     *3IO49760
       ZET     HHDR                                                    *3IO49770
       AXC     5,4                 ****** AS                           *3IO49780
       STQ     LAREA,4             REEL SERIAL NUMBER                  *3IO49790
       LXA     WRL2,4              RESTORE IR4                          3IO49800
       TRA     1,4                 TAKE LABEL ERROR EXIT                3IO49810
       SPACE   1                                                        3IO49820
*                         SPECIAL SELECTS FOR                           3IO49830
*                          FORWARD SPACE FILE                           3IO49840
*                        READ AND WRITE LABELS                          3IO49850
       SPACE   1                                                        3IO49860
SKSEL  TMI     SKSM                SEL+ OR SEL-                         3IO49870
       STZ*    (RCTXI              NO REDUN CHECK FOR FORWARD SPACING  $3IO49880
*                             LABEL SEL+                                3IO49890
LBSEL  TMI     LBSM                LABEL SEL-                           3IO49900
       SXA     S3,4                SAVE IR4                             3IO49910
       SXA     S3+1,1              IR1                                  3IO49920
       PAC     0,4                 -L(UCW) TO IR4                       3IO49930
       CLA     1,4                 SET L(RCHX)                          3IO49940
       STA*    (RCHXI                                                   3IO49950
       CAL     0,4                 UNIT TO AC DECREMENT                 3IO49960
       STZ     SYSJOB+2                                                 3IO49961
       NZT     HHDR                                                    *3IO49970
       TRA     RWRS                ISSUE SELECT                         3IO49980
*                            HYPERTAPE SEL+                             3IO49990
LSL3   ANA     DEC15               HYPER UNIT NUMBER                   *3IO50000
       ORA     HYSEL               (120600120112)                      *3IO50010
       LDI     1,4                                                     $3IO50020
       LFT     200000                                                  $3IO50030
       ORA     L(64D)                                                  $3IO50040
       SLW     LPRFF                                                   *3IO50050
       CLA     LSL4                CONTROL AND READ                    *3IO50060
       ZET     RWL3                                                    *3IO50070
       CLA     LSL4+1              CONTROL AND WRITE                   *3IO50080
       STO     LSL2+2                                                  *3IO50090
       AXT     LSL5+1,2                                                $3IO50100
       LFT     200000                                                  *3IO50110
       AXT     LSL5+4,2                                                $3IO50120
       SXA     LSL5,2                                                  $3IO50130
       CAL     LPRFI                                                   *3IO50140
       LFT     200000              READ BACKWARD                       *3IO50150
       ORA     HSMSR               YES                                 *3IO50160
       LDI     0,4                                                     *3IO50170
       LFT     000040              INTERFACE 2                         *3IO50180
       ORA     L(1)                YES                                 *3IO50190
       SLW     LSL2                                                    *3IO50200
       CLA     *-1                                                     $3IO50210
       STA*    (RCHXI                                                  $3IO50220
       TRA     SELCT+1             ISSUE SELECT                        *3IO50230
       BES     LSL3+NOHYP/NOHYP**-NOHYP/NOHYP*LSL3-*                    3IO50240
LSL1   IORT    LAREA,,14           I/O LABEL                            3IO50250
LSL2   SMS     **                                                      *3IO50260
       LIPT    *+1                 IN CASE OF INTERRUPT                *3IO50270
       PZE     LPRFF               (1206XX120112)                      *3IO50280
LSL5   TCH     **                                                      $3IO50290
       CPYP    LAREA,,14                                               *3IO50300
       CPYD    LAREA1,,6                                               *3IO50310
       TCH     SYSTWT                                                  *3IO50320
       CPYP    LAREA1+5,,6                                             $3IO50330
       CPYD    LAREA+13,,14                                            $3IO50340
       TCH     SYSTWT                                                  $3IO50350
LSL4   CTLR    LPRFF                                                   *3IO50360
       CTLW    LPRFF                                                   *3IO50370
       BES     LSL2+NOHYP/NOHYP**-NOHYP/NOHYP*LSL2-*                    3IO50380
SSL1   IOCPN   **,,32767           IO FORWARD                           3IO50390
       TCH     *-1                 SPACE FILE                           3IO50400
SCHLS  IORT    LAREA+14,,LSL1+1    SCHX COMPARE FOR LABEL LENGTH CHECK  3IO50410
LBSHS  PZE     **                  SPECIAL SELECT HISTORY CELL          3IO50420
       TTL     POSTING ROUTINES FOR SPECIAL LABEL SELECTS               3IO50430
*                            TAPE SKIP SEL-                             3IO50440
SKSM   PAC     SK1,2               -L(UCW) TO IR2                       3IO50450
       CLA     *-1                 SET NO WAIT                          3IO50460
SKS1   STA     WAIT                IN WAIT SWITCH                       3IO50470
       STZ     1,2                 CLEAR UCW PRIORITY                   3IO50480
       TRA     1,4                 EXIT                                 3IO50490
*                            TAPE LABEL SEL-                            3IO50500
LBSM   PAC     WRL1,2                                                  *3IO50510
       ZET     HHDR                                                    *3IO50520
       TRA     LBS3                                                    *3IO50530
       LNT     400000              IF SHORT RECORD ( 2 WORD REDUN)     *3IO50540
       TRA     2,4                 IGNORE IT ( IT IS NOISE)             3IO50550
       RIS     XCPT2               STORE EOF OR EOT BIT                 3IO50560
       STI     LBSHS               IN HISTORY CELL                      3IO50570
       CAL     COMM                COMPARE SCHX VALUE                   3IO50580
       LAS     SCHLS               WITH PREDICTED TO CHECK              3IO50590
       STL     LBSHS                                                    3IO50600
       TRA     *+2                                                      3IO50610
       STL     LBSHS                                                    3IO50620
LBS2   CLA     LBSM                SET UP WAIT                          3IO50630
       TRA     SKS1                RETURN ADDRESS                       3IO50640
*                            HYPERTAPE SEL-                             3IO50650
LBS3   STZ     LBSHS               RESET ERROR SWITCH                  *3IO50660
       LFT     007100                                                  *3IO50670
       TRA     LBS2-1              ERROR                                3IO50680
       TRA     LBS2                NO ERRORS                           *3IO50690
       BES     LBS3+NOHYP/NOHYP**-NOHYP/NOHYP*LBS3-*                    3IO50700
       SPACE   1                                                        3IO50710
*               TRAP WAITING FOR SKIP AND LABEL SELECTS                 3IO50720
WAIT   TRA     **                  WAIT                                 3IO50730
       TTL              DISK LABEL ROUTINES                             3IO50740
       SPACE                                                           $3IO50750
RDLBD  LDQ     RWL1D               DISK READ SELECT WORD               $3IO50760
       LXA     WRL2,4                                                  *3IO50770
       TRA     *+2                                                     $3IO50780
WRLBD  LDQ     RWL2D               DISK WRITE SELECT WORD              $3IO50790
       SXA     WRL2D,4             SAVE IR4                            $3IO50800
       CAL     0,2                                                     *3IO50810
       PAC     ,4                  UCB                                 $3IO50820
       ZET     1,4                 WAIT FOR FREE ARM                   $3IO50830
       TRA     *-1                                                     $3IO50840
       STQ     1,4                 STORE SELECT WORD                   $3IO50850
       ARS     18                                                      $3IO50860
       NZT     DHDR                HEADER OR TRAILER                   $3IO50870
       TRA     TRAIL               TRAILER                             $3IO50880
       STA     3,4                 SEEK ADDRESS TO UCB                 $3IO50890
       TQP     *+2                 READING LABEL                       $3IO50900
       TRA     *+3                 WRITING LABEL                       $3IO50910
       LFT     003000              UNLESS                              $3IO50920
       TRA     *+3                 READING OUTPUT LABEL                $3IO50930
       ADD     L(1)                UP TRACK COUNT                      $3IO50940
       STA     6,2                                                     $3IO50950
       CLA     6,2                                                     $3IO50960
       ARS     6                                                       $3IO50970
       ANA     MSK1                HA2 TO FDAMT                        $3IO50980
       ORA     L(6)                FOR SMS                             $3IO50990
       STP     6,2                 MAKE ZERO                           $3IO51000
       STO     SMSX                                                    $3IO51010
       TRA     *+3                                                     $3IO51020
TRAIL  SUB     L(1)                SEEK ADDRESS                        $3IO51030
       STA     3,4                 TO UCB                              $3IO51040
       CLS     2,4                                                     $3IO51050
       STO     2,4                 SET ACTIVITY FLAG                   $3IO51060
       CAL     3,4                                                     *3IO51070
       TSX     (DECVA,4                                                *3IO51080
       STQ     TEMP                                                    *3IO51090
       TRA     SKXWT               GO ACTIVATE                         $3IO51100
WRL2D  AXT     **,4                                                    $3IO51110
       TRA     2,4                                                     $3IO51120
RWL1D  PZE     LSL1D,,LBSLD                                            $3IO51130
RWL2D  MZE     LSL2D,,LBSLD                                            $3IO51140
LBSLD  SXA     SAV,4                                                   $3IO51150
       PAC     ,4                                                      $3IO51160
       TMI     LBSDM               SEL(-)                              $3IO51170
       LDQ     TEMP                TTTT  TO MQ                         *3IO51180
       TSX     (FDAMT,2            PREPARE ORDER                       $3IO51190
SMSX   OCT     000012120006                                            $3IO51200
       PZE     DVTN                                                    $3IO51210
       CLA     1,4                                                     $3IO51220
       STA*    (RCHXI                                                  $3IO51230
       XEC*    (RCHXI                                                  $3IO51240
SAV    AXT     **,4                                                    $3IO51250
       TRA     1,4                                                     $3IO51260
LBSDM  CLA     WRLBD+1                                                 $3IO51270
       STA     WAIT                                                    $3IO51280
       STZ     1,4                                                     $3IO51290
       TRA     SAV                                                     $3IO51300
DVTN   DVTN    ,,                                                      $3IO51310
LSL1D  SMS*    SMSX                                                    $3IO51320
       CTLR    DVTN                                                    $3IO51330
       TCH     *+3                                                     $3IO51340
LSL2D  SMS*    SMSX                                                    $3IO51350
       CTLW    DVTN                                                    $3IO51360
       CPYD    LAREA,,14                                               $3IO51370
       TCH     SYSTWT                                                  $3IO51380
       BES     RDLBD+NOCH/NOCH**-NOCH/NOCH*RDLBD-*                     $3IO51390
       TTL         MESSAGE ROUTINE FOR ALL TYPES OF LABEL ERRORS        3IO51400
*                                                                       3IO51410
*      TSX     LBERR,4        AC= ERROR PROUT PARAM                     3IO51420
*      RETURN       AFTER PAUSE                                         3IO51430
       SPACE   1                                                        3IO51440
LBERR  SXA     LBR1,4              SAVE IR4                             3IO51450
       SLW     LBR0                STORE MESSAGE PARAM                  3IO51460
       TSX     DRANO,4             FIND UNIT ADDRESS                    3IO51470
       ZET     HHDR                                                    *3IO51480
       TSX     AB00,4                                                  *3IO51490
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO51500
       TSX     PROUT,4             PRINT                                3IO51510
       PTW     7                                                     $5$3IO51520
       MZE     MESS1,,2            ''UNIT ***** **FILE-NAME**           3IO51530
       MZE     9,2,3               LABEL ERROR''                        3IO51540
       PZE     LMSG8,,2            '' ** LABEL ** ''                    3IO51550
       PZE     LAREA,,12           '' ADDITIONAL MESSAGE ''             3IO51560
       PZE     LAREA1+2,,4                                             *3IO51570
LBR0   PZE     **,,**              ''IF SSW * DOWN IGNORED''            3IO51580
       PZE     LMSG6,,4                                                 3IO51590
       TSX     PAUSE,4,1     PAUSE                                   $5$3IO51600
LBR1   AXT     **,4                RESTORE IR4                          3IO51610
       TRA     1,4                 EXIT                                 3IO51620
*                                                                       3IO51630
*              THIS ROUTINE BLANKS THE CHECKPOINT INDICATOR             3IO51640
*              AND BLOCK COUNT IF FOUND TO BE ZERO,THUS                 3IO51650
*              PROVIDING A NEATER ON-LINE PRINT OUT                     3IO51660
*                                                                       3IO51670
*      TSX     AB00,4              MUST BE HYPERTAPE LABEL              3IO51680
*      RETURN                                                           3IO51690
*                                                                       3IO51700
AB00   CAL     LAREA+10                                                *3IO51710
       LBT                         SET CHECKPOINT INDICATOR            *3IO51720
       ORA     BL1K                TO BLANK IF ZERO                    *3IO51730
       SLW     LAREA+10                                                *3IO51740
       CAL     BLNKS                                                   *3IO51750
       NZT     LAREA+11            IF BLOCK COUNT IS ZERO,             *3IO51760
       SLW     LAREA+11            SET TO BLANKS                       *3IO51770
       TRA     1,4                                                     *3IO51780
       BES     AB00+NOHYP/NOHYP**-NOHYP/NOHYP*AB00-*                    3IO51790
       TTL                         LABEL MESSAGES                       3IO51800
LMSG1  BCI     3,INPUT REEL INVALID                                     3IO51810
LMSG2  BCI     4, OUTPUT REEL INVALID                                   3IO51820
LMSG3  BCI     4, RETENTION NOT EXPIRED                                 3IO51830
LMSG4  BCI     4, NO LABEL, BLANK CREATED                               3IO51840
LMSG5  BCI     3, MOUNT LAB. BLANK                                      3IO51850
LMSG6  BCI     1,IF SSW            * DOWN IGNORED                       3IO51860
       VFD     O6/60,6/LERIG,O24/60244666                               3IO51870
       BCI     2,N IGNORED                                              3IO51880
LMSG8  BCI     2,LABEL ERROR                                            3IO51890
LMSG9  BCI     5,LABEL **** DENSITYHIGH D LOW D                         3IO51900
LMG10  BCI     1, FOUND                                                 3IO51910
LMG11  BCI     2, NO TRAILER                                            3IO51920
LMG12  BCI     6, SEARCH SKIP LIST FOLLOWS... IF SSW  * DOWN REMOUNT    3IO51930
       VFD     6/LERIG,O30/6024466645                                   3IO51940
       BCI     2, REMOUNT                                               3IO51950
LMG13  BCI     4,  INPUT REEL,NO LABEL   TAPE POSITIONED AFTER 1ST REC  3IO51960
DLABEL BCI     3,DISK FILE LABEL                                       $3IO51970
       BES     *-3+NOCH/NOCH*3-*                                        3IO51980
HLABEL BCI     3, HYPERTAPE LABEL                                       3IO51990
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO52000
       TTL                         LABEL CHECK INPUT FILE               3IO52010
*      TSX     LCKIN,1  XEC  LABRT1                                     3IO52020
*      RETURN  LABEL OK                                                 3IO52030
*      RETURN  LABEL ERROR                                              3IO52040
       SPACE   1                                                        3IO52050
*  THIS ROUTINE COMPARES     1. FILE SERIAL NUMBER  ) FOR TAPE ONLY    $3IO52060
*                            2. REEL SEQUENCE NUMBER)                  $3IO52070
*                            3. 18 CHARACTER FILE NAME                  3IO52080
       SPACE   1                                                        3IO52090
LCKIN  SXA     LCKI7,1                                                  3IO52100
       CAL     FCW                 PLACE L(FILE)+12                     3IO52110
       ACL     L(12)               INTO COMPARE                         3IO52120
       STA     LCKI2                                                    3IO52130
       STZ     CHPSI               ZERO ERROR SWITCH                   $3IO52140
       ZET     HHDR                                                    *3IO52150
       TRA     LCK14               7340                                *3IO52160
LCKI4  NZT     DHDR                                                     3IO52170
       TRA     *+5                                                     $3IO52180
       AXT     3,4                 DISK                                $3IO52190
       AXT     3,1                                                     $3IO52200
       LDQ     L(0)                                                    $3IO52210
       TRA     LCKI1                                                   $3IO52220
       BES     LCKI4+NOCH/NOCH**-NOCH/NOCH*LCKI4-*                      3IO52230
       AXT     6,1                 COMPARE                              3IO52240
       AXT     8,4                 FILE WD. TO LABEL WD.                3IO52250
       LDQ     L(12)               7 3                                 $3IO52260
LCKI1  CAL     LAREA+10,4          8 4                                  3IO52270
       NZT*    *+2                 IF FILE NAME FIRST 6 CHAR            3IO52300
       TRA     *+4                 =0 SKIP NAME CHECK                  $3IO52310
LCKI2  ERA     **,1                ERROR CHECK                          3IO52320
       TZE     *+2                 IF ERROR                            $3IO52330
       STO     CHPSI               SET ERROR SWITCH                    $3IO52340
       TQP     *+3                                                      3IO52350
       TXI     *+1,1,-1                                                 3IO52360
       TXI     *+2,4,-4                                                 3IO52370
       TXI     *+1,4,-1                                                 3IO52380
       RQL     1                                                        3IO52390
       TIX     LCKI1,1,1                                                3IO52400
LCKI5  RIL     MXDMD+MODE+CKSUMS+BLKSEQ                             (12)3IO52410
       CAL     LAREA                                                   *3IO52420
       ERA     BLNK                BYPASS IF BLANK LABEL               *3IO52430
       TZE     LCKI3                                                   *3IO52440
       AXT     0,4                                                     *3IO52450
       ZET     HHDR                                                    *3IO52460
       AXC     1,4                                                     *3IO52470
       STI     TEMIND                                                   3IO52480
       PXA     0,0                                                     *3IO52490
       LDI*    LCK10,4                                                 *3IO52500
       XEC     LCK11,4                                                 *3IO52510
       ORA     FOR                 MIXED MODE                          *3IO52520
       XEC     LCK12,4                                                 *3IO52530
       ORA     MODBT               BINARY                              *3IO52540
       RNT     000100                                                  *3IO52550
       TRA     *+4                 NO BLOCK SEQUENCE                   *3IO52560
       RFT     010000                                                  *3IO52570
       ORA     L(64D)              BLOCK SEQUENCE AND CHECKSUMS        *3IO52580
       ORA     2P2                 BLOCK SEQ.,BUT NO CHECKSUMS         *3IO52590
       LDI     TEMIND                                                   3IO52600
       OAI                         BLOCK SEQUENCE AND CHECKSUMS        $3IO52680
       PIA                                                          (12)3IO52682
       NZT     SWING                                                (12)3IO52683
       STP     1,2                                                  (12)3IO52684
LCKI3  TSX     LPRFD-2,4                                               *3IO52690
       PZE     **                  OPTIONAL LABELS                     *3IO52700
       BES     *-2+NOHYP/NOHYP*2-*                                      3IO52710
LCKI7  AXT     **,1                                                     3IO52720
       NZT     CHPSI               TEST ERROR SWITCH                   $3IO52730
       TRA     1,1                 EXIT                                $3IO52740
       TRA     2,1                 ERROR EXIT                          $3IO52750
*        LABEL CHECK HYPERTAPE INPUT HEADER                             3IO52760
LCK14  CAL     LAREA+2                           DDDIII                *3IO52770
       LDQ     LAREA+3                                     IIIIII      *3IO52780
       LGL     18                                IIIIII    III000      *3IO52790
       ERA     9,2                 FILE IDENTIFICATION                 *3IO52800
       TNZ     LCK15                                                   *3IO52810
       LGL     18                                XXXIII    000000      *3IO52820
       LDQ     LAREA+4                                     ISSSSS      *3IO52830
       LGL     6                                 XXIIII    SSSSS0      *3IO52840
       ALS     12                                IIII00                *3IO52850
       ORA     BL2K                              IIIIBB                *3IO52860
       ERA     10,2                FILE IDENTIFICATION                 *3IO52870
       TNZ     LCK15                                                   *3IO52880
       XCL                                       SSSSS0    XXXXXX      *3IO52890
       ARS     6                                 0SSSSS                *3IO52900
       ORA     BLK1                              BSSSSS                *3IO52910
       ERA     6,2                 FILE SERIAL NUMBER                  *3IO52920
       TNZ     LCK15                                                   *3IO52930
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *3IO52940
       RQL     6                                 XXXXXX    RRRRBB      *3IO52950
       XCL                                       RRRRBB                *3IO52960
       ERA     LAREA+6             REEL SEQUENCE NUMBER                *3IO52970
       TZE     *+2                                                     *3IO52980
LCK15  STL     CHPSI               ERROR SWITCH                        *3IO52990
       LDQ     1,2                                                     *3IO53000
       RQL     18                  IN READ BACKWARD MODE               *3IO53010
       TQP     LCKI5               NO                                  *3IO53020
*                  CONVERT BLOCK COUNT FROM BCD TO BINARY               3IO53030
       AXT     36,4                                                    *3IO53040
       LDQ     LAREA+11            BLOCK COUNT                         *3IO53050
       STZ     TEMP                                                    *3IO53060
       PXD     0,0                                                     *3IO53070
LCKI6  LGL     6                   GET NEXT DIGIT                      *3IO53080
       ACL     TEMP                                                    *3IO53090
       TNX     *+7,4,6                                                 *3IO53100
       STQ     RWL3                                                    *3IO53110
       XCL                                                             *3IO53120
       MPY     L(12A)                                                  *3IO53130
       STQ     TEMP                SAVE PARTIAL PRODUCT                *3IO53140
       LDQ     RWL3                                                    *3IO53150
       TRA     LCKI6                                                   *3IO53160
       ALS     18                                                      *3IO53170
       STD     3,2                                                     *3IO53180
       TRA     LCKI5                                                   *3IO53190
       BES     LCK14+NOHYP/NOHYP**-NOHYP/NOHYP*LCK14-*                  3IO53200
LCK10  LDI     LAREA+6                                                 *3IO53210
       LDI     LAREA+7                                                 *3IO53220
LCK11  LFT     2                                                       *3IO53230
       RFT     4                                                       *3IO53240
LCK12  LFT     1                                                       *3IO53250
       RFT     1                                                       *3IO53260
LCK13  LDQ     LAREA+6                                                 *3IO53270
       LDQ     LAREA+10                                                *3IO53280
       TTL              TRAILER CHECK INPUT FILE                        3IO53290
*      TSX     TCKIN,1  XEC  LABRT2                                     3IO53300
*      RETURN IF OK           TAKES SEQEX IF SEQ CHECK FAILS            3IO53310
*      AT EITHER RETURN  MQ +  EOR TRAILER                              3IO53320
*                        MQ -  HDR TRAILER (READ BACKWARD)              3IO53330
*                        MQ -  EOF TRAILER                              3IO53340
*                                                                       3IO53350
TCKIN  STI     TEMP                SAVE INDICATORS,NEED TAG            *3IO53360
       LDI     1,2                 FOR READ BACKWARD BIT               *3IO53370
       ONT     MSK2                                                    *3IO53380
       TRA     TCK3                                                    $3IO53390
       CAL     LAREA               CHECKPOINT AND READ BACKWARD        $3IO53400
       ERA     1HDR                                                    *3IO53410
       TZE     TCK3+3              1HDR-NORMAL SITUATION               *3IO53420
       TSX     (NDSLX,4                                                *3IO53430
       PZE     0,2,HBSFP           HYPERTAPE BACKSPACE FILE            *3IO53440
       TSX     RDLAB,4                                                 *3IO53450
       TRA     TCK4                                                    *3IO53460
       BES     *-10+NOHYP/NOHYP*10-*                                    3IO53470
TCK3   CAL     LAREA               PLACE TEMP + IF EOR                *$3IO53480
       ERA     1EOR                - IF EOF                             3IO53490
       TZE     *+2                                                      3IO53500
       SSM                                                              3IO53510
       LDI     TEMP                                                    *3IO53520
       STO     TEMP                CHECK FOR BOTH BCD AND               3IO53530
       CAL     3,2                 SPREAD OCTAL BLOCK COUNT             3IO53540
       TSX     (DECVD,4                                                $3IO53550
       XCL                                                              3IO53560
       SXA     TCK1,1                                                  *3IO53570
       AXC     1,1                                                     *3IO53580
       ZET     HHDR                WORD 2 IF 729,1301                  *3IO53590
       AXC     11,1                IF 7340,WORD 12                     *3IO53600
       ZET     HHDR                                                    *3IO53610
       ANA     MSK3                MASK OUT HIGH ORDER BLANK           *3IO53620
       ERA     LAREA,1                                                 *3IO53630
       TZE     *+4                                                     $3IO53640
       LDQ     3,2                 IF BLOCK COUNTS                     $3IO53650
       TSX     BCD5-1,4            AGREE THEN                           3IO53660
       ERA     LAREA,1             EXIT...ELSE TAKE                    *3IO53670
TCK2   STO     LPROO               SET SEQUENCE CONDITION              *3IO53680
       TSX     LPRFD-2,4           CHECK FOR                           *3IO53690
       PZE     ,,1                 OPTIONAL LABELS                     *3IO53700
       CLA     LPROO                                                   *3IO53710
       BES     TCK2+NOHYP/NOHYP**-NOHYP/NOHYP*TCK2-*                    3IO53720
       LDQ     TEMP                SEQUENCE ERROR EXIT                  3IO53730
       STO     TEMP                SAVE SEQ CONDITION (=0 OK)           3IO53740
TCK1   AXT     **,1                                                    *3IO53750
       TRA     1,1                 EXIT                                 3IO53760
TCK4   TSX     PROUT,4                                                 *3IO53770
       PZE     2                                                       *3IO53780
       MZE     9,2,3               ''FILE-NAME''                       *3IO53790
       PZE     LMG11,,2+512*DBLSP    ''NO TRAILER''                    *3IO53800
       TRA     LCK3                                                    *3IO53810
       BES     TCK4+NOHYP/NOHYP**-NOHYP/NOHYP*TCK4-*                    3IO53820
       TTL     CHECK LABEL OF SUPPOSED USEABLE OUTPUT REEL FOR LEGALITY 3IO53830
*      TSX     LCKOF,1  XEC  LABRT3                                     3IO53840
*      RETURN  USEABLE                                                  3IO53850
*              RETENTION NOT EXPIRED                                   $3IO53860
*              NOT USABLE                                              $3IO53870
       SPACE   1                                                        3IO53880
LCKOF  CAL     LAREA               IF 1ST WORD = 1BLANK                 3IO53890
       ERA     BLNK                REEL OK TO USE                       3IO53900
       TZE     1,1                                                      3IO53910
       CAL     LAREA                                                    3IO53920
       ERA     1HDR                                                     3IO53930
       TNZ     3,1                 REEL NOT USEABLE                     3IO53940
       ZET     HHDR                                                    *3IO53950
       TRA     LCK3                7340                                *3IO53960
       CAL     LAREA+4             IF DATE(CREATION)+ RETENTION DAYS    3IO53970
       ANA     17SS                HAS NOT BEEN REACHED                $3IO53980
       ACL     LAREA+5             THEN TAKE RETENTION NOT              3IO53990
LCK2   TSX     BCDCV,4             EXPIRED EXIT                        $3IO54000
       SLW     RWL3                                                    *3IO54010
       ANA     MSK4                                                    *3IO54020
       LAS     LDOYR               CHECK SUM OVERFLOW                   3IO54030
       TRA     LCK1                TO NEXT YEAR                        $3IO54040
       AXT     0,0                                                      3IO54050
       CAL     RWL3                                                    *3IO54060
       ACL     BLP4                                                    $3IO54070
       LAS     DATE                IF ''SAVE DATE''                     3IO54080
       TRA     2,1                 NOT REACHED                          3IO54090
       TRA     1,1                 THEN REEL IS                         3IO54100
       TRA     1,1                 '' RETENTION PROTECTED''             3IO54110
LCK1   CAL     RWL3                                                    *3IO54120
       ACL     M365                ADD 1 YEAR,SUBTRACT 365 DAYS       *$3IO54130
       TRA     LCK2                                                    *3IO54140
       SPACE   1                                                        3IO54150
*        CHECK RETENTION PERIOD FOR HYPERTAPE                           3IO54160
LCK3   CAL     LAREA+1             RETENTION PERIOD                    *3IO54170
       ARS     12                  00RRRR                              *3IO54180
       TZE     1,1                 NOT APPLICABLE IF ZERO              *3IO54190
       SLW     RWL3                                                    *3IO54200
       CAL     LAREA+1                                                 *3IO54210
       ALS     6                   RRRYY0                              *3IO54220
       LDQ     LAREA+2                     DDDIII                      *3IO54230
       LGR     18                  YY0DDD                              *3IO54240
       XCL                         BEWARE OF Q BIT                     *3IO54250
       ACL     RWL3                                                    *3IO54260
       TRA     LCK2                                                    *3IO54270
       BES     LCK3+NOHYP/NOHYP**-NOHYP/NOHYP*LCK3-*                    3IO54280
       TTL              PREPARE OUTPUT TRAILER                          3IO54290
*         LOGICAL AC MUST CONTAIN EITHER  1EOF  OR 1EOR                $3IO54300
*      TSX     TPROF,1  XEC  LABRT4                                     3IO54310
*      RETURN                                                           3IO54320
       SPACE   1                                                        3IO54330
TPROF  SLW     LAREA               SET 1EOR OR 1EOF                    $3IO54340
       CAL     3,2                 IN TRAILER                           3IO54350
       TSX     (DECVD,4            CONVERT BLOCK                        3IO54360
       ZET     HHDR                COUNT TO DECIMAL                    $3IO54370
       TRA     TPROH               7340                                *3IO54380
       STQ     LAREA+1                                                  3IO54390
       LDQ     0,2                 INSERT IN TRAILER                    3IO54400
       RQL     21                  CONVERT UCW USED                     3IO54410
       TSX     (BCD5X,4            TO SPREAD OCTAL                     $3IO54420
       SLW     LAREA+2             AND INSERT IN TRAILER                3IO54430
       AXT     11,4                FOR POSSIBLE VISUAL                  3IO54440
       LDQ     BLNKS               USE LATER ON                         3IO54450
       STQ     LAREA+14,4                                               3IO54460
       TIX     *-1,4,1                                                  3IO54470
       AXT     6,4                                                     *3IO54480
       LDQ     LAREA1+6,4          BLANK OUT                           *3IO54490
       TIX     *-1,4,1             WORDS 15 TO 20                      *3IO54500
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO54510
       TRA     1,1                 EXIT                                $3IO54520
TPROH  XCL                                                             *3IO54530
       ANA     MSK3                                                    *3IO54540
       SLW     LAREA+11            BLOCK COUNT                         $3IO54550
       LDQ     DATE                                                    *3IO54560
       STL     LPROO                                                   *3IO54570
       AXT     3,4                                                     *3IO54580
       TRA     LPRFC+2                                                 *3IO54590
       BES     TPROH+NOHYP/NOHYP**-NOHYP/NOHYP*TPROH-*                  3IO54600
       TTL                         PREPARE LABEL OUTPUT FILE            3IO54610
*      TSX     LPROF,1  XEC  LABRT5                                     3IO54620
*      RETURN                                                           3IO54630
       SPACE   1                                                        3IO54640
LPROF  CLA     1HDR                SET 1ST WORD                        $3IO54650
       STO     LAREA               = 1HDR                               3IO54660
       LDQ     DATE                5TH                                 $3IO54670
       ZET     HHDR                IF HYPERTAPE GO TO PREPARE          *3IO54680
       TRA     LPRFC               120 CHARACTER HEADER                *3IO54690
       STQ     LAREA+4             =TODAYS DATE                        $3IO54700
       CLA     8,2                 6TH                                 $3IO54710
       STO     LAREA+5             =RETENTION DAYS                     $3IO54720
LPRFG  NZT     DHDR                                                   *$3IO54730
       TRA     LPRFA               TAPE                                $3IO54740
       AXT     3,4                                                     $3IO54750
       CAL     BLNKS                                                   $3IO54760
       SLW     LAREA+4,4                                               $3IO54770
       TIX     *-1,4,1                                                 $3IO54780
       TRA     LPRFB                                                   $3IO54790
       BES     LPRFG+NOCH/NOCH**-NOCH/NOCH*LPRFG-*                      3IO54800
LPRFA  CLA     6,2                 3RD                                 $3IO54810
       STO     LAREA+2             = FILE SERIAL                        3IO54820
       CAL     7,2                 4TH                                  3IO54830
       SLW     LAREA+3             =REEL SEQUENCE NUMBER                3IO54840
LPRFB  CAL     6PRE                FIRST CHARACTER BLANK               $3IO54850
       STI     LAREA+10            SAVE SI TEMPORARILY                  3IO54860
       LDI     1,2                                                      3IO54870
       RFT     FDEN                FILE DENSITY                        $3IO54880
       ACL     L(64D)              =1 IF HI                            $3IO54890
       LFT     MODE                MODE                                 3IO54900
       ACL     1DEC                =1 IF BINARY                         3IO54910
       LFT     400000              IF MIXED MODE                        3IO54920
       ACL     2DEC                =2 OR 3 (M OR N)                     3IO54930
       LFT     CKSUMS              CHECKSUM                             3IO54940
       ACL     1P4                 =1 IF PRESENT                       *3IO54950
       LFT     BLKSEQ              BLOCK SEQ                            3IO54960
       ACL     1P5A                =1 IF PRESENT                       *3IO54970
       LNT     OPEND               IF OPENING                           3IO54980
       TRA     *+3                 NO CHECKPOINT                        3IO54990
       LFT     CP1                 BIT IN LABEL                        $3IO55000
       ACL     L(1)                CKPT BIT                             3IO55010
       SLW     LAREA+6             =1 IF CHECKPOINT FOLLOWS             3IO55020
       LDQ     9,2                 FILE NAME                            3IO55030
       STQ     LAREA+7             TO LABEL                             3IO55040
       LDQ     10,2                                                     3IO55050
       STQ     LAREA+8                                                  3IO55060
       LDQ     11,2                                                     3IO55070
       STQ     LAREA+9                                                  3IO55080
       LDI     LAREA+10            RESTORE SI                           3IO55090
       AXT     4,4                 BLANK OUT                            3IO55100
       CAL     BLNKS               WORDS 11 TO 14                       3IO55110
       SLW     LAREA+14,4                                               3IO55120
       TIX     *-1,4,1                                                  3IO55130
       AXT     4,4                                                     *3IO55140
       SLW     LAREA1+6,4          BLANK OUT                           *3IO55150
       TIX     *-1,4,1             WORDS 15 TO 20                      *3IO55160
       BES     *-3+NOHYP/NOHYP*3-*                                      3IO55170
       TRA     1,1                 EXIT                                $3IO55180
       TTL     PREPARE 120 CHARACTER HEADER                             3IO55190
*                                                                       3IO55200
*          FIELD  WORD  LENGTH  CONTENTS    DESCRIPTION                 3IO55210
*            1      1      6    1XXXBB      LABEL IDENTIFIER            3IO55220
*            2      2      4    RRRR        RETENTION PERIOD            3IO55230
*            3     2-3     5    YYDDD       CREATION DATE               3IO55240
*            4     3-5    10    IIIIIIIIII  FILE IDENTIFICATION         3IO55250
*            5      5      5    SSSSS       FILE SERIAL                 3IO55260
*            6      6      6    NNNNNB      REEL SERIAL                 3IO55270
*            7      7      5    RRRRB       REEL SEQUENCE               3IO55280
*            8     7-8     3                RESERVE                     3IO55290
*            9      8      1    D  (NA)     DENSITY                     3IO55300
*           10      8      1    C           CHECK SUM                   3IO55310
*           11      8      1    S           BLOCK SEQUENCE              3IO55320
*           12      8      1    T           TAPE CHECK/INTERPRET        3IO55330
*           13      9      1    R  (8)      RECORDING TECHNIQUE         3IO55340
*           14      9      1    P  (6)      PROCESSING TECHNIQUE        3IO55350
*           15      9      4    7090(4)     CREATING SYSTEM             3IO55360
*           16     10      1    F           RECORD FORMAT               3IO55370
*           17     10      5    LLLLL       RECORD LENGTH               3IO55380
*           18     11      5    SSSSS       BLOCK SIZE                  3IO55390
*           19     11      1    C           CHECKPOINT                  3IO55400
*           20     12      6    CCCCCC      BLOCK COUNT (TRAILER ONLY)  3IO55410
*          21-26  13-17   28                RESERVE                     3IO55420
*           27    17-20   20                OPTIONAL                    3IO55430
*                                                                       3IO55440
*                                                                       3IO55450
LPRFC  STZ     LPROO               RESET OUTPUT SWITCH                 *3IO55460
       AXT     2,4                                                     *3IO55470
       SXD     LPRFH,4                                                 *3IO55480
       CAL     8,2                 RETENTION     BBRRRR    MMBDDD      *3IO55490
       LGL     12                                RRRRMM    BDDD00      *3IO55500
       SLW     LAREA+1                                                 *3IO55510
       LGL     24                                XXBDDD    000000      *3IO55520
       LDQ     9,2                 IDENT 1-6               IIIIII      *3IO55530
       LGL     18                                DDDIII    III000      *3IO55540
       SLW     LAREA+2                                                 *3IO55550
       LGL     18                                XXXIII    000000      *3IO55560
       NZT     LPROO               DO NOT SET BLOCK                    *3IO55570
       STQ     LAREA+11            COUNT IF TRAILER                    *3IO55580
       LDQ     10,2                IDENT 7-10              IIIIBB      *3IO55590
       LGL     18                                IIIIII    IBB000      *3IO55600
       SLW     LAREA+3                                                 *3IO55610
       LGL     6                                 XXXXXI    BB0000      *3IO55620
       LDQ     6,2                 FILE SERIAL             BSSSSS      *3IO55630
       RQL     6                                           SSSSSB      *3IO55640
       LGR     6                                 0XXXXX    ISSSSS      *3IO55650
       STQ     LAREA+4                                                 *3IO55660
LPRFK  BES     LPRFC+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFC-*                  3IO55670
       LDQ     11,2                REEL SERIAL NUMBER                  *3IO55680
       STQ     LAREA+5                           NNNNNB                *3IO55690
       AXC     3,4                                                     *3IO55700
       ZET     LPROO                                                   *3IO55710
       STQ*    0,2                                                     *3IO55720
       LDQ     7,2                 REEL SEQUENCE NUMBER    BRRRRB      *3IO55730
       RQL     6                                           RRRRBB      *3IO55740
       STQ     LAREA+6                                                 *3IO55750
       STI     LAREA1              HOLD SI TEMPORARILY                 *3IO55760
       LDI     1,2                                                     *3IO55770
       CAL     BB0001              FIRST CHARACTER BLANK               *3IO55780
       LFT     CKSUMS                                                  *3IO55790
       ACL     1P4                 YES                                 *3IO55800
       LFT     BLKSEQ                                                  *3IO55810
       ACL     1P5A                YES                                 *3IO55820
       LNT     MODE                                                    *3IO55830
       ACL     L(1)                BCD                                 *3IO55840
       LFT     400000              BINARY                              *3IO55850
       ACL     L(4)                MIXED MODE                          *3IO55860
       SLW     LAREA+7                                                 *3IO55870
       PXA     0,0                                                     *3IO55880
       OCT     044300012000        DOUBLE LOAD                         *3IO55890
       TZE     *+2                 7090                                *3IO55900
       CAL     L(4)                                                    *3IO55910
LPRFL  BES     LPRFK+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFK-*                  3IO55920
       ADM     H7090               CHECKING INTERPRETING TECHNIQUE     *3IO55930
       SLW     LAREA+8             DATA RECORDING TECHNIQUE            *3IO55940
       CAL     BBBBB                                                   *3IO55950
       LNT     OPEND                                                   *3IO55960
       TRA     *+3                 CHECKPOINT ONLY IF REEL SWITCHING   *3IO55970
       LFT     CP1                                                     *3IO55980
       ADM     L(1)                CHECKPOINT                          *3IO55990
       SLW     LAREA+10                                                *3IO56000
       CLA     BLNKS                                                   *3IO56010
       STO     LAREA+9                                                 *3IO56020
       LDI     LAREA1              RESTORE SI                          *3IO56030
       AXT     2,4                                                     *3IO56040
       STO     LAREA+14,4                                              *3IO56050
       TIX     *-1,4,1                                                 *3IO56060
       AXT     6,4                                                     *3IO56070
       STO     LAREA1+6,4          RESERVE AND OPTIONAL                *3IO56080
       TIX     *-1,4,1                                                 *3IO56090
       TSX     LPRFD,4             CHECK FOR USER                      *3IO56100
LPRFH  PZE     **                  LABEL ACTION                        *3IO56110
       TRA     1,1                 EXIT                                *3IO56120
       BES     LPRFL+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFL-*                  3IO56130
       TTL     ADDITIONAL LABEL RECORD ROUTINE                          3IO56140
*      THIS ROUTINE CHECKS FOR USER LABEL ACTION REQUESTS               3IO56150
*      ALL INDEX REGISTERS AND SENSE INDICATORS ARE SAVED               3IO56160
*                                                                       3IO56170
*      TSX     LPRFD-2,4                                                3IO56180
*      PZE     ,,DECREMENT                                              3IO56190
*      RETURN                                                           3IO56200
*                                                                       3IO56210
*                  DECREMENT = 0   CHECK INPUT HEADER                   3IO56220
*                              1   CHECK INPUT TRAILER                  3IO56230
*                              2   PREPARE OUTPUT HEADER                3IO56240
*                              3   PREPARE OUTPUT TRAILER               3IO56250
*                                                                       3IO56260
       NZT     HHDR                                                    *3IO56270
       TRA     2,4                 EXIT IF NOT 7340                    *3IO56280
LPRFD  CLA     1,4                                                     *3IO56290
       STD     LPRFJ                                                   *3IO56300
       CLA     2,2                                                     *3IO56310
       SXA     LPRFE,4                                                 *3IO56320
       PDX     0,4                                                     *3IO56330
       TXL     LPRFE,4,0           EXIT IF NO USER LABEL ACTION        *3IO56340
       SXA     LPRFE-2,1                                               *3IO56350
       SXA     LPRFE-1,2           SAVE IRS AND SI                     *3IO56360
       STI     LPRFF                                                   *3IO56370
LPRFJ  TXI     *+1,4,**                                                *3IO56380
       SXA     *+1,4                                                   *3IO56390
       TSX     **,4                GO TO USER                          *3IO56400
       LDI     LPRFF                                                   *3IO56410
       AXT     **,1                                                    *3IO56420
       AXT     **,2                RESTORE IRS AND SI                  *3IO56430
LPRFE  AXT     **,4                                                    *3IO56440
       TRA     2,4                                                     *3IO56450
LPROO  PZE     **                  NON-ZERO IF PREPARING TRAILER        3IO56460
H7090  BCI     1,867090            RECORDING SYSTEM                     3IO56470
LPRFI  OCT     700000000126                                            $3IO56480
LPRFF  PZE     **                  TEMP STORAGE                         3IO56490
L(12A) PZE     10                                                       3IO56500
BLK1   BCI     1, 00000                                                 3IO56510
       BES     LPRFD+NOHYP/NOHYP**-NOHYP/NOHYP*LPRFD-*                  3IO56520
       TTL                         CONSTANTS FOR LABEL IMAGE ROUTINES   3IO56530
L(12)  PTW     12                                                       3IO56540
2DEC   PZE     0,,2                                                     3IO56550
1EOR   BCI     1,1EOR                                                   3IO56560
1EOF   BCI     1,1EOF                                                   3IO56570
1HDR   BCI     1,1HDR                                                   3IO56580
BLNK   BCI     1,1BLANK                                                 3IO56590
ASTER  BCI     1, *****                                                 3IO56600
BBBBB  BCI     1,     0                                                 3IO56610
LDOYR  BCI     1,000365                                                *3IO56620
BLP4   BCI     1,00 000                                                 3IO56630
M365   BCI     1,009635                                                 3IO56640
XCPT2  OCT     577777777777                                             3IO56650
MSK1   OCT     000077770000                                            $3IO56660
MSK2   OCT     200000400000                                             3IO56670
MSK3   OCT     077777777777                                             3IO56680
MSK4   OCT     000077777777                                            *3IO56690
2P2    BCI     1,020000                                                 3IO56700
1P4    BCI     1,000100                                                 3IO56710
BL1K   BCI     1,00000                                                  3IO56720
BL2K   BCI     1,0000                                                   3IO56730
BB0001 BCI     1,  0001                                                 3IO56740
1P5A   BCI     1,000010                                                 3IO56750
MNT6   MZE     LMSG5,,3                                                 3IO56760
       SPACE   1                                                        3IO56770
B6FIN  BSS     0                   ...END LABEL IOCS STORAGE.........   3IO56780
F7     BES     1                                                        3IO56790
       END                   END OF OBJECT IOCS                         3IO56800
